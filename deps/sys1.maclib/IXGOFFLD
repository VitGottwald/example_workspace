*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXGOFFLD                              -19/04/11-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Logger Services Writer Offload                * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 1997, 2017                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77B0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IXGOFFLD macro allows a user connected to a log stream to  * 00002100
*      intiate a writer offload operation for the log stream.         * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00002400
*                                                                     * 00002500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002600
*                                                                     * 00002700
*01* ENVIRONMENT:                                                     * 00002800
*                                                                     * 00002900
*                                                                     * 00003000
*      Dispatchable unit mode: Task mode.                             * 00003100
*                                                                     * 00003200
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00003300
*                                                                     * 00003400
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00003500
*                        key.                                         * 00003600
*                                                                     * 00003700
*      AMODE:            31- or 64-bit.                               * 00003800
*                                                                     * 00003900
*      ASC mode:         Primary or Access Register.                  * 00004000
*                                                                     * 00004100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004200
*                                                                     * 00004300
*                        The current primary address space must be    * 00004400
*                        the same as the HOME address space at the    * 00004500
*                        time you issued the IXGCONN macro.           * 00004600
*                                                                     * 00004700
*                        The caller must have connected with write    * 00004800
*                        authority to the log stream.                 * 00004900
*                                                                     * 00005000
*                        The caller's parameter list must be resident * 00005100
*                        in the caller's primary address space.       * 00005200
*                                                                     * 00005300
*                        All storage areas specified must be in the   * 00005400
*                        same storage key as the caller.              * 00005500
*                                                                     * 00005600
*      Locks:            No locks held.                               * 00005700
*                                                                     * 00005800
*      Control parameters: None.                                      * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*01* PROGRAMMING REQUIREMENTS:                                        * 00006300
*                                                                     * 00006400
*    Before issuing this request, a valid connection to the target    * 00006500
*    log stream identified by STREAMTOKEN must exist. Additionally,   * 00006600
*    the connection request (established by the IXGCONN) macro must   * 00006700
*    specify AUTH=WRITE.                                              * 00006800
*                                                                     * 00006900
*01* RESTRICTIONS:                                                    * 00007000
*                                                                     * 00007100
*    The caller must have connected with write authority to the log   * 00007200
*    stream.                                                          * 00007300
*                                                                     * 00007400
*    The caller's parameter list must be resident in the caller's     * 00007500
*    primary address space.                                           * 00007600
*                                                                     * 00007700
*    All storage areas specified must be in the same storage key as   * 00007800
*    the caller. Storage areas must exist in the caller's primary     * 00007900
*    address space.                                                   * 00008000
*                                                                     * 00008100
*    The caller's connect request must have indicated AUTH = WRITE.   * 00008200
*                                                                     * 00008300
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00008400
*                      GR2-GR13    Undefined                          * 00008500
*                      GR14-GR15   Reserved                           * 00008600
*                      AR0-AR1     Reserved                           * 00008700
*                      AR2-AR13    Undefined                          * 00008800
*                      AR14-AR15   Reserved                           * 00008900
*                                                                     * 00009000
*01* OUTPUT REGISTERS: GR0         Reason code if GR15 return code is * 00009100
*                                  non-zero                           * 00009200
*                      GR1         Unpredictable                      * 00009300
*                      GR2-GR13    Unchanged                          * 00009400
*                      GR14        Unpredictable                      * 00009500
*                      GR15        Return code                        * 00009600
*                      AR0-AR1     Unpredictable                      * 00009700
*                      AR2-AR13    Unchanged                          * 00009800
*                      AR14-AR15   Unpredictable                      * 00009900
*                                                                     * 00010000
*01* PERFORMANCE IMPLICATIONS:                                        * 00010100
*                                                                     * 00010200
*    None.                                                            * 00010300
*                                                                     * 00010400
*01* SYNTAX:                                                          * 00010500
*                                                                     * 00010600
*Ýxlabel¨  IXGOFFLD     STREAMTOKEN=xstreamtoken                      * 00010700
*                      ,ANSAREA=xansarea                              * 00010800
*                      ,ANSLEN=xanslen                                * 00010900
*                     Ý,RETCODE=xretcode¨                             * 00011000
*                     Ý,RSNCODE=xrsncode¨                             * 00011100
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00011200
*                    ÐÝ,MF=S¨                                         * 00011300
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00011400
*                    ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00011500
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*      Where:                                                         * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*      Ýxlabel¨                                                       * 00012200
*          is an optional symbol, starting in column 1, that is the   * 00012300
*          name on the IXGOFFLD macro invocation.  The name must      * 00012400
*          conform to the rules for an ordinary assembler language    * 00012500
*          symbol.                                                    * 00012600
*          DEFAULT: No name.                                          * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*      STREAMTOKEN=xstreamtoken                                       * 00013200
*          is the name (RS-type), or address in register (2)-(12), of * 00013300
*          a required 16 character input that specifies the log       * 00013400
*          stream token that was returned on the IXGCONN service.     * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*      ANSAREA=xansarea                                               * 00014000
*          is a required input.  It is the name (RS-type), or address * 00014100
*          in register (2)-(12), of a virtual storage area, called    * 00014200
*          the answer area.  The ANSAREA contains additional error    * 00014300
*          status when the IXGOFFLD service generates an error return * 00014400
*          code. The format of the returned data is defined by the    * 00014500
*          IXGANSAA mapping macro.                                    * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*      ANSLEN=xanslen                                                 * 00015100
*          is the name (RS-type), or address in register (2)-(12), of * 00015200
*          a required fullword input that contains the length in      * 00015300
*          bytes of the virtual storage area provided for ANSAREA.    * 00015400
*                                                                     * 00015500
*          The length of the answer area is described by the IXGANSAA * 00015600
*          mapping macro.                                             * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*                                                                     * 00016100
*      ÝRETCODE=xretcode¨                                             * 00016200
*          is the name (RS-type) of an optional fullword output       * 00016300
*          variable, or register (2)-(12) or (15), into which the     * 00016400
*          return code is to be copied from GPR 15.  If you specify   * 00016500
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00016600
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00016700
*          with MF=M.                                                 * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*      ÝRSNCODE=xrsncode¨                                             * 00017300
*          is the name (RS-type) of an optional fullword output       * 00017400
*          variable into which the reason code is to be copied from   * 00017500
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00017600
*          R0 (within or without parentheses), the value will be left * 00017700
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00018300
*          is an optional byte input decimal value in the "0-0" range * 00018400
*          that specifies the macro version.  PLISTVER is the only    * 00018500
*          key allowed on the list form of MF and determines which    * 00018600
*          parameter list is generated.  Note that MAX may be         * 00018700
*          specified instead of a number, and the parameter list will * 00018800
*          be of the largest size currently supported. This size may  * 00018900
*          grow from release to release (thus possibly affecting the  * 00019000
*          amount of storage needed by your program).  If your        * 00019100
*          program can tolerate this, IBM recommends that you always  * 00019200
*          specify MAX when creating the list form parameter list as  * 00019300
*          that will ensure that the list form parameter list is      * 00019400
*          always long enough to hold whatever parameters might be    * 00019500
*          specified on the execute form.                             * 00019600
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00019700
*          default is the lowest version which allows all of the      * 00019800
*          parameters specified on the invocation to be processed.    * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*      ÝMF=»S!L!M!Eº¨                                                 * 00020400
*          is an optional keyword input which specifies the macro     * 00020500
*          form.                                                      * 00020600
*          DEFAULT: S                                                 * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*          ÝMF=S¨                                                     * 00021000
*              specifies the standard form of the macro.  The "S"     * 00021100
*              form generates code to put the parameters into an      * 00021200
*              in-line parameter list and invoke the desired service. * 00021300
*              Full checking for required macro keys is done along    * 00021400
*              with supplying defaults for omitted optional           * 00021500
*              parameters.                                            * 00021600
*                                                                     * 00021700
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00021800
*              specifies the list form of the macro.  The "L" form    * 00021900
*              defines an area to be used for the parameter list.     * 00022000
*              Only the PLISTVER key may be specified on the          * 00022100
*              invocation.  All other macro parameters are flagged as * 00022200
*              errors.  If PLISTVER is not specified, the original    * 00022300
*              parameter list definition is used.                     * 00022400
*                                                                     * 00022500
*            ,xmfctrl                                                 * 00022600
*              is a required input.  It is the name of a storage area * 00022700
*              for the parameter list.                                * 00022800
*                                                                     * 00022900
*            »,xmfattr!0Dº                                            * 00023000
*              is an optional 60 character input string that varies   * 00023100
*              from 1 to 60 characters. Use it to force boundary      * 00023200
*              alignment of the parameter list. Use only 0F or 0D.    * 00023300
*              DEFAULT: 0D which forces the parameter list to a       * 00023400
*              doubleword boundary.                                   * 00023500
*                                                                     * 00023600
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00023700
*              specifies the modify form of the macro.  The "M" form  * 00023800
*              generates code to put the parameters into the          * 00023900
*              parameter list specified by xmfctrl.                   * 00024000
*                                                                     * 00024100
*            ,xmfctrl                                                 * 00024200
*              is a required input.  It is the name (RS-type), or     * 00024300
*              address in register (1)-(12), of a storage area for    * 00024400
*              the parameter list.                                    * 00024500
*                                                                     * 00024600
*            »,COMPLETE!NOCHECKº¨                                     * 00024700
*              is an optional keyword input which specifies the       * 00024800
*              degree of macro parameter syntax checking.             * 00024900
*              DEFAULT: COMPLETE                                      * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*              COMPLETE                                               * 00025300
*                  Checking for required macro keys is done and       * 00025400
*                  defaults are supplied for omitted optional         * 00025500
*                  parameters.  (See Macro Usage Note 2).             * 00025600
*                                                                     * 00025700
*              NOCHECK                                                * 00025800
*                  Checking for required macro keys is not done nor   * 00025900
*                  are defaults supplied for omitted optional         * 00026000
*                  parameters.                                        * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00026500
*              specifies the execute form of the macro.  The "E" form * 00026600
*              generates code to put the parameters into the          * 00026700
*              parameter list specified by xmfctrl and invoke the     * 00026800
*              desired service.                                       * 00026900
*                                                                     * 00027000
*            ,xmfctrl                                                 * 00027100
*              is a required input.  It is the name (RS-type), or     * 00027200
*              address in register (1)-(12), of a storage area for    * 00027300
*              the parameter list.                                    * 00027400
*                                                                     * 00027500
*            »,COMPLETE!NOCHECKº                                      * 00027600
*              is an optional keyword input which specifies the       * 00027700
*              degree of macro parameter syntax checking.             * 00027800
*              DEFAULT: COMPLETE                                      * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*              COMPLETE                                               * 00028200
*                  Checking for required macro keys is done and       * 00028300
*                  defaults are supplied for omitted optional         * 00028400
*                  parameters.  (See Macro Usage Note 2).             * 00028500
*                                                                     * 00028600
*              NOCHECK                                                * 00028700
*                  Checking for required macro keys is not done nor   * 00028800
*                  are defaults supplied for omitted optional         * 00028900
*                  parameters.                                        * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*01* RETURN CODES:                                                    * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                 When IXGOFFLD macro returns control to your         * 00030100
*                 program, GPR 15 contains a return code and GPR 0    * 00030200
*                 contains a reason code.                             * 00030300
*                                                                     * 00030400
*                 The IXGCON mapping macro provides equate symbols    * 00030500
*                 for the return and reason codes.  The equate        * 00030600
*                 symbols associated with each hexadecimal return     * 00030700
*                 code are as follows:                                * 00030800
*                                                                     * 00030900
*       00        IXGRETCODEOK -  Successful Completion               * 00031000
*                                                                     * 00031100
*       04        IXGRETCODEWARNING - The request was processed       * 00031200
*                 successfully, however a warning condition was       * 00031300
*                 encountered.                                        * 00031400
*                                                                     * 00031500
*       08        IXGRETCODEERROR - An error has been encountered.    * 00031600
*                 The associated reason code provides more            * 00031700
*                 information.                                        * 00031800
*                                                                     * 00031900
*       0C        IXGRETCODECOMPERROR - A System Logger component     * 00032000
*                 error has been encountered.                         * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*01* REASON CODES:                                                    * 00032500
*                                                                     * 00032600
*       Full details on the reason codes provided for each return     * 00032700
*       code listed above can be found in the "Return and Reason      * 00032800
*       Codes" topic for this service in publication "z/OS MVS        * 00032900
*       Programming:  Assembler Services Reference:, Volume 2         * 00033000
*       (IARR2V-XCTLX)".                                              * 00033100
*                                                                     * 00033200
*       REASON    RETURN                                              * 00033300
*       CODE      CODE      DESCRIPTION                               * 00033400
*       --------  --------  -----------                               * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*       xxxx0000  00                                                  * 00033800
*                                                                     * 00033900
*                           IXGRSNCODEOK -                            * 00034000
*                                                                     * 00034100
*                           EXPLANATION: Request processed            * 00034200
*                           successfully.                             * 00034300
*                                                                     * 00034400
*       xxxx0801  08                                                  * 00034500
*                                                                     * 00034600
*                           IXGRSNCODEBADPARMLIST -                   * 00034700
*                                                                     * 00034800
*                           EXPLANATION:  Program error. The          * 00034900
*                           parameter list is invalid.  Either the    * 00035000
*                           parameter list storage is inaccessible,   * 00035100
*                           or an invalid version of the macro was    * 00035200
*                           used.                                     * 00035300
*                                                                     * 00035400
*                           ACTION: Ensure that the storage area for  * 00035500
*                           the parameter list is accessible to the   * 00035600
*                           system logger for the duration of the     * 00035700
*                           request, and that the macro version is    * 00035800
*                           correct.  The parameter list storage must * 00035900
*                           be addressable in the caller's primary    * 00036000
*                           address space and in the same key as the  * 00036100
*                           caller.                                   * 00036200
*                                                                     * 00036300
*       xxxx0802  08                                                  * 00036400
*                                                                     * 00036500
*                           IXGRSNCODEXESERROR -                      * 00036600
*                                                                     * 00036700
*                           EXPLANATION:  System error. A severe      * 00036800
*                           cross-system extended services (XES)      * 00036900
*                           error has occurred.                       * 00037000
*                                                                     * 00037100
*                           ACTION:  See ANSAA_DIAG1 for the XES      * 00037200
*                           return code and ANSAA_DIAG2 for the XES   * 00037300
*                           reason code.                              * 00037400
*                                                                     * 00037500
*       xxxx0806  08                                                  * 00037600
*                                                                     * 00037700
*                           IXGRSNCODEBADSTMTOKEN -                   * 00037800
*                                                                     * 00037900
*                           EXPLANATION: Program error. One of the    * 00038000
*                           following occurred: # The stream token    * 00038100
*                           was not valid. # The specified request    * 00038200
*                           was issued from an address space other    * 00038300
*                           than the connectors address space.        * 00038400
*                                                                     * 00038500
*                           ACTION: Do one of the following: # Make   * 00038600
*                           sure that the stream token specified is   * 00038700
*                           valid. # Ensure that IXGOFFLD requests    * 00038800
*                           were issued from the connectors address   * 00038900
*                           space.                                    * 00039000
*                                                                     * 00039100
*       xxxx080A  08                                                  * 00039200
*                                                                     * 00039300
*                           IXGRSNCODEREQUESTLOCKED -                 * 00039400
*                                                                     * 00039500
*                           EXPLANATION:  Program error. The program  * 00039600
*                           issuing the request is holding a lock.    * 00039700
*                                                                     * 00039800
*                           ACTION: Ensure that the program issuing   * 00039900
*                           the request is not holding a lock.        * 00040000
*                                                                     * 00040100
*       xxxx0814  08                                                  * 00040200
*                                                                     * 00040300
*                           IXGRSNCODENOTAVAILFORIPL -                * 00040400
*                                                                     * 00040500
*                           EXPLANATION:  Environment error. The      * 00040600
*                           system logger address space is not        * 00040700
*                           available for the remainder of this IPL.  * 00040800
*                           The system issues messages about this     * 00040900
*                           error during system logger                * 00041000
*                           initialization.                           * 00041100
*                                                                     * 00041200
*                           ACTION: See the explanation for system    * 00041300
*                           messages issued during system logger      * 00041400
*                           initialization.                           * 00041500
*                                                                     * 00041600
*       xxxx0815  08                                                  * 00041700
*                                                                     * 00041800
*                           IXGRSNCODENOTENABLED -                    * 00041900
*                                                                     * 00042000
*                           EXPLANATION:  Program error. The program  * 00042100
*                           issuing the request is not enabled for    * 00042200
*                           I/O and external interrupts, so the       * 00042300
*                           request fails.                            * 00042400
*                                                                     * 00042500
*                           ACTION:  Make sure the program issuing    * 00042600
*                           the request is enabled for I/O and        * 00042700
*                           external interrupts.                      * 00042800
*                                                                     * 00042900
*       xxxx0816  08                                                  * 00043000
*                                                                     * 00043100
*                           IXGRSNCODEBADANSLEN -                     * 00043200
*                                                                     * 00043300
*                           EXPLANATION:  Program error. The answer   * 00043400
*                           area length (ANSLEN parameter) is not     * 00043500
*                           large enough. The system logger returned  * 00043600
*                           the required size in the                  * 00043700
*                           Ansaa_Preferred_Size field of the answer  * 00043800
*                           area, mapped by IXGANSAA macro.           * 00043900
*                                                                     * 00044000
*                           ACTION:  Re-issue the request, specifying * 00044100
*                           an answer area of the required size.      * 00044200
*                                                                     * 00044300
*       xxxx0817  08                                                  * 00044400
*                                                                     * 00044500
*                           IXGRSNCODEBADANSAREA -                    * 00044600
*                                                                     * 00044700
*                           EXPLANATION: Program error. The storage   * 00044800
*                           area specified on the ANSAREA parameter   * 00044900
*                           cannot be accessed. This may occur after  * 00045000
*                           the system logger address space has       * 00045100
*                           terminated.                               * 00045200
*                                                                     * 00045300
*                           ACTION: Specify storage that is in the    * 00045400
*                           callers primary address space and in the  * 00045500
*                           same key as the calling program at the    * 00045600
*                           time the system logger service was        * 00045700
*                           issued. This storage must be accessible   * 00045800
*                           until the request completes.              * 00045900
*                                                                     * 00046000
*       xxxx0819  08                                                  * 00046100
*                                                                     * 00046200
*                           IXGRSNCODESRBMODE -                       * 00046300
*                                                                     * 00046400
*                           EXPLANATION:  Program error. The calling  * 00046500
*                           program is in SRB mode, but task mode is  * 00046600
*                           the required dispatchable unit mode for   * 00046700
*                           this system logger service.               * 00046800
*                                                                     * 00046900
*                           ACTION: Make sure the calling program is  * 00047000
*                           in task mode.                             * 00047100
*                                                                     * 00047200
*       xxxx081C  08                                                  * 00047300
*                                                                     * 00047400
*                           IXGRSNCODENOTAUTHFUNC -                   * 00047500
*                                                                     * 00047600
*                           EXPLANATION: Program error. The program   * 00047700
*                           connected to the log stream with the      * 00047800
*                           AUTH=READ parameter and then tried to     * 00047900
*                           delete, write, offload or update data.    * 00048000
*                           You cannot write, delete, update or       * 00048100
*                           offload data when connected with read     * 00048200
*                           authority.                                * 00048300
*                                                                     * 00048400
*                           Or the program connected to the log       * 00048500
*                           stream with the AUTH=WRITE parameter and  * 00048600
*                           was granted limited access (i.e. write    * 00048700
*                           only log data and disconnect) as per the  * 00048800
*                           defined security access profiles, and     * 00048900
*                           then tried to perform a log stream access * 00049000
*                           service other than IXGWRITE, or IXGCONN   * 00049100
*                           (to disconnect).                          * 00049200
*                                                                     * 00049300
*                           ACTION: A connection to the log stream    * 00049400
*                           with the appropriate access authority     * 00049500
*                           must be established before requesting a   * 00049600
*                           log stream offload (IXGOFFLD).  When      * 00049700
*                           AUTH=WRITE was already used when the      * 00049800
*                           error was encountered, then check with    * 00049900
*                           your installation's security              * 00050000
*                           administrator on obtaining the            * 00050100
*                           appropriate access to the log stream.     * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*       xxxx082D  08        IXGRSNCODEEXPIREDSTMTOKEN -               * 00050500
*                                                                     * 00050600
*                           EXPLANATION: Environment error. The       * 00050700
*                           stream token is no longer valid because   * 00050800
*                           the connector has been disconnected.      * 00050900
*                                                                     * 00051000
*                           ACTION: Re-connect to the logstream       * 00051100
*                           before issuing any functional requests.   * 00051200
*                                                                     * 00051300
*       xxxx0840  08                                                  * 00051400
*                                                                     * 00051500
*                           IXGRSNCODEBADVERSION -                    * 00051600
*                                                                     * 00051700
*                           EXPLANATION: Environment error. The       * 00051800
*                           parameter list passed to the service      * 00051900
*                           routine has an invalid version indicator. * 00052000
*                                                                     * 00052100
*                           ACTION: Ensure the level of MVS executing * 00052200
*                           the request and the macro library used to * 00052300
*                           compile the invoking routine are          * 00052400
*                           compatible.                               * 00052500
*                                                                     * 00052600
*       xxxx0861  08                                                  * 00052700
*                                                                     * 00052800
*                           IXGRSNCODEREBUILDINPROGRESS -             * 00052900
*                                                                     * 00053000
*                           EXPLANATION: Environment error. No        * 00053100
*                           requests can be processed for this log    * 00053200
*                           stream because a coupling facility        * 00053300
*                           structure re-build or a system-managed    * 00053400
*                           duplexing re-build is in progress for the * 00053500
*                           structure associated with this log        * 00053600
*                           stream.                                   * 00053700
*                                                                     * 00053800
*                           ACTION: Listen for ENF signal 48 that     * 00053900
*                           will indicate one of the following: # The * 00054000
*                           log stream is available because the       * 00054100
*                           re-build completed successfully. Re-issue * 00054200
*                           the request.  # The re-build failed and   * 00054300
*                           the log stream is not available. .        * 00054400
*                                                                     * 00054500
*       xxxx0862  08                                                  * 00054600
*                                                                     * 00054700
*                           IXGRSNCODEXESPURGE -                      * 00054800
*                                                                     * 00054900
*                           EXPLANATION: Environment error. An        * 00055000
*                           cross-system extended services (XES)      * 00055100
*                           request has been purged due to re-build   * 00055200
*                           processing.                               * 00055300
*                                                                     * 00055400
*                           ACTION: Listen for ENF signal 48 that     * 00055500
*                           will indicate one of the following: # The * 00055600
*                           log stream is available because the       * 00055700
*                           re-build completed successfully. Re-issue * 00055800
*                           the request.  # The re-build failed and   * 00055900
*                           the log stream is not available. .        * 00056000
*                                                                     * 00056100
*       xxxx0863  08                                                  * 00056200
*                                                                     * 00056300
*                           IXGRSNCODESTRUCTUREFAILED -               * 00056400
*                                                                     * 00056500
*                           EXPLANATION: Environment error. Either    * 00056600
*                           the coupling facility structure           * 00056700
*                           associated with the log stream has failed * 00056800
*                           or the coupling facility itself has       * 00056900
*                           failed.                                   * 00057000
*                                                                     * 00057100
*                           ACTION: Listen for ENF signal 48 that     * 00057200
*                           will indicate one of the following: # The * 00057300
*                           log stream is available because the       * 00057400
*                           re-build completed successfully. Re-issue * 00057500
*                           the request.  # The re-build failed and   * 00057600
*                           the log stream is not available.          * 00057700
*                                                                     * 00057800
*       xxxx0864  08                                                  * 00057900
*                                                                     * 00058000
*                           IXGRSNCODENOCONNECTIVITY -                * 00058100
*                                                                     * 00058200
*                           EXPLANATION: Environment error. No        * 00058300
*                           connectivity exists to the coupling       * 00058400
*                           facility associated with the log stream.  * 00058500
*                           The system logger will either attempt to  * 00058600
*                           re-build the log stream in another        * 00058700
*                           coupling facility or the log stream will  * 00058800
*                           be disconnected.                          * 00058900
*                                                                     * 00059000
*                           ACTION: Listen for ENF signal 48 that     * 00059100
*                           will indicate one of the following: # The * 00059200
*                           log stream is available because the       * 00059300
*                           re-build completed successfully. Re-issue * 00059400
*                           the request.  # The re-build failed and   * 00059500
*                           the log stream is not available. # The    * 00059600
*                           log stream has been disconnected from     * 00059700
*                           this system.                              * 00059800
*                                                                     * 00059900
*       xxxx0890  08                                                  * 00060000
*                                                                     * 00060100
*                           IXGRSNCODEADDRSPACENOTAVAIL -             * 00060200
*                                                                     * 00060300
*                           EXPLANATION: System error. The system     * 00060400
*                           logger address space failed and is not    * 00060500
*                           available.                                * 00060600
*                                                                     * 00060700
*                           ACTION: Do not issue system logger        * 00060800
*                           requests.                                 * 00060900
*                                                                     * 00061000
*       xxxx0891  08                                                  * 00061100
*                                                                     * 00061200
*                           IXGRSNCODEADDRSPACEINITIALIZING -         * 00061300
*                                                                     * 00061400
*                                                                     * 00061500
*                           EXPLANATION: System error. The system     * 00061600
*                           logger address space is not available     * 00061700
*                           because it is IPLing.                     * 00061800
*                                                                     * 00061900
*                           ACTION:  Listen for ENF signal 48, which  * 00062000
*                           will indicate when the system logger      * 00062100
*                           address space is available.  Once it's    * 00062200
*                           available, re-connect to the log stream,  * 00062300
*                           then re-issue this request. You can also  * 00062400
*                           listen for ENF signal 48, which will      * 00062500
*                           indicate if the system logger address     * 00062600
*                           space will not be available for the life  * 00062700
*                           of the IPL. In that case, do not issue    * 00062800
*                           system logger services.                   * 00062900
*                                                                     * 00063000
*       xxxx0891  08                                                  * 00063100
*                                                                     * 00063200
*                           IXGRSNCODEADDRSPACEINITIALIZING -         * 00063300
*                                                                     * 00063400
*                                                                     * 00063500
*                           EXPLANATION: System error. The system     * 00063600
*                           logger address space is not available     * 00063700
*                           because it is IPLing.                     * 00063800
*                                                                     * 00063900
*                           ACTION:  Listen for ENF signal 48, which  * 00064000
*                           will indicate when the system logger      * 00064100
*                           address space is available.  Once it's    * 00064200
*                           available, re-connect to the log stream,  * 00064300
*                           then re-issue this request. You can also  * 00064400
*                           listen for ENF signal 48, which will      * 00064500
*                           indicate if the system logger address     * 00064600
*                           space will not be available for the life  * 00064700
*                           of the IPL. In that case, do not issue    * 00064800
*                           system logger services.                   * 00064900
*                                                                     * 00065000
*       xxxx0C00  0C                                                  * 00065100
*                                                                     * 00065200
*                           EXPLANATION: System Logger Error.  A      * 00065300
*                           System Logger component error has been    * 00065400
*                           encountered.                              * 00065500
*                                                                     * 00065600
*                                                                     * 00065700
*                                                                     * 00065800
*01* ABEND CODES:                                                     * 00065900
*                                                                     * 00066000
*                                                                     * 00066100
*       1C5       IXG_ABEND_CODE - A System Logger abend has          * 00066200
*                 occurred.                                           * 00066300
*                                                                     * 00066400
*                                                                     * 00066500
*                                                                     * 00066600
*01* ABEND REASON CODES:                                              * 00066700
*                                                                     * 00066800
*       REASON    ABEND                                               * 00066900
*       CODE      CODE      DESCRIPTION                               * 00067000
*       --------  --------  -----------                               * 00067100
*                                                                     * 00067200
*                                                                     * 00067300
*       xxxx085F  1C5       IXGRSNCODEPERCTOREQUESTOR -               * 00067400
*                                                                     * 00067500
*                           EXPLANATION: Environment error.           * 00067600
*                           Percolation to the service requestor's    * 00067700
*                           task occurred because of an abend during  * 00067800
*                           system logger processing. Retry was not   * 00067900
*                           allowed.                                  * 00068000
*                                                                     * 00068100
*                           ACTION: Issue the request again. If the   * 00068200
*                           problem persists, contact the IBM Support * 00068300
*                           Center.                                   * 00068400
*                                                                     * 00068500
*                                                                     * 00068600
*                                                                     * 00068700
*01* MODULE TYPE:  ASSEM MACRO                                        * 00068800
*                                                                     * 00068900
*02*   PROCESSOR:  ASSEM                                              * 00069000
*                                                                     * 00069100
*01* COMPONENT:  SCLOG                                                * 00069200
*                                                                     * 00069300
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00069400
*                                                                     * 00069500
*01* EXAMPLES:                                                        * 00069600
*    None.                                                            * 00069700
*                                                                     * 00069800
*01* MACRO USAGE NOTES:                                               * 00069900
*                                                                     * 00070000
*                                                                     * 00070100
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00070200
*        global macro variable.  Any value other than 'NO' will       * 00070300
*        result in the macro expansion being printed.  The default is * 00070400
*        'YES'.  The following examples illustrate how the ZPRINT     * 00070500
*        variable should be set.                                      * 00070600
*                                                                     * 00070700
*                    GBLC &ZPRINT                                     * 00070800
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00070900
*                                                                     * 00071000
*                                                                     * 00071100
*    2.  When using the NOCHECK option in conjunction with the Modify * 00071200
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00071300
*        Modify   or  Execute  form  invocation  which  specifies  or * 00071400
*        defaults  to  the  COMPLETE  option.   This insures that the * 00071500
*        parameter  list  is  initialized completely.   The parameter * 00071600
*        list  field which identifies the version number of the macro * 00071700
*        is only set when the Standard form or the Complete option of * 00071800
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00071900
*        explicitly  specified.  Be sure that the resulting parameter * 00072000
*        list version number covers all the keys that you use.        * 00072100
*                                                                     * 00072200
*                                                                     * 00072300
*    3.  All   keys   currently   contained  in  the  IXGOFFLD  macro * 00072400
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00072500
*        value of 0 or MAX.                                           * 00072600
*                                                                     * 00072700
*                                                                     * 00072800
*                                                                     * 00072900
*                                                                     * 00073000
*01* CHANGE ACTIVITY:                                                 * 00073100
*                                                                     * 00073200
*   Flag LineItem  FMID    Date   ID    Comment                       * 00073300
*                                                                     * 00073400
*    $L0=LOGGR    HBB6603 951201 PDXD:                                * 00073500
*    $L1=CFDUP    HBB7705 001024 PDJL:  Update                        * 00073600
*                                         IxgRsnCodeRebuildInProgress * 00073700
*    $L2=64V2     HBB7709 020404 PD00A8:  Support Amode 64            * 00073800
*    $P1=PJK0029  HBB7709 030401 PD00A8:  Documentation Updates       * 00073900
*    $L3=ME09177  HBB7740 070131 PDDZ:  refer to pubs for reason code * 00074000
*                                         details                     * 00074100
*    $P2=ME17775  HBB7770 091124 PDDZ:  AR mode proper linkage        * 00074200
*    $01=OA56050  HBB77B0 190411 PDDZ:  WriteOnly access              * 00074300
****** END OF SPECIFICATIONS *****************************************/ 00074400
*/********************************************************************* 00074500
         MACRO                                                          00074600
&XLABEL  IXGOFFLD &STREAMTOKEN=,&ANSAREA=,&ANSLEN=,&RETCODE=,&RSNCODE=,*00074700
               &PLISTVER=,&MF=                                          00074800
.*                                                                      00074900
*                 MACDATE -19/04/11-<0>                                 00075000
.*                                                                      00075100
.*******************************************************************    00075200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00075300
.*******************************************************************    00075400
                 GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                00075500
                 GBLC  &ZTEST      YES=TEST NO=NO TEST                  00075600
                 GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX          00075700
.*                                                                      00075800
                 GBLC  &ZIXGOFFLD  YES=MACRO USED AT LEAST ONCE         00075900
.*******************************************************************    00076000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00076100
.*******************************************************************    00076200
                 LCLC  &ZMS        ERROR MESSAGE WORK AREA              00076300
                 LCLC  &ZCNDX      SYSNDX CHARACTERS                    00076400
                 LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED           00076500
                 LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR          00076600
                 LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE          00076700
                 LCLA  &ZAWRK      USED AS A WORK AREA                  00076800
                 LCLA  &ZASIZ      USED FOR SIZE OF VALUE               00076900
                 LCLA  &ZN         NUMERIC WORK VARIABLE                00077000
                 LCLC  &ZC         CHARACTER WORK VARIABLE              00077100
                 LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE          00077200
                 LCLA  &ZTLA       VALUE TOO LONG VARIABLE              00077300
                 LCLC  &ZMAC_G     "G" or null                          00077400
&ZMAC_G          SETC  ''                                               00077500
                 LCLC  &ZMAC_LR                                         00077600
&ZMAC_LR         SETC  'LR'                                             00077700
                 LCLC  &ZMAC_L                                          00077800
&ZMAC_L          SETC  'L'                                              00077900
                 LCLC  &ZMAC_ST                                         00078000
&ZMAC_ST         SETC  'ST'                                             00078100
                 LCLC  &ZMAC_LLGT                                       00078200
&ZMAC_LLGT       SETC  'L'                                              00078300
                 LCLC  &ZMAC_LGR                                        00078400
&ZMAC_LGR        SETC  'LR'                                             00078500
                 LCLC  &ZMAC_LG                                         00078600
&ZMAC_LG         SETC  'L'                                              00078700
                 LCLC  &ZMAC_STG                                        00078800
&ZMAC_STG        SETC  'ST'                                             00078900
                 LCLA  &ZMACRET    MACRO RETURN CODE                    00079000
&ZMACRET         SETA  0           ASSUME NO ERRORS                     00079100
.*                                                                      00079200
                 LCLC  &ZCSYSLIST(255)          NONXKEY, POS ARRAY      00079300
                 LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()           00079400
                 LCLA  &ZPLLEN     PARAMETER LIST LENGTH                00079500
                 LCLC  &ZENDBASEPL              End of base PL          00079600
                 LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                00079700
.*******************************************************************    00079800
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00079900
.*******************************************************************    00080000
                 LCLA  &ZI         INDEX FOR ARRAY                      00080100
                 LCLA  &ZJ         INDEX FOR PARMS                      00080200
                 LCLA  &ZK         INDEX FOR PARSE                      00080300
                 LCLA  &ZLO        LOW RANGE VALUE                      00080400
                 LCLA  &ZHI        HIGH RANGE VALUE                     00080500
                 LCLC  &ZW         WORK AREA FOR PARM                   00080600
.********************************************************************   00080700
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00080800
.********************************************************************   00080900
                 GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL              00081000
                 GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE       00081100
                 GBLA  &SYSALVL    SYSSTATE ARCHLVL                     00081200
                 GBLC  &SYSAM64    SYSSTATE AMODE64                     00081300
.*                                                                      00081400
                 AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED       00081500
                 AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED        00081600
                 SPLEVEL  TEST                                          00081700
.ZSYS2           ANOP  ,                                                00081800
                 AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1            00081900
                 AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1            00082000
                 SYSSTATE TEST                                          00082100
                 AGO   .ZSYS4                                           00082200
.ZSYS3           ANOP  ,                                                00082300
&SYSASCE         SETC  'P'         ASSUME SYSSTATE PRIMARY              00082400
.ZSYS4           ANOP  ,                                                00082500
                 AIF   ('&SYSAM64' NE 'YES').ZSYSN64                    00082600
&ZMAC_LLGT       SETC 'LLGT'                                            00082700
&ZMAC_LGR        SETC 'LGR'                                             00082800
&ZMAC_LG         SETC 'LG'                                              00082900
&ZMAC_STG        SETC 'STG'                                             00083000
.ZSYSN64         ANOP  ,                                                00083100
.*******************************************************************    00083200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00083300
.*******************************************************************    00083400
                 LCLC  &XSTREAMTOKEN            ++ NAME                 00083500
                 LCLC  &XANSAREA   ++ NAME                              00083600
                 LCLC  &XANSLEN    ++ NAME                              00083700
                 LCLC  &XRETCODE   ++ NAME                              00083800
                 LCLC  &XRSNCODE   ++ NAME                              00083900
                 LCLA  &XPLISTVER  ++ VALUE                             00084000
                 LCLC  &XMF        ++ VALUE                             00084100
                 LCLC  &XMFCTRL    ++ NAME                              00084200
                 LCLC  &XMFATTR    ++ VALUE                             00084300
                 LCLC  &XMFSCK     ++ VALUE                             00084400
.*******************************************************************    00084500
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00084600
.*******************************************************************    00084700
                 LCLC  &ZXSTREAMTOKEN           ++ INPUT NAME           00084800
                 LCLC  &ZXANSAREA  ++ INPUT NAME                        00084900
                 LCLC  &ZXANSLEN   ++ INPUT NAME                        00085000
                 LCLC  &ZXRETCODE  ++ OUTPUT NAME                       00085100
                 LCLC  &ZXRSNCODE  ++ OUTPUT NAME                       00085200
                 LCLC  &ZXPLISTVER              ++ INPUT VALUE          00085300
                 LCLC  &ZXMF       ++ INPUT VALUE                       00085400
                 LCLC  &ZXMFCTRL   ++ INPUT NAME                        00085500
                 LCLC  &ZXMFATTR   ++ INPUT VALUE                       00085600
                 LCLC  &ZXMFSCK    ++ INPUT VALUE                       00085700
.********************************************************************   00085800
.***AC.PLV01  PROCESS PLISTVER                                      *   00085900
.********************************************************************   00086000
&XPLISTVER      SETA  0                                                 00086100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00086200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00086300
&XPLISTVER      SETA  0                                                 00086400
.ZPLV0          ANOP  ,                                                 00086500
.*                                                                      00086600
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00086700
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00086800
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00086900
.*-------------------------------------------------------------------   00087000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00087100
&ZMS            SETC  '"PLISTVER='                                      00087200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00087300
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00087400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00087500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00087600
                AGO   .ZPVCK2                                           00087700
.ZPVCK3         ANOP  ,                                                 00087800
.*-------------------------------------------------------------------   00087900
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00088000
&ZMS            SETC  '"PLISTVER='                                      00088100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00088200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00088300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00088400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00088500
                AGO   .ZPVCKE                                           00088600
.ZPVCK2         ANOP  ,                                                 00088700
.*-------------------------------------------------------------------   00088800
&ZCVAL          SETC  '&PLISTVER(1)'                                    00088900
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00089000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00089100
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00089200
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00089300
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00089400
.ZPVCK6         ANOP  ,                                                 00089500
&ZMS            SETC  '"PLISTVER='                                      00089600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00089700
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00089800
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00089900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00090000
&XPLISTVER      SETA  0                                                 00090100
                AGO   .ZPVCKE                                           00090200
.*-------------------------------------------------------------------   00090300
.ZPVCK4A        ANOP  ,                                                 00090400
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00090500
&ZMS            SETC  'PLISTVER='                                       00090600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00090700
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00090800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00090900
                MNOTE 8,' &ZMS IS REQUIRED.'                            00091000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00091100
                AGO   .ZPVCK5                                           00091200
.ZPVCK4         ANOP  ,                                                 00091300
&XPLISTVER      SETA  &PLISTVER(1)                                      00091400
.ZPVCK5         ANOP  ,                                                 00091500
.ZPVCKE         ANOP  ,                                                 00091600
.********************************************************************   00091700
.***AG.MF01 PROCESS MF MACRO FORMS                                      00091800
.********************************************************************   00091900
                 ACTR  10000                                            00092000
.*------------------------------------------------------------------    00092100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092200
&XMF             SETC  ''          INITIALIZE XVARIABLE                 00092300
.*-------------------------------------------------------------------   00092400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092500
.ZG21            ANOP  ,                                                00092600
&ZTLC            SETC 'S'                                               00092700
                 AIF   ('&MF(1)' NE '&ZTLC').ZG22                       00092800
&XMF             SETC  'S'         SET KEYWORD                          00092900
&XMFSCK          SETC  'COMPLETE'  SET XMFSCK                           00093000
                 AIF   (N'&MF LE 1).ZG21A       CK NUM                  00093100
&ZMS             SETC  '"MF='                                           00093200
&ZMS             SETC  '&ZMS.&MF"'                                      00093300
&ZMS             SETC  '&ZMS "MF"'                                      00093400
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00093500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00093600
.ZG21A           ANOP  ,                                                00093700
.*-------------------------------------------------------------------   00093800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093900
.ZG22            ANOP  ,                                                00094000
&ZTLC            SETC 'L'                                               00094100
                 AIF   ('&MF(1)' NE '&ZTLC').ZG29                       00094200
&XMF             SETC  'L'         SET KEYWORD                          00094300
                 AIF   (N'&MF LE 3).ZG22A       CK NUM                  00094400
&ZMS             SETC  '"MF='                                           00094500
&ZMS             SETC  '&ZMS.&MF"'                                      00094600
&ZMS             SETC  '&ZMS "MF"'                                      00094700
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00094800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00094900
.ZG22A           ANOP  ,                                                00095000
.*-------------------------------------------------------------------   00095100
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00095200
                 AIF   (N'&SYSLIST NE 0).ZG22B  POSITIONALS?            00095300
                 AIF   ('&STREAMTOKEN' NE '').ZG22B  KEYS?              00095400
                 AIF   ('&ANSAREA' NE '').ZG22B  KEYS?                  00095500
                 AIF   ('&ANSLEN' NE '').ZG22B  KEYS?                   00095600
                 AIF   ('&RETCODE' NE '').ZG22B  KEYS?                  00095700
                 AIF   ('&RSNCODE' NE '').ZG22B  KEYS?                  00095800
                 AGO    .ZG22C     INVOCATION OKAY                      00095900
.ZG22B           ANOP  ,                                                00096000
&ZMS             SETC  'THE "L" FORM OF "MF"'                           00096100
&ZMS             SETC  '&ZMS CAN ONLY HAVE'                             00096200
&ZMS             SETC  '&ZMS THE "PLISTVER" KEY'                        00096300
                 MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'           00096400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00096500
.ZG22C           ANOP  ,                                                00096600
.*-------------------------------------------------------------------   00096700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00096800
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00096900
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00097000
                 AIF   (N'&MF(2) GT 1).ZG24B    MULTI                   00097100
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00097200
.ZG24B           AIF   (K'&MF(2) GT 0).ZG24C                            00097300
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00097400
&ZMS             SETC  'WHEN "L" IS SPECIFIED'                          00097500
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00097600
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00097700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00097800
.ZG24C           ANOP  ,                                                00097900
.*-------------------------------------------------------------------   00098000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00098100
                 AIF   (K'&ZXMFCTRL LE 0).ZG24P  NOT I/O                00098200
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG24P                   00098300
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00098400
&ZMS             SETC  '"MF='                                           00098500
&ZMS             SETC  '&ZMS.&MF"'                                      00098600
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00098700
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                00098800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00098900
.ZG24P           ANOP  ,                                                00099000
.*-------------------------------------------------------------------   00099100
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00099200
&ZXMFATTR        SETC  'INPUT'     SET IN/OUTPUT                        00099300
&XMFATTR         SETC  '0D'                                             00099400
                 AIF   (K'&MF(3) LE 0).ZG27B    PARM                    00099500
&XMFATTR         SETC  '&MF(3,1)'  SET XVARIABLE                        00099600
                 AIF   (N'&MF(3) GT 1).ZG27B    MULTI                   00099700
&XMFATTR         SETC  '&MF(3)'    SET XVARIABLE                        00099800
.ZG27B           ANOP  ,                                                00099900
.*-------------------------------------------------------------------   00100000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00100100
                 AIF   (K'&ZXMFATTR LE 0).ZG27P  NOT I/O                00100200
                 AIF   ('&XMFATTR'(1,1) NE '(').ZG27P                   00100300
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00100400
&ZMS             SETC  '"MF='                                           00100500
&ZMS             SETC  '&ZMS.&MF"'                                      00100600
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00100700
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                00100800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00100900
.ZG27P           ANOP  ,                                                00101000
.*-------------------------------------------------------------------   00101100
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00101200
                 AIF   (K'&ZXMFATTR LE 0).ZG27S  NOT I/O                00101300
                 AIF   (K'&XMFATTR LE 60).ZG27S  LNG OK                 00101400
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00101500
&ZMS             SETC  '"MF='                                           00101600
&ZMS             SETC  '&ZMS.&MF"'                                      00101700
&ZMS             SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'            00101800
                 MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'               00101900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00102000
.ZG27S           ANOP  ,                                                00102100
.*-------------------------------------------------------------------   00102200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102300
.ZG29            ANOP  ,                                                00102400
&ZTLC            SETC 'M'                                               00102500
                 AIF   ('&MF(1)' NE '&ZTLC').ZG38                       00102600
&XMF             SETC  'M'         SET KEYWORD                          00102700
                 AIF   (N'&MF LE 3).ZG29A       CK NUM                  00102800
&ZMS             SETC  '"MF='                                           00102900
&ZMS             SETC  '&ZMS.&MF"'                                      00103000
&ZMS             SETC  '&ZMS "MF"'                                      00103100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00103200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00103300
.ZG29A           ANOP  ,                                                00103400
.*-------------------------------------------------------------------   00103500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00103600
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00103700
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00103800
                 AIF   (N'&MF(2) GT 1).ZG31B    MULTI                   00103900
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00104000
.ZG31B           AIF   (K'&MF(2) GT 0).ZG31C                            00104100
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00104200
&ZMS             SETC  'WHEN "M" IS SPECIFIED'                          00104300
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00104400
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00104500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00104600
.ZG31C           ANOP  ,                                                00104700
.*-------------------------------------------------------------------   00104800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00104900
                 AIF   (K'&ZXMFCTRL LE 0).ZG31R  NOT I/O                00105000
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG31R                   00105100
&ZCGPR           SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                       00105200
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                     00105300
                 AIF   (K'&ZCGPR GT 2).ZG31Q                            00105400
                 AIF   ('&ZCGPR' EQ '0').ZG31Q                          00105500
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00105600
                 AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME        00105700
.ZG31P           ANOP  ,                                                00105800
                 AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC             00105900
                 AIF   ('&ZCGPR' LT '1').ZG31Q                          00106000
                 AIF   ('&ZCGPR' LE '12').ZG31R                         00106100
.ZG31Q           ANOP  ,                                                00106200
&ZMS             SETC  '"MF='                                           00106300
&ZMS             SETC  '&ZMS.&MF"'                                      00106400
&ZMS             SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'        00106500
                 MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                 00106600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00106700
.ZG31R           ANOP  ,                                                00106800
.*-------------------------------------------------------------------   00106900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00107000
&XMFSCK          SETC  ''          INITIALIZE XVARIABLE                 00107100
.ZG35A   AIF   ('&MF(3)' NE 'COMPLETE').ZG36A                           00107200
&XMFSCK          SETC  'COMPLETE'  SET KEYWORD                          00107300
.*-------------------------------------------------------------------   00107400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00107500
.ZG36A   AIF   ('&MF(3)' NE 'NOCHECK').ZG37A                            00107600
&XMFSCK          SETC  'NOCHECK'   SET KEYWORD                          00107700
.*-------------------------------------------------------------------   00107800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00107900
.ZG37A           AIF   (K'&XMFSCK GT 0).ZG37C   KEYWORD                 00108000
                 AIF   (K'&MF(3) LE 0).ZG37B                            00108100
&ZMS             SETC  '"MF='                                           00108200
&ZMS             SETC  '&ZMS.&MF"'                                      00108300
&ZMS             SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '        00108400
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00108500
&ZMS             SETC  '&ZMS "COMPLETE"'                                00108600
&ZMS             SETC  '&ZMS OR "NOCHECK".'                             00108700
                 MNOTE 8,' &ZMS '                                       00108800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00108900
.ZG37B           ANOP  ,                                                00109000
&XMFSCK          SETC  'COMPLETE'  SET DEFAULT KEYWORD                  00109100
.ZG37C           ANOP  ,                                                00109200
&ZXMFSCK         SETC  'INPUT'     SET IN/OUTPUT                        00109300
.*-------------------------------------------------------------------   00109400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109500
.ZG38            ANOP  ,                                                00109600
&ZTLC            SETC 'E'                                               00109700
                 AIF   ('&MF(1)' NE '&ZTLC').ZG47                       00109800
&XMF             SETC  'E'         SET KEYWORD                          00109900
                 AIF   (N'&MF LE 3).ZG38A       CK NUM                  00110000
&ZMS             SETC  '"MF='                                           00110100
&ZMS             SETC  '&ZMS.&MF"'                                      00110200
&ZMS             SETC  '&ZMS "MF"'                                      00110300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00110400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00110500
.ZG38A           ANOP  ,                                                00110600
.*-------------------------------------------------------------------   00110700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00110800
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00110900
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00111000
                 AIF   (N'&MF(2) GT 1).ZG40B    MULTI                   00111100
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00111200
.ZG40B           AIF   (K'&MF(2) GT 0).ZG40C                            00111300
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00111400
&ZMS             SETC  'WHEN "E" IS SPECIFIED'                          00111500
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00111600
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00111700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00111800
.ZG40C           ANOP  ,                                                00111900
.*-------------------------------------------------------------------   00112000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00112100
                 AIF   (K'&ZXMFCTRL LE 0).ZG40R  NOT I/O                00112200
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG40R                   00112300
&ZCGPR           SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                       00112400
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                     00112500
                 AIF   (K'&ZCGPR GT 2).ZG40Q                            00112600
                 AIF   ('&ZCGPR' EQ '0').ZG40Q                          00112700
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00112800
                 AIF   (T'&ZCGPR NE 'N').ZG40Q  INVALID REG NAME        00112900
.ZG40P           ANOP  ,                                                00113000
                 AIF   (T'&ZCGPR NE 'N').ZG40R  NON NUMERIC             00113100
                 AIF   ('&ZCGPR' LT '1').ZG40Q                          00113200
                 AIF   ('&ZCGPR' LE '12').ZG40R                         00113300
.ZG40Q           ANOP  ,                                                00113400
&ZMS             SETC  '"MF='                                           00113500
&ZMS             SETC  '&ZMS.&MF"'                                      00113600
&ZMS             SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'        00113700
                 MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                 00113800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00113900
.ZG40R           ANOP  ,                                                00114000
.*-------------------------------------------------------------------   00114100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00114200
&XMFSCK          SETC  ''          INITIALIZE XVARIABLE                 00114300
.ZG44A   AIF   ('&MF(3)' NE 'COMPLETE').ZG45A                           00114400
&XMFSCK          SETC  'COMPLETE'  SET KEYWORD                          00114500
.*-------------------------------------------------------------------   00114600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00114700
.ZG45A   AIF   ('&MF(3)' NE 'NOCHECK').ZG46A                            00114800
&XMFSCK          SETC  'NOCHECK'   SET KEYWORD                          00114900
.*-------------------------------------------------------------------   00115000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00115100
.ZG46A           AIF   (K'&XMFSCK GT 0).ZG46C   KEYWORD                 00115200
                 AIF   (K'&MF(3) LE 0).ZG46B                            00115300
&ZMS             SETC  '"MF='                                           00115400
&ZMS             SETC  '&ZMS.&MF"'                                      00115500
&ZMS             SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '        00115600
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00115700
&ZMS             SETC  '&ZMS "COMPLETE"'                                00115800
&ZMS             SETC  '&ZMS OR "NOCHECK".'                             00115900
                 MNOTE 8,' &ZMS '                                       00116000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00116100
.ZG46B           ANOP  ,                                                00116200
&XMFSCK          SETC  'COMPLETE'  SET DEFAULT KEYWORD                  00116300
.ZG46C           ANOP  ,                                                00116400
&ZXMFSCK         SETC  'INPUT'     SET IN/OUTPUT                        00116500
.*------------------------------------------------------------------    00116600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116700
.ZG47            ANOP  ,                                                00116800
&ZXMF            SETC  'INPUT'     SET IN/OUTPUT                        00116900
                 AIF   (K'&XMF GT 0).ZG47E      VALID ARG               00117000
                 AIF   (T'&MF EQ 'O').ZG47D     OMITTED                 00117100
&ZASYSLNDX       SETA  0                                                00117200
.ZG47A           ANOP  ,           POSITIONAL MACRO KEY                 00117300
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00117400
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG47C                 00117500
&ZTLC            SETC 'MF'                                              00117600
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG47A        00117700
.ZG47B           ANOP  ,                                                00117800
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00117900
&ZMS             SETC  'THE "MF" KEY'                                   00118000
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00118100
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00118200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00118300
                 AGO   .ZG47E                                           00118400
.ZG47C           ANOP  ,                                                00118500
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00118600
&ZMS             SETC  '"MF='                                           00118700
&ZMS             SETC  '&ZMS.&MF"'                                      00118800
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00118900
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00119000
&ZMS             SETC  '&ZMS "S",'                                      00119100
&ZMS             SETC  '&ZMS "L",'                                      00119200
&ZMS             SETC  '&ZMS "M",'                                      00119300
&ZMS             SETC  '&ZMS OR "E".'                                   00119400
                 MNOTE 8,' &ZMS '                                       00119500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00119600
                 AGO   .ZG47E                                           00119700
.ZG47D           ANOP  ,                                                00119800
&XMF             SETC  'S'         SET DEFAULT KEYWORD                  00119900
&XMFSCK          SETC  'COMPLETE'  COMPLETE CHECKING                    00120000
.ZG47E           ANOP  ,                                                00120100
.********************************************************************   00120200
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00120300
.********************************************************************   00120400
                 ACTR  10000                                            00120500
.*-------------------------------------------------------------------   00120600
.***AG.MF03 MF=(SLME)                                                   00120700
                 AIF   ('&XMF' EQ 'L').ZGMFX                            00120800
                 AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                  00120900
.*----------------------------------------------------------------***   00121000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00121100
                 AIF   (N'&STREAMTOKEN LE 1).ZG2A  CK NUM               00121200
&ZMS             SETC  '"STREAMTOKEN='                                  00121300
&ZMS             SETC  '&ZMS.&STREAMTOKEN"'                             00121400
&ZMS             SETC  '&ZMS "STREAMTOKEN"'                             00121500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00121600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00121700
.ZG2A            ANOP  ,                                                00121800
.*-------------------------------------------------------------------   00121900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00122000
&ZXSTREAMTOKEN   SETC  'INPUT'     SET IN/OUTPUT                        00122100
&XSTREAMTOKEN    SETC  '&STREAMTOKEN(1)'        SET XVARIABLE           00122200
                 AIF   (N'&STREAMTOKEN GT 1).ZG2B  MULTI                00122300
&XSTREAMTOKEN    SETC  '&STREAMTOKEN'           SET XVARIABLE           00122400
.ZG2B            AIF   (K'&STREAMTOKEN(1) GT 0).ZG2C                    00122500
&ZXSTREAMTOKEN   SETC  ''          RESET IN/OUTPUT                      00122600
&ZMS             SETC  ' '                                              00122700
&ZMS             SETC  '&ZMS "STREAMTOKEN" KEY AND ITS'                 00122800
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00122900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00123000
.ZG2C            ANOP  ,                                                00123100
.*-------------------------------------------------------------------   00123200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00123300
                 AIF   (K'&ZXSTREAMTOKEN LE 0).ZG2R  NOT I/O            00123400
                 AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZG2R               00123500
&ZCGPR           SETC  '&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2)             00123600
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                      00123700
                 AIF   (K'&ZCGPR GT 2).ZG2Q                             00123800
                 AIF   ('&ZCGPR' EQ '0').ZG2Q                           00123900
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00124000
                 AIF   (T'&ZCGPR NE 'N').ZG2Q   INVALID REG NAME        00124100
.ZG2P            ANOP  ,                                                00124200
                 AIF   (T'&ZCGPR NE 'N').ZG2R   NON NUMERIC             00124300
                 AIF   ('&ZCGPR' LT '2').ZG2Q                           00124400
                 AIF   ('&ZCGPR' LE '12').ZG2R                          00124500
.ZG2Q            ANOP  ,                                                00124600
&ZMS             SETC  '"STREAMTOKEN='                                  00124700
&ZMS             SETC  '&ZMS.&STREAMTOKEN"'                             00124800
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00124900
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00125000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00125100
.ZG2R            ANOP  ,                                                00125200
.*----------------------------------------------------------------***   00125300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00125400
                 AIF   (N'&ANSAREA LE 1).ZG5A   CK NUM                  00125500
&ZMS             SETC  '"ANSAREA='                                      00125600
&ZMS             SETC  '&ZMS.&ANSAREA"'                                 00125700
&ZMS             SETC  '&ZMS "ANSAREA"'                                 00125800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00125900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00126000
.ZG5A            ANOP  ,                                                00126100
.*-------------------------------------------------------------------   00126200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00126300
&ZXANSAREA       SETC  'INPUT'     SET IN/OUTPUT                        00126400
&XANSAREA        SETC  '&ANSAREA(1)'            SET XVARIABLE           00126500
                 AIF   (N'&ANSAREA GT 1).ZG5B   MULTI                   00126600
&XANSAREA        SETC  '&ANSAREA'  SET XVARIABLE                        00126700
.ZG5B            AIF   (K'&ANSAREA(1) GT 0).ZG5C                        00126800
&ZXANSAREA       SETC  ''          RESET IN/OUTPUT                      00126900
&ZMS             SETC  ' '                                              00127000
&ZMS             SETC  '&ZMS "ANSAREA" KEY AND ITS'                     00127100
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00127200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00127300
.ZG5C            ANOP  ,                                                00127400
.*-------------------------------------------------------------------   00127500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00127600
                 AIF   (K'&ZXANSAREA LE 0).ZG5R  NOT I/O                00127700
                 AIF   ('&XANSAREA'(1,1) NE '(').ZG5R                   00127800
&ZCGPR           SETC  '&XANSAREA'(2,K'&XANSAREA-2)                     00127900
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                      00128000
                 AIF   (K'&ZCGPR GT 2).ZG5Q                             00128100
                 AIF   ('&ZCGPR' EQ '0').ZG5Q                           00128200
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00128300
                 AIF   (T'&ZCGPR NE 'N').ZG5Q   INVALID REG NAME        00128400
.ZG5P            ANOP  ,                                                00128500
                 AIF   (T'&ZCGPR NE 'N').ZG5R   NON NUMERIC             00128600
                 AIF   ('&ZCGPR' LT '2').ZG5Q                           00128700
                 AIF   ('&ZCGPR' LE '12').ZG5R                          00128800
.ZG5Q            ANOP  ,                                                00128900
&ZMS             SETC  '"ANSAREA='                                      00129000
&ZMS             SETC  '&ZMS.&ANSAREA"'                                 00129100
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00129200
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00129300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00129400
.ZG5R            ANOP  ,                                                00129500
.*----------------------------------------------------------------***   00129600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00129700
                 AIF   (N'&ANSLEN LE 1).ZG8A    CK NUM                  00129800
&ZMS             SETC  '"ANSLEN='                                       00129900
&ZMS             SETC  '&ZMS.&ANSLEN"'                                  00130000
&ZMS             SETC  '&ZMS "ANSLEN"'                                  00130100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00130200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00130300
.ZG8A            ANOP  ,                                                00130400
.*-------------------------------------------------------------------   00130500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00130600
&ZXANSLEN        SETC  'INPUT'     SET IN/OUTPUT                        00130700
&XANSLEN         SETC  '&ANSLEN(1)'             SET XVARIABLE           00130800
                 AIF   (N'&ANSLEN GT 1).ZG8B    MULTI                   00130900
&XANSLEN         SETC  '&ANSLEN'   SET XVARIABLE                        00131000
.ZG8B            AIF   (K'&ANSLEN(1) GT 0).ZG8C                         00131100
&ZXANSLEN        SETC  ''          RESET IN/OUTPUT                      00131200
&ZMS             SETC  ' '                                              00131300
&ZMS             SETC  '&ZMS "ANSLEN" KEY AND ITS'                      00131400
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00131500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00131600
.ZG8C            ANOP  ,                                                00131700
.*-------------------------------------------------------------------   00131800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00131900
                 AIF   (K'&ZXANSLEN LE 0).ZG8R  NOT I/O                 00132000
                 AIF   ('&XANSLEN'(1,1) NE '(').ZG8R                    00132100
&ZCGPR           SETC  '&XANSLEN'(2,K'&XANSLEN-2)                       00132200
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                      00132300
                 AIF   (K'&ZCGPR GT 2).ZG8Q                             00132400
                 AIF   ('&ZCGPR' EQ '0').ZG8Q                           00132500
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00132600
                 AIF   (T'&ZCGPR NE 'N').ZG8Q   INVALID REG NAME        00132700
.ZG8P            ANOP  ,                                                00132800
                 AIF   (T'&ZCGPR NE 'N').ZG8R   NON NUMERIC             00132900
                 AIF   ('&ZCGPR' LT '2').ZG8Q                           00133000
                 AIF   ('&ZCGPR' LE '12').ZG8R                          00133100
.ZG8Q            ANOP  ,                                                00133200
&ZMS             SETC  '"ANSLEN='                                       00133300
&ZMS             SETC  '&ZMS.&ANSLEN"'                                  00133400
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00133500
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00133600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00133700
.ZG8R            ANOP  ,                                                00133800
.*----------------------------------------------------------------***   00133900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00134000
                 AIF   (N'&RETCODE LE 1).ZG11A  CK NUM                  00134100
&ZMS             SETC  '"RETCODE='                                      00134200
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00134300
&ZMS             SETC  '&ZMS "RETCODE"'                                 00134400
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00134500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00134600
.ZG11A           ANOP  ,                                                00134700
.*-------------------------------------------------------------------   00134800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00134900
                 AIF   (K'&RETCODE(1) LE 0).ZG11C  NO PARM              00135000
&ZXRETCODE       SETC  'OUTPUT'    SET OUTPUT                           00135100
&XRETCODE        SETC  '&RETCODE(1)'            SET XVARIABLE           00135200
                 AIF   (N'&RETCODE GT 1).ZG11C                          00135300
&XRETCODE        SETC  '&RETCODE'  SET XVARIABLE                        00135400
.ZG11C           ANOP  ,                                                00135500
.*-------------------------------------------------------------------   00135600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00135700
                 AIF   (K'&ZXRETCODE LE 0).ZG11R  NOT I/O               00135800
                 AIF   ('&XRETCODE'(1,1) NE '(').ZG11R                  00135900
&ZCGPR           SETC  '&XRETCODE'(2,K'&XRETCODE-2)                     00136000
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                     00136100
                 AIF   (K'&ZCGPR GT 2).ZG11Q                            00136200
                 AIF   ('&ZCGPR' EQ '0').ZG11Q                          00136300
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00136400
                 AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME        00136500
.ZG11P           ANOP  ,                                                00136600
                 AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC             00136700
                 AIF   ('&ZCGPR' EQ '15').ZG11R                         00136800
                 AIF   ('&ZCGPR' LT '2').ZG11Q                          00136900
                 AIF   ('&ZCGPR' LE '12').ZG11R                         00137000
.ZG11Q           ANOP  ,                                                00137100
&ZMS             SETC  '"RETCODE='                                      00137200
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00137300
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00137400
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'         00137500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00137600
.ZG11R           ANOP  ,                                                00137700
.*----------------------------------------------------------------***   00137800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00137900
                 AIF   (N'&RSNCODE LE 1).ZG14A  CK NUM                  00138000
&ZMS             SETC  '"RSNCODE='                                      00138100
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00138200
&ZMS             SETC  '&ZMS "RSNCODE"'                                 00138300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00138400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00138500
.ZG14A           ANOP  ,                                                00138600
.*-------------------------------------------------------------------   00138700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00138800
                 AIF   (K'&RSNCODE(1) LE 0).ZG14C  NO PARM              00138900
&ZXRSNCODE       SETC  'OUTPUT'    SET OUTPUT                           00139000
&XRSNCODE        SETC  '&RSNCODE(1)'            SET XVARIABLE           00139100
                 AIF   (N'&RSNCODE GT 1).ZG14C                          00139200
&XRSNCODE        SETC  '&RSNCODE'  SET XVARIABLE                        00139300
.ZG14C           ANOP  ,                                                00139400
.*-------------------------------------------------------------------   00139500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00139600
                 AIF   (K'&ZXRSNCODE LE 0).ZG14R  NOT I/O               00139700
                 AIF   ('&XRSNCODE'(1,1) NE '(').ZG14R                  00139800
&ZCGPR           SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                     00139900
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                     00140000
                 AIF   (K'&ZCGPR GT 2).ZG14Q                            00140100
                 AIF   ('&ZCGPR' EQ '0').ZG14R                          00140200
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00140300
                 AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME        00140400
.ZG14P           ANOP  ,                                                00140500
                 AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC             00140600
                 AIF   ('&ZCGPR' EQ '0').ZG14R                          00140700
                 AIF   ('&ZCGPR' LT '2').ZG14Q                          00140800
                 AIF   ('&ZCGPR' LE '12').ZG14R                         00140900
.ZG14Q           ANOP  ,                                                00141000
&ZMS             SETC  '"RSNCODE='                                      00141100
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00141200
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00141300
                 MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'          00141400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00141500
.ZG14R           ANOP  ,                                                00141600
.******************************************************************     00141700
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00141800
.******************************************************************     00141900
                 ACTR  10000                                            00142000
.*----------------------------------------------------------------***   00142100
.***AH.P02 EXTRA POSITIONALS                                            00142200
                 AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS             00142300
                 AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL             00142400
                 AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL         00142500
                 AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL          00142600
.ZGLISTX1        ANOP  ,                                                00142700
&ZCVAL           SETC  ''          ERROR FIELD                          00142800
&ZAWRK           SETA  0           POSITIONAL NUMBER                    00142900
.ZGLIST2         ANOP  ,                                                00143000
&ZAWRK           SETA  &ZAWRK+1    NEXT POSITIONAL                      00143100
                 AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE             00143200
&ZCVAL           SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                  00143300
                 AGO   .ZGLIST2                                         00143400
.*                                                                      00143500
.ZGLIST3         ANOP  ,                                                00143600
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)    STRIP COMMA             00143700
&ZMS             SETC  'POSITIONAL ARGUMENT(S),'                        00143800
&ZMS             SETC  '&ZMS "&ZCVAL"'                                  00143900
&ZMS             SETC  '&ZMS CANNOT BE USED.'                           00144000
&ZMS             SETC  '&ZMS NO POSITIONAL ARGUMENTS'                   00144100
                 MNOTE 8,' &ZMS ARE ALLOWED.'                           00144200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00144300
.ZGLISTX         ANOP  ,                                                00144400
&ZASYSLNDX       SETA  0                                                00144500
.*-------------------------------------------------------------------   00144600
.***AG.MF04 MF=(SLME)                                                   00144700
.ZGMFX           ANOP  ,           END OF FULL SYNTAX CHECK             00144800
.********************************************************************   00144900
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00145000
.********************************************************************   00145100
                 ACTR  10000                                            00145200
.*-------------------------------------------------------------------   00145300
.***AE.MF01 MF=(SLME)                                                   00145400
                 AIF   ('&XMF' EQ 'L').ZEMFX                            00145500
                 AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                   00145600
.********************************************************************   00145700
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00145800
.********************************************************************   00145900
.*----------------------------------------------------------------***   00146000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00146100
                 AIF   (N'&STREAMTOKEN LE 1).ZE2A  CK NUM               00146200
&ZMS             SETC  '"STREAMTOKEN='                                  00146300
&ZMS             SETC  '&ZMS.&STREAMTOKEN"'                             00146400
&ZMS             SETC  '&ZMS "STREAMTOKEN"'                             00146500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00146600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00146700
.ZE2A            ANOP  ,                                                00146800
.*-------------------------------------------------------------------   00146900
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00147000
                 AIF   (K'&STREAMTOKEN(1) LE 0).ZE2B NO PRM             00147100
&ZXSTREAMTOKEN   SETC  'INPUT'     SET IN/OUTPUT                        00147200
&XSTREAMTOKEN    SETC  '&STREAMTOKEN(1)'        SET XVARIABLE           00147300
                 AIF   (N'&STREAMTOKEN GT 1).ZE2B                       00147400
.*               ANOP                                                   00147500
&XSTREAMTOKEN    SETC  '&STREAMTOKEN'           SET XVARIABLE           00147600
.ZE2B            ANOP  ,                                                00147700
.*-------------------------------------------------------------------   00147800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00147900
                 AIF   (K'&ZXSTREAMTOKEN LE 0).ZE2R  NOT I/O            00148000
                 AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZE2R               00148100
&ZCGPR           SETC  '&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2)             00148200
                 AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                      00148300
                 AIF   (K'&ZCGPR GT 2).ZE2Q                             00148400
                 AIF   ('&ZCGPR' EQ '0').ZE2Q                           00148500
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00148600
                 AIF   (T'&ZCGPR NE 'N').ZE2Q   INVALID REG NAME        00148700
.ZE2P            ANOP  ,                                                00148800
                 AIF   (T'&ZCGPR NE 'N').ZE2R   NON NUMERIC             00148900
                 AIF   ('&ZCGPR' LT '2').ZE2Q                           00149000
                 AIF   ('&ZCGPR' LE '12').ZE2R                          00149100
.ZE2Q            ANOP  ,                                                00149200
&ZMS             SETC  '"STREAMTOKEN='                                  00149300
&ZMS             SETC  '&ZMS.&STREAMTOKEN"'                             00149400
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00149500
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00149600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00149700
.ZE2R            ANOP  ,                                                00149800
.*----------------------------------------------------------------***   00149900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00150000
                 AIF   (N'&ANSAREA LE 1).ZE5A   CK NUM                  00150100
&ZMS             SETC  '"ANSAREA='                                      00150200
&ZMS             SETC  '&ZMS.&ANSAREA"'                                 00150300
&ZMS             SETC  '&ZMS "ANSAREA"'                                 00150400
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00150500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00150600
.ZE5A            ANOP  ,                                                00150700
.*-------------------------------------------------------------------   00150800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00150900
                 AIF   (K'&ANSAREA(1) LE 0).ZE5B NO PRM                 00151000
&ZXANSAREA       SETC  'INPUT'     SET IN/OUTPUT                        00151100
&XANSAREA        SETC  '&ANSAREA(1)'            SET XVARIABLE           00151200
                 AIF   (N'&ANSAREA GT 1).ZE5B                           00151300
.*               ANOP                                                   00151400
&XANSAREA        SETC  '&ANSAREA'  SET XVARIABLE                        00151500
.ZE5B            ANOP  ,                                                00151600
.*-------------------------------------------------------------------   00151700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00151800
                 AIF   (K'&ZXANSAREA LE 0).ZE5R  NOT I/O                00151900
                 AIF   ('&XANSAREA'(1,1) NE '(').ZE5R                   00152000
&ZCGPR           SETC  '&XANSAREA'(2,K'&XANSAREA-2)                     00152100
                 AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                      00152200
                 AIF   (K'&ZCGPR GT 2).ZE5Q                             00152300
                 AIF   ('&ZCGPR' EQ '0').ZE5Q                           00152400
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00152500
                 AIF   (T'&ZCGPR NE 'N').ZE5Q   INVALID REG NAME        00152600
.ZE5P            ANOP  ,                                                00152700
                 AIF   (T'&ZCGPR NE 'N').ZE5R   NON NUMERIC             00152800
                 AIF   ('&ZCGPR' LT '2').ZE5Q                           00152900
                 AIF   ('&ZCGPR' LE '12').ZE5R                          00153000
.ZE5Q            ANOP  ,                                                00153100
&ZMS             SETC  '"ANSAREA='                                      00153200
&ZMS             SETC  '&ZMS.&ANSAREA"'                                 00153300
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00153400
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00153500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00153600
.ZE5R            ANOP  ,                                                00153700
.*----------------------------------------------------------------***   00153800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00153900
                 AIF   (N'&ANSLEN LE 1).ZE8A    CK NUM                  00154000
&ZMS             SETC  '"ANSLEN='                                       00154100
&ZMS             SETC  '&ZMS.&ANSLEN"'                                  00154200
&ZMS             SETC  '&ZMS "ANSLEN"'                                  00154300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00154400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00154500
.ZE8A            ANOP  ,                                                00154600
.*-------------------------------------------------------------------   00154700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00154800
                 AIF   (K'&ANSLEN(1) LE 0).ZE8B NO PRM                  00154900
&ZXANSLEN        SETC  'INPUT'     SET IN/OUTPUT                        00155000
&XANSLEN         SETC  '&ANSLEN(1)'             SET XVARIABLE           00155100
                 AIF   (N'&ANSLEN GT 1).ZE8B                            00155200
.*               ANOP                                                   00155300
&XANSLEN         SETC  '&ANSLEN'   SET XVARIABLE                        00155400
.ZE8B            ANOP  ,                                                00155500
.*-------------------------------------------------------------------   00155600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00155700
                 AIF   (K'&ZXANSLEN LE 0).ZE8R  NOT I/O                 00155800
                 AIF   ('&XANSLEN'(1,1) NE '(').ZE8R                    00155900
&ZCGPR           SETC  '&XANSLEN'(2,K'&XANSLEN-2)                       00156000
                 AIF   ('&ZCGPR'(1,1) NE '0').ZE8P                      00156100
                 AIF   (K'&ZCGPR GT 2).ZE8Q                             00156200
                 AIF   ('&ZCGPR' EQ '0').ZE8Q                           00156300
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00156400
                 AIF   (T'&ZCGPR NE 'N').ZE8Q   INVALID REG NAME        00156500
.ZE8P            ANOP  ,                                                00156600
                 AIF   (T'&ZCGPR NE 'N').ZE8R   NON NUMERIC             00156700
                 AIF   ('&ZCGPR' LT '2').ZE8Q                           00156800
                 AIF   ('&ZCGPR' LE '12').ZE8R                          00156900
.ZE8Q            ANOP  ,                                                00157000
&ZMS             SETC  '"ANSLEN='                                       00157100
&ZMS             SETC  '&ZMS.&ANSLEN"'                                  00157200
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00157300
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00157400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00157500
.ZE8R            ANOP  ,                                                00157600
.*----------------------------------------------------------------***   00157700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00157800
                 AIF   (N'&RETCODE LE 1).ZE11A  CK NUM                  00157900
&ZMS             SETC  '"RETCODE='                                      00158000
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00158100
&ZMS             SETC  '&ZMS "RETCODE"'                                 00158200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00158300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00158400
.ZE11A           ANOP  ,                                                00158500
.*-------------------------------------------------------------------   00158600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00158700
                 AIF   (K'&RETCODE(1) LE 0).ZE11B NO PRM                00158800
&ZXRETCODE       SETC  'OUTPUT'    SET IN/OUTPUT                        00158900
&XRETCODE        SETC  '&RETCODE(1)'            SET XVARIABLE           00159000
                 AIF   (N'&RETCODE GT 1).ZE11B                          00159100
.*               ANOP                                                   00159200
&XRETCODE        SETC  '&RETCODE'  SET XVARIABLE                        00159300
.ZE11B           ANOP  ,                                                00159400
.*-------------------------------------------------------------------   00159500
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00159600
                 AIF   (K'&ZXRETCODE LE 0).ZE11R  NOT I/O               00159700
                 AIF   ('&XRETCODE'(1,1) NE '(').ZE11R                  00159800
&ZCGPR           SETC  '&XRETCODE'(2,K'&XRETCODE-2)                     00159900
                 AIF   ('&ZCGPR'(1,1) NE '0').ZE11P                     00160000
                 AIF   (K'&ZCGPR GT 2).ZE11Q                            00160100
                 AIF   ('&ZCGPR' EQ '0').ZE11Q                          00160200
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00160300
                 AIF   (T'&ZCGPR NE 'N').ZE11Q  INVALID REG NAME        00160400
.ZE11P           ANOP  ,                                                00160500
                 AIF   (T'&ZCGPR NE 'N').ZE11R  NON NUMERIC             00160600
                 AIF   ('&ZCGPR' LT '2').ZE11Q                          00160700
                 AIF   ('&ZCGPR' LE '12').ZE11R                         00160800
.ZE11Q           ANOP  ,                                                00160900
&ZMS             SETC  '"RETCODE='                                      00161000
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00161100
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00161200
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00161300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00161400
.ZE11R           ANOP  ,                                                00161500
.*----------------------------------------------------------------***   00161600
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00161700
                 AIF   (N'&RSNCODE LE 1).ZE14A  CK NUM                  00161800
&ZMS             SETC  '"RSNCODE='                                      00161900
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00162000
&ZMS             SETC  '&ZMS "RSNCODE"'                                 00162100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00162200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00162300
.ZE14A           ANOP  ,                                                00162400
.*-------------------------------------------------------------------   00162500
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00162600
                 AIF   (K'&RSNCODE(1) LE 0).ZE14B NO PRM                00162700
&ZXRSNCODE       SETC  'OUTPUT'    SET IN/OUTPUT                        00162800
&XRSNCODE        SETC  '&RSNCODE(1)'            SET XVARIABLE           00162900
                 AIF   (N'&RSNCODE GT 1).ZE14B                          00163000
.*               ANOP                                                   00163100
&XRSNCODE        SETC  '&RSNCODE'  SET XVARIABLE                        00163200
.ZE14B           ANOP  ,                                                00163300
.*-------------------------------------------------------------------   00163400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00163500
                 AIF   (K'&ZXRSNCODE LE 0).ZE14R  NOT I/O               00163600
                 AIF   ('&XRSNCODE'(1,1) NE '(').ZE14R                  00163700
&ZCGPR           SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                     00163800
                 AIF   ('&ZCGPR'(1,1) NE '0').ZE14P                     00163900
                 AIF   (K'&ZCGPR GT 2).ZE14Q                            00164000
                 AIF   ('&ZCGPR' EQ '0').ZE14Q                          00164100
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00164200
                 AIF   (T'&ZCGPR NE 'N').ZE14Q  INVALID REG NAME        00164300
.ZE14P           ANOP  ,                                                00164400
                 AIF   (T'&ZCGPR NE 'N').ZE14R  NON NUMERIC             00164500
                 AIF   ('&ZCGPR' LT '2').ZE14Q                          00164600
                 AIF   ('&ZCGPR' LE '12').ZE14R                         00164700
.ZE14Q           ANOP  ,                                                00164800
&ZMS             SETC  '"RSNCODE='                                      00164900
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00165000
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00165100
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00165200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00165300
.ZE14R           ANOP  ,                                                00165400
.******************************************************************     00165500
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00165600
.******************************************************************     00165700
                 ACTR  10000                                            00165800
.*----------------------------------------------------------------***   00165900
.***AF.P02 EXTRA POSITIONALS                                            00166000
                 AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS             00166100
&ZCVAL           SETC  ''          ERROR FIELD                          00166200
&ZAWRK           SETA  0           POSITIONAL NUMBER                    00166300
.ZELIST2         ANOP  ,                                                00166400
&ZAWRK           SETA  &ZAWRK+1    NEXT POSITIONAL                      00166500
                 AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE             00166600
&ZCVAL           SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                  00166700
                 AGO   .ZELIST2                                         00166800
.*                                                                      00166900
.ZELIST3         ANOP  ,                                                00167000
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)    STRIP COMMA             00167100
&ZMS             SETC  'POSITIONAL ARGUMENT(S),'                        00167200
&ZMS             SETC  '&ZMS "&ZCVAL"'                                  00167300
&ZMS             SETC  '&ZMS CANNOT BE USED.'                           00167400
&ZMS             SETC  '&ZMS NO POSITIONAL ARGUMENTS'                   00167500
                 MNOTE 8,' &ZMS ARE ALLOWED.'                           00167600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00167700
.ZELISTX         ANOP  ,                                                00167800
&ZASYSLNDX       SETA  0                                                00167900
.*-------------------------------------------------------------------   00168000
.***AE.MF02 MF=(SLME)                                                   00168100
.ZEMFX           ANOP  ,           END OF PARTIAL SYNTAX CHECK          00168200
.*******************************************************************    00168300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00168400
.*******************************************************************    00168500
                 AIF   (&ZMACRET NE 0).ZLX2     ERROR DETECTED          00168600
.*******************************************************************    00168700
.***AE.01  START OF IXGOFFLD MACRO CODE                                 00168800
.*******************************************************************    00168900
                 LCLC  &M0M0001                 NAME                    00169000
&M0M0001         SETC  '&XLABEL'                SET NAME                00169100
                 AIF   (K'&XLABEL NE 0).XLAB2                           00169200
&M0M0001         SETC  'M00M&SYSNDX'            DEFAULT NAME            00169300
.*                                                                      00169400
.XLAB2           ANOP  ,                                                00169500
                 AIF   ('&XMF' EQ 'L').XLAB3                            00169600
&M0M0001 DS    0H                             IXGOFFLD-0                00169700
.XLAB3           ANOP  ,                                                00169800
.*******************************************************************    00169900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00170000
.*******************************************************************    00170100
              PUSH  PRINT                                               00170200
                 AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON       00170300
                 PRINT OFF         ++ PR01                              00170400
                 AGO   .ZPRNTXX                                         00170500
.ZPRINTX         PRINT ON                                               00170600
.ZPRNTXX         ANOP  ,                                                00170700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00170800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00170900
.********************************************************************   00171000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00171100
.********************************************************************   00171200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00171300
                      LCLA  &ZOPN1         INVOCATION INDEX             00171400
                      LCLC  &ZOPL(4095)    LABEL                        00171500
                      LCLC  &ZOPO(4095)    OPERATION                    00171600
                      LCLC  &ZOPV(4095)    VALUE                        00171700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00171800
.*                                                                      00171900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00172000
.******************************************************************     00172100
.***AL.L10 IXGOFFLD FMT=LIST MF=S!L PARAMETERS                          00172200
.******************************************************************     00172300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00172400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00172500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00172600
&XMFATTR              SETC  '0D'                                        00172700
.*                                                                      00172800
&ZOPN                 SETA  &ZOPN+1                                     00172900
&ZOPL(&ZOPN)          SETC  ' '                                         00173000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00173100
&ZOPO(&ZOPN)          SETC  'B'                                         00173200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00173300
                      AGO   .ZALVL6B                                    00173400
.ZALVL6A              ANOP                                              00173500
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00173600
&ZOPV(&ZOPN)          SETC  '4,8'                                       00173700
&ZOPN                 SETA  &ZOPN+1                                     00173800
&ZOPL(&ZOPN)          SETC  ' '                                         00173900
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00174000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00174100
.ZALVL6B              ANOP                                              00174200
&ZOPD(&ZOPN)          SETC  '++ IXGOFFLD ARG PARMS'                     00174300
.*                                                                      00174400
&ZOPN                 SETA  &ZOPN+1                                     00174500
&ZOPL(&ZOPN)          SETC  ' '                                         00174600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00174700
&ZOPV(&ZOPN)          SETC  '1'                                         00174800
&ZOPD(&ZOPN)          SETC  ' '                                         00174900
.*                                                                      00175000
.ZLMFSL2              ANOP  ,                                           00175100
.*-------------------------------------------------------------------   00175200
.***AM.L00  IXGOFFLD FMT=LIST name                                      00175300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00175400
&ZOPN                 SETA &ZOPN+1                                      00175500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00175600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00175700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00175800
&ZOPD(&ZOPN)          SETC '++ IXGOFFLD NAME'                           00175900
.ZLMFSL2M             ANOP  ,                                           00176000
.*-------------------------------------------------------------------   00176100
.***AM.L01  IXGOFFLD FMT=LIST PARAMETERS                                00176200
&ZOPN                 SETA &ZOPN+1                                      00176300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00176400
&ZOPO(&ZOPN)          SETC 'DS'                                         00176500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00176600
&ZOPD(&ZOPN)          SETC '++ IXGOFFLD PARM LIST'                      00176700
.*-------------------------------------------------------------------   00176800
.***AM.L02 XVERSION XL1                                                 00176900
&ZOPN                 SETA &ZOPN+1                                      00177000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00177100
&ZOPO(&ZOPN)          SETC 'DS'                                         00177200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00177300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00177400
.*-------------------------------------------------------------------   00177500
.***AM.L09  XRSV0001 CL3                                                00177600
&ZOPN                 SETA &ZOPN+1                                      00177700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00177800
&ZOPO(&ZOPN)          SETC 'DS'                                         00177900
&ZOPV(&ZOPN)          SETC 'CL3'                                        00178000
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00178100
.*-------------------------------------------------------------------   00178200
.***AM.L09  XPLISTPTR A                                                 00178300
&ZOPN                 SETA &ZOPN+1                                      00178400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTPTR'                        00178500
&ZOPO(&ZOPN)          SETC 'DS'                                         00178600
&ZOPV(&ZOPN)          SETC 'A'                                          00178700
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00178800
.*-------------------------------------------------------------------   00178900
.***AM.L09  XANSAREA A                                                  00179000
&ZOPN                 SETA &ZOPN+1                                      00179100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA'                         00179200
&ZOPO(&ZOPN)          SETC 'DS'                                         00179300
&ZOPV(&ZOPN)          SETC 'A'                                          00179400
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA '                             00179500
.*-------------------------------------------------------------------   00179600
.***AM.L09  XANSLEN F                                                   00179700
&ZOPN                 SETA &ZOPN+1                                      00179800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00179900
&ZOPO(&ZOPN)          SETC 'DS'                                         00180000
&ZOPV(&ZOPN)          SETC 'F'                                          00180100
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN '                              00180200
.*-------------------------------------------------------------------   00180300
.***AM.L09  XSTREAMTOKEN CL16                                           00180400
&ZOPN                 SETA &ZOPN+1                                      00180500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTREAMTOKEN'                     00180600
&ZOPO(&ZOPN)          SETC 'DS'                                         00180700
&ZOPV(&ZOPN)          SETC 'CL16'                                       00180800
&ZOPD(&ZOPN)          SETC '++ &ZXSTREAMTOKEN '                         00180900
.*-------------------------------------------------------------------   00181000
.***AM.L10 END OF IXGOFFLD LIST PARAMETERS                              00181100
&ZOPN                 SETA &ZOPN+1                                      00181200
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00181300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00181400
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00181500
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00181600
.*                                                                      00181700
&ZOPN                 SETA &ZOPN+1                                      00181800
&ZOPL(&ZOPN)          SETC ' '                                          00181900
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00182000
&ZOPV(&ZOPN)          SETC '1'                                          00182100
&ZOPD(&ZOPN)          SETC ' '                                          00182200
.*-------------------------------------------------------------------   00182300
.***AL.L12 IXGOFFLD FMT=LIST MF=S!L PARAMETERS                          00182400
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00182500
.*                                                                      00182600
&ZOPN                 SETA  &ZOPN+1                                     00182700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00182800
&ZOPO(&ZOPN)          SETC  'DC'                                        00182900
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00183000
&ZOPD(&ZOPN)          SETC  '++ IXGOFFLD ARG PARMS'                     00183100
.*                                                                      00183200
.ZLMFSLX              ANOP  ,                                           00183300
.*-------------------------------------------------------------------   00183400
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00183500
&ZPLLEN               SETA 32                                           00183600
.*                                                                      00183700
.******************************************************************     00183800
.***AI.L01 IXGOFFLD FMT=LIST FILL IN PARAMETER AREA                     00183900
.******************************************************************     00184000
                      ACTR  10000                                       00184100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00184200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00184300
&ZCVAL                SETC  'LAE'          XAX MODE                     00184400
.ZIMFXA               ANOP ,                                            00184500
.*                                                                      00184600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00184700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00184800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00184900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00185000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00185100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00185200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00185300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00185400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00185500
&ZOPN                 SETA  &ZOPN+1                                     00185600
&ZOPL(&ZOPN)          SETC  ' '                                         00185700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00185800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00185900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00186000
                      AGO   .ZIMFNX                                     00186100
.*                                                                      00186200
.ZIMFN2               ANOP ,                                            00186300
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00186400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00186500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00186600
&ZOPN                 SETA  &ZOPN+1                                     00186700
&ZOPL(&ZOPN)          SETC  ' '                                         00186800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00186900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00187000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00187100
                      AGO   .ZIMFNX                                     00187200
.ZIMFNX1              ANOP ,                                            00187300
&ZOPN                 SETA  &ZOPN+1                                     00187400
&ZOPL(&ZOPN)          SETC  ' '                                         00187500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00187600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00187700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00187800
.ZIMFNX               ANOP ,                                            00187900
.********************************************************************   00188000
.***AI.L02 IXGOFFLD FMT=LIST INITIALIZE PARAMETER AREA                  00188100
.********************************************************************   00188200
.***AI.L03 MF=(SLME)                                                    00188300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00188400
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00188500
.*                                                                      00188600
&ZOPN                 SETA  &ZOPN+1                                     00188700
&ZOPL(&ZOPN)          SETC  ' '                                         00188800
&ZOPO(&ZOPN)          SETC  'XC'                                        00188900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00189000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00189100
.ZIMFLX               ANOP  ,                                           00189200
.*-------------------------------------------------------------------   00189300
.***AI.L19  XANSAREA A                                                  00189400
                      AIF   ('&ZXANSAREA' EQ '').ZI4H                   00189500
&ZCLNG                SETC  '&XANSAREA'                                 00189600
&ZCGPR                SETC  '14'                                        00189700
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI4F  IN GPR                   00189800
.*                                                                      00189900
&ZOPN                 SETA  &ZOPN+1                                     00190000
&ZOPL(&ZOPN)          SETC  ' '                                         00190100
&ZOPO(&ZOPN)          SETC  'LA'                                        00190200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00190300
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00190400
.*                                                                      00190500
                      AGO   .ZI4G                                       00190600
.*                                                                      00190700
.ZI4F                 ANOP  ,                                           00190800
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00190900
.*                                                                      00191000
.ZI4G                 ANOP  ,                                           00191100
.*                                                                      00191200
&ZOPN                 SETA  &ZOPN+1                                     00191300
&ZOPL(&ZOPN)          SETC  ' '                                         00191400
&ZOPO(&ZOPN)          SETC  'ST'                                        00191500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00191600
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00191700
.*                                                                      00191800
.ZI4H                 ANOP  ,                                           00191900
.*-------------------------------------------------------------------   00192000
.***AI.L25  XANSLEN F                                                   00192100
                      AIF   ('&ZXANSLEN' EQ '').ZI5E                    00192200
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI5E              00192300
&ZCGPR                SETC  '&XANSLEN'                                  00192400
.*                                                                      00192500
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI5B               00192600
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00192700
                      AGO   .ZI5D                                       00192800
.ZI5B                 ANOP  ,                                           00192900
.*                                                                      00193000
&ZC                   SETC  '&XANSLEN'(1,1)                             00193100
                      AIF   (T'&ZC NE 'N').ZI5D                         00193200
&ZC                   SETC  '&XANSLEN'                                  00193300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                00193400
&ZCGPR                SETC  '=AL4(&XANSLEN)'                            00193500
.*                                                                      00193600
.ZI5D                 ANOP  ,                                           00193700
.*                                                                      00193800
&ZOPN                 SETA  &ZOPN+1                                     00193900
&ZOPL(&ZOPN)          SETC  ' '                                         00194000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00194100
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00194200
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00194300
.*                                                                      00194400
.ZI5E                 ANOP  ,                                           00194500
.*-------------------------------------------------------------------   00194600
.***AI.L25  XSTREAMTOKEN CL16                                           00194700
                      AIF   ('&ZXSTREAMTOKEN' EQ '').ZI6E               00194800
                      AIF   ('&ZXSTREAMTOKEN' EQ 'OUTPUT').ZI6E         00194900
&ZCGPR                SETC  '&XSTREAMTOKEN'                             00195000
.*                                                                      00195100
                      AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZI6B          00195200
&ZCGPR   SETC  '0('.'&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2).')'            00195300
.ZI6B                 ANOP  ,                                           00195400
.*                                                                      00195500
&ZOPN                 SETA  &ZOPN+1                                     00195600
&ZOPL(&ZOPN)          SETC  ' '                                         00195700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00195800
&ZOPV(&ZOPN)          SETC  '16(16,1),&ZCGPR'                           00195900
&ZOPD(&ZOPN)          SETC  '++ &ZXSTREAMTOKEN XSTREAMTOKEN'            00196000
.*                                                                      00196100
.ZI6E                 ANOP  ,                                           00196200
.*-------------------------------------------------------------------   00196300
.***AI.C01 RESTORE ADDR OF PARM LIST PTR                                00196400
.*                                                                      00196500
&ZOPN                 SETA  &ZOPN+1                                     00196600
&ZOPL(&ZOPN)          SETC  ' '                                         00196700
&ZOPO(&ZOPN)          SETC  'ST'                                        00196800
&ZOPV(&ZOPN)          SETC  '1,4(,1)'                                   00196900
&ZOPD(&ZOPN)          SETC  '++ STORE ADDR OF PARM LIST'                00197000
.*                                                                      00197100
&ZOPN                 SETA  &ZOPN+1                                     00197200
&ZOPL(&ZOPN)          SETC  ' '                                         00197300
&ZOPO(&ZOPN)          SETC  'LA'                                        00197400
&ZOPV(&ZOPN)          SETC  '1,4(,1)'                                   00197500
&ZOPD(&ZOPN)          SETC  '++ LOAD ADDR OF PARM LIST PTR INTO R1'     00197600
.*-------------------------------------------------------------------   00197700
&ZOPN1                SETA &ZOPN                                        00197800
.*-------------------------------------------------------------------   00197900
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00198000
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00198100
.*******************************************************************    00198200
.***  PROCESS IXGOFFLD OUTPUT PARAMETERS                                00198300
.*******************************************************************    00198400
                      ACTR  10000                                       00198500
.*******************************************************************    00198600
.***AO.X02  RETURN CODE PROCESSING                                      00198700
.*******************************************************************    00198800
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00198900
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00199000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00199100
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00199200
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00199300
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00199400
&ZOPN                 SETA  &ZOPN+1                                     00199500
&ZOPL(&ZOPN)          SETC  ' '                                         00199600
&ZOPO(&ZOPN)          SETC  'ST'                                        00199700
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00199800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00199900
                      AGO   .ZMRETX                                     00200000
.*                                                                      00200100
.ZMRET2               ANOP  ,                                           00200200
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00200300
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00200400
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00200500
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00200600
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00200700
&ZOPN                 SETA  &ZOPN+1                                     00200800
&ZOPL(&ZOPN)          SETC  ' '                                         00200900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00201000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00201100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00201200
.ZMRETX               ANOP  ,                                           00201300
.*******************************************************************    00201400
.***AO.X03  REASON CODE PROCESSING                                      00201500
.*******************************************************************    00201600
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00201700
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00201800
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00201900
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00202000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00202100
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00202200
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00202300
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00202400
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00202500
&ZOPN                 SETA  &ZOPN+1                                     00202600
&ZOPL(&ZOPN)          SETC  ' '                                         00202700
&ZOPO(&ZOPN)          SETC  'ST'                                        00202800
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00202900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00203000
                      AGO   .ZMRSNX                                     00203100
.*                                                                      00203200
.ZMRSN2               ANOP  ,                                           00203300
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00203400
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00203500
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00203600
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00203700
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00203800
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00203900
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00204000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00204100
&ZOPN                 SETA  &ZOPN+1                                     00204200
&ZOPL(&ZOPN)          SETC  ' '                                         00204300
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00204400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00204500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00204600
.ZMRSNX               ANOP  ,                                           00204700
.*******************************************************************    00204800
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00204900
.*******************************************************************    00205000
.ZMFLX                ANOP  ,              MF=L PROCESSING              00205100
.*******************************************************************    00205200
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00205300
.*******************************************************************    00205400
                      ACTR  10000                                       00205500
.*                                                                      00205600
                      LCLA  &ZLC           COLUMN POSITION              00205700
                      LCLA  &ZOPX          LIST TABLE INDEX             00205800
                      LCLC  &ZLL           LABEL                        00205900
                      LCLC  &ZLOP          OPERATION                    00206000
                      LCLC  &ZLV           VALUE                        00206100
                      LCLC  &ZLD           DESCRIPTION                  00206200
.*                                                                      00206300
&ZOPX                 SETA  1                                           00206400
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00206500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00206600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00206700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00206800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00206900
                      AIF   (K'&ZLD LE 0).ZL5                           00207000
&ZLC                  SETA  35             COMMENT COLUMN               00207100
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00207200
&ZLC                  SETA  33             COMMMENT COLUMN              00207300
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00207400
&ZLV                  SETC  '&ZLV'.' '                                  00207500
                      AGO   .ZL3                                        00207600
.*                                                                      00207700
.ZL4                  ANOP  ,                                           00207800
&ZLV                  SETC  '&ZLV'.' '                                  00207900
.ZL5                  ANOP  ,                                           00208000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00208100
.*                                                                      00208200
&ZLL     &ZLOP &ZLV                                                     00208300
.*                                                                      00208400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00208500
                      AGO   .ZL2           CONTINUE LOOPING             00208600
.*                                                                      00208700
.ZLX                  ANOP  ,                                           00208800
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00208900
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00209000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00209100
         AIF   ('&SYSASCE' EQ 'P').OFFPRIM  SYSSTATE PRIMARY            00209200
         SLR   15,15                SET GPR 15 TO ZERO                  00209300
         SAR   15,15                ENSURE AR 15 IS ZERO FOR PRIMARY    00209400
.OFFPRIM ANOP                                                           00209500
         AIF   ('&SYSAM64' EQ 'YES').OFFA64                             00209600
         L     15,16(0,0)           GET CVT ADDRESS                     00209700
         AGO   .OFFCONT                                                 00209800
.OFFA64  LLGT  15,16(0,0)           GET CVT Address                     00209900
.OFFCONT L     15,140(15,0)         GET ECVT ADDRESS                    00210000
         L     15,288(15,0)         GET LSAB ADDRESS                    00210100
         L     15,124(15,0)         GET ENTRY POINT ADDRESS             00210200
         LA    0,11                 EX OF OFFLOAD SERVICE               00210300
         BALR  14,15                INVOKE SERVICE ROUTINE              00210400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00210500
.ZLINKX               ANOP  ,                                           00210600
.*******************************************************************    00210700
.***AP.X01  FORMAT GENERATED CODE                                       00210800
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00210900
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00211000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00211100
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00211200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00211300
                      AIF   (K'&ZLD LE 0).ZL51                          00211400
&ZLC                  SETA  35             COMMENT COLUMN               00211500
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00211600
&ZLC                  SETA  33             COMMENT COLUMN               00211700
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00211800
&ZLV                  SETC  '&ZLV'.' '                                  00211900
                      AGO   .ZL31                                       00212000
.*                                                                      00212100
.ZL41                 ANOP  ,                                           00212200
&ZLV                  SETC  '&ZLV'.' '                                  00212300
.ZL51                 ANOP  ,                                           00212400
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00212500
.*                                                                      00212600
&ZLL     &ZLOP &ZLV                                                     00212700
.*                                                                      00212800
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00212900
                      AGO   .ZL21          CONTINUE LOOPING             00213000
.*                                                                      00213100
.ZLX1                 ANOP  ,                                           00213200
.*******************************************************************    00213300
.***AP.X02  END OF IXGOFFLD MACRO                                       00213400
&ZIXGOFFLD            SETC  'YES'          SET IXGOFFLD USED            00213500
         POP   PRINT                                                    00213600
*                                            IXGOFFLD-0                 00213700
         SPACE 1                                                        00213800
.ZLX2                 ANOP  ,                                           00213900
         MEND                                                           00214000
**********************************************************************/ 00214100
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00214200
*%IXGOFFLD: MACRO KEYS(STREAMTOKEN,ANSAREA,ANSLEN,RETCODE,RSNCODE,      00214300
*                 PLISTVER,MF);                                         00214400
*  ANS('?'!!MACLABEL!!' '!!'IXGOFFLP '!!MACLIST!!                       00214500
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00214600
*%END IXGOFFLD;                                                         00214700

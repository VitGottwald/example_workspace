*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IEAGSF                                -11/15/17-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Guarded-Storage Facility services             * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2017                               * 00001200
*                                                                     * 00001300
* STATUS= HBB77B0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      IEAGSF allows you to request that the system enable or disable * 00002100
*      the Guarded-Storage Facility (GSF) and start or stop its       * 00002200
*      status saving of the controls for the Guarded-Storage Facility * 00002300
*      for a specific task (TCB).  It also can be used to request     * 00002400
*      that the system update the Guarded-Storage Facility controls   * 00002500
*      for a specific task and its subtasks.                          * 00002600
*                                                                     * 00002700
*      This service is typically invoked when a thread of execution   * 00002800
*      that will use the Guarded-Storage Facility starts, then again  * 00002900
*      when the thread is done using the Guarded-Storage Facility.    * 00003000
*      It is important to use it when done with the Guarded-Storage   * 00003100
*      Facility because otherwise your Guarded-Storage Event Handler  * 00003200
*      could receive control unexpectedly.                            * 00003300
*                                                                     * 00003400
*01* EXTERNAL CLASSIFICATION:                                         * 00003500
*                                                                     * 00003600
*02* PI:   BASE                                                       * 00003700
*                                                                     * 00003800
*02* NONE: FIELDS                                                     * 00003900
*          MF=M                                                       * 00004000
*                                                                     * 00004100
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004200
*                                                                     * 00004300
*01* ENVIRONMENT:                                                     * 00004400
*                                                                     * 00004500
*                                                                     * 00004600
*      Minimum authorization:                                         * 00004700
*                                                                     * 00004800
*                        The minimum authority for IEAGSF is problem  * 00004900
*                        state and PSW key 8-15.                      * 00005000
*                                                                     * 00005100
*      Dispatchable unit mode: Task mode.                             * 00005200
*                                                                     * 00005300
*      Cross Memory Mode: For START and STOP: Any PASN, any HASN, any * 00005400
*                        SASN.  For UPDATE: PASN=HASN                 * 00005500
*                                                                     * 00005600
*      AMODE:            31- or 64-bit.                               * 00005700
*                                                                     * 00005800
*      ASC mode:         Primary or Access Register.                  * 00005900
*                                                                     * 00006000
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006100
*                                                                     * 00006200
*      Locks:            The caller is not required to hold any locks * 00006300
*                        on entry, but may hold the LOCAL lock.       * 00006400
*                                                                     * 00006500
*      Control parameters: Control parameters must be in the primary  * 00006600
*                        address space.                               * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*01* PROGRAMMING REQUIREMENTS:                                        * 00007100
*                                                                     * 00007200
*    Control parameters must be below the 2G line.                    * 00007300
*                                                                     * 00007400
*    Include the IHAGSRET mapping macro to get equate symbols for the * 00007500
*    return and reason codes provided by the IEAGSF macro.            * 00007600
*                                                                     * 00007700
*01* RESTRICTIONS:                                                    * 00007800
*                                                                     * 00007900
*    IEAGSF is only available if the CVTGSF bit is on.                * 00008000
*                                                                     * 00008100
*    IEAGSF must not be issued from an SRB or an asynchronous exit    * 00008200
*    routine (IRB).                                                   * 00008300
*                                                                     * 00008400
*    IEAGSF must not be issued for a task above the jobstep program   * 00008500
*    TCB.                                                             * 00008600
*                                                                     * 00008700
*    Supervisor-state or system key users must not use this facility  * 00008800
*    if unauthorized programs can run in the same address space       * 00008900
*    because unauthorized programs have the ability to change the GSF * 00009000
*    controls.                                                        * 00009100
*                                                                     * 00009200
*    The caller must not have an FRR established when invoking IEAGSF * 00009300
*    UPDATE.                                                          * 00009400
*                                                                     * 00009500
*01* INPUT REGISTER INFORMATION:                                      * 00009600
*                                                                     * 00009700
*    Before issuing the IEAGSF macro, the caller does not have to     * 00009800
*    place any information into any general purpose register (GPR) or * 00009900
*    access register (AR) unless using it in register notation for a  * 00010000
*    particular parameter, or using it as a base register.            * 00010100
*                                                                     * 00010200
*01* OUTPUT REGISTER INFORMATION:                                     * 00010300
*                                                                     * 00010400
*    When control returns to the caller, the GPRs contain:            * 00010500
*                                                                     * 00010600
*                                                                     * 00010700
*    REGISTER    CONTENTS                                             * 00010800
*                                                                     * 00010900
*    0           Reason code, when GPR 15 is non-zero                 * 00011000
*                                                                     * 00011100
*    1           Used as a work register by the system                * 00011200
*                                                                     * 00011300
*    2-13        Unchanged                                            * 00011400
*                                                                     * 00011500
*    14-15       Used as a work register by the system                * 00011600
*                                                                     * 00011700
*    15          Return code                                          * 00011800
*                                                                     * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*    When control returns to the caller, the ARs contain:             * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*    REGISTER    CONTENTS                                             * 00012500
*                                                                     * 00012600
*    0-1         Used as work registers by the system                 * 00012700
*                                                                     * 00012800
*    2-13        Unchanged                                            * 00012900
*                                                                     * 00013000
*    14-15       Used as work registers by the system                 * 00013100
*                                                                     * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*    Some callers depend on register contents remaining the same      * 00013500
*    before and after issuing a service.  If the system changes the   * 00013600
*    contents of registers on which the caller depends, the caller    * 00013700
*    must save them before issuing the service, and restore them      * 00013800
*    after the system returns control.                                * 00013900
*                                                                     * 00014000
*01* PERFORMANCE IMPLICATIONS:                                        * 00014100
*    None.                                                            * 00014200
*                                                                     * 00014300
*01* SYNTAX:                                                          * 00014400
*                                                                     * 00014500
*Ýxlabel¨  IEAGSF  Ð  START                                           * 00014600
*                  !    Ý,INITIALCONTROLS=»xinitialcontrols!0º¨       * 00014700
*                  Ô ,STOP                                            * 00014800
*                  ¿ ,UPDATE                                          * 00014900
*                        ,TCBTOKEN=xtcbtoken                          * 00015000
*                        ,UPDATECONTROLS=xupdatecontrols              * 00015100
*                      Ð ,UPDATEMASK=0001                             * 00015200
*                      Ô ,UPDATEMASK=0010                             * 00015300
*                      Ô ,UPDATEMASK=0011                             * 00015400
*                      Ô ,UPDATEMASK=0100                             * 00015500
*                      Ô ,UPDATEMASK=0101                             * 00015600
*                      Ô ,UPDATEMASK=0110                             * 00015700
*                      Ô ,UPDATEMASK=0111                             * 00015800
*                      Ô ,UPDATEMASK=1000                             * 00015900
*                      Ô ,UPDATEMASK=1001                             * 00016000
*                      Ô ,UPDATEMASK=1010                             * 00016100
*                      Ô ,UPDATEMASK=1011                             * 00016200
*                      Ô ,UPDATEMASK=1100                             * 00016300
*                      Ô ,UPDATEMASK=1101                             * 00016400
*                      Ô ,UPDATEMASK=1110                             * 00016500
*                      ¿ ,UPDATEMASK=1111                             * 00016600
*                   Ý,RETCODE=xretcode¨                               * 00016700
*                   Ý,RSNCODE=xrsncode¨                               * 00016800
*                   Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨           * 00016900
*                  ÐÝ,MF=S¨                                           * 00017000
*                  ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                    * 00017100
*                  ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨              * 00017200
*                  ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨              * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*      Where:                                                         * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*      Ýxlabel¨                                                       * 00017900
*          is an optional symbol, starting in column 1, that is the   * 00018000
*          name on the IEAGSF macro invocation.  The name must        * 00018100
*          conform to the rules for an ordinary assembler language    * 00018200
*          symbol.                                                    * 00018300
*          DEFAULT: No name.                                          * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*      The following is a set of mutually exclusive keys.  This set   * 00018900
*      is required; only one key must be specified.                   * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*      START                                                          * 00019300
*          keyword that indicates that the system should start the    * 00019400
*          Guarded-Storage Facility and start the saving of           * 00019500
*          Guarded-Storage Facility control information for the       * 00019600
*          current TCB.                                               * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*          ÝINITIALCONTROLS=»xinitialcontrols!0º¨                     * 00020000
*              is the name (RS-type), or address in register          * 00020100
*              (2)-(12), of an optional 32 character input which      * 00020200
*              contains the initial GSF controls (GSCB) to be used.   * 00020300
*              See the description of the Guarded-Storage Control     * 00020400
*              Block in the z/Architecture Principles of Operation    * 00020500
*              manual.                                                * 00020600
*              DEFAULT: 0. The initial GSCB will be set to zeroes.    * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*      STOP                                                           * 00021100
*          keyword that indicates that the system should stop the     * 00021200
*          saving of Guarded-Storage Facility control information and * 00021300
*          stop the Guarded-Storage Facility for the current TCB.     * 00021400
*          Note that MF= is not supported (or needed) for IEAGSF      * 00021500
*          STOP.                                                      * 00021600
*                                                                     * 00021700
*      UPDATE                                                         * 00021800
*          keyword that indicates that the system should              * 00021900
*          synchronously update the Guarded-Storage Facility control  * 00022000
*          information for the input TCB and all of its subtasks.     * 00022100
*          Any tasks which have not issued IEAGSF START will be       * 00022200
*          ignored.                                                   * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*          TCBTOKEN=xtcbtoken                                         * 00022600
*              is the name (RS-type), or address in register          * 00022700
*              (2)-(12), of a required 16 character input which       * 00022800
*              contains the TCBTOKEN of the task to be updated.  All  * 00022900
*              of that task's subtasks will also be updated.  The     * 00023000
*              TCBTOKEN must be valid and must represent the jobstep  * 00023100
*              program task or a subtask of the jobstep program task. * 00023200
*                                                                     * 00023300
*          UPDATECONTROLS=xupdatecontrols                             * 00023400
*              is the name (RS-type), or address in register          * 00023500
*              (2)-(12), of a required 32 character input which       * 00023600
*              contains a new GSF Control Block ('GSCB') to be used.  * 00023700
*              See the description of the Guarded-Storage Control     * 00023800
*              Block in the z/Architecture Principles of Operation    * 00023900
*              manual.                                                * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*          UPDATEMASK=»0001!0010!0011!0100!0101!0110!0111!1000!1001!1 * 00024500
*              010!1011!1100!1101!1110!1111º                          * 00024600
*              is a required keyword input which specifies a mask     * 00024700
*              that describes which of the 4 doublewords of each      * 00024800
*              task's GSCB are to be updated using the new GSCB       * 00024900
*              specified by UPDATECONTROLS.  Use caution when         * 00025000
*              updating the fourth doubleword - you may not want      * 00025100
*              multiple tasks sharing the GSEPL that it points to.    * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*              UPDATEMASK=0001                                        * 00025500
*                  specifies that only the fourth doubleword is to be * 00025600
*                  updated.                                           * 00025700
*                                                                     * 00025800
*              UPDATEMASK=0010                                        * 00025900
*                  specifies that only the third doubleword is to be  * 00026000
*                  updated.                                           * 00026100
*                                                                     * 00026200
*              UPDATEMASK=0011                                        * 00026300
*                  specifies that only the third and fourth           * 00026400
*                  doubleword are to be updated.                      * 00026500
*                                                                     * 00026600
*              UPDATEMASK=0100                                        * 00026700
*                  specifies that only the second doubleword is to be * 00026800
*                  updated.                                           * 00026900
*                                                                     * 00027000
*              UPDATEMASK=0101                                        * 00027100
*                  specifies that only the second and fourth          * 00027200
*                  doubleword are to be updated.                      * 00027300
*                                                                     * 00027400
*              UPDATEMASK=0110                                        * 00027500
*                  specifies that only the second and third           * 00027600
*                  doublewords are to be updated.                     * 00027700
*                                                                     * 00027800
*              UPDATEMASK=0111                                        * 00027900
*                  specifies that only the second, third, and fourth  * 00028000
*                  doublewords are to be updated.                     * 00028100
*                                                                     * 00028200
*              UPDATEMASK=1000                                        * 00028300
*                  specifies that only the first doubleword is to be  * 00028400
*                  updated.                                           * 00028500
*                                                                     * 00028600
*              UPDATEMASK=1001                                        * 00028700
*                  specifies that only the first and fourth           * 00028800
*                  doublewords are to be updated.                     * 00028900
*                                                                     * 00029000
*              UPDATEMASK=1010                                        * 00029100
*                  specifies that only the first and third            * 00029200
*                  doublewords are to be updated.                     * 00029300
*                                                                     * 00029400
*              UPDATEMASK=1011                                        * 00029500
*                  specifies that only the first and third and fourth * 00029600
*                  doublewords are to be updated.                     * 00029700
*                                                                     * 00029800
*              UPDATEMASK=1100                                        * 00029900
*                  specifies that only the first and second           * 00030000
*                  doublewords are to be updated.                     * 00030100
*                                                                     * 00030200
*              UPDATEMASK=1101                                        * 00030300
*                  specifies that only the first and second and       * 00030400
*                  fourth doublewords are to be updated.              * 00030500
*                                                                     * 00030600
*              UPDATEMASK=1110                                        * 00030700
*                  specifies that only the first and second and third * 00030800
*                  doublewords are to be updated.                     * 00030900
*                                                                     * 00031000
*              UPDATEMASK=1111                                        * 00031100
*                  specifies that all four doublewords are to be      * 00031200
*                  updated.                                           * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*      End of a set of mutually exclusive required keys.              * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*      ÝRETCODE=xretcode¨                                             * 00032500
*          is the name (RS-type) of an optional fullword output       * 00032600
*          variable, or register (2)-(12) or (15), into which the     * 00032700
*          return code is to be copied from GPR 15.  If you specify   * 00032800
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00032900
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00033000
*          with MF=M.                                                 * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*      ÝRSNCODE=xrsncode¨                                             * 00033600
*          is the name (RS-type) of an optional fullword output       * 00033700
*          variable into which the reason code is to be copied from   * 00033800
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00033900
*          R0 (within or without parentheses), the value will be left * 00034000
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00034600
*          is an optional byte input decimal value in the "0-0" range * 00034700
*          that specifies the macro version.  PLISTVER is the only    * 00034800
*          key allowed on the list form of MF and determines which    * 00034900
*          parameter list is generated.  Note that MAX may be         * 00035000
*          specified instead of a number, and the parameter list will * 00035100
*          be of the largest size currently supported. This size may  * 00035200
*          grow from release to release (thus possibly affecting the  * 00035300
*          amount of storage needed by your program).  If your        * 00035400
*          program can tolerate this, IBM recommends that you always  * 00035500
*          specify MAX when creating the list form parameter list as  * 00035600
*          that will ensure that the list form parameter list is      * 00035700
*          always long enough to hold whatever parameters might be    * 00035800
*          specified on the execute form.                             * 00035900
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00036000
*          default is the lowest version which allows all of the      * 00036100
*          parameters specified on the invocation to be processed.    * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*      ÝMF=»S!L!M!Eº¨                                                 * 00036700
*          is an optional keyword input which specifies the macro     * 00036800
*          form.                                                      * 00036900
*          DEFAULT: S                                                 * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*          ÝMF=S¨                                                     * 00037300
*              specifies the standard form of the macro.  The "S"     * 00037400
*              form generates code to put the parameters into an      * 00037500
*              in-line parameter list and invoke the desired service. * 00037600
*              Full checking for required macro keys is done along    * 00037700
*              with supplying defaults for omitted optional           * 00037800
*              parameters.                                            * 00037900
*                                                                     * 00038000
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00038100
*              specifies the list form of the macro.  The "L" form    * 00038200
*              defines an area to be used for the parameter list.     * 00038300
*              Only the PLISTVER key may be specified on the          * 00038400
*              invocation.  All other macro parameters are flagged as * 00038500
*              errors.  If PLISTVER is not specified, the original    * 00038600
*              parameter list definition is used.                     * 00038700
*                                                                     * 00038800
*            ,xmfctrl                                                 * 00038900
*              is a required input.  It is the name of a storage area * 00039000
*              for the parameter list.                                * 00039100
*                                                                     * 00039200
*            »,xmfattr!0Dº                                            * 00039300
*              is an optional 60 character input string that varies   * 00039400
*              from 1 to 60 characters. Use it to force boundary      * 00039500
*              alignment of the parameter list. Use only 0F or 0D.    * 00039600
*              DEFAULT: 0D which forces the parameter list to a       * 00039700
*              doubleword boundary.                                   * 00039800
*                                                                     * 00039900
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00040000
*              specifies the modify form of the macro.  The "M" form  * 00040100
*              generates code to put the parameters into the          * 00040200
*              parameter list specified by xmfctrl.                   * 00040300
*                                                                     * 00040400
*            ,xmfctrl                                                 * 00040500
*              is a required input.  It is the name (RS-type), or     * 00040600
*              address in register (1)-(12), of a storage area for    * 00040700
*              the parameter list.                                    * 00040800
*                                                                     * 00040900
*            »,COMPLETE!NOCHECKº¨                                     * 00041000
*              is an optional keyword input which specifies the       * 00041100
*              degree of macro parameter syntax checking.             * 00041200
*              DEFAULT: COMPLETE                                      * 00041300
*                                                                     * 00041400
*                                                                     * 00041500
*              COMPLETE                                               * 00041600
*                  Checking for required macro keys is done and       * 00041700
*                  defaults are supplied for omitted optional         * 00041800
*                  parameters.  (See Macro Usage Note 2).             * 00041900
*                                                                     * 00042000
*              NOCHECK                                                * 00042100
*                  Checking for required macro keys is not done nor   * 00042200
*                  are defaults supplied for omitted optional         * 00042300
*                  parameters.                                        * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*                                                                     * 00042700
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00042800
*              specifies the execute form of the macro.  The "E" form * 00042900
*              generates code to put the parameters into the          * 00043000
*              parameter list specified by xmfctrl and invoke the     * 00043100
*              desired service.                                       * 00043200
*                                                                     * 00043300
*            ,xmfctrl                                                 * 00043400
*              is a required input.  It is the name (RS-type), or     * 00043500
*              address in register (1)-(12), of a storage area for    * 00043600
*              the parameter list.                                    * 00043700
*                                                                     * 00043800
*            »,COMPLETE!NOCHECKº                                      * 00043900
*              is an optional keyword input which specifies the       * 00044000
*              degree of macro parameter syntax checking.             * 00044100
*              DEFAULT: COMPLETE                                      * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*              COMPLETE                                               * 00044500
*                  Checking for required macro keys is done and       * 00044600
*                  defaults are supplied for omitted optional         * 00044700
*                  parameters.  (See Macro Usage Note 2).             * 00044800
*                                                                     * 00044900
*              NOCHECK                                                * 00045000
*                  Checking for required macro keys is not done nor   * 00045100
*                  are defaults supplied for omitted optional         * 00045200
*                  parameters.                                        * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*                                                                     * 00045600
*                                                                     * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*01* ABEND CODES:  None.                                              * 00046100
*                                                                     * 00046200
*01* RETURN CODES:                                                    * 00046300
*                                                                     * 00046400
*                                                                     * 00046500
*                 Macro IHAGSRET provides equate symbols for the      * 00046600
*                 return and reason codes.                            * 00046700
*                                                                     * 00046800
*       0         Name: IeaGsfRc_OK                                   * 00046900
*                                                                     * 00047000
*                 Meaning:  IEAGSF request successful.                * 00047100
*                                                                     * 00047200
*                 Action:  None required.                             * 00047300
*                                                                     * 00047400
*       8         Name: IeaGsfRc_InvParm                              * 00047500
*                                                                     * 00047600
*                 Meaning:  IEAGSF request specifies parameters that  * 00047700
*                 are not valid.                                      * 00047800
*                                                                     * 00047900
*                 Action:  Refer to the action provided with the      * 00048000
*                 specific reason code.                               * 00048100
*                                                                     * 00048200
*                                                                     * 00048300
*                 HEX REASON  MEANING/ACTION                          * 00048400
*                 CODE                                                * 00048500
*                                                                     * 00048600
*                 xxxx0801    Name: IeaGsfRsnBadFunction              * 00048700
*                                                                     * 00048800
*                             Meaning: Incorrect value passed to      * 00048900
*                             target routine.                         * 00049000
*                                                                     * 00049100
*                             Action: Check for possible storage      * 00049200
*                             overlay.                                * 00049300
*                                                                     * 00049400
*                 xxxx0802    Name: IeaGsfRsnUpdateTcbBad             * 00049500
*                                                                     * 00049600
*                             Meaning: The TCB specified by the       * 00049700
*                             TTOKEN for an IEAGSF UPDATE request is  * 00049800
*                             no longer valid, or is terminating, or  * 00049900
*                             is neither the jobstep program task nor * 00050000
*                             a subtask of the jobstep program task.  * 00050100
*                                                                     * 00050200
*                             Action: N/A                             * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*                                                                     * 00050700
*       C         Name: IeaGsfRc_Env                                  * 00050800
*                                                                     * 00050900
*                 Meaning: Environmental error                        * 00051000
*                                                                     * 00051100
*                 Action:  Refer to the action provided with the      * 00051200
*                 specific reason code.                               * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*                 HEX REASON  MEANING/ACTION                          * 00051600
*                 CODE                                                * 00051700
*                                                                     * 00051800
*                 xxxx0C01    Name: IeaGsfRsnFromAsynchExit           * 00051900
*                                                                     * 00052000
*                             Meaning: IEAGSF was issued from an      * 00052100
*                             asynchronous exit routine.              * 00052200
*                                                                     * 00052300
*                             Action: Avoid issuing IEAGSF from an    * 00052400
*                             asynchronous exit routine.              * 00052500
*                                                                     * 00052600
*                 xxxx0C02    Name: IeaGsfRsnFromSRB                  * 00052700
*                                                                     * 00052800
*                             Meaning: IEAGSF was issued from an SRB. * 00052900
*                                                                     * 00053000
*                             Action: Avoid issuing IEAGSF from an    * 00053100
*                             SRB.                                    * 00053200
*                                                                     * 00053300
*                 xxxx0C03    Name: IeaGsfRsnFromNotBITCB             * 00053400
*                                                                     * 00053500
*                             Meaning: IEAGSF was issued from a task  * 00053600
*                             that was neither the jobstep program    * 00053700
*                             task nor a subtask of the jobstep task. * 00053800
*                                                                     * 00053900
*                             Action: Only issue IEAGSF from the      * 00054000
*                             jobstep program task or a subtask of    * 00054100
*                             that task.                              * 00054200
*                                                                     * 00054300
*                 xxxx0C04    Name: IeaGsfRsnLocked                   * 00054400
*                                                                     * 00054500
*                             Meaning: IEAGSF was issued while        * 00054600
*                             holding a lock other than the LOCAL     * 00054700
*                             lock.                                   * 00054800
*                                                                     * 00054900
*                             Action: Avoid issuing IEAGSF while      * 00055000
*                             holding a lock other than the LOCAL     * 00055100
*                             lock.                                   * 00055200
*                                                                     * 00055300
*                 xxxx0C05    Name: IeaGsfRsnNoStorage                * 00055400
*                                                                     * 00055500
*                             Meaning: Necessary system storage could * 00055600
*                             not be obtained from LSQA.              * 00055700
*                                                                     * 00055800
*                             Action: Use IEAGSF START at an earlier  * 00055900
*                             time in the jobstep.                    * 00056000
*                                                                     * 00056100
*                 xxxx0C06    Name: IeaGsfRsnSuperBit                 * 00056200
*                                                                     * 00056300
*                             Meaning: IEAGSF was issued from a work  * 00056400
*                             unit with at least one bit on in the    * 00056500
*                             PSASUPER word.                          * 00056600
*                                                                     * 00056700
*                             Action: Avoid issuing IEAGSF from a     * 00056800
*                             work unit running with a PSASUPER bit   * 00056900
*                             on.                                     * 00057000
*                                                                     * 00057100
*                 xxxx0C07    Name: IeaGsfRsnNotAvailable             * 00057200
*                                                                     * 00057300
*                             Meaning: The Guarded-Storage Facility   * 00057400
*                             is not available on this system.        * 00057500
*                                                                     * 00057600
*                             Action: Ensure that the hardware        * 00057700
*                             supports this facility.                 * 00057800
*                                                                     * 00057900
*                 xxxx0C08    Name: IeaGsfRsnUpdateInXM               * 00058000
*                                                                     * 00058100
*                             Meaning: IEAGSF UPDATE has been called  * 00058200
*                             with a Primary address space that is    * 00058300
*                             different than the Home address space.  * 00058400
*                                                                     * 00058500
*                             Action: Only invoke IEAGSF UPDATE with  * 00058600
*                             the Primary address space equal to the  * 00058700
*                             Home address space.                     * 00058800
*                                                                     * 00058900
*                                                                     * 00059000
*                                                                     * 00059100
*                                                                     * 00059200
*                                                                     * 00059300
*01* REASON CODES:                                                    * 00059400
*                                                                     * 00059500
*       Reason codes, as appropriate, are defined under their         * 00059600
*       corresponding return code.                                    * 00059700
*                                                                     * 00059800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00059900
*                                                                     * 00060000
*02*   PROCESSOR:  ASSEM                                              * 00060100
*                                                                     * 00060200
*01* COMPONENT:  SC1C5                                                * 00060300
*                                                                     * 00060400
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00060500
*                                                                     * 00060600
*01* EXAMPLES:                                                        * 00060700
*                                                                     * 00060800
*    Example 1                                                        * 00060900
*                                                                     * 00061000
*    Operation:                                                       * 00061100
*                                                                     * 00061200
*                                                                     * 00061300
*    1.  Start using the Guarded-Storage Facility with an initial     * 00061400
*        GSCB                                                         * 00061500
*                                                                     * 00061600
*                                                                     * 00061700
*                                                                     * 00061800
*    The code is as follows.                                          * 00061900
*                                                                     * 00062000
*               IEAGSF START,INITIALCONTROLS=MYGSCB                   * 00062100
*                                                                     * 00062200
*                                                                     * 00062300
*01* MACRO USAGE NOTES:                                               * 00062400
*                                                                     * 00062500
*                                                                     * 00062600
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00062700
*        global macro variable.  Any value other than 'NO' will       * 00062800
*        result in the macro expansion being printed.  The default is * 00062900
*        'YES'.  The following examples illustrate how the ZPRINT     * 00063000
*        variable should be set.                                      * 00063100
*                                                                     * 00063200
*                    GBLC &ZPRINT                                     * 00063300
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00063400
*                                                                     * 00063500
*                                                                     * 00063600
*    2.  When using the NOCHECK option in conjunction with the Modify * 00063700
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00063800
*        Modify   or  Execute  form  invocation  which  specifies  or * 00063900
*        defaults  to  the  COMPLETE  option.   This insures that the * 00064000
*        parameter  list  is  initialized completely.   The parameter * 00064100
*        list  field which identifies the version number of the macro * 00064200
*        is only set when the Standard form or the Complete option of * 00064300
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00064400
*        explicitly  specified.  Be sure that the resulting parameter * 00064500
*        list version number covers all the keys that you use.        * 00064600
*                                                                     * 00064700
*                                                                     * 00064800
*    3.  All  keys currently contained in the IEAGSF macro correspond * 00064900
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 00065000
*        MAX.                                                         * 00065100
*                                                                     * 00065200
*                                                                     * 00065300
*                                                                     * 00065400
*                                                                     * 00065500
*01* CHANGE ACTIVITY:                                                 * 00065600
*                                                                     * 00065700
*   Flag LineItem  FMID    Date   ID    Comment                       * 00065800
*                                                                     * 00065900
*    $L0=GSF      HBB77B0 150706 PD00KD:  Guarded-Storage Facility    * 00066000
****** END OF SPECIFICATIONS *****************************************/ 00066100
*/********************************************************************* 00066200
         MACRO                                                          00066300
&XLABEL  IEAGSF &INITIALCONTROLS=,&TCBTOKEN=,&UPDATECONTROLS=,         *00066400
               &UPDATEMASK=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=         00066500
.*                                                                      00066600
*                     MACDATE -11/15/17-<0>                             00066700
.*                                                                      00066800
.*******************************************************************    00066900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00067000
.*******************************************************************    00067100
                     GBLC  &ZPRINT     YES=PRINT NO=NO PRINT            00067200
                     GBLC  &ZTEST      YES=TEST NO=NO TEST              00067300
                     GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX      00067400
.*                                                                      00067500
                     GBLC  &ZIEAGSF    YES=MACRO USED AT LEAST ONCE     00067600
.*******************************************************************    00067700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00067800
.*******************************************************************    00067900
                     LCLC  &ZMS        ERROR MESSAGE WORK AREA          00068000
                     LCLC  &ZCNDX      SYSNDX CHARACTERS                00068100
                     LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED       00068200
                     LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR      00068300
                     LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE      00068400
                     LCLA  &ZAWRK      USED AS A WORK AREA              00068500
                     LCLA  &ZASIZ      USED FOR SIZE OF VALUE           00068600
                     LCLA  &ZN         NUMERIC WORK VARIABLE            00068700
                     LCLC  &ZC         CHARACTER WORK VARIABLE          00068800
                     LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE      00068900
                     LCLA  &ZTLA       VALUE TOO LONG VARIABLE          00069000
                     LCLC  &ZMAC_G     "G" or null                      00069100
&ZMAC_G              SETC  ''                                           00069200
                     LCLC  &ZMAC_LR                                     00069300
&ZMAC_LR             SETC  'LR'                                         00069400
                     LCLC  &ZMAC_L                                      00069500
&ZMAC_L              SETC  'L'                                          00069600
                     LCLC  &ZMAC_ST                                     00069700
&ZMAC_ST             SETC  'ST'                                         00069800
                     LCLC  &ZMAC_LLGT                                   00069900
&ZMAC_LLGT           SETC  'L'                                          00070000
                     LCLC  &ZMAC_LGR                                    00070100
&ZMAC_LGR            SETC  'LR'                                         00070200
                     LCLC  &ZMAC_LG                                     00070300
&ZMAC_LG             SETC  'L'                                          00070400
                     LCLC  &ZMAC_STG                                    00070500
&ZMAC_STG            SETC  'ST'                                         00070600
                     LCLA  &ZMACRET    MACRO RETURN CODE                00070700
&ZMACRET             SETA  0           ASSUME NO ERRORS                 00070800
.*                                                                      00070900
                     LCLC  &ZCSYSLIST(255)      NONXKEY, POS ARRAY      00071000
                     LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()       00071100
                     LCLA  &ZPLLEN     PARAMETER LIST LENGTH            00071200
                     LCLC  &ZENDBASEPL          End of base PL          00071300
                     LCLA  &ZPLWORKA   PARAMETER LIST LENGTH            00071400
.*******************************************************************    00071500
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00071600
.*******************************************************************    00071700
                     LCLA  &ZI         INDEX FOR ARRAY                  00071800
                     LCLA  &ZJ         INDEX FOR PARMS                  00071900
                     LCLA  &ZK         INDEX FOR PARSE                  00072000
                     LCLA  &ZLO        LOW RANGE VALUE                  00072100
                     LCLA  &ZHI        HIGH RANGE VALUE                 00072200
                     LCLC  &ZW         WORK AREA FOR PARM               00072300
.********************************************************************   00072400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00072500
.********************************************************************   00072600
                     GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL          00072700
                     GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE   00072800
                     GBLA  &SYSALVL    SYSSTATE ARCHLVL                 00072900
                     GBLC  &SYSAM64    SYSSTATE AMODE64                 00073000
.*                                                                      00073100
                     AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED   00073200
                     AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED    00073300
                     SPLEVEL  TEST                                      00073400
.ZSYS2               ANOP  ,                                            00073500
                     AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1        00073600
                     AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1        00073700
                     SYSSTATE TEST                                      00073800
                     AGO   .ZSYS4                                       00073900
.ZSYS3               ANOP  ,                                            00074000
&SYSASCE             SETC  'P'         ASSUME SYSSTATE PRIMARY          00074100
.ZSYS4               ANOP  ,                                            00074200
                     AIF   ('&SYSAM64' NE 'YES').ZSYSN64                00074300
&ZMAC_LLGT           SETC 'LLGT'                                        00074400
&ZMAC_LGR            SETC 'LGR'                                         00074500
&ZMAC_LG             SETC 'LG'                                          00074600
&ZMAC_STG            SETC 'STG'                                         00074700
.ZSYSN64             ANOP  ,                                            00074800
&ZMAC_G              SETC 'G'                                           00074900
&ZMAC_LR             SETC 'LGR'                                         00075000
&ZMAC_L              SETC 'LG'                                          00075100
&ZMAC_ST             SETC 'STG'                                         00075200
.*******************************************************************    00075300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00075400
.*******************************************************************    00075500
                     LCLC  &XOPER      ++ VALUE                         00075600
                     LCLC  &XSTART     ++ VALUE                         00075700
                     LCLC  &XINITIALCONTROLS    ++ NAME                 00075800
                     LCLC  &XSTOP      ++ VALUE                         00075900
                     LCLC  &XUPDATE    ++ VALUE                         00076000
                     LCLC  &XTCBTOKEN  ++ NAME                          00076100
                     LCLC  &XUPDATECONTROLS     ++ NAME                 00076200
                     LCLC  &XUPDATEMASK         ++ VALUE                00076300
                     LCLC  &XRETCODE   ++ NAME                          00076400
                     LCLC  &XRSNCODE   ++ NAME                          00076500
                     LCLA  &XPLISTVER  ++ VALUE                         00076600
                     LCLC  &XMF        ++ VALUE                         00076700
                     LCLC  &XMFCTRL    ++ NAME                          00076800
                     LCLC  &XMFATTR    ++ VALUE                         00076900
                     LCLC  &XMFSCK     ++ VALUE                         00077000
.*******************************************************************    00077100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00077200
.*******************************************************************    00077300
                     LCLC  &ZXOPER     ++ INPUT VALUE                   00077400
                     LCLC  &ZXSTART    ++ INPUT VALUE                   00077500
                     LCLC  &ZXINITIALCONTROLS   ++ INPUT NAME           00077600
                     LCLC  &ZXSTOP     ++ INPUT VALUE                   00077700
                     LCLC  &ZXUPDATE   ++ INPUT VALUE                   00077800
                     LCLC  &ZXTCBTOKEN          ++ INPUT NAME           00077900
                     LCLC  &ZXUPDATECONTROLS    ++ INPUT NAME           00078000
                     LCLC  &ZXUPDATEMASK        ++ INPUT VALUE          00078100
                     LCLC  &ZXRETCODE  ++ OUTPUT NAME                   00078200
                     LCLC  &ZXRSNCODE  ++ OUTPUT NAME                   00078300
                     LCLC  &ZXPLISTVER          ++ INPUT VALUE          00078400
                     LCLC  &ZXMF       ++ INPUT VALUE                   00078500
                     LCLC  &ZXMFCTRL   ++ INPUT NAME                    00078600
                     LCLC  &ZXMFATTR   ++ INPUT VALUE                   00078700
                     LCLC  &ZXMFSCK    ++ INPUT VALUE                   00078800
.********************************************************************   00078900
.***AC.PLV01  PROCESS PLISTVER                                      *   00079000
.********************************************************************   00079100
&XPLISTVER      SETA  0                                                 00079200
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00079300
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00079400
&XPLISTVER      SETA  0                                                 00079500
.ZPLV0          ANOP  ,                                                 00079600
.*                                                                      00079700
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00079800
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00079900
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00080000
.*-------------------------------------------------------------------   00080100
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00080200
&ZMS            SETC  '"PLISTVER='                                      00080300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00080400
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00080500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00080600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00080700
                AGO   .ZPVCK2                                           00080800
.ZPVCK3         ANOP  ,                                                 00080900
.*-------------------------------------------------------------------   00081000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00081100
&ZMS            SETC  '"PLISTVER='                                      00081200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00081300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00081400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00081500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00081600
                AGO   .ZPVCKE                                           00081700
.ZPVCK2         ANOP  ,                                                 00081800
.*-------------------------------------------------------------------   00081900
&ZCVAL          SETC  '&PLISTVER(1)'                                    00082000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00082100
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00082200
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00082300
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00082400
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00082500
.ZPVCK6         ANOP  ,                                                 00082600
&ZMS            SETC  '"PLISTVER='                                      00082700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00082800
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00082900
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00083000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00083100
&XPLISTVER      SETA  0                                                 00083200
                AGO   .ZPVCKE                                           00083300
.*-------------------------------------------------------------------   00083400
.ZPVCK4A        ANOP  ,                                                 00083500
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00083600
&ZMS            SETC  'PLISTVER='                                       00083700
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00083800
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00083900
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00084000
                MNOTE 8,' &ZMS IS REQUIRED.'                            00084100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00084200
                AGO   .ZPVCK5                                           00084300
.ZPVCK4         ANOP  ,                                                 00084400
&XPLISTVER      SETA  &PLISTVER(1)                                      00084500
.ZPVCK5         ANOP  ,                                                 00084600
.ZPVCKE         ANOP  ,                                                 00084700
.********************************************************************   00084800
.***AG.MF01 PROCESS MF MACRO FORMS                                      00084900
.********************************************************************   00085000
                     ACTR  10000                                        00085100
.*------------------------------------------------------------------    00085200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085300
&XMF                 SETC  ''          INITIALIZE XVARIABLE             00085400
.*-------------------------------------------------------------------   00085500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085600
.ZG42                ANOP  ,                                            00085700
&ZTLC                SETC 'S'                                           00085800
                     AIF   ('&MF(1)' NE '&ZTLC').ZG43                   00085900
&XMF                 SETC  'S'         SET KEYWORD                      00086000
&XMFSCK              SETC  'COMPLETE'  SET XMFSCK                       00086100
                     AIF   (N'&MF LE 1).ZG42A   CK NUM                  00086200
&ZMS                 SETC  '"MF='                                       00086300
&ZMS                 SETC  '&ZMS.&MF"'                                  00086400
&ZMS                 SETC  '&ZMS "MF"'                                  00086500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00086600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00086700
.ZG42A               ANOP  ,                                            00086800
.*-------------------------------------------------------------------   00086900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087000
.ZG43                ANOP  ,                                            00087100
&ZTLC                SETC 'L'                                           00087200
                     AIF   ('&MF(1)' NE '&ZTLC').ZG50                   00087300
&XMF                 SETC  'L'         SET KEYWORD                      00087400
                     AIF   (N'&MF LE 3).ZG43A   CK NUM                  00087500
&ZMS                 SETC  '"MF='                                       00087600
&ZMS                 SETC  '&ZMS.&MF"'                                  00087700
&ZMS                 SETC  '&ZMS "MF"'                                  00087800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00087900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00088000
.ZG43A               ANOP  ,                                            00088100
.*-------------------------------------------------------------------   00088200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00088300
                     AIF   (N'&SYSLIST NE 0).ZG43B  POSITIONALS?        00088400
                     AIF   ('&INITIALCONTROLS' NE '').ZG43B  KEYS?      00088500
                     AIF   ('&TCBTOKEN' NE '').ZG43B  KEYS?             00088600
                     AIF   ('&UPDATECONTROLS' NE '').ZG43B  KEYS?       00088700
                     AIF   ('&UPDATEMASK' NE '').ZG43B  KEYS?           00088800
                     AIF   ('&RETCODE' NE '').ZG43B  KEYS?              00088900
                     AIF   ('&RSNCODE' NE '').ZG43B  KEYS?              00089000
                     AGO    .ZG43C     INVOCATION OKAY                  00089100
.ZG43B               ANOP  ,                                            00089200
&ZMS                 SETC  'THE "L" FORM OF "MF"'                       00089300
&ZMS                 SETC  '&ZMS CAN ONLY HAVE'                         00089400
&ZMS                 SETC  '&ZMS THE "PLISTVER" KEY'                    00089500
                     MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'       00089600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00089700
.ZG43C               ANOP  ,                                            00089800
.*-------------------------------------------------------------------   00089900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00090000
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00090100
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00090200
                     AIF   (N'&MF(2) GT 1).ZG45B  MULTI                 00090300
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00090400
.ZG45B               AIF   (K'&MF(2) GT 0).ZG45C                        00090500
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00090600
&ZMS                 SETC  'WHEN "L" IS SPECIFIED'                      00090700
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00090800
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00090900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00091000
.ZG45C               ANOP  ,                                            00091100
.*-------------------------------------------------------------------   00091200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00091300
                     AIF   (K'&ZXMFCTRL LE 0).ZG45P  NOT I/O            00091400
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG45P               00091500
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00091600
&ZMS                 SETC  '"MF='                                       00091700
&ZMS                 SETC  '&ZMS.&MF"'                                  00091800
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00091900
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'            00092000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00092100
.ZG45P               ANOP  ,                                            00092200
.*-------------------------------------------------------------------   00092300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00092400
&ZXMFATTR            SETC  'INPUT'     SET IN/OUTPUT                    00092500
&XMFATTR             SETC  '0D'                                         00092600
                     AIF   (K'&MF(3) LE 0).ZG48B  PARM                  00092700
&XMFATTR             SETC  '&MF(3,1)'  SET XVARIABLE                    00092800
                     AIF   (N'&MF(3) GT 1).ZG48B  MULTI                 00092900
&XMFATTR             SETC  '&MF(3)'    SET XVARIABLE                    00093000
.ZG48B               ANOP  ,                                            00093100
.*-------------------------------------------------------------------   00093200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00093300
                     AIF   (K'&ZXMFATTR LE 0).ZG48P  NOT I/O            00093400
                     AIF   ('&XMFATTR'(1,1) NE '(').ZG48P               00093500
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00093600
&ZMS                 SETC  '"MF='                                       00093700
&ZMS                 SETC  '&ZMS.&MF"'                                  00093800
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00093900
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'            00094000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00094100
.ZG48P               ANOP  ,                                            00094200
.*-------------------------------------------------------------------   00094300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00094400
                     AIF   (K'&ZXMFATTR LE 0).ZG48S  NOT I/O            00094500
                     AIF   (K'&XMFATTR LE 60).ZG48S  LNG OK             00094600
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00094700
&ZMS                 SETC  '"MF='                                       00094800
&ZMS                 SETC  '&ZMS.&MF"'                                  00094900
&ZMS                 SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'        00095000
                     MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'           00095100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00095200
.ZG48S               ANOP  ,                                            00095300
.*-------------------------------------------------------------------   00095400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095500
.ZG50                ANOP  ,                                            00095600
&ZTLC                SETC 'M'                                           00095700
                     AIF   ('&MF(1)' NE '&ZTLC').ZG59                   00095800
&XMF                 SETC  'M'         SET KEYWORD                      00095900
                     AIF   (N'&MF LE 3).ZG50A   CK NUM                  00096000
&ZMS                 SETC  '"MF='                                       00096100
&ZMS                 SETC  '&ZMS.&MF"'                                  00096200
&ZMS                 SETC  '&ZMS "MF"'                                  00096300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00096400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00096500
.ZG50A               ANOP  ,                                            00096600
.*-------------------------------------------------------------------   00096700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00096800
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00096900
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00097000
                     AIF   (N'&MF(2) GT 1).ZG52B  MULTI                 00097100
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00097200
.ZG52B               AIF   (K'&MF(2) GT 0).ZG52C                        00097300
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00097400
&ZMS                 SETC  'WHEN "M" IS SPECIFIED'                      00097500
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00097600
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00097700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00097800
.ZG52C               ANOP  ,                                            00097900
.*-------------------------------------------------------------------   00098000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00098100
                     AIF   (K'&ZXMFCTRL LE 0).ZG52R  NOT I/O            00098200
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG52R               00098300
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00098400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG52P                 00098500
                     AIF   (K'&ZCGPR GT 2).ZG52Q                        00098600
                     AIF   ('&ZCGPR' EQ '0').ZG52Q                      00098700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00098800
                     AIF   (T'&ZCGPR NE 'N').ZG52Q  INVALID REG NAME    00098900
.ZG52P               ANOP  ,                                            00099000
                     AIF   (T'&ZCGPR NE 'N').ZG52R  NON NUMERIC         00099100
                     AIF   ('&ZCGPR' LT '1').ZG52Q                      00099200
                     AIF   ('&ZCGPR' LE '12').ZG52R                     00099300
.ZG52Q               ANOP  ,                                            00099400
&ZMS                 SETC  '"MF='                                       00099500
&ZMS                 SETC  '&ZMS.&MF"'                                  00099600
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00099700
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00099800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00099900
.ZG52R               ANOP  ,                                            00100000
.*-------------------------------------------------------------------   00100100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00100200
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00100300
.ZG56A   AIF   ('&MF(3)' NE 'COMPLETE').ZG57A                           00100400
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00100500
.*-------------------------------------------------------------------   00100600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00100700
.ZG57A   AIF   ('&MF(3)' NE 'NOCHECK').ZG58A                            00100800
&XMFSCK              SETC  'NOCHECK'   SET KEYWORD                      00100900
.*-------------------------------------------------------------------   00101000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00101100
.ZG58A               AIF   (K'&XMFSCK GT 0).ZG58C  KEYWORD              00101200
                     AIF   (K'&MF(3) LE 0).ZG58B                        00101300
&ZMS                 SETC  '"MF='                                       00101400
&ZMS                 SETC  '&ZMS.&MF"'                                  00101500
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00101600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00101700
&ZMS                 SETC  '&ZMS "COMPLETE"'                            00101800
&ZMS                 SETC  '&ZMS OR "NOCHECK".'                         00101900
                     MNOTE 8,' &ZMS '                                   00102000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00102100
.ZG58B               ANOP  ,                                            00102200
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00102300
.ZG58C               ANOP  ,                                            00102400
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00102500
.*-------------------------------------------------------------------   00102600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102700
.ZG59                ANOP  ,                                            00102800
&ZTLC                SETC 'E'                                           00102900
                     AIF   ('&MF(1)' NE '&ZTLC').ZG68                   00103000
&XMF                 SETC  'E'         SET KEYWORD                      00103100
                     AIF   (N'&MF LE 3).ZG59A   CK NUM                  00103200
&ZMS                 SETC  '"MF='                                       00103300
&ZMS                 SETC  '&ZMS.&MF"'                                  00103400
&ZMS                 SETC  '&ZMS "MF"'                                  00103500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00103600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00103700
.ZG59A               ANOP  ,                                            00103800
.*-------------------------------------------------------------------   00103900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00104000
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00104100
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00104200
                     AIF   (N'&MF(2) GT 1).ZG61B  MULTI                 00104300
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00104400
.ZG61B               AIF   (K'&MF(2) GT 0).ZG61C                        00104500
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00104600
&ZMS                 SETC  'WHEN "E" IS SPECIFIED'                      00104700
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00104800
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00104900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00105000
.ZG61C               ANOP  ,                                            00105100
.*-------------------------------------------------------------------   00105200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00105300
                     AIF   (K'&ZXMFCTRL LE 0).ZG61R  NOT I/O            00105400
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG61R               00105500
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00105600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                 00105700
                     AIF   (K'&ZCGPR GT 2).ZG61Q                        00105800
                     AIF   ('&ZCGPR' EQ '0').ZG61Q                      00105900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00106000
                     AIF   (T'&ZCGPR NE 'N').ZG61Q  INVALID REG NAME    00106100
.ZG61P               ANOP  ,                                            00106200
                     AIF   (T'&ZCGPR NE 'N').ZG61R  NON NUMERIC         00106300
                     AIF   ('&ZCGPR' LT '1').ZG61Q                      00106400
                     AIF   ('&ZCGPR' LE '12').ZG61R                     00106500
.ZG61Q               ANOP  ,                                            00106600
&ZMS                 SETC  '"MF='                                       00106700
&ZMS                 SETC  '&ZMS.&MF"'                                  00106800
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00106900
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00107000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00107100
.ZG61R               ANOP  ,                                            00107200
.*-------------------------------------------------------------------   00107300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00107400
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00107500
.ZG65A   AIF   ('&MF(3)' NE 'COMPLETE').ZG66A                           00107600
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00107700
.*-------------------------------------------------------------------   00107800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00107900
.ZG66A   AIF   ('&MF(3)' NE 'NOCHECK').ZG67A                            00108000
&XMFSCK              SETC  'NOCHECK'   SET KEYWORD                      00108100
.*-------------------------------------------------------------------   00108200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00108300
.ZG67A               AIF   (K'&XMFSCK GT 0).ZG67C  KEYWORD              00108400
                     AIF   (K'&MF(3) LE 0).ZG67B                        00108500
&ZMS                 SETC  '"MF='                                       00108600
&ZMS                 SETC  '&ZMS.&MF"'                                  00108700
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00108800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00108900
&ZMS                 SETC  '&ZMS "COMPLETE"'                            00109000
&ZMS                 SETC  '&ZMS OR "NOCHECK".'                         00109100
                     MNOTE 8,' &ZMS '                                   00109200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00109300
.ZG67B               ANOP  ,                                            00109400
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00109500
.ZG67C               ANOP  ,                                            00109600
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00109700
.*------------------------------------------------------------------    00109800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109900
.ZG68                ANOP  ,                                            00110000
&ZXMF                SETC  'INPUT'     SET IN/OUTPUT                    00110100
                     AIF   (K'&XMF GT 0).ZG68E  VALID ARG               00110200
                     AIF   (T'&MF EQ 'O').ZG68D  OMITTED                00110300
&ZASYSLNDX           SETA  0                                            00110400
.ZG68A               ANOP  ,           POSITIONAL MACRO KEY             00110500
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00110600
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG68C             00110700
&ZTLC                SETC 'MF'                                          00110800
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG68A    00110900
.ZG68B               ANOP  ,                                            00111000
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00111100
&ZMS                 SETC  'THE "MF" KEY'                               00111200
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00111300
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00111400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00111500
                     AGO   .ZG68E                                       00111600
.ZG68C               ANOP  ,                                            00111700
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00111800
&ZMS                 SETC  '"MF='                                       00111900
&ZMS                 SETC  '&ZMS.&MF"'                                  00112000
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00112100
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00112200
&ZMS                 SETC  '&ZMS "S",'                                  00112300
&ZMS                 SETC  '&ZMS "L",'                                  00112400
&ZMS                 SETC  '&ZMS "M",'                                  00112500
&ZMS                 SETC  '&ZMS OR "E".'                               00112600
                     MNOTE 8,' &ZMS '                                   00112700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00112800
                     AGO   .ZG68E                                       00112900
.ZG68D               ANOP  ,                                            00113000
&XMF                 SETC  'S'         SET DEFAULT KEYWORD              00113100
&XMFSCK              SETC  'COMPLETE'  COMPLETE CHECKING                00113200
.ZG68E               ANOP  ,                                            00113300
.********************************************************************   00113400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00113500
.********************************************************************   00113600
                     ACTR  10000                                        00113700
.*-------------------------------------------------------------------   00113800
.***AG.MF03 MF=(SLME)                                                   00113900
                     AIF   ('&XMF' EQ 'L').ZGMFX                        00114000
                     AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX              00114100
.*-------------------------------------------------------------------   00114200
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00114300
&XOPER               SETC  ''          INITIALIZE XVARIABLE             00114400
&ZASYSLNDX           SETA  0                                            00114500
.ZG2A                ANOP  ,           POSITIONAL KEY SEARCH            00114600
&ZASYSLNDX           SETA  &ZASYSLNDX+1         NEXT POSITIONAL         00114700
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00114800
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00114900
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'START').ZG2A                 00115000
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'  KEY IS NON-XKEY                  00115100
&ZXOPER              SETC  'INPUT'     SET IN/OUTPUT                    00115200
&XOPER               SETC  'START'     SET XVARIABLE                    00115300
&ZXSTART             SETC  'INPUT'     SET IN/OUTPUT                    00115400
&XSTART              SETC  'START'     SET XVARIABLE PARM               00115500
.ZG2B                ANOP  ,                                            00115600
.*-------------------------------------------------------------------   00115700
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00115800
&ZASYSLNDX           SETA  0                                            00115900
.ZG6A                ANOP  ,           POSITIONAL KEY SEARCH            00116000
&ZASYSLNDX           SETA  &ZASYSLNDX+1         NEXT POSITIONAL         00116100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG6C  DONE                    00116200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG6A             00116300
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'STOP').ZG6A                  00116400
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'  KEY IS NON-XKEY                  00116500
                     AIF   (K'&XOPER LE 0).ZG6B  VALID                  00116600
&ZMS                 SETC  '"STOP'                                      00116700
&ZMS                 SETC  '&ZMS."'                                     00116800
&ZMS                 SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'        00116900
&ZMS                 SETC  '&ZMS "&XOPER"'                              00117000
                     MNOTE 8,' &ZMS KEY.'                               00117100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00117200
                     AGO   .ZG6C                                        00117300
.*                                                                      00117400
.ZG6B                ANOP  ,                                            00117500
&ZXOPER              SETC  'INPUT'     SET IN/OUTPUT                    00117600
&XOPER               SETC  'STOP'      SET XVARIABLE                    00117700
&ZXSTOP              SETC  'INPUT'     SET IN/OUTPUT                    00117800
&XSTOP               SETC  'STOP'      SET XVARIABLE PARM               00117900
.ZG6C                ANOP  ,                                            00118000
.*-------------------------------------------------------------------   00118100
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00118200
&ZASYSLNDX           SETA  0                                            00118300
.ZG7A                ANOP  ,           POSITIONAL KEY SEARCH            00118400
&ZASYSLNDX           SETA  &ZASYSLNDX+1         NEXT POSITIONAL         00118500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG7C  DONE                    00118600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG7A             00118700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'UPDATE').ZG7A                00118800
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'  KEY IS NON-XKEY                  00118900
                     AIF   (K'&XOPER LE 0).ZG7B  VALID                  00119000
&ZMS                 SETC  '"UPDATE'                                    00119100
&ZMS                 SETC  '&ZMS."'                                     00119200
&ZMS                 SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'        00119300
&ZMS                 SETC  '&ZMS "&XOPER"'                              00119400
                     MNOTE 8,' &ZMS KEY.'                               00119500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00119600
                     AGO   .ZG7C                                        00119700
.*                                                                      00119800
.ZG7B                ANOP  ,                                            00119900
&ZXOPER              SETC  'INPUT'     SET IN/OUTPUT                    00120000
&XOPER               SETC  'UPDATE'    SET XVARIABLE                    00120100
&ZXUPDATE            SETC  'INPUT'     SET IN/OUTPUT                    00120200
&XUPDATE             SETC  'UPDATE'    SET XVARIABLE PARM               00120300
.ZG7C                ANOP  ,                                            00120400
.*------------------------------------------------------------------    00120500
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00120600
                     AIF   (K'&XOPER GT 0).ZG30B                        00120700
&ZXOPER              SETC  ''          RESET IN/OUTPUT                  00120800
&ZXSTART             SETC  ''          RESET IN/OUTPUT                  00120900
&XOPER               SETC  ''          ENSURE NULL                      00121000
&XSTART              SETC  ''          ENSURE NULL                      00121100
&ZMS                 SETC  'ONE OF THE FOLLOWING'                       00121200
&ZMS                 SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'          00121300
&ZMS                 SETC  '&ZMS REQUIRED:'                             00121400
&ZMS                 SETC  '&ZMS "START",'      VALID ME KEY            00121500
&ZMS                 SETC  '&ZMS "STOP",'       VALID ME KEY            00121600
&ZMS                 SETC  '&ZMS OR "UPDATE".'  VALID ME KEY            00121700
                     MNOTE 8,' &ZMS '                                   00121800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00121900
.ZG30B               ANOP  ,                                            00122000
.*-------------------------------------------------------------------   00122100
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00122200
.ZG2ZY  AIF    ('&XOPER' NE 'START').ZG6ZY                              00122300
.*-------------------------------------------------------------------   00122400
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00122500
&ZCVAL               SETC ''           ERROR KEY FIELD                  00122600
.ZG2I0               AIF   (K'&TCBTOKEN LE 0).ZG2I1                     00122700
&ZCVAL               SETC '&ZCVAL TCBTOKEN'     DISALLOWED KEY          00122800
.ZG2I1               AIF   (K'&UPDATECONTROLS LE 0).ZG2I2               00122900
&ZCVAL               SETC '&ZCVAL UPDATECONTROLS'  DISALLOWED KEY       00123000
.ZG2I2               AIF   (K'&UPDATEMASK LE 0).ZG2I3                   00123100
&ZCVAL               SETC '&ZCVAL UPDATEMASK'   DISALLOWED KEY          00123200
.ZG2I3               AIF   (K'&ZCVAL LE 0).ZG2J  KEY                    00123300
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00123400
&ZMS                 SETC  '"START'                                     00123500
&ZMS                 SETC  '&ZMS."'                                     00123600
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00123700
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00123800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00123900
.ZG2J                ANOP  ,                                            00124000
.*----------------------------------------------------------------***   00124100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00124200
                     AIF   (N'&INITIALCONTROLS LE 1).ZG4A  CK NUM       00124300
&ZMS                 SETC  '"INITIALCONTROLS='                          00124400
&ZMS                 SETC  '&ZMS.&INITIALCONTROLS"'                     00124500
&ZMS                 SETC  '&ZMS "INITIALCONTROLS"'                     00124600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00124700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00124800
.ZG4A                ANOP  ,                                            00124900
.*-------------------------------------------------------------------   00125000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00125100
&ZXINITIALCONTROLS   SETC  'INPUT'     SET IN/OUTPUT                    00125200
&XINITIALCONTROLS    SETC  '0'                                          00125300
                     AIF   (K'&INITIALCONTROLS(1) LE 0).ZG4B  PARM      00125400
&XINITIALCONTROLS    SETC  '&INITIALCONTROLS(1)'  SET XVARIABLE         00125500
                     AIF   (N'&INITIALCONTROLS GT 1).ZG4B  MULTI        00125600
&XINITIALCONTROLS    SETC  '&INITIALCONTROLS'   SET XVARIABLE           00125700
.ZG4B                ANOP  ,                                            00125800
.*-------------------------------------------------------------------   00125900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00126000
                     AIF   (K'&ZXINITIALCONTROLS LE 0).ZG4R  NOT I/O    00126100
                     AIF   ('&XINITIALCONTROLS'(1,1) NE '(').ZG4R       00126200
&ZCGPR               SETC  '&XINITIALCONTROLS'(2,K'&XINITIALCONTROLS-2) 00126300
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                  00126400
                     AIF   (K'&ZCGPR GT 2).ZG4Q                         00126500
                     AIF   ('&ZCGPR' EQ '0').ZG4Q                       00126600
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00126700
                     AIF   (T'&ZCGPR NE 'N').ZG4Q  INVALID REG NAME     00126800
.ZG4P                ANOP  ,                                            00126900
                     AIF   (T'&ZCGPR NE 'N').ZG4R  NON NUMERIC          00127000
                     AIF   ('&ZCGPR' LT '2').ZG4Q                       00127100
                     AIF   ('&ZCGPR' LE '12').ZG4R                      00127200
.ZG4Q                ANOP  ,                                            00127300
&ZMS                 SETC  '"INITIALCONTROLS='                          00127400
&ZMS                 SETC  '&ZMS.&INITIALCONTROLS"'                     00127500
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00127600
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00127700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00127800
.ZG4R                ANOP  ,                                            00127900
.*-------------------------------------------------------------------   00128000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00128100
.ZG6ZY  AIF    ('&XOPER' NE 'STOP').ZG7ZY                               00128200
.*-------------------------------------------------------------------   00128300
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00128400
&ZCVAL               SETC ''           ERROR KEY FIELD                  00128500
.ZG6I0               AIF   (K'&INITIALCONTROLS LE 0).ZG6I1              00128600
&ZCVAL               SETC '&ZCVAL INITIALCONTROLS'  DISALLOWED KEY      00128700
.ZG6I1               AIF   (K'&TCBTOKEN LE 0).ZG6I2                     00128800
&ZCVAL               SETC '&ZCVAL TCBTOKEN'     DISALLOWED KEY          00128900
.ZG6I2               AIF   (K'&UPDATECONTROLS LE 0).ZG6I3               00129000
&ZCVAL               SETC '&ZCVAL UPDATECONTROLS'  DISALLOWED KEY       00129100
.ZG6I3               AIF   (K'&UPDATEMASK LE 0).ZG6I4                   00129200
&ZCVAL               SETC '&ZCVAL UPDATEMASK'   DISALLOWED KEY          00129300
.ZG6I4               AIF   (K'&ZCVAL LE 0).ZG6J  KEY                    00129400
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00129500
&ZMS                 SETC  '"STOP'                                      00129600
&ZMS                 SETC  '&ZMS."'                                     00129700
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00129800
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00129900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00130000
.ZG6J                ANOP  ,                                            00130100
.*-------------------------------------------------------------------   00130200
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00130300
.ZG7ZY  AIF    ('&XOPER' NE 'UPDATE').ZG30ZY                            00130400
.*-------------------------------------------------------------------   00130500
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00130600
&ZCVAL               SETC ''           ERROR KEY FIELD                  00130700
.ZG7I0               AIF   (K'&INITIALCONTROLS LE 0).ZG7I1              00130800
&ZCVAL               SETC '&ZCVAL INITIALCONTROLS'  DISALLOWED KEY      00130900
.ZG7I1               AIF   (K'&ZCVAL LE 0).ZG7J  KEY                    00131000
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00131100
&ZMS                 SETC  '"UPDATE'                                    00131200
&ZMS                 SETC  '&ZMS."'                                     00131300
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00131400
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00131500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00131600
.ZG7J                ANOP  ,                                            00131700
.*----------------------------------------------------------------***   00131800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00131900
                     AIF   (N'&TCBTOKEN LE 1).ZG9A  CK NUM              00132000
&ZMS                 SETC  '"TCBTOKEN='                                 00132100
&ZMS                 SETC  '&ZMS.&TCBTOKEN"'                            00132200
&ZMS                 SETC  '&ZMS "TCBTOKEN"'                            00132300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00132400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00132500
.ZG9A                ANOP  ,                                            00132600
.*-------------------------------------------------------------------   00132700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00132800
&ZXTCBTOKEN          SETC  'INPUT'     SET IN/OUTPUT                    00132900
&XTCBTOKEN           SETC  '&TCBTOKEN(1)'       SET XVARIABLE           00133000
                     AIF   (N'&TCBTOKEN GT 1).ZG9B  MULTI               00133100
&XTCBTOKEN           SETC  '&TCBTOKEN'          SET XVARIABLE           00133200
.ZG9B                AIF   (K'&TCBTOKEN(1) GT 0).ZG9C                   00133300
&ZXTCBTOKEN          SETC  ''          RESET IN/OUTPUT                  00133400
&ZMS                 SETC  ' '                                          00133500
&ZMS                 SETC  '&ZMS "TCBTOKEN" KEY AND ITS'                00133600
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00133700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00133800
.ZG9C                ANOP  ,                                            00133900
.*-------------------------------------------------------------------   00134000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00134100
                     AIF   (K'&ZXTCBTOKEN LE 0).ZG9R  NOT I/O           00134200
                     AIF   ('&XTCBTOKEN'(1,1) NE '(').ZG9R              00134300
&ZCGPR               SETC  '&XTCBTOKEN'(2,K'&XTCBTOKEN-2)               00134400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG9P                  00134500
                     AIF   (K'&ZCGPR GT 2).ZG9Q                         00134600
                     AIF   ('&ZCGPR' EQ '0').ZG9Q                       00134700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00134800
                     AIF   (T'&ZCGPR NE 'N').ZG9Q  INVALID REG NAME     00134900
.ZG9P                ANOP  ,                                            00135000
                     AIF   (T'&ZCGPR NE 'N').ZG9R  NON NUMERIC          00135100
                     AIF   ('&ZCGPR' LT '2').ZG9Q                       00135200
                     AIF   ('&ZCGPR' LE '12').ZG9R                      00135300
.ZG9Q                ANOP  ,                                            00135400
&ZMS                 SETC  '"TCBTOKEN='                                 00135500
&ZMS                 SETC  '&ZMS.&TCBTOKEN"'                            00135600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00135700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00135800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00135900
.ZG9R                ANOP  ,                                            00136000
.*----------------------------------------------------------------***   00136100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00136200
                     AIF   (N'&UPDATECONTROLS LE 1).ZG10A  CK NUM       00136300
&ZMS                 SETC  '"UPDATECONTROLS='                           00136400
&ZMS                 SETC  '&ZMS.&UPDATECONTROLS"'                      00136500
&ZMS                 SETC  '&ZMS "UPDATECONTROLS"'                      00136600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00136700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00136800
.ZG10A               ANOP  ,                                            00136900
.*-------------------------------------------------------------------   00137000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00137100
&ZXUPDATECONTROLS    SETC  'INPUT'     SET IN/OUTPUT                    00137200
&XUPDATECONTROLS     SETC  '&UPDATECONTROLS(1)'  SET XVARIABLE          00137300
                     AIF   (N'&UPDATECONTROLS GT 1).ZG10B  MULTI        00137400
&XUPDATECONTROLS     SETC  '&UPDATECONTROLS'    SET XVARIABLE           00137500
.ZG10B               AIF   (K'&UPDATECONTROLS(1) GT 0).ZG10C            00137600
&ZXUPDATECONTROLS    SETC  ''          RESET IN/OUTPUT                  00137700
&ZMS                 SETC  ' '                                          00137800
&ZMS                 SETC  '&ZMS "UPDATECONTROLS" KEY AND ITS'          00137900
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00138000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00138100
.ZG10C               ANOP  ,                                            00138200
.*-------------------------------------------------------------------   00138300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00138400
                     AIF   (K'&ZXUPDATECONTROLS LE 0).ZG10R  NOT I/O    00138500
                     AIF   ('&XUPDATECONTROLS'(1,1) NE '(').ZG10R       00138600
&ZCGPR               SETC  '&XUPDATECONTROLS'(2,K'&XUPDATECONTROLS-2)   00138700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                 00138800
                     AIF   (K'&ZCGPR GT 2).ZG10Q                        00138900
                     AIF   ('&ZCGPR' EQ '0').ZG10Q                      00139000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00139100
                     AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME    00139200
.ZG10P               ANOP  ,                                            00139300
                     AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC         00139400
                     AIF   ('&ZCGPR' LT '2').ZG10Q                      00139500
                     AIF   ('&ZCGPR' LE '12').ZG10R                     00139600
.ZG10Q               ANOP  ,                                            00139700
&ZMS                 SETC  '"UPDATECONTROLS='                           00139800
&ZMS                 SETC  '&ZMS.&UPDATECONTROLS"'                      00139900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00140000
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00140100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00140200
.ZG10R               ANOP  ,                                            00140300
.*------------------------------------------------------------------    00140400
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140500
&XUPDATEMASK         SETC  ''          INITIALIZE XVARIABLE             00140600
.*-------------------------------------------------------------------   00140700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140800
.ZG14                ANOP  ,                                            00140900
                     AIF   (K'&UPDATEMASK(1) LE 0).ZG14A                00141000
&ZTLC                SETC '0001'                                        00141100
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG15           00141200
&XUPDATEMASK         SETC  '0001'      SET KEYWORD                      00141300
                     AIF   (N'&UPDATEMASK LE 1).ZG14A  CK NUM           00141400
&ZMS                 SETC  '"UPDATEMASK='                               00141500
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00141600
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00141700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00141800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00141900
.ZG14A               ANOP  ,                                            00142000
.*-------------------------------------------------------------------   00142100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142200
.ZG15                ANOP  ,                                            00142300
&ZTLC                SETC '0010'                                        00142400
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG16           00142500
&XUPDATEMASK         SETC  '0010'      SET KEYWORD                      00142600
                     AIF   (N'&UPDATEMASK LE 1).ZG15A  CK NUM           00142700
&ZMS                 SETC  '"UPDATEMASK='                               00142800
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00142900
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00143000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00143100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00143200
.ZG15A               ANOP  ,                                            00143300
.*-------------------------------------------------------------------   00143400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00143500
.ZG16                ANOP  ,                                            00143600
&ZTLC                SETC '0011'                                        00143700
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG17           00143800
&XUPDATEMASK         SETC  '0011'      SET KEYWORD                      00143900
                     AIF   (N'&UPDATEMASK LE 1).ZG16A  CK NUM           00144000
&ZMS                 SETC  '"UPDATEMASK='                               00144100
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00144200
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00144300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00144400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00144500
.ZG16A               ANOP  ,                                            00144600
.*-------------------------------------------------------------------   00144700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144800
.ZG17                ANOP  ,                                            00144900
&ZTLC                SETC '0100'                                        00145000
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG18           00145100
&XUPDATEMASK         SETC  '0100'      SET KEYWORD                      00145200
                     AIF   (N'&UPDATEMASK LE 1).ZG17A  CK NUM           00145300
&ZMS                 SETC  '"UPDATEMASK='                               00145400
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00145500
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00145600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00145700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00145800
.ZG17A               ANOP  ,                                            00145900
.*-------------------------------------------------------------------   00146000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00146100
.ZG18                ANOP  ,                                            00146200
&ZTLC                SETC '0101'                                        00146300
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG19           00146400
&XUPDATEMASK         SETC  '0101'      SET KEYWORD                      00146500
                     AIF   (N'&UPDATEMASK LE 1).ZG18A  CK NUM           00146600
&ZMS                 SETC  '"UPDATEMASK='                               00146700
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00146800
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00146900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00147000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00147100
.ZG18A               ANOP  ,                                            00147200
.*-------------------------------------------------------------------   00147300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147400
.ZG19                ANOP  ,                                            00147500
&ZTLC                SETC '0110'                                        00147600
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG20           00147700
&XUPDATEMASK         SETC  '0110'      SET KEYWORD                      00147800
                     AIF   (N'&UPDATEMASK LE 1).ZG19A  CK NUM           00147900
&ZMS                 SETC  '"UPDATEMASK='                               00148000
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00148100
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00148200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00148300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00148400
.ZG19A               ANOP  ,                                            00148500
.*-------------------------------------------------------------------   00148600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148700
.ZG20                ANOP  ,                                            00148800
&ZTLC                SETC '0111'                                        00148900
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG21           00149000
&XUPDATEMASK         SETC  '0111'      SET KEYWORD                      00149100
                     AIF   (N'&UPDATEMASK LE 1).ZG20A  CK NUM           00149200
&ZMS                 SETC  '"UPDATEMASK='                               00149300
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00149400
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00149500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00149600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00149700
.ZG20A               ANOP  ,                                            00149800
.*-------------------------------------------------------------------   00149900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150000
.ZG21                ANOP  ,                                            00150100
&ZTLC                SETC '1000'                                        00150200
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG22           00150300
&XUPDATEMASK         SETC  '1000'      SET KEYWORD                      00150400
                     AIF   (N'&UPDATEMASK LE 1).ZG21A  CK NUM           00150500
&ZMS                 SETC  '"UPDATEMASK='                               00150600
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00150700
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00150800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00150900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00151000
.ZG21A               ANOP  ,                                            00151100
.*-------------------------------------------------------------------   00151200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00151300
.ZG22                ANOP  ,                                            00151400
&ZTLC                SETC '1001'                                        00151500
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG23           00151600
&XUPDATEMASK         SETC  '1001'      SET KEYWORD                      00151700
                     AIF   (N'&UPDATEMASK LE 1).ZG22A  CK NUM           00151800
&ZMS                 SETC  '"UPDATEMASK='                               00151900
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00152000
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00152100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00152200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00152300
.ZG22A               ANOP  ,                                            00152400
.*-------------------------------------------------------------------   00152500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152600
.ZG23                ANOP  ,                                            00152700
&ZTLC                SETC '1010'                                        00152800
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG24           00152900
&XUPDATEMASK         SETC  '1010'      SET KEYWORD                      00153000
                     AIF   (N'&UPDATEMASK LE 1).ZG23A  CK NUM           00153100
&ZMS                 SETC  '"UPDATEMASK='                               00153200
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00153300
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00153400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00153500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00153600
.ZG23A               ANOP  ,                                            00153700
.*-------------------------------------------------------------------   00153800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00153900
.ZG24                ANOP  ,                                            00154000
&ZTLC                SETC '1011'                                        00154100
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG25           00154200
&XUPDATEMASK         SETC  '1011'      SET KEYWORD                      00154300
                     AIF   (N'&UPDATEMASK LE 1).ZG24A  CK NUM           00154400
&ZMS                 SETC  '"UPDATEMASK='                               00154500
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00154600
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00154700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00154800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00154900
.ZG24A               ANOP  ,                                            00155000
.*-------------------------------------------------------------------   00155100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155200
.ZG25                ANOP  ,                                            00155300
&ZTLC                SETC '1100'                                        00155400
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG26           00155500
&XUPDATEMASK         SETC  '1100'      SET KEYWORD                      00155600
                     AIF   (N'&UPDATEMASK LE 1).ZG25A  CK NUM           00155700
&ZMS                 SETC  '"UPDATEMASK='                               00155800
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00155900
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00156000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00156100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00156200
.ZG25A               ANOP  ,                                            00156300
.*-------------------------------------------------------------------   00156400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156500
.ZG26                ANOP  ,                                            00156600
&ZTLC                SETC '1101'                                        00156700
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG27           00156800
&XUPDATEMASK         SETC  '1101'      SET KEYWORD                      00156900
                     AIF   (N'&UPDATEMASK LE 1).ZG26A  CK NUM           00157000
&ZMS                 SETC  '"UPDATEMASK='                               00157100
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00157200
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00157300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00157400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00157500
.ZG26A               ANOP  ,                                            00157600
.*-------------------------------------------------------------------   00157700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157800
.ZG27                ANOP  ,                                            00157900
&ZTLC                SETC '1110'                                        00158000
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG28           00158100
&XUPDATEMASK         SETC  '1110'      SET KEYWORD                      00158200
                     AIF   (N'&UPDATEMASK LE 1).ZG27A  CK NUM           00158300
&ZMS                 SETC  '"UPDATEMASK='                               00158400
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00158500
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00158600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00158700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00158800
.ZG27A               ANOP  ,                                            00158900
.*-------------------------------------------------------------------   00159000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00159100
.ZG28                ANOP  ,                                            00159200
&ZTLC                SETC '1111'                                        00159300
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZG29           00159400
&XUPDATEMASK         SETC  '1111'      SET KEYWORD                      00159500
                     AIF   (N'&UPDATEMASK LE 1).ZG28A  CK NUM           00159600
&ZMS                 SETC  '"UPDATEMASK='                               00159700
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00159800
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00159900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00160000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00160100
.ZG28A               ANOP  ,                                            00160200
.*------------------------------------------------------------------    00160300
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160400
.ZG29                ANOP  ,                                            00160500
&ZXUPDATEMASK        SETC  'INPUT'     SET IN/OUTPUT                    00160600
                     AIF   (K'&XUPDATEMASK GT 0).ZG29E  VALID ARG       00160700
                     AIF   (T'&UPDATEMASK EQ 'O').ZG29D  OMITTED        00160800
&ZASYSLNDX           SETA  0                                            00160900
.ZG29A               ANOP  ,           POSITIONAL MACRO KEY             00161000
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00161100
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG29C             00161200
&ZTLC                SETC 'UPDATEMASK'                                  00161300
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG29A    00161400
.ZG29B               ANOP  ,                                            00161500
&ZXUPDATEMASK        SETC  ''          RESET IN/OUTPUT                  00161600
&ZMS                 SETC  'THE "UPDATEMASK" KEY'                       00161700
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00161800
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00161900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00162000
                     AGO   .ZG29E                                       00162100
.ZG29C               ANOP  ,                                            00162200
&ZXUPDATEMASK        SETC  ''          RESET IN/OUTPUT                  00162300
&ZMS                 SETC  '"UPDATEMASK='                               00162400
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00162500
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00162600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00162700
&ZMS                 SETC  '&ZMS "0001",'                               00162800
&ZMS                 SETC  '&ZMS "0010",'                               00162900
&ZMS                 SETC  '&ZMS "0011",'                               00163000
&ZMS                 SETC  '&ZMS "0100",'                               00163100
&ZMS                 SETC  '&ZMS "0101",'                               00163200
&ZMS                 SETC  '&ZMS "0110",'                               00163300
&ZMS                 SETC  '&ZMS "0111",'                               00163400
&ZMS                 SETC  '&ZMS "1000",'                               00163500
&ZMS                 SETC  '&ZMS "1001",'                               00163600
&ZMS                 SETC  '&ZMS "1010",'                               00163700
&ZMS                 SETC  '&ZMS "1011",'                               00163800
&ZMS                 SETC  '&ZMS "1100",'                               00163900
&ZMS                 SETC  '&ZMS "1101",'                               00164000
&ZMS                 SETC  '&ZMS "1110",'                               00164100
&ZMS                 SETC  '&ZMS OR "1111".'                            00164200
                     MNOTE 8,' &ZMS '                                   00164300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00164400
                     AGO   .ZG29E                                       00164500
.ZG29D               ANOP  ,                                            00164600
&XUPDATEMASK         SETC  '0001'      SET DEFAULT KEYWORD              00164700
.ZG29E               ANOP  ,                                            00164800
.*------------------------------------------------------------------    00164900
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165000
                     AIF   (K'&UPDATEMASK(1) GT 0).ZG29F  PARM          00165100
&XUPDATEMASK         SETC  ''          ENSURE NULL KEYWORD              00165200
&ZXUPDATEMASK        SETC  ''          RESET IN/OUTPUT                  00165300
&ZMS                 SETC  'THE'                                        00165400
&ZMS                 SETC  '&ZMS "UPDATEMASK" KEY AND ITS'              00165500
&ZMS                 SETC  '&ZMS ARGUMENT ARE REQUIRED.'                00165600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00165700
&ZMS                 SETC  '&ZMS "0001",'                               00165800
&ZMS                 SETC  '&ZMS "0010",'                               00165900
&ZMS                 SETC  '&ZMS "0011",'                               00166000
&ZMS                 SETC  '&ZMS "0100",'                               00166100
&ZMS                 SETC  '&ZMS "0101",'                               00166200
&ZMS                 SETC  '&ZMS "0110",'                               00166300
&ZMS                 SETC  '&ZMS "0111",'                               00166400
&ZMS                 SETC  '&ZMS "1000",'                               00166500
&ZMS                 SETC  '&ZMS "1001",'                               00166600
&ZMS                 SETC  '&ZMS "1010",'                               00166700
&ZMS                 SETC  '&ZMS "1011",'                               00166800
&ZMS                 SETC  '&ZMS "1100",'                               00166900
&ZMS                 SETC  '&ZMS "1101",'                               00167000
&ZMS                 SETC  '&ZMS "1110",'                               00167100
&ZMS                 SETC  '&ZMS OR "1111".'                            00167200
                     MNOTE 8,' &ZMS '                                   00167300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00167400
.ZG29F               ANOP  ,                                            00167500
.*-------------------------------------------------------------------   00167600
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00167700
.ZG30ZY              ANOP ,            END MUTUALLY EXCLUSIVE KEYS      00167800
.*----------------------------------------------------------------***   00167900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00168000
                     AIF   (N'&RETCODE LE 1).ZG32A  CK NUM              00168100
&ZMS                 SETC  '"RETCODE='                                  00168200
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00168300
&ZMS                 SETC  '&ZMS "RETCODE"'                             00168400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00168500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00168600
.ZG32A               ANOP  ,                                            00168700
.*-------------------------------------------------------------------   00168800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00168900
                     AIF   (K'&RETCODE(1) LE 0).ZG32C  NO PARM          00169000
&ZXRETCODE           SETC  'OUTPUT'    SET OUTPUT                       00169100
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00169200
                     AIF   (N'&RETCODE GT 1).ZG32C                      00169300
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00169400
.ZG32C               ANOP  ,                                            00169500
.*-------------------------------------------------------------------   00169600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00169700
                     AIF   (K'&ZXRETCODE LE 0).ZG32R  NOT I/O           00169800
                     AIF   ('&XRETCODE'(1,1) NE '(').ZG32R              00169900
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00170000
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                 00170100
                     AIF   (K'&ZCGPR GT 2).ZG32Q                        00170200
                     AIF   ('&ZCGPR' EQ '0').ZG32Q                      00170300
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00170400
                     AIF   (T'&ZCGPR NE 'N').ZG32Q  INVALID REG NAME    00170500
.ZG32P               ANOP  ,                                            00170600
                     AIF   (T'&ZCGPR NE 'N').ZG32R  NON NUMERIC         00170700
                     AIF   ('&ZCGPR' EQ '15').ZG32R                     00170800
                     AIF   ('&ZCGPR' LT '2').ZG32Q                      00170900
                     AIF   ('&ZCGPR' LE '12').ZG32R                     00171000
.ZG32Q               ANOP  ,                                            00171100
&ZMS                 SETC  '"RETCODE='                                  00171200
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00171300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00171400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'     00171500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00171600
.ZG32R               ANOP  ,                                            00171700
.*----------------------------------------------------------------***   00171800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00171900
                     AIF   (N'&RSNCODE LE 1).ZG35A  CK NUM              00172000
&ZMS                 SETC  '"RSNCODE='                                  00172100
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00172200
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00172300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00172400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00172500
.ZG35A               ANOP  ,                                            00172600
.*-------------------------------------------------------------------   00172700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00172800
                     AIF   (K'&RSNCODE(1) LE 0).ZG35C  NO PARM          00172900
&ZXRSNCODE           SETC  'OUTPUT'    SET OUTPUT                       00173000
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00173100
                     AIF   (N'&RSNCODE GT 1).ZG35C                      00173200
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00173300
.ZG35C               ANOP  ,                                            00173400
.*-------------------------------------------------------------------   00173500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00173600
                     AIF   (K'&ZXRSNCODE LE 0).ZG35R  NOT I/O           00173700
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZG35R              00173800
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00173900
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                 00174000
                     AIF   (K'&ZCGPR GT 2).ZG35Q                        00174100
                     AIF   ('&ZCGPR' EQ '0').ZG35R                      00174200
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00174300
                     AIF   (T'&ZCGPR NE 'N').ZG35Q  INVALID REG NAME    00174400
.ZG35P               ANOP  ,                                            00174500
                     AIF   (T'&ZCGPR NE 'N').ZG35R  NON NUMERIC         00174600
                     AIF   ('&ZCGPR' EQ '0').ZG35R                      00174700
                     AIF   ('&ZCGPR' LT '2').ZG35Q                      00174800
                     AIF   ('&ZCGPR' LE '12').ZG35R                     00174900
.ZG35Q               ANOP  ,                                            00175000
&ZMS                 SETC  '"RSNCODE='                                  00175100
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00175200
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00175300
                     MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'      00175400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00175500
.ZG35R               ANOP  ,                                            00175600
.******************************************************************     00175700
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00175800
.******************************************************************     00175900
                     ACTR  10000                                        00176000
.*-------------------------------------------------------------------   00176100
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00176200
&ZCVAL               SETC  ''          ERROR FIELD                      00176300
&ZAWRK               SETA  0           POSITIONAL COUNTER               00176400
&ZASYSLNDX           SETA  0           NON-X KEY COUNTER                00176500
.ZGLIST2             ANOP  ,                                            00176600
&ZASYSLNDX           SETA  &ZASYSLNDX+1         NEXT NON-X KEY          00176700
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00176800
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00176900
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00177000
                     AIF   (&ZAWRK LE 0).ZGLIST2                        00177100
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA          00177200
                     AGO   .ZGLIST2                                     00177300
.*                                                                      00177400
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00177500
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00177600
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'                    00177700
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00177800
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00177900
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00178000
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00178100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00178200
.ZGLISTX             ANOP  ,                                            00178300
&ZASYSLNDX           SETA  0                                            00178400
.*-------------------------------------------------------------------   00178500
.***AG.MF04 MF=(SLME)                                                   00178600
.ZGMFX               ANOP  ,           END OF FULL SYNTAX CHECK         00178700
.********************************************************************   00178800
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00178900
.********************************************************************   00179000
                     ACTR  10000                                        00179100
.*-------------------------------------------------------------------   00179200
.***AE.MF01 MF=(SLME)                                                   00179300
                     AIF   ('&XMF' EQ 'L').ZEMFX                        00179400
                     AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX               00179500
.********************************************************************   00179600
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00179700
.********************************************************************   00179800
&XUPDATEMASK         SETC  ''          INITIALIZE XVARIABLE             00179900
.*-------------------------------------------------------------------   00180000
.***AE.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00180100
&XOPER               SETC  ''          INITIALIZE XVARIABLE             00180200
&ZASYSLNDX           SETA  0                                            00180300
.ZE2A                ANOP  ,           POSITIONAL KEY SEARCH            00180400
&ZASYSLNDX           SETA  &ZASYSLNDX+1         NEXT POSITIONAL         00180500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE2B  DONE                    00180600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE2A             00180700
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'START').ZE2A                 00180800
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'  KEY IS NON-XKEY                  00180900
&ZXOPER              SETC  'INPUT'     SET IN/OUTPUT                    00181000
&XOPER               SETC  'START'     SET XVARIABLE                    00181100
&ZXSTART             SETC  'INPUT'     SET IN/OUTPUT                    00181200
&XSTART              SETC  'START'     SET XVARIABLE                    00181300
.ZE2B                ANOP  ,                                            00181400
.*-------------------------------------------------------------------   00181500
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00181600
&ZASYSLNDX           SETA  0                                            00181700
.ZE6A                ANOP  ,           POSITIONAL KEY SEARCH            00181800
&ZASYSLNDX           SETA  &ZASYSLNDX+1         NEXT POSITIONAL         00181900
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE6C  DONE                    00182000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE6A             00182100
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'STOP').ZE6A                  00182200
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'  KEY IS NON-XKEY                  00182300
                     AIF   (K'&XOPER LE 0).ZE6B  VALID                  00182400
&ZMS                 SETC  '"STOP'                                      00182500
&ZMS                 SETC  '&ZMS."'                                     00182600
&ZMS                 SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'        00182700
&ZMS                 SETC  '&ZMS "&XOPER"'                              00182800
                     MNOTE 8,' &ZMS KEY.'                               00182900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00183000
                     AGO   .ZE6C                                        00183100
.*                                                                      00183200
.ZE6B                ANOP  ,                                            00183300
&ZXOPER              SETC  'INPUT'     SET IN/OUTPUT                    00183400
&XOPER               SETC  'STOP'      SET XVARIABLE                    00183500
&ZXSTOP              SETC  'INPUT'     SET IN/OUTPUT                    00183600
&XSTOP               SETC  'STOP'      SET XVARIABLE                    00183700
.ZE6C                ANOP  ,                                            00183800
.*-------------------------------------------------------------------   00183900
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00184000
&ZASYSLNDX           SETA  0                                            00184100
.ZE7A                ANOP  ,           POSITIONAL KEY SEARCH            00184200
&ZASYSLNDX           SETA  &ZASYSLNDX+1         NEXT POSITIONAL         00184300
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE7C  DONE                    00184400
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE7A             00184500
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'UPDATE').ZE7A                00184600
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'  KEY IS NON-XKEY                  00184700
                     AIF   (K'&XOPER LE 0).ZE7B  VALID                  00184800
&ZMS                 SETC  '"UPDATE'                                    00184900
&ZMS                 SETC  '&ZMS."'                                     00185000
&ZMS                 SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'        00185100
&ZMS                 SETC  '&ZMS "&XOPER"'                              00185200
                     MNOTE 8,' &ZMS KEY.'                               00185300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00185400
                     AGO   .ZE7C                                        00185500
.*                                                                      00185600
.ZE7B                ANOP  ,                                            00185700
&ZXOPER              SETC  'INPUT'     SET IN/OUTPUT                    00185800
&XOPER               SETC  'UPDATE'    SET XVARIABLE                    00185900
&ZXUPDATE            SETC  'INPUT'     SET IN/OUTPUT                    00186000
&XUPDATE             SETC  'UPDATE'    SET XVARIABLE                    00186100
.ZE7C                ANOP  ,                                            00186200
.*------------------------------------------------------------------    00186300
.***AE.KMEKY07 VALUE, RQD INPUT, ME KEYS -CHECK IF ENTERED              00186400
                     AIF   (K'&XOPER GT 0).ZE30B                        00186500
&ZXOPER              SETC  ''          RESET IN/OUTPUT                  00186600
&XOPER               SETC  ''          SET NULL                         00186700
&ZXSTART             SETC  ''          RESET OUTPUT                     00186800
&XSTART              SETC  ''          SET NULL PARM                    00186900
.ZE30B               ANOP  ,                                            00187000
.*-------------------------------------------------------------------   00187100
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00187200
.ZE2     AIF   ('&XOPER' NE 'START').ZE6                                00187300
.*-------------------------------------------------------------------   00187400
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00187500
                     AIF   (K'&ZXSTART LE 0).ZE2R  NOT I/O              00187600
                     AIF   ('&XSTART'(1,1) NE '(').ZE2R                 00187700
&ZCGPR               SETC  '&XSTART'(2,K'&XSTART-2)                     00187800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                  00187900
                     AIF   (K'&ZCGPR GT 2).ZE2Q                         00188000
                     AIF   ('&ZCGPR' EQ '0').ZE2Q                       00188100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00188200
                     AIF   (T'&ZCGPR NE 'N').ZE2Q  INVALID REG NAME     00188300
.ZE2P                ANOP  ,                                            00188400
                     AIF   (T'&ZCGPR NE 'N').ZE2R  NON NUMERIC          00188500
                     AIF   ('&ZCGPR' LT '2').ZE2Q                       00188600
                     AIF   ('&ZCGPR' LE '12').ZE2R                      00188700
.ZE2Q                ANOP  ,                                            00188800
&ZMS                 SETC  '"START='                                    00188900
&ZMS                 SETC  '&ZMS.&START"'                               00189000
&ZMS                 SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'    00189100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00189200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00189300
.ZE2R                ANOP  ,                                            00189400
.*----------------------------------------------------------------***   00189500
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00189600
                     AIF   (N'&INITIALCONTROLS LE 1).ZE4A  CK NUM       00189700
&ZMS                 SETC  '"INITIALCONTROLS='                          00189800
&ZMS                 SETC  '&ZMS.&INITIALCONTROLS"'                     00189900
&ZMS                 SETC  '&ZMS "INITIALCONTROLS"'                     00190000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00190100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00190200
.ZE4A                ANOP  ,                                            00190300
.*-------------------------------------------------------------------   00190400
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00190500
                     AIF   (K'&INITIALCONTROLS(1) LE 0).ZE4B NO PRM     00190600
&ZXINITIALCONTROLS   SETC  'INPUT'     SET IN/OUTPUT                    00190700
&XINITIALCONTROLS    SETC  '&INITIALCONTROLS(1)'  SET XVARIABLE         00190800
                     AIF   (N'&INITIALCONTROLS GT 1).ZE4B               00190900
.*                   ANOP                                               00191000
&XINITIALCONTROLS    SETC  '&INITIALCONTROLS'   SET XVARIABLE           00191100
.ZE4B                ANOP  ,                                            00191200
.*-------------------------------------------------------------------   00191300
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00191400
                     AIF   (K'&ZXINITIALCONTROLS LE 0).ZE4R  NOT I/O    00191500
                     AIF   ('&XINITIALCONTROLS'(1,1) NE '(').ZE4R       00191600
&ZCGPR               SETC  '&XINITIALCONTROLS'(2,K'&XINITIALCONTROLS-2) 00191700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE4P                  00191800
                     AIF   (K'&ZCGPR GT 2).ZE4Q                         00191900
                     AIF   ('&ZCGPR' EQ '0').ZE4Q                       00192000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00192100
                     AIF   (T'&ZCGPR NE 'N').ZE4Q  INVALID REG NAME     00192200
.ZE4P                ANOP  ,                                            00192300
                     AIF   (T'&ZCGPR NE 'N').ZE4R  NON NUMERIC          00192400
                     AIF   ('&ZCGPR' LT '2').ZE4Q                       00192500
                     AIF   ('&ZCGPR' LE '12').ZE4R                      00192600
.ZE4Q                ANOP  ,                                            00192700
&ZMS                 SETC  '"INITIALCONTROLS='                          00192800
&ZMS                 SETC  '&ZMS.&INITIALCONTROLS"'                     00192900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00193000
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00193100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00193200
.ZE4R                ANOP  ,                                            00193300
.*-------------------------------------------------------------------   00193400
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00193500
.ZE6     AIF   ('&XOPER' NE 'STOP').ZE7                                 00193600
.*-------------------------------------------------------------------   00193700
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00193800
                     AIF   (K'&ZXSTOP LE 0).ZE6R  NOT I/O               00193900
                     AIF   ('&XSTOP'(1,1) NE '(').ZE6R                  00194000
&ZCGPR               SETC  '&XSTOP'(2,K'&XSTOP-2)                       00194100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE6P                  00194200
                     AIF   (K'&ZCGPR GT 2).ZE6Q                         00194300
                     AIF   ('&ZCGPR' EQ '0').ZE6Q                       00194400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00194500
                     AIF   (T'&ZCGPR NE 'N').ZE6Q  INVALID REG NAME     00194600
.ZE6P                ANOP  ,                                            00194700
                     AIF   (T'&ZCGPR NE 'N').ZE6R  NON NUMERIC          00194800
                     AIF   ('&ZCGPR' LT '2').ZE6Q                       00194900
                     AIF   ('&ZCGPR' LE '12').ZE6R                      00195000
.ZE6Q                ANOP  ,                                            00195100
&ZMS                 SETC  '"STOP='                                     00195200
&ZMS                 SETC  '&ZMS.&STOP"'                                00195300
&ZMS                 SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'    00195400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00195500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00195600
.ZE6R                ANOP  ,                                            00195700
.*-------------------------------------------------------------------   00195800
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00195900
.ZE7     AIF   ('&XOPER' NE 'UPDATE').ZE30                              00196000
.*-------------------------------------------------------------------   00196100
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00196200
                     AIF   (K'&ZXUPDATE LE 0).ZE7R  NOT I/O             00196300
                     AIF   ('&XUPDATE'(1,1) NE '(').ZE7R                00196400
&ZCGPR               SETC  '&XUPDATE'(2,K'&XUPDATE-2)                   00196500
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE7P                  00196600
                     AIF   (K'&ZCGPR GT 2).ZE7Q                         00196700
                     AIF   ('&ZCGPR' EQ '0').ZE7Q                       00196800
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00196900
                     AIF   (T'&ZCGPR NE 'N').ZE7Q  INVALID REG NAME     00197000
.ZE7P                ANOP  ,                                            00197100
                     AIF   (T'&ZCGPR NE 'N').ZE7R  NON NUMERIC          00197200
                     AIF   ('&ZCGPR' LT '2').ZE7Q                       00197300
                     AIF   ('&ZCGPR' LE '12').ZE7R                      00197400
.ZE7Q                ANOP  ,                                            00197500
&ZMS                 SETC  '"UPDATE='                                   00197600
&ZMS                 SETC  '&ZMS.&UPDATE"'                              00197700
&ZMS                 SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'    00197800
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00197900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00198000
.ZE7R                ANOP  ,                                            00198100
.*----------------------------------------------------------------***   00198200
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00198300
                     AIF   (N'&TCBTOKEN LE 1).ZE9A  CK NUM              00198400
&ZMS                 SETC  '"TCBTOKEN='                                 00198500
&ZMS                 SETC  '&ZMS.&TCBTOKEN"'                            00198600
&ZMS                 SETC  '&ZMS "TCBTOKEN"'                            00198700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00198800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00198900
.ZE9A                ANOP  ,                                            00199000
.*-------------------------------------------------------------------   00199100
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00199200
                     AIF   (K'&TCBTOKEN(1) LE 0).ZE9B NO PRM            00199300
&ZXTCBTOKEN          SETC  'INPUT'     SET IN/OUTPUT                    00199400
&XTCBTOKEN           SETC  '&TCBTOKEN(1)'       SET XVARIABLE           00199500
                     AIF   (N'&TCBTOKEN GT 1).ZE9B                      00199600
.*                   ANOP                                               00199700
&XTCBTOKEN           SETC  '&TCBTOKEN'          SET XVARIABLE           00199800
.ZE9B                ANOP  ,                                            00199900
.*-------------------------------------------------------------------   00200000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00200100
                     AIF   (K'&ZXTCBTOKEN LE 0).ZE9R  NOT I/O           00200200
                     AIF   ('&XTCBTOKEN'(1,1) NE '(').ZE9R              00200300
&ZCGPR               SETC  '&XTCBTOKEN'(2,K'&XTCBTOKEN-2)               00200400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE9P                  00200500
                     AIF   (K'&ZCGPR GT 2).ZE9Q                         00200600
                     AIF   ('&ZCGPR' EQ '0').ZE9Q                       00200700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00200800
                     AIF   (T'&ZCGPR NE 'N').ZE9Q  INVALID REG NAME     00200900
.ZE9P                ANOP  ,                                            00201000
                     AIF   (T'&ZCGPR NE 'N').ZE9R  NON NUMERIC          00201100
                     AIF   ('&ZCGPR' LT '2').ZE9Q                       00201200
                     AIF   ('&ZCGPR' LE '12').ZE9R                      00201300
.ZE9Q                ANOP  ,                                            00201400
&ZMS                 SETC  '"TCBTOKEN='                                 00201500
&ZMS                 SETC  '&ZMS.&TCBTOKEN"'                            00201600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00201700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00201800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00201900
.ZE9R                ANOP  ,                                            00202000
.*----------------------------------------------------------------***   00202100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00202200
                     AIF   (N'&UPDATECONTROLS LE 1).ZE10A  CK NUM       00202300
&ZMS                 SETC  '"UPDATECONTROLS='                           00202400
&ZMS                 SETC  '&ZMS.&UPDATECONTROLS"'                      00202500
&ZMS                 SETC  '&ZMS "UPDATECONTROLS"'                      00202600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00202700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00202800
.ZE10A               ANOP  ,                                            00202900
.*-------------------------------------------------------------------   00203000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00203100
                     AIF   (K'&UPDATECONTROLS(1) LE 0).ZE10B NO PRM     00203200
&ZXUPDATECONTROLS    SETC  'INPUT'     SET IN/OUTPUT                    00203300
&XUPDATECONTROLS     SETC  '&UPDATECONTROLS(1)'  SET XVARIABLE          00203400
                     AIF   (N'&UPDATECONTROLS GT 1).ZE10B               00203500
.*                   ANOP                                               00203600
&XUPDATECONTROLS     SETC  '&UPDATECONTROLS'    SET XVARIABLE           00203700
.ZE10B               ANOP  ,                                            00203800
.*-------------------------------------------------------------------   00203900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00204000
                     AIF   (K'&ZXUPDATECONTROLS LE 0).ZE10R  NOT I/O    00204100
                     AIF   ('&XUPDATECONTROLS'(1,1) NE '(').ZE10R       00204200
&ZCGPR               SETC  '&XUPDATECONTROLS'(2,K'&XUPDATECONTROLS-2)   00204300
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                 00204400
                     AIF   (K'&ZCGPR GT 2).ZE10Q                        00204500
                     AIF   ('&ZCGPR' EQ '0').ZE10Q                      00204600
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00204700
                     AIF   (T'&ZCGPR NE 'N').ZE10Q  INVALID REG NAME    00204800
.ZE10P               ANOP  ,                                            00204900
                     AIF   (T'&ZCGPR NE 'N').ZE10R  NON NUMERIC         00205000
                     AIF   ('&ZCGPR' LT '2').ZE10Q                      00205100
                     AIF   ('&ZCGPR' LE '12').ZE10R                     00205200
.ZE10Q               ANOP  ,                                            00205300
&ZMS                 SETC  '"UPDATECONTROLS='                           00205400
&ZMS                 SETC  '&ZMS.&UPDATECONTROLS"'                      00205500
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00205600
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00205700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00205800
.ZE10R               ANOP  ,                                            00205900
.*-------------------------------------------------------------------   00206000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00206100
&ZTLC                SETC '0001'                                        00206200
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE14A          00206300
&XUPDATEMASK         SETC  '0001'      SET KEYWORD                      00206400
                     AIF   (N'&UPDATEMASK LE 1).ZE14A  CK NUM           00206500
&ZMS                 SETC  '"UPDATEMASK='                               00206600
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00206700
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00206800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00206900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00207000
.ZE14A               ANOP  ,                                            00207100
.*-------------------------------------------------------------------   00207200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00207300
&ZTLC                SETC '0010'                                        00207400
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE15A          00207500
&XUPDATEMASK         SETC  '0010'      SET KEYWORD                      00207600
                     AIF   (N'&UPDATEMASK LE 1).ZE15A  CK NUM           00207700
&ZMS                 SETC  '"UPDATEMASK='                               00207800
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00207900
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00208000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00208100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00208200
.ZE15A               ANOP  ,                                            00208300
.*-------------------------------------------------------------------   00208400
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00208500
&ZTLC                SETC '0011'                                        00208600
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE16A          00208700
&XUPDATEMASK         SETC  '0011'      SET KEYWORD                      00208800
                     AIF   (N'&UPDATEMASK LE 1).ZE16A  CK NUM           00208900
&ZMS                 SETC  '"UPDATEMASK='                               00209000
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00209100
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00209200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00209300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00209400
.ZE16A               ANOP  ,                                            00209500
.*-------------------------------------------------------------------   00209600
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00209700
&ZTLC                SETC '0100'                                        00209800
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE17A          00209900
&XUPDATEMASK         SETC  '0100'      SET KEYWORD                      00210000
                     AIF   (N'&UPDATEMASK LE 1).ZE17A  CK NUM           00210100
&ZMS                 SETC  '"UPDATEMASK='                               00210200
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00210300
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00210400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00210500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00210600
.ZE17A               ANOP  ,                                            00210700
.*-------------------------------------------------------------------   00210800
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00210900
&ZTLC                SETC '0101'                                        00211000
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE18A          00211100
&XUPDATEMASK         SETC  '0101'      SET KEYWORD                      00211200
                     AIF   (N'&UPDATEMASK LE 1).ZE18A  CK NUM           00211300
&ZMS                 SETC  '"UPDATEMASK='                               00211400
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00211500
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00211600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00211700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00211800
.ZE18A               ANOP  ,                                            00211900
.*-------------------------------------------------------------------   00212000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00212100
&ZTLC                SETC '0110'                                        00212200
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE19A          00212300
&XUPDATEMASK         SETC  '0110'      SET KEYWORD                      00212400
                     AIF   (N'&UPDATEMASK LE 1).ZE19A  CK NUM           00212500
&ZMS                 SETC  '"UPDATEMASK='                               00212600
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00212700
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00212800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00212900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00213000
.ZE19A               ANOP  ,                                            00213100
.*-------------------------------------------------------------------   00213200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00213300
&ZTLC                SETC '0111'                                        00213400
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE20A          00213500
&XUPDATEMASK         SETC  '0111'      SET KEYWORD                      00213600
                     AIF   (N'&UPDATEMASK LE 1).ZE20A  CK NUM           00213700
&ZMS                 SETC  '"UPDATEMASK='                               00213800
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00213900
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00214000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00214100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00214200
.ZE20A               ANOP  ,                                            00214300
.*-------------------------------------------------------------------   00214400
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00214500
&ZTLC                SETC '1000'                                        00214600
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE21A          00214700
&XUPDATEMASK         SETC  '1000'      SET KEYWORD                      00214800
                     AIF   (N'&UPDATEMASK LE 1).ZE21A  CK NUM           00214900
&ZMS                 SETC  '"UPDATEMASK='                               00215000
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00215100
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00215200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00215300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00215400
.ZE21A               ANOP  ,                                            00215500
.*-------------------------------------------------------------------   00215600
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00215700
&ZTLC                SETC '1001'                                        00215800
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE22A          00215900
&XUPDATEMASK         SETC  '1001'      SET KEYWORD                      00216000
                     AIF   (N'&UPDATEMASK LE 1).ZE22A  CK NUM           00216100
&ZMS                 SETC  '"UPDATEMASK='                               00216200
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00216300
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00216400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00216500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00216600
.ZE22A               ANOP  ,                                            00216700
.*-------------------------------------------------------------------   00216800
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00216900
&ZTLC                SETC '1010'                                        00217000
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE23A          00217100
&XUPDATEMASK         SETC  '1010'      SET KEYWORD                      00217200
                     AIF   (N'&UPDATEMASK LE 1).ZE23A  CK NUM           00217300
&ZMS                 SETC  '"UPDATEMASK='                               00217400
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00217500
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00217600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00217700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00217800
.ZE23A               ANOP  ,                                            00217900
.*-------------------------------------------------------------------   00218000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00218100
&ZTLC                SETC '1011'                                        00218200
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE24A          00218300
&XUPDATEMASK         SETC  '1011'      SET KEYWORD                      00218400
                     AIF   (N'&UPDATEMASK LE 1).ZE24A  CK NUM           00218500
&ZMS                 SETC  '"UPDATEMASK='                               00218600
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00218700
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00218800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00218900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00219000
.ZE24A               ANOP  ,                                            00219100
.*-------------------------------------------------------------------   00219200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00219300
&ZTLC                SETC '1100'                                        00219400
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE25A          00219500
&XUPDATEMASK         SETC  '1100'      SET KEYWORD                      00219600
                     AIF   (N'&UPDATEMASK LE 1).ZE25A  CK NUM           00219700
&ZMS                 SETC  '"UPDATEMASK='                               00219800
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00219900
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00220000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00220100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00220200
.ZE25A               ANOP  ,                                            00220300
.*-------------------------------------------------------------------   00220400
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00220500
&ZTLC                SETC '1101'                                        00220600
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE26A          00220700
&XUPDATEMASK         SETC  '1101'      SET KEYWORD                      00220800
                     AIF   (N'&UPDATEMASK LE 1).ZE26A  CK NUM           00220900
&ZMS                 SETC  '"UPDATEMASK='                               00221000
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00221100
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00221200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00221300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00221400
.ZE26A               ANOP  ,                                            00221500
.*-------------------------------------------------------------------   00221600
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00221700
&ZTLC                SETC '1110'                                        00221800
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE27A          00221900
&XUPDATEMASK         SETC  '1110'      SET KEYWORD                      00222000
                     AIF   (N'&UPDATEMASK LE 1).ZE27A  CK NUM           00222100
&ZMS                 SETC  '"UPDATEMASK='                               00222200
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00222300
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00222400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00222500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00222600
.ZE27A               ANOP  ,                                            00222700
.*-------------------------------------------------------------------   00222800
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00222900
&ZTLC                SETC '1111'                                        00223000
                     AIF   ('&UPDATEMASK(1)' NE '&ZTLC').ZE28A          00223100
&XUPDATEMASK         SETC  '1111'      SET KEYWORD                      00223200
                     AIF   (N'&UPDATEMASK LE 1).ZE28A  CK NUM           00223300
&ZMS                 SETC  '"UPDATEMASK='                               00223400
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00223500
&ZMS                 SETC  '&ZMS "UPDATEMASK"'                          00223600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00223700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00223800
.ZE28A               ANOP  ,                                            00223900
.*------------------------------------------------------------------    00224000
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00224100
.ZE29                AIF   (K'&XUPDATEMASK GT 0).ZE29A                  00224200
                     AIF   (K'&UPDATEMASK(1) LE 0).ZE29B                00224300
&ZMS                 SETC  '"UPDATEMASK='                               00224400
&ZMS                 SETC  '&ZMS.&UPDATEMASK"'                          00224500
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00224600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00224700
&ZMS                 SETC  '&ZMS "0001",'                               00224800
&ZMS                 SETC  '&ZMS "0010",'                               00224900
&ZMS                 SETC  '&ZMS "0011",'                               00225000
&ZMS                 SETC  '&ZMS "0100",'                               00225100
&ZMS                 SETC  '&ZMS "0101",'                               00225200
&ZMS                 SETC  '&ZMS "0110",'                               00225300
&ZMS                 SETC  '&ZMS "0111",'                               00225400
&ZMS                 SETC  '&ZMS "1000",'                               00225500
&ZMS                 SETC  '&ZMS "1001",'                               00225600
&ZMS                 SETC  '&ZMS "1010",'                               00225700
&ZMS                 SETC  '&ZMS "1011",'                               00225800
&ZMS                 SETC  '&ZMS "1100",'                               00225900
&ZMS                 SETC  '&ZMS "1101",'                               00226000
&ZMS                 SETC  '&ZMS "1110",'                               00226100
&ZMS                 SETC  '&ZMS OR "1111".'                            00226200
                     MNOTE 8,' &ZMS '                                   00226300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00226400
                     AGO   .ZE29B                                       00226500
.*                                                                      00226600
.ZE29A               ANOP  ,                                            00226700
&ZXUPDATEMASK        SETC  'INPUT'     SET IN/OUTPUT                    00226800
.ZE29B               ANOP  ,                                            00226900
.*-------------------------------------------------------------------   00227000
.***AE.KMEKY09 VALUE, RQD INPUT, ME KEYS -END                           00227100
.ZE30                ANOP  ,           END MUTUALLY EXCLUSIVE KEYS      00227200
.*----------------------------------------------------------------***   00227300
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00227400
                     AIF   (N'&RETCODE LE 1).ZE32A  CK NUM              00227500
&ZMS                 SETC  '"RETCODE='                                  00227600
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00227700
&ZMS                 SETC  '&ZMS "RETCODE"'                             00227800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00227900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00228000
.ZE32A               ANOP  ,                                            00228100
.*-------------------------------------------------------------------   00228200
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00228300
                     AIF   (K'&RETCODE(1) LE 0).ZE32B NO PRM            00228400
&ZXRETCODE           SETC  'OUTPUT'    SET IN/OUTPUT                    00228500
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00228600
                     AIF   (N'&RETCODE GT 1).ZE32B                      00228700
.*                   ANOP                                               00228800
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00228900
.ZE32B               ANOP  ,                                            00229000
.*-------------------------------------------------------------------   00229100
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00229200
                     AIF   (K'&ZXRETCODE LE 0).ZE32R  NOT I/O           00229300
                     AIF   ('&XRETCODE'(1,1) NE '(').ZE32R              00229400
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00229500
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE32P                 00229600
                     AIF   (K'&ZCGPR GT 2).ZE32Q                        00229700
                     AIF   ('&ZCGPR' EQ '0').ZE32Q                      00229800
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00229900
                     AIF   (T'&ZCGPR NE 'N').ZE32Q  INVALID REG NAME    00230000
.ZE32P               ANOP  ,                                            00230100
                     AIF   (T'&ZCGPR NE 'N').ZE32R  NON NUMERIC         00230200
                     AIF   ('&ZCGPR' LT '2').ZE32Q                      00230300
                     AIF   ('&ZCGPR' LE '12').ZE32R                     00230400
.ZE32Q               ANOP  ,                                            00230500
&ZMS                 SETC  '"RETCODE='                                  00230600
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00230700
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00230800
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00230900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00231000
.ZE32R               ANOP  ,                                            00231100
.*----------------------------------------------------------------***   00231200
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00231300
                     AIF   (N'&RSNCODE LE 1).ZE35A  CK NUM              00231400
&ZMS                 SETC  '"RSNCODE='                                  00231500
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00231600
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00231700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00231800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00231900
.ZE35A               ANOP  ,                                            00232000
.*-------------------------------------------------------------------   00232100
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00232200
                     AIF   (K'&RSNCODE(1) LE 0).ZE35B NO PRM            00232300
&ZXRSNCODE           SETC  'OUTPUT'    SET IN/OUTPUT                    00232400
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00232500
                     AIF   (N'&RSNCODE GT 1).ZE35B                      00232600
.*                   ANOP                                               00232700
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00232800
.ZE35B               ANOP  ,                                            00232900
.*-------------------------------------------------------------------   00233000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00233100
                     AIF   (K'&ZXRSNCODE LE 0).ZE35R  NOT I/O           00233200
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZE35R              00233300
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00233400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE35P                 00233500
                     AIF   (K'&ZCGPR GT 2).ZE35Q                        00233600
                     AIF   ('&ZCGPR' EQ '0').ZE35Q                      00233700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00233800
                     AIF   (T'&ZCGPR NE 'N').ZE35Q  INVALID REG NAME    00233900
.ZE35P               ANOP  ,                                            00234000
                     AIF   (T'&ZCGPR NE 'N').ZE35R  NON NUMERIC         00234100
                     AIF   ('&ZCGPR' LT '2').ZE35Q                      00234200
                     AIF   ('&ZCGPR' LE '12').ZE35R                     00234300
.ZE35Q               ANOP  ,                                            00234400
&ZMS                 SETC  '"RSNCODE='                                  00234500
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00234600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00234700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00234800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00234900
.ZE35R               ANOP  ,                                            00235000
.******************************************************************     00235100
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00235200
.******************************************************************     00235300
                     ACTR  10000                                        00235400
.*-------------------------------------------------------------------   00235500
.***AF.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00235600
&ZCVAL               SETC  ''          ERROR FIELD                      00235700
&ZAWRK               SETA  0           POSITIONAL COUNTER               00235800
&ZASYSLNDX           SETA  0           NON-X KEY COUNTER                00235900
.ZELIST2             ANOP  ,                                            00236000
&ZASYSLNDX           SETA  &ZASYSLNDX+1         NEXT NON-X KEY          00236100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZELIST3  DONE                 00236200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZELIST2          00236300
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00236400
                     AIF   (&ZAWRK LE 0).ZELIST2                        00236500
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA          00236600
                     AGO   .ZELIST2                                     00236700
.*                                                                      00236800
.ZELIST3  AIF  (K'&ZCVAL LE 0).ZELISTX                                  00236900
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00237000
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'                    00237100
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00237200
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00237300
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00237400
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00237500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00237600
.ZELISTX             ANOP  ,                                            00237700
&ZASYSLNDX           SETA  0                                            00237800
.*-------------------------------------------------------------------   00237900
.***AE.MF02 MF=(SLME)                                                   00238000
.ZEMFX               ANOP  ,           END OF PARTIAL SYNTAX CHECK      00238100
.*******************************************************************    00238200
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00238300
.*******************************************************************    00238400
                     AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED         00238500
.*******************************************************************    00238600
.***AE.01  START OF IEAGSF MACRO CODE                                   00238700
.*******************************************************************    00238800
                     LCLC  &M0M0001                 NAME                00238900
&M0M0001             SETC  '&XLABEL'                SET NAME            00239000
                     AIF   (K'&XLABEL NE 0).XLAB2                       00239100
&M0M0001             SETC  'M00M&SYSNDX'            DEFAULT NAME        00239200
.*                                                                      00239300
.XLAB2               ANOP  ,                                            00239400
                     AIF   ('&XMF' EQ 'L').XLAB3                        00239500
&M0M0001 DS    0H                             IEAGSF-0                  00239600
.XLAB3               ANOP  ,                                            00239700
.*******************************************************************    00239800
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00239900
.*******************************************************************    00240000
              PUSH  PRINT                                               00240100
                     AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON   00240200
                     PRINT OFF         ++ PR01                          00240300
                     AGO   .ZPRNTXX                                     00240400
.ZPRINTX             PRINT ON                                           00240500
.ZPRNTXX             ANOP  ,                                            00240600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00240700
         LCLC  &T1                                                      00240800
         AIF   ('&XOPER' NE 'STOP').NOTSTOP                             00240900
         AIF ('&MF' EQ '').OKRET                                        00241000
&T1      SETC  'MF is not valid with the STOP option'                   00241100
         MNOTE 8,'&T1'                                                  00241200
         POP   PRINT                                                    00241300
         MEXIT                                                          00241400
.OKRET   ANOP                                                           00241500
         LHI   0,5                     Indicate "STOP"                  00241600
         &ZMAC_LLGT 14,16(0,0)         Get CVT address                  00241700
         L     14,772(14,0)            Get SFT address                  00241800
         L     14,496(14,0)            Get LX/EX for service rtn        00241900
         PC    0(14)                                                    00242000
         AIF   (N'&RETCODE LE 0).GSFMRETX                               00242100
         AIF   ('&XRETCODE'(1,1) EQ '(').GSFMRET2                       00242200
         AIF   ('&XRETCODE' EQ 'GPR15').GSFMRETX                        00242300
         AIF   ('&XRETCODE' EQ 'REG15').GSFMRETX                        00242400
         AIF   ('&XRETCODE' EQ 'R15').GSFMRETX                          00242500
         AIF   ('&XRETCODE' EQ '15').GSFMRETX                           00242600
         ST    15,&XRETCODE                                             00242700
         AGO   .GSFMRETX                                                00242800
.GSFMRET2 ANOP  ,                                                       00242900
&ZCGPR   SETC  '&XRETCODE'(2,K'&XRETCODE-2)                             00243000
         AIF   ('&ZCGPR' EQ 'GPR15').GSFMRETX                           00243100
         AIF   ('&ZCGPR' EQ 'REG15').GSFMRETX                           00243200
         AIF   ('&ZCGPR' EQ 'R15').GSFMRETX                             00243300
         AIF   ('&ZCGPR' EQ '15').GSFMRETX                              00243400
         LR    &ZCGPR,15                                                00243500
.GSFMRETX ANOP  ,                                                       00243600
         AIF   (N'&RSNCODE LE 0).GSFMRSNX                               00243700
         AIF   ('&XRSNCODE'(1,1) EQ '(').GSFMRSN2                       00243800
         AIF   ('&XRSNCODE' EQ 'GPR0').GSFMRSNX                         00243900
         AIF   ('&XRSNCODE' EQ 'GPR00').GSFMRSNX                        00244000
         AIF   ('&XRSNCODE' EQ 'REG0').GSFMRSNX                         00244100
         AIF   ('&XRSNCODE' EQ 'REG00').GSFMRSNX                        00244200
         AIF   ('&XRSNCODE' EQ 'R0').GSFMRSNX                           00244300
         AIF   ('&XRSNCODE' EQ '0').GSFMRSNX                            00244400
         AIF   ('&XRSNCODE' EQ '00').GSFMRSNX                           00244500
         ST    0,&XRSNCODE                                              00244600
         AGO   .GSFMRSNX                                                00244700
.GSFMRSN2 ANOP  ,                                                       00244800
&ZCGPR   SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                             00244900
         AIF   ('&ZCGPR' EQ 'GPR0').GSFMRSNX                            00245000
         AIF   ('&ZCGPR' EQ 'GPR00').GSFMRSNX                           00245100
         AIF   ('&ZCGPR' EQ 'REG0').GSFMRSNX                            00245200
         AIF   ('&ZCGPR' EQ 'REG00').GSFMRSNX                           00245300
         AIF   ('&ZCGPR' EQ 'R0').GSFMRSNX                              00245400
         AIF   ('&ZCGPR' EQ '0').GSFMRSNX                               00245500
         AIF   ('&ZCGPR' EQ '00').GSFMRSNX                              00245600
         LR    &ZCGPR,0                                                 00245700
.GSFMRSNX ANOP  ,                                                       00245800
         POP   PRINT                                                    00245900
         MEXIT                                                          00246000
.NOTSTOP  ANOP                                                          00246100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00246200
.********************************************************************   00246300
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00246400
.********************************************************************   00246500
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00246600
                      LCLA  &ZOPN1         INVOCATION INDEX             00246700
                      LCLC  &ZOPL(4095)    LABEL                        00246800
                      LCLC  &ZOPO(4095)    OPERATION                    00246900
                      LCLC  &ZOPV(4095)    VALUE                        00247000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00247100
.*                                                                      00247200
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00247300
.******************************************************************     00247400
.***AL.L10 IEAGSF FMT=LIST MF=S!L PARAMETERS                            00247500
.******************************************************************     00247600
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00247700
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00247800
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00247900
&XMFATTR              SETC  '0D'                                        00248000
.*                                                                      00248100
&ZOPN                 SETA  &ZOPN+1                                     00248200
&ZOPL(&ZOPN)          SETC  ' '                                         00248300
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00248400
&ZOPV(&ZOPN)          SETC  '4,8'                                       00248500
&ZOPN                 SETA  &ZOPN+1                                     00248600
&ZOPL(&ZOPN)          SETC  ' '                                         00248700
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00248800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00248900
&ZOPD(&ZOPN)          SETC  '++ IEAGSF ARG PARMS'                       00249000
.*                                                                      00249100
&ZOPN                 SETA  &ZOPN+1                                     00249200
&ZOPL(&ZOPN)          SETC  ' '                                         00249300
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00249400
&ZOPV(&ZOPN)          SETC  '1'                                         00249500
&ZOPD(&ZOPN)          SETC  ' '                                         00249600
.*                                                                      00249700
.ZLMFSL2              ANOP  ,                                           00249800
.*-------------------------------------------------------------------   00249900
.***AM.L00  IEAGSF FMT=LIST name                                        00250000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00250100
&ZOPN                 SETA &ZOPN+1                                      00250200
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00250300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00250400
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00250500
&ZOPD(&ZOPN)          SETC '++ IEAGSF NAME'                             00250600
.ZLMFSL2M             ANOP  ,                                           00250700
.*-------------------------------------------------------------------   00250800
.***AM.L01  IEAGSF FMT=LIST PARAMETERS                                  00250900
&ZOPN                 SETA &ZOPN+1                                      00251000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00251100
&ZOPO(&ZOPN)          SETC 'DS'                                         00251200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00251300
&ZOPD(&ZOPN)          SETC '++ IEAGSF PARM LIST'                        00251400
.*-------------------------------------------------------------------   00251500
.***AM.L02 XVERSION XL1                                                 00251600
&ZOPN                 SETA &ZOPN+1                                      00251700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00251800
&ZOPO(&ZOPN)          SETC 'DS'                                         00251900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00252000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00252100
.*-------------------------------------------------------------------   00252200
.***AM.L03 XFLAG1 BL.8                                                  00252300
&ZOPN                 SETA &ZOPN+1                                      00252400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAG1'                           00252500
&ZOPO(&ZOPN)          SETC 'DS'                                         00252600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00252700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00252800
.*                                                                      00252900
&ZOPN                 SETA  &ZOPN+1                                     00253000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_INITIALCONTROLS'         00253100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00253200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00253300
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00253400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INITIALCONTROLS'              00253500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00253600
.*                                                                      00253700
&ZOPN                 SETA  &ZOPN+1                                     00253800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UPDATEMASK'              00253900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00254000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00254100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00254200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UPDATEMASK'                   00254300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00254400
.*-------------------------------------------------------------------   00254500
.***AM.L09  XRSV0001 CL2                                                00254600
&ZOPN                 SETA &ZOPN+1                                      00254700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00254800
&ZOPO(&ZOPN)          SETC 'DS'                                         00254900
&ZOPV(&ZOPN)          SETC 'CL2'                                        00255000
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00255100
.*-------------------------------------------------------------------   00255200
.***AM.L05 XUPDATEMASK XL1                                              00255300
&ZOPN                 SETA &ZOPN+1                                      00255400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUPDATEMASK'                      00255500
&ZOPO(&ZOPN)          SETC 'DS'                                         00255600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00255700
&ZOPD(&ZOPN)          SETC '++ &ZXUPDATEMASK XUPDATEMASK'               00255800
.*                                                                      00255900
&ZOPN                 SETA  &ZOPN+1                                     00256000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_0001'                00256100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00256200
&ZOPV(&ZOPN)          SETC  '1'                                         00256300
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00256400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).0001'                         00256500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00256600
.*                                                                      00256700
&ZOPN                 SETA  &ZOPN+1                                     00256800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_0010'                00256900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00257000
&ZOPV(&ZOPN)          SETC  '2'                                         00257100
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00257200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).0010'                         00257300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00257400
.*                                                                      00257500
&ZOPN                 SETA  &ZOPN+1                                     00257600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_0011'                00257700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00257800
&ZOPV(&ZOPN)          SETC  '3'                                         00257900
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00258000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).0011'                         00258100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00258200
.*                                                                      00258300
&ZOPN                 SETA  &ZOPN+1                                     00258400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_0100'                00258500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00258600
&ZOPV(&ZOPN)          SETC  '4'                                         00258700
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00258800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).0100'                         00258900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00259000
.*                                                                      00259100
&ZOPN                 SETA  &ZOPN+1                                     00259200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_0101'                00259300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00259400
&ZOPV(&ZOPN)          SETC  '5'                                         00259500
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00259600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).0101'                         00259700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00259800
.*                                                                      00259900
&ZOPN                 SETA  &ZOPN+1                                     00260000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_0110'                00260100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00260200
&ZOPV(&ZOPN)          SETC  '6'                                         00260300
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00260400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).0110'                         00260500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00260600
.*                                                                      00260700
&ZOPN                 SETA  &ZOPN+1                                     00260800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_0111'                00260900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00261000
&ZOPV(&ZOPN)          SETC  '7'                                         00261100
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00261200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).0111'                         00261300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00261400
.*                                                                      00261500
&ZOPN                 SETA  &ZOPN+1                                     00261600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_1000'                00261700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00261800
&ZOPV(&ZOPN)          SETC  '8'                                         00261900
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00262000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).1000'                         00262100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00262200
.*                                                                      00262300
&ZOPN                 SETA  &ZOPN+1                                     00262400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_1001'                00262500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00262600
&ZOPV(&ZOPN)          SETC  '9'                                         00262700
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00262800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).1001'                         00262900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00263000
.*                                                                      00263100
&ZOPN                 SETA  &ZOPN+1                                     00263200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_1010'                00263300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00263400
&ZOPV(&ZOPN)          SETC  '10'                                        00263500
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00263600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).1010'                         00263700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00263800
.*                                                                      00263900
&ZOPN                 SETA  &ZOPN+1                                     00264000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_1011'                00264100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00264200
&ZOPV(&ZOPN)          SETC  '11'                                        00264300
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00264400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).1011'                         00264500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00264600
.*                                                                      00264700
&ZOPN                 SETA  &ZOPN+1                                     00264800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_1100'                00264900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00265000
&ZOPV(&ZOPN)          SETC  '12'                                        00265100
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00265200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).1100'                         00265300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00265400
.*                                                                      00265500
&ZOPN                 SETA  &ZOPN+1                                     00265600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_1101'                00265700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00265800
&ZOPV(&ZOPN)          SETC  '13'                                        00265900
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00266000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).1101'                         00266100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00266200
.*                                                                      00266300
&ZOPN                 SETA  &ZOPN+1                                     00266400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_1110'                00266500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00266600
&ZOPV(&ZOPN)          SETC  '14'                                        00266700
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00266800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).1110'                         00266900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00267000
.*                                                                      00267100
&ZOPN                 SETA  &ZOPN+1                                     00267200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUPDATEMASK_1111'                00267300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00267400
&ZOPV(&ZOPN)          SETC  '15'                                        00267500
&ZOPD(&ZOPN)          SETC  '++ XUPDATEMASK.'                           00267600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).1111'                         00267700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00267800
.*-------------------------------------------------------------------   00267900
.***AM.L09  XINITIALCONTROLS CL32                                       00268000
&ZOPN                 SETA &ZOPN+1                                      00268100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINITIALCONTROLS'                 00268200
&ZOPO(&ZOPN)          SETC 'DS'                                         00268300
&ZOPV(&ZOPN)          SETC 'CL32'                                       00268400
&ZOPD(&ZOPN)          SETC '++ &ZXINITIALCONTROLS '                     00268500
.*-------------------------------------------------------------------   00268600
.***AM.L09  XUPDATECONTROLS CL32                                        00268700
&ZOPN                 SETA &ZOPN+1                                      00268800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUPDATECONTROLS'                  00268900
&ZOPO(&ZOPN)          SETC 'DS'                                         00269000
&ZOPV(&ZOPN)          SETC 'CL32'                                       00269100
&ZOPD(&ZOPN)          SETC '++ &ZXUPDATECONTROLS '                      00269200
.*-------------------------------------------------------------------   00269300
.***AM.L09  XTCBTOKEN CL16                                              00269400
&ZOPN                 SETA &ZOPN+1                                      00269500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTCBTOKEN'                        00269600
&ZOPO(&ZOPN)          SETC 'DS'                                         00269700
&ZOPV(&ZOPN)          SETC 'CL16'                                       00269800
&ZOPD(&ZOPN)          SETC '++ &ZXTCBTOKEN '                            00269900
.*-------------------------------------------------------------------   00270000
.***AM.L10 END OF IEAGSF LIST PARAMETERS                                00270100
&ZOPN                 SETA &ZOPN+1                                      00270200
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00270300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00270400
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00270500
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00270600
.*                                                                      00270700
&ZOPN                 SETA &ZOPN+1                                      00270800
&ZOPL(&ZOPN)          SETC ' '                                          00270900
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00271000
&ZOPV(&ZOPN)          SETC '1'                                          00271100
&ZOPD(&ZOPN)          SETC ' '                                          00271200
.*-------------------------------------------------------------------   00271300
.***AL.L12 IEAGSF FMT=LIST MF=S!L PARAMETERS                            00271400
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00271500
.*                                                                      00271600
&ZOPN                 SETA  &ZOPN+1                                     00271700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00271800
&ZOPO(&ZOPN)          SETC  'DC'                                        00271900
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00272000
&ZOPD(&ZOPN)          SETC  '++ IEAGSF ARG PARMS'                       00272100
.*                                                                      00272200
.ZLMFSLX              ANOP  ,                                           00272300
.*-------------------------------------------------------------------   00272400
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00272500
&ZPLLEN               SETA 85                                           00272600
.*                                                                      00272700
.******************************************************************     00272800
.***AI.L01 IEAGSF FMT=LIST FILL IN PARAMETER AREA                       00272900
.******************************************************************     00273000
                      ACTR  10000                                       00273100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00273200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00273300
&ZCVAL                SETC  'LAE'          XAX MODE                     00273400
.ZIMFXA               ANOP ,                                            00273500
.*                                                                      00273600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00273700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00273800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00273900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00274000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00274100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00274200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00274300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00274400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00274500
&ZOPN                 SETA  &ZOPN+1                                     00274600
&ZOPL(&ZOPN)          SETC  ' '                                         00274700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00274800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00274900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00275000
                      AGO   .ZIMFNX                                     00275100
.*                                                                      00275200
.ZIMFN2               ANOP ,                                            00275300
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00275400
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00275500
&ZOPN                 SETA  &ZOPN+1                                     00275600
&ZOPL(&ZOPN)          SETC  ' '                                         00275700
&ZOPO(&ZOPN)          SETC  'LAE'                                       00275800
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00275900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00276000
                      AGO   .ZIMFNX                                     00276100
.ZIMFNX1              ANOP ,                                            00276200
&ZOPN                 SETA  &ZOPN+1                                     00276300
&ZOPL(&ZOPN)          SETC  ' '                                         00276400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00276500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00276600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00276700
.ZIMFNX               ANOP ,                                            00276800
.********************************************************************   00276900
.***AI.L02 IEAGSF FMT=LIST INITIALIZE PARAMETER AREA                    00277000
.********************************************************************   00277100
.***AI.L03 MF=(SLME)                                                    00277200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00277300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00277400
.*                                                                      00277500
&ZOPN                 SETA  &ZOPN+1                                     00277600
&ZOPL(&ZOPN)          SETC  ' '                                         00277700
&ZOPO(&ZOPN)          SETC  'XC'                                        00277800
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00277900
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00278000
.ZIMFLX               ANOP  ,                                           00278100
.*-------------------------------------------------------------------   00278200
.***AI.L05 XFLAG1 BL1                                                   00278300
&ZW                   SETC  ''                                          00278400
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00278500
&ZMS                  SETC  ''                                          00278600
&ZC                   SETC  ''                                          00278700
.*-------------------------------------------------------------------   00278800
.***AI.L08 XFLAG1 "INITIALCONTROLS"                                     00278900
.***      BL1'1XXXXXXX'                                                 00279000
         AIF   ('&INITIALCONTROLS' EQ '').ZI3A                          00279100
&ZW                   SETC  '&ZW.1'                                     00279200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00279300
&ZMS                  SETC  '&ZMS.0'                                    00279400
                      AGO   .ZI3C                                       00279500
.*                                                                      00279600
.ZI3A                 ANOP  ,                                           00279700
&ZW                   SETC  '&ZW.0'                                     00279800
&ZMS                  SETC  '&ZMS.1'                                    00279900
.ZI3C                 ANOP  ,                                           00280000
.*-------------------------------------------------------------------   00280100
.***AI.L08 XFLAG1 "UPDATEMASK"                                          00280200
.***      BL1'X1XXXXXX'                                                 00280300
         AIF   ('&UPDATEMASK' EQ '').ZI4A                               00280400
&ZW                   SETC  '&ZW.1000000'                               00280500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00280600
&ZMS                  SETC  '&ZMS.0111111'                              00280700
                      AGO   .ZI4C                                       00280800
.*                                                                      00280900
.ZI4A                 ANOP  ,                                           00281000
&ZW                   SETC  '&ZW.0000000'                               00281100
&ZMS                  SETC  '&ZMS.1111111'                              00281200
.ZI4C                 ANOP  ,                                           00281300
.*-------------------------------------------------------------------   00281400
.***AI.L11 XFLAG1 BL1                                                   00281500
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI4D               00281600
                      AIF   ('&ZC' NE 'YES').ZI4D                       00281700
&ZOPN                 SETA  &ZOPN+1                                     00281800
&ZOPL(&ZOPN)          SETC  ' '                                         00281900
&ZOPO(&ZOPN)          SETC  'NI'                                        00282000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            00282100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00282200
.ZI4D                 ANOP  ,                                           00282300
                      AIF   ('&ZCLNG' NE 'YES').ZI4E  ALL ZERO BITS     00282400
&ZOPN                 SETA  &ZOPN+1                                     00282500
&ZOPL(&ZOPN)          SETC  ' '                                         00282600
&ZOPO(&ZOPN)          SETC  'OI'                                        00282700
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00282800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00282900
.ZI4E                 ANOP  ,                                           00283000
.*-------------------------------------------------------------------   00283100
.***AI.L07 XUPDATEMASK AL1                                              00283200
&ZW                   SETC  ''                                          00283300
.*-------------------------------------------------------------------   00283400
.***AI.L15 XUPDATEMASK "0001" AL1                                       00283500
         AIF   ('&XUPDATEMASK' NE '0001').ZI7A                          00283600
&ZW                   SETC  '1'                                         00283700
.ZI7A                 ANOP  ,                                           00283800
.*-------------------------------------------------------------------   00283900
.***AI.L15 XUPDATEMASK "0010" AL1                                       00284000
         AIF   ('&XUPDATEMASK' NE '0010').ZI8A                          00284100
&ZW                   SETC  '2'                                         00284200
.ZI8A                 ANOP  ,                                           00284300
.*-------------------------------------------------------------------   00284400
.***AI.L15 XUPDATEMASK "0011" AL1                                       00284500
         AIF   ('&XUPDATEMASK' NE '0011').ZI9A                          00284600
&ZW                   SETC  '3'                                         00284700
.ZI9A                 ANOP  ,                                           00284800
.*-------------------------------------------------------------------   00284900
.***AI.L15 XUPDATEMASK "0100" AL1                                       00285000
         AIF   ('&XUPDATEMASK' NE '0100').ZI10A                         00285100
&ZW                   SETC  '4'                                         00285200
.ZI10A                ANOP  ,                                           00285300
.*-------------------------------------------------------------------   00285400
.***AI.L15 XUPDATEMASK "0101" AL1                                       00285500
         AIF   ('&XUPDATEMASK' NE '0101').ZI11A                         00285600
&ZW                   SETC  '5'                                         00285700
.ZI11A                ANOP  ,                                           00285800
.*-------------------------------------------------------------------   00285900
.***AI.L15 XUPDATEMASK "0110" AL1                                       00286000
         AIF   ('&XUPDATEMASK' NE '0110').ZI12A                         00286100
&ZW                   SETC  '6'                                         00286200
.ZI12A                ANOP  ,                                           00286300
.*-------------------------------------------------------------------   00286400
.***AI.L15 XUPDATEMASK "0111" AL1                                       00286500
         AIF   ('&XUPDATEMASK' NE '0111').ZI13A                         00286600
&ZW                   SETC  '7'                                         00286700
.ZI13A                ANOP  ,                                           00286800
.*-------------------------------------------------------------------   00286900
.***AI.L15 XUPDATEMASK "1000" AL1                                       00287000
         AIF   ('&XUPDATEMASK' NE '1000').ZI14A                         00287100
&ZW                   SETC  '8'                                         00287200
.ZI14A                ANOP  ,                                           00287300
.*-------------------------------------------------------------------   00287400
.***AI.L15 XUPDATEMASK "1001" AL1                                       00287500
         AIF   ('&XUPDATEMASK' NE '1001').ZI15A                         00287600
&ZW                   SETC  '9'                                         00287700
.ZI15A                ANOP  ,                                           00287800
.*-------------------------------------------------------------------   00287900
.***AI.L15 XUPDATEMASK "1010" AL1                                       00288000
         AIF   ('&XUPDATEMASK' NE '1010').ZI16A                         00288100
&ZW                   SETC  '10'                                        00288200
.ZI16A                ANOP  ,                                           00288300
.*-------------------------------------------------------------------   00288400
.***AI.L15 XUPDATEMASK "1011" AL1                                       00288500
         AIF   ('&XUPDATEMASK' NE '1011').ZI17A                         00288600
&ZW                   SETC  '11'                                        00288700
.ZI17A                ANOP  ,                                           00288800
.*-------------------------------------------------------------------   00288900
.***AI.L15 XUPDATEMASK "1100" AL1                                       00289000
         AIF   ('&XUPDATEMASK' NE '1100').ZI18A                         00289100
&ZW                   SETC  '12'                                        00289200
.ZI18A                ANOP  ,                                           00289300
.*-------------------------------------------------------------------   00289400
.***AI.L15 XUPDATEMASK "1101" AL1                                       00289500
         AIF   ('&XUPDATEMASK' NE '1101').ZI19A                         00289600
&ZW                   SETC  '13'                                        00289700
.ZI19A                ANOP  ,                                           00289800
.*-------------------------------------------------------------------   00289900
.***AI.L15 XUPDATEMASK "1110" AL1                                       00290000
         AIF   ('&XUPDATEMASK' NE '1110').ZI20A                         00290100
&ZW                   SETC  '14'                                        00290200
.ZI20A                ANOP  ,                                           00290300
.*-------------------------------------------------------------------   00290400
.***AI.L15 XUPDATEMASK "1111" AL1                                       00290500
         AIF   ('&XUPDATEMASK' NE '1111').ZI21A                         00290600
&ZW                   SETC  '15'                                        00290700
.ZI21A                ANOP  ,                                           00290800
.*-------------------------------------------------------------------   00290900
.***AI.L17 XUPDATEMASK AL1                                              00291000
                      AIF   ('&ZW' NE '0').ZI21C                        00291100
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI21B             00291200
.ZI21C                ANOP  ,                                           00291300
                      AIF   ('&ZW' EQ '').ZI21B                         00291400
.*                                                                      00291500
&ZOPN                 SETA  &ZOPN+1                                     00291600
&ZOPL(&ZOPN)          SETC  ' '                                         00291700
&ZOPO(&ZOPN)          SETC  'MVI'                                       00291800
&ZOPV(&ZOPN)          SETC  '4(1),&ZW'                                  00291900
&ZOPD(&ZOPN)          SETC  '++ &ZXUPDATEMASK XUPDATEMASK'              00292000
.ZI21B                ANOP  ,                                           00292100
.*-------------------------------------------------------------------   00292200
.***AI.L25  XINITIALCONTROLS CL32                                       00292300
                      AIF   ('&ZXINITIALCONTROLS' EQ '').ZI22E          00292400
                      AIF   ('&ZXINITIALCONTROLS' EQ 'OUTPUT').ZI22E    00292500
&ZCGPR                SETC  '&XINITIALCONTROLS'                         00292600
         AIF   ('&XINITIALCONTROLS' NE '0').ZI22A                       00292700
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI22E                          00292800
.*                                                                      00292900
&ZCGPR                SETC  '=XL32''00'''                               00293000
.ZI22A                ANOP  ,                                           00293100
.*                                                                      00293200
                      AIF   ('&XINITIALCONTROLS'(1,1) NE '(').ZI22B     00293300
&ZCGPR   SETC  '0('.'&XINITIALCONTROLS'(2,K'&XINITIALCONTROLS-2).')'    00293400
                      AGO   .ZI22D                                      00293500
.ZI22B                ANOP  ,                                           00293600
.*                                                                      00293700
                      AIF   ('&INITIALCONTROLS(1)' EQ '').ZI22I         00293800
&ZC                   SETC  '0'                                         00293900
                      AIF   ('&XINITIALCONTROLS' NE '&ZC').ZI22C        00294000
.ZI22I                ANOP  ,                                           00294100
&ZCGPR                SETC  '=CL32''&XINITIALCONTROLS'''                00294200
.ZI22C                ANOP  ,                                           00294300
.*                                                                      00294400
.ZI22D                ANOP  ,                                           00294500
.*                                                                      00294600
&ZOPN                 SETA  &ZOPN+1                                     00294700
&ZOPL(&ZOPN)          SETC  ' '                                         00294800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00294900
&ZOPV(&ZOPN)          SETC  '5(32,1),&ZCGPR'                            00295000
&ZOPD(&ZOPN)          SETC  '++ &ZXINITIALCONTROLS XINITIALCONTROLS'    00295100
.*                                                                      00295200
.ZI22E                ANOP  ,                                           00295300
.*-------------------------------------------------------------------   00295400
.***AI.L25  XUPDATECONTROLS CL32                                        00295500
                      AIF   ('&ZXUPDATECONTROLS' EQ '').ZI23E           00295600
                      AIF   ('&ZXUPDATECONTROLS' EQ 'OUTPUT').ZI23E     00295700
&ZCGPR                SETC  '&XUPDATECONTROLS'                          00295800
.*                                                                      00295900
                      AIF   ('&XUPDATECONTROLS'(1,1) NE '(').ZI23B      00296000
&ZCGPR   SETC  '0('.'&XUPDATECONTROLS'(2,K'&XUPDATECONTROLS-2).')'      00296100
.ZI23B                ANOP  ,                                           00296200
.*                                                                      00296300
&ZOPN                 SETA  &ZOPN+1                                     00296400
&ZOPL(&ZOPN)          SETC  ' '                                         00296500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00296600
&ZOPV(&ZOPN)          SETC  '37(32,1),&ZCGPR'                           00296700
&ZOPD(&ZOPN)          SETC  '++ &ZXUPDATECONTROLS XUPDATECONTROLS'      00296800
.*                                                                      00296900
.ZI23E                ANOP  ,                                           00297000
.*-------------------------------------------------------------------   00297100
.***AI.L25  XTCBTOKEN CL16                                              00297200
                      AIF   ('&ZXTCBTOKEN' EQ '').ZI24E                 00297300
                      AIF   ('&ZXTCBTOKEN' EQ 'OUTPUT').ZI24E           00297400
&ZCGPR                SETC  '&XTCBTOKEN'                                00297500
.*                                                                      00297600
                      AIF   ('&XTCBTOKEN'(1,1) NE '(').ZI24B            00297700
&ZCGPR   SETC  '0('.'&XTCBTOKEN'(2,K'&XTCBTOKEN-2).')'                  00297800
.ZI24B                ANOP  ,                                           00297900
.*                                                                      00298000
&ZOPN                 SETA  &ZOPN+1                                     00298100
&ZOPL(&ZOPN)          SETC  ' '                                         00298200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00298300
&ZOPV(&ZOPN)          SETC  '69(16,1),&ZCGPR'                           00298400
&ZOPD(&ZOPN)          SETC  '++ &ZXTCBTOKEN XTCBTOKEN'                  00298500
.*                                                                      00298600
.ZI24E                ANOP  ,                                           00298700
.*-------------------------------------------------------------------   00298800
&ZOPN1                SETA &ZOPN                                        00298900
.*-------------------------------------------------------------------   00299000
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00299100
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00299200
.*******************************************************************    00299300
.***  PROCESS IEAGSF OUTPUT PARAMETERS                                  00299400
.*******************************************************************    00299500
                      ACTR  10000                                       00299600
.*******************************************************************    00299700
.***AO.X02  RETURN CODE PROCESSING                                      00299800
.*******************************************************************    00299900
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00300000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00300100
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00300200
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00300300
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00300400
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00300500
&ZOPN                 SETA  &ZOPN+1                                     00300600
&ZOPL(&ZOPN)          SETC  ' '                                         00300700
&ZOPO(&ZOPN)          SETC  'ST'                                        00300800
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00300900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00301000
                      AGO   .ZMRETX                                     00301100
.*                                                                      00301200
.ZMRET2               ANOP  ,                                           00301300
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00301400
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00301500
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00301600
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00301700
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00301800
&ZOPN                 SETA  &ZOPN+1                                     00301900
&ZOPL(&ZOPN)          SETC  ' '                                         00302000
&ZOPO(&ZOPN)          SETC  'LR'                                        00302100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00302200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00302300
.ZMRETX               ANOP  ,                                           00302400
.*******************************************************************    00302500
.***AO.X03  REASON CODE PROCESSING                                      00302600
.*******************************************************************    00302700
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00302800
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00302900
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00303000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00303100
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00303200
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00303300
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00303400
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00303500
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00303600
&ZOPN                 SETA  &ZOPN+1                                     00303700
&ZOPL(&ZOPN)          SETC  ' '                                         00303800
&ZOPO(&ZOPN)          SETC  'ST'                                        00303900
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00304000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00304100
                      AGO   .ZMRSNX                                     00304200
.*                                                                      00304300
.ZMRSN2               ANOP  ,                                           00304400
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00304500
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00304600
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00304700
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00304800
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00304900
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00305000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00305100
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00305200
&ZOPN                 SETA  &ZOPN+1                                     00305300
&ZOPL(&ZOPN)          SETC  ' '                                         00305400
&ZOPO(&ZOPN)          SETC  'LR'                                        00305500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00305600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00305700
.ZMRSNX               ANOP  ,                                           00305800
.*******************************************************************    00305900
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00306000
.*******************************************************************    00306100
.ZMFLX                ANOP  ,              MF=L PROCESSING              00306200
.*******************************************************************    00306300
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00306400
.*******************************************************************    00306500
                      ACTR  10000                                       00306600
.*                                                                      00306700
                      LCLA  &ZLC           COLUMN POSITION              00306800
                      LCLA  &ZOPX          LIST TABLE INDEX             00306900
                      LCLC  &ZLL           LABEL                        00307000
                      LCLC  &ZLOP          OPERATION                    00307100
                      LCLC  &ZLV           VALUE                        00307200
                      LCLC  &ZLD           DESCRIPTION                  00307300
.*                                                                      00307400
&ZOPX                 SETA  1                                           00307500
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00307600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00307700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00307800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00307900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00308000
                      AIF   (K'&ZLD LE 0).ZL5                           00308100
&ZLC                  SETA  35             COMMENT COLUMN               00308200
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00308300
&ZLC                  SETA  33             COMMMENT COLUMN              00308400
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00308500
&ZLV                  SETC  '&ZLV'.' '                                  00308600
                      AGO   .ZL3                                        00308700
.*                                                                      00308800
.ZL4                  ANOP  ,                                           00308900
&ZLV                  SETC  '&ZLV'.' '                                  00309000
.ZL5                  ANOP  ,                                           00309100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00309200
.*                                                                      00309300
&ZLL     &ZLOP &ZLV                                                     00309400
.*                                                                      00309500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00309600
                      AGO   .ZL2           CONTINUE LOOPING             00309700
.*                                                                      00309800
.ZLX                  ANOP  ,                                           00309900
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00310000
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00310100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00310200
.* Note that function codes 0-4 are reserved for IEAFP                  00310300
         AIF   ('&XOPER' EQ 'UPDATE').SET7                              00310400
.SET6    ANOP                                                           00310500
         LHI   0,6                     Indicate "START"                 00310600
         AGO   .CALL                                                    00310700
.SET7    ANOP                                                           00310800
         LHI   0,7                     Indicate "UPDATE"                00310900
         AGO   .CALL                                                    00311000
.CALL    ANOP                                                           00311100
         &ZMAC_LLGT 14,16(0,0)         Get CVT address                  00311200
         L     14,772(14,0)            Get SFT address                  00311300
         L     14,496(14,0)            Get LX/EX for service rtn        00311400
         PC    0(14)                                                    00311500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00311600
.ZLINKX               ANOP  ,                                           00311700
.*******************************************************************    00311800
.***AP.X01  FORMAT GENERATED CODE                                       00311900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00312000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00312100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00312200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00312300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00312400
                      AIF   (K'&ZLD LE 0).ZL51                          00312500
&ZLC                  SETA  35             COMMENT COLUMN               00312600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00312700
&ZLC                  SETA  33             COMMENT COLUMN               00312800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00312900
&ZLV                  SETC  '&ZLV'.' '                                  00313000
                      AGO   .ZL31                                       00313100
.*                                                                      00313200
.ZL41                 ANOP  ,                                           00313300
&ZLV                  SETC  '&ZLV'.' '                                  00313400
.ZL51                 ANOP  ,                                           00313500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00313600
.*                                                                      00313700
&ZLL     &ZLOP &ZLV                                                     00313800
.*                                                                      00313900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00314000
                      AGO   .ZL21          CONTINUE LOOPING             00314100
.*                                                                      00314200
.ZLX1                 ANOP  ,                                           00314300
.*******************************************************************    00314400
.***AP.X02  END OF IEAGSF MACRO                                         00314500
&ZIEAGSF              SETC  'YES'          SET IEAGSF USED              00314600
         POP   PRINT                                                    00314700
*                                            IEAGSF-0                   00314800
         SPACE 1                                                        00314900
.ZLX2                 ANOP  ,                                           00315000
         MEND                                                           00315100
**********************************************************************/ 00315200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00315300
*%IEAGSF: MACRO KEYS(START,INITIALCONTROLS,STOP,UPDATE,TCBTOKEN,        00315400
*                 UPDATECONTROLS,UPDATEMASK,RETCODE,RSNCODE,PLISTVER,   00315500
*                 MF);                                                  00315600
*  ANS('?'!!MACLABEL!!' '!!'IEAGSFP '!!MACLIST!!                        00315700
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00315800
*%END IEAGSF;                                                           00315900

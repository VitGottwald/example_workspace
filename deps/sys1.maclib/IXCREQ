*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXCREQ                                -01/13/18-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Format a request for the XCF Server           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 2011, 2011                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7780                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      This macro expands inline to initialize and format an area     * 00002100
*      that can then be used with the XCF Client/Server Send          * 00002200
*      Interface (IXCSEND) to send a request to the XCF Server for    * 00002300
*      processing. The IXCREQ macro is used to construct a request    * 00002400
*      message that is supported by the XCF Server.  A request        * 00002500
*      message is constructed using the List and Modify forms of the  * 00002600
*      IXCREQ macro and specifying on the modify invocation the       * 00002700
*      desired server function, options and information selection     * 00002800
*      criteria to be used by the XCF Server when processing the      * 00002900
*      request.  The area defined by the List form of the IXCREQ      * 00003000
*      macro and updated by the Modify form is an XCF Server request  * 00003100
*      message that can be sent to the XCF Server.                    * 00003200
*                                                                     * 00003300
*      The List form accepts no variable parameters and is used only  * 00003400
*      to reserve storage for the request message.  The Modify form   * 00003500
*      is provided for use with the List form for formatting a        * 00003600
*      specific request message that can be processed by an XCF       * 00003700
*      Server.                                                        * 00003800
*                                                                     * 00003900
*      To send a request to an XCF Server, and receive the results of * 00004000
*      the request, the requestor must do the following:              * 00004100
*                                                                     * 00004200
*                                                                     * 00004300
*      o   Construct an XCF Server request using the IXCREQ macro     * 00004400
*                                                                     * 00004500
*      o   Use the XCF Client/Server Send Interface (IXCSEND) to send * 00004600
*          a request to the XCF server                                * 00004700
*                                                                     * 00004800
*      o   Use the XCF Client/Server Receive Interface (IXCRECV) to   * 00004900
*          receive the response data from system(s) that provided     * 00005000
*          responses                                                  * 00005100
*                                                                     * 00005200
*      o   Interpret the XCF Server response data using the data      * 00005300
*          mappings in the IXCYSRVR macro                             * 00005400
*                                                                     * 00005500
*                                                                     * 00005600
*                                                                     * 00005700
*      The IXCREQ macro can be used to format a request message for   * 00005800
*      the following types of requests supported by the XCF Server:   * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*      o   SERVERINFO                                                 * 00006200
*                                                                     * 00006300
*          A SERVERINFO request can be used to collect information    * 00006400
*          about application and system servers defined to XCF on any * 00006500
*          system in the sysplex. Information about servers defined   * 00006600
*          to XCF on the local system or any other system in the      * 00006700
*          sysplex is returned to the requestor in a data area        * 00006800
*          provided on the XCF Client/Server Receive Interface        * 00006900
*          (IXCRECV).                                                 * 00007000
*                                                                     * 00007100
*          The returned SERVERINFO response data is defined by        * 00007200
*          mappings provided in the IXCYSRVR macro.  See the          * 00007300
*          following mappings for information on the content of the   * 00007400
*          response data, which is determined by the request          * 00007500
*          selection criteria specified on the IXCREQ request:        * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*          -   ixcysrvr_tSrvrInfoAA - server information answer area  * 00007900
*                                                                     * 00008000
*          -   ixcysrvr_tSrvrInfoDR - server definition record        * 00008100
*                                                                     * 00008200
*          -   ixcysrvr_tSrvrInfoHR - server data header record       * 00008300
*                                                                     * 00008400
*          -   ixcysrvr_tSrvrInfoWI - server work item record         * 00008500
*                                                                     * 00008600
*          -   ixcysrvr_tSrvrInfoIR - server instance record          * 00008700
*                                                                     * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*      o   Sending a Request to the XCF Server                        * 00009400
*                                                                     * 00009500
*          To send a server request to the XCF Server, the client     * 00009600
*          must first construct an XCF Server request message using   * 00009700
*          the IXCREQ macro then use the IXCSEND macro to send the    * 00009800
*          request message to the XCF Server. Specify the following   * 00009900
*          on the IXCSEND macro to send a server request to the XCF   * 00010000
*          Server:                                                    * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*          1.  Specify the message content to be sent to the XCF      * 00010400
*              server using the MSGDATA or MSGDESC keywords on the    * 00010500
*              IXCSEND macro.  The message content is the output from * 00010600
*              the LIST and MODIFY form of an IXCREQ macro            * 00010700
*              invocation. MSGLEN (or the dd_DataSize field of a      * 00010800
*              message descriptor if MSGDESC is used) must be set to  * 00010900
*              the length of the IXCREQ defined area generated by the * 00011000
*              List form of the IXCREQ macro. An EQU statement is     * 00011100
*              generated by the IXCREQ List form expansion assigning  * 00011200
*              the length of the IXCREQ defined area to a symbol that * 00011300
*              can be used on the IXCSEND invocation.                 * 00011400
*                                                                     * 00011500
*          2.  Allow the MSGCNTL keyword to default to 0. The XCF     * 00011600
*              Server expects the MSGCNTL metadata for a request to   * 00011700
*              be unused by the client.                               * 00011800
*                                                                     * 00011900
*          3.  Identify the XCF server as the target to receive the   * 00012000
*              message using the SENDTO=SERVER and SERVER keywords on * 00012100
*              the IXCSEND macro.  The XCF Server Name can be found   * 00012200
*              in the IXCYSRVR macro and can be defined by specifying * 00012300
*              the following in a program or using the EQUs in        * 00012400
*              IXCYSRVR to define a constant:                         * 00012500
*                                                                     * 00012600
*              IXCYSRVR_XCFSERVERNAME DC CL32'SYSXCF  IXCREQ          * 00012700
*              '                                                      * 00012800
*                                                                     * 00012900
*              The XCF Server name must be padded with EBCDIC blanks  * 00013000
*                                                                     * 00013100
*          4.  Identify what function is being requested from the XCF * 00013200
*              server using the FUNCTION keyword. The functions       * 00013300
*              supported by the XCF Server can be found in the        * 00013400
*              IXCYSRVR macro.                                        * 00013500
*                                                                     * 00013600
*          5.  Indicate that a reply is expected from the XCF Server  * 00013700
*              by specifying EXPECTREPLY=YES.                         * 00013800
*                                                                     * 00013900
*          6.  Specify appropriate RESPTIME and HOLDTIME values.      * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*              -   RESPTIME: The sender should indicate how long it   * 00014300
*                  is willing to wait for the responses to arrive     * 00014400
*                  from all the XCF Servers that the request was send * 00014500
*                  to.                                                * 00014600
*                                                                     * 00014700
*              -   HOLDTIME:  The sender indicates how much time XCF  * 00014800
*                  should allow for the sender to retrieve the        * 00014900
*                  responses using the IXCRECV macro.                 * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*          7.  Specify the SENDER keyword to identify the request     * 00015400
*              sender and the DESCRIPTION keyword to indicate the     * 00015500
*              description of the request.                            * 00015600
*                                                                     * 00015700
*          8.  Use the CRITERIA keyword to indicate the level of XCF  * 00015800
*              Server support desired. The current XCF Server         * 00015900
*              supports a server level of zero (0).  The CRITERIA     * 00016000
*              keyword on the IXCSEND macro is not required for       * 00016100
*              currently supported XCF Server requests. If desired,   * 00016200
*              the XCF criteria defaults can be specified (for        * 00016300
*              example, CRITERIA=DEFAULT).  Specifying a non-zero     * 00016400
*              value for any of the server selection criteria defined * 00016500
*              by mapping IXCYSRVR_TCRITERIA will prevent the XCF     * 00016600
*              Server from receiving the client request.              * 00016700
*                                                                     * 00016800
*          9.  Select the target systems to send the XCF Server       * 00016900
*              request to. The request can be sent to any combination * 00017000
*              of active systems in the sysplex. See the SYSTEMS      * 00017100
*              keyword on the IXCSEND macro for more information on   * 00017200
*              selecting systems to send the request to.  IXCSEND     * 00017300
*              will return a token to the requestor (RETMSGTOKEN) to  * 00017400
*              represent the request. The token is used to identify   * 00017500
*              the request when invoking the IXCRECV macro (keyword   * 00017600
*              MSGTOKEN) to receive the response data for the         * 00017700
*              request.                                               * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*          On each target system, the XCF server receives the client  * 00018100
*          request. The server processes the request and sends the    * 00018200
*          response back to the local system for collection and       * 00018300
*          return to the requestor.                                   * 00018400
*                                                                     * 00018500
*      o   Receiving Responses from the XCF Server                    * 00018600
*                                                                     * 00018700
*          You use the IXCRECV macro to retrieve the XCF Server       * 00018800
*          responses for a request sent by IXCSEND. The request       * 00018900
*          completes normally when all the expected responses arrive. * 00019000
*          If all the expected responses do not arrive within the     * 00019100
*          specified RESPTIME,  XCF considers the request to have     * 00019200
*          completed.  If the requestor does not receive the results  * 00019300
*          of a completed request within HOLDTIME seconds, XCF        * 00019400
*          discards the request results and responses.                * 00019500
*                                                                     * 00019600
*          Take the following steps to determine whether response     * 00019700
*          data was returned by an XCF Server:                        * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*          1.  Establish addressability to the storage provided on    * 00020100
*              the IXCRECV ANSAREA and DATAAREA keywords.             * 00020200
*                                                                     * 00020300
*          2.  Each target/response descriptor record returned in the * 00020400
*              IXCRECV ANSAREA represents a target system that the    * 00020500
*              request was sent to and a response was expected from.  * 00020600
*              aa_#Desc specifies the number of target/response       * 00020700
*              descriptor entries returned in the ANSAREA.            * 00020800
*                                                                     * 00020900
*          3.  The rd_RespCode.RespCode_RC1 field of the response     * 00021000
*              record will contain the value ixcysrvr_RC1_Replied     * 00021100
*              (08x) when a reply was received from the target        * 00021200
*              system.                                                * 00021300
*                                                                     * 00021400
*              Once it is determined that a response was received     * 00021500
*              from a target XCF Server on the system named in the    * 00021600
*              td_SysName field, the rd_RespRetcode and               * 00021700
*              rd_RespRsncode fields can be used to determine the     * 00021800
*              results of the XCF Server request. A value of zero (0) * 00021900
*              in the rd_RespRetcode field indicates that the request * 00022000
*              completed successfully. When the request completed     * 00022100
*              successfully, response data is sent by the target XCF  * 00022200
*              Server to the originating system.                      * 00022300
*              rd_MsgDesc.md_MsgAvailable will indicate when response * 00022400
*              data is available in the storage area identified by    * 00022500
*              the IXCRECV DATAAREA keyword.                          * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*                                                                     * 00023100
*      The IXCREQ macro is provided in PL/X and assembler formats.    * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*01* INPUT REGISTER INFORMATION:                                      * 00023500
*                                                                     * 00023600
*    Before issuing the IXCREQ macro, the caller does not have to     * 00023700
*    place any information into any register unless using it in       * 00023800
*    register notation for a particular parameter, or using it as a   * 00023900
*    base register.                                                   * 00024000
*                                                                     * 00024100
*01* OUTPUT REGISTER INFORMATION:                                     * 00024200
*                                                                     * 00024300
*    When control returns to the caller, the GPRs contain:            * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*    REGISTER    CONTENTS                                             * 00024700
*                                                                     * 00024800
*    0           Unchanged                                            * 00024900
*                                                                     * 00025000
*    1           Used as a work register by the system                * 00025100
*                                                                     * 00025200
*    2-15        Unchanged                                            * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*                                                                     * 00025600
*    When control returns to the caller, the ARs contain:             * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*    REGISTER    CONTENTS                                             * 00026000
*                                                                     * 00026100
*    0           Unchanged                                            * 00026200
*                                                                     * 00026300
*    1           Used as a work register by the system                * 00026400
*                                                                     * 00026500
*    2-15        Unchanged                                            * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*    Some callers depend on register contents remaining the same      * 00027000
*    before and after issuing a service.  If the system changes the   * 00027100
*    contents of registers on which the caller depends, the caller    * 00027200
*    must save them before issuing the service, and restore them      * 00027300
*    after the system returns control.                                * 00027400
*                                                                     * 00027500
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00027600
*                                                                     * 00027700
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00027800
*                                                                     * 00027900
*01* ENVIRONMENT:                                                     * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*      Dispatchable unit mode: Task or SRB mode.                      * 00028300
*                                                                     * 00028400
*      Minimum authorization: None, although Supervisor state or PKM  * 00028500
*                        allowing keys 0-7 is required to invoke the  * 00028600
*                        IXCSEND macro service that is used to send   * 00028700
*                        the IXCREQ request to the XCF Server Task.   * 00028800
*                                                                     * 00028900
*      AMODE:            31- or 64-bit.                               * 00029000
*                                                                     * 00029100
*                        If in 64-bit mode, specify SYSSTATE          * 00029200
*                        AMODE64=YES before invoking this macro.      * 00029300
*                                                                     * 00029400
*      ASC mode:         Primary or Access Register.                  * 00029500
*                                                                     * 00029600
*                        If in Access Register ASC mode, specify      * 00029700
*                        SYSSTATE ASCENV=AR before invoking this      * 00029800
*                        macro.                                       * 00029900
*                                                                     * 00030000
*                        Any primary address space; any secondary     * 00030100
*                        address space; any home address space.       * 00030200
*                                                                     * 00030300
*      Interrupt status: Enabled or disabled for I/O and external     * 00030400
*                        interrupts                                   * 00030500
*                                                                     * 00030600
*      Locks:            No locks held or locks held                  * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*01* RESTRICTIONS:                                                    * 00031100
*    No restrictions.                                                 * 00031200
*                                                                     * 00031300
*01* SYNTAX:                                                          * 00031400
*                                                                     * 00031500
*Ýxlabel¨  IXCREQ  Ô  REQUEST=SERVERINFO                              * 00031600
*                  !   Ð ,LISTALL                                     * 00031700
*                  !   Ô ,SERVER=xserver                              * 00031800
*                  !   ¿ ,SERVERID=xserverid                          * 00031900
*                  !    Ý,INFOTYPE=SUMMARY!WORK!INSTANCE¨             * 00032000
*                  !Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨           * 00032100
*                  Ð ,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)               * 00032200
*                  Ô ,MF=(L,xmfctrl»,xmfattr!0Dº)                     * 00032300
*                  ¿ ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)               * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*      Where:                                                         * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*      Ýxlabel¨                                                       * 00033000
*          is an optional symbol, starting in column 1, that is the   * 00033100
*          name on the IXCREQ macro invocation.  The name must        * 00033200
*          conform to the rules for an ordinary assembler language    * 00033300
*          symbol.                                                    * 00033400
*          DEFAULT: No name.                                          * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*      REQUEST=»SERVERINFO                                            * 00034000
*          is a required keyword input that indicates which request   * 00034100
*          is to be formatted for the XCF server(s) to process.       * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*          REQUEST=SERVERINFO                                         * 00034500
*              Obtain server definition, server message delivery,     * 00034600
*              work item and server instance information.             * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*              The following is a set of mutually exclusive keys.     * 00035000
*              This set is required; only one key must be specified.  * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*              LISTALL                                                * 00035400
*                  keyword to request information about all servers   * 00035500
*                  defined to XCF on a system.                        * 00035600
*                                                                     * 00035700
*              SERVER=xserver                                         * 00035800
*                  belongs to a set of mutually exclusive keys. It is * 00035900
*                  the name (RS-type), or address in register         * 00036000
*                  (2)-(12), of a 32 character input variable         * 00036100
*                  containing the name of the server name or server   * 00036200
*                  name pattern for which information is to be        * 00036300
*                  returned for.                                      * 00036400
*                                                                     * 00036500
*                  Server names and server name patterns are mapped   * 00036600
*                  by ixcysrvr_tName (macro IXCYSRVR).  Server names  * 00036700
*                  and server name patterns consist of four 8 byte    * 00036800
*                  sections.  Each 8 byte section must be left        * 00036900
*                  justified, padded on the right with EBCDIC blanks  * 00037000
*                  as needed.  Each section can contain any           * 00037100
*                  alphanumeric (A-Z,a-z,0-9), national (@,#,$), or   * 00037200
*                  underscore (_) character.  Any section but the     * 00037300
*                  first can be entirely blank.  Any section can      * 00037400
*                  contain a pattern with wild card characters.  A    * 00037500
*                  question mark ('?') within the pattern will match  * 00037600
*                  any one character and an asterisk ('*') within the * 00037700
*                  pattern will match any sequence of zero or more    * 00037800
*                  characters.  Server names are case sensitive.      * 00037900
*                                                                     * 00038000
*              SERVERID=xserverid                                     * 00038100
*                  belongs to a set of mutually exclusive keys. It is * 00038200
*                  the name (RS-type), or address in register         * 00038300
*                  (2)-(12), of a 16 character input variable that    * 00038400
*                  contains the server ID of the specific server      * 00038500
*                  instance for which information is to be returned   * 00038600
*                  for.                                               * 00038700
*                                                                     * 00038800
*                  ServerIDs for server instances of a server are     * 00038900
*                  available in the srvrIir_ServerID field of a       * 00039000
*                  ixcysrvr_tSrvrInfoIR record for an IXCREQ          * 00039100
*                  SERVERINFO request that specified                  * 00039200
*                  INFOTYPE=INSTANCE.                                 * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*              End of a set of mutually exclusive required keys.      * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*              ÝINFOTYPE=SUMMARY!WORK!INSTANCE¨                       * 00040100
*                  is an optional group of keyword input(s) that      * 00040200
*                  indicates the type of server information to be     * 00040300
*                  obtained and returned in the DATAAREA provided on  * 00040400
*                  the IXCRECV macro service.  The contents and       * 00040500
*                  mapping of the data area depends on the the        * 00040600
*                  particular request.  See mapping macro IXCYSRVR    * 00040700
*                  for details.                                       * 00040800
*                  DEFAULT: SUMMARY                                   * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                  INFOTYPE=SUMMARY                                   * 00041200
*                      Obtain summary information that describes a    * 00041300
*                      server.                                        * 00041400
*                                                                     * 00041500
*                  INFOTYPE=WORK                                      * 00041600
*                      Obtain information that describes work that is * 00041700
*                      pending for processing by the server and       * 00041800
*                      currently being worked on by the server.       * 00041900
*                                                                     * 00042000
*                  INFOTYPE=INSTANCE                                  * 00042100
*                      Obtain information about the instantiated      * 00042200
*                      server instance(s).                            * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*                                                                     * 00042700
*                                                                     * 00042800
*                                                                     * 00042900
*                                                                     * 00043000
*                                                                     * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00043400
*          is an optional byte input decimal value in the "0-0" range * 00043500
*          that specifies the macro version.  PLISTVER is the only    * 00043600
*          key allowed on the list form of MF and determines which    * 00043700
*          parameter list is generated.  Note that MAX may be         * 00043800
*          specified instead of a number, and the parameter list will * 00043900
*          be of the largest size currently supported. This size may  * 00044000
*          grow from release to release (thus possibly affecting the  * 00044100
*          amount of storage needed by your program).  If your        * 00044200
*          program can tolerate this, IBM recommends that you always  * 00044300
*          specify MAX when creating the list form parameter list as  * 00044400
*          that will ensure that the list form parameter list is      * 00044500
*          always long enough to hold whatever parameters might be    * 00044600
*          specified on the execute form.                             * 00044700
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00044800
*          default is the lowest version which allows all of the      * 00044900
*          parameters specified on the invocation to be processed.    * 00045000
*                                                                     * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*      MF=»E!L!Mº                                                     * 00045500
*          is a required keyword input which specifies the macro      * 00045600
*          form.                                                      * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*           MF(E,xmfctrl»,COMPLETE!NOCHECKº)                          * 00046000
*              specifies the execute form of the macro.  The "E" form * 00046100
*              generates code to put the parameters into the          * 00046200
*              parameter list specified by xmfctrl and invoke the     * 00046300
*              desired service.                                       * 00046400
*                                                                     * 00046500
*            ,xmfctrl                                                 * 00046600
*              is a required input.  It is the name (RS-type), or     * 00046700
*              address in register (1)-(12), of a storage area for    * 00046800
*              the parameter list.                                    * 00046900
*                                                                     * 00047000
*            »,COMPLETE!NOCHECKº                                      * 00047100
*              is an optional keyword input which specifies the       * 00047200
*              degree of macro parameter syntax checking.             * 00047300
*              DEFAULT: COMPLETE                                      * 00047400
*                                                                     * 00047500
*                                                                     * 00047600
*              COMPLETE                                               * 00047700
*                  Checking for required macro keys is done and       * 00047800
*                  defaults are supplied for omitted optional         * 00047900
*                  parameters.  (See Macro Usage Note 2).             * 00048000
*                                                                     * 00048100
*              NOCHECK                                                * 00048200
*                  Checking for required macro keys is not done nor   * 00048300
*                  are defaults supplied for omitted optional         * 00048400
*                  parameters.                                        * 00048500
*                                                                     * 00048600
*                                                                     * 00048700
*                                                                     * 00048800
*          MF=(L,xmfctrl»,xmfattr!0Dº)                                * 00048900
*              specifies the list form of the macro.  The "L" form    * 00049000
*              defines an area to be used for the parameter list.     * 00049100
*              Only the PLISTVER key may be specified on the          * 00049200
*              invocation.  All other macro parameters are flagged as * 00049300
*              errors.  If PLISTVER is not specified, the original    * 00049400
*              parameter list definition is used.                     * 00049500
*                                                                     * 00049600
*            ,xmfctrl                                                 * 00049700
*              is a required input.  It is the name of a storage area * 00049800
*              for the parameter list.                                * 00049900
*                                                                     * 00050000
*            »,xmfattr!0Dº                                            * 00050100
*              is an optional 60 character input string that varies   * 00050200
*              from 1 to 60 characters. Use it to force boundary      * 00050300
*              alignment of the parameter list. Use only 0F or 0D.    * 00050400
*              DEFAULT: 0D which forces the parameter list to a       * 00050500
*              doubleword boundary.                                   * 00050600
*                                                                     * 00050700
*          MF=(M,xmfctrl»,COMPLETE!NOCHECKº)                          * 00050800
*              specifies the modify form of the macro.  The "M" form  * 00050900
*              generates code to put the parameters into the          * 00051000
*              parameter list specified by xmfctrl.                   * 00051100
*                                                                     * 00051200
*            ,xmfctrl                                                 * 00051300
*              is a required input.  It is the name (RS-type), or     * 00051400
*              address in register (1)-(12), of a storage area for    * 00051500
*              the parameter list.                                    * 00051600
*                                                                     * 00051700
*            »,COMPLETE!NOCHECKº                                      * 00051800
*              is an optional keyword input which specifies the       * 00051900
*              degree of macro parameter syntax checking.             * 00052000
*              DEFAULT: COMPLETE                                      * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*              COMPLETE                                               * 00052400
*                  Checking for required macro keys is done and       * 00052500
*                  defaults are supplied for omitted optional         * 00052600
*                  parameters.  (See Macro Usage Note 2).             * 00052700
*                                                                     * 00052800
*              NOCHECK                                                * 00052900
*                  Checking for required macro keys is not done nor   * 00053000
*                  are defaults supplied for omitted optional         * 00053100
*                  parameters.                                        * 00053200
*                                                                     * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*01* RETURN CODES:  None.                                             * 00054000
*                                                                     * 00054100
*       The IXCREQ macro does not provide a return code.  However,    * 00054200
*       when the XCF Send Service (IXCSEND) is used to send the XCF   * 00054300
*       Server request message to an XCF server for processing, the   * 00054400
*       server that processes the request provides a return and       * 00054500
*       reason code as described below.  These codes are available in * 00054600
*       the answer area returned by the XCF Receive Service (IXCRECV) * 00054700
*       when the IXCRECV macro is used to receive the results         * 00054800
*       provided by the server(s) that process the request.  Fields   * 00054900
*       rd_RespRetcode and rd_RespRsncode in the                      * 00055000
*       ixcysrvr_tResponseDescriptor record (see macro IXCYSRVR)      * 00055100
*       contain the return and reason code, respectively, provided by * 00055200
*       the server.                                                   * 00055300
*                                                                     * 00055400
*                                                                     * 00055500
*                                                                     * 00055600
*       0         IxcRetcodeOK:  Successful completion. The reason    * 00055700
*                 code is always zero (0).                            * 00055800
*                                                                     * 00055900
*       4         IxcRetcodeWarning:  Successful completion, although * 00056000
*                 with exceptional circumstances.                     * 00056100
*                                                                     * 00056200
*                 HEX REASON       MEANING                            * 00056300
*                 CODE                                                * 00056400
*                                                                     * 00056500
*       8         IxcRetCodeParmError: Invalid Parameters             * 00056600
*                                                                     * 00056700
*                 HEX REASON       MEANING                            * 00056800
*                 CODE                                                * 00056900
*                                                                     * 00057000
*                                                                     * 00057100
*                 0001000C    ixcreqRsnNoRequestData:                 * 00057200
*                                                                     * 00057300
*                             No request data was received by the XCF * 00057400
*                             Server Exit for the IXCREQ request.     * 00057500
*                             Check the IXCSEND invocation to make    * 00057600
*                             sure that an XCF Server request message * 00057700
*                             was specified on the MSGDATA keyword or * 00057800
*                             in a MSGDESC data descriptor            * 00057900
*                                                                     * 00058000
*                 00010018    ixcreqRsnBadPlistVersion:               * 00058100
*                                                                     * 00058200
*                             Invalid version number for the XCF      * 00058300
*                             Server request                          * 00058400
*                                                                     * 00058500
*                             When this reason code is set,           * 00058600
*                             diagnostic information mapped by        * 00058700
*                             ixcysrvr_tSrvrInfoDD is returned by the * 00058800
*                             XCF server.  srvrIdd_Diag1 contains the * 00058900
*                             version number that the XCF Server      * 00059000
*                             expected to receive in the server       * 00059100
*                             request.  srvrIdd_Diag2 contains the    * 00059200
*                             version number that the XCF Server      * 00059300
*                             received in the server request.         * 00059400
*                                                                     * 00059500
*                 0002000C    ixcreqRsnBadDataSize:                   * 00059600
*                                                                     * 00059700
*                             Unexpected amount of request data sent  * 00059800
*                             to the server. The value of MSGLEN on   * 00059900
*                             the IXCSEND request or the value in the * 00060000
*                             dd_DataSize field of a MSGDESC data     * 00060100
*                             descriptor was not recognized by the    * 00060200
*                             XCF Server. The amount of data sent for * 00060300
*                             an SERVERINFO request must equal the    * 00060400
*                             length of the storage area formatted    * 00060500
*                             using the List and Modify form of the   * 00060600
*                             IXCREQ macro.                           * 00060700
*                                                                     * 00060800
*                             When this reason code is set,           * 00060900
*                             diagnostic information mapped by        * 00061000
*                             ixcysrvr_tSrvrInfoDD is returned by the * 00061100
*                             XCF server.  srvrIdd_Diag1 contains the * 00061200
*                             number of bytes of data that the XCF    * 00061300
*                             Server expected to receive for the      * 00061400
*                             IXCREQ request.  srvrIdd_Diag2 contains * 00061500
*                             the number of bytes of data that the    * 00061600
*                             XCF Server received for the IXCREQ      * 00061700
*                             request.                                * 00061800
*                                                                     * 00061900
*                 00020018    ixcreqRsnBadPlistRequest:               * 00062000
*                                                                     * 00062100
*                             Invalid REQUEST specified for the XCF   * 00062200
*                             Server.  The IXCREQ REQUEST was not     * 00062300
*                             SERVERINFO.                             * 00062400
*                                                                     * 00062500
*                 0003000C    ixcreqRsnBadValQueryInfo:               * 00062600
*                                                                     * 00062700
*                             Request for SERVERINFO is not valid.    * 00062800
*                             ListAll, Server or ServerID must be     * 00062900
*                             specified on the IXCREQ macro.          * 00063000
*                                                                     * 00063100
*                 0004000C    ixcreqRsnBadValServer:                  * 00063200
*                                                                     * 00063300
*                             Server Name value specified on the      * 00063400
*                             IXCREQ SERVER keyword is not valid.     * 00063500
*                                                                     * 00063600
*                 00040018    ixcreqRsnBadPlistLen:                   * 00063700
*                                                                     * 00063800
*                             Invalid request message length          * 00063900
*                             specified in the XCF Server request     * 00064000
*                             message                                 * 00064100
*                                                                     * 00064200
*                             When this reason code is set,           * 00064300
*                             diagnostic information mapped by        * 00064400
*                             ixcysrvr_tSrvrInfoDD is returned by the * 00064500
*                             XCF Server.                             * 00064600
*                                                                     * 00064700
*                                                                     * 00064800
*                             o   srvrIdd_Diag1 contains the minimum  * 00064900
*                                 message length that the XCF Server  * 00065000
*                                 expected to receive for the IXCREQ  * 00065100
*                                 request.                            * 00065200
*                                                                     * 00065300
*                             o   srvrIdd_Diag2 contains the maximum  * 00065400
*                                 message length that the XCF Server  * 00065500
*                                 expected to receive for the IXCREQ  * 00065600
*                                 request.                            * 00065700
*                                                                     * 00065800
*                             o   srvrIdd_Diag3 contains the message  * 00065900
*                                 length that the XCF Server received * 00066000
*                                 for the IXCREQ request.             * 00066100
*                                                                     * 00066200
*                                                                     * 00066300
*                                                                     * 00066400
*                 0005000C    ixcreqRsnBadValMsgCntl:                 * 00066500
*                                                                     * 00066600
*                             Invalid MsgCntl content sent with the   * 00066700
*                             IXCREQ request.  MsgCntl data is        * 00066800
*                             reserved for XCF use only               * 00066900
*                                                                     * 00067000
*                             When this reason code is set,           * 00067100
*                             diagnostic information mapped by        * 00067200
*                             ixcysrvr_tSrvrInfoDD is returned by the * 00067300
*                             XCF server.  srvrIdd_Diag1 contains     * 00067400
*                             bytes 1 - 4 of the specified MsgCntl.   * 00067500
*                             srvrIdd_Diag2 contains bytes 5 - 8 of   * 00067600
*                             the specified MsgCntl.  srvrIdd_Diag3   * 00067700
*                             contains bytes 9 - 12 of the specified  * 00067800
*                             MsgCntl.  srvrIdd_Diag4 contains bytes  * 00067900
*                             13 - 16 of the specified MsgCntl.       * 00068000
*                                                                     * 00068100
*                 00050018    ixcreqRsnBadPlistRsvd:                  * 00068200
*                                                                     * 00068300
*                             Invalid request message content.        * 00068400
*                             Reserved fields are not initialized to  * 00068500
*                             nulls                                   * 00068600
*                                                                     * 00068700
*                 0006000C    ixcreqRsnOtherSysServerID:              * 00068800
*                                                                     * 00068900
*                             Server ID represents a server instance  * 00069000
*                             that resides on some other system       * 00069100
*                                                                     * 00069200
*                 0007000C    ixcreqRsnBadSenderFunction:             * 00069300
*                                                                     * 00069400
*                             Invalid Function specified on IXCSEND.  * 00069500
*                             When sending an IXCREQ                  * 00069600
*                             REQUEST=SERVERINFO request to the XCF   * 00069700
*                             Server Task, the value provided on the  * 00069800
*                             IXCSEND FUNCTION keyword must be        * 00069900
*                             'SRVRINFO'.                             * 00070000
*                                                                     * 00070100
*                             When this reason code is set,           * 00070200
*                             diagnostic information mapped by        * 00070300
*                             ixcysrvr_tSrvrInfoDD is returned by the * 00070400
*                             XCF server.  srvrIdd_Diag1 contains     * 00070500
*                             bytes 1 - 4 of the specified FUNCTION.  * 00070600
*                             srvrIdd_Diag2 contains bytes 5 - 8 of   * 00070700
*                             the specified FUNCTION.                 * 00070800
*                                                                     * 00070900
*                 000A000C    ixcreqRsnBadValServerID:                * 00071000
*                                                                     * 00071100
*                             Server ID value is not valid.           * 00071200
*                                                                     * 00071300
*                                                                     * 00071400
*                                                                     * 00071500
*                                                                     * 00071600
*       C         IxcRetCodeEnvError: Environmental error             * 00071700
*                                                                     * 00071800
*                 HEX REASON       MEANING                            * 00071900
*                 CODE                                                * 00072000
*                                                                     * 00072100
*                                                                     * 00072200
*                 000100CE    ixcreqRsnSystemResources:               * 00072300
*                                                                     * 00072400
*                             Failed to obtain storage needed to      * 00072500
*                             complete the request due to a system    * 00072600
*                             error.                                  * 00072700
*                                                                     * 00072800
*                             When this reason code is set,           * 00072900
*                             diagnostic information mapped by        * 00073000
*                             ixcysrvr_tSrvrInfoDD is returned by the * 00073100
*                             XCF server.  srvrIdd_Diag1 contains the * 00073200
*                             IARV64 return code and srvrIdd_Diag2    * 00073300
*                             contains the IARV64 reason code.        * 00073400
*                                                                     * 00073500
*                 000100EE    ixcreqRsnTooMuchData:                   * 00073600
*                                                                     * 00073700
*                             Request generates too much response     * 00073800
*                             data which exceeds allowable IXCSEND    * 00073900
*                             maximum.                                * 00074000
*                                                                     * 00074100
*                             When this reason code is set,           * 00074200
*                             diagnostic information mapped by        * 00074300
*                             ixcysrvr_tSrvrInfoDD is returned by the * 00074400
*                             XCF server.  srvrIdd_Diag1 contains the * 00074500
*                             maximum amount of response data that    * 00074600
*                             can be sent by the XCF Server on the    * 00074700
*                             target system.  The amount of response  * 00074800
*                             data that can be sent is determined by  * 00074900
*                             the version of the IXCSEND service that * 00075000
*                             the XCF Server is using.  srvrIdd_Diag2 * 00075100
*                             contains the amount of response data    * 00075200
*                             that was collected by the XCF Server on * 00075300
*                             the target system for the IXCREQ        * 00075400
*                             request.                                * 00075500
*                                                                     * 00075600
*                                                                     * 00075700
*                                                                     * 00075800
*                                                                     * 00075900
*       10        IxcRetCodeCompError: Failure in XCF processing      * 00076000
*                                                                     * 00076100
*                 A non-zero reason code will be provided to assist   * 00076200
*                 IBM Service personnel with diagnosis of the XCF     * 00076300
*                 failure.                                            * 00076400
*                                                                     * 00076500
*                                                                     * 00076600
*                                                                     * 00076700
*01* REASON CODES:  None.                                             * 00076800
*                                                                     * 00076900
*       The IXCREQ macro does not provide a reason code.  However,    * 00077000
*       when the XCF Send Service (IXCSEND) is used to send the       * 00077100
*       parameter list created by the IXCREQ macro to an XCF server   * 00077200
*       for processing, the server that processes the request         * 00077300
*       provides a reason code as described above.                    * 00077400
*                                                                     * 00077500
*01* MODULE TYPE:  ASSEM MACRO                                        * 00077600
*                                                                     * 00077700
*02*   PROCESSOR:  ASSEM                                              * 00077800
*                                                                     * 00077900
*01* COMPONENT:  SCXCF                                                * 00078000
*                                                                     * 00078100
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00078200
*                                                                     * 00078300
*01* MACRO USAGE NOTES:                                               * 00078400
*                                                                     * 00078500
*                                                                     * 00078600
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00078700
*        global macro variable.  Any value other than 'NO' will       * 00078800
*        result in the macro expansion being printed.  The default is * 00078900
*        'YES'.  The following examples illustrate how the ZPRINT     * 00079000
*        variable should be set.                                      * 00079100
*                                                                     * 00079200
*                    GBLC &ZPRINT                                     * 00079300
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00079400
*                                                                     * 00079500
*                                                                     * 00079600
*    2.  When using the NOCHECK option in conjunction with the Modify * 00079700
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00079800
*        Modify   or  Execute  form  invocation  which  specifies  or * 00079900
*        defaults  to  the  COMPLETE  option.   This insures that the * 00080000
*        parameter  list  is  initialized completely.   The parameter * 00080100
*        list  field which identifies the version number of the macro * 00080200
*        is only set when the Standard form or the Complete option of * 00080300
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00080400
*        explicitly  specified.  Be sure that the resulting parameter * 00080500
*        list version number covers all the keys that you use.        * 00080600
*                                                                     * 00080700
*                                                                     * 00080800
*    3.  All  keys currently contained in the IXCREQ macro correspond * 00080900
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 00081000
*        MAX.                                                         * 00081100
*                                                                     * 00081200
*                                                                     * 00081300
*                                                                     * 00081400
*                                                                     * 00081500
*01* CHANGE ACTIVITY:                                                 * 00081600
*                                                                     * 00081700
*   Flag LineItem  FMID    Date   ID    Comment                       * 00081800
*                                                                     * 00081900
*    $L0=XCFSRVR  HBB7780 100730 PD00BJ:  XCF Client/Server           * 00082000
*    $L1=XCFSRVR  HBB7780 101001 PD00C9:  XCF Client/Server           * 00082100
*    $01=OA36283  HBB7780 110420 PD00C9:  XCF Client/Server - Prolog  * 00082200
*                                         Updates                     * 00082300
****** END OF SPECIFICATIONS *****************************************/ 00082400
*/********************************************************************* 00082500
         MACRO                                                          00082600
&XLABEL  IXCREQ &REQUEST=,&SERVER=,&SERVERID=,&INFOTYPE=,&PLISTVER=,   *00082700
               &MF=                                                     00082800
.*                                                                      00082900
*                MACDATE -01/13/18-<0>                                  00083000
.*                                                                      00083100
.*******************************************************************    00083200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00083300
.*******************************************************************    00083400
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00083500
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00083600
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00083700
.*                                                                      00083800
                GBLC  &ZIXCREQ    YES=MACRO USED AT LEAST ONCE          00083900
.*******************************************************************    00084000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00084100
.*******************************************************************    00084200
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00084300
                LCLC  &ZCNDX      SYSNDX CHARACTERS                     00084400
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00084500
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00084600
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00084700
                LCLA  &ZAWRK      USED AS A WORK AREA                   00084800
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00084900
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00085000
                LCLC  &ZC         CHARACTER WORK VARIABLE               00085100
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00085200
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00085300
                LCLC  &ZMAC_G     "G" or null                           00085400
&ZMAC_G         SETC  ''                                                00085500
                LCLC  &ZMAC_LR                                          00085600
&ZMAC_LR        SETC  'LR'                                              00085700
                LCLC  &ZMAC_L                                           00085800
&ZMAC_L         SETC  'L'                                               00085900
                LCLC  &ZMAC_ST                                          00086000
&ZMAC_ST        SETC  'ST'                                              00086100
                LCLC  &ZMAC_LLGT                                        00086200
&ZMAC_LLGT      SETC  'L'                                               00086300
                LCLC  &ZMAC_LGR                                         00086400
&ZMAC_LGR       SETC  'LR'                                              00086500
                LCLC  &ZMAC_LG                                          00086600
&ZMAC_LG        SETC  'L'                                               00086700
                LCLC  &ZMAC_STG                                         00086800
&ZMAC_STG       SETC  'ST'                                              00086900
                LCLA  &ZMACRET    MACRO RETURN CODE                     00087000
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00087100
.*                                                                      00087200
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00087300
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00087400
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00087500
                LCLC  &ZENDBASEPL               End of base PL          00087600
                LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                 00087700
.*******************************************************************    00087800
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00087900
.*******************************************************************    00088000
                LCLA  &ZI         INDEX FOR ARRAY                       00088100
                LCLA  &ZJ         INDEX FOR PARMS                       00088200
                LCLA  &ZK         INDEX FOR PARSE                       00088300
                LCLA  &ZLO        LOW RANGE VALUE                       00088400
                LCLA  &ZHI        HIGH RANGE VALUE                      00088500
                LCLC  &ZW         WORK AREA FOR PARM                    00088600
.********************************************************************   00088700
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00088800
.********************************************************************   00088900
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00089000
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00089100
                GBLA  &SYSALVL    SYSSTATE ARCHLVL                      00089200
                GBLC  &SYSAM64    SYSSTATE AMODE64                      00089300
.*                                                                      00089400
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00089500
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00089600
                SPLEVEL  TEST                                           00089700
.ZSYS2          ANOP  ,                                                 00089800
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00089900
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00090000
                SYSSTATE TEST                                           00090100
                AGO   .ZSYS4                                            00090200
.ZSYS3          ANOP  ,                                                 00090300
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00090400
.ZSYS4          ANOP  ,                                                 00090500
                AIF   ('&SYSAM64' NE 'YES').ZSYSN64                     00090600
&ZMAC_LLGT      SETC 'LLGT'                                             00090700
&ZMAC_LGR       SETC 'LGR'                                              00090800
&ZMAC_LG        SETC 'LG'                                               00090900
&ZMAC_STG       SETC 'STG'                                              00091000
.ZSYSN64        ANOP  ,                                                 00091100
.*******************************************************************    00091200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00091300
.*******************************************************************    00091400
                LCLC  &XREQUEST   ++ VALUE                              00091500
                LCLC  &XQUERYINFO               ++ NAME                 00091600
                LCLC  &XLISTALL   ++ NAME                               00091700
                LCLC  &XSERVER    ++ NAME                               00091800
                LCLC  &XSERVERID  ++ NAME                               00091900
                LCLC  &XINFOTYPE(257)           ++ VALUE                00092000
                LCLA  &XPLISTVER  ++ VALUE                              00092100
                LCLC  &XMF        ++ VALUE                              00092200
                LCLC  &XMFCTRL    ++ NAME                               00092300
                LCLC  &XMFSCK     ++ VALUE                              00092400
                LCLC  &XMFATTR    ++ VALUE                              00092500
.*******************************************************************    00092600
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00092700
.*******************************************************************    00092800
                LCLC  &ZXREQUEST  ++ INPUT VALUE                        00092900
                LCLC  &ZXQUERYINFO              ++ INPUT NAME           00093000
                LCLC  &ZXLISTALL  ++ INPUT NAME                         00093100
                LCLC  &ZXSERVER   ++ INPUT NAME                         00093200
                LCLC  &ZXSERVERID               ++ INPUT NAME           00093300
                LCLC  &ZXINFOTYPE               ++ INPUT VALUE          00093400
                LCLC  &ZXPLISTVER               ++ INPUT VALUE          00093500
                LCLC  &ZXMF       ++ INPUT VALUE                        00093600
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00093700
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00093800
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00093900
.********************************************************************   00094000
.***AC.PLV01  PROCESS PLISTVER                                      *   00094100
.********************************************************************   00094200
&XPLISTVER      SETA  0                                                 00094300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00094400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00094500
&XPLISTVER      SETA  0                                                 00094600
.ZPLV0          ANOP  ,                                                 00094700
.*                                                                      00094800
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00094900
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00095000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00095100
.*-------------------------------------------------------------------   00095200
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00095300
&ZMS            SETC  '"PLISTVER='                                      00095400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00095500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00095600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00095700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00095800
                AGO   .ZPVCK2                                           00095900
.ZPVCK3         ANOP  ,                                                 00096000
.*-------------------------------------------------------------------   00096100
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00096200
&ZMS            SETC  '"PLISTVER='                                      00096300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00096400
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00096500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00096600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00096700
                AGO   .ZPVCKE                                           00096800
.ZPVCK2         ANOP  ,                                                 00096900
.*-------------------------------------------------------------------   00097000
&ZCVAL          SETC  '&PLISTVER(1)'                                    00097100
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00097200
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00097300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00097400
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00097500
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00097600
.ZPVCK6         ANOP  ,                                                 00097700
&ZMS            SETC  '"PLISTVER='                                      00097800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00097900
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00098000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00098100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00098200
&XPLISTVER      SETA  0                                                 00098300
                AGO   .ZPVCKE                                           00098400
.*-------------------------------------------------------------------   00098500
.ZPVCK4A        ANOP  ,                                                 00098600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00098700
&ZMS            SETC  'PLISTVER='                                       00098800
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00098900
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00099000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00099100
                MNOTE 8,' &ZMS IS REQUIRED.'                            00099200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00099300
                AGO   .ZPVCK5                                           00099400
.ZPVCK4         ANOP  ,                                                 00099500
&XPLISTVER      SETA  &PLISTVER(1)                                      00099600
.ZPVCK5         ANOP  ,                                                 00099700
.ZPVCKE         ANOP  ,                                                 00099800
.********************************************************************   00099900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00100000
.********************************************************************   00100100
                ACTR  10000                                             00100200
.*------------------------------------------------------------------    00100300
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100400
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00100500
.*-------------------------------------------------------------------   00100600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100700
.ZG21           ANOP  ,                                                 00100800
&ZTLC           SETC 'E'                                                00100900
                AIF   ('&MF(1)' NE '&ZTLC').ZG30                        00101000
&XMF            SETC  'E'         SET KEYWORD                           00101100
                AIF   (N'&MF LE 3).ZG21A        CK NUM                  00101200
&ZMS            SETC  '"MF='                                            00101300
&ZMS            SETC  '&ZMS.&MF"'                                       00101400
&ZMS            SETC  '&ZMS "MF"'                                       00101500
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00101600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00101700
.ZG21A          ANOP  ,                                                 00101800
.*-------------------------------------------------------------------   00101900
.***AG.KXVAR06 NAME, RQD INPUT, POS(2) -XVARIABLE                       00102000
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00102100
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00102200
                AIF   (N'&MF(2) GT 1).ZG23B     MULTI                   00102300
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00102400
.ZG23B          AIF   (K'&MF(2) GT 0).ZG23C                             00102500
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00102600
&ZMS            SETC  ' '                                               00102700
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00102800
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00102900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00103000
.ZG23C          ANOP  ,                                                 00103100
.*-------------------------------------------------------------------   00103200
.***AG.KCK02 NAME, RQD INPUT, POS(2) -GPR OUT OF RANGE                  00103300
                AIF   (K'&ZXMFCTRL LE 0).ZG23R  NOT I/O                 00103400
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG23R                    00103500
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00103600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                      00103700
                AIF   (K'&ZCGPR GT 2).ZG23Q                             00103800
                AIF   ('&ZCGPR' EQ '0').ZG23Q                           00103900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00104000
                AIF   (T'&ZCGPR NE 'N').ZG23Q   INVALID REG NAME        00104100
.ZG23P          ANOP  ,                                                 00104200
                AIF   (T'&ZCGPR NE 'N').ZG23R   NON NUMERIC             00104300
                AIF   ('&ZCGPR' LT '1').ZG23Q                           00104400
                AIF   ('&ZCGPR' LE '12').ZG23R                          00104500
.ZG23Q          ANOP  ,                                                 00104600
&ZMS            SETC  '"MF='                                            00104700
&ZMS            SETC  '&ZMS.&MF"'                                       00104800
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00104900
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00105000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00105100
.ZG23R          ANOP  ,                                                 00105200
.*-------------------------------------------------------------------   00105300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00105400
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00105500
.ZG27A   AIF   ('&MF(3)' NE 'COMPLETE').ZG28A                           00105600
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00105700
.*-------------------------------------------------------------------   00105800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00105900
.ZG28A   AIF   ('&MF(3)' NE 'NOCHECK').ZG29A                            00106000
&XMFSCK         SETC  'NOCHECK'   SET KEYWORD                           00106100
.*-------------------------------------------------------------------   00106200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00106300
.ZG29A          AIF   (K'&XMFSCK GT 0).ZG29C    KEYWORD                 00106400
                AIF   (K'&MF(3) LE 0).ZG29B                             00106500
&ZMS            SETC  '"MF='                                            00106600
&ZMS            SETC  '&ZMS.&MF"'                                       00106700
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00106800
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00106900
&ZMS            SETC  '&ZMS "COMPLETE"'                                 00107000
&ZMS            SETC  '&ZMS OR "NOCHECK".'                              00107100
                MNOTE 8,' &ZMS '                                        00107200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00107300
.ZG29B          ANOP  ,                                                 00107400
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00107500
.ZG29C          ANOP  ,                                                 00107600
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00107700
.*-------------------------------------------------------------------   00107800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107900
.ZG30           ANOP  ,                                                 00108000
&ZTLC           SETC 'L'                                                00108100
                AIF   ('&MF(1)' NE '&ZTLC').ZG37                        00108200
&XMF            SETC  'L'         SET KEYWORD                           00108300
                AIF   (N'&MF LE 3).ZG30A        CK NUM                  00108400
&ZMS            SETC  '"MF='                                            00108500
&ZMS            SETC  '&ZMS.&MF"'                                       00108600
&ZMS            SETC  '&ZMS "MF"'                                       00108700
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00108800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00108900
.ZG30A          ANOP  ,                                                 00109000
.*-------------------------------------------------------------------   00109100
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00109200
                AIF   (N'&SYSLIST NE 0).ZG30B   POSITIONALS?            00109300
                AIF   ('&REQUEST' NE '').ZG30B  KEYS?                   00109400
                AIF   ('&SERVER' NE '').ZG30B   KEYS?                   00109500
                AIF   ('&SERVERID' NE '').ZG30B  KEYS?                  00109600
                AIF   ('&INFOTYPE' NE '').ZG30B  KEYS?                  00109700
                AGO    .ZG30C     INVOCATION OKAY                       00109800
.ZG30B          ANOP  ,                                                 00109900
&ZMS            SETC  'THE "L" FORM OF "MF"'                            00110000
&ZMS            SETC  '&ZMS CAN ONLY HAVE'                              00110100
&ZMS            SETC  '&ZMS THE "PLISTVER" KEY'                         00110200
                MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'            00110300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00110400
.ZG30C          ANOP  ,                                                 00110500
.*-------------------------------------------------------------------   00110600
.***AG.KXVAR06 NAME, RQD INPUT, POS(2) -XVARIABLE                       00110700
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00110800
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00110900
                AIF   (N'&MF(2) GT 1).ZG32B     MULTI                   00111000
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00111100
.ZG32B          AIF   (K'&MF(2) GT 0).ZG32C                             00111200
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00111300
&ZMS            SETC  ' '                                               00111400
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00111500
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00111600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00111700
.ZG32C          ANOP  ,                                                 00111800
.*-------------------------------------------------------------------   00111900
.***AG.KCK01 NAME, RQD INPUT, POS(2) -GPR NOT ALLOWED                   00112000
                AIF   (K'&ZXMFCTRL LE 0).ZG32P  NOT I/O                 00112100
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG32P                    00112200
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00112300
&ZMS            SETC  '"MF='                                            00112400
&ZMS            SETC  '&ZMS.&MF"'                                       00112500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00112600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00112700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00112800
.ZG32P          ANOP  ,                                                 00112900
.*-------------------------------------------------------------------   00113000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00113100
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00113200
&XMFATTR        SETC  '0D'                                              00113300
                AIF   (K'&MF(3) LE 0).ZG35B     PARM                    00113400
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00113500
                AIF   (N'&MF(3) GT 1).ZG35B     MULTI                   00113600
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00113700
.ZG35B          ANOP  ,                                                 00113800
.*-------------------------------------------------------------------   00113900
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00114000
                AIF   (K'&ZXMFATTR LE 0).ZG35P  NOT I/O                 00114100
                AIF   ('&XMFATTR'(1,1) NE '(').ZG35P                    00114200
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00114300
&ZMS            SETC  '"MF='                                            00114400
&ZMS            SETC  '&ZMS.&MF"'                                       00114500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00114600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00114700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00114800
.ZG35P          ANOP  ,                                                 00114900
.*-------------------------------------------------------------------   00115000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00115100
                AIF   (K'&ZXMFATTR LE 0).ZG35S  NOT I/O                 00115200
                AIF   (K'&XMFATTR LE 60).ZG35S  LNG OK                  00115300
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00115400
&ZMS            SETC  '"MF='                                            00115500
&ZMS            SETC  '&ZMS.&MF"'                                       00115600
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00115700
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00115800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00115900
.ZG35S          ANOP  ,                                                 00116000
.*-------------------------------------------------------------------   00116100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116200
.ZG37           ANOP  ,                                                 00116300
&ZTLC           SETC 'M'                                                00116400
                AIF   ('&MF(1)' NE '&ZTLC').ZG46                        00116500
&XMF            SETC  'M'         SET KEYWORD                           00116600
                AIF   (N'&MF LE 3).ZG37A        CK NUM                  00116700
&ZMS            SETC  '"MF='                                            00116800
&ZMS            SETC  '&ZMS.&MF"'                                       00116900
&ZMS            SETC  '&ZMS "MF"'                                       00117000
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00117100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00117200
.ZG37A          ANOP  ,                                                 00117300
.*-------------------------------------------------------------------   00117400
.***AG.KXVAR06 NAME, RQD INPUT, POS(2) -XVARIABLE                       00117500
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00117600
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00117700
                AIF   (N'&MF(2) GT 1).ZG39B     MULTI                   00117800
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00117900
.ZG39B          AIF   (K'&MF(2) GT 0).ZG39C                             00118000
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00118100
&ZMS            SETC  ' '                                               00118200
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00118300
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00118400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00118500
.ZG39C          ANOP  ,                                                 00118600
.*-------------------------------------------------------------------   00118700
.***AG.KCK02 NAME, RQD INPUT, POS(2) -GPR OUT OF RANGE                  00118800
                AIF   (K'&ZXMFCTRL LE 0).ZG39R  NOT I/O                 00118900
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG39R                    00119000
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00119100
                AIF   ('&ZCGPR'(1,1) NE '0').ZG39P                      00119200
                AIF   (K'&ZCGPR GT 2).ZG39Q                             00119300
                AIF   ('&ZCGPR' EQ '0').ZG39Q                           00119400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00119500
                AIF   (T'&ZCGPR NE 'N').ZG39Q   INVALID REG NAME        00119600
.ZG39P          ANOP  ,                                                 00119700
                AIF   (T'&ZCGPR NE 'N').ZG39R   NON NUMERIC             00119800
                AIF   ('&ZCGPR' LT '1').ZG39Q                           00119900
                AIF   ('&ZCGPR' LE '12').ZG39R                          00120000
.ZG39Q          ANOP  ,                                                 00120100
&ZMS            SETC  '"MF='                                            00120200
&ZMS            SETC  '&ZMS.&MF"'                                       00120300
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00120400
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00120500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00120600
.ZG39R          ANOP  ,                                                 00120700
.*-------------------------------------------------------------------   00120800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120900
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00121000
.ZG43A   AIF   ('&MF(3)' NE 'COMPLETE').ZG44A                           00121100
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00121200
.*-------------------------------------------------------------------   00121300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121400
.ZG44A   AIF   ('&MF(3)' NE 'NOCHECK').ZG45A                            00121500
&XMFSCK         SETC  'NOCHECK'   SET KEYWORD                           00121600
.*-------------------------------------------------------------------   00121700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121800
.ZG45A          AIF   (K'&XMFSCK GT 0).ZG45C    KEYWORD                 00121900
                AIF   (K'&MF(3) LE 0).ZG45B                             00122000
&ZMS            SETC  '"MF='                                            00122100
&ZMS            SETC  '&ZMS.&MF"'                                       00122200
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00122300
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00122400
&ZMS            SETC  '&ZMS "COMPLETE"'                                 00122500
&ZMS            SETC  '&ZMS OR "NOCHECK".'                              00122600
                MNOTE 8,' &ZMS '                                        00122700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00122800
.ZG45B          ANOP  ,                                                 00122900
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00123000
.ZG45C          ANOP  ,                                                 00123100
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00123200
.*------------------------------------------------------------------    00123300
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123400
.ZG46           ANOP  ,                                                 00123500
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00123600
                AIF   (K'&XMF GT 0).ZG46E       VALID ARG               00123700
                AIF   (T'&MF EQ 'O').ZG46D      OMITTED                 00123800
&ZASYSLNDX      SETA  0                                                 00123900
.ZG46A          ANOP  ,           POSITIONAL MACRO KEY                  00124000
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00124100
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG46C                  00124200
&ZTLC           SETC 'MF'                                               00124300
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG46A         00124400
.ZG46B          ANOP  ,                                                 00124500
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00124600
&ZMS            SETC  'THE "MF" KEY'                                    00124700
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00124800
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00124900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00125000
                AGO   .ZG46E                                            00125100
.ZG46C          ANOP  ,                                                 00125200
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00125300
&ZMS            SETC  '"MF='                                            00125400
&ZMS            SETC  '&ZMS.&MF"'                                       00125500
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00125600
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00125700
&ZMS            SETC  '&ZMS "E",'                                       00125800
&ZMS            SETC  '&ZMS "L",'                                       00125900
&ZMS            SETC  '&ZMS OR "M".'                                    00126000
                MNOTE 8,' &ZMS '                                        00126100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00126200
                AGO   .ZG46E                                            00126300
.ZG46D          ANOP  ,                                                 00126400
&XMF            SETC  'E'         SET DEFAULT KEYWORD                   00126500
.ZG46E          ANOP  ,                                                 00126600
.*------------------------------------------------------------------    00126700
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126800
                AIF   (K'&MF(1) GT 0).ZG46F     PARM                    00126900
&XMF            SETC  ''          ENSURE NULL KEYWORD                   00127000
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00127100
&ZMS            SETC  'THE'                                             00127200
&ZMS            SETC  '&ZMS "MF" KEY AND ITS'                           00127300
&ZMS            SETC  '&ZMS ARGUMENT ARE REQUIRED.'                     00127400
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00127500
&ZMS            SETC  '&ZMS "E",'                                       00127600
&ZMS            SETC  '&ZMS "L",'                                       00127700
&ZMS            SETC  '&ZMS OR "M".'                                    00127800
                MNOTE 8,' &ZMS '                                        00127900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00128000
.ZG46F          ANOP  ,                                                 00128100
.********************************************************************   00128200
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00128300
.********************************************************************   00128400
                ACTR  10000                                             00128500
.*-------------------------------------------------------------------   00128600
.***AG.MF03 MF=(LME)                                                    00128700
                AIF   ('&XMF' EQ 'L').ZGMFX                             00128800
                AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                   00128900
.*------------------------------------------------------------------    00129000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129100
&XREQUEST       SETC  ''          INITIALIZE XVARIABLE                  00129200
.*-------------------------------------------------------------------   00129300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129400
.ZG3            ANOP  ,                                                 00129500
                AIF   (K'&REQUEST(1) LE 0).ZG3A                         00129600
&ZTLC           SETC 'SERVERINFO'                                       00129700
                AIF   ('&REQUEST(1)' NE '&ZTLC').ZG15                   00129800
&XREQUEST       SETC  'SERVERINFO'              SET KEYWORD             00129900
                AIF   (N'&REQUEST LE 1).ZG3A    CK NUM                  00130000
&ZMS            SETC  '"REQUEST='                                       00130100
&ZMS            SETC  '&ZMS.&REQUEST"'                                  00130200
&ZMS            SETC  '&ZMS "REQUEST"'                                  00130300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00130400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00130500
.ZG3A           ANOP  ,                                                 00130600
.*-------------------------------------------------------------------   00130700
.***AG.KMEKY05 NAME, RQD INPUT, ME KEYS -NO ARGUMENTS                   00130800
&XQUERYINFO     SETC  ''          INITIALIZE XVARIABLE                  00130900
&ZASYSLNDX      SETA  0                                                 00131000
.ZG5A           ANOP  ,           POSITIONAL KEY SEARCH                 00131100
&ZASYSLNDX      SETA  &ZASYSLNDX+1              NEXT POSITIONAL         00131200
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG5B  DONE                    00131300
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG5A             00131400
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'LISTALL').ZG5A               00131500
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00131600
&ZXQUERYINFO    SETC  'INPUT'     SET IN/OUTPUT                         00131700
&XQUERYINFO     SETC  'LISTALL'   SET XVARIABLE                         00131800
&ZXLISTALL      SETC  'INPUT'     SET IN/OUTPUT                         00131900
&XLISTALL       SETC  'LISTALL'   SET XVARIABLE PARM                    00132000
.ZG5B           ANOP  ,                                                 00132100
.*----------------------------------------------------------------***   00132200
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00132300
                AIF   (K'&SERVER LE 0).ZG6D     NO ME KEY               00132400
                AIF   (N'&SERVER LE 1).ZG6A     CK NUM                  00132500
&ZMS            SETC  '"SERVER='                                        00132600
&ZMS            SETC  '&ZMS.&SERVER"'                                   00132700
&ZMS            SETC  '&ZMS "SERVER"'                                   00132800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00132900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00133000
.ZG6A           AIF   (K'&XQUERYINFO LE 0).ZG6B                         00133100
&ZMS            SETC  '"SERVER'                                         00133200
&ZMS            SETC  '&ZMS.=&SERVER"'                                  00133300
&ZMS            SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'             00133400
&ZMS            SETC  '&ZMS "&XQUERYINFO"'                              00133500
                MNOTE 8,' &ZMS KEY.'                                    00133600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00133700
                AGO   .ZG6D                                             00133800
.*                                                                      00133900
.ZG6B           ANOP  ,                                                 00134000
&ZXQUERYINFO    SETC  'INPUT'     SET IN/OUTPUT                         00134100
&XQUERYINFO     SETC  'SERVER'    SET XVARIABLE                         00134200
&ZXSERVER       SETC  'INPUT'     SET IN/OUTPUT                         00134300
&XSERVER        SETC  '&SERVER(1)'              SET XVARIABLE PARM      00134400
                AIF   (N'&SERVER GT 1).ZG6C                             00134500
&XSERVER        SETC  '&SERVER'   SET XVARIABLE PARM                    00134600
.ZG6C           AIF   (K'&XSERVER GT 0).ZG6D    ONE PARM                00134700
&ZXQUERYINFO    SETC  ''          RESET IN/OUTPUT                       00134800
&ZXSERVER       SETC  ''          RESET IN/OUTPUT                       00134900
&ZMS            SETC  ' '                                               00135000
&ZMS            SETC  '&ZMS "SERVER" KEY AND ITS'                       00135100
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00135200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00135300
.ZG6D           ANOP  ,                                                 00135400
.*----------------------------------------------------------------***   00135500
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00135600
                AIF   (K'&SERVERID LE 0).ZG7D   NO ME KEY               00135700
                AIF   (N'&SERVERID LE 1).ZG7A   CK NUM                  00135800
&ZMS            SETC  '"SERVERID='                                      00135900
&ZMS            SETC  '&ZMS.&SERVERID"'                                 00136000
&ZMS            SETC  '&ZMS "SERVERID"'                                 00136100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00136200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00136300
.ZG7A           AIF   (K'&XQUERYINFO LE 0).ZG7B                         00136400
&ZMS            SETC  '"SERVERID'                                       00136500
&ZMS            SETC  '&ZMS.=&SERVERID"'                                00136600
&ZMS            SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'             00136700
&ZMS            SETC  '&ZMS "&XQUERYINFO"'                              00136800
                MNOTE 8,' &ZMS KEY.'                                    00136900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00137000
                AGO   .ZG7D                                             00137100
.*                                                                      00137200
.ZG7B           ANOP  ,                                                 00137300
&ZXQUERYINFO    SETC  'INPUT'     SET IN/OUTPUT                         00137400
&XQUERYINFO     SETC  'SERVERID'  SET XVARIABLE                         00137500
&ZXSERVERID     SETC  'INPUT'     SET IN/OUTPUT                         00137600
&XSERVERID      SETC  '&SERVERID(1)'            SET XVARIABLE PARM      00137700
                AIF   (N'&SERVERID GT 1).ZG7C                           00137800
&XSERVERID      SETC  '&SERVERID'               SET XVARIABLE PARM      00137900
.ZG7C           AIF   (K'&XSERVERID GT 0).ZG7D  ONE PARM                00138000
&ZXQUERYINFO    SETC  ''          RESET IN/OUTPUT                       00138100
&ZXSERVERID     SETC  ''          RESET IN/OUTPUT                       00138200
&ZMS            SETC  ' '                                               00138300
&ZMS            SETC  '&ZMS "SERVERID" KEY AND ITS'                     00138400
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00138500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00138600
.ZG7D           ANOP  ,                                                 00138700
.*------------------------------------------------------------------    00138800
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00138900
                AIF   (K'&XQUERYINFO GT 0).ZG8B                         00139000
&ZXQUERYINFO    SETC  ''          RESET IN/OUTPUT                       00139100
&ZXLISTALL      SETC  ''          RESET IN/OUTPUT                       00139200
&XQUERYINFO     SETC  ''          ENSURE NULL                           00139300
&XLISTALL       SETC  ''          ENSURE NULL                           00139400
&ZMS            SETC  'ONE OF THE FOLLOWING'                            00139500
&ZMS            SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'               00139600
&ZMS            SETC  '&ZMS REQUIRED:'                                  00139700
&ZMS            SETC  '&ZMS "LISTALL",'         VALID ME KEY            00139800
&ZMS            SETC  '&ZMS "SERVER",'          VALID ME KEY            00139900
&ZMS            SETC  '&ZMS OR "SERVERID".'     VALID ME KEY            00140000
                MNOTE 8,' &ZMS '                                        00140100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00140200
.ZG8B           ANOP  ,                                                 00140300
.*-------------------------------------------------------------------   00140400
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00140500
.ZG5ZY  AIF    ('&XQUERYINFO' NE 'LISTALL').ZG6ZY                       00140600
.*-------------------------------------------------------------------   00140700
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00140800
.ZG6ZY  AIF    ('&XQUERYINFO' NE 'SERVER').ZG7ZY                        00140900
.*-------------------------------------------------------------------   00141000
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00141100
                AIF   (K'&ZXSERVER LE 0).ZG6R   NOT I/O                 00141200
                AIF   ('&XSERVER'(1,1) NE '(').ZG6R                     00141300
&ZCGPR          SETC  '&XSERVER'(2,K'&XSERVER-2)                        00141400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                       00141500
                AIF   (K'&ZCGPR GT 2).ZG6Q                              00141600
                AIF   ('&ZCGPR' EQ '0').ZG6Q                            00141700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00141800
                AIF   (T'&ZCGPR NE 'N').ZG6Q    INVALID REG NAME        00141900
.ZG6P           ANOP  ,                                                 00142000
                AIF   (T'&ZCGPR NE 'N').ZG6R    NON NUMERIC             00142100
                AIF   ('&ZCGPR' LT '2').ZG6Q                            00142200
                AIF   ('&ZCGPR' LE '12').ZG6R                           00142300
.ZG6Q           ANOP  ,                                                 00142400
&ZMS            SETC  '"SERVER='                                        00142500
&ZMS            SETC  '&ZMS.&SERVER"'                                   00142600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00142700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00142800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00142900
.ZG6R           ANOP  ,                                                 00143000
.*-------------------------------------------------------------------   00143100
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00143200
.ZG7ZY  AIF    ('&XQUERYINFO' NE 'SERVERID').ZG8ZY                      00143300
.*-------------------------------------------------------------------   00143400
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00143500
                AIF   (K'&ZXSERVERID LE 0).ZG7R  NOT I/O                00143600
                AIF   ('&XSERVERID'(1,1) NE '(').ZG7R                   00143700
&ZCGPR          SETC  '&XSERVERID'(2,K'&XSERVERID-2)                    00143800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                       00143900
                AIF   (K'&ZCGPR GT 2).ZG7Q                              00144000
                AIF   ('&ZCGPR' EQ '0').ZG7Q                            00144100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00144200
                AIF   (T'&ZCGPR NE 'N').ZG7Q    INVALID REG NAME        00144300
.ZG7P           ANOP  ,                                                 00144400
                AIF   (T'&ZCGPR NE 'N').ZG7R    NON NUMERIC             00144500
                AIF   ('&ZCGPR' LT '2').ZG7Q                            00144600
                AIF   ('&ZCGPR' LE '12').ZG7R                           00144700
.ZG7Q           ANOP  ,                                                 00144800
&ZMS            SETC  '"SERVERID='                                      00144900
&ZMS            SETC  '&ZMS.&SERVERID"'                                 00145000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00145100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00145200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00145300
.ZG7R           ANOP  ,                                                 00145400
.*-------------------------------------------------------------------   00145500
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00145600
.ZG8ZY          ANOP ,            END MUTUALLY EXCLUSIVE KEYS           00145700
.*-------------------------------------------------------------------   00145800
.***AG.KKWRD07 VALUE, OPT INPUT, ME KEYWORD -MULTIPLE KEYWORDS          00145900
&ZI             SETA  0           XVARIABLE ARRAY INDEX                 00146000
&ZJ             SETA  0           SUBLIST INDEX                         00146100
.ZG10A          ANOP  ,                                                 00146200
&ZJ             SETA  &ZJ+1       NEXT SUBLIST                          00146300
                AIF   (&ZJ GT N'&INFOTYPE).ZG10C  DONE                  00146400
                AIF   (K'&INFOTYPE(&ZJ) LE 0).ZG10A  NULL               00146500
&ZI             SETA  &ZI+1       NEXT ARRAY ENTRY                      00146600
&XINFOTYPE(&ZI)   SETC  ''        NULL ENTRY                            00146700
&XINFOTYPE(&ZI+1) SETC  ''        NULL AT ARRAY END                     00146800
.ZG11B  AIF   ('&INFOTYPE(&ZJ)' NE 'SUMMARY').ZG12B                     00146900
&XINFOTYPE(&ZI)   SETC  'SUMMARY'               SET KEYWORD             00147000
.ZG12B  AIF   ('&INFOTYPE(&ZJ)' NE 'WORK').ZG13B                        00147100
&XINFOTYPE(&ZI)   SETC  'WORK'    SET KEYWORD                           00147200
.ZG13B  AIF   ('&INFOTYPE(&ZJ)' NE 'INSTANCE').ZG14B                    00147300
&XINFOTYPE(&ZI)   SETC  'INSTANCE'              SET KEYWORD             00147400
.ZG14B          AIF   ('&XINFOTYPE(&ZI)' NE '').ZG10A                   00147500
&ZI             SETA  &ZI-1       BACKUP ARRAY                          00147600
&ZMS            SETC  '"INFOTYPE='                                      00147700
&ZMS            SETC  '&ZMS.&INFOTYPE"'                                 00147800
&ZMS            SETC  '&ZMS ARGUMENT &ZJ'                               00147900
&ZMS            SETC  '&ZMS IS AN UNKNOWN KEYWORD. '                    00148000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00148100
&ZMS            SETC  '&ZMS "SUMMARY",'                                 00148200
&ZMS            SETC  '&ZMS "WORK",'                                    00148300
&ZMS            SETC  '&ZMS OR "INSTANCE".'                             00148400
                MNOTE 8,' &ZMS '                                        00148500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00148600
                AGO   .ZG10A                                            00148700
.*-------------------------------------------------------------------   00148800
.***AG.KKWRD08 VALUE, OPT INPUT, ME KEYWORD -MULTIPLE KEYWORDS          00148900
.ZG10C          ANOP  ,                                                 00149000
&ZXINFOTYPE     SETC  'INPUT'     SET IN/OUTPUT                         00149100
                AIF   (&ZI GT 0).ZG10D          VALID KEYWORD           00149200
&XINFOTYPE(1)  SETC  'SUMMARY'    SET DEFAULT KEYWORD                   00149300
&XINFOTYPE(2)  SETC  ''           NULL AT ARRAY END                     00149400
.ZG10D          ANOP  ,                                                 00149500
.*------------------------------------------------------------------    00149600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149700
.ZG15           ANOP  ,                                                 00149800
&ZXREQUEST      SETC  'INPUT'     SET IN/OUTPUT                         00149900
                AIF   (K'&XREQUEST GT 0).ZG15E  VALID ARG               00150000
                AIF   (T'&REQUEST EQ 'O').ZG15D  OMITTED                00150100
&ZASYSLNDX      SETA  0                                                 00150200
.ZG15A          ANOP  ,           POSITIONAL MACRO KEY                  00150300
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00150400
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG15C                  00150500
&ZTLC           SETC 'REQUEST'                                          00150600
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG15A         00150700
.ZG15B          ANOP  ,                                                 00150800
&ZXREQUEST      SETC  ''          RESET IN/OUTPUT                       00150900
&ZMS            SETC  'THE "REQUEST" KEY'                               00151000
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00151100
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00151200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00151300
                AGO   .ZG15E                                            00151400
.ZG15C          ANOP  ,                                                 00151500
&ZXREQUEST      SETC  ''          RESET IN/OUTPUT                       00151600
&ZMS            SETC  '"REQUEST='                                       00151700
&ZMS            SETC  '&ZMS.&REQUEST"'                                  00151800
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00151900
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00152000
&ZMS            SETC  '&ZMS "SERVERINFO".'                              00152100
                MNOTE 8,' &ZMS '                                        00152200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00152300
                AGO   .ZG15E                                            00152400
.ZG15D          ANOP  ,                                                 00152500
&XREQUEST       SETC  'SERVERINFO'              SET DEFAULT KEYWORD     00152600
.ZG15E          ANOP  ,                                                 00152700
.*------------------------------------------------------------------    00152800
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152900
                AIF   (K'&REQUEST(1) GT 0).ZG15F  PARM                  00153000
&XREQUEST       SETC  ''          ENSURE NULL KEYWORD                   00153100
&ZXREQUEST      SETC  ''          RESET IN/OUTPUT                       00153200
&ZMS            SETC  'THE'                                             00153300
&ZMS            SETC  '&ZMS "REQUEST" KEY AND ITS'                      00153400
&ZMS            SETC  '&ZMS ARGUMENT ARE REQUIRED.'                     00153500
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00153600
&ZMS            SETC  '&ZMS "SERVERINFO".'                              00153700
                MNOTE 8,' &ZMS '                                        00153800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00153900
.ZG15F          ANOP  ,                                                 00154000
.******************************************************************     00154100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00154200
.******************************************************************     00154300
                ACTR  10000                                             00154400
.*-------------------------------------------------------------------   00154500
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00154600
&ZCVAL          SETC  ''          ERROR FIELD                           00154700
&ZAWRK          SETA  0           POSITIONAL COUNTER                    00154800
&ZASYSLNDX      SETA  0           NON-X KEY COUNTER                     00154900
.ZGLIST2        ANOP  ,                                                 00155000
&ZASYSLNDX      SETA  &ZASYSLNDX+1              NEXT NON-X KEY          00155100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00155200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00155300
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00155400
                AIF   (&ZAWRK LE 0).ZGLIST2                             00155500
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA               00155600
                AGO   .ZGLIST2                                          00155700
.*                                                                      00155800
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00155900
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00156000
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'                         00156100
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00156200
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00156300
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00156400
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00156500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00156600
.ZGLISTX        ANOP  ,                                                 00156700
&ZASYSLNDX      SETA  0                                                 00156800
.*-------------------------------------------------------------------   00156900
.***AG.MF04 MF=(LME)                                                    00157000
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00157100
.********************************************************************   00157200
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00157300
.********************************************************************   00157400
                ACTR  10000                                             00157500
.*-------------------------------------------------------------------   00157600
.***AE.MF01 MF=(LME)                                                    00157700
                AIF   ('&XMF' EQ 'L').ZEMFX                             00157800
                AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                    00157900
.********************************************************************   00158000
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00158100
.********************************************************************   00158200
&XREQUEST       SETC  ''          INITIALIZE XVARIABLE                  00158300
.*-------------------------------------------------------------------   00158400
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158500
&ZTLC           SETC 'SERVERINFO'                                       00158600
                AIF   ('&REQUEST(1)' NE '&ZTLC').ZE3A                   00158700
&XREQUEST       SETC  'SERVERINFO'              SET KEYWORD             00158800
                AIF   (N'&REQUEST LE 1).ZE3A    CK NUM                  00158900
&ZMS            SETC  '"REQUEST='                                       00159000
&ZMS            SETC  '&ZMS.&REQUEST"'                                  00159100
&ZMS            SETC  '&ZMS "REQUEST"'                                  00159200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00159300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00159400
.ZE3A           ANOP  ,                                                 00159500
.*-------------------------------------------------------------------   00159600
.***AE.KMEKY05 NAME, RQD INPUT, ME KEYS -NO ARGUMENTS                   00159700
&XQUERYINFO     SETC  ''          INITIALIZE XVARIABLE                  00159800
&ZASYSLNDX      SETA  0                                                 00159900
.ZE5A           ANOP  ,           POSITIONAL KEY SEARCH                 00160000
&ZASYSLNDX      SETA  &ZASYSLNDX+1              NEXT POSITIONAL         00160100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE5B  DONE                    00160200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE5A             00160300
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'LISTALL').ZE5A               00160400
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00160500
&ZXQUERYINFO    SETC  'INPUT'     SET IN/OUTPUT                         00160600
&XQUERYINFO     SETC  'LISTALL'   SET XVARIABLE                         00160700
&ZXLISTALL      SETC  'INPUT'     SET IN/OUTPUT                         00160800
&XLISTALL       SETC  'LISTALL'   SET XVARIABLE                         00160900
.ZE5B           ANOP  ,                                                 00161000
.*----------------------------------------------------------------***   00161100
.***AE.KMEKY02 NAME, RQD INPUT, ME KEYS -NON-XVAR KEY                   00161200
                AIF   (K'&SERVER LE 0).ZE6D     NO ME KEY               00161300
                AIF   (N'&SERVER LE 1).ZE6A     CK NUM                  00161400
&ZMS            SETC  '"SERVER='                                        00161500
&ZMS            SETC  '&ZMS.&SERVER"'                                   00161600
&ZMS            SETC  '&ZMS "SERVER"'                                   00161700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00161800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00161900
.ZE6A           AIF   (K'&XQUERYINFO LE 0).ZE6B                         00162000
&ZMS            SETC  '"SERVER'                                         00162100
&ZMS            SETC  '&ZMS.=&SERVER"'                                  00162200
&ZMS            SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'             00162300
&ZMS            SETC  '&ZMS "&XQUERYINFO"'                              00162400
                MNOTE 8,' &ZMS KEY.'                                    00162500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00162600
                AGO   .ZE6D                                             00162700
.*                                                                      00162800
.ZE6B           ANOP  ,                                                 00162900
&ZXQUERYINFO    SETC  'INPUT'     SET IN/OUTPUT                         00163000
&XQUERYINFO     SETC  'SERVER'    SET XVARIABLE                         00163100
&ZXSERVER       SETC  'INPUT'     SET IN/OUTPUT                         00163200
&XSERVER        SETC  '&SERVER(1)'              SET PARM                00163300
                AIF   (N'&SERVER GT 1).ZE6C                             00163400
&XSERVER        SETC  '&SERVER'   SET PARM                              00163500
.ZE6C           AIF   (K'&XSERVER GT 0).ZE6D    ONE PARM                00163600
&ZXQUERYINFO    SETC  ''          RESET IN/OUTPUT                       00163700
&ZXSERVER       SETC  ''          RESET IN/OUTPUT                       00163800
.ZE6D           ANOP  ,                                                 00163900
.*----------------------------------------------------------------***   00164000
.***AE.KMEKY02 NAME, RQD INPUT, ME KEYS -NON-XVAR KEY                   00164100
                AIF   (K'&SERVERID LE 0).ZE7D   NO ME KEY               00164200
                AIF   (N'&SERVERID LE 1).ZE7A   CK NUM                  00164300
&ZMS            SETC  '"SERVERID='                                      00164400
&ZMS            SETC  '&ZMS.&SERVERID"'                                 00164500
&ZMS            SETC  '&ZMS "SERVERID"'                                 00164600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00164700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00164800
.ZE7A           AIF   (K'&XQUERYINFO LE 0).ZE7B                         00164900
&ZMS            SETC  '"SERVERID'                                       00165000
&ZMS            SETC  '&ZMS.=&SERVERID"'                                00165100
&ZMS            SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'             00165200
&ZMS            SETC  '&ZMS "&XQUERYINFO"'                              00165300
                MNOTE 8,' &ZMS KEY.'                                    00165400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00165500
                AGO   .ZE7D                                             00165600
.*                                                                      00165700
.ZE7B           ANOP  ,                                                 00165800
&ZXQUERYINFO    SETC  'INPUT'     SET IN/OUTPUT                         00165900
&XQUERYINFO     SETC  'SERVERID'  SET XVARIABLE                         00166000
&ZXSERVERID     SETC  'INPUT'     SET IN/OUTPUT                         00166100
&XSERVERID      SETC  '&SERVERID(1)'            SET PARM                00166200
                AIF   (N'&SERVERID GT 1).ZE7C                           00166300
&XSERVERID      SETC  '&SERVERID'               SET PARM                00166400
.ZE7C           AIF   (K'&XSERVERID GT 0).ZE7D  ONE PARM                00166500
&ZXQUERYINFO    SETC  ''          RESET IN/OUTPUT                       00166600
&ZXSERVERID     SETC  ''          RESET IN/OUTPUT                       00166700
.ZE7D           ANOP  ,                                                 00166800
.*------------------------------------------------------------------    00166900
.***AE.KMEKY07 NAME, RQD INPUT, ME KEYS -CHECK IF ENTERED               00167000
                AIF   (K'&XQUERYINFO GT 0).ZE8B                         00167100
&ZXQUERYINFO    SETC  ''          RESET IN/OUTPUT                       00167200
&XQUERYINFO     SETC  ''          SET NULL                              00167300
&ZXLISTALL      SETC  ''          RESET OUTPUT                          00167400
&XLISTALL       SETC  ''          SET NULL PARM                         00167500
.ZE8B           ANOP  ,                                                 00167600
.*-------------------------------------------------------------------   00167700
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00167800
.ZE5     AIF   ('&XQUERYINFO' NE 'LISTALL').ZE6                         00167900
.*-------------------------------------------------------------------   00168000
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00168100
                AIF   (K'&ZXLISTALL LE 0).ZE5R  NOT I/O                 00168200
                AIF   ('&XLISTALL'(1,1) NE '(').ZE5R                    00168300
&ZCGPR          SETC  '&XLISTALL'(2,K'&XLISTALL-2)                      00168400
                AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                       00168500
                AIF   (K'&ZCGPR GT 2).ZE5Q                              00168600
                AIF   ('&ZCGPR' EQ '0').ZE5Q                            00168700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00168800
                AIF   (T'&ZCGPR NE 'N').ZE5Q    INVALID REG NAME        00168900
.ZE5P           ANOP  ,                                                 00169000
                AIF   (T'&ZCGPR NE 'N').ZE5R    NON NUMERIC             00169100
                AIF   ('&ZCGPR' LT '2').ZE5Q                            00169200
                AIF   ('&ZCGPR' LE '12').ZE5R                           00169300
.ZE5Q           ANOP  ,                                                 00169400
&ZMS            SETC  '"LISTALL='                                       00169500
&ZMS            SETC  '&ZMS.&LISTALL"'                                  00169600
&ZMS            SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'         00169700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00169800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00169900
.ZE5R           ANOP  ,                                                 00170000
.*-------------------------------------------------------------------   00170100
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00170200
.ZE6     AIF   ('&XQUERYINFO' NE 'SERVER').ZE7                          00170300
.*-------------------------------------------------------------------   00170400
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00170500
                AIF   (K'&ZXSERVER LE 0).ZE6R   NOT I/O                 00170600
                AIF   ('&XSERVER'(1,1) NE '(').ZE6R                     00170700
&ZCGPR          SETC  '&XSERVER'(2,K'&XSERVER-2)                        00170800
                AIF   ('&ZCGPR'(1,1) NE '0').ZE6P                       00170900
                AIF   (K'&ZCGPR GT 2).ZE6Q                              00171000
                AIF   ('&ZCGPR' EQ '0').ZE6Q                            00171100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00171200
                AIF   (T'&ZCGPR NE 'N').ZE6Q    INVALID REG NAME        00171300
.ZE6P           ANOP  ,                                                 00171400
                AIF   (T'&ZCGPR NE 'N').ZE6R    NON NUMERIC             00171500
                AIF   ('&ZCGPR' LT '2').ZE6Q                            00171600
                AIF   ('&ZCGPR' LE '12').ZE6R                           00171700
.ZE6Q           ANOP  ,                                                 00171800
&ZMS            SETC  '"SERVER='                                        00171900
&ZMS            SETC  '&ZMS.&SERVER"'                                   00172000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00172100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00172200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00172300
.ZE6R           ANOP  ,                                                 00172400
.*-------------------------------------------------------------------   00172500
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00172600
.ZE7     AIF   ('&XQUERYINFO' NE 'SERVERID').ZE8                        00172700
.*-------------------------------------------------------------------   00172800
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00172900
                AIF   (K'&ZXSERVERID LE 0).ZE7R  NOT I/O                00173000
                AIF   ('&XSERVERID'(1,1) NE '(').ZE7R                   00173100
&ZCGPR          SETC  '&XSERVERID'(2,K'&XSERVERID-2)                    00173200
                AIF   ('&ZCGPR'(1,1) NE '0').ZE7P                       00173300
                AIF   (K'&ZCGPR GT 2).ZE7Q                              00173400
                AIF   ('&ZCGPR' EQ '0').ZE7Q                            00173500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00173600
                AIF   (T'&ZCGPR NE 'N').ZE7Q    INVALID REG NAME        00173700
.ZE7P           ANOP  ,                                                 00173800
                AIF   (T'&ZCGPR NE 'N').ZE7R    NON NUMERIC             00173900
                AIF   ('&ZCGPR' LT '2').ZE7Q                            00174000
                AIF   ('&ZCGPR' LE '12').ZE7R                           00174100
.ZE7Q           ANOP  ,                                                 00174200
&ZMS            SETC  '"SERVERID='                                      00174300
&ZMS            SETC  '&ZMS.&SERVERID"'                                 00174400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00174500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00174600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00174700
.ZE7R           ANOP  ,                                                 00174800
.*-------------------------------------------------------------------   00174900
.***AE.KMEKY09 NAME, RQD INPUT, ME KEYS -END                            00175000
.ZE8            ANOP  ,           END MUTUALLY EXCLUSIVE KEYS           00175100
.*-------------------------------------------------------------------   00175200
.***AE.KKWRD04 VALUE, OPT INPUT, ME KEYWORD -MULTIPLE KEYWORDS          00175300
&ZI             SETA  0           XVARIABLE ARRAY INDEX                 00175400
&ZJ             SETA  0           SUBLIST INDEX                         00175500
.ZE10A          ANOP  ,                                                 00175600
&ZJ             SETA  &ZJ+1       NEXT SUBLIST                          00175700
                AIF   (&ZJ GT N'&INFOTYPE).ZE10C  DONE                  00175800
                AIF   (K'&INFOTYPE(&ZJ) LE 0).ZE10A  NULL               00175900
&ZI             SETA  &ZI+1       NEXT ARRAY ENTRY                      00176000
&XINFOTYPE(&ZI)   SETC  ''        NULL ENTRY                            00176100
&XINFOTYPE(&ZI+1) SETC  ''        NULL AT ARRAY END                     00176200
.ZE11B  AIF   ('&INFOTYPE(&ZJ)' NE 'SUMMARY').ZE12B                     00176300
&XINFOTYPE(&ZI)   SETC  'SUMMARY'               SET KEYWORD             00176400
.ZE12B  AIF   ('&INFOTYPE(&ZJ)' NE 'WORK').ZE13B                        00176500
&XINFOTYPE(&ZI)   SETC  'WORK'    SET KEYWORD                           00176600
.ZE13B  AIF   ('&INFOTYPE(&ZJ)' NE 'INSTANCE').ZE14B                    00176700
&XINFOTYPE(&ZI)   SETC  'INSTANCE'              SET KEYWORD             00176800
.ZE14B          AIF   ('&XINFOTYPE(&ZI)' NE '').ZE10A                   00176900
&ZI             SETA  &ZI-1       BACKUP ARRAY                          00177000
&ZMS            SETC  '"INFOTYPE='                                      00177100
&ZMS            SETC  '&ZMS.&INFOTYPE"'                                 00177200
&ZMS            SETC  '&ZMS ARGUMENT &ZJ'                               00177300
&ZMS            SETC  '&ZMS IS AN UNKNOWN KEYWORD. '                    00177400
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00177500
&ZMS            SETC  '&ZMS "SUMMARY",'                                 00177600
&ZMS            SETC  '&ZMS "WORK",'                                    00177700
&ZMS            SETC  '&ZMS OR "INSTANCE".'                             00177800
                MNOTE 8,' &ZMS '                                        00177900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00178000
                AGO   .ZE10A                                            00178100
.*-------------------------------------------------------------------   00178200
.***AE.KKWRD05 VALUE, OPT INPUT, ME KEYWORD -MULTIPLE KEYWORDS          00178300
&ZXINFOTYPE     SETC  'INPUT'     SET IN/OUTPUT                         00178400
.ZE10C          AIF   (&ZI GT 0).ZE10D          VALID KEYWORD           00178500
&ZXINFOTYPE     SETC  ''          RESET IN/OUTPUT                       00178600
&XINFOTYPE(1)  SETC  ''           SET NULL KEYWORD                      00178700
&XINFOTYPE(2)  SETC  ''           NULL AT ARRAY END                     00178800
.ZE10D          ANOP  ,                                                 00178900
.*------------------------------------------------------------------    00179000
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00179100
.ZE15           AIF   (K'&XREQUEST GT 0).ZE15A                          00179200
                AIF   (K'&REQUEST(1) LE 0).ZE15B                        00179300
&ZMS            SETC  '"REQUEST='                                       00179400
&ZMS            SETC  '&ZMS.&REQUEST"'                                  00179500
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00179600
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00179700
&ZMS            SETC  '&ZMS "SERVERINFO".'                              00179800
                MNOTE 8,' &ZMS '                                        00179900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00180000
                AGO   .ZE15B                                            00180100
.*                                                                      00180200
.ZE15A          ANOP  ,                                                 00180300
&ZXREQUEST      SETC  'INPUT'     SET IN/OUTPUT                         00180400
.ZE15B          ANOP  ,                                                 00180500
.******************************************************************     00180600
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00180700
.******************************************************************     00180800
                ACTR  10000                                             00180900
.*-------------------------------------------------------------------   00181000
.***AF.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00181100
&ZCVAL          SETC  ''          ERROR FIELD                           00181200
&ZAWRK          SETA  0           POSITIONAL COUNTER                    00181300
&ZASYSLNDX      SETA  0           NON-X KEY COUNTER                     00181400
.ZELIST2        ANOP  ,                                                 00181500
&ZASYSLNDX      SETA  &ZASYSLNDX+1              NEXT NON-X KEY          00181600
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZELIST3  DONE                 00181700
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZELIST2          00181800
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00181900
                AIF   (&ZAWRK LE 0).ZELIST2                             00182000
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA               00182100
                AGO   .ZELIST2                                          00182200
.*                                                                      00182300
.ZELIST3  AIF  (K'&ZCVAL LE 0).ZELISTX                                  00182400
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00182500
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'                         00182600
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00182700
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00182800
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00182900
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00183000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00183100
.ZELISTX        ANOP  ,                                                 00183200
&ZASYSLNDX      SETA  0                                                 00183300
.*-------------------------------------------------------------------   00183400
.***AE.MF02 MF=(LME)                                                    00183500
.ZEMFX          ANOP  ,           END OF PARTIAL SYNTAX CHECK           00183600
.*******************************************************************    00183700
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00183800
.*******************************************************************    00183900
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00184000
.*******************************************************************    00184100
.***AE.01  START OF IXCREQ MACRO CODE                                   00184200
.*******************************************************************    00184300
                LCLC  &M0M0001                 NAME                     00184400
&M0M0001        SETC  '&XLABEL'                SET NAME                 00184500
                AIF   (K'&XLABEL NE 0).XLAB2                            00184600
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00184700
.*                                                                      00184800
.XLAB2          ANOP  ,                                                 00184900
                AIF   ('&XMF' EQ 'L').XLAB3                             00185000
&M0M0001 DS    0H                             IXCREQ-0                  00185100
.XLAB3          ANOP  ,                                                 00185200
.*******************************************************************    00185300
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00185400
.*******************************************************************    00185500
              PUSH  PRINT                                               00185600
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00185700
                PRINT OFF         ++ PR01                               00185800
                AGO   .ZPRNTXX                                          00185900
.ZPRINTX        PRINT ON                                                00186000
.ZPRNTXX        ANOP  ,                                                 00186100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00186200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00186300
.********************************************************************   00186400
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00186500
.********************************************************************   00186600
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00186700
                      LCLA  &ZOPN1         INVOCATION INDEX             00186800
                      LCLC  &ZOPL(4095)    LABEL                        00186900
                      LCLC  &ZOPO(4095)    OPERATION                    00187000
                      LCLC  &ZOPV(4095)    VALUE                        00187100
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00187200
.*                                                                      00187300
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00187400
.******************************************************************     00187500
.***AL.L08 IXCREQ FMT=LIST MF=L PARAMETER AREA                          00187600
.******************************************************************     00187700
                      AIF   ('&XMF' NE 'L').ZLMFLX  NOT MF=LIST         00187800
.*-------------------------------------------------------------------   00187900
.***AM.L00  IXCREQ FMT=LIST name                                        00188000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00188100
&ZOPN                 SETA &ZOPN+1                                      00188200
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00188300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00188400
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00188500
&ZOPD(&ZOPN)          SETC '++ IXCREQ NAME'                             00188600
.ZLMFSL2M             ANOP  ,                                           00188700
.*-------------------------------------------------------------------   00188800
.***AM.L01  IXCREQ FMT=LIST PARAMETERS                                  00188900
&ZOPN                 SETA &ZOPN+1                                      00189000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00189100
&ZOPO(&ZOPN)          SETC 'DS'                                         00189200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00189300
&ZOPD(&ZOPN)          SETC '++ IXCREQ PARM LIST'                        00189400
.*-------------------------------------------------------------------   00189500
.***AM.L02 XVERSION XL1                                                 00189600
&ZOPN                 SETA &ZOPN+1                                      00189700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00189800
&ZOPO(&ZOPN)          SETC 'DS'                                         00189900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00190000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00190100
.*-------------------------------------------------------------------   00190200
.***AM.L09  XRSV0001 CL1                                                00190300
&ZOPN                 SETA &ZOPN+1                                      00190400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00190500
&ZOPO(&ZOPN)          SETC 'DS'                                         00190600
&ZOPV(&ZOPN)          SETC 'CL1'                                        00190700
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00190800
.*-------------------------------------------------------------------   00190900
.***AM.L09  XPLISTLEN XL2                                               00191000
&ZOPN                 SETA &ZOPN+1                                      00191100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00191200
&ZOPO(&ZOPN)          SETC 'DS'                                         00191300
&ZOPV(&ZOPN)          SETC 'XL2'                                        00191400
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00191500
.*-------------------------------------------------------------------   00191600
.***AM.L05 XREQUEST H                                                   00191700
&ZOPN                 SETA &ZOPN+1                                      00191800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00191900
&ZOPO(&ZOPN)          SETC 'DS'                                         00192000
&ZOPV(&ZOPN)          SETC 'H'                                          00192100
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00192200
.*                                                                      00192300
&ZOPN                 SETA  &ZOPN+1                                     00192400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_SERVERINFO'             00192500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00192600
&ZOPV(&ZOPN)          SETC  '1'                                         00192700
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00192800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SERVERINFO'                   00192900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00193000
.*-------------------------------------------------------------------   00193100
.***AM.L05 XQUERYINFO H                                                 00193200
&ZOPN                 SETA &ZOPN+1                                      00193300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XQUERYINFO'                       00193400
&ZOPO(&ZOPN)          SETC 'DS'                                         00193500
&ZOPV(&ZOPN)          SETC 'H'                                          00193600
&ZOPD(&ZOPN)          SETC '++ &ZXQUERYINFO XQUERYINFO'                 00193700
.*                                                                      00193800
&ZOPN                 SETA  &ZOPN+1                                     00193900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XQUERYINFO_LISTALL'              00194000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00194100
&ZOPV(&ZOPN)          SETC  '1'                                         00194200
&ZOPD(&ZOPN)          SETC  '++ XQUERYINFO.'                            00194300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LISTALL'                      00194400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00194500
.*                                                                      00194600
&ZOPN                 SETA  &ZOPN+1                                     00194700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XQUERYINFO_SERVER'               00194800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00194900
&ZOPV(&ZOPN)          SETC  '2'                                         00195000
&ZOPD(&ZOPN)          SETC  '++ XQUERYINFO.'                            00195100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SERVER'                       00195200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00195300
.*                                                                      00195400
&ZOPN                 SETA  &ZOPN+1                                     00195500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XQUERYINFO_SERVERID'             00195600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00195700
&ZOPV(&ZOPN)          SETC  '3'                                         00195800
&ZOPD(&ZOPN)          SETC  '++ XQUERYINFO.'                            00195900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SERVERID'                     00196000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00196100
.*-------------------------------------------------------------------   00196200
.***AM.L09  XLEVEL F                                                    00196300
&ZOPN                 SETA &ZOPN+1                                      00196400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XLEVEL'                           00196500
&ZOPO(&ZOPN)          SETC 'DS'                                         00196600
&ZOPV(&ZOPN)          SETC 'F'                                          00196700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00196800
.*-------------------------------------------------------------------   00196900
.***AM.L09  XSERVERLOC CL32                                             00197000
&ZOPN                 SETA &ZOPN+1                                      00197100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVERLOC'                       00197200
&ZOPO(&ZOPN)          SETC 'DS'                                         00197300
&ZOPV(&ZOPN)          SETC 'CL32'                                       00197400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00197500
.*-------------------------------------------------------------------   00197600
.***AM.L09  XREQUESTINFO CL32                                           00197700
&ZOPN                 SETA &ZOPN+1                                      00197800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUESTINFO'                     00197900
&ZOPO(&ZOPN)          SETC 'DS'                                         00198000
&ZOPV(&ZOPN)          SETC 'CL32'                                       00198100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00198200
.*-------------------------------------------------------------------   00198300
.***AM.MLM1 SAVED LOCATION COUNTER                                      00198400
                      AIF  ('&ZENDBASEPL' NE '').ZL13LB                 00198500
&ZENDBASEPL           SETC 'YES'                                        00198600
&ZOPN                 SETA &ZOPN+1                                      00198700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00198800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00198900
&ZOPV(&ZOPN)          SETC '*'                                          00199000
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00199100
.ZL13LB               ANOP  ,                                           00199200
.*-------------------------------------------------------------------   00199300
.***AM.PJR1 DEFINED ON XSERVERLOC                                       00199400
&ZOPN                 SETA &ZOPN+1                                      00199500
&ZOPL(&ZOPN)          SETC ' '                                          00199600
&ZOPO(&ZOPN)          SETC 'ORG'                                        00199700
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+12'                               00199800
&ZOPD(&ZOPN)          SETC ' '                                          00199900
.*-------------------------------------------------------------------   00200000
.***AM.L09  XSERVER CL32                                                00200100
&ZOPN                 SETA &ZOPN+1                                      00200200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVER'                          00200300
&ZOPO(&ZOPN)          SETC 'DS'                                         00200400
&ZOPV(&ZOPN)          SETC 'CL32'                                       00200500
&ZOPD(&ZOPN)          SETC '++ &ZXSERVER '                              00200600
.*-------------------------------------------------------------------   00200700
.***AM.PJR1 DEFINED ON XSERVERLOC                                       00200800
&ZOPN                 SETA &ZOPN+1                                      00200900
&ZOPL(&ZOPN)          SETC ' '                                          00201000
&ZOPO(&ZOPN)          SETC 'ORG'                                        00201100
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+12'                               00201200
&ZOPD(&ZOPN)          SETC ' '                                          00201300
.*-------------------------------------------------------------------   00201400
.***AM.L09  XSERVERID CL16                                              00201500
&ZOPN                 SETA &ZOPN+1                                      00201600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVERID'                        00201700
&ZOPO(&ZOPN)          SETC 'DS'                                         00201800
&ZOPV(&ZOPN)          SETC 'CL16'                                       00201900
&ZOPD(&ZOPN)          SETC '++ &ZXSERVERID '                            00202000
.*-------------------------------------------------------------------   00202100
.***AM.PJR1 DEFINED ON XREQUESTINFO                                     00202200
&ZOPN                 SETA &ZOPN+1                                      00202300
&ZOPL(&ZOPN)          SETC ' '                                          00202400
&ZOPO(&ZOPN)          SETC 'ORG'                                        00202500
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+44'                               00202600
&ZOPD(&ZOPN)          SETC ' '                                          00202700
.*-------------------------------------------------------------------   00202800
.***AM.L03 XFLAGS BL.8                                                  00202900
&ZOPN                 SETA &ZOPN+1                                      00203000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00203100
&ZOPO(&ZOPN)          SETC 'DS'                                         00203200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00203300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00203400
.*                                                                      00203500
&ZOPN                 SETA  &ZOPN+1                                     00203600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XINFOTYPE_WORK'                  00203700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00203800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00203900
&ZOPD(&ZOPN)          SETC  '++ XINFOTYPE.'                             00204000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).WORK'                         00204100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00204200
.*                                                                      00204300
&ZOPN                 SETA  &ZOPN+1                                     00204400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XINFOTYPE_INSTANCE'              00204500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00204600
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00204700
&ZOPD(&ZOPN)          SETC  '++ XINFOTYPE.'                             00204800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INSTANCE'                     00204900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00205000
&ZOPN                 SETA &ZOPN+1                                      00205100
&ZOPL(&ZOPN)          SETC ' '                                          00205200
&ZOPO(&ZOPN)          SETC 'ORG'                                        00205300
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00205400
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00205500
.*-------------------------------------------------------------------   00205600
.***AM.L10 END OF IXCREQ LIST PARAMETERS                                00205700
&ZOPN                 SETA &ZOPN+1                                      00205800
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00205900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00206000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00206100
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00206200
.*                                                                      00206300
&ZOPN                 SETA &ZOPN+1                                      00206400
&ZOPL(&ZOPN)          SETC ' '                                          00206500
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00206600
&ZOPV(&ZOPN)          SETC '1'                                          00206700
&ZOPD(&ZOPN)          SETC ' '                                          00206800
.*-------------------------------------------------------------------   00206900
.***AL.L09 IXCREQ FMT=LIST MF=L PARAMETER AREA DEFINED                  00207000
                      AGO   .ZMFLX         EXIT, MF=L DONE              00207100
.*                                                                      00207200
.ZLMFLX               ANOP  ,                                           00207300
.*-------------------------------------------------------------------   00207400
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00207500
&ZPLLEN               SETA 76                                           00207600
.*                                                                      00207700
.******************************************************************     00207800
.***AI.L01 IXCREQ FMT=LIST FILL IN PARAMETER AREA                       00207900
.******************************************************************     00208000
                      ACTR  10000                                       00208100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00208200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00208300
&ZCVAL                SETC  'LAE'          XAX MODE                     00208400
.ZIMFXA               ANOP ,                                            00208500
.*                                                                      00208600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00208700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00208800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00208900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00209000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00209100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00209200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00209300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00209400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00209500
&ZOPN                 SETA  &ZOPN+1                                     00209600
&ZOPL(&ZOPN)          SETC  ' '                                         00209700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00209800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00209900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00210000
                      AGO   .ZIMFNX                                     00210100
.*                                                                      00210200
.ZIMFN2               ANOP ,                                            00210300
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00210400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00210500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00210600
&ZOPN                 SETA  &ZOPN+1                                     00210700
&ZOPL(&ZOPN)          SETC  ' '                                         00210800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00210900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00211000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00211100
                      AGO   .ZIMFNX                                     00211200
.ZIMFNX1              ANOP ,                                            00211300
&ZOPN                 SETA  &ZOPN+1                                     00211400
&ZOPL(&ZOPN)          SETC  ' '                                         00211500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00211600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00211700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00211800
.ZIMFNX               ANOP ,                                            00211900
.********************************************************************   00212000
.***AI.L02 IXCREQ FMT=LIST INITIALIZE PARAMETER AREA                    00212100
.********************************************************************   00212200
.***AI.L03 MF=(LME)                                                     00212300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00212400
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00212500
.*                                                                      00212600
&ZOPN                 SETA  &ZOPN+1                                     00212700
&ZOPL(&ZOPN)          SETC  ' '                                         00212800
&ZOPO(&ZOPN)          SETC  'XC'                                        00212900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00213000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00213100
.ZIMFLX               ANOP  ,                                           00213200
.*-------------------------------------------------------------------   00213300
.***AI.L04 XPLISTLEN XL2                                                00213400
&ZOPN                 SETA  &ZOPN+1                                     00213500
&ZOPL(&ZOPN)          SETC  ' '                                         00213600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00213700
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      00213800
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00213900
.*-------------------------------------------------------------------   00214000
.***AI.L07 XREQUEST AL2                                                 00214100
&ZW                   SETC  ''                                          00214200
.*-------------------------------------------------------------------   00214300
.***AI.L15 XREQUEST "SERVERINFO" AL2                                    00214400
         AIF   ('&XREQUEST' NE 'SERVERINFO').ZI5A                       00214500
&ZW                   SETC  '1'                                         00214600
.ZI5A                 ANOP  ,                                           00214700
.*-------------------------------------------------------------------   00214800
.***AI.L15 XREQUEST AL2                                                 00214900
                      AIF   ('&ZW' NE '0').ZI5C                         00215000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI5B              00215100
.ZI5C                 ANOP  ,                                           00215200
                      AIF   ('&ZW' EQ '').ZI5B                          00215300
.*                                                                      00215400
&ZOPN                 SETA  &ZOPN+1                                     00215500
&ZOPL(&ZOPN)          SETC  ' '                                         00215600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00215700
&ZOPV(&ZOPN)          SETC  '4(2,1),=AL2(&ZW)'                          00215800
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00215900
.ZI5B                 ANOP  ,                                           00216000
.*-------------------------------------------------------------------   00216100
.***AI.L07 XQUERYINFO AL2                                               00216200
&ZW                   SETC  ''                                          00216300
.*-------------------------------------------------------------------   00216400
.***AI.L15 XQUERYINFO "LISTALL" AL2                                     00216500
         AIF   ('&XQUERYINFO' NE 'LISTALL').ZI7A                        00216600
&ZW                   SETC  '1'                                         00216700
.ZI7A                 ANOP  ,                                           00216800
.*-------------------------------------------------------------------   00216900
.***AI.L15 XQUERYINFO "SERVER" AL2                                      00217000
         AIF   ('&XQUERYINFO' NE 'SERVER').ZI8A                         00217100
&ZW                   SETC  '2'                                         00217200
.ZI8A                 ANOP  ,                                           00217300
.*-------------------------------------------------------------------   00217400
.***AI.L15 XQUERYINFO "SERVERID" AL2                                    00217500
         AIF   ('&XQUERYINFO' NE 'SERVERID').ZI9A                       00217600
&ZW                   SETC  '3'                                         00217700
.ZI9A                 ANOP  ,                                           00217800
.*-------------------------------------------------------------------   00217900
.***AI.L15 XQUERYINFO AL2                                               00218000
                      AIF   ('&ZW' NE '0').ZI9C                         00218100
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI9B              00218200
.ZI9C                 ANOP  ,                                           00218300
                      AIF   ('&ZW' EQ '').ZI9B                          00218400
.*                                                                      00218500
&ZOPN                 SETA  &ZOPN+1                                     00218600
&ZOPL(&ZOPN)          SETC  ' '                                         00218700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00218800
&ZOPV(&ZOPN)          SETC  '6(2,1),=AL2(&ZW)'                          00218900
&ZOPD(&ZOPN)          SETC  '++ &ZXQUERYINFO XQUERYINFO'                00219000
.ZI9B                 ANOP  ,                                           00219100
.*-------------------------------------------------------------------   00219200
.***AI.L25  XSERVER CL32                                                00219300
                      AIF   ('&ZXSERVER' EQ '').ZI14E                   00219400
                      AIF   ('&ZXSERVER' EQ 'OUTPUT').ZI14E             00219500
&ZCGPR                SETC  '&XSERVER'                                  00219600
.*                                                                      00219700
                      AIF   ('&XSERVER'(1,1) NE '(').ZI14B              00219800
&ZCGPR   SETC  '0('.'&XSERVER'(2,K'&XSERVER-2).')'                      00219900
.ZI14B                ANOP  ,                                           00220000
.*                                                                      00220100
&ZOPN                 SETA  &ZOPN+1                                     00220200
&ZOPL(&ZOPN)          SETC  ' '                                         00220300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00220400
&ZOPV(&ZOPN)          SETC  '12(32,1),&ZCGPR'                           00220500
&ZOPD(&ZOPN)          SETC  '++ &ZXSERVER XSERVER'                      00220600
.*                                                                      00220700
.ZI14E                ANOP  ,                                           00220800
.*-------------------------------------------------------------------   00220900
.***AI.L25  XSERVERID CL16                                              00221000
                      AIF   ('&ZXSERVERID' EQ '').ZI16E                 00221100
                      AIF   ('&ZXSERVERID' EQ 'OUTPUT').ZI16E           00221200
&ZCGPR                SETC  '&XSERVERID'                                00221300
.*                                                                      00221400
                      AIF   ('&XSERVERID'(1,1) NE '(').ZI16B            00221500
&ZCGPR   SETC  '0('.'&XSERVERID'(2,K'&XSERVERID-2).')'                  00221600
.ZI16B                ANOP  ,                                           00221700
.*                                                                      00221800
&ZOPN                 SETA  &ZOPN+1                                     00221900
&ZOPL(&ZOPN)          SETC  ' '                                         00222000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00222100
&ZOPV(&ZOPN)          SETC  '12(16,1),&ZCGPR'                           00222200
&ZOPD(&ZOPN)          SETC  '++ &ZXSERVERID XSERVERID'                  00222300
.*                                                                      00222400
.ZI16E                ANOP  ,                                           00222500
.*-------------------------------------------------------------------   00222600
.***AI.L05 XFLAGS BL1                                                   00222700
&ZW                   SETC  ''                                          00222800
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00222900
&ZMS                  SETC  ''                                          00223000
&ZC                   SETC  ''                                          00223100
.*-------------------------------------------------------------------   00223200
.***AI.L09 XFLAGS "WORK"                                                00223300
.***      BL1'1XXXXXXX'                                                 00223400
&ZI                   SETA  0              RESET ARRAY INDEX            00223500
.ZI19A                ANOP  ,                                           00223600
&ZI                   SETA  &ZI+1          NEXT ARRAY ENTRY             00223700
                      AIF   (K'&XINFOTYPE(&ZI) LE 0).ZI19B              00223800
         AIF   ('&XINFOTYPE(&ZI)' NE 'WORK').ZI19A                      00223900
&ZW                   SETC  '&ZW.1'                                     00224000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00224100
&ZMS                  SETC  '&ZMS.0'                                    00224200
                      AGO   .ZI19C                                      00224300
.*                                                                      00224400
.ZI19B                ANOP  ,                                           00224500
&ZW                   SETC  '&ZW.0'                                     00224600
&ZMS                  SETC  '&ZMS.1'                                    00224700
.ZI19C                ANOP  ,                                           00224800
.*-------------------------------------------------------------------   00224900
.***AI.L09 XFLAGS "INSTANCE"                                            00225000
.***      BL1'X1XXXXXX'                                                 00225100
&ZI                   SETA  0              RESET ARRAY INDEX            00225200
.ZI20A                ANOP  ,                                           00225300
&ZI                   SETA  &ZI+1          NEXT ARRAY ENTRY             00225400
                      AIF   (K'&XINFOTYPE(&ZI) LE 0).ZI20B              00225500
         AIF   ('&XINFOTYPE(&ZI)' NE 'INSTANCE').ZI20A                  00225600
&ZW                   SETC  '&ZW.1000000'                               00225700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00225800
&ZMS                  SETC  '&ZMS.0111111'                              00225900
                      AGO   .ZI20C                                      00226000
.*                                                                      00226100
.ZI20B                ANOP  ,                                           00226200
&ZW                   SETC  '&ZW.0000000'                               00226300
&ZMS                  SETC  '&ZMS.1111111'                              00226400
.ZI20C                ANOP  ,                                           00226500
.*-------------------------------------------------------------------   00226600
.***AI.L11 XFLAGS BL1                                                   00226700
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI20D              00226800
                      AIF   ('&ZC' NE 'YES').ZI20D                      00226900
&ZOPN                 SETA  &ZOPN+1                                     00227000
&ZOPL(&ZOPN)          SETC  ' '                                         00227100
&ZOPO(&ZOPN)          SETC  'NI'                                        00227200
&ZOPV(&ZOPN)          SETC  '44(1),B''&ZMS'''                           00227300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00227400
.ZI20D                ANOP  ,                                           00227500
                      AIF   ('&ZCLNG' NE 'YES').ZI20E  ALL ZERO BITS    00227600
&ZOPN                 SETA  &ZOPN+1                                     00227700
&ZOPL(&ZOPN)          SETC  ' '                                         00227800
&ZOPO(&ZOPN)          SETC  'OI'                                        00227900
&ZOPV(&ZOPN)          SETC  '44(1),B''&ZW'''                            00228000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00228100
.ZI20E                ANOP  ,                                           00228200
.*-------------------------------------------------------------------   00228300
&ZOPN1                SETA &ZOPN                                        00228400
.*-------------------------------------------------------------------   00228500
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00228600
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00228700
.*******************************************************************    00228800
.***  PROCESS IXCREQ OUTPUT PARAMETERS                                  00228900
.*******************************************************************    00229000
                      ACTR  10000                                       00229100
.*******************************************************************    00229200
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00229300
.*******************************************************************    00229400
.ZMFLX                ANOP  ,              MF=L PROCESSING              00229500
.*******************************************************************    00229600
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00229700
.*******************************************************************    00229800
                      ACTR  10000                                       00229900
.*                                                                      00230000
                      LCLA  &ZLC           COLUMN POSITION              00230100
                      LCLA  &ZOPX          LIST TABLE INDEX             00230200
                      LCLC  &ZLL           LABEL                        00230300
                      LCLC  &ZLOP          OPERATION                    00230400
                      LCLC  &ZLV           VALUE                        00230500
                      LCLC  &ZLD           DESCRIPTION                  00230600
.*                                                                      00230700
&ZOPX                 SETA  1                                           00230800
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00230900
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00231000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00231100
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00231200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00231300
                      AIF   (K'&ZLD LE 0).ZL5                           00231400
&ZLC                  SETA  35             COMMENT COLUMN               00231500
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00231600
&ZLC                  SETA  33             COMMMENT COLUMN              00231700
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00231800
&ZLV                  SETC  '&ZLV'.' '                                  00231900
                      AGO   .ZL3                                        00232000
.*                                                                      00232100
.ZL4                  ANOP  ,                                           00232200
&ZLV                  SETC  '&ZLV'.' '                                  00232300
.ZL5                  ANOP  ,                                           00232400
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00232500
.*                                                                      00232600
&ZLL     &ZLOP &ZLV                                                     00232700
.*                                                                      00232800
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00232900
                      AGO   .ZL2           CONTINUE LOOPING             00233000
.*                                                                      00233100
.ZLX                  ANOP  ,                                           00233200
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00233300
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00233400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00233500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00233600
.ZLINKX               ANOP  ,                                           00233700
.*******************************************************************    00233800
.***AP.X01  FORMAT GENERATED CODE                                       00233900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00234000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00234100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00234200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00234300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00234400
                      AIF   (K'&ZLD LE 0).ZL51                          00234500
&ZLC                  SETA  35             COMMENT COLUMN               00234600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00234700
&ZLC                  SETA  33             COMMENT COLUMN               00234800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00234900
&ZLV                  SETC  '&ZLV'.' '                                  00235000
                      AGO   .ZL31                                       00235100
.*                                                                      00235200
.ZL41                 ANOP  ,                                           00235300
&ZLV                  SETC  '&ZLV'.' '                                  00235400
.ZL51                 ANOP  ,                                           00235500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00235600
.*                                                                      00235700
&ZLL     &ZLOP &ZLV                                                     00235800
.*                                                                      00235900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00236000
                      AGO   .ZL21          CONTINUE LOOPING             00236100
.*                                                                      00236200
.ZLX1                 ANOP  ,                                           00236300
.*******************************************************************    00236400
.***AP.X02  END OF IXCREQ MACRO                                         00236500
&ZIXCREQ              SETC  'YES'          SET IXCREQ USED              00236600
         POP   PRINT                                                    00236700
*                                            IXCREQ-0                   00236800
         SPACE 1                                                        00236900
.ZLX2                 ANOP  ,                                           00237000
         MEND                                                           00237100
**********************************************************************/ 00237200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00237300
*%IXCREQ: MACRO KEYS(REQUEST,LISTALL,SERVER,SERVERID,INFOTYPE,          00237400
*                 PLISTVER,MF);                                         00237500
*  ANS('?'!!MACLABEL!!' '!!'IXCREQP '!!MACLIST!!                        00237600
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00237700
*%END IXCREQ;                                                           00237800

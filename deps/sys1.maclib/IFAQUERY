*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IFAQUERY                              -16/09/30-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  SMF Configuration Query service               * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2007, 2017                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77B0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IFAQUERY service provides SMF configuration information to * 00002100
*      its caller.  The IFAQUERY service currently performs the       * 00002200
*      following function:                                            * 00002300
*                                                                     * 00002400
*                                                                     * 00002500
*      o   RETRIEVE STATUS - Return the status of SMF recording.      * 00002600
*          Information can be obtained about SMF logstreams, SMF      * 00002700
*          Record Flood Policies and the history of records dropped   * 00002800
*          by the SMF Record Flood Automation facility.               * 00002900
*                                                                     * 00003000
*          If SMF recording is not active a non-zero return code is   * 00003100
*          returned.                                                  * 00003200
*                                                                     * 00003300
*                                                                     * 00003400
*                                                                     * 00003500
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003600
*                                                                     * 00003700
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003800
*                                                                     * 00003900
*01* ENVIRONMENT:                                                     * 00004000
*                                                                     * 00004100
*                                                                     * 00004200
*      Minimum authorization: Supervisor state.  System PSW key.      * 00004300
*                                                                     * 00004400
*      Dispatchable unit mode: Task mode.                             * 00004500
*                                                                     * 00004600
*      Cross Memory Mode: PASN=HASN=SASN.                             * 00004700
*                                                                     * 00004800
*      AMODE:            31-bit.                                      * 00004900
*                                                                     * 00005000
*      ASC mode:         Primary or Access Register.                  * 00005100
*                                                                     * 00005200
*      Interrupt status: Enabled for I/O and external interrupts.     * 00005300
*                                                                     * 00005400
*      Locks:            None                                         * 00005500
*                                                                     * 00005600
*      Control parameters: Control parameters must be in the primary  * 00005700
*                        address space.                               * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*01* PROGRAMMING REQUIREMENTS:                                        * 00006200
*                                                                     * 00006300
*    None.                                                            * 00006400
*                                                                     * 00006500
*01* RESTRICTIONS:                                                    * 00006600
*    None.                                                            * 00006700
*                                                                     * 00006800
*01* INPUT REGISTER INFORMATION:                                      * 00006900
*                                                                     * 00007000
*    There are no input register requirements for issuing the         * 00007100
*    IFAQUERY macro.                                                  * 00007200
*                                                                     * 00007300
*01* OUTPUT REGISTER INFORMATION:                                     * 00007400
*                                                                     * 00007500
*    When control returns to the caller, the GPRs contain:            * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*    REGISTER  CONTENTS                                               * 00007900
*                                                                     * 00008000
*    0         Reason code                                            * 00008100
*                                                                     * 00008200
*    1         Used as work register by the system                    * 00008300
*                                                                     * 00008400
*    2-13      Unchanged                                              * 00008500
*                                                                     * 00008600
*    14        Used as work register by the system                    * 00008700
*                                                                     * 00008800
*    15        Return code                                            * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*    When control returns to the caller, the ARs contain:             * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*    REGISTER  CONTENTS                                               * 00009600
*                                                                     * 00009700
*    0-1       Used as work register by the system                    * 00009800
*                                                                     * 00009900
*    2-13      Unchanged                                              * 00010000
*                                                                     * 00010100
*    14-15     Used as work register by the system                    * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*                                                                     * 00010500
*01* PERFORMANCE IMPLICATIONS:                                        * 00010600
*                                                                     * 00010700
*    None.                                                            * 00010800
*                                                                     * 00010900
*01* SYNTAX:                                                          * 00011000
*                                                                     * 00011100
*Ýxlabel¨  IFAQUERY     RETRIEVE                                      * 00011200
*                          ,STATUS                                    * 00011300
*                              ,OUTAREA=xoutarea                      * 00011400
*                              ,OUTLEN=xoutlen                        * 00011500
*                     Ý,DETAILS=»LOGSTREAM!DROPHISTORY!FLOODPOLICYº¨  * 00011600
*                    ÐÝ,EXTENDEDTYPES=NO¨                             * 00011700
*                    ¿Ý,EXTENDEDTYPES=YES¨                            * 00011800
*                     Ý,RETCODE=xretcode¨                             * 00011900
*                     Ý,RSNCODE=xrsncode¨                             * 00012000
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00012100
*                    ÐÝ,MF=S¨                                         * 00012200
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00012300
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*      Where:                                                         * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*      Ýxlabel¨                                                       * 00013000
*          is an optional symbol, starting in column 1, that is the   * 00013100
*          name on the IFAQUERY macro invocation.  The name must      * 00013200
*          conform to the rules for an ordinary assembler language    * 00013300
*          symbol.                                                    * 00013400
*          DEFAULT: No name.                                          * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*      RETRIEVE                                                       * 00014000
*          Retrieve SMF Recording information.                        * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*          STATUS                                                     * 00014400
*              Obtain information about the current SMF recording     * 00014500
*              environment                                            * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*              OUTAREA=xoutarea                                       * 00014900
*                  is the name (RS-type), or address in register      * 00015000
*                  (2)-(12), of a required character input/output     * 00015100
*                  specifying an area to contain the data being       * 00015200
*                  returned by IFAQUERY.  The output area is defined  * 00015300
*                  by the IFAQUAA macro (consisting of the QUAHDR and * 00015400
*                  related elements).                                 * 00015500
*                                                                     * 00015600
*                  The IFAQUAA mapping macro provides the format of   * 00015700
*                  the area.  The area can be in the primary address  * 00015800
*                  space or in an address/data space that is          * 00015900
*                  addressable through a public entry on the caller's * 00016000
*                  DU-AL.  Use the OUTLEN parameter to specify the    * 00016100
*                  length of the area.                                * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*              OUTLEN=xoutlen                                         * 00016700
*                  is the name (RS-type), or address in register      * 00016800
*                  (2)-(12), of a required fullword input variable    * 00016900
*                  which contains the length of the area provided to  * 00017000
*                  contain the data being returned by IFAQUERY.       * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*      ÝDETAILS=»LOGSTREAM!DROPHISTORY!FLOODPOLICYº¨                  * 00018000
*          is an optional keyword input indicating the type of        * 00018100
*          information that the SMF Query service should return.      * 00018200
*          DEFAULT: LOGSTREAM                                         * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*          DETAILS=LOGSTREAM                                          * 00018600
*              Requests that the SMF Query Service return details     * 00018700
*              about the logstreams defined for use by SMF.           * 00018800
*                                                                     * 00018900
*          DETAILS=DROPHISTORY                                        * 00019000
*              Obtain information about the SMF Flood Policy drop     * 00019100
*              record history                                         * 00019200
*                                                                     * 00019300
*          DETAILS=FLOODPOLICY                                        * 00019400
*              Obtain information about the current SMF Flood Policy  * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*      ÝEXTENDEDTYPES=»NO!YESº¨                                       * 00020200
*          is an optional keyword input that indicates whether        * 00020300
*          IFAQUERY should return information on extended SMF record  * 00020400
*          types with record type numbers above 255.                  * 00020500
*          DEFAULT: NO                                                * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*          ÝEXTENDEDTYPES=NO¨                                         * 00020900
*              Requests that IFAQUERY only return information on      * 00021000
*              types 0 to 255.                                        * 00021100
*                                                                     * 00021200
*          ÝEXTENDEDTYPES=YES¨                                        * 00021300
*              Requests that IFAQUERY return information on all SMF   * 00021400
*              record types.                                          * 00021500
*                                                                     * 00021600
*              When ExtendedTypes=YES, fields QUALSREC, QuafType and  * 00021700
*              QUAPRecType will be zero and fields                    * 00021800
*              QUALSExtRecTypeBits, QuafExtType and QuapExtType will  * 00021900
*              contain information about all record types,            * 00022000
*              respectively.  Note that specifying ExtendedTypes=YES  * 00022100
*              will require a significantly larger outarea to return  * 00022200
*              the extended record type data for DETAILS=LOGSTREAM.   * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*      ÝRETCODE=xretcode¨                                             * 00023000
*          is the name (RS-type) of an optional fullword output       * 00023100
*          variable, or register (2)-(12) or (15), into which the     * 00023200
*          return code is to be copied from GPR 15.  If you specify   * 00023300
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00023400
*          the value will be left in GPR 15.                          * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*      ÝRSNCODE=xrsncode¨                                             * 00024000
*          is the name (RS-type) of an optional fullword output       * 00024100
*          variable into which the reason code is to be copied from   * 00024200
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00024300
*          R0 (within or without parentheses), the value will be left * 00024400
*          in GPR 0.                                                  * 00024500
*                                                                     * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00025000
*          is an optional byte input decimal value in the "0-0" range * 00025100
*          that specifies the macro version.  PLISTVER is the only    * 00025200
*          key allowed on the list form of MF and determines which    * 00025300
*          parameter list is generated.  Note that MAX may be         * 00025400
*          specified instead of a number, and the parameter list will * 00025500
*          be of the largest size currently supported. This size may  * 00025600
*          grow from release to release (thus possibly affecting the  * 00025700
*          amount of storage needed by your program).  If your        * 00025800
*          program can tolerate this, IBM recommends that you always  * 00025900
*          specify MAX when creating the list form parameter list as  * 00026000
*          that will ensure that the list form parameter list is      * 00026100
*          always long enough to hold whatever parameters might be    * 00026200
*          specified on the execute form.                             * 00026300
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00026400
*          default is the lowest version which allows all of the      * 00026500
*          parameters specified on the invocation to be processed.    * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*      ÝMF=»S!L!Eº¨                                                   * 00027100
*          is an optional keyword input which specifies the macro     * 00027200
*          form.                                                      * 00027300
*          DEFAULT: S                                                 * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*          ÝMF=S¨                                                     * 00027700
*              specifies the standard form of the macro.  The "S"     * 00027800
*              form generates code to put the parameters into an      * 00027900
*              in-line parameter list and invoke the desired service. * 00028000
*              Full checking for required macro keys is done along    * 00028100
*              with supplying defaults for omitted optional           * 00028200
*              parameters.                                            * 00028300
*                                                                     * 00028400
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00028500
*              specifies the list form of the macro.  The "L" form    * 00028600
*              defines an area to be used for the parameter list.     * 00028700
*              Only the PLISTVER key may be specified on the          * 00028800
*              invocation.  All other macro parameters are flagged as * 00028900
*              errors.  If PLISTVER is not specified, the original    * 00029000
*              parameter list definition is used.                     * 00029100
*                                                                     * 00029200
*            ,xmfctrl                                                 * 00029300
*              is a required input.  It is the name of a storage area * 00029400
*              for the parameter list.                                * 00029500
*                                                                     * 00029600
*            »,xmfattr!0Dº                                            * 00029700
*              is an optional 60 character input string that varies   * 00029800
*              from 1 to 60 characters. Use it to force boundary      * 00029900
*              alignment of the parameter list. Use only 0F or 0D.    * 00030000
*              DEFAULT: 0D which forces the parameter list to a       * 00030100
*              doubleword boundary.                                   * 00030200
*                                                                     * 00030300
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00030400
*              specifies the execute form of the macro.  The "E" form * 00030500
*              generates code to put the parameters into the          * 00030600
*              parameter list specified by xmfctrl and provides full  * 00030700
*              syntax checking with default setting.                  * 00030800
*                                                                     * 00030900
*            ,xmfctrl                                                 * 00031000
*              is a required input.  It is the name (RS-type), or     * 00031100
*              address in register (1)-(12), of a storage area for    * 00031200
*              the parameter list.                                    * 00031300
*                                                                     * 00031400
*            »,COMPLETEº                                              * 00031500
*              is an optional keyword input which specifies the       * 00031600
*              degree of macro parameter syntax checking.             * 00031700
*              DEFAULT: COMPLETE                                      * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*              COMPLETE                                               * 00032100
*                  Checking for required macro keys is done and       * 00032200
*                  defaults are supplied for omitted optional         * 00032300
*                  parameters.                                        * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*01* RETURN CODES:                                                    * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                 The return and reason codes are defined in macro    * 00033500
*                 IFARCQRY.                                           * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                 X'00'     IFAQUERY request successful.              * 00033900
*                                                                     * 00034000
*                           Reason code                               * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                           X'00'     IFAQUERY request successful.    * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*                 X'04'     Warning. Refer to the action provided     * 00034800
*                           with the specific reason code.            * 00034900
*                                                                     * 00035000
*                           Reason codes                              * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*                           X'00000401' Meaning                       * 00035400
*                                                                     * 00035500
*                                     OUTAREA is too small to contain * 00035600
*                                     all the requested data.         * 00035700
*                                                                     * 00035800
*                                     System action                   * 00035900
*                                                                     * 00036000
*                                     The results in the OUTAREA were * 00036100
*                                     truncated.  QUAHLEN specifies   * 00036200
*                                     the amount of storage that is   * 00036300
*                                     required to return a complete   * 00036400
*                                     result.                         * 00036500
*                                                                     * 00036600
*                                     Programmer action               * 00036700
*                                                                     * 00036800
*                                     Retry the request with a larger * 00036900
*                                     OUTAREA.                        * 00037000
*                                                                     * 00037100
*                           X'00000403' Meaning                       * 00037200
*                                                                     * 00037300
*                                     DETAILS=LOGSTREAM was requested * 00037400
*                                     but no logstream information    * 00037500
*                                     exists. The QUAHDR is filled in * 00037600
*                                     appropriately.                  * 00037700
*                                                                     * 00037800
*                                     System action No records are    * 00037900
*                                     returned                        * 00038000
*                                                                     * 00038100
*                                     Programmer action               * 00038200
*                                                                     * 00038300
*                                     None.                           * 00038400
*                                                                     * 00038500
*                           X'00000404' Meaning                       * 00038600
*                                                                     * 00038700
*                                     DETAILS=FLDPOLS was requested   * 00038800
*                                     but no flood policy information * 00038900
*                                     exists. The QUAHDR is filled in * 00039000
*                                     appropriately.                  * 00039100
*                                                                     * 00039200
*                                     System action No records are    * 00039300
*                                     returned                        * 00039400
*                                                                     * 00039500
*                                     Programmer action               * 00039600
*                                                                     * 00039700
*                                     None.                           * 00039800
*                                                                     * 00039900
*                           X'00000405' Meaning                       * 00040000
*                                                                     * 00040100
*                                     DETAILS=LOGSTREAM was requested * 00040200
*                                     but no flood policy information * 00040300
*                                     exists. The QUAHDR is filled in * 00040400
*                                     appropriately.                  * 00040500
*                                                                     * 00040600
*                                     System action No records are    * 00040700
*                                     returned                        * 00040800
*                                                                     * 00040900
*                                     Programmer action               * 00041000
*                                                                     * 00041100
*                                     None.                           * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*                                                                     * 00041500
*                 X'08'     Invalid input parameter. Refer to the     * 00041600
*                           action provided with the specific reason  * 00041700
*                           code.                                     * 00041800
*                                                                     * 00041900
*                           Reason codes                              * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                           X'00000801' Meaning                       * 00042300
*                                                                     * 00042400
*                                     Caller was not running as a     * 00042500
*                                     task.                           * 00042600
*                                                                     * 00042700
*                                     Programmer action               * 00042800
*                                                                     * 00042900
*                                     Move the invocation of IFAQUERY * 00043000
*                                     under a task.                   * 00043100
*                                                                     * 00043200
*                           X'00000802' Meaning                       * 00043300
*                                                                     * 00043400
*                                     The input parmlist could not be * 00043500
*                                     accessed.                       * 00043600
*                                                                     * 00043700
*                                     Programmer action               * 00043800
*                                                                     * 00043900
*                                     Check for one of the following  * 00044000
*                                     possible errors: Program        * 00044100
*                                     exception during access of      * 00044200
*                                     parameter list. Parameter list  * 00044300
*                                     has invalid address.            * 00044400
*                                                                     * 00044500
*                           X'00000803' Meaning                       * 00044600
*                                                                     * 00044700
*                                     The QUAA area could not be      * 00044800
*                                     accessed.                       * 00044900
*                                                                     * 00045000
*                                     Programmer action               * 00045100
*                                                                     * 00045200
*                                     Check for one of the following  * 00045300
*                                     possible errors: Program        * 00045400
*                                     exception during access of QUAA * 00045500
*                                     area. QUAA area  has invalid    * 00045600
*                                     address.                        * 00045700
*                                                                     * 00045800
*                           X'00000805' Meaning                       * 00045900
*                                                                     * 00046000
*                                     The OUTAREA length (specified   * 00046100
*                                     via the OUTLEN keyword) is too  * 00046200
*                                     small for even a QUAA header.   * 00046300
*                                                                     * 00046400
*                                     Programmer action               * 00046500
*                                                                     * 00046600
*                                     Increase the size of the        * 00046700
*                                     OUTAREA.  The length must be    * 00046800
*                                     greater than or equal to 16     * 00046900
*                                     bytes.                          * 00047000
*                                                                     * 00047100
*                                                                     * 00047200
*                                                                     * 00047300
*                 X'0C'     Environmental error.  Refer to the action * 00047400
*                           provided with the specific reason code.   * 00047500
*                                                                     * 00047600
*                           Reason codes                              * 00047700
*                                                                     * 00047800
*                                                                     * 00047900
*                           X'00000C01' Meaning                       * 00048000
*                                                                     * 00048100
*                                     SMF recording is not active.    * 00048200
*                                                                     * 00048300
*                                     System action No records are    * 00048400
*                                     returned                        * 00048500
*                                                                     * 00048600
*                                     Programmer action               * 00048700
*                                                                     * 00048800
*                                     None.                           * 00048900
*                                                                     * 00049000
*                           X'00000C02' Meaning                       * 00049100
*                                                                     * 00049200
*                                     Storage for local area was not  * 00049300
*                                     obtained                        * 00049400
*                                                                     * 00049500
*                                      Actions                        * 00049600
*                                                                     * 00049700
*                                     Contact IBM support center.     * 00049800
*                                                                     * 00049900
*                                                                     * 00050000
*                                                                     * 00050100
*                 X'10'     Unexpected error. The state of the        * 00050200
*                           request is unpredictable.                 * 00050300
*                                                                     * 00050400
*                            Actions                                  * 00050500
*                                                                     * 00050600
*                           Contact IBM support center.               * 00050700
*                                                                     * 00050800
*                           Reason codes                              * 00050900
*                                                                     * 00051000
*                                                                     * 00051100
*                           NONE                                      * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*                                                                     * 00051900
*01* REASON CODES:                                                    * 00052000
*                                                                     * 00052100
*       See return codes section.                                     * 00052200
*                                                                     * 00052300
*01* MODULE TYPE:  ASSEM MACRO                                        * 00052400
*                                                                     * 00052500
*02*   PROCESSOR:  ASSEM                                              * 00052600
*                                                                     * 00052700
*01* COMPONENT:  SC100                                                * 00052800
*                                                                     * 00052900
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00053000
*                                                                     * 00053100
*01* ABEND CODES:  None.                                              * 00053200
*                                                                     * 00053300
*01* MACRO USAGE NOTES:                                               * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00053700
*        global macro variable.  Any value other than 'NO' will       * 00053800
*        result in the macro expansion being printed.  The default is * 00053900
*        'YES'.  The following examples illustrate how the ZPRINT     * 00054000
*        variable should be set.                                      * 00054100
*                                                                     * 00054200
*                    GBLC &ZPRINT                                     * 00054300
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*    2.  All   keys   currently   contained  in  the  IFAQUERY  macro * 00054700
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00054800
*        value of 0 or MAX.                                           * 00054900
*                                                                     * 00055000
*                                                                     * 00055100
*                                                                     * 00055200
*                                                                     * 00055300
*01* CHANGE ACTIVITY:                                                 * 00055400
*                                                                     * 00055500
*   Flag LineItem  FMID    Date   ID    Comment                       * 00055600
*                                                                     * 00055700
*    $00=OA20995  HBB7740 070801 PDHV:  SMF Vendor Enablement         * 00055800
*    $xx=SMFFLOOD HBB7770 090430 PDAS:  SMF Flood Automation          * 00055900
*    $L1=SMFTYPEX HBB77B0 160930 PDHV:  SMF Extended Type support     * 00056000
*    $01=OA65166  HBB77C0 230728 PDOO:  ABEND0D6 if SMF not active    * 00056100
****** END OF SPECIFICATIONS *****************************************/ 00056200
*/********************************************************************* 00056300
         MACRO                                                          00056400
&XLABEL  IFAQUERY &OUTAREA=,&OUTLEN=,&DETAILS=,&EXTENDEDTYPES=,        *00056500
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00056600
.*                                                                      00056700
*                   MACDATE -16/09/30-<0>                               00056800
.*                                                                      00056900
.*******************************************************************    00057000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00057100
.*******************************************************************    00057200
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00057300
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00057400
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00057500
.*                                                                      00057600
                   GBLC  &ZIFAQUERY  YES=MACRO USED AT LEAST ONCE       00057700
.*******************************************************************    00057800
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00057900
.*******************************************************************    00058000
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00058100
                   LCLC  &ZCNDX      SYSNDX CHARACTERS                  00058200
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00058300
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00058400
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00058500
                   LCLA  &ZAWRK      USED AS A WORK AREA                00058600
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00058700
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00058800
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00058900
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00059000
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00059100
                   LCLC  &ZMAC_G     "G" or null                        00059200
&ZMAC_G            SETC  ''                                             00059300
                   LCLC  &ZMAC_LR                                       00059400
&ZMAC_LR           SETC  'LR'                                           00059500
                   LCLC  &ZMAC_L                                        00059600
&ZMAC_L            SETC  'L'                                            00059700
                   LCLC  &ZMAC_ST                                       00059800
&ZMAC_ST           SETC  'ST'                                           00059900
                   LCLC  &ZMAC_LLGT                                     00060000
&ZMAC_LLGT         SETC  'L'                                            00060100
                   LCLC  &ZMAC_LGR                                      00060200
&ZMAC_LGR          SETC  'LR'                                           00060300
                   LCLC  &ZMAC_LG                                       00060400
&ZMAC_LG           SETC  'L'                                            00060500
                   LCLC  &ZMAC_STG                                      00060600
&ZMAC_STG          SETC  'ST'                                           00060700
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00060800
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00060900
.*                                                                      00061000
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00061100
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00061200
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00061300
                   LCLC  &ZENDBASEPL            End of base PL          00061400
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00061500
.*******************************************************************    00061600
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00061700
.*******************************************************************    00061800
                   LCLA  &ZI         INDEX FOR ARRAY                    00061900
                   LCLA  &ZJ         INDEX FOR PARMS                    00062000
                   LCLA  &ZK         INDEX FOR PARSE                    00062100
                   LCLA  &ZLO        LOW RANGE VALUE                    00062200
                   LCLA  &ZHI        HIGH RANGE VALUE                   00062300
                   LCLC  &ZW         WORK AREA FOR PARM                 00062400
.********************************************************************   00062500
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00062600
.********************************************************************   00062700
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00062800
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00062900
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00063000
                   GBLC  &SYSAM64    SYSSTATE AMODE64                   00063100
.*                                                                      00063200
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00063300
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00063400
                   SPLEVEL  TEST                                        00063500
.ZSYS2             ANOP  ,                                              00063600
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00063700
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00063800
                   SYSSTATE TEST                                        00063900
                   AGO   .ZSYS4                                         00064000
.ZSYS3             ANOP  ,                                              00064100
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00064200
.ZSYS4             ANOP  ,                                              00064300
                   AIF   ('&SYSAM64' NE 'YES').ZSYSN64                  00064400
&ZMAC_LLGT         SETC 'LLGT'                                          00064500
&ZMAC_LGR          SETC 'LGR'                                           00064600
&ZMAC_LG           SETC 'LG'                                            00064700
&ZMAC_STG          SETC 'STG'                                           00064800
.ZSYSN64           ANOP  ,                                              00064900
.*******************************************************************    00065000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00065100
.*******************************************************************    00065200
                   LCLC  &XRETRIEVE  ++ VALUE                           00065300
                   LCLC  &XSTATUS    ++ VALUE                           00065400
                   LCLC  &XOUTAREA   ++ NAME                            00065500
                   LCLC  &XOUTLEN    ++ NAME                            00065600
                   LCLC  &XDETAILS   ++ VALUE                           00065700
                   LCLC  &XEXTENDEDTYPES        ++ VALUE                00065800
                   LCLC  &XRETCODE   ++ NAME                            00065900
                   LCLC  &XRSNCODE   ++ NAME                            00066000
                   LCLA  &XPLISTVER  ++ VALUE                           00066100
                   LCLC  &XMF        ++ VALUE                           00066200
                   LCLC  &XMFCTRL    ++ NAME                            00066300
                   LCLC  &XMFATTR    ++ VALUE                           00066400
                   LCLC  &XMFSCK     ++ VALUE                           00066500
.*******************************************************************    00066600
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00066700
.*******************************************************************    00066800
                   LCLC  &ZXRETRIEVE            ++ INPUT VALUE          00066900
                   LCLC  &ZXSTATUS   ++ INPUT VALUE                     00067000
                   LCLC  &ZXOUTAREA  ++ INOUT NAME                      00067100
                   LCLC  &ZXOUTLEN   ++ INPUT NAME                      00067200
                   LCLC  &ZXDETAILS  ++ INPUT VALUE                     00067300
                   LCLC  &ZXEXTENDEDTYPES       ++ INPUT VALUE          00067400
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00067500
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00067600
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00067700
                   LCLC  &ZXMF       ++ INPUT VALUE                     00067800
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00067900
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00068000
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00068100
.********************************************************************   00068200
.***AC.PLV01  PROCESS PLISTVER                                      *   00068300
.********************************************************************   00068400
&XPLISTVER      SETA  0                                                 00068500
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00068600
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00068700
&XPLISTVER      SETA  0                                                 00068800
.ZPLV0          ANOP  ,                                                 00068900
.*                                                                      00069000
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00069100
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00069200
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00069300
.*-------------------------------------------------------------------   00069400
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00069500
&ZMS            SETC  '"PLISTVER='                                      00069600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00069700
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00069800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00069900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00070000
                AGO   .ZPVCK2                                           00070100
.ZPVCK3         ANOP  ,                                                 00070200
.*-------------------------------------------------------------------   00070300
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00070400
&ZMS            SETC  '"PLISTVER='                                      00070500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00070600
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00070700
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00070800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00070900
                AGO   .ZPVCKE                                           00071000
.ZPVCK2         ANOP  ,                                                 00071100
.*-------------------------------------------------------------------   00071200
&ZCVAL          SETC  '&PLISTVER(1)'                                    00071300
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00071400
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00071500
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00071600
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00071700
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00071800
.ZPVCK6         ANOP  ,                                                 00071900
&ZMS            SETC  '"PLISTVER='                                      00072000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00072100
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00072200
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00072300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00072400
&XPLISTVER      SETA  0                                                 00072500
                AGO   .ZPVCKE                                           00072600
.*-------------------------------------------------------------------   00072700
.ZPVCK4A        ANOP  ,                                                 00072800
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00072900
&ZMS            SETC  'PLISTVER='                                       00073000
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00073100
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00073200
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00073300
                MNOTE 8,' &ZMS IS REQUIRED.'                            00073400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00073500
                AGO   .ZPVCK5                                           00073600
.ZPVCK4         ANOP  ,                                                 00073700
&XPLISTVER      SETA  &PLISTVER(1)                                      00073800
.ZPVCK5         ANOP  ,                                                 00073900
.ZPVCKE         ANOP  ,                                                 00074000
.********************************************************************   00074100
.***AG.MF01 PROCESS MF MACRO FORMS                                      00074200
.********************************************************************   00074300
                   ACTR  10000                                          00074400
.*------------------------------------------------------------------    00074500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00074600
&XMF               SETC  ''          INITIALIZE XVARIABLE               00074700
.*-------------------------------------------------------------------   00074800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00074900
.ZG35              ANOP  ,                                              00075000
&ZTLC              SETC 'S'                                             00075100
                   AIF   ('&MF(1)' NE '&ZTLC').ZG36                     00075200
&XMF               SETC  'S'         SET KEYWORD                        00075300
                   AIF   (N'&MF LE 1).ZG35A     CK NUM                  00075400
&ZMS               SETC  '"MF='                                         00075500
&ZMS               SETC  '&ZMS.&MF"'                                    00075600
&ZMS               SETC  '&ZMS "MF"'                                    00075700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00075800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00075900
.ZG35A             ANOP  ,                                              00076000
.*-------------------------------------------------------------------   00076100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076200
.ZG36              ANOP  ,                                              00076300
&ZTLC              SETC 'L'                                             00076400
                   AIF   ('&MF(1)' NE '&ZTLC').ZG43                     00076500
&XMF               SETC  'L'         SET KEYWORD                        00076600
                   AIF   (N'&MF LE 3).ZG36A     CK NUM                  00076700
&ZMS               SETC  '"MF='                                         00076800
&ZMS               SETC  '&ZMS.&MF"'                                    00076900
&ZMS               SETC  '&ZMS "MF"'                                    00077000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00077100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00077200
.ZG36A             ANOP  ,                                              00077300
.*-------------------------------------------------------------------   00077400
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00077500
                   AIF   (N'&SYSLIST NE 0).ZG36B  POSITIONALS?          00077600
                   AIF   ('&OUTAREA' NE '').ZG36B  KEYS?                00077700
                   AIF   ('&OUTLEN' NE '').ZG36B  KEYS?                 00077800
                   AIF   ('&DETAILS' NE '').ZG36B  KEYS?                00077900
                   AIF   ('&EXTENDEDTYPES' NE '').ZG36B  KEYS?          00078000
                   AIF   ('&RETCODE' NE '').ZG36B  KEYS?                00078100
                   AIF   ('&RSNCODE' NE '').ZG36B  KEYS?                00078200
                   AGO    .ZG36C     INVOCATION OKAY                    00078300
.ZG36B             ANOP  ,                                              00078400
&ZMS               SETC  'THE "L" FORM OF "MF"'                         00078500
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00078600
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00078700
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00078800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00078900
.ZG36C             ANOP  ,                                              00079000
.*-------------------------------------------------------------------   00079100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00079200
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00079300
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00079400
                   AIF   (N'&MF(2) GT 1).ZG38B  MULTI                   00079500
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00079600
.ZG38B             AIF   (K'&MF(2) GT 0).ZG38C                          00079700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00079800
&ZMS               SETC  'WHEN "L" IS SPECIFIED'                        00079900
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00080000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00080100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00080200
.ZG38C             ANOP  ,                                              00080300
.*-------------------------------------------------------------------   00080400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00080500
                   AIF   (K'&ZXMFCTRL LE 0).ZG38P  NOT I/O              00080600
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG38P                 00080700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00080800
&ZMS               SETC  '"MF='                                         00080900
&ZMS               SETC  '&ZMS.&MF"'                                    00081000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00081100
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00081200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00081300
.ZG38P             ANOP  ,                                              00081400
.*-------------------------------------------------------------------   00081500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00081600
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00081700
&XMFATTR           SETC  '0D'                                           00081800
                   AIF   (K'&MF(3) LE 0).ZG41B  PARM                    00081900
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00082000
                   AIF   (N'&MF(3) GT 1).ZG41B  MULTI                   00082100
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00082200
.ZG41B             ANOP  ,                                              00082300
.*-------------------------------------------------------------------   00082400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00082500
                   AIF   (K'&ZXMFATTR LE 0).ZG41P  NOT I/O              00082600
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG41P                 00082700
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00082800
&ZMS               SETC  '"MF='                                         00082900
&ZMS               SETC  '&ZMS.&MF"'                                    00083000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00083100
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00083200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00083300
.ZG41P             ANOP  ,                                              00083400
.*-------------------------------------------------------------------   00083500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00083600
                   AIF   (K'&ZXMFATTR LE 0).ZG41S  NOT I/O              00083700
                   AIF   (K'&XMFATTR LE 60).ZG41S  LNG OK               00083800
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00083900
&ZMS               SETC  '"MF='                                         00084000
&ZMS               SETC  '&ZMS.&MF"'                                    00084100
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00084200
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00084300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00084400
.ZG41S             ANOP  ,                                              00084500
.*-------------------------------------------------------------------   00084600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084700
.ZG43              ANOP  ,                                              00084800
&ZTLC              SETC 'E'                                             00084900
                   AIF   ('&MF(1)' NE '&ZTLC').ZG51                     00085000
&XMF               SETC  'E'         SET KEYWORD                        00085100
                   AIF   (N'&MF LE 3).ZG43A     CK NUM                  00085200
&ZMS               SETC  '"MF='                                         00085300
&ZMS               SETC  '&ZMS.&MF"'                                    00085400
&ZMS               SETC  '&ZMS "MF"'                                    00085500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00085600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00085700
.ZG43A             ANOP  ,                                              00085800
.*-------------------------------------------------------------------   00085900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00086000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00086100
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00086200
                   AIF   (N'&MF(2) GT 1).ZG45B  MULTI                   00086300
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00086400
.ZG45B             AIF   (K'&MF(2) GT 0).ZG45C                          00086500
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00086600
&ZMS               SETC  'WHEN "E" IS SPECIFIED'                        00086700
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00086800
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00086900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00087000
.ZG45C             ANOP  ,                                              00087100
.*-------------------------------------------------------------------   00087200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00087300
                   AIF   (K'&ZXMFCTRL LE 0).ZG45R  NOT I/O              00087400
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG45R                 00087500
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00087600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG45P                   00087700
                   AIF   (K'&ZCGPR GT 2).ZG45Q                          00087800
                   AIF   ('&ZCGPR' EQ '0').ZG45Q                        00087900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00088000
                   AIF   (T'&ZCGPR NE 'N').ZG45Q  INVALID REG NAME      00088100
.ZG45P             ANOP  ,                                              00088200
                   AIF   (T'&ZCGPR NE 'N').ZG45R  NON NUMERIC           00088300
                   AIF   ('&ZCGPR' LT '1').ZG45Q                        00088400
                   AIF   ('&ZCGPR' LE '12').ZG45R                       00088500
.ZG45Q             ANOP  ,                                              00088600
&ZMS               SETC  '"MF='                                         00088700
&ZMS               SETC  '&ZMS.&MF"'                                    00088800
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00088900
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00089000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00089100
.ZG45R             ANOP  ,                                              00089200
.*-------------------------------------------------------------------   00089300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00089400
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00089500
.ZG49A   AIF   ('&MF(3)' NE 'COMPLETE').ZG50A                           00089600
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00089700
.*-------------------------------------------------------------------   00089800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00089900
.ZG50A             AIF   (K'&XMFSCK GT 0).ZG50C  KEYWORD                00090000
                   AIF   (K'&MF(3) LE 0).ZG50B                          00090100
&ZMS               SETC  '"MF='                                         00090200
&ZMS               SETC  '&ZMS.&MF"'                                    00090300
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00090400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00090500
&ZMS               SETC  '&ZMS "COMPLETE".'                             00090600
                   MNOTE 8,' &ZMS '                                     00090700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00090800
.ZG50B             ANOP  ,                                              00090900
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00091000
.ZG50C             ANOP  ,                                              00091100
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00091200
.*------------------------------------------------------------------    00091300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00091400
.ZG51              ANOP  ,                                              00091500
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00091600
                   AIF   (K'&XMF GT 0).ZG51E    VALID ARG               00091700
                   AIF   (T'&MF EQ 'O').ZG51D   OMITTED                 00091800
&ZASYSLNDX         SETA  0                                              00091900
.ZG51A             ANOP  ,           POSITIONAL MACRO KEY               00092000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00092100
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG51C               00092200
&ZTLC              SETC 'MF'                                            00092300
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG51A      00092400
.ZG51B             ANOP  ,                                              00092500
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00092600
&ZMS               SETC  'THE "MF" KEY'                                 00092700
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00092800
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00092900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00093000
                   AGO   .ZG51E                                         00093100
.ZG51C             ANOP  ,                                              00093200
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00093300
&ZMS               SETC  '"MF='                                         00093400
&ZMS               SETC  '&ZMS.&MF"'                                    00093500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00093600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00093700
&ZMS               SETC  '&ZMS "S",'                                    00093800
&ZMS               SETC  '&ZMS "L",'                                    00093900
&ZMS               SETC  '&ZMS OR "E".'                                 00094000
                   MNOTE 8,' &ZMS '                                     00094100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00094200
                   AGO   .ZG51E                                         00094300
.ZG51D             ANOP  ,                                              00094400
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00094500
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00094600
.ZG51E             ANOP  ,                                              00094700
.********************************************************************   00094800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00094900
.********************************************************************   00095000
                   ACTR  10000                                          00095100
.*-------------------------------------------------------------------   00095200
.***AG.MF03 MF=(SLE)                                                    00095300
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00095400
.*----------------------------------------------------------------***   00095500
.***AG.KXVAR01 VALUE, RQD INPUT, KEYS -NO ARGUMENTS                     00095600
&XRETRIEVE         SETC  ''          RESET XVARIABLE                    00095700
&ZXRETRIEVE        SETC  ''          RESET IN/OUTPUT                    00095800
&ZASYSLNDX         SETA  0                                              00095900
.ZG2A              ANOP  ,           POSITIONAL MACRO KEY               00096000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00096100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B                          00096200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00096300
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'RETRIEVE').ZG2A              00096400
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00096500
&XRETRIEVE         SETC  'RETRIEVE'  MACRO KEY FOUND                    00096600
&ZXRETRIEVE        SETC  'INPUT'     SET IN/OUTPUT                      00096700
.ZG2B              ANOP  ,                                              00096800
.*-------------------------------------------------------------------   00096900
.***AG.KXVAR02 VALUE, RQD INPUT, KEYS -NO ARGUMENTS                     00097000
                   AIF   (K'&XRETRIEVE GT 0).ZG2C  KEY ENTERED          00097100
&ZMS               SETC  ' '                                            00097200
&ZMS               SETC  '&ZMS "RETRIEVE" KEY AND ITS'                  00097300
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00097400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00097500
.ZG2C              ANOP  ,                                              00097600
.*----------------------------------------------------------------***   00097700
.***AG.KXVAR01 VALUE, RQD INPUT, KEYS -NO ARGUMENTS                     00097800
&XSTATUS           SETC  ''          RESET XVARIABLE                    00097900
&ZXSTATUS          SETC  ''          RESET IN/OUTPUT                    00098000
&ZASYSLNDX         SETA  0                                              00098100
.ZG4A              ANOP  ,           POSITIONAL MACRO KEY               00098200
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00098300
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG4B                          00098400
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG4A             00098500
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'STATUS').ZG4A                00098600
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00098700
&XSTATUS           SETC  'STATUS'    MACRO KEY FOUND                    00098800
&ZXSTATUS          SETC  'INPUT'     SET IN/OUTPUT                      00098900
.ZG4B              ANOP  ,                                              00099000
.*-------------------------------------------------------------------   00099100
.***AG.KXVAR02 VALUE, RQD INPUT, KEYS -NO ARGUMENTS                     00099200
                   AIF   (K'&XSTATUS GT 0).ZG4C  KEY ENTERED            00099300
&ZMS               SETC  ' '                                            00099400
&ZMS               SETC  '&ZMS "STATUS" KEY AND ITS'                    00099500
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00099600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00099700
.ZG4C              ANOP  ,                                              00099800
.*----------------------------------------------------------------***   00099900
.***AG.KXVAR05 NAME, RQD INOUT, KEYS -XVARIABLE KEY                     00100000
                   AIF   (N'&OUTAREA LE 1).ZG6A  CK NUM                 00100100
&ZMS               SETC  '"OUTAREA='                                    00100200
&ZMS               SETC  '&ZMS.&OUTAREA"'                               00100300
&ZMS               SETC  '&ZMS "OUTAREA"'                               00100400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00100500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00100600
.ZG6A              ANOP  ,                                              00100700
.*-------------------------------------------------------------------   00100800
.***AG.KXVAR06 NAME, RQD INOUT, KEYS -XVARIABLE                         00100900
&ZXOUTAREA         SETC  'INOUT'     SET IN/OUTPUT                      00101000
&XOUTAREA          SETC  '&OUTAREA(1)'          SET XVARIABLE           00101100
                   AIF   (N'&OUTAREA GT 1).ZG6B  MULTI                  00101200
&XOUTAREA          SETC  '&OUTAREA'  SET XVARIABLE                      00101300
.ZG6B              AIF   (K'&OUTAREA(1) GT 0).ZG6C                      00101400
&ZXOUTAREA         SETC  ''          RESET IN/OUTPUT                    00101500
&ZMS               SETC  ' '                                            00101600
&ZMS               SETC  '&ZMS "OUTAREA" KEY AND ITS'                   00101700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00101800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00101900
.ZG6C              ANOP  ,                                              00102000
.*-------------------------------------------------------------------   00102100
.***AG.KCK02 NAME, RQD INOUT, KEYS -GPR OUT OF RANGE                    00102200
                   AIF   (K'&ZXOUTAREA LE 0).ZG6R  NOT I/O              00102300
                   AIF   ('&XOUTAREA'(1,1) NE '(').ZG6R                 00102400
&ZCGPR             SETC  '&XOUTAREA'(2,K'&XOUTAREA-2)                   00102500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                    00102600
                   AIF   (K'&ZCGPR GT 2).ZG6Q                           00102700
                   AIF   ('&ZCGPR' EQ '0').ZG6Q                         00102800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00102900
                   AIF   (T'&ZCGPR NE 'N').ZG6Q  INVALID REG NAME       00103000
.ZG6P              ANOP  ,                                              00103100
                   AIF   (T'&ZCGPR NE 'N').ZG6R  NON NUMERIC            00103200
                   AIF   ('&ZCGPR' LT '2').ZG6Q                         00103300
                   AIF   ('&ZCGPR' LE '12').ZG6R                        00103400
.ZG6Q              ANOP  ,                                              00103500
&ZMS               SETC  '"OUTAREA='                                    00103600
&ZMS               SETC  '&ZMS.&OUTAREA"'                               00103700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00103800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00103900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00104000
.ZG6R              ANOP  ,                                              00104100
.*----------------------------------------------------------------***   00104200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00104300
                   AIF   (N'&OUTLEN LE 1).ZG9A  CK NUM                  00104400
&ZMS               SETC  '"OUTLEN='                                     00104500
&ZMS               SETC  '&ZMS.&OUTLEN"'                                00104600
&ZMS               SETC  '&ZMS "OUTLEN"'                                00104700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00104800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00104900
.ZG9A              ANOP  ,                                              00105000
.*-------------------------------------------------------------------   00105100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00105200
&ZXOUTLEN          SETC  'INPUT'     SET IN/OUTPUT                      00105300
&XOUTLEN           SETC  '&OUTLEN(1)'           SET XVARIABLE           00105400
                   AIF   (N'&OUTLEN GT 1).ZG9B  MULTI                   00105500
&XOUTLEN           SETC  '&OUTLEN'   SET XVARIABLE                      00105600
.ZG9B              AIF   (K'&OUTLEN(1) GT 0).ZG9C                       00105700
&ZXOUTLEN          SETC  ''          RESET IN/OUTPUT                    00105800
&ZMS               SETC  ' '                                            00105900
&ZMS               SETC  '&ZMS "OUTLEN" KEY AND ITS'                    00106000
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00106100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00106200
.ZG9C              ANOP  ,                                              00106300
.*-------------------------------------------------------------------   00106400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00106500
                   AIF   (K'&ZXOUTLEN LE 0).ZG9R  NOT I/O               00106600
                   AIF   ('&XOUTLEN'(1,1) NE '(').ZG9R                  00106700
&ZCGPR             SETC  '&XOUTLEN'(2,K'&XOUTLEN-2)                     00106800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG9P                    00106900
                   AIF   (K'&ZCGPR GT 2).ZG9Q                           00107000
                   AIF   ('&ZCGPR' EQ '0').ZG9Q                         00107100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00107200
                   AIF   (T'&ZCGPR NE 'N').ZG9Q  INVALID REG NAME       00107300
.ZG9P              ANOP  ,                                              00107400
                   AIF   (T'&ZCGPR NE 'N').ZG9R  NON NUMERIC            00107500
                   AIF   ('&ZCGPR' LT '2').ZG9Q                         00107600
                   AIF   ('&ZCGPR' LE '12').ZG9R                        00107700
.ZG9Q              ANOP  ,                                              00107800
&ZMS               SETC  '"OUTLEN='                                     00107900
&ZMS               SETC  '&ZMS.&OUTLEN"'                                00108000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00108100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00108200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00108300
.ZG9R              ANOP  ,                                              00108400
.*----------------------------------------------------------------***   00108500
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00108600
                   AIF   (N'&DETAILS LE 1).ZG14A  CK NUM                00108700
&ZMS               SETC  '"DETAILS='                                    00108800
&ZMS               SETC  '&ZMS.&DETAILS"'                               00108900
&ZMS               SETC  '&ZMS "DETAILS"'                               00109000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00109100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00109200
.ZG14A             ANOP  ,                                              00109300
.*-------------------------------------------------------------------   00109400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00109500
&XDETAILS          SETC  ''          INITIALIZE XVARIABLE               00109600
.ZG15A   AIF   ('&DETAILS(1)' NE 'LOGSTREAM').ZG16A                     00109700
&XDETAILS          SETC  'LOGSTREAM'            SET KEYWORD             00109800
.*-------------------------------------------------------------------   00109900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00110000
.ZG16A   AIF   ('&DETAILS(1)' NE 'DROPHISTORY').ZG17A                   00110100
&XDETAILS          SETC  'DROPHISTORY'          SET KEYWORD             00110200
.*-------------------------------------------------------------------   00110300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00110400
.ZG17A   AIF   ('&DETAILS(1)' NE 'FLOODPOLICY').ZG18A                   00110500
&XDETAILS          SETC  'FLOODPOLICY'          SET KEYWORD             00110600
.*-------------------------------------------------------------------   00110700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00110800
.ZG18A             AIF   (K'&XDETAILS GT 0).ZG18C  KEYWORD              00110900
                   AIF   (K'&DETAILS(1) LE 0).ZG18B                     00111000
&ZMS               SETC  '"DETAILS='                                    00111100
&ZMS               SETC  '&ZMS.&DETAILS"'                               00111200
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00111300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00111400
&ZMS               SETC  '&ZMS "LOGSTREAM",'                            00111500
&ZMS               SETC  '&ZMS "DROPHISTORY",'                          00111600
&ZMS               SETC  '&ZMS OR "FLOODPOLICY".'                       00111700
                   MNOTE 8,' &ZMS '                                     00111800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00111900
.ZG18B             ANOP  ,                                              00112000
&XDETAILS          SETC  'LOGSTREAM'            SET DEFAULT KEYWORD     00112100
.ZG18C             ANOP  ,                                              00112200
&ZXDETAILS         SETC  'INPUT'     SET IN/OUTPUT                      00112300
.*------------------------------------------------------------------    00112400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112500
&XEXTENDEDTYPES    SETC  ''          INITIALIZE XVARIABLE               00112600
.*-------------------------------------------------------------------   00112700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112800
.ZG21              ANOP  ,                                              00112900
                   AIF   (K'&EXTENDEDTYPES(1) LE 0).ZG21A               00113000
&ZTLC              SETC 'NO'                                            00113100
                   AIF   ('&EXTENDEDTYPES(1)' NE '&ZTLC').ZG22          00113200
&XEXTENDEDTYPES    SETC  'NO'        SET KEYWORD                        00113300
                   AIF   (N'&EXTENDEDTYPES LE 1).ZG21A  CK NUM          00113400
&ZMS               SETC  '"EXTENDEDTYPES='                              00113500
&ZMS               SETC  '&ZMS.&EXTENDEDTYPES"'                         00113600
&ZMS               SETC  '&ZMS "EXTENDEDTYPES"'                         00113700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00113800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00113900
.ZG21A             ANOP  ,                                              00114000
.*-------------------------------------------------------------------   00114100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114200
.ZG22              ANOP  ,                                              00114300
&ZTLC              SETC 'YES'                                           00114400
                   AIF   ('&EXTENDEDTYPES(1)' NE '&ZTLC').ZG23          00114500
&XEXTENDEDTYPES    SETC  'YES'       SET KEYWORD                        00114600
                   AIF   (N'&EXTENDEDTYPES LE 1).ZG22A  CK NUM          00114700
&ZMS               SETC  '"EXTENDEDTYPES='                              00114800
&ZMS               SETC  '&ZMS.&EXTENDEDTYPES"'                         00114900
&ZMS               SETC  '&ZMS "EXTENDEDTYPES"'                         00115000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00115100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00115200
.ZG22A             ANOP  ,                                              00115300
.*------------------------------------------------------------------    00115400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115500
.ZG23              ANOP  ,                                              00115600
&ZXEXTENDEDTYPES   SETC  'INPUT'     SET IN/OUTPUT                      00115700
                   AIF   (K'&XEXTENDEDTYPES GT 0).ZG23E  VALID ARG      00115800
                   AIF   (T'&EXTENDEDTYPES EQ 'O').ZG23D  OMITTED       00115900
&ZASYSLNDX         SETA  0                                              00116000
.ZG23A             ANOP  ,           POSITIONAL MACRO KEY               00116100
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00116200
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG23C               00116300
&ZTLC              SETC 'EXTENDEDTYPES'                                 00116400
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG23A      00116500
.ZG23B             ANOP  ,                                              00116600
&ZXEXTENDEDTYPES   SETC  ''          RESET IN/OUTPUT                    00116700
&ZMS               SETC  'THE "EXTENDEDTYPES" KEY'                      00116800
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00116900
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00117000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00117100
                   AGO   .ZG23E                                         00117200
.ZG23C             ANOP  ,                                              00117300
&ZXEXTENDEDTYPES   SETC  ''          RESET IN/OUTPUT                    00117400
&ZMS               SETC  '"EXTENDEDTYPES='                              00117500
&ZMS               SETC  '&ZMS.&EXTENDEDTYPES"'                         00117600
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00117700
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00117800
&ZMS               SETC  '&ZMS "NO"'                                    00117900
&ZMS               SETC  '&ZMS OR "YES".'                               00118000
                   MNOTE 8,' &ZMS '                                     00118100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00118200
                   AGO   .ZG23E                                         00118300
.ZG23D             ANOP  ,                                              00118400
&XEXTENDEDTYPES    SETC  'NO'        SET DEFAULT KEYWORD                00118500
.ZG23E             ANOP  ,                                              00118600
.*----------------------------------------------------------------***   00118700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00118800
                   AIF   (N'&RETCODE LE 1).ZG25A  CK NUM                00118900
&ZMS               SETC  '"RETCODE='                                    00119000
&ZMS               SETC  '&ZMS.&RETCODE"'                               00119100
&ZMS               SETC  '&ZMS "RETCODE"'                               00119200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00119300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00119400
.ZG25A             ANOP  ,                                              00119500
.*-------------------------------------------------------------------   00119600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00119700
                   AIF   (K'&RETCODE(1) LE 0).ZG25C  NO PARM            00119800
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00119900
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00120000
                   AIF   (N'&RETCODE GT 1).ZG25C                        00120100
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00120200
.ZG25C             ANOP  ,                                              00120300
.*-------------------------------------------------------------------   00120400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00120500
                   AIF   (K'&ZXRETCODE LE 0).ZG25R  NOT I/O             00120600
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG25R                00120700
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00120800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                   00120900
                   AIF   (K'&ZCGPR GT 2).ZG25Q                          00121000
                   AIF   ('&ZCGPR' EQ '0').ZG25Q                        00121100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00121200
                   AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME      00121300
.ZG25P             ANOP  ,                                              00121400
                   AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC           00121500
                   AIF   ('&ZCGPR' EQ '15').ZG25R                       00121600
                   AIF   ('&ZCGPR' LT '2').ZG25Q                        00121700
                   AIF   ('&ZCGPR' LE '12').ZG25R                       00121800
.ZG25Q             ANOP  ,                                              00121900
&ZMS               SETC  '"RETCODE='                                    00122000
&ZMS               SETC  '&ZMS.&RETCODE"'                               00122100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00122200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'       00122300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00122400
.ZG25R             ANOP  ,                                              00122500
.*----------------------------------------------------------------***   00122600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00122700
                   AIF   (N'&RSNCODE LE 1).ZG28A  CK NUM                00122800
&ZMS               SETC  '"RSNCODE='                                    00122900
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00123000
&ZMS               SETC  '&ZMS "RSNCODE"'                               00123100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00123200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00123300
.ZG28A             ANOP  ,                                              00123400
.*-------------------------------------------------------------------   00123500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00123600
                   AIF   (K'&RSNCODE(1) LE 0).ZG28C  NO PARM            00123700
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00123800
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00123900
                   AIF   (N'&RSNCODE GT 1).ZG28C                        00124000
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00124100
.ZG28C             ANOP  ,                                              00124200
.*-------------------------------------------------------------------   00124300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00124400
                   AIF   (K'&ZXRSNCODE LE 0).ZG28R  NOT I/O             00124500
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG28R                00124600
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00124700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                   00124800
                   AIF   (K'&ZCGPR GT 2).ZG28Q                          00124900
                   AIF   ('&ZCGPR' EQ '0').ZG28R                        00125000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00125100
                   AIF   (T'&ZCGPR NE 'N').ZG28Q  INVALID REG NAME      00125200
.ZG28P             ANOP  ,                                              00125300
                   AIF   (T'&ZCGPR NE 'N').ZG28R  NON NUMERIC           00125400
                   AIF   ('&ZCGPR' EQ '0').ZG28R                        00125500
                   AIF   ('&ZCGPR' LT '2').ZG28Q                        00125600
                   AIF   ('&ZCGPR' LE '12').ZG28R                       00125700
.ZG28Q             ANOP  ,                                              00125800
&ZMS               SETC  '"RSNCODE='                                    00125900
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00126000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00126100
                   MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'        00126200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00126300
.ZG28R             ANOP  ,                                              00126400
.******************************************************************     00126500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00126600
.******************************************************************     00126700
                   ACTR  10000                                          00126800
.*-------------------------------------------------------------------   00126900
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00127000
&ZCVAL             SETC  ''          ERROR FIELD                        00127100
&ZAWRK             SETA  0           POSITIONAL COUNTER                 00127200
&ZASYSLNDX         SETA  0           NON-X KEY COUNTER                  00127300
.ZGLIST2           ANOP  ,                                              00127400
&ZASYSLNDX         SETA  &ZASYSLNDX+1           NEXT NON-X KEY          00127500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00127600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00127700
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00127800
                   AIF   (&ZAWRK LE 0).ZGLIST2                          00127900
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA            00128000
                   AGO   .ZGLIST2                                       00128100
.*                                                                      00128200
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00128300
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00128400
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00128500
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00128600
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00128700
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00128800
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00128900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00129000
.ZGLISTX           ANOP  ,                                              00129100
&ZASYSLNDX         SETA  0                                              00129200
.*-------------------------------------------------------------------   00129300
.***AG.MF04 MF=(SLE)                                                    00129400
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00129500
.*******************************************************************    00129600
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00129700
.*******************************************************************    00129800
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00129900
.*******************************************************************    00130000
.***AE.01  START OF IFAQUERY MACRO CODE                                 00130100
.*******************************************************************    00130200
                   LCLC  &M0M0001                 NAME                  00130300
&M0M0001           SETC  '&XLABEL'                SET NAME              00130400
                   AIF   (K'&XLABEL NE 0).XLAB2                         00130500
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00130600
.*                                                                      00130700
.XLAB2             ANOP  ,                                              00130800
                   AIF   ('&XMF' EQ 'L').XLAB3                          00130900
&M0M0001 DS    0H                             IFAQUERY-0                00131000
.XLAB3             ANOP  ,                                              00131100
.*******************************************************************    00131200
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00131300
.*******************************************************************    00131400
              PUSH  PRINT                                               00131500
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00131600
                   PRINT OFF         ++ PR01                            00131700
                   AGO   .ZPRNTXX                                       00131800
.ZPRINTX           PRINT ON                                             00131900
.ZPRNTXX           ANOP  ,                                              00132000
.********************************************************************   00132100
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00132200
.********************************************************************   00132300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00132400
                      LCLA  &ZOPN1         INVOCATION INDEX             00132500
                      LCLC  &ZOPL(4095)    LABEL                        00132600
                      LCLC  &ZOPO(4095)    OPERATION                    00132700
                      LCLC  &ZOPV(4095)    VALUE                        00132800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00132900
.*                                                                      00133000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00133100
.******************************************************************     00133200
.***AL.L10 IFAQUERY FMT=LIST MF=S!L PARAMETERS                          00133300
.******************************************************************     00133400
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00133500
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00133600
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00133700
&XMFATTR              SETC  '0D'                                        00133800
.*                                                                      00133900
&ZOPN                 SETA  &ZOPN+1                                     00134000
&ZOPL(&ZOPN)          SETC  ' '                                         00134100
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00134200
&ZOPO(&ZOPN)          SETC  'B'                                         00134300
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00134400
                      AGO   .ZALVL6B                                    00134500
.ZALVL6A              ANOP                                              00134600
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00134700
&ZOPV(&ZOPN)          SETC  '4,8'                                       00134800
&ZOPN                 SETA  &ZOPN+1                                     00134900
&ZOPL(&ZOPN)          SETC  ' '                                         00135000
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00135100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00135200
.ZALVL6B              ANOP                                              00135300
&ZOPD(&ZOPN)          SETC  '++ IFAQUERY ARG PARMS'                     00135400
.*                                                                      00135500
&ZOPN                 SETA  &ZOPN+1                                     00135600
&ZOPL(&ZOPN)          SETC  ' '                                         00135700
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00135800
&ZOPV(&ZOPN)          SETC  '1'                                         00135900
&ZOPD(&ZOPN)          SETC  ' '                                         00136000
.*                                                                      00136100
.ZLMFSL2              ANOP  ,                                           00136200
.*-------------------------------------------------------------------   00136300
.***AM.L00  IFAQUERY FMT=LIST name                                      00136400
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00136500
&ZOPN                 SETA &ZOPN+1                                      00136600
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00136700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00136800
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00136900
&ZOPD(&ZOPN)          SETC '++ IFAQUERY NAME'                           00137000
.ZLMFSL2M             ANOP  ,                                           00137100
.*-------------------------------------------------------------------   00137200
.***AM.L01  IFAQUERY FMT=LIST PARAMETERS                                00137300
&ZOPN                 SETA &ZOPN+1                                      00137400
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00137500
&ZOPO(&ZOPN)          SETC 'DS'                                         00137600
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00137700
&ZOPD(&ZOPN)          SETC '++ IFAQUERY PARM LIST'                      00137800
.*-------------------------------------------------------------------   00137900
.***AM.L09  XACRONYM CL4                                                00138000
&ZOPN                 SETA &ZOPN+1                                      00138100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACRONYM'                         00138200
&ZOPO(&ZOPN)          SETC 'DS'                                         00138300
&ZOPV(&ZOPN)          SETC 'CL4'                                        00138400
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00138500
.*-------------------------------------------------------------------   00138600
.***AM.L09  XPLISTLEN XL2                                               00138700
&ZOPN                 SETA &ZOPN+1                                      00138800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00138900
&ZOPO(&ZOPN)          SETC 'DS'                                         00139000
&ZOPV(&ZOPN)          SETC 'XL2'                                        00139100
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00139200
.*-------------------------------------------------------------------   00139300
.***AM.L02 XVERSION XL1                                                 00139400
&ZOPN                 SETA &ZOPN+1                                      00139500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00139600
&ZOPO(&ZOPN)          SETC 'DS'                                         00139700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00139800
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00139900
.*-------------------------------------------------------------------   00140000
.***AM.L09  XRSV0001 CL1                                                00140100
&ZOPN                 SETA &ZOPN+1                                      00140200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00140300
&ZOPO(&ZOPN)          SETC 'DS'                                         00140400
&ZOPV(&ZOPN)          SETC 'CL1'                                        00140500
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00140600
.*-------------------------------------------------------------------   00140700
.***AM.L03 XFUNC_TYPE BL.8                                              00140800
&ZOPN                 SETA &ZOPN+1                                      00140900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNC_TYPE'                       00141000
&ZOPO(&ZOPN)          SETC 'DS'                                         00141100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00141200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00141300
.*                                                                      00141400
&ZOPN                 SETA  &ZOPN+1                                     00141500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_RETRIEVE'                00141600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00141700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00141800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00141900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RETRIEVE'                     00142000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00142100
.*-------------------------------------------------------------------   00142200
.***AM.L03 XREQ_TYPE BL.16                                              00142300
&ZOPN                 SETA &ZOPN+1                                      00142400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQ_TYPE'                        00142500
&ZOPO(&ZOPN)          SETC 'DS'                                         00142600
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00142700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00142800
.*                                                                      00142900
&ZOPN                 SETA  &ZOPN+1                                     00143000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_STATUS'                  00143100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00143200
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00143300
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00143400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).STATUS'                       00143500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00143600
.*-------------------------------------------------------------------   00143700
.***AM.L03 XINFLGS BL.8                                                 00143800
&ZOPN                 SETA &ZOPN+1                                      00143900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINFLGS'                          00144000
&ZOPO(&ZOPN)          SETC 'DS'                                         00144100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00144200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00144300
.*                                                                      00144400
&ZOPN                 SETA  &ZOPN+1                                     00144500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DETAILS'                 00144600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00144700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00144800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00144900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DETAILS'                      00145000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00145100
.*                                                                      00145200
&ZOPN                 SETA  &ZOPN+1                                     00145300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_EXTENDEDTYPES'           00145400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00145500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00145600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00145700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EXTENDEDTYPES'                00145800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00145900
.*-------------------------------------------------------------------   00146000
.***AM.L03 XDETAILS BL.8                                                00146100
&ZOPN                 SETA &ZOPN+1                                      00146200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDETAILS'                         00146300
&ZOPO(&ZOPN)          SETC 'DS'                                         00146400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00146500
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00146600
.*                                                                      00146700
&ZOPN                 SETA  &ZOPN+1                                     00146800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDETAILS_LOGSTREAM'              00146900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00147000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00147100
&ZOPD(&ZOPN)          SETC  '++ XDETAILS.'                              00147200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LOGSTREAM'                    00147300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00147400
.*                                                                      00147500
&ZOPN                 SETA  &ZOPN+1                                     00147600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDETAILS_FLOODPOLICY'            00147700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00147800
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00147900
&ZOPD(&ZOPN)          SETC  '++ XDETAILS.'                              00148000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).FLOODPOLICY'                  00148100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00148200
.*                                                                      00148300
&ZOPN                 SETA  &ZOPN+1                                     00148400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDETAILS_DROPHISTORY'            00148500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00148600
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00148700
&ZOPD(&ZOPN)          SETC  '++ XDETAILS.'                              00148800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DROPHISTORY'                  00148900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00149000
.*-------------------------------------------------------------------   00149100
.***AM.L03 XEXTENDEDTYPES BL.8                                          00149200
&ZOPN                 SETA &ZOPN+1                                      00149300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEXTENDEDTYPES'                   00149400
&ZOPO(&ZOPN)          SETC 'DS'                                         00149500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00149600
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00149700
.*                                                                      00149800
&ZOPN                 SETA  &ZOPN+1                                     00149900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XEXTENDEDTYPES_NO'               00150000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00150100
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00150200
&ZOPD(&ZOPN)          SETC  '++ XEXTENDEDTYPES.'                        00150300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           00150400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00150500
.*                                                                      00150600
&ZOPN                 SETA  &ZOPN+1                                     00150700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XEXTENDEDTYPES_YES'              00150800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00150900
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00151000
&ZOPD(&ZOPN)          SETC  '++ XEXTENDEDTYPES.'                        00151100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00151200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00151300
.*-------------------------------------------------------------------   00151400
.***AM.L09  XRSV0002 CL2                                                00151500
&ZOPN                 SETA &ZOPN+1                                      00151600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00151700
&ZOPO(&ZOPN)          SETC 'DS'                                         00151800
&ZOPV(&ZOPN)          SETC 'CL2'                                        00151900
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00152000
.*-------------------------------------------------------------------   00152100
.***AM.L09 ADDR XOUTAREA A                                              00152200
&ZOPN                 SETA &ZOPN+1                                      00152300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTAREA_ADDR'                    00152400
&ZOPO(&ZOPN)          SETC 'DS'                                         00152500
&ZOPV(&ZOPN)          SETC 'A'                                          00152600
&ZOPD(&ZOPN)          SETC '++ &ZXOUTAREA ADDR'                         00152700
.*-------------------------------------------------------------------   00152800
.***AM.L09 ALET XOUTAREA F                                              00152900
&ZOPN                 SETA &ZOPN+1                                      00153000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTAREA_ALET'                    00153100
&ZOPO(&ZOPN)          SETC 'DS'                                         00153200
&ZOPV(&ZOPN)          SETC 'F'                                          00153300
&ZOPD(&ZOPN)          SETC '++ &ZXOUTAREA ALET'                         00153400
.*-------------------------------------------------------------------   00153500
.***AM.L09  XOUTLEN F                                                   00153600
&ZOPN                 SETA &ZOPN+1                                      00153700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTLEN'                          00153800
&ZOPO(&ZOPN)          SETC 'DS'                                         00153900
&ZOPV(&ZOPN)          SETC 'F'                                          00154000
&ZOPD(&ZOPN)          SETC '++ &ZXOUTLEN '                              00154100
.*-------------------------------------------------------------------   00154200
.***AM.L09  XRSV0003 CL16                                               00154300
&ZOPN                 SETA &ZOPN+1                                      00154400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00154500
&ZOPO(&ZOPN)          SETC 'DS'                                         00154600
&ZOPV(&ZOPN)          SETC 'CL16'                                       00154700
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00154800
.*-------------------------------------------------------------------   00154900
.***AM.L10 END OF IFAQUERY LIST PARAMETERS                              00155000
&ZOPN                 SETA &ZOPN+1                                      00155100
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00155200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00155300
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00155400
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00155500
.*                                                                      00155600
&ZOPN                 SETA &ZOPN+1                                      00155700
&ZOPL(&ZOPN)          SETC ' '                                          00155800
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00155900
&ZOPV(&ZOPN)          SETC '1'                                          00156000
&ZOPD(&ZOPN)          SETC ' '                                          00156100
.*-------------------------------------------------------------------   00156200
.***AL.L12 IFAQUERY FMT=LIST MF=S!L PARAMETERS                          00156300
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00156400
.*                                                                      00156500
&ZOPN                 SETA  &ZOPN+1                                     00156600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00156700
&ZOPO(&ZOPN)          SETC  'DC'                                        00156800
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00156900
&ZOPD(&ZOPN)          SETC  '++ IFAQUERY ARG PARMS'                     00157000
.*                                                                      00157100
.ZLMFSLX              ANOP  ,                                           00157200
.*-------------------------------------------------------------------   00157300
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00157400
&ZPLLEN               SETA 44                                           00157500
.*                                                                      00157600
.******************************************************************     00157700
.***AI.L01 IFAQUERY FMT=LIST FILL IN PARAMETER AREA                     00157800
.******************************************************************     00157900
                      ACTR  10000                                       00158000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00158100
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00158200
&ZCVAL                SETC  'LAE'          XAX MODE                     00158300
.ZIMFXA               ANOP ,                                            00158400
.*                                                                      00158500
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00158600
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00158700
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00158800
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00158900
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00159000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00159100
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00159200
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00159300
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00159400
&ZOPN                 SETA  &ZOPN+1                                     00159500
&ZOPL(&ZOPN)          SETC  ' '                                         00159600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00159700
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00159800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00159900
                      AGO   .ZIMFNX                                     00160000
.*                                                                      00160100
.ZIMFN2               ANOP ,                                            00160200
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00160300
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00160400
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00160500
&ZOPN                 SETA  &ZOPN+1                                     00160600
&ZOPL(&ZOPN)          SETC  ' '                                         00160700
&ZOPO(&ZOPN)          SETC  'LAE'                                       00160800
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00160900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00161000
                      AGO   .ZIMFNX                                     00161100
.ZIMFNX1              ANOP ,                                            00161200
&ZOPN                 SETA  &ZOPN+1                                     00161300
&ZOPL(&ZOPN)          SETC  ' '                                         00161400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00161500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00161600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00161700
.ZIMFNX               ANOP ,                                            00161800
.********************************************************************   00161900
.***AI.L02 IFAQUERY FMT=LIST INITIALIZE PARAMETER AREA                  00162000
.********************************************************************   00162100
.***AI.L03 MF=(SLE)                                                     00162200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00162300
.*                                                                      00162400
&ZOPN                 SETA  &ZOPN+1                                     00162500
&ZOPL(&ZOPN)          SETC  ' '                                         00162600
&ZOPO(&ZOPN)          SETC  'XC'                                        00162700
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00162800
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00162900
.ZIMFLX               ANOP  ,                                           00163000
.*-------------------------------------------------------------------   00163100
.***AI.L60 XACRONYM CL4                                                 00163200
&ZOPN                 SETA  &ZOPN+1                                     00163300
&ZOPL(&ZOPN)          SETC  ' '                                         00163400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00163500
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''SMFQ'''                       00163600
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           00163700
.*-------------------------------------------------------------------   00163800
.***AI.L04 XPLISTLEN XL2                                                00163900
&ZOPN                 SETA  &ZOPN+1                                     00164000
&ZOPL(&ZOPN)          SETC  ' '                                         00164100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00164200
&ZOPV(&ZOPN)          SETC  '4(2,1),=AL2(&ZPLLEN)'                      00164300
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00164400
.*-------------------------------------------------------------------   00164500
.***AI.L05 XFUNC_TYPE BL1                                               00164600
&ZW                   SETC  ''                                          00164700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00164800
.*-------------------------------------------------------------------   00164900
.***AI.L08 XFUNC_TYPE "RETRIEVE"                                        00165000
.***      BL1'1XXXXXXX'                                                 00165100
         AIF   ('&XRETRIEVE' EQ '').ZI6A                                00165200
&ZW                   SETC  '&ZW.10000000'                              00165300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00165400
                      AGO   .ZI6C                                       00165500
.*                                                                      00165600
.ZI6A                 ANOP  ,                                           00165700
&ZW                   SETC  '&ZW.00000000'                              00165800
.ZI6C                 ANOP  ,                                           00165900
.*-------------------------------------------------------------------   00166000
.***AI.L11 XFUNC_TYPE BL1                                               00166100
                      AIF   ('&ZCLNG' NE 'YES').ZI6E  ALL ZERO BITS     00166200
&ZOPN                 SETA  &ZOPN+1                                     00166300
&ZOPL(&ZOPN)          SETC  ' '                                         00166400
&ZOPO(&ZOPN)          SETC  'OI'                                        00166500
&ZOPV(&ZOPN)          SETC  '8(1),B''&ZW'''                             00166600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00166700
.ZI6E                 ANOP  ,                                           00166800
.*-------------------------------------------------------------------   00166900
.***AI.L05 XREQ_TYPE BL2                                                00167000
&ZW                   SETC  ''                                          00167100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00167200
.*-------------------------------------------------------------------   00167300
.***AI.L08 XREQ_TYPE "STATUS"                                           00167400
.***      BL2'1XXXXXXXXXXXXXXX'                                         00167500
         AIF   ('&XSTATUS' EQ '').ZI8A                                  00167600
&ZW                   SETC  '&ZW.1000000000000000'                      00167700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00167800
                      AGO   .ZI8C                                       00167900
.*                                                                      00168000
.ZI8A                 ANOP  ,                                           00168100
&ZW                   SETC  '&ZW.0000000000000000'                      00168200
.ZI8C                 ANOP  ,                                           00168300
.*-------------------------------------------------------------------   00168400
.***AI.L10 XREQ_TYPE BL2                                                00168500
                      AIF   ('&ZCLNG' NE 'YES').ZI8E  ALL ZERO BITS     00168600
&ZOPN                 SETA  &ZOPN+1                                     00168700
&ZOPL(&ZOPN)          SETC  ' '                                         00168800
&ZOPO(&ZOPN)          SETC  'OC'                                        00168900
&ZOPV(&ZOPN)          SETC  '9(2,1),=BL2''&ZW'''                        00169000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00169100
.ZI8E                 ANOP  ,                                           00169200
.*-------------------------------------------------------------------   00169300
.***AI.L05 XINFLGS BL1                                                  00169400
&ZW                   SETC  ''                                          00169500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00169600
.*-------------------------------------------------------------------   00169700
.***AI.L08 XINFLGS "DETAILS"                                            00169800
.***      BL1'1XXXXXXX'                                                 00169900
         AIF   ('&DETAILS' EQ '').ZI10A                                 00170000
&ZW                   SETC  '&ZW.1'                                     00170100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00170200
                      AGO   .ZI10C                                      00170300
.*                                                                      00170400
.ZI10A                ANOP  ,                                           00170500
&ZW                   SETC  '&ZW.0'                                     00170600
.ZI10C                ANOP  ,                                           00170700
.*-------------------------------------------------------------------   00170800
.***AI.L08 XINFLGS "EXTENDEDTYPES"                                      00170900
.***      BL1'X1XXXXXX'                                                 00171000
         AIF   ('&EXTENDEDTYPES' EQ '').ZI11A                           00171100
&ZW                   SETC  '&ZW.1000000'                               00171200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00171300
                      AGO   .ZI11C                                      00171400
.*                                                                      00171500
.ZI11A                ANOP  ,                                           00171600
&ZW                   SETC  '&ZW.0000000'                               00171700
.ZI11C                ANOP  ,                                           00171800
.*-------------------------------------------------------------------   00171900
.***AI.L11 XINFLGS BL1                                                  00172000
                      AIF   ('&ZCLNG' NE 'YES').ZI11E  ALL ZERO BITS    00172100
&ZOPN                 SETA  &ZOPN+1                                     00172200
&ZOPL(&ZOPN)          SETC  ' '                                         00172300
&ZOPO(&ZOPN)          SETC  'OI'                                        00172400
&ZOPV(&ZOPN)          SETC  '11(1),B''&ZW'''                            00172500
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00172600
.ZI11E                ANOP  ,                                           00172700
.*-------------------------------------------------------------------   00172800
.***AI.L05 XDETAILS BL1                                                 00172900
&ZW                   SETC  ''                                          00173000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00173100
.*-------------------------------------------------------------------   00173200
.***AI.L08 XDETAILS "LOGSTREAM"                                         00173300
.***      BL1'X1XXXXXX'                                                 00173400
         AIF   ('&XDETAILS' NE 'LOGSTREAM').ZI13A                       00173500
&ZW                   SETC  '&ZW.01'                                    00173600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00173700
                      AGO   .ZI13C                                      00173800
.*                                                                      00173900
.ZI13A                ANOP  ,                                           00174000
&ZW                   SETC  '&ZW.00'                                    00174100
.ZI13C                ANOP  ,                                           00174200
.*-------------------------------------------------------------------   00174300
.***AI.L08 XDETAILS "FLOODPOLICY"                                       00174400
.***      BL1'XX1XXXXX'                                                 00174500
         AIF   ('&XDETAILS' NE 'FLOODPOLICY').ZI14A                     00174600
&ZW                   SETC  '&ZW.1'                                     00174700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00174800
                      AGO   .ZI14C                                      00174900
.*                                                                      00175000
.ZI14A                ANOP  ,                                           00175100
&ZW                   SETC  '&ZW.0'                                     00175200
.ZI14C                ANOP  ,                                           00175300
.*-------------------------------------------------------------------   00175400
.***AI.L08 XDETAILS "DROPHISTORY"                                       00175500
.***      BL1'XXX1XXXX'                                                 00175600
         AIF   ('&XDETAILS' NE 'DROPHISTORY').ZI15A                     00175700
&ZW                   SETC  '&ZW.10000'                                 00175800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00175900
                      AGO   .ZI15C                                      00176000
.*                                                                      00176100
.ZI15A                ANOP  ,                                           00176200
&ZW                   SETC  '&ZW.00000'                                 00176300
.ZI15C                ANOP  ,                                           00176400
.*-------------------------------------------------------------------   00176500
.***AI.L11 XDETAILS BL1                                                 00176600
                      AIF   ('&ZCLNG' NE 'YES').ZI15E  ALL ZERO BITS    00176700
&ZOPN                 SETA  &ZOPN+1                                     00176800
&ZOPL(&ZOPN)          SETC  ' '                                         00176900
&ZOPO(&ZOPN)          SETC  'OI'                                        00177000
&ZOPV(&ZOPN)          SETC  '12(1),B''&ZW'''                            00177100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00177200
.ZI15E                ANOP  ,                                           00177300
.*-------------------------------------------------------------------   00177400
.***AI.L05 XEXTENDEDTYPES BL1                                           00177500
&ZW                   SETC  ''                                          00177600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00177700
.*-------------------------------------------------------------------   00177800
.***AI.L08 XEXTENDEDTYPES "NO"                                          00177900
.***      BL1'1XXXXXXX'                                                 00178000
         AIF   ('&XEXTENDEDTYPES' NE 'NO').ZI17A                        00178100
&ZW                   SETC  '&ZW.1'                                     00178200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00178300
                      AGO   .ZI17C                                      00178400
.*                                                                      00178500
.ZI17A                ANOP  ,                                           00178600
&ZW                   SETC  '&ZW.0'                                     00178700
.ZI17C                ANOP  ,                                           00178800
.*-------------------------------------------------------------------   00178900
.***AI.L08 XEXTENDEDTYPES "YES"                                         00179000
.***      BL1'X1XXXXXX'                                                 00179100
         AIF   ('&XEXTENDEDTYPES' NE 'YES').ZI18A                       00179200
&ZW                   SETC  '&ZW.1000000'                               00179300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00179400
                      AGO   .ZI18C                                      00179500
.*                                                                      00179600
.ZI18A                ANOP  ,                                           00179700
&ZW                   SETC  '&ZW.0000000'                               00179800
.ZI18C                ANOP  ,                                           00179900
.*-------------------------------------------------------------------   00180000
.***AI.L11 XEXTENDEDTYPES BL1                                           00180100
                      AIF   ('&ZCLNG' NE 'YES').ZI18E  ALL ZERO BITS    00180200
&ZOPN                 SETA  &ZOPN+1                                     00180300
&ZOPL(&ZOPN)          SETC  ' '                                         00180400
&ZOPO(&ZOPN)          SETC  'OI'                                        00180500
&ZOPV(&ZOPN)          SETC  '13(1),B''&ZW'''                            00180600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00180700
.ZI18E                ANOP  ,                                           00180800
.*-------------------------------------------------------------------   00180900
.***AI.L19 ADDR XOUTAREA A                                              00181000
                      AIF   ('&ZXOUTAREA' EQ '').ZI20H                  00181100
&ZCLNG                SETC  '&XOUTAREA'                                 00181200
&ZCGPR                SETC  '14'                                        00181300
         AIF   ('&XOUTAREA'(1,1) EQ '(').ZI20F  IN GPR                  00181400
.*                                                                      00181500
&ZOPN                 SETA  &ZOPN+1                                     00181600
&ZOPL(&ZOPN)          SETC  ' '                                         00181700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00181800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00181900
&ZOPD(&ZOPN)          SETC  '++ &ZXOUTAREA XOUTAREA'                    00182000
.*                                                                      00182100
                      AGO   .ZI20G                                      00182200
.*                                                                      00182300
.ZI20F                ANOP  ,                                           00182400
&ZCGPR   SETC  '&XOUTAREA'(2,K'&XOUTAREA-2)                             00182500
.*                                                                      00182600
.ZI20G                ANOP  ,                                           00182700
.*                                                                      00182800
&ZOPN                 SETA  &ZOPN+1                                     00182900
&ZOPL(&ZOPN)          SETC  ' '                                         00183000
&ZOPO(&ZOPN)          SETC  'ST'                                        00183100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00183200
&ZOPD(&ZOPN)          SETC  '++ &ZXOUTAREA XOUTAREA'                    00183300
.*                                                                      00183400
.ZI20H                ANOP  ,                                           00183500
.*-------------------------------------------------------------------   00183600
.***AI.L23 ALET XOUTAREA F                                              00183700
         AIF   ('&ZXOUTAREA' EQ '').ZI21G                               00183800
         AIF   ('&SYSASCE' EQ 'P').ZI21G   SYSSTATE PRIMARY             00183900
&ZCLNG                SETC  '&XOUTAREA'                                 00184000
         AIF   ('&XOUTAREA'(1,1) EQ '(').ZI21E  IN AR                   00184100
.*                                                                      00184200
&ZCGPR                SETC  '14'                                        00184300
                      AGO   .ZI21F                                      00184400
.*                                                                      00184500
.ZI21E                ANOP  ,                                           00184600
&ZCGPR   SETC  '&XOUTAREA'(2,K'&XOUTAREA-2)                             00184700
.*                                                                      00184800
.ZI21F                ANOP  ,                                           00184900
.*                                                                      00185000
&ZOPN                 SETA  &ZOPN+1                                     00185100
&ZOPL(&ZOPN)          SETC  ' '                                         00185200
&ZOPO(&ZOPN)          SETC  'STAM'                                      00185300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,20(1)'                       00185400
&ZOPD(&ZOPN)          SETC  '++ &ZXOUTAREA XOUTAREA'                    00185500
.*                                                                      00185600
.ZI21G                ANOP  ,                                           00185700
.*-------------------------------------------------------------------   00185800
.***AI.L25  XOUTLEN F                                                   00185900
                      AIF   ('&ZXOUTLEN' EQ '').ZI22E                   00186000
                      AIF   ('&ZXOUTLEN' EQ 'OUTPUT').ZI22E             00186100
&ZCGPR                SETC  '&XOUTLEN'                                  00186200
.*                                                                      00186300
                      AIF   ('&XOUTLEN'(1,1) NE '(').ZI22B              00186400
&ZCGPR   SETC  '0('.'&XOUTLEN'(2,K'&XOUTLEN-2).')'                      00186500
                      AGO   .ZI22D                                      00186600
.ZI22B                ANOP  ,                                           00186700
.*                                                                      00186800
&ZC                   SETC  '&XOUTLEN'(1,1)                             00186900
                      AIF   (T'&ZC NE 'N').ZI22D                        00187000
&ZC                   SETC  '&XOUTLEN'                                  00187100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI22D               00187200
&ZCGPR                SETC  '=AL4(&XOUTLEN)'                            00187300
.*                                                                      00187400
.ZI22D                ANOP  ,                                           00187500
.*                                                                      00187600
&ZOPN                 SETA  &ZOPN+1                                     00187700
&ZOPL(&ZOPN)          SETC  ' '                                         00187800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00187900
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00188000
&ZOPD(&ZOPN)          SETC  '++ &ZXOUTLEN XOUTLEN'                      00188100
.*                                                                      00188200
.ZI22E                ANOP  ,                                           00188300
.*-------------------------------------------------------------------   00188400
&ZOPN1                SETA &ZOPN                                        00188500
.*******************************************************************    00188600
.***  PROCESS IFAQUERY OUTPUT PARAMETERS                                00188700
.*******************************************************************    00188800
                      ACTR  10000                                       00188900
.*******************************************************************    00189000
.***AO.X01  LABEL TO BYPASS INVOCATION                                  00189100
.*******************************************************************    00189200
&ZOPN                 SETA  &ZOPN+1                                     00189300
&ZOPL(&ZOPN)          SETC  'AMGE&SYSNDX'                               00189400
&ZOPO(&ZOPN)          SETC  'DS'                                        00189500
&ZOPV(&ZOPN)          SETC  '0H'                                        00189600
&ZOPD(&ZOPN)          SETC  '++ BYPASS INVOCATION'                      00189700
.*******************************************************************    00189800
.***AO.X02  RETURN CODE PROCESSING                                      00189900
.*******************************************************************    00190000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00190100
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00190200
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00190300
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00190400
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00190500
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00190600
&ZOPN                 SETA  &ZOPN+1                                     00190700
&ZOPL(&ZOPN)          SETC  ' '                                         00190800
&ZOPO(&ZOPN)          SETC  'ST'                                        00190900
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00191000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00191100
                      AGO   .ZMRETX                                     00191200
.*                                                                      00191300
.ZMRET2               ANOP  ,                                           00191400
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00191500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00191600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00191700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00191800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00191900
&ZOPN                 SETA  &ZOPN+1                                     00192000
&ZOPL(&ZOPN)          SETC  ' '                                         00192100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00192200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00192300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00192400
.ZMRETX               ANOP  ,                                           00192500
.*******************************************************************    00192600
.***AO.X03  REASON CODE PROCESSING                                      00192700
.*******************************************************************    00192800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00192900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00193000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00193100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00193200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00193300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00193400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00193500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00193600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00193700
&ZOPN                 SETA  &ZOPN+1                                     00193800
&ZOPL(&ZOPN)          SETC  ' '                                         00193900
&ZOPO(&ZOPN)          SETC  'ST'                                        00194000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00194100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00194200
                      AGO   .ZMRSNX                                     00194300
.*                                                                      00194400
.ZMRSN2               ANOP  ,                                           00194500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00194600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00194700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00194800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00194900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00195000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00195100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00195200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00195300
&ZOPN                 SETA  &ZOPN+1                                     00195400
&ZOPL(&ZOPN)          SETC  ' '                                         00195500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00195600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00195700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00195800
.ZMRSNX               ANOP  ,                                           00195900
.*******************************************************************    00196000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00196100
.*******************************************************************    00196200
.ZMFLX                ANOP  ,              MF=L PROCESSING              00196300
.*******************************************************************    00196400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00196500
.*******************************************************************    00196600
                      ACTR  10000                                       00196700
.*                                                                      00196800
                      LCLA  &ZLC           COLUMN POSITION              00196900
                      LCLA  &ZOPX          LIST TABLE INDEX             00197000
                      LCLC  &ZLL           LABEL                        00197100
                      LCLC  &ZLOP          OPERATION                    00197200
                      LCLC  &ZLV           VALUE                        00197300
                      LCLC  &ZLD           DESCRIPTION                  00197400
.*                                                                      00197500
&ZOPX                 SETA  1                                           00197600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00197700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00197800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00197900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00198000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00198100
                      AIF   (K'&ZLD LE 0).ZL5                           00198200
&ZLC                  SETA  35             COMMENT COLUMN               00198300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00198400
&ZLC                  SETA  33             COMMMENT COLUMN              00198500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00198600
&ZLV                  SETC  '&ZLV'.' '                                  00198700
                      AGO   .ZL3                                        00198800
.*                                                                      00198900
.ZL4                  ANOP  ,                                           00199000
&ZLV                  SETC  '&ZLV'.' '                                  00199100
.ZL5                  ANOP  ,                                           00199200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00199300
.*                                                                      00199400
&ZLL     &ZLOP &ZLV                                                     00199500
.*                                                                      00199600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00199700
                      AGO   .ZL2           CONTINUE LOOPING             00199800
.*                                                                      00199900
.ZLX                  ANOP  ,                                           00200000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00200100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00200200
&A       SETA  &SYSNDX                                             @01A 00200300
.*********************************************************************  00200400
.*  Check if SMF is active                                        @01A* 00200500
.*********************************************************************  00200600
         L     15,16(0,0)         ++ Get CVT address               @01A 00200700
         L     15,196(,15)        ++ Get SMCA address              @01A 00200800
         LTR   15,15              ++ Test if SMCA exists           @01A 00200900
         JZ    QRY1&A             ++ Branch if no SMCA             @01A 00201000
         TM    1(15),X'40'        ++ Test if SMF is active         @01A 00201100
         JNO   QRY1&A             ++ Branch if SMF is not active   @01A 00201200
.*********************************************************************  00201300
.*                                                                   *  00201400
.*  Get LX/EX for SMF Query service                                  *  00201500
.*                                                                   *  00201600
.*  Note: SMF PC number is calculated by multiplying SMF entry in    *  00201700
.*        the XM@ table (35) times the length of a PC/AUTH table     *  00201800
.*        entry (4) and then subtracting 4. Then entry index (1)     *  00201900
.*        should be added to SMF PC number to get IFAPCQRY PC        *  00202000
.*        number. In other words offset in SFT table for SMF PC      *  00202100
.*        number is 35*4-4=136.                                      *  00202200
.*                                                                   *  00202300
.*********************************************************************  00202400
         L     15,16(0,0)         ++ Get CVT address                    00202500
         L     15,772(15,0)       ++ Get SFT address                    00202600
         L     15,136(15,0)       ++ Get SMF PC number                  00202700
         PC    1(15)              ++ PC to IFAPCQRY                     00202800
         J     QRY2&A             ++ Branch around set RC=12       @01A 00202900
QRY1&A   DS    0H                                                  @01A 00203000
         LA    15,12              ++ SMF not active, set rc=12     @01A 00203100
         LA    R0,3073            ++ SMF not active, set RSN=0C01x @01A 00203200
QRY2&A   DS    0H                                                  @01A 00203300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00203400
.ZLINKX               ANOP  ,                                           00203500
.*******************************************************************    00203600
.***AP.X01  FORMAT GENERATED CODE                                       00203700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00203800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00203900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00204000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00204100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00204200
                      AIF   (K'&ZLD LE 0).ZL51                          00204300
&ZLC                  SETA  35             COMMENT COLUMN               00204400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00204500
&ZLC                  SETA  33             COMMENT COLUMN               00204600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00204700
&ZLV                  SETC  '&ZLV'.' '                                  00204800
                      AGO   .ZL31                                       00204900
.*                                                                      00205000
.ZL41                 ANOP  ,                                           00205100
&ZLV                  SETC  '&ZLV'.' '                                  00205200
.ZL51                 ANOP  ,                                           00205300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00205400
.*                                                                      00205500
&ZLL     &ZLOP &ZLV                                                     00205600
.*                                                                      00205700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00205800
                      AGO   .ZL21          CONTINUE LOOPING             00205900
.*                                                                      00206000
.ZLX1                 ANOP  ,                                           00206100
.*******************************************************************    00206200
.***AP.X02  END OF IFAQUERY MACRO                                       00206300
&ZIFAQUERY            SETC  'YES'          SET IFAQUERY USED            00206400
         POP   PRINT                                                    00206500
*                                            IFAQUERY-0                 00206600
         SPACE 1                                                        00206700
.ZLX2                 ANOP  ,                                           00206800
         MEND                                                           00206900
**********************************************************************/ 00207000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00207100
*%IFAQUERY: MACRO KEYS(RETRIEVE,STATUS,OUTAREA,OUTLEN,DETAILS,          00207200
*                 EXTENDEDTYPES,RETCODE,RSNCODE,PLISTVER,MF);           00207300
*  ANS('?'!!MACLABEL!!' '!!'IFAQUERP '!!MACLIST!!                       00207400
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00207500
*%END IFAQUERY;                                                         00207600

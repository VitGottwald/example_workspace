*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  HISSERV                               -11/04/14-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  HISSERV Service Interface                     * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2013, 2015                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77A0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      HISSERV provides an interface to begin profiling and retrieve  * 00002100
*      instrumentation data from the system. There are currently two  * 00002200
*      types of instrumentation data:                                 * 00002300
*                                                                     * 00002400
*                                                                     * 00002500
*      Events         Events are recorded at the CPU level. As events * 00002600
*                     occur they are captured and recorded, to be     * 00002700
*                     queried at any interval determined by software. * 00002800
*                     Events are grouped into event types, which can  * 00002900
*                     be enabled and disabled independently of each   * 00003000
*                     other.                                          * 00003100
*                                                                     * 00003200
*      Sampling       At predetermined intervals, a sample            * 00003300
*                     representing the current state of a CPU is      * 00003400
*                     stored into a Sampling Data Buffer (SDBs). As   * 00003500
*                     SDBs are filled software is notified allowing   * 00003600
*                     the software to process the full SDBs. The SDBs * 00003700
*                     are then cleared to be reused by the hardware.  * 00003800
*                     There are different sampling types that can be  * 00003900
*                     enabled and disabled independently of each      * 00004000
*                     other, however a profiler can only indicate its * 00004100
*                     intention to receive sampling data. The         * 00004200
*                     sampling frequency, as well as which sampling   * 00004300
*                     types are enabled are determined by the service * 00004400
*                     parameters specified on a F hisproc,SERVICE     * 00004500
*                     command or a F hisproc,BEGIN command.           * 00004600
*                                                                     * 00004700
*                                                                     * 00004800
*      Specifically, with HISSERV you can do the following:           * 00004900
*                                                                     * 00005000
*                                                                     * 00005100
*      o   Query for event info such as determining which events and  * 00005200
*          event types are available.  (REQUEST=QUERY,TYPE=EVENT).    * 00005300
*                                                                     * 00005400
*      o   Query for sampling info such as the sampling interval and  * 00005500
*          which sampling types are available.                        * 00005600
*          (REQUEST=QUERY,TYPE=SAMPLE).                               * 00005700
*                                                                     * 00005800
*      o   Query for statistics of whomever is currently profiling    * 00005900
*          the system.  (REQUEST=QUERY,TYPE=PROFILERS).               * 00006000
*                                                                     * 00006100
*      o   Begin profiling the system, indicating to the system the   * 00006200
*          intention of collecting one or more event types and/or     * 00006300
*          sampling data.  Requests that require a PROFILETKN must    * 00006400
*          first use this to identify itself as wanting to profile    * 00006500
*          the system.  (REQUEST=PROFILE,ACTION=START)                * 00006600
*                                                                     * 00006700
*      o   Stop profiling the system. The PROFILETKN is no longer     * 00006800
*          useable and when the last profiler stops profiling the     * 00006900
*          system, any unnecessary resources are released.            * 00007000
*          (REQUEST=PROFILE,ACTION=STOP)                              * 00007100
*                                                                     * 00007200
*      o   Query for event data provided by the service. Requires a   * 00007300
*          PROFILETKN.  (REQUEST=QUERY,TYPE=EVENTDATA).               * 00007400
*                                                                     * 00007500
*                                                                     * 00007600
*      The HISSERV service is only enabled when the HIS address space * 00007700
*      has been initialized. The dynamic exit HIS.SERVSTAT can be     * 00007800
*      used to be notified when the service has been enabled or       * 00007900
*      disabled.                                                      * 00008000
*                                                                     * 00008100
*01* EXTERNAL CLASSIFICATION:                                         * 00008200
*                                                                     * 00008300
*02* PI:   BASE                                                       * 00008400
*                                                                     * 00008500
*02* NONE: FIELDS                                                     * 00008600
*          MF=M                                                       * 00008700
*          TRCTIME                                                    * 00008800
*                                                                     * 00008900
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00009000
*                                                                     * 00009100
*01* ENVIRONMENT:                                                     * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*      Minimum authorization:                                         * 00009500
*                                                                     * 00009600
*                            Supervisor state or PKM 0-7.             * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*      Dispatchable unit mode: Task mode.                             * 00010100
*                                                                     * 00010200
*      Cross Memory Mode: PASN=HASN=SASN.                             * 00010300
*                                                                     * 00010400
*      AMODE:            31- or 64-bit.                               * 00010500
*                                                                     * 00010600
*      ASC mode:         Primary or Access Register.                  * 00010700
*                                                                     * 00010800
*      Interrupt status: Enabled for I/O and external interrupts.     * 00010900
*                                                                     * 00011000
*      Locks:            The caller must not be holding any locks.    * 00011100
*                                                                     * 00011200
*      Control parameters: Control parameters must be in the primary  * 00011300
*                        address space or, for AR-mode callers, must  * 00011400
*                        be in an address/data space that is          * 00011500
*                        addressable through a public entry on the    * 00011600
*                        caller's dispatchable unit access list       * 00011700
*                        (DU-AL).                                     * 00011800
*                                                                     * 00011900
*                        The user-provided answer area (via the       * 00012000
*                        ANSAREA parameter) has the same requirements * 00012100
*                        and restrictions as the control parameters.  * 00012200
*                                                                     * 00012300
*                        The user-provided CPU bitmask (via the       * 00012400
*                        CPUMASK parameter) has the same requirements * 00012500
*                        and restrictions as the control parameters.  * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*01* PROGRAMMING REQUIREMENTS:                                        * 00013000
*                                                                     * 00013100
*    The caller should include the HISYSERV macro to get equate       * 00013200
*    symbols for the return and reason codes.                         * 00013300
*                                                                     * 00013400
*    The caller must include the HISYSERV macro to get a mapping of   * 00013500
*    the output area provided via the ANSAREA parameter for           * 00013600
*    REQUEST=QUERY.                                                   * 00013700
*                                                                     * 00013800
*    The caller must include the HISYEXIT macro to get a mapping of   * 00013900
*    the parameter area passed to the exit routine specified by the   * 00014000
*    EXITRTN parameter for REQUEST=PROFILE,ACTION=START requests.     * 00014100
*                                                                     * 00014200
*    The caller must include the HISYSMPX macro to get a mapping of   * 00014300
*    the parameter area passed to the exit routine specified by the   * 00014400
*    EXITRTN parameter for REQUEST=PROFILE,ACTION=START requests,     * 00014500
*    when the profiler requests sampling data (SAMPLE=YES).           * 00014600
*                                                                     * 00014700
*    The caller must include the HISYCTRS macro to get equate symbols * 00014800
*    for the counter numbers and definitions of each event type.      * 00014900
*                                                                     * 00015000
*01* RESTRICTIONS:                                                    * 00015100
*                                                                     * 00015200
*    The caller must not have functional recovery routines (FRRs)     * 00015300
*    established.                                                     * 00015400
*                                                                     * 00015500
*01* INPUT REGISTER INFORMATION:                                      * 00015600
*                                                                     * 00015700
*    Before issuing the HISSERV macro, the caller does not have to    * 00015800
*    place any information into any general purpose register (GPR)    * 00015900
*    unless using it in register notation for a particular parameter, * 00016000
*    or using it as a base register.                                  * 00016100
*                                                                     * 00016200
*    Before issuing the HISSERV macro, the caller does not have to    * 00016300
*    place any information into any access register (AR) unless using * 00016400
*    it in register notation for a particular parameter, or using it  * 00016500
*    as a base register.                                              * 00016600
*                                                                     * 00016700
*01* OUTPUT REGISTER INFORMATION:                                     * 00016800
*                                                                     * 00016900
*    When control returns to the caller, the GPRs contain:            * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*    REGISTER    CONTENTS                                             * 00017300
*                                                                     * 00017400
*    0           Reason code if GPR15 is not 0                        * 00017500
*                                                                     * 00017600
*    1           Used as work registers by the system                 * 00017700
*                                                                     * 00017800
*    2-13        Unchanged                                            * 00017900
*                                                                     * 00018000
*    14          Used as a work register by the system                * 00018100
*                                                                     * 00018200
*    15          Return code                                          * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*    When control returns to the caller, the ARs contain:             * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*    REGISTER    CONTENTS                                             * 00019000
*                                                                     * 00019100
*    0-1         Used as work registers by the system                 * 00019200
*                                                                     * 00019300
*    2-13        Unchanged                                            * 00019400
*                                                                     * 00019500
*    14-15       Used as work registers by the system                 * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*    Some callers depend on register contents remaining the same      * 00020000
*    before and after issuing a service.  If the system changes the   * 00020100
*    contents of registers on which the caller depends, the caller    * 00020200
*    must save them before issuing the service, and restore them      * 00020300
*    after the system returns control.                                * 00020400
*                                                                     * 00020500
*01* PERFORMANCE IMPLICATIONS:                                        * 00020600
*    None.                                                            * 00020700
*                                                                     * 00020800
*01* SYNTAX:                                                          * 00020900
*                                                                     * 00021000
*Ýxlabel¨  HISSERV  Ð  REQUEST=PROFILE                                * 00021100
*                   !   Ð ,ACTION=START                               * 00021200
*                   !   !     ,OUTPROFILETKN                          * 00021300
*                   !   !                    =xoutprofiletkn          * 00021400
*                   !   !    Ý,EVENT=»xevent!NO_EVENTº                * 00021500
*                   !   !        Ý,TRCTIME=»xtrctime!ALLº¨¨           * 00021600
*                   !   !    Ý,SAMPLE=»NO!YESº¨                       * 00021700
*                   !   !     ,NAME=xname                             * 00021800
*                   !   !     ,EXITRTN=xexitrtn                       * 00021900
*                   !   ¿ ,ACTION=STOP                                * 00022000
*                   !         ,PROFILETKN=xprofiletkn                 * 00022100
*                   ¿ ,REQUEST=QUERY                                  * 00022200
*                         ,ANSAREA=xansarea                           * 00022300
*                         ,ANSLEN=xanslen                             * 00022400
*                       Ð ,TYPE=EVENTDATA                             * 00022500
*                       !     ,PROFILETKN=xprofiletkn                 * 00022600
*                       !    Ý,CPUMASK=»xcpumask!ALLº¨                * 00022700
*                       Ô ,TYPE=EVENT                                 * 00022800
*                       Ô ,TYPE=SAMPLE                                * 00022900
*                       ¿ ,TYPE=PROFILERS                             * 00023000
*                    Ý,RETCODE=xretcode¨                              * 00023100
*                    Ý,RSNCODE=xrsncode¨                              * 00023200
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00023300
*                   ÐÝ,MF=S¨                                          * 00023400
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00023500
*                   ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00023600
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*      Where:                                                         * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*      Ýxlabel¨                                                       * 00024300
*          is an optional symbol, starting in column 1, that is the   * 00024400
*          name on the HISSERV macro invocation.  The name must       * 00024500
*          conform to the rules for an ordinary assembler language    * 00024600
*          symbol.                                                    * 00024700
*          DEFAULT: No name.                                          * 00024800
*                                                                     * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*      REQUEST=»PROFILE!QUERYº                                        * 00025300
*          is a required keyword input used to indicate the type of   * 00025400
*          request.                                                   * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*          REQUEST=PROFILE                                            * 00025800
*              indicates the intention to start or stop profiling the * 00025900
*              system.                                                * 00026000
*                                                                     * 00026100
*                                                                     * 00026200
*              ACTION=»START!STOPº                                    * 00026300
*                  is a required keyword input used to indicate the   * 00026400
*                  profiling action to take. Note that a PROFILE      * 00026500
*                  action cannot be requested from within a           * 00026600
*                  profiler's exit routine, nor should it be          * 00026700
*                  requested from a work unit holding a resource      * 00026800
*                  required by a profiler's exit routine.             * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                  ACTION=START                                       * 00027200
*                      indicates to start profiling the system.       * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                      OUTPROFILETKN=xoutprofiletkn                   * 00027600
*                          is the name (RS-type), or address in       * 00027700
*                          register (2)-(12), of a required 16        * 00027800
*                          character output into which the unique     * 00027900
*                          profiler token to identify this profiler   * 00028000
*                          will be returned. If this is the first     * 00028100
*                          profiler of the system, resources          * 00028200
*                          associated with profiling will be obtained * 00028300
*                          and held until the last profiler stops     * 00028400
*                          profiling the system.                      * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                      ÝEVENT=»xevent!NO_EVENTº                       * 00029000
*                          is the name (RS-type), or address in       * 00029100
*                          register (2)-(12), of an optional 32 bit   * 00029200
*                          input which should contain the event types * 00029300
*                          to profile. When querying the event data,  * 00029400
*                          only the event types specified when        * 00029500
*                          starting to PROFILE the system will be     * 00029600
*                          returned.  If the event types are not      * 00029700
*                          authorized at the time of the PROFILE      * 00029800
*                          request the request will be remembered.    * 00029900
*                          Later if the system becomes authorized for * 00030000
*                          that event type, it will be returned in    * 00030100
*                          any subsequent event data query. The       * 00030200
*                          storage is mapped by HisEvnTyp in macro    * 00030300
*                          HISYSERV and must be a subset of the event * 00030400
*                          type data returned in HisEvn_ValidEvnTyp,  * 00030500
*                          which is returned in the                   * 00030600
*                          REQUEST=QUERY,TYPE=EVENT request. If       * 00030700
*                          EVENT=NO_EVENT or the storage passed in is * 00030800
*                          binary zeroes, the profiler will not be    * 00030900
*                          able to query for event data.              * 00031000
*                          DEFAULT: NO_EVENT                          * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                          ÝTRCTIME=»xtrctime!ALLº¨¨                  * 00031400
*                              is the name (RS-type), or address in   * 00031500
*                              register (2)-(12), of an optional 8    * 00031600
*                              character input which specifies the    * 00031700
*                              amount of time (in TOD format) of      * 00031800
*                              trace data to capture and return when  * 00031900
*                              querying for event data and the        * 00032000
*                              profiler has indicated to capture      * 00032100
*                              HisEvnTyp_SysTrace events. If event    * 00032200
*                              HisEvnTyp_SysTrace is not requested    * 00032300
*                              this parameter is ignored by the       * 00032400
*                              service. If the time is ever greater   * 00032500
*                              than the amount of available trace     * 00032600
*                              buffers provided by the system (via    * 00032700
*                              the TRACE command), all available      * 00032800
*                              buffers will be returned for each CPU. * 00032900
*                              Specify binary zeroes or TRCTIME=ALL   * 00033000
*                              to obtain all available trace buffers. * 00033100
*                              For IBM use only.                      * 00033200
*                              DEFAULT: ALL                           * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*                      ÝSAMPLE=»NO!YESº¨                              * 00034000
*                          is an optional keyword input which is used * 00034100
*                          to determine whether to receive callbacks  * 00034200
*                          with sampling data. When SAMPLE=YES, the   * 00034300
*                          exit routine defined in the EXITRTN        * 00034400
*                          parameter will be called as Sampling Data  * 00034500
*                          Blocks (SDBs) become available.  If        * 00034600
*                          sampling is not authorized at the time of  * 00034700
*                          the PROFILE request the request will be    * 00034800
*                          remembered. Later if the system becomes    * 00034900
*                          authorized for sampling, it will begin     * 00035000
*                          providing sampling data. The types of      * 00035100
*                          sampling entries returned by the service   * 00035200
*                          is dependent on the configuration of the   * 00035300
*                          service by the SAMPTYPE parameter from the * 00035400
*                          most recent F hisproc,SERVICE or F         * 00035500
*                          hisproc,BEGIN command.                     * 00035600
*                          DEFAULT: NO                                * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*                          SAMPLE=NO                                  * 00036000
*                              Do not receive callbacks with sampling * 00036100
*                              data.                                  * 00036200
*                                                                     * 00036300
*                          SAMPLE=YES                                 * 00036400
*                              Receive callbacks with sampling data.  * 00036500
*                                                                     * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                      NAME=xname                                     * 00037200
*                          is the name (RS-type), or address in       * 00037300
*                          register (2)-(12), of a required 8         * 00037400
*                          character input which should contain the   * 00037500
*                          unique name identifying this profiler. The * 00037600
*                          name should use EBCDIC characters from     * 00037700
*                          among the set of alphanumerics.  The NAME  * 00037800
*                          will be returned in any QUERY,TYPE=PROFILE * 00037900
*                          queries to identify this profiler. This    * 00038000
*                          name will also be displayed as output from * 00038100
*                          the D HIS command. The NAME specified      * 00038200
*                          should be one that easily identifies the   * 00038300
*                          product requesting the profiling, for      * 00038400
*                          example the HIS supplied profiler starts   * 00038500
*                          with "HIS". The service will not allow     * 00038600
*                          another name starting with "HIS". The NAME * 00038700
*                          must be unique for each profiler           * 00038800
*                          registered with the service.               * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*                      EXITRTN=xexitrtn                               * 00039400
*                          is the name (RS-type), or address in       * 00039500
*                          register (2)-(12), of a required 8         * 00039600
*                          character input which should contain the   * 00039700
*                          name of the exit routine that will be      * 00039800
*                          called when the service needs to notify    * 00039900
*                          the profiler for some reason, such as for  * 00040000
*                          sampling callbacks. The exit routine must  * 00040100
*                          reside in LPA, the LNKLST LNKLST           * 00040200
*                          concatenation, or the nucleus. The         * 00040300
*                          interface to the exit routine is described * 00040400
*                          in macro HISYEXIT. The EXITRTN must be     * 00040500
*                          unique for each profiler registered with   * 00040600
*                          the service.                               * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*                  ACTION=STOP                                        * 00041100
*                      indicates to stop profiling the system. When   * 00041200
*                      profiling for sampling data, the exit routine  * 00041300
*                      specified by EXITRTN will receive a final      * 00041400
*                      sampling related callback, with the            * 00041500
*                      HisSmpParmFlgs_Last flag on, for each CPU that * 00041600
*                      is currently sampling. Note this service call  * 00041700
*                      will not return until after the EXITRTN has    * 00041800
*                      handled every CPU's final sampling callback.   * 00041900
*                      If no more profilers are profiling the system, * 00042000
*                      all resources associated with profiling will   * 00042100
*                      be released.                                   * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*                      PROFILETKN=xprofiletkn                         * 00042500
*                          is the name (RS-type), or address in       * 00042600
*                          register (2)-(12), of a required 16        * 00042700
*                          character input which should contain the   * 00042800
*                          profiler's unique token received from this * 00042900
*                          profiler's REQUEST=PROFILE,ACTION=START    * 00043000
*                          request (parameter OUTPROFILETKN).  The    * 00043100
*                          profiler's token will no longer be         * 00043200
*                          useable.                                   * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*                                                                     * 00043700
*                                                                     * 00043800
*                                                                     * 00043900
*                                                                     * 00044000
*          REQUEST=QUERY                                              * 00044100
*              indicates to query the service.                        * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*              ANSAREA=xansarea                                       * 00044500
*                  is the name (RS-type), or address in register      * 00044600
*                  (2)-(12), of a required character input which will * 00044700
*                  be used by the service to store information        * 00044800
*                  associated with the query request. Macro HISYSERV  * 00044900
*                  contains mappings of the answer areas to provide,  * 00045000
*                  the size of the area depends on the type of query  * 00045100
*                  being requested. The minimum amount of storage     * 00045200
*                  required for the request to be successful and      * 00045300
*                  return a subset of the data, is HisAns_kLength.    * 00045400
*                                                                     * 00045500
*                                                                     * 00045600
*                                                                     * 00045700
*                                                                     * 00045800
*              ANSLEN=xanslen                                         * 00045900
*                  is the name (RS-type), or address in register      * 00046000
*                  (2)-(12), of a required doubleword input which     * 00046100
*                  should contain the length of the provided answer   * 00046200
*                  area. The length depends on the query that is      * 00046300
*                  requested. The minimum ANSLEN required for the     * 00046400
*                  request to be successful and return a subset of    * 00046500
*                  the data, is HisAns_kLength.                       * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*              TYPE=»EVENTDATA!EVENT!SAMPLE!PROFILERSº                * 00047100
*                  is a required keyword input used to indicate the   * 00047200
*                  type of query to process.                          * 00047300
*                                                                     * 00047400
*                                                                     * 00047500
*                  TYPE=EVENTDATA                                     * 00047600
*                      indicates to process a query event data        * 00047700
*                      request. ANSAREA should point to storage that  * 00047800
*                      will be mapped by HisEvnData in macro          * 00047900
*                      HISYSERV. It is possible for the amount of     * 00048000
*                      storage required to change between two         * 00048100
*                      consecutive TYPE=EVENTDATA queries, depending  * 00048200
*                      on which event types are currently authorized  * 00048300
*                      in the system and which CPUs are currently     * 00048400
*                      online.                                        * 00048500
*                                                                     * 00048600
*                                                                     * 00048700
*                      PROFILETKN=xprofiletkn                         * 00048800
*                          is the name (RS-type), or address in       * 00048900
*                          register (2)-(12), of a required 16        * 00049000
*                          character input which should contain the   * 00049100
*                          profiler's unique token received from this * 00049200
*                          profilers's REQUEST=PROFILE,ACTION=START   * 00049300
*                          request (parameter OUTPROFILETKN).         * 00049400
*                                                                     * 00049500
*                                                                     * 00049600
*                                                                     * 00049700
*                                                                     * 00049800
*                      ÝCPUMASK=»xcpumask!ALLº¨                       * 00049900
*                          is the name (RS-type), or address in       * 00050000
*                          register (2)-(12), of an optional          * 00050100
*                          character input representing a bitmask of  * 00050200
*                          which CPUs to query event data. The        * 00050300
*                          bitmask should be ECVTMaxMPNumBytesInMask  * 00050400
*                          bytes long. When Bit 0 is on, CPU 0's      * 00050500
*                          event data will be queried, and so forth   * 00050600
*                          up to the bit position at CVTMAXMP. If     * 00050700
*                          requesting all CPUs specify ALL, pass in a * 00050800
*                          CPUMASK of binary ones, or omit the        * 00050900
*                          CPUMASK parameter.                         * 00051000
*                          DEFAULT: ALL                               * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                  TYPE=EVENT                                         * 00051500
*                      indicates to process a query event request.    * 00051600
*                      ANSAREA should point to storage that will be   * 00051700
*                      mapped by HisEvn in macro HISYSERV.            * 00051800
*                                                                     * 00051900
*                  TYPE=SAMPLE                                        * 00052000
*                      indicates to process a query sample request.   * 00052100
*                      ANSAREA should point to storage that will be   * 00052200
*                      mapped by HisSmp in macro HISYSERV.            * 00052300
*                                                                     * 00052400
*                  TYPE=PROFILERS                                     * 00052500
*                      indicates to process a query profiler info     * 00052600
*                      request. ANSAREA should point to storage that  * 00052700
*                      will be mapped by HisProf in macro HISYSERV.   * 00052800
*                      It is possible for the amount of storage       * 00052900
*                      required to change between two consecutive     * 00053000
*                      TYPE=PROFILERS queries, depending on the       * 00053100
*                      current number of profilers in the system.     * 00053200
*                                                                     * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*                                                                     * 00054000
*                                                                     * 00054100
*                                                                     * 00054200
*      ÝRETCODE=xretcode¨                                             * 00054300
*          is the name (RS-type) of an optional fullword output       * 00054400
*          variable, or register (2)-(12) or (15), into which the     * 00054500
*          return code is to be copied from GPR 15.  If you specify   * 00054600
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00054700
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00054800
*          with MF=M.                                                 * 00054900
*                                                                     * 00055000
*                                                                     * 00055100
*                                                                     * 00055200
*                                                                     * 00055300
*      ÝRSNCODE=xrsncode¨                                             * 00055400
*          is the name (RS-type) of an optional fullword output       * 00055500
*          variable into which the reason code is to be copied from   * 00055600
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00055700
*          R0 (within or without parentheses), the value will be left * 00055800
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00055900
*                                                                     * 00056000
*                                                                     * 00056100
*                                                                     * 00056200
*                                                                     * 00056300
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00056400
*          is an optional byte input decimal value in the "0-0" range * 00056500
*          that specifies the macro version.  PLISTVER is the only    * 00056600
*          key allowed on the list form of MF and determines which    * 00056700
*          parameter list is generated.  Note that MAX may be         * 00056800
*          specified instead of a number, and the parameter list will * 00056900
*          be of the largest size currently supported. This size may  * 00057000
*          grow from release to release (thus possibly affecting the  * 00057100
*          amount of storage needed by your program).  If your        * 00057200
*          program can tolerate this, IBM recommends that you always  * 00057300
*          specify MAX when creating the list form parameter list as  * 00057400
*          that will ensure that the list form parameter list is      * 00057500
*          always long enough to hold whatever parameters might be    * 00057600
*          specified on the execute form.                             * 00057700
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00057800
*          default is the lowest version which allows all of the      * 00057900
*          parameters specified on the invocation to be processed.    * 00058000
*                                                                     * 00058100
*                                                                     * 00058200
*                                                                     * 00058300
*                                                                     * 00058400
*      ÝMF=»S!L!M!Eº¨                                                 * 00058500
*          is an optional keyword input which specifies the macro     * 00058600
*          form.                                                      * 00058700
*          DEFAULT: S                                                 * 00058800
*                                                                     * 00058900
*                                                                     * 00059000
*          ÝMF=S¨                                                     * 00059100
*              specifies the standard form of the macro.  The "S"     * 00059200
*              form generates code to put the parameters into an      * 00059300
*              in-line parameter list and invoke the desired service. * 00059400
*              Full checking for required macro keys is done along    * 00059500
*              with supplying defaults for omitted optional           * 00059600
*              parameters.                                            * 00059700
*                                                                     * 00059800
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00059900
*              specifies the list form of the macro.  The "L" form    * 00060000
*              defines an area to be used for the parameter list.     * 00060100
*              Only the PLISTVER key may be specified on the          * 00060200
*              invocation.  All other macro parameters are flagged as * 00060300
*              errors.  If PLISTVER is not specified, the original    * 00060400
*              parameter list definition is used.                     * 00060500
*                                                                     * 00060600
*            ,xmfctrl                                                 * 00060700
*              is a required input.  It is the name of a storage area * 00060800
*              for the parameter list.                                * 00060900
*                                                                     * 00061000
*            »,xmfattr!0Dº                                            * 00061100
*              is an optional 60 character input string that varies   * 00061200
*              from 1 to 60 characters. Use it to force boundary      * 00061300
*              alignment of the parameter list. Use only 0F or 0D.    * 00061400
*              DEFAULT: 0D which forces the parameter list to a       * 00061500
*              doubleword boundary.                                   * 00061600
*                                                                     * 00061700
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00061800
*              specifies the modify form of the macro.  The "M" form  * 00061900
*              generates code to put the parameters into the          * 00062000
*              parameter list specified by xmfctrl.                   * 00062100
*                                                                     * 00062200
*            ,xmfctrl                                                 * 00062300
*              is a required input.  It is the name (RS-type), or     * 00062400
*              address in register (1)-(12), of a storage area for    * 00062500
*              the parameter list.                                    * 00062600
*                                                                     * 00062700
*            »,COMPLETE!NOCHECKº¨                                     * 00062800
*              is an optional keyword input which specifies the       * 00062900
*              degree of macro parameter syntax checking.             * 00063000
*              DEFAULT: COMPLETE                                      * 00063100
*                                                                     * 00063200
*                                                                     * 00063300
*              COMPLETE                                               * 00063400
*                  Checking for required macro keys is done and       * 00063500
*                  defaults are supplied for omitted optional         * 00063600
*                  parameters.  (See Macro Usage Note 2).             * 00063700
*                                                                     * 00063800
*              NOCHECK                                                * 00063900
*                  Checking for required macro keys is not done nor   * 00064000
*                  are defaults supplied for omitted optional         * 00064100
*                  parameters.                                        * 00064200
*                                                                     * 00064300
*                                                                     * 00064400
*                                                                     * 00064500
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00064600
*              specifies the execute form of the macro.  The "E" form * 00064700
*              generates code to put the parameters into the          * 00064800
*              parameter list specified by xmfctrl and invoke the     * 00064900
*              desired service.                                       * 00065000
*                                                                     * 00065100
*            ,xmfctrl                                                 * 00065200
*              is a required input.  It is the name (RS-type), or     * 00065300
*              address in register (1)-(12), of a storage area for    * 00065400
*              the parameter list.                                    * 00065500
*                                                                     * 00065600
*            »,COMPLETE!NOCHECKº                                      * 00065700
*              is an optional keyword input which specifies the       * 00065800
*              degree of macro parameter syntax checking.             * 00065900
*              DEFAULT: COMPLETE                                      * 00066000
*                                                                     * 00066100
*                                                                     * 00066200
*              COMPLETE                                               * 00066300
*                  Checking for required macro keys is done and       * 00066400
*                  defaults are supplied for omitted optional         * 00066500
*                  parameters.  (See Macro Usage Note 2).             * 00066600
*                                                                     * 00066700
*              NOCHECK                                                * 00066800
*                  Checking for required macro keys is not done nor   * 00066900
*                  are defaults supplied for omitted optional         * 00067000
*                  parameters.                                        * 00067100
*                                                                     * 00067200
*                                                                     * 00067300
*                                                                     * 00067400
*                                                                     * 00067500
*                                                                     * 00067600
*                                                                     * 00067700
*                                                                     * 00067800
*01* ABEND CODES:  None.                                              * 00067900
*                                                                     * 00068000
*01* RETURN CODES:                                                    * 00068100
*                                                                     * 00068200
*                                                                     * 00068300
*                 Macro HISYSERV provides equate symbols for the      * 00068400
*                 return and reason codes. Note carefully that bits   * 00068500
*                 0-15 of the reason code may contain                 * 00068600
*                 component-diagnostic data and must not be assumed   * 00068700
*                 to be 0.                                            * 00068800
*                                                                     * 00068900
*       0         Name: Hisserv_kRetOk                                * 00069000
*                                                                     * 00069100
*                 Meaning: HISSERV request successful.                * 00069200
*                                                                     * 00069300
*                 Action: Processing continues.                       * 00069400
*                                                                     * 00069500
*                                                                     * 00069600
*       4         Name: Hisserv_kRetWarn                              * 00069700
*                                                                     * 00069800
*                 Meaning: Warning                                    * 00069900
*                                                                     * 00070000
*                 Action:  Refer to the action provided with the      * 00070100
*                 specific reason code.                               * 00070200
*                                                                     * 00070300
*                                                                     * 00070400
*                 HEX REASON  MEANING/ACTION                          * 00070500
*                 CODE                                                * 00070600
*                                                                     * 00070700
*                 xxxx0401    Name: Hisserv_kRsnWarn_AnsAreaSmall     * 00070800
*                                                                     * 00070900
*                             Meaning: For REQUEST=QUERY, the answer  * 00071000
*                             area provided was large enough to hold  * 00071100
*                             the minimum amount of data required for * 00071200
*                             the request, but not large enough to    * 00071300
*                             hold all of the data requested.         * 00071400
*                                                                     * 00071500
*                             Action: Obtain a larger answer area     * 00071600
*                             using the HisAns_LengthRequired field   * 00071700
*                             returned in the request's ANSAREA.      * 00071800
*                                                                     * 00071900
*                                                                     * 00072000
*                                                                     * 00072100
*                                                                     * 00072200
*       8         Name: Hisserv_kRetUser                              * 00072300
*                                                                     * 00072400
*                 Meaning: HISSERV request failed due to a user       * 00072500
*                 error.                                              * 00072600
*                                                                     * 00072700
*                 Action: Refer to the action provided with the       * 00072800
*                 specific reason code.                               * 00072900
*                                                                     * 00073000
*                                                                     * 00073100
*                 HEX REASON  MEANING/ACTION                          * 00073200
*                 CODE                                                * 00073300
*                                                                     * 00073400
*                 xxxx0801    Name: Hisserv_kRsnUser_BadParmArea      * 00073500
*                                                                     * 00073600
*                             Meaning: Unable to access parameter     * 00073700
*                             area.                                   * 00073800
*                                                                     * 00073900
*                             Action: Check for possible storage      * 00074000
*                             overlay.                                * 00074100
*                                                                     * 00074200
*                 xxxx0802    Name: Hisserv_kRsnUser_BadParmAreaALET  * 00074300
*                                                                     * 00074400
*                             Meaning: Bad parameter area ALET.       * 00074500
*                                                                     * 00074600
*                             Action: Make sure that the ALET         * 00074700
*                             associated with the parameter area is   * 00074800
*                             valid. The access register might not    * 00074900
*                             have been set up correctly.             * 00075000
*                                                                     * 00075100
*                 xxxx0803    Name: Hisserv_kRsnUser_BadVersion       * 00075200
*                                                                     * 00075300
*                             Meaning: Bad version for the parameter  * 00075400
*                             list was specified.                     * 00075500
*                                                                     * 00075600
*                             Action: Check for possible storage      * 00075700
*                             overlay.                                * 00075800
*                                                                     * 00075900
*                 xxxx0804    Name: Hisserv_kRsnUser_SrbMode          * 00076000
*                                                                     * 00076100
*                             Meaning: This function is only          * 00076200
*                             available in task mode.                 * 00076300
*                                                                     * 00076400
*                             Action: Use function in task mode.      * 00076500
*                                                                     * 00076600
*                 xxxx0805    Name: Hisserv_kRsnUser_NotEnabled       * 00076700
*                                                                     * 00076800
*                             Meaning: This function is only          * 00076900
*                             available to enabled programs.          * 00077000
*                                                                     * 00077100
*                             Action: Use function while enabled.     * 00077200
*                                                                     * 00077300
*                 xxxx0806    Name: Hisserv_kRsnUser_LocksHeld        * 00077400
*                                                                     * 00077500
*                             Meaning: This function is only          * 00077600
*                             available to unlocked programs.         * 00077700
*                                                                     * 00077800
*                             Action: Use function while unlocked.    * 00077900
*                                                                     * 00078000
*                 xxxx0807    Name: Hisserv_kRsnUser_CallerFRR        * 00078100
*                                                                     * 00078200
*                             Meaning: This function is only          * 00078300
*                             available to programs that have not     * 00078400
*                             established an FRR.                     * 00078500
*                                                                     * 00078600
*                             Action: Retry the request without an    * 00078700
*                             FRR established.                        * 00078800
*                                                                     * 00078900
*                 xxxx0808    Name: Hisserv_kRsnUser_BadRequest       * 00079000
*                                                                     * 00079100
*                             Meaning: A Bad request was made to the  * 00079200
*                             service.                                * 00079300
*                                                                     * 00079400
*                             Action: Check for possible storage      * 00079500
*                             overlay.                                * 00079600
*                                                                     * 00079700
*                 xxxx0809    Name: Hisserv_kRsnUser_BadProfTkn       * 00079800
*                                                                     * 00079900
*                             Meaning: Token specified was not a      * 00080000
*                             valid token.                            * 00080100
*                                                                     * 00080200
*                             Action: Use a valid token provided by   * 00080300
*                             the REQUEST=PROFILE,ACTION=START        * 00080400
*                             request.                                * 00080500
*                                                                     * 00080600
*                 xxxx080A    Name: Hisserv_kRsnUser_NameInUse        * 00080700
*                                                                     * 00080800
*                             Meaning: The name requested is already  * 00080900
*                             in use.                                 * 00081000
*                                                                     * 00081100
*                             Action: Provide a NAME that is unique   * 00081200
*                             to the service.                         * 00081300
*                                                                     * 00081400
*                 xxxx080B    Name: Hisserv_kRsnUser_InvName          * 00081500
*                                                                     * 00081600
*                             Meaning: The name requested is invalid. * 00081700
*                                                                     * 00081800
*                             Action: Provide a valid NAME, it cannot * 00081900
*                             begin with HIS.                         * 00082000
*                                                                     * 00082100
*                 xxxx080C    Name: Hisserv_kRsnUser_ExitRtnNotFound  * 00082200
*                                                                     * 00082300
*                             Meaning: The exit routine specified     * 00082400
*                             wasn't found.                           * 00082500
*                                                                     * 00082600
*                             Action: Ensure the exit routine         * 00082700
*                             specified exists in LPA, the LNKLST     * 00082800
*                             concatenation, or the nucleus.          * 00082900
*                                                                     * 00083000
*                 xxxx080D    Name: Hisserv_kRsnUser_ExitRtnInUse     * 00083100
*                                                                     * 00083200
*                             Meaning: The exit routine specified is  * 00083300
*                             already in use.                         * 00083400
*                                                                     * 00083500
*                             Action: A different exit routine must   * 00083600
*                             be provided.                            * 00083700
*                                                                     * 00083800
*                 xxxx080E    Name: Hisserv_kRsnUser_BadEvnTyp        * 00083900
*                                                                     * 00084000
*                             Meaning: For                            * 00084100
*                             REQUEST=PROFILE,ACTION=START requests,  * 00084200
*                             one or more event types specified could * 00084300
*                             not be properly configured for because  * 00084400
*                             it is not allowed. Only event types     * 00084500
*                             returned in the HisEvn_ValidEvnTyp      * 00084600
*                             field of a REQUEST=QUERY,TYPE=EVENT     * 00084700
*                             request can be requested.               * 00084800
*                                                                     * 00084900
*                             Action: Ensure the event types being    * 00085000
*                             requested are a subset of the event     * 00085100
*                             types returned in the                   * 00085200
*                             HisEvn_ValidEvnTyp field of a           * 00085300
*                             REQUEST=QUERY,TYPE=EVENT request.       * 00085400
*                                                                     * 00085500
*                 xxxx080F    Name: Hisserv_kRsnUser_BadProfReq       * 00085600
*                                                                     * 00085700
*                             Meaning: A bad PROFILE request was made * 00085800
*                             to the service.                         * 00085900
*                                                                     * 00086000
*                             Action: Check for possible storage      * 00086100
*                             overlay.                                * 00086200
*                                                                     * 00086300
*                 xxxx0810    Name: Hisserv_kRsnUser_BadProfStart     * 00086400
*                                                                     * 00086500
*                             Meaning: For                            * 00086600
*                             REQUEST=PROFILE,ACTION=START, a bad     * 00086700
*                             request was made.  At least one event   * 00086800
*                             type or sampling should be requested    * 00086900
*                             when starting to profile the system.    * 00087000
*                                                                     * 00087100
*                             Action: Request at least one event type * 00087200
*                             or sampling.                            * 00087300
*                                                                     * 00087400
*                 xxxx0811    Name: Hisserv_kRsnUser_BadQuery         * 00087500
*                                                                     * 00087600
*                             Meaning: For REQUEST=QUERY, a bad query * 00087700
*                             was requested.                          * 00087800
*                                                                     * 00087900
*                             Action: Check for possible storage      * 00088000
*                             overlay.                                * 00088100
*                                                                     * 00088200
*                 xxxx0812    Name: Hisserv_kRsnUser_BadAnsArea       * 00088300
*                                                                     * 00088400
*                             Meaning: For REQUEST=QUERY, unable to   * 00088500
*                             access answer area.                     * 00088600
*                                                                     * 00088700
*                             Action: Provide a valid answer area.    * 00088800
*                                                                     * 00088900
*                 xxxx0813    Name: Hisserv_kRsnUser_BadAnsAreaALET   * 00089000
*                                                                     * 00089100
*                             Meaning: Bad answer area ALET.          * 00089200
*                                                                     * 00089300
*                             Action: Make sure that the ALET         * 00089400
*                             associated with the answer area is      * 00089500
*                             valid. The access register might not    * 00089600
*                             have been set up correctly.             * 00089700
*                                                                     * 00089800
*                 xxxx0814    Name: Hisserv_kRsnUser_AnsLenTooSmall   * 00089900
*                                                                     * 00090000
*                             Meaning: For REQUEST=QUERY, the answer  * 00090100
*                             area length is incorrect.               * 00090200
*                                                                     * 00090300
*                             Action: Ensure the answer area length   * 00090400
*                             and the storage provided as the answer  * 00090500
*                             area is at least HisAns_kLength bytes   * 00090600
*                             long.                                   * 00090700
*                                                                     * 00090800
*                 xxxx0815    Name: Hisserv_kRsnUser_BadCpuMask       * 00090900
*                                                                     * 00091000
*                             Meaning: For                            * 00091100
*                             REQUEST=QUERY,TYPE=EVENTDATA requests,  * 00091200
*                             unable to access the CPU mask.          * 00091300
*                                                                     * 00091400
*                             Action: Provide a valid CPU mask.       * 00091500
*                                                                     * 00091600
*                 xxxx0816    Name: Hisserv_kRsnUser_BadCpuMaskALET   * 00091700
*                                                                     * 00091800
*                             Meaning: Bad CPU mask ALET.             * 00091900
*                                                                     * 00092000
*                             Action: Make sure that the ALET         * 00092100
*                             associated with the CPU mask is valid.  * 00092200
*                             The access register might not have been * 00092300
*                             set up correctly.                       * 00092400
*                                                                     * 00092500
*                 xxxx0817    Name: Hisserv_kRsnUser_NoEvnTyp         * 00092600
*                                                                     * 00092700
*                             Meaning: For                            * 00092800
*                             REQUEST=QUERY,TYPE=EVENTDATA requests,  * 00092900
*                             the profiler making the request is not  * 00093000
*                             profiling events.                       * 00093100
*                                                                     * 00093200
*                             Action: When registering with the       * 00093300
*                             system to profile, indicate the         * 00093400
*                             intention to profile events using the   * 00093500
*                             EVENT= parameter.                       * 00093600
*                                                                     * 00093700
*                 xxxx0818    Name: Hisserv_kRsnUser_InvProfChange    * 00093800
*                                                                     * 00093900
*                             Meaning: A REQUEST=PROFILE request was  * 00094000
*                             made from a profiler's exit routine.    * 00094100
*                                                                     * 00094200
*                             Action: A REQUEST=PROFILE request       * 00094300
*                             cannot be made from a profiler's exit   * 00094400
*                             routine.                                * 00094500
*                                                                     * 00094600
*                                                                     * 00094700
*                                                                     * 00094800
*                                                                     * 00094900
*       C         Name: Hisserv_kRetEnv                               * 00095000
*                                                                     * 00095100
*                 Meaning: Environmental error                        * 00095200
*                                                                     * 00095300
*                 Action:  Refer to the action provided with the      * 00095400
*                 specific reason code.                               * 00095500
*                                                                     * 00095600
*                                                                     * 00095700
*                 HEX REASON  MEANING/ACTION                          * 00095800
*                 CODE                                                * 00095900
*                                                                     * 00096000
*                 xxxx0C01    Name: Hisserv_kRsnEnv_NotAvailable      * 00096100
*                                                                     * 00096200
*                             Meaning: Function is not available.     * 00096300
*                                                                     * 00096400
*                             Action: This function is only available * 00096500
*                             when the HIS address space is running.  * 00096600
*                                                                     * 00096700
*                 xxxx0C02    Name: Hisserv_kRsnEnv_NotReady          * 00096800
*                                                                     * 00096900
*                             Meaning: Function is available but is   * 00097000
*                             not currently ready to accept requests. * 00097100
*                                                                     * 00097200
*                             Action: Retry the request.              * 00097300
*                                                                     * 00097400
*                 xxxx0C03    Name: Hisserv_kRsnEnv_NoStorage         * 00097500
*                                                                     * 00097600
*                             Meaning: There was not enough storage   * 00097700
*                             in HIS private storage to complete the  * 00097800
*                             request.                                * 00097900
*                                                                     * 00098000
*                             Action: Contact your system programmer. * 00098100
*                                                                     * 00098200
*                                                                     * 00098300
*                                                                     * 00098400
*                                                                     * 00098500
*       10        Name: Hisserv_kRetUnk                               * 00098600
*                                                                     * 00098700
*                 Meaning: Unexpected failure.                        * 00098800
*                                                                     * 00098900
*                 Action: Refer to the action provided with the       * 00099000
*                 specific reason code.                               * 00099100
*                                                                     * 00099200
*                                                                     * 00099300
*                 HEX REASON  MEANING/ACTION                          * 00099400
*                 CODE                                                * 00099500
*                                                                     * 00099600
*                 xxxx1001    Name: Hisserv_kRsnUnk_Unk               * 00099700
*                                                                     * 00099800
*                             Meaning: Unexpected failure. The state  * 00099900
*                             of the request is unpredictable.        * 00100000
*                                                                     * 00100100
*                             Action: Contact your system programmer. * 00100200
*                                                                     * 00100300
*                 xxxx1002    Name: Hisserv_kRsnUnk_QueryCpu          * 00100400
*                                                                     * 00100500
*                             Meaning: For                            * 00100600
*                             REQUEST=QUERY,TYPE=EVENTDATA, while     * 00100700
*                             attempting to query a CPU's event data  * 00100800
*                             an unknown error occurred.              * 00100900
*                                                                     * 00101000
*                             Action: Contact your system programmer. * 00101100
*                                                                     * 00101200
*                                                                     * 00101300
*                                                                     * 00101400
*                                                                     * 00101500
*                                                                     * 00101600
*01* REASON CODES:                                                    * 00101700
*                                                                     * 00101800
*       Reason codes, as appropriate, are defined under their         * 00101900
*       corresponding return code.                                    * 00102000
*                                                                     * 00102100
*01* MODULE TYPE:  ASSEM MACRO                                        * 00102200
*                                                                     * 00102300
*02*   PROCESSOR:  ASSEM                                              * 00102400
*                                                                     * 00102500
*01* COMPONENT:  SCHIS                                                * 00102600
*                                                                     * 00102700
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00102800
*                                                                     * 00102900
*01* EXAMPLES:                                                        * 00103000
*                                                                     * 00103100
*    Operation                                                        * 00103200
*                                                                     * 00103300
*                                                                     * 00103400
*    1.  Profile for all available event types, and sampling.         * 00103500
*                                                                     * 00103600
*    2.  Query the event types on 1 minute intervals for an hour,     * 00103700
*        ensuring all event data is returned each query.              * 00103800
*                                                                     * 00103900
*    3.  Process Sampling Data Blocks (SDBs) as they become           * 00104000
*        available.                                                   * 00104100
*                                                                     * 00104200
*    4.  Stop profiling the system.                                   * 00104300
*                                                                     * 00104400
*                                                                     * 00104500
*                                                                     * 00104600
*    The code is as follows.                                          * 00104700
*                                                                     * 00104800
*    *************************************************************    * 00104900
*    * Query Events to determine what can be enabled.            *    * 00105000
*    *************************************************************    * 00105100
*             HISSERV MF=(E,serviceList),REQUEST=QUERY,           *   * 00105200
*                   ANSAREA=EvnAnsArea,ANSLEN=EvnAnsLen,          *   * 00105300
*                   TYPE=EVENT,RETCODE=LRetCode,                  *   * 00105400
*                   RSNCODE=LRsnCode                                  * 00105500
*             ICM  R5,B'1111',LRetCode                                * 00105600
*             JZ   EVNAREA_GOOD                                       * 00105700
*             LA   R4,Hisserv_kRetWarn                                * 00105800
*             CLR  R5,R4                                              * 00105900
*             JE   EVNAREA_WARN                                       * 00106000
*    EVNAREA_BAD   DS 0H                                              * 00106100
*    *                                                                * 00106200
*    * Place code to check bad return/reason codes here               * 00106300
*    *                                                                * 00106400
*    EVNAREA_WARN  DS 0H                                              * 00106500
*             L    R5,LRsnCode                                        * 00106600
*             NILH R5,0                                               * 00106700
*             CHI  R5,Hisserv_kRsnWarn_AnsAreaSmall                   * 00106800
*             JNE  EVNAREA_BAD                                        * 00106900
*    *                                                                * 00107000
*    * Place code to handle obtaining more storage for the            * 00107100
*    * ANSAREA, and repeat the request if necessary.                  * 00107200
*    *                                                                * 00107300
*    EVNAREA_GOOD   DS 0H                                             * 00107400
*             LA    R8,EvnAnsArea                                     * 00107500
*             Using HisEvn,R8                                         * 00107600
*    *************************************************************    * 00107700
*    * Start profiling the system. Output from the previous      *    * 00107800
*    * query is used as input to this query, specifically we     *    * 00107900
*    * want to profile all valid event types.                    *    * 00108000
*    *************************************************************    * 00108100
*             HISSERV MF=(E,serviceList),REQUEST=PROFILE,         *   * 00108200
*                   ACTION=START,OUTPROFILETKN=ProfToken,         *   * 00108300
*                   NAME=ProfName,EXITRTN=ExitMod,SAMPLE=YES,     *   * 00108400
*                   EVENT=HisEvn_ValidEvnTyp,RETCODE=LRetCode,    *   * 00108500
*                   RSNCODE=LRsnCode                                  * 00108600
*    *                                                                * 00108700
*    * Place code to check return/reason codes here                   * 00108800
*    *                                                                * 00108900
*    * Place code to obtain storage of length HisEvnData_kLength,     * 00109000
*    * save address in R8, length in EvnDataAnsLen                    * 00109100
*    *                                                                * 00109200
*    EVN_LOOP      DS 0H                                              * 00109300
*    *************************************************************    * 00109400
*    * Query the current state of the events                     *    * 00109500
*    *************************************************************    * 00109600
*             Using HisEvnData,R8                                     * 00109700
*             HISSERV MF=(E,serviceList),REQUEST=QUERY,           *   * 00109800
*                   TYPE=EVENTDATA,PROFILETKN=ProfToken,          *   * 00109900
*                   CPUMASK=ALL,ANSAREA=HisEvnData,               *   * 00110000
*                   ANSLEN=EvnDataAnsLen,RETCODE=LRetCode,        *   * 00110100
*                   RSNCODE=LRsnCode                                  * 00110200
*             ICM  R5,B'1111',LRetCode                                * 00110300
*             JZ   EVNDATAAREA_GOOD                                   * 00110400
*             LA   R4,Hisserv_kRetWarn                                * 00110500
*             CLR  R5,R4                                              * 00110600
*             JE   EVNDATAAREA_WARN                                   * 00110700
*    EVNDATAAREA_BAD   DS 0H                                          * 00110800
*    *                                                                * 00110900
*    * Place code to check bad return/reason codes here               * 00111000
*    *                                                                * 00111100
*    EVNDATAAREA_WARN  DS 0H                                          * 00111200
*             L    R5,LRsnCode                                        * 00111300
*             NILH R5,0                                               * 00111400
*             CHI  R5,Hisserv_kRsnWarn_AnsAreaSmall                   * 00111500
*             JNE  EVNAREA_BAD                                        * 00111600
*    *                                                                * 00111700
*    * Place code to free storage of length EvnDataAnsLen, then       * 00111800
*    * obtain new storage of length HisEvnData_Length, save address   * 00111900
*    * in R8, length in EvnDataAnsLen                                 * 00112000
*    *                                                                * 00112100
*             J    EVN_LOOP                                           * 00112200
*    EVNDATAAREA_GOOD DS 0H                                           * 00112300
*    *                                                                * 00112400
*    * Place code to process the returned events here.                * 00112500
*    *                                                                * 00112600
*             L    R5,EvnQueryVal                                     * 00112700
*             BCT  R5,EVNDONE                                         * 00112800
*             ST   R5,EvnQueryVal                                     * 00112900
*             STIMER WAIT,BINTVL=EvnIntv                              * 00113000
*             J    EVN_LOOP                                           * 00113100
*    EVNDONE       DS 0H                                              * 00113200
*    *************************************************************    * 00113300
*    * Stop profiling the system                                 *    * 00113400
*    *************************************************************    * 00113500
*             HISSERV MF=(E,serviceList),REQUEST=PROFILE,         *   * 00113600
*                   ACTION=STOP,PROFILETKN=ProfToken,             *   * 00113700
*                   RETCODE=LRetCode,RSNCODE=LRsnCode                 * 00113800
*    *                                                                * 00113900
*    * Place code to check return/reason codes here                   * 00114000
*    *                                                                * 00114100
*    EvnIntv     DC    F'6000'       One minute interval between  *   * 00114200
*                                    event queries                    * 00114300
*    ProfName    DC    CL8'SAMPLE01' External name for profiler       * 00114400
*    ExitMod     DC    CL8'SAMPEXRT' EXITRTN Name                     * 00114500
*                HISYSERV            Return code information and  *   * 00114600
*                                    ANSAREA mappings.                * 00114700
*    DynArea     DSECT                                                * 00114800
*    LRetCode    DS    F                                              * 00114900
*    LRsnCode    DS    F                                              * 00115000
*    ProfToken   DC    CL16'0'                                        * 00115100
*    EvnQueryVal DC    F'60'         Query events 60 times            * 00115200
*    EvnAnsArea  DS    XL(HisEvn_Len+HisEvnCtr_Len)                   * 00115300
*    EvnAnsLen   DS    AD(HisEvn_Len+HisEvnCtr_Len)                   * 00115400
*    EvnDataAnsLen DS  D                                              * 00115500
*             HISSERV MF=(L,serviceList)                              * 00115600
*    *                                                                * 00115700
*    *                                                                * 00115800
*    * HISEXRTN CSECT, the EXITRTN located in LPA,LNKLIST or the      * 00115900
*    * nucleus.                                                       * 00116000
*    *                                                                * 00116100
*    HISEXRTN    CSECT                                                * 00116200
*                Using HisExitParm,R1                                 * 00116300
*                CLI   HisExitParm_Func,HisExitParmFunc_kStat         * 00116400
*                JNE   CHECK_SMP                                      * 00116500
*                PUSH  USING                                          * 00116600
*                USING HisStatParm,R1                                 * 00116700
*    *                                                                * 00116800
*    * Place code to process any service actions                      * 00116900
*    *                                                                * 00117000
*                J     DONE                                           * 00117100
*                POP   USING                                          * 00117200
*    CHECK_SMP   DS    0H                                             * 00117300
*                CLI   HisExitParm_Func,HisExitParmFunc_kSmp          * 00117400
*                JNE   DONE                                           * 00117500
*                PUSH  USING                                          * 00117600
*                USING HisSmpParm,R1                                  * 00117700
*    *                                                                * 00117800
*    * Place code to process the full SDBs                            * 00117900
*    *                                                                * 00118000
*                POP   USING                                          * 00118100
*    DONE        DS    0H                                             * 00118200
*                HISYEXIT                                             * 00118300
*                HISYSMPX                                             * 00118400
*                                                                     * 00118500
*                                                                     * 00118600
*01* MACRO USAGE NOTES:                                               * 00118700
*                                                                     * 00118800
*                                                                     * 00118900
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00119000
*        global macro variable.  Any value other than 'NO' will       * 00119100
*        result in the macro expansion being printed.  The default is * 00119200
*        'YES'.  The following examples illustrate how the ZPRINT     * 00119300
*        variable should be set.                                      * 00119400
*                                                                     * 00119500
*                    GBLC &ZPRINT                                     * 00119600
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00119700
*                                                                     * 00119800
*                                                                     * 00119900
*    2.  When using the NOCHECK option in conjunction with the Modify * 00120000
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00120100
*        Modify   or  Execute  form  invocation  which  specifies  or * 00120200
*        defaults  to  the  COMPLETE  option.   This insures that the * 00120300
*        parameter  list  is  initialized completely.   The parameter * 00120400
*        list  field which identifies the version number of the macro * 00120500
*        is only set when the Standard form or the Complete option of * 00120600
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00120700
*        explicitly  specified.  Be sure that the resulting parameter * 00120800
*        list version number covers all the keys that you use.        * 00120900
*                                                                     * 00121000
*                                                                     * 00121100
*    3.  All keys currently contained in the HISSERV macro correspond * 00121200
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 00121300
*        MAX.                                                         * 00121400
*                                                                     * 00121500
*                                                                     * 00121600
*                                                                     * 00121700
*                                                                     * 00121800
*01* CHANGE ACTIVITY:                                                 * 00121900
*                                                                     * 00122000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00122100
*                                                                     * 00122200
*    $L0=HISSERV  HBB7790 100728 PD00BS:  HIS Extendability           * 00122300
*    $L1=HISTRC   HBB77A0 120101 PD00BS:  HIS System Trace Capture    * 00122400
****** END OF SPECIFICATIONS *****************************************/ 00122500
*/********************************************************************* 00122600
         MACRO                                                          00122700
&XLABEL  HISSERV &REQUEST=,&ACTION=,&OUTPROFILETKN=,&EVENT=,&TRCTIME=, *00122800
               &SAMPLE=,&NAME=,&EXITRTN=,&PROFILETKN=,&ANSAREA=,       *00122900
               &ANSLEN=,&TYPE=,&CPUMASK=,&RETCODE=,&RSNCODE=,          *00123000
               &PLISTVER=,&MF=                                          00123100
.*                                                                      00123200
*                   MACDATE -11/04/14-<0>                               00123300
.*                                                                      00123400
.*******************************************************************    00123500
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00123600
.*******************************************************************    00123700
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00123800
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00123900
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00124000
.*                                                                      00124100
                   GBLC  &ZHISSERV   YES=MACRO USED AT LEAST ONCE       00124200
.*******************************************************************    00124300
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00124400
.*******************************************************************    00124500
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00124600
                   LCLC  &ZCNDX      SYSNDX CHARACTERS                  00124700
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00124800
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00124900
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00125000
                   LCLA  &ZAWRK      USED AS A WORK AREA                00125100
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00125200
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00125300
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00125400
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00125500
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00125600
                   LCLC  &ZMAC_G     "G" or null                        00125700
&ZMAC_G            SETC  ''                                             00125800
                   LCLC  &ZMAC_LR                                       00125900
&ZMAC_LR           SETC  'LR'                                           00126000
                   LCLC  &ZMAC_L                                        00126100
&ZMAC_L            SETC  'L'                                            00126200
                   LCLC  &ZMAC_ST                                       00126300
&ZMAC_ST           SETC  'ST'                                           00126400
                   LCLC  &ZMAC_LLGT                                     00126500
&ZMAC_LLGT         SETC  'L'                                            00126600
                   LCLC  &ZMAC_LGR                                      00126700
&ZMAC_LGR          SETC  'LR'                                           00126800
                   LCLC  &ZMAC_LG                                       00126900
&ZMAC_LG           SETC  'L'                                            00127000
                   LCLC  &ZMAC_STG                                      00127100
&ZMAC_STG          SETC  'ST'                                           00127200
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00127300
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00127400
.*                                                                      00127500
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00127600
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00127700
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00127800
                   LCLC  &ZENDBASEPL            End of base PL          00127900
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00128000
.*******************************************************************    00128100
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00128200
.*******************************************************************    00128300
                   LCLA  &ZI         INDEX FOR ARRAY                    00128400
                   LCLA  &ZJ         INDEX FOR PARMS                    00128500
                   LCLA  &ZK         INDEX FOR PARSE                    00128600
                   LCLA  &ZLO        LOW RANGE VALUE                    00128700
                   LCLA  &ZHI        HIGH RANGE VALUE                   00128800
                   LCLC  &ZW         WORK AREA FOR PARM                 00128900
.********************************************************************   00129000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00129100
.********************************************************************   00129200
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00129300
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00129400
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00129500
                   GBLC  &SYSAM64    SYSSTATE AMODE64                   00129600
.*                                                                      00129700
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00129800
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00129900
                   SPLEVEL  TEST                                        00130000
.ZSYS2             ANOP  ,                                              00130100
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00130200
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00130300
                   SYSSTATE TEST                                        00130400
                   AGO   .ZSYS4                                         00130500
.ZSYS3             ANOP  ,                                              00130600
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00130700
.ZSYS4             ANOP  ,                                              00130800
                   AIF   ('&SYSAM64' NE 'YES').ZSYSN64                  00130900
&ZMAC_LLGT         SETC 'LLGT'                                          00131000
&ZMAC_LGR          SETC 'LGR'                                           00131100
&ZMAC_LG           SETC 'LG'                                            00131200
&ZMAC_STG          SETC 'STG'                                           00131300
.ZSYSN64           ANOP  ,                                              00131400
&ZMAC_G            SETC 'G'                                             00131500
&ZMAC_LR           SETC 'LGR'                                           00131600
&ZMAC_L            SETC 'LG'                                            00131700
&ZMAC_ST           SETC 'STG'                                           00131800
.*******************************************************************    00131900
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00132000
.*******************************************************************    00132100
                   LCLC  &XREQUEST   ++ VALUE                           00132200
                   LCLC  &XACTION    ++ VALUE                           00132300
                   LCLC  &XOUTPROFILETKN        ++ NAME                 00132400
                   LCLC  &XEVENT     ++ NAME                            00132500
                   LCLC  &XTRCTIME   ++ NAME                            00132600
                   LCLC  &XSAMPLE    ++ VALUE                           00132700
                   LCLC  &XNAME      ++ NAME                            00132800
                   LCLC  &XEXITRTN   ++ NAME                            00132900
                   LCLC  &XPROFILETKN           ++ NAME                 00133000
                   LCLC  &XANSAREA   ++ NAME                            00133100
                   LCLC  &XANSLEN    ++ NAME                            00133200
                   LCLC  &XTYPE      ++ VALUE                           00133300
                   LCLC  &XCPUMASK   ++ NAME                            00133400
                   LCLC  &XRETCODE   ++ NAME                            00133500
                   LCLC  &XRSNCODE   ++ NAME                            00133600
                   LCLA  &XPLISTVER  ++ VALUE                           00133700
                   LCLC  &XMF        ++ VALUE                           00133800
                   LCLC  &XMFCTRL    ++ NAME                            00133900
                   LCLC  &XMFATTR    ++ VALUE                           00134000
                   LCLC  &XMFSCK     ++ VALUE                           00134100
.*******************************************************************    00134200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00134300
.*******************************************************************    00134400
                   LCLC  &ZXREQUEST  ++ INPUT VALUE                     00134500
                   LCLC  &ZXACTION   ++ INPUT VALUE                     00134600
                   LCLC  &ZXOUTPROFILETKN       ++ OUTPUT NAME          00134700
                   LCLC  &ZXEVENT    ++ INPUT NAME                      00134800
                   LCLC  &ZXTRCTIME  ++ INPUT NAME                      00134900
                   LCLC  &ZXSAMPLE   ++ INPUT VALUE                     00135000
                   LCLC  &ZXNAME     ++ INPUT NAME                      00135100
                   LCLC  &ZXEXITRTN  ++ INPUT NAME                      00135200
                   LCLC  &ZXPROFILETKN          ++ INPUT NAME           00135300
                   LCLC  &ZXANSAREA  ++ INPUT NAME                      00135400
                   LCLC  &ZXANSLEN   ++ INPUT NAME                      00135500
                   LCLC  &ZXTYPE     ++ INPUT VALUE                     00135600
                   LCLC  &ZXCPUMASK  ++ INPUT NAME                      00135700
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00135800
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00135900
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00136000
                   LCLC  &ZXMF       ++ INPUT VALUE                     00136100
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00136200
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00136300
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00136400
.********************************************************************   00136500
.***AC.PLV01  PROCESS PLISTVER                                      *   00136600
.********************************************************************   00136700
&XPLISTVER      SETA  0                                                 00136800
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00136900
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00137000
&XPLISTVER      SETA  0                                                 00137100
.ZPLV0          ANOP  ,                                                 00137200
.*                                                                      00137300
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00137400
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00137500
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00137600
.*-------------------------------------------------------------------   00137700
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00137800
&ZMS            SETC  '"PLISTVER='                                      00137900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00138000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00138100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00138200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00138300
                AGO   .ZPVCK2                                           00138400
.ZPVCK3         ANOP  ,                                                 00138500
.*-------------------------------------------------------------------   00138600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00138700
&ZMS            SETC  '"PLISTVER='                                      00138800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00138900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00139000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00139100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00139200
                AGO   .ZPVCKE                                           00139300
.ZPVCK2         ANOP  ,                                                 00139400
.*-------------------------------------------------------------------   00139500
&ZCVAL          SETC  '&PLISTVER(1)'                                    00139600
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00139700
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00139800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00139900
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00140000
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00140100
.ZPVCK6         ANOP  ,                                                 00140200
&ZMS            SETC  '"PLISTVER='                                      00140300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00140400
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00140500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00140600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00140700
&XPLISTVER      SETA  0                                                 00140800
                AGO   .ZPVCKE                                           00140900
.*-------------------------------------------------------------------   00141000
.ZPVCK4A        ANOP  ,                                                 00141100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00141200
&ZMS            SETC  'PLISTVER='                                       00141300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00141400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00141500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00141600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00141700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00141800
                AGO   .ZPVCK5                                           00141900
.ZPVCK4         ANOP  ,                                                 00142000
&XPLISTVER      SETA  &PLISTVER(1)                                      00142100
.ZPVCK5         ANOP  ,                                                 00142200
.ZPVCKE         ANOP  ,                                                 00142300
.********************************************************************   00142400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00142500
.********************************************************************   00142600
                   ACTR  10000                                          00142700
.*------------------------------------------------------------------    00142800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142900
&XMF               SETC  ''          INITIALIZE XVARIABLE               00143000
.*-------------------------------------------------------------------   00143100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00143200
.ZG64              ANOP  ,                                              00143300
&ZTLC              SETC 'S'                                             00143400
                   AIF   ('&MF(1)' NE '&ZTLC').ZG65                     00143500
&XMF               SETC  'S'         SET KEYWORD                        00143600
&XMFSCK            SETC  'COMPLETE'  SET XMFSCK                         00143700
                   AIF   (N'&MF LE 1).ZG64A     CK NUM                  00143800
&ZMS               SETC  '"MF='                                         00143900
&ZMS               SETC  '&ZMS.&MF"'                                    00144000
&ZMS               SETC  '&ZMS "MF"'                                    00144100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00144200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00144300
.ZG64A             ANOP  ,                                              00144400
.*-------------------------------------------------------------------   00144500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144600
.ZG65              ANOP  ,                                              00144700
&ZTLC              SETC 'L'                                             00144800
                   AIF   ('&MF(1)' NE '&ZTLC').ZG72                     00144900
&XMF               SETC  'L'         SET KEYWORD                        00145000
                   AIF   (N'&MF LE 3).ZG65A     CK NUM                  00145100
&ZMS               SETC  '"MF='                                         00145200
&ZMS               SETC  '&ZMS.&MF"'                                    00145300
&ZMS               SETC  '&ZMS "MF"'                                    00145400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00145500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00145600
.ZG65A             ANOP  ,                                              00145700
.*-------------------------------------------------------------------   00145800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00145900
                   AIF   (N'&SYSLIST NE 0).ZG65B  POSITIONALS?          00146000
                   AIF   ('&REQUEST' NE '').ZG65B  KEYS?                00146100
                   AIF   ('&ACTION' NE '').ZG65B  KEYS?                 00146200
                   AIF   ('&OUTPROFILETKN' NE '').ZG65B  KEYS?          00146300
                   AIF   ('&EVENT' NE '').ZG65B  KEYS?                  00146400
                   AIF   ('&TRCTIME' NE '').ZG65B  KEYS?                00146500
                   AIF   ('&SAMPLE' NE '').ZG65B  KEYS?                 00146600
                   AIF   ('&NAME' NE '').ZG65B  KEYS?                   00146700
                   AIF   ('&EXITRTN' NE '').ZG65B  KEYS?                00146800
                   AIF   ('&PROFILETKN' NE '').ZG65B  KEYS?             00146900
                   AIF   ('&ANSAREA' NE '').ZG65B  KEYS?                00147000
                   AIF   ('&ANSLEN' NE '').ZG65B  KEYS?                 00147100
                   AIF   ('&TYPE' NE '').ZG65B  KEYS?                   00147200
                   AIF   ('&CPUMASK' NE '').ZG65B  KEYS?                00147300
                   AIF   ('&RETCODE' NE '').ZG65B  KEYS?                00147400
                   AIF   ('&RSNCODE' NE '').ZG65B  KEYS?                00147500
                   AGO    .ZG65C     INVOCATION OKAY                    00147600
.ZG65B             ANOP  ,                                              00147700
&ZMS               SETC  'THE "L" FORM OF "MF"'                         00147800
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00147900
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00148000
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00148100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00148200
.ZG65C             ANOP  ,                                              00148300
.*-------------------------------------------------------------------   00148400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00148500
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00148600
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00148700
                   AIF   (N'&MF(2) GT 1).ZG67B  MULTI                   00148800
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00148900
.ZG67B             AIF   (K'&MF(2) GT 0).ZG67C                          00149000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00149100
&ZMS               SETC  'WHEN "L" IS SPECIFIED'                        00149200
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00149300
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00149400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00149500
.ZG67C             ANOP  ,                                              00149600
.*-------------------------------------------------------------------   00149700
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00149800
                   AIF   (K'&ZXMFCTRL LE 0).ZG67P  NOT I/O              00149900
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG67P                 00150000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00150100
&ZMS               SETC  '"MF='                                         00150200
&ZMS               SETC  '&ZMS.&MF"'                                    00150300
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00150400
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00150500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00150600
.ZG67P             ANOP  ,                                              00150700
.*-------------------------------------------------------------------   00150800
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00150900
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00151000
&XMFATTR           SETC  '0D'                                           00151100
                   AIF   (K'&MF(3) LE 0).ZG70B  PARM                    00151200
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00151300
                   AIF   (N'&MF(3) GT 1).ZG70B  MULTI                   00151400
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00151500
.ZG70B             ANOP  ,                                              00151600
.*-------------------------------------------------------------------   00151700
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00151800
                   AIF   (K'&ZXMFATTR LE 0).ZG70P  NOT I/O              00151900
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG70P                 00152000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00152100
&ZMS               SETC  '"MF='                                         00152200
&ZMS               SETC  '&ZMS.&MF"'                                    00152300
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00152400
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00152500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00152600
.ZG70P             ANOP  ,                                              00152700
.*-------------------------------------------------------------------   00152800
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00152900
                   AIF   (K'&ZXMFATTR LE 0).ZG70S  NOT I/O              00153000
                   AIF   (K'&XMFATTR LE 60).ZG70S  LNG OK               00153100
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00153200
&ZMS               SETC  '"MF='                                         00153300
&ZMS               SETC  '&ZMS.&MF"'                                    00153400
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00153500
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00153600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00153700
.ZG70S             ANOP  ,                                              00153800
.*-------------------------------------------------------------------   00153900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00154000
.ZG72              ANOP  ,                                              00154100
&ZTLC              SETC 'M'                                             00154200
                   AIF   ('&MF(1)' NE '&ZTLC').ZG81                     00154300
&XMF               SETC  'M'         SET KEYWORD                        00154400
                   AIF   (N'&MF LE 3).ZG72A     CK NUM                  00154500
&ZMS               SETC  '"MF='                                         00154600
&ZMS               SETC  '&ZMS.&MF"'                                    00154700
&ZMS               SETC  '&ZMS "MF"'                                    00154800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00154900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00155000
.ZG72A             ANOP  ,                                              00155100
.*-------------------------------------------------------------------   00155200
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00155300
                   AIF   ('&OUTPROFILETKN' NE '').ZG72B  OUTPUT?        00155400
                   AGO    .ZG72C     INVOCATION OKAY                    00155500
.ZG72B             ANOP  ,                                              00155600
&ZMS               SETC  'THE "M" FORM OF "MF" CANNOT'                  00155700
&ZMS               SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'        00155800
&ZMS               SETC  '&ZMS SPECIFIED ON THE INVOCATION:'            00155900
&ZMS               SETC  '&ZMS "OUTPROFILETKN"'                         00156000
                   MNOTE 8,' &ZMS '                                     00156100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00156200
.ZG72C             ANOP  ,                                              00156300
.*-------------------------------------------------------------------   00156400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00156500
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00156600
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00156700
                   AIF   (N'&MF(2) GT 1).ZG74B  MULTI                   00156800
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00156900
.ZG74B             AIF   (K'&MF(2) GT 0).ZG74C                          00157000
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00157100
&ZMS               SETC  'WHEN "M" IS SPECIFIED'                        00157200
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00157300
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00157400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00157500
.ZG74C             ANOP  ,                                              00157600
.*-------------------------------------------------------------------   00157700
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00157800
                   AIF   (K'&ZXMFCTRL LE 0).ZG74R  NOT I/O              00157900
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG74R                 00158000
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00158100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG74P                   00158200
                   AIF   (K'&ZCGPR GT 2).ZG74Q                          00158300
                   AIF   ('&ZCGPR' EQ '0').ZG74Q                        00158400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00158500
                   AIF   (T'&ZCGPR NE 'N').ZG74Q  INVALID REG NAME      00158600
.ZG74P             ANOP  ,                                              00158700
                   AIF   (T'&ZCGPR NE 'N').ZG74R  NON NUMERIC           00158800
                   AIF   ('&ZCGPR' LT '1').ZG74Q                        00158900
                   AIF   ('&ZCGPR' LE '12').ZG74R                       00159000
.ZG74Q             ANOP  ,                                              00159100
&ZMS               SETC  '"MF='                                         00159200
&ZMS               SETC  '&ZMS.&MF"'                                    00159300
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00159400
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00159500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00159600
.ZG74R             ANOP  ,                                              00159700
.*-------------------------------------------------------------------   00159800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00159900
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00160000
.ZG78A   AIF   ('&MF(3)' NE 'COMPLETE').ZG79A                           00160100
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00160200
.*-------------------------------------------------------------------   00160300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00160400
.ZG79A   AIF   ('&MF(3)' NE 'NOCHECK').ZG80A                            00160500
&XMFSCK            SETC  'NOCHECK'   SET KEYWORD                        00160600
.*-------------------------------------------------------------------   00160700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00160800
.ZG80A             AIF   (K'&XMFSCK GT 0).ZG80C  KEYWORD                00160900
                   AIF   (K'&MF(3) LE 0).ZG80B                          00161000
&ZMS               SETC  '"MF='                                         00161100
&ZMS               SETC  '&ZMS.&MF"'                                    00161200
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00161300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00161400
&ZMS               SETC  '&ZMS "COMPLETE"'                              00161500
&ZMS               SETC  '&ZMS OR "NOCHECK".'                           00161600
                   MNOTE 8,' &ZMS '                                     00161700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00161800
.ZG80B             ANOP  ,                                              00161900
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00162000
.ZG80C             ANOP  ,                                              00162100
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00162200
.*-------------------------------------------------------------------   00162300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00162400
.ZG81              ANOP  ,                                              00162500
&ZTLC              SETC 'E'                                             00162600
                   AIF   ('&MF(1)' NE '&ZTLC').ZG90                     00162700
&XMF               SETC  'E'         SET KEYWORD                        00162800
                   AIF   (N'&MF LE 3).ZG81A     CK NUM                  00162900
&ZMS               SETC  '"MF='                                         00163000
&ZMS               SETC  '&ZMS.&MF"'                                    00163100
&ZMS               SETC  '&ZMS "MF"'                                    00163200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00163300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00163400
.ZG81A             ANOP  ,                                              00163500
.*-------------------------------------------------------------------   00163600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00163700
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00163800
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00163900
                   AIF   (N'&MF(2) GT 1).ZG83B  MULTI                   00164000
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00164100
.ZG83B             AIF   (K'&MF(2) GT 0).ZG83C                          00164200
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00164300
&ZMS               SETC  'WHEN "E" IS SPECIFIED'                        00164400
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00164500
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00164600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00164700
.ZG83C             ANOP  ,                                              00164800
.*-------------------------------------------------------------------   00164900
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00165000
                   AIF   (K'&ZXMFCTRL LE 0).ZG83R  NOT I/O              00165100
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG83R                 00165200
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00165300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG83P                   00165400
                   AIF   (K'&ZCGPR GT 2).ZG83Q                          00165500
                   AIF   ('&ZCGPR' EQ '0').ZG83Q                        00165600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00165700
                   AIF   (T'&ZCGPR NE 'N').ZG83Q  INVALID REG NAME      00165800
.ZG83P             ANOP  ,                                              00165900
                   AIF   (T'&ZCGPR NE 'N').ZG83R  NON NUMERIC           00166000
                   AIF   ('&ZCGPR' LT '1').ZG83Q                        00166100
                   AIF   ('&ZCGPR' LE '12').ZG83R                       00166200
.ZG83Q             ANOP  ,                                              00166300
&ZMS               SETC  '"MF='                                         00166400
&ZMS               SETC  '&ZMS.&MF"'                                    00166500
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00166600
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00166700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00166800
.ZG83R             ANOP  ,                                              00166900
.*-------------------------------------------------------------------   00167000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00167100
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00167200
.ZG87A   AIF   ('&MF(3)' NE 'COMPLETE').ZG88A                           00167300
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00167400
.*-------------------------------------------------------------------   00167500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00167600
.ZG88A   AIF   ('&MF(3)' NE 'NOCHECK').ZG89A                            00167700
&XMFSCK            SETC  'NOCHECK'   SET KEYWORD                        00167800
.*-------------------------------------------------------------------   00167900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00168000
.ZG89A             AIF   (K'&XMFSCK GT 0).ZG89C  KEYWORD                00168100
                   AIF   (K'&MF(3) LE 0).ZG89B                          00168200
&ZMS               SETC  '"MF='                                         00168300
&ZMS               SETC  '&ZMS.&MF"'                                    00168400
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00168500
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00168600
&ZMS               SETC  '&ZMS "COMPLETE"'                              00168700
&ZMS               SETC  '&ZMS OR "NOCHECK".'                           00168800
                   MNOTE 8,' &ZMS '                                     00168900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00169000
.ZG89B             ANOP  ,                                              00169100
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00169200
.ZG89C             ANOP  ,                                              00169300
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00169400
.*------------------------------------------------------------------    00169500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169600
.ZG90              ANOP  ,                                              00169700
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00169800
                   AIF   (K'&XMF GT 0).ZG90E    VALID ARG               00169900
                   AIF   (T'&MF EQ 'O').ZG90D   OMITTED                 00170000
&ZASYSLNDX         SETA  0                                              00170100
.ZG90A             ANOP  ,           POSITIONAL MACRO KEY               00170200
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00170300
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG90C               00170400
&ZTLC              SETC 'MF'                                            00170500
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG90A      00170600
.ZG90B             ANOP  ,                                              00170700
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00170800
&ZMS               SETC  'THE "MF" KEY'                                 00170900
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00171000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00171100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00171200
                   AGO   .ZG90E                                         00171300
.ZG90C             ANOP  ,                                              00171400
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00171500
&ZMS               SETC  '"MF='                                         00171600
&ZMS               SETC  '&ZMS.&MF"'                                    00171700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00171800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00171900
&ZMS               SETC  '&ZMS "S",'                                    00172000
&ZMS               SETC  '&ZMS "L",'                                    00172100
&ZMS               SETC  '&ZMS "M",'                                    00172200
&ZMS               SETC  '&ZMS OR "E".'                                 00172300
                   MNOTE 8,' &ZMS '                                     00172400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00172500
                   AGO   .ZG90E                                         00172600
.ZG90D             ANOP  ,                                              00172700
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00172800
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00172900
.ZG90E             ANOP  ,                                              00173000
.********************************************************************   00173100
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00173200
.********************************************************************   00173300
                   ACTR  10000                                          00173400
.*-------------------------------------------------------------------   00173500
.***AG.MF03 MF=(SLME)                                                   00173600
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00173700
                   AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                00173800
.*------------------------------------------------------------------    00173900
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174000
&XREQUEST          SETC  ''          INITIALIZE XVARIABLE               00174100
.*-------------------------------------------------------------------   00174200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174300
.ZG3               ANOP  ,                                              00174400
                   AIF   (K'&REQUEST(1) LE 0).ZG3A                      00174500
&ZTLC              SETC 'PROFILE'                                       00174600
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG32                00174700
&XREQUEST          SETC  'PROFILE'   SET KEYWORD                        00174800
                   AIF   (N'&REQUEST LE 1).ZG3A  CK NUM                 00174900
&ZMS               SETC  '"REQUEST='                                    00175000
&ZMS               SETC  '&ZMS.&REQUEST"'                               00175100
&ZMS               SETC  '&ZMS "REQUEST"'                               00175200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00175300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00175400
.ZG3A              ANOP  ,                                              00175500
.*------------------------------------------------------------------    00175600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00175700
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00175800
.ZG3A0             AIF   (K'&ANSAREA LE 0).ZG3A1  OK                    00175900
&ZCVAL             SETC '&ZCVAL ANSAREA'        INCORRECT KEY USED      00176000
.ZG3A1             AIF   (K'&ANSLEN LE 0).ZG3A2  OK                     00176100
&ZCVAL             SETC '&ZCVAL ANSLEN'         INCORRECT KEY USED      00176200
.ZG3A2             AIF   (K'&TYPE LE 0).ZG3A3   OK                      00176300
&ZCVAL             SETC '&ZCVAL TYPE'           INCORRECT KEY USED      00176400
.ZG3A3             AIF   (K'&CPUMASK LE 0).ZG3A4  OK                    00176500
&ZCVAL             SETC '&ZCVAL CPUMASK'        INCORRECT KEY USED      00176600
.ZG3A4             AIF   (K'&ZCVAL LE 0).ZG3A5  OK                      00176700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00176800
&ZMS               SETC  '"REQUEST'                                     00176900
&ZMS               SETC  '&ZMS.=&REQUEST"'                              00177000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00177100
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00177200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00177300
.ZG3A5             ANOP  ,                                              00177400
.*------------------------------------------------------------------    00177500
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177600
&XACTION           SETC  ''          INITIALIZE XVARIABLE               00177700
.*-------------------------------------------------------------------   00177800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177900
.ZG6               ANOP  ,                                              00178000
                   AIF   (K'&ACTION(1) LE 0).ZG6A                       00178100
&ZTLC              SETC 'START'                                         00178200
                   AIF   ('&ACTION(1)' NE '&ZTLC').ZG27                 00178300
&XACTION           SETC  'START'     SET KEYWORD                        00178400
                   AIF   (N'&ACTION LE 1).ZG6A  CK NUM                  00178500
&ZMS               SETC  '"ACTION='                                     00178600
&ZMS               SETC  '&ZMS.&ACTION"'                                00178700
&ZMS               SETC  '&ZMS "ACTION"'                                00178800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00178900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00179000
.ZG6A              ANOP  ,                                              00179100
.*------------------------------------------------------------------    00179200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00179300
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00179400
.ZG6A0             AIF   (K'&PROFILETKN LE 0).ZG6A1  OK                 00179500
&ZCVAL             SETC '&ZCVAL PROFILETKN'     INCORRECT KEY USED      00179600
.ZG6A1             AIF   (K'&ZCVAL LE 0).ZG6A2  OK                      00179700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00179800
&ZMS               SETC  '"ACTION'                                      00179900
&ZMS               SETC  '&ZMS.=&ACTION"'                               00180000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00180100
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00180200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00180300
.ZG6A2             ANOP  ,                                              00180400
.*-------------------------------------------------------------------   00180500
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00180600
                   AIF   ('&XMF' EQ 'M').ZG9    BYPASS IF MF=M          00180700
.*----------------------------------------------------------------***   00180800
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00180900
                   AIF   (N'&OUTPROFILETKN LE 1).ZG8A  CK NUM           00181000
&ZMS               SETC  '"OUTPROFILETKN='                              00181100
&ZMS               SETC  '&ZMS.&OUTPROFILETKN"'                         00181200
&ZMS               SETC  '&ZMS "OUTPROFILETKN"'                         00181300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00181400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00181500
.ZG8A              ANOP  ,                                              00181600
.*-------------------------------------------------------------------   00181700
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00181800
&ZXOUTPROFILETKN   SETC  'OUTPUT'    SET IN/OUTPUT                      00181900
&XOUTPROFILETKN    SETC  '&OUTPROFILETKN(1)'    SET XVARIABLE           00182000
                   AIF   (N'&OUTPROFILETKN GT 1).ZG8B  MULTI            00182100
&XOUTPROFILETKN    SETC  '&OUTPROFILETKN'       SET XVARIABLE           00182200
.ZG8B              AIF   (K'&OUTPROFILETKN(1) GT 0).ZG8C                00182300
&ZXOUTPROFILETKN   SETC  ''          RESET IN/OUTPUT                    00182400
&ZMS               SETC  ' '                                            00182500
&ZMS               SETC  '&ZMS "OUTPROFILETKN" KEY AND ITS'             00182600
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00182700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00182800
.ZG8C              ANOP  ,                                              00182900
.*-------------------------------------------------------------------   00183000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00183100
                   AIF   (K'&ZXOUTPROFILETKN LE 0).ZG8R  NOT I/O        00183200
                   AIF   ('&XOUTPROFILETKN'(1,1) NE '(').ZG8R           00183300
&ZCGPR             SETC  '&XOUTPROFILETKN'(2,K'&XOUTPROFILETKN-2)       00183400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                    00183500
                   AIF   (K'&ZCGPR GT 2).ZG8Q                           00183600
                   AIF   ('&ZCGPR' EQ '0').ZG8Q                         00183700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00183800
                   AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME       00183900
.ZG8P              ANOP  ,                                              00184000
                   AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC            00184100
                   AIF   ('&ZCGPR' LT '2').ZG8Q                         00184200
                   AIF   ('&ZCGPR' LE '12').ZG8R                        00184300
.ZG8Q              ANOP  ,                                              00184400
&ZMS               SETC  '"OUTPROFILETKN='                              00184500
&ZMS               SETC  '&ZMS.&OUTPROFILETKN"'                         00184600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00184700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00184800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00184900
.ZG8R              ANOP  ,                                              00185000
.*-------------------------------------------------------------------   00185100
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00185200
.ZG9               ANOP  ,           END OF BYPASS CHECK                00185300
.*----------------------------------------------------------------***   00185400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00185500
                   AIF   (N'&EVENT LE 1).ZG11A  CK NUM                  00185600
&ZMS               SETC  '"EVENT='                                      00185700
&ZMS               SETC  '&ZMS.&EVENT"'                                 00185800
&ZMS               SETC  '&ZMS "EVENT"'                                 00185900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00186000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00186100
.ZG11A             ANOP  ,                                              00186200
.*-------------------------------------------------------------------   00186300
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00186400
&ZXEVENT           SETC  'INPUT'     SET IN/OUTPUT                      00186500
&XEVENT            SETC  'NO_EVENT'                                     00186600
                   AIF   (K'&EVENT(1) LE 0).ZG11B  PARM                 00186700
&XEVENT            SETC  '&EVENT(1)'            SET XVARIABLE           00186800
                   AIF   (N'&EVENT GT 1).ZG11B  MULTI                   00186900
&XEVENT            SETC  '&EVENT'    SET XVARIABLE                      00187000
.ZG11B             ANOP  ,                                              00187100
.*-------------------------------------------------------------------   00187200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00187300
                   AIF   (K'&ZXEVENT LE 0).ZG11R  NOT I/O               00187400
         AIF   ('&XEVENT' EQ 'NO_EVENT').ZG11R                          00187500
                   AIF   ('&XEVENT'(1,1) NE '(').ZG11R                  00187600
&ZCGPR             SETC  '&XEVENT'(2,K'&XEVENT-2)                       00187700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                   00187800
                   AIF   (K'&ZCGPR GT 2).ZG11Q                          00187900
                   AIF   ('&ZCGPR' EQ '0').ZG11Q                        00188000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00188100
                   AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME      00188200
.ZG11P             ANOP  ,                                              00188300
                   AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC           00188400
                   AIF   ('&ZCGPR' LT '2').ZG11Q                        00188500
                   AIF   ('&ZCGPR' LE '12').ZG11R                       00188600
.ZG11Q             ANOP  ,                                              00188700
&ZMS               SETC  '"EVENT='                                      00188800
&ZMS               SETC  '&ZMS.&EVENT"'                                 00188900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00189000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00189100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00189200
.ZG11R             ANOP  ,                                              00189300
.*----------------------------------------------------------------***   00189400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00189500
                   AIF   (N'&TRCTIME LE 1).ZG13A  CK NUM                00189600
&ZMS               SETC  '"TRCTIME='                                    00189700
&ZMS               SETC  '&ZMS.&TRCTIME"'                               00189800
&ZMS               SETC  '&ZMS "TRCTIME"'                               00189900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00190000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00190100
.ZG13A             ANOP  ,                                              00190200
.*-------------------------------------------------------------------   00190300
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00190400
&XTRCTIME          SETC  'ALL'       SET DEFAULT                        00190500
                   AIF   (K'&TRCTIME(1) LE 0).ZG13C  PARM               00190600
&XTRCTIME          SETC  '&TRCTIME(1)'          SET XVARIABLE           00190700
                   AIF   (N'&TRCTIME GT 1).ZG13B  MULTI                 00190800
&XTRCTIME          SETC  '&TRCTIME'  SET XVARIABLE                      00190900
.ZG13B             AIF   (K'&EVENT(1) GT 0).ZG13C  KEY                  00191000
&ZMS               SETC  '"TRCTIME'                                     00191100
&ZMS               SETC  '&ZMS.=&TRCTIME"'                              00191200
&ZMS               SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                00191300
&ZMS               SETC  '&ZMS '                                        00191400
&ZMS               SETC  '&ZMS "EVENT"'                                 00191500
                   MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                   00191600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00191700
.ZG13C             ANOP  ,                                              00191800
&ZXTRCTIME         SETC  'INPUT'     SET IN/OUTPUT                      00191900
.*-------------------------------------------------------------------   00192000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00192100
                   AIF   (K'&ZXTRCTIME LE 0).ZG13R  NOT I/O             00192200
         AIF   ('&XTRCTIME' EQ 'ALL').ZG13R                             00192300
                   AIF   ('&XTRCTIME'(1,1) NE '(').ZG13R                00192400
&ZCGPR             SETC  '&XTRCTIME'(2,K'&XTRCTIME-2)                   00192500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG13P                   00192600
                   AIF   (K'&ZCGPR GT 2).ZG13Q                          00192700
                   AIF   ('&ZCGPR' EQ '0').ZG13Q                        00192800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00192900
                   AIF   (T'&ZCGPR NE 'N').ZG13Q  INVALID REG NAME      00193000
.ZG13P             ANOP  ,                                              00193100
                   AIF   (T'&ZCGPR NE 'N').ZG13R  NON NUMERIC           00193200
                   AIF   ('&ZCGPR' LT '2').ZG13Q                        00193300
                   AIF   ('&ZCGPR' LE '12').ZG13R                       00193400
.ZG13Q             ANOP  ,                                              00193500
&ZMS               SETC  '"TRCTIME='                                    00193600
&ZMS               SETC  '&ZMS.&TRCTIME"'                               00193700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00193800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00193900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00194000
.ZG13R             ANOP  ,                                              00194100
.*----------------------------------------------------------------***   00194200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00194300
                   AIF   (N'&SAMPLE LE 1).ZG17A  CK NUM                 00194400
&ZMS               SETC  '"SAMPLE='                                     00194500
&ZMS               SETC  '&ZMS.&SAMPLE"'                                00194600
&ZMS               SETC  '&ZMS "SAMPLE"'                                00194700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00194800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00194900
.ZG17A             ANOP  ,                                              00195000
.*-------------------------------------------------------------------   00195100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00195200
&XSAMPLE           SETC  ''          INITIALIZE XVARIABLE               00195300
.ZG18A   AIF   ('&SAMPLE(1)' NE 'NO').ZG19A                             00195400
&XSAMPLE           SETC  'NO'        SET KEYWORD                        00195500
.*-------------------------------------------------------------------   00195600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00195700
.ZG19A   AIF   ('&SAMPLE(1)' NE 'YES').ZG20A                            00195800
&XSAMPLE           SETC  'YES'       SET KEYWORD                        00195900
.*-------------------------------------------------------------------   00196000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00196100
.ZG20A             AIF   (K'&XSAMPLE GT 0).ZG20C  KEYWORD               00196200
                   AIF   (K'&SAMPLE(1) LE 0).ZG20B                      00196300
&ZMS               SETC  '"SAMPLE='                                     00196400
&ZMS               SETC  '&ZMS.&SAMPLE"'                                00196500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00196600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00196700
&ZMS               SETC  '&ZMS "NO"'                                    00196800
&ZMS               SETC  '&ZMS OR "YES".'                               00196900
                   MNOTE 8,' &ZMS '                                     00197000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00197100
.ZG20B             ANOP  ,                                              00197200
&XSAMPLE           SETC  'NO'        SET DEFAULT KEYWORD                00197300
.ZG20C             ANOP  ,                                              00197400
&ZXSAMPLE          SETC  'INPUT'     SET IN/OUTPUT                      00197500
.*----------------------------------------------------------------***   00197600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00197700
                   AIF   (N'&NAME LE 1).ZG22A   CK NUM                  00197800
&ZMS               SETC  '"NAME='                                       00197900
&ZMS               SETC  '&ZMS.&NAME"'                                  00198000
&ZMS               SETC  '&ZMS "NAME"'                                  00198100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00198200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00198300
.ZG22A             ANOP  ,                                              00198400
.*-------------------------------------------------------------------   00198500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00198600
&ZXNAME            SETC  'INPUT'     SET IN/OUTPUT                      00198700
&XNAME             SETC  '&NAME(1)'  SET XVARIABLE                      00198800
                   AIF   (N'&NAME GT 1).ZG22B   MULTI                   00198900
&XNAME             SETC  '&NAME'     SET XVARIABLE                      00199000
.ZG22B             AIF   (K'&NAME(1) GT 0).ZG22C                        00199100
&ZXNAME            SETC  ''          RESET IN/OUTPUT                    00199200
&ZMS               SETC  ' '                                            00199300
&ZMS               SETC  '&ZMS "NAME" KEY AND ITS'                      00199400
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00199500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00199600
.ZG22C             ANOP  ,                                              00199700
.*-------------------------------------------------------------------   00199800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00199900
                   AIF   (K'&ZXNAME LE 0).ZG22R  NOT I/O                00200000
                   AIF   ('&XNAME'(1,1) NE '(').ZG22R                   00200100
&ZCGPR             SETC  '&XNAME'(2,K'&XNAME-2)                         00200200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                   00200300
                   AIF   (K'&ZCGPR GT 2).ZG22Q                          00200400
                   AIF   ('&ZCGPR' EQ '0').ZG22Q                        00200500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00200600
                   AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME      00200700
.ZG22P             ANOP  ,                                              00200800
                   AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC           00200900
                   AIF   ('&ZCGPR' LT '2').ZG22Q                        00201000
                   AIF   ('&ZCGPR' LE '12').ZG22R                       00201100
.ZG22Q             ANOP  ,                                              00201200
&ZMS               SETC  '"NAME='                                       00201300
&ZMS               SETC  '&ZMS.&NAME"'                                  00201400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00201500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00201600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00201700
.ZG22R             ANOP  ,                                              00201800
.*----------------------------------------------------------------***   00201900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00202000
                   AIF   (N'&EXITRTN LE 1).ZG25A  CK NUM                00202100
&ZMS               SETC  '"EXITRTN='                                    00202200
&ZMS               SETC  '&ZMS.&EXITRTN"'                               00202300
&ZMS               SETC  '&ZMS "EXITRTN"'                               00202400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00202500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00202600
.ZG25A             ANOP  ,                                              00202700
.*-------------------------------------------------------------------   00202800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00202900
&ZXEXITRTN         SETC  'INPUT'     SET IN/OUTPUT                      00203000
&XEXITRTN          SETC  '&EXITRTN(1)'          SET XVARIABLE           00203100
                   AIF   (N'&EXITRTN GT 1).ZG25B  MULTI                 00203200
&XEXITRTN          SETC  '&EXITRTN'  SET XVARIABLE                      00203300
.ZG25B             AIF   (K'&EXITRTN(1) GT 0).ZG25C                     00203400
&ZXEXITRTN         SETC  ''          RESET IN/OUTPUT                    00203500
&ZMS               SETC  ' '                                            00203600
&ZMS               SETC  '&ZMS "EXITRTN" KEY AND ITS'                   00203700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00203800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00203900
.ZG25C             ANOP  ,                                              00204000
.*-------------------------------------------------------------------   00204100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00204200
                   AIF   (K'&ZXEXITRTN LE 0).ZG25R  NOT I/O             00204300
                   AIF   ('&XEXITRTN'(1,1) NE '(').ZG25R                00204400
&ZCGPR             SETC  '&XEXITRTN'(2,K'&XEXITRTN-2)                   00204500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                   00204600
                   AIF   (K'&ZCGPR GT 2).ZG25Q                          00204700
                   AIF   ('&ZCGPR' EQ '0').ZG25Q                        00204800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00204900
                   AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME      00205000
.ZG25P             ANOP  ,                                              00205100
                   AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC           00205200
                   AIF   ('&ZCGPR' LT '2').ZG25Q                        00205300
                   AIF   ('&ZCGPR' LE '12').ZG25R                       00205400
.ZG25Q             ANOP  ,                                              00205500
&ZMS               SETC  '"EXITRTN='                                    00205600
&ZMS               SETC  '&ZMS.&EXITRTN"'                               00205700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00205800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00205900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00206000
.ZG25R             ANOP  ,                                              00206100
.*-------------------------------------------------------------------   00206200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00206300
.ZG27              ANOP  ,                                              00206400
&ZTLC              SETC 'STOP'                                          00206500
                   AIF   ('&ACTION(1)' NE '&ZTLC').ZG31                 00206600
&XACTION           SETC  'STOP'      SET KEYWORD                        00206700
                   AIF   (N'&ACTION LE 1).ZG27A  CK NUM                 00206800
&ZMS               SETC  '"ACTION='                                     00206900
&ZMS               SETC  '&ZMS.&ACTION"'                                00207000
&ZMS               SETC  '&ZMS "ACTION"'                                00207100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00207200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00207300
.ZG27A             ANOP  ,                                              00207400
.*------------------------------------------------------------------    00207500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00207600
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00207700
.ZG27A0            AIF   (K'&OUTPROFILETKN LE 0).ZG27A1  OK             00207800
&ZCVAL             SETC '&ZCVAL OUTPROFILETKN'  INCORRECT KEY USED      00207900
.ZG27A1            AIF   (K'&EVENT LE 0).ZG27A2  OK                     00208000
&ZCVAL             SETC '&ZCVAL EVENT'          INCORRECT KEY USED      00208100
.ZG27A2            AIF   (K'&TRCTIME LE 0).ZG27A3  OK                   00208200
&ZCVAL             SETC '&ZCVAL TRCTIME'        INCORRECT KEY USED      00208300
.ZG27A3            AIF   (K'&SAMPLE LE 0).ZG27A4  OK                    00208400
&ZCVAL             SETC '&ZCVAL SAMPLE'         INCORRECT KEY USED      00208500
.ZG27A4            AIF   (K'&NAME LE 0).ZG27A5  OK                      00208600
&ZCVAL             SETC '&ZCVAL NAME'           INCORRECT KEY USED      00208700
.ZG27A5            AIF   (K'&EXITRTN LE 0).ZG27A6  OK                   00208800
&ZCVAL             SETC '&ZCVAL EXITRTN'        INCORRECT KEY USED      00208900
.ZG27A6            AIF   (K'&ZCVAL LE 0).ZG27A7  OK                     00209000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00209100
&ZMS               SETC  '"ACTION'                                      00209200
&ZMS               SETC  '&ZMS.=&ACTION"'                               00209300
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00209400
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00209500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00209600
.ZG27A7            ANOP  ,                                              00209700
.*----------------------------------------------------------------***   00209800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00209900
                   AIF   (N'&PROFILETKN LE 1).ZG29A  CK NUM             00210000
&ZMS               SETC  '"PROFILETKN='                                 00210100
&ZMS               SETC  '&ZMS.&PROFILETKN"'                            00210200
&ZMS               SETC  '&ZMS "PROFILETKN"'                            00210300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00210400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00210500
.ZG29A             ANOP  ,                                              00210600
.*-------------------------------------------------------------------   00210700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00210800
&ZXPROFILETKN      SETC  'INPUT'     SET IN/OUTPUT                      00210900
&XPROFILETKN       SETC  '&PROFILETKN(1)'       SET XVARIABLE           00211000
                   AIF   (N'&PROFILETKN GT 1).ZG29B  MULTI              00211100
&XPROFILETKN       SETC  '&PROFILETKN'          SET XVARIABLE           00211200
.ZG29B             AIF   (K'&PROFILETKN(1) GT 0).ZG29C                  00211300
&ZXPROFILETKN      SETC  ''          RESET IN/OUTPUT                    00211400
&ZMS               SETC  ' '                                            00211500
&ZMS               SETC  '&ZMS "PROFILETKN" KEY AND ITS'                00211600
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00211700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00211800
.ZG29C             ANOP  ,                                              00211900
.*-------------------------------------------------------------------   00212000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00212100
                   AIF   (K'&ZXPROFILETKN LE 0).ZG29R  NOT I/O          00212200
                   AIF   ('&XPROFILETKN'(1,1) NE '(').ZG29R             00212300
&ZCGPR             SETC  '&XPROFILETKN'(2,K'&XPROFILETKN-2)             00212400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                   00212500
                   AIF   (K'&ZCGPR GT 2).ZG29Q                          00212600
                   AIF   ('&ZCGPR' EQ '0').ZG29Q                        00212700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00212800
                   AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME      00212900
.ZG29P             ANOP  ,                                              00213000
                   AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC           00213100
                   AIF   ('&ZCGPR' LT '2').ZG29Q                        00213200
                   AIF   ('&ZCGPR' LE '12').ZG29R                       00213300
.ZG29Q             ANOP  ,                                              00213400
&ZMS               SETC  '"PROFILETKN='                                 00213500
&ZMS               SETC  '&ZMS.&PROFILETKN"'                            00213600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00213700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00213800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00213900
.ZG29R             ANOP  ,                                              00214000
.*------------------------------------------------------------------    00214100
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00214200
.ZG31              ANOP  ,                                              00214300
&ZXACTION          SETC  'INPUT'     SET IN/OUTPUT                      00214400
                   AIF   (K'&XACTION GT 0).ZG31E  VALID ARG             00214500
                   AIF   (T'&ACTION EQ 'O').ZG31D  OMITTED              00214600
&ZASYSLNDX         SETA  0                                              00214700
.ZG31A             ANOP  ,           POSITIONAL MACRO KEY               00214800
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00214900
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG31C               00215000
&ZTLC              SETC 'ACTION'                                        00215100
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG31A      00215200
.ZG31B             ANOP  ,                                              00215300
&ZXACTION          SETC  ''          RESET IN/OUTPUT                    00215400
&ZMS               SETC  'THE "ACTION" KEY'                             00215500
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00215600
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00215700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00215800
                   AGO   .ZG31E                                         00215900
.ZG31C             ANOP  ,                                              00216000
&ZXACTION          SETC  ''          RESET IN/OUTPUT                    00216100
&ZMS               SETC  '"ACTION='                                     00216200
&ZMS               SETC  '&ZMS.&ACTION"'                                00216300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00216400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00216500
&ZMS               SETC  '&ZMS "START"'                                 00216600
&ZMS               SETC  '&ZMS OR "STOP".'                              00216700
                   MNOTE 8,' &ZMS '                                     00216800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00216900
                   AGO   .ZG31E                                         00217000
.ZG31D             ANOP  ,                                              00217100
&XACTION           SETC  'START'     SET DEFAULT KEYWORD                00217200
.ZG31E             ANOP  ,                                              00217300
.*------------------------------------------------------------------    00217400
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00217500
                   AIF   (K'&ACTION(1) GT 0).ZG31F  PARM                00217600
&XACTION           SETC  ''          ENSURE NULL KEYWORD                00217700
&ZXACTION          SETC  ''          RESET IN/OUTPUT                    00217800
&ZMS               SETC  'THE'                                          00217900
&ZMS               SETC  '&ZMS "ACTION" KEY AND ITS'                    00218000
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00218100
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00218200
&ZMS               SETC  '&ZMS "START"'                                 00218300
&ZMS               SETC  '&ZMS OR "STOP".'                              00218400
                   MNOTE 8,' &ZMS '                                     00218500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00218600
.ZG31F             ANOP  ,                                              00218700
.*-------------------------------------------------------------------   00218800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00218900
.ZG32              ANOP  ,                                              00219000
&ZTLC              SETC 'QUERY'                                         00219100
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG52                00219200
&XREQUEST          SETC  'QUERY'     SET KEYWORD                        00219300
                   AIF   (N'&REQUEST LE 1).ZG32A  CK NUM                00219400
&ZMS               SETC  '"REQUEST='                                    00219500
&ZMS               SETC  '&ZMS.&REQUEST"'                               00219600
&ZMS               SETC  '&ZMS "REQUEST"'                               00219700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00219800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00219900
.ZG32A             ANOP  ,                                              00220000
.*------------------------------------------------------------------    00220100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00220200
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00220300
.ZG32A0            AIF   (K'&ACTION LE 0).ZG32A1  OK                    00220400
&ZCVAL             SETC '&ZCVAL ACTION'         INCORRECT KEY USED      00220500
.ZG32A1            AIF   (K'&OUTPROFILETKN LE 0).ZG32A2  OK             00220600
&ZCVAL             SETC '&ZCVAL OUTPROFILETKN'  INCORRECT KEY USED      00220700
.ZG32A2            AIF   (K'&EVENT LE 0).ZG32A3  OK                     00220800
&ZCVAL             SETC '&ZCVAL EVENT'          INCORRECT KEY USED      00220900
.ZG32A3            AIF   (K'&TRCTIME LE 0).ZG32A4  OK                   00221000
&ZCVAL             SETC '&ZCVAL TRCTIME'        INCORRECT KEY USED      00221100
.ZG32A4            AIF   (K'&SAMPLE LE 0).ZG32A5  OK                    00221200
&ZCVAL             SETC '&ZCVAL SAMPLE'         INCORRECT KEY USED      00221300
.ZG32A5            AIF   (K'&NAME LE 0).ZG32A6  OK                      00221400
&ZCVAL             SETC '&ZCVAL NAME'           INCORRECT KEY USED      00221500
.ZG32A6            AIF   (K'&EXITRTN LE 0).ZG32A7  OK                   00221600
&ZCVAL             SETC '&ZCVAL EXITRTN'        INCORRECT KEY USED      00221700
.ZG32A7            AIF   (K'&ZCVAL LE 0).ZG32A8  OK                     00221800
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00221900
&ZMS               SETC  '"REQUEST'                                     00222000
&ZMS               SETC  '&ZMS.=&REQUEST"'                              00222100
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00222200
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00222300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00222400
.ZG32A8            ANOP  ,                                              00222500
.*----------------------------------------------------------------***   00222600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00222700
                   AIF   (N'&ANSAREA LE 1).ZG34A  CK NUM                00222800
&ZMS               SETC  '"ANSAREA='                                    00222900
&ZMS               SETC  '&ZMS.&ANSAREA"'                               00223000
&ZMS               SETC  '&ZMS "ANSAREA"'                               00223100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00223200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00223300
.ZG34A             ANOP  ,                                              00223400
.*-------------------------------------------------------------------   00223500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00223600
&ZXANSAREA         SETC  'INPUT'     SET IN/OUTPUT                      00223700
&XANSAREA          SETC  '&ANSAREA(1)'          SET XVARIABLE           00223800
                   AIF   (N'&ANSAREA GT 1).ZG34B  MULTI                 00223900
&XANSAREA          SETC  '&ANSAREA'  SET XVARIABLE                      00224000
.ZG34B             AIF   (K'&ANSAREA(1) GT 0).ZG34C                     00224100
&ZXANSAREA         SETC  ''          RESET IN/OUTPUT                    00224200
&ZMS               SETC  ' '                                            00224300
&ZMS               SETC  '&ZMS "ANSAREA" KEY AND ITS'                   00224400
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00224500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00224600
.ZG34C             ANOP  ,                                              00224700
.*-------------------------------------------------------------------   00224800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00224900
                   AIF   (K'&ZXANSAREA LE 0).ZG34R  NOT I/O             00225000
                   AIF   ('&XANSAREA'(1,1) NE '(').ZG34R                00225100
&ZCGPR             SETC  '&XANSAREA'(2,K'&XANSAREA-2)                   00225200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                   00225300
                   AIF   (K'&ZCGPR GT 2).ZG34Q                          00225400
                   AIF   ('&ZCGPR' EQ '0').ZG34Q                        00225500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00225600
                   AIF   (T'&ZCGPR NE 'N').ZG34Q  INVALID REG NAME      00225700
.ZG34P             ANOP  ,                                              00225800
                   AIF   (T'&ZCGPR NE 'N').ZG34R  NON NUMERIC           00225900
                   AIF   ('&ZCGPR' LT '2').ZG34Q                        00226000
                   AIF   ('&ZCGPR' LE '12').ZG34R                       00226100
.ZG34Q             ANOP  ,                                              00226200
&ZMS               SETC  '"ANSAREA='                                    00226300
&ZMS               SETC  '&ZMS.&ANSAREA"'                               00226400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00226500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00226600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00226700
.ZG34R             ANOP  ,                                              00226800
.*----------------------------------------------------------------***   00226900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00227000
                   AIF   (N'&ANSLEN LE 1).ZG37A  CK NUM                 00227100
&ZMS               SETC  '"ANSLEN='                                     00227200
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00227300
&ZMS               SETC  '&ZMS "ANSLEN"'                                00227400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00227500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00227600
.ZG37A             ANOP  ,                                              00227700
.*-------------------------------------------------------------------   00227800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00227900
&ZXANSLEN          SETC  'INPUT'     SET IN/OUTPUT                      00228000
&XANSLEN           SETC  '&ANSLEN(1)'           SET XVARIABLE           00228100
                   AIF   (N'&ANSLEN GT 1).ZG37B  MULTI                  00228200
&XANSLEN           SETC  '&ANSLEN'   SET XVARIABLE                      00228300
.ZG37B             AIF   (K'&ANSLEN(1) GT 0).ZG37C                      00228400
&ZXANSLEN          SETC  ''          RESET IN/OUTPUT                    00228500
&ZMS               SETC  ' '                                            00228600
&ZMS               SETC  '&ZMS "ANSLEN" KEY AND ITS'                    00228700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00228800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00228900
.ZG37C             ANOP  ,                                              00229000
.*-------------------------------------------------------------------   00229100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00229200
                   AIF   (K'&ZXANSLEN LE 0).ZG37R  NOT I/O              00229300
                   AIF   ('&XANSLEN'(1,1) NE '(').ZG37R                 00229400
&ZCGPR             SETC  '&XANSLEN'(2,K'&XANSLEN-2)                     00229500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                   00229600
                   AIF   (K'&ZCGPR GT 2).ZG37Q                          00229700
                   AIF   ('&ZCGPR' EQ '0').ZG37Q                        00229800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00229900
                   AIF   (T'&ZCGPR NE 'N').ZG37Q  INVALID REG NAME      00230000
.ZG37P             ANOP  ,                                              00230100
                   AIF   (T'&ZCGPR NE 'N').ZG37R  NON NUMERIC           00230200
                   AIF   ('&ZCGPR' LT '2').ZG37Q                        00230300
                   AIF   ('&ZCGPR' LE '12').ZG37R                       00230400
.ZG37Q             ANOP  ,                                              00230500
&ZMS               SETC  '"ANSLEN='                                     00230600
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00230700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00230800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00230900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00231000
.ZG37R             ANOP  ,                                              00231100
.*------------------------------------------------------------------    00231200
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00231300
&XTYPE             SETC  ''          INITIALIZE XVARIABLE               00231400
.*-------------------------------------------------------------------   00231500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00231600
.ZG41              ANOP  ,                                              00231700
                   AIF   (K'&TYPE(1) LE 0).ZG41A                        00231800
&ZTLC              SETC 'EVENTDATA'                                     00231900
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZG48                   00232000
&XTYPE             SETC  'EVENTDATA'            SET KEYWORD             00232100
                   AIF   (N'&TYPE LE 1).ZG41A   CK NUM                  00232200
&ZMS               SETC  '"TYPE='                                       00232300
&ZMS               SETC  '&ZMS.&TYPE"'                                  00232400
&ZMS               SETC  '&ZMS "TYPE"'                                  00232500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00232600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00232700
.ZG41A             ANOP  ,                                              00232800
.*----------------------------------------------------------------***   00232900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00233000
                   AIF   (N'&PROFILETKN LE 1).ZG43A  CK NUM             00233100
&ZMS               SETC  '"PROFILETKN='                                 00233200
&ZMS               SETC  '&ZMS.&PROFILETKN"'                            00233300
&ZMS               SETC  '&ZMS "PROFILETKN"'                            00233400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00233500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00233600
.ZG43A             ANOP  ,                                              00233700
.*-------------------------------------------------------------------   00233800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00233900
&ZXPROFILETKN      SETC  'INPUT'     SET IN/OUTPUT                      00234000
&XPROFILETKN       SETC  '&PROFILETKN(1)'       SET XVARIABLE           00234100
                   AIF   (N'&PROFILETKN GT 1).ZG43B  MULTI              00234200
&XPROFILETKN       SETC  '&PROFILETKN'          SET XVARIABLE           00234300
.ZG43B             AIF   (K'&PROFILETKN(1) GT 0).ZG43C                  00234400
&ZXPROFILETKN      SETC  ''          RESET IN/OUTPUT                    00234500
&ZMS               SETC  ' '                                            00234600
&ZMS               SETC  '&ZMS "PROFILETKN" KEY AND ITS'                00234700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00234800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00234900
.ZG43C             ANOP  ,                                              00235000
.*-------------------------------------------------------------------   00235100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00235200
                   AIF   (K'&ZXPROFILETKN LE 0).ZG43R  NOT I/O          00235300
                   AIF   ('&XPROFILETKN'(1,1) NE '(').ZG43R             00235400
&ZCGPR             SETC  '&XPROFILETKN'(2,K'&XPROFILETKN-2)             00235500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG43P                   00235600
                   AIF   (K'&ZCGPR GT 2).ZG43Q                          00235700
                   AIF   ('&ZCGPR' EQ '0').ZG43Q                        00235800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00235900
                   AIF   (T'&ZCGPR NE 'N').ZG43Q  INVALID REG NAME      00236000
.ZG43P             ANOP  ,                                              00236100
                   AIF   (T'&ZCGPR NE 'N').ZG43R  NON NUMERIC           00236200
                   AIF   ('&ZCGPR' LT '2').ZG43Q                        00236300
                   AIF   ('&ZCGPR' LE '12').ZG43R                       00236400
.ZG43Q             ANOP  ,                                              00236500
&ZMS               SETC  '"PROFILETKN='                                 00236600
&ZMS               SETC  '&ZMS.&PROFILETKN"'                            00236700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00236800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00236900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00237000
.ZG43R             ANOP  ,                                              00237100
.*----------------------------------------------------------------***   00237200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00237300
                   AIF   (N'&CPUMASK LE 1).ZG46A  CK NUM                00237400
&ZMS               SETC  '"CPUMASK='                                    00237500
&ZMS               SETC  '&ZMS.&CPUMASK"'                               00237600
&ZMS               SETC  '&ZMS "CPUMASK"'                               00237700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00237800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00237900
.ZG46A             ANOP  ,                                              00238000
.*-------------------------------------------------------------------   00238100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00238200
&ZXCPUMASK         SETC  'INPUT'     SET IN/OUTPUT                      00238300
&XCPUMASK          SETC  'ALL'                                          00238400
                   AIF   (K'&CPUMASK(1) LE 0).ZG46B  PARM               00238500
&XCPUMASK          SETC  '&CPUMASK(1)'          SET XVARIABLE           00238600
                   AIF   (N'&CPUMASK GT 1).ZG46B  MULTI                 00238700
&XCPUMASK          SETC  '&CPUMASK'  SET XVARIABLE                      00238800
.ZG46B             ANOP  ,                                              00238900
.*-------------------------------------------------------------------   00239000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00239100
                   AIF   (K'&ZXCPUMASK LE 0).ZG46R  NOT I/O             00239200
         AIF   ('&XCPUMASK' EQ 'ALL').ZG46R                             00239300
                   AIF   ('&XCPUMASK'(1,1) NE '(').ZG46R                00239400
&ZCGPR             SETC  '&XCPUMASK'(2,K'&XCPUMASK-2)                   00239500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                   00239600
                   AIF   (K'&ZCGPR GT 2).ZG46Q                          00239700
                   AIF   ('&ZCGPR' EQ '0').ZG46Q                        00239800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00239900
                   AIF   (T'&ZCGPR NE 'N').ZG46Q  INVALID REG NAME      00240000
.ZG46P             ANOP  ,                                              00240100
                   AIF   (T'&ZCGPR NE 'N').ZG46R  NON NUMERIC           00240200
                   AIF   ('&ZCGPR' LT '2').ZG46Q                        00240300
                   AIF   ('&ZCGPR' LE '12').ZG46R                       00240400
.ZG46Q             ANOP  ,                                              00240500
&ZMS               SETC  '"CPUMASK='                                    00240600
&ZMS               SETC  '&ZMS.&CPUMASK"'                               00240700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00240800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00240900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00241000
.ZG46R             ANOP  ,                                              00241100
.*-------------------------------------------------------------------   00241200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00241300
.ZG48              ANOP  ,                                              00241400
&ZTLC              SETC 'EVENT'                                         00241500
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZG49                   00241600
&XTYPE             SETC  'EVENT'     SET KEYWORD                        00241700
                   AIF   (N'&TYPE LE 1).ZG48A   CK NUM                  00241800
&ZMS               SETC  '"TYPE='                                       00241900
&ZMS               SETC  '&ZMS.&TYPE"'                                  00242000
&ZMS               SETC  '&ZMS "TYPE"'                                  00242100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00242200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00242300
.ZG48A             ANOP  ,                                              00242400
.*------------------------------------------------------------------    00242500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00242600
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00242700
.ZG48A0            AIF   (K'&PROFILETKN LE 0).ZG48A1  OK                00242800
&ZCVAL             SETC '&ZCVAL PROFILETKN'     INCORRECT KEY USED      00242900
.ZG48A1            AIF   (K'&CPUMASK LE 0).ZG48A2  OK                   00243000
&ZCVAL             SETC '&ZCVAL CPUMASK'        INCORRECT KEY USED      00243100
.ZG48A2            AIF   (K'&ZCVAL LE 0).ZG48A3  OK                     00243200
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00243300
&ZMS               SETC  '"TYPE'                                        00243400
&ZMS               SETC  '&ZMS.=&TYPE"'                                 00243500
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00243600
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00243700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00243800
.ZG48A3            ANOP  ,                                              00243900
.*-------------------------------------------------------------------   00244000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00244100
.ZG49              ANOP  ,                                              00244200
&ZTLC              SETC 'SAMPLE'                                        00244300
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZG50                   00244400
&XTYPE             SETC  'SAMPLE'    SET KEYWORD                        00244500
                   AIF   (N'&TYPE LE 1).ZG49A   CK NUM                  00244600
&ZMS               SETC  '"TYPE='                                       00244700
&ZMS               SETC  '&ZMS.&TYPE"'                                  00244800
&ZMS               SETC  '&ZMS "TYPE"'                                  00244900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00245000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00245100
.ZG49A             ANOP  ,                                              00245200
.*------------------------------------------------------------------    00245300
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00245400
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00245500
.ZG49A0            AIF   (K'&PROFILETKN LE 0).ZG49A1  OK                00245600
&ZCVAL             SETC '&ZCVAL PROFILETKN'     INCORRECT KEY USED      00245700
.ZG49A1            AIF   (K'&CPUMASK LE 0).ZG49A2  OK                   00245800
&ZCVAL             SETC '&ZCVAL CPUMASK'        INCORRECT KEY USED      00245900
.ZG49A2            AIF   (K'&ZCVAL LE 0).ZG49A3  OK                     00246000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00246100
&ZMS               SETC  '"TYPE'                                        00246200
&ZMS               SETC  '&ZMS.=&TYPE"'                                 00246300
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00246400
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00246500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00246600
.ZG49A3            ANOP  ,                                              00246700
.*-------------------------------------------------------------------   00246800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00246900
.ZG50              ANOP  ,                                              00247000
&ZTLC              SETC 'PROFILERS'                                     00247100
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZG51                   00247200
&XTYPE             SETC  'PROFILERS'            SET KEYWORD             00247300
                   AIF   (N'&TYPE LE 1).ZG50A   CK NUM                  00247400
&ZMS               SETC  '"TYPE='                                       00247500
&ZMS               SETC  '&ZMS.&TYPE"'                                  00247600
&ZMS               SETC  '&ZMS "TYPE"'                                  00247700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00247800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00247900
.ZG50A             ANOP  ,                                              00248000
.*------------------------------------------------------------------    00248100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00248200
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00248300
.ZG50A0            AIF   (K'&PROFILETKN LE 0).ZG50A1  OK                00248400
&ZCVAL             SETC '&ZCVAL PROFILETKN'     INCORRECT KEY USED      00248500
.ZG50A1            AIF   (K'&CPUMASK LE 0).ZG50A2  OK                   00248600
&ZCVAL             SETC '&ZCVAL CPUMASK'        INCORRECT KEY USED      00248700
.ZG50A2            AIF   (K'&ZCVAL LE 0).ZG50A3  OK                     00248800
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00248900
&ZMS               SETC  '"TYPE'                                        00249000
&ZMS               SETC  '&ZMS.=&TYPE"'                                 00249100
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00249200
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00249300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00249400
.ZG50A3            ANOP  ,                                              00249500
.*------------------------------------------------------------------    00249600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00249700
.ZG51              ANOP  ,                                              00249800
&ZXTYPE            SETC  'INPUT'     SET IN/OUTPUT                      00249900
                   AIF   (K'&XTYPE GT 0).ZG51E  VALID ARG               00250000
                   AIF   (T'&TYPE EQ 'O').ZG51D  OMITTED                00250100
&ZASYSLNDX         SETA  0                                              00250200
.ZG51A             ANOP  ,           POSITIONAL MACRO KEY               00250300
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00250400
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG51C               00250500
&ZTLC              SETC 'TYPE'                                          00250600
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG51A      00250700
.ZG51B             ANOP  ,                                              00250800
&ZXTYPE            SETC  ''          RESET IN/OUTPUT                    00250900
&ZMS               SETC  'THE "TYPE" KEY'                               00251000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00251100
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00251200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00251300
                   AGO   .ZG51E                                         00251400
.ZG51C             ANOP  ,                                              00251500
&ZXTYPE            SETC  ''          RESET IN/OUTPUT                    00251600
&ZMS               SETC  '"TYPE='                                       00251700
&ZMS               SETC  '&ZMS.&TYPE"'                                  00251800
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00251900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00252000
&ZMS               SETC  '&ZMS "EVENTDATA",'                            00252100
&ZMS               SETC  '&ZMS "EVENT",'                                00252200
&ZMS               SETC  '&ZMS "SAMPLE",'                               00252300
&ZMS               SETC  '&ZMS OR "PROFILERS".'                         00252400
                   MNOTE 8,' &ZMS '                                     00252500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00252600
                   AGO   .ZG51E                                         00252700
.ZG51D             ANOP  ,                                              00252800
&XTYPE             SETC  'EVENTDATA'            SET DEFAULT KEYWORD     00252900
.ZG51E             ANOP  ,                                              00253000
.*------------------------------------------------------------------    00253100
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00253200
                   AIF   (K'&TYPE(1) GT 0).ZG51F  PARM                  00253300
&XTYPE             SETC  ''          ENSURE NULL KEYWORD                00253400
&ZXTYPE            SETC  ''          RESET IN/OUTPUT                    00253500
&ZMS               SETC  'THE'                                          00253600
&ZMS               SETC  '&ZMS "TYPE" KEY AND ITS'                      00253700
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00253800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00253900
&ZMS               SETC  '&ZMS "EVENTDATA",'                            00254000
&ZMS               SETC  '&ZMS "EVENT",'                                00254100
&ZMS               SETC  '&ZMS "SAMPLE",'                               00254200
&ZMS               SETC  '&ZMS OR "PROFILERS".'                         00254300
                   MNOTE 8,' &ZMS '                                     00254400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00254500
.ZG51F             ANOP  ,                                              00254600
.*------------------------------------------------------------------    00254700
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00254800
.ZG52              ANOP  ,                                              00254900
&ZXREQUEST         SETC  'INPUT'     SET IN/OUTPUT                      00255000
                   AIF   (K'&XREQUEST GT 0).ZG52E  VALID ARG            00255100
                   AIF   (T'&REQUEST EQ 'O').ZG52D  OMITTED             00255200
&ZASYSLNDX         SETA  0                                              00255300
.ZG52A             ANOP  ,           POSITIONAL MACRO KEY               00255400
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00255500
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG52C               00255600
&ZTLC              SETC 'REQUEST'                                       00255700
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG52A      00255800
.ZG52B             ANOP  ,                                              00255900
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00256000
&ZMS               SETC  'THE "REQUEST" KEY'                            00256100
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00256200
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00256300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00256400
                   AGO   .ZG52E                                         00256500
.ZG52C             ANOP  ,                                              00256600
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00256700
&ZMS               SETC  '"REQUEST='                                    00256800
&ZMS               SETC  '&ZMS.&REQUEST"'                               00256900
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00257000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00257100
&ZMS               SETC  '&ZMS "PROFILE"'                               00257200
&ZMS               SETC  '&ZMS OR "QUERY".'                             00257300
                   MNOTE 8,' &ZMS '                                     00257400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00257500
                   AGO   .ZG52E                                         00257600
.ZG52D             ANOP  ,                                              00257700
&XREQUEST          SETC  'PROFILE'   SET DEFAULT KEYWORD                00257800
.ZG52E             ANOP  ,                                              00257900
.*------------------------------------------------------------------    00258000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00258100
                   AIF   (K'&REQUEST(1) GT 0).ZG52F  PARM               00258200
&XREQUEST          SETC  ''          ENSURE NULL KEYWORD                00258300
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00258400
&ZMS               SETC  'THE'                                          00258500
&ZMS               SETC  '&ZMS "REQUEST" KEY AND ITS'                   00258600
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00258700
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00258800
&ZMS               SETC  '&ZMS "PROFILE"'                               00258900
&ZMS               SETC  '&ZMS OR "QUERY".'                             00259000
                   MNOTE 8,' &ZMS '                                     00259100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00259200
.ZG52F             ANOP  ,                                              00259300
.*----------------------------------------------------------------***   00259400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00259500
                   AIF   (N'&RETCODE LE 1).ZG54A  CK NUM                00259600
&ZMS               SETC  '"RETCODE='                                    00259700
&ZMS               SETC  '&ZMS.&RETCODE"'                               00259800
&ZMS               SETC  '&ZMS "RETCODE"'                               00259900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00260000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00260100
.ZG54A             ANOP  ,                                              00260200
.*-------------------------------------------------------------------   00260300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00260400
                   AIF   (K'&RETCODE(1) LE 0).ZG54C  NO PARM            00260500
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00260600
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00260700
                   AIF   (N'&RETCODE GT 1).ZG54C                        00260800
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00260900
.ZG54C             ANOP  ,                                              00261000
.*-------------------------------------------------------------------   00261100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00261200
                   AIF   (K'&ZXRETCODE LE 0).ZG54R  NOT I/O             00261300
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG54R                00261400
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00261500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG54P                   00261600
                   AIF   (K'&ZCGPR GT 2).ZG54Q                          00261700
                   AIF   ('&ZCGPR' EQ '0').ZG54Q                        00261800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00261900
                   AIF   (T'&ZCGPR NE 'N').ZG54Q  INVALID REG NAME      00262000
.ZG54P             ANOP  ,                                              00262100
                   AIF   (T'&ZCGPR NE 'N').ZG54R  NON NUMERIC           00262200
                   AIF   ('&ZCGPR' EQ '15').ZG54R                       00262300
                   AIF   ('&ZCGPR' LT '2').ZG54Q                        00262400
                   AIF   ('&ZCGPR' LE '12').ZG54R                       00262500
.ZG54Q             ANOP  ,                                              00262600
&ZMS               SETC  '"RETCODE='                                    00262700
&ZMS               SETC  '&ZMS.&RETCODE"'                               00262800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00262900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'       00263000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00263100
.ZG54R             ANOP  ,                                              00263200
.*----------------------------------------------------------------***   00263300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00263400
                   AIF   (N'&RSNCODE LE 1).ZG57A  CK NUM                00263500
&ZMS               SETC  '"RSNCODE='                                    00263600
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00263700
&ZMS               SETC  '&ZMS "RSNCODE"'                               00263800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00263900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00264000
.ZG57A             ANOP  ,                                              00264100
.*-------------------------------------------------------------------   00264200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00264300
                   AIF   (K'&RSNCODE(1) LE 0).ZG57C  NO PARM            00264400
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00264500
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00264600
                   AIF   (N'&RSNCODE GT 1).ZG57C                        00264700
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00264800
.ZG57C             ANOP  ,                                              00264900
.*-------------------------------------------------------------------   00265000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00265100
                   AIF   (K'&ZXRSNCODE LE 0).ZG57R  NOT I/O             00265200
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG57R                00265300
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00265400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG57P                   00265500
                   AIF   (K'&ZCGPR GT 2).ZG57Q                          00265600
                   AIF   ('&ZCGPR' EQ '0').ZG57R                        00265700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00265800
                   AIF   (T'&ZCGPR NE 'N').ZG57Q  INVALID REG NAME      00265900
.ZG57P             ANOP  ,                                              00266000
                   AIF   (T'&ZCGPR NE 'N').ZG57R  NON NUMERIC           00266100
                   AIF   ('&ZCGPR' EQ '0').ZG57R                        00266200
                   AIF   ('&ZCGPR' LT '2').ZG57Q                        00266300
                   AIF   ('&ZCGPR' LE '12').ZG57R                       00266400
.ZG57Q             ANOP  ,                                              00266500
&ZMS               SETC  '"RSNCODE='                                    00266600
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00266700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00266800
                   MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'        00266900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00267000
.ZG57R             ANOP  ,                                              00267100
.******************************************************************     00267200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00267300
.******************************************************************     00267400
                   ACTR  10000                                          00267500
.*----------------------------------------------------------------***   00267600
.***AH.P02 EXTRA POSITIONALS                                            00267700
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00267800
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00267900
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00268000
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00268100
.ZGLISTX1          ANOP  ,                                              00268200
&ZCVAL             SETC  ''          ERROR FIELD                        00268300
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00268400
.ZGLIST2           ANOP  ,                                              00268500
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00268600
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00268700
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00268800
                   AGO   .ZGLIST2                                       00268900
.*                                                                      00269000
.ZGLIST3           ANOP  ,                                              00269100
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00269200
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00269300
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00269400
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00269500
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00269600
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00269700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00269800
.ZGLISTX           ANOP  ,                                              00269900
&ZASYSLNDX         SETA  0                                              00270000
.*-------------------------------------------------------------------   00270100
.***AG.MF04 MF=(SLME)                                                   00270200
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00270300
.********************************************************************   00270400
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00270500
.********************************************************************   00270600
                   ACTR  10000                                          00270700
.*-------------------------------------------------------------------   00270800
.***AE.MF01 MF=(SLME)                                                   00270900
                   AIF   ('&XMF' EQ 'L').ZEMFX                          00271000
                   AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                 00271100
.********************************************************************   00271200
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00271300
.********************************************************************   00271400
&XREQUEST          SETC  ''          INITIALIZE XVARIABLE               00271500
&XACTION           SETC  ''          INITIALIZE XVARIABLE               00271600
&XSAMPLE           SETC  ''          INITIALIZE XVARIABLE               00271700
&XTYPE             SETC  ''          INITIALIZE XVARIABLE               00271800
.*-------------------------------------------------------------------   00271900
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00272000
&ZTLC              SETC 'PROFILE'                                       00272100
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZE3A                00272200
&XREQUEST          SETC  'PROFILE'   SET KEYWORD                        00272300
                   AIF   (N'&REQUEST LE 1).ZE3A  CK NUM                 00272400
&ZMS               SETC  '"REQUEST='                                    00272500
&ZMS               SETC  '&ZMS.&REQUEST"'                               00272600
&ZMS               SETC  '&ZMS "REQUEST"'                               00272700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00272800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00272900
.ZE3A              ANOP  ,                                              00273000
.*-------------------------------------------------------------------   00273100
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00273200
&ZTLC              SETC 'START'                                         00273300
                   AIF   ('&ACTION(1)' NE '&ZTLC').ZE6A                 00273400
&XACTION           SETC  'START'     SET KEYWORD                        00273500
                   AIF   (N'&ACTION LE 1).ZE6A  CK NUM                  00273600
&ZMS               SETC  '"ACTION='                                     00273700
&ZMS               SETC  '&ZMS.&ACTION"'                                00273800
&ZMS               SETC  '&ZMS "ACTION"'                                00273900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00274000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00274100
.ZE6A              ANOP  ,                                              00274200
.*----------------------------------------------------------------***   00274300
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         00274400
                   AIF   (N'&OUTPROFILETKN LE 1).ZE8A  CK NUM           00274500
&ZMS               SETC  '"OUTPROFILETKN='                              00274600
&ZMS               SETC  '&ZMS.&OUTPROFILETKN"'                         00274700
&ZMS               SETC  '&ZMS "OUTPROFILETKN"'                         00274800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00274900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00275000
.ZE8A              ANOP  ,                                              00275100
.*-------------------------------------------------------------------   00275200
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    00275300
                   AIF   (K'&OUTPROFILETKN(1) LE 0).ZE8B NO PRM         00275400
&ZXOUTPROFILETKN   SETC  'OUTPUT'    SET IN/OUTPUT                      00275500
&XOUTPROFILETKN    SETC  '&OUTPROFILETKN(1)'    SET XVARIABLE           00275600
                   AIF   (N'&OUTPROFILETKN GT 1).ZE8B                   00275700
.*                 ANOP                                                 00275800
&XOUTPROFILETKN    SETC  '&OUTPROFILETKN'       SET XVARIABLE           00275900
.ZE8B              ANOP  ,                                              00276000
.*-------------------------------------------------------------------   00276100
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00276200
                   AIF   (K'&ZXOUTPROFILETKN LE 0).ZE8R  NOT I/O        00276300
                   AIF   ('&XOUTPROFILETKN'(1,1) NE '(').ZE8R           00276400
&ZCGPR             SETC  '&XOUTPROFILETKN'(2,K'&XOUTPROFILETKN-2)       00276500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE8P                    00276600
                   AIF   (K'&ZCGPR GT 2).ZE8Q                           00276700
                   AIF   ('&ZCGPR' EQ '0').ZE8Q                         00276800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00276900
                   AIF   (T'&ZCGPR NE 'N').ZE8Q  INVALID REG NAME       00277000
.ZE8P              ANOP  ,                                              00277100
                   AIF   (T'&ZCGPR NE 'N').ZE8R  NON NUMERIC            00277200
                   AIF   ('&ZCGPR' LT '2').ZE8Q                         00277300
                   AIF   ('&ZCGPR' LE '12').ZE8R                        00277400
.ZE8Q              ANOP  ,                                              00277500
&ZMS               SETC  '"OUTPROFILETKN='                              00277600
&ZMS               SETC  '&ZMS.&OUTPROFILETKN"'                         00277700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00277800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00277900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00278000
.ZE8R              ANOP  ,                                              00278100
.*----------------------------------------------------------------***   00278200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00278300
                   AIF   (N'&EVENT LE 1).ZE11A  CK NUM                  00278400
&ZMS               SETC  '"EVENT='                                      00278500
&ZMS               SETC  '&ZMS.&EVENT"'                                 00278600
&ZMS               SETC  '&ZMS "EVENT"'                                 00278700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00278800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00278900
.ZE11A             ANOP  ,                                              00279000
.*-------------------------------------------------------------------   00279100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00279200
                   AIF   (K'&EVENT(1) LE 0).ZE11B NO PRM                00279300
&ZXEVENT           SETC  'INPUT'     SET IN/OUTPUT                      00279400
&XEVENT            SETC  '&EVENT(1)'            SET XVARIABLE           00279500
                   AIF   (N'&EVENT GT 1).ZE11B                          00279600
.*                 ANOP                                                 00279700
&XEVENT            SETC  '&EVENT'    SET XVARIABLE                      00279800
.ZE11B             ANOP  ,                                              00279900
.*-------------------------------------------------------------------   00280000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00280100
                   AIF   (K'&ZXEVENT LE 0).ZE11R  NOT I/O               00280200
                   AIF   ('&XEVENT'(1,1) NE '(').ZE11R                  00280300
&ZCGPR             SETC  '&XEVENT'(2,K'&XEVENT-2)                       00280400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE11P                   00280500
                   AIF   (K'&ZCGPR GT 2).ZE11Q                          00280600
                   AIF   ('&ZCGPR' EQ '0').ZE11Q                        00280700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00280800
                   AIF   (T'&ZCGPR NE 'N').ZE11Q  INVALID REG NAME      00280900
.ZE11P             ANOP  ,                                              00281000
                   AIF   (T'&ZCGPR NE 'N').ZE11R  NON NUMERIC           00281100
                   AIF   ('&ZCGPR' LT '2').ZE11Q                        00281200
                   AIF   ('&ZCGPR' LE '12').ZE11R                       00281300
.ZE11Q             ANOP  ,                                              00281400
&ZMS               SETC  '"EVENT='                                      00281500
&ZMS               SETC  '&ZMS.&EVENT"'                                 00281600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00281700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00281800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00281900
.ZE11R             ANOP  ,                                              00282000
.*----------------------------------------------------------------***   00282100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00282200
                   AIF   (N'&TRCTIME LE 1).ZE13A  CK NUM                00282300
&ZMS               SETC  '"TRCTIME='                                    00282400
&ZMS               SETC  '&ZMS.&TRCTIME"'                               00282500
&ZMS               SETC  '&ZMS "TRCTIME"'                               00282600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00282700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00282800
.ZE13A             ANOP  ,                                              00282900
.*-------------------------------------------------------------------   00283000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00283100
                   AIF   (K'&TRCTIME(1) LE 0).ZE13B NO PRM              00283200
&ZXTRCTIME         SETC  'INPUT'     SET IN/OUTPUT                      00283300
&XTRCTIME          SETC  '&TRCTIME(1)'          SET XVARIABLE           00283400
                   AIF   (N'&TRCTIME GT 1).ZE13B                        00283500
.*                 ANOP                                                 00283600
&XTRCTIME          SETC  '&TRCTIME'  SET XVARIABLE                      00283700
.ZE13B             ANOP  ,                                              00283800
.*-------------------------------------------------------------------   00283900
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00284000
                   AIF   (K'&ZXTRCTIME LE 0).ZE13R  NOT I/O             00284100
                   AIF   ('&XTRCTIME'(1,1) NE '(').ZE13R                00284200
&ZCGPR             SETC  '&XTRCTIME'(2,K'&XTRCTIME-2)                   00284300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE13P                   00284400
                   AIF   (K'&ZCGPR GT 2).ZE13Q                          00284500
                   AIF   ('&ZCGPR' EQ '0').ZE13Q                        00284600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00284700
                   AIF   (T'&ZCGPR NE 'N').ZE13Q  INVALID REG NAME      00284800
.ZE13P             ANOP  ,                                              00284900
                   AIF   (T'&ZCGPR NE 'N').ZE13R  NON NUMERIC           00285000
                   AIF   ('&ZCGPR' LT '2').ZE13Q                        00285100
                   AIF   ('&ZCGPR' LE '12').ZE13R                       00285200
.ZE13Q             ANOP  ,                                              00285300
&ZMS               SETC  '"TRCTIME='                                    00285400
&ZMS               SETC  '&ZMS.&TRCTIME"'                               00285500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00285600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00285700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00285800
.ZE13R             ANOP  ,                                              00285900
.*----------------------------------------------------------------***   00286000
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00286100
                   AIF   (N'&SAMPLE LE 1).ZE17A  CK NUM                 00286200
&ZMS               SETC  '"SAMPLE='                                     00286300
&ZMS               SETC  '&ZMS.&SAMPLE"'                                00286400
&ZMS               SETC  '&ZMS "SAMPLE"'                                00286500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00286600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00286700
.ZE17A             ANOP  ,                                              00286800
.*-------------------------------------------------------------------   00286900
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00287000
.ZE18A   AIF   ('&SAMPLE(1)' NE 'NO').ZE19A                             00287100
&XSAMPLE           SETC  'NO'        SET KEYWORD                        00287200
.*-------------------------------------------------------------------   00287300
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00287400
.ZE19A   AIF   ('&SAMPLE(1)' NE 'YES').ZE20A                            00287500
&XSAMPLE           SETC  'YES'       SET KEYWORD                        00287600
.*-------------------------------------------------------------------   00287700
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00287800
.ZE20A             AIF   (K'&XSAMPLE GT 0).ZE20B                        00287900
                   AIF   (K'&SAMPLE(1) LE 0).ZE20C                      00288000
&ZMS               SETC  '"SAMPLE='                                     00288100
&ZMS               SETC  '&ZMS.&SAMPLE"'                                00288200
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00288300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00288400
&ZMS               SETC  '&ZMS "NO"'                                    00288500
&ZMS               SETC  '&ZMS OR "YES".'                               00288600
                   MNOTE 8,' &ZMS '                                     00288700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00288800
                   AGO   .ZE20C                                         00288900
.*                                                                      00289000
.ZE20B             ANOP  ,                                              00289100
&ZXSAMPLE          SETC  'INPUT'     SET IN/OUTPUT                      00289200
.ZE20C             ANOP  ,                                              00289300
.*----------------------------------------------------------------***   00289400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00289500
                   AIF   (N'&NAME LE 1).ZE22A   CK NUM                  00289600
&ZMS               SETC  '"NAME='                                       00289700
&ZMS               SETC  '&ZMS.&NAME"'                                  00289800
&ZMS               SETC  '&ZMS "NAME"'                                  00289900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00290000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00290100
.ZE22A             ANOP  ,                                              00290200
.*-------------------------------------------------------------------   00290300
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00290400
                   AIF   (K'&NAME(1) LE 0).ZE22B NO PRM                 00290500
&ZXNAME            SETC  'INPUT'     SET IN/OUTPUT                      00290600
&XNAME             SETC  '&NAME(1)'  SET XVARIABLE                      00290700
                   AIF   (N'&NAME GT 1).ZE22B                           00290800
.*                 ANOP                                                 00290900
&XNAME             SETC  '&NAME'     SET XVARIABLE                      00291000
.ZE22B             ANOP  ,                                              00291100
.*-------------------------------------------------------------------   00291200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00291300
                   AIF   (K'&ZXNAME LE 0).ZE22R  NOT I/O                00291400
                   AIF   ('&XNAME'(1,1) NE '(').ZE22R                   00291500
&ZCGPR             SETC  '&XNAME'(2,K'&XNAME-2)                         00291600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE22P                   00291700
                   AIF   (K'&ZCGPR GT 2).ZE22Q                          00291800
                   AIF   ('&ZCGPR' EQ '0').ZE22Q                        00291900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00292000
                   AIF   (T'&ZCGPR NE 'N').ZE22Q  INVALID REG NAME      00292100
.ZE22P             ANOP  ,                                              00292200
                   AIF   (T'&ZCGPR NE 'N').ZE22R  NON NUMERIC           00292300
                   AIF   ('&ZCGPR' LT '2').ZE22Q                        00292400
                   AIF   ('&ZCGPR' LE '12').ZE22R                       00292500
.ZE22Q             ANOP  ,                                              00292600
&ZMS               SETC  '"NAME='                                       00292700
&ZMS               SETC  '&ZMS.&NAME"'                                  00292800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00292900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00293000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00293100
.ZE22R             ANOP  ,                                              00293200
.*----------------------------------------------------------------***   00293300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00293400
                   AIF   (N'&EXITRTN LE 1).ZE25A  CK NUM                00293500
&ZMS               SETC  '"EXITRTN='                                    00293600
&ZMS               SETC  '&ZMS.&EXITRTN"'                               00293700
&ZMS               SETC  '&ZMS "EXITRTN"'                               00293800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00293900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00294000
.ZE25A             ANOP  ,                                              00294100
.*-------------------------------------------------------------------   00294200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00294300
                   AIF   (K'&EXITRTN(1) LE 0).ZE25B NO PRM              00294400
&ZXEXITRTN         SETC  'INPUT'     SET IN/OUTPUT                      00294500
&XEXITRTN          SETC  '&EXITRTN(1)'          SET XVARIABLE           00294600
                   AIF   (N'&EXITRTN GT 1).ZE25B                        00294700
.*                 ANOP                                                 00294800
&XEXITRTN          SETC  '&EXITRTN'  SET XVARIABLE                      00294900
.ZE25B             ANOP  ,                                              00295000
.*-------------------------------------------------------------------   00295100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00295200
                   AIF   (K'&ZXEXITRTN LE 0).ZE25R  NOT I/O             00295300
                   AIF   ('&XEXITRTN'(1,1) NE '(').ZE25R                00295400
&ZCGPR             SETC  '&XEXITRTN'(2,K'&XEXITRTN-2)                   00295500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE25P                   00295600
                   AIF   (K'&ZCGPR GT 2).ZE25Q                          00295700
                   AIF   ('&ZCGPR' EQ '0').ZE25Q                        00295800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00295900
                   AIF   (T'&ZCGPR NE 'N').ZE25Q  INVALID REG NAME      00296000
.ZE25P             ANOP  ,                                              00296100
                   AIF   (T'&ZCGPR NE 'N').ZE25R  NON NUMERIC           00296200
                   AIF   ('&ZCGPR' LT '2').ZE25Q                        00296300
                   AIF   ('&ZCGPR' LE '12').ZE25R                       00296400
.ZE25Q             ANOP  ,                                              00296500
&ZMS               SETC  '"EXITRTN='                                    00296600
&ZMS               SETC  '&ZMS.&EXITRTN"'                               00296700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00296800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00296900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00297000
.ZE25R             ANOP  ,                                              00297100
.*-------------------------------------------------------------------   00297200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00297300
&ZTLC              SETC 'STOP'                                          00297400
                   AIF   ('&ACTION(1)' NE '&ZTLC').ZE27A                00297500
&XACTION           SETC  'STOP'      SET KEYWORD                        00297600
                   AIF   (N'&ACTION LE 1).ZE27A  CK NUM                 00297700
&ZMS               SETC  '"ACTION='                                     00297800
&ZMS               SETC  '&ZMS.&ACTION"'                                00297900
&ZMS               SETC  '&ZMS "ACTION"'                                00298000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00298100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00298200
.ZE27A             ANOP  ,                                              00298300
.*----------------------------------------------------------------***   00298400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00298500
                   AIF   (N'&PROFILETKN LE 1).ZE29A  CK NUM             00298600
&ZMS               SETC  '"PROFILETKN='                                 00298700
&ZMS               SETC  '&ZMS.&PROFILETKN"'                            00298800
&ZMS               SETC  '&ZMS "PROFILETKN"'                            00298900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00299000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00299100
.ZE29A             ANOP  ,                                              00299200
.*-------------------------------------------------------------------   00299300
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00299400
                   AIF   (K'&PROFILETKN(1) LE 0).ZE29B NO PRM           00299500
&ZXPROFILETKN      SETC  'INPUT'     SET IN/OUTPUT                      00299600
&XPROFILETKN       SETC  '&PROFILETKN(1)'       SET XVARIABLE           00299700
                   AIF   (N'&PROFILETKN GT 1).ZE29B                     00299800
.*                 ANOP                                                 00299900
&XPROFILETKN       SETC  '&PROFILETKN'          SET XVARIABLE           00300000
.ZE29B             ANOP  ,                                              00300100
.*-------------------------------------------------------------------   00300200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00300300
                   AIF   (K'&ZXPROFILETKN LE 0).ZE29R  NOT I/O          00300400
                   AIF   ('&XPROFILETKN'(1,1) NE '(').ZE29R             00300500
&ZCGPR             SETC  '&XPROFILETKN'(2,K'&XPROFILETKN-2)             00300600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE29P                   00300700
                   AIF   (K'&ZCGPR GT 2).ZE29Q                          00300800
                   AIF   ('&ZCGPR' EQ '0').ZE29Q                        00300900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00301000
                   AIF   (T'&ZCGPR NE 'N').ZE29Q  INVALID REG NAME      00301100
.ZE29P             ANOP  ,                                              00301200
                   AIF   (T'&ZCGPR NE 'N').ZE29R  NON NUMERIC           00301300
                   AIF   ('&ZCGPR' LT '2').ZE29Q                        00301400
                   AIF   ('&ZCGPR' LE '12').ZE29R                       00301500
.ZE29Q             ANOP  ,                                              00301600
&ZMS               SETC  '"PROFILETKN='                                 00301700
&ZMS               SETC  '&ZMS.&PROFILETKN"'                            00301800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00301900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00302000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00302100
.ZE29R             ANOP  ,                                              00302200
.*------------------------------------------------------------------    00302300
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00302400
.ZE31              AIF   (K'&XACTION GT 0).ZE31A                        00302500
                   AIF   (K'&ACTION(1) LE 0).ZE31B                      00302600
&ZMS               SETC  '"ACTION='                                     00302700
&ZMS               SETC  '&ZMS.&ACTION"'                                00302800
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00302900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00303000
&ZMS               SETC  '&ZMS "START"'                                 00303100
&ZMS               SETC  '&ZMS OR "STOP".'                              00303200
                   MNOTE 8,' &ZMS '                                     00303300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00303400
                   AGO   .ZE31B                                         00303500
.*                                                                      00303600
.ZE31A             ANOP  ,                                              00303700
&ZXACTION          SETC  'INPUT'     SET IN/OUTPUT                      00303800
.ZE31B             ANOP  ,                                              00303900
.*-------------------------------------------------------------------   00304000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00304100
&ZTLC              SETC 'QUERY'                                         00304200
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZE32A               00304300
&XREQUEST          SETC  'QUERY'     SET KEYWORD                        00304400
                   AIF   (N'&REQUEST LE 1).ZE32A  CK NUM                00304500
&ZMS               SETC  '"REQUEST='                                    00304600
&ZMS               SETC  '&ZMS.&REQUEST"'                               00304700
&ZMS               SETC  '&ZMS "REQUEST"'                               00304800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00304900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00305000
.ZE32A             ANOP  ,                                              00305100
.*----------------------------------------------------------------***   00305200
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00305300
                   AIF   (N'&ANSAREA LE 1).ZE34A  CK NUM                00305400
&ZMS               SETC  '"ANSAREA='                                    00305500
&ZMS               SETC  '&ZMS.&ANSAREA"'                               00305600
&ZMS               SETC  '&ZMS "ANSAREA"'                               00305700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00305800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00305900
.ZE34A             ANOP  ,                                              00306000
.*-------------------------------------------------------------------   00306100
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00306200
                   AIF   (K'&ANSAREA(1) LE 0).ZE34B NO PRM              00306300
&ZXANSAREA         SETC  'INPUT'     SET IN/OUTPUT                      00306400
&XANSAREA          SETC  '&ANSAREA(1)'          SET XVARIABLE           00306500
                   AIF   (N'&ANSAREA GT 1).ZE34B                        00306600
.*                 ANOP                                                 00306700
&XANSAREA          SETC  '&ANSAREA'  SET XVARIABLE                      00306800
.ZE34B             ANOP  ,                                              00306900
.*-------------------------------------------------------------------   00307000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00307100
                   AIF   (K'&ZXANSAREA LE 0).ZE34R  NOT I/O             00307200
                   AIF   ('&XANSAREA'(1,1) NE '(').ZE34R                00307300
&ZCGPR             SETC  '&XANSAREA'(2,K'&XANSAREA-2)                   00307400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE34P                   00307500
                   AIF   (K'&ZCGPR GT 2).ZE34Q                          00307600
                   AIF   ('&ZCGPR' EQ '0').ZE34Q                        00307700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00307800
                   AIF   (T'&ZCGPR NE 'N').ZE34Q  INVALID REG NAME      00307900
.ZE34P             ANOP  ,                                              00308000
                   AIF   (T'&ZCGPR NE 'N').ZE34R  NON NUMERIC           00308100
                   AIF   ('&ZCGPR' LT '2').ZE34Q                        00308200
                   AIF   ('&ZCGPR' LE '12').ZE34R                       00308300
.ZE34Q             ANOP  ,                                              00308400
&ZMS               SETC  '"ANSAREA='                                    00308500
&ZMS               SETC  '&ZMS.&ANSAREA"'                               00308600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00308700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00308800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00308900
.ZE34R             ANOP  ,                                              00309000
.*----------------------------------------------------------------***   00309100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00309200
                   AIF   (N'&ANSLEN LE 1).ZE37A  CK NUM                 00309300
&ZMS               SETC  '"ANSLEN='                                     00309400
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00309500
&ZMS               SETC  '&ZMS "ANSLEN"'                                00309600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00309700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00309800
.ZE37A             ANOP  ,                                              00309900
.*-------------------------------------------------------------------   00310000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00310100
                   AIF   (K'&ANSLEN(1) LE 0).ZE37B NO PRM               00310200
&ZXANSLEN          SETC  'INPUT'     SET IN/OUTPUT                      00310300
&XANSLEN           SETC  '&ANSLEN(1)'           SET XVARIABLE           00310400
                   AIF   (N'&ANSLEN GT 1).ZE37B                         00310500
.*                 ANOP                                                 00310600
&XANSLEN           SETC  '&ANSLEN'   SET XVARIABLE                      00310700
.ZE37B             ANOP  ,                                              00310800
.*-------------------------------------------------------------------   00310900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00311000
                   AIF   (K'&ZXANSLEN LE 0).ZE37R  NOT I/O              00311100
                   AIF   ('&XANSLEN'(1,1) NE '(').ZE37R                 00311200
&ZCGPR             SETC  '&XANSLEN'(2,K'&XANSLEN-2)                     00311300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE37P                   00311400
                   AIF   (K'&ZCGPR GT 2).ZE37Q                          00311500
                   AIF   ('&ZCGPR' EQ '0').ZE37Q                        00311600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00311700
                   AIF   (T'&ZCGPR NE 'N').ZE37Q  INVALID REG NAME      00311800
.ZE37P             ANOP  ,                                              00311900
                   AIF   (T'&ZCGPR NE 'N').ZE37R  NON NUMERIC           00312000
                   AIF   ('&ZCGPR' LT '2').ZE37Q                        00312100
                   AIF   ('&ZCGPR' LE '12').ZE37R                       00312200
.ZE37Q             ANOP  ,                                              00312300
&ZMS               SETC  '"ANSLEN='                                     00312400
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00312500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00312600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00312700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00312800
.ZE37R             ANOP  ,                                              00312900
.*-------------------------------------------------------------------   00313000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00313100
&ZTLC              SETC 'EVENTDATA'                                     00313200
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZE41A                  00313300
&XTYPE             SETC  'EVENTDATA'            SET KEYWORD             00313400
                   AIF   (N'&TYPE LE 1).ZE41A   CK NUM                  00313500
&ZMS               SETC  '"TYPE='                                       00313600
&ZMS               SETC  '&ZMS.&TYPE"'                                  00313700
&ZMS               SETC  '&ZMS "TYPE"'                                  00313800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00313900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00314000
.ZE41A             ANOP  ,                                              00314100
.*----------------------------------------------------------------***   00314200
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00314300
                   AIF   (N'&PROFILETKN LE 1).ZE43A  CK NUM             00314400
&ZMS               SETC  '"PROFILETKN='                                 00314500
&ZMS               SETC  '&ZMS.&PROFILETKN"'                            00314600
&ZMS               SETC  '&ZMS "PROFILETKN"'                            00314700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00314800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00314900
.ZE43A             ANOP  ,                                              00315000
.*-------------------------------------------------------------------   00315100
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00315200
                   AIF   (K'&PROFILETKN(1) LE 0).ZE43B NO PRM           00315300
&ZXPROFILETKN      SETC  'INPUT'     SET IN/OUTPUT                      00315400
&XPROFILETKN       SETC  '&PROFILETKN(1)'       SET XVARIABLE           00315500
                   AIF   (N'&PROFILETKN GT 1).ZE43B                     00315600
.*                 ANOP                                                 00315700
&XPROFILETKN       SETC  '&PROFILETKN'          SET XVARIABLE           00315800
.ZE43B             ANOP  ,                                              00315900
.*-------------------------------------------------------------------   00316000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00316100
                   AIF   (K'&ZXPROFILETKN LE 0).ZE43R  NOT I/O          00316200
                   AIF   ('&XPROFILETKN'(1,1) NE '(').ZE43R             00316300
&ZCGPR             SETC  '&XPROFILETKN'(2,K'&XPROFILETKN-2)             00316400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE43P                   00316500
                   AIF   (K'&ZCGPR GT 2).ZE43Q                          00316600
                   AIF   ('&ZCGPR' EQ '0').ZE43Q                        00316700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00316800
                   AIF   (T'&ZCGPR NE 'N').ZE43Q  INVALID REG NAME      00316900
.ZE43P             ANOP  ,                                              00317000
                   AIF   (T'&ZCGPR NE 'N').ZE43R  NON NUMERIC           00317100
                   AIF   ('&ZCGPR' LT '2').ZE43Q                        00317200
                   AIF   ('&ZCGPR' LE '12').ZE43R                       00317300
.ZE43Q             ANOP  ,                                              00317400
&ZMS               SETC  '"PROFILETKN='                                 00317500
&ZMS               SETC  '&ZMS.&PROFILETKN"'                            00317600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00317700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00317800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00317900
.ZE43R             ANOP  ,                                              00318000
.*----------------------------------------------------------------***   00318100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00318200
                   AIF   (N'&CPUMASK LE 1).ZE46A  CK NUM                00318300
&ZMS               SETC  '"CPUMASK='                                    00318400
&ZMS               SETC  '&ZMS.&CPUMASK"'                               00318500
&ZMS               SETC  '&ZMS "CPUMASK"'                               00318600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00318700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00318800
.ZE46A             ANOP  ,                                              00318900
.*-------------------------------------------------------------------   00319000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00319100
                   AIF   (K'&CPUMASK(1) LE 0).ZE46B NO PRM              00319200
&ZXCPUMASK         SETC  'INPUT'     SET IN/OUTPUT                      00319300
&XCPUMASK          SETC  '&CPUMASK(1)'          SET XVARIABLE           00319400
                   AIF   (N'&CPUMASK GT 1).ZE46B                        00319500
.*                 ANOP                                                 00319600
&XCPUMASK          SETC  '&CPUMASK'  SET XVARIABLE                      00319700
.ZE46B             ANOP  ,                                              00319800
.*-------------------------------------------------------------------   00319900
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00320000
                   AIF   (K'&ZXCPUMASK LE 0).ZE46R  NOT I/O             00320100
                   AIF   ('&XCPUMASK'(1,1) NE '(').ZE46R                00320200
&ZCGPR             SETC  '&XCPUMASK'(2,K'&XCPUMASK-2)                   00320300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE46P                   00320400
                   AIF   (K'&ZCGPR GT 2).ZE46Q                          00320500
                   AIF   ('&ZCGPR' EQ '0').ZE46Q                        00320600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00320700
                   AIF   (T'&ZCGPR NE 'N').ZE46Q  INVALID REG NAME      00320800
.ZE46P             ANOP  ,                                              00320900
                   AIF   (T'&ZCGPR NE 'N').ZE46R  NON NUMERIC           00321000
                   AIF   ('&ZCGPR' LT '2').ZE46Q                        00321100
                   AIF   ('&ZCGPR' LE '12').ZE46R                       00321200
.ZE46Q             ANOP  ,                                              00321300
&ZMS               SETC  '"CPUMASK='                                    00321400
&ZMS               SETC  '&ZMS.&CPUMASK"'                               00321500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00321600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00321700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00321800
.ZE46R             ANOP  ,                                              00321900
.*-------------------------------------------------------------------   00322000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00322100
&ZTLC              SETC 'EVENT'                                         00322200
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZE48A                  00322300
&XTYPE             SETC  'EVENT'     SET KEYWORD                        00322400
                   AIF   (N'&TYPE LE 1).ZE48A   CK NUM                  00322500
&ZMS               SETC  '"TYPE='                                       00322600
&ZMS               SETC  '&ZMS.&TYPE"'                                  00322700
&ZMS               SETC  '&ZMS "TYPE"'                                  00322800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00322900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00323000
.ZE48A             ANOP  ,                                              00323100
.*-------------------------------------------------------------------   00323200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00323300
&ZTLC              SETC 'SAMPLE'                                        00323400
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZE49A                  00323500
&XTYPE             SETC  'SAMPLE'    SET KEYWORD                        00323600
                   AIF   (N'&TYPE LE 1).ZE49A   CK NUM                  00323700
&ZMS               SETC  '"TYPE='                                       00323800
&ZMS               SETC  '&ZMS.&TYPE"'                                  00323900
&ZMS               SETC  '&ZMS "TYPE"'                                  00324000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00324100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00324200
.ZE49A             ANOP  ,                                              00324300
.*-------------------------------------------------------------------   00324400
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00324500
&ZTLC              SETC 'PROFILERS'                                     00324600
                   AIF   ('&TYPE(1)' NE '&ZTLC').ZE50A                  00324700
&XTYPE             SETC  'PROFILERS'            SET KEYWORD             00324800
                   AIF   (N'&TYPE LE 1).ZE50A   CK NUM                  00324900
&ZMS               SETC  '"TYPE='                                       00325000
&ZMS               SETC  '&ZMS.&TYPE"'                                  00325100
&ZMS               SETC  '&ZMS "TYPE"'                                  00325200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00325300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00325400
.ZE50A             ANOP  ,                                              00325500
.*------------------------------------------------------------------    00325600
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00325700
.ZE51              AIF   (K'&XTYPE GT 0).ZE51A                          00325800
                   AIF   (K'&TYPE(1) LE 0).ZE51B                        00325900
&ZMS               SETC  '"TYPE='                                       00326000
&ZMS               SETC  '&ZMS.&TYPE"'                                  00326100
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00326200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00326300
&ZMS               SETC  '&ZMS "EVENTDATA",'                            00326400
&ZMS               SETC  '&ZMS "EVENT",'                                00326500
&ZMS               SETC  '&ZMS "SAMPLE",'                               00326600
&ZMS               SETC  '&ZMS OR "PROFILERS".'                         00326700
                   MNOTE 8,' &ZMS '                                     00326800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00326900
                   AGO   .ZE51B                                         00327000
.*                                                                      00327100
.ZE51A             ANOP  ,                                              00327200
&ZXTYPE            SETC  'INPUT'     SET IN/OUTPUT                      00327300
.ZE51B             ANOP  ,                                              00327400
.*------------------------------------------------------------------    00327500
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00327600
.ZE52              AIF   (K'&XREQUEST GT 0).ZE52A                       00327700
                   AIF   (K'&REQUEST(1) LE 0).ZE52B                     00327800
&ZMS               SETC  '"REQUEST='                                    00327900
&ZMS               SETC  '&ZMS.&REQUEST"'                               00328000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00328100
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00328200
&ZMS               SETC  '&ZMS "PROFILE"'                               00328300
&ZMS               SETC  '&ZMS OR "QUERY".'                             00328400
                   MNOTE 8,' &ZMS '                                     00328500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00328600
                   AGO   .ZE52B                                         00328700
.*                                                                      00328800
.ZE52A             ANOP  ,                                              00328900
&ZXREQUEST         SETC  'INPUT'     SET IN/OUTPUT                      00329000
.ZE52B             ANOP  ,                                              00329100
.*----------------------------------------------------------------***   00329200
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00329300
                   AIF   (N'&RETCODE LE 1).ZE54A  CK NUM                00329400
&ZMS               SETC  '"RETCODE='                                    00329500
&ZMS               SETC  '&ZMS.&RETCODE"'                               00329600
&ZMS               SETC  '&ZMS "RETCODE"'                               00329700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00329800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00329900
.ZE54A             ANOP  ,                                              00330000
.*-------------------------------------------------------------------   00330100
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00330200
                   AIF   (K'&RETCODE(1) LE 0).ZE54B NO PRM              00330300
&ZXRETCODE         SETC  'OUTPUT'    SET IN/OUTPUT                      00330400
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00330500
                   AIF   (N'&RETCODE GT 1).ZE54B                        00330600
.*                 ANOP                                                 00330700
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00330800
.ZE54B             ANOP  ,                                              00330900
.*-------------------------------------------------------------------   00331000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00331100
                   AIF   (K'&ZXRETCODE LE 0).ZE54R  NOT I/O             00331200
                   AIF   ('&XRETCODE'(1,1) NE '(').ZE54R                00331300
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00331400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE54P                   00331500
                   AIF   (K'&ZCGPR GT 2).ZE54Q                          00331600
                   AIF   ('&ZCGPR' EQ '0').ZE54Q                        00331700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00331800
                   AIF   (T'&ZCGPR NE 'N').ZE54Q  INVALID REG NAME      00331900
.ZE54P             ANOP  ,                                              00332000
                   AIF   (T'&ZCGPR NE 'N').ZE54R  NON NUMERIC           00332100
                   AIF   ('&ZCGPR' LT '2').ZE54Q                        00332200
                   AIF   ('&ZCGPR' LE '12').ZE54R                       00332300
.ZE54Q             ANOP  ,                                              00332400
&ZMS               SETC  '"RETCODE='                                    00332500
&ZMS               SETC  '&ZMS.&RETCODE"'                               00332600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00332700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00332800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00332900
.ZE54R             ANOP  ,                                              00333000
.*----------------------------------------------------------------***   00333100
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00333200
                   AIF   (N'&RSNCODE LE 1).ZE57A  CK NUM                00333300
&ZMS               SETC  '"RSNCODE='                                    00333400
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00333500
&ZMS               SETC  '&ZMS "RSNCODE"'                               00333600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00333700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00333800
.ZE57A             ANOP  ,                                              00333900
.*-------------------------------------------------------------------   00334000
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00334100
                   AIF   (K'&RSNCODE(1) LE 0).ZE57B NO PRM              00334200
&ZXRSNCODE         SETC  'OUTPUT'    SET IN/OUTPUT                      00334300
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00334400
                   AIF   (N'&RSNCODE GT 1).ZE57B                        00334500
.*                 ANOP                                                 00334600
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00334700
.ZE57B             ANOP  ,                                              00334800
.*-------------------------------------------------------------------   00334900
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00335000
                   AIF   (K'&ZXRSNCODE LE 0).ZE57R  NOT I/O             00335100
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZE57R                00335200
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00335300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE57P                   00335400
                   AIF   (K'&ZCGPR GT 2).ZE57Q                          00335500
                   AIF   ('&ZCGPR' EQ '0').ZE57Q                        00335600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00335700
                   AIF   (T'&ZCGPR NE 'N').ZE57Q  INVALID REG NAME      00335800
.ZE57P             ANOP  ,                                              00335900
                   AIF   (T'&ZCGPR NE 'N').ZE57R  NON NUMERIC           00336000
                   AIF   ('&ZCGPR' LT '2').ZE57Q                        00336100
                   AIF   ('&ZCGPR' LE '12').ZE57R                       00336200
.ZE57Q             ANOP  ,                                              00336300
&ZMS               SETC  '"RSNCODE='                                    00336400
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00336500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00336600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00336700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00336800
.ZE57R             ANOP  ,                                              00336900
.******************************************************************     00337000
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00337100
.******************************************************************     00337200
                   ACTR  10000                                          00337300
.*----------------------------------------------------------------***   00337400
.***AF.P02 EXTRA POSITIONALS                                            00337500
                   AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS           00337600
&ZCVAL             SETC  ''          ERROR FIELD                        00337700
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00337800
.ZELIST2           ANOP  ,                                              00337900
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00338000
                   AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE           00338100
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00338200
                   AGO   .ZELIST2                                       00338300
.*                                                                      00338400
.ZELIST3           ANOP  ,                                              00338500
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00338600
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00338700
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00338800
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00338900
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00339000
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00339100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00339200
.ZELISTX           ANOP  ,                                              00339300
&ZASYSLNDX         SETA  0                                              00339400
.*-------------------------------------------------------------------   00339500
.***AE.MF02 MF=(SLME)                                                   00339600
.ZEMFX             ANOP  ,           END OF PARTIAL SYNTAX CHECK        00339700
.*******************************************************************    00339800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00339900
.*******************************************************************    00340000
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00340100
.*******************************************************************    00340200
.***AE.01  START OF HISSERV MACRO CODE                                  00340300
.*******************************************************************    00340400
                   LCLC  &M0M0001                 NAME                  00340500
&M0M0001           SETC  '&XLABEL'                SET NAME              00340600
                   AIF   (K'&XLABEL NE 0).XLAB2                         00340700
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00340800
.*                                                                      00340900
.XLAB2             ANOP  ,                                              00341000
                   AIF   ('&XMF' EQ 'L').XLAB3                          00341100
&M0M0001 DS    0H                             HISSERV-0                 00341200
.XLAB3             ANOP  ,                                              00341300
.*******************************************************************    00341400
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00341500
.*******************************************************************    00341600
              PUSH  PRINT                                               00341700
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00341800
                   PRINT OFF         ++ PR01                            00341900
                   AGO   .ZPRNTXX                                       00342000
.ZPRINTX           PRINT ON                                             00342100
.ZPRNTXX           ANOP  ,                                              00342200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00342300
         AIF   ('&XMF' NE 'M').NOTM                                     00342400
&ZMS     SETC  'MF=M MAY NOT BE SPECIFIED'                              00342500
         MNOTE 8,'&ZMS'                                                 00342600
         POP   PRINT                                                    00342700
         MEXIT                                                          00342800
.NOTM ANOP                                                              00342900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00343000
.********************************************************************   00343100
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00343200
.********************************************************************   00343300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00343400
                      LCLA  &ZOPN1         INVOCATION INDEX             00343500
                      LCLC  &ZOPL(4095)    LABEL                        00343600
                      LCLC  &ZOPO(4095)    OPERATION                    00343700
                      LCLC  &ZOPV(4095)    VALUE                        00343800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00343900
.*                                                                      00344000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00344100
.******************************************************************     00344200
.***AL.L10 HISSERV FMT=LIST MF=S!L PARAMETERS                           00344300
.******************************************************************     00344400
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00344500
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00344600
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00344700
&XMFATTR              SETC  '0D'                                        00344800
.*                                                                      00344900
&ZOPN                 SETA  &ZOPN+1                                     00345000
&ZOPL(&ZOPN)          SETC  ' '                                         00345100
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00345200
&ZOPV(&ZOPN)          SETC  '4,8'                                       00345300
&ZOPN                 SETA  &ZOPN+1                                     00345400
&ZOPL(&ZOPN)          SETC  ' '                                         00345500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00345600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00345700
&ZOPD(&ZOPN)          SETC  '++ HISSERV ARG PARMS'                      00345800
.*                                                                      00345900
&ZOPN                 SETA  &ZOPN+1                                     00346000
&ZOPL(&ZOPN)          SETC  ' '                                         00346100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00346200
&ZOPV(&ZOPN)          SETC  '1'                                         00346300
&ZOPD(&ZOPN)          SETC  ' '                                         00346400
.*                                                                      00346500
.ZLMFSL2              ANOP  ,                                           00346600
.*-------------------------------------------------------------------   00346700
.***AM.L00  HISSERV FMT=LIST name                                       00346800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00346900
&ZOPN                 SETA &ZOPN+1                                      00347000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00347100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00347200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00347300
&ZOPD(&ZOPN)          SETC '++ HISSERV NAME'                            00347400
.ZLMFSL2M             ANOP  ,                                           00347500
.*-------------------------------------------------------------------   00347600
.***AM.L01  HISSERV FMT=LIST PARAMETERS                                 00347700
&ZOPN                 SETA &ZOPN+1                                      00347800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00347900
&ZOPO(&ZOPN)          SETC 'DS'                                         00348000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00348100
&ZOPD(&ZOPN)          SETC '++ HISSERV PARM LIST'                       00348200
.*-------------------------------------------------------------------   00348300
.***AM.L09  XEYE CL4                                                    00348400
&ZOPN                 SETA &ZOPN+1                                      00348500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEYE'                             00348600
&ZOPO(&ZOPN)          SETC 'DS'                                         00348700
&ZOPV(&ZOPN)          SETC 'CL4'                                        00348800
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00348900
.*-------------------------------------------------------------------   00349000
.***AM.L02 XVERSION XL1                                                 00349100
&ZOPN                 SETA &ZOPN+1                                      00349200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00349300
&ZOPO(&ZOPN)          SETC 'DS'                                         00349400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00349500
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00349600
.*-------------------------------------------------------------------   00349700
.***AM.L09  XPLISTLEN XL2                                               00349800
&ZOPN                 SETA &ZOPN+1                                      00349900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00350000
&ZOPO(&ZOPN)          SETC 'DS'                                         00350100
&ZOPV(&ZOPN)          SETC 'XL2'                                        00350200
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00350300
.*-------------------------------------------------------------------   00350400
.***AM.L05 XREQUEST XL1                                                 00350500
&ZOPN                 SETA &ZOPN+1                                      00350600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00350700
&ZOPO(&ZOPN)          SETC 'DS'                                         00350800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00350900
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00351000
.*                                                                      00351100
&ZOPN                 SETA  &ZOPN+1                                     00351200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_PROFILE'                00351300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00351400
&ZOPV(&ZOPN)          SETC  '1'                                         00351500
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00351600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PROFILE'                      00351700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00351800
.*                                                                      00351900
&ZOPN                 SETA  &ZOPN+1                                     00352000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_QUERY'                  00352100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00352200
&ZOPV(&ZOPN)          SETC  '2'                                         00352300
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00352400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).QUERY'                        00352500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00352600
.*-------------------------------------------------------------------   00352700
.***AM.L09  XPROFILETKN CL16                                            00352800
&ZOPN                 SETA &ZOPN+1                                      00352900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPROFILETKN'                      00353000
&ZOPO(&ZOPN)          SETC 'DS'                                         00353100
&ZOPV(&ZOPN)          SETC 'CL16'                                       00353200
&ZOPD(&ZOPN)          SETC '++ &ZXPROFILETKN '                          00353300
.*-------------------------------------------------------------------   00353400
.***AM.L09  XUNIQUE CL64                                                00353500
&ZOPN                 SETA &ZOPN+1                                      00353600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUNIQUE'                          00353700
&ZOPO(&ZOPN)          SETC 'DS'                                         00353800
&ZOPV(&ZOPN)          SETC 'CL64'                                       00353900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00354000
.*-------------------------------------------------------------------   00354100
.***AM.L09  XRSV0058 CL24                                               00354200
&ZOPN                 SETA &ZOPN+1                                      00354300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0058'                         00354400
&ZOPO(&ZOPN)          SETC 'DS'                                         00354500
&ZOPV(&ZOPN)          SETC 'CL24'                                       00354600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00354700
.*-------------------------------------------------------------------   00354800
.***AM.MLM1 SAVED LOCATION COUNTER                                      00354900
                      AIF  ('&ZENDBASEPL' NE '').ZL10LB                 00355000
&ZENDBASEPL           SETC 'YES'                                        00355100
&ZOPN                 SETA &ZOPN+1                                      00355200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00355300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00355400
&ZOPV(&ZOPN)          SETC '*'                                          00355500
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00355600
.ZL10LB               ANOP  ,                                           00355700
.*-------------------------------------------------------------------   00355800
.***AM.PJR1 DEFINED ON XUNIQUE                                          00355900
&ZOPN                 SETA &ZOPN+1                                      00356000
&ZOPL(&ZOPN)          SETC ' '                                          00356100
&ZOPO(&ZOPN)          SETC 'ORG'                                        00356200
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+24'                               00356300
&ZOPD(&ZOPN)          SETC ' '                                          00356400
.*-------------------------------------------------------------------   00356500
.***AM.L05 XACTION XL1                                                  00356600
&ZOPN                 SETA &ZOPN+1                                      00356700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACTION'                          00356800
&ZOPO(&ZOPN)          SETC 'DS'                                         00356900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00357000
&ZOPD(&ZOPN)          SETC '++ &ZXACTION XACTION'                       00357100
.*                                                                      00357200
&ZOPN                 SETA  &ZOPN+1                                     00357300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XACTION_START'                   00357400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00357500
&ZOPV(&ZOPN)          SETC  '1'                                         00357600
&ZOPD(&ZOPN)          SETC  '++ XACTION.'                               00357700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).START'                        00357800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00357900
.*                                                                      00358000
&ZOPN                 SETA  &ZOPN+1                                     00358100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XACTION_STOP'                    00358200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00358300
&ZOPV(&ZOPN)          SETC  '2'                                         00358400
&ZOPD(&ZOPN)          SETC  '++ XACTION.'                               00358500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).STOP'                         00358600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00358700
.*-------------------------------------------------------------------   00358800
.***AM.L03 XFLAGS BL.8                                                  00358900
&ZOPN                 SETA &ZOPN+1                                      00359000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00359100
&ZOPO(&ZOPN)          SETC 'DS'                                         00359200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00359300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00359400
.*                                                                      00359500
&ZOPN                 SETA  &ZOPN+1                                     00359600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSAMPLE_YES'                     00359700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00359800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00359900
&ZOPD(&ZOPN)          SETC  '++ XSAMPLE.'                               00360000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00360100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00360200
.*-------------------------------------------------------------------   00360300
.***AM.L09  XRSV001A CL2                                                00360400
&ZOPN                 SETA &ZOPN+1                                      00360500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV001A'                         00360600
&ZOPO(&ZOPN)          SETC 'DS'                                         00360700
&ZOPV(&ZOPN)          SETC 'CL2'                                        00360800
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00360900
.*-------------------------------------------------------------------   00361000
.***AM.L09  XNAME CL8                                                   00361100
&ZOPN                 SETA &ZOPN+1                                      00361200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNAME'                            00361300
&ZOPO(&ZOPN)          SETC 'DS'                                         00361400
&ZOPV(&ZOPN)          SETC 'CL8'                                        00361500
&ZOPD(&ZOPN)          SETC '++ &ZXNAME '                                00361600
.*-------------------------------------------------------------------   00361700
.***AM.L09  XEXITRTN CL8                                                00361800
&ZOPN                 SETA &ZOPN+1                                      00361900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEXITRTN'                         00362000
&ZOPO(&ZOPN)          SETC 'DS'                                         00362100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00362200
&ZOPD(&ZOPN)          SETC '++ &ZXEXITRTN '                             00362300
.*-------------------------------------------------------------------   00362400
.***AM.L09  XEVENT BL.32                                                00362500
&ZOPN                 SETA &ZOPN+1                                      00362600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEVENT'                           00362700
&ZOPO(&ZOPN)          SETC 'DS'                                         00362800
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00362900
&ZOPD(&ZOPN)          SETC '++ &ZXEVENT '                               00363000
.*-------------------------------------------------------------------   00363100
.***AM.L09  XOUTPROFILETKN CL16                                         00363200
&ZOPN                 SETA &ZOPN+1                                      00363300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTPROFILETKN'                   00363400
&ZOPO(&ZOPN)          SETC 'DS'                                         00363500
&ZOPV(&ZOPN)          SETC 'CL16'                                       00363600
&ZOPD(&ZOPN)          SETC '++ &ZXOUTPROFILETKN '                       00363700
.*-------------------------------------------------------------------   00363800
.***AM.L09  XTRCTIME CL8                                                00363900
&ZOPN                 SETA &ZOPN+1                                      00364000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTRCTIME'                         00364100
&ZOPO(&ZOPN)          SETC 'DS'                                         00364200
&ZOPV(&ZOPN)          SETC 'CL8'                                        00364300
&ZOPD(&ZOPN)          SETC '++ &ZXTRCTIME '                             00364400
.*-------------------------------------------------------------------   00364500
.***AM.L09  XRSV0048 CL16                                               00364600
&ZOPN                 SETA &ZOPN+1                                      00364700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0048'                         00364800
&ZOPO(&ZOPN)          SETC 'DS'                                         00364900
&ZOPV(&ZOPN)          SETC 'CL16'                                       00365000
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00365100
.*-------------------------------------------------------------------   00365200
.***AM.PJR1 DEFINED ON XUNIQUE                                          00365300
&ZOPN                 SETA &ZOPN+1                                      00365400
&ZOPL(&ZOPN)          SETC ' '                                          00365500
&ZOPO(&ZOPN)          SETC 'ORG'                                        00365600
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+24'                               00365700
&ZOPD(&ZOPN)          SETC ' '                                          00365800
.*-------------------------------------------------------------------   00365900
.***AM.L09 ADDR3164 XANSAREA AD                                         00366000
&ZOPN                 SETA &ZOPN+1                                      00366100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ADDR3164'                00366200
&ZOPO(&ZOPN)          SETC 'DS'                                         00366300
&ZOPV(&ZOPN)          SETC 'AD'                                         00366400
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ADDR3164'                     00366500
.*-------------------------------------------------------------------   00366600
.***AM.L09  XANSLEN D                                                   00366700
&ZOPN                 SETA &ZOPN+1                                      00366800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00366900
&ZOPO(&ZOPN)          SETC 'DS'                                         00367000
&ZOPV(&ZOPN)          SETC 'D'                                          00367100
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN '                              00367200
.*-------------------------------------------------------------------   00367300
.***AM.L09 ALET XANSAREA F                                              00367400
&ZOPN                 SETA &ZOPN+1                                      00367500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ALET'                    00367600
&ZOPO(&ZOPN)          SETC 'DS'                                         00367700
&ZOPV(&ZOPN)          SETC 'F'                                          00367800
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ALET'                         00367900
.*-------------------------------------------------------------------   00368000
.***AM.L05 XTYPE XL1                                                    00368100
&ZOPN                 SETA &ZOPN+1                                      00368200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTYPE'                            00368300
&ZOPO(&ZOPN)          SETC 'DS'                                         00368400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00368500
&ZOPD(&ZOPN)          SETC '++ &ZXTYPE XTYPE'                           00368600
.*                                                                      00368700
&ZOPN                 SETA  &ZOPN+1                                     00368800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_PROFILERS'                 00368900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00369000
&ZOPV(&ZOPN)          SETC  '1'                                         00369100
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 00369200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PROFILERS'                    00369300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00369400
.*                                                                      00369500
&ZOPN                 SETA  &ZOPN+1                                     00369600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_SAMPLE'                    00369700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00369800
&ZOPV(&ZOPN)          SETC  '2'                                         00369900
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 00370000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SAMPLE'                       00370100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00370200
.*                                                                      00370300
&ZOPN                 SETA  &ZOPN+1                                     00370400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_EVENT'                     00370500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00370600
&ZOPV(&ZOPN)          SETC  '3'                                         00370700
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 00370800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EVENT'                        00370900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00371000
.*                                                                      00371100
&ZOPN                 SETA  &ZOPN+1                                     00371200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_EVENTDATA'                 00371300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00371400
&ZOPV(&ZOPN)          SETC  '4'                                         00371500
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 00371600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EVENTDATA'                    00371700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00371800
.*-------------------------------------------------------------------   00371900
.***AM.L09  XRSV0035 CL3                                                00372000
&ZOPN                 SETA &ZOPN+1                                      00372100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0035'                         00372200
&ZOPO(&ZOPN)          SETC 'DS'                                         00372300
&ZOPV(&ZOPN)          SETC 'CL3'                                        00372400
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00372500
.*-------------------------------------------------------------------   00372600
.***AM.L09  XUNIQUE_QUERY CL24                                          00372700
&ZOPN                 SETA &ZOPN+1                                      00372800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUNIQUE_QUERY'                    00372900
&ZOPO(&ZOPN)          SETC 'DS'                                         00373000
&ZOPV(&ZOPN)          SETC 'CL24'                                       00373100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00373200
.*-------------------------------------------------------------------   00373300
.***AM.PJR1 DEFINED ON XUNIQUE_QUERY                                    00373400
&ZOPN                 SETA &ZOPN+1                                      00373500
&ZOPL(&ZOPN)          SETC ' '                                          00373600
&ZOPO(&ZOPN)          SETC 'ORG'                                        00373700
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+48'                               00373800
&ZOPD(&ZOPN)          SETC ' '                                          00373900
.*-------------------------------------------------------------------   00374000
.***AM.L09 ADDR3164 XCPUMASK AD                                         00374100
&ZOPN                 SETA &ZOPN+1                                      00374200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCPUMASK_ADDR3164'                00374300
&ZOPO(&ZOPN)          SETC 'DS'                                         00374400
&ZOPV(&ZOPN)          SETC 'AD'                                         00374500
&ZOPD(&ZOPN)          SETC '++ &ZXCPUMASK ADDR3164'                     00374600
.*-------------------------------------------------------------------   00374700
.***AM.L09 ALET XCPUMASK F                                              00374800
&ZOPN                 SETA &ZOPN+1                                      00374900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCPUMASK_ALET'                    00375000
&ZOPO(&ZOPN)          SETC 'DS'                                         00375100
&ZOPV(&ZOPN)          SETC 'F'                                          00375200
&ZOPD(&ZOPN)          SETC '++ &ZXCPUMASK ALET'                         00375300
.*-------------------------------------------------------------------   00375400
.***AM.L09  XRSV004C CL12                                               00375500
&ZOPN                 SETA &ZOPN+1                                      00375600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV004C'                         00375700
&ZOPO(&ZOPN)          SETC 'DS'                                         00375800
&ZOPV(&ZOPN)          SETC 'CL12'                                       00375900
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00376000
&ZOPN                 SETA &ZOPN+1                                      00376100
&ZOPL(&ZOPN)          SETC ' '                                          00376200
&ZOPO(&ZOPN)          SETC 'ORG'                                        00376300
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00376400
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00376500
.*-------------------------------------------------------------------   00376600
.***AM.L10 END OF HISSERV LIST PARAMETERS                               00376700
&ZOPN                 SETA &ZOPN+1                                      00376800
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00376900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00377000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00377100
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00377200
.*                                                                      00377300
&ZOPN                 SETA &ZOPN+1                                      00377400
&ZOPL(&ZOPN)          SETC ' '                                          00377500
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00377600
&ZOPV(&ZOPN)          SETC '1'                                          00377700
&ZOPD(&ZOPN)          SETC ' '                                          00377800
.*-------------------------------------------------------------------   00377900
.***AL.L12 HISSERV FMT=LIST MF=S!L PARAMETERS                           00378000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00378100
.*                                                                      00378200
&ZOPN                 SETA  &ZOPN+1                                     00378300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00378400
&ZOPO(&ZOPN)          SETC  'DC'                                        00378500
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00378600
&ZOPD(&ZOPN)          SETC  '++ HISSERV ARG PARMS'                      00378700
.*                                                                      00378800
.ZLMFSLX              ANOP  ,                                           00378900
.*-------------------------------------------------------------------   00379000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00379100
&ZPLLEN               SETA 112                                          00379200
.*                                                                      00379300
.******************************************************************     00379400
.***AI.L01 HISSERV FMT=LIST FILL IN PARAMETER AREA                      00379500
.******************************************************************     00379600
                      ACTR  10000                                       00379700
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00379800
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00379900
&ZCVAL                SETC  'LAE'          XAX MODE                     00380000
.ZIMFXA               ANOP ,                                            00380100
.*                                                                      00380200
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00380300
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00380400
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00380500
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00380600
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00380700
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00380800
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00380900
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00381000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00381100
&ZOPN                 SETA  &ZOPN+1                                     00381200
&ZOPL(&ZOPN)          SETC  ' '                                         00381300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00381400
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00381500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00381600
                      AGO   .ZIMFNX                                     00381700
.*                                                                      00381800
.ZIMFN2               ANOP ,                                            00381900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00382000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00382100
&ZOPN                 SETA  &ZOPN+1                                     00382200
&ZOPL(&ZOPN)          SETC  ' '                                         00382300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00382400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00382500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00382600
                      AGO   .ZIMFNX                                     00382700
.ZIMFNX1              ANOP ,                                            00382800
&ZOPN                 SETA  &ZOPN+1                                     00382900
&ZOPL(&ZOPN)          SETC  ' '                                         00383000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00383100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00383200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00383300
.ZIMFNX               ANOP ,                                            00383400
.********************************************************************   00383500
.***AI.L02 HISSERV FMT=LIST INITIALIZE PARAMETER AREA                   00383600
.********************************************************************   00383700
.***AI.L03 MF=(SLME)                                                    00383800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00383900
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00384000
.*                                                                      00384100
&ZOPN                 SETA  &ZOPN+1                                     00384200
&ZOPL(&ZOPN)          SETC  ' '                                         00384300
&ZOPO(&ZOPN)          SETC  'XC'                                        00384400
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00384500
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00384600
.ZIMFLX               ANOP  ,                                           00384700
.*-------------------------------------------------------------------   00384800
.***AI.L60 XEYE CL4                                                     00384900
&ZOPN                 SETA  &ZOPN+1                                     00385000
&ZOPL(&ZOPN)          SETC  ' '                                         00385100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00385200
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''HISS'''                       00385300
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           00385400
.*-------------------------------------------------------------------   00385500
.***AI.L04 XPLISTLEN XL2                                                00385600
&ZOPN                 SETA  &ZOPN+1                                     00385700
&ZOPL(&ZOPN)          SETC  ' '                                         00385800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00385900
&ZOPV(&ZOPN)          SETC  '5(2,1),=AL2(&ZPLLEN)'                      00386000
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00386100
.*-------------------------------------------------------------------   00386200
.***AI.L07 XREQUEST AL1                                                 00386300
&ZW                   SETC  ''                                          00386400
.*-------------------------------------------------------------------   00386500
.***AI.L15 XREQUEST "PROFILE" AL1                                       00386600
         AIF   ('&XREQUEST' NE 'PROFILE').ZI5A                          00386700
&ZW                   SETC  '1'                                         00386800
.ZI5A                 ANOP  ,                                           00386900
.*-------------------------------------------------------------------   00387000
.***AI.L15 XREQUEST "QUERY" AL1                                         00387100
         AIF   ('&XREQUEST' NE 'QUERY').ZI6A                            00387200
&ZW                   SETC  '2'                                         00387300
.ZI6A                 ANOP  ,                                           00387400
.*-------------------------------------------------------------------   00387500
.***AI.L17 XREQUEST AL1                                                 00387600
                      AIF   ('&ZW' NE '0').ZI6C                         00387700
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI6B              00387800
.ZI6C                 ANOP  ,                                           00387900
                      AIF   ('&ZW' EQ '').ZI6B                          00388000
.*                                                                      00388100
&ZOPN                 SETA  &ZOPN+1                                     00388200
&ZOPL(&ZOPN)          SETC  ' '                                         00388300
&ZOPO(&ZOPN)          SETC  'MVI'                                       00388400
&ZOPV(&ZOPN)          SETC  '7(1),&ZW'                                  00388500
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00388600
.ZI6B                 ANOP  ,                                           00388700
.*-------------------------------------------------------------------   00388800
.***AI.L25  XPROFILETKN CL16                                            00388900
                      AIF   ('&ZXPROFILETKN' EQ '').ZI7E                00389000
                      AIF   ('&ZXPROFILETKN' EQ 'OUTPUT').ZI7E          00389100
&ZCGPR                SETC  '&XPROFILETKN'                              00389200
.*                                                                      00389300
                      AIF   ('&XPROFILETKN'(1,1) NE '(').ZI7B           00389400
&ZCGPR   SETC  '0('.'&XPROFILETKN'(2,K'&XPROFILETKN-2).')'              00389500
.ZI7B                 ANOP  ,                                           00389600
.*                                                                      00389700
&ZOPN                 SETA  &ZOPN+1                                     00389800
&ZOPL(&ZOPN)          SETC  ' '                                         00389900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00390000
&ZOPV(&ZOPN)          SETC  '8(16,1),&ZCGPR'                            00390100
&ZOPD(&ZOPN)          SETC  '++ &ZXPROFILETKN XPROFILETKN'              00390200
.*                                                                      00390300
.ZI7E                 ANOP  ,                                           00390400
.*-------------------------------------------------------------------   00390500
.***AI.L07 XACTION AL1                                                  00390600
&ZW                   SETC  ''                                          00390700
.*-------------------------------------------------------------------   00390800
.***AI.L15 XACTION "START" AL1                                          00390900
         AIF   ('&XACTION' NE 'START').ZI12A                            00391000
&ZW                   SETC  '1'                                         00391100
.ZI12A                ANOP  ,                                           00391200
.*-------------------------------------------------------------------   00391300
.***AI.L15 XACTION "STOP" AL1                                           00391400
         AIF   ('&XACTION' NE 'STOP').ZI13A                             00391500
&ZW                   SETC  '2'                                         00391600
.ZI13A                ANOP  ,                                           00391700
.*-------------------------------------------------------------------   00391800
.***AI.L17 XACTION AL1                                                  00391900
                      AIF   ('&ZW' NE '0').ZI13C                        00392000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI13B             00392100
.ZI13C                ANOP  ,                                           00392200
                      AIF   ('&ZW' EQ '').ZI13B                         00392300
.*                                                                      00392400
&ZOPN                 SETA  &ZOPN+1                                     00392500
&ZOPL(&ZOPN)          SETC  ' '                                         00392600
&ZOPO(&ZOPN)          SETC  'MVI'                                       00392700
&ZOPV(&ZOPN)          SETC  '24(1),&ZW'                                 00392800
&ZOPD(&ZOPN)          SETC  '++ &ZXACTION XACTION'                      00392900
.ZI13B                ANOP  ,                                           00393000
.*-------------------------------------------------------------------   00393100
.***AI.L05 XFLAGS BL1                                                   00393200
&ZW                   SETC  ''                                          00393300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00393400
&ZMS                  SETC  ''                                          00393500
&ZC                   SETC  ''                                          00393600
.*-------------------------------------------------------------------   00393700
.***AI.L08 XFLAGS "YES"                                                 00393800
.***      BL1'1XXXXXXX'                                                 00393900
         AIF   ('&XSAMPLE' NE 'YES').ZI15A                              00394000
&ZW                   SETC  '&ZW.10000000'                              00394100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00394200
&ZMS                  SETC  '&ZMS.11111111'                             00394300
                      AGO   .ZI15C                                      00394400
.*                                                                      00394500
.ZI15A                ANOP  ,                                           00394600
&ZW                   SETC  '&ZW.00000000'                              00394700
         AIF   ('&ZXSAMPLE' EQ '').ZI15B                                00394800
&ZMS                  SETC  '&ZMS.01111111'                             00394900
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00395000
                      AGO   .ZI15C                                      00395100
.*                                                                      00395200
.ZI15B                ANOP  ,                                           00395300
&ZMS                  SETC  '&ZMS.11111111'                             00395400
.ZI15C                ANOP  ,                                           00395500
.*-------------------------------------------------------------------   00395600
.***AI.L11 XFLAGS BL1                                                   00395700
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI15D              00395800
                      AIF   ('&ZC' NE 'YES').ZI15D                      00395900
&ZOPN                 SETA  &ZOPN+1                                     00396000
&ZOPL(&ZOPN)          SETC  ' '                                         00396100
&ZOPO(&ZOPN)          SETC  'NI'                                        00396200
&ZOPV(&ZOPN)          SETC  '25(1),B''&ZMS'''                           00396300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00396400
.ZI15D                ANOP  ,                                           00396500
                      AIF   ('&ZCLNG' NE 'YES').ZI15E  ALL ZERO BITS    00396600
&ZOPN                 SETA  &ZOPN+1                                     00396700
&ZOPL(&ZOPN)          SETC  ' '                                         00396800
&ZOPO(&ZOPN)          SETC  'OI'                                        00396900
&ZOPV(&ZOPN)          SETC  '25(1),B''&ZW'''                            00397000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00397100
.ZI15E                ANOP  ,                                           00397200
.*-------------------------------------------------------------------   00397300
.***AI.L25  XNAME CL8                                                   00397400
                      AIF   ('&ZXNAME' EQ '').ZI17E                     00397500
                      AIF   ('&ZXNAME' EQ 'OUTPUT').ZI17E               00397600
&ZCGPR                SETC  '&XNAME'                                    00397700
.*                                                                      00397800
                      AIF   ('&XNAME'(1,1) NE '(').ZI17B                00397900
&ZCGPR   SETC  '0('.'&XNAME'(2,K'&XNAME-2).')'                          00398000
.ZI17B                ANOP  ,                                           00398100
.*                                                                      00398200
&ZOPN                 SETA  &ZOPN+1                                     00398300
&ZOPL(&ZOPN)          SETC  ' '                                         00398400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00398500
&ZOPV(&ZOPN)          SETC  '28(8,1),&ZCGPR'                            00398600
&ZOPD(&ZOPN)          SETC  '++ &ZXNAME XNAME'                          00398700
.*                                                                      00398800
.ZI17E                ANOP  ,                                           00398900
.*-------------------------------------------------------------------   00399000
.***AI.L25  XEXITRTN CL8                                                00399100
                      AIF   ('&ZXEXITRTN' EQ '').ZI18E                  00399200
                      AIF   ('&ZXEXITRTN' EQ 'OUTPUT').ZI18E            00399300
&ZCGPR                SETC  '&XEXITRTN'                                 00399400
.*                                                                      00399500
                      AIF   ('&XEXITRTN'(1,1) NE '(').ZI18B             00399600
&ZCGPR   SETC  '0('.'&XEXITRTN'(2,K'&XEXITRTN-2).')'                    00399700
.ZI18B                ANOP  ,                                           00399800
.*                                                                      00399900
&ZOPN                 SETA  &ZOPN+1                                     00400000
&ZOPL(&ZOPN)          SETC  ' '                                         00400100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00400200
&ZOPV(&ZOPN)          SETC  '36(8,1),&ZCGPR'                            00400300
&ZOPD(&ZOPN)          SETC  '++ &ZXEXITRTN XEXITRTN'                    00400400
.*                                                                      00400500
.ZI18E                ANOP  ,                                           00400600
.*-------------------------------------------------------------------   00400700
.***AI.L18  XEVENT XL4                                                  00400800
         AIF   ('&XEVENT' NE 'NO_EVENT').ZI19                           00400900
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI19  CK *        00401000
&ZXEVENT              SETC  ''             RESET INPUT/OUTPUT           00401100
.ZI19                 ANOP  ,                                           00401200
.*-------------------------------------------------------------------   00401300
.***AI.L25  XEVENT XL4                                                  00401400
                      AIF   ('&ZXEVENT' EQ '').ZI19E                    00401500
                      AIF   ('&ZXEVENT' EQ 'OUTPUT').ZI19E              00401600
&ZCGPR                SETC  '&XEVENT'                                   00401700
         AIF   ('&XEVENT' NE 'NO_EVENT').ZI19A                          00401800
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI19E                          00401900
.*                                                                      00402000
&ZCGPR                SETC  '=XL4''00'''                                00402100
.ZI19A                ANOP  ,                                           00402200
.*                                                                      00402300
                      AIF   ('&XEVENT'(1,1) NE '(').ZI19B               00402400
&ZCGPR   SETC  '0('.'&XEVENT'(2,K'&XEVENT-2).')'                        00402500
                      AGO   .ZI19D                                      00402600
.ZI19B                ANOP  ,                                           00402700
.*                                                                      00402800
&ZC                   SETC  '&XEVENT'(1,1)                              00402900
                      AIF   (T'&ZC NE 'N').ZI19D                        00403000
&ZC                   SETC  '&XEVENT'                                   00403100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               00403200
&ZCGPR                SETC  '=BL4''&XEVENT'''                           00403300
.*                                                                      00403400
.ZI19D                ANOP  ,                                           00403500
.*                                                                      00403600
&ZOPN                 SETA  &ZOPN+1                                     00403700
&ZOPL(&ZOPN)          SETC  ' '                                         00403800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00403900
&ZOPV(&ZOPN)          SETC  '44(4,1),&ZCGPR'                            00404000
&ZOPD(&ZOPN)          SETC  '++ &ZXEVENT XEVENT'                        00404100
.*                                                                      00404200
.ZI19E                ANOP  ,                                           00404300
.*-------------------------------------------------------------------   00404400
.***AI.L18  XTRCTIME CL8                                                00404500
         AIF   ('&XTRCTIME' NE 'ALL').ZI21                              00404600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI21  CK *        00404700
&ZXTRCTIME            SETC  ''             RESET INPUT/OUTPUT           00404800
.ZI21                 ANOP  ,                                           00404900
.*-------------------------------------------------------------------   00405000
.***AI.L25  XTRCTIME CL8                                                00405100
                      AIF   ('&ZXTRCTIME' EQ '').ZI21E                  00405200
                      AIF   ('&ZXTRCTIME' EQ 'OUTPUT').ZI21E            00405300
&ZCGPR                SETC  '&XTRCTIME'                                 00405400
         AIF   ('&XTRCTIME' NE 'ALL').ZI21A                             00405500
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI21E                          00405600
.*                                                                      00405700
&ZCGPR                SETC  '=XL8''00'''                                00405800
.ZI21A                ANOP  ,                                           00405900
.*                                                                      00406000
                      AIF   ('&XTRCTIME'(1,1) NE '(').ZI21B             00406100
&ZCGPR   SETC  '0('.'&XTRCTIME'(2,K'&XTRCTIME-2).')'                    00406200
.ZI21B                ANOP  ,                                           00406300
.*                                                                      00406400
&ZOPN                 SETA  &ZOPN+1                                     00406500
&ZOPL(&ZOPN)          SETC  ' '                                         00406600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00406700
&ZOPV(&ZOPN)          SETC  '64(8,1),&ZCGPR'                            00406800
&ZOPD(&ZOPN)          SETC  '++ &ZXTRCTIME XTRCTIME'                    00406900
.*                                                                      00407000
.ZI21E                ANOP  ,                                           00407100
.*-------------------------------------------------------------------   00407200
.***AI.L19 ADDR3164 XANSAREA AD                                         00407300
                      AIF   ('&ZXANSAREA' EQ '').ZI24H                  00407400
&ZCLNG                SETC  '&XANSAREA'                                 00407500
&ZCGPR                SETC  '14'                                        00407600
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI24F  IN GPR                  00407700
.*                                                                      00407800
&ZOPN                 SETA  &ZOPN+1                                     00407900
&ZOPL(&ZOPN)          SETC  ' '                                         00408000
&ZOPO(&ZOPN)          SETC  'LA'                                        00408100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00408200
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00408300
.*                                                                      00408400
                      AGO   .ZI24G                                      00408500
.*                                                                      00408600
.ZI24F                ANOP  ,                                           00408700
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00408800
.*                                                                      00408900
.ZI24G                ANOP  ,                                           00409000
                      AIF   ('&SYSAM64' EQ 'YES').ZI24H1A               00409100
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI24C2             00409200
.*                                                                      00409300
&ZOPN                 SETA  &ZOPN+1                                     00409400
&ZOPL(&ZOPN)          SETC  ' '                                         00409500
&ZOPO(&ZOPN)          SETC  'XC'                                        00409600
&ZOPV(&ZOPN)          SETC  '24(4,1),24(1)'                             00409700
.ZI24C2               ANOP  ,                                           00409800
.*                                                                      00409900
&ZOPN                 SETA  &ZOPN+1                                     00410000
&ZOPL(&ZOPN)          SETC  ' '                                         00410100
&ZOPO(&ZOPN)          SETC  'ST'                                        00410200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+24(,1)'                           00410300
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00410400
.*                                                                      00410500
                      AGO   .ZI24H                                      00410600
.ZI24H1A              ANOP  ,                                           00410700
.*                                                                      00410800
&ZOPN                 SETA  &ZOPN+1                                     00410900
&ZOPL(&ZOPN)          SETC  ' '                                         00411000
&ZOPO(&ZOPN)          SETC  'STG'                                       00411100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,24(,1)'                             00411200
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00411300
.*                                                                      00411400
.ZI24H                ANOP  ,                                           00411500
.*-------------------------------------------------------------------   00411600
.***AI.L25  XANSLEN CL8                                                 00411700
                      AIF   ('&ZXANSLEN' EQ '').ZI25E                   00411800
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI25E             00411900
&ZCGPR                SETC  '&XANSLEN'                                  00412000
.*                                                                      00412100
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI25B              00412200
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00412300
                      AGO   .ZI25D                                      00412400
.ZI25B                ANOP  ,                                           00412500
.*                                                                      00412600
&ZC                   SETC  '&XANSLEN'(1,1)                             00412700
                      AIF   (T'&ZC NE 'N').ZI25D                        00412800
&ZC                   SETC  '&XANSLEN'                                  00412900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI25D               00413000
&ZCGPR                SETC  '=AD(&XANSLEN)'                             00413100
.*                                                                      00413200
.ZI25D                ANOP  ,                                           00413300
.*                                                                      00413400
&ZOPN                 SETA  &ZOPN+1                                     00413500
&ZOPL(&ZOPN)          SETC  ' '                                         00413600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00413700
&ZOPV(&ZOPN)          SETC  '32(8,1),&ZCGPR'                            00413800
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00413900
.*                                                                      00414000
.ZI25E                ANOP  ,                                           00414100
.*-------------------------------------------------------------------   00414200
.***AI.L23 ALET XANSAREA F                                              00414300
         AIF   ('&ZXANSAREA' EQ '').ZI26G                               00414400
         AIF   ('&SYSASCE' EQ 'P').ZI26G   SYSSTATE PRIMARY             00414500
&ZCLNG                SETC  '&XANSAREA'                                 00414600
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI26E  IN AR                   00414700
.*                                                                      00414800
&ZCGPR                SETC  '14'                                        00414900
&ZOPN                 SETA  &ZOPN+1                                     00415000
&ZOPL(&ZOPN)          SETC  ' '                                         00415100
&ZOPO(&ZOPN)          SETC  'LAE'                                       00415200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00415300
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00415400
                      AGO   .ZI26F                                      00415500
.*                                                                      00415600
.ZI26E                ANOP  ,                                           00415700
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00415800
.*                                                                      00415900
.ZI26F                ANOP  ,                                           00416000
.*                                                                      00416100
&ZOPN                 SETA  &ZOPN+1                                     00416200
&ZOPL(&ZOPN)          SETC  ' '                                         00416300
&ZOPO(&ZOPN)          SETC  'STAM'                                      00416400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,40(1)'                       00416500
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00416600
.*                                                                      00416700
.ZI26G                ANOP  ,                                           00416800
.*-------------------------------------------------------------------   00416900
.***AI.L07 XTYPE AL1                                                    00417000
&ZW                   SETC  ''                                          00417100
.*-------------------------------------------------------------------   00417200
.***AI.L15 XTYPE "PROFILERS" AL1                                        00417300
         AIF   ('&XTYPE' NE 'PROFILERS').ZI28A                          00417400
&ZW                   SETC  '1'                                         00417500
.ZI28A                ANOP  ,                                           00417600
.*-------------------------------------------------------------------   00417700
.***AI.L15 XTYPE "SAMPLE" AL1                                           00417800
         AIF   ('&XTYPE' NE 'SAMPLE').ZI29A                             00417900
&ZW                   SETC  '2'                                         00418000
.ZI29A                ANOP  ,                                           00418100
.*-------------------------------------------------------------------   00418200
.***AI.L15 XTYPE "EVENT" AL1                                            00418300
         AIF   ('&XTYPE' NE 'EVENT').ZI30A                              00418400
&ZW                   SETC  '3'                                         00418500
.ZI30A                ANOP  ,                                           00418600
.*-------------------------------------------------------------------   00418700
.***AI.L15 XTYPE "EVENTDATA" AL1                                        00418800
         AIF   ('&XTYPE' NE 'EVENTDATA').ZI31A                          00418900
&ZW                   SETC  '4'                                         00419000
.ZI31A                ANOP  ,                                           00419100
.*-------------------------------------------------------------------   00419200
.***AI.L17 XTYPE AL1                                                    00419300
                      AIF   ('&ZW' NE '0').ZI31C                        00419400
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI31B             00419500
.ZI31C                ANOP  ,                                           00419600
                      AIF   ('&ZW' EQ '').ZI31B                         00419700
.*                                                                      00419800
&ZOPN                 SETA  &ZOPN+1                                     00419900
&ZOPL(&ZOPN)          SETC  ' '                                         00420000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00420100
&ZOPV(&ZOPN)          SETC  '44(1),&ZW'                                 00420200
&ZOPD(&ZOPN)          SETC  '++ &ZXTYPE XTYPE'                          00420300
.ZI31B                ANOP  ,                                           00420400
.*-------------------------------------------------------------------   00420500
.***AI.L18 ADDR3164 XCPUMASK AD                                         00420600
         AIF   ('&XCPUMASK' NE 'ALL').ZI35                              00420700
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI35  CK *        00420800
&ZXCPUMASK            SETC  ''             RESET INPUT/OUTPUT           00420900
.ZI35                 ANOP  ,                                           00421000
.*-------------------------------------------------------------------   00421100
.***AI.L19 ADDR3164 XCPUMASK AD                                         00421200
                      AIF   ('&ZXCPUMASK' EQ '').ZI35H                  00421300
&ZCLNG                SETC  '&XCPUMASK'                                 00421400
&ZCGPR                SETC  '14'                                        00421500
         AIF   ('&XCPUMASK'(1,1) EQ '(').ZI35F  IN GPR                  00421600
        AIF   ('&XCPUMASK' NE 'ALL').ZI35A                              00421700
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI35H             00421800
.*                                                                      00421900
&ZCLNG                SETC  '=XL8''00'''                                00422000
.ZI35A                ANOP  ,                                           00422100
.*                                                                      00422200
&ZOPN                 SETA  &ZOPN+1                                     00422300
&ZOPL(&ZOPN)          SETC  ' '                                         00422400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00422500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00422600
&ZOPD(&ZOPN)          SETC  '++ &ZXCPUMASK XCPUMASK'                    00422700
.*                                                                      00422800
                      AGO   .ZI35G                                      00422900
.*                                                                      00423000
.ZI35F                ANOP  ,                                           00423100
&ZCGPR   SETC  '&XCPUMASK'(2,K'&XCPUMASK-2)                             00423200
.*                                                                      00423300
.ZI35G                ANOP  ,                                           00423400
                      AIF   ('&SYSAM64' EQ 'YES').ZI35H1A               00423500
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI35C2             00423600
.*                                                                      00423700
&ZOPN                 SETA  &ZOPN+1                                     00423800
&ZOPL(&ZOPN)          SETC  ' '                                         00423900
&ZOPO(&ZOPN)          SETC  'XC'                                        00424000
&ZOPV(&ZOPN)          SETC  '48(4,1),48(1)'                             00424100
.ZI35C2               ANOP  ,                                           00424200
.*                                                                      00424300
&ZOPN                 SETA  &ZOPN+1                                     00424400
&ZOPL(&ZOPN)          SETC  ' '                                         00424500
&ZOPO(&ZOPN)          SETC  'ST'                                        00424600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+48(,1)'                           00424700
&ZOPD(&ZOPN)          SETC  '++ &ZXCPUMASK XCPUMASK'                    00424800
.*                                                                      00424900
                      AGO   .ZI35H                                      00425000
.ZI35H1A              ANOP  ,                                           00425100
.*                                                                      00425200
&ZOPN                 SETA  &ZOPN+1                                     00425300
&ZOPL(&ZOPN)          SETC  ' '                                         00425400
&ZOPO(&ZOPN)          SETC  'STG'                                       00425500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,48(,1)'                             00425600
&ZOPD(&ZOPN)          SETC  '++ &ZXCPUMASK XCPUMASK'                    00425700
.*                                                                      00425800
.ZI35H                ANOP  ,                                           00425900
.*-------------------------------------------------------------------   00426000
.***AI.L18 ALET XCPUMASK F                                              00426100
         AIF   ('&XCPUMASK' NE 'ALL').ZI36                              00426200
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI36  CK *        00426300
&ZXCPUMASK            SETC  ''             RESET INPUT/OUTPUT           00426400
.ZI36                 ANOP  ,                                           00426500
.*-------------------------------------------------------------------   00426600
.***AI.L23 ALET XCPUMASK F                                              00426700
         AIF   ('&ZXCPUMASK' EQ '').ZI36G                               00426800
         AIF   ('&SYSASCE' EQ 'P').ZI36G   SYSSTATE PRIMARY             00426900
&ZCLNG                SETC  '&XCPUMASK'                                 00427000
         AIF   ('&XCPUMASK'(1,1) EQ '(').ZI36E  IN AR                   00427100
.*                                                                      00427200
        AIF   ('&XCPUMASK' NE 'ALL').ZI36A                              00427300
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI36G             00427400
.*                                                                      00427500
&ZCLNG                SETC  '=XL4''00'''                                00427600
.ZI36A                ANOP  ,                                           00427700
.*                                                                      00427800
&ZCGPR                SETC  '14'                                        00427900
                      AGO   .ZI36F                                      00428000
.*                                                                      00428100
.ZI36E                ANOP  ,                                           00428200
&ZCGPR   SETC  '&XCPUMASK'(2,K'&XCPUMASK-2)                             00428300
.*                                                                      00428400
.ZI36F                ANOP  ,                                           00428500
.*                                                                      00428600
&ZOPN                 SETA  &ZOPN+1                                     00428700
&ZOPL(&ZOPN)          SETC  ' '                                         00428800
&ZOPO(&ZOPN)          SETC  'STAM'                                      00428900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,56(1)'                       00429000
&ZOPD(&ZOPN)          SETC  '++ &ZXCPUMASK XCPUMASK'                    00429100
.*                                                                      00429200
.ZI36G                ANOP  ,                                           00429300
.*-------------------------------------------------------------------   00429400
&ZOPN1                SETA &ZOPN                                        00429500
.*-------------------------------------------------------------------   00429600
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00429700
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00429800
.*******************************************************************    00429900
.***  PROCESS HISSERV OUTPUT PARAMETERS                                 00430000
.*******************************************************************    00430100
                      ACTR  10000                                       00430200
.*------------------------------------------------------------------    00430300
.***AO.L02 XOUTPROFILETKN CL16                                          00430400
         AIF   ('&ZXOUTPROFILETKN' EQ 'OUTPUT').ZO20A  OUTPUT           00430500
         AIF   ('&ZXOUTPROFILETKN' NE 'INOUT').ZO20C  INOUT             00430600
.ZO20A    AIF   ('&XOUTPROFILETKN'(1,1) NE '(').ZO20B  ADDR IN GPR      00430700
&ZCGPR   SETC  '&XOUTPROFILETKN'(2,K'&XOUTPROFILETKN-2)                 00430800
&ZOPN                 SETA  &ZOPN+1                                     00430900
&ZOPL(&ZOPN)          SETC  ' '                                         00431000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00431100
&ZOPV(&ZOPN)          SETC  '0(16,&ZCGPR),48(1)'                        00431200
&ZOPD(&ZOPN)          SETC  '++ XOUTPROFILETKN CL16'                    00431300
                      AGO   .ZO20C                                      00431400
.*                                                                      00431500
.ZO20B                ANOP  ,                                           00431600
&ZAWRK   SETA  K'&XOUTPROFILETKN                                        00431700
         AIF   ('&XOUTPROFILETKN'(&ZAWRK,1) NE ')').ZO20G               00431800
&ZN      SETA  2                                                        00431900
.ZO20H    ANOP                                                          00432000
         AIF   (&ZN GE &ZAWRK).ZO20G                                    00432100
         AIF   ('&XOUTPROFILETKN'(&ZN,1) NE '(').ZO20I                  00432200
&ZC      SETC  '&XOUTPROFILETKN'(1,&ZN).'16'.','                        00432300
&ZC      SETC  '&ZC'.'&XOUTPROFILETKN'(&ZN+1,&ZAWRK-&ZN).',48(1)'       00432400
         AGO   .ZO20J                                                   00432500
.ZO20I    ANOP                                                          00432600
&ZN      SETA  &ZN+1                                                    00432700
         AGO   .ZO20H                                                   00432800
.ZO20G    ANOP                                                          00432900
&ZC      SETC  '&XOUTPROFILETKN.(16),48(1)'                             00433000
.ZO20J    ANOP                                                          00433100
&ZOPN                 SETA  &ZOPN+1                                     00433200
&ZOPL(&ZOPN)          SETC  ' '                                         00433300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00433400
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00433500
&ZOPD(&ZOPN)          SETC  '++ XOUTPROFILETKN CL16'                    00433600
.ZO20C                ANOP  ,                                           00433700
.*******************************************************************    00433800
.***AO.X02  RETURN CODE PROCESSING                                      00433900
.*******************************************************************    00434000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00434100
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00434200
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00434300
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00434400
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00434500
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00434600
&ZOPN                 SETA  &ZOPN+1                                     00434700
&ZOPL(&ZOPN)          SETC  ' '                                         00434800
&ZOPO(&ZOPN)          SETC  'ST'                                        00434900
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00435000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00435100
                      AGO   .ZMRETX                                     00435200
.*                                                                      00435300
.ZMRET2               ANOP  ,                                           00435400
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00435500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00435600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00435700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00435800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00435900
&ZOPN                 SETA  &ZOPN+1                                     00436000
&ZOPL(&ZOPN)          SETC  ' '                                         00436100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00436200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00436300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00436400
.ZMRETX               ANOP  ,                                           00436500
.*******************************************************************    00436600
.***AO.X03  REASON CODE PROCESSING                                      00436700
.*******************************************************************    00436800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00436900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00437000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00437100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00437200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00437300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00437400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00437500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00437600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00437700
&ZOPN                 SETA  &ZOPN+1                                     00437800
&ZOPL(&ZOPN)          SETC  ' '                                         00437900
&ZOPO(&ZOPN)          SETC  'ST'                                        00438000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00438100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00438200
                      AGO   .ZMRSNX                                     00438300
.*                                                                      00438400
.ZMRSN2               ANOP  ,                                           00438500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00438600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00438700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00438800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00438900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00439000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00439100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00439200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00439300
&ZOPN                 SETA  &ZOPN+1                                     00439400
&ZOPL(&ZOPN)          SETC  ' '                                         00439500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00439600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00439700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00439800
.ZMRSNX               ANOP  ,                                           00439900
.*******************************************************************    00440000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00440100
.*******************************************************************    00440200
.ZMFLX                ANOP  ,              MF=L PROCESSING              00440300
.*******************************************************************    00440400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00440500
.*******************************************************************    00440600
                      ACTR  10000                                       00440700
.*                                                                      00440800
                      LCLA  &ZLC           COLUMN POSITION              00440900
                      LCLA  &ZOPX          LIST TABLE INDEX             00441000
                      LCLC  &ZLL           LABEL                        00441100
                      LCLC  &ZLOP          OPERATION                    00441200
                      LCLC  &ZLV           VALUE                        00441300
                      LCLC  &ZLD           DESCRIPTION                  00441400
.*                                                                      00441500
&ZOPX                 SETA  1                                           00441600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00441700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00441800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00441900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00442000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00442100
                      AIF   (K'&ZLD LE 0).ZL5                           00442200
&ZLC                  SETA  35             COMMENT COLUMN               00442300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00442400
&ZLC                  SETA  33             COMMMENT COLUMN              00442500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00442600
&ZLV                  SETC  '&ZLV'.' '                                  00442700
                      AGO   .ZL3                                        00442800
.*                                                                      00442900
.ZL4                  ANOP  ,                                           00443000
&ZLV                  SETC  '&ZLV'.' '                                  00443100
.ZL5                  ANOP  ,                                           00443200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00443300
.*                                                                      00443400
&ZLL     &ZLOP &ZLV                                                     00443500
.*                                                                      00443600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00443700
                      AGO   .ZL2           CONTINUE LOOPING             00443800
.*                                                                      00443900
.ZLX                  ANOP  ,                                           00444000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00444100
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00444200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00444300
         &ZMAC_LLGT 14,16(0,0)         Get CVT address                  00444400
         &ZMAC_LLGT 15,140(14,0)       Get ECVT address                 00444500
         L     15,868(15,0)            Get HIAB address                 00444600
         LTR   15,15                   Test for zero                    00444700
         JZ    HISSERV&SYSNDX._NOSERVICE                                00444800
         AIF   ('&SYSASCE' EQ 'P').HISSERV_NOTAR                        00444900
         LAE   15,0(15,0)              Clear AR15 for upcoming access   00445000
.HISSERV_NOTAR ANOP ,                                                   00445100
         TM    4(15),X'80'             Determine if service is enabled  00445200
         JZ    HISSERV&SYSNDX._NOSERVICE It is not, do not issue PC     00445300
         L     14,772(14,0)            Get SFT address                  00445400
         L     14,608(14,0)            Get LX/EX for service routine    00445500
         PC    0(14)                                                    00445600
         J     HISSERV&SYSNDX._DONE                                     00445700
HISSERV&SYSNDX._NOSERVICE DS 0H                                         00445800
         LHI   15,X'000C'              Indicate environment error       00445900
         LHI   0,X'0C01'               Indicate service not available   00446000
HISSERV&SYSNDX._DONE DS 0H                                              00446100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00446200
.ZLINKX               ANOP  ,                                           00446300
.*******************************************************************    00446400
.***AP.X01  FORMAT GENERATED CODE                                       00446500
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00446600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00446700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00446800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00446900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00447000
                      AIF   (K'&ZLD LE 0).ZL51                          00447100
&ZLC                  SETA  35             COMMENT COLUMN               00447200
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00447300
&ZLC                  SETA  33             COMMENT COLUMN               00447400
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00447500
&ZLV                  SETC  '&ZLV'.' '                                  00447600
                      AGO   .ZL31                                       00447700
.*                                                                      00447800
.ZL41                 ANOP  ,                                           00447900
&ZLV                  SETC  '&ZLV'.' '                                  00448000
.ZL51                 ANOP  ,                                           00448100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00448200
.*                                                                      00448300
&ZLL     &ZLOP &ZLV                                                     00448400
.*                                                                      00448500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00448600
                      AGO   .ZL21          CONTINUE LOOPING             00448700
.*                                                                      00448800
.ZLX1                 ANOP  ,                                           00448900
.*******************************************************************    00449000
.***AP.X02  END OF HISSERV MACRO                                        00449100
&ZHISSERV             SETC  'YES'          SET HISSERV USED             00449200
         POP   PRINT                                                    00449300
*                                            HISSERV-0                  00449400
         SPACE 1                                                        00449500
.ZLX2                 ANOP  ,                                           00449600
         MEND                                                           00449700
**********************************************************************/ 00449800
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00449900
*%HISSERV: MACRO KEYS(REQUEST,ACTION,OUTPROFILETKN,EVENT,TRCTIME,       00450000
*                 SAMPLE,NAME,EXITRTN,PROFILETKN,ANSAREA,ANSLEN,TYPE,   00450100
*                 CPUMASK,RETCODE,RSNCODE,PLISTVER,MF);                 00450200
*  ANS('?'!!MACLABEL!!' '!!'HISSERVP '!!MACLIST!!                       00450300
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00450400
*%END HISSERV;                                                          00450500

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  CSVAPF                                -12/07/01-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  APF Services                                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 (C) COPYRIGHT IBM CORP. 1992, 2002                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7707                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      CSVAPF provides an interface to request services against the   * 00002100
*      APF List.                                                      * 00002200
*                                                                     * 00002300
*      The following services are provided:                           * 00002400
*                                                                     * 00002500
*                                                                     * 00002600
*      QUERY    Determine if a particular dataset is in the list.     * 00002700
*                                                                     * 00002800
*      QUERYFORMAT Determine the current format (dynamic or static)   * 00002900
*               of the list.                                          * 00003000
*                                                                     * 00003100
*      ADD      Add an entry to the dynamic list.                     * 00003200
*                                                                     * 00003300
*      DELETE   Remove an entry from the dynamic list.                * 00003400
*                                                                     * 00003500
*      LIST     Return information about all of the entries in the    * 00003600
*               list.                                                 * 00003700
*                                                                     * 00003800
*      DYNFORMAT Change to use the dynamically formatted list.        * 00003900
*               Subsequently, the ADD and DELETE functions can be     * 00004000
*               used.                                                 * 00004100
*                                                                     * 00004200
*                                                                     * 00004300
*                                                                     * 00004400
*                                                                     * 00004500
*                                                                     * 00004600
*      INPUT REGISTERS:                                               * 00004700
*                                                                     * 00004800
*                                                                     * 00004900
*                          GR0-GR1     reserved                       * 00005000
*                                                                     * 00005100
*                          GR2-GR12    undefined                      * 00005200
*                                                                     * 00005300
*                          GR13        Address of standard 72-byte    * 00005400
*                                      save area for QUERY.           * 00005500
*                                                                     * 00005600
*                          GR14-GR15   reserved                       * 00005700
*                                                                     * 00005800
*                          AR0-AR1     reserved                       * 00005900
*                                                                     * 00006000
*                          AR2-AR13    undefined                      * 00006100
*                                                                     * 00006200
*                          AR14-AR15   reserved                       * 00006300
*                                                                     * 00006400
*                                                                     * 00006500
*                                                                     * 00006600
*      OUTPUT ENVIRONMENT: Same as on entry                           * 00006700
*                                                                     * 00006800
*      OUTPUT REGISTERS:                                              * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*                          GR0         reason code based on GR15 or 0 * 00007200
*                                                                     * 00007300
*                          GR1         Not intended interface         * 00007400
*                                                                     * 00007500
*                          GR2-GR13    unchanged                      * 00007600
*                                                                     * 00007700
*                          GR14        Not intended interface         * 00007800
*                                                                     * 00007900
*                          GR15        return code                    * 00008000
*                                                                     * 00008100
*                          AR0-AR1     Not intended interface         * 00008200
*                                                                     * 00008300
*                          AR2-AR13    unchanged                      * 00008400
*                                                                     * 00008500
*                          AR14-AR15   Not intended interface         * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*01* EXTERNAL CLASSIFICATION:                                         * 00009200
*                                                                     * 00009300
*02* PI:   BASE                                                       * 00009400
*                                                                     * 00009500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00009600
*                                                                     * 00009700
*01* ENVIRONMENT:                                                     * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*      Dispatchable unit mode: Task or SRB mode.                      * 00010100
*                                                                     * 00010200
*                        The ADD, DELETE, and DYNFORMAT functions     * 00010300
*                        require task mode.                           * 00010400
*                                                                     * 00010500
*      Minimum authorization:                                         * 00010600
*                                                                     * 00010700
*                        The ADD, DELETE, and DYNFORMAT functions     * 00010800
*                        require SAF authority to the FACILITY class. * 00010900
*                        If SAF is not available, then the caller     * 00011000
*                        must be supervisor state or key 0-7.  For    * 00011100
*                        ADD and DELETE, the entity name used to do   * 00011200
*                        the RACHECK is "CSVAPF.dsname".  For         * 00011300
*                        DYNFORMAT, the entity name used to do the    * 00011400
*                        RACHECK is                                   * 00011500
*                        "CSVAPF.MVS.SETPROG.FORMAT.DYNAMIC".         * 00011600
*                                                                     * 00011700
*                        The QUERY, QUERYFORMAT and LIST functions    * 00011800
*                        allow any state.                             * 00011900
*                                                                     * 00012000
*      AMODE:            24- or 31-bit.                               * 00012100
*                                                                     * 00012200
*                        Invokers of CSVAPF QUERY must be in 31-bit   * 00012300
*                        AMODE as linkage is via branch. For the      * 00012400
*                        other services, linkage is via stacking PC.  * 00012500
*                        All addresses are assumed to be clean 31-bit * 00012600
*                        addresses, even for 24-bit mode callers.     * 00012700
*                                                                     * 00012800
*                        Invokers of CSVAPF QUERYFORMAT must be in    * 00012900
*                        31-bit AMODE, as the control structures      * 00013000
*                        referenced reside above 16M.                 * 00013100
*                                                                     * 00013200
*      ASC mode:         Primary or Access Register.                  * 00013300
*                                                                     * 00013400
*                        The QUERY, QUERYFORMAT, and LIST functions   * 00013500
*                        allow any primary, secondary, and home       * 00013600
*                        address spaces.                              * 00013700
*                                                                     * 00013800
*                        The ADD, DELETE, and DYNFORMAT functions     * 00013900
*                        require p=h=s.                               * 00014000
*                                                                     * 00014100
*      Serialization:                                                 * 00014200
*                                                                     * 00014300
*                        The caller must be enabled, but may be       * 00014400
*                        locked and have FRRs for the QUERY,          * 00014500
*                        QUERYFORMAT, and LIST functions.             * 00014600
*                                                                     * 00014700
*      Restrictions:     None.                                        * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*01* SYNTAX:                                                          * 00015200
*                                                                     * 00015300
*Ýxlabel¨  CSVAPF  Ð  REQUEST=QUERY                                   * 00015400
*                  !     ,DSNAME=xdsname                              * 00015500
*                  !   ÐÝ,VOLTYPE=SMS¨                                * 00015600
*                  !   ¿Ý,VOLTYPE=ANY                                 * 00015700
*                  !         ,VOLUME=xvolume¨                         * 00015800
*                  !   ÐÝ,TEST=NO¨                                    * 00015900
*                  !   ¿Ý,TEST=YES¨                                   * 00016000
*                  Ô ,REQUEST=QUERYFORMAT                             * 00016100
*                  !     ,FORMAT=xformat                              * 00016200
*                  Ô ,REQUEST=ADD                                     * 00016300
*                  !     ,DSNAME=xdsname                              * 00016400
*                  !   ÐÝ,VOLTYPE=SMS¨                                * 00016500
*                  !   ¿Ý,VOLTYPE=ANY                                 * 00016600
*                  !         ,VOLUME=xvolume¨                         * 00016700
*                  Ô ,REQUEST=DELETE                                  * 00016800
*                  !     ,DSNAME=xdsname                              * 00016900
*                  !   ÐÝ,VOLTYPE=SMS¨                                * 00017000
*                  !   ¿Ý,VOLTYPE=ANY                                 * 00017100
*                  !         ,VOLUME=xvolume¨                         * 00017200
*                  Ô ,REQUEST=DYNFORMAT                               * 00017300
*                  ¿ ,REQUEST=LIST                                    * 00017400
*                        ,ANSAREA=xansarea                            * 00017500
*                        ,ANSLEN=xanslen                              * 00017600
*                   Ý,RETCODE=xretcode¨                               * 00017700
*                   Ý,RSNCODE=xrsncode¨                               * 00017800
*                   Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨           * 00017900
*                  ÐÝ,MF=S¨                                           * 00018000
*                  ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                    * 00018100
*                  ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                      * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      Where:                                                         * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*      Ýxlabel¨                                                       * 00018800
*          is an optional symbol, starting in column 1, that is the   * 00018900
*          name on the CSVAPF macro invocation.  The name must        * 00019000
*          conform to the rules for an ordinary assembler language    * 00019100
*          symbol.                                                    * 00019200
*          DEFAULT: No name.                                          * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*      REQUEST=»QUERY!QUERYFORMAT!ADD!DELETE!DYNFORMAT!LISTº          * 00019800
*          is a required keyword input that indicates the type of     * 00019900
*          request.                                                   * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*          REQUEST=QUERY                                              * 00020300
*              indicates to query if a particular dataset is in the   * 00020400
*              APF list.                                              * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*              DSNAME=xdsname                                         * 00020800
*                  is the name (RS-type), or address in register      * 00020900
*                  (2)-(12), of a required 44 character input         * 00021000
*                  containing the name of the subject dataset.        * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*              ÝVOLTYPE=»SMS!ANYº¨                                    * 00021600
*                  is an optional keyword input that indicates the    * 00021700
*                  status of the volume associated with this dataset. * 00021800
*                  DEFAULT: SMS                                       * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*                  ÝVOLTYPE=SMS¨                                      * 00022200
*                      indicates that the dataset is SMS-managed and  * 00022300
*                      that no volume is ever to be associated with   * 00022400
*                      the dataset.                                   * 00022500
*                                                                     * 00022600
*                  ÝVOLTYPE=ANY                                       * 00022700
*                      indicates that the dataset may or may not be   * 00022800
*                      SMS-managed and that the accompanying volume   * 00022900
*                      is to be used.                                 * 00023000
*                                                                     * 00023100
*                                                                     * 00023200
*                      VOLUME=xvolume¨                                * 00023300
*                          is the name (RS-type), or address in       * 00023400
*                          register (2)-(12), of a required 6         * 00023500
*                          character input containing the name of the * 00023600
*                          volume on which the dataset resides.  The  * 00023700
*                          special volume indications of "******" for * 00023800
*                          the SYSRES volume and "*MCAT*" for the     * 00023900
*                          volume containing the master catalog are   * 00024000
*                          not supported for QUERY.                   * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*              ÝTEST=»NO!YESº¨                                        * 00025000
*                  is an optional keyword input that indicates        * 00025100
*                  whether or not to see if the QUERY routine has     * 00025200
*                  been set up yet.                                   * 00025300
*                  DEFAULT: NO                                        * 00025400
*                                                                     * 00025500
*                                                                     * 00025600
*                  ÝTEST=NO¨                                          * 00025700
*                      that indicates not to do this test. Once past  * 00025800
*                      the point of the creation of the second        * 00025900
*                      address space in the system, it is not         * 00026000
*                      necessary to perform this test. The QUERY      * 00026100
*                      routine will have been defined.                * 00026200
*                                                                     * 00026300
*                  ÝTEST=YES¨                                         * 00026400
*                      that indicates to do the test. If the routine  * 00026500
*                      has not been set up, then the QUERY request    * 00026600
*                      returns with an indication of "Not in the      * 00026700
*                      list".                                         * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*          REQUEST=QUERYFORMAT                                        * 00027400
*              indicates to return the current state (static or       * 00027500
*              dynamic) of the APF list. The system assumes that the  * 00027600
*              APF list has already been initialized. The RETCODE,    * 00027700
*              RSNCODE, and MF keys may not be specified.             * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*              FORMAT=xformat                                         * 00028100
*                  is the name (RS-type), or address in register      * 00028200
*                  (2)-(12), of a required byte output that will      * 00028300
*                  contain the current state of the APF list.  If 0,  * 00028400
*                  the list is static. If 1, the list is dynamic -    * 00028500
*                  additions and deletions are allowed.               * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*          REQUEST=ADD                                                * 00029000
*              indicates to add an entry to the dynamic APF list.     * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*              DSNAME=xdsname                                         * 00029400
*                  is the name (RS-type), or address in register      * 00029500
*                  (2)-(12), of a required 44 character input         * 00029600
*                  containing the name of the dataset to be added.    * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*              ÝVOLTYPE=»SMS!ANYº¨                                    * 00030200
*                  is an optional keyword input that indicates the    * 00030300
*                  status of the volume associated with this dataset. * 00030400
*                  DEFAULT: SMS                                       * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                  ÝVOLTYPE=SMS¨                                      * 00030800
*                      indicates that the dataset is SMS-managed and  * 00030900
*                      that no volume is ever to be associated with   * 00031000
*                      the dataset.                                   * 00031100
*                                                                     * 00031200
*                  ÝVOLTYPE=ANY                                       * 00031300
*                      indicates that the dataset may or may not be   * 00031400
*                      SMS-managed and that the accompanying volume   * 00031500
*                      is to be used.                                 * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                      VOLUME=xvolume¨                                * 00031900
*                          is the name (RS-type), or address in       * 00032000
*                          register (2)-(12), of a required 6         * 00032100
*                          character input containing the name of the * 00032200
*                          volume on which the dataset resides.  If   * 00032300
*                          the specified volume is "******", the      * 00032400
*                          SYSRES volume is used.  If the specified   * 00032500
*                          volume is "*MCAT*", the volume containing  * 00032600
*                          the master catalog is used.  If the        * 00032700
*                          specified volume contains all 0s then the  * 00032800
*                          dataset is assumed to be SMS-managed.      * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*          REQUEST=DELETE                                             * 00033700
*              indicates to remove an entry from the dynamic APF      * 00033800
*              list.                                                  * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*              DSNAME=xdsname                                         * 00034200
*                  is the name (RS-type), or address in register      * 00034300
*                  (2)-(12), of a required 44 character input         * 00034400
*                  containing the name of the dataset to be deleted.  * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*              ÝVOLTYPE=»SMS!ANYº¨                                    * 00035000
*                  is an optional keyword input that indicates the    * 00035100
*                  status of the volume associated with this dataset. * 00035200
*                  DEFAULT: SMS                                       * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*                  ÝVOLTYPE=SMS¨                                      * 00035600
*                      indicates that the dataset is SMS-managed and  * 00035700
*                      that no volume is ever to be associated with   * 00035800
*                      the dataset.                                   * 00035900
*                                                                     * 00036000
*                  ÝVOLTYPE=ANY                                       * 00036100
*                      indicates that the dataset may or may not be   * 00036200
*                      SMS-managed and that the accompanying volume   * 00036300
*                      is to be used.                                 * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                      VOLUME=xvolume¨                                * 00036700
*                          is the name (RS-type), or address in       * 00036800
*                          register (2)-(12), of a required 6         * 00036900
*                          character input containing the name of the * 00037000
*                          volume on which the dataset resides.  If   * 00037100
*                          the specified volume is "******", then the * 00037200
*                          SYSRES volume is used.  If the specified   * 00037300
*                          volume is "*MCAT*", the volume containing  * 00037400
*                          the master catalog is used.  If the        * 00037500
*                          specified volume contains all 0s then the  * 00037600
*                          dataset is assumed to be SMS-managed.      * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*                                                                     * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*          REQUEST=DYNFORMAT                                          * 00038500
*              requests a transition from the static table format to  * 00038600
*              the dynamically formatted list.                        * 00038700
*                                                                     * 00038800
*          REQUEST=LIST                                               * 00038900
*              requests to return information about all of the        * 00039000
*              entries in the list. The list is mapped by macro       * 00039100
*              CSVAPFAA and consists of a header (APFHDR) followed by * 00039200
*              one or more entries (APFE).                            * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*              ANSAREA=xansarea                                       * 00039600
*                  is the name (RS-type), or address in register      * 00039700
*                  (2)-(12), of a required character output that      * 00039800
*                  indicates the area into which the output is to be  * 00039900
*                  placed.  This area is mapped by macro CSVAPFAA.    * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*              ANSLEN=xanslen                                         * 00040500
*                  is the name (RS-type), or address in register      * 00040600
*                  (2)-(12), of a required fullword input that        * 00040700
*                  indicates the length of the answer area provided.  * 00040800
*                  The length must be at least as long as the length  * 00040900
*                  of the APFHDR structure contained in mapping macro * 00041000
*                  CSVAPFAA.                                          * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*                                                                     * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*      ÝRETCODE=xretcode¨                                             * 00042000
*          is the name (RS-type) of an optional fullword output       * 00042100
*          variable, or register (2)-(12), into which the return code * 00042200
*          is to be copied from GPR 15.                               * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*                                                                     * 00042700
*      ÝRSNCODE=xrsncode¨                                             * 00042800
*          is the name (RS-type) of an optional fullword output       * 00042900
*          variable, or register (2)-(12), into which the reason code * 00043000
*          is to be copied from GPR 0.                                * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00043600
*          is an optional byte input decimal value in the "0-0" range * 00043700
*          that specifies the macro version.  PLISTVER is the only    * 00043800
*          key allowed on the list form of MF and determines which    * 00043900
*          parameter list is generated.  Note that MAX may be         * 00044000
*          specified instead of a number, and the parameter list will * 00044100
*          be of the largest size currently supported. This size may  * 00044200
*          grow from release to release (thus possibly affecting the  * 00044300
*          amount of storage needed by your program).  If your        * 00044400
*          program can tolerate this, IBM recommends that you always  * 00044500
*          specify MAX when creating the list form parameter list as  * 00044600
*          that will ensure that the list form parameter list is      * 00044700
*          always long enough to hold whatever parameters might be    * 00044800
*          specified on the execute form.                             * 00044900
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00045000
*          default is the lowest version which allows all of the      * 00045100
*          parameters specified on the invocation to be processed.    * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*                                                                     * 00045600
*      ÝMF=»S!L!Eº¨                                                   * 00045700
*          is an optional keyword input which specifies the macro     * 00045800
*          form.                                                      * 00045900
*          DEFAULT: S                                                 * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*          ÝMF=S¨                                                     * 00046300
*              specifies the standard form of the macro.  The "S"     * 00046400
*              form generates code to put the parameters into an      * 00046500
*              in-line parameter list and invoke the desired service. * 00046600
*              Full checking for required macro keys is done along    * 00046700
*              with supplying defaults for omitted optional           * 00046800
*              parameters.                                            * 00046900
*                                                                     * 00047000
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00047100
*              specifies the list form of the macro.  The "L" form    * 00047200
*              defines an area to be used for the parameter list.     * 00047300
*              Only the PLISTVER key may be specified on the          * 00047400
*              invocation.  All other macro parameters are flagged as * 00047500
*              errors.  If PLISTVER is not specified, the original    * 00047600
*              parameter list definition is used.                     * 00047700
*                                                                     * 00047800
*            ,xmfctrl                                                 * 00047900
*              is a required input.  It is the name of a storage area * 00048000
*              for the parameter list.                                * 00048100
*                                                                     * 00048200
*            »,xmfattr!0Dº                                            * 00048300
*              is an optional 60 character input string that varies   * 00048400
*              from 1 to 60 characters. Use it to force boundary      * 00048500
*              alignment of the parameter list. Use only 0F or 0D.    * 00048600
*              DEFAULT: 0D which forces the parameter list to a       * 00048700
*              doubleword boundary.                                   * 00048800
*                                                                     * 00048900
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00049000
*              specifies the execute form of the macro.  The "E" form * 00049100
*              generates code to put the parameters into the          * 00049200
*              parameter list specified by xmfctrl and provides full  * 00049300
*              syntax checking with default setting.                  * 00049400
*                                                                     * 00049500
*            ,xmfctrl                                                 * 00049600
*              is a required input.  It is the name (RS-type), or     * 00049700
*              address in register (1)-(12), of a storage area for    * 00049800
*              the parameter list.                                    * 00049900
*                                                                     * 00050000
*            »,COMPLETEº                                              * 00050100
*              is an optional keyword input which specifies the       * 00050200
*              degree of macro parameter syntax checking.             * 00050300
*              DEFAULT: COMPLETE                                      * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*              COMPLETE                                               * 00050700
*                  Checking for required macro keys is done and       * 00050800
*                  defaults are supplied for omitted optional         * 00050900
*                  parameters.                                        * 00051000
*                                                                     * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*                                                                     * 00051700
*01* RETURN CODES:                                                    * 00051800
*                                                                     * 00051900
*                                                                     * 00052000
*                 Equates for the return and reason codes are defined * 00052100
*                 by macro CSVAPFAA.                                  * 00052200
*                                                                     * 00052300
*       0         CSVAPF request successful.                          * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*                 QUERY     Dataset found in APF list                 * 00052700
*                                                                     * 00052800
*                 ADD       Dataset added to the APF list             * 00052900
*                                                                     * 00053000
*                 DELETE    Dataset deleted from the APF list         * 00053100
*                                                                     * 00053200
*                 LIST      All data returned                         * 00053300
*                                                                     * 00053400
*                 DYNFORMAT Dynamically formatted APF list is now     * 00053500
*                           being used                                * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*                                                                     * 00054000
*       4         Warning                                             * 00054100
*                                                                     * 00054200
*                 HEX REASON   MEANING                                * 00054300
*                 CODE                                                * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*                 xxxx0401    Dataset is in the list. For Query, the  * 00054700
*                             dataset is marked "SMS-managed". For    * 00054800
*                             ADD, the dataset already exists in the  * 00054900
*                             list.                                   * 00055000
*                                                                     * 00055100
*                 xxxx0402    Dataset is not in the list.  For Query  * 00055200
*                             the data set is not authorized.  For    * 00055300
*                             Delete, the requested operation was not * 00055400
*                             performed.                              * 00055500
*                                                                     * 00055600
*                 xxxx0403    For List request, not all data was      * 00055700
*                             returned because the answer area is not * 00055800
*                             big enough. Answer area field APFHTLEN  * 00055900
*                             indicates how much space is currently   * 00056000
*                             required. The user should re-issue the  * 00056100
*                             request designating a larger answer     * 00056200
*                             area.                                   * 00056300
*                                                                     * 00056400
*                                                                     * 00056500
*                                                                     * 00056600
*                                                                     * 00056700
*       8         CSVAPF request specifies invalid parameters.        * 00056800
*                                                                     * 00056900
*                 HEX REASON   MEANING                                * 00057000
*                 CODE                                                * 00057100
*                                                                     * 00057200
*                                                                     * 00057300
*                 xxxx0801    Unable to access parameter list         * 00057400
*                                                                     * 00057500
*                 xxxx0802    SRB mode                                * 00057600
*                                                                     * 00057700
*                 xxxx0803    Not Enabled                             * 00057800
*                                                                     * 00057900
*                 xxxx0804    Not authorized                          * 00058000
*                                                                     * 00058100
*                 xxxx0805    Home address space different than       * 00058200
*                             primary address space                   * 00058300
*                                                                     * 00058400
*                 xxxx0806    Bad answer area ALET                    * 00058500
*                                                                     * 00058600
*                 xxxx0807    Error accessing answer area             * 00058700
*                                                                     * 00058800
*                 xxxx0808    QUERY - AnsLen is less than size of the * 00058900
*                             header area                             * 00059000
*                                                                     * 00059100
*                 xxxx0809    Request type is not valid               * 00059200
*                                                                     * 00059300
*                 xxxx080A    Unable to establish ESTAE. "xxxx"       * 00059400
*                             contains ESTAE return code              * 00059500
*                                                                     * 00059600
*                 xxxx080B    Reserved field not 0                    * 00059700
*                                                                     * 00059800
*                 xxxx080C    Bad dataset name. First character is    * 00059900
*                             blank                                   * 00060000
*                                                                     * 00060100
*                 xxxx080D    Bad parmlist ALET                       * 00060200
*                                                                     * 00060300
*                 xxxx080E    Bad version number                      * 00060400
*                                                                     * 00060500
*                 xxxx080F    Locked (for ADD, DELETE, DYNFORMAT)     * 00060600
*                                                                     * 00060700
*                                                                     * 00060800
*                                                                     * 00060900
*                                                                     * 00061000
*       C         Environmental error                                 * 00061100
*                                                                     * 00061200
*                 HEX REASON   MEANING                                * 00061300
*                 CODE                                                * 00061400
*                                                                     * 00061500
*                                                                     * 00061600
*                 xxxx0C01    Function is not available. APF FORMAT   * 00061700
*                             is STATIC                               * 00061800
*                                                                     * 00061900
*                 xxxx0C02    Function is not available. DFP level is * 00062000
*                             not at least DFP 4.1.0.                 * 00062100
*                                                                     * 00062200
*                                                                     * 00062300
*                                                                     * 00062400
*                                                                     * 00062500
*       10        Unexpected failure.  The state of the request is    * 00062600
*                 unpredictable.                                      * 00062700
*                                                                     * 00062800
*                 HEX REASON   MEANING                                * 00062900
*                 CODE                                                * 00063000
*                                                                     * 00063100
*                                                                     * 00063200
*                 xxxx1001    Unexpected failure                      * 00063300
*                                                                     * 00063400
*                                                                     * 00063500
*                                                                     * 00063600
*                                                                     * 00063700
*                                                                     * 00063800
*01* REASON CODES:                                                    * 00063900
*                                                                     * 00064000
*       Reason codes, as appropriate, are defined under their         * 00064100
*       corresponding return code.  Reason code and return code       * 00064200
*       constants are defined within CSVAPFAA.                        * 00064300
*                                                                     * 00064400
*01* MODULE TYPE:  ASSEM MACRO                                        * 00064500
*                                                                     * 00064600
*02*   PROCESSOR:  ASSEM                                              * 00064700
*                                                                     * 00064800
*01* COMPONENT:  SC1CJ                                                * 00064900
*                                                                     * 00065000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00065100
*                                                                     * 00065200
*01* MACRO USAGE NOTES:                                               * 00065300
*                                                                     * 00065400
*                                                                     * 00065500
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00065600
*        global macro variable.  Any value other than 'NO' will       * 00065700
*        result in the macro expansion being printed.  The default is * 00065800
*        'YES'.  The following examples illustrate how the ZPRINT     * 00065900
*        variable should be set.                                      * 00066000
*                                                                     * 00066100
*                    GBLC &ZPRINT                                     * 00066200
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00066300
*                                                                     * 00066400
*                                                                     * 00066500
*    2.  All  keys currently contained in the CSVAPF macro correspond * 00066600
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 00066700
*        MAX.                                                         * 00066800
*                                                                     * 00066900
*                                                                     * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*01* CHANGE ACTIVITY:                                                 * 00067300
*                                                                     * 00067400
*   Flag LineItem  FMID    Date   ID    Comment                       * 00067500
*                                                                     * 00067600
*    $L0=ANVALAPA HBB4430 901112 PD00XB:  Dynamic APF                 * 00067700
*    $01=OY60389  HBB4430 921224 PD34EP:  *MCAT* support              * 00067800
*    $L1=PYV0192  HBB7707 011207 PD00XB:  POP PRINT                   * 00067900
****** END OF SPECIFICATIONS *****************************************/ 00068000
*/* TLINE 1 *********************************************************** 00068100
         MACRO                                                          00068200
&XLABEL  CSVAPF &REQUEST=,&DSNAME=,&VOLTYPE=,&VOLUME=,&TEST=,&FORMAT=, *00068300
               &ANSAREA=,&ANSLEN=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=   00068400
.*                                                                      00068500
*                 MACDATE -12/07/01-<0>                                 00068600
.*                                                                      00068700
.*******************************************************************    00068800
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00068900
.*******************************************************************    00069000
                 GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                00069100
                 GBLC  &ZTEST      YES=TEST NO=NO TEST                  00069200
                 GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX          00069300
.*                                                                      00069400
                 GBLC  &ZCSVAPF    YES=MACRO USED AT LEAST ONCE         00069500
.*******************************************************************    00069600
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00069700
.*******************************************************************    00069800
                 LCLC  &ZMS        ERROR MESSAGE WORK AREA              00069900
                 LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS         00070000
                 LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED           00070100
                 LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR          00070200
                 LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE          00070300
                 LCLA  &ZAWRK      USED AS A WORK AREA                  00070400
                 LCLA  &ZASIZ      USED FOR SIZE OF VALUE               00070500
                 LCLA  &ZN         NUMERIC WORK VARIABLE                00070600
                 LCLC  &ZC         CHARACTER WORK VARIABLE              00070700
                 LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE          00070800
                 LCLA  &ZTLA       VALUE TOO LONG VARIABLE              00070900
                 LCLC  &ZMAC_G     "G" or null                          00071000
&ZMAC_G          SETC  ''                                               00071100
                 LCLC  &ZMAC_LR                                         00071200
&ZMAC_LR         SETC  'LR'                                             00071300
                 LCLC  &ZMAC_L                                          00071400
&ZMAC_L          SETC  'L'                                              00071500
                 LCLC  &ZMAC_ST                                         00071600
&ZMAC_ST         SETC  'ST'                                             00071700
                 LCLA  &ZMACRET    MACRO RETURN CODE                    00071800
&ZMACRET         SETA  0           ASSUME NO ERRORS                     00071900
.*                                                                      00072000
                 LCLC  &ZCSYSLIST(255)          NONXKEY, POS ARRAY      00072100
                 LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()           00072200
                 LCLA  &ZPLLEN     PARAMETER LIST LENGTH                00072300
                 LCLC  &ZENDBASEPL              End of base PL          00072400
                 LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                00072500
.*******************************************************************    00072600
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00072700
.*******************************************************************    00072800
                 LCLA  &ZI         INDEX FOR ARRAY                      00072900
                 LCLA  &ZJ         INDEX FOR PARMS                      00073000
                 LCLA  &ZK         INDEX FOR PARSE                      00073100
                 LCLA  &ZLO        LOW RANGE VALUE                      00073200
                 LCLA  &ZHI        HIGH RANGE VALUE                     00073300
                 LCLC  &ZW         WORK AREA FOR PARM                   00073400
.********************************************************************   00073500
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00073600
.********************************************************************   00073700
                 GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL              00073800
                 GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE       00073900
                 GBLA  &SYSALVL    SYSSTATE ARCHLVL                     00074000
                 GBLC  &SYSAM64    SYSSTATE AMODE64                     00074100
.*                                                                      00074200
                 AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED       00074300
                 AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED        00074400
                 SPLEVEL  TEST                                          00074500
.ZSYS2           ANOP  ,                                                00074600
                 AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1            00074700
                 AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1            00074800
                 SYSSTATE TEST                                          00074900
                 AGO   .ZSYS4                                           00075000
.ZSYS3           ANOP  ,                                                00075100
&SYSASCE         SETC  'P'         ASSUME SYSSTATE PRIMARY              00075200
.ZSYS4           ANOP  ,                                                00075300
.*******************************************************************    00075400
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00075500
.*******************************************************************    00075600
                 LCLC  &XREQUEST   ++ VALUE                             00075700
                 LCLC  &XDSNAME    ++ NAME                              00075800
                 LCLC  &XVOLTYPE   ++ VALUE                             00075900
                 LCLC  &XVOLUME    ++ NAME                              00076000
                 LCLC  &XTEST      ++ VALUE                             00076100
                 LCLC  &XFORMAT    ++ NAME                              00076200
                 LCLC  &XANSAREA   ++ NAME                              00076300
                 LCLC  &XANSLEN    ++ NAME                              00076400
                 LCLC  &XRETCODE   ++ NAME                              00076500
                 LCLC  &XRSNCODE   ++ NAME                              00076600
                 LCLA  &XPLISTVER  ++ VALUE                             00076700
                 LCLC  &XMF        ++ VALUE                             00076800
                 LCLC  &XMFCTRL    ++ NAME                              00076900
                 LCLC  &XMFATTR    ++ VALUE                             00077000
                 LCLC  &XMFSCK     ++ VALUE                             00077100
.*******************************************************************    00077200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00077300
.*******************************************************************    00077400
                 LCLC  &ZXREQUEST  ++ INPUT VALUE                       00077500
                 LCLC  &ZXDSNAME   ++ INPUT NAME                        00077600
                 LCLC  &ZXVOLTYPE  ++ INPUT VALUE                       00077700
                 LCLC  &ZXVOLUME   ++ INPUT NAME                        00077800
                 LCLC  &ZXTEST     ++ INPUT VALUE                       00077900
                 LCLC  &ZXFORMAT   ++ OUTPUT NAME                       00078000
                 LCLC  &ZXANSAREA  ++ OUTPUT NAME                       00078100
                 LCLC  &ZXANSLEN   ++ INPUT NAME                        00078200
                 LCLC  &ZXRETCODE  ++ OUTPUT NAME                       00078300
                 LCLC  &ZXRSNCODE  ++ OUTPUT NAME                       00078400
                 LCLC  &ZXPLISTVER              ++ INPUT VALUE          00078500
                 LCLC  &ZXMF       ++ INPUT VALUE                       00078600
                 LCLC  &ZXMFCTRL   ++ INPUT NAME                        00078700
                 LCLC  &ZXMFATTR   ++ INPUT VALUE                       00078800
                 LCLC  &ZXMFSCK    ++ INPUT VALUE                       00078900
.********************************************************************   00079000
.***AC.PLV01  PROCESS PLISTVER                                      *   00079100
.********************************************************************   00079200
&XPLISTVER      SETA  0                                                 00079300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00079400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00079500
&XPLISTVER      SETA  0                                                 00079600
.ZPLV0          ANOP  ,                                                 00079700
.*                                                                      00079800
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00079900
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00080000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00080100
.*-------------------------------------------------------------------   00080200
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00080300
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00080400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00080500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00080600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00080700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00080800
                AGO   .ZPVCK2                                           00080900
.ZPVCK3         ANOP  ,                                                 00081000
.*-------------------------------------------------------------------   00081100
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00081200
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00081300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00081400
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00081500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00081600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00081700
                AGO   .ZPVCKE                                           00081800
.ZPVCK2         ANOP  ,                                                 00081900
.*-------------------------------------------------------------------   00082000
&ZCVAL          SETC  '&PLISTVER(1)'                                    00082100
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00082200
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00082300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00082400
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00082500
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00082600
.ZPVCK6         ANOP  ,                                                 00082700
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00082800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00082900
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00083000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00083100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00083200
&XPLISTVER      SETA  0                                                 00083300
                AGO   .ZPVCKE                                           00083400
.*-------------------------------------------------------------------   00083500
.ZPVCK4A        ANOP  ,                                                 00083600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00083700
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00083800
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00083900
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00084000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00084100
                MNOTE 8,' &ZMS IS REQUIRED.'                            00084200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00084300
                AGO   .ZPVCK5                                           00084400
.ZPVCK4         ANOP  ,                                                 00084500
&XPLISTVER      SETA  &PLISTVER(1)                                      00084600
.ZPVCK5         ANOP  ,                                                 00084700
.ZPVCKE         ANOP  ,                                                 00084800
.********************************************************************   00084900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00085000
.********************************************************************   00085100
                 ACTR  10000                                            00085200
.*------------------------------------------------------------------    00085300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085400
&XMF             SETC  ''          INITIALIZE XVARIABLE                 00085500
.*-------------------------------------------------------------------   00085600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085700
.ZG68            ANOP  ,                                                00085800
&ZTLC            SETC 'S'                                               00085900
                 AIF   ('&MF(1)' NE '&ZTLC').ZG69                       00086000
&XMF             SETC  'S'         SET KEYWORD                          00086100
                 AIF   (N'&MF LE 1).ZG68A       CK NUM                  00086200
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00086300
&ZMS             SETC  '&ZMS.&MF"'                                      00086400
&ZMS             SETC  '&ZMS "MF"'                                      00086500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00086600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00086700
.ZG68A           ANOP  ,                                                00086800
.*-------------------------------------------------------------------   00086900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087000
.ZG69            ANOP  ,                                                00087100
&ZTLC            SETC 'L'                                               00087200
                 AIF   ('&MF(1)' NE '&ZTLC').ZG76                       00087300
&XMF             SETC  'L'         SET KEYWORD                          00087400
                 AIF   (N'&MF LE 3).ZG69A       CK NUM                  00087500
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00087600
&ZMS             SETC  '&ZMS.&MF"'                                      00087700
&ZMS             SETC  '&ZMS "MF"'                                      00087800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00087900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00088000
.ZG69A           ANOP  ,                                                00088100
.*-------------------------------------------------------------------   00088200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00088300
                 AIF   (N'&SYSLIST NE 0).ZG69B  POSITIONALS?            00088400
                 AIF   ('&REQUEST' NE '').ZG69B  KEYS?                  00088500
                 AIF   ('&DSNAME' NE '').ZG69B  KEYS?                   00088600
                 AIF   ('&VOLTYPE' NE '').ZG69B  KEYS?                  00088700
                 AIF   ('&VOLUME' NE '').ZG69B  KEYS?                   00088800
                 AIF   ('&TEST' NE '').ZG69B    KEYS?                   00088900
                 AIF   ('&FORMAT' NE '').ZG69B  KEYS?                   00089000
                 AIF   ('&ANSAREA' NE '').ZG69B  KEYS?                  00089100
                 AIF   ('&ANSLEN' NE '').ZG69B  KEYS?                   00089200
                 AIF   ('&RETCODE' NE '').ZG69B  KEYS?                  00089300
                 AIF   ('&RSNCODE' NE '').ZG69B  KEYS?                  00089400
                 AGO    .ZG69C     INVOCATION OKAY                      00089500
.ZG69B           ANOP  ,                                                00089600
&ZMS             SETC  'THE "L" FORM OF "MF"'   *MFLA* MNOTE            00089700
&ZMS             SETC  '&ZMS CAN ONLY HAVE'                             00089800
&ZMS             SETC  '&ZMS THE "PLISTVER" KEY'                        00089900
                 MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'           00090000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00090100
.ZG69C           ANOP  ,                                                00090200
.*-------------------------------------------------------------------   00090300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00090400
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00090500
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00090600
                 AIF   (N'&MF(2) GT 1).ZG71B    MULTI PARMS             00090700
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00090800
.ZG71B           AIF   (K'&MF(2) GT 0).ZG71C                            00090900
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00091000
&ZMS             SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*                 00091100
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00091200
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00091300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00091400
.ZG71C           ANOP  ,                                                00091500
.*-------------------------------------------------------------------   00091600
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00091700
                 AIF   (K'&ZXMFCTRL LE 0).ZG71P  NOT I/O                00091800
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG71P                   00091900
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00092000
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00092100
&ZMS             SETC  '&ZMS.&MF"'                                      00092200
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00092300
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                00092400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00092500
.ZG71P           ANOP  ,                                                00092600
.*-------------------------------------------------------------------   00092700
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00092800
&ZXMFATTR        SETC  'INPUT'     SET IN/OUTPUT                        00092900
&XMFATTR         SETC  '0D'                                             00093000
                 AIF   (K'&MF(3) LE 0).ZG74B    PARM                    00093100
&XMFATTR         SETC  '&MF(3,1)'  SET XVARIABLE                        00093200
                 AIF   (N'&MF(3) GT 1).ZG74B    MULTI PARMS             00093300
&XMFATTR         SETC  '&MF(3)'    SET XVARIABLE                        00093400
.ZG74B           ANOP  ,                                                00093500
.*-------------------------------------------------------------------   00093600
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00093700
                 AIF   (K'&ZXMFATTR LE 0).ZG74P  NOT I/O                00093800
                 AIF   ('&XMFATTR'(1,1) NE '(').ZG74P                   00093900
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00094000
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00094100
&ZMS             SETC  '&ZMS.&MF"'                                      00094200
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00094300
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                00094400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00094500
.ZG74P           ANOP  ,                                                00094600
.*-------------------------------------------------------------------   00094700
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00094800
                 AIF   (K'&ZXMFATTR LE 0).ZG74S  NOT I/O                00094900
                 AIF   (K'&XMFATTR LE 60).ZG74S  LNG OK                 00095000
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00095100
&ZMS             SETC  '"MF='      *KLNGA* MNOTE                        00095200
&ZMS             SETC  '&ZMS.&MF"'                                      00095300
&ZMS             SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'            00095400
                 MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'               00095500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00095600
.ZG74S           ANOP  ,                                                00095700
.*-------------------------------------------------------------------   00095800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095900
.ZG76            ANOP  ,                                                00096000
&ZTLC            SETC 'E'                                               00096100
                 AIF   ('&MF(1)' NE '&ZTLC').ZG84                       00096200
&XMF             SETC  'E'         SET KEYWORD                          00096300
                 AIF   (N'&MF LE 3).ZG76A       CK NUM                  00096400
&ZMS             SETC  '"MF='      *KPOSA* MNOTE                        00096500
&ZMS             SETC  '&ZMS.&MF"'                                      00096600
&ZMS             SETC  '&ZMS "MF"'                                      00096700
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00096800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00096900
.ZG76A           ANOP  ,                                                00097000
.*-------------------------------------------------------------------   00097100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00097200
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00097300
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00097400
                 AIF   (N'&MF(2) GT 1).ZG78B    MULTI PARMS             00097500
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00097600
.ZG78B           AIF   (K'&MF(2) GT 0).ZG78C                            00097700
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00097800
&ZMS             SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*                 00097900
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00098000
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00098100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00098200
.ZG78C           ANOP  ,                                                00098300
.*-------------------------------------------------------------------   00098400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00098500
                 AIF   (K'&ZXMFCTRL LE 0).ZG78R  NOT I/O                00098600
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG78R                   00098700
&ZCGPR           SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                       00098800
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG78P                     00098900
                 AIF   (K'&ZCGPR GT 2).ZG78Q                            00099000
                 AIF   ('&ZCGPR' EQ '0').ZG78Q                          00099100
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00099200
                 AIF   (T'&ZCGPR NE 'N').ZG78Q  INVALID REG NAME        00099300
.ZG78P           ANOP  ,                                                00099400
                 AIF   (T'&ZCGPR NE 'N').ZG78R  NON NUMERIC             00099500
                 AIF   ('&ZCGPR' LT '1').ZG78Q                          00099600
                 AIF   ('&ZCGPR' LE '12').ZG78R                         00099700
.ZG78Q           ANOP  ,                                                00099800
&ZMS             SETC  '"MF='      *KGPRA* MNOTE                        00099900
&ZMS             SETC  '&ZMS.&MF"'                                      00100000
&ZMS             SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'        00100100
                 MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                 00100200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00100300
.ZG78R           ANOP  ,                                                00100400
.*-------------------------------------------------------------------   00100500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00100600
&XMFSCK          SETC  ''          INITIALIZE XVARIABLE                 00100700
.ZG82A   AIF   ('&MF(3)' NE 'COMPLETE').ZG83A                           00100800
&XMFSCK          SETC  'COMPLETE'  SET KEYWORD                          00100900
.*-------------------------------------------------------------------   00101000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00101100
.ZG83A           AIF   (K'&XMFSCK GT 0).ZG83C   KEYWORD                 00101200
                 AIF   (K'&MF(3) LE 0).ZG83B                            00101300
&ZMS             SETC  '"MF='      *KUKWA* MNOTE                        00101400
&ZMS             SETC  '&ZMS.&MF"'                                      00101500
&ZMS             SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '        00101600
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00101700
&ZMS             SETC  '&ZMS "COMPLETE".'                               00101800
                 MNOTE 8,' &ZMS '                                       00101900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00102000
.ZG83B           ANOP  ,                                                00102100
&XMFSCK          SETC  'COMPLETE'  SET DEFAULT KEYWORD                  00102200
.ZG83C           ANOP  ,                                                00102300
&ZXMFSCK         SETC  'INPUT'     SET IN/OUTPUT                        00102400
.*------------------------------------------------------------------    00102500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102600
.ZG84            ANOP  ,                                                00102700
&ZXMF            SETC  'INPUT'     SET IN/OUTPUT                        00102800
                 AIF   (K'&XMF GT 0).ZG84E      VALID ARG               00102900
                 AIF   (T'&MF EQ 'O').ZG84D     OMITTED                 00103000
&ZASYSLNDX       SETA  0                                                00103100
.ZG84A           ANOP  ,           POSITIONAL MACRO KEY                 00103200
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00103300
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG84C                 00103400
&ZTLC            SETC 'MF'                                              00103500
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG84A        00103600
.ZG84B           ANOP  ,                                                00103700
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00103800
&ZMS             SETC  'THE "MF" KEY'           *KOPTA* MNOTE           00103900
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00104000
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00104100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00104200
                 AGO   .ZG84E                                           00104300
.ZG84C           ANOP  ,                                                00104400
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00104500
&ZMS             SETC  '"MF='      *KUKWA* MNOTE                        00104600
&ZMS             SETC  '&ZMS.&MF"'                                      00104700
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00104800
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00104900
&ZMS             SETC  '&ZMS "S",'                                      00105000
&ZMS             SETC  '&ZMS "L",'                                      00105100
&ZMS             SETC  '&ZMS OR "E".'                                   00105200
                 MNOTE 8,' &ZMS '                                       00105300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00105400
                 AGO   .ZG84E                                           00105500
.ZG84D           ANOP  ,                                                00105600
&XMF             SETC  'S'         SET DEFAULT KEYWORD                  00105700
&XMFSCK          SETC  'COMPLETE'  COMPLETE CHECKING                    00105800
.ZG84E           ANOP  ,                                                00105900
.********************************************************************   00106000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00106100
.********************************************************************   00106200
                 ACTR  10000                                            00106300
.*-------------------------------------------------------------------   00106400
.***AG.MF03 MF=(SLE)                                                    00106500
                 AIF   ('&XMF' EQ 'L').ZGMFX                            00106600
.*------------------------------------------------------------------    00106700
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00106800
&XREQUEST        SETC  ''          INITIALIZE XVARIABLE                 00106900
.*-------------------------------------------------------------------   00107000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107100
.ZG3             ANOP  ,                                                00107200
                 AIF   (K'&REQUEST(1) LE 0).ZG3A                        00107300
&ZTLC            SETC 'QUERY'                                           00107400
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG20                  00107500
&XREQUEST        SETC  'QUERY'     SET KEYWORD                          00107600
                 AIF   (N'&REQUEST LE 1).ZG3A   CK NUM                  00107700
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00107800
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00107900
&ZMS             SETC  '&ZMS "REQUEST"'                                 00108000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00108100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00108200
.ZG3A            ANOP  ,                                                00108300
.*------------------------------------------------------------------    00108400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00108500
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00108600
.ZG3A0           AIF   (K'&FORMAT LE 0).ZG3A1   OK                      00108700
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00108800
.ZG3A1           AIF   (K'&ANSAREA LE 0).ZG3A2  OK                      00108900
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00109000
.ZG3A2           AIF   (K'&ANSLEN LE 0).ZG3A3   OK                      00109100
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00109200
.ZG3A3           AIF   (K'&ZCVAL LE 0).ZG3A4    OK                      00109300
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00109400
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00109500
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00109600
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00109700
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00109800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00109900
.ZG3A4           ANOP  ,                                                00110000
.*----------------------------------------------------------------***   00110100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00110200
                 AIF   (N'&DSNAME LE 1).ZG5A    CK NUM                  00110300
&ZMS             SETC  '"DSNAME='  *KPOSA* MNOTE                        00110400
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00110500
&ZMS             SETC  '&ZMS "DSNAME"'                                  00110600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00110700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00110800
.ZG5A            ANOP  ,                                                00110900
.*-------------------------------------------------------------------   00111000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00111100
&ZXDSNAME        SETC  'INPUT'     SET IN/OUTPUT                        00111200
&XDSNAME         SETC  '&DSNAME(1)'             SET XVARIABLE           00111300
                 AIF   (N'&DSNAME GT 1).ZG5B    MULTI PARMS             00111400
&XDSNAME         SETC  '&DSNAME'   SET XVARIABLE                        00111500
.ZG5B            AIF   (K'&DSNAME(1) GT 0).ZG5C                         00111600
&ZXDSNAME        SETC  ''          RESET IN/OUTPUT                      00111700
&ZMS             SETC  ' '         *KRQDA*                              00111800
&ZMS             SETC  '&ZMS "DSNAME" KEY AND ITS'                      00111900
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00112000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00112100
.ZG5C            ANOP  ,                                                00112200
.*-------------------------------------------------------------------   00112300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00112400
                 AIF   (K'&ZXDSNAME LE 0).ZG5R  NOT I/O                 00112500
                 AIF   ('&XDSNAME'(1,1) NE '(').ZG5R                    00112600
&ZCGPR           SETC  '&XDSNAME'(2,K'&XDSNAME-2)                       00112700
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                      00112800
                 AIF   (K'&ZCGPR GT 2).ZG5Q                             00112900
                 AIF   ('&ZCGPR' EQ '0').ZG5Q                           00113000
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00113100
                 AIF   (T'&ZCGPR NE 'N').ZG5Q   INVALID REG NAME        00113200
.ZG5P            ANOP  ,                                                00113300
                 AIF   (T'&ZCGPR NE 'N').ZG5R   NON NUMERIC             00113400
                 AIF   ('&ZCGPR' LT '2').ZG5Q                           00113500
                 AIF   ('&ZCGPR' LE '12').ZG5R                          00113600
.ZG5Q            ANOP  ,                                                00113700
&ZMS             SETC  '"DSNAME='  *KGPRA* MNOTE                        00113800
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00113900
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00114000
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00114100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00114200
.ZG5R            ANOP  ,                                                00114300
.*------------------------------------------------------------------    00114400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114500
&XVOLTYPE        SETC  ''          INITIALIZE XVARIABLE                 00114600
.*-------------------------------------------------------------------   00114700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114800
.ZG9             ANOP  ,                                                00114900
                 AIF   (K'&VOLTYPE(1) LE 0).ZG9A                        00115000
&ZTLC            SETC 'SMS'                                             00115100
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG10                  00115200
&XVOLTYPE        SETC  'SMS'       SET KEYWORD                          00115300
                 AIF   (N'&VOLTYPE LE 1).ZG9A   CK NUM                  00115400
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00115500
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00115600
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00115700
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00115800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00115900
.ZG9A            ANOP  ,                                                00116000
.*------------------------------------------------------------------    00116100
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116200
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00116300
.ZG9A0           AIF   (K'&VOLUME LE 0).ZG9A1   OK                      00116400
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00116500
.ZG9A1           AIF   (K'&ZCVAL LE 0).ZG9A2    OK                      00116600
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00116700
&ZMS             SETC  '"VOLTYPE'  *KMEIA* MNOTE                        00116800
&ZMS             SETC  '&ZMS.=&VOLTYPE"'                                00116900
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00117000
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00117100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00117200
.ZG9A2           ANOP  ,                                                00117300
.*-------------------------------------------------------------------   00117400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117500
.ZG10            ANOP  ,                                                00117600
&ZTLC            SETC 'ANY'                                             00117700
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG14                  00117800
&XVOLTYPE        SETC  'ANY'       SET KEYWORD                          00117900
                 AIF   (N'&VOLTYPE LE 1).ZG10A  CK NUM                  00118000
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00118100
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00118200
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00118300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00118400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00118500
.ZG10A           ANOP  ,                                                00118600
.*----------------------------------------------------------------***   00118700
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00118800
                 AIF   (N'&VOLUME LE 1).ZG12A   CK NUM                  00118900
&ZMS             SETC  '"VOLUME='  *KPOSA* MNOTE                        00119000
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00119100
&ZMS             SETC  '&ZMS "VOLUME"'                                  00119200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00119300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00119400
.ZG12A           ANOP  ,                                                00119500
.*-------------------------------------------------------------------   00119600
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00119700
&ZXVOLUME        SETC  'INPUT'     SET IN/OUTPUT                        00119800
&XVOLUME         SETC  '&VOLUME(1)'             SET XVARIABLE           00119900
                 AIF   (N'&VOLUME GT 1).ZG12B   MULTI PARMS             00120000
&XVOLUME         SETC  '&VOLUME'   SET XVARIABLE                        00120100
.ZG12B           AIF   (K'&VOLUME(1) GT 0).ZG12C                        00120200
&ZXVOLUME        SETC  ''          RESET IN/OUTPUT                      00120300
&ZMS             SETC  'WHEN "ANY" IS SPECIFIED'  *KRQDA*               00120400
&ZMS             SETC  '&ZMS , "VOLUME" KEY AND ITS'                    00120500
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00120600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00120700
.ZG12C           ANOP  ,                                                00120800
.*-------------------------------------------------------------------   00120900
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00121000
                 AIF   (K'&ZXVOLUME LE 0).ZG12R  NOT I/O                00121100
                 AIF   ('&XVOLUME'(1,1) NE '(').ZG12R                   00121200
&ZCGPR           SETC  '&XVOLUME'(2,K'&XVOLUME-2)                       00121300
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                     00121400
                 AIF   (K'&ZCGPR GT 2).ZG12Q                            00121500
                 AIF   ('&ZCGPR' EQ '0').ZG12Q                          00121600
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00121700
                 AIF   (T'&ZCGPR NE 'N').ZG12Q  INVALID REG NAME        00121800
.ZG12P           ANOP  ,                                                00121900
                 AIF   (T'&ZCGPR NE 'N').ZG12R  NON NUMERIC             00122000
                 AIF   ('&ZCGPR' LT '2').ZG12Q                          00122100
                 AIF   ('&ZCGPR' LE '12').ZG12R                         00122200
.ZG12Q           ANOP  ,                                                00122300
&ZMS             SETC  '"VOLUME='  *KGPRA* MNOTE                        00122400
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00122500
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00122600
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00122700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00122800
.ZG12R           ANOP  ,                                                00122900
.*------------------------------------------------------------------    00123000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123100
.ZG14            ANOP  ,                                                00123200
&ZXVOLTYPE       SETC  'INPUT'     SET IN/OUTPUT                        00123300
                 AIF   (K'&XVOLTYPE GT 0).ZG14E  VALID ARG              00123400
                 AIF   (T'&VOLTYPE EQ 'O').ZG14D  OMITTED               00123500
&ZASYSLNDX       SETA  0                                                00123600
.ZG14A           ANOP  ,           POSITIONAL MACRO KEY                 00123700
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00123800
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG14C                 00123900
&ZTLC            SETC 'VOLTYPE'                                         00124000
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG14A        00124100
.ZG14B           ANOP  ,                                                00124200
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00124300
&ZMS             SETC  'THE "VOLTYPE" KEY'      *KOPTA* MNOTE           00124400
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00124500
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00124600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00124700
                 AGO   .ZG14E                                           00124800
.ZG14C           ANOP  ,                                                00124900
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00125000
&ZMS             SETC  '"VOLTYPE='              *KUKWA* MNOTE           00125100
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00125200
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00125300
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00125400
&ZMS             SETC  '&ZMS "SMS"'                                     00125500
&ZMS             SETC  '&ZMS OR "ANY".'                                 00125600
                 MNOTE 8,' &ZMS '                                       00125700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00125800
                 AGO   .ZG14E                                           00125900
.ZG14D           ANOP  ,                                                00126000
&XVOLTYPE        SETC  'SMS'       SET DEFAULT KEYWORD                  00126100
.ZG14E           ANOP  ,                                                00126200
.*------------------------------------------------------------------    00126300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126400
&XTEST           SETC  ''          INITIALIZE XVARIABLE                 00126500
.*-------------------------------------------------------------------   00126600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126700
.ZG17            ANOP  ,                                                00126800
                 AIF   (K'&TEST(1) LE 0).ZG17A                          00126900
&ZTLC            SETC 'NO'                                              00127000
                 AIF   ('&TEST(1)' NE '&ZTLC').ZG18                     00127100
&XTEST           SETC  'NO'        SET KEYWORD                          00127200
                 AIF   (N'&TEST LE 1).ZG17A     CK NUM                  00127300
&ZMS             SETC  '"TEST='    *KPOSA* MNOTE                        00127400
&ZMS             SETC  '&ZMS.&TEST"'                                    00127500
&ZMS             SETC  '&ZMS "TEST"'                                    00127600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00127700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00127800
.ZG17A           ANOP  ,                                                00127900
.*-------------------------------------------------------------------   00128000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128100
.ZG18            ANOP  ,                                                00128200
&ZTLC            SETC 'YES'                                             00128300
                 AIF   ('&TEST(1)' NE '&ZTLC').ZG19                     00128400
&XTEST           SETC  'YES'       SET KEYWORD                          00128500
                 AIF   (N'&TEST LE 1).ZG18A     CK NUM                  00128600
&ZMS             SETC  '"TEST='    *KPOSA* MNOTE                        00128700
&ZMS             SETC  '&ZMS.&TEST"'                                    00128800
&ZMS             SETC  '&ZMS "TEST"'                                    00128900
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00129000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00129100
.ZG18A           ANOP  ,                                                00129200
.*------------------------------------------------------------------    00129300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129400
.ZG19            ANOP  ,                                                00129500
&ZXTEST          SETC  'INPUT'     SET IN/OUTPUT                        00129600
                 AIF   (K'&XTEST GT 0).ZG19E    VALID ARG               00129700
                 AIF   (T'&TEST EQ 'O').ZG19D   OMITTED                 00129800
&ZASYSLNDX       SETA  0                                                00129900
.ZG19A           ANOP  ,           POSITIONAL MACRO KEY                 00130000
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00130100
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG19C                 00130200
&ZTLC            SETC 'TEST'                                            00130300
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG19A        00130400
.ZG19B           ANOP  ,                                                00130500
&ZXTEST          SETC  ''          RESET IN/OUTPUT                      00130600
&ZMS             SETC  'THE "TEST" KEY'         *KOPTA* MNOTE           00130700
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00130800
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00130900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00131000
                 AGO   .ZG19E                                           00131100
.ZG19C           ANOP  ,                                                00131200
&ZXTEST          SETC  ''          RESET IN/OUTPUT                      00131300
&ZMS             SETC  '"TEST='    *KUKWA* MNOTE                        00131400
&ZMS             SETC  '&ZMS.&TEST"'                                    00131500
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00131600
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00131700
&ZMS             SETC  '&ZMS "NO"'                                      00131800
&ZMS             SETC  '&ZMS OR "YES".'                                 00131900
                 MNOTE 8,' &ZMS '                                       00132000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00132100
                 AGO   .ZG19E                                           00132200
.ZG19D           ANOP  ,                                                00132300
&XTEST           SETC  'NO'        SET DEFAULT KEYWORD                  00132400
.ZG19E           ANOP  ,                                                00132500
.*-------------------------------------------------------------------   00132600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00132700
.ZG20            ANOP  ,                                                00132800
&ZTLC            SETC 'QUERYFORMAT'                                     00132900
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG24                  00133000
&XREQUEST        SETC  'QUERYFORMAT'            SET KEYWORD             00133100
                 AIF   (N'&REQUEST LE 1).ZG20A  CK NUM                  00133200
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00133300
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00133400
&ZMS             SETC  '&ZMS "REQUEST"'                                 00133500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00133600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00133700
.ZG20A           ANOP  ,                                                00133800
.*------------------------------------------------------------------    00133900
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00134000
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00134100
.ZG20A0          AIF   (K'&DSNAME LE 0).ZG20A1  OK                      00134200
&ZCVAL           SETC '&ZCVAL DSNAME'           INCORRECT KEY USED      00134300
.ZG20A1          AIF   (K'&VOLTYPE LE 0).ZG20A2  OK                     00134400
&ZCVAL           SETC '&ZCVAL VOLTYPE'          INCORRECT KEY USED      00134500
.ZG20A2          AIF   (K'&VOLUME LE 0).ZG20A3  OK                      00134600
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00134700
.ZG20A3          AIF   (K'&TEST LE 0).ZG20A4    OK                      00134800
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00134900
.ZG20A4          AIF   (K'&ANSAREA LE 0).ZG20A5  OK                     00135000
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00135100
.ZG20A5          AIF   (K'&ANSLEN LE 0).ZG20A6  OK                      00135200
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00135300
.ZG20A6          AIF   (K'&ZCVAL LE 0).ZG20A7   OK                      00135400
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00135500
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00135600
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00135700
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00135800
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00135900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00136000
.ZG20A7          ANOP  ,                                                00136100
.*----------------------------------------------------------------***   00136200
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00136300
                 AIF   (N'&FORMAT LE 1).ZG22A   CK NUM                  00136400
&ZMS             SETC  '"FORMAT='  *KPOSA* MNOTE                        00136500
&ZMS             SETC  '&ZMS.&FORMAT"'                                  00136600
&ZMS             SETC  '&ZMS "FORMAT"'                                  00136700
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00136800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00136900
.ZG22A           ANOP  ,                                                00137000
.*-------------------------------------------------------------------   00137100
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00137200
&ZXFORMAT        SETC  'OUTPUT'    SET IN/OUTPUT                        00137300
&XFORMAT         SETC  '&FORMAT(1)'             SET XVARIABLE           00137400
                 AIF   (N'&FORMAT GT 1).ZG22B   MULTI PARMS             00137500
&XFORMAT         SETC  '&FORMAT'   SET XVARIABLE                        00137600
.ZG22B           AIF   (K'&FORMAT(1) GT 0).ZG22C                        00137700
&ZXFORMAT        SETC  ''          RESET IN/OUTPUT                      00137800
&ZMS             SETC  ' '         *KRQDA*                              00137900
&ZMS             SETC  '&ZMS "FORMAT" KEY AND ITS'                      00138000
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00138100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00138200
.ZG22C           ANOP  ,                                                00138300
.*-------------------------------------------------------------------   00138400
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00138500
                 AIF   (K'&ZXFORMAT LE 0).ZG22R  NOT I/O                00138600
                 AIF   ('&XFORMAT'(1,1) NE '(').ZG22R                   00138700
&ZCGPR           SETC  '&XFORMAT'(2,K'&XFORMAT-2)                       00138800
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                     00138900
                 AIF   (K'&ZCGPR GT 2).ZG22Q                            00139000
                 AIF   ('&ZCGPR' EQ '0').ZG22Q                          00139100
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00139200
                 AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME        00139300
.ZG22P           ANOP  ,                                                00139400
                 AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC             00139500
                 AIF   ('&ZCGPR' LT '2').ZG22Q                          00139600
                 AIF   ('&ZCGPR' LE '12').ZG22R                         00139700
.ZG22Q           ANOP  ,                                                00139800
&ZMS             SETC  '"FORMAT='  *KGPRA* MNOTE                        00139900
&ZMS             SETC  '&ZMS.&FORMAT"'                                  00140000
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00140100
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00140200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00140300
.ZG22R           ANOP  ,                                                00140400
.*-------------------------------------------------------------------   00140500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140600
.ZG24            ANOP  ,                                                00140700
&ZTLC            SETC 'ADD'                                             00140800
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG36                  00140900
&XREQUEST        SETC  'ADD'       SET KEYWORD                          00141000
                 AIF   (N'&REQUEST LE 1).ZG24A  CK NUM                  00141100
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00141200
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00141300
&ZMS             SETC  '&ZMS "REQUEST"'                                 00141400
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00141500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00141600
.ZG24A           ANOP  ,                                                00141700
.*------------------------------------------------------------------    00141800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141900
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00142000
.ZG24A0          AIF   (K'&TEST LE 0).ZG24A1    OK                      00142100
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00142200
.ZG24A1          AIF   (K'&FORMAT LE 0).ZG24A2  OK                      00142300
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00142400
.ZG24A2          AIF   (K'&ANSAREA LE 0).ZG24A3  OK                     00142500
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00142600
.ZG24A3          AIF   (K'&ANSLEN LE 0).ZG24A4  OK                      00142700
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00142800
.ZG24A4          AIF   (K'&ZCVAL LE 0).ZG24A5   OK                      00142900
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00143000
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00143100
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00143200
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00143300
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00143400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00143500
.ZG24A5          ANOP  ,                                                00143600
.*----------------------------------------------------------------***   00143700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00143800
                 AIF   (N'&DSNAME LE 1).ZG26A   CK NUM                  00143900
&ZMS             SETC  '"DSNAME='  *KPOSA* MNOTE                        00144000
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00144100
&ZMS             SETC  '&ZMS "DSNAME"'                                  00144200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00144300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00144400
.ZG26A           ANOP  ,                                                00144500
.*-------------------------------------------------------------------   00144600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00144700
&ZXDSNAME        SETC  'INPUT'     SET IN/OUTPUT                        00144800
&XDSNAME         SETC  '&DSNAME(1)'             SET XVARIABLE           00144900
                 AIF   (N'&DSNAME GT 1).ZG26B   MULTI PARMS             00145000
&XDSNAME         SETC  '&DSNAME'   SET XVARIABLE                        00145100
.ZG26B           AIF   (K'&DSNAME(1) GT 0).ZG26C                        00145200
&ZXDSNAME        SETC  ''          RESET IN/OUTPUT                      00145300
&ZMS             SETC  ' '         *KRQDA*                              00145400
&ZMS             SETC  '&ZMS "DSNAME" KEY AND ITS'                      00145500
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00145600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00145700
.ZG26C           ANOP  ,                                                00145800
.*-------------------------------------------------------------------   00145900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00146000
                 AIF   (K'&ZXDSNAME LE 0).ZG26R  NOT I/O                00146100
                 AIF   ('&XDSNAME'(1,1) NE '(').ZG26R                   00146200
&ZCGPR           SETC  '&XDSNAME'(2,K'&XDSNAME-2)                       00146300
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                     00146400
                 AIF   (K'&ZCGPR GT 2).ZG26Q                            00146500
                 AIF   ('&ZCGPR' EQ '0').ZG26Q                          00146600
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00146700
                 AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME        00146800
.ZG26P           ANOP  ,                                                00146900
                 AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC             00147000
                 AIF   ('&ZCGPR' LT '2').ZG26Q                          00147100
                 AIF   ('&ZCGPR' LE '12').ZG26R                         00147200
.ZG26Q           ANOP  ,                                                00147300
&ZMS             SETC  '"DSNAME='  *KGPRA* MNOTE                        00147400
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00147500
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00147600
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00147700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00147800
.ZG26R           ANOP  ,                                                00147900
.*------------------------------------------------------------------    00148000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148100
&XVOLTYPE        SETC  ''          INITIALIZE XVARIABLE                 00148200
.*-------------------------------------------------------------------   00148300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148400
.ZG30            ANOP  ,                                                00148500
                 AIF   (K'&VOLTYPE(1) LE 0).ZG30A                       00148600
&ZTLC            SETC 'SMS'                                             00148700
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG31                  00148800
&XVOLTYPE        SETC  'SMS'       SET KEYWORD                          00148900
                 AIF   (N'&VOLTYPE LE 1).ZG30A  CK NUM                  00149000
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00149100
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00149200
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00149300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00149400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00149500
.ZG30A           ANOP  ,                                                00149600
.*------------------------------------------------------------------    00149700
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149800
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00149900
.ZG30A0          AIF   (K'&VOLUME LE 0).ZG30A1  OK                      00150000
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00150100
.ZG30A1          AIF   (K'&ZCVAL LE 0).ZG30A2   OK                      00150200
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00150300
&ZMS             SETC  '"VOLTYPE'  *KMEIA* MNOTE                        00150400
&ZMS             SETC  '&ZMS.=&VOLTYPE"'                                00150500
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00150600
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00150700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00150800
.ZG30A2          ANOP  ,                                                00150900
.*-------------------------------------------------------------------   00151000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00151100
.ZG31            ANOP  ,                                                00151200
&ZTLC            SETC 'ANY'                                             00151300
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG35                  00151400
&XVOLTYPE        SETC  'ANY'       SET KEYWORD                          00151500
                 AIF   (N'&VOLTYPE LE 1).ZG31A  CK NUM                  00151600
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00151700
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00151800
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00151900
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00152000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00152100
.ZG31A           ANOP  ,                                                00152200
.*----------------------------------------------------------------***   00152300
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00152400
                 AIF   (N'&VOLUME LE 1).ZG33A   CK NUM                  00152500
&ZMS             SETC  '"VOLUME='  *KPOSA* MNOTE                        00152600
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00152700
&ZMS             SETC  '&ZMS "VOLUME"'                                  00152800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00152900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00153000
.ZG33A           ANOP  ,                                                00153100
.*-------------------------------------------------------------------   00153200
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00153300
&ZXVOLUME        SETC  'INPUT'     SET IN/OUTPUT                        00153400
&XVOLUME         SETC  '&VOLUME(1)'             SET XVARIABLE           00153500
                 AIF   (N'&VOLUME GT 1).ZG33B   MULTI PARMS             00153600
&XVOLUME         SETC  '&VOLUME'   SET XVARIABLE                        00153700
.ZG33B           AIF   (K'&VOLUME(1) GT 0).ZG33C                        00153800
&ZXVOLUME        SETC  ''          RESET IN/OUTPUT                      00153900
&ZMS             SETC  'WHEN "ANY" IS SPECIFIED'  *KRQDA*               00154000
&ZMS             SETC  '&ZMS , "VOLUME" KEY AND ITS'                    00154100
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00154200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00154300
.ZG33C           ANOP  ,                                                00154400
.*-------------------------------------------------------------------   00154500
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00154600
                 AIF   (K'&ZXVOLUME LE 0).ZG33R  NOT I/O                00154700
                 AIF   ('&XVOLUME'(1,1) NE '(').ZG33R                   00154800
&ZCGPR           SETC  '&XVOLUME'(2,K'&XVOLUME-2)                       00154900
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                     00155000
                 AIF   (K'&ZCGPR GT 2).ZG33Q                            00155100
                 AIF   ('&ZCGPR' EQ '0').ZG33Q                          00155200
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00155300
                 AIF   (T'&ZCGPR NE 'N').ZG33Q  INVALID REG NAME        00155400
.ZG33P           ANOP  ,                                                00155500
                 AIF   (T'&ZCGPR NE 'N').ZG33R  NON NUMERIC             00155600
                 AIF   ('&ZCGPR' LT '2').ZG33Q                          00155700
                 AIF   ('&ZCGPR' LE '12').ZG33R                         00155800
.ZG33Q           ANOP  ,                                                00155900
&ZMS             SETC  '"VOLUME='  *KGPRA* MNOTE                        00156000
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00156100
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00156200
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00156300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00156400
.ZG33R           ANOP  ,                                                00156500
.*------------------------------------------------------------------    00156600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156700
.ZG35            ANOP  ,                                                00156800
&ZXVOLTYPE       SETC  'INPUT'     SET IN/OUTPUT                        00156900
                 AIF   (K'&XVOLTYPE GT 0).ZG35E  VALID ARG              00157000
                 AIF   (T'&VOLTYPE EQ 'O').ZG35D  OMITTED               00157100
&ZASYSLNDX       SETA  0                                                00157200
.ZG35A           ANOP  ,           POSITIONAL MACRO KEY                 00157300
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00157400
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG35C                 00157500
&ZTLC            SETC 'VOLTYPE'                                         00157600
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG35A        00157700
.ZG35B           ANOP  ,                                                00157800
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00157900
&ZMS             SETC  'THE "VOLTYPE" KEY'      *KOPTA* MNOTE           00158000
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00158100
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00158200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00158300
                 AGO   .ZG35E                                           00158400
.ZG35C           ANOP  ,                                                00158500
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00158600
&ZMS             SETC  '"VOLTYPE='              *KUKWA* MNOTE           00158700
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00158800
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00158900
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00159000
&ZMS             SETC  '&ZMS "SMS"'                                     00159100
&ZMS             SETC  '&ZMS OR "ANY".'                                 00159200
                 MNOTE 8,' &ZMS '                                       00159300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00159400
                 AGO   .ZG35E                                           00159500
.ZG35D           ANOP  ,                                                00159600
&XVOLTYPE        SETC  'SMS'       SET DEFAULT KEYWORD                  00159700
.ZG35E           ANOP  ,                                                00159800
.*-------------------------------------------------------------------   00159900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160000
.ZG36            ANOP  ,                                                00160100
&ZTLC            SETC 'DELETE'                                          00160200
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG48                  00160300
&XREQUEST        SETC  'DELETE'    SET KEYWORD                          00160400
                 AIF   (N'&REQUEST LE 1).ZG36A  CK NUM                  00160500
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00160600
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00160700
&ZMS             SETC  '&ZMS "REQUEST"'                                 00160800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00160900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00161000
.ZG36A           ANOP  ,                                                00161100
.*------------------------------------------------------------------    00161200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00161300
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00161400
.ZG36A0          AIF   (K'&TEST LE 0).ZG36A1    OK                      00161500
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00161600
.ZG36A1          AIF   (K'&FORMAT LE 0).ZG36A2  OK                      00161700
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00161800
.ZG36A2          AIF   (K'&ANSAREA LE 0).ZG36A3  OK                     00161900
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00162000
.ZG36A3          AIF   (K'&ANSLEN LE 0).ZG36A4  OK                      00162100
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00162200
.ZG36A4          AIF   (K'&ZCVAL LE 0).ZG36A5   OK                      00162300
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00162400
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00162500
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00162600
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00162700
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00162800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00162900
.ZG36A5          ANOP  ,                                                00163000
.*----------------------------------------------------------------***   00163100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00163200
                 AIF   (N'&DSNAME LE 1).ZG38A   CK NUM                  00163300
&ZMS             SETC  '"DSNAME='  *KPOSA* MNOTE                        00163400
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00163500
&ZMS             SETC  '&ZMS "DSNAME"'                                  00163600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00163700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00163800
.ZG38A           ANOP  ,                                                00163900
.*-------------------------------------------------------------------   00164000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00164100
&ZXDSNAME        SETC  'INPUT'     SET IN/OUTPUT                        00164200
&XDSNAME         SETC  '&DSNAME(1)'             SET XVARIABLE           00164300
                 AIF   (N'&DSNAME GT 1).ZG38B   MULTI PARMS             00164400
&XDSNAME         SETC  '&DSNAME'   SET XVARIABLE                        00164500
.ZG38B           AIF   (K'&DSNAME(1) GT 0).ZG38C                        00164600
&ZXDSNAME        SETC  ''          RESET IN/OUTPUT                      00164700
&ZMS             SETC  ' '         *KRQDA*                              00164800
&ZMS             SETC  '&ZMS "DSNAME" KEY AND ITS'                      00164900
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00165000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00165100
.ZG38C           ANOP  ,                                                00165200
.*-------------------------------------------------------------------   00165300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00165400
                 AIF   (K'&ZXDSNAME LE 0).ZG38R  NOT I/O                00165500
                 AIF   ('&XDSNAME'(1,1) NE '(').ZG38R                   00165600
&ZCGPR           SETC  '&XDSNAME'(2,K'&XDSNAME-2)                       00165700
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                     00165800
                 AIF   (K'&ZCGPR GT 2).ZG38Q                            00165900
                 AIF   ('&ZCGPR' EQ '0').ZG38Q                          00166000
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00166100
                 AIF   (T'&ZCGPR NE 'N').ZG38Q  INVALID REG NAME        00166200
.ZG38P           ANOP  ,                                                00166300
                 AIF   (T'&ZCGPR NE 'N').ZG38R  NON NUMERIC             00166400
                 AIF   ('&ZCGPR' LT '2').ZG38Q                          00166500
                 AIF   ('&ZCGPR' LE '12').ZG38R                         00166600
.ZG38Q           ANOP  ,                                                00166700
&ZMS             SETC  '"DSNAME='  *KGPRA* MNOTE                        00166800
&ZMS             SETC  '&ZMS.&DSNAME"'                                  00166900
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00167000
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00167100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00167200
.ZG38R           ANOP  ,                                                00167300
.*------------------------------------------------------------------    00167400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167500
&XVOLTYPE        SETC  ''          INITIALIZE XVARIABLE                 00167600
.*-------------------------------------------------------------------   00167700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167800
.ZG42            ANOP  ,                                                00167900
                 AIF   (K'&VOLTYPE(1) LE 0).ZG42A                       00168000
&ZTLC            SETC 'SMS'                                             00168100
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG43                  00168200
&XVOLTYPE        SETC  'SMS'       SET KEYWORD                          00168300
                 AIF   (N'&VOLTYPE LE 1).ZG42A  CK NUM                  00168400
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00168500
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00168600
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00168700
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00168800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00168900
.ZG42A           ANOP  ,                                                00169000
.*------------------------------------------------------------------    00169100
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169200
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00169300
.ZG42A0          AIF   (K'&VOLUME LE 0).ZG42A1  OK                      00169400
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00169500
.ZG42A1          AIF   (K'&ZCVAL LE 0).ZG42A2   OK                      00169600
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00169700
&ZMS             SETC  '"VOLTYPE'  *KMEIA* MNOTE                        00169800
&ZMS             SETC  '&ZMS.=&VOLTYPE"'                                00169900
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00170000
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00170100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00170200
.ZG42A2          ANOP  ,                                                00170300
.*-------------------------------------------------------------------   00170400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170500
.ZG43            ANOP  ,                                                00170600
&ZTLC            SETC 'ANY'                                             00170700
                 AIF   ('&VOLTYPE(1)' NE '&ZTLC').ZG47                  00170800
&XVOLTYPE        SETC  'ANY'       SET KEYWORD                          00170900
                 AIF   (N'&VOLTYPE LE 1).ZG43A  CK NUM                  00171000
&ZMS             SETC  '"VOLTYPE='              *KPOSA* MNOTE           00171100
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00171200
&ZMS             SETC  '&ZMS "VOLTYPE"'                                 00171300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00171400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00171500
.ZG43A           ANOP  ,                                                00171600
.*----------------------------------------------------------------***   00171700
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00171800
                 AIF   (N'&VOLUME LE 1).ZG45A   CK NUM                  00171900
&ZMS             SETC  '"VOLUME='  *KPOSA* MNOTE                        00172000
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00172100
&ZMS             SETC  '&ZMS "VOLUME"'                                  00172200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00172300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00172400
.ZG45A           ANOP  ,                                                00172500
.*-------------------------------------------------------------------   00172600
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00172700
&ZXVOLUME        SETC  'INPUT'     SET IN/OUTPUT                        00172800
&XVOLUME         SETC  '&VOLUME(1)'             SET XVARIABLE           00172900
                 AIF   (N'&VOLUME GT 1).ZG45B   MULTI PARMS             00173000
&XVOLUME         SETC  '&VOLUME'   SET XVARIABLE                        00173100
.ZG45B           AIF   (K'&VOLUME(1) GT 0).ZG45C                        00173200
&ZXVOLUME        SETC  ''          RESET IN/OUTPUT                      00173300
&ZMS             SETC  'WHEN "ANY" IS SPECIFIED'  *KRQDA*               00173400
&ZMS             SETC  '&ZMS , "VOLUME" KEY AND ITS'                    00173500
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00173600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00173700
.ZG45C           ANOP  ,                                                00173800
.*-------------------------------------------------------------------   00173900
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00174000
                 AIF   (K'&ZXVOLUME LE 0).ZG45R  NOT I/O                00174100
                 AIF   ('&XVOLUME'(1,1) NE '(').ZG45R                   00174200
&ZCGPR           SETC  '&XVOLUME'(2,K'&XVOLUME-2)                       00174300
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG45P                     00174400
                 AIF   (K'&ZCGPR GT 2).ZG45Q                            00174500
                 AIF   ('&ZCGPR' EQ '0').ZG45Q                          00174600
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00174700
                 AIF   (T'&ZCGPR NE 'N').ZG45Q  INVALID REG NAME        00174800
.ZG45P           ANOP  ,                                                00174900
                 AIF   (T'&ZCGPR NE 'N').ZG45R  NON NUMERIC             00175000
                 AIF   ('&ZCGPR' LT '2').ZG45Q                          00175100
                 AIF   ('&ZCGPR' LE '12').ZG45R                         00175200
.ZG45Q           ANOP  ,                                                00175300
&ZMS             SETC  '"VOLUME='  *KGPRA* MNOTE                        00175400
&ZMS             SETC  '&ZMS.&VOLUME"'                                  00175500
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00175600
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00175700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00175800
.ZG45R           ANOP  ,                                                00175900
.*------------------------------------------------------------------    00176000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00176100
.ZG47            ANOP  ,                                                00176200
&ZXVOLTYPE       SETC  'INPUT'     SET IN/OUTPUT                        00176300
                 AIF   (K'&XVOLTYPE GT 0).ZG47E  VALID ARG              00176400
                 AIF   (T'&VOLTYPE EQ 'O').ZG47D  OMITTED               00176500
&ZASYSLNDX       SETA  0                                                00176600
.ZG47A           ANOP  ,           POSITIONAL MACRO KEY                 00176700
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00176800
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG47C                 00176900
&ZTLC            SETC 'VOLTYPE'                                         00177000
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG47A        00177100
.ZG47B           ANOP  ,                                                00177200
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00177300
&ZMS             SETC  'THE "VOLTYPE" KEY'      *KOPTA* MNOTE           00177400
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00177500
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00177600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00177700
                 AGO   .ZG47E                                           00177800
.ZG47C           ANOP  ,                                                00177900
&ZXVOLTYPE       SETC  ''          RESET IN/OUTPUT                      00178000
&ZMS             SETC  '"VOLTYPE='              *KUKWA* MNOTE           00178100
&ZMS             SETC  '&ZMS.&VOLTYPE"'                                 00178200
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00178300
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00178400
&ZMS             SETC  '&ZMS "SMS"'                                     00178500
&ZMS             SETC  '&ZMS OR "ANY".'                                 00178600
                 MNOTE 8,' &ZMS '                                       00178700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00178800
                 AGO   .ZG47E                                           00178900
.ZG47D           ANOP  ,                                                00179000
&XVOLTYPE        SETC  'SMS'       SET DEFAULT KEYWORD                  00179100
.ZG47E           ANOP  ,                                                00179200
.*-------------------------------------------------------------------   00179300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00179400
.ZG48            ANOP  ,                                                00179500
&ZTLC            SETC 'DYNFORMAT'                                       00179600
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG49                  00179700
&XREQUEST        SETC  'DYNFORMAT'              SET KEYWORD             00179800
                 AIF   (N'&REQUEST LE 1).ZG48A  CK NUM                  00179900
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00180000
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00180100
&ZMS             SETC  '&ZMS "REQUEST"'                                 00180200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00180300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00180400
.ZG48A           ANOP  ,                                                00180500
.*------------------------------------------------------------------    00180600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180700
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00180800
.ZG48A0          AIF   (K'&DSNAME LE 0).ZG48A1  OK                      00180900
&ZCVAL           SETC '&ZCVAL DSNAME'           INCORRECT KEY USED      00181000
.ZG48A1          AIF   (K'&VOLTYPE LE 0).ZG48A2  OK                     00181100
&ZCVAL           SETC '&ZCVAL VOLTYPE'          INCORRECT KEY USED      00181200
.ZG48A2          AIF   (K'&VOLUME LE 0).ZG48A3  OK                      00181300
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00181400
.ZG48A3          AIF   (K'&TEST LE 0).ZG48A4    OK                      00181500
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00181600
.ZG48A4          AIF   (K'&FORMAT LE 0).ZG48A5  OK                      00181700
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00181800
.ZG48A5          AIF   (K'&ANSAREA LE 0).ZG48A6  OK                     00181900
&ZCVAL           SETC '&ZCVAL ANSAREA'          INCORRECT KEY USED      00182000
.ZG48A6          AIF   (K'&ANSLEN LE 0).ZG48A7  OK                      00182100
&ZCVAL           SETC '&ZCVAL ANSLEN'           INCORRECT KEY USED      00182200
.ZG48A7          AIF   (K'&ZCVAL LE 0).ZG48A8   OK                      00182300
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00182400
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00182500
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00182600
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00182700
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00182800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00182900
.ZG48A8          ANOP  ,                                                00183000
.*-------------------------------------------------------------------   00183100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183200
.ZG49            ANOP  ,                                                00183300
&ZTLC            SETC 'LIST'                                            00183400
                 AIF   ('&REQUEST(1)' NE '&ZTLC').ZG56                  00183500
&XREQUEST        SETC  'LIST'      SET KEYWORD                          00183600
                 AIF   (N'&REQUEST LE 1).ZG49A  CK NUM                  00183700
&ZMS             SETC  '"REQUEST='              *KPOSA* MNOTE           00183800
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00183900
&ZMS             SETC  '&ZMS "REQUEST"'                                 00184000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00184100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00184200
.ZG49A           ANOP  ,                                                00184300
.*------------------------------------------------------------------    00184400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00184500
&ZCVAL           SETC ''           CLEAR ERROR KEY ACCUMULATOR          00184600
.ZG49A0          AIF   (K'&DSNAME LE 0).ZG49A1  OK                      00184700
&ZCVAL           SETC '&ZCVAL DSNAME'           INCORRECT KEY USED      00184800
.ZG49A1          AIF   (K'&VOLTYPE LE 0).ZG49A2  OK                     00184900
&ZCVAL           SETC '&ZCVAL VOLTYPE'          INCORRECT KEY USED      00185000
.ZG49A2          AIF   (K'&VOLUME LE 0).ZG49A3  OK                      00185100
&ZCVAL           SETC '&ZCVAL VOLUME'           INCORRECT KEY USED      00185200
.ZG49A3          AIF   (K'&TEST LE 0).ZG49A4    OK                      00185300
&ZCVAL           SETC '&ZCVAL TEST'             INCORRECT KEY USED      00185400
.ZG49A4          AIF   (K'&FORMAT LE 0).ZG49A5  OK                      00185500
&ZCVAL           SETC '&ZCVAL FORMAT'           INCORRECT KEY USED      00185600
.ZG49A5          AIF   (K'&ZCVAL LE 0).ZG49A6   OK                      00185700
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)                            00185800
&ZMS             SETC  '"REQUEST'  *KMEIA* MNOTE                        00185900
&ZMS             SETC  '&ZMS.=&REQUEST"'                                00186000
&ZMS             SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'             00186100
                 MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'             00186200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00186300
.ZG49A6          ANOP  ,                                                00186400
.*----------------------------------------------------------------***   00186500
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00186600
                 AIF   (N'&ANSAREA LE 1).ZG51A  CK NUM                  00186700
&ZMS             SETC  '"ANSAREA='              *KPOSA* MNOTE           00186800
&ZMS             SETC  '&ZMS.&ANSAREA"'                                 00186900
&ZMS             SETC  '&ZMS "ANSAREA"'                                 00187000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00187100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00187200
.ZG51A           ANOP  ,                                                00187300
.*-------------------------------------------------------------------   00187400
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00187500
&ZXANSAREA       SETC  'OUTPUT'    SET IN/OUTPUT                        00187600
&XANSAREA        SETC  '&ANSAREA(1)'            SET XVARIABLE           00187700
                 AIF   (N'&ANSAREA GT 1).ZG51B  MULTI PARMS             00187800
&XANSAREA        SETC  '&ANSAREA'  SET XVARIABLE                        00187900
.ZG51B           AIF   (K'&ANSAREA(1) GT 0).ZG51C                       00188000
&ZXANSAREA       SETC  ''          RESET IN/OUTPUT                      00188100
&ZMS             SETC  ' '         *KRQDA*                              00188200
&ZMS             SETC  '&ZMS "ANSAREA" KEY AND ITS'                     00188300
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00188400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00188500
.ZG51C           ANOP  ,                                                00188600
.*-------------------------------------------------------------------   00188700
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00188800
                 AIF   (K'&ZXANSAREA LE 0).ZG51R  NOT I/O               00188900
                 AIF   ('&XANSAREA'(1,1) NE '(').ZG51R                  00189000
&ZCGPR           SETC  '&XANSAREA'(2,K'&XANSAREA-2)                     00189100
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG51P                     00189200
                 AIF   (K'&ZCGPR GT 2).ZG51Q                            00189300
                 AIF   ('&ZCGPR' EQ '0').ZG51Q                          00189400
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00189500
                 AIF   (T'&ZCGPR NE 'N').ZG51Q  INVALID REG NAME        00189600
.ZG51P           ANOP  ,                                                00189700
                 AIF   (T'&ZCGPR NE 'N').ZG51R  NON NUMERIC             00189800
                 AIF   ('&ZCGPR' LT '2').ZG51Q                          00189900
                 AIF   ('&ZCGPR' LE '12').ZG51R                         00190000
.ZG51Q           ANOP  ,                                                00190100
&ZMS             SETC  '"ANSAREA='              *KGPRA* MNOTE           00190200
&ZMS             SETC  '&ZMS.&ANSAREA"'                                 00190300
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00190400
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00190500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00190600
.ZG51R           ANOP  ,                                                00190700
.*----------------------------------------------------------------***   00190800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00190900
                 AIF   (N'&ANSLEN LE 1).ZG54A   CK NUM                  00191000
&ZMS             SETC  '"ANSLEN='  *KPOSA* MNOTE                        00191100
&ZMS             SETC  '&ZMS.&ANSLEN"'                                  00191200
&ZMS             SETC  '&ZMS "ANSLEN"'                                  00191300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00191400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00191500
.ZG54A           ANOP  ,                                                00191600
.*-------------------------------------------------------------------   00191700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00191800
&ZXANSLEN        SETC  'INPUT'     SET IN/OUTPUT                        00191900
&XANSLEN         SETC  '&ANSLEN(1)'             SET XVARIABLE           00192000
                 AIF   (N'&ANSLEN GT 1).ZG54B   MULTI PARMS             00192100
&XANSLEN         SETC  '&ANSLEN'   SET XVARIABLE                        00192200
.ZG54B           AIF   (K'&ANSLEN(1) GT 0).ZG54C                        00192300
&ZXANSLEN        SETC  ''          RESET IN/OUTPUT                      00192400
&ZMS             SETC  ' '         *KRQDA*                              00192500
&ZMS             SETC  '&ZMS "ANSLEN" KEY AND ITS'                      00192600
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00192700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00192800
.ZG54C           ANOP  ,                                                00192900
.*-------------------------------------------------------------------   00193000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00193100
                 AIF   (K'&ZXANSLEN LE 0).ZG54R  NOT I/O                00193200
                 AIF   ('&XANSLEN'(1,1) NE '(').ZG54R                   00193300
&ZCGPR           SETC  '&XANSLEN'(2,K'&XANSLEN-2)                       00193400
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG54P                     00193500
                 AIF   (K'&ZCGPR GT 2).ZG54Q                            00193600
                 AIF   ('&ZCGPR' EQ '0').ZG54Q                          00193700
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00193800
                 AIF   (T'&ZCGPR NE 'N').ZG54Q  INVALID REG NAME        00193900
.ZG54P           ANOP  ,                                                00194000
                 AIF   (T'&ZCGPR NE 'N').ZG54R  NON NUMERIC             00194100
                 AIF   ('&ZCGPR' LT '2').ZG54Q                          00194200
                 AIF   ('&ZCGPR' LE '12').ZG54R                         00194300
.ZG54Q           ANOP  ,                                                00194400
&ZMS             SETC  '"ANSLEN='  *KGPRA* MNOTE                        00194500
&ZMS             SETC  '&ZMS.&ANSLEN"'                                  00194600
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00194700
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00194800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00194900
.ZG54R           ANOP  ,                                                00195000
.*------------------------------------------------------------------    00195100
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00195200
.ZG56            ANOP  ,                                                00195300
&ZXREQUEST       SETC  'INPUT'     SET IN/OUTPUT                        00195400
                 AIF   (K'&XREQUEST GT 0).ZG56E  VALID ARG              00195500
                 AIF   (T'&REQUEST EQ 'O').ZG56D  OMITTED               00195600
&ZASYSLNDX       SETA  0                                                00195700
.ZG56A           ANOP  ,           POSITIONAL MACRO KEY                 00195800
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00195900
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG56C                 00196000
&ZTLC            SETC 'REQUEST'                                         00196100
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG56A        00196200
.ZG56B           ANOP  ,                                                00196300
&ZXREQUEST       SETC  ''          RESET IN/OUTPUT                      00196400
&ZMS             SETC  'THE "REQUEST" KEY'      *KOPTA* MNOTE           00196500
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00196600
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00196700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00196800
                 AGO   .ZG56E                                           00196900
.ZG56C           ANOP  ,                                                00197000
&ZXREQUEST       SETC  ''          RESET IN/OUTPUT                      00197100
&ZMS             SETC  '"REQUEST='              *KUKWA* MNOTE           00197200
&ZMS             SETC  '&ZMS.&REQUEST"'                                 00197300
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00197400
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00197500
&ZMS             SETC  '&ZMS "QUERY",'                                  00197600
&ZMS             SETC  '&ZMS "QUERYFORMAT",'                            00197700
&ZMS             SETC  '&ZMS "ADD",'                                    00197800
&ZMS             SETC  '&ZMS "DELETE",'                                 00197900
&ZMS             SETC  '&ZMS "DYNFORMAT",'                              00198000
&ZMS             SETC  '&ZMS OR "LIST".'                                00198100
                 MNOTE 8,' &ZMS '                                       00198200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00198300
                 AGO   .ZG56E                                           00198400
.ZG56D           ANOP  ,                                                00198500
&XREQUEST        SETC  'QUERY'     SET DEFAULT KEYWORD                  00198600
.ZG56E           ANOP  ,                                                00198700
.*------------------------------------------------------------------    00198800
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00198900
                 AIF   (K'&REQUEST(1) GT 0).ZG56F  PARM                 00199000
&XREQUEST        SETC  ''          ENSURE NULL KEYWORD                  00199100
&ZXREQUEST       SETC  ''          RESET IN/OUTPUT                      00199200
&ZMS             SETC  'THE'                                            00199300
&ZMS             SETC  '&ZMS "REQUEST" KEY AND ITS'                     00199400
&ZMS             SETC  '&ZMS ARGUMENT ARE REQUIRED.'                    00199500
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00199600
&ZMS             SETC  '&ZMS "QUERY",'                                  00199700
&ZMS             SETC  '&ZMS "QUERYFORMAT",'                            00199800
&ZMS             SETC  '&ZMS "ADD",'                                    00199900
&ZMS             SETC  '&ZMS "DELETE",'                                 00200000
&ZMS             SETC  '&ZMS "DYNFORMAT",'                              00200100
&ZMS             SETC  '&ZMS OR "LIST".'                                00200200
                 MNOTE 8,' &ZMS '                                       00200300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00200400
.ZG56F           ANOP  ,                                                00200500
.*----------------------------------------------------------------***   00200600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00200700
                 AIF   (N'&RETCODE LE 1).ZG58A  CK NUM                  00200800
&ZMS             SETC  '"RETCODE='              *KPOSA* MNOTE           00200900
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00201000
&ZMS             SETC  '&ZMS "RETCODE"'                                 00201100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00201200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00201300
.ZG58A           ANOP  ,                                                00201400
.*-------------------------------------------------------------------   00201500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00201600
                 AIF   (K'&RETCODE(1) LE 0).ZG58C  NO PARM              00201700
&ZXRETCODE       SETC  'OUTPUT'    SET OUTPUT                           00201800
&XRETCODE        SETC  '&RETCODE(1)'            SET XVARIABLE           00201900
                 AIF   (N'&RETCODE GT 1).ZG58C                          00202000
&XRETCODE        SETC  '&RETCODE'  SET XVARIABLE                        00202100
.ZG58C           ANOP  ,                                                00202200
.*-------------------------------------------------------------------   00202300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00202400
                 AIF   (K'&ZXRETCODE LE 0).ZG58R  NOT I/O               00202500
                 AIF   ('&XRETCODE'(1,1) NE '(').ZG58R                  00202600
&ZCGPR           SETC  '&XRETCODE'(2,K'&XRETCODE-2)                     00202700
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG58P                     00202800
                 AIF   (K'&ZCGPR GT 2).ZG58Q                            00202900
                 AIF   ('&ZCGPR' EQ '0').ZG58Q                          00203000
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00203100
                 AIF   (T'&ZCGPR NE 'N').ZG58Q  INVALID REG NAME        00203200
.ZG58P           ANOP  ,                                                00203300
                 AIF   (T'&ZCGPR NE 'N').ZG58R  NON NUMERIC             00203400
                 AIF   ('&ZCGPR' LT '2').ZG58Q                          00203500
                 AIF   ('&ZCGPR' LE '12').ZG58R                         00203600
.ZG58Q           ANOP  ,                                                00203700
&ZMS             SETC  '"RETCODE='              *KGPRA* MNOTE           00203800
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00203900
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00204000
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00204100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00204200
.ZG58R           ANOP  ,                                                00204300
.*----------------------------------------------------------------***   00204400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00204500
                 AIF   (N'&RSNCODE LE 1).ZG61A  CK NUM                  00204600
&ZMS             SETC  '"RSNCODE='              *KPOSA* MNOTE           00204700
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00204800
&ZMS             SETC  '&ZMS "RSNCODE"'                                 00204900
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00205000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00205100
.ZG61A           ANOP  ,                                                00205200
.*-------------------------------------------------------------------   00205300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00205400
                 AIF   (K'&RSNCODE(1) LE 0).ZG61C  NO PARM              00205500
&ZXRSNCODE       SETC  'OUTPUT'    SET OUTPUT                           00205600
&XRSNCODE        SETC  '&RSNCODE(1)'            SET XVARIABLE           00205700
                 AIF   (N'&RSNCODE GT 1).ZG61C                          00205800
&XRSNCODE        SETC  '&RSNCODE'  SET XVARIABLE                        00205900
.ZG61C           ANOP  ,                                                00206000
.*-------------------------------------------------------------------   00206100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00206200
                 AIF   (K'&ZXRSNCODE LE 0).ZG61R  NOT I/O               00206300
                 AIF   ('&XRSNCODE'(1,1) NE '(').ZG61R                  00206400
&ZCGPR           SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                     00206500
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                     00206600
                 AIF   (K'&ZCGPR GT 2).ZG61Q                            00206700
                 AIF   ('&ZCGPR' EQ '0').ZG61Q                          00206800
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00206900
                 AIF   (T'&ZCGPR NE 'N').ZG61Q  INVALID REG NAME        00207000
.ZG61P           ANOP  ,                                                00207100
                 AIF   (T'&ZCGPR NE 'N').ZG61R  NON NUMERIC             00207200
                 AIF   ('&ZCGPR' LT '2').ZG61Q                          00207300
                 AIF   ('&ZCGPR' LE '12').ZG61R                         00207400
.ZG61Q           ANOP  ,                                                00207500
&ZMS             SETC  '"RSNCODE='              *KGPRA* MNOTE           00207600
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00207700
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00207800
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00207900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00208000
.ZG61R           ANOP  ,                                                00208100
.******************************************************************     00208200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00208300
.******************************************************************     00208400
                 ACTR  10000                                            00208500
.*----------------------------------------------------------------***   00208600
.***AH.P02 EXTRA POSITIONALS                                            00208700
                 AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS             00208800
                 AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL             00208900
                 AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL         00209000
                 AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL          00209100
.ZGLISTX1        ANOP  ,                                                00209200
&ZCVAL           SETC  ''          ERROR FIELD                          00209300
&ZAWRK           SETA  0           POSITIONAL NUMBER                    00209400
.ZGLIST2         ANOP  ,                                                00209500
&ZAWRK           SETA  &ZAWRK+1    NEXT POSITIONAL                      00209600
                 AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE             00209700
&ZCVAL           SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                  00209800
                 AGO   .ZGLIST2                                         00209900
.*                                                                      00210000
.ZGLIST3         ANOP  ,                                                00210100
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)    STRIP COMMA             00210200
&ZMS             SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE         00210300
&ZMS             SETC  '&ZMS "&ZCVAL"'                                  00210400
&ZMS             SETC  '&ZMS CANNOT BE USED.'                           00210500
&ZMS             SETC  '&ZMS NO POSITIONAL ARGUMENTS'                   00210600
                 MNOTE 8,' &ZMS ARE ALLOWED.'                           00210700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00210800
.ZGLISTX         ANOP  ,                                                00210900
&ZASYSLNDX       SETA  0                                                00211000
.*-------------------------------------------------------------------   00211100
.***AG.MF04 MF=(SLE)                                                    00211200
.ZGMFX           ANOP  ,           END OF FULL SYNTAX CHECK             00211300
.*******************************************************************    00211400
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00211500
.*******************************************************************    00211600
                 AIF   (&ZMACRET NE 0).ZLX2     ERROR DETECTED          00211700
.*******************************************************************    00211800
.***AE.01  START OF CSVAPF MACRO CODE                                   00211900
.*******************************************************************    00212000
                 LCLC  &M0M0001                 NAME                    00212100
&M0M0001         SETC  '&XLABEL'                SET NAME                00212200
                 AIF   (K'&XLABEL NE 0).XLAB2                           00212300
&M0M0001         SETC  'M00M&SYSNDX'            DEFAULT NAME            00212400
.*                                                                      00212500
.XLAB2           ANOP  ,                                                00212600
                 AIF   ('&XMF' EQ 'L').XLAB3                            00212700
&M0M0001 DS    0H                             CSVAPF-0                  00212800
.XLAB3           ANOP  ,                                                00212900
.*******************************************************************    00213000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00213100
.*******************************************************************    00213200
              PUSH  PRINT                                               00213300
                 AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON       00213400
                 PRINT OFF         ++ PR01                              00213500
                 AGO   .ZPRNTXX                                         00213600
.ZPRINTX         PRINT ON                                               00213700
.ZPRNTXX         ANOP  ,                                                00213800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00213900
         LCLC  &T2,&T1                                                  00214000
         LCLA  &A1                                                      00214100
         AIF   ('&REQUEST' NE 'QUERYFORMAT').NOQF                       00214200
    AIF ('&MF' EQ '' AND '&RETCODE' EQ '' AND '&RSNCODE' EQ '').OKRET   00214300
&T1      SETC  'MF, RETCODE AND RSNCODE ARE NOT VALID WITH '            00214400
&T1      SETC  '&T1.REQUEST=QUERYFORMAT'                                00214500
         MNOTE 4,'&T1'                                                  00214600
.OKRET   ANOP                                                           00214700
         L     15,16(0,0)              GET CVT                          00214800
         L     15,140(15,0)            GET ECVT                         00214900
         L     15,228(15,0)                                             00215000
         AIF   ('&SYSASCE' EQ 'P').NOAR                                 00215100
         LAE   15,0(15,0)              CLEAR AR15                       00215200
.NOAR    ANOP                                                           00215300
         AIF   ('&FORMAT'(1,1) NE '(').LREG  Not a reg, branch          00215400
&T1      SETC  '&FORMAT'(2,K'&FORMAT-2)  Isolate reg number             00215500
&T1      SETC  '0(1,&T1.)'             Target expression                00215600
         AGO   .MREG                                                    00215700
.LREG    ANOP                          Not a reg                        00215800
&A1      SETA  K'&FORMAT               Length of expression             00215900
         AIF   ('&FORMAT'(&A1,1) NE ')').NOTRX  Branch if not RX        00216000
&A2      SETA  2                                                        00216100
.OREG    ANOP                          Loop to find open paren          00216200
         AIF   (&A2 GE &A1).NOTRX      Reached end, treat as non-RX     00216300
         AIF   ('&FORMAT'(&A2,1) NE '(').NREG  Not open paren, branch   00216400
&T1      SETC  '&FORMAT'(1,&A2).'1'.','    Found paren                  00216500
&T1      SETC  '&T1'.'&FORMAT'(&A2+1,&A1-&A2)  Create expression        00216600
         AGO   .MREG                                                    00216700
.NREG    ANOP                          Continue loop                    00216800
&A2      SETA  &A2+1                   Next character                   00216900
         AGO   .OREG                   Repeat                           00217000
.NOTRX   ANOP                          Not an RX-address                00217100
&T1      SETC  '&FORMAT(1).(1)'        Get expression                   00217200
.MREG    ANOP                          Produce resulting statement      00217300
         MVC   &T1,25(15)              GET FORMAT VALUE                 00217400
         POP   PRINT                                               @L1A 00217500
         MEXIT                                                          00217600
.NOQF    ANOP                                                           00217700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00217800
.********************************************************************   00217900
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00218000
.********************************************************************   00218100
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00218200
                      LCLA  &ZOPN1         INVOCATION INDEX             00218300
                      LCLC  &ZOPL(4095)    LABEL                        00218400
                      LCLC  &ZOPO(4095)    OPERATION                    00218500
                      LCLC  &ZOPV(4095)    VALUE                        00218600
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00218700
.*                                                                      00218800
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00218900
.******************************************************************     00219000
.***AL.L10 CSVAPF FMT=LIST MF=S!L PARAMETERS                            00219100
.******************************************************************     00219200
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00219300
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00219400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00219500
&XMFATTR              SETC  '0D'                                        00219600
.*                                                                      00219700
&ZOPN                 SETA  &ZOPN+1                                     00219800
&ZOPL(&ZOPN)          SETC  ' '                                         00219900
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00220000
&ZOPO(&ZOPN)          SETC  'B'                                         00220100
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00220200
                      AGO   .ZALVL6B                                    00220300
.ZALVL6A              ANOP                                              00220400
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00220500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00220600
.ZALVL6B              ANOP                                              00220700
&ZOPD(&ZOPN)          SETC  '++ CSVAPF ARG PARMS'                       00220800
.*                                                                      00220900
&ZOPN                 SETA  &ZOPN+1                                     00221000
&ZOPL(&ZOPN)          SETC  ' '                                         00221100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00221200
&ZOPV(&ZOPN)          SETC  '1'                                         00221300
&ZOPD(&ZOPN)          SETC  ' '                                         00221400
.*                                                                      00221500
.ZLMFSL2              ANOP  ,                                           00221600
.*-------------------------------------------------------------------   00221700
.***AM.L00  CSVAPF FMT=LIST name                                        00221800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00221900
&ZOPN                 SETA &ZOPN+1                                      00222000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00222100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00222200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00222300
&ZOPD(&ZOPN)          SETC '++ CSVAPF NAME'                             00222400
.ZLMFSL2M             ANOP  ,                                           00222500
.*-------------------------------------------------------------------   00222600
.***AM.L01  CSVAPF FMT=LIST PARAMETERS                                  00222700
&ZOPN                 SETA &ZOPN+1                                      00222800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00222900
&ZOPO(&ZOPN)          SETC 'DS'                                         00223000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00223100
&ZOPD(&ZOPN)          SETC '++ CSVAPF PARM LIST'                        00223200
.*-------------------------------------------------------------------   00223300
.***AM.L02 XVERSION XL1                                                 00223400
&ZOPN                 SETA &ZOPN+1                                      00223500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00223600
&ZOPO(&ZOPN)          SETC 'DS'                                         00223700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00223800
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00223900
.*-------------------------------------------------------------------   00224000
.***AM.L05 XREQUEST XL1                                                 00224100
&ZOPN                 SETA &ZOPN+1                                      00224200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00224300
&ZOPO(&ZOPN)          SETC 'DS'                                         00224400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00224500
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00224600
.*                                                                      00224700
&ZOPN                 SETA  &ZOPN+1                                     00224800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_QUERY'                  00224900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00225000
&ZOPV(&ZOPN)          SETC  '0'                                         00225100
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00225200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).QUERY'                        00225300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00225400
.*                                                                      00225500
&ZOPN                 SETA  &ZOPN+1                                     00225600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_ADD'                    00225700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00225800
&ZOPV(&ZOPN)          SETC  '1'                                         00225900
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00226000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ADD'                          00226100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00226200
.*                                                                      00226300
&ZOPN                 SETA  &ZOPN+1                                     00226400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_DELETE'                 00226500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00226600
&ZOPV(&ZOPN)          SETC  '2'                                         00226700
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00226800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DELETE'                       00226900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00227000
.*                                                                      00227100
&ZOPN                 SETA  &ZOPN+1                                     00227200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_LIST'                   00227300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00227400
&ZOPV(&ZOPN)          SETC  '3'                                         00227500
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00227600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LIST'                         00227700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00227800
.*                                                                      00227900
&ZOPN                 SETA  &ZOPN+1                                     00228000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_DYNFORMAT'              00228100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00228200
&ZOPV(&ZOPN)          SETC  '4'                                         00228300
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00228400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DYNFORMAT'                    00228500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00228600
.*-------------------------------------------------------------------   00228700
.***AM.L03 XFLAGS BL.8                                                  00228800
&ZOPN                 SETA &ZOPN+1                                      00228900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00229000
&ZOPO(&ZOPN)          SETC 'DS'                                         00229100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00229200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00229300
.*                                                                      00229400
&ZOPN                 SETA  &ZOPN+1                                     00229500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XVOLTYPE_ANY'                    00229600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00229700
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00229800
&ZOPD(&ZOPN)          SETC  '++ XVOLTYPE.'                              00229900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ANY'                          00230000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00230100
.*-------------------------------------------------------------------   00230200
.***AM.L09  XRSV0001 CL1                                                00230300
&ZOPN                 SETA &ZOPN+1                                      00230400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00230500
&ZOPO(&ZOPN)          SETC 'DS'                                         00230600
&ZOPV(&ZOPN)          SETC 'CL1'                                        00230700
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00230800
.*-------------------------------------------------------------------   00230900
.***AM.L09  XDSNAME CL44                                                00231000
&ZOPN                 SETA &ZOPN+1                                      00231100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDSNAME'                          00231200
&ZOPO(&ZOPN)          SETC 'DS'                                         00231300
&ZOPV(&ZOPN)          SETC 'CL44'                                       00231400
&ZOPD(&ZOPN)          SETC '++ &ZXDSNAME  XDSNAME'                      00231500
.*-------------------------------------------------------------------   00231600
.***AM.L09  XVOLUME CL6                                                 00231700
&ZOPN                 SETA &ZOPN+1                                      00231800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVOLUME'                          00231900
&ZOPO(&ZOPN)          SETC 'DS'                                         00232000
&ZOPV(&ZOPN)          SETC 'CL6'                                        00232100
&ZOPD(&ZOPN)          SETC '++ &ZXVOLUME  XVOLUME'                      00232200
.*-------------------------------------------------------------------   00232300
.***AM.L09  XRSV0002 CL2                                                00232400
&ZOPN                 SETA &ZOPN+1                                      00232500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00232600
&ZOPO(&ZOPN)          SETC 'DS'                                         00232700
&ZOPV(&ZOPN)          SETC 'CL2'                                        00232800
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      00232900
.*-------------------------------------------------------------------   00233000
.***AM.L09 ADDR XANSAREA A                                              00233100
&ZOPN                 SETA &ZOPN+1                                      00233200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ADDR'                    00233300
&ZOPO(&ZOPN)          SETC 'DS'                                         00233400
&ZOPV(&ZOPN)          SETC 'A'                                          00233500
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ADDR XANSAREA'                00233600
.*-------------------------------------------------------------------   00233700
.***AM.L09 ALET XANSAREA F                                              00233800
&ZOPN                 SETA &ZOPN+1                                      00233900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA_ALET'                    00234000
&ZOPO(&ZOPN)          SETC 'DS'                                         00234100
&ZOPV(&ZOPN)          SETC 'F'                                          00234200
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA ALET XANSAREA'                00234300
.*-------------------------------------------------------------------   00234400
.***AM.L09  XANSLEN F                                                   00234500
&ZOPN                 SETA &ZOPN+1                                      00234600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00234700
&ZOPO(&ZOPN)          SETC 'DS'                                         00234800
&ZOPV(&ZOPN)          SETC 'F'                                          00234900
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN  XANSLEN'                      00235000
.*-------------------------------------------------------------------   00235100
.***AM.L10 END OF CSVAPF LIST PARAMETERS                                00235200
&ZOPN                 SETA &ZOPN+1                                      00235300
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00235400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00235500
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00235600
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00235700
.*                                                                      00235800
&ZOPN                 SETA &ZOPN+1                                      00235900
&ZOPL(&ZOPN)          SETC ' '                                          00236000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00236100
&ZOPV(&ZOPN)          SETC '1'                                          00236200
&ZOPD(&ZOPN)          SETC ' '                                          00236300
.*-------------------------------------------------------------------   00236400
.***AL.L12 CSVAPF FMT=LIST MF=S!L PARAMETERS                            00236500
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00236600
.*                                                                      00236700
&ZOPN                 SETA  &ZOPN+1                                     00236800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00236900
&ZOPO(&ZOPN)          SETC  'DC'                                        00237000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00237100
&ZOPD(&ZOPN)          SETC  '++ CSVAPF ARG PARMS'                       00237200
.*                                                                      00237300
.ZLMFSLX              ANOP  ,                                           00237400
.*-------------------------------------------------------------------   00237500
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00237600
&ZPLLEN               SETA 68                                           00237700
.*                                                                      00237800
.******************************************************************     00237900
.***AI.L01 CSVAPF FMT=LIST FILL IN PARAMETER AREA                       00238000
.******************************************************************     00238100
                      ACTR  10000                                       00238200
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00238300
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00238400
&ZCVAL                SETC  'LAE'          XAX MODE                     00238500
.ZIMFXA               ANOP ,                                            00238600
.*                                                                      00238700
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00238800
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00238900
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00239000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00239100
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00239200
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00239300
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00239400
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00239500
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00239600
&ZOPN                 SETA  &ZOPN+1                                     00239700
&ZOPL(&ZOPN)          SETC  ' '                                         00239800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00239900
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00240000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00240100
                      AGO   .ZIMFNX                                     00240200
.*                                                                      00240300
.ZIMFN2               ANOP ,                                            00240400
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00240500
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00240600
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00240700
&ZOPN                 SETA  &ZOPN+1                                     00240800
&ZOPL(&ZOPN)          SETC  ' '                                         00240900
&ZOPO(&ZOPN)          SETC  'LAE'                                       00241000
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00241100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00241200
                      AGO   .ZIMFNX                                     00241300
.ZIMFNX1              ANOP ,                                            00241400
&ZOPN                 SETA  &ZOPN+1                                     00241500
&ZOPL(&ZOPN)          SETC  ' '                                         00241600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00241700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00241800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00241900
.ZIMFNX               ANOP ,                                            00242000
.********************************************************************   00242100
.***AI.L02 CSVAPF FMT=LIST INITIALIZE PARAMETER AREA                    00242200
.********************************************************************   00242300
.***AI.L03 MF=(SLE)                                                     00242400
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00242500
.*                                                                      00242600
&ZOPN                 SETA  &ZOPN+1                                     00242700
&ZOPL(&ZOPN)          SETC  ' '                                         00242800
&ZOPO(&ZOPN)          SETC  'XC'                                        00242900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00243000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00243100
.ZIMFLX               ANOP  ,                                           00243200
.*-------------------------------------------------------------------   00243300
.***AI.L07 XREQUEST AL1                                                 00243400
&ZW                   SETC  ''                                          00243500
.*-------------------------------------------------------------------   00243600
.***AI.L15 XREQUEST "QUERY" AL1                                         00243700
         AIF   ('&XREQUEST' NE 'QUERY').ZI3A                            00243800
&ZW                   SETC  '0'                                         00243900
.ZI3A                 ANOP  ,                                           00244000
.*-------------------------------------------------------------------   00244100
.***AI.L15 XREQUEST "ADD" AL1                                           00244200
         AIF   ('&XREQUEST' NE 'ADD').ZI4A                              00244300
&ZW                   SETC  '1'                                         00244400
.ZI4A                 ANOP  ,                                           00244500
.*-------------------------------------------------------------------   00244600
.***AI.L15 XREQUEST "DELETE" AL1                                        00244700
         AIF   ('&XREQUEST' NE 'DELETE').ZI5A                           00244800
&ZW                   SETC  '2'                                         00244900
.ZI5A                 ANOP  ,                                           00245000
.*-------------------------------------------------------------------   00245100
.***AI.L15 XREQUEST "LIST" AL1                                          00245200
         AIF   ('&XREQUEST' NE 'LIST').ZI6A                             00245300
&ZW                   SETC  '3'                                         00245400
.ZI6A                 ANOP  ,                                           00245500
.*-------------------------------------------------------------------   00245600
.***AI.L15 XREQUEST "DYNFORMAT" AL1                                     00245700
         AIF   ('&XREQUEST' NE 'DYNFORMAT').ZI7A                        00245800
&ZW                   SETC  '4'                                         00245900
.ZI7A                 ANOP  ,                                           00246000
.*-------------------------------------------------------------------   00246100
.***AI.L17 XREQUEST AL1                                                 00246200
                      AIF   ('&ZW' EQ '0').ZI7B                         00246300
                      AIF   ('&ZW' EQ '').ZI7B                          00246400
.*                                                                      00246500
&ZOPN                 SETA  &ZOPN+1                                     00246600
&ZOPL(&ZOPN)          SETC  ' '                                         00246700
&ZOPO(&ZOPN)          SETC  'MVI'                                       00246800
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  00246900
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00247000
.ZI7B                 ANOP  ,                                           00247100
.*-------------------------------------------------------------------   00247200
.***AI.L05 XFLAGS BL1                                                   00247300
&ZW                   SETC  ''                                          00247400
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00247500
.*-------------------------------------------------------------------   00247600
.***AI.L08 XFLAGS "ANY"                                                 00247700
.***      BL1'XXXXXXX1'                                                 00247800
         AIF   ('&XVOLTYPE' NE 'ANY').ZI9A                              00247900
&ZW                   SETC  '&ZW.00000001'                              00248000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00248100
                      AGO   .ZI9C                                       00248200
.*                                                                      00248300
.ZI9A                 ANOP  ,                                           00248400
&ZW                   SETC  '&ZW.00000000'                              00248500
.ZI9C                 ANOP  ,                                           00248600
.*-------------------------------------------------------------------   00248700
.***AI.L11 XFLAGS BL1                                                   00248800
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00248900
&ZOPN                 SETA  &ZOPN+1                                     00249000
&ZOPL(&ZOPN)          SETC  ' '                                         00249100
&ZOPO(&ZOPN)          SETC  'OI'                                        00249200
&ZOPV(&ZOPN)          SETC  '2(1),B''&ZW'''                             00249300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00249400
.ZI9E                 ANOP  ,                                           00249500
.*-------------------------------------------------------------------   00249600
.***AI.L25  XDSNAME CL44                                                00249700
                      AIF   ('&ZXDSNAME' EQ '').ZI11E                   00249800
                      AIF   ('&ZXDSNAME' EQ 'OUTPUT').ZI11E             00249900
&ZCGPR                SETC  '&XDSNAME'                                  00250000
.*                                                                      00250100
                      AIF   ('&XDSNAME'(1,1) NE '(').ZI11B              00250200
&ZCGPR   SETC  '0('.'&XDSNAME'(2,K'&XDSNAME-2).')'                      00250300
.ZI11B                ANOP  ,                                           00250400
.*                                                                      00250500
&ZOPN                 SETA  &ZOPN+1                                     00250600
&ZOPL(&ZOPN)          SETC  ' '                                         00250700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00250800
&ZOPV(&ZOPN)          SETC  '4(44,1),&ZCGPR'                            00250900
&ZOPD(&ZOPN)          SETC  '++ &ZXDSNAME XDSNAME'                      00251000
.*                                                                      00251100
.ZI11E                ANOP  ,                                           00251200
.*-------------------------------------------------------------------   00251300
.***AI.L25  XVOLUME CL6                                                 00251400
                      AIF   ('&ZXVOLUME' EQ '').ZI12E                   00251500
                      AIF   ('&ZXVOLUME' EQ 'OUTPUT').ZI12E             00251600
&ZCGPR                SETC  '&XVOLUME'                                  00251700
.*                                                                      00251800
                      AIF   ('&XVOLUME'(1,1) NE '(').ZI12B              00251900
&ZCGPR   SETC  '0('.'&XVOLUME'(2,K'&XVOLUME-2).')'                      00252000
.ZI12B                ANOP  ,                                           00252100
.*                                                                      00252200
&ZOPN                 SETA  &ZOPN+1                                     00252300
&ZOPL(&ZOPN)          SETC  ' '                                         00252400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00252500
&ZOPV(&ZOPN)          SETC  '48(6,1),&ZCGPR'                            00252600
&ZOPD(&ZOPN)          SETC  '++ &ZXVOLUME XVOLUME'                      00252700
.*                                                                      00252800
.ZI12E                ANOP  ,                                           00252900
.*-------------------------------------------------------------------   00253000
.***AI.L19 ADDR XANSAREA A                                              00253100
                      AIF   ('&ZXANSAREA' EQ '').ZI14H                  00253200
&ZCLNG                SETC  '&XANSAREA'                                 00253300
&ZCGPR                SETC  '14'                                        00253400
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI14F  IN GPR                  00253500
.*                                                                      00253600
&ZOPN                 SETA  &ZOPN+1                                     00253700
&ZOPL(&ZOPN)          SETC  ' '                                         00253800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00253900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00254000
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00254100
.*                                                                      00254200
                      AGO   .ZI14G                                      00254300
.*                                                                      00254400
.ZI14F                ANOP  ,                                           00254500
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00254600
.*                                                                      00254700
.ZI14G                ANOP  ,                                           00254800
.*                                                                      00254900
&ZOPN                 SETA  &ZOPN+1                                     00255000
&ZOPL(&ZOPN)          SETC  ' '                                         00255100
&ZOPO(&ZOPN)          SETC  'ST'                                        00255200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,56(,1)'                             00255300
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00255400
.*                                                                      00255500
.ZI14H                ANOP  ,                                           00255600
.*-------------------------------------------------------------------   00255700
.***AI.L23 ALET XANSAREA F                                              00255800
         AIF   ('&ZXANSAREA' EQ '').ZI15G                               00255900
         AIF   ('&SYSASCE' EQ 'P').ZI15G   SYSSTATE PRIMARY             00256000
&ZCLNG                SETC  '&XANSAREA'                                 00256100
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI15E  IN AR                   00256200
.*                                                                      00256300
&ZCGPR                SETC  '14'                                        00256400
                      AGO   .ZI15F                                      00256500
.*                                                                      00256600
.ZI15E                ANOP  ,                                           00256700
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00256800
.*                                                                      00256900
.ZI15F                ANOP  ,                                           00257000
.*                                                                      00257100
&ZOPN                 SETA  &ZOPN+1                                     00257200
&ZOPL(&ZOPN)          SETC  ' '                                         00257300
&ZOPO(&ZOPN)          SETC  'STAM'                                      00257400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,60(1)'                       00257500
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00257600
.*                                                                      00257700
.ZI15G                ANOP  ,                                           00257800
.*-------------------------------------------------------------------   00257900
.***AI.L25  XANSLEN F                                                   00258000
                      AIF   ('&ZXANSLEN' EQ '').ZI16E                   00258100
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI16E             00258200
&ZCGPR                SETC  '&XANSLEN'                                  00258300
.*                                                                      00258400
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI16B              00258500
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00258600
                      AGO   .ZI16D                                      00258700
.ZI16B                ANOP  ,                                           00258800
.*                                                                      00258900
&ZC                   SETC  '&XANSLEN'(1,1)                             00259000
                      AIF   (T'&ZC NE 'N').ZI16D                        00259100
&ZC                   SETC  '&XANSLEN'                                  00259200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               00259300
&ZCGPR                SETC  '=FL4''&XANSLEN'''                          00259400
.*                                                                      00259500
.ZI16D                ANOP  ,                                           00259600
.*                                                                      00259700
&ZOPN                 SETA  &ZOPN+1                                     00259800
&ZOPL(&ZOPN)          SETC  ' '                                         00259900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00260000
&ZOPV(&ZOPN)          SETC  '64(4,1),&ZCGPR'                            00260100
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00260200
.*                                                                      00260300
.ZI16E                ANOP  ,                                           00260400
.*-------------------------------------------------------------------   00260500
&ZOPN1                SETA &ZOPN                                        00260600
.*******************************************************************    00260700
.***  PROCESS CSVAPF OUTPUT PARAMETERS                                  00260800
.*******************************************************************    00260900
                      ACTR  10000                                       00261000
.*******************************************************************    00261100
.***AO.X02  RETURN CODE PROCESSING                                      00261200
.*******************************************************************    00261300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00261400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00261500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00261600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00261700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00261800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00261900
&ZOPN                 SETA  &ZOPN+1                                     00262000
&ZOPL(&ZOPN)          SETC  ' '                                         00262100
&ZOPO(&ZOPN)          SETC  'ST'                                        00262200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00262300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00262400
                      AGO   .ZMRETX                                     00262500
.*                                                                      00262600
.ZMRET2               ANOP  ,                                           00262700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00262800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00262900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00263000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00263100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00263200
&ZOPN                 SETA  &ZOPN+1                                     00263300
&ZOPL(&ZOPN)          SETC  ' '                                         00263400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00263500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00263600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00263700
.ZMRETX               ANOP  ,                                           00263800
.*******************************************************************    00263900
.***AO.X03  REASON CODE PROCESSING                                      00264000
.*******************************************************************    00264100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00264200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00264300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00264400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00264500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00264600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00264700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00264800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00264900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00265000
&ZOPN                 SETA  &ZOPN+1                                     00265100
&ZOPL(&ZOPN)          SETC  ' '                                         00265200
&ZOPO(&ZOPN)          SETC  'ST'                                        00265300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00265400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00265500
                      AGO   .ZMRSNX                                     00265600
.*                                                                      00265700
.ZMRSN2               ANOP  ,                                           00265800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00265900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00266000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00266100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00266200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00266300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00266400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00266500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00266600
&ZOPN                 SETA  &ZOPN+1                                     00266700
&ZOPL(&ZOPN)          SETC  ' '                                         00266800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00266900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00267000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00267100
.ZMRSNX               ANOP  ,                                           00267200
.*******************************************************************    00267300
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00267400
.*******************************************************************    00267500
.ZMFLX                ANOP  ,              MF=L PROCESSING              00267600
.*******************************************************************    00267700
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00267800
.*******************************************************************    00267900
                      ACTR  10000                                       00268000
.*                                                                      00268100
                      LCLA  &ZLC           COLUMN POSITION              00268200
                      LCLA  &ZOPX          LIST TABLE INDEX             00268300
                      LCLC  &ZLL           LABEL                        00268400
                      LCLC  &ZLOP          OPERATION                    00268500
                      LCLC  &ZLV           VALUE                        00268600
                      LCLC  &ZLD           DESCRIPTION                  00268700
.*                                                                      00268800
&ZOPX                 SETA  1                                           00268900
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00269000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00269100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00269200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00269300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00269400
                      AIF   (K'&ZLD LE 0).ZL5                           00269500
&ZLC                  SETA  35             COMMENT COLUMN               00269600
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00269700
&ZLC                  SETA  33             COMMMENT COLUMN              00269800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00269900
&ZLV                  SETC  '&ZLV'.' '                                  00270000
                      AGO   .ZL3                                        00270100
.*                                                                      00270200
.ZL4                  ANOP  ,                                           00270300
&ZLV                  SETC  '&ZLV'.' '                                  00270400
.ZL5                  ANOP  ,                                           00270500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00270600
.*                                                                      00270700
&ZLL     &ZLOP &ZLV                                                     00270800
.*                                                                      00270900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00271000
                      AGO   .ZL2           CONTINUE LOOPING             00271100
.*                                                                      00271200
.ZLX                  ANOP  ,                                           00271300
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00271400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00271500
         AIF   ('&REQUEST' EQ 'QUERY').QUERLINK                         00271600
         L     14,16(0,0)              GET CVT ADDRESS                  00271700
         L     14,772(14,0)            GET SFT ADDRESS                  00271800
         L     14,356(14,0)            GET LX/EX FOR SERVICE ROUTINE    00271900
         PC    0(14)                                                    00272000
         AGO   .ENDLINK                                                 00272100
.QUERLINK ANOP                                                          00272200
         L     15,16(0,0)              GET CVT ADDRESS                  00272300
         L     15,140(15,0)            GET ECVT ADDRESS                 00272400
         L     15,228(15,0)                                             00272500
         AIF   ('&TEST' NE 'YES').DOBALR                                00272600
         LTR   15,15                   SEE IF ROUTINE EXISTS            00272700
         BZ    C&SYSNDX                NO, AVOID CALL                   00272800
         L     15,8(15,0)              GET APF QUERY ADDRESS            00272900
         LTR   15,15                   SEE IF ROUTINE EXISTS            00273000
         BNZ   A&SYSNDX                YES, CALL IT                     00273100
C&SYSNDX DS    0H                      NO CALL NEEDED                   00273200
         LA    15,4                    INDICATE NOT IN LIST             00273300
         LA    0,X'0402'               REASON CODE=0                    00273400
         B     B&SYSNDX                                                 00273500
A&SYSNDX DS    0H                      NEED TO CALL                     00273600
         BALR  14,15                   CALL ROUTINE                     00273700
B&SYSNDX DS    0H                                                       00273800
         AGO   .ENDBALR                                                 00273900
.DOBALR  ANOP                                                           00274000
         L     15,8(15,0)              GET APF QUERY ADDRESS            00274100
         BALR  14,15                   CALL ROUTINE                     00274200
.ENDBALR ANOP                                                           00274300
.ENDLINK ANOP                                                           00274400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00274500
.ZLINKX               ANOP  ,                                           00274600
.*******************************************************************    00274700
.***AP.X01  FORMAT GENERATED CODE                                       00274800
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00274900
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00275000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00275100
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00275200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00275300
                      AIF   (K'&ZLD LE 0).ZL51                          00275400
&ZLC                  SETA  35             COMMENT COLUMN               00275500
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00275600
&ZLC                  SETA  33             COMMENT COLUMN               00275700
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00275800
&ZLV                  SETC  '&ZLV'.' '                                  00275900
                      AGO   .ZL31                                       00276000
.*                                                                      00276100
.ZL41                 ANOP  ,                                           00276200
&ZLV                  SETC  '&ZLV'.' '                                  00276300
.ZL51                 ANOP  ,                                           00276400
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00276500
.*                                                                      00276600
&ZLL     &ZLOP &ZLV                                                     00276700
.*                                                                      00276800
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00276900
                      AGO   .ZL21          CONTINUE LOOPING             00277000
.*                                                                      00277100
.ZLX1                 ANOP  ,                                           00277200
.*******************************************************************    00277300
.***AP.X02  END OF CSVAPF MACRO                                         00277400
&ZCSVAPF              SETC  'YES'          SET CSVAPF USED              00277500
         POP   PRINT                                                    00277600
*                                            CSVAPF-0                   00277700
         SPACE 1                                                        00277800
.ZLX2                 ANOP  ,                                           00277900
         MEND                                                           00278000
**********************************************************************/ 00278100
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00278200
*%CSVAPF: MACRO KEYS(REQUEST,DSNAME,VOLTYPE,VOLUME,TEST,FORMAT,         00278300
*                 ANSAREA,ANSLEN,RETCODE,RSNCODE,PLISTVER,MF);          00278400
*  ANS('?'!!MACLABEL!!' '!!'CSVAPFP '!!MACLIST!!                        00278500
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00278600
*%END CSVAPF;                                                           00278700

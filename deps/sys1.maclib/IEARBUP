*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IEARBUP                                -05/02/13-<> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  RB update service                             * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2000, 2015                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77A0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      IEARBUP allows you to request that the system update the PSW   * 00002100
*      address in an RB or extract the PSW data from an RB.           * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:                                         * 00002400
*                                                                     * 00002500
*02* GUPI: BASE                                                       * 00002600
*                                                                     * 00002700
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002800
*                                                                     * 00002900
*01* ENVIRONMENT:                                                     * 00003000
*                                                                     * 00003100
*                                                                     * 00003200
*      Minimum authorization:                                         * 00003300
*                                                                     * 00003400
*                        The minimum authority for IEARBUP is         * 00003500
*                        supervisor state and PSW key 0.              * 00003600
*                                                                     * 00003700
*      Dispatchable unit mode: Task mode.                             * 00003800
*                                                                     * 00003900
*      Cross Memory Mode: PASN=HASN, any SASN.                        * 00004000
*                                                                     * 00004100
*      AMODE:            31-bit.                                      * 00004200
*                                                                     * 00004300
*      ASC mode:         Primary.                                     * 00004400
*                                                                     * 00004500
*      Interrupt status: Enabled or disabled for I/O and external     * 00004600
*                        interrupts.                                  * 00004700
*                                                                     * 00004800
*      Locks:            No locks are required.  The caller may hold  * 00004900
*                        a local lock, the CMS lock or the CPU lock.  * 00005000
*                                                                     * 00005100
*      Control parameters: Control parameters must be in the primary  * 00005200
*                        address space.                               * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*                                                                     * 00005600
*01* PROGRAMMING REQUIREMENTS:                                        * 00005700
*                                                                     * 00005800
*    The caller must include the CVT and IHAECVT mapping macros.      * 00005900
*                                                                     * 00006000
*01* RESTRICTIONS:                                                    * 00006100
*                                                                     * 00006200
*    If the caller holds the CPU lock, the parameter list must be in  * 00006300
*    fixed or DREF storage.                                           * 00006400
*                                                                     * 00006500
*01* INPUT REGISTER INFORMATION:                                      * 00006600
*                                                                     * 00006700
*    Before issuing the IEARBUP macro, the caller does not have to    * 00006800
*    place any information into any general purpose register (GPR) or * 00006900
*    access register (AR) unless using it in register notation for a  * 00007000
*    particular parameter, or using it as a base register.            * 00007100
*                                                                     * 00007200
*01* OUTPUT REGISTER INFORMATION:                                     * 00007300
*                                                                     * 00007400
*    When control returns to the caller, the GPRs contain:            * 00007500
*                                                                     * 00007600
*                                                                     * 00007700
*    REGISTER    CONTENTS                                             * 00007800
*                                                                     * 00007900
*    0-1         Used as work registers by the system                 * 00008000
*                                                                     * 00008100
*    2-13        Unchanged                                            * 00008200
*                                                                     * 00008300
*    14          Used as a work register by the system                * 00008400
*                                                                     * 00008500
*    15          Return code                                          * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*                                                                     * 00008900
*    When control returns to the caller, the ARs contain:             * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*    REGISTER    CONTENTS                                             * 00009300
*                                                                     * 00009400
*    0-1         Used as work registers by the system.                * 00009500
*                                                                     * 00009600
*    2-13        Unchanged                                            * 00009700
*                                                                     * 00009800
*    14-15       Used as work registers by the system                 * 00009900
*                                                                     * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*    Some callers depend on register contents remaining the same      * 00010300
*    before and after issuing a service.  If the system changes the   * 00010400
*    contents of registers on which the caller depends, the caller    * 00010500
*    must save them before issuing the service, and restore them      * 00010600
*    after the system returns control.                                * 00010700
*                                                                     * 00010800
*01* PERFORMANCE IMPLICATIONS:                                        * 00010900
*    None.                                                            * 00011000
*                                                                     * 00011100
*01* SYNTAX:                                                          * 00011200
*                                                                     * 00011300
*Ýxlabel¨  IEARBUP  Ð  WHICHRB=CURRENT                                * 00011400
*                   Ô ,WHICHRB=PREV                                   * 00011500
*                   ¿ ,WHICHRB=EXPLICIT                               * 00011600
*                         ,RB=xrb                                     * 00011700
*                   ÐÝ,FUNCTION=UPDATE                                * 00011800
*                   !   Ð ,PSWBYTE03=NO                               * 00011900
*                   !   ¿ ,PSWBYTE03=YES                              * 00012000
*                   !   ÐÝ,ADDRTYPE=NO_CHANGE¨                        * 00012100
*                   !   ÔÝ,ADDRTYPE=INRBOPSWA¨                        * 00012200
*                   !   ÔÝ,ADDRTYPE=ACTUAL                            * 00012300
*                   !   !     ,PSWADDR=xpswaddr                       * 00012400
*                   !   !   Ð ,AMODE=UNCHANGED                        * 00012500
*                   !   !   Ô ,AMODE=24                               * 00012600
*                   !   !   Ô ,AMODE=31                               * 00012700
*                   !   !   ¿ ,AMODE=64¨                              * 00012800
*                   !   ¿Ý,ADDRTYPE=DELTA                             * 00012900
*                   !         ,PSWDELTA=xpswdelta¨¨                   * 00013000
*                   ¿Ý,FUNCTION=EXTRACTPSW                            * 00013100
*                         ,PSWG=xpswg¨                                * 00013200
*                    Ý,RETCODE=xretcode¨                              * 00013300
*                    Ý,RSNCODE=xrsncode¨                              * 00013400
*                   ÐÝ,MF=S¨                                          * 00013500
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00013600
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*      Where:                                                         * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*      Ýxlabel¨                                                       * 00014300
*          is an optional symbol, starting in column 1, that is the   * 00014400
*          name on the IEARBUP macro invocation.  The name must       * 00014500
*          conform to the rules for an ordinary assembler language    * 00014600
*          symbol.                                                    * 00014700
*          DEFAULT: No name.                                          * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*      WHICHRB=»CURRENT!PREV!EXPLICITº                                * 00015300
*          is a required keyword input that identifies the RB to be   * 00015400
*          updated                                                    * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*          WHICHRB=CURRENT                                            * 00015800
*              indicates to update the current RB.                    * 00015900
*                                                                     * 00016000
*          WHICHRB=PREV                                               * 00016100
*              indicates to update the previous (older) RB.           * 00016200
*                                                                     * 00016300
*          WHICHRB=EXPLICIT                                           * 00016400
*              indicates to update the provided RB.  It is the        * 00016500
*              calling program's responsibility to ensure that proper * 00016600
*              serialization exists to keep the provided RB valid for * 00016700
*              the duration of the IEARBUP service.                   * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*              RB=xrb                                                 * 00017100
*                  is the name (RS-type), or address in register      * 00017200
*                  (2)-(12), of a required character input that       * 00017300
*                  identifies the RB to be updated                    * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*      ÝFUNCTION=»UPDATE!EXTRACTPSWº¨                                 * 00018300
*          is an optional keyword input that identifies the function  * 00018400
*          to be performed.                                           * 00018500
*          DEFAULT: UPDATE                                            * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*          ÝFUNCTION=UPDATE                                           * 00018900
*              indicates to update an RB.                             * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*              PSWBYTE03=»NO!YESº                                     * 00019300
*                  is a required keyword input that indicates whether * 00019400
*                  the user has updated the first 4 bytes (bytes 0 to * 00019500
*                  3) of RBOPSW. If so, the system should use those   * 00019600
*                  updated values.                                    * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*                  PSWBYTE03=NO                                       * 00020000
*                      indicates that bytes 0 to 3 were not modified. * 00020100
*                                                                     * 00020200
*                  PSWBYTE03=YES                                      * 00020300
*                      indicates that bytes 0 to 3 were modified.     * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*              ÝADDRTYPE=»NO_CHANGE!INRBOPSWA!ACTUAL!DELTAº¨          * 00021100
*                  is an optional keyword input that identifies the   * 00021200
*                  method by which the PSW address is provided        * 00021300
*                  DEFAULT: NO_CHANGE                                 * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                  ÝADDRTYPE=NO_CHANGE¨                               * 00021700
*                      indicates that the PSW address has not been    * 00021800
*                      changed.                                       * 00021900
*                                                                     * 00022000
*                  ÝADDRTYPE=INRBOPSWA¨                               * 00022100
*                      indicates that the PSW address has been        * 00022200
*                      updated in RBOPSWA, along with the AMODE       * 00022300
*                      indicator(s).                                  * 00022400
*                                                                     * 00022500
*                  ÝADDRTYPE=ACTUAL                                   * 00022600
*                      indicates that the PSW address is to be used   * 00022700
*                      as is.                                         * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*                      PSWADDR=xpswaddr                               * 00023100
*                          is the name (RS-type), or address in       * 00023200
*                          register (2)-(12), of a required 8         * 00023300
*                          character input that contains the address  * 00023400
*                          to be placed into the PSW stored in the    * 00023500
*                          RB. The high 33 bits must be zero unless   * 00023600
*                          the result is to be AMODE 64.              * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                      AMODE=»UNCHANGED!24!31!64º                     * 00024200
*                          is a required keyword input that           * 00024300
*                          identifies the resulting AMODE for the PSW * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*                          AMODE=UNCHANGED                            * 00024700
*                              indicates not to change the AMODE.     * 00024800
*                                                                     * 00024900
*                          AMODE=24                                   * 00025000
*                              indicates to set the AMODE to 24.      * 00025100
*                                                                     * 00025200
*                          AMODE=31                                   * 00025300
*                              indicates to set the AMODE to 31.      * 00025400
*                                                                     * 00025500
*                          AMODE=64¨                                  * 00025600
*                              indicates to set the AMODE to 64.      * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*                                                                     * 00026200
*                  ÝADDRTYPE=DELTA                                    * 00026300
*                      indicates that the value provided is a delta   * 00026400
*                      to the existing address.                       * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                      PSWDELTA=xpswdelta¨¨                           * 00026800
*                          is the name (RS-type), or address in       * 00026900
*                          register (2)-(12), of a required fullword  * 00027000
*                          input that contains the delta to be added  * 00027100
*                          to the PSW address stored in the RB. The   * 00027200
*                          value is treated as a signed quantity, so  * 00027300
*                          a value of X'FFFFFFFE' would be treated as * 00027400
*                          negative two, resulting in subtracting two * 00027500
*                          from the PSW address.  The AMODE will      * 00027600
*                          remain unchanged.                          * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*          ÝFUNCTION=EXTRACTPSW                                       * 00028500
*              indicates to extract the 128-bit PSW associated with   * 00028600
*              this RB                                                * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*              PSWG=xpswg¨                                            * 00029000
*                  is the name (RS-type), or address in register      * 00029100
*                  (2)-(12), of a required 16 character output that   * 00029200
*                  is to contain the 128-bit z/Architecture PSW. Note * 00029300
*                  that when running ESA/390 architecture (ARCHLVL 1) * 00029400
*                  the PSW will be the 128-bit z/Architecture analog  * 00029500
*                  of the 64-bit ESA/390 PSW.                         * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*      ÝRETCODE=xretcode¨                                             * 00030500
*          is the name (RS-type) of an optional fullword output       * 00030600
*          variable, or register (2)-(12) or (15), into which the     * 00030700
*          return code is to be copied from GPR 15.  If you specify   * 00030800
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00030900
*          the value will be left in GPR 15.                          * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*      ÝRSNCODE=xrsncode¨                                             * 00031500
*          is the name (RS-type) of an optional fullword output       * 00031600
*          variable into which the reason code is to be copied from   * 00031700
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00031800
*          R0 (within or without parentheses), the value will be left * 00031900
*          in GPR 0.                                                  * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*      ÝMF=»S!L!Eº¨                                                   * 00032500
*          is an optional keyword input which specifies the macro     * 00032600
*          form.                                                      * 00032700
*          DEFAULT: S                                                 * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*          ÝMF=S¨                                                     * 00033100
*              specifies the standard form of the macro.  The "S"     * 00033200
*              form generates code to put the parameters into an      * 00033300
*              in-line parameter list and invoke the desired service. * 00033400
*              Full checking for required macro keys is done along    * 00033500
*              with supplying defaults for omitted optional           * 00033600
*              parameters.                                            * 00033700
*                                                                     * 00033800
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00033900
*              specifies the list form of the macro.  The "L" form    * 00034000
*              defines an area to be used for the parameter list.     * 00034100
*              Any other macro parameters are flagged as errors.      * 00034200
*                                                                     * 00034300
*            ,xmfctrl                                                 * 00034400
*              is a required input.  It is the name of a storage area * 00034500
*              for the parameter list.                                * 00034600
*                                                                     * 00034700
*            »,xmfattr!0Dº                                            * 00034800
*              is an optional 60 character input string that varies   * 00034900
*              from 1 to 60 characters. Use it to force boundary      * 00035000
*              alignment of the parameter list. Use only 0F or 0D.    * 00035100
*              DEFAULT: 0D which forces the parameter list to a       * 00035200
*              doubleword boundary.                                   * 00035300
*                                                                     * 00035400
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00035500
*              specifies the execute form of the macro.  The "E" form * 00035600
*              generates code to put the parameters into the          * 00035700
*              parameter list specified by xmfctrl and provides full  * 00035800
*              syntax checking with default setting.                  * 00035900
*                                                                     * 00036000
*            ,xmfctrl                                                 * 00036100
*              is a required input.  It is the name (RS-type), or     * 00036200
*              address in register (1)-(12), of a storage area for    * 00036300
*              the parameter list.                                    * 00036400
*                                                                     * 00036500
*            »,COMPLETEº                                              * 00036600
*              is an optional keyword input which specifies the       * 00036700
*              degree of macro parameter syntax checking.             * 00036800
*              DEFAULT: COMPLETE                                      * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*              COMPLETE                                               * 00037200
*                  Checking for required macro keys is done and       * 00037300
*                  defaults are supplied for omitted optional         * 00037400
*                  parameters.                                        * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*                                                                     * 00038200
*01* ABEND CODES:  None.                                              * 00038300
*                                                                     * 00038400
*       The caller may get the following abend code:                  * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*       0C2-02          The caller was not in supervisor state.       * 00038800
*                                                                     * 00038900
*       0C4-04          The caller was not in key 0.                  * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*01* RETURN CODES:                                                    * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*                 Macro IEARBUPM provides equate symbols for the      * 00039700
*                 return and reason codes.                            * 00039800
*                                                                     * 00039900
*       0         Name: IearbupRc_OK                                  * 00040000
*                                                                     * 00040100
*                 Meaning:  Iearbup request successful.               * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*       8         Name: IearbupRc_InvParm                             * 00040500
*                                                                     * 00040600
*                 Meaning:  Iearbup request specifies invalid         * 00040700
*                 parameters.                                         * 00040800
*                                                                     * 00040900
*                 Action:  Refer to the action provided with the      * 00041000
*                 specific reason code.                               * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                 HEX REASON  MEANING/ACTION                          * 00041400
*                 CODE                                                * 00041500
*                                                                     * 00041600
*                 xxxx0801    Name: IearbupRsnBadVersion              * 00041700
*                                                                     * 00041800
*                             Meaning: The version field in the       * 00041900
*                             parameter list is not valid.            * 00042000
*                                                                     * 00042100
*                             Action: Check for possible storage      * 00042200
*                             overlay.                                * 00042300
*                                                                     * 00042400
*                 xxxx0802    Name: IearbupRsnBadAMODEField           * 00042500
*                                                                     * 00042600
*                             Meaning: The amode field in the         * 00042700
*                             parameter list is not valid.            * 00042800
*                                                                     * 00042900
*                             Action: Check for possible storage      * 00043000
*                             overlay.                                * 00043100
*                                                                     * 00043200
*                 xxxx0803    Name: IearbupRsnBadAddress              * 00043300
*                                                                     * 00043400
*                             Meaning: The address provided is not    * 00043500
*                             valid.                                  * 00043600
*                                                                     * 00043700
*                             Action: Only provide an instruction     * 00043800
*                             address that is less than X'80000000'.  * 00043900
*                                                                     * 00044000
*                 xxxx0804    Name: IearbupRsnBadFunction             * 00044100
*                                                                     * 00044200
*                             Meaning: The function field in the      * 00044300
*                             parameter list is not valid.            * 00044400
*                                                                     * 00044500
*                             Action: Check for possible storage      * 00044600
*                             overlay.                                * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*                                                                     * 00045100
*       C         Name: IearbupRc_Env                                 * 00045200
*                                                                     * 00045300
*                 Meaning: Environmental error                        * 00045400
*                                                                     * 00045500
*                 Action:  Refer to the action provided with the      * 00045600
*                 specific reason code.                               * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*                 HEX REASON  MEANING/ACTION                          * 00046000
*                 CODE                                                * 00046100
*                                                                     * 00046200
*                 xxxx0C01    Name: IearbupRsnPrevRBNotFound          * 00046300
*                                                                     * 00046400
*                             Meaning: RB=PREV was requested, but     * 00046500
*                             there is only one RB for the current    * 00046600
*                             task.                                   * 00046700
*                                                                     * 00046800
*                             Action: Use RB=CURRENT when there is    * 00046900
*                             only one RB.                            * 00047000
*                                                                     * 00047100
*                 xxxx0C02    Name: IearbupRsnBadAMODE                * 00047200
*                                                                     * 00047300
*                             Meaning: AMODE=64 was specified but the * 00047400
*                             architecture level is not ESAME.        * 00047500
*                                                                     * 00047600
*                             Action: Only request AMODE=64 when the  * 00047700
*                             architecture level is ESAME.            * 00047800
*                                                                     * 00047900
*                                                                     * 00048000
*                                                                     * 00048100
*                                                                     * 00048200
*                                                                     * 00048300
*01* REASON CODES:                                                    * 00048400
*                                                                     * 00048500
*       Reason codes, as appropriate, are defined under their         * 00048600
*       corresponding return code.                                    * 00048700
*                                                                     * 00048800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00048900
*                                                                     * 00049000
*02*   PROCESSOR:  ASSEM                                              * 00049100
*                                                                     * 00049200
*01* COMPONENT:  SC1C5                                                * 00049300
*                                                                     * 00049400
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00049500
*                                                                     * 00049600
*01* EXAMPLES:                                                        * 00049700
*                                                                     * 00049800
*    Example 1                                                        * 00049900
*                                                                     * 00050000
*    Operation:                                                       * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*    1.  Update the PSW address to the address provided in field P.   * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*                                                                     * 00050700
*    The code is as follows.                                          * 00050800
*                                                                     * 00050900
*          IEARBUP ADDRTYPE=ACTUAL,PSWADDR=P,RETCODE=RC,MF=(E,MFL)    * 00051000
*             ...                                                     * 00051100
*          IEARBUP MF=(L,MFL)                                         * 00051200
*    P     DS    XL8                                                  * 00051300
*    RC    DS    F                                                    * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*    Example 2                                                        * 00051700
*                                                                     * 00051800
*    Operation:                                                       * 00051900
*                                                                     * 00052000
*                                                                     * 00052100
*    1.  Decrement the PSW address in the RB by 4                     * 00052200
*                                                                     * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*    The code is as follows.                                          * 00052600
*                                                                     * 00052700
*          IEARBUP ADDRTYPE=DELTA,PSWDELTA=PD,RETCODE=RC,MF=(E,MFL)   * 00052800
*             ...                                                     * 00052900
*          IEARBUP MF=(L,MFL)                                         * 00053000
*    PD    DC    F'-4'                                                * 00053100
*    RC    DS    F                                                    * 00053200
*                                                                     * 00053300
*                                                                     * 00053400
*01* MACRO USAGE NOTES:                                               * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00053800
*        global macro variable.  Any value other than 'NO' will       * 00053900
*        result in the macro expansion being printed.  The default is * 00054000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00054100
*        variable should be set.                                      * 00054200
*                                                                     * 00054300
*                    GBLC &ZPRINT                                     * 00054400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00054500
*                                                                     * 00054600
*                                                                     * 00054700
*                                                                     * 00054800
*01* CHANGE ACTIVITY:                                                 * 00054900
*                                                                     * 00055000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00055100
*                                                                     * 00055200
*    $L0=64BITAMG HBB7703 990721 PD00XB:  New                         * 00055300
*    $L1=64BITSUP HBB7703 990721 PD00XB:  New                         * 00055400
*    $L2=RBUPE    HBB7708 020214 PD00XB:  WHICHRB=EXPLICIT            * 00055500
*    $L2=PYN0296  HBB7708 020419 PD00XB:  Move RB address for         * 00055600
*                                         WHICHRB=EXPLICIT            * 00055700
*    $L3=RMODE64  HBB7780 091101 PD00XB:  RMODE 64                    * 00055800
*    $L4=RBUNODYN HBB77A0 130301 PD00XB:  No-Plist cases              * 00055900
****** END OF SPECIFICATIONS *****************************************/ 00056000
*/********************************************************************* 00056100
         MACRO                                                          00056200
&XLABEL  IEARBUP &WHICHRB=,&RB=,&FUNCTION=,&PSWBYTE03=,&ADDRTYPE=,     *00056300
               &PSWADDR=,&AMODE=,&PSWDELTA=,&PSWG=,&RETCODE=,&RSNCODE=,*00056400
               &MF=                                                     00056500
.*                                                                      00056600
*                MACDATE -05/02/13-<0>                                  00056700
.*                                                                      00056800
.*******************************************************************    00056900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00057000
.*******************************************************************    00057100
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00057200
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00057300
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00057400
.*                                                                      00057500
                GBLC  &ZIEARBUP   YES=MACRO USED AT LEAST ONCE          00057600
.*******************************************************************    00057700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00057800
.*******************************************************************    00057900
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00058000
                LCLC  &ZCNDX      SYSNDX CHARACTERS                     00058100
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00058200
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00058300
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00058400
                LCLA  &ZAWRK      USED AS A WORK AREA                   00058500
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00058600
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00058700
                LCLC  &ZC         CHARACTER WORK VARIABLE               00058800
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00058900
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00059000
                LCLC  &ZMAC_G     "G" or null                           00059100
&ZMAC_G         SETC  ''                                                00059200
                LCLC  &ZMAC_LR                                          00059300
&ZMAC_LR        SETC  'LR'                                              00059400
                LCLC  &ZMAC_L                                           00059500
&ZMAC_L         SETC  'L'                                               00059600
                LCLC  &ZMAC_ST                                          00059700
&ZMAC_ST        SETC  'ST'                                              00059800
                LCLC  &ZMAC_LLGT                                        00059900
&ZMAC_LLGT      SETC  'L'                                               00060000
                LCLC  &ZMAC_LGR                                         00060100
&ZMAC_LGR       SETC  'LR'                                              00060200
                LCLC  &ZMAC_LG                                          00060300
&ZMAC_LG        SETC  'L'                                               00060400
                LCLC  &ZMAC_STG                                         00060500
&ZMAC_STG       SETC  'ST'                                              00060600
                LCLA  &ZMACRET    MACRO RETURN CODE                     00060700
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00060800
.*                                                                      00060900
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00061000
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00061100
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00061200
                LCLC  &ZENDBASEPL               End of base PL          00061300
.********************************************************************   00061400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00061500
.********************************************************************   00061600
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00061700
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00061800
                GBLA  &SYSALVL    SYSSTATE ARCHLVL                      00061900
                GBLC  &SYSAM64    SYSSTATE AMODE64                      00062000
.*                                                                      00062100
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00062200
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00062300
                SPLEVEL  TEST                                           00062400
.ZSYS2          ANOP  ,                                                 00062500
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00062600
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00062700
                SYSSTATE TEST                                           00062800
                AGO   .ZSYS4                                            00062900
.ZSYS3          ANOP  ,                                                 00063000
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00063100
.ZSYS4          ANOP  ,                                                 00063200
                AIF   ('&SYSAM64' NE 'YES').ZSYSN64                     00063300
&ZMAC_LLGT      SETC 'LLGT'                                             00063400
&ZMAC_LGR       SETC 'LGR'                                              00063500
&ZMAC_LG        SETC 'LG'                                               00063600
&ZMAC_STG       SETC 'STG'                                              00063700
.ZSYSN64        ANOP  ,                                                 00063800
.*******************************************************************    00063900
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00064000
.*******************************************************************    00064100
                LCLC  &XWHICHRB   ++ VALUE                              00064200
                LCLC  &XRB        ++ NAME                               00064300
                LCLC  &XFUNCTION  ++ VALUE                              00064400
                LCLC  &XPSWBYTE03               ++ VALUE                00064500
                LCLC  &XADDRTYPE  ++ VALUE                              00064600
                LCLC  &XPSWADDR   ++ NAME                               00064700
                LCLC  &XAMODE     ++ VALUE                              00064800
                LCLC  &XPSWDELTA  ++ NAME                               00064900
                LCLC  &XPSWG      ++ NAME                               00065000
                LCLC  &XRETCODE   ++ NAME                               00065100
                LCLC  &XRSNCODE   ++ NAME                               00065200
                LCLC  &XMF        ++ VALUE                              00065300
                LCLC  &XMFCTRL    ++ NAME                               00065400
                LCLC  &XMFATTR    ++ VALUE                              00065500
                LCLC  &XMFSCK     ++ VALUE                              00065600
.*******************************************************************    00065700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00065800
.*******************************************************************    00065900
                LCLC  &ZXWHICHRB  ++ INPUT VALUE                        00066000
                LCLC  &ZXRB       ++ INPUT NAME                         00066100
                LCLC  &ZXFUNCTION               ++ INPUT VALUE          00066200
                LCLC  &ZXPSWBYTE03              ++ INPUT VALUE          00066300
                LCLC  &ZXADDRTYPE               ++ INPUT VALUE          00066400
                LCLC  &ZXPSWADDR  ++ INPUT NAME                         00066500
                LCLC  &ZXAMODE    ++ INPUT VALUE                        00066600
                LCLC  &ZXPSWDELTA               ++ INPUT NAME           00066700
                LCLC  &ZXPSWG     ++ OUTPUT NAME                        00066800
                LCLC  &ZXRETCODE  ++ OUTPUT NAME                        00066900
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00067000
                LCLC  &ZXMF       ++ INPUT VALUE                        00067100
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00067200
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00067300
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00067400
.********************************************************************   00067500
.***AG.MF01 PROCESS MF MACRO FORMS                                      00067600
.********************************************************************   00067700
                ACTR  10000                                             00067800
.*------------------------------------------------------------------    00067900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00068000
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00068100
.*-------------------------------------------------------------------   00068200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00068300
.ZG51           ANOP  ,                                                 00068400
&ZTLC           SETC 'S'                                                00068500
                AIF   ('&MF(1)' NE '&ZTLC').ZG52                        00068600
&XMF            SETC  'S'         SET KEYWORD                           00068700
                AIF   (N'&MF LE 1).ZG51A        CK NUM                  00068800
&ZMS            SETC  '"MF='                                            00068900
&ZMS            SETC  '&ZMS.&MF"'                                       00069000
&ZMS            SETC  '&ZMS "MF"'                                       00069100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00069200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00069300
.ZG51A          ANOP  ,                                                 00069400
.*-------------------------------------------------------------------   00069500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00069600
.ZG52           ANOP  ,                                                 00069700
&ZTLC           SETC 'L'                                                00069800
                AIF   ('&MF(1)' NE '&ZTLC').ZG59                        00069900
&XMF            SETC  'L'         SET KEYWORD                           00070000
                AIF   (N'&MF LE 3).ZG52A        CK NUM                  00070100
&ZMS            SETC  '"MF='                                            00070200
&ZMS            SETC  '&ZMS.&MF"'                                       00070300
&ZMS            SETC  '&ZMS "MF"'                                       00070400
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00070500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00070600
.ZG52A          ANOP  ,                                                 00070700
.*-------------------------------------------------------------------   00070800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00070900
                AIF   (N'&SYSLIST NE 0).ZG52B   POSITIONALS?            00071000
                AIF   ('&WHICHRB' NE '').ZG52B  KEYS?                   00071100
                AIF   ('&RB' NE '').ZG52B       KEYS?                   00071200
                AIF   ('&FUNCTION' NE '').ZG52B  KEYS?                  00071300
                AIF   ('&PSWBYTE03' NE '').ZG52B  KEYS?                 00071400
                AIF   ('&ADDRTYPE' NE '').ZG52B  KEYS?                  00071500
                AIF   ('&PSWADDR' NE '').ZG52B  KEYS?                   00071600
                AIF   ('&AMODE' NE '').ZG52B    KEYS?                   00071700
                AIF   ('&PSWDELTA' NE '').ZG52B  KEYS?                  00071800
                AIF   ('&PSWG' NE '').ZG52B     KEYS?                   00071900
                AIF   ('&RETCODE' NE '').ZG52B  KEYS?                   00072000
                AIF   ('&RSNCODE' NE '').ZG52B  KEYS?                   00072100
                AGO    .ZG52C     INVOCATION OKAY                       00072200
.ZG52B          ANOP  ,                                                 00072300
&ZMS            SETC  'THE "L" FORM OF "MF" CANNOT'                     00072400
&ZMS            SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                 00072500
&ZMS            SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'            00072600
                MNOTE 8,' &ZMS ON THE INVOCATION.'                      00072700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00072800
.ZG52C          ANOP  ,                                                 00072900
.*-------------------------------------------------------------------   00073000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00073100
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00073200
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00073300
                AIF   (N'&MF(2) GT 1).ZG54B     MULTI PARMS             00073400
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00073500
.ZG54B          AIF   (K'&MF(2) GT 0).ZG54C                             00073600
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00073700
&ZMS            SETC  'WHEN "L" IS SPECIFIED'                           00073800
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00073900
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00074000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00074100
.ZG54C          ANOP  ,                                                 00074200
.*-------------------------------------------------------------------   00074300
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00074400
                AIF   (K'&ZXMFCTRL LE 0).ZG54P  NOT I/O                 00074500
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG54P                    00074600
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00074700
&ZMS            SETC  '"MF='                                            00074800
&ZMS            SETC  '&ZMS.&MF"'                                       00074900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00075000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00075100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00075200
.ZG54P          ANOP  ,                                                 00075300
.*-------------------------------------------------------------------   00075400
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00075500
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00075600
&XMFATTR        SETC  '0D'                                              00075700
                AIF   (K'&MF(3) LE 0).ZG57B     PARM                    00075800
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00075900
                AIF   (N'&MF(3) GT 1).ZG57B     MULTI                   00076000
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00076100
.ZG57B          ANOP  ,                                                 00076200
.*-------------------------------------------------------------------   00076300
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00076400
                AIF   (K'&ZXMFATTR LE 0).ZG57P  NOT I/O                 00076500
                AIF   ('&XMFATTR'(1,1) NE '(').ZG57P                    00076600
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00076700
&ZMS            SETC  '"MF='                                            00076800
&ZMS            SETC  '&ZMS.&MF"'                                       00076900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00077000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00077100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00077200
.ZG57P          ANOP  ,                                                 00077300
.*-------------------------------------------------------------------   00077400
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00077500
                AIF   (K'&ZXMFATTR LE 0).ZG57S  NOT I/O                 00077600
                AIF   (K'&XMFATTR LE 60).ZG57S  LNG OK                  00077700
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00077800
&ZMS            SETC  '"MF='                                            00077900
&ZMS            SETC  '&ZMS.&MF"'                                       00078000
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00078100
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00078200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00078300
.ZG57S          ANOP  ,                                                 00078400
.*-------------------------------------------------------------------   00078500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00078600
.ZG59           ANOP  ,                                                 00078700
&ZTLC           SETC 'E'                                                00078800
                AIF   ('&MF(1)' NE '&ZTLC').ZG67                        00078900
&XMF            SETC  'E'         SET KEYWORD                           00079000
                AIF   (N'&MF LE 3).ZG59A        CK NUM                  00079100
&ZMS            SETC  '"MF='                                            00079200
&ZMS            SETC  '&ZMS.&MF"'                                       00079300
&ZMS            SETC  '&ZMS "MF"'                                       00079400
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00079500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00079600
.ZG59A          ANOP  ,                                                 00079700
.*-------------------------------------------------------------------   00079800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00079900
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00080000
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00080100
                AIF   (N'&MF(2) GT 1).ZG61B     MULTI PARMS             00080200
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00080300
.ZG61B          AIF   (K'&MF(2) GT 0).ZG61C                             00080400
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00080500
&ZMS            SETC  'WHEN "E" IS SPECIFIED'                           00080600
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00080700
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00080800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00080900
.ZG61C          ANOP  ,                                                 00081000
.*-------------------------------------------------------------------   00081100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00081200
                AIF   (K'&ZXMFCTRL LE 0).ZG61R  NOT I/O                 00081300
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG61R                    00081400
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00081500
                AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                      00081600
                AIF   (K'&ZCGPR GT 2).ZG61Q                             00081700
                AIF   ('&ZCGPR' EQ '0').ZG61Q                           00081800
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00081900
                AIF   (T'&ZCGPR NE 'N').ZG61Q   INVALID REG NAME        00082000
.ZG61P          ANOP  ,                                                 00082100
                AIF   (T'&ZCGPR NE 'N').ZG61R   NON NUMERIC             00082200
                AIF   ('&ZCGPR' LT '1').ZG61Q                           00082300
                AIF   ('&ZCGPR' LE '12').ZG61R                          00082400
.ZG61Q          ANOP  ,                                                 00082500
&ZMS            SETC  '"MF='                                            00082600
&ZMS            SETC  '&ZMS.&MF"'                                       00082700
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00082800
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00082900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00083000
.ZG61R          ANOP  ,                                                 00083100
.*-------------------------------------------------------------------   00083200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00083300
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00083400
.ZG65A   AIF   ('&MF(3)' NE 'COMPLETE').ZG66A                           00083500
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00083600
.*-------------------------------------------------------------------   00083700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00083800
.ZG66A          AIF   (K'&XMFSCK GT 0).ZG66C    KEYWORD                 00083900
                AIF   (K'&MF(3) LE 0).ZG66B                             00084000
&ZMS            SETC  '"MF='                                            00084100
&ZMS            SETC  '&ZMS.&MF"'                                       00084200
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00084300
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00084400
&ZMS            SETC  '&ZMS "COMPLETE".'                                00084500
                MNOTE 8,' &ZMS '                                        00084600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00084700
.ZG66B          ANOP  ,                                                 00084800
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00084900
.ZG66C          ANOP  ,                                                 00085000
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00085100
.*------------------------------------------------------------------    00085200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085300
.ZG67           ANOP  ,                                                 00085400
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00085500
                AIF   (K'&XMF GT 0).ZG67E       VALID ARG               00085600
                AIF   (T'&MF EQ 'O').ZG67D      OMITTED                 00085700
&ZASYSLNDX      SETA  0                                                 00085800
.ZG67A          ANOP  ,           POSITIONAL MACRO KEY                  00085900
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00086000
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG67C                  00086100
&ZTLC           SETC 'MF'                                               00086200
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG67A         00086300
.ZG67B          ANOP  ,                                                 00086400
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00086500
&ZMS            SETC  'THE "MF" KEY'                                    00086600
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00086700
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00086800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00086900
                AGO   .ZG67E                                            00087000
.ZG67C          ANOP  ,                                                 00087100
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00087200
&ZMS            SETC  '"MF='                                            00087300
&ZMS            SETC  '&ZMS.&MF"'                                       00087400
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00087500
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00087600
&ZMS            SETC  '&ZMS "S",'                                       00087700
&ZMS            SETC  '&ZMS "L",'                                       00087800
&ZMS            SETC  '&ZMS OR "E".'                                    00087900
                MNOTE 8,' &ZMS '                                        00088000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00088100
                AGO   .ZG67E                                            00088200
.ZG67D          ANOP  ,                                                 00088300
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00088400
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00088500
.ZG67E          ANOP  ,                                                 00088600
.********************************************************************   00088700
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00088800
.********************************************************************   00088900
                ACTR  10000                                             00089000
.*-------------------------------------------------------------------   00089100
.***AG.MF03 MF=(SLE)                                                    00089200
                AIF   ('&XMF' EQ 'L').ZGMFX                             00089300
.*------------------------------------------------------------------    00089400
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089500
&XWHICHRB       SETC  ''          INITIALIZE XVARIABLE                  00089600
.*-------------------------------------------------------------------   00089700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089800
.ZG3            ANOP  ,                                                 00089900
                AIF   (K'&WHICHRB(1) LE 0).ZG3A                         00090000
&ZTLC           SETC 'CURRENT'                                          00090100
                AIF   ('&WHICHRB(1)' NE '&ZTLC').ZG4                    00090200
&XWHICHRB       SETC  'CURRENT'   SET KEYWORD                           00090300
                AIF   (N'&WHICHRB LE 1).ZG3A    CK NUM                  00090400
&ZMS            SETC  '"WHICHRB='                                       00090500
&ZMS            SETC  '&ZMS.&WHICHRB"'                                  00090600
&ZMS            SETC  '&ZMS "WHICHRB"'                                  00090700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00090800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00090900
.ZG3A           ANOP  ,                                                 00091000
.*------------------------------------------------------------------    00091100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00091200
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00091300
.ZG3A0          AIF   (K'&RB LE 0).ZG3A1        OK                      00091400
&ZCVAL          SETC '&ZCVAL RB'  INCORRECT KEY USED                    00091500
.ZG3A1          AIF   (K'&ZCVAL LE 0).ZG3A2     OK                      00091600
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00091700
&ZMS            SETC  '"WHICHRB'                                        00091800
&ZMS            SETC  '&ZMS.=&WHICHRB"'                                 00091900
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00092000
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00092100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00092200
.ZG3A2          ANOP  ,                                                 00092300
.*-------------------------------------------------------------------   00092400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092500
.ZG4            ANOP  ,                                                 00092600
&ZTLC           SETC 'PREV'                                             00092700
                AIF   ('&WHICHRB(1)' NE '&ZTLC').ZG5                    00092800
&XWHICHRB       SETC  'PREV'      SET KEYWORD                           00092900
                AIF   (N'&WHICHRB LE 1).ZG4A    CK NUM                  00093000
&ZMS            SETC  '"WHICHRB='                                       00093100
&ZMS            SETC  '&ZMS.&WHICHRB"'                                  00093200
&ZMS            SETC  '&ZMS "WHICHRB"'                                  00093300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00093400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00093500
.ZG4A           ANOP  ,                                                 00093600
.*------------------------------------------------------------------    00093700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093800
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00093900
.ZG4A0          AIF   (K'&RB LE 0).ZG4A1        OK                      00094000
&ZCVAL          SETC '&ZCVAL RB'  INCORRECT KEY USED                    00094100
.ZG4A1          AIF   (K'&ZCVAL LE 0).ZG4A2     OK                      00094200
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00094300
&ZMS            SETC  '"WHICHRB'                                        00094400
&ZMS            SETC  '&ZMS.=&WHICHRB"'                                 00094500
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00094600
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00094700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00094800
.ZG4A2          ANOP  ,                                                 00094900
.*-------------------------------------------------------------------   00095000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095100
.ZG5            ANOP  ,                                                 00095200
&ZTLC           SETC 'EXPLICIT'                                         00095300
                AIF   ('&WHICHRB(1)' NE '&ZTLC').ZG9                    00095400
&XWHICHRB       SETC  'EXPLICIT'  SET KEYWORD                           00095500
                AIF   (N'&WHICHRB LE 1).ZG5A    CK NUM                  00095600
&ZMS            SETC  '"WHICHRB='                                       00095700
&ZMS            SETC  '&ZMS.&WHICHRB"'                                  00095800
&ZMS            SETC  '&ZMS "WHICHRB"'                                  00095900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00096000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00096100
.ZG5A           ANOP  ,                                                 00096200
.*----------------------------------------------------------------***   00096300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00096400
                AIF   (N'&RB LE 1).ZG7A         CK NUM                  00096500
&ZMS            SETC  '"RB='                                            00096600
&ZMS            SETC  '&ZMS.&RB"'                                       00096700
&ZMS            SETC  '&ZMS "RB"'                                       00096800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00096900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00097000
.ZG7A           ANOP  ,                                                 00097100
.*-------------------------------------------------------------------   00097200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00097300
&ZXRB           SETC  'INPUT'     SET IN/OUTPUT                         00097400
&XRB            SETC  '&RB(1)'    SET XVARIABLE                         00097500
                AIF   (N'&RB GT 1).ZG7B         MULTI PARMS             00097600
&XRB            SETC  '&RB'       SET XVARIABLE                         00097700
.ZG7B           AIF   (K'&RB(1) GT 0).ZG7C                              00097800
&ZXRB           SETC  ''          RESET IN/OUTPUT                       00097900
&ZMS            SETC  ' '                                               00098000
&ZMS            SETC  '&ZMS "RB" KEY AND ITS'                           00098100
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00098200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00098300
.ZG7C           ANOP  ,                                                 00098400
.*-------------------------------------------------------------------   00098500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00098600
                AIF   (K'&ZXRB LE 0).ZG7R       NOT I/O                 00098700
                AIF   ('&XRB'(1,1) NE '(').ZG7R                         00098800
&ZCGPR          SETC  '&XRB'(2,K'&XRB-2)                                00098900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                       00099000
                AIF   (K'&ZCGPR GT 2).ZG7Q                              00099100
                AIF   ('&ZCGPR' EQ '0').ZG7Q                            00099200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00099300
                AIF   (T'&ZCGPR NE 'N').ZG7Q    INVALID REG NAME        00099400
.ZG7P           ANOP  ,                                                 00099500
                AIF   (T'&ZCGPR NE 'N').ZG7R    NON NUMERIC             00099600
                AIF   ('&ZCGPR' LT '2').ZG7Q                            00099700
                AIF   ('&ZCGPR' LE '12').ZG7R                           00099800
.ZG7Q           ANOP  ,                                                 00099900
&ZMS            SETC  '"RB='                                            00100000
&ZMS            SETC  '&ZMS.&RB"'                                       00100100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00100200
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00100300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00100400
.ZG7R           ANOP  ,                                                 00100500
.*------------------------------------------------------------------    00100600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100700
.ZG9            ANOP  ,                                                 00100800
&ZXWHICHRB      SETC  'INPUT'     SET IN/OUTPUT                         00100900
                AIF   (K'&XWHICHRB GT 0).ZG9E   VALID ARG               00101000
                AIF   (T'&WHICHRB EQ 'O').ZG9D  OMITTED                 00101100
&ZASYSLNDX      SETA  0                                                 00101200
.ZG9A           ANOP  ,           POSITIONAL MACRO KEY                  00101300
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00101400
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG9C                   00101500
&ZTLC           SETC 'WHICHRB'                                          00101600
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG9A          00101700
.ZG9B           ANOP  ,                                                 00101800
&ZXWHICHRB      SETC  ''          RESET IN/OUTPUT                       00101900
&ZMS            SETC  'THE "WHICHRB" KEY'                               00102000
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00102100
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00102200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00102300
                AGO   .ZG9E                                             00102400
.ZG9C           ANOP  ,                                                 00102500
&ZXWHICHRB      SETC  ''          RESET IN/OUTPUT                       00102600
&ZMS            SETC  '"WHICHRB='                                       00102700
&ZMS            SETC  '&ZMS.&WHICHRB"'                                  00102800
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00102900
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00103000
&ZMS            SETC  '&ZMS "CURRENT",'                                 00103100
&ZMS            SETC  '&ZMS "PREV",'                                    00103200
&ZMS            SETC  '&ZMS OR "EXPLICIT".'                             00103300
                MNOTE 8,' &ZMS '                                        00103400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00103500
                AGO   .ZG9E                                             00103600
.ZG9D           ANOP  ,                                                 00103700
&XWHICHRB       SETC  'CURRENT'   SET DEFAULT KEYWORD                   00103800
.ZG9E           ANOP  ,                                                 00103900
.*------------------------------------------------------------------    00104000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104100
                AIF   (K'&WHICHRB(1) GT 0).ZG9F  PARM                   00104200
&XWHICHRB       SETC  ''          ENSURE NULL KEYWORD                   00104300
&ZXWHICHRB      SETC  ''          RESET IN/OUTPUT                       00104400
&ZMS            SETC  'THE'                                             00104500
&ZMS            SETC  '&ZMS "WHICHRB" KEY AND ITS'                      00104600
&ZMS            SETC  '&ZMS ARGUMENT ARE REQUIRED.'                     00104700
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00104800
&ZMS            SETC  '&ZMS "CURRENT",'                                 00104900
&ZMS            SETC  '&ZMS "PREV",'                                    00105000
&ZMS            SETC  '&ZMS OR "EXPLICIT".'                             00105100
                MNOTE 8,' &ZMS '                                        00105200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00105300
.ZG9F           ANOP  ,                                                 00105400
.*------------------------------------------------------------------    00105500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105600
&XFUNCTION      SETC  ''          INITIALIZE XVARIABLE                  00105700
.*-------------------------------------------------------------------   00105800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105900
.ZG12           ANOP  ,                                                 00106000
                AIF   (K'&FUNCTION(1) LE 0).ZG12A                       00106100
&ZTLC           SETC 'UPDATE'                                           00106200
                AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG38                  00106300
&XFUNCTION      SETC  'UPDATE'    SET KEYWORD                           00106400
                AIF   (N'&FUNCTION LE 1).ZG12A  CK NUM                  00106500
&ZMS            SETC  '"FUNCTION='                                      00106600
&ZMS            SETC  '&ZMS.&FUNCTION"'                                 00106700
&ZMS            SETC  '&ZMS "FUNCTION"'                                 00106800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00106900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00107000
.ZG12A          ANOP  ,                                                 00107100
.*------------------------------------------------------------------    00107200
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107300
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00107400
.ZG12A0         AIF   (K'&PSWG LE 0).ZG12A1     OK                      00107500
&ZCVAL          SETC '&ZCVAL PSWG'              INCORRECT KEY USED      00107600
.ZG12A1         AIF   (K'&ZCVAL LE 0).ZG12A2    OK                      00107700
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00107800
&ZMS            SETC  '"FUNCTION'                                       00107900
&ZMS            SETC  '&ZMS.=&FUNCTION"'                                00108000
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00108100
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00108200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00108300
.ZG12A2         ANOP  ,                                                 00108400
.*------------------------------------------------------------------    00108500
.***AG.KKCTL01 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00108600
&XPSWBYTE03     SETC  ''          INITIALIZE XVARIABLE                  00108700
.*-------------------------------------------------------------------   00108800
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00108900
.ZG15           ANOP  ,                                                 00109000
                AIF   (K'&PSWBYTE03(1) LE 0).ZG15A                      00109100
&ZTLC           SETC 'NO'                                               00109200
                AIF   ('&PSWBYTE03(1)' NE '&ZTLC').ZG16                 00109300
&XPSWBYTE03     SETC  'NO'        SET KEYWORD                           00109400
                AIF   (N'&PSWBYTE03 LE 1).ZG15A  CK NUM                 00109500
&ZMS            SETC  '"PSWBYTE03='                                     00109600
&ZMS            SETC  '&ZMS.&PSWBYTE03"'                                00109700
&ZMS            SETC  '&ZMS "PSWBYTE03"'                                00109800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00109900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00110000
.ZG15A          ANOP  ,                                                 00110100
.*-------------------------------------------------------------------   00110200
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00110300
.ZG16           ANOP  ,                                                 00110400
&ZTLC           SETC 'YES'                                              00110500
                AIF   ('&PSWBYTE03(1)' NE '&ZTLC').ZG17                 00110600
&XPSWBYTE03     SETC  'YES'       SET KEYWORD                           00110700
                AIF   (N'&PSWBYTE03 LE 1).ZG16A  CK NUM                 00110800
&ZMS            SETC  '"PSWBYTE03='                                     00110900
&ZMS            SETC  '&ZMS.&PSWBYTE03"'                                00111000
&ZMS            SETC  '&ZMS "PSWBYTE03"'                                00111100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00111200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00111300
.ZG16A          ANOP  ,                                                 00111400
.*------------------------------------------------------------------    00111500
.***AG.KKCTL04 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00111600
.ZG17           ANOP  ,                                                 00111700
&ZXPSWBYTE03    SETC  'INPUT'     SET IN/OUTPUT                         00111800
                AIF   (K'&XPSWBYTE03 GT 0).ZG17E  VALID ARG             00111900
                AIF   (T'&PSWBYTE03 EQ 'O').ZG17D  OMITTED              00112000
&ZASYSLNDX      SETA  0                                                 00112100
.ZG17A          ANOP  ,           POSITIONAL MACRO KEY                  00112200
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00112300
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C                  00112400
&ZTLC           SETC 'PSWBYTE03'                                        00112500
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG17A         00112600
.ZG17B          ANOP  ,                                                 00112700
&ZXPSWBYTE03    SETC  ''          RESET IN/OUTPUT                       00112800
&ZMS            SETC  'THE "PSWBYTE03" KEY'                             00112900
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00113000
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00113100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00113200
                AGO   .ZG17E                                            00113300
.ZG17C          ANOP  ,                                                 00113400
&ZXPSWBYTE03    SETC  ''          RESET IN/OUTPUT                       00113500
&ZMS            SETC  '"PSWBYTE03='                                     00113600
&ZMS            SETC  '&ZMS.&PSWBYTE03"'                                00113700
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00113800
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00113900
&ZMS            SETC  '&ZMS "NO"'                                       00114000
&ZMS            SETC  '&ZMS OR "YES".'                                  00114100
                MNOTE 8,' &ZMS '                                        00114200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00114300
                AGO   .ZG17E                                            00114400
.ZG17D          ANOP  ,                                                 00114500
&XPSWBYTE03     SETC  'NO'        SET DEFAULT KEYWORD                   00114600
.ZG17E          ANOP  ,                                                 00114700
.*------------------------------------------------------------------    00114800
.***AG.KKCTL05 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00114900
                AIF   (K'&PSWBYTE03(1) GT 0).ZG17F  PARM                00115000
&XPSWBYTE03     SETC  ''          ENSURE NULL KEYWORD                   00115100
&ZXPSWBYTE03    SETC  ''          RESET IN/OUTPUT                       00115200
&ZMS            SETC  'WHEN "UPDATE" IS SPECIFIED, THE'                 00115300
&ZMS            SETC  '&ZMS "PSWBYTE03" KEY AND ITS'                    00115400
&ZMS            SETC  '&ZMS ARGUMENT ARE REQUIRED.'                     00115500
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00115600
&ZMS            SETC  '&ZMS "NO"'                                       00115700
&ZMS            SETC  '&ZMS OR "YES".'                                  00115800
                MNOTE 8,' &ZMS '                                        00115900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00116000
.ZG17F          ANOP  ,                                                 00116100
.*------------------------------------------------------------------    00116200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116300
&XADDRTYPE      SETC  ''          INITIALIZE XVARIABLE                  00116400
.*-------------------------------------------------------------------   00116500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116600
.ZG20           ANOP  ,                                                 00116700
                AIF   (K'&ADDRTYPE(1) LE 0).ZG20A                       00116800
&ZTLC           SETC 'NO_CHANGE'                                        00116900
                AIF   ('&ADDRTYPE(1)' NE '&ZTLC').ZG21                  00117000
&XADDRTYPE      SETC  'NO_CHANGE'               SET KEYWORD             00117100
                AIF   (N'&ADDRTYPE LE 1).ZG20A  CK NUM                  00117200
&ZMS            SETC  '"ADDRTYPE='                                      00117300
&ZMS            SETC  '&ZMS.&ADDRTYPE"'                                 00117400
&ZMS            SETC  '&ZMS "ADDRTYPE"'                                 00117500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00117600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00117700
.ZG20A          ANOP  ,                                                 00117800
.*------------------------------------------------------------------    00117900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00118000
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00118100
.ZG20A0         AIF   (K'&PSWADDR LE 0).ZG20A1  OK                      00118200
&ZCVAL          SETC '&ZCVAL PSWADDR'           INCORRECT KEY USED      00118300
.ZG20A1         AIF   (K'&AMODE LE 0).ZG20A2    OK                      00118400
&ZCVAL          SETC '&ZCVAL AMODE'             INCORRECT KEY USED      00118500
.ZG20A2         AIF   (K'&PSWDELTA LE 0).ZG20A3  OK                     00118600
&ZCVAL          SETC '&ZCVAL PSWDELTA'          INCORRECT KEY USED      00118700
.ZG20A3         AIF   (K'&ZCVAL LE 0).ZG20A4    OK                      00118800
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00118900
&ZMS            SETC  '"ADDRTYPE'                                       00119000
&ZMS            SETC  '&ZMS.=&ADDRTYPE"'                                00119100
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00119200
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00119300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00119400
.ZG20A4         ANOP  ,                                                 00119500
.*-------------------------------------------------------------------   00119600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119700
.ZG21           ANOP  ,                                                 00119800
&ZTLC           SETC 'INRBOPSWA'                                        00119900
                AIF   ('&ADDRTYPE(1)' NE '&ZTLC').ZG22                  00120000
&XADDRTYPE      SETC  'INRBOPSWA'               SET KEYWORD             00120100
                AIF   (N'&ADDRTYPE LE 1).ZG21A  CK NUM                  00120200
&ZMS            SETC  '"ADDRTYPE='                                      00120300
&ZMS            SETC  '&ZMS.&ADDRTYPE"'                                 00120400
&ZMS            SETC  '&ZMS "ADDRTYPE"'                                 00120500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00120600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00120700
.ZG21A          ANOP  ,                                                 00120800
.*------------------------------------------------------------------    00120900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121000
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00121100
.ZG21A0         AIF   (K'&PSWADDR LE 0).ZG21A1  OK                      00121200
&ZCVAL          SETC '&ZCVAL PSWADDR'           INCORRECT KEY USED      00121300
.ZG21A1         AIF   (K'&AMODE LE 0).ZG21A2    OK                      00121400
&ZCVAL          SETC '&ZCVAL AMODE'             INCORRECT KEY USED      00121500
.ZG21A2         AIF   (K'&PSWDELTA LE 0).ZG21A3  OK                     00121600
&ZCVAL          SETC '&ZCVAL PSWDELTA'          INCORRECT KEY USED      00121700
.ZG21A3         AIF   (K'&ZCVAL LE 0).ZG21A4    OK                      00121800
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00121900
&ZMS            SETC  '"ADDRTYPE'                                       00122000
&ZMS            SETC  '&ZMS.=&ADDRTYPE"'                                00122100
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00122200
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00122300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00122400
.ZG21A4         ANOP  ,                                                 00122500
.*-------------------------------------------------------------------   00122600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00122700
.ZG22           ANOP  ,                                                 00122800
&ZTLC           SETC 'ACTUAL'                                           00122900
                AIF   ('&ADDRTYPE(1)' NE '&ZTLC').ZG33                  00123000
&XADDRTYPE      SETC  'ACTUAL'    SET KEYWORD                           00123100
                AIF   (N'&ADDRTYPE LE 1).ZG22A  CK NUM                  00123200
&ZMS            SETC  '"ADDRTYPE='                                      00123300
&ZMS            SETC  '&ZMS.&ADDRTYPE"'                                 00123400
&ZMS            SETC  '&ZMS "ADDRTYPE"'                                 00123500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00123600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00123700
.ZG22A          ANOP  ,                                                 00123800
.*------------------------------------------------------------------    00123900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00124000
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00124100
.ZG22A0         AIF   (K'&PSWDELTA LE 0).ZG22A1  OK                     00124200
&ZCVAL          SETC '&ZCVAL PSWDELTA'          INCORRECT KEY USED      00124300
.ZG22A1         AIF   (K'&ZCVAL LE 0).ZG22A2    OK                      00124400
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00124500
&ZMS            SETC  '"ADDRTYPE'                                       00124600
&ZMS            SETC  '&ZMS.=&ADDRTYPE"'                                00124700
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00124800
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00124900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00125000
.ZG22A2         ANOP  ,                                                 00125100
.*----------------------------------------------------------------***   00125200
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00125300
                AIF   (N'&PSWADDR LE 1).ZG24A   CK NUM                  00125400
&ZMS            SETC  '"PSWADDR='                                       00125500
&ZMS            SETC  '&ZMS.&PSWADDR"'                                  00125600
&ZMS            SETC  '&ZMS "PSWADDR"'                                  00125700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00125800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00125900
.ZG24A          ANOP  ,                                                 00126000
.*-------------------------------------------------------------------   00126100
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00126200
&ZXPSWADDR      SETC  'INPUT'     SET IN/OUTPUT                         00126300
&XPSWADDR       SETC  '&PSWADDR(1)'             SET XVARIABLE           00126400
                AIF   (N'&PSWADDR GT 1).ZG24B   MULTI PARMS             00126500
&XPSWADDR       SETC  '&PSWADDR'  SET XVARIABLE                         00126600
.ZG24B          AIF   (K'&PSWADDR(1) GT 0).ZG24C                        00126700
&ZXPSWADDR      SETC  ''          RESET IN/OUTPUT                       00126800
&ZMS            SETC  'WHEN "ACTUAL" IS SPECIFIED'                      00126900
&ZMS            SETC  '&ZMS , "PSWADDR" KEY AND ITS'                    00127000
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00127100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00127200
.ZG24C          ANOP  ,                                                 00127300
.*-------------------------------------------------------------------   00127400
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00127500
                AIF   (K'&ZXPSWADDR LE 0).ZG24R  NOT I/O                00127600
                AIF   ('&XPSWADDR'(1,1) NE '(').ZG24R                   00127700
&ZCGPR          SETC  '&XPSWADDR'(2,K'&XPSWADDR-2)                      00127800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                      00127900
                AIF   (K'&ZCGPR GT 2).ZG24Q                             00128000
                AIF   ('&ZCGPR' EQ '0').ZG24Q                           00128100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00128200
                AIF   (T'&ZCGPR NE 'N').ZG24Q   INVALID REG NAME        00128300
.ZG24P          ANOP  ,                                                 00128400
                AIF   (T'&ZCGPR NE 'N').ZG24R   NON NUMERIC             00128500
                AIF   ('&ZCGPR' LT '2').ZG24Q                           00128600
                AIF   ('&ZCGPR' LE '12').ZG24R                          00128700
.ZG24Q          ANOP  ,                                                 00128800
&ZMS            SETC  '"PSWADDR='                                       00128900
&ZMS            SETC  '&ZMS.&PSWADDR"'                                  00129000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00129100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00129200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00129300
.ZG24R          ANOP  ,                                                 00129400
.*------------------------------------------------------------------    00129500
.***AG.KKCTL01 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00129600
&XAMODE         SETC  ''          INITIALIZE XVARIABLE                  00129700
.*-------------------------------------------------------------------   00129800
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00129900
.ZG28           ANOP  ,                                                 00130000
                AIF   (K'&AMODE(1) LE 0).ZG28A                          00130100
&ZTLC           SETC 'UNCHANGED'                                        00130200
                AIF   ('&AMODE(1)' NE '&ZTLC').ZG29                     00130300
&XAMODE         SETC  'UNCHANGED'               SET KEYWORD             00130400
                AIF   (N'&AMODE LE 1).ZG28A     CK NUM                  00130500
&ZMS            SETC  '"AMODE='                                         00130600
&ZMS            SETC  '&ZMS.&AMODE"'                                    00130700
&ZMS            SETC  '&ZMS "AMODE"'                                    00130800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00130900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00131000
.ZG28A          ANOP  ,                                                 00131100
.*-------------------------------------------------------------------   00131200
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00131300
.ZG29           ANOP  ,                                                 00131400
&ZTLC           SETC '24'                                               00131500
                AIF   ('&AMODE(1)' NE '&ZTLC').ZG30                     00131600
&XAMODE         SETC  '24'        SET KEYWORD                           00131700
                AIF   (N'&AMODE LE 1).ZG29A     CK NUM                  00131800
&ZMS            SETC  '"AMODE='                                         00131900
&ZMS            SETC  '&ZMS.&AMODE"'                                    00132000
&ZMS            SETC  '&ZMS "AMODE"'                                    00132100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00132200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00132300
.ZG29A          ANOP  ,                                                 00132400
.*-------------------------------------------------------------------   00132500
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00132600
.ZG30           ANOP  ,                                                 00132700
&ZTLC           SETC '31'                                               00132800
                AIF   ('&AMODE(1)' NE '&ZTLC').ZG31                     00132900
&XAMODE         SETC  '31'        SET KEYWORD                           00133000
                AIF   (N'&AMODE LE 1).ZG30A     CK NUM                  00133100
&ZMS            SETC  '"AMODE='                                         00133200
&ZMS            SETC  '&ZMS.&AMODE"'                                    00133300
&ZMS            SETC  '&ZMS "AMODE"'                                    00133400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00133500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00133600
.ZG30A          ANOP  ,                                                 00133700
.*-------------------------------------------------------------------   00133800
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00133900
.ZG31           ANOP  ,                                                 00134000
&ZTLC           SETC '64'                                               00134100
                AIF   ('&AMODE(1)' NE '&ZTLC').ZG32                     00134200
&XAMODE         SETC  '64'        SET KEYWORD                           00134300
                AIF   (N'&AMODE LE 1).ZG31A     CK NUM                  00134400
&ZMS            SETC  '"AMODE='                                         00134500
&ZMS            SETC  '&ZMS.&AMODE"'                                    00134600
&ZMS            SETC  '&ZMS "AMODE"'                                    00134700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00134800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00134900
.ZG31A          ANOP  ,                                                 00135000
.*------------------------------------------------------------------    00135100
.***AG.KKCTL04 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00135200
.ZG32           ANOP  ,                                                 00135300
&ZXAMODE        SETC  'INPUT'     SET IN/OUTPUT                         00135400
                AIF   (K'&XAMODE GT 0).ZG32E    VALID ARG               00135500
                AIF   (T'&AMODE EQ 'O').ZG32D   OMITTED                 00135600
&ZASYSLNDX      SETA  0                                                 00135700
.ZG32A          ANOP  ,           POSITIONAL MACRO KEY                  00135800
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00135900
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG32C                  00136000
&ZTLC           SETC 'AMODE'                                            00136100
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG32A         00136200
.ZG32B          ANOP  ,                                                 00136300
&ZXAMODE        SETC  ''          RESET IN/OUTPUT                       00136400
&ZMS            SETC  'THE "AMODE" KEY'                                 00136500
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00136600
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00136700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00136800
                AGO   .ZG32E                                            00136900
.ZG32C          ANOP  ,                                                 00137000
&ZXAMODE        SETC  ''          RESET IN/OUTPUT                       00137100
&ZMS            SETC  '"AMODE='                                         00137200
&ZMS            SETC  '&ZMS.&AMODE"'                                    00137300
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00137400
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00137500
&ZMS            SETC  '&ZMS "UNCHANGED",'                               00137600
&ZMS            SETC  '&ZMS "24",'                                      00137700
&ZMS            SETC  '&ZMS "31",'                                      00137800
&ZMS            SETC  '&ZMS OR "64".'                                   00137900
                MNOTE 8,' &ZMS '                                        00138000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00138100
                AGO   .ZG32E                                            00138200
.ZG32D          ANOP  ,                                                 00138300
&XAMODE         SETC  'UNCHANGED'               SET DEFAULT KEYWORD     00138400
.ZG32E          ANOP  ,                                                 00138500
.*------------------------------------------------------------------    00138600
.***AG.KKCTL05 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00138700
                AIF   (K'&AMODE(1) GT 0).ZG32F  PARM                    00138800
&XAMODE         SETC  ''          ENSURE NULL KEYWORD                   00138900
&ZXAMODE        SETC  ''          RESET IN/OUTPUT                       00139000
&ZMS            SETC  'WHEN "ACTUAL" IS SPECIFIED, THE'                 00139100
&ZMS            SETC  '&ZMS "AMODE" KEY AND ITS'                        00139200
&ZMS            SETC  '&ZMS ARGUMENT ARE REQUIRED.'                     00139300
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00139400
&ZMS            SETC  '&ZMS "UNCHANGED",'                               00139500
&ZMS            SETC  '&ZMS "24",'                                      00139600
&ZMS            SETC  '&ZMS "31",'                                      00139700
&ZMS            SETC  '&ZMS OR "64".'                                   00139800
                MNOTE 8,' &ZMS '                                        00139900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00140000
.ZG32F          ANOP  ,                                                 00140100
.*-------------------------------------------------------------------   00140200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140300
.ZG33           ANOP  ,                                                 00140400
&ZTLC           SETC 'DELTA'                                            00140500
                AIF   ('&ADDRTYPE(1)' NE '&ZTLC').ZG37                  00140600
&XADDRTYPE      SETC  'DELTA'     SET KEYWORD                           00140700
                AIF   (N'&ADDRTYPE LE 1).ZG33A  CK NUM                  00140800
&ZMS            SETC  '"ADDRTYPE='                                      00140900
&ZMS            SETC  '&ZMS.&ADDRTYPE"'                                 00141000
&ZMS            SETC  '&ZMS "ADDRTYPE"'                                 00141100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00141200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00141300
.ZG33A          ANOP  ,                                                 00141400
.*------------------------------------------------------------------    00141500
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141600
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00141700
.ZG33A0         AIF   (K'&PSWADDR LE 0).ZG33A1  OK                      00141800
&ZCVAL          SETC '&ZCVAL PSWADDR'           INCORRECT KEY USED      00141900
.ZG33A1         AIF   (K'&AMODE LE 0).ZG33A2    OK                      00142000
&ZCVAL          SETC '&ZCVAL AMODE'             INCORRECT KEY USED      00142100
.ZG33A2         AIF   (K'&ZCVAL LE 0).ZG33A3    OK                      00142200
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00142300
&ZMS            SETC  '"ADDRTYPE'                                       00142400
&ZMS            SETC  '&ZMS.=&ADDRTYPE"'                                00142500
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00142600
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00142700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00142800
.ZG33A3         ANOP  ,                                                 00142900
.*----------------------------------------------------------------***   00143000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00143100
                AIF   (N'&PSWDELTA LE 1).ZG35A  CK NUM                  00143200
&ZMS            SETC  '"PSWDELTA='                                      00143300
&ZMS            SETC  '&ZMS.&PSWDELTA"'                                 00143400
&ZMS            SETC  '&ZMS "PSWDELTA"'                                 00143500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00143600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00143700
.ZG35A          ANOP  ,                                                 00143800
.*-------------------------------------------------------------------   00143900
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00144000
&ZXPSWDELTA     SETC  'INPUT'     SET IN/OUTPUT                         00144100
&XPSWDELTA      SETC  '&PSWDELTA(1)'            SET XVARIABLE           00144200
                AIF   (N'&PSWDELTA GT 1).ZG35B  MULTI PARMS             00144300
&XPSWDELTA      SETC  '&PSWDELTA'               SET XVARIABLE           00144400
.ZG35B          AIF   (K'&PSWDELTA(1) GT 0).ZG35C                       00144500
&ZXPSWDELTA     SETC  ''          RESET IN/OUTPUT                       00144600
&ZMS            SETC  'WHEN "DELTA" IS SPECIFIED'                       00144700
&ZMS            SETC  '&ZMS , "PSWDELTA" KEY AND ITS'                   00144800
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00144900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00145000
.ZG35C          ANOP  ,                                                 00145100
.*-------------------------------------------------------------------   00145200
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00145300
                AIF   (K'&ZXPSWDELTA LE 0).ZG35R  NOT I/O               00145400
                AIF   ('&XPSWDELTA'(1,1) NE '(').ZG35R                  00145500
&ZCGPR          SETC  '&XPSWDELTA'(2,K'&XPSWDELTA-2)                    00145600
                AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                      00145700
                AIF   (K'&ZCGPR GT 2).ZG35Q                             00145800
                AIF   ('&ZCGPR' EQ '0').ZG35Q                           00145900
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00146000
                AIF   (T'&ZCGPR NE 'N').ZG35Q   INVALID REG NAME        00146100
.ZG35P          ANOP  ,                                                 00146200
                AIF   (T'&ZCGPR NE 'N').ZG35R   NON NUMERIC             00146300
                AIF   ('&ZCGPR' LT '2').ZG35Q                           00146400
                AIF   ('&ZCGPR' LE '12').ZG35R                          00146500
.ZG35Q          ANOP  ,                                                 00146600
&ZMS            SETC  '"PSWDELTA='                                      00146700
&ZMS            SETC  '&ZMS.&PSWDELTA"'                                 00146800
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00146900
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00147000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00147100
.ZG35R          ANOP  ,                                                 00147200
.*------------------------------------------------------------------    00147300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147400
.ZG37           ANOP  ,                                                 00147500
&ZXADDRTYPE     SETC  'INPUT'     SET IN/OUTPUT                         00147600
                AIF   (K'&XADDRTYPE GT 0).ZG37E  VALID ARG              00147700
                AIF   (T'&ADDRTYPE EQ 'O').ZG37D  OMITTED               00147800
&ZASYSLNDX      SETA  0                                                 00147900
.ZG37A          ANOP  ,           POSITIONAL MACRO KEY                  00148000
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00148100
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG37C                  00148200
&ZTLC           SETC 'ADDRTYPE'                                         00148300
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG37A         00148400
.ZG37B          ANOP  ,                                                 00148500
&ZXADDRTYPE     SETC  ''          RESET IN/OUTPUT                       00148600
&ZMS            SETC  'THE "ADDRTYPE" KEY'                              00148700
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00148800
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00148900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00149000
                AGO   .ZG37E                                            00149100
.ZG37C          ANOP  ,                                                 00149200
&ZXADDRTYPE     SETC  ''          RESET IN/OUTPUT                       00149300
&ZMS            SETC  '"ADDRTYPE='                                      00149400
&ZMS            SETC  '&ZMS.&ADDRTYPE"'                                 00149500
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00149600
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00149700
&ZMS            SETC  '&ZMS "NO_CHANGE",'                               00149800
&ZMS            SETC  '&ZMS "INRBOPSWA",'                               00149900
&ZMS            SETC  '&ZMS "ACTUAL",'                                  00150000
&ZMS            SETC  '&ZMS OR "DELTA".'                                00150100
                MNOTE 8,' &ZMS '                                        00150200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00150300
                AGO   .ZG37E                                            00150400
.ZG37D          ANOP  ,                                                 00150500
&XADDRTYPE      SETC  'NO_CHANGE'               SET DEFAULT KEYWORD     00150600
.ZG37E          ANOP  ,                                                 00150700
.*-------------------------------------------------------------------   00150800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150900
.ZG38           ANOP  ,                                                 00151000
&ZTLC           SETC 'EXTRACTPSW'                                       00151100
                AIF   ('&FUNCTION(1)' NE '&ZTLC').ZG42                  00151200
&XFUNCTION      SETC  'EXTRACTPSW'              SET KEYWORD             00151300
                AIF   (N'&FUNCTION LE 1).ZG38A  CK NUM                  00151400
&ZMS            SETC  '"FUNCTION='                                      00151500
&ZMS            SETC  '&ZMS.&FUNCTION"'                                 00151600
&ZMS            SETC  '&ZMS "FUNCTION"'                                 00151700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00151800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00151900
.ZG38A          ANOP  ,                                                 00152000
.*------------------------------------------------------------------    00152100
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152200
&ZCVAL          SETC ''           CLEAR ERROR KEY ACCUMULATOR           00152300
.ZG38A0         AIF   (K'&PSWBYTE03 LE 0).ZG38A1  OK                    00152400
&ZCVAL          SETC '&ZCVAL PSWBYTE03'         INCORRECT KEY USED      00152500
.ZG38A1         AIF   (K'&ADDRTYPE LE 0).ZG38A2  OK                     00152600
&ZCVAL          SETC '&ZCVAL ADDRTYPE'          INCORRECT KEY USED      00152700
.ZG38A2         AIF   (K'&PSWADDR LE 0).ZG38A3  OK                      00152800
&ZCVAL          SETC '&ZCVAL PSWADDR'           INCORRECT KEY USED      00152900
.ZG38A3         AIF   (K'&AMODE LE 0).ZG38A4    OK                      00153000
&ZCVAL          SETC '&ZCVAL AMODE'             INCORRECT KEY USED      00153100
.ZG38A4         AIF   (K'&PSWDELTA LE 0).ZG38A5  OK                     00153200
&ZCVAL          SETC '&ZCVAL PSWDELTA'          INCORRECT KEY USED      00153300
.ZG38A5         AIF   (K'&ZCVAL LE 0).ZG38A6    OK                      00153400
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00153500
&ZMS            SETC  '"FUNCTION'                                       00153600
&ZMS            SETC  '&ZMS.=&FUNCTION"'                                00153700
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00153800
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00153900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00154000
.ZG38A6         ANOP  ,                                                 00154100
.*----------------------------------------------------------------***   00154200
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00154300
                AIF   (N'&PSWG LE 1).ZG40A      CK NUM                  00154400
&ZMS            SETC  '"PSWG='                                          00154500
&ZMS            SETC  '&ZMS.&PSWG"'                                     00154600
&ZMS            SETC  '&ZMS "PSWG"'                                     00154700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00154800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00154900
.ZG40A          ANOP  ,                                                 00155000
.*-------------------------------------------------------------------   00155100
.***AG.KXVAR06 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00155200
&ZXPSWG         SETC  'OUTPUT'    SET IN/OUTPUT                         00155300
&XPSWG          SETC  '&PSWG(1)'  SET XVARIABLE                         00155400
                AIF   (N'&PSWG GT 1).ZG40B      MULTI PARMS             00155500
&XPSWG          SETC  '&PSWG'     SET XVARIABLE                         00155600
.ZG40B          AIF   (K'&PSWG(1) GT 0).ZG40C                           00155700
&ZXPSWG         SETC  ''          RESET IN/OUTPUT                       00155800
&ZMS            SETC  'WHEN "EXTRACTPSW" IS SPECIFIED'                  00155900
&ZMS            SETC  '&ZMS , "PSWG" KEY AND ITS'                       00156000
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00156100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00156200
.ZG40C          ANOP  ,                                                 00156300
.*-------------------------------------------------------------------   00156400
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00156500
                AIF   (K'&ZXPSWG LE 0).ZG40R    NOT I/O                 00156600
                AIF   ('&XPSWG'(1,1) NE '(').ZG40R                      00156700
&ZCGPR          SETC  '&XPSWG'(2,K'&XPSWG-2)                            00156800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                      00156900
                AIF   (K'&ZCGPR GT 2).ZG40Q                             00157000
                AIF   ('&ZCGPR' EQ '0').ZG40Q                           00157100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00157200
                AIF   (T'&ZCGPR NE 'N').ZG40Q   INVALID REG NAME        00157300
.ZG40P          ANOP  ,                                                 00157400
                AIF   (T'&ZCGPR NE 'N').ZG40R   NON NUMERIC             00157500
                AIF   ('&ZCGPR' LT '2').ZG40Q                           00157600
                AIF   ('&ZCGPR' LE '12').ZG40R                          00157700
.ZG40Q          ANOP  ,                                                 00157800
&ZMS            SETC  '"PSWG='                                          00157900
&ZMS            SETC  '&ZMS.&PSWG"'                                     00158000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00158100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00158200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00158300
.ZG40R          ANOP  ,                                                 00158400
.*------------------------------------------------------------------    00158500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158600
.ZG42           ANOP  ,                                                 00158700
&ZXFUNCTION     SETC  'INPUT'     SET IN/OUTPUT                         00158800
                AIF   (K'&XFUNCTION GT 0).ZG42E  VALID ARG              00158900
                AIF   (T'&FUNCTION EQ 'O').ZG42D  OMITTED               00159000
&ZASYSLNDX      SETA  0                                                 00159100
.ZG42A          ANOP  ,           POSITIONAL MACRO KEY                  00159200
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00159300
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG42C                  00159400
&ZTLC           SETC 'FUNCTION'                                         00159500
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG42A         00159600
.ZG42B          ANOP  ,                                                 00159700
&ZXFUNCTION     SETC  ''          RESET IN/OUTPUT                       00159800
&ZMS            SETC  'THE "FUNCTION" KEY'                              00159900
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00160000
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00160100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00160200
                AGO   .ZG42E                                            00160300
.ZG42C          ANOP  ,                                                 00160400
&ZXFUNCTION     SETC  ''          RESET IN/OUTPUT                       00160500
&ZMS            SETC  '"FUNCTION='                                      00160600
&ZMS            SETC  '&ZMS.&FUNCTION"'                                 00160700
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00160800
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00160900
&ZMS            SETC  '&ZMS "UPDATE"'                                   00161000
&ZMS            SETC  '&ZMS OR "EXTRACTPSW".'                           00161100
                MNOTE 8,' &ZMS '                                        00161200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00161300
                AGO   .ZG42E                                            00161400
.ZG42D          ANOP  ,                                                 00161500
&XFUNCTION      SETC  'UPDATE'    SET DEFAULT KEYWORD                   00161600
.ZG42E          ANOP  ,                                                 00161700
.*----------------------------------------------------------------***   00161800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00161900
                AIF   (N'&RETCODE LE 1).ZG44A   CK NUM                  00162000
&ZMS            SETC  '"RETCODE='                                       00162100
&ZMS            SETC  '&ZMS.&RETCODE"'                                  00162200
&ZMS            SETC  '&ZMS "RETCODE"'                                  00162300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00162400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00162500
.ZG44A          ANOP  ,                                                 00162600
.*-------------------------------------------------------------------   00162700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00162800
                AIF   (K'&RETCODE(1) LE 0).ZG44C  NO PARM               00162900
&ZXRETCODE      SETC  'OUTPUT'    SET OUTPUT                            00163000
&XRETCODE       SETC  '&RETCODE(1)'             SET XVARIABLE           00163100
                AIF   (N'&RETCODE GT 1).ZG44C                           00163200
&XRETCODE       SETC  '&RETCODE'  SET XVARIABLE                         00163300
.ZG44C          ANOP  ,                                                 00163400
.*-------------------------------------------------------------------   00163500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00163600
                AIF   (K'&ZXRETCODE LE 0).ZG44R  NOT I/O                00163700
                AIF   ('&XRETCODE'(1,1) NE '(').ZG44R                   00163800
&ZCGPR          SETC  '&XRETCODE'(2,K'&XRETCODE-2)                      00163900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                      00164000
                AIF   (K'&ZCGPR GT 2).ZG44Q                             00164100
                AIF   ('&ZCGPR' EQ '0').ZG44Q                           00164200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00164300
                AIF   (T'&ZCGPR NE 'N').ZG44Q   INVALID REG NAME        00164400
.ZG44P          ANOP  ,                                                 00164500
                AIF   (T'&ZCGPR NE 'N').ZG44R   NON NUMERIC             00164600
                AIF   ('&ZCGPR' EQ '15').ZG44R                          00164700
                AIF   ('&ZCGPR' LT '2').ZG44Q                           00164800
                AIF   ('&ZCGPR' LE '12').ZG44R                          00164900
.ZG44Q          ANOP  ,                                                 00165000
&ZMS            SETC  '"RETCODE='                                       00165100
&ZMS            SETC  '&ZMS.&RETCODE"'                                  00165200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00165300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'          00165400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00165500
.ZG44R          ANOP  ,                                                 00165600
.*----------------------------------------------------------------***   00165700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00165800
                AIF   (N'&RSNCODE LE 1).ZG47A   CK NUM                  00165900
&ZMS            SETC  '"RSNCODE='                                       00166000
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00166100
&ZMS            SETC  '&ZMS "RSNCODE"'                                  00166200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00166300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00166400
.ZG47A          ANOP  ,                                                 00166500
.*-------------------------------------------------------------------   00166600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00166700
                AIF   (K'&RSNCODE(1) LE 0).ZG47C  NO PARM               00166800
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            00166900
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           00167000
                AIF   (N'&RSNCODE GT 1).ZG47C                           00167100
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         00167200
.ZG47C          ANOP  ,                                                 00167300
.*-------------------------------------------------------------------   00167400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00167500
                AIF   (K'&ZXRSNCODE LE 0).ZG47R  NOT I/O                00167600
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG47R                   00167700
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      00167800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                      00167900
                AIF   (K'&ZCGPR GT 2).ZG47Q                             00168000
                AIF   ('&ZCGPR' EQ '0').ZG47R                           00168100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00168200
                AIF   (T'&ZCGPR NE 'N').ZG47Q   INVALID REG NAME        00168300
.ZG47P          ANOP  ,                                                 00168400
                AIF   (T'&ZCGPR NE 'N').ZG47R   NON NUMERIC             00168500
                AIF   ('&ZCGPR' EQ '0').ZG47R                           00168600
                AIF   ('&ZCGPR' LT '2').ZG47Q                           00168700
                AIF   ('&ZCGPR' LE '12').ZG47R                          00168800
.ZG47Q          ANOP  ,                                                 00168900
&ZMS            SETC  '"RSNCODE='                                       00169000
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00169100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00169200
                MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'           00169300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00169400
.ZG47R          ANOP  ,                                                 00169500
.******************************************************************     00169600
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00169700
.******************************************************************     00169800
                ACTR  10000                                             00169900
.*----------------------------------------------------------------***   00170000
.***AH.P02 EXTRA POSITIONALS                                            00170100
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00170200
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00170300
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00170400
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00170500
.ZGLISTX1       ANOP  ,                                                 00170600
&ZCVAL          SETC  ''          ERROR FIELD                           00170700
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00170800
.ZGLIST2        ANOP  ,                                                 00170900
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00171000
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00171100
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00171200
                AGO   .ZGLIST2                                          00171300
.*                                                                      00171400
.ZGLIST3        ANOP  ,                                                 00171500
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00171600
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'                         00171700
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00171800
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00171900
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00172000
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00172100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00172200
.ZGLISTX        ANOP  ,                                                 00172300
&ZASYSLNDX      SETA  0                                                 00172400
.*-------------------------------------------------------------------   00172500
.***AG.MF04 MF=(SLE)                                                    00172600
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00172700
.*******************************************************************    00172800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00172900
.*******************************************************************    00173000
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00173100
.*******************************************************************    00173200
.***AE.01  START OF IEARBUP MACRO CODE                                  00173300
.*******************************************************************    00173400
                LCLC  &M0M0001                 NAME                     00173500
&M0M0001        SETC  '&XLABEL'                SET NAME                 00173600
                AIF   (K'&XLABEL NE 0).XLAB2                            00173700
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00173800
.*                                                                      00173900
.XLAB2          ANOP  ,                                                 00174000
                AIF   ('&XMF' EQ 'L').XLAB3                             00174100
&M0M0001 DS    0H                             IEARBUP-0                 00174200
.XLAB3          ANOP  ,                                                 00174300
.*******************************************************************    00174400
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00174500
.*******************************************************************    00174600
              PUSH  PRINT                                               00174700
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00174800
                PRINT OFF         ++ PR01                               00174900
                AGO   .ZPRNTXX                                          00175000
.ZPRINTX        PRINT ON                                                00175100
.ZPRNTXX        ANOP  ,                                                 00175200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00175300
         GBLC  &SYSOSREL                                           @L4A 00175400
         GBLC  &SYSOSREL_ZOSV2R2                                   @L4A 00175500
         AIF   ('&SYSOSREL_ZOSV2R2' EQ '').NeedPlist               @L4A 00175600
         AIF   ('&SYSOSREL' LT '&SYSOSREL_ZOSV2R2').NeedPlist      @L4A 00175700
         AIF   ('&xMF' NE 'S').NeedPlist                           @L4A 00175800
         AIF   ('&SYSASCE' NE 'P').NeedPlist                       @L4A 00175900
         AIF   ('&xFunction' NE 'UPDATE').NeedPlist                @L4A 00176000
         AIF   ('&xPSWBYTE03' NE 'YES').NeedPlist                  @L4A 00176100
         AIF   ('&xAddrType' NE 'NO_CHANGE').NeedPlist             @L4A 00176200
         AIF   ('&xWhichRB' EQ 'EXPLICIT').NeedPlist               @L4A 00176300
         AIF   ('&xWhichRB' NE 'CURRENT').NotCurrent               @L4A 00176400
         SLR   1,1                                                 @L4A 00176500
         AGO   .ZINPUT_END                                         @L4A 00176600
.NotCurrent ANOP                                                   @L4A 00176700
         LA    1,1                                                 @L4A 00176800
         AGO   .ZINPUT_END                                         @L4A 00176900
.NeedPlist ANOP                                                    @L4A 00177000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00177100
.********************************************************************   00177200
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00177300
.********************************************************************   00177400
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00177500
                      LCLA  &ZOPN1         INVOCATION INDEX             00177600
                      LCLC  &ZOPL(4095)    LABEL                        00177700
                      LCLC  &ZOPO(4095)    OPERATION                    00177800
                      LCLC  &ZOPV(4095)    VALUE                        00177900
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00178000
.*                                                                      00178100
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00178200
.******************************************************************     00178300
.***AL.L10 IEARBUP FMT=LIST MF=S!L PARAMETERS                           00178400
.******************************************************************     00178500
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00178600
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00178700
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00178800
&XMFATTR              SETC  '0D'                                        00178900
.*                                                                      00179000
&ZOPN                 SETA  &ZOPN+1                                     00179100
&ZOPL(&ZOPN)          SETC  ' '                                         00179200
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00179300
&ZOPO(&ZOPN)          SETC  'B'                                         00179400
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00179500
                      AGO   .ZALVL6B                                    00179600
.ZALVL6A              ANOP                                              00179700
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00179800
&ZOPV(&ZOPN)          SETC  '4,8'                                       00179900
&ZOPN                 SETA  &ZOPN+1                                     00180000
&ZOPL(&ZOPN)          SETC  ' '                                         00180100
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00180200
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00180300
.ZALVL6B              ANOP                                              00180400
&ZOPD(&ZOPN)          SETC  '++ IEARBUP ARG PARMS'                      00180500
.*                                                                      00180600
&ZOPN                 SETA  &ZOPN+1                                     00180700
&ZOPL(&ZOPN)          SETC  ' '                                         00180800
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00180900
&ZOPV(&ZOPN)          SETC  '1'                                         00181000
&ZOPD(&ZOPN)          SETC  ' '                                         00181100
.*                                                                      00181200
.ZLMFSL2              ANOP  ,                                           00181300
.*-------------------------------------------------------------------   00181400
.***AM.L00  IEARBUP FMT=LIST name                                       00181500
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00181600
&ZOPN                 SETA &ZOPN+1                                      00181700
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00181800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00181900
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00182000
&ZOPD(&ZOPN)          SETC '++ IEARBUP NAME'                            00182100
.ZLMFSL2M             ANOP  ,                                           00182200
.*-------------------------------------------------------------------   00182300
.***AM.L01  IEARBUP FMT=LIST PARAMETERS                                 00182400
&ZOPN                 SETA &ZOPN+1                                      00182500
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00182600
&ZOPO(&ZOPN)          SETC 'DS'                                         00182700
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00182800
&ZOPD(&ZOPN)          SETC '++ IEARBUP PARM LIST'                       00182900
.*-------------------------------------------------------------------   00183000
.***AM.L02 XVERSION XL1                                                 00183100
&ZOPN                 SETA &ZOPN+1                                      00183200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00183300
&ZOPO(&ZOPN)          SETC 'DS'                                         00183400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00183500
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00183600
.*-------------------------------------------------------------------   00183700
.***AM.L03 XFLAGS BL.8                                                  00183800
&ZOPN                 SETA &ZOPN+1                                      00183900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00184000
&ZOPO(&ZOPN)          SETC 'DS'                                         00184100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00184200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00184300
.*                                                                      00184400
&ZOPN                 SETA  &ZOPN+1                                     00184500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ADDRTYPE'                00184600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00184700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00184800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00184900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ADDRTYPE'                     00185000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00185100
.*                                                                      00185200
&ZOPN                 SETA  &ZOPN+1                                     00185300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRTYPE_INRBOPSWA'             00185400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00185500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00185600
&ZOPD(&ZOPN)          SETC  '++ XADDRTYPE.'                             00185700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INRBOPSWA'                    00185800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00185900
.*                                                                      00186000
&ZOPN                 SETA  &ZOPN+1                                     00186100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRTYPE_ACTUAL'                00186200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00186300
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00186400
&ZOPD(&ZOPN)          SETC  '++ XADDRTYPE.'                             00186500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ACTUAL'                       00186600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00186700
.*                                                                      00186800
&ZOPN                 SETA  &ZOPN+1                                     00186900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRTYPE_DELTA'                 00187000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00187100
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00187200
&ZOPD(&ZOPN)          SETC  '++ XADDRTYPE.'                             00187300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DELTA'                        00187400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00187500
.*                                                                      00187600
&ZOPN                 SETA  &ZOPN+1                                     00187700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XWHICHRB_CURRENT'                00187800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00187900
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00188000
&ZOPD(&ZOPN)          SETC  '++ XWHICHRB.'                              00188100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CURRENT'                      00188200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00188300
.*                                                                      00188400
&ZOPN                 SETA  &ZOPN+1                                     00188500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XWHICHRB_EXPLICIT'               00188600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00188700
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00188800
&ZOPD(&ZOPN)          SETC  '++ XWHICHRB.'                              00188900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EXPLICIT'                     00189000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00189100
.*                                                                      00189200
&ZOPN                 SETA  &ZOPN+1                                     00189300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XPSWBYTE03_YES'                  00189400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00189500
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00189600
&ZOPD(&ZOPN)          SETC  '++ XPSWBYTE03.'                            00189700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00189800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00189900
.*-------------------------------------------------------------------   00190000
.***AM.L05 XAMODE XL1                                                   00190100
&ZOPN                 SETA &ZOPN+1                                      00190200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAMODE'                           00190300
&ZOPO(&ZOPN)          SETC 'DS'                                         00190400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00190500
&ZOPD(&ZOPN)          SETC '++ &ZXAMODE XAMODE'                         00190600
.*                                                                      00190700
&ZOPN                 SETA  &ZOPN+1                                     00190800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAMODE_UNCHANGED'                00190900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00191000
&ZOPV(&ZOPN)          SETC  '0'                                         00191100
&ZOPD(&ZOPN)          SETC  '++ XAMODE.'                                00191200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UNCHANGED'                    00191300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00191400
.*                                                                      00191500
&ZOPN                 SETA  &ZOPN+1                                     00191600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAMODE_24'                       00191700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00191800
&ZOPV(&ZOPN)          SETC  '1'                                         00191900
&ZOPD(&ZOPN)          SETC  '++ XAMODE.'                                00192000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).24'                           00192100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00192200
.*                                                                      00192300
&ZOPN                 SETA  &ZOPN+1                                     00192400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAMODE_31'                       00192500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00192600
&ZOPV(&ZOPN)          SETC  '2'                                         00192700
&ZOPD(&ZOPN)          SETC  '++ XAMODE.'                                00192800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).31'                           00192900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00193000
.*                                                                      00193100
&ZOPN                 SETA  &ZOPN+1                                     00193200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAMODE_64'                       00193300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00193400
&ZOPV(&ZOPN)          SETC  '3'                                         00193500
&ZOPD(&ZOPN)          SETC  '++ XAMODE.'                                00193600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).64'                           00193700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00193800
.*-------------------------------------------------------------------   00193900
.***AM.L05 XFUNCTION XL1                                                00194000
&ZOPN                 SETA &ZOPN+1                                      00194100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNCTION'                        00194200
&ZOPO(&ZOPN)          SETC 'DS'                                         00194300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00194400
&ZOPD(&ZOPN)          SETC '++ &ZXFUNCTION XFUNCTION'                   00194500
.*                                                                      00194600
&ZOPN                 SETA  &ZOPN+1                                     00194700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNCTION_UPDATE'                00194800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00194900
&ZOPV(&ZOPN)          SETC  '0'                                         00195000
&ZOPD(&ZOPN)          SETC  '++ XFUNCTION.'                             00195100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UPDATE'                       00195200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00195300
.*                                                                      00195400
&ZOPN                 SETA  &ZOPN+1                                     00195500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNCTION_EXTRACTPSW'            00195600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00195700
&ZOPV(&ZOPN)          SETC  '1'                                         00195800
&ZOPD(&ZOPN)          SETC  '++ XFUNCTION.'                             00195900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EXTRACTPSW'                   00196000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00196100
.*-------------------------------------------------------------------   00196200
.***AM.L09  XPSWDELTA F                                                 00196300
&ZOPN                 SETA &ZOPN+1                                      00196400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPSWDELTA'                        00196500
&ZOPO(&ZOPN)          SETC 'DS'                                         00196600
&ZOPV(&ZOPN)          SETC 'F'                                          00196700
&ZOPD(&ZOPN)          SETC '++ &ZXPSWDELTA '                            00196800
.*-------------------------------------------------------------------   00196900
.***AM.L09  XRSV0008 CL4                                                00197000
&ZOPN                 SETA &ZOPN+1                                      00197100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0008'                         00197200
&ZOPO(&ZOPN)          SETC 'DS'                                         00197300
&ZOPV(&ZOPN)          SETC 'CL4'                                        00197400
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00197500
.*-------------------------------------------------------------------   00197600
.***AM.L09 ADDR XRB A                                                   00197700
&ZOPN                 SETA &ZOPN+1                                      00197800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRB_ADDR'                         00197900
&ZOPO(&ZOPN)          SETC 'DS'                                         00198000
&ZOPV(&ZOPN)          SETC 'A'                                          00198100
&ZOPD(&ZOPN)          SETC '++ &ZXRB ADDR'                              00198200
.*-------------------------------------------------------------------   00198300
.***AM.L09  XRSV0010 CL4                                                00198400
&ZOPN                 SETA &ZOPN+1                                      00198500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0010'                         00198600
&ZOPO(&ZOPN)          SETC 'DS'                                         00198700
&ZOPV(&ZOPN)          SETC 'CL4'                                        00198800
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00198900
.*-------------------------------------------------------------------   00199000
.***AM.MLM1 SAVED LOCATION COUNTER                                      00199100
                      AIF  ('&ZENDBASEPL' NE '').ZL21LB                 00199200
&ZENDBASEPL           SETC 'YES'                                        00199300
&ZOPN                 SETA &ZOPN+1                                      00199400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00199500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00199600
&ZOPV(&ZOPN)          SETC '*'                                          00199700
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00199800
.ZL21LB               ANOP  ,                                           00199900
.*-------------------------------------------------------------------   00200000
.***AM.PJR1 DEFINED ON XPSWDELTA                                        00200100
&ZOPN                 SETA &ZOPN+1                                      00200200
&ZOPL(&ZOPN)          SETC ' '                                          00200300
&ZOPO(&ZOPN)          SETC 'ORG'                                        00200400
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+4'                                00200500
&ZOPD(&ZOPN)          SETC ' '                                          00200600
.*-------------------------------------------------------------------   00200700
.***AM.L09  XPSWADDR CL8                                                00200800
&ZOPN                 SETA &ZOPN+1                                      00200900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPSWADDR'                         00201000
&ZOPO(&ZOPN)          SETC 'DS'                                         00201100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00201200
&ZOPD(&ZOPN)          SETC '++ &ZXPSWADDR '                             00201300
.*-------------------------------------------------------------------   00201400
.***AM.PJR1 DEFINED ON XPSWDELTA                                        00201500
&ZOPN                 SETA &ZOPN+1                                      00201600
&ZOPL(&ZOPN)          SETC ' '                                          00201700
&ZOPO(&ZOPN)          SETC 'ORG'                                        00201800
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+4'                                00201900
&ZOPD(&ZOPN)          SETC ' '                                          00202000
.*-------------------------------------------------------------------   00202100
.***AM.L09 ADDR XPSWG A                                                 00202200
&ZOPN                 SETA &ZOPN+1                                      00202300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPSWG_ADDR'                       00202400
&ZOPO(&ZOPN)          SETC 'DS'                                         00202500
&ZOPV(&ZOPN)          SETC 'A'                                          00202600
&ZOPD(&ZOPN)          SETC '++ &ZXPSWG ADDR'                            00202700
&ZOPN                 SETA &ZOPN+1                                      00202800
&ZOPL(&ZOPN)          SETC ' '                                          00202900
&ZOPO(&ZOPN)          SETC 'ORG'                                        00203000
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00203100
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00203200
.*-------------------------------------------------------------------   00203300
.***AM.L10 END OF IEARBUP LIST PARAMETERS                               00203400
&ZOPN                 SETA &ZOPN+1                                      00203500
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00203600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00203700
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00203800
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00203900
.*                                                                      00204000
&ZOPN                 SETA &ZOPN+1                                      00204100
&ZOPL(&ZOPN)          SETC ' '                                          00204200
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00204300
&ZOPV(&ZOPN)          SETC '1'                                          00204400
&ZOPD(&ZOPN)          SETC ' '                                          00204500
.*-------------------------------------------------------------------   00204600
.***AL.L12 IEARBUP FMT=LIST MF=S!L PARAMETERS                           00204700
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00204800
.*                                                                      00204900
&ZOPN                 SETA  &ZOPN+1                                     00205000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00205100
&ZOPO(&ZOPN)          SETC  'DC'                                        00205200
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00205300
&ZOPD(&ZOPN)          SETC  '++ IEARBUP ARG PARMS'                      00205400
.*                                                                      00205500
.ZLMFSLX              ANOP  ,                                           00205600
.*-------------------------------------------------------------------   00205700
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00205800
&ZPLLEN               SETA 20                                           00205900
.*                                                                      00206000
.******************************************************************     00206100
.***AI.L01 IEARBUP FMT=LIST FILL IN PARAMETER AREA                      00206200
.******************************************************************     00206300
                      ACTR  10000                                       00206400
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00206500
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00206600
&ZCVAL                SETC  'LAE'          XAX MODE                     00206700
.ZIMFXA               ANOP ,                                            00206800
.*                                                                      00206900
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00207000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00207100
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00207200
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00207300
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00207400
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00207500
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00207600
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00207700
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00207800
&ZOPN                 SETA  &ZOPN+1                                     00207900
&ZOPL(&ZOPN)          SETC  ' '                                         00208000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00208100
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00208200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00208300
                      AGO   .ZIMFNX                                     00208400
.*                                                                      00208500
.ZIMFN2               ANOP ,                                            00208600
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00208700
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00208800
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00208900
&ZOPN                 SETA  &ZOPN+1                                     00209000
&ZOPL(&ZOPN)          SETC  ' '                                         00209100
&ZOPO(&ZOPN)          SETC  'LAE'                                       00209200
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00209300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00209400
                      AGO   .ZIMFNX                                     00209500
.ZIMFNX1              ANOP ,                                            00209600
&ZOPN                 SETA  &ZOPN+1                                     00209700
&ZOPL(&ZOPN)          SETC  ' '                                         00209800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00209900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00210000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00210100
.ZIMFNX               ANOP ,                                            00210200
.********************************************************************   00210300
.***AI.L02 IEARBUP FMT=LIST INITIALIZE PARAMETER AREA                   00210400
.********************************************************************   00210500
.***AI.L03 MF=(SLE)                                                     00210600
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00210700
.*                                                                      00210800
&ZOPN                 SETA  &ZOPN+1                                     00210900
&ZOPL(&ZOPN)          SETC  ' '                                         00211000
&ZOPO(&ZOPN)          SETC  'XC'                                        00211100
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00211200
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00211300
.ZIMFLX               ANOP  ,                                           00211400
.*-------------------------------------------------------------------   00211500
.***AI.L05 XFLAGS BL1                                                   00211600
&ZW                   SETC  ''                                          00211700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00211800
.*-------------------------------------------------------------------   00211900
.***AI.L08 XFLAGS "ADDRTYPE"                                            00212000
.***      BL1'1XXXXXXX'                                                 00212100
         AIF   ('&ADDRTYPE' EQ '').ZI3A                                 00212200
&ZW                   SETC  '&ZW.1'                                     00212300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00212400
                      AGO   .ZI3C                                       00212500
.*                                                                      00212600
.ZI3A                 ANOP  ,                                           00212700
&ZW                   SETC  '&ZW.0'                                     00212800
.ZI3C                 ANOP  ,                                           00212900
.*-------------------------------------------------------------------   00213000
.***AI.L08 XFLAGS "INRBOPSWA"                                           00213100
.***      BL1'X1XXXXXX'                                                 00213200
         AIF   ('&XADDRTYPE' NE 'INRBOPSWA').ZI4A                       00213300
&ZW                   SETC  '&ZW.1'                                     00213400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00213500
                      AGO   .ZI4C                                       00213600
.*                                                                      00213700
.ZI4A                 ANOP  ,                                           00213800
&ZW                   SETC  '&ZW.0'                                     00213900
.ZI4C                 ANOP  ,                                           00214000
.*-------------------------------------------------------------------   00214100
.***AI.L08 XFLAGS "ACTUAL"                                              00214200
.***      BL1'XX1XXXXX'                                                 00214300
         AIF   ('&XADDRTYPE' NE 'ACTUAL').ZI5A                          00214400
&ZW                   SETC  '&ZW.1'                                     00214500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00214600
                      AGO   .ZI5C                                       00214700
.*                                                                      00214800
.ZI5A                 ANOP  ,                                           00214900
&ZW                   SETC  '&ZW.0'                                     00215000
.ZI5C                 ANOP  ,                                           00215100
.*-------------------------------------------------------------------   00215200
.***AI.L08 XFLAGS "DELTA"                                               00215300
.***      BL1'XXX1XXXX'                                                 00215400
         AIF   ('&XADDRTYPE' NE 'DELTA').ZI6A                           00215500
&ZW                   SETC  '&ZW.1'                                     00215600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00215700
                      AGO   .ZI6C                                       00215800
.*                                                                      00215900
.ZI6A                 ANOP  ,                                           00216000
&ZW                   SETC  '&ZW.0'                                     00216100
.ZI6C                 ANOP  ,                                           00216200
.*-------------------------------------------------------------------   00216300
.***AI.L08 XFLAGS "CURRENT"                                             00216400
.***      BL1'XXXX1XXX'                                                 00216500
         AIF   ('&XWHICHRB' NE 'CURRENT').ZI7A                          00216600
&ZW                   SETC  '&ZW.1'                                     00216700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00216800
                      AGO   .ZI7C                                       00216900
.*                                                                      00217000
.ZI7A                 ANOP  ,                                           00217100
&ZW                   SETC  '&ZW.0'                                     00217200
.ZI7C                 ANOP  ,                                           00217300
.*-------------------------------------------------------------------   00217400
.***AI.L08 XFLAGS "EXPLICIT"                                            00217500
.***      BL1'XXXXX1XX'                                                 00217600
         AIF   ('&XWHICHRB' NE 'EXPLICIT').ZI8A                         00217700
&ZW                   SETC  '&ZW.1'                                     00217800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00217900
                      AGO   .ZI8C                                       00218000
.*                                                                      00218100
.ZI8A                 ANOP  ,                                           00218200
&ZW                   SETC  '&ZW.0'                                     00218300
.ZI8C                 ANOP  ,                                           00218400
.*-------------------------------------------------------------------   00218500
.***AI.L08 XFLAGS "YES"                                                 00218600
.***      BL1'XXXXXXX1'                                                 00218700
         AIF   ('&XPSWBYTE03' NE 'YES').ZI9A                            00218800
&ZW                   SETC  '&ZW.01'                                    00218900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00219000
                      AGO   .ZI9C                                       00219100
.*                                                                      00219200
.ZI9A                 ANOP  ,                                           00219300
&ZW                   SETC  '&ZW.00'                                    00219400
.ZI9C                 ANOP  ,                                           00219500
.*-------------------------------------------------------------------   00219600
.***AI.L11 XFLAGS BL1                                                   00219700
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00219800
&ZOPN                 SETA  &ZOPN+1                                     00219900
&ZOPL(&ZOPN)          SETC  ' '                                         00220000
&ZOPO(&ZOPN)          SETC  'OI'                                        00220100
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00220200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00220300
.ZI9E                 ANOP  ,                                           00220400
.*-------------------------------------------------------------------   00220500
.***AI.L07 XAMODE AL1                                                   00220600
&ZW                   SETC  ''                                          00220700
.*-------------------------------------------------------------------   00220800
.***AI.L15 XAMODE "UNCHANGED" AL1                                       00220900
         AIF   ('&XAMODE' NE 'UNCHANGED').ZI11A                         00221000
&ZW                   SETC  '0'                                         00221100
.ZI11A                ANOP  ,                                           00221200
.*-------------------------------------------------------------------   00221300
.***AI.L15 XAMODE "24" AL1                                              00221400
         AIF   ('&XAMODE' NE '24').ZI12A                                00221500
&ZW                   SETC  '1'                                         00221600
.ZI12A                ANOP  ,                                           00221700
.*-------------------------------------------------------------------   00221800
.***AI.L15 XAMODE "31" AL1                                              00221900
         AIF   ('&XAMODE' NE '31').ZI13A                                00222000
&ZW                   SETC  '2'                                         00222100
.ZI13A                ANOP  ,                                           00222200
.*-------------------------------------------------------------------   00222300
.***AI.L15 XAMODE "64" AL1                                              00222400
         AIF   ('&XAMODE' NE '64').ZI14A                                00222500
&ZW                   SETC  '3'                                         00222600
.ZI14A                ANOP  ,                                           00222700
.*-------------------------------------------------------------------   00222800
.***AI.L17 XAMODE AL1                                                   00222900
                      AIF   ('&ZW' EQ '0').ZI14B                        00223000
                      AIF   ('&ZW' EQ '').ZI14B                         00223100
.*                                                                      00223200
&ZOPN                 SETA  &ZOPN+1                                     00223300
&ZOPL(&ZOPN)          SETC  ' '                                         00223400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00223500
&ZOPV(&ZOPN)          SETC  '2(1),&ZW'                                  00223600
&ZOPD(&ZOPN)          SETC  '++ &ZXAMODE XAMODE'                        00223700
.ZI14B                ANOP  ,                                           00223800
.*-------------------------------------------------------------------   00223900
.***AI.L07 XFUNCTION AL1                                                00224000
&ZW                   SETC  ''                                          00224100
.*-------------------------------------------------------------------   00224200
.***AI.L15 XFUNCTION "UPDATE" AL1                                       00224300
         AIF   ('&XFUNCTION' NE 'UPDATE').ZI16A                         00224400
&ZW                   SETC  '0'                                         00224500
.ZI16A                ANOP  ,                                           00224600
.*-------------------------------------------------------------------   00224700
.***AI.L15 XFUNCTION "EXTRACTPSW" AL1                                   00224800
         AIF   ('&XFUNCTION' NE 'EXTRACTPSW').ZI17A                     00224900
&ZW                   SETC  '1'                                         00225000
.ZI17A                ANOP  ,                                           00225100
.*-------------------------------------------------------------------   00225200
.***AI.L17 XFUNCTION AL1                                                00225300
                      AIF   ('&ZW' EQ '0').ZI17B                        00225400
                      AIF   ('&ZW' EQ '').ZI17B                         00225500
.*                                                                      00225600
&ZOPN                 SETA  &ZOPN+1                                     00225700
&ZOPL(&ZOPN)          SETC  ' '                                         00225800
&ZOPO(&ZOPN)          SETC  'MVI'                                       00225900
&ZOPV(&ZOPN)          SETC  '3(1),&ZW'                                  00226000
&ZOPD(&ZOPN)          SETC  '++ &ZXFUNCTION XFUNCTION'                  00226100
.ZI17B                ANOP  ,                                           00226200
.*-------------------------------------------------------------------   00226300
.***AI.L25  XPSWDELTA F                                                 00226400
                      AIF   ('&ZXPSWDELTA' EQ '').ZI18E                 00226500
                      AIF   ('&ZXPSWDELTA' EQ 'OUTPUT').ZI18E           00226600
&ZCGPR                SETC  '&XPSWDELTA'                                00226700
.*                                                                      00226800
                      AIF   ('&XPSWDELTA'(1,1) NE '(').ZI18B            00226900
&ZCGPR   SETC  '0('.'&XPSWDELTA'(2,K'&XPSWDELTA-2).')'                  00227000
                      AGO   .ZI18D                                      00227100
.ZI18B                ANOP  ,                                           00227200
.*                                                                      00227300
&ZC                   SETC  '&XPSWDELTA'(1,1)                           00227400
                      AIF   (T'&ZC NE 'N').ZI18D                        00227500
&ZC                   SETC  '&XPSWDELTA'                                00227600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               00227700
&ZCGPR                SETC  '=FL4''&XPSWDELTA'''                        00227800
.*                                                                      00227900
.ZI18D                ANOP  ,                                           00228000
.*                                                                      00228100
&ZOPN                 SETA  &ZOPN+1                                     00228200
&ZOPL(&ZOPN)          SETC  ' '                                         00228300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00228400
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00228500
&ZOPD(&ZOPN)          SETC  '++ &ZXPSWDELTA XPSWDELTA'                  00228600
.*                                                                      00228700
.ZI18E                ANOP  ,                                           00228800
.*-------------------------------------------------------------------   00228900
.***AI.L19 ADDR XRB A                                                   00229000
                      AIF   ('&ZXRB' EQ '').ZI20H                       00229100
&ZCLNG                SETC  '&XRB'                                      00229200
&ZCGPR                SETC  '14'                                        00229300
         AIF   ('&XRB'(1,1) EQ '(').ZI20F  IN GPR                       00229400
.*                                                                      00229500
&ZOPN                 SETA  &ZOPN+1                                     00229600
&ZOPL(&ZOPN)          SETC  ' '                                         00229700
&ZOPO(&ZOPN)          SETC  'LA'                                        00229800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00229900
&ZOPD(&ZOPN)          SETC  '++ &ZXRB XRB'                              00230000
.*                                                                      00230100
                      AGO   .ZI20G                                      00230200
.*                                                                      00230300
.ZI20F                ANOP  ,                                           00230400
&ZCGPR   SETC  '&XRB'(2,K'&XRB-2)                                       00230500
.*                                                                      00230600
.ZI20G                ANOP  ,                                           00230700
.*                                                                      00230800
&ZOPN                 SETA  &ZOPN+1                                     00230900
&ZOPL(&ZOPN)          SETC  ' '                                         00231000
&ZOPO(&ZOPN)          SETC  'ST'                                        00231100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00231200
&ZOPD(&ZOPN)          SETC  '++ &ZXRB XRB'                              00231300
.*                                                                      00231400
.ZI20H                ANOP  ,                                           00231500
.*-------------------------------------------------------------------   00231600
.***AI.L25  XPSWADDR CL8                                                00231700
                      AIF   ('&ZXPSWADDR' EQ '').ZI23E                  00231800
                      AIF   ('&ZXPSWADDR' EQ 'OUTPUT').ZI23E            00231900
&ZCGPR                SETC  '&XPSWADDR'                                 00232000
.*                                                                      00232100
                      AIF   ('&XPSWADDR'(1,1) NE '(').ZI23B             00232200
&ZCGPR   SETC  '0('.'&XPSWADDR'(2,K'&XPSWADDR-2).')'                    00232300
.ZI23B                ANOP  ,                                           00232400
.*                                                                      00232500
&ZOPN                 SETA  &ZOPN+1                                     00232600
&ZOPL(&ZOPN)          SETC  ' '                                         00232700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00232800
&ZOPV(&ZOPN)          SETC  '4(8,1),&ZCGPR'                             00232900
&ZOPD(&ZOPN)          SETC  '++ &ZXPSWADDR XPSWADDR'                    00233000
.*                                                                      00233100
.ZI23E                ANOP  ,                                           00233200
.*-------------------------------------------------------------------   00233300
.***AI.L19 ADDR XPSWG A                                                 00233400
                      AIF   ('&ZXPSWG' EQ '').ZI25H                     00233500
&ZCLNG                SETC  '&XPSWG'                                    00233600
&ZCGPR                SETC  '14'                                        00233700
         AIF   ('&XPSWG'(1,1) EQ '(').ZI25F  IN GPR                     00233800
.*                                                                      00233900
&ZOPN                 SETA  &ZOPN+1                                     00234000
&ZOPL(&ZOPN)          SETC  ' '                                         00234100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00234200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00234300
&ZOPD(&ZOPN)          SETC  '++ &ZXPSWG XPSWG'                          00234400
.*                                                                      00234500
                      AGO   .ZI25G                                      00234600
.*                                                                      00234700
.ZI25F                ANOP  ,                                           00234800
&ZCGPR   SETC  '&XPSWG'(2,K'&XPSWG-2)                                   00234900
.*                                                                      00235000
.ZI25G                ANOP  ,                                           00235100
.*                                                                      00235200
&ZOPN                 SETA  &ZOPN+1                                     00235300
&ZOPL(&ZOPN)          SETC  ' '                                         00235400
&ZOPO(&ZOPN)          SETC  'ST'                                        00235500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              00235600
&ZOPD(&ZOPN)          SETC  '++ &ZXPSWG XPSWG'                          00235700
.*                                                                      00235800
.ZI25H                ANOP  ,                                           00235900
.*-------------------------------------------------------------------   00236000
&ZOPN1                SETA &ZOPN                                        00236100
.*******************************************************************    00236200
.***  PROCESS IEARBUP OUTPUT PARAMETERS                                 00236300
.*******************************************************************    00236400
                      ACTR  10000                                       00236500
.*******************************************************************    00236600
.***AO.X02  RETURN CODE PROCESSING                                      00236700
.*******************************************************************    00236800
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00236900
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00237000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00237100
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00237200
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00237300
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00237400
&ZOPN                 SETA  &ZOPN+1                                     00237500
&ZOPL(&ZOPN)          SETC  ' '                                         00237600
&ZOPO(&ZOPN)          SETC  'ST'                                        00237700
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00237800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00237900
                      AGO   .ZMRETX                                     00238000
.*                                                                      00238100
.ZMRET2               ANOP  ,                                           00238200
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00238300
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00238400
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00238500
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00238600
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00238700
&ZOPN                 SETA  &ZOPN+1                                     00238800
&ZOPL(&ZOPN)          SETC  ' '                                         00238900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00239000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00239100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00239200
.ZMRETX               ANOP  ,                                           00239300
.*******************************************************************    00239400
.***AO.X03  REASON CODE PROCESSING                                      00239500
.*******************************************************************    00239600
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00239700
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00239800
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00239900
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00240000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00240100
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00240200
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00240300
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00240400
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00240500
&ZOPN                 SETA  &ZOPN+1                                     00240600
&ZOPL(&ZOPN)          SETC  ' '                                         00240700
&ZOPO(&ZOPN)          SETC  'ST'                                        00240800
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00240900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00241000
                      AGO   .ZMRSNX                                     00241100
.*                                                                      00241200
.ZMRSN2               ANOP  ,                                           00241300
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00241400
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00241500
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00241600
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00241700
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00241800
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00241900
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00242000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00242100
&ZOPN                 SETA  &ZOPN+1                                     00242200
&ZOPL(&ZOPN)          SETC  ' '                                         00242300
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00242400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00242500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00242600
.ZMRSNX               ANOP  ,                                           00242700
.*******************************************************************    00242800
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00242900
.*******************************************************************    00243000
.ZMFLX                ANOP  ,              MF=L PROCESSING              00243100
.*******************************************************************    00243200
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00243300
.*******************************************************************    00243400
                      ACTR  10000                                       00243500
.*                                                                      00243600
                      LCLA  &ZLC           COLUMN POSITION              00243700
                      LCLA  &ZOPX          LIST TABLE INDEX             00243800
                      LCLC  &ZLL           LABEL                        00243900
                      LCLC  &ZLOP          OPERATION                    00244000
                      LCLC  &ZLV           VALUE                        00244100
                      LCLC  &ZLD           DESCRIPTION                  00244200
.*                                                                      00244300
&ZOPX                 SETA  1                                           00244400
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00244500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00244600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00244700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00244800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00244900
                      AIF   (K'&ZLD LE 0).ZL5                           00245000
&ZLC                  SETA  35             COMMENT COLUMN               00245100
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00245200
&ZLC                  SETA  33             COMMMENT COLUMN              00245300
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00245400
&ZLV                  SETC  '&ZLV'.' '                                  00245500
                      AGO   .ZL3                                        00245600
.*                                                                      00245700
.ZL4                  ANOP  ,                                           00245800
&ZLV                  SETC  '&ZLV'.' '                                  00245900
.ZL5                  ANOP  ,                                           00246000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00246100
.*                                                                      00246200
&ZLL     &ZLOP &ZLV                                                     00246300
.*                                                                      00246400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00246500
                      AGO   .ZL2           CONTINUE LOOPING             00246600
.*                                                                      00246700
.ZLX                  ANOP  ,                                           00246800
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00246900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00247000
         L     15,16(0,0)              GET CVT ADDRESS             @L1A 00247100
         L     15,CVTECVT-CVT(15,0)    GET ECVT address            @L1A 00247200
         L     15,ECVTRBUP-ECVT(15,0)  GET RB update address       @L1A 00247300
         BASR  14,15                   CALL RB update service      @L1A 00247400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00247500
.ZLINKX               ANOP  ,                                           00247600
.*******************************************************************    00247700
.***AP.X01  FORMAT GENERATED CODE                                       00247800
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00247900
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00248000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00248100
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00248200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00248300
                      AIF   (K'&ZLD LE 0).ZL51                          00248400
&ZLC                  SETA  35             COMMENT COLUMN               00248500
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00248600
&ZLC                  SETA  33             COMMENT COLUMN               00248700
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00248800
&ZLV                  SETC  '&ZLV'.' '                                  00248900
                      AGO   .ZL31                                       00249000
.*                                                                      00249100
.ZL41                 ANOP  ,                                           00249200
&ZLV                  SETC  '&ZLV'.' '                                  00249300
.ZL51                 ANOP  ,                                           00249400
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00249500
.*                                                                      00249600
&ZLL     &ZLOP &ZLV                                                     00249700
.*                                                                      00249800
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00249900
                      AGO   .ZL21          CONTINUE LOOPING             00250000
.*                                                                      00250100
.ZLX1                 ANOP  ,                                           00250200
.*******************************************************************    00250300
.***AP.X02  END OF IEARBUP MACRO                                        00250400
&ZIEARBUP             SETC  'YES'          SET IEARBUP USED             00250500
         POP   PRINT                                                    00250600
*                                            IEARBUP-0                  00250700
         SPACE 1                                                        00250800
.ZLX2                 ANOP  ,                                           00250900
         MEND                                                           00251000
**********************************************************************/ 00251100
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00251200
*%IEARBUP: MACRO KEYS(WHICHRB,RB,FUNCTION,PSWBYTE03,ADDRTYPE,PSWADDR,   00251300
*                 AMODE,PSWDELTA,PSWG,RETCODE,RSNCODE,MF);              00251400
*  ANS('?'!!MACLABEL!!' '!!'IEARBUPP '!!MACLIST!!                       00251500
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00251600
*%END IEARBUP;                                                          00251700

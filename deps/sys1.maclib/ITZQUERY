*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  ITZQUERY                              -09/27/13-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Transaction Trace Query                       * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2000, 2013                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7790                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      This service is used to query if the particular transaction or * 00002100
*      work unit needs to be traced.                                  * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00002400
*                                                                     * 00002500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002600
*                                                                     * 00002700
*01* ENVIRONMENT:                                                     * 00002800
*                                                                     * 00002900
*                                                                     * 00003000
*      Minimum authorization: Problem state.  PSW key 8-15.           * 00003100
*                                                                     * 00003200
*      Dispatchable unit mode: Task or SRB mode.                      * 00003300
*                                                                     * 00003400
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00003500
*                                                                     * 00003600
*      AMODE:            31-bit.                                      * 00003700
*                                                                     * 00003800
*      ASC mode:         Primary.                                     * 00003900
*                                                                     * 00004000
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004100
*                                                                     * 00004200
*      Locks:            No locks held.                               * 00004300
*                                                                     * 00004400
*      Control parameters: Control parameters must be in the primary  * 00004500
*                        address space.                               * 00004600
*                                                                     * 00004700
*                                                                     * 00004800
*                                                                     * 00004900
*01* PROGRAMMING REQUIREMENTS:                                        * 00005000
*                                                                     * 00005100
*    Any module that invokes this macro must include the macros CVT   * 00005200
*    and IHAECVT.  e.g. in PL/X - %INCLUDE SYSLIB(CVT),  %INCLUDE     * 00005300
*    SYSLIB(IHAECVT)                                                  * 00005400
*                                                                     * 00005500
*01* RESTRICTIONS:                                                    * 00005600
*                                                                     * 00005700
*01* INPUT REGISTER INFORMATION:                                      * 00005800
*                                                                     * 00005900
*    Before issuing the ITZQUERY macro, the caller must ensure that   * 00006000
*    the following general purpose registers (GPRs) contain the       * 00006100
*    specified information:                                           * 00006200
*                                                                     * 00006300
*                                                                     * 00006400
*    REGISTER  CONTENTS                                               * 00006500
*                                                                     * 00006600
*    13        The address of a 72-byte standard save area in the     * 00006700
*              primary address space                                  * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*    Before issuing the ITZQUERY macro, the caller does not have to   * 00007200
*    place any information into any AR                                * 00007300
*                                                                     * 00007400
*01* OUTPUT REGISTER INFORMATION:                                     * 00007500
*                                                                     * 00007600
*    When control returns to the caller, the GPRs contain:            * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*    REGISTER  CONTENTS                                               * 00008000
*                                                                     * 00008100
*    0         Unchanged                                              * 00008200
*                                                                     * 00008300
*    1         Used as work register by the system                    * 00008400
*                                                                     * 00008500
*    2-13      Unchanged                                              * 00008600
*                                                                     * 00008700
*    14        Used as work register by the system                    * 00008800
*                                                                     * 00008900
*    15        Contains the return code.                              * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*    When control returns to the caller, the ARs contain:             * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*    REGISTER  CONTENTS                                               * 00009700
*                                                                     * 00009800
*    0-1       Used as work registers by the system                   * 00009900
*                                                                     * 00010000
*    2-13      Unchanged                                              * 00010100
*                                                                     * 00010200
*    14-15     Used as work registers by the system                   * 00010300
*                                                                     * 00010400
*                                                                     * 00010500
*                                                                     * 00010600
*    Some callers depend on register contents remaining the same      * 00010700
*    before and after issuing a service.  If the system changes the   * 00010800
*    contents of registers on which the caller depends, the caller    * 00010900
*    must save them before issuing the service, and restore them      * 00011000
*    after the system returns control.                                * 00011100
*                                                                     * 00011200
*01* PERFORMANCE IMPLICATIONS:                                        * 00011300
*                                                                     * 00011400
*    Specifying the MONTKN64 or MONTKN in a monitoring environment    * 00011500
*    results in a faster query.                                       * 00011600
*                                                                     * 00011700
*01* SYNTAX:                                                          * 00011800
*                                                                     * 00011900
*Ýxlabel¨  ITZQUERY  ÐÝ MONTKN=»xmontkn!0º                            * 00012000
*                    ¿ ,MONTKN64=»xmontkn64!0º¨                       * 00012100
*                      ,TRACETKN=xtracetkn                            * 00012200
*                     Ý,TRACELVL=xtracelvl¨                           * 00012300
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00012400
*                    ÐÝ,MF=S¨                                         * 00012500
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00012600
*                    ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00012700
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*      Where:                                                         * 00013100
*                                                                     * 00013200
*                                                                     * 00013300
*      Ýxlabel¨                                                       * 00013400
*          is an optional symbol, starting in column 1, that is the   * 00013500
*          name on the ITZQUERY macro invocation.  The name must      * 00013600
*          conform to the rules for an ordinary assembler language    * 00013700
*          symbol.                                                    * 00013800
*          DEFAULT: No name.                                          * 00013900
*                                                                     * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*      The following is a set of mutually exclusive keys.  This set   * 00014400
*      is optional; only one key may be specified.                    * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*      ÝMONTKN=»xmontkn!0º                                            * 00014800
*          belongs to a set of mutually exclusive keys. It is the     * 00014900
*          name (RS-type), or address in register (2)-(12), of an     * 00015000
*          optional 32 bit input that is the token used to locate the * 00015100
*          current monitoring environment.                            * 00015200
*                                                                     * 00015300
*          It is recommended that MONTKN64 or MONTKN be specified for * 00015400
*          a monitoring environment to keep the query pathlength      * 00015500
*          short and fast.                                            * 00015600
*          DEFAULT: 0                                                 * 00015700
*                                                                     * 00015800
*      MONTKN64=»xmontkn64!0º¨                                        * 00015900
*          belongs to a set of mutually exclusive keys. It is the     * 00016000
*          name (RS-type), or address in register (2)-(12), of an     * 00016100
*          optional 64 bit input that is the token used to locate the * 00016200
*          current monitoring environment.                            * 00016300
*                                                                     * 00016400
*          It is recommended that MONTKN64 or MONTKN be specified for * 00016500
*          a monitoring environment to keep the query pathlength      * 00016600
*          short and fast.                                            * 00016700
*          DEFAULT: 0                                                 * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*      End of a set of mutually exclusive optional keys.              * 00017200
*      DEFAULT: MONTKN                                                * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*      TRACETKN=xtracetkn                                             * 00017700
*          is the name (RS-type) of a required 32 character output    * 00017800
*          that specifies the transaction trace token returned from   * 00017900
*          query.                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      ÝTRACELVL=xtracelvl¨                                           * 00018500
*          is the name (RS-type) of an optional byte output that      * 00018600
*          specifies the transaction trace indicator returned from    * 00018700
*          query. A non-zero value implies that this work unit is     * 00018800
*          eligible for tracing. A value of zero implies that this    * 00018900
*          work unit is not eligible for tracing. In that case the    * 00019000
*          trace token is also set to zero.                           * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00019600
*          is an optional byte input decimal value in the "0-1" range * 00019700
*          that specifies the macro version.  PLISTVER is the only    * 00019800
*          key allowed on the list form of MF and determines which    * 00019900
*          parameter list is generated.  The macro keys associated    * 00020000
*          with each supported version of the macro are listed in     * 00020100
*          MACRO USAGE NOTE 3.  Note that MAX may be specified        * 00020200
*          instead of a number, and the parameter list will be of the * 00020300
*          largest size currently supported. This size may grow from  * 00020400
*          release to release (thus possibly affecting the amount of  * 00020500
*          storage needed by your program).  If your program can      * 00020600
*          tolerate this, IBM recommends that you always specify MAX  * 00020700
*          when creating the list form parameter list as that will    * 00020800
*          ensure that the list form parameter list is always long    * 00020900
*          enough to hold whatever parameters might be specified on   * 00021000
*          the execute form.                                          * 00021100
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00021200
*          default is the lowest version which allows all of the      * 00021300
*          parameters specified on the invocation to be processed.    * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*      ÝMF=»S!L!M!Eº¨                                                 * 00021900
*          is an optional keyword input which specifies the macro     * 00022000
*          form.                                                      * 00022100
*          DEFAULT: S                                                 * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*          ÝMF=S¨                                                     * 00022500
*              specifies the standard form of the macro.  The "S"     * 00022600
*              form generates code to put the parameters into an      * 00022700
*              in-line parameter list and invoke the desired service. * 00022800
*              Full checking for required macro keys is done along    * 00022900
*              with supplying defaults for omitted optional           * 00023000
*              parameters.                                            * 00023100
*                                                                     * 00023200
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00023300
*              specifies the list form of the macro.  The "L" form    * 00023400
*              defines an area to be used for the parameter list.     * 00023500
*              Only the PLISTVER key may be specified on the          * 00023600
*              invocation.  All other macro parameters are flagged as * 00023700
*              errors.  If PLISTVER is not specified, the original    * 00023800
*              parameter list definition is used.                     * 00023900
*                                                                     * 00024000
*            ,xmfctrl                                                 * 00024100
*              is a required input.  It is the name of a storage area * 00024200
*              for the parameter list.                                * 00024300
*                                                                     * 00024400
*            »,xmfattr!0Dº                                            * 00024500
*              is an optional 60 character input string that varies   * 00024600
*              from 1 to 60 characters. Use it to force boundary      * 00024700
*              alignment of the parameter list. Use only 0F or 0D.    * 00024800
*              DEFAULT: 0D which forces the parameter list to a       * 00024900
*              doubleword boundary.                                   * 00025000
*                                                                     * 00025100
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00025200
*              specifies the modify form of the macro.  The "M" form  * 00025300
*              generates code to put the parameters into the          * 00025400
*              parameter list specified by xmfctrl.                   * 00025500
*                                                                     * 00025600
*            ,xmfctrl                                                 * 00025700
*              is a required input.  It is the name (RS-type), or     * 00025800
*              address in register (1)-(12), of a storage area for    * 00025900
*              the parameter list.                                    * 00026000
*                                                                     * 00026100
*            »,COMPLETE!NOCHECKº¨                                     * 00026200
*              is an optional keyword input which specifies the       * 00026300
*              degree of macro parameter syntax checking.             * 00026400
*              DEFAULT: COMPLETE                                      * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*              COMPLETE                                               * 00026800
*                  Checking for required macro keys is done and       * 00026900
*                  defaults are supplied for omitted optional         * 00027000
*                  parameters.  (See Macro Usage Note 2).             * 00027100
*                                                                     * 00027200
*              NOCHECK                                                * 00027300
*                  Checking for required macro keys is not done nor   * 00027400
*                  are defaults supplied for omitted optional         * 00027500
*                  parameters.                                        * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00028000
*              specifies the execute form of the macro.  The "E" form * 00028100
*              generates code to put the parameters into the          * 00028200
*              parameter list specified by xmfctrl and invoke the     * 00028300
*              desired service.                                       * 00028400
*                                                                     * 00028500
*            ,xmfctrl                                                 * 00028600
*              is a required input.  It is the name (RS-type), or     * 00028700
*              address in register (1)-(12), of a storage area for    * 00028800
*              the parameter list.                                    * 00028900
*                                                                     * 00029000
*            »,COMPLETE!NOCHECKº                                      * 00029100
*              is an optional keyword input which specifies the       * 00029200
*              degree of macro parameter syntax checking.             * 00029300
*              DEFAULT: COMPLETE                                      * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*              COMPLETE                                               * 00029700
*                  Checking for required macro keys is done and       * 00029800
*                  defaults are supplied for omitted optional         * 00029900
*                  parameters.  (See Macro Usage Note 2).             * 00030000
*                                                                     * 00030100
*              NOCHECK                                                * 00030200
*                  Checking for required macro keys is not done nor   * 00030300
*                  are defaults supplied for omitted optional         * 00030400
*                  parameters.                                        * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*01* RETURN CODES:                                                    * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*       0         NAME: ITZGOOD                                       * 00031600
*                                                                     * 00031700
*                 Meaning: Success                                    * 00031800
*                                                                     * 00031900
*                 Action: trace this work unit. Trace token is        * 00032000
*                 non-zero                                            * 00032100
*                                                                     * 00032200
*       4         NAME: ITZNOTR                                       * 00032300
*                                                                     * 00032400
*                 Meaning: Work unit not to be traced.                * 00032500
*                                                                     * 00032600
*                 Action: do not trace this work unit.                * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*01* REASON CODES:  None.                                             * 00033100
*                                                                     * 00033200
*01* MODULE TYPE:  ASSEM MACRO                                        * 00033300
*                                                                     * 00033400
*02*   PROCESSOR:  ASSEM                                              * 00033500
*                                                                     * 00033600
*01* COMPONENT:  SCTTR                                                * 00033700
*                                                                     * 00033800
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00033900
*                                                                     * 00034000
*01* ABEND CODES:  None.                                              * 00034100
*                                                                     * 00034200
*01* EXAMPLES:                                                        * 00034300
*                                                                     * 00034400
*01* MACRO USAGE NOTES:                                               * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00034800
*        global macro variable.  Any value other than 'NO' will       * 00034900
*        result in the macro expansion being printed.  The default is * 00035000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00035100
*        variable should be set.                                      * 00035200
*                                                                     * 00035300
*                    GBLC &ZPRINT                                     * 00035400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00035500
*                                                                     * 00035600
*                                                                     * 00035700
*    2.  When using the NOCHECK option in conjunction with the Modify * 00035800
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00035900
*        Modify   or  Execute  form  invocation  which  specifies  or * 00036000
*        defaults  to  the  COMPLETE  option.   This insures that the * 00036100
*        parameter  list  is  initialized completely.   The parameter * 00036200
*        list  field which identifies the version number of the macro * 00036300
*        is only set when the Standard form or the Complete option of * 00036400
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00036500
*        explicitly  specified.  Be sure that the resulting parameter * 00036600
*        list version number covers all the keys that you use.        * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*    3.  The ITZQUERY macro supports multiple versions. The macro key * 00037000
*        list  below  contains the version level in which the key was * 00037100
*        first  introduced.  Positionals  are  identified by the word * 00037200
*        'Positional'  followed by the numeric value of its position. * 00037300
*        Nested  positionals  are  preceded  by their outer key.  The * 00037400
*        lowest value represents the original version and the highest * 00037500
*        value  represents  the  most  recent version of the ITZQUERY * 00037600
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00037700
*        least  as high as the highest version number of all the keys * 00037800
*        being used.                                                  * 00037900
*                                                                     * 00038000
*        VERSION   KEY                                                * 00038100
*                                                                     * 00038200
*              0      PLISTVER                                        * 00038300
*                     TRACELVL                                        * 00038400
*                     TRACETKN                                        * 00038500
*              1      MONTKN                                          * 00038600
*                     MONTKN64                                        * 00038700
*                                                                     * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*01* CHANGE ACTIVITY:                                                 * 00039100
*                                                                     * 00039200
*   Flag LineItem  FMID    Date   ID    Comment                       * 00039300
*                                                                     * 00039400
*    $L0=PR390AMG JBB6609 981215 PD00AJ:  Transaction Trace initial   * 00039500
*                                         support                     * 00039600
*    $L1=PR390    JBB6609 990115 PD00AJ:  Transaction Trace initial   * 00039700
*                                         support                     * 00039800
*    $L2=LPBABV   HBB7790 121114 3241DW:  MONTKN64 support            * 00039900
*    $01=OA43454  HBB7790 130925 PDNJ:  remove NO_MONTKN to allow     * 00040000
*                                         ASSEMBLY                    * 00040100
* macrfy   = 'YES'                                                    * 00040200
* maclang  = 'ASMPLAS'                                                * 00040300
* macprint = 'YES'.                                                   * 00040400
****** END OF SPECIFICATIONS *****************************************/ 00040500
*/********************************************************************* 00040600
         MACRO                                                          00040700
&XLABEL  ITZQUERY &MONTKN=,&MONTKN64=,&TRACETKN=,&TRACELVL=,&PLISTVER=,*00040800
               &MF=                                                     00040900
.*                                                                      00041000
*              MACDATE -09/27/13-<1>                                    00041100
.*                                                                      00041200
.*******************************************************************    00041300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00041400
.*******************************************************************    00041500
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00041600
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00041700
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00041800
.*                                                                      00041900
              GBLC  &ZITZQUERY  YES=MACRO USED AT LEAST ONCE            00042000
.*******************************************************************    00042100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00042200
.*******************************************************************    00042300
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00042400
              LCLC  &ZCNDX      SYSNDX CHARACTERS                       00042500
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00042600
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00042700
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00042800
              LCLA  &ZAWRK      USED AS A WORK AREA                     00042900
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00043000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00043100
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00043200
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00043300
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00043400
              LCLC  &ZMAC_G     "G" or null                             00043500
&ZMAC_G       SETC  ''                                                  00043600
              LCLC  &ZMAC_LR                                            00043700
&ZMAC_LR      SETC  'LR'                                                00043800
              LCLC  &ZMAC_L                                             00043900
&ZMAC_L       SETC  'L'                                                 00044000
              LCLC  &ZMAC_ST                                            00044100
&ZMAC_ST      SETC  'ST'                                                00044200
              LCLC  &ZMAC_LLGT                                          00044300
&ZMAC_LLGT    SETC  'L'                                                 00044400
              LCLC  &ZMAC_LGR                                           00044500
&ZMAC_LGR     SETC  'LR'                                                00044600
              LCLC  &ZMAC_LG                                            00044700
&ZMAC_LG      SETC  'L'                                                 00044800
              LCLC  &ZMAC_STG                                           00044900
&ZMAC_STG     SETC  'ST'                                                00045000
              LCLA  &ZMACRET    MACRO RETURN CODE                       00045100
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00045200
.*                                                                      00045300
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00045400
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00045500
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00045600
              LCLC  &ZENDBASEPL                 End of base PL          00045700
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00045800
.*******************************************************************    00045900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00046000
.*******************************************************************    00046100
              LCLA  &ZI         INDEX FOR ARRAY                         00046200
              LCLA  &ZJ         INDEX FOR PARMS                         00046300
              LCLA  &ZK         INDEX FOR PARSE                         00046400
              LCLA  &ZLO        LOW RANGE VALUE                         00046500
              LCLA  &ZHI        HIGH RANGE VALUE                        00046600
              LCLC  &ZW         WORK AREA FOR PARM                      00046700
.********************************************************************   00046800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00046900
.********************************************************************   00047000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00047100
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00047200
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00047300
              GBLC  &SYSAM64    SYSSTATE AMODE64                        00047400
.*                                                                      00047500
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00047600
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00047700
              SPLEVEL  TEST                                             00047800
.ZSYS2        ANOP  ,                                                   00047900
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00048000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00048100
              SYSSTATE TEST                                             00048200
              AGO   .ZSYS4                                              00048300
.ZSYS3        ANOP  ,                                                   00048400
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00048500
.ZSYS4        ANOP  ,                                                   00048600
              AIF   ('&SYSAM64' NE 'YES').ZSYSN64                       00048700
&ZMAC_LLGT    SETC 'LLGT'                                               00048800
&ZMAC_LGR     SETC 'LGR'                                                00048900
&ZMAC_LG      SETC 'LG'                                                 00049000
&ZMAC_STG     SETC 'STG'                                                00049100
.ZSYSN64      ANOP  ,                                                   00049200
.*******************************************************************    00049300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00049400
.*******************************************************************    00049500
              LCLC  &XUSEDMONTKNKEY             ++ NAME                 00049600
              LCLC  &XMONTKN    ++ NAME                                 00049700
              LCLC  &XMONTKN64  ++ NAME                                 00049800
              LCLC  &XTRACETKN  ++ NAME                                 00049900
              LCLC  &XTRACELVL  ++ NAME                                 00050000
              LCLA  &XPLISTVER  ++ VALUE                                00050100
              LCLC  &XMF        ++ VALUE                                00050200
              LCLC  &XMFCTRL    ++ NAME                                 00050300
              LCLC  &XMFATTR    ++ VALUE                                00050400
              LCLC  &XMFSCK     ++ VALUE                                00050500
.*******************************************************************    00050600
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00050700
.*******************************************************************    00050800
              LCLC  &ZXUSEDMONTKNKEY            ++ INPUT NAME           00050900
              LCLC  &ZXMONTKN   ++ INPUT NAME                           00051000
              LCLC  &ZXMONTKN64                 ++ INPUT NAME           00051100
              LCLC  &ZXTRACETKN                 ++ OUTPUT NAME          00051200
              LCLC  &ZXTRACELVL                 ++ OUTPUT NAME          00051300
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00051400
              LCLC  &ZXMF       ++ INPUT VALUE                          00051500
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00051600
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00051700
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00051800
.********************************************************************   00051900
.***AC.PLV01  PROCESS PLISTVER                                      *   00052000
.********************************************************************   00052100
&XPLISTVER      SETA  0                                                 00052200
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00052300
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00052400
&XPLISTVER      SETA  1                                                 00052500
.ZPLV0          ANOP  ,                                                 00052600
.*                                                                      00052700
                AIF   ('&MONTKN' EQ '').ZPLV1E                          00052800
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00052900
&XPLISTVER      SETA  1                                                 00053000
.ZPLV1E         ANOP  ,                                                 00053100
.*                                                                      00053200
                AIF   ('&MONTKN64' EQ '').ZPLV2E                        00053300
                AIF   (&XPLISTVER GE 1).ZPLV2E                          00053400
&XPLISTVER      SETA  1                                                 00053500
.ZPLV2E         ANOP  ,                                                 00053600
.*                                                                      00053700
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00053800
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00053900
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00054000
.*-------------------------------------------------------------------   00054100
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00054200
&ZMS            SETC  '"PLISTVER='                                      00054300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00054400
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00054500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00054600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00054700
                AGO   .ZPVCK2                                           00054800
.ZPVCK3         ANOP  ,                                                 00054900
.*-------------------------------------------------------------------   00055000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00055100
&ZMS            SETC  '"PLISTVER='                                      00055200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00055300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00055400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00055500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00055600
                AGO   .ZPVCKE                                           00055700
.ZPVCK2         ANOP  ,                                                 00055800
.*-------------------------------------------------------------------   00055900
&ZCVAL          SETC  '&PLISTVER(1)'                                    00056000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00056100
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00056200
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00056300
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00056400
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00056500
.ZPVCK6         ANOP  ,                                                 00056600
&ZMS            SETC  '"PLISTVER='                                      00056700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00056800
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00056900
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00057000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00057100
&XPLISTVER      SETA  1                                                 00057200
                AGO   .ZPVCKE                                           00057300
.*-------------------------------------------------------------------   00057400
.ZPVCK4A        ANOP  ,                                                 00057500
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00057600
&ZMS            SETC  'PLISTVER='                                       00057700
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00057800
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00057900
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00058000
                MNOTE 8,' &ZMS IS REQUIRED.'                            00058100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00058200
                AGO   .ZPVCK5                                           00058300
.ZPVCK4         ANOP  ,                                                 00058400
&XPLISTVER      SETA  &PLISTVER(1)                                      00058500
.ZPVCK5         ANOP  ,                                                 00058600
.ZPVCKE         ANOP  ,                                                 00058700
.********************************************************************   00058800
.***AG.MF01 PROCESS MF MACRO FORMS                                      00058900
.********************************************************************   00059000
              ACTR  10000                                               00059100
.*------------------------------------------------------------------    00059200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00059300
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00059400
.*-------------------------------------------------------------------   00059500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00059600
.ZG16         ANOP  ,                                                   00059700
&ZTLC         SETC 'S'                                                  00059800
              AIF   ('&MF(1)' NE '&ZTLC').ZG17                          00059900
&XMF          SETC  'S'         SET KEYWORD                             00060000
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00060100
              AIF   (N'&MF LE 1).ZG16A          CK NUM                  00060200
&ZMS          SETC  '"MF='                                              00060300
&ZMS          SETC  '&ZMS.&MF"'                                         00060400
&ZMS          SETC  '&ZMS "MF"'                                         00060500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00060600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00060700
.ZG16A        ANOP  ,                                                   00060800
.*-------------------------------------------------------------------   00060900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00061000
.ZG17         ANOP  ,                                                   00061100
&ZTLC         SETC 'L'                                                  00061200
              AIF   ('&MF(1)' NE '&ZTLC').ZG24                          00061300
&XMF          SETC  'L'         SET KEYWORD                             00061400
              AIF   (N'&MF LE 3).ZG17A          CK NUM                  00061500
&ZMS          SETC  '"MF='                                              00061600
&ZMS          SETC  '&ZMS.&MF"'                                         00061700
&ZMS          SETC  '&ZMS "MF"'                                         00061800
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00061900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00062000
.ZG17A        ANOP  ,                                                   00062100
.*-------------------------------------------------------------------   00062200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00062300
              AIF   (N'&SYSLIST NE 0).ZG17B     POSITIONALS?            00062400
              AIF   ('&MONTKN' NE '').ZG17B     KEYS?                   00062500
              AIF   ('&MONTKN64' NE '').ZG17B   KEYS?                   00062600
              AIF   ('&TRACETKN' NE '').ZG17B   KEYS?                   00062700
              AIF   ('&TRACELVL' NE '').ZG17B   KEYS?                   00062800
              AGO    .ZG17C     INVOCATION OKAY                         00062900
.ZG17B        ANOP  ,                                                   00063000
&ZMS          SETC  'THE "L" FORM OF "MF"'                              00063100
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00063200
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00063300
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00063400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00063500
.ZG17C        ANOP  ,                                                   00063600
.*-------------------------------------------------------------------   00063700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00063800
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00063900
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00064000
              AIF   (N'&MF(2) GT 1).ZG19B       MULTI                   00064100
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00064200
.ZG19B        AIF   (K'&MF(2) GT 0).ZG19C                               00064300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00064400
&ZMS          SETC  'WHEN "L" IS SPECIFIED'                             00064500
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00064600
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00064700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00064800
.ZG19C        ANOP  ,                                                   00064900
.*-------------------------------------------------------------------   00065000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00065100
              AIF   (K'&ZXMFCTRL LE 0).ZG19P    NOT I/O                 00065200
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG19P                      00065300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00065400
&ZMS          SETC  '"MF='                                              00065500
&ZMS          SETC  '&ZMS.&MF"'                                         00065600
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00065700
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00065800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00065900
.ZG19P        ANOP  ,                                                   00066000
.*-------------------------------------------------------------------   00066100
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00066200
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00066300
&XMFATTR      SETC  '0D'                                                00066400
              AIF   (K'&MF(3) LE 0).ZG22B       PARM                    00066500
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00066600
              AIF   (N'&MF(3) GT 1).ZG22B       MULTI                   00066700
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00066800
.ZG22B        ANOP  ,                                                   00066900
.*-------------------------------------------------------------------   00067000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00067100
              AIF   (K'&ZXMFATTR LE 0).ZG22P    NOT I/O                 00067200
              AIF   ('&XMFATTR'(1,1) NE '(').ZG22P                      00067300
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00067400
&ZMS          SETC  '"MF='                                              00067500
&ZMS          SETC  '&ZMS.&MF"'                                         00067600
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00067700
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00067800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00067900
.ZG22P        ANOP  ,                                                   00068000
.*-------------------------------------------------------------------   00068100
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00068200
              AIF   (K'&ZXMFATTR LE 0).ZG22S    NOT I/O                 00068300
              AIF   (K'&XMFATTR LE 60).ZG22S    LNG OK                  00068400
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00068500
&ZMS          SETC  '"MF='                                              00068600
&ZMS          SETC  '&ZMS.&MF"'                                         00068700
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00068800
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00068900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00069000
.ZG22S        ANOP  ,                                                   00069100
.*-------------------------------------------------------------------   00069200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00069300
.ZG24         ANOP  ,                                                   00069400
&ZTLC         SETC 'M'                                                  00069500
              AIF   ('&MF(1)' NE '&ZTLC').ZG33                          00069600
&XMF          SETC  'M'         SET KEYWORD                             00069700
              AIF   (N'&MF LE 3).ZG24A          CK NUM                  00069800
&ZMS          SETC  '"MF='                                              00069900
&ZMS          SETC  '&ZMS.&MF"'                                         00070000
&ZMS          SETC  '&ZMS "MF"'                                         00070100
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00070200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00070300
.ZG24A        ANOP  ,                                                   00070400
.*-------------------------------------------------------------------   00070500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00070600
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00070700
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00070800
              AIF   (N'&MF(2) GT 1).ZG26B       MULTI                   00070900
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00071000
.ZG26B        AIF   (K'&MF(2) GT 0).ZG26C                               00071100
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00071200
&ZMS          SETC  'WHEN "M" IS SPECIFIED'                             00071300
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00071400
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00071500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00071600
.ZG26C        ANOP  ,                                                   00071700
.*-------------------------------------------------------------------   00071800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00071900
              AIF   (K'&ZXMFCTRL LE 0).ZG26R    NOT I/O                 00072000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG26R                      00072100
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00072200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        00072300
              AIF   (K'&ZCGPR GT 2).ZG26Q                               00072400
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             00072500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00072600
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        00072700
.ZG26P        ANOP  ,                                                   00072800
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             00072900
              AIF   ('&ZCGPR' LT '1').ZG26Q                             00073000
              AIF   ('&ZCGPR' LE '12').ZG26R                            00073100
.ZG26Q        ANOP  ,                                                   00073200
&ZMS          SETC  '"MF='                                              00073300
&ZMS          SETC  '&ZMS.&MF"'                                         00073400
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00073500
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00073600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00073700
.ZG26R        ANOP  ,                                                   00073800
.*-------------------------------------------------------------------   00073900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00074000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00074100
.ZG30A   AIF   ('&MF(3)' NE 'COMPLETE').ZG31A                           00074200
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00074300
.*-------------------------------------------------------------------   00074400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00074500
.ZG31A   AIF   ('&MF(3)' NE 'NOCHECK').ZG32A                            00074600
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00074700
.*-------------------------------------------------------------------   00074800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00074900
.ZG32A        AIF   (K'&XMFSCK GT 0).ZG32C      KEYWORD                 00075000
              AIF   (K'&MF(3) LE 0).ZG32B                               00075100
&ZMS          SETC  '"MF='                                              00075200
&ZMS          SETC  '&ZMS.&MF"'                                         00075300
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00075400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00075500
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00075600
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00075700
              MNOTE 8,' &ZMS '                                          00075800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00075900
.ZG32B        ANOP  ,                                                   00076000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00076100
.ZG32C        ANOP  ,                                                   00076200
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00076300
.*-------------------------------------------------------------------   00076400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076500
.ZG33         ANOP  ,                                                   00076600
&ZTLC         SETC 'E'                                                  00076700
              AIF   ('&MF(1)' NE '&ZTLC').ZG42                          00076800
&XMF          SETC  'E'         SET KEYWORD                             00076900
              AIF   (N'&MF LE 3).ZG33A          CK NUM                  00077000
&ZMS          SETC  '"MF='                                              00077100
&ZMS          SETC  '&ZMS.&MF"'                                         00077200
&ZMS          SETC  '&ZMS "MF"'                                         00077300
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00077400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00077500
.ZG33A        ANOP  ,                                                   00077600
.*-------------------------------------------------------------------   00077700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00077800
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00077900
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00078000
              AIF   (N'&MF(2) GT 1).ZG35B       MULTI                   00078100
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00078200
.ZG35B        AIF   (K'&MF(2) GT 0).ZG35C                               00078300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00078400
&ZMS          SETC  'WHEN "E" IS SPECIFIED'                             00078500
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00078600
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00078700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00078800
.ZG35C        ANOP  ,                                                   00078900
.*-------------------------------------------------------------------   00079000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00079100
              AIF   (K'&ZXMFCTRL LE 0).ZG35R    NOT I/O                 00079200
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG35R                      00079300
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00079400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                        00079500
              AIF   (K'&ZCGPR GT 2).ZG35Q                               00079600
              AIF   ('&ZCGPR' EQ '0').ZG35Q                             00079700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00079800
              AIF   (T'&ZCGPR NE 'N').ZG35Q     INVALID REG NAME        00079900
.ZG35P        ANOP  ,                                                   00080000
              AIF   (T'&ZCGPR NE 'N').ZG35R     NON NUMERIC             00080100
              AIF   ('&ZCGPR' LT '1').ZG35Q                             00080200
              AIF   ('&ZCGPR' LE '12').ZG35R                            00080300
.ZG35Q        ANOP  ,                                                   00080400
&ZMS          SETC  '"MF='                                              00080500
&ZMS          SETC  '&ZMS.&MF"'                                         00080600
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00080700
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00080800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00080900
.ZG35R        ANOP  ,                                                   00081000
.*-------------------------------------------------------------------   00081100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00081200
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00081300
.ZG39A   AIF   ('&MF(3)' NE 'COMPLETE').ZG40A                           00081400
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00081500
.*-------------------------------------------------------------------   00081600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00081700
.ZG40A   AIF   ('&MF(3)' NE 'NOCHECK').ZG41A                            00081800
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00081900
.*-------------------------------------------------------------------   00082000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00082100
.ZG41A        AIF   (K'&XMFSCK GT 0).ZG41C      KEYWORD                 00082200
              AIF   (K'&MF(3) LE 0).ZG41B                               00082300
&ZMS          SETC  '"MF='                                              00082400
&ZMS          SETC  '&ZMS.&MF"'                                         00082500
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00082600
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00082700
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00082800
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00082900
              MNOTE 8,' &ZMS '                                          00083000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00083100
.ZG41B        ANOP  ,                                                   00083200
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00083300
.ZG41C        ANOP  ,                                                   00083400
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00083500
.*------------------------------------------------------------------    00083600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00083700
.ZG42         ANOP  ,                                                   00083800
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00083900
              AIF   (K'&XMF GT 0).ZG42E         VALID ARG               00084000
              AIF   (T'&MF EQ 'O').ZG42D        OMITTED                 00084100
&ZASYSLNDX    SETA  0                                                   00084200
.ZG42A        ANOP  ,           POSITIONAL MACRO KEY                    00084300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00084400
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG42C                    00084500
&ZTLC         SETC 'MF'                                                 00084600
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG42A           00084700
.ZG42B        ANOP  ,                                                   00084800
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00084900
&ZMS          SETC  'THE "MF" KEY'                                      00085000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00085100
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00085200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00085300
              AGO   .ZG42E                                              00085400
.ZG42C        ANOP  ,                                                   00085500
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00085600
&ZMS          SETC  '"MF='                                              00085700
&ZMS          SETC  '&ZMS.&MF"'                                         00085800
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00085900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00086000
&ZMS          SETC  '&ZMS "S",'                                         00086100
&ZMS          SETC  '&ZMS "L",'                                         00086200
&ZMS          SETC  '&ZMS "M",'                                         00086300
&ZMS          SETC  '&ZMS OR "E".'                                      00086400
              MNOTE 8,' &ZMS '                                          00086500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00086600
              AGO   .ZG42E                                              00086700
.ZG42D        ANOP  ,                                                   00086800
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00086900
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00087000
.ZG42E        ANOP  ,                                                   00087100
.********************************************************************   00087200
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00087300
.********************************************************************   00087400
              ACTR  10000                                               00087500
.*-------------------------------------------------------------------   00087600
.***AG.MF03 MF=(SLME)                                                   00087700
              AIF   ('&XMF' EQ 'L').ZGMFX                               00087800
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00087900
.*----------------------------------------------------------------***   00088000
.***AG.KMEKY01 NAME, OPT INPUT, ME KEYS -XVARIABLE                      00088100
&XUSEDMONTKNKEY                 SETC  ''        INITIALIZE XVARIABLE    00088200
              AIF   (K'&MONTKN LE 0).ZG2C                               00088300
&ZXUSEDMONTKNKEY                SETC  'INPUT'   SET IN/OUTPUT           00088400
&XUSEDMONTKNKEY                 SETC  'MONTKN'  SET XVARIABLE           00088500
&ZXMONTKN     SETC  'INPUT'     SET IN/OUTPUT                           00088600
&XMONTKN      SETC  '&MONTKN(1)'                SET XVARIABLE PARM      00088700
              AIF   (N'&MONTKN GT 1).ZG2A                               00088800
&XMONTKN      SETC  '&MONTKN'   SET XVARIABLE PARM                      00088900
.ZG2A         AIF   (N'&MONTKN LE 1).ZG2B       CK NUM                  00089000
&ZMS          SETC  '"MONTKN='                                          00089100
&ZMS          SETC  '&ZMS.&MONTKN"'                                     00089200
&ZMS          SETC  '&ZMS "MONTKN"'                                     00089300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00089400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00089500
.ZG2B         AIF   (K'&XMONTKN GT 0).ZG2C      ONE PARM                00089600
&ZXUSEDMONTKNKEY                SETC  ''        RESET IN/OUTPUT         00089700
&ZXMONTKN     SETC  ''          RESET IN/OUTPUT                         00089800
&ZMS          SETC  ' '                                                 00089900
&ZMS          SETC  '&ZMS "MONTKN" KEY AND ITS'                         00090000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00090100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090200
.ZG2C         ANOP  ,                                                   00090300
.*----------------------------------------------------------------***   00090400
.***AG.KMEKY02 NAME, OPT INPUT, ME KEYS -XVARIABLE                      00090500
              AIF   (K'&MONTKN64 LE 0).ZG3D     NO ME KEY               00090600
              AIF   (N'&MONTKN64 LE 1).ZG3A     CK NUM                  00090700
&ZMS          SETC  '"MONTKN64='                                        00090800
&ZMS          SETC  '&ZMS.&MONTKN64"'                                   00090900
&ZMS          SETC  '&ZMS "MONTKN64"'                                   00091000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00091100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00091200
.ZG3A         AIF   (K'&XUSEDMONTKNKEY LE 0).ZG3B                       00091300
&ZMS          SETC  '"MONTKN64'                                         00091400
&ZMS          SETC  '&ZMS.=&MONTKN64"'                                  00091500
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00091600
&ZMS          SETC  '&ZMS "&XUSEDMONTKNKEY"'                            00091700
              MNOTE 8,' &ZMS KEY.'                                      00091800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00091900
              AGO   .ZG3D                                               00092000
.*                                                                      00092100
.ZG3B         ANOP  ,                                                   00092200
&ZXUSEDMONTKNKEY                SETC  'INPUT'   SET IN/OUTPUT           00092300
&XUSEDMONTKNKEY                 SETC  'MONTKN64'  SET XVARIABLE         00092400
&ZXMONTKN64   SETC  'INPUT'     SET IN/OUTPUT                           00092500
&XMONTKN64    SETC  '&MONTKN64(1)'              SET XVARIABLE PARM      00092600
              AIF   (N'&MONTKN64 GT 1).ZG3C                             00092700
&XMONTKN64    SETC  '&MONTKN64'                 SET XVARIABLE PARM      00092800
.ZG3C         AIF   (K'&XMONTKN64 GT 0).ZG3D    ONE PARM                00092900
&ZXUSEDMONTKNKEY                SETC  ''        RESET IN/OUTPUT         00093000
&ZXMONTKN64   SETC  ''          RESET IN/OUTPUT                         00093100
&ZMS          SETC  ' '                                                 00093200
&ZMS          SETC  '&ZMS "MONTKN64" KEY AND ITS'                       00093300
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00093400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093500
.ZG3D         ANOP  ,                                                   00093600
.*------------------------------------------------------------------    00093700
.***AG.KMEKY07 NAME, OPT INPUT, ME KEYS -CHECK IF KEY ENTERED           00093800
              AIF   (K'&XUSEDMONTKNKEY GT 0).ZG4B                       00093900
&ZXUSEDMONTKNKEY                SETC  'INPUT'   SET IN/OUTPUT           00094000
&XUSEDMONTKNKEY                 SETC  'MONTKN'  SET DEFAULT             00094100
&ZXMONTKN     SETC  'INPUT'     SET IN/OUTPUT                           00094200
&XMONTKN      SETC  '0'         SET DEFAULT PARM                        00094300
.ZG4B         ANOP  ,                                                   00094400
.*-------------------------------------------------------------------   00094500
.***AG.KCK02 NAME, OPT INPUT, ME KEYS -GPR OUT OF RANGE                 00094600
              AIF   (K'&ZXMONTKN64 LE 0).ZG4R   NOT I/O                 00094700
              AIF   ('&XMONTKN64'(1,1) NE '(').ZG4R                     00094800
&ZCGPR        SETC  '&XMONTKN64'(2,K'&XMONTKN64-2)                      00094900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                         00095000
              AIF   (K'&ZCGPR GT 2).ZG4Q                                00095100
              AIF   ('&ZCGPR' EQ '0').ZG4Q                              00095200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00095300
              AIF   (T'&ZCGPR NE 'N').ZG4Q      INVALID REG NAME        00095400
.ZG4P         ANOP  ,                                                   00095500
              AIF   (T'&ZCGPR NE 'N').ZG4R      NON NUMERIC             00095600
              AIF   ('&ZCGPR' LT '2').ZG4Q                              00095700
              AIF   ('&ZCGPR' LE '12').ZG4R                             00095800
.ZG4Q         ANOP  ,                                                   00095900
&ZMS          SETC  '"MONTKN64='                                        00096000
&ZMS          SETC  '&ZMS.&MONTKN64"'                                   00096100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00096200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00096300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00096400
.ZG4R         ANOP  ,                                                   00096500
.*-------------------------------------------------------------------   00096600
.***AG.KMEKY13 NAME, OPT INPUT, ME KEYS -PROCESS DEPENDENCIES           00096700
.ZG2ZY  AIF    ('&XUSEDMONTKNKEY' NE 'MONTKN').ZG3ZY                    00096800
.*-------------------------------------------------------------------   00096900
.***AG.KCK02 NAME, OPT INPUT, ME KEYS -GPR OUT OF RANGE                 00097000
              AIF   (K'&ZXMONTKN LE 0).ZG2R     NOT I/O                 00097100
              AIF   ('&XMONTKN'(1,1) NE '(').ZG2R                       00097200
&ZCGPR        SETC  '&XMONTKN'(2,K'&XMONTKN-2)                          00097300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         00097400
              AIF   (K'&ZCGPR GT 2).ZG2Q                                00097500
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              00097600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00097700
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        00097800
.ZG2P         ANOP  ,                                                   00097900
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             00098000
              AIF   ('&ZCGPR' LT '2').ZG2Q                              00098100
              AIF   ('&ZCGPR' LE '12').ZG2R                             00098200
.ZG2Q         ANOP  ,                                                   00098300
&ZMS          SETC  '"MONTKN='                                          00098400
&ZMS          SETC  '&ZMS.&MONTKN"'                                     00098500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00098600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00098700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00098800
.ZG2R         ANOP  ,                                                   00098900
.*-------------------------------------------------------------------   00099000
.***AG.KMEKY13 NAME, OPT INPUT, ME KEYS -PROCESS DEPENDENCIES           00099100
.ZG3ZY  AIF    ('&XUSEDMONTKNKEY' NE 'MONTKN64').ZG4ZY                  00099200
.*-------------------------------------------------------------------   00099300
.***AG.KCK02 NAME, OPT INPUT, ME KEYS -GPR OUT OF RANGE                 00099400
              AIF   (K'&ZXMONTKN64 LE 0).ZG3R   NOT I/O                 00099500
              AIF   ('&XMONTKN64'(1,1) NE '(').ZG3R                     00099600
&ZCGPR        SETC  '&XMONTKN64'(2,K'&XMONTKN64-2)                      00099700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                         00099800
              AIF   (K'&ZCGPR GT 2).ZG3Q                                00099900
              AIF   ('&ZCGPR' EQ '0').ZG3Q                              00100000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00100100
              AIF   (T'&ZCGPR NE 'N').ZG3Q      INVALID REG NAME        00100200
.ZG3P         ANOP  ,                                                   00100300
              AIF   (T'&ZCGPR NE 'N').ZG3R      NON NUMERIC             00100400
              AIF   ('&ZCGPR' LT '2').ZG3Q                              00100500
              AIF   ('&ZCGPR' LE '12').ZG3R                             00100600
.ZG3Q         ANOP  ,                                                   00100700
&ZMS          SETC  '"MONTKN64='                                        00100800
&ZMS          SETC  '&ZMS.&MONTKN64"'                                   00100900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00101000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00101100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101200
.ZG3R         ANOP  ,                                                   00101300
.*-------------------------------------------------------------------   00101400
.***AG.KMEKY15 NAME, OPT INPUT, ME KEYS -END                            00101500
.ZG4ZY        ANOP ,            END MUTUALLY EXCLUSIVE KEYS             00101600
.*----------------------------------------------------------------***   00101700
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00101800
              AIF   (N'&TRACETKN LE 1).ZG6A     CK NUM                  00101900
&ZMS          SETC  '"TRACETKN='                                        00102000
&ZMS          SETC  '&ZMS.&TRACETKN"'                                   00102100
&ZMS          SETC  '&ZMS "TRACETKN"'                                   00102200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00102300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00102400
.ZG6A         ANOP  ,                                                   00102500
.*-------------------------------------------------------------------   00102600
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00102700
&ZXTRACETKN   SETC  'OUTPUT'    SET IN/OUTPUT                           00102800
&XTRACETKN    SETC  '&TRACETKN(1)'              SET XVARIABLE           00102900
              AIF   (N'&TRACETKN GT 1).ZG6B     MULTI                   00103000
&XTRACETKN    SETC  '&TRACETKN'                 SET XVARIABLE           00103100
.ZG6B         AIF   (K'&TRACETKN(1) GT 0).ZG6C                          00103200
&ZXTRACETKN   SETC  ''          RESET IN/OUTPUT                         00103300
&ZMS          SETC  ' '                                                 00103400
&ZMS          SETC  '&ZMS "TRACETKN" KEY AND ITS'                       00103500
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00103600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00103700
.ZG6C         ANOP  ,                                                   00103800
.*-------------------------------------------------------------------   00103900
.***AG.KCK01 NAME, RQD OUTPUT, KEYS -GPR NOT ALLOWED                    00104000
              AIF   (K'&ZXTRACETKN LE 0).ZG6P   NOT I/O                 00104100
              AIF   ('&XTRACETKN'(1,1) NE '(').ZG6P                     00104200
&ZXTRACETKN   SETC  ''          RESET IN/OUTPUT                         00104300
&ZMS          SETC  '"TRACETKN='                                        00104400
&ZMS          SETC  '&ZMS.&TRACETKN"'                                   00104500
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00104600
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00104700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104800
.ZG6P         ANOP  ,                                                   00104900
.*----------------------------------------------------------------***   00105000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00105100
              AIF   (N'&TRACELVL LE 1).ZG9A     CK NUM                  00105200
&ZMS          SETC  '"TRACELVL='                                        00105300
&ZMS          SETC  '&ZMS.&TRACELVL"'                                   00105400
&ZMS          SETC  '&ZMS "TRACELVL"'                                   00105500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00105600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00105700
.ZG9A         ANOP  ,                                                   00105800
.*-------------------------------------------------------------------   00105900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00106000
              AIF   (K'&TRACELVL(1) LE 0).ZG9C  NO PARM                 00106100
&ZXTRACELVL   SETC  'OUTPUT'    SET OUTPUT                              00106200
&XTRACELVL    SETC  '&TRACELVL(1)'              SET XVARIABLE           00106300
              AIF   (N'&TRACELVL GT 1).ZG9C                             00106400
&XTRACELVL    SETC  '&TRACELVL'                 SET XVARIABLE           00106500
.ZG9C         ANOP  ,                                                   00106600
.*-------------------------------------------------------------------   00106700
.***AG.KCK01 NAME, OPT OUTPUT, KEYS -GPR NOT ALLOWED                    00106800
              AIF   (K'&ZXTRACELVL LE 0).ZG9P   NOT I/O                 00106900
              AIF   ('&XTRACELVL'(1,1) NE '(').ZG9P                     00107000
&ZXTRACELVL   SETC  ''          RESET IN/OUTPUT                         00107100
&ZMS          SETC  '"TRACELVL='                                        00107200
&ZMS          SETC  '&ZMS.&TRACELVL"'                                   00107300
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00107400
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00107500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107600
.ZG9P         ANOP  ,                                                   00107700
.******************************************************************     00107800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00107900
.******************************************************************     00108000
              ACTR  10000                                               00108100
.*----------------------------------------------------------------***   00108200
.***AH.P02 EXTRA POSITIONALS                                            00108300
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00108400
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00108500
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00108600
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00108700
.ZGLISTX1     ANOP  ,                                                   00108800
&ZCVAL        SETC  ''          ERROR FIELD                             00108900
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00109000
.ZGLIST2      ANOP  ,                                                   00109100
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00109200
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00109300
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00109400
              AGO   .ZGLIST2                                            00109500
.*                                                                      00109600
.ZGLIST3      ANOP  ,                                                   00109700
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00109800
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00109900
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00110000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00110100
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00110200
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00110300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00110400
.ZGLISTX      ANOP  ,                                                   00110500
&ZASYSLNDX    SETA  0                                                   00110600
.*-------------------------------------------------------------------   00110700
.***AG.MF04 MF=(SLME)                                                   00110800
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00110900
.********************************************************************   00111000
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00111100
.********************************************************************   00111200
              ACTR  10000                                               00111300
.*-------------------------------------------------------------------   00111400
.***AE.MF01 MF=(SLME)                                                   00111500
              AIF   ('&XMF' EQ 'L').ZEMFX                               00111600
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00111700
.********************************************************************   00111800
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00111900
.********************************************************************   00112000
.*----------------------------------------------------------------***   00112100
.***AE.KMEKY01 NAME, OPT INPUT, ME KEYS -XVARIABLE                      00112200
&XUSEDMONTKNKEY                 SETC  ''        INITIALIZE XVARIABLE    00112300
              AIF   (K'&MONTKN LE 0).ZE2C                               00112400
&ZXUSEDMONTKNKEY                SETC  'INPUT'   SET IN/OUTPUT           00112500
&XUSEDMONTKNKEY                 SETC  'MONTKN'  SET XVARIABLE           00112600
&ZXMONTKN     SETC  'INPUT'     SET IN/OUTPUT                           00112700
&XMONTKN      SETC  '&MONTKN(1)'                SET XVARIABLE PARM      00112800
              AIF   (N'&MONTKN GT 1).ZE2A                               00112900
&XMONTKN      SETC  '&MONTKN'   SET XVARIABLE PARM                      00113000
.ZE2A         AIF   (N'&MONTKN LE 1).ZE2B       CK NUM                  00113100
&ZMS          SETC  '"MONTKN='                                          00113200
&ZMS          SETC  '&ZMS.&MONTKN"'                                     00113300
&ZMS          SETC  '&ZMS "MONTKN"'                                     00113400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00113500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00113600
.ZE2B         AIF   (K'&XMONTKN GT 0).ZE2C      ONE PARM                00113700
&ZXUSEDMONTKNKEY                SETC  ''        RESET IN/OUTPUT         00113800
&ZXMONTKN     SETC  ''          RESET IN/OUTPUT                         00113900
.ZE2C         ANOP  ,                                                   00114000
.*----------------------------------------------------------------***   00114100
.***AE.KMEKY02 NAME, OPT INPUT, ME KEYS -NON-XVAR KEY                   00114200
              AIF   (K'&MONTKN64 LE 0).ZE3D     NO ME KEY               00114300
              AIF   (N'&MONTKN64 LE 1).ZE3A     CK NUM                  00114400
&ZMS          SETC  '"MONTKN64='                                        00114500
&ZMS          SETC  '&ZMS.&MONTKN64"'                                   00114600
&ZMS          SETC  '&ZMS "MONTKN64"'                                   00114700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00114800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114900
.ZE3A         AIF   (K'&XUSEDMONTKNKEY LE 0).ZE3B                       00115000
&ZMS          SETC  '"MONTKN64'                                         00115100
&ZMS          SETC  '&ZMS.=&MONTKN64"'                                  00115200
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00115300
&ZMS          SETC  '&ZMS "&XUSEDMONTKNKEY"'                            00115400
              MNOTE 8,' &ZMS KEY.'                                      00115500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00115600
              AGO   .ZE3D                                               00115700
.*                                                                      00115800
.ZE3B         ANOP  ,                                                   00115900
&ZXUSEDMONTKNKEY                SETC  'INPUT'   SET IN/OUTPUT           00116000
&XUSEDMONTKNKEY                 SETC  'MONTKN64'  SET XVARIABLE         00116100
&ZXMONTKN64   SETC  'INPUT'     SET IN/OUTPUT                           00116200
&XMONTKN64    SETC  '&MONTKN64(1)'              SET PARM                00116300
              AIF   (N'&MONTKN64 GT 1).ZE3C                             00116400
&XMONTKN64    SETC  '&MONTKN64'                 SET PARM                00116500
.ZE3C         AIF   (K'&XMONTKN64 GT 0).ZE3D    ONE PARM                00116600
&ZXUSEDMONTKNKEY                SETC  ''        RESET IN/OUTPUT         00116700
&ZXMONTKN64   SETC  ''          RESET IN/OUTPUT                         00116800
.ZE3D         ANOP  ,                                                   00116900
.*------------------------------------------------------------------    00117000
.***AE.KMEKY07 NAME, OPT INPUT, ME KEYS -CHECK IF ENTERED               00117100
              AIF   (K'&XUSEDMONTKNKEY GT 0).ZE4B                       00117200
&ZXUSEDMONTKNKEY                SETC  ''        RESET IN/OUTPUT         00117300
&XUSEDMONTKNKEY                 SETC  ''        SET NULL                00117400
&ZXMONTKN     SETC  ''          RESET OUTPUT                            00117500
&XMONTKN      SETC  ''          SET NULL PARM                           00117600
.ZE4B         ANOP  ,                                                   00117700
.*-------------------------------------------------------------------   00117800
.***AE.KMEKY08 NAME, OPT INPUT, ME KEYS -PROCESS DEPENDENCIES           00117900
.ZE2     AIF   ('&XUSEDMONTKNKEY' NE 'MONTKN').ZE3                      00118000
.*-------------------------------------------------------------------   00118100
.***AE.KCK02 NAME, OPT INPUT, ME KEYS -GPR OUT OF RANGE                 00118200
              AIF   (K'&ZXMONTKN LE 0).ZE2R     NOT I/O                 00118300
              AIF   ('&XMONTKN'(1,1) NE '(').ZE2R                       00118400
&ZCGPR        SETC  '&XMONTKN'(2,K'&XMONTKN-2)                          00118500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                         00118600
              AIF   (K'&ZCGPR GT 2).ZE2Q                                00118700
              AIF   ('&ZCGPR' EQ '0').ZE2Q                              00118800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00118900
              AIF   (T'&ZCGPR NE 'N').ZE2Q      INVALID REG NAME        00119000
.ZE2P         ANOP  ,                                                   00119100
              AIF   (T'&ZCGPR NE 'N').ZE2R      NON NUMERIC             00119200
              AIF   ('&ZCGPR' LT '2').ZE2Q                              00119300
              AIF   ('&ZCGPR' LE '12').ZE2R                             00119400
.ZE2Q         ANOP  ,                                                   00119500
&ZMS          SETC  '"MONTKN='                                          00119600
&ZMS          SETC  '&ZMS.&MONTKN"'                                     00119700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00119800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00119900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00120000
.ZE2R         ANOP  ,                                                   00120100
.*-------------------------------------------------------------------   00120200
.***AE.KMEKY08 NAME, OPT INPUT, ME KEYS -PROCESS DEPENDENCIES           00120300
.ZE3     AIF   ('&XUSEDMONTKNKEY' NE 'MONTKN64').ZE4                    00120400
.*-------------------------------------------------------------------   00120500
.***AE.KCK02 NAME, OPT INPUT, ME KEYS -GPR OUT OF RANGE                 00120600
              AIF   (K'&ZXMONTKN64 LE 0).ZE3R   NOT I/O                 00120700
              AIF   ('&XMONTKN64'(1,1) NE '(').ZE3R                     00120800
&ZCGPR        SETC  '&XMONTKN64'(2,K'&XMONTKN64-2)                      00120900
              AIF   ('&ZCGPR'(1,1) NE '0').ZE3P                         00121000
              AIF   (K'&ZCGPR GT 2).ZE3Q                                00121100
              AIF   ('&ZCGPR' EQ '0').ZE3Q                              00121200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00121300
              AIF   (T'&ZCGPR NE 'N').ZE3Q      INVALID REG NAME        00121400
.ZE3P         ANOP  ,                                                   00121500
              AIF   (T'&ZCGPR NE 'N').ZE3R      NON NUMERIC             00121600
              AIF   ('&ZCGPR' LT '2').ZE3Q                              00121700
              AIF   ('&ZCGPR' LE '12').ZE3R                             00121800
.ZE3Q         ANOP  ,                                                   00121900
&ZMS          SETC  '"MONTKN64='                                        00122000
&ZMS          SETC  '&ZMS.&MONTKN64"'                                   00122100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00122200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00122300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122400
.ZE3R         ANOP  ,                                                   00122500
.*-------------------------------------------------------------------   00122600
.***AE.KMEKY09 NAME, OPT INPUT, ME KEYS -END                            00122700
.ZE4          ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00122800
.*----------------------------------------------------------------***   00122900
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         00123000
              AIF   (N'&TRACETKN LE 1).ZE6A     CK NUM                  00123100
&ZMS          SETC  '"TRACETKN='                                        00123200
&ZMS          SETC  '&ZMS.&TRACETKN"'                                   00123300
&ZMS          SETC  '&ZMS "TRACETKN"'                                   00123400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00123500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00123600
.ZE6A         ANOP  ,                                                   00123700
.*-------------------------------------------------------------------   00123800
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    00123900
              AIF   (K'&TRACETKN(1) LE 0).ZE6B  NO PRM                  00124000
&ZXTRACETKN   SETC  'OUTPUT'    SET IN/OUTPUT                           00124100
&XTRACETKN    SETC  '&TRACETKN(1)'              SET XVARIABLE           00124200
              AIF   (N'&TRACETKN GT 1).ZE6B                             00124300
.*            ANOP                                                      00124400
&XTRACETKN    SETC  '&TRACETKN'                 SET XVARIABLE           00124500
.ZE6B         ANOP  ,                                                   00124600
.*-------------------------------------------------------------------   00124700
.***AE.KCK01 NAME, RQD OUTPUT, KEYS -GPR NOT ALLOWED                    00124800
              AIF   (K'&ZXTRACETKN LE 0).ZE6P   NOT I/O                 00124900
              AIF   ('&XTRACETKN'(1,1) NE '(').ZE6P                     00125000
&ZXTRACETKN   SETC  ''          RESET IN/OUTPUT                         00125100
&ZMS          SETC  '"TRACETKN='                                        00125200
&ZMS          SETC  '&ZMS.&TRACETKN"'                                   00125300
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00125400
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00125500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00125600
.ZE6P         ANOP  ,                                                   00125700
.*----------------------------------------------------------------***   00125800
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00125900
              AIF   (N'&TRACELVL LE 1).ZE9A     CK NUM                  00126000
&ZMS          SETC  '"TRACELVL='                                        00126100
&ZMS          SETC  '&ZMS.&TRACELVL"'                                   00126200
&ZMS          SETC  '&ZMS "TRACELVL"'                                   00126300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00126400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126500
.ZE9A         ANOP  ,                                                   00126600
.*-------------------------------------------------------------------   00126700
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00126800
              AIF   (K'&TRACELVL(1) LE 0).ZE9B  NO PRM                  00126900
&ZXTRACELVL   SETC  'OUTPUT'    SET IN/OUTPUT                           00127000
&XTRACELVL    SETC  '&TRACELVL(1)'              SET XVARIABLE           00127100
              AIF   (N'&TRACELVL GT 1).ZE9B                             00127200
.*            ANOP                                                      00127300
&XTRACELVL    SETC  '&TRACELVL'                 SET XVARIABLE           00127400
.ZE9B         ANOP  ,                                                   00127500
.*-------------------------------------------------------------------   00127600
.***AE.KCK01 NAME, OPT OUTPUT, KEYS -GPR NOT ALLOWED                    00127700
              AIF   (K'&ZXTRACELVL LE 0).ZE9P   NOT I/O                 00127800
              AIF   ('&XTRACELVL'(1,1) NE '(').ZE9P                     00127900
&ZXTRACELVL   SETC  ''          RESET IN/OUTPUT                         00128000
&ZMS          SETC  '"TRACELVL='                                        00128100
&ZMS          SETC  '&ZMS.&TRACELVL"'                                   00128200
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00128300
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00128400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128500
.ZE9P         ANOP  ,                                                   00128600
.******************************************************************     00128700
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00128800
.******************************************************************     00128900
              ACTR  10000                                               00129000
.*----------------------------------------------------------------***   00129100
.***AF.P02 EXTRA POSITIONALS                                            00129200
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00129300
&ZCVAL        SETC  ''          ERROR FIELD                             00129400
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00129500
.ZELIST2      ANOP  ,                                                   00129600
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00129700
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00129800
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00129900
              AGO   .ZELIST2                                            00130000
.*                                                                      00130100
.ZELIST3      ANOP  ,                                                   00130200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00130300
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00130400
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00130500
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00130600
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00130700
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00130800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00130900
.ZELISTX      ANOP  ,                                                   00131000
&ZASYSLNDX    SETA  0                                                   00131100
.*-------------------------------------------------------------------   00131200
.***AE.MF02 MF=(SLME)                                                   00131300
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00131400
.*******************************************************************    00131500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00131600
.*******************************************************************    00131700
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00131800
.*******************************************************************    00131900
.***AE.01  START OF ITZQUERY MACRO CODE                                 00132000
.*******************************************************************    00132100
              LCLC  &M0M0001                 NAME                       00132200
&M0M0001      SETC  '&XLABEL'                SET NAME                   00132300
              AIF   (K'&XLABEL NE 0).XLAB2                              00132400
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00132500
.*                                                                      00132600
.XLAB2        ANOP  ,                                                   00132700
              AIF   ('&XMF' EQ 'L').XLAB3                               00132800
&M0M0001 DS    0H                             ITZQUERY-1                00132900
.XLAB3        ANOP  ,                                                   00133000
.*******************************************************************    00133100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00133200
.*******************************************************************    00133300
              PUSH  PRINT                                               00133400
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00133500
              PRINT OFF         ++ PR01                                 00133600
              AGO   .ZPRNTXX                                            00133700
.ZPRINTX      PRINT ON                                                  00133800
.ZPRNTXX      ANOP  ,                                                   00133900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00134000
&NOQLAB SETC  'NOQRY&SYSNDX'       Generate unique label           @L1A 00134100
&QDONE  SETC  'QRDN&SYSNDX'        Generate unique label           @L1A 00134200
        AIF   ('&XMF' EQ 'L').QRLST                                @L1A 00134300
        AIF   ('&SYSASCE' EQ 'P').NOTAR   Ck for AR mode callers   @L1A 00134400
        LAE   15,0(15,0)           Clear AR 14                     @L1A 00134500
.NOTAR  ANOP                                                       @L1A 00134600
        L     15,16(0,0)                                           @L1A 00134700
        L     15,140(15,0)                                         @L1A 00134800
        TM    519(15),B'10000000'  Is TTrace active?               @L1A 00134900
        BZ    &NOQLAB              No, skip query                  @L1A 00135000
.QRLST  ANOP                                                       @L1A 00135100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00135200
.********************************************************************   00135300
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00135400
.********************************************************************   00135500
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00135600
                      LCLA  &ZOPN1         INVOCATION INDEX             00135700
                      LCLC  &ZOPL(4095)    LABEL                        00135800
                      LCLC  &ZOPO(4095)    OPERATION                    00135900
                      LCLC  &ZOPV(4095)    VALUE                        00136000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00136100
.*                                                                      00136200
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00136300
.******************************************************************     00136400
.***AL.L10 ITZQUERY FMT=LIST MF=S!L PARAMETERS                          00136500
.******************************************************************     00136600
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00136700
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00136800
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00136900
&XMFATTR              SETC  '0D'                                        00137000
.*                                                                      00137100
&ZOPN                 SETA  &ZOPN+1                                     00137200
&ZOPL(&ZOPN)          SETC  ' '                                         00137300
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00137400
&ZOPO(&ZOPN)          SETC  'B'                                         00137500
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00137600
                      AGO   .ZALVL6B                                    00137700
.ZALVL6A              ANOP                                              00137800
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00137900
&ZOPV(&ZOPN)          SETC  '4,8'                                       00138000
&ZOPN                 SETA  &ZOPN+1                                     00138100
&ZOPL(&ZOPN)          SETC  ' '                                         00138200
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00138300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00138400
.ZALVL6B              ANOP                                              00138500
&ZOPD(&ZOPN)          SETC  '++ ITZQUERY ARG PARMS'                     00138600
.*                                                                      00138700
&ZOPN                 SETA  &ZOPN+1                                     00138800
&ZOPL(&ZOPN)          SETC  ' '                                         00138900
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00139000
&ZOPV(&ZOPN)          SETC  '1'                                         00139100
&ZOPD(&ZOPN)          SETC  ' '                                         00139200
.*                                                                      00139300
.ZLMFSL2              ANOP  ,                                           00139400
.*-------------------------------------------------------------------   00139500
.***AM.L00  ITZQUERY FMT=LIST name                                      00139600
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00139700
&ZOPN                 SETA &ZOPN+1                                      00139800
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00139900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00140000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00140100
&ZOPD(&ZOPN)          SETC '++ ITZQUERY NAME'                           00140200
.ZLMFSL2M             ANOP  ,                                           00140300
.*-------------------------------------------------------------------   00140400
.***AM.L01  ITZQUERY FMT=LIST PARAMETERS                                00140500
&ZOPN                 SETA &ZOPN+1                                      00140600
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00140700
&ZOPO(&ZOPN)          SETC 'DS'                                         00140800
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00140900
&ZOPD(&ZOPN)          SETC '++ ITZQUERY PARM LIST'                      00141000
.*-------------------------------------------------------------------   00141100
.***AM.L02 XVERSION XL1                                                 00141200
&ZOPN                 SETA &ZOPN+1                                      00141300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00141400
&ZOPO(&ZOPN)          SETC 'DS'                                         00141500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00141600
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00141700
.*-------------------------------------------------------------------   00141800
.***AM.L03 XREQUEST BL.8                                                00141900
&ZOPN                 SETA &ZOPN+1                                      00142000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00142100
&ZOPO(&ZOPN)          SETC 'DS'                                         00142200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00142300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00142400
.*                                                                      00142500
&ZOPN                 SETA  &ZOPN+1                                     00142600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_TRACELVL'                00142700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00142800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00142900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00143000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TRACELVL'                     00143100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00143200
.*                                                                      00143300
&ZOPN                 SETA  &ZOPN+1                                     00143400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MONTKN'                  00143500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00143600
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00143700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00143800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MONTKN'                       00143900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00144000
.*                                                                      00144100
&ZOPN                 SETA  &ZOPN+1                                     00144200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MONTKN64'                00144300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00144400
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00144500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00144600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MONTKN64'                     00144700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00144800
.*-------------------------------------------------------------------   00144900
.***AM.L09  XRESERVED1 CL2                                              00145000
&ZOPN                 SETA &ZOPN+1                                      00145100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00145200
&ZOPO(&ZOPN)          SETC 'DS'                                         00145300
&ZOPV(&ZOPN)          SETC 'CL2'                                        00145400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00145500
.*-------------------------------------------------------------------   00145600
.***AM.L09  XMONTKN BL.32                                               00145700
&ZOPN                 SETA &ZOPN+1                                      00145800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00145900
&ZOPO(&ZOPN)          SETC 'DS'                                         00146000
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00146100
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN '                              00146200
.*-------------------------------------------------------------------   00146300
.***AM.L09 ADDR XTRACELVL A                                             00146400
&ZOPN                 SETA &ZOPN+1                                      00146500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTRACELVL_ADDR'                   00146600
&ZOPO(&ZOPN)          SETC 'DS'                                         00146700
&ZOPV(&ZOPN)          SETC 'A'                                          00146800
&ZOPD(&ZOPN)          SETC '++ &ZXTRACELVL ADDR'                        00146900
.*-------------------------------------------------------------------   00147000
.***AM.L09 ADDR XTRACETKN A                                             00147100
&ZOPN                 SETA &ZOPN+1                                      00147200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTRACETKN_ADDR'                   00147300
&ZOPO(&ZOPN)          SETC 'DS'                                         00147400
&ZOPV(&ZOPN)          SETC 'A'                                          00147500
&ZOPD(&ZOPN)          SETC '++ &ZXTRACETKN ADDR'                        00147600
.*-------------------------------------------------------------------   00147700
.***AM.L09  XQRYWKA CL28                                                00147800
&ZOPN                 SETA &ZOPN+1                                      00147900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XQRYWKA'                          00148000
&ZOPO(&ZOPN)          SETC 'DS'                                         00148100
&ZOPV(&ZOPN)          SETC 'CL28'                                       00148200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00148300
.*-------------------------------------------------------------------   00148400
.***AM.L09  XWRKAREA CL20                                               00148500
&ZOPN                 SETA &ZOPN+1                                      00148600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWRKAREA'                         00148700
&ZOPO(&ZOPN)          SETC 'DS'                                         00148800
&ZOPV(&ZOPN)          SETC 'CL20'                                       00148900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00149000
.*-------------------------------------------------------------------   00149100
.***AM.L09  XMONTKN64 BL.64                                             00149200
&ZOPN                 SETA &ZOPN+1                                      00149300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN64'                        00149400
&ZOPO(&ZOPN)          SETC 'DS'                                         00149500
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00149600
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN64 '                            00149700
.*-------------------------------------------------------------------   00149800
.***AM.L10 END OF ITZQUERY LIST PARAMETERS                              00149900
&ZOPN                 SETA &ZOPN+1                                      00150000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00150100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00150200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00150300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00150400
.*                                                                      00150500
&ZOPN                 SETA &ZOPN+1                                      00150600
&ZOPL(&ZOPN)          SETC ' '                                          00150700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00150800
&ZOPV(&ZOPN)          SETC '1'                                          00150900
&ZOPD(&ZOPN)          SETC ' '                                          00151000
.*-------------------------------------------------------------------   00151100
.***AL.L12 ITZQUERY FMT=LIST MF=S!L PARAMETERS                          00151200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00151300
.*                                                                      00151400
&ZOPN                 SETA  &ZOPN+1                                     00151500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00151600
&ZOPO(&ZOPN)          SETC  'DC'                                        00151700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00151800
&ZOPD(&ZOPN)          SETC  '++ ITZQUERY ARG PARMS'                     00151900
.*                                                                      00152000
.ZLMFSLX              ANOP  ,                                           00152100
.*-------------------------------------------------------------------   00152200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00152300
&ZPLLEN               SETA 72                                           00152400
.*                                                                      00152500
.******************************************************************     00152600
.***AI.L01 ITZQUERY FMT=LIST FILL IN PARAMETER AREA                     00152700
.******************************************************************     00152800
                      ACTR  10000                                       00152900
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00153000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00153100
&ZCVAL                SETC  'LAE'          XAX MODE                     00153200
.ZIMFXA               ANOP ,                                            00153300
.*                                                                      00153400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00153500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00153600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00153700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00153800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00153900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00154000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00154100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00154200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00154300
&ZOPN                 SETA  &ZOPN+1                                     00154400
&ZOPL(&ZOPN)          SETC  ' '                                         00154500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00154600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00154700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00154800
                      AGO   .ZIMFNX                                     00154900
.*                                                                      00155000
.ZIMFN2               ANOP ,                                            00155100
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00155200
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00155300
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00155400
&ZOPN                 SETA  &ZOPN+1                                     00155500
&ZOPL(&ZOPN)          SETC  ' '                                         00155600
&ZOPO(&ZOPN)          SETC  'LAE'                                       00155700
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00155800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00155900
                      AGO   .ZIMFNX                                     00156000
.ZIMFNX1              ANOP ,                                            00156100
&ZOPN                 SETA  &ZOPN+1                                     00156200
&ZOPL(&ZOPN)          SETC  ' '                                         00156300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00156400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00156500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00156600
.ZIMFNX               ANOP ,                                            00156700
.********************************************************************   00156800
.***AI.L02 ITZQUERY FMT=LIST INITIALIZE PARAMETER AREA                  00156900
.********************************************************************   00157000
.***AI.L03 MF=(SLME)                                                    00157100
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00157200
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00157300
.*                                                                      00157400
&ZOPN                 SETA  &ZOPN+1                                     00157500
&ZOPL(&ZOPN)          SETC  ' '                                         00157600
&ZOPO(&ZOPN)          SETC  'XC'                                        00157700
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00157800
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00157900
.ZIMFLX               ANOP  ,                                           00158000
.*-------------------------------------------------------------------   00158100
.***AI.L04A XVERSION XL1                                                00158200
                      AIF   (&XPLISTVER EQ 0).ZIMFVU                    00158300
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVV            00158400
.ZIMFVU               ANOP  ,                                           00158500
                      AIF   ('&PLISTVER' EQ '').ZIMFVW                  00158600
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVW            00158700
.ZIMFVV               ANOP  ,                                           00158800
&ZOPN                 SETA  &ZOPN+1                                     00158900
&ZOPL(&ZOPN)          SETC  ' '                                         00159000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00159100
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00159200
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00159300
.ZIMFVW               ANOP  ,                                           00159400
.*-------------------------------------------------------------------   00159500
.***AI.L05 XREQUEST BL1                                                 00159600
&ZW                   SETC  ''                                          00159700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00159800
&ZMS                  SETC  ''                                          00159900
&ZC                   SETC  ''                                          00160000
.*-------------------------------------------------------------------   00160100
.***AI.L08 XREQUEST "TRACELVL"                                          00160200
.***      BL1'1XXXXXXX'                                                 00160300
         AIF   ('&TRACELVL' EQ '').ZI3A                                 00160400
&ZW                   SETC  '&ZW.1'                                     00160500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00160600
&ZMS                  SETC  '&ZMS.0'                                    00160700
                      AGO   .ZI3C                                       00160800
.*                                                                      00160900
.ZI3A                 ANOP  ,                                           00161000
&ZW                   SETC  '&ZW.0'                                     00161100
&ZMS                  SETC  '&ZMS.1'                                    00161200
.ZI3C                 ANOP  ,                                           00161300
.*-------------------------------------------------------------------   00161400
.***AI.L08 XREQUEST "MONTKN"                                            00161500
.***      BL1'XXXX1XXX'                                                 00161600
         AIF   ('&MONTKN' EQ '').ZI4A                                   00161700
&ZW                   SETC  '&ZW.0001'                                  00161800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00161900
&ZMS                  SETC  '&ZMS.1110'                                 00162000
                      AGO   .ZI4C                                       00162100
.*                                                                      00162200
.ZI4A                 ANOP  ,                                           00162300
&ZW                   SETC  '&ZW.0000'                                  00162400
&ZMS                  SETC  '&ZMS.1111'                                 00162500
.ZI4C                 ANOP  ,                                           00162600
.*-------------------------------------------------------------------   00162700
.***AI.L08 XREQUEST "MONTKN64"                                          00162800
.***      BL1'XXXXX1XX'                                                 00162900
         AIF   ('&MONTKN64' EQ '').ZI5A                                 00163000
&ZW                   SETC  '&ZW.100'                                   00163100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00163200
&ZMS                  SETC  '&ZMS.011'                                  00163300
                      AGO   .ZI5C                                       00163400
.*                                                                      00163500
.ZI5A                 ANOP  ,                                           00163600
&ZW                   SETC  '&ZW.000'                                   00163700
&ZMS                  SETC  '&ZMS.111'                                  00163800
.ZI5C                 ANOP  ,                                           00163900
.*-------------------------------------------------------------------   00164000
.***AI.L11 XREQUEST BL1                                                 00164100
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI5D               00164200
                      AIF   ('&ZC' NE 'YES').ZI5D                       00164300
&ZOPN                 SETA  &ZOPN+1                                     00164400
&ZOPL(&ZOPN)          SETC  ' '                                         00164500
&ZOPO(&ZOPN)          SETC  'NI'                                        00164600
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            00164700
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00164800
.ZI5D                 ANOP  ,                                           00164900
                      AIF   ('&ZCLNG' NE 'YES').ZI5E  ALL ZERO BITS     00165000
&ZOPN                 SETA  &ZOPN+1                                     00165100
&ZOPL(&ZOPN)          SETC  ' '                                         00165200
&ZOPO(&ZOPN)          SETC  'OI'                                        00165300
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00165400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00165500
.ZI5E                 ANOP  ,                                           00165600
.*-------------------------------------------------------------------   00165700
.***AI.L25  XMONTKN XL4                                                 00165800
                      AIF   ('&ZXMONTKN' EQ '').ZI7E                    00165900
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI7E              00166000
&ZCGPR                SETC  '&XMONTKN'                                  00166100
         AIF   ('&XMONTKN' NE '0').ZI7A                                 00166200
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI7E                           00166300
.*                                                                      00166400
&ZCGPR                SETC  '=XL4''00'''                                00166500
.ZI7A                 ANOP  ,                                           00166600
.*                                                                      00166700
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI7B               00166800
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      00166900
                      AGO   .ZI7D                                       00167000
.ZI7B                 ANOP  ,                                           00167100
.*                                                                      00167200
&ZC                   SETC  '&XMONTKN'(1,1)                             00167300
                      AIF   (T'&ZC NE 'N').ZI7D                         00167400
&ZC                   SETC  '&XMONTKN'                                  00167500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00167600
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          00167700
.*                                                                      00167800
.ZI7D                 ANOP  ,                                           00167900
.*                                                                      00168000
&ZOPN                 SETA  &ZOPN+1                                     00168100
&ZOPL(&ZOPN)          SETC  ' '                                         00168200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00168300
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00168400
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      00168500
.*                                                                      00168600
.ZI7E                 ANOP  ,                                           00168700
.*-------------------------------------------------------------------   00168800
.***AI.L19 ADDR XTRACELVL A                                             00168900
                      AIF   ('&ZXTRACELVL' EQ '').ZI8H                  00169000
&ZCLNG                SETC  '&XTRACELVL'                                00169100
&ZCGPR                SETC  '14'                                        00169200
.*                                                                      00169300
&ZOPN                 SETA  &ZOPN+1                                     00169400
&ZOPL(&ZOPN)          SETC  ' '                                         00169500
&ZOPO(&ZOPN)          SETC  'LA'                                        00169600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00169700
&ZOPD(&ZOPN)          SETC  '++ &ZXTRACELVL XTRACELVL'                  00169800
.*                                                                      00169900
&ZOPN                 SETA  &ZOPN+1                                     00170000
&ZOPL(&ZOPN)          SETC  ' '                                         00170100
&ZOPO(&ZOPN)          SETC  'ST'                                        00170200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00170300
&ZOPD(&ZOPN)          SETC  '++ &ZXTRACELVL XTRACELVL'                  00170400
.*                                                                      00170500
.ZI8H                 ANOP  ,                                           00170600
.*-------------------------------------------------------------------   00170700
.***AI.L19 ADDR XTRACETKN A                                             00170800
                      AIF   ('&ZXTRACETKN' EQ '').ZI9H                  00170900
&ZCLNG                SETC  '&XTRACETKN'                                00171000
&ZCGPR                SETC  '14'                                        00171100
.*                                                                      00171200
&ZOPN                 SETA  &ZOPN+1                                     00171300
&ZOPL(&ZOPN)          SETC  ' '                                         00171400
&ZOPO(&ZOPN)          SETC  'LA'                                        00171500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00171600
&ZOPD(&ZOPN)          SETC  '++ &ZXTRACETKN XTRACETKN'                  00171700
.*                                                                      00171800
&ZOPN                 SETA  &ZOPN+1                                     00171900
&ZOPL(&ZOPN)          SETC  ' '                                         00172000
&ZOPO(&ZOPN)          SETC  'ST'                                        00172100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00172200
&ZOPD(&ZOPN)          SETC  '++ &ZXTRACETKN XTRACETKN'                  00172300
.*                                                                      00172400
.ZI9H                 ANOP  ,                                           00172500
.*-------------------------------------------------------------------   00172600
.***AI.L25  XMONTKN64 XL8                                               00172700
                      AIF   ('&ZXMONTKN64' EQ '').ZI12E                 00172800
                      AIF   ('&ZXMONTKN64' EQ 'OUTPUT').ZI12E           00172900
&ZCGPR                SETC  '&XMONTKN64'                                00173000
         AIF   ('&XMONTKN64' NE '0').ZI12A                              00173100
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI12E                          00173200
.*                                                                      00173300
&ZCGPR                SETC  '=XL8''00'''                                00173400
.ZI12A                ANOP  ,                                           00173500
.*                                                                      00173600
                      AIF   ('&XMONTKN64'(1,1) NE '(').ZI12B            00173700
&ZCGPR   SETC  '0('.'&XMONTKN64'(2,K'&XMONTKN64-2).')'                  00173800
                      AGO   .ZI12D                                      00173900
.ZI12B                ANOP  ,                                           00174000
.*                                                                      00174100
&ZC                   SETC  '&XMONTKN64'(1,1)                           00174200
                      AIF   (T'&ZC NE 'N').ZI12D                        00174300
&ZC                   SETC  '&XMONTKN64'                                00174400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00174500
&ZCGPR                SETC  '=BL8''&XMONTKN64'''                        00174600
.*                                                                      00174700
.ZI12D                ANOP  ,                                           00174800
.*                                                                      00174900
&ZOPN                 SETA  &ZOPN+1                                     00175000
&ZOPL(&ZOPN)          SETC  ' '                                         00175100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00175200
&ZOPV(&ZOPN)          SETC  '64(8,1),&ZCGPR'                            00175300
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN64 XMONTKN64'                  00175400
.*                                                                      00175500
.ZI12E                ANOP  ,                                           00175600
.*-------------------------------------------------------------------   00175700
&ZOPN1                SETA &ZOPN                                        00175800
.*-------------------------------------------------------------------   00175900
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00176000
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00176100
.*******************************************************************    00176200
.***  PROCESS ITZQUERY OUTPUT PARAMETERS                                00176300
.*******************************************************************    00176400
                      ACTR  10000                                       00176500
.*******************************************************************    00176600
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00176700
.*******************************************************************    00176800
.ZMFLX                ANOP  ,              MF=L PROCESSING              00176900
.*******************************************************************    00177000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00177100
.*******************************************************************    00177200
                      ACTR  10000                                       00177300
.*                                                                      00177400
                      LCLA  &ZLC           COLUMN POSITION              00177500
                      LCLA  &ZOPX          LIST TABLE INDEX             00177600
                      LCLC  &ZLL           LABEL                        00177700
                      LCLC  &ZLOP          OPERATION                    00177800
                      LCLC  &ZLV           VALUE                        00177900
                      LCLC  &ZLD           DESCRIPTION                  00178000
.*                                                                      00178100
&ZOPX                 SETA  1                                           00178200
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00178300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00178400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00178500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00178600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00178700
                      AIF   (K'&ZLD LE 0).ZL5                           00178800
&ZLC                  SETA  35             COMMENT COLUMN               00178900
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00179000
&ZLC                  SETA  33             COMMMENT COLUMN              00179100
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00179200
&ZLV                  SETC  '&ZLV'.' '                                  00179300
                      AGO   .ZL3                                        00179400
.*                                                                      00179500
.ZL4                  ANOP  ,                                           00179600
&ZLV                  SETC  '&ZLV'.' '                                  00179700
.ZL5                  ANOP  ,                                           00179800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00179900
.*                                                                      00180000
&ZLL     &ZLOP &ZLV                                                     00180100
.*                                                                      00180200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00180300
                      AGO   .ZL2           CONTINUE LOOPING             00180400
.*                                                                      00180500
.ZLX                  ANOP  ,                                           00180600
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00180700
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00180800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00180900
        L     15,616(15,0)                                         @L1A 00181000
        L     15,16(15,0)          Get query rtn address           @L1A 00181100
        BALR  14,15                Invoke TTrace Query Rtn         @L1A 00181200
        B     &QDONE                                               @L1A 00181300
&NOQLAB  DS    0H                                                  @L1A 00181400
        LA    15,4                                                 @L1A 00181500
&QDONE   DS    0H                                                  @L1A 00181600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00181700
.ZLINKX               ANOP  ,                                           00181800
.*******************************************************************    00181900
.***AP.X01  FORMAT GENERATED CODE                                       00182000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00182100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00182200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00182300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00182400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00182500
                      AIF   (K'&ZLD LE 0).ZL51                          00182600
&ZLC                  SETA  35             COMMENT COLUMN               00182700
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00182800
&ZLC                  SETA  33             COMMENT COLUMN               00182900
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00183000
&ZLV                  SETC  '&ZLV'.' '                                  00183100
                      AGO   .ZL31                                       00183200
.*                                                                      00183300
.ZL41                 ANOP  ,                                           00183400
&ZLV                  SETC  '&ZLV'.' '                                  00183500
.ZL51                 ANOP  ,                                           00183600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00183700
.*                                                                      00183800
&ZLL     &ZLOP &ZLV                                                     00183900
.*                                                                      00184000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00184100
                      AGO   .ZL21          CONTINUE LOOPING             00184200
.*                                                                      00184300
.ZLX1                 ANOP  ,                                           00184400
.*******************************************************************    00184500
.***AP.X02  END OF ITZQUERY MACRO                                       00184600
&ZITZQUERY            SETC  'YES'          SET ITZQUERY USED            00184700
         POP   PRINT                                                    00184800
*                                            ITZQUERY-1                 00184900
         SPACE 1                                                        00185000
.ZLX2                 ANOP  ,                                           00185100
         MEND                                                           00185200
**********************************************************************/ 00185300
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00185400
*%ITZQUERY: MACRO KEYS(MONTKN,MONTKN64,TRACETKN,TRACELVL,PLISTVER,MF);  00185500
*  ANS('?'!!MACLABEL!!' '!!'ITZQUERP '!!MACLIST!!                       00185600
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00185700
*%END ITZQUERY;                                                         00185800

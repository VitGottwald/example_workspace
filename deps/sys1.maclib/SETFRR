*                                                                       00010001
*%/* IF PLS, EXCLUDE THE BAL FORM OF THE MACRO                          00020001
         MACRO                                                          00030001
&NAME    SETFRR    &OPT,&FRRAD=,&PARMAD=,&WRKREGS=,&RELATED=,&CLEAR=,  C00040001
               &MODE=,&EUT=,&INLINE=NO,&ASSIST=NO,&AMODE=CALLER,       C00050001
               &CANCEL=,&OPT2,&REGS=SAVE,&SDWALOC31=               @P5C 00060001
.*                                                                      00070001
.********************************************************************** 00080001
.*                                                                    * 00090001
.*01* MACRO NAME: SETFRR                                              * 00100001
.*                                                                    * 00110001
.*01* PROPRIETARY STATEMENT:                                          * 00120001
.*                                                                    * 00130001
.*   5650-ZOS COPYRIGHT IBM CORP. 1980,2015                           * 00140001
.*   LICENSED MATERIALS - PROPERTY OF IBM                             * 00150001
.*                                                                    * 00160001
.*   STATUS = HBB77A0                                                 * 00170001
.*                                                                    * 00180001
.*01* FUNCTION:                                                       * 00190001
.*                                                                    * 00200001
.*     THE SETFRR MACRO EXPANSION GENERATES CODE WHICH CALLS          * 00210001
.*     IEAVTSFR TO MANIPULATE THE CURRENT FRR STACK.                  * 00220001
.*                                                                    * 00230001
.*     USERS OF SETFRR MUST BE RUNNING DISABLED OR LOCKED OR IN       * 00240001
.*     SRB MODE, OR THEY MUST SPECIFY EUT=YES                         * 00250001
.*                                                                    * 00260001
.*     PRIOR TO ISSUING SETFRR THE USER MUST HAVE                     * 00270001
.*                                                                    * 00280001
.*     1.  ESTABLISHED ADDRESSABILITY TO THE PSA (THE FIRST           * 00290001
.*         INSTRUCTION GENERATED BY THE SETFRR EXPANSION REFERENCES   * 00300001
.*         THE PSACSTK FIELD OF THE PSA)                              * 00310001
.*                                                                    * 00320001
.*     2.  ISSUED THE FRR STACK MAPPING MACRO (IHAFRRS)               * 00330001
.*                                                                    * 00340001
.*01* USAGE NOTES:                                                    * 00341001
.*                                                                    * 00342001
.*     GBLC variables SETFRR_L31_YES and SETFRR_L31_REQ are used to   * 00343001
.*     tweak the SDWALOC31 behavior                                   * 00344001
.*   - SETFRR_L31_YES, when not null, indicates that the default      * 00345001
.*     for SDWALOC31 is YES. This applies even if SETFRR_L31_REQ is   * 00345101
.*     not null                                                       * 00345201
.*   - SETFRR_L31_REQ, when not null, indicates that SDWALOC31        * 00345301
.*     is required. An error is reported when SDWALOC31 is not        * 00345401
.*     specified. This processing does not apply when                 * 00345501
.*     SETFRR_L31_YES is not null.                                    * 00345601
.*                                                                    * 00345701
.*01* EXTERNAL CLASSIFICATION:                                        * 00345801
.*                                                                    * 00345901
.*02* PI: BASE                                                        * 00346001
.*        CLEAR=YES WHEN USED WITH REPLACE                            * 00347001
.*                                                                    * 00348001
.*                                                                    * 00349001
.*                                                                    * 00350001
.*02* NONE: CLEAR                                                     * 00360001
.*          INLINE                                                    * 00370001
.*          ASSIST                                                    * 00380001
.*          AMODE                                                     * 00390001
.*                                                                    * 00400001
.*01* END OF EXTERNAL CLASSIFICATION:                                 * 00410001
.*                                                                    * 00420001
.*01* MODULE TYPE:  ASSEM MACRO                                       * 00430001
.*                                                                    * 00440001
.*02*   PROCESSOR:  ASSEM                                             * 00450001
.*                                                                    * 00460001
.*01* COMPONENT:  SCRTM                                               * 00470001
.*                                                                    * 00480001
.*01* DISTRIBUTION LIBRARY: AMACLIB                                   * 00490001
.*                                                                    * 00500001
.*01* CHANGE ACTIVITY:                                                * 00510001
.*         MVS/SYSTEM PRODUCT RELEASE 2 2/21/79               @G381P2F* 00520001
.*                 CROSS MEMORY PARAMETERS (MODE,EUT)         @G381P2F* 00530001
.*                 INTRODUCED OUT-OF-LINE CODE (INLINE)       @G381P2F* 00540001
.*                 RACE CONDITION FIXED                       @G381P2F* 00550001
.*                 INTRODUCED ADD FRR INSTRUCTION (SETFRRI) 4/17/80   * 00560001
.*                                                            @G38LP1S* 00570001
.*                 - USE LA TO OBTAIN NORMAL STACK ADDRESS    @ZM49899* 00580001
.*                 - ADDED OPT2 TO CATCH MISSING PARENS AND   @ZM50139* 00590001
.*                 FIXED OVERFLOW OF COMMENTS WHEN SYMBOLIC   @ZM50139* 00600001
.*                 NAMES ARE USED IN WRKREGS  4/24/79         @ZM50139* 00610001
.*                 - ON ADDFLUSH, CHANGED THE LOAD ADDRESS    @ZMB0044* 00620001
.*                 OF FRRSENTS TO AN ADD OF FRRSELEN TO REG 1 @ZMB0044* 00630001
.*                 TO ADDRESS THE FIRST ENTRY 8/29/79         @ZMB0044* 00640001
.*         MVS/SYSTEM PRODUCT VERSION 2 RELEASE 1             @G860P1S* 00650001
.*                 - ADDED THE AMODE = CALLER OR DEFINED TO   @G860P1F* 00660001
.*                   THE INLINE SETFRR WITH THE AF(ADD-FLUSH) @G860P1F* 00670001
.*                   OPTION FOR USE BY THE DISPATCHER.        @G860P1F* 00680001
.*      $L1=RTM1REC ,JBB2125,821203,PDA8: INVOKE SETFRRP IN PL/S  @L1A* 00690001
.*      $H1=ADVPROC1,JBB2133,830103,PDXB: REMOVE ASSIST SUPPORT   @H1A* 00700001
.*      $L2=AR      ,HBB3310,851101,PDXB: AR SUPPORT                  * 00710001
.*      $D1=DCR0059 ,HBB3310,861029,PDU8: CANCEL KEYWORD SUPPORT  @D1A* 00720001
.* $P1=PYV0025  HBB7707 010828 PDKD: REMOVE SUPPORT FOR THE INLINE    * 00730001
.*                                   KEYWORD WHEN ADDING AN FRR --    * 00740001
.*                                   THIS KEYWORD PROVIDED A VERY     * 00750001
.*                                   SMALL PERFORMANCE BENEFIT AT THE * 00760001
.*                                   COST OF NOT SUPPORTING CURRENT   * 00770001
.*                                   ARCHITECTURE FEATURES.  PROGRAMS * 00780001
.*                                   THAT FAIL TO ASSEMBLE BECAUSE OF * 00790001
.*                                   THIS CHANGE SHOULD BE UPDATED    * 00800001
.*                                   TO NO LONGER SPECIFY INLINE=YES  * 00810001
.* $P2=PYN0224  HBB7708 020308 PDKD: ALLOW CLEAR=YES FOR REPLACE      * 00820001
.* $L3=PEV      HBB7730 050415 PDXB: AMODE 64 FRR                     * 00830001
.* $L4=MEXXXXX  HBB7730 050801 PDXB: JUMPIFY                          * 00840001
.* $L5=ME06342  HBB7730 060320 PDXB: REGS                             * 00850001
.* $L6=FRRSDWA  HBB7740 070220 PDKD: Allow combo of EUT and AMODE64   * 00860001
.* $L7=ME15002  HBB7760 081115 PDXB: UNRSTDReg14(reg) for SETFRRP     * 00870001
.* $P3=ME17549  HBB7770 091023 PDKD: SDWALOC31 for FRRs               * 00880001
.* $P4=ME17587  HBB7770 091023 PDKD: Correct delete SDWALOC31         * 00890001
.* $P5=ME17701  HBB7770 091111 PDXB: SETFRR_L31_xxx                   * 00900001
.* $01=OA54807  HBB7790 180330 PDXB: OA54807                          * 00910002
.*                                                                    * 00920001
.********************************************************************** 00921001
         GBLC  &SYSSPLV                                        @G860P1C 00922001
      SPLEVEL TEST                     INVOKE SPLEVEL MACRO    @G860P1C 00923001
      AIF    ('&SYSSPLV' EQ '1').S370  S/370 LEVEL REQUESTED?  @G860P1C 00924001
      LCLC    &L,&LR              L OR LLGT,LR OR LGR              @L3A 00925001
      LCLC    &LFLCCVT            L OR LG                          @L3A 00926001
      LCLC    &FLCCVTOFF          16 OR 72                         @L3A 00927001
      LCLC    &CVTSFR             276 FOR SFR, 1048 FOR SFV        @L3A 00928001
      LCLC    &LA                 HOLDS LA OR LAE BY SPLEVEL       @L2A 00929001
      LCLC    &LAA                HOLDS LA OR LAE BY SYSSTATE      @L2A 00930001
&LA   SETC    'LA'                LA INSTRUCTION FOR SP2           @L2A 00940001
&LAA  SETC    'LA'                ASSUME TO USE LA INSTRUCTION     @L2A 00950001
      GBLC     &SYSASCE           ASC ENVIRONMENT                  @L2A 00960001
      GBLC     &SYSAM64           AMODE 64                         @L3A 00970001
      GBLC     &SYSOSREL          OS RELEASE                       @L3A 00980001
      GBLC     &SYSOSREL_ZOSV1R7  Z/OS 1.8                         @L3A 00990001
      GBLC     &SETFRR_L31_REQ    SDWALOC31 required               @P5A 01000001
      GBLC     &SETFRR_L31_YES    SDWALOC31 default to YES         @P5A 01010001
      LCLC     &SETFRR_AM64       TRUE AMODE 64 NEEDED             @L3A 01020001
      LCLC     &DIDLAE1           Did LAE for reg 1                @L5A 01030001
      SYSSTATE TEST               WHAT IS ASC ENVIRONMENT          @L2A 01040001
      AIF ('&SYSASCE' EQ 'P').USEPRIM PRIMARY, PROCESS NORMALLY    @L2A 01050001
&LA   SETC    'LAE'               USE LAE INSTRUCTION              @L2A 01060001
&LAA  SETC    'LAE'               AR/ANY -- USE LAE INSTRUCTION    @L2A 01070001
.USEPRIM ANOP                                                      @L2A 01080001
&L    SETC    'L'                 USE L    INSTRUCTION             @L3A 01090001
&LR   SETC    'LR'                USE LR   INSTRUCTION             @L3A 01100001
&CVTSFR SETC  '276'               CVTSFR                           @L3A 01110001
&LFLCCVT SETC 'L'                 LOAD INSTRUCTION                 @L3A 01120001
&FLCCVTOFF SETC '16'              FLCCVT                           @L3A 01130001
      AIF ('&SYSAM64' NE 'YES').NOT64                              @L3A 01140001
&L    SETC    'LLGT'              USE LLGT INSTRUCTION             @L3A 01150001
      AIF ('&OPT' EQ 'A').NOT64                                    @L5A 01160001
      AIF ('&OPT' EQ 'D').NOT64                                    @L5A 01170001
         MNOTE 12,'SETFRR &OPT. MAY NOT BE ISSUED IN AMODE 64'     @L5A 01180001
         AGO   .END                                                @L3A 01190001
.NOT64 ANOP                                                        @L3A 01200001
         AIF   ('&SYSAM64' NE 'YES' OR                                 *01210001
               '&SYSASCE' NE 'P' OR                                    *01220001
               '&SYSOSREL' LE '&SYSOSREL_ZOSV1R7').NOTTRUEAM64     @L3A 01230001
&SETFRR_AM64 SETC 'YES'            TRUE AMODE 64                   @L3A 01240001
&LR   SETC    'LGR'               USE LGR INSTRUCTION              @L3A 01250001
&LFLCCVT SETC 'LG'                LG INSTRUCTION                   @L3A 01260001
&FLCCVTOFF SETC '72'              FLCCVT64                         @L3A 01270001
         AIF   ('&OPT' NE 'P' AND '&OPT' NE 'D').NOTNEWEP          @L3A 01280001
&CVTSFR SETC  '1048'              CVTSFV                           @L3A 01290001
.NOTNEWEP ANOP                                                     @L3A 01300001
.NOTTRUEAM64 ANOP                                                  @L3A 01310001
         AIF   ('&SYSAM64' NE 'YES').AMODEOK                       @L3A 01320001
         AIF   ('&SETFRR_AM64' EQ 'YES').AMODEOK                   @L3A 01330001
.* It is intentional that                                               01340001
.* - there is no space between SETFRR and &OPT.                         01341001
.* - there are multiple spaces between some things.                     01342001
.* These make the MNOTE more readable                                   01343001
 MNOTE 12,'SETFRR &OPT. CANNOT BE ISSUED IN AMODE 64 PRIOR TO z/OS 1.8.*01344001
                SETFRR&OPT. CANNOT BE ISSUED IN AMODE 64 WHILE IN AR AS*01345001
               C MODE.    CHANGE TO BE IN AMODE 31 OR PRIMARY ASC MODE *01346001
               FOR THE    INVOCATION AND INDICATE YOUR RELEASE, AMODE, *01347001
               AND ASC    MODE VIA SYSSTATE'                           *01348001
                                                                   @L3A 01349001
         AGO   .END                                                @L3A 01350001
.AMODEOK ANOP                                                      @L3A 01360001
*    MACDATE    09/10/2009                                         @P3C 01370001
      LCLA    &CTRLNK                                          @G381P2F 01380001
      LCLA    &I                                               @G381P2F 01390001
      LCLA    &J                                               @G381P2F 01400001
      LCLA    &MODFLG                                          @G381P2F 01410001
      LCLB    &B(5)                                            @G381P2F 01420001
      LCLC    &R1                                                       01430001
      LCLC    &R2                                                       01440001
      LCLC    &R3                                                       01450001
      LCLC    &R4                                                       01460001
         LCLC  &LABEL                                          @G38LP1S 01470001
         LCLC  &RX,&RY,&T                                      @G38LP1S 01480001
&J    SETA    N'&MODE                                          @G381P2F 01490001
.*    VERIFY THAT THERE ARE NO POSITIONAL PARAMETERS OTHER     @ZM50139 01500001
.*    THAN OPTION,  THIS COULD OCCUR IF MODE WAS SPECIFIED     @ZM50139 01510001
.*    WITH MORE THAN ONE PARAMETER AND PARENTHESIS WERE NOT    @ZM50139 01520001
.*    USED                                                     @ZM50139 01530001
      AIF    ('&OPT2' NE '').MSG12                             @ZM50139 01540001
         AIF   ('&ASSIST' NE 'YES').ASSTOK   SKIP IF ASSIST NOT WANTED X01550001
                                                               @G38LP1S 01560001
         MNOTE  8,'SETFRR ASSIST NOT SUPPORTED'                    @H1A 01570001
         AGO   .END                     LEAVE MACRO                @H1A 01580001
.*                                                                8@H1D 01590001
.ASSTOK  ANOP  ,                                               @G38LP1S 01600001
.*                                                             @G860P1F 01610001
         AIF   ('&AMODE' EQ 'CALLER').AMODECL SKIP IF CALLER           X01620001
                                              IS SPECIFIED     @G860P1F 01630001
         AGO   .MSG14                    OTHER AMODE= OPTIONS      @P1C 01640001
.*                                       ARE NOT SUPPORTED BY THIS      01650001
.*                                       MACRO                          01660001
.AMODECL ANOP  ,                                               @G860P1F 01670001
.*    VERIFY VALID OPTION SPECIFIED FOR CLEAR KEYWORD                   01680001
.C1   AIF    ('&CLEAR' EQ '' OR '&CLEAR' EQ 'Y' OR '&CLEAR' EQ 'N').C2  01690001
      AIF    ('&CLEAR' EQ 'YES' OR '&CLEAR' EQ 'NO').C2                 01700001
      AIF    ('&OPT' EQ 'A').CLEARY                            @G38LP2F 01710001
.*    DEFAULT FOR REPLACE AND ADDFLUSH IS CLEAR=NO             @G38LP2F 01720001
      MNOTE  0,'INVALID CLEAR OPTION, CLEAR=NO ASSUMED'        @G38LP2F 01730001
         AGO      .C2                                          @G38LP2F 01740001
.CLEARY  ANOP  ,                                               @G38LP2F 01750001
.*    DEFAULT FOR ADD IS CLEAR=YES                             @G38LP2F 01760001
      MNOTE  0,'INVALID CLEAR OPTION, CLEAR=YES ASSUMED'       @G38LP2F 01770001
         AGO      .C2                                                   01780001
.C4      MNOTE      8,'** PARMAD MUST BE SPECIFIED WITH CLEAR OPTION'   01790001
         MEXIT                                                          01800001
.C2      AIF       ('&CLEAR' NE '' AND '&PARMAD' EQ '').C4              01810001
         AIF       ('&WRKREGS' EQ '').MSG1            CHECK TO SEE IF   01820001
.*                                                    WORK REGISTERS    01830001
.*                                                    ARE SPECIFIED     01840001
         AIF   ('&INLINE' EQ 'NO' OR '&INLINE' EQ 'N').OUTLINE          01850001
.*                                          BRANCH IF INLINE=YES WAS    01860001
.*                                          NOT SPECIFIED      @G381P2F 01870001
         AIF   ('&INLINE' NE 'YES' AND '&INLINE' NE 'Y').MSG9           01880001
.*                                          ISSUE MESSAGE IF &INLINE    01890001
.*                                          IS SPECIFIED INCORRECTLY    01900001
         AIF   ('&MODE' NE '' AND '&MODE(1)' NE 'HOME').MSG7   @G381P2F 01910001
         AIF   ('&MODE' NE '' AND &J GT 1).MSG7                @G381P2F 01920001
.*                                          ISSUE MESSAGE IF &MODE      01930001
.*                                          IS SPECIFIED INCORRECTLY    01940001
.*                                          WITH INLINE=YES    @G381P2F 01950001
         AIF   ('&CANCEL' NE '').MSG16      CANCEL KEYWORD NOT     @D1A 01960001
.*                                          SUPPORTED FOR INLINE FORM   01970001
         AIF   ('&EUT' NE '').MSG6                             @G381P2F 01980001
.*                                          ISSUE MESSAGE IF &EUT       01990001
.*                                          IS SPECIFIED WITH           02000001
.*                                          INLINE=YES         @G381P2F 02010001
         AIF       ('&WRKREGS'(1,1) NE '(' OR N'&WRKREGS NE 2).MSG2     02020001
.*                                                    IF &WRKREGS IS    02030001
.*                                                    SPECIFIED BUT     02040001
.*                                                    INVALIDLY ISSUE   02050001
.*                                                    ERROR MESSAGE.    02060001
.** Note that we do not bother to check for the combination of INLINE   02070001
.** and SDWALOC31 since INLINE ADD is no longer supported               02080001
.*                                                                      02090001
.*    SET UP LOCAL CHARACTER FOR USE IN EXPANSIONS                      02100001
&R1    SETC    '&WRKREGS(1)'                                            02110001
&R2    SETC    '&WRKREGS(2)'                                            02120001
&R3    SETC    '&PARMAD(1)'                                             02130001
&R4    SETC    '&FRRAD(1)'                                              02140001
.CHKSAVE ANOP                                                      @L5A 02150001
         LCLC  &C1,&C2                                             @L5A 02160001
&C1      SETC  '&R1'                                               @L5A 02170001
&C2      SETC  '&R2'                                               @L5A 02180001
         AIF   ('&REGS' NE 'USE').OKSAVE                           @L5A 02190001
         AIF   ('&OPT' NE 'A' AND '&OPT' NE 'D').MSG19             @L5A 02200001
&C1      SETC  '1'                                                 @L5A 02210001
&C2      SETC  '2'                                                 @L5A 02220001
.OKSAVE  ANOP                                                      @L5A 02230001
.*                                                    OTHERWISE CHECK   02240001
.*                                                    &OPT FOR A VALID  02250001
.*                                                    OPTION            02260001
         AIF       ('&OPT' EQ 'A' OR '&OPT' EQ 'R').MSG5           @P1C 02270001
.*                                          INLINE=YES IS NOT ALLOWED   02280001
.*                                          WHEN ADDING AN FRR          02290001
         AIF       ('&OPT' EQ 'D' OR '&OPT' EQ 'P').EXPAND              02300001
         AIF       ('&OPT' EQ 'F').FLUSH                                02310001
         AIF       ('&OPT' EQ 'AF').MSG13 ADD/FLUSH OPTION         @P1C 02320001
.*                                          INLINE=YES IS NOT ALLOWED   02330001
.*                                          WHEN ADDING AN FRR          02340001
.INVOPT  MNOTE     12,'INVALID OPTION &OPT SPECIFIED'          @G38LP1S 02350001
.*                                                    MESSAGE STATING   02360001
.*                                                    INVALID OPTION    02370001
         AGO       .END                               STOP EXPANSION    02380001
.EXPAND  ANOP                                         BEGIN EXPANSION   02390001
         AIF       ('&FRRAD' NE '' OR '&PARMAD' NE '').WARN             02400001
         AGO       .EXPAND1                                             02410001
.WARN    MNOTE     *,'FRRAD AND/OR PARMAD SPECIFIED FOR DELETE/PURGE'   02420001
         MNOTE     0,'FRRAD AND/OR PARMAD IGNORED-DELETE/PURGE HONORED' 02430001
.*                                                             @G38LP2F 02440001
.EXPAND1 ANOP                                                           02450001
&NAME    &L    &C1,PSACSTK-PSA(0,0)         ADDRESS OF CURRENT     @L3A 02460001
         AIF   ('&SYSAM64' NE 'YES' OR                                 *02470001
               '&SETFRR_AM64' EQ 'YES').OKDELPURGE1                @L3A 02480001
.* IT IS INTENTIONAL THAT                                               02490001
.* THERE ARE 2 SPACES BETWEEN "IN" AND "AR-MODE"                        02500001
.* AND THAT THERE IS NO SPACE BETWEEN "ISSUE" AND "SYSSTATE"            02510001
.* - IT MAKES THE MNOTE MORE READABLE                                   02520001
         MNOTE 12,'SETFRR &OPT. CANNOT BE ISSUED IN AMODE 64 PRIOR TO Z*02530001
               /OS 1.8 OR IN  AR-MODE. PLEASE CHANGE TO MEET THE REQUIR*02540001
               MENTS AND ISSUESYSSTATE TO MATCH YOUR CHANGED INVOCATION*02550001
                ENVIRONMENT'                                            02560001
         AGO   .END                                                @L3A 02570001
.OKDELPURGE1 ANOP                                                  @L3A 02580001
         AIF       ('&OPT' EQ 'P').PURGE              GO EXPAND FOR A   02590001
.*                                                    PURGE OF THE FRR  02600001
.*                                                    STACK             02610001
         L     &R2,FRRSCURR-FRRS(&C1,0)    CURRENT ELEMENT ADDR    @L3A 02620001
         CL    &R2,FRRSEMP-FRRS(&C1,0)      IS THE FRR STACK EMPTY @L2C 02630001
         JE    *+12                         YES, DO NOT DELETE     @L4C 02640001
         SL    &R2,FRRSELEN-FRRS(&C1,0)     DECREMENT CURRENT          *02650001
                                            ADDRESS                @L2C 02660001
         AGO       .UPDATE                                              02670001
.PURGE   ANOP                                                      @L3A 02680001
         L     &R2,FRRSEMP-FRRS(&C1,0)      EMPTY STACK ADDR       @L3A 02690001
.UPDATE  ST    &R2,FRRSCURR-FRRS(&C1,0)     UPDATE CURRENT STACK       *02700001
                                            ENTRY                  @L2C 02710001
         AIF       ('&OPT' NE 'P').END      FINISHED IF NOT             02720001
*                                           PURGE              @G382P2F 02730001
         CL    &C1,PSANSTK-PSA(0,0)         IS THIS THE NORMAL          02740001
*                                           STACK              @G382P2F 02750001
         JNE   *+8                          NO, BRANCH             @L4C 02760001
         NI    PSAMFLGS-PSA(0),X'7F'        ENSURE PSANSS FLAG          02770001
*                                           IS OFF             @G382P2F 02780001
         AGO       .END                                                 02790001
.FLUSH   ANOP                                                           02800001
&NAME    L     &C1,PSANSTK-PSA(0,0)             NORMAL STACK PTR   @01A 02810001
         MVC   FRRSCURR-FRRS(4,&C1),FRRSEMP-FRRS(&C1) Purge stack  @01C 02820001
         MVI   FRRSRTMW-FRRS(&C1),X'00'   Zero recursion byte      @01C 02830001
         NI    PSAMFLGS-PSA(0),X'7F'             ENSURE PSANSS          02840001
*                                                FLAG IS OFF   @G381P2F 02850001
         AGO   .END                                                     02860001
.*                                        ***************************   02870001
.OUTLINE ANOP                                                  @G381P2F 02880001
.*                                        FOLLOWING IS CODE TO          02890001
.*                                        BRANCH TO IEAVTSFR   @G381P2F 02900001
.*                                        AND PERFORM ADD FRR  @G38LP1S 02910001
.*                                        INSTRUCTION          @G38LP1S 02920001
.*                                                                      02930001
.*    SET UP LOCAL CHARACTER FOR USE IN EXPANSIONS                      02940001
&I       SETA  1                 INIT INDEX FOR MODE           @G381P2F 02950001
&MODFLG  SETA  0                 INIT MODE FLAGS               @G381P2F 02960001
&CTRLNK  SETA  0                 INIT BRANCH TABLE CTR         @G381P2F 02970001
.* THE AMODE 64 TABLE IS ALSO AT OFFSET 0, BUT FROM IEAVTSFV       @L3A 02980001
.* IF AMODE 64 *AND* AR MODE, WE USE AR-MODE AND SWITCH TO         @L3A 02990001
.* AMODE 31 FOR THE CALL                                           @L3A 03000001
         AIF   ('&SYSASCE' EQ 'P').KEEPCTR                         @L2A 03010001
&CTRLNK  SETA  72                RESET TO AR TABLE                 @L2A 03020001
.KEEPCTR ANOP                                                      @L2A 03030001
&B(1)    SETB  0                 INIT MODE=HOME IND            @G381P2F 03040001
&B(2)    SETB  0                 INIT MODE=FULLXM IND          @G381P2F 03050001
&B(3)    SETB  0                 INIT MODE=PRIMARY IND         @G381P2F 03060001
&B(4)    SETB  0                 INIT MODE=LOCAL IND           @G381P2F 03070001
&B(5)    SETB  0                 INIT MODE=GLOBAL IND          @G381P2F 03080001
&R1      SETC  '&WRKREGS(1)'                                   @G381P2F 03090001
&R3      SETC  '&PARMAD(1)'                                    @G381P2F 03100001
&R4      SETC  '&FRRAD(1)'                                     @G381P2F 03110001
&C1      SETC  '&R1'                                               @L5A 03120001
         AIF   ('&REGS' NE 'USE').OKSAVE1                          @L5A 03130001
&C1      SETC  '1'                                                 @L5A 03140001
.OKSAVE1 ANOP                                                      @L5A 03150001
.*                                                    OTHERWISE CHECK   03160001
.*                                                    &OPT FOR A VALID  03170001
.*                                                    OPTION            03180001
         AIF       ('&OPT' EQ 'A' OR '&OPT' EQ 'R').ADREP2     @G381P2F 03190001
         AIF       ('&OPT' EQ 'D' OR '&OPT' EQ 'P').EXPAND2    @G381P2F 03200001
         AIF       ('&OPT' EQ 'F').FLUSH2                      @G381P2F 03210001
         AIF       ('&OPT' EQ 'AF').ADFL2  ADD/FLUSH OPTION    @G381P2F 03220001
         MNOTE     12,'INVALID OPTION &OPT SPECIFIED'                   03230001
.*                                                    MESSAGE STATING   03240001
.*                                                    INVALID OPTION    03250001
         AGO       .END                               STOP EXPANSION    03260001
.*                                                                      03270001
.ADREP2  ANOP                              SYNTAX CHECK FOR ADD         03280001
.*                                         AND REPLACE         @G381P2F 03290001
.*                                                                      03300001
         AIF       ('&FRRAD' EQ '').MSG3              ISSUE MESSAGE IF  03310001
.*                                                    &FRRAD  IS NOT    03320001
.*                                                    SPECIFIED FOR     03330001
.*                                                    THE ADD/REPLACE   03340001
.*                                                    OPTION   @G381P2F 03350001
         AIF       ('&MODE' NE '').MODELP  CHECK MODE          @G381P2F 03360001
&B(1)    SETB      1                      IND HOME DEFAULTED   @G381P2F 03370001
         AGO       .CHKEUT                                              03380001
.MODELP  ANOP                              MODE LOOP WILL SCAN THE      03390001
.*                                         MODE OPTIONS, SYNTAX CHECK   03400001
.*                                         AND INDICATE THE OPTIONS     03410001
.*                                         CHOSEN              @G381P2F 03420001
         AIF       ('&MODE(&I)' NE 'HOME').FULL  IF NOT HOME, CHECK     03430001
.*                                               FOR FULLXM    @G381P2F 03440001
         AIF       (&B(2) OR &B(3)).MSG10  ISSUE MESSAGE IF FULLXM OR   03450001
.*                                         PRIMARY HAS ALSO BEEN        03460001
.*                                         SPECIFIED           @G381P2F 03470001
&B(1)    SETB      1                       IND HOME SPEC       @G381P2F 03480001
         AGO       .INITLP                                     @G381P2F 03490001
.FULL    ANOP                                                  @G381P2F 03500001
         AIF       ('&MODE(&I)' NE 'FULLXM').PRIM IF NOT FULLXM,CHECK   03510001
.*                                               FOR PRIMARY   @G381P2F 03520001
         AIF       (&B(2)).INITLP          IGNORE IF FULLXM WAS         03530001
.*                                         SPECIFIED BEFORE    @G381P2F 03540001
         AIF       (&B(1) OR &B(3)).MSG10  ISSUE MESSAGE IF HOME OR     03550001
.*                                         PRIMARY HAS ALSO BEEN        03560001
.*                                         SPECIFIED           @G381P2F 03570001
&MODFLG  SETA      &MODFLG+8               IND FULLXM          @G381P2F 03580001
&B(2)    SETB      1                       IND FULLXM SPEC     @G381P2F 03590001
         AGO       .INITLP                                     @G381P2F 03600001
.PRIM    ANOP                                                  @G381P2F 03610001
         AIF       ('&MODE(&I)' NE 'PRIMARY').LCL IF NOT PRIMARY, CHK   03620001
.*                                                FOR LOCAL    @G381P2F 03630001
         AIF       (&B(3)).INITLP          IGNORE IF PRIMARY WAS        03640001
.*                                         SPECIFIED BEFORE    @G381P2F 03650001
         AIF       (&B(1) OR &B(2)).MSG10  ISSUE MESSAGE IF HOME OR     03660001
.*                                         FULLXM HAS ALSO BEEN         03670001
.*                                         SPECIFIED           @G381P2F 03680001
&MODFLG  SETA      &MODFLG+4               IND PRIMARY         @G381P2F 03690001
&B(3)    SETB      1                       IND PRIMARY SPEC    @G381P2F 03700001
         AGO       .INITLP                                     @G381P2F 03710001
.LCL     ANOP                                                  @G381P2F 03720001
         AIF       ('&MODE(&I)' NE 'LOCAL').GLB  IF NOT LOCAL, CHECK    03730001
.*                                               FOR GLOBAL    @G381P2F 03740001
         AIF       (&B(4)).INITLP          IGNORE IF LOCAL WAS          03750001
.*                                         SPECIFIED BEFORE    @G381P2F 03760001
&MODFLG  SETA      &MODFLG+2               IND LOCAL           @G381P2F 03770001
&B(4)    SETB      1                       IND LOCAL SPEC      @G381P2F 03780001
         AGO       .INITLP                                     @G381P2F 03790001
.GLB     ANOP                                                  @G381P2F 03800001
         AIF       ('&MODE(&I)' NE 'GLOBAL').MSG10  IF NOT GLOBAL,      03810001
.*                                               ISSUE MESSAGE THAT     03820001
.*                                               MODE IS SPECIFIED      03830001
.*                                               INCORRECTLY   @G381P2F 03840001
         AIF       (&B(5)).INITLP          IGNORE IF GLOBAL WAS         03850001
.*                                         SPECIFIED BEFORE    @G381P2F 03860001
&MODFLG  SETA      &MODFLG+1               IND GLOBAL          @G381P2F 03870001
&B(5)    SETB      1                       IND GLOBAL SPEC     @G381P2F 03880001
.INITLP  ANOP                                                  @G381P2F 03890001
&I       SETA      &I+1                    INCR ELEMENT CTR    @G381P2F 03900001
         AIF       (&I LE &J).MODELP       IF MORE ELEMENTS, LOOP TO    03910001
.*                                         SCAN THE NEXT ONE   @G381P2F 03920001
.*                                                                      03930001
.CHKEUT  ANOP                              CHECK EUT           @G382P2F 03940001
.*                                                                      03950001
         AIF       ('&EUT' NE '' AND '&EUT' NE 'Y' AND                 S03960001
                   '&EUT' NE 'YES').MSG8    ISSUE MESSAGE IF &EUT       03970001
.*                                          IS SPECIFIED INCORRECTLY    03980001
.*                                                             @G382P2F 03990001
         AIF       ('&CANCEL' NE '' AND '&CANCEL' NE 'YES' AND         S04000001
                   '&CANCEL' NE 'NO').MSG17                        @D1A 04010001
.*                                          ISSUE MESSAGE IF CANCEL     04020001
.*                                          IS SPECIFIED INCORRECTLY    04030001
.*                                                                 @D1A 04040001
         AIF       ('&SDWALOC31' NE '' AND '&SDWALOC31' NE 'YES' AND   S04050001
                   '&SDWALOC31' NE 'NO').MSG20   ISSUE MESSAGE IF       04060001
.*                                          SDWALOC31 IS SPECIFIED      04070001
.*                                          INCORRECTLY            @P3A 04080001
         AGO        .EXPAND3                                   @G382P2F 04090001
.*                                                                      04100001
.EXPAND2 ANOP                             SYNTAX CHECK FOR DELETE       04110001
.*                                        AND PURGE            @G381P2F 04120001
.*                                                                      04130001
         AIF   ('&SYSAM64' NE 'YES' OR                                 *04140001
               '&SETFRR_AM64' EQ 'YES').OKDELPURGE2                @L3A 04150001
.* IT IS INTENTIONAL THAT                                               04160001
.* THERE ARE 2 SPACES BETWEEN "IN" AND "AR-MODE"                        04170001
.* AND THAT THERE IS NO SPACE BETWEEN "ISSUE" AND "SYSSTATE"            04180001
.* - IT MAKES THE MNOTE MORE READABLE                                   04190001
         MNOTE 12,'SETFRR &OPT. CANNOT BE ISSUED IN AMODE 64 PRIOR TO Z*04200001
               /OS 1.8 OR IN  AR-MODE. PLEASE CHANGE TO MEET THE REQUIR*04210001
               MENTS AND ISSUESYSSTATE TO MATCH YOUR CHANGED INVOCATION*04220001
                ENVIRONMENT'                                            04230001
         AGO   .END                                                @L3A 04240001
.OKDELPURGE2 ANOP                                                  @L3A 04250001
         AIF       ('&FRRAD' EQ '' AND '&PARMAD' EQ '').WARN2           04260001
.*                                                             @G381P2F 04270001
         MNOTE     *,'FRRAD AND/OR PARMAD SPECIFIED FOR DELETE/PURGE'   04280001
.*                                                             @G381P2F 04290001
         MNOTE     0,'FRRAD AND/OR PARMAD IGNORED-DELETE/PURGE HONORED' 04300001
.*                                                             @G38LP2F 04310001
.WARN2   ANOP                                                  @G381P2F 04320001
         AIF       ('&WRKREGS'(1,1) NE '(' OR N'&WRKREGS NE 2).MSG2     04330001
.*                                       IF &WRKREGS IS SPECIFIED BUT   04340001
.*                                       INVALIDLY, ISSUE ERROR         04350001
.*                                       MESSAGE.              @G382P2F 04360001
&R2    SETC    '&WRKREGS(2)'                                   &G382P2F 04370001
&C2      SETC  '&R2'                                               @L5A 04380001
         AIF   ('&REGS' NE 'USE').OKSAVE2                          @L5A 04390001
&C2      SETC  '0'                                                 @L5A 04400001
.OKSAVE2 ANOP                                                      @L5A 04410001
         AIF       ('&MODE' EQ '').WARN3                       @G381P2F 04420001
         MNOTE     0,'MODE SPECIFIED FOR DELETE/PURGE - MODE IGNORED'   04430001
.*                                                             @G38LP2F 04440001
.WARN3   ANOP                                                  @G381P2F 04450001
         AIF       ('&CANCEL' NE '' AND '&OPT' EQ 'P').MSG18       @D1A 04460001
         AIF       ('&CANCEL' EQ '').LOCCHK                        @P3C 04470001
         MNOTE     0,'CANCEL SPECIFIED FOR DELETE- CANCEL IGNORED' @D1A 04480001
.LOCCHK  ANOP                                                      @P3A 04481001
         AIF       ('&SDWALOC31' NE '' AND '&OPT' EQ 'P').MSG21    @P3A 04482001
         AIF       ('&SDWALOC31' EQ '').EUTCHK                     @NxC 04483001
         MNOTE     0,'SDWALOC31 SPECIFIED FOR DELETE IS IGNORED'   @P3A 04484001
.EUTCHK  AIF       ('&EUT' NE '' AND '&OPT' EQ 'P').MSG11          @D1C 04485001
         AIF       ('&EUT' EQ '').CHKEUT                       @G382P2F 04486001
         MNOTE     0,'EUT SPECIFIED FOR DELETE - EUT IGNORED'  @G38LP2F 04487001
.*                                                                      04488001
.EXPAND3 ANOP                          START CODE GENERATION FOR        04489001
.*                                     ADD, REPLACE, DELETE, AND        04490001
.*                                     PURGE                   @G381P2F 04500001
&LABEL   SETC  '&NAME'        LABEL REQUESTED BY CALLER        @G38LP1S 04510001
.*                                                                1@H1D 04520001
&LABEL   &L    &C1,PSACSTK-PSA(0,0)      ADDR OF CURRENT STACK     @L3A 04530001
         AIF   ('&SYSASCE' EQ 'P').NOLAE3                          @L2A 04540001
         LAE   &C1,0(&C1,0)              SET ALET                  @L2A 04550001
         AIF   ('&C1' NE '1').NOLAE3                               @L5A 04560001
&DIDLAE1 SETC  'YES'                                               @L5A 04570001
.NOLAE3  ANOP                                                           04580001
         AIF       ('&OPT' EQ 'D' OR '&OPT' EQ 'P').CHKMPTY  BRANCH     04590001
.*                                        IF DELETE OR PURGE   @G381P2F 04600001
         AIF       ('&EUT' EQ '').SAVREGS  BRANCH IF NOT EUT   @G381P2F 04610001
         CL    &C1,PSANSTK-PSA(0,0)      IS CURRENT STACK THE           04620001
*                                        NORMAL STACK          @G382P2F 04630001
         JNE   *+8                       NO, BRANCH                @L4C 04640001
         OI    PSAMFLGS-PSA(0),X'80'     IND EUT TYPE FRR      @G381P2F 04650001
         AGO   .SAVREGS                                            @H1C 04660001
.CHKMPTY ANOP                                                  @G382P2F 04670001
         AIF   ('&SYSAM64' EQ 'YES').AM64A                         @L5A 04680001
         &L    &C2,FRRSCURR-FRRS(&C1,0)     ADDR OF CURRENT            *04690001
                                            ELEMENT                @L3A 04700001
         CL    &C2,FRRSEMP-FRRS(&C1,0)      IS THE FRR STACK           *04710001
                                            EMPTY                  @L2C 04720001
         AGO   .AM64B                                              @L5A 04730001
.AM64A   ANOP                                                      @L5A 04740001
         CLC   FRRSCURR-FRRS(4,&C1),FRRSEMP-FRRS(&C1) EMPTY?       @L5C 04750001
.AM64B   ANOP                                                      @L5A 04760001
         JE    A&SYSNDX                 YES, NO NEED TO UPDATE     @L4C 04770001
         AGO        .SAVREGS                                   @G381P2F 04780001
.*                                                                      04790001
.ADFL2   ANOP                          SYNTAX CHECK FOR ADD/FLUSH       04800001
.*                                                             @G381P2F 04810001
.*                                                                      04820001
         AIF       ('&FRRAD' EQ '').MSG3              ISSUE MESSAGE IF  04830001
.*                                                    &FRRAD  IS NOT    04840001
.*                                                    SPECIFIED FOR     04850001
.*                                                    THE ADD/FLUSH     04860001
.*                                                    OPTION   @G381P2F 04870001
         AIF       ('&MODE' EQ '').ADFLEUT                     @G381P2F 04880001
         MNOTE     0,'MODE SPECIFIED FOR ADDFLUSH - MODE IGNORED'       04890001
.*                                                             @G38LP2F 04900001
.ADFLEUT ANOP                                                  @G381P2F 04910001
         AIF       ('&EUT' NE '').MSG11                        @G381P2F 04920001
.ADFLCNL ANOP                                                      @D1A 04930001
         AIF       ('&CANCEL' NE '').MSG18                         @D1A 04940001
.*                                     CANCEL NOT SUPPORTED ON          04950001
.*                                     ADD-FLUSH OPTION            @D1A 04960001
.ADFLLOC ANOP                                                      @D1A 04970001
         AIF       ('&SDWALOC31' NE '').MSG21                      @P3A 04980001
.*                                     SDWALOC31 NOT SUPPORTED ON       04990001
.*                                     ADD-FLUSH OPTION            @P3A 05000001
.*                                                                      05010001
.*                                     START CODE GENERATION FOR        05020001
.*                                     ADDFLUSH                @G381P2F 05030001
.*                                                                      05040001
&NAME    L     &C1,PSANSTK-PSA(0,0)      NORMAL STACK ADDR         @01C 05050001
         AIF ('&SYSASCE' EQ 'P').NOTAR_ADDF                        @01A 05060001
         LAE   &C1,0(&C1,0)                                        @01A 05061001
.NOTAR_ADDF ANOP                                                   @01A 05062001
.*                                                             @G381P2F 05063001
.SAVREGS ANOP                          CONTINUE WITH CODE GENERATION    05064001
.*                                     FOR ADD, REPLACE, ADDFLUSH,      05065001
.*                                     DELETE, AND PURGE       @G381P2F 05066001
.*                                                             @G381P2F 05067001
         AIF   ('&REGS' EQ 'USE').NOSAVE1                          @L5A 05068001
         AIF   ('&SYSASCE' EQ 'P').NOSTAM1                         @L2A 05069001
         STAM  14,3,64(&C1)              SAVE ARS 14-3             @L2A 05070001
         AGO   .NOSTAM1A                                           @L3A 05080001
.NOSTAM1 ANOP                                                      @L2A 05090001
         AIF   ('&SETFRR_AM64' NE 'YES').NOSTMH1                   @L3A 05100001
         STMH  14,3,64(&C1)              SAVE G64H 14-3            @L3A 05110001
.NOSTMH1 ANOP                                                      @L3A 05120001
.NOSTAM1A ANOP                                                     @L3A 05130001
         STM   14,3,16(&C1)              SAVE REGS 14-3        @G381P2F 05140001
.NOSAVE1 ANOP                                                      @L5A 05150001
         AIF        ('&OPT' EQ 'D' OR '&OPT' EQ 'P').DELPUR    @G381P2F 05160001
.*                                                             @G381P2F 05170001
.*                                   IF OPTION IS ADD, REPLACE, OR      05180001
.*                                   ADD/FLUSH, SAVE &FRRAD    @G381P2F 05190001
.*                                                             @G381P2F 05200001
         AIF        ('&FRRAD'(1,1) EQ '(').STFRR2 IF A REG WAS          05210001
.*                                                SPECIFIED    @G381P2F 05220001
         AIF        (T'&FRRAD EQ 'N').MSG4                     @G381P2F 05230001
         L     0,&FRRAD                  LOAD FRR ADDRESS          @L3A 05240001
         AGO         .LDREG1                                   @G381P2F 05250001
.STFRR2  ANOP                                                  @G381P2F 05260001
         AIF        (T'&FRRAD NE 'N').LDREG0  IF NOT SELF-DEFINING,     05270001
.*                                          BRANCH             @G381P2F 05280001
         AIF        (&R4 EQ 0).LDREG1       IF FRR ADDR PASSED IN       05290001
.*                                          REG 0, BRANCH      @G381P2F 05300001
.LDREG0  ANOP                                                  @G381P2F 05310001
         LR    0,&R4                     LOAD FRR ADDRESS      @G381P2F 05320001
.LDREG1  ANOP                                                  @G381P2F 05330001
         AIF        (T'&WRKREGS(1) NE 'N').LDREG1A  IF NOT SELF-        05340001
.*                                          DEFINING, BRANCH   @G381P2F 05350001
         AIF        (&C1 EQ 1).NTRYAD       IF FIRST WORK REG PASSED    05360001
.*                                          IS REG 1, BRANCH   @G381P2F 05370001
.LDREG1A ANOP                                                  @G381P2F 05380001
         AIF   ('&REGS' EQ 'USE').NOSAVE2                          @L5A 05390001
         AIF   ('&SYSASCE' EQ 'P').DOLR                            @L2A 05400001
         LAE   1,0(&C1,0)                COPY WITH ALET            @L2A 05410001
         AGO   .NTRYAD                   SKIP LR                   @L2A 05420001
.DOLR    &LR   1,&C1                     SAVE STACK PTR            @L3A 05430001
         AGO   .NTRYAD                   SKIP LR                   @L2A 05440001
.NOSAVE2 ANOP                                                      @L5A 05450001
         AIF   ('&SYSASCE' EQ 'P').NTRYAD                          @L5A 05460001
         AIF   ('&DIDLAE1' EQ 'YES').NTRYAD                        @L5A 05470001
         LAE   1,0(1,0)                  COPY WITH ALET            @L5A 05480001
.NTRYAD  ANOP                                                  @G381P2F 05490001
.*                                   CALCULATE ENTRY ADDRESS INTO       05500001
.*                                   IEAVTSFR                  @G381P2F 05510001
.*                                                             @G381P2F 05520001
         AIF   ('&CLEAR' EQ 'Y' OR '&CLEAR' EQ 'YES').CLEAR    @G381P2F 05530001
         AIF   ('&OPT' NE 'A').CHKADFL   DEFAULT FOR ADDFLUSH AND       05540001
.*                                       REPLACE IS CLEAR=NO   @G381P2F 05550001
         AIF   ('&CLEAR' EQ 'N' OR '&CLEAR' EQ 'NO').CHKADFL            05560001
.*                                       DEFAULT FOR ADD IS             05570001
.*                                       CLEAR=YES             @G381P2F 05580001
.CLEAR   ANOP                                                  @G381P2F 05590001
&CTRLNK  SETA    &CTRLNK+4               OFFSET FOR CLEAR=YES      @L2C 05600001
.*                                       (IEAVTSFR BR TABLE)   @G381P2F 05610001
.CHKADFL ANOP                                                  @G381P2F 05620001
         AIF   ('&OPT' NE 'AF').CHKEM    CHK IF ADDFLUSH       @G381P2F 05630001
&CTRLNK  SETA  &CTRLNK+48                OFFSET FOR ADDFLUSH   @G381P2F 05640001
         AGO   .BASR                                           @G381P2F 05650001
.CHKEM   ANOP                                                  @G381P2F 05660001
         AIF   ('&CANCEL' NE 'NO').CHKLOC                          @P3C 05670001
&MODFLG  SETA  &MODFLG+64                TURN ON CANCEL=NO BIT     @D1A 05680001
.CHKLOC  ANOP                                                      @P3A 05690001
         AIF   ('&SDWALOC31' EQ 'NO').CHKE                         @P5C 05700001
         AIF   ('&SDWALOC31' EQ 'YES').SETL31                      @P5A 05710001
         AIF   ('&SETFRR_L31_YES' NE '').SETL31                    @P5A 05720001
         AIF   ('&SETFRR_L31_REQ' NE '').MSG22                     @P5A 05730001
         AGO   .CHKE                                               @P5A 05740001
.SETL31  ANOP                                                      @P5A 05750001
&MODFLG  SETA  &MODFLG+32                TURN ON SDWALOC31=YES BIT @D1A 05760001
.CHKE    ANOP                                                      @D1A 05761001
         AIF   ('&EUT' EQ '').CHKMODE    CHECK FOR MODE IF EUT NOT      05762001
.*                                       SPECIFIED             @G381P2F 05763001
&MODFLG  SETA  &MODFLG+128               IND EUT=YES           @G381P2F 05764001
         AIF   ('&SETFRR_AM64' NE 'YES').INDEM  AMODE64 TOO?       @L6A 05765001
&MODFLG  SETA  &MODFLG+16                IND AMODE 64              @L6A 05766001
         AGO   .INDEM                                          @G381P2F 05767001
.CHKMODE ANOP                                                  @G381P2F 05768001
         AIF   ('&SETFRR_AM64' NE 'YES').ECHKAM64                  @L3A 05769001
&MODFLG  SETA  &MODFLG+16                IND AMODE 64              @L3A 05770001
.ECHKAM64 ANOP                                                     @L3A 05780001
         AIF   (&MODFLG EQ 0).OPTS       BRANCH IF NO PARAMETERS        05790001
.*                                       WERE SPECIFIED            @P3C 05800001
.INDEM   ANOP                            ELSE PARAMETERS WERE           05810001
.*                                       SPECIFIED                 @P3C 05820001
         AIF   (&B(2) OR &B(3)).SAVXM    BRANCH IF MODE=FULLXM OR       05830001
.*                                       PRIMARY WAS SPEC      @G381P2F 05840001
&CTRLNK  SETA  &CTRLNK+8                 OFFSET WHEN -NO- CROSS MEMORY  05850001
.*                                       STATUS IS TO BE SAVED          05860001
.*                                       (IEAVTSFR BR TABLE)       @P3C 05870001
         AGO   .INITR2                                         @G381P2F 05880001
.SAVXM   ANOP                                                  @G381P2F 05890001
&CTRLNK  SETA  &CTRLNK+16                OFFSET WHEN CROSS MEMORY       05900001
.*                                       STATUS IS TO BE SAVED          05910001
.*                                       (IEAVTSFR BRANCH TABLE)   @P3C 05920001
.INITR2  ANOP                                                  @G381P2F 05930001
         LA    2,&MODFLG                 IND PARAMETERS CHOSEN @G381P2F 05940001
.OPTS    ANOP                                                  @G381P2F 05950001
         AIF   ('&OPT' NE 'R').BASR      CHK IF REPLACE        @G381P2F 05960001
&CTRLNK  SETA  &CTRLNK+24                OFFSET FOR REPLACE    @G381P2F 05970001
         AGO   .BASR                                           @G381P2F 05980001
.*                                                             @G381P2F 05990001
.DELPUR  ANOP                            DELETE OR PURGE       @G381P2F 06000001
         AIF        (T'&WRKREGS(1) NE 'N').LDREG1D  IF NOT SELF-        06010001
.*                                          DEFINING, BRANCH   @G381P2F 06020001
         AIF        (&C1 EQ 1).BRIFPUR      IF FIRST WORK REG PASSED    06030001
.*                                          IS REG 1, BRANCH   @G381P2F 06040001
.LDREG1D ANOP                                                  @G381P2F 06050001
         AIF   ('&SYSASCE' EQ 'P').DOLR2                           @L2A 06060001
         LAE   1,0(&C1,0)                COPY WITH ALET            @L2A 06070001
         AGO   .BRIFPUR                  SKIP LR                   @L2A 06080001
.DOLR2   ANOP                                                      @L5A 06090001
         AIF   ('&REGS' EQ 'USE').BRIFPUR                          @L5A 06100001
         &LR   1,&C1                     SAVE STACK PTR            @L3A 06110001
.BRIFPUR ANOP                                                  @G381P2F 06120001
         AIF        ('&OPT' EQ 'P').PURGE2   GO TO PURGE       @G381P2F 06130001
.*                                                             @G381P2F 06140001
&CTRLNK  SETA  &CTRLNK+56                OFFSET FOR DELETE         @L2C 06150001
         AGO   .BASR                                           @G381P2F 06160001
.PURGE2  ANOP                                                  @G381P2F 06170001
&CTRLNK  SETA  &CTRLNK+64                OFFSET FOR PURGE          @L2C 06180001
         AGO   .BASR                                           @G381P2F 06190001
.*                                                                      06200001
.FLUSH2  ANOP                           SYNTAX CHECK AND CODE           06210001
.*                                      GENERATION FOR FLUSH   @G381P2F 06220001
.*                                                                      06230001
         AIF       ('&MODE' EQ '').FLEUT                       @G381P2F 06240001
         MNOTE     0,'MODE SPECIFIED FOR FLUSH - MODE IGNORED'          06250001
.*                                                             @G38LP2F 06260001
.FLEUT   ANOP                                                  @G381P2F 06270001
         AIF       ('&EUT' NE '').MSG11                        @G381P2F 06280001
         AIF       ('&CANCEL' NE '').MSG18                         @D1A 06290001
.*                                       CANCEL NOT ALLOWED ON          06300001
.*                                       FLUSH OPTION              @D1A 06310001
         AIF       ('&SDWALOC31' NE '').MSG21                      @P3A 06320001
.*                                       SDWALOC31 NOT ALLOWED ON       06330001
.*                                       FLUSH OPTION              @P3A 06340001
&CTRLNK  SETA  &CTRLNK+68                OFFSET FOR FLUSH          @L2C 06350001
&NAME    L     &C1,PSANSTK-PSA(0,0)      NORMAL STACK ADDR         @01C 06360001
         AIF   ('&SYSASCE' EQ 'P').NOSTAM2                         @L2A 06370001
         LAE   &C1,0(&C1,0)                                        @01A 06380001
         STAM  14,3,64(&C1)              SAVE ARS 14-3             @L2A 06390001
         AGO   .NOSTAM2A                                           @L3A 06400001
.NOSTAM2 ANOP                                                      @L2A 06410001
         AIF   ('&SETFRR_AM64' NE 'YES').NOSTMH2                   @L3A 06420001
         STMH  14,3,64(&C1)              SAVE G64H 14-3            @L3A 06430001
.NOSTMH2 ANOP                                                      @L3A 06440001
.NOSTAM2A ANOP                                                     @L3A 06450001
         STM   14,3,16(&C1)              SAVE REGS 14-3        @G381P2F 06460001
         AIF        (T'&WRKREGS(1) NE 'N').LDREG1E  IF NOT SELF-        06470001
.*                                          DEFINING, BRANCH   @G381P2F 06480001
         AIF        (&C1 EQ 1).BASR         IF FIRST WORK REG PASSED    06490001
.*                                          IS REG 1, BRANCH   @G381P2F 06500001
.LDREG1E ANOP                                                  @G381P2F 06510001
         AIF   ('&REGS' EQ 'USE').NOSAVE3A                         @L5A 06520001
         AIF   ('&SYSASCE' EQ 'P').DOLR3                           @L2A 06530001
         LAE   1,0(&C1,0)                COPY WITH ALET            @L2A 06540001
         AGO   .BASR                     SKIP LR                   @L2A 06550001
.DOLR3   &LR   1,&C1                     SAVE STACK PTR            @L3A 06560001
.*                                                                      06570001
.*                                       BASR TO IEAVTSFR      @G381P2F 06580001
.*                                                                      06590001
         AGO   .NOSAVE3B                                           @L5A 06600001
.NOSAVE3A ANOP                                                     @L5A 06610001
         AIF   ('&SYSASCE' EQ 'P').BASR                            @L5A 06620001
         LAE   1,0(1,0)                  COPY WITH ALET            @L5A 06630001
.NOSAVE3B ANOP                                                     @L5A 06640001
.BASR    ANOP                                                  @G381P2F 06650001
         &LFLCCVT 15,&FLCCVTOFF.(0,0)    LOAD CVT ADDRESS          @L3A 06660001
         L     15,&CVTSFR.(15,0)         ADDR OF IEAVTSFR          @L3A 06670001
         L     15,&CTRLNK.(15,0)         ADDR OF ENTRY POINT       @L2C 06680001
         BASR  14,15                     GO TO IEAVTSFR            @L3A 06690001
         AIF       ('&OPT' EQ 'F').LMREGS                      @G382P2F 06700001
         AIF       ('&OPT' EQ 'P' OR '&OPT' EQ 'D').LMNSS      @G382P2F 06710001
.*                                                             @G381P2F 06720001
.*                                 IF OPTION IS ADD, REPLACE, OR        06730001
.*                                 ADDFLUSH CHECK PARMAD       @G381P2F 06740001
.*                                                             @G381P2F 06750001
         AIF   ('&PARMAD' EQ '').LMREGS  CHECK IF PARMAD       @G381P2F 06760001
         AIF   ('&PARMAD'(1,1) EQ '(').C19                     @G381P2F 06770001
         AIF   (T'&PARMAD EQ 'N').MSG4                         @G381P2F 06780001
         AIF   ('&REGS' EQ 'USE').NOSAVE11A                        @L5A 06790001
         LM    14,3,16(1)                RESTORE REGS          @G381P2F 06800001
         AIF   ('&SYSASCE' EQ 'P').NOARLM1                         @L2A 06810001
         LAE   &C1,0(&C1,0)              GET 0 ALET                @L2A 06820001
         LAM   14,3,64(&C1)              RESTORE ARS 14-3          @L2A 06830001
         AGO   .NOARLM1A                                           @L3A 06840001
.NOARLM1 ANOP                                                      @L2A 06850001
         AIF   ('&SETFRR_AM64' NE 'YES').NOLMH1                    @L3A 06860001
         LMH   14,3,64(&C1)              RESTORE G64H 14-3         @L3A 06870001
.NOLMH1 ANOP                                                       @L3A 06880001
.NOARLM1A ANOP                                                     @L3A 06890001
         L     &C1,FRRSCURR-FRRS(&C1,0)  CURRENT ENTRY             @L3A 06900001
         LA    &C1,FRRSPARM-FRRSENTR(&C1,0) FRR PARM ADDRESS       @L2C 06910001
         AGO   .NOSAVE11B                                          @L5A 06920001
.NOSAVE11A ANOP                                                    @L5A 06930001
         LA    &C1,FRRSPARM-FRRSENTR(3,0) FRR PARM ADDRESS         @L5C 06940001
.NOSAVE11B ANOP                                                    @L5A 06950001
         ST    &C1,&PARMAD               RETURN ADDR TO USER   @G381P2F 06960001
         AGO   .ASST1                                          @G38LP1S 06970001
.C19     ANOP                                                  @G381P2F 06980001
         AIF   (T'&PARMAD(1) NE 'N').LM1ST  IF NOT SELF-DEFINING,       06990001
.*                                          BRANCH             @G381P2F 07000001
         AIF   ('&REGS' EQ 'USE').NOSAVE12A                        @L5A 07010001
         AIF   ('&SYSASCE' NE 'P' AND T'&C1 NE 'N').LM1ST          @L2A 07020001
         AIF   ('&SYSASCE' NE 'P' AND '&R3' EQ '&C1').LM1ST        @L2A 07030001
         AIF   (&R3 GT 2 AND &R3 LT 14).PARM1ST                @G381P2F 07040001
.LM1ST   ANOP                                                  @G381P2F 07050001
         LM    14,3,16(1)                RESTORE REGS          @G381P2F 07060001
         AIF   ('&SYSASCE' EQ 'P').NOARLM2                         @L2A 07070001
         LAE   &C1,0(&C1,0)              GET 0 ALET                @L2A 07080001
         LAM   14,3,64(&C1)              RESTORE ARS 14-3          @L2A 07090001
         AGO   .NOARLM2A                                           @L3A 07100001
.NOARLM2 ANOP                                                      @L2A 07110001
         AIF   ('&SETFRR_AM64' NE 'YES').NOLMH2                    @L3A 07120001
         LMH   14,3,64(&C1)              RESTORE G64H 14-3         @L3A 07130001
.NOLMH2 ANOP                                                       @L3A 07140001
.NOARLM2A ANOP                                                     @L3A 07150001
         &L    &C1,FRRSCURR-FRRS(&C1,0)  CURRENT ENTRY             @L3A 07160001
         &LAA  &R3,FRRSPARM-FRRSENTR(&C1,0) FRR PARM ADDRESS       @L2C 07170001
         AGO   .NOSAVE12B                                          @L5A 07180001
.NOSAVE12A ANOP                                                    @L5A 07190001
         &LAA  &R3,FRRSPARM-FRRSENTR(3,0) FRR PARM ADDRESS         @L5C 07200001
.NOSAVE12B ANOP                                                    @L5A 07210001
         AGO   .ASST1                                          @G38LP1S 07220001
.PARM1ST ANOP                                                  @G381P2F 07230001
         &LAA  &R3,FRRSPARM-FRRSENTR(3,0) ADDR OF PARM AREA        @L2C 07240001
         AIF   (&R3 EQ 3).LMNOT3                               @G381P2F 07250001
.LMREGS  ANOP                                                  @G381P2F 07260001
         AIF   ('&REGS' EQ 'USE').NOSAVE13A                        @L5A 07270001
         LM    14,3,16(1)                RESTORE REGS          @G381P2F 07280001
         AIF   ('&SYSASCE' EQ 'P').NOARLM3                         @L2A 07290001
         LAE   &C1,0(&C1,0)              GET 0 ALET                @L2A 07300001
         LAM   14,3,64(&C1)              RESTORE ARS 14-3          @L2A 07310001
         AGO   .NOARLM3A                                           @L3A 07320001
.NOARLM3 ANOP                                                      @L2A 07330001
         AIF   ('&SETFRR_AM64' NE 'YES').NOLMH3                    @L3A 07340001
         LMH   14,3,64(&C1)              RESTORE G64H 14-3         @L3A 07350001
.NOLMH3 ANOP                                                       @L3A 07360001
.NOARLM3A ANOP                                                     @L3A 07370001
         AGO   .ASST1                                          @G38LP1S 07380001
.NOSAVE13A ANOP                                                    @L5A 07390001
.LMNOT3  ANOP                                                  @G381P2F 07400001
         AIF   ('&REGS' EQ 'USE').NOSAVE14A                        @L5A 07410001
         LM    14,2,16(1)                RESTORE REGS          @G381P2F 07420001
.NOSAVE14A ANOP                                                    @L5A 07430001
         AIF   ('&SYSASCE' EQ 'P').NOARLM4                         @L2A 07440001
.*                                                                      07450001
.* &C1 IS RELOADED IN THIS PATH BECAUSE THE LM WOULD NOT                07460001
.* HAVE RESTORED IT IF &C1 = REG 3.                                     07470001
.*                                                                      07480001
         &L    &C1,PSACSTK-PSA(0,0)      GET STACK ADDRESS         @L3A 07490001
         AIF   ('&REGS' EQ 'USE').NOSAVE15A                        @L5A 07500001
         LAE   &C1,0(&C1,0)              GET 0 ALET                @L2A 07510001
         LAM   14,2,64(&C1)              RESTORE ARS 14-2          @L2A 07520001
.NOSAVE15A ANOP                                                    @L5A 07530001
         AGO   .NOARLM4A                                           @L3A 07540001
.NOARLM4 ANOP                                                      @L2A 07550001
         AIF   ('&SETFRR_AM64' NE 'YES').NOLMH4                    @L3A 07560001
.*                                                                      07570001
.* &C1 IS RELOADED IN THIS PATH BECAUSE THE LM WOULD NOT                07580001
.* HAVE RESTORED IT IF &C1 = REG 3.                                     07590001
.*                                                                      07600001
         AIF   ('&REGS' EQ 'USE').NOSAVE16A                        @L5A 07610001
         &L    &C1,PSACSTK-PSA(0,0)      GET STACK ADDRESS         @L3A 07620001
         LMH   14,2,64(&C1)              RESTORE G64H 14-3         @L3A 07630001
.NOSAVE16A ANOP                                                    @L5A 07640001
.NOLMH4 ANOP                                                       @L3A 07650001
.NOARLM4A ANOP                                                     @L3A 07660001
.ASST1   ANOP  ,                                               @G38LP1S 07670001
         AGO   .END                     THAT'S ALL                 @H1C 07680001
.*                                                               50@H1D 07690001
.*SUMMARY:                                                              07700001
.*  Not AR mode, Not Amode 64, Save:                                    07710001
.*    Delete returns 8 bytes past R14 to turn off PSANSS, 0 otherwise   07720001
.*    So we restore regs, branch, restore regs turn off PSANSS          07730001
.*  Not AR mode, Not Amode 64, NoSave:                                  07740001
.*    Delete returns 8 bytes past R14 to turn off PSANSS, 0 otherwise   07750001
.*    So we NOP, branch, turn off PSANSS                                07760001
.*  AR mode, Not Amode 64, Save:                                        07770001
.*    Delete returns 0 bytes past R14 to turn off PSANSS, 4 otherwise   07780001
.*    So we branch, restore regs, branch, restore regs, turn off PSANSS 07790001
.*  AR mode, Not Amode 64, NoSave:                                      07800001
.*    Delete returns 0 bytes past R14 to turn off PSANSS, 4 otherwise   07810001
.*    So we turn off PSANSS                                             07820001
.*  Not AR mode, Amode 64, Save:                                        07830001
.*    Delete returns 0 bytes past R14 to turn off PSANSS, 4 otherwise   07840001
.*    So we branch, restore regs, branch, restore regs turn off PSANSS  07850001
.*  Not AR mode, Amode 64, NoSave:                                      07860001
.*    Delete returns 0 bytes past R14 to turn off PSANSS, 4 otherwise   07870001
.*    So we turn off PSANSS                                             07880001
.*  AR mode, Amode 64, Save:                                            07890001
.*    Delete returns 0 bytes past R14 to turn off PSANSS, 4 otherwise   07900001
.*    So we branch, restore regs, branch, restore regs, turn off PSANSS 07910001
.*  AR mode, Amode 64, NoSave:                                          07920001
.*    Delete returns 0 bytes past R14 to turn off PSANSS, 4 otherwise   07930001
.*    So we turn off PSANSS                                             07940001
.LMNSS   ANOP                                                  @G381P2F 07950001
         AIF   ('&REGS(1)' NE 'USE').NOTSPECIAL                    @L5A 07960001
         AIF   ('&SYSASCE' NE 'P').ISSPECIAL                       @L5A 07970001
         AIF   ('&SETFRR_AM64' NE 'YES').NOTSPECIAL                @L5A 07980001
.ISSPECIAL ANOP                                                    @L5A 07990001
*                  IEAVTSFR RETURNS HERE WHEN THE PSANSS BIT NEEDS @L2A 08000001
*                  TO BE SET OFF                                   @L2A 08010001
         NI    PSAMFLGS-PSA(0),X'7F'     SET PSANSS FLAG OFF   @G382P2F 08020001
         AGO   .ENDLMNSS                                           @L5A 08030001
.NOTSPECIAL ANOP                                                   @L5A 08040001
         AIF   ('&REGS(1)' EQ 'USE').NOTBRANCHA                    @L5A 08050001
         AIF   ('&SYSASCE' NE 'P').NEEDBRANCHA                     @L5A 08060001
         AIF   ('&SETFRR_AM64' NE 'YES').NOTBRANCHA                @L5A 08070001
.NEEDBRANCHA ANOP                                                  @L5A 08080001
*                  IEAVTSFR RETURNS HERE WHEN THE PSANSS BIT NEEDS @L2A 08090001
*                  TO BE SET OFF                                   @L2A 08100001
         J     B&SYSNDX                  TURN OFF PSANSS           @L4C 08110001
.NOTBRANCHA ANOP                                                   @L5A 08120001
         AIF   ('&REGS(1)' EQ 'USE').NOSAVEDEL                     @L5A 08130001
         LM    14,3,16(1)                RESTORE REGS          @G382P2F 08140001
         AIF   ('&SYSASCE' EQ 'P').NOARLM5                         @L2A 08150001
         LAE   &C1,0(&C1,0)              GET 0 ALET                @L2A 08160001
         LAM   14,3,64(&C1)              RESTORE ARS 14-3          @L2A 08170001
         AGO   .NOARLM5A                                           @L3A 08180001
.NOARLM5 ANOP                                                      @L2A 08190001
         AIF   ('&SETFRR_AM64' NE 'YES').NOLMH5                    @L3A 08200001
         LMH   14,3,64(&C1)              RESTORE G64H 14-3         @L3A 08210001
.NOLMH5 ANOP                                                       @L3A 08220001
.NOARLM5A ANOP                                                     @L3A 08230001
         AGO   .ENDSAVEDEL                                         @L5A 08240001
.NOSAVEDEL ANOP                                                    @L5A 08250001
         AIF   ('&SYSASCE' NE 'P').NONOP                           @L2A 08260001
         AIF   ('&SETFRR_AM64' EQ 'YES').NONOP                     @L2A 08270001
         NOP   0                                                   @L5A 08280001
.NONOP   ANOP                                                      @L5A 08290001
.ENDSAVEDEL ANOP                                                   @L5A 08300001
         J     A&SYSNDX                                            @L4C 08310001
B&SYSNDX DS    0H                                                  @L4C 08320001
         AIF   ('&REGS(1)' EQ 'USE').NOSAVEDEL2                    @L5A 08330001
         LM    14,3,16(1)                RESTORE REGS          @G382P2F 08340001
         AIF   ('&SYSASCE' EQ 'P').NOARLM6                         @L2A 08350001
         LAE   &C1,0(&C1,0)              GET 0 ALET                @L2A 08360001
         LAM   14,3,64(&C1)              RESTORE ARS 14-3          @L2A 08370001
         AGO   .NOARLM6A                                           @L3A 08380001
.NOARLM6 ANOP                                                      @L2A 08390001
         AIF   ('&SETFRR_AM64' NE 'YES').NOLMH6                    @L3A 08400001
         LMH   14,3,64(&C1)              RESTORE G64H 14-3         @L3A 08410001
.NOLMH6 ANOP                                                       @L3A 08420001
.NOARLM6A ANOP                                                     @L3A 08430001
.NOSAVEDEL2 ANOP                                                   @L5A 08440001
         NI    PSAMFLGS-PSA(0),X'7F'     SET PSANSS FLAG OFF   @G382P2F 08450001
.ENDLMNSS ANOP                                                     @L5A 08460001
A&SYSNDX DS    0H                        END OF EXPANSION          @L2A 08470001
         AGO   .END                                            @G382P2F 08480001
.MSG1    MNOTE     12,'WORK REGISTERS NOT SPECIFIED'                    08490001
         AGO       .END                                                 08500001
.MSG2    MNOTE     8,'WORK REGISTERS SPECIFIED INCORRECTLY'             08510001
         MNOTE     8,'SPECIFY AS FOLLOWS - WRKREGS=(REGISTER,REGISTER)' 08520001
         AGO       .END                                                 08530001
.MSG3    MNOTE     8,'FRR ADDRESS NOT SPECIFIED FOR ADD/REPLACE'        08540001
         AGO        .END                                                08550001
.MSG4    MNOTE  8,'ADDRESS SPECIFIED FOR FRRAD/PARMAD IS SELF-DEFINING' 08560001
         AGO       .END                                        @G381P2F 08570001
.MSG5    MNOTE 8,'ADD OR REPLACE NOT ALLOWED WITH INLINE=YES'      @P1A 08580001
         AGO   .END                                                @P1A 08590001
.MSG6    MNOTE     8,'EUT NOT ALLOWED WITH INLINE=YES'         @G381P2F 08600001
         AGO       .END                                        @G381P2F 08610001
.MSG7    MNOTE    8,'MODE SPECIFIED INCORRECTLY WITH INLINE'   @G381P2F 08620001
         AGO        .END                                       @G381P2F 08630001
.MSG8    MNOTE     8,'EUT SPECIFIED INCORRECTLY'               @G381P2F 08640001
         AGO       .END                                        @G381P2F 08650001
.MSG9    MNOTE     8,'INLINE SPECIFIED INCORRECTLY'            @G381P2F 08660001
         AGO       .END                                        @G381P2F 08670001
.MSG10   MNOTE    12,'INVALID OPTION IN MODE SUBSTRING ELEMENT &I'      08680001
.*                                                             @G381P2F 08690001
         AGO        .END                                       @G381P2F 08700001
.MSG11   MNOTE     8,'EUT NOT ALLOWED WITH PURGE/FLUSH/ADDFLUSH'        08710001
.*                                                             @G381P2F 08720001
         AGO       .END                                        @ZM50139 08730001
.MSG12   MNOTE    12,'INVALID PARM &OPT2, PARENTHESIS MAY BE MISSING'   08740001
.*                                                             @ZM50139 08750001
         AGO   .END                                            @G38LP1S 08760001
.MSG13   MNOTE 8,'ADD/FLUSH NOT ALLOWED WITH INLINE=YES'           @P1A 08770001
         AGO   .END                                                @P1A 08780001
.MSG14   MNOTE 12,'INVALID PARAMETER &AMODE'                   @G860P1F 08790001
         AGO   .END                                            @G860P1F 08800001
.MSG16   MNOTE 8,'CANCEL NOT ALLOWED WITH INLINE=YES'              @D1A 08810001
         AGO   .END                                                @D1A 08820001
.MSG17   MNOTE 8,'CANCEL SPECIFIED INCORRECTLY'                    @D1A 08830001
         AGO   .END                                                @D1A 08840001
.MSG18   MNOTE 8,'CANCEL NOT ALLOWED WITH PURGE/FLUSH/ADDFLUSH'    @D1A 08850001
         AGO   .END                                                @D1A 08860001
.MSG19   MNOTE     8,'REGS OPTION IS INCORRECT'                    @L5A 08870001
         AGO       .END                                            @L5A 08880001
.MSG20   MNOTE 8,'SDWALOC31 SPECIFIED INCORRECTLY'                 @P3A 08890001
         AGO   .END                                                @P3A 08900001
.MSG21   MNOTE 8,'SDWALOC31 NOT ALLOWED WITH PURGE/FLUSH/ADDFLUSH' @P3A 08910001
         AGO   .END                                                @P3A 08920001
.MSG22   MNOTE 8,'SDWALOC31 IS REQUIRED BUT IS NOT SPECIFIED'      @P5A 08930001
         AGO   .END                                                @P5A 08940001
.S370    ANOP                                                  @G860P1C 08950001
&NAME    SETFRR7   &OPT,FRRAD=&FRRAD,PARMAD=&PARMAD,WRKREGS=&WRKREGS,  C08960001
               RELATED=&RELATED,CLEAR=&CLEAR,MODE=&MODE,EUT=&EUT,      C08970001
               INLINE=&INLINE,ASSIST=&ASSIST,&OPT2             @G860P1C 08980001
.END     MEND                                                           08990001
* END OF BAL SETFRR MACRO                                            */ 09000001
* SETFRR: /***********************************************************/ 09010001
*         /* INVOKE ?SETFRRP - PL/S VERSION OF THE SETFRR MACRO      */ 09020001
*         /***********************************************************/ 09030001
* MACRO                            /* ?SETFRR INVOKES ?SETFRRP       */ 09040001
*   KEYS(FRRAD,                    /* FRR ADDRESS                    */ 09050001
*        PARMAD,                   /* PARAMETER AREA ADDRESS         */ 09060001
*        MODE,                     /* MODE OPERAND(S)                */ 09070001
*        CLEAR,                    /* CLEAR OPERAND                  */ 09080001
*        EUT,                      /* EUT OPERAND                    */ 09090001
*        CANCEL,                   /* CANCEL OPERAND             @D1A*/ 09100001
*        RELATED,                  /* USED FOR DOCUMENTATION         */ 09110001
*        AMODE,                    /* ADDRESSING MODE - NOT USED     */ 09120001
*        WRKREGS,                  /* WORK REGS     - NOT NEEDED     */ 09130001
*        ASSIST,                   /* ASSIST        - NOT USED       */ 09140001
*        FRRAMODE64,               /* FRRAMODE64(NO ! YES)       @L5A*/ 09150001
*        REGS,                     /* REGS(SAVE ! USE)           @L5A*/ 09160001
*        UNRSTDREG14,              /* Names the reg name for R14        09170001
*                                     that is to be UNRSTD before the   09180001
*                                     call and RSTD after the call      09190001
*                                                                @L7A*/ 09200001
*        SDWALOC31,                /* Tolerate an SDWA above the        09201001
*                                     16M line                   @P3A*/ 09202001
*        INLINE);                  /* INLINE EXPANSION NOT USED      */ 09203001
* ANS( '?' !! MACLABEL !! 'SETFRRP ' !! MACLIST !! MACKEYS !! ';' );/*  09204001
*                                     INVOKE ?SETFRRP            @L1A*/ 09205001
*%END SETFRR;                                                           09206001

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IOSODS                                -02/26/19-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  IOS Offline Device Support                    * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2003, 2015                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77A0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      IOSODS provides an authorized user the ability to access       * 00002100
*      devices that are offline to the system and make the following  * 00002200
*      system and device dependent features active:                   * 00002300
*                                                                     * 00002400
*                                                                     * 00002500
*      o   Dynamic pathing                                            * 00002600
*                                                                     * 00002700
*      o   Configuration validation                                   * 00002800
*                                                                     * 00002900
*      o   Reset event protection enabled                             * 00003000
*                                                                     * 00003100
*      o   Parallel Access Volumes enabled                            * 00003200
*                                                                     * 00003300
*      o   WLM PAV-alias Tuning  **FUNCTION CURRENTLY DISABLED**      * 00003400
*                                                                     * 00003500
*                                                                     * 00003600
*                                                                     * 00003700
*      Processing is for only a single input device.                  * 00003800
*                                                                     * 00003900
*01* ENVIRONMENT:                                                     * 00004000
*                                                                     * 00004100
*                                                                     * 00004200
*      Dispatchable unit mode: Task mode.                             * 00004300
*                                                                     * 00004400
*      Minimum authorization: Supervisor State and key 0.             * 00004500
*                                                                     * 00004600
*      AMODE:            24- or 31-bit.                               * 00004700
*                                                                     * 00004800
*      ASC mode:         Primary.                                     * 00004900
*                                                                     * 00005000
*      Interrupt status: Enabled for I/O and external interrupts.     * 00005100
*                                                                     * 00005200
*01* RESTRICTIONS:                                                    * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*    o   The caller may not hold any locks.                           * 00005600
*                                                                     * 00005700
*    o   The caller is required to pin the UCB for the device before  * 00005800
*        invoking the IOSODS macro service.  Pinning the UCB will     * 00005900
*        insure that the proper identification of the user of the     * 00006000
*        device will be displayed if the installation should try to   * 00006100
*        dynamically delete it.                                       * 00006200
*                                                                     * 00006300
*    o   Issuers of the IOSODS macro service must provide recovery    * 00006400
*        and resource termination managers to insure that the device  * 00006500
*        is freed for use by other applications in case of an         * 00006600
*        unexpected failure or cancellation of the address space.     * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00007300
*                                                                     * 00007400
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00007500
*                                                                     * 00007600
*01* SYNTAX:                                                          * 00007700
*                                                                     * 00007800
*Ýxlabel¨  IOSODS  Ð  ON                                              * 00007900
*                  !    Ý,BYPONLINEFENCE¨                             * 00008000
*                  !   ÐÝ,BYPALIAS=NO¨                                * 00008100
*                  !   ¿Ý,BYPALIAS=YES¨                               * 00008200
*                  !    Ý,WLMPAVSUSPEND¨                              * 00008300
*                  !    Ý,UNCOND¨                                     * 00008400
*                  ¿ ,OFF                                             * 00008500
*                       Ý,WLMPAVRESTORE¨                              * 00008600
*                  Ð ,DEVN=xdevn                                      * 00008700
*                  !    Ý,SCHSET=»xschset!0º¨                         * 00008800
*                  Ô ,DEVNCHAR=xdevnchar                              * 00008900
*                  !    Ý,SCHSET=»xschset!0º¨                         * 00009000
*                  ¿ ,LDEVNCHAR=xldevnchar                            * 00009100
*                   Ý,RETCODE=xretcode¨                               * 00009200
*                   Ý,RSNCODE=xrsncode¨                               * 00009300
*                   Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨           * 00009400
*                  ÐÝ,MF=S¨                                           * 00009500
*                  ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                    * 00009600
*                  ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                      * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*      Where:                                                         * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*      Ýxlabel¨                                                       * 00010300
*          is an optional symbol, starting in column 1, that is the   * 00010400
*          name on the IOSODS macro invocation.  The name must        * 00010500
*          conform to the rules for an ordinary assembler language    * 00010600
*          symbol.                                                    * 00010700
*          DEFAULT: No name.                                          * 00010800
*                                                                     * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*                                                                     * 00011200
*      The following is a set of mutually exclusive keys.  This set   * 00011300
*      is required; only one key must be specified.                   * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*      ON                                                             * 00011700
*          KEYWORD that indicates the input device number is to be    * 00011800
*          marked as offline and in use by a system component.        * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*          ÝBYPONLINEFENCE¨                                           * 00012200
*              KEYWORD that indicates that the device should be       * 00012300
*              allowed to have dynamic pathing established even if    * 00012400
*              the device is fenced for vary establishing dynamic     * 00012500
*              pathing.  When this keyword is specified, z/OS I/O     * 00012600
*              operations will be permitted to bypass a fence, if     * 00012700
*              established, that would have prevented the device from * 00012800
*              having dynamic pathing established.  Invokers of this  * 00012900
*              service should understand why a device may have been   * 00013000
*              fenced for dynamic pathing, and understand why it is   * 00013100
*              okay to bypass this type of fence before using this    * 00013200
*              keyword.                                               * 00013300
*              DEFAULT: NONE                                          * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*          ÝBYPALIAS=»NO!YESº¨                                        * 00013900
*              is an optional keyword input that indicates whether    * 00014000
*              the device initialization should include alias         * 00014100
*              initialization.                                        * 00014200
*              DEFAULT: NO                                            * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*              ÝBYPALIAS=NO¨                                          * 00014600
*                  Alias initialization will be performed if          * 00014700
*                  necessary.                                         * 00014800
*                                                                     * 00014900
*              ÝBYPALIAS=YES¨                                         * 00015000
*                  Alias initialization will not be performed.        * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*          ÝWLMPAVSUSPEND¨                                            * 00015800
*              KEYWORD that indicates that the Work Load Manager      * 00015900
*              dynamic alias tuning capability for the device (if     * 00016000
*              applicable) will be suspended.  Note that it is up to  * 00016100
*              the user to restore this capability via an IOSODS OFF  * 00016200
*              request with the WLMPavRestore keyword specified.      * 00016300
*                  ** THIS FUNCTION IS CURRENTLY DISABLED. **         * 00016400
*              DEFAULT: NONE                                          * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*          ÝUNCOND¨                                                   * 00017000
*              KEYWORD that indicates to unconditionally activate     * 00017100
*              some of the system and device dependent features.      * 00017200
*              Initialization processing will be requested even when  * 00017300
*              the device is already in use by a system component     * 00017400
*              (for example, a prior IOSODS ON function).  When       * 00017500
*              UNCOND is used in conjunction with BYPALIAS(NO), the   * 00017600
*              parallel access volumes will be initialized.           * 00017700
*              DEFAULT: NONE                                          * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*      OFF                                                            * 00018200
*          KEYWORD that indicates the input device number is no       * 00018300
*          longer to be marked as offline and in use by a system      * 00018400
*          component.                                                 * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*          ÝWLMPAVRESTORE¨                                            * 00018800
*              KEYWORD that indicates that the Work Load Manager      * 00018900
*              dynamic alias tuning capability for the device (if     * 00019000
*              applicable) will be restored.  Note that this function * 00019100
*              will restore the WLM dynamic alias tuning capability   * 00019200
*              only in the case where a prior IOSODS ON request was   * 00019300
*              done that specified the WLMPavSuspend keyword.         * 00019400
*                  ** THIS FUNCTION IS CURRENTLY DISABLED. **         * 00019500
*              DEFAULT: NONE                                          * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*      End of a set of mutually exclusive required keys.              * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*      The following is a set of mutually exclusive keys.  This set   * 00020600
*      is required; only one key must be specified.                   * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*      DEVN=xdevn                                                     * 00021000
*          belongs to a set of mutually exclusive keys. It is the     * 00021100
*          name (RS-type), or address in register (2)-(12), of a      * 00021200
*          halfword input which specifies the device number in binary * 00021300
*          of the device that is to be operated on.                   * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*          ÝSCHSET=»xschset!0º¨                                       * 00021700
*              is the name (RS-type), or address in register          * 00021800
*              (2)-(12), of an optional byte input which specifies    * 00021900
*              the subchannel set in binary of the input device.      * 00022000
*              DEFAULT: 0.                                            * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*      DEVNCHAR=xdevnchar                                             * 00022500
*          belongs to a set of mutually exclusive keys. It is the     * 00022600
*          name (RS-type), or address in register (2)-(12), of a 4    * 00022700
*          character input which specifies the device number in       * 00022800
*          EBCDIC of the device that is to be operated on.            * 00022900
*                                                                     * 00023000
*          NOTE:  A three digit device number can either be           * 00023100
*          represented as ' ddd' or '0ddd'.                           * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*          ÝSCHSET=»xschset!0º¨                                       * 00023500
*              is the name (RS-type), or address in register          * 00023600
*              (2)-(12), of an optional byte input which specifies    * 00023700
*              the subchannel set in binary of the input device.      * 00023800
*              DEFAULT: 0.                                            * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*      LDEVNCHAR=xldevnchar                                           * 00024300
*          belongs to a set of mutually exclusive keys. It is the     * 00024400
*          name (RS-type), or address in register (2)-(12), of a 5    * 00024500
*          character input which specifies the logical device number  * 00024600
*          in EBCDIC of the device that is to be operated on.         * 00024700
*                                                                     * 00024800
*          NOTE:  A logical device number is represented by the       * 00024900
*          1-digit subchannel set id followed by the 4-digit device   * 00025000
*          number: 'sdddd'.                                           * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*      End of a set of mutually exclusive required keys.              * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*      ÝRETCODE=xretcode¨                                             * 00025900
*          is the name (RS-type) of an optional fullword output       * 00026000
*          variable, or register (2)-(12) or (15), into which the     * 00026100
*          return code is to be copied from GPR 15.  If you specify   * 00026200
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00026300
*          the value will be left in GPR 15.                          * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*      ÝRSNCODE=xrsncode¨                                             * 00026900
*          is the name (RS-type) of an optional fullword output       * 00027000
*          variable into which the reason code is to be copied from   * 00027100
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00027200
*          R0 (within or without parentheses), the value will be left * 00027300
*          in GPR 0.                                                  * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00027900
*          is an optional byte input decimal value in the "1-1" range * 00028000
*          that specifies the macro version.  PLISTVER is the only    * 00028100
*          key allowed on the list form of MF and determines which    * 00028200
*          parameter list is generated.  Note that MAX may be         * 00028300
*          specified instead of a number, and the parameter list will * 00028400
*          be of the largest size currently supported. This size may  * 00028500
*          grow from release to release (thus possibly affecting the  * 00028600
*          amount of storage needed by your program).  If your        * 00028700
*          program can tolerate this, IBM recommends that you always  * 00028800
*          specify MAX when creating the list form parameter list as  * 00028900
*          that will ensure that the list form parameter list is      * 00029000
*          always long enough to hold whatever parameters might be    * 00029100
*          specified on the execute form.                             * 00029200
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00029300
*          default is the lowest version which allows all of the      * 00029400
*          parameters specified on the invocation to be processed.    * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*      ÝMF=»S!L!Eº¨                                                   * 00030000
*          is an optional keyword input which specifies the macro     * 00030100
*          form.                                                      * 00030200
*          DEFAULT: S                                                 * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*          ÝMF=S¨                                                     * 00030600
*              specifies the standard form of the macro.  The "S"     * 00030700
*              form generates code to put the parameters into an      * 00030800
*              in-line parameter list and invoke the desired service. * 00030900
*              Full checking for required macro keys is done along    * 00031000
*              with supplying defaults for omitted optional           * 00031100
*              parameters.                                            * 00031200
*                                                                     * 00031300
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00031400
*              specifies the list form of the macro.  The "L" form    * 00031500
*              defines an area to be used for the parameter list.     * 00031600
*              Only the PLISTVER key may be specified on the          * 00031700
*              invocation.  All other macro parameters are flagged as * 00031800
*              errors.  If PLISTVER is not specified, the original    * 00031900
*              parameter list definition is used.                     * 00032000
*                                                                     * 00032100
*            ,xmfctrl                                                 * 00032200
*              is a required input.  It is the name of a storage area * 00032300
*              for the parameter list.                                * 00032400
*                                                                     * 00032500
*            »,xmfattr!0Dº                                            * 00032600
*              is an optional 60 character input string that varies   * 00032700
*              from 1 to 60 characters. Use it to force boundary      * 00032800
*              alignment of the parameter list. Use only 0F or 0D.    * 00032900
*              DEFAULT: 0D which forces the parameter list to a       * 00033000
*              doubleword boundary.                                   * 00033100
*                                                                     * 00033200
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00033300
*              specifies the execute form of the macro.  The "E" form * 00033400
*              generates code to put the parameters into the          * 00033500
*              parameter list specified by xmfctrl and provides full  * 00033600
*              syntax checking with default setting.                  * 00033700
*                                                                     * 00033800
*            ,xmfctrl                                                 * 00033900
*              is a required input.  It is the name (RS-type), or     * 00034000
*              address in register (1)-(12), of a storage area for    * 00034100
*              the parameter list.                                    * 00034200
*                                                                     * 00034300
*            »,COMPLETEº                                              * 00034400
*              is an optional keyword input which specifies the       * 00034500
*              degree of macro parameter syntax checking.             * 00034600
*              DEFAULT: COMPLETE                                      * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*              COMPLETE                                               * 00035000
*                  Checking for required macro keys is done and       * 00035100
*                  defaults are supplied for omitted optional         * 00035200
*                  parameters.                                        * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*01* RETURN CODES:                                                    * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                 The following is a list of return and reason codes: * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                 X'00'     The requested function executed           * 00036700
*                           successfully.                             * 00036800
*                                                                     * 00036900
*                 X'08'     The requested function failed.            * 00037000
*                                                                     * 00037100
*                           Reason codes                              * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                           X'01'     The input device number was not * 00037500
*                                     found.                          * 00037600
*                                                                     * 00037700
*                           X'02'     A request to allocate an        * 00037800
*                                     offline device was made, but it * 00037900
*                                     is already online or in use by  * 00038000
*                                     a system component ("ON"        * 00038100
*                                     function).                      * 00038200
*                                                                     * 00038300
*                           X'03'     A request to unallocate a       * 00038400
*                                     device was made, but the device * 00038500
*                                     is not currently in use ("OFF"  * 00038600
*                                     function).                      * 00038700
*                                                                     * 00038800
*                           X'04'     IOS Path Validation failed      * 00038900
*                                     ("ON" function).                * 00039000
*                                                                     * 00039100
*                           X'05'     IOS Dynamic Pathing function    * 00039200
*                                     failed  ("OFF" function).       * 00039300
*                                                                     * 00039400
*                           X'06'     The Allocation service to set   * 00039500
*                                     UCBNALOC failed ("ON"           * 00039600
*                                     function).                      * 00039700
*                                                                     * 00039800
*                           X'07'     The input device number         * 00039900
*                                     specified by DEVNCHAR or        * 00040000
*                                     LDEVNCHAR is not valid.         * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*                 X'20'     An unexpected error occurred.  The        * 00040500
*                           recovery routine recovered and returned   * 00040600
*                           control to the caller.                    * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*01* REASON CODES:                                                    * 00041300
*                                                                     * 00041400
*       See return codes section.                                     * 00041500
*                                                                     * 00041600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00041700
*                                                                     * 00041800
*02*   PROCESSOR:  ASSEM                                              * 00041900
*                                                                     * 00042000
*01* COMPONENT:  SC1C3                                                * 00042100
*                                                                     * 00042200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00042300
*                                                                     * 00042400
*01* MACRO USAGE NOTES:                                               * 00042500
*                                                                     * 00042600
*                                                                     * 00042700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00042800
*        global macro variable.  Any value other than 'NO' will       * 00042900
*        result in the macro expansion being printed.  The default is * 00043000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00043100
*        variable should be set.                                      * 00043200
*                                                                     * 00043300
*                    GBLC &ZPRINT                                     * 00043400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00043500
*                                                                     * 00043600
*                                                                     * 00043700
*    2.  All  keys currently contained in the IOSODS macro correspond * 00043800
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00043900
*        MAX.                                                         * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*01* CHANGE ACTIVITY:                                                 * 00044500
*                                                                     * 00044600
*   Flag LineItem  FMID    Date   ID    Comment                       * 00044700
*                                                                     * 00044800
*    $L0=LANFR    HBB7708 021115 PDLZ:  LAN Free Backup Enhancements  * 00044900
*    $L1=SCHSET2  HBB7750 080331 PDB7:  Subchannel Sets for special   * 00045000
*                                         devices.  Changes flagged   * 00045100
*                                         by OA24142                  * 00045200
*    $A6=OA24142  HBB7740 080831 PDB7:  Exploitation of Subchannel    * 00045300
*                                         Sets for special devices.   * 00045400
*                                         Add DEVNCHAR, LDEVNCHAR,    * 00045500
*                                         and SCHSET keywords.        * 00045600
*    $01=OA42773  HBB7770 140331 PDSC:  Bypass Vary Online Fence      * 00045700
*    $02=OA50322  HBB7790 160501 PDSC:  Bypass Alias Initialization   * 00045800
*    $03=OA56125  HBB77A0 190331 PDB7:  Add optional UNCOND option    * 00045900
*                                         for ON processing           * 00046000
*    $P1=PYN1072  HBB7708 030515 PDNO:  No code changes.  Reshipped   * 00046100
*                                         to correct copyright        * 00046200
*                                         statement.                  * 00046300
*    $AA=OA49090  HBB7790 160501 PDSC:  SuperPAV - Reship for OA50322 * 00046400
****** END OF SPECIFICATIONS *****************************************/ 00046500
*/********************************************************************* 00046600
         MACRO                                                          00046700
&XLABEL  IOSODS &BYPALIAS=,&DEVN=,&SCHSET=,&DEVNCHAR=,&LDEVNCHAR=,     *00046800
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00046900
.*                                                                      00047000
*                    MACDATE -02/26/19-<1>                              00047100
.*                                                                      00047200
.*******************************************************************    00047300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00047400
.*******************************************************************    00047500
                    GBLC  &ZPRINT     YES=PRINT NO=NO PRINT             00047600
                    GBLC  &ZTEST      YES=TEST NO=NO TEST               00047700
                    GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX       00047800
.*                                                                      00047900
                    GBLC  &ZIOSODS    YES=MACRO USED AT LEAST ONCE      00048000
.*******************************************************************    00048100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00048200
.*******************************************************************    00048300
                    LCLC  &ZMS        ERROR MESSAGE WORK AREA           00048400
                    LCLC  &ZCNDX      SYSNDX CHARACTERS                 00048500
                    LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED        00048600
                    LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR       00048700
                    LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE       00048800
                    LCLA  &ZAWRK      USED AS A WORK AREA               00048900
                    LCLA  &ZASIZ      USED FOR SIZE OF VALUE            00049000
                    LCLA  &ZN         NUMERIC WORK VARIABLE             00049100
                    LCLC  &ZC         CHARACTER WORK VARIABLE           00049200
                    LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE       00049300
                    LCLA  &ZTLA       VALUE TOO LONG VARIABLE           00049400
                    LCLC  &ZMAC_G     "G" or null                       00049500
&ZMAC_G             SETC  ''                                            00049600
                    LCLC  &ZMAC_LR                                      00049700
&ZMAC_LR            SETC  'LR'                                          00049800
                    LCLC  &ZMAC_L                                       00049900
&ZMAC_L             SETC  'L'                                           00050000
                    LCLC  &ZMAC_ST                                      00050100
&ZMAC_ST            SETC  'ST'                                          00050200
                    LCLC  &ZMAC_LLGT                                    00050300
&ZMAC_LLGT          SETC  'L'                                           00050400
                    LCLC  &ZMAC_LGR                                     00050500
&ZMAC_LGR           SETC  'LR'                                          00050600
                    LCLC  &ZMAC_LG                                      00050700
&ZMAC_LG            SETC  'L'                                           00050800
                    LCLC  &ZMAC_STG                                     00050900
&ZMAC_STG           SETC  'ST'                                          00051000
                    LCLA  &ZMACRET    MACRO RETURN CODE                 00051100
&ZMACRET            SETA  0           ASSUME NO ERRORS                  00051200
.*                                                                      00051300
                    LCLC  &ZCSYSLIST(255)       NONXKEY, POS ARRAY      00051400
                    LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()        00051500
                    LCLA  &ZPLLEN     PARAMETER LIST LENGTH             00051600
                    LCLC  &ZENDBASEPL           End of base PL          00051700
                    LCLA  &ZPLWORKA   PARAMETER LIST LENGTH             00051800
.*******************************************************************    00051900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00052000
.*******************************************************************    00052100
                    LCLA  &ZI         INDEX FOR ARRAY                   00052200
                    LCLA  &ZJ         INDEX FOR PARMS                   00052300
                    LCLA  &ZK         INDEX FOR PARSE                   00052400
                    LCLA  &ZLO        LOW RANGE VALUE                   00052500
                    LCLA  &ZHI        HIGH RANGE VALUE                  00052600
                    LCLC  &ZW         WORK AREA FOR PARM                00052700
.********************************************************************   00052800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00052900
.********************************************************************   00053000
                    GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL           00053100
                    GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE    00053200
                    GBLA  &SYSALVL    SYSSTATE ARCHLVL                  00053300
                    GBLC  &SYSAM64    SYSSTATE AMODE64                  00053400
.*                                                                      00053500
                    AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED    00053600
                    AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED     00053700
                    SPLEVEL  TEST                                       00053800
.ZSYS2              ANOP  ,                                             00053900
                    AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1         00054000
                    AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1         00054100
                    SYSSTATE TEST                                       00054200
                    AGO   .ZSYS4                                        00054300
.ZSYS3              ANOP  ,                                             00054400
&SYSASCE            SETC  'P'         ASSUME SYSSTATE PRIMARY           00054500
.ZSYS4              ANOP  ,                                             00054600
                    AIF   ('&SYSAM64' NE 'YES').ZSYSN64                 00054700
&ZMAC_LLGT          SETC 'LLGT'                                         00054800
&ZMAC_LGR           SETC 'LGR'                                          00054900
&ZMAC_LG            SETC 'LG'                                           00055000
&ZMAC_STG           SETC 'STG'                                          00055100
.ZSYSN64            ANOP  ,                                             00055200
.*******************************************************************    00055300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00055400
.*******************************************************************    00055500
                    LCLC  &XSERVICE   ++ VALUE                          00055600
                    LCLC  &XON        ++ VALUE                          00055700
                    LCLC  &XBYPONLINEFENCE      ++ VALUE                00055800
                    LCLC  &XBYPALIAS  ++ VALUE                          00055900
                    LCLC  &XWLMPAVSUSPEND       ++ VALUE                00056000
                    LCLC  &XUNCOND    ++ VALUE                          00056100
                    LCLC  &XOFF       ++ VALUE                          00056200
                    LCLC  &XWLMPAVRESTORE       ++ VALUE                00056300
                    LCLC  &XDEVVAR1   ++ NAME                           00056400
                    LCLC  &XDEVN      ++ NAME                           00056500
                    LCLC  &XSCHSET    ++ NAME                           00056600
                    LCLC  &XDEVNCHAR  ++ NAME                           00056700
                    LCLC  &XLDEVNCHAR           ++ NAME                 00056800
                    LCLC  &XRETCODE   ++ NAME                           00056900
                    LCLC  &XRSNCODE   ++ NAME                           00057000
                    LCLA  &XPLISTVER  ++ VALUE                          00057100
                    LCLC  &XMF        ++ VALUE                          00057200
                    LCLC  &XMFCTRL    ++ NAME                           00057300
                    LCLC  &XMFATTR    ++ VALUE                          00057400
                    LCLC  &XMFSCK     ++ VALUE                          00057500
.*******************************************************************    00057600
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00057700
.*******************************************************************    00057800
                    LCLC  &ZXSERVICE  ++ INPUT VALUE                    00057900
                    LCLC  &ZXON       ++ INPUT VALUE                    00058000
                    LCLC  &ZXBYPONLINEFENCE     ++ INPUT VALUE          00058100
                    LCLC  &ZXBYPALIAS           ++ INPUT VALUE          00058200
                    LCLC  &ZXWLMPAVSUSPEND      ++ INPUT VALUE          00058300
                    LCLC  &ZXUNCOND   ++ INPUT VALUE                    00058400
                    LCLC  &ZXOFF      ++ INPUT VALUE                    00058500
                    LCLC  &ZXWLMPAVRESTORE      ++ INPUT VALUE          00058600
                    LCLC  &ZXDEVVAR1  ++ INPUT NAME                     00058700
                    LCLC  &ZXDEVN     ++ INPUT NAME                     00058800
                    LCLC  &ZXSCHSET   ++ INPUT NAME                     00058900
                    LCLC  &ZXDEVNCHAR           ++ INPUT NAME           00059000
                    LCLC  &ZXLDEVNCHAR          ++ INPUT NAME           00059100
                    LCLC  &ZXRETCODE  ++ OUTPUT NAME                    00059200
                    LCLC  &ZXRSNCODE  ++ OUTPUT NAME                    00059300
                    LCLC  &ZXPLISTVER           ++ INPUT VALUE          00059400
                    LCLC  &ZXMF       ++ INPUT VALUE                    00059500
                    LCLC  &ZXMFCTRL   ++ INPUT NAME                     00059600
                    LCLC  &ZXMFATTR   ++ INPUT VALUE                    00059700
                    LCLC  &ZXMFSCK    ++ INPUT VALUE                    00059800
.********************************************************************   00059900
.***AC.PLV01  PROCESS PLISTVER                                      *   00060000
.********************************************************************   00060100
&XPLISTVER      SETA  1                                                 00060200
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00060300
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00060400
&XPLISTVER      SETA  1                                                 00060500
.ZPLV0          ANOP  ,                                                 00060600
.*                                                                      00060700
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00060800
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00060900
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00061000
.*-------------------------------------------------------------------   00061100
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00061200
&ZMS            SETC  '"PLISTVER='                                      00061300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00061400
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00061500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00061600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00061700
                AGO   .ZPVCK2                                           00061800
.ZPVCK3         ANOP  ,                                                 00061900
.*-------------------------------------------------------------------   00062000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00062100
&ZMS            SETC  '"PLISTVER='                                      00062200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00062300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00062400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00062500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00062600
                AGO   .ZPVCKE                                           00062700
.ZPVCK2         ANOP  ,                                                 00062800
.*-------------------------------------------------------------------   00062900
&ZCVAL          SETC  '&PLISTVER(1)'                                    00063000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00063100
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00063200
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00063300
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00063400
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00063500
.ZPVCK6         ANOP  ,                                                 00063600
&ZMS            SETC  '"PLISTVER='                                      00063700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00063800
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00063900
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00064000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00064100
&XPLISTVER      SETA  1                                                 00064200
                AGO   .ZPVCKE                                           00064300
.*-------------------------------------------------------------------   00064400
.ZPVCK4A        ANOP  ,                                                 00064500
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00064600
&ZMS            SETC  'PLISTVER='                                       00064700
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00064800
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00064900
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00065000
                MNOTE 8,' &ZMS IS REQUIRED.'                            00065100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00065200
                AGO   .ZPVCK5                                           00065300
.ZPVCK4         ANOP  ,                                                 00065400
&XPLISTVER      SETA  &PLISTVER(1)                                      00065500
.ZPVCK5         ANOP  ,                                                 00065600
.ZPVCKE         ANOP  ,                                                 00065700
.********************************************************************   00065800
.***AG.MF01 PROCESS MF MACRO FORMS                                      00065900
.********************************************************************   00066000
                    ACTR  10000                                         00066100
.*------------------------------------------------------------------    00066200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00066300
&XMF                SETC  ''          INITIALIZE XVARIABLE              00066400
.*-------------------------------------------------------------------   00066500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00066600
.ZG44               ANOP  ,                                             00066700
&ZTLC               SETC 'S'                                            00066800
                    AIF   ('&MF(1)' NE '&ZTLC').ZG45                    00066900
&XMF                SETC  'S'         SET KEYWORD                       00067000
                    AIF   (N'&MF LE 1).ZG44A    CK NUM                  00067100
&ZMS                SETC  '"MF='                                        00067200
&ZMS                SETC  '&ZMS.&MF"'                                   00067300
&ZMS                SETC  '&ZMS "MF"'                                   00067400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00067500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00067600
.ZG44A              ANOP  ,                                             00067700
.*-------------------------------------------------------------------   00067800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067900
.ZG45               ANOP  ,                                             00068000
&ZTLC               SETC 'L'                                            00068100
                    AIF   ('&MF(1)' NE '&ZTLC').ZG52                    00068200
&XMF                SETC  'L'         SET KEYWORD                       00068300
                    AIF   (N'&MF LE 3).ZG45A    CK NUM                  00068400
&ZMS                SETC  '"MF='                                        00068500
&ZMS                SETC  '&ZMS.&MF"'                                   00068600
&ZMS                SETC  '&ZMS "MF"'                                   00068700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00068800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00068900
.ZG45A              ANOP  ,                                             00069000
.*-------------------------------------------------------------------   00069100
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00069200
                    AIF   (N'&SYSLIST NE 0).ZG45B  POSITIONALS?         00069300
                    AIF   ('&BYPALIAS' NE '').ZG45B  KEYS?              00069400
                    AIF   ('&DEVN' NE '').ZG45B  KEYS?                  00069500
                    AIF   ('&SCHSET' NE '').ZG45B  KEYS?                00069600
                    AIF   ('&DEVNCHAR' NE '').ZG45B  KEYS?              00069700
                    AIF   ('&LDEVNCHAR' NE '').ZG45B  KEYS?             00069800
                    AIF   ('&RETCODE' NE '').ZG45B  KEYS?               00069900
                    AIF   ('&RSNCODE' NE '').ZG45B  KEYS?               00070000
                    AGO    .ZG45C     INVOCATION OKAY                   00070100
.ZG45B              ANOP  ,                                             00070200
&ZMS                SETC  'THE "L" FORM OF "MF"'                        00070300
&ZMS                SETC  '&ZMS CAN ONLY HAVE'                          00070400
&ZMS                SETC  '&ZMS THE "PLISTVER" KEY'                     00070500
                    MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'        00070600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00070700
.ZG45C              ANOP  ,                                             00070800
.*-------------------------------------------------------------------   00070900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00071000
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00071100
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00071200
                    AIF   (N'&MF(2) GT 1).ZG47B  MULTI                  00071300
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00071400
.ZG47B              AIF   (K'&MF(2) GT 0).ZG47C                         00071500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00071600
&ZMS                SETC  'WHEN "L" IS SPECIFIED'                       00071700
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00071800
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00071900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00072000
.ZG47C              ANOP  ,                                             00072100
.*-------------------------------------------------------------------   00072200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00072300
                    AIF   (K'&ZXMFCTRL LE 0).ZG47P  NOT I/O             00072400
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG47P                00072500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00072600
&ZMS                SETC  '"MF='                                        00072700
&ZMS                SETC  '&ZMS.&MF"'                                   00072800
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00072900
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'             00073000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00073100
.ZG47P              ANOP  ,                                             00073200
.*-------------------------------------------------------------------   00073300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00073400
&ZXMFATTR           SETC  'INPUT'     SET IN/OUTPUT                     00073500
&XMFATTR            SETC  '0D'                                          00073600
                    AIF   (K'&MF(3) LE 0).ZG50B  PARM                   00073700
&XMFATTR            SETC  '&MF(3,1)'  SET XVARIABLE                     00073800
                    AIF   (N'&MF(3) GT 1).ZG50B  MULTI                  00073900
&XMFATTR            SETC  '&MF(3)'    SET XVARIABLE                     00074000
.ZG50B              ANOP  ,                                             00074100
.*-------------------------------------------------------------------   00074200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00074300
                    AIF   (K'&ZXMFATTR LE 0).ZG50P  NOT I/O             00074400
                    AIF   ('&XMFATTR'(1,1) NE '(').ZG50P                00074500
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00074600
&ZMS                SETC  '"MF='                                        00074700
&ZMS                SETC  '&ZMS.&MF"'                                   00074800
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00074900
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'             00075000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00075100
.ZG50P              ANOP  ,                                             00075200
.*-------------------------------------------------------------------   00075300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00075400
                    AIF   (K'&ZXMFATTR LE 0).ZG50S  NOT I/O             00075500
                    AIF   (K'&XMFATTR LE 60).ZG50S  LNG OK              00075600
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00075700
&ZMS                SETC  '"MF='                                        00075800
&ZMS                SETC  '&ZMS.&MF"'                                   00075900
&ZMS                SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'         00076000
                    MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'            00076100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00076200
.ZG50S              ANOP  ,                                             00076300
.*-------------------------------------------------------------------   00076400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076500
.ZG52               ANOP  ,                                             00076600
&ZTLC               SETC 'E'                                            00076700
                    AIF   ('&MF(1)' NE '&ZTLC').ZG60                    00076800
&XMF                SETC  'E'         SET KEYWORD                       00076900
                    AIF   (N'&MF LE 3).ZG52A    CK NUM                  00077000
&ZMS                SETC  '"MF='                                        00077100
&ZMS                SETC  '&ZMS.&MF"'                                   00077200
&ZMS                SETC  '&ZMS "MF"'                                   00077300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00077400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00077500
.ZG52A              ANOP  ,                                             00077600
.*-------------------------------------------------------------------   00077700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00077800
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00077900
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00078000
                    AIF   (N'&MF(2) GT 1).ZG54B  MULTI                  00078100
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00078200
.ZG54B              AIF   (K'&MF(2) GT 0).ZG54C                         00078300
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00078400
&ZMS                SETC  'WHEN "E" IS SPECIFIED'                       00078500
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00078600
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00078700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00078800
.ZG54C              ANOP  ,                                             00078900
.*-------------------------------------------------------------------   00079000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00079100
                    AIF   (K'&ZXMFCTRL LE 0).ZG54R  NOT I/O             00079200
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG54R                00079300
&ZCGPR              SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                    00079400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG54P                  00079500
                    AIF   (K'&ZCGPR GT 2).ZG54Q                         00079600
                    AIF   ('&ZCGPR' EQ '0').ZG54Q                       00079700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00079800
                    AIF   (T'&ZCGPR NE 'N').ZG54Q  INVALID REG NAME     00079900
.ZG54P              ANOP  ,                                             00080000
                    AIF   (T'&ZCGPR NE 'N').ZG54R  NON NUMERIC          00080100
                    AIF   ('&ZCGPR' LT '1').ZG54Q                       00080200
                    AIF   ('&ZCGPR' LE '12').ZG54R                      00080300
.ZG54Q              ANOP  ,                                             00080400
&ZMS                SETC  '"MF='                                        00080500
&ZMS                SETC  '&ZMS.&MF"'                                   00080600
&ZMS                SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'     00080700
                    MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'              00080800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00080900
.ZG54R              ANOP  ,                                             00081000
.*-------------------------------------------------------------------   00081100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00081200
&XMFSCK             SETC  ''          INITIALIZE XVARIABLE              00081300
.ZG58A   AIF   ('&MF(3)' NE 'COMPLETE').ZG59A                           00081400
&XMFSCK             SETC  'COMPLETE'  SET KEYWORD                       00081500
.*-------------------------------------------------------------------   00081600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00081700
.ZG59A              AIF   (K'&XMFSCK GT 0).ZG59C  KEYWORD               00081800
                    AIF   (K'&MF(3) LE 0).ZG59B                         00081900
&ZMS                SETC  '"MF='                                        00082000
&ZMS                SETC  '&ZMS.&MF"'                                   00082100
&ZMS                SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '     00082200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00082300
&ZMS                SETC  '&ZMS "COMPLETE".'                            00082400
                    MNOTE 8,' &ZMS '                                    00082500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00082600
.ZG59B              ANOP  ,                                             00082700
&XMFSCK             SETC  'COMPLETE'  SET DEFAULT KEYWORD               00082800
.ZG59C              ANOP  ,                                             00082900
&ZXMFSCK            SETC  'INPUT'     SET IN/OUTPUT                     00083000
.*------------------------------------------------------------------    00083100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00083200
.ZG60               ANOP  ,                                             00083300
&ZXMF               SETC  'INPUT'     SET IN/OUTPUT                     00083400
                    AIF   (K'&XMF GT 0).ZG60E   VALID ARG               00083500
                    AIF   (T'&MF EQ 'O').ZG60D  OMITTED                 00083600
&ZASYSLNDX          SETA  0                                             00083700
.ZG60A              ANOP  ,           POSITIONAL MACRO KEY              00083800
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00083900
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG60C              00084000
&ZTLC               SETC 'MF'                                           00084100
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG60A     00084200
.ZG60B              ANOP  ,                                             00084300
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00084400
&ZMS                SETC  'THE "MF" KEY'                                00084500
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00084600
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00084700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00084800
                    AGO   .ZG60E                                        00084900
.ZG60C              ANOP  ,                                             00085000
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00085100
&ZMS                SETC  '"MF='                                        00085200
&ZMS                SETC  '&ZMS.&MF"'                                   00085300
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00085400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00085500
&ZMS                SETC  '&ZMS "S",'                                   00085600
&ZMS                SETC  '&ZMS "L",'                                   00085700
&ZMS                SETC  '&ZMS OR "E".'                                00085800
                    MNOTE 8,' &ZMS '                                    00085900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00086000
                    AGO   .ZG60E                                        00086100
.ZG60D              ANOP  ,                                             00086200
&XMF                SETC  'S'         SET DEFAULT KEYWORD               00086300
&XMFSCK             SETC  'COMPLETE'  COMPLETE CHECKING                 00086400
.ZG60E              ANOP  ,                                             00086500
.********************************************************************   00086600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00086700
.********************************************************************   00086800
                    ACTR  10000                                         00086900
.*-------------------------------------------------------------------   00087000
.***AG.MF03 MF=(SLE)                                                    00087100
                    AIF   ('&XMF' EQ 'L').ZGMFX                         00087200
.*-------------------------------------------------------------------   00087300
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00087400
&XSERVICE           SETC  ''          INITIALIZE XVARIABLE              00087500
&ZASYSLNDX          SETA  0                                             00087600
.ZG2A               ANOP  ,           POSITIONAL KEY SEARCH             00087700
&ZASYSLNDX          SETA  &ZASYSLNDX+1          NEXT POSITIONAL         00087800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00087900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00088000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'ON').ZG2A                    00088100
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00088200
&ZXSERVICE          SETC  'INPUT'     SET IN/OUTPUT                     00088300
&XSERVICE           SETC  'ON'        SET XVARIABLE                     00088400
&ZXON               SETC  'INPUT'     SET IN/OUTPUT                     00088500
&XON                SETC  'ON'        SET XVARIABLE PARM                00088600
.ZG2B               ANOP  ,                                             00088700
.*-------------------------------------------------------------------   00088800
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00088900
&ZASYSLNDX          SETA  0                                             00089000
.ZG17A              ANOP  ,           POSITIONAL KEY SEARCH             00089100
&ZASYSLNDX          SETA  &ZASYSLNDX+1          NEXT POSITIONAL         00089200
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C  DONE                   00089300
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG17A            00089400
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'OFF').ZG17A                  00089500
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00089600
                    AIF   (K'&XSERVICE LE 0).ZG17B  VALID               00089700
&ZMS                SETC  '"OFF'                                        00089800
&ZMS                SETC  '&ZMS."'                                      00089900
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00090000
&ZMS                SETC  '&ZMS "&XSERVICE"'                            00090100
                    MNOTE 8,' &ZMS KEY.'                                00090200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00090300
                    AGO   .ZG17C                                        00090400
.*                                                                      00090500
.ZG17B              ANOP  ,                                             00090600
&ZXSERVICE          SETC  'INPUT'     SET IN/OUTPUT                     00090700
&XSERVICE           SETC  'OFF'       SET XVARIABLE                     00090800
&ZXOFF              SETC  'INPUT'     SET IN/OUTPUT                     00090900
&XOFF               SETC  'OFF'       SET XVARIABLE PARM                00091000
.ZG17C              ANOP  ,                                             00091100
.*------------------------------------------------------------------    00091200
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00091300
                    AIF   (K'&XSERVICE GT 0).ZG21B                      00091400
&ZXSERVICE          SETC  ''          RESET IN/OUTPUT                   00091500
&ZXON               SETC  ''          RESET IN/OUTPUT                   00091600
&XSERVICE           SETC  ''          ENSURE NULL                       00091700
&XON                SETC  ''          ENSURE NULL                       00091800
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00091900
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00092000
&ZMS                SETC  '&ZMS REQUIRED:'                              00092100
&ZMS                SETC  '&ZMS "ON"'           VALID ME KEY            00092200
&ZMS                SETC  '&ZMS OR "OFF".'      VALID ME KEY            00092300
                    MNOTE 8,' &ZMS '                                    00092400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00092500
.ZG21B              ANOP  ,                                             00092600
.*-------------------------------------------------------------------   00092700
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00092800
.ZG2ZY  AIF    ('&XSERVICE' NE 'ON').ZG17ZY                             00092900
.*-------------------------------------------------------------------   00093000
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00093100
&ZCVAL              SETC ''           ERROR KEY FIELD                   00093200
.ZG2I0              AIF   (K'&XWLMPAVRESTORE LE 0).ZG2I1                00093300
&ZCVAL              SETC '&ZCVAL XWLMPAVRESTORE'  DISALLOWED KEY        00093400
.ZG2I1              AIF   (K'&ZCVAL LE 0).ZG2J  KEY                     00093500
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00093600
&ZMS                SETC  '"ON'                                         00093700
&ZMS                SETC  '&ZMS."'                                      00093800
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00093900
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00094000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00094100
.ZG2J               ANOP  ,                                             00094200
.*----------------------------------------------------------------***   00094300
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00094400
&XBYPONLINEFENCE    SETC  ''          RESET XVARIABLE                   00094500
&ZXBYPONLINEFENCE   SETC  ''          RESET IN/OUTPUT                   00094600
&ZASYSLNDX          SETA  0                                             00094700
.ZG4A               ANOP  ,           POSITIONAL MACRO KEY              00094800
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00094900
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG4B                          00095000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG4A             00095100
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'BYPONLINEFENCE').ZG4A        00095200
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00095300
&XBYPONLINEFENCE    SETC  'BYPONLINEFENCE'      MACRO KEY FOUND         00095400
&ZXBYPONLINEFENCE   SETC  'INPUT'     SET IN/OUTPUT                     00095500
.ZG4B               ANOP  ,                                             00095600
.*-------------------------------------------------------------------   00095700
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00095800
                    AIF   (K'&XBYPONLINEFENCE GT 0).ZG4C  KEY ENTERED   00095900
&ZXBYPONLINEFENCE   SETC  'INPUT'     SET IN/OUTPUT                     00096000
&XBYPONLINEFENCE    SETC  'NONE'      SET DEFAULT                       00096100
.ZG4C               ANOP  ,                                             00096200
.*------------------------------------------------------------------    00096300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00096400
&XBYPALIAS          SETC  ''          INITIALIZE XVARIABLE              00096500
.*-------------------------------------------------------------------   00096600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00096700
.ZG8                ANOP  ,                                             00096800
                    AIF   (K'&BYPALIAS(1) LE 0).ZG8A                    00096900
&ZTLC               SETC 'NO'                                           00097000
                    AIF   ('&BYPALIAS(1)' NE '&ZTLC').ZG9               00097100
&XBYPALIAS          SETC  'NO'        SET KEYWORD                       00097200
                    AIF   (N'&BYPALIAS LE 1).ZG8A  CK NUM               00097300
&ZMS                SETC  '"BYPALIAS='                                  00097400
&ZMS                SETC  '&ZMS.&BYPALIAS"'                             00097500
&ZMS                SETC  '&ZMS "BYPALIAS"'                             00097600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00097700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00097800
.ZG8A               ANOP  ,                                             00097900
.*-------------------------------------------------------------------   00098000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098100
.ZG9                ANOP  ,                                             00098200
&ZTLC               SETC 'YES'                                          00098300
                    AIF   ('&BYPALIAS(1)' NE '&ZTLC').ZG10              00098400
&XBYPALIAS          SETC  'YES'       SET KEYWORD                       00098500
                    AIF   (N'&BYPALIAS LE 1).ZG9A  CK NUM               00098600
&ZMS                SETC  '"BYPALIAS='                                  00098700
&ZMS                SETC  '&ZMS.&BYPALIAS"'                             00098800
&ZMS                SETC  '&ZMS "BYPALIAS"'                             00098900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00099000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00099100
.ZG9A               ANOP  ,                                             00099200
.*------------------------------------------------------------------    00099300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099400
.ZG10               ANOP  ,                                             00099500
&ZXBYPALIAS         SETC  'INPUT'     SET IN/OUTPUT                     00099600
                    AIF   (K'&XBYPALIAS GT 0).ZG10E  VALID ARG          00099700
                    AIF   (T'&BYPALIAS EQ 'O').ZG10D  OMITTED           00099800
&ZASYSLNDX          SETA  0                                             00099900
.ZG10A              ANOP  ,           POSITIONAL MACRO KEY              00100000
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00100100
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG10C              00100200
&ZTLC               SETC 'BYPALIAS'                                     00100300
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG10A     00100400
.ZG10B              ANOP  ,                                             00100500
&ZXBYPALIAS         SETC  ''          RESET IN/OUTPUT                   00100600
&ZMS                SETC  'THE "BYPALIAS" KEY'                          00100700
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00100800
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00100900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00101000
                    AGO   .ZG10E                                        00101100
.ZG10C              ANOP  ,                                             00101200
&ZXBYPALIAS         SETC  ''          RESET IN/OUTPUT                   00101300
&ZMS                SETC  '"BYPALIAS='                                  00101400
&ZMS                SETC  '&ZMS.&BYPALIAS"'                             00101500
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00101600
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00101700
&ZMS                SETC  '&ZMS "NO"'                                   00101800
&ZMS                SETC  '&ZMS OR "YES".'                              00101900
                    MNOTE 8,' &ZMS '                                    00102000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00102100
                    AGO   .ZG10E                                        00102200
.ZG10D              ANOP  ,                                             00102300
&XBYPALIAS          SETC  'NO'        SET DEFAULT KEYWORD               00102400
.ZG10E              ANOP  ,                                             00102500
.*----------------------------------------------------------------***   00102600
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00102700
&XWLMPAVSUSPEND     SETC  ''          RESET XVARIABLE                   00102800
&ZXWLMPAVSUSPEND    SETC  ''          RESET IN/OUTPUT                   00102900
&ZASYSLNDX          SETA  0                                             00103000
.ZG12A              ANOP  ,           POSITIONAL MACRO KEY              00103100
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00103200
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG12B                         00103300
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG12A            00103400
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'WLMPAVSUSPEND').ZG12A        00103500
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00103600
&XWLMPAVSUSPEND     SETC  'WLMPAVSUSPEND'       MACRO KEY FOUND         00103700
&ZXWLMPAVSUSPEND    SETC  'INPUT'     SET IN/OUTPUT                     00103800
.ZG12B              ANOP  ,                                             00103900
.*-------------------------------------------------------------------   00104000
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00104100
                    AIF   (K'&XWLMPAVSUSPEND GT 0).ZG12C  KEY ENTERED   00104200
&ZXWLMPAVSUSPEND    SETC  'INPUT'     SET IN/OUTPUT                     00104300
&XWLMPAVSUSPEND     SETC  'NONE'      SET DEFAULT                       00104400
.ZG12C              ANOP  ,                                             00104500
.*----------------------------------------------------------------***   00104600
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00104700
&XUNCOND            SETC  ''          RESET XVARIABLE                   00104800
&ZXUNCOND           SETC  ''          RESET IN/OUTPUT                   00104900
&ZASYSLNDX          SETA  0                                             00105000
.ZG15A              ANOP  ,           POSITIONAL MACRO KEY              00105100
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00105200
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG15B                         00105300
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG15A            00105400
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'UNCOND').ZG15A               00105500
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00105600
&XUNCOND            SETC  'UNCOND'    MACRO KEY FOUND                   00105700
&ZXUNCOND           SETC  'INPUT'     SET IN/OUTPUT                     00105800
.ZG15B              ANOP  ,                                             00105900
.*-------------------------------------------------------------------   00106000
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00106100
                    AIF   (K'&XUNCOND GT 0).ZG15C  KEY ENTERED          00106200
&ZXUNCOND           SETC  'INPUT'     SET IN/OUTPUT                     00106300
&XUNCOND            SETC  'NONE'      SET DEFAULT                       00106400
.ZG15C              ANOP  ,                                             00106500
.*-------------------------------------------------------------------   00106600
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00106700
.ZG17ZY  AIF    ('&XSERVICE' NE 'OFF').ZG21ZY                           00106800
.*-------------------------------------------------------------------   00106900
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00107000
&ZCVAL              SETC ''           ERROR KEY FIELD                   00107100
.ZG17I0             AIF   (K'&XBYPONLINEFENCE LE 0).ZG17I1              00107200
&ZCVAL              SETC '&ZCVAL XBYPONLINEFENCE'  DISALLOWED KEY       00107300
.ZG17I1             AIF   (K'&BYPALIAS LE 0).ZG17I2                     00107400
&ZCVAL              SETC '&ZCVAL BYPALIAS'      DISALLOWED KEY          00107500
.ZG17I2             AIF   (K'&XWLMPAVSUSPEND LE 0).ZG17I3               00107600
&ZCVAL              SETC '&ZCVAL XWLMPAVSUSPEND'  DISALLOWED KEY        00107700
.ZG17I3             AIF   (K'&XUNCOND LE 0).ZG17I4                      00107800
&ZCVAL              SETC '&ZCVAL XUNCOND'       DISALLOWED KEY          00107900
.ZG17I4             AIF   (K'&ZCVAL LE 0).ZG17J  KEY                    00108000
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00108100
&ZMS                SETC  '"OFF'                                        00108200
&ZMS                SETC  '&ZMS."'                                      00108300
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00108400
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00108500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00108600
.ZG17J              ANOP  ,                                             00108700
.*----------------------------------------------------------------***   00108800
.***AG.KXVAR01 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00108900
&XWLMPAVRESTORE     SETC  ''          RESET XVARIABLE                   00109000
&ZXWLMPAVRESTORE    SETC  ''          RESET IN/OUTPUT                   00109100
&ZASYSLNDX          SETA  0                                             00109200
.ZG19A              ANOP  ,           POSITIONAL MACRO KEY              00109300
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00109400
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG19B                         00109500
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG19A            00109600
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'WLMPAVRESTORE').ZG19A        00109700
&ZCSYSLIST(&ZASYSLNDX) SETC  'NONXKEY'          POSITIONAL IS MACRO KEY 00109800
&XWLMPAVRESTORE     SETC  'WLMPAVRESTORE'       MACRO KEY FOUND         00109900
&ZXWLMPAVRESTORE    SETC  'INPUT'     SET IN/OUTPUT                     00110000
.ZG19B              ANOP  ,                                             00110100
.*-------------------------------------------------------------------   00110200
.***AG.KXVAR03 VALUE, OPT INPUT, KEYS -NO ARGUMENTS                     00110300
                    AIF   (K'&XWLMPAVRESTORE GT 0).ZG19C  KEY ENTERED   00110400
&ZXWLMPAVRESTORE    SETC  'INPUT'     SET IN/OUTPUT                     00110500
&XWLMPAVRESTORE     SETC  'NONE'      SET DEFAULT                       00110600
.ZG19C              ANOP  ,                                             00110700
.*-------------------------------------------------------------------   00110800
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00110900
.ZG21ZY             ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00111000
.*----------------------------------------------------------------***   00111100
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00111200
&XDEVVAR1           SETC  ''          INITIALIZE XVARIABLE              00111300
                    AIF   (K'&DEVN LE 0).ZG23C                          00111400
&ZXDEVVAR1          SETC  'INPUT'     SET IN/OUTPUT                     00111500
&XDEVVAR1           SETC  'DEVN'      SET XVARIABLE                     00111600
&ZXDEVN             SETC  'INPUT'     SET IN/OUTPUT                     00111700
&XDEVN              SETC  '&DEVN(1)'  SET XVARIABLE PARM                00111800
                    AIF   (N'&DEVN GT 1).ZG23A                          00111900
&XDEVN              SETC  '&DEVN'     SET XVARIABLE PARM                00112000
.ZG23A              AIF   (N'&DEVN LE 1).ZG23B  CK NUM                  00112100
&ZMS                SETC  '"DEVN='                                      00112200
&ZMS                SETC  '&ZMS.&DEVN"'                                 00112300
&ZMS                SETC  '&ZMS "DEVN"'                                 00112400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00112500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00112600
.ZG23B              AIF   (K'&XDEVN GT 0).ZG23C  ONE PARM               00112700
&ZXDEVVAR1          SETC  ''          RESET IN/OUTPUT                   00112800
&ZXDEVN             SETC  ''          RESET IN/OUTPUT                   00112900
&ZMS                SETC  ' '                                           00113000
&ZMS                SETC  '&ZMS "DEVN" KEY AND ITS'                     00113100
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00113200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00113300
.ZG23C              ANOP  ,                                             00113400
.*----------------------------------------------------------------***   00113500
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00113600
                    AIF   (K'&DEVNCHAR LE 0).ZG27D  NO ME KEY           00113700
                    AIF   (N'&DEVNCHAR LE 1).ZG27A  CK NUM              00113800
&ZMS                SETC  '"DEVNCHAR='                                  00113900
&ZMS                SETC  '&ZMS.&DEVNCHAR"'                             00114000
&ZMS                SETC  '&ZMS "DEVNCHAR"'                             00114100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00114200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00114300
.ZG27A              AIF   (K'&XDEVVAR1 LE 0).ZG27B                      00114400
&ZMS                SETC  '"DEVNCHAR'                                   00114500
&ZMS                SETC  '&ZMS.=&DEVNCHAR"'                            00114600
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00114700
&ZMS                SETC  '&ZMS "&XDEVVAR1"'                            00114800
                    MNOTE 8,' &ZMS KEY.'                                00114900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00115000
                    AGO   .ZG27D                                        00115100
.*                                                                      00115200
.ZG27B              ANOP  ,                                             00115300
&ZXDEVVAR1          SETC  'INPUT'     SET IN/OUTPUT                     00115400
&XDEVVAR1           SETC  'DEVNCHAR'  SET XVARIABLE                     00115500
&ZXDEVNCHAR         SETC  'INPUT'     SET IN/OUTPUT                     00115600
&XDEVNCHAR          SETC  '&DEVNCHAR(1)'        SET XVARIABLE PARM      00115700
                    AIF   (N'&DEVNCHAR GT 1).ZG27C                      00115800
&XDEVNCHAR          SETC  '&DEVNCHAR'           SET XVARIABLE PARM      00115900
.ZG27C              AIF   (K'&XDEVNCHAR GT 0).ZG27D  ONE PARM           00116000
&ZXDEVVAR1          SETC  ''          RESET IN/OUTPUT                   00116100
&ZXDEVNCHAR         SETC  ''          RESET IN/OUTPUT                   00116200
&ZMS                SETC  ' '                                           00116300
&ZMS                SETC  '&ZMS "DEVNCHAR" KEY AND ITS'                 00116400
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00116500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00116600
.ZG27D              ANOP  ,                                             00116700
.*----------------------------------------------------------------***   00116800
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00116900
                    AIF   (K'&LDEVNCHAR LE 0).ZG31D  NO ME KEY          00117000
                    AIF   (N'&LDEVNCHAR LE 1).ZG31A  CK NUM             00117100
&ZMS                SETC  '"LDEVNCHAR='                                 00117200
&ZMS                SETC  '&ZMS.&LDEVNCHAR"'                            00117300
&ZMS                SETC  '&ZMS "LDEVNCHAR"'                            00117400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00117500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00117600
.ZG31A              AIF   (K'&XDEVVAR1 LE 0).ZG31B                      00117700
&ZMS                SETC  '"LDEVNCHAR'                                  00117800
&ZMS                SETC  '&ZMS.=&LDEVNCHAR"'                           00117900
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00118000
&ZMS                SETC  '&ZMS "&XDEVVAR1"'                            00118100
                    MNOTE 8,' &ZMS KEY.'                                00118200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00118300
                    AGO   .ZG31D                                        00118400
.*                                                                      00118500
.ZG31B              ANOP  ,                                             00118600
&ZXDEVVAR1          SETC  'INPUT'     SET IN/OUTPUT                     00118700
&XDEVVAR1           SETC  'LDEVNCHAR'           SET XVARIABLE           00118800
&ZXLDEVNCHAR        SETC  'INPUT'     SET IN/OUTPUT                     00118900
&XLDEVNCHAR         SETC  '&LDEVNCHAR(1)'       SET XVARIABLE PARM      00119000
                    AIF   (N'&LDEVNCHAR GT 1).ZG31C                     00119100
&XLDEVNCHAR         SETC  '&LDEVNCHAR'          SET XVARIABLE PARM      00119200
.ZG31C              AIF   (K'&XLDEVNCHAR GT 0).ZG31D  ONE PARM          00119300
&ZXDEVVAR1          SETC  ''          RESET IN/OUTPUT                   00119400
&ZXLDEVNCHAR        SETC  ''          RESET IN/OUTPUT                   00119500
&ZMS                SETC  ' '                                           00119600
&ZMS                SETC  '&ZMS "LDEVNCHAR" KEY AND ITS'                00119700
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00119800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00119900
.ZG31D              ANOP  ,                                             00120000
.*------------------------------------------------------------------    00120100
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00120200
                    AIF   (K'&XDEVVAR1 GT 0).ZG32B                      00120300
&ZXDEVVAR1          SETC  ''          RESET IN/OUTPUT                   00120400
&ZXDEVN             SETC  ''          RESET IN/OUTPUT                   00120500
&XDEVVAR1           SETC  ''          ENSURE NULL                       00120600
&XDEVN              SETC  ''          ENSURE NULL                       00120700
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00120800
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00120900
&ZMS                SETC  '&ZMS REQUIRED:'                              00121000
&ZMS                SETC  '&ZMS "DEVN",'        VALID ME KEY            00121100
&ZMS                SETC  '&ZMS "DEVNCHAR",'    VALID ME KEY            00121200
&ZMS                SETC  '&ZMS OR "LDEVNCHAR".'  VALID ME KEY          00121300
                    MNOTE 8,' &ZMS '                                    00121400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00121500
.ZG32B              ANOP  ,                                             00121600
.*-------------------------------------------------------------------   00121700
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00121800
.ZG23ZY  AIF    ('&XDEVVAR1' NE 'DEVN').ZG27ZY                          00121900
.*-------------------------------------------------------------------   00122000
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00122100
                    AIF   (K'&ZXDEVN LE 0).ZG23R  NOT I/O               00122200
                    AIF   ('&XDEVN'(1,1) NE '(').ZG23R                  00122300
&ZCGPR              SETC  '&XDEVN'(2,K'&XDEVN-2)                        00122400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                  00122500
                    AIF   (K'&ZCGPR GT 2).ZG23Q                         00122600
                    AIF   ('&ZCGPR' EQ '0').ZG23Q                       00122700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00122800
                    AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME     00122900
.ZG23P              ANOP  ,                                             00123000
                    AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC          00123100
                    AIF   ('&ZCGPR' LT '2').ZG23Q                       00123200
                    AIF   ('&ZCGPR' LE '12').ZG23R                      00123300
.ZG23Q              ANOP  ,                                             00123400
&ZMS                SETC  '"DEVN='                                      00123500
&ZMS                SETC  '&ZMS.&DEVN"'                                 00123600
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00123700
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00123800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00123900
.ZG23R              ANOP  ,                                             00124000
.*----------------------------------------------------------------***   00124100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00124200
                    AIF   (N'&SCHSET LE 1).ZG25A  CK NUM                00124300
&ZMS                SETC  '"SCHSET='                                    00124400
&ZMS                SETC  '&ZMS.&SCHSET"'                               00124500
&ZMS                SETC  '&ZMS "SCHSET"'                               00124600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00124700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00124800
.ZG25A              ANOP  ,                                             00124900
.*-------------------------------------------------------------------   00125000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00125100
&ZXSCHSET           SETC  'INPUT'     SET IN/OUTPUT                     00125200
&XSCHSET            SETC  '0'                                           00125300
                    AIF   (K'&SCHSET(1) LE 0).ZG25B  PARM               00125400
&XSCHSET            SETC  '&SCHSET(1)'          SET XVARIABLE           00125500
                    AIF   (N'&SCHSET GT 1).ZG25B  MULTI                 00125600
&XSCHSET            SETC  '&SCHSET'   SET XVARIABLE                     00125700
.ZG25B              ANOP  ,                                             00125800
.*-------------------------------------------------------------------   00125900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00126000
                    AIF   (K'&ZXSCHSET LE 0).ZG25R  NOT I/O             00126100
                    AIF   ('&XSCHSET'(1,1) NE '(').ZG25R                00126200
&ZCGPR              SETC  '&XSCHSET'(2,K'&XSCHSET-2)                    00126300
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                  00126400
                    AIF   (K'&ZCGPR GT 2).ZG25Q                         00126500
                    AIF   ('&ZCGPR' EQ '0').ZG25Q                       00126600
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00126700
                    AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME     00126800
.ZG25P              ANOP  ,                                             00126900
                    AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC          00127000
                    AIF   ('&ZCGPR' LT '2').ZG25Q                       00127100
                    AIF   ('&ZCGPR' LE '12').ZG25R                      00127200
.ZG25Q              ANOP  ,                                             00127300
&ZMS                SETC  '"SCHSET='                                    00127400
&ZMS                SETC  '&ZMS.&SCHSET"'                               00127500
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00127600
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00127700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00127800
.ZG25R              ANOP  ,                                             00127900
.*-------------------------------------------------------------------   00128000
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00128100
.ZG27ZY  AIF    ('&XDEVVAR1' NE 'DEVNCHAR').ZG31ZY                      00128200
.*-------------------------------------------------------------------   00128300
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00128400
                    AIF   (K'&ZXDEVNCHAR LE 0).ZG27R  NOT I/O           00128500
                    AIF   ('&XDEVNCHAR'(1,1) NE '(').ZG27R              00128600
&ZCGPR              SETC  '&XDEVNCHAR'(2,K'&XDEVNCHAR-2)                00128700
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                  00128800
                    AIF   (K'&ZCGPR GT 2).ZG27Q                         00128900
                    AIF   ('&ZCGPR' EQ '0').ZG27Q                       00129000
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00129100
                    AIF   (T'&ZCGPR NE 'N').ZG27Q  INVALID REG NAME     00129200
.ZG27P              ANOP  ,                                             00129300
                    AIF   (T'&ZCGPR NE 'N').ZG27R  NON NUMERIC          00129400
                    AIF   ('&ZCGPR' LT '2').ZG27Q                       00129500
                    AIF   ('&ZCGPR' LE '12').ZG27R                      00129600
.ZG27Q              ANOP  ,                                             00129700
&ZMS                SETC  '"DEVNCHAR='                                  00129800
&ZMS                SETC  '&ZMS.&DEVNCHAR"'                             00129900
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00130000
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00130100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00130200
.ZG27R              ANOP  ,                                             00130300
.*----------------------------------------------------------------***   00130400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00130500
                    AIF   (N'&SCHSET LE 1).ZG29A  CK NUM                00130600
&ZMS                SETC  '"SCHSET='                                    00130700
&ZMS                SETC  '&ZMS.&SCHSET"'                               00130800
&ZMS                SETC  '&ZMS "SCHSET"'                               00130900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00131000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00131100
.ZG29A              ANOP  ,                                             00131200
.*-------------------------------------------------------------------   00131300
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00131400
&ZXSCHSET           SETC  'INPUT'     SET IN/OUTPUT                     00131500
&XSCHSET            SETC  '0'                                           00131600
                    AIF   (K'&SCHSET(1) LE 0).ZG29B  PARM               00131700
&XSCHSET            SETC  '&SCHSET(1)'          SET XVARIABLE           00131800
                    AIF   (N'&SCHSET GT 1).ZG29B  MULTI                 00131900
&XSCHSET            SETC  '&SCHSET'   SET XVARIABLE                     00132000
.ZG29B              ANOP  ,                                             00132100
.*-------------------------------------------------------------------   00132200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00132300
                    AIF   (K'&ZXSCHSET LE 0).ZG29R  NOT I/O             00132400
                    AIF   ('&XSCHSET'(1,1) NE '(').ZG29R                00132500
&ZCGPR              SETC  '&XSCHSET'(2,K'&XSCHSET-2)                    00132600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                  00132700
                    AIF   (K'&ZCGPR GT 2).ZG29Q                         00132800
                    AIF   ('&ZCGPR' EQ '0').ZG29Q                       00132900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00133000
                    AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME     00133100
.ZG29P              ANOP  ,                                             00133200
                    AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC          00133300
                    AIF   ('&ZCGPR' LT '2').ZG29Q                       00133400
                    AIF   ('&ZCGPR' LE '12').ZG29R                      00133500
.ZG29Q              ANOP  ,                                             00133600
&ZMS                SETC  '"SCHSET='                                    00133700
&ZMS                SETC  '&ZMS.&SCHSET"'                               00133800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00133900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00134000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00134100
.ZG29R              ANOP  ,                                             00134200
.*-------------------------------------------------------------------   00134300
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00134400
.ZG31ZY  AIF    ('&XDEVVAR1' NE 'LDEVNCHAR').ZG32ZY                     00134500
.*-------------------------------------------------------------------   00134600
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00134700
&ZCVAL              SETC ''           ERROR KEY FIELD                   00134800
.ZG31I0             AIF   (K'&SCHSET LE 0).ZG31I1                       00134900
&ZCVAL              SETC '&ZCVAL SCHSET'        DISALLOWED KEY          00135000
.ZG31I1             AIF   (K'&ZCVAL LE 0).ZG31J  KEY                    00135100
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00135200
&ZMS                SETC  '"LDEVNCHAR'                                  00135300
&ZMS                SETC  '&ZMS.=&LDEVNCHAR"'                           00135400
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00135500
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00135600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00135700
.ZG31J              ANOP  ,                                             00135800
.*-------------------------------------------------------------------   00135900
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00136000
                    AIF   (K'&ZXLDEVNCHAR LE 0).ZG31R  NOT I/O          00136100
                    AIF   ('&XLDEVNCHAR'(1,1) NE '(').ZG31R             00136200
&ZCGPR              SETC  '&XLDEVNCHAR'(2,K'&XLDEVNCHAR-2)              00136300
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                  00136400
                    AIF   (K'&ZCGPR GT 2).ZG31Q                         00136500
                    AIF   ('&ZCGPR' EQ '0').ZG31Q                       00136600
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00136700
                    AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME     00136800
.ZG31P              ANOP  ,                                             00136900
                    AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC          00137000
                    AIF   ('&ZCGPR' LT '2').ZG31Q                       00137100
                    AIF   ('&ZCGPR' LE '12').ZG31R                      00137200
.ZG31Q              ANOP  ,                                             00137300
&ZMS                SETC  '"LDEVNCHAR='                                 00137400
&ZMS                SETC  '&ZMS.&LDEVNCHAR"'                            00137500
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00137600
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00137700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00137800
.ZG31R              ANOP  ,                                             00137900
.*-------------------------------------------------------------------   00138000
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00138100
.ZG32ZY             ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00138200
.*----------------------------------------------------------------***   00138300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00138400
                    AIF   (N'&RETCODE LE 1).ZG34A  CK NUM               00138500
&ZMS                SETC  '"RETCODE='                                   00138600
&ZMS                SETC  '&ZMS.&RETCODE"'                              00138700
&ZMS                SETC  '&ZMS "RETCODE"'                              00138800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00138900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00139000
.ZG34A              ANOP  ,                                             00139100
.*-------------------------------------------------------------------   00139200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00139300
                    AIF   (K'&RETCODE(1) LE 0).ZG34C  NO PARM           00139400
&ZXRETCODE          SETC  'OUTPUT'    SET OUTPUT                        00139500
&XRETCODE           SETC  '&RETCODE(1)'         SET XVARIABLE           00139600
                    AIF   (N'&RETCODE GT 1).ZG34C                       00139700
&XRETCODE           SETC  '&RETCODE'  SET XVARIABLE                     00139800
.ZG34C              ANOP  ,                                             00139900
.*-------------------------------------------------------------------   00140000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00140100
                    AIF   (K'&ZXRETCODE LE 0).ZG34R  NOT I/O            00140200
                    AIF   ('&XRETCODE'(1,1) NE '(').ZG34R               00140300
&ZCGPR              SETC  '&XRETCODE'(2,K'&XRETCODE-2)                  00140400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                  00140500
                    AIF   (K'&ZCGPR GT 2).ZG34Q                         00140600
                    AIF   ('&ZCGPR' EQ '0').ZG34Q                       00140700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00140800
                    AIF   (T'&ZCGPR NE 'N').ZG34Q  INVALID REG NAME     00140900
.ZG34P              ANOP  ,                                             00141000
                    AIF   (T'&ZCGPR NE 'N').ZG34R  NON NUMERIC          00141100
                    AIF   ('&ZCGPR' EQ '15').ZG34R                      00141200
                    AIF   ('&ZCGPR' LT '2').ZG34Q                       00141300
                    AIF   ('&ZCGPR' LE '12').ZG34R                      00141400
.ZG34Q              ANOP  ,                                             00141500
&ZMS                SETC  '"RETCODE='                                   00141600
&ZMS                SETC  '&ZMS.&RETCODE"'                              00141700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00141800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'      00141900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00142000
.ZG34R              ANOP  ,                                             00142100
.*----------------------------------------------------------------***   00142200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00142300
                    AIF   (N'&RSNCODE LE 1).ZG37A  CK NUM               00142400
&ZMS                SETC  '"RSNCODE='                                   00142500
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00142600
&ZMS                SETC  '&ZMS "RSNCODE"'                              00142700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00142800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00142900
.ZG37A              ANOP  ,                                             00143000
.*-------------------------------------------------------------------   00143100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00143200
                    AIF   (K'&RSNCODE(1) LE 0).ZG37C  NO PARM           00143300
&ZXRSNCODE          SETC  'OUTPUT'    SET OUTPUT                        00143400
&XRSNCODE           SETC  '&RSNCODE(1)'         SET XVARIABLE           00143500
                    AIF   (N'&RSNCODE GT 1).ZG37C                       00143600
&XRSNCODE           SETC  '&RSNCODE'  SET XVARIABLE                     00143700
.ZG37C              ANOP  ,                                             00143800
.*-------------------------------------------------------------------   00143900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00144000
                    AIF   (K'&ZXRSNCODE LE 0).ZG37R  NOT I/O            00144100
                    AIF   ('&XRSNCODE'(1,1) NE '(').ZG37R               00144200
&ZCGPR              SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                  00144300
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                  00144400
                    AIF   (K'&ZCGPR GT 2).ZG37Q                         00144500
                    AIF   ('&ZCGPR' EQ '0').ZG37R                       00144600
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00144700
                    AIF   (T'&ZCGPR NE 'N').ZG37Q  INVALID REG NAME     00144800
.ZG37P              ANOP  ,                                             00144900
                    AIF   (T'&ZCGPR NE 'N').ZG37R  NON NUMERIC          00145000
                    AIF   ('&ZCGPR' EQ '0').ZG37R                       00145100
                    AIF   ('&ZCGPR' LT '2').ZG37Q                       00145200
                    AIF   ('&ZCGPR' LE '12').ZG37R                      00145300
.ZG37Q              ANOP  ,                                             00145400
&ZMS                SETC  '"RSNCODE='                                   00145500
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00145600
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00145700
                    MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'       00145800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00145900
.ZG37R              ANOP  ,                                             00146000
.******************************************************************     00146100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00146200
.******************************************************************     00146300
                    ACTR  10000                                         00146400
.*-------------------------------------------------------------------   00146500
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00146600
&ZCVAL              SETC  ''          ERROR FIELD                       00146700
&ZAWRK              SETA  0           POSITIONAL COUNTER                00146800
&ZASYSLNDX          SETA  0           NON-X KEY COUNTER                 00146900
.ZGLIST2            ANOP  ,                                             00147000
&ZASYSLNDX          SETA  &ZASYSLNDX+1          NEXT NON-X KEY          00147100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00147200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00147300
&ZAWRK              SETA  &ZAWRK+1    NEXT POSITIONAL                   00147400
                    AIF   (&ZAWRK LE 0).ZGLIST2                         00147500
&ZCVAL              SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA           00147600
                    AGO   .ZGLIST2                                      00147700
.*                                                                      00147800
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00147900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA            00148000
&ZMS                SETC  'POSITIONAL ARGUMENT(S),'                     00148100
&ZMS                SETC  '&ZMS "&ZCVAL"'                               00148200
&ZMS                SETC  '&ZMS CANNOT BE USED.'                        00148300
&ZMS                SETC  '&ZMS NO POSITIONAL ARGUMENTS'                00148400
                    MNOTE 8,' &ZMS ARE ALLOWED.'                        00148500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00148600
.ZGLISTX            ANOP  ,                                             00148700
&ZASYSLNDX          SETA  0                                             00148800
.*-------------------------------------------------------------------   00148900
.***AG.MF04 MF=(SLE)                                                    00149000
.ZGMFX              ANOP  ,           END OF FULL SYNTAX CHECK          00149100
.*******************************************************************    00149200
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00149300
.*******************************************************************    00149400
                    AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED          00149500
.*******************************************************************    00149600
.***AE.01  START OF IOSODS MACRO CODE                                   00149700
.*******************************************************************    00149800
                    LCLC  &M0M0001                 NAME                 00149900
&M0M0001            SETC  '&XLABEL'                SET NAME             00150000
                    AIF   (K'&XLABEL NE 0).XLAB2                        00150100
&M0M0001            SETC  'M00M&SYSNDX'            DEFAULT NAME         00150200
.*                                                                      00150300
.XLAB2              ANOP  ,                                             00150400
                    AIF   ('&XMF' EQ 'L').XLAB3                         00150500
&M0M0001 DS    0H                             IOSODS-1                  00150600
.XLAB3              ANOP  ,                                             00150700
.*******************************************************************    00150800
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00150900
.*******************************************************************    00151000
              PUSH  PRINT                                               00151100
                    AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON    00151200
                    PRINT OFF         ++ PR01                           00151300
                    AGO   .ZPRNTXX                                      00151400
.ZPRINTX            PRINT ON                                            00151500
.ZPRNTXX            ANOP  ,                                             00151600
.********************************************************************   00151700
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00151800
.********************************************************************   00151900
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00152000
                      LCLA  &ZOPN1         INVOCATION INDEX             00152100
                      LCLC  &ZOPL(4095)    LABEL                        00152200
                      LCLC  &ZOPO(4095)    OPERATION                    00152300
                      LCLC  &ZOPV(4095)    VALUE                        00152400
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00152500
.*                                                                      00152600
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00152700
.******************************************************************     00152800
.***AL.L10 IOSODS FMT=LIST MF=S!L PARAMETERS                            00152900
.******************************************************************     00153000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00153100
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00153200
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00153300
&XMFATTR              SETC  '0D'                                        00153400
.*                                                                      00153500
&ZOPN                 SETA  &ZOPN+1                                     00153600
&ZOPL(&ZOPN)          SETC  ' '                                         00153700
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00153800
&ZOPO(&ZOPN)          SETC  'B'                                         00153900
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00154000
                      AGO   .ZALVL6B                                    00154100
.ZALVL6A              ANOP                                              00154200
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00154300
&ZOPV(&ZOPN)          SETC  '4,8'                                       00154400
&ZOPN                 SETA  &ZOPN+1                                     00154500
&ZOPL(&ZOPN)          SETC  ' '                                         00154600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00154700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00154800
.ZALVL6B              ANOP                                              00154900
&ZOPD(&ZOPN)          SETC  '++ IOSODS ARG PARMS'                       00155000
.*                                                                      00155100
&ZOPN                 SETA  &ZOPN+1                                     00155200
&ZOPL(&ZOPN)          SETC  ' '                                         00155300
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00155400
&ZOPV(&ZOPN)          SETC  '1'                                         00155500
&ZOPD(&ZOPN)          SETC  ' '                                         00155600
.*                                                                      00155700
.ZLMFSL2              ANOP  ,                                           00155800
.*-------------------------------------------------------------------   00155900
.***AM.L00  IOSODS FMT=LIST name                                        00156000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00156100
&ZOPN                 SETA &ZOPN+1                                      00156200
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00156300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00156400
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00156500
&ZOPD(&ZOPN)          SETC '++ IOSODS NAME'                             00156600
.ZLMFSL2M             ANOP  ,                                           00156700
.*-------------------------------------------------------------------   00156800
.***AM.L01  IOSODS FMT=LIST PARAMETERS                                  00156900
&ZOPN                 SETA &ZOPN+1                                      00157000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00157100
&ZOPO(&ZOPN)          SETC 'DS'                                         00157200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00157300
&ZOPD(&ZOPN)          SETC '++ IOSODS PARM LIST'                        00157400
.*-------------------------------------------------------------------   00157500
.***AM.L02 XVERSION XL1                                                 00157600
&ZOPN                 SETA &ZOPN+1                                      00157700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00157800
&ZOPO(&ZOPN)          SETC 'DS'                                         00157900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00158000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00158100
.*-------------------------------------------------------------------   00158200
.***AM.L05 XSERVICE XL1                                                 00158300
&ZOPN                 SETA &ZOPN+1                                      00158400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVICE'                         00158500
&ZOPO(&ZOPN)          SETC 'DS'                                         00158600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00158700
&ZOPD(&ZOPN)          SETC '++ &ZXSERVICE XSERVICE'                     00158800
.*                                                                      00158900
&ZOPN                 SETA  &ZOPN+1                                     00159000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._ON'                              00159100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00159200
&ZOPV(&ZOPN)          SETC  '1'                                         00159300
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00159400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ON'                           00159500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00159600
.*                                                                      00159700
&ZOPN                 SETA  &ZOPN+1                                     00159800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._OFF'                             00159900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00160000
&ZOPV(&ZOPN)          SETC  '2'                                         00160100
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00160200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).OFF'                          00160300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00160400
.*-------------------------------------------------------------------   00160500
.***AM.L03 XFLAGS BL.8                                                  00160600
&ZOPN                 SETA &ZOPN+1                                      00160700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00160800
&ZOPO(&ZOPN)          SETC 'DS'                                         00160900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00161000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00161100
.*                                                                      00161200
&ZOPN                 SETA  &ZOPN+1                                     00161300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XWLMPAVSUSPEND_WLMPAVSUSPEND'    00161400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00161500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00161600
&ZOPD(&ZOPN)          SETC  '++ XWLMPAVSUSPEND.'                        00161700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).WLMPAVSUSPEND'                00161800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00161900
.*                                                                      00162000
&ZOPN                 SETA  &ZOPN+1                                     00162100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XWLMPAVRESTORE_WLMPAVRESTORE'    00162200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00162300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00162400
&ZOPD(&ZOPN)          SETC  '++ XWLMPAVRESTORE.'                        00162500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).WLMPAVRESTORE'                00162600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00162700
.*                                                                      00162800
&ZOPN                 SETA  &ZOPN+1                                     00162900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DEVN'                    00163000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00163100
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00163200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00163300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEVN'                         00163400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00163500
.*                                                                      00163600
&ZOPN                 SETA  &ZOPN+1                                     00163700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DEVNCHAR'                00163800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00163900
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00164000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00164100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEVNCHAR'                     00164200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00164300
.*                                                                      00164400
&ZOPN                 SETA  &ZOPN+1                                     00164500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_LDEVNCHAR'               00164600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00164700
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00164800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00164900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LDEVNCHAR'                    00165000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00165100
.*                                                                      00165200
&ZOPN                 SETA  &ZOPN+1                                     00165300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SCHSET'                  00165400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00165500
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00165600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00165700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SCHSET'                       00165800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00165900
.*                                                                      00166000
&ZOPN                 SETA  &ZOPN+1                                     00166100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XBYPONLINEFENCE_BYPONLINEFENCE'  00166200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00166300
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00166400
&ZOPD(&ZOPN)          SETC  '++ XBYPONLINEFENCE.'                       00166500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).BYPONLINEFENCE'               00166600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00166700
.*                                                                      00166800
&ZOPN                 SETA  &ZOPN+1                                     00166900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XBYPALIAS_YES'                   00167000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00167100
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00167200
&ZOPD(&ZOPN)          SETC  '++ XBYPALIAS.'                             00167300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00167400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00167500
.*-------------------------------------------------------------------   00167600
.***AM.L03 XFLAGS2 BL.8                                                 00167700
&ZOPN                 SETA &ZOPN+1                                      00167800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS2'                          00167900
&ZOPO(&ZOPN)          SETC 'DS'                                         00168000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00168100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00168200
.*                                                                      00168300
&ZOPN                 SETA  &ZOPN+1                                     00168400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XUNCOND_UNCOND'                  00168500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00168600
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00168700
&ZOPD(&ZOPN)          SETC  '++ XUNCOND.'                               00168800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UNCOND'                       00168900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00169000
.*-------------------------------------------------------------------   00169100
.***AM.L09  XDEVN XL2                                                   00169200
&ZOPN                 SETA &ZOPN+1                                      00169300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVN'                            00169400
&ZOPO(&ZOPN)          SETC 'DS'                                         00169500
&ZOPV(&ZOPN)          SETC 'XL2'                                        00169600
&ZOPD(&ZOPN)          SETC '++ &ZXDEVN '                                00169700
.*-------------------------------------------------------------------   00169800
.***AM.L09  XRESERVED2 CL2                                              00169900
&ZOPN                 SETA &ZOPN+1                                      00170000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       00170100
&ZOPO(&ZOPN)          SETC 'DS'                                         00170200
&ZOPV(&ZOPN)          SETC 'CL2'                                        00170300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00170400
.*-------------------------------------------------------------------   00170500
.***AM.L09  XLDEVNCHAR CL5                                              00170600
&ZOPN                 SETA &ZOPN+1                                      00170700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XLDEVNCHAR'                       00170800
&ZOPO(&ZOPN)          SETC 'DS'                                         00170900
&ZOPV(&ZOPN)          SETC 'CL5'                                        00171000
&ZOPD(&ZOPN)          SETC '++ &ZXLDEVNCHAR '                           00171100
.*-------------------------------------------------------------------   00171200
.***AM.L09  XRESERVED3 CL11                                             00171300
&ZOPN                 SETA &ZOPN+1                                      00171400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED3'                       00171500
&ZOPO(&ZOPN)          SETC 'DS'                                         00171600
&ZOPV(&ZOPN)          SETC 'CL11'                                       00171700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00171800
.*-------------------------------------------------------------------   00171900
.***AM.MLM1 SAVED LOCATION COUNTER                                      00172000
                      AIF  ('&ZENDBASEPL' NE '').ZL20LB                 00172100
&ZENDBASEPL           SETC 'YES'                                        00172200
&ZOPN                 SETA &ZOPN+1                                      00172300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00172400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00172500
&ZOPV(&ZOPN)          SETC '*'                                          00172600
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00172700
.ZL20LB               ANOP  ,                                           00172800
.*-------------------------------------------------------------------   00172900
.***AM.PJR1 DEFINED ON XLDEVNCHAR                                       00173000
&ZOPN                 SETA &ZOPN+1                                      00173100
&ZOPL(&ZOPN)          SETC ' '                                          00173200
&ZOPO(&ZOPN)          SETC 'ORG'                                        00173300
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+8'                                00173400
&ZOPD(&ZOPN)          SETC ' '                                          00173500
.*-------------------------------------------------------------------   00173600
.***AM.L09  XSCHSET XL1                                                 00173700
&ZOPN                 SETA &ZOPN+1                                      00173800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSCHSET'                          00173900
&ZOPO(&ZOPN)          SETC 'DS'                                         00174000
&ZOPV(&ZOPN)          SETC 'XL1'                                        00174100
&ZOPD(&ZOPN)          SETC '++ &ZXSCHSET '                              00174200
.*-------------------------------------------------------------------   00174300
.***AM.L09  XDEVNCHAR CL4                                               00174400
&ZOPN                 SETA &ZOPN+1                                      00174500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVNCHAR'                        00174600
&ZOPO(&ZOPN)          SETC 'DS'                                         00174700
&ZOPV(&ZOPN)          SETC 'CL4'                                        00174800
&ZOPD(&ZOPN)          SETC '++ &ZXDEVNCHAR '                            00174900
&ZOPN                 SETA &ZOPN+1                                      00175000
&ZOPL(&ZOPN)          SETC ' '                                          00175100
&ZOPO(&ZOPN)          SETC 'ORG'                                        00175200
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00175300
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00175400
.*-------------------------------------------------------------------   00175500
.***AM.L10 END OF IOSODS LIST PARAMETERS                                00175600
&ZOPN                 SETA &ZOPN+1                                      00175700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00175800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00175900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00176000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00176100
.*                                                                      00176200
&ZOPN                 SETA &ZOPN+1                                      00176300
&ZOPL(&ZOPN)          SETC ' '                                          00176400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00176500
&ZOPV(&ZOPN)          SETC '1'                                          00176600
&ZOPD(&ZOPN)          SETC ' '                                          00176700
.*-------------------------------------------------------------------   00176800
.***AL.L12 IOSODS FMT=LIST MF=S!L PARAMETERS                            00176900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00177000
.*                                                                      00177100
&ZOPN                 SETA  &ZOPN+1                                     00177200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00177300
&ZOPO(&ZOPN)          SETC  'DC'                                        00177400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00177500
&ZOPD(&ZOPN)          SETC  '++ IOSODS ARG PARMS'                       00177600
.*                                                                      00177700
.ZLMFSLX              ANOP  ,                                           00177800
.*-------------------------------------------------------------------   00177900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00178000
&ZPLLEN               SETA 24                                           00178100
.*                                                                      00178200
.******************************************************************     00178300
.***AI.L01 IOSODS FMT=LIST FILL IN PARAMETER AREA                       00178400
.******************************************************************     00178500
                      ACTR  10000                                       00178600
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00178700
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00178800
&ZCVAL                SETC  'LAE'          XAX MODE                     00178900
.ZIMFXA               ANOP ,                                            00179000
.*                                                                      00179100
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00179200
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00179300
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00179400
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00179500
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00179600
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00179700
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00179800
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00179900
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00180000
&ZOPN                 SETA  &ZOPN+1                                     00180100
&ZOPL(&ZOPN)          SETC  ' '                                         00180200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00180300
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00180400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00180500
                      AGO   .ZIMFNX                                     00180600
.*                                                                      00180700
.ZIMFN2               ANOP ,                                            00180800
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00180900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00181000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00181100
&ZOPN                 SETA  &ZOPN+1                                     00181200
&ZOPL(&ZOPN)          SETC  ' '                                         00181300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00181400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00181500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00181600
                      AGO   .ZIMFNX                                     00181700
.ZIMFNX1              ANOP ,                                            00181800
&ZOPN                 SETA  &ZOPN+1                                     00181900
&ZOPL(&ZOPN)          SETC  ' '                                         00182000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00182100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00182200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00182300
.ZIMFNX               ANOP ,                                            00182400
.********************************************************************   00182500
.***AI.L02 IOSODS FMT=LIST INITIALIZE PARAMETER AREA                    00182600
.********************************************************************   00182700
.***AI.L03 MF=(SLE)                                                     00182800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00182900
.*                                                                      00183000
&ZOPN                 SETA  &ZOPN+1                                     00183100
&ZOPL(&ZOPN)          SETC  ' '                                         00183200
&ZOPO(&ZOPN)          SETC  'XC'                                        00183300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00183400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00183500
.ZIMFLX               ANOP  ,                                           00183600
.*-------------------------------------------------------------------   00183700
.***AI.L04B XVERSION XL1                                                00183800
                      AIF   (&XPLISTVER EQ 0).ZIMFVZ                    00183900
&ZOPN                 SETA  &ZOPN+1                                     00184000
&ZOPL(&ZOPN)          SETC  ' '                                         00184100
&ZOPO(&ZOPN)          SETC  'MVI'                                       00184200
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00184300
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00184400
.ZIMFVZ               ANOP  ,                                           00184500
.*-------------------------------------------------------------------   00184600
.***AI.L07 XSERVICE AL1                                                 00184700
&ZW                   SETC  ''                                          00184800
.*-------------------------------------------------------------------   00184900
.***AI.L15 XSERVICE "ON" AL1                                            00185000
         AIF   ('&XSERVICE' NE 'ON').ZI3A                               00185100
&ZW                   SETC  '1'                                         00185200
.ZI3A                 ANOP  ,                                           00185300
.*-------------------------------------------------------------------   00185400
.***AI.L15 XSERVICE "OFF" AL1                                           00185500
         AIF   ('&XSERVICE' NE 'OFF').ZI4A                              00185600
&ZW                   SETC  '2'                                         00185700
.ZI4A                 ANOP  ,                                           00185800
.*-------------------------------------------------------------------   00185900
.***AI.L17 XSERVICE AL1                                                 00186000
                      AIF   ('&ZW' EQ '0').ZI4B                         00186100
                      AIF   ('&ZW' EQ '').ZI4B                          00186200
.*                                                                      00186300
&ZOPN                 SETA  &ZOPN+1                                     00186400
&ZOPL(&ZOPN)          SETC  ' '                                         00186500
&ZOPO(&ZOPN)          SETC  'MVI'                                       00186600
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  00186700
&ZOPD(&ZOPN)          SETC  '++ &ZXSERVICE XSERVICE'                    00186800
.ZI4B                 ANOP  ,                                           00186900
.*-------------------------------------------------------------------   00187000
.***AI.L05 XFLAGS BL1                                                   00187100
&ZW                   SETC  ''                                          00187200
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00187300
.*-------------------------------------------------------------------   00187400
.***AI.L08 XFLAGS "WLMPAVSUSPEND"                                       00187500
.***      BL1'1XXXXXXX'                                                 00187600
         AIF   ('&XWLMPAVSUSPEND' NE 'WLMPAVSUSPEND').ZI6A              00187700
&ZW                   SETC  '&ZW.1'                                     00187800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00187900
                      AGO   .ZI6C                                       00188000
.*                                                                      00188100
.ZI6A                 ANOP  ,                                           00188200
&ZW                   SETC  '&ZW.0'                                     00188300
.ZI6C                 ANOP  ,                                           00188400
.*-------------------------------------------------------------------   00188500
.***AI.L08 XFLAGS "WLMPAVRESTORE"                                       00188600
.***      BL1'X1XXXXXX'                                                 00188700
         AIF   ('&XWLMPAVRESTORE' NE 'WLMPAVRESTORE').ZI7A              00188800
&ZW                   SETC  '&ZW.1'                                     00188900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00189000
                      AGO   .ZI7C                                       00189100
.*                                                                      00189200
.ZI7A                 ANOP  ,                                           00189300
&ZW                   SETC  '&ZW.0'                                     00189400
.ZI7C                 ANOP  ,                                           00189500
.*-------------------------------------------------------------------   00189600
.***AI.L08 XFLAGS "DEVN"                                                00189700
.***      BL1'XX1XXXXX'                                                 00189800
         AIF   ('&DEVN' EQ '').ZI8A                                     00189900
&ZW                   SETC  '&ZW.1'                                     00190000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00190100
                      AGO   .ZI8C                                       00190200
.*                                                                      00190300
.ZI8A                 ANOP  ,                                           00190400
&ZW                   SETC  '&ZW.0'                                     00190500
.ZI8C                 ANOP  ,                                           00190600
.*-------------------------------------------------------------------   00190700
.***AI.L08 XFLAGS "DEVNCHAR"                                            00190800
.***      BL1'XXX1XXXX'                                                 00190900
         AIF   ('&DEVNCHAR' EQ '').ZI9A                                 00191000
&ZW                   SETC  '&ZW.1'                                     00191100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00191200
                      AGO   .ZI9C                                       00191300
.*                                                                      00191400
.ZI9A                 ANOP  ,                                           00191500
&ZW                   SETC  '&ZW.0'                                     00191600
.ZI9C                 ANOP  ,                                           00191700
.*-------------------------------------------------------------------   00191800
.***AI.L08 XFLAGS "LDEVNCHAR"                                           00191900
.***      BL1'XXXX1XXX'                                                 00192000
         AIF   ('&LDEVNCHAR' EQ '').ZI10A                               00192100
&ZW                   SETC  '&ZW.1'                                     00192200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00192300
                      AGO   .ZI10C                                      00192400
.*                                                                      00192500
.ZI10A                ANOP  ,                                           00192600
&ZW                   SETC  '&ZW.0'                                     00192700
.ZI10C                ANOP  ,                                           00192800
.*-------------------------------------------------------------------   00192900
.***AI.L08 XFLAGS "SCHSET"                                              00193000
.***      BL1'XXXXX1XX'                                                 00193100
         AIF   ('&SCHSET' EQ '').ZI11A                                  00193200
&ZW                   SETC  '&ZW.1'                                     00193300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00193400
                      AGO   .ZI11C                                      00193500
.*                                                                      00193600
.ZI11A                ANOP  ,                                           00193700
&ZW                   SETC  '&ZW.0'                                     00193800
.ZI11C                ANOP  ,                                           00193900
.*-------------------------------------------------------------------   00194000
.***AI.L08 XFLAGS "BYPONLINEFENCE"                                      00194100
.***      BL1'XXXXXX1X'                                                 00194200
         AIF   ('&XBYPONLINEFENCE' NE 'BYPONLINEFENCE').ZI12A           00194300
&ZW                   SETC  '&ZW.1'                                     00194400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00194500
                      AGO   .ZI12C                                      00194600
.*                                                                      00194700
.ZI12A                ANOP  ,                                           00194800
&ZW                   SETC  '&ZW.0'                                     00194900
.ZI12C                ANOP  ,                                           00195000
.*-------------------------------------------------------------------   00195100
.***AI.L08 XFLAGS "YES"                                                 00195200
.***      BL1'XXXXXXX1'                                                 00195300
         AIF   ('&XBYPALIAS' NE 'YES').ZI13A                            00195400
&ZW                   SETC  '&ZW.1'                                     00195500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00195600
                      AGO   .ZI13C                                      00195700
.*                                                                      00195800
.ZI13A                ANOP  ,                                           00195900
&ZW                   SETC  '&ZW.0'                                     00196000
.ZI13C                ANOP  ,                                           00196100
.*-------------------------------------------------------------------   00196200
.***AI.L11 XFLAGS BL1                                                   00196300
                      AIF   ('&ZCLNG' NE 'YES').ZI13E  ALL ZERO BITS    00196400
&ZOPN                 SETA  &ZOPN+1                                     00196500
&ZOPL(&ZOPN)          SETC  ' '                                         00196600
&ZOPO(&ZOPN)          SETC  'OI'                                        00196700
&ZOPV(&ZOPN)          SETC  '2(1),B''&ZW'''                             00196800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00196900
.ZI13E                ANOP  ,                                           00197000
.*-------------------------------------------------------------------   00197100
.***AI.L05 XFLAGS2 BL1                                                  00197200
&ZW                   SETC  ''                                          00197300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00197400
.*-------------------------------------------------------------------   00197500
.***AI.L08 XFLAGS2 "UNCOND"                                             00197600
.***      BL1'1XXXXXXX'                                                 00197700
         AIF   ('&XUNCOND' NE 'UNCOND').ZI15A                           00197800
&ZW                   SETC  '&ZW.10000000'                              00197900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00198000
                      AGO   .ZI15C                                      00198100
.*                                                                      00198200
.ZI15A                ANOP  ,                                           00198300
&ZW                   SETC  '&ZW.00000000'                              00198400
.ZI15C                ANOP  ,                                           00198500
.*-------------------------------------------------------------------   00198600
.***AI.L11 XFLAGS2 BL1                                                  00198700
                      AIF   ('&ZCLNG' NE 'YES').ZI15E  ALL ZERO BITS    00198800
&ZOPN                 SETA  &ZOPN+1                                     00198900
&ZOPL(&ZOPN)          SETC  ' '                                         00199000
&ZOPO(&ZOPN)          SETC  'OI'                                        00199100
&ZOPV(&ZOPN)          SETC  '3(1),B''&ZW'''                             00199200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00199300
.ZI15E                ANOP  ,                                           00199400
.*-------------------------------------------------------------------   00199500
.***AI.L25  XDEVN XL2                                                   00199600
                      AIF   ('&ZXDEVN' EQ '').ZI16E                     00199700
                      AIF   ('&ZXDEVN' EQ 'OUTPUT').ZI16E               00199800
&ZCGPR                SETC  '&XDEVN'                                    00199900
.*                                                                      00200000
                      AIF   ('&XDEVN'(1,1) NE '(').ZI16B                00200100
&ZCGPR   SETC  '0('.'&XDEVN'(2,K'&XDEVN-2).')'                          00200200
                      AGO   .ZI16D                                      00200300
.ZI16B                ANOP  ,                                           00200400
.*                                                                      00200500
&ZC                   SETC  '&XDEVN'(1,1)                               00200600
                      AIF   (T'&ZC NE 'N').ZI16D                        00200700
&ZC                   SETC  '&XDEVN'                                    00200800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               00200900
&ZCGPR                SETC  '=AL2(&XDEVN)'                              00201000
.*                                                                      00201100
.ZI16D                ANOP  ,                                           00201200
.*                                                                      00201300
&ZOPN                 SETA  &ZOPN+1                                     00201400
&ZOPL(&ZOPN)          SETC  ' '                                         00201500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00201600
&ZOPV(&ZOPN)          SETC  '4(2,1),&ZCGPR'                             00201700
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVN XDEVN'                          00201800
.*                                                                      00201900
.ZI16E                ANOP  ,                                           00202000
.*-------------------------------------------------------------------   00202100
.***AI.L25  XLDEVNCHAR CL5                                              00202200
                      AIF   ('&ZXLDEVNCHAR' EQ '').ZI18E                00202300
                      AIF   ('&ZXLDEVNCHAR' EQ 'OUTPUT').ZI18E          00202400
&ZCGPR                SETC  '&XLDEVNCHAR'                               00202500
.*                                                                      00202600
                      AIF   ('&XLDEVNCHAR'(1,1) NE '(').ZI18B           00202700
&ZCGPR   SETC  '0('.'&XLDEVNCHAR'(2,K'&XLDEVNCHAR-2).')'                00202800
.ZI18B                ANOP  ,                                           00202900
.*                                                                      00203000
&ZOPN                 SETA  &ZOPN+1                                     00203100
&ZOPL(&ZOPN)          SETC  ' '                                         00203200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00203300
&ZOPV(&ZOPN)          SETC  '8(5,1),&ZCGPR'                             00203400
&ZOPD(&ZOPN)          SETC  '++ &ZXLDEVNCHAR XLDEVNCHAR'                00203500
.*                                                                      00203600
.ZI18E                ANOP  ,                                           00203700
.*-------------------------------------------------------------------   00203800
.***AI.L25  XSCHSET XL1                                                 00203900
                      AIF   ('&ZXSCHSET' EQ '').ZI21E                   00204000
                      AIF   ('&ZXSCHSET' EQ 'OUTPUT').ZI21E             00204100
&ZCGPR                SETC  '&XSCHSET'                                  00204200
         AIF   ('&XSCHSET' EQ '0').ZI21E                                00204300
         AIF   ('&XSCHSET' EQ '0').ZI21E                                00204400
.*                                                                      00204500
                      AIF   ('&XSCHSET'(1,1) NE '(').ZI21B              00204600
&ZCGPR   SETC  '0('.'&XSCHSET'(2,K'&XSCHSET-2).')'                      00204700
                      AGO   .ZI21D                                      00204800
.ZI21B                ANOP  ,                                           00204900
.*                                                                      00205000
&ZC                   SETC  '&XSCHSET'(1,1)                             00205100
                      AIF   (T'&ZC NE 'N').ZI21D                        00205200
&ZC                   SETC  '&XSCHSET'                                  00205300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI21D               00205400
&ZCGPR                SETC  '=AL1(&XSCHSET)'                            00205500
.*                                                                      00205600
.ZI21D                ANOP  ,                                           00205700
.*                                                                      00205800
&ZOPN                 SETA  &ZOPN+1                                     00205900
&ZOPL(&ZOPN)          SETC  ' '                                         00206000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00206100
&ZOPV(&ZOPN)          SETC  '8(1,1),&ZCGPR'                             00206200
&ZOPD(&ZOPN)          SETC  '++ &ZXSCHSET XSCHSET'                      00206300
.*                                                                      00206400
.ZI21E                ANOP  ,                                           00206500
.*-------------------------------------------------------------------   00206600
.***AI.L25  XDEVNCHAR CL4                                               00206700
                      AIF   ('&ZXDEVNCHAR' EQ '').ZI22E                 00206800
                      AIF   ('&ZXDEVNCHAR' EQ 'OUTPUT').ZI22E           00206900
&ZCGPR                SETC  '&XDEVNCHAR'                                00207000
.*                                                                      00207100
                      AIF   ('&XDEVNCHAR'(1,1) NE '(').ZI22B            00207200
&ZCGPR   SETC  '0('.'&XDEVNCHAR'(2,K'&XDEVNCHAR-2).')'                  00207300
.ZI22B                ANOP  ,                                           00207400
.*                                                                      00207500
&ZOPN                 SETA  &ZOPN+1                                     00207600
&ZOPL(&ZOPN)          SETC  ' '                                         00207700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00207800
&ZOPV(&ZOPN)          SETC  '9(4,1),&ZCGPR'                             00207900
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVNCHAR XDEVNCHAR'                  00208000
.*                                                                      00208100
.ZI22E                ANOP  ,                                           00208200
.*-------------------------------------------------------------------   00208300
&ZOPN1                SETA &ZOPN                                        00208400
.*******************************************************************    00208500
.***  PROCESS IOSODS OUTPUT PARAMETERS                                  00208600
.*******************************************************************    00208700
                      ACTR  10000                                       00208800
.*******************************************************************    00208900
.***AO.X02  RETURN CODE PROCESSING                                      00209000
.*******************************************************************    00209100
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00209200
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00209300
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00209400
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00209500
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00209600
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00209700
&ZOPN                 SETA  &ZOPN+1                                     00209800
&ZOPL(&ZOPN)          SETC  ' '                                         00209900
&ZOPO(&ZOPN)          SETC  'ST'                                        00210000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00210100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00210200
                      AGO   .ZMRETX                                     00210300
.*                                                                      00210400
.ZMRET2               ANOP  ,                                           00210500
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00210600
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00210700
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00210800
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00210900
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00211000
&ZOPN                 SETA  &ZOPN+1                                     00211100
&ZOPL(&ZOPN)          SETC  ' '                                         00211200
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00211300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00211400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00211500
.ZMRETX               ANOP  ,                                           00211600
.*******************************************************************    00211700
.***AO.X03  REASON CODE PROCESSING                                      00211800
.*******************************************************************    00211900
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00212000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00212100
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00212200
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00212300
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00212400
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00212500
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00212600
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00212700
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00212800
&ZOPN                 SETA  &ZOPN+1                                     00212900
&ZOPL(&ZOPN)          SETC  ' '                                         00213000
&ZOPO(&ZOPN)          SETC  'ST'                                        00213100
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00213200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00213300
                      AGO   .ZMRSNX                                     00213400
.*                                                                      00213500
.ZMRSN2               ANOP  ,                                           00213600
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00213700
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00213800
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00213900
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00214000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00214100
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00214200
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00214300
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00214400
&ZOPN                 SETA  &ZOPN+1                                     00214500
&ZOPL(&ZOPN)          SETC  ' '                                         00214600
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00214700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00214800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00214900
.ZMRSNX               ANOP  ,                                           00215000
.*******************************************************************    00215100
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00215200
.*******************************************************************    00215300
.ZMFLX                ANOP  ,              MF=L PROCESSING              00215400
.*******************************************************************    00215500
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00215600
.*******************************************************************    00215700
                      ACTR  10000                                       00215800
.*                                                                      00215900
                      LCLA  &ZLC           COLUMN POSITION              00216000
                      LCLA  &ZOPX          LIST TABLE INDEX             00216100
                      LCLC  &ZLL           LABEL                        00216200
                      LCLC  &ZLOP          OPERATION                    00216300
                      LCLC  &ZLV           VALUE                        00216400
                      LCLC  &ZLD           DESCRIPTION                  00216500
.*                                                                      00216600
&ZOPX                 SETA  1                                           00216700
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00216800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00216900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00217000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00217100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00217200
                      AIF   (K'&ZLD LE 0).ZL5                           00217300
&ZLC                  SETA  35             COMMENT COLUMN               00217400
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00217500
&ZLC                  SETA  33             COMMMENT COLUMN              00217600
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00217700
&ZLV                  SETC  '&ZLV'.' '                                  00217800
                      AGO   .ZL3                                        00217900
.*                                                                      00218000
.ZL4                  ANOP  ,                                           00218100
&ZLV                  SETC  '&ZLV'.' '                                  00218200
.ZL5                  ANOP  ,                                           00218300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00218400
.*                                                                      00218500
&ZLL     &ZLOP &ZLV                                                     00218600
.*                                                                      00218700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00218800
                      AGO   .ZL2           CONTINUE LOOPING             00218900
.*                                                                      00219000
.ZLX                  ANOP  ,                                           00219100
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00219200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00219300
.*-----------BAL invocation code-------------                           00219400
         LA    0,0                ++ Clear register zero                00219500
         LINK EP=IOSVODS          ++ Link to IOSVODS                    00219600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00219700
.ZLINKX               ANOP  ,                                           00219800
.*******************************************************************    00219900
.***AP.X01  FORMAT GENERATED CODE                                       00220000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00220100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00220200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00220300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00220400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00220500
                      AIF   (K'&ZLD LE 0).ZL51                          00220600
&ZLC                  SETA  35             COMMENT COLUMN               00220700
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00220800
&ZLC                  SETA  33             COMMENT COLUMN               00220900
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00221000
&ZLV                  SETC  '&ZLV'.' '                                  00221100
                      AGO   .ZL31                                       00221200
.*                                                                      00221300
.ZL41                 ANOP  ,                                           00221400
&ZLV                  SETC  '&ZLV'.' '                                  00221500
.ZL51                 ANOP  ,                                           00221600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00221700
.*                                                                      00221800
&ZLL     &ZLOP &ZLV                                                     00221900
.*                                                                      00222000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00222100
                      AGO   .ZL21          CONTINUE LOOPING             00222200
.*                                                                      00222300
.ZLX1                 ANOP  ,                                           00222400
.*******************************************************************    00222500
.***AP.X02  END OF IOSODS MACRO                                         00222600
&ZIOSODS              SETC  'YES'          SET IOSODS USED              00222700
         POP   PRINT                                                    00222800
*                                            IOSODS-1                   00222900
         SPACE 1                                                        00223000
.ZLX2                 ANOP  ,                                           00223100
         MEND                                                           00223200
**********************************************************************/ 00223300
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00223400
*%IOSODS: MACRO KEYS(ON,BYPONLINEFENCE,BYPALIAS,WLMPAVSUSPEND,UNCOND,   00223500
*                 OFF,WLMPAVRESTORE,DEVN,SCHSET,DEVNCHAR,LDEVNCHAR,     00223600
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00223700
*  ANS('?'!!MACLABEL!!' '!!'IOSODSP '!!MACLIST!!                        00223800
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00223900
*%END IOSODS;                                                           00224000

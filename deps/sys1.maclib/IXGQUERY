*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXGQUERY                              -19/04/11-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Query System Logger                           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 1997, 2019                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77C0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IXGQUERY macro allows a user to retrieve information about * 00002100
*      a log stream or system logger parameter information.           * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00002400
*                                                                     * 00002500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002600
*                                                                     * 00002700
*01* ENVIRONMENT:                                                     * 00002800
*                                                                     * 00002900
*                                                                     * 00003000
*      Dispatchable unit mode: Task mode.                             * 00003100
*                                                                     * 00003200
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00003300
*                                                                     * 00003400
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00003500
*                        key.                                         * 00003600
*                                                                     * 00003700
*      AMODE:            31- or 64-bit.                               * 00003800
*                                                                     * 00003900
*      ASC mode:         Primary or Access Register.                  * 00004000
*                                                                     * 00004100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004200
*                                                                     * 00004300
*      Locks:            No locks held.                               * 00004400
*                                                                     * 00004500
*      Control parameters: None.                                      * 00004600
*                                                                     * 00004700
*                                                                     * 00004800
*                                                                     * 00004900
*01* PROGRAMMING REQUIREMENTS:                                        * 00005000
*                                                                     * 00005100
*                                                                     * 00005200
*    o   The parameter list for this service must be addressable in   * 00005300
*        the caller's primary address space.                          * 00005400
*                                                                     * 00005500
*    o   Include the IXGCON mapping macro in your program. This macro * 00005600
*        provides a list of equate symbols for the system logger      * 00005700
*        services.                                                    * 00005800
*                                                                     * 00005900
*    o   Include mapping macro IXGANSAA in your program. This macro   * 00006000
*        shows the format of the answer area output returned for each * 00006100
*        system logger service in the ANSAREA parameter.              * 00006200
*                                                                     * 00006300
*    o   When coding REQUEST=LSCONNINFO or when using default:        * 00006400
*                                                                     * 00006500
*                                                                     * 00006600
*        -   The caller must have a valid connection to the log       * 00006700
*            stream.                                                  * 00006800
*                                                                     * 00006900
*        -   The current primary address space must be the same as    * 00007000
*            the HOME address space at the time you issued the        * 00007100
*            IXGCONN macro.                                           * 00007200
*                                                                     * 00007300
*        -   Include mapping macro IXGQBUF in your program when       * 00007400
*            CHECKCONNSTATUS=NO is specified.  This macro shows the   * 00007500
*            format of the data returned by IXGQUERY.                 * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*    o   When coding REQUEST=ZAILOCINFO:                              * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*        -   The current primary address space must be the same as    * 00008300
*            the HOME address space, unless a log stream connection   * 00008400
*            (IXGCONN connect) request was previously performed from  * 00008500
*            the primary address space.                               * 00008600
*                                                                     * 00008700
*        -   Include mapping macro IXGQZBUF in your program.  This    * 00008800
*            macro shows the format of the data returned by this      * 00008900
*            IXGQUERY.                                                * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*01* RESTRICTIONS:                                                    * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*    o   The caller's output buffer (see BUFFER and BUFFER64) must be * 00009900
*        in the caller's primary address space and cannot be          * 00010000
*        ALET-qualified.                                              * 00010100
*                                                                     * 00010200
*    o   All storage areas specified must be in the same storage key  * 00010300
*        as the caller.                                               * 00010400
*                                                                     * 00010500
*    o   The caller cannot have any enabled, unlocked task (EUT) FRRs * 00010600
*        established.                                                 * 00010700
*                                                                     * 00010800
*    o   There is more than one version of this macro available. The  * 00010900
*        parameters you can use depend on the version you specify on  * 00011000
*        the PLISTVER parameter.  See the description of the PLISTVER * 00011100
*        parameter for more information.                              * 00011200
*                                                                     * 00011300
*    o   You can call any of the system logger services in either     * 00011400
*        AMODE 31 or 64, but the parameter list and all other data    * 00011500
*        addresses, with the exception of BUFFER64 must reside in     * 00011600
*        31-bit storage.                                              * 00011700
*                                                                     * 00011800
*                                                                     * 00011900
*                                                                     * 00012000
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00012100
*                      GR2-GR13    Undefined                          * 00012200
*                      GR14-GR15   Reserved                           * 00012300
*                      AR0-AR1     Reserved                           * 00012400
*                      AR2-AR13    Undefined                          * 00012500
*                      AR14-AR15   Reserved                           * 00012600
*                                                                     * 00012700
*01* OUTPUT REGISTERS: GR0         Reason code if GR15 return code is * 00012800
*                                  non-zero                           * 00012900
*                      GR1         Unpredictable                      * 00013000
*                      GR2-GR13    Unchanged                          * 00013100
*                      GR14        Unpredictable                      * 00013200
*                      GR15        Return code                        * 00013300
*                      AR0-AR1     Unpredictable                      * 00013400
*                      AR2-AR13    Unchanged                          * 00013500
*                      AR14-AR15   Unpredictable                      * 00013600
*                                                                     * 00013700
*01* OUTPUT REGISTER INFORMATION:                                     * 00013800
*                                                                     * 00013900
*    64 Bit Register Usage.                                           * 00014000
*                                                                     * 00014100
*    If the caller is in Amode 64, then 64-bit Register 15 will be    * 00014200
*    altered.  If the caller uses Buffer64, then 64-Bit Registers 0,  * 00014300
*    1, and 15 may be altered.                                        * 00014400
*                                                                     * 00014500
*01* PERFORMANCE IMPLICATIONS:                                        * 00014600
*                                                                     * 00014700
*    None.                                                            * 00014800
*                                                                     * 00014900
*01* SYNTAX:                                                          * 00015000
*                                                                     * 00015100
*Ýxlabel¨  IXGQUERY  ÐÝ REQUEST=LSCONNINFO                            * 00015200
*                    !     ,STREAMTOKEN=xstreamtoken                  * 00015300
*                    !   ÐÝ,CHECKCONNSTATUS=NO                        * 00015400
*                    !   !     ,BUFFER=xbuffer                        * 00015500
*                    !   !     ,BUFFLEN=xbufflen¨                     * 00015600
*                    !   ¿Ý,CHECKCONNSTATUS=YES¨¨                     * 00015700
*                    ¿Ý,REQUEST=ZAILOCINFO                            * 00015800
*                          ,BUFFER64=xbuffer64                        * 00015900
*                          ,BUFFLEN=xbufflen¨                         * 00016000
*                      ,ANSAREA=xansarea                              * 00016100
*                      ,ANSLEN=xanslen                                * 00016200
*                     Ý,RETCODE=xretcode¨                             * 00016300
*                     Ý,RSNCODE=xrsncode¨                             * 00016400
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00016500
*                    ÐÝ,MF=S¨                                         * 00016600
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00016700
*                    ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00016800
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*      Where:                                                         * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*      Ýxlabel¨                                                       * 00017500
*          is an optional symbol, starting in column 1, that is the   * 00017600
*          name on the IXGQUERY macro invocation.  The name must      * 00017700
*          conform to the rules for an ordinary assembler language    * 00017800
*          symbol.                                                    * 00017900
*          DEFAULT: No name.                                          * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      ÝREQUEST=»LSCONNINFO!ZAILOCINFOº¨                              * 00018500
*          is an optional keyword input that specifies the type of    * 00018600
*          system logger related information being requested.         * 00018700
*          DEFAULT: LSCONNINFO                                        * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*          ÝREQUEST=LSCONNINFO                                        * 00019100
*              The program requests to obtain information for a       * 00019200
*              connected log stream.                                  * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*              STREAMTOKEN=xstreamtoken                               * 00019600
*                  is the name (RS-type), or address in register      * 00019700
*                  (2)-(12), of a required 16 character input that    * 00019800
*                  specifies the log stream token that was returned   * 00019900
*                  by the IXGCONN service.                            * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*              ÝCHECKCONNSTATUS=»NO!YESº¨                             * 00020500
*                  is an optional keyword input that indicates        * 00020600
*                  whether or not the Connection status of the        * 00020700
*                  logstream should be checked.                       * 00020800
*                  DEFAULT: NO                                        * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                  ÝCHECKCONNSTATUS=NO                                * 00021200
*                      indicates that full IXGQUERY processing should * 00021300
*                      be performed.                                  * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                      BUFFER=xbuffer                                 * 00021700
*                          is the name (RS-type), or address in       * 00021800
*                          register (2)-(12), of a required character * 00021900
*                          output that specifies the buffer into      * 00022000
*                          which the requested data are to be copied. * 00022100
*                          The contents of the buffer are mapped by   * 00022200
*                          IXGQBUF.                                   * 00022300
*                                                                     * 00022400
*                          The buffer cannot be ALET qualified.       * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                      BUFFLEN=xbufflen¨                              * 00023000
*                          is the name (RS-type), or address in       * 00023100
*                          register (2)-(12), of a required fullword  * 00023200
*                          input that specifies the size of the       * 00023300
*                          buffer, identified by the BUFFER keyword,  * 00023400
*                          relative to different output versions:     * 00023500
*                                                                     * 00023600
*                          If the user-specified buffer is less than  * 00023700
*                          72 bytes, the query request will fail and  * 00023800
*                          a specific return or reason code           * 00023900
*                          (IxgRetCodeError, IxgRsnCodeBadBufSize)    * 00024000
*                          will be returned.                          * 00024100
*                                                                     * 00024200
*                          If the user-specified buffer is greater    * 00024300
*                          than or equal to 88 bytes then version one * 00024400
*                          information will be returned.              * 00024500
*                                                                     * 00024600
*                          If the user-specified buffer is greater    * 00024700
*                          than or equal to 168 bytes then version    * 00024800
*                          two information will be returned.          * 00024900
*                                                                     * 00025000
*                          If the user-specified buffer is greater    * 00025100
*                          than or equal to 200 bytes then version    * 00025200
*                          three information will be returned.  If    * 00025300
*                          you want to see the GROUP information      * 00025400
*                          specified for the log stream, you must     * 00025500
*                          specify at least 200 bytes. If you specify * 00025600
*                          less than 200 bytes, IXGQUERY will not     * 00025700
*                          return the GROUP information.              * 00025800
*                                                                     * 00025900
*                          See IXGQBUF in z/OS MVS Data Areas for     * 00026000
*                          details.                                   * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                  ÝCHECKCONNSTATUS=YES¨¨                             * 00026500
*                      indicates that only the status of the Log      * 00026600
*                      Stream Connection should be checked.  No       * 00026700
*                      Buffer is needed for this operation.           * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*          ÝREQUEST=ZAILOCINFO                                        * 00027400
*              The program requests to obtain information for the     * 00027500
*              system logger ZAI parameter options pertaining to the  * 00027600
*              IBM zAware server location.                            * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*              BUFFER64=xbuffer64                                     * 00028000
*                  is the name (RS-type), or address in register      * 00028100
*                  (2)-(12), of a required character output that      * 00028200
*                  specifies the buffer (starting on a full word      * 00028300
*                  boundary) into which the requested data are to be  * 00028400
*                  copied.  The location of this buffer may be        * 00028500
*                  anywhere in 64-bit storage.  The contents of the   * 00028600
*                  buffer are mapped by IXGQZBUF.                     * 00028700
*                                                                     * 00028800
*                  The buffer cannot be ALET qualified.               * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*              BUFFLEN=xbufflen¨                                      * 00029400
*                  is the name (RS-type), or address in register      * 00029500
*                  (2)-(12), of a required fullword input that        * 00029600
*                  specifies the size of the buffer, identified by    * 00029700
*                  the BUFFER64 keyword, relative to the output       * 00029800
*                  versions:                                          * 00029900
*                                                                     * 00030000
*                  If the user-specified buffer is less than 96       * 00030100
*                  bytes, the query request will fail and a specific  * 00030200
*                  return or reason code (IxgRetCodeError,            * 00030300
*                  IxgRsnCodeBadBufSize) will be returned.            * 00030400
*                                                                     * 00030500
*                  If the user specified buffer is greater than or    * 00030600
*                  equal to 96 bytes then version one information     * 00030700
*                  will be returned.  Meaning, the IXGQZBUF_Hdr       * 00030800
*                  fields will be filled in by logger with the        * 00030900
*                  following values:                                  * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                  1.  IXGQZBUF_HDR_VER value is assigned a value of  * 00031300
*                      1 ('01'x)                                      * 00031400
*                                                                     * 00031500
*                  2.  IXGQZBUF_HDR_LEN value is assigned a value of  * 00031600
*                      96 ('60'x)                                     * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                  If the user specified buffer area length is        * 00032100
*                  greater than or equal to 128 bytes, then logger    * 00032200
*                  will return all the version 1 information and the  * 00032300
*                  version two information.  The IXGQZBUF_Hdr fields  * 00032400
*                  will be filled in by logger with the following     * 00032500
*                  values:                                            * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*                  1.  IXGQZBUF_HDR_VER value is assigned a value of  * 00032900
*                      2 ('02'x)                                      * 00033000
*                                                                     * 00033100
*                  2.  IXGQZBUF_HDR_LEN value is assigned a value of  * 00033200
*                      128 ('80'x)                                    * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*                  See IXGQZBUF in z/OS MVS Data Areas for details.   * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*      ANSAREA=xansarea                                               * 00034600
*          is a required input.  It is the name (RS-type), or address * 00034700
*          in register (2)-(12), of a virtual storage area, called    * 00034800
*          the answer area.  The ANSAREA contains additional error    * 00034900
*          status when the IXGQUERY service generates an error return * 00035000
*          code. The format of the returned data is defined by the    * 00035100
*          IXGANSAA mapping macro.                                    * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*      ANSLEN=xanslen                                                 * 00035700
*          is the name (RS-type), or address in register (2)-(12), of * 00035800
*          a required fullword input that contains the length in      * 00035900
*          bytes of the virtual storage area provided for ANSAREA.    * 00036000
*                                                                     * 00036100
*          The length of the answer area is described by the IXGANSAA * 00036200
*          mapping macro.                                             * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                                                                     * 00036700
*      ÝRETCODE=xretcode¨                                             * 00036800
*          is the name (RS-type) of an optional fullword output       * 00036900
*          variable, or register (2)-(12) or (15), into which the     * 00037000
*          return code is to be copied from GPR 15.  If you specify   * 00037100
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00037200
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00037300
*          with MF=M.                                                 * 00037400
*                                                                     * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*      ÝRSNCODE=xrsncode¨                                             * 00037900
*          is the name (RS-type) of an optional fullword output       * 00038000
*          variable into which the reason code is to be copied from   * 00038100
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00038200
*          R0 (within or without parentheses), the value will be left * 00038300
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00038900
*          is an optional byte input decimal value in the "0-2" range * 00039000
*          that specifies the macro version.  PLISTVER is the only    * 00039100
*          key allowed on the list form of MF and determines which    * 00039200
*          parameter list is generated.  The macro keys associated    * 00039300
*          with each supported version of the macro are listed in     * 00039400
*          MACRO USAGE NOTE 3.  Note that MAX may be specified        * 00039500
*          instead of a number, and the parameter list will be of the * 00039600
*          largest size currently supported. This size may grow from  * 00039700
*          release to release (thus possibly affecting the amount of  * 00039800
*          storage needed by your program).  If your program can      * 00039900
*          tolerate this, IBM recommends that you always specify MAX  * 00040000
*          when creating the list form parameter list as that will    * 00040100
*          ensure that the list form parameter list is always long    * 00040200
*          enough to hold whatever parameters might be specified on   * 00040300
*          the execute form.                                          * 00040400
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00040500
*          default is the lowest version which allows all of the      * 00040600
*          parameters specified on the invocation to be processed.    * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*      ÝMF=»S!L!M!Eº¨                                                 * 00041200
*          is an optional keyword input which specifies the macro     * 00041300
*          form.                                                      * 00041400
*          DEFAULT: S                                                 * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*          ÝMF=S¨                                                     * 00041800
*              specifies the standard form of the macro.  The "S"     * 00041900
*              form generates code to put the parameters into an      * 00042000
*              in-line parameter list and invoke the desired service. * 00042100
*              Full checking for required macro keys is done along    * 00042200
*              with supplying defaults for omitted optional           * 00042300
*              parameters.                                            * 00042400
*                                                                     * 00042500
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00042600
*              specifies the list form of the macro.  The "L" form    * 00042700
*              defines an area to be used for the parameter list.     * 00042800
*              Only the PLISTVER key may be specified on the          * 00042900
*              invocation.  All other macro parameters are flagged as * 00043000
*              errors.  If PLISTVER is not specified, the original    * 00043100
*              parameter list definition is used.                     * 00043200
*                                                                     * 00043300
*            ,xmfctrl                                                 * 00043400
*              is a required input.  It is the name of a storage area * 00043500
*              for the parameter list.                                * 00043600
*                                                                     * 00043700
*            »,xmfattr!0Dº                                            * 00043800
*              is an optional 60 character input string that varies   * 00043900
*              from 1 to 60 characters. Use it to force boundary      * 00044000
*              alignment of the parameter list. Use only 0F or 0D.    * 00044100
*              DEFAULT: 0D which forces the parameter list to a       * 00044200
*              doubleword boundary.                                   * 00044300
*                                                                     * 00044400
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00044500
*              specifies the modify form of the macro.  The "M" form  * 00044600
*              generates code to put the parameters into the          * 00044700
*              parameter list specified by xmfctrl.                   * 00044800
*                                                                     * 00044900
*            ,xmfctrl                                                 * 00045000
*              is a required input.  It is the name (RS-type), or     * 00045100
*              address in register (1)-(12), of a storage area for    * 00045200
*              the parameter list.                                    * 00045300
*                                                                     * 00045400
*            »,COMPLETE!NOCHECKº¨                                     * 00045500
*              is an optional keyword input which specifies the       * 00045600
*              degree of macro parameter syntax checking.             * 00045700
*              DEFAULT: COMPLETE                                      * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*              COMPLETE                                               * 00046100
*                  Checking for required macro keys is done and       * 00046200
*                  defaults are supplied for omitted optional         * 00046300
*                  parameters.  (See Macro Usage Note 2).             * 00046400
*                                                                     * 00046500
*              NOCHECK                                                * 00046600
*                  Checking for required macro keys is not done nor   * 00046700
*                  are defaults supplied for omitted optional         * 00046800
*                  parameters.                                        * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*                                                                     * 00047200
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00047300
*              specifies the execute form of the macro.  The "E" form * 00047400
*              generates code to put the parameters into the          * 00047500
*              parameter list specified by xmfctrl and invoke the     * 00047600
*              desired service.                                       * 00047700
*                                                                     * 00047800
*            ,xmfctrl                                                 * 00047900
*              is a required input.  It is the name (RS-type), or     * 00048000
*              address in register (1)-(12), of a storage area for    * 00048100
*              the parameter list.                                    * 00048200
*                                                                     * 00048300
*            »,COMPLETE!NOCHECKº                                      * 00048400
*              is an optional keyword input which specifies the       * 00048500
*              degree of macro parameter syntax checking.             * 00048600
*              DEFAULT: COMPLETE                                      * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*              COMPLETE                                               * 00049000
*                  Checking for required macro keys is done and       * 00049100
*                  defaults are supplied for omitted optional         * 00049200
*                  parameters.  (See Macro Usage Note 2).             * 00049300
*                                                                     * 00049400
*              NOCHECK                                                * 00049500
*                  Checking for required macro keys is not done nor   * 00049600
*                  are defaults supplied for omitted optional         * 00049700
*                  parameters.                                        * 00049800
*                                                                     * 00049900
*                                                                     * 00050000
*                                                                     * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*01* RETURN CODES:                                                    * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*                 When IXGQUERY macro returns control to your         * 00050900
*                 program, GPR 15 contains a return code and GPR 0    * 00051000
*                 contains a reason code.                             * 00051100
*                                                                     * 00051200
*                 The IXGCON mapping macro provides equate symbols    * 00051300
*                 for the return and reason codes.  The equate        * 00051400
*                 symbols associated with each hexadecimal return     * 00051500
*                 code are as follows:                                * 00051600
*                                                                     * 00051700
*       00        IXGRETCODEOK -  Successful Completion               * 00051800
*                                                                     * 00051900
*       04        IXGRETCODEWARNING - The request was processed       * 00052000
*                 successfully, however a warning condition was       * 00052100
*                 encountered.                                        * 00052200
*                                                                     * 00052300
*       08        IXGRETCODEERROR - An error has been encountered.    * 00052400
*                 The associated reason code provides more            * 00052500
*                 information.                                        * 00052600
*                                                                     * 00052700
*       0C        IXGRETCODECOMPERROR - A System Logger component     * 00052800
*                 error has been encountered.                         * 00052900
*                                                                     * 00053000
*                                                                     * 00053100
*                                                                     * 00053200
*01* REASON CODES:                                                    * 00053300
*                                                                     * 00053400
*       Full details on the reason codes provided for each return     * 00053500
*       code listed above can be found in the "Return and Reason      * 00053600
*       Codes" topic for this service in publication "z/OS MVS        * 00053700
*       Programming:  Assembler Services Reference:, Volume 2         * 00053800
*       (IARR2V-XCTLX)".                                              * 00053900
*                                                                     * 00054000
*       REASON    RETURN                                              * 00054100
*       CODE      CODE      DESCRIPTION                               * 00054200
*       --------  --------  -----------                               * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*       xxxx0000  00                                                  * 00054600
*                                                                     * 00054700
*                           IXGRSNCODEOK -                            * 00054800
*                                                                     * 00054900
*                           EXPLANATION: Request processed            * 00055000
*                           successfully.                             * 00055100
*                                                                     * 00055200
*       xxxx0801  08                                                  * 00055300
*                                                                     * 00055400
*                           IXGRSNCODEBADPARMLIST -                   * 00055500
*                                                                     * 00055600
*                           EXPLANATION:  Program error. The          * 00055700
*                           parameter list is invalid.  Either the    * 00055800
*                           parameter list storage is inaccessible,   * 00055900
*                           or an invalid version of the macro was    * 00056000
*                           used.                                     * 00056100
*                                                                     * 00056200
*                           ACTION: Ensure that the storage area for  * 00056300
*                           the parameter list is accessible to the   * 00056400
*                           system logger for the duration of the     * 00056500
*                           request, and that the macro version is    * 00056600
*                           correct.  The parameter list storage must * 00056700
*                           be addressable in the caller's primary    * 00056800
*                           address space and in the same key as the  * 00056900
*                           caller.                                   * 00057000
*                                                                     * 00057100
*       xxxx0802  08        IXGRSNCODEXESERROR -                      * 00057200
*                                                                     * 00057300
*                                                                     * 00057400
*                           EXPLANATION:  System error. A severe      * 00057500
*                           cross-system extended services (XES)      * 00057600
*                           error has occurred.                       * 00057700
*                                                                     * 00057800
*                           ACTION:  See ANSAA_DIAG1 for the XES      * 00057900
*                           return code and ANSAA_DIAG2 for the XES   * 00058000
*                           reason code.                              * 00058100
*                                                                     * 00058200
*       xxxx0803  08                                                  * 00058300
*                                                                     * 00058400
*                           IXGRSNCODEBADBUFFER -                     * 00058500
*                                                                     * 00058600
*                                                                     * 00058700
*                           EXPLANATION: The virtual storage area     * 00058800
*                           specified by the BUFFER keyword not       * 00058900
*                           addressable.                              * 00059000
*                                                                     * 00059100
*                           ACTION: Ensure the storage area is        * 00059200
*                           accessible to the Logger Services for the * 00059300
*                           duration of the request.                  * 00059400
*                                                                     * 00059500
*       xxxx0806  08                                                  * 00059600
*                                                                     * 00059700
*                           IXGRSNCODEBADSTMTOKEN -                   * 00059800
*                                                                     * 00059900
*                           EXPLANATION: Program error. One of the    * 00060000
*                           following occurred: # The stream token    * 00060100
*                           was not valid. # The specified request    * 00060200
*                           was issued from an address space other    * 00060300
*                           than the connectors address space.        * 00060400
*                                                                     * 00060500
*                           ACTION: Do one of the following: # Make   * 00060600
*                           sure that the stream token specified is   * 00060700
*                           valid. # Ensure that IXGQUERY requests    * 00060800
*                           were issued from the connectors address   * 00060900
*                           space.                                    * 00061000
*                                                                     * 00061100
*       xxxx080A  08                                                  * 00061200
*                                                                     * 00061300
*                           IXGRSNCODEREQUESTLOCKED -                 * 00061400
*                                                                     * 00061500
*                           EXPLANATION:  Program error. The program  * 00061600
*                           issuing the request is holding a lock.    * 00061700
*                                                                     * 00061800
*                           ACTION: Ensure that the program issuing   * 00061900
*                           the request is not holding a lock.        * 00062000
*                                                                     * 00062100
*       xxxx080F  08        IXGRSNCODEBADBUFSIZE -                    * 00062200
*                                                                     * 00062300
*                           EXPLANATION:  The buffer specified (re:   * 00062400
*                           BUFFER or BUFFER64) is not large enough   * 00062500
*                           to contain the data being returned.  No   * 00062600
*                           data is returned.                         * 00062700
*                                                                     * 00062800
*                           ACTION:  Obtain a buffer of the length of * 00062900
*                           IXGQBUF or IXGQZBUF (as appropriate) and  * 00063000
*                           redrive the request.                      * 00063100
*                                                                     * 00063200
*       xxxx0814  08                                                  * 00063300
*                                                                     * 00063400
*                           IXGRSNCODENOTAVAILFORIPL -                * 00063500
*                                                                     * 00063600
*                           EXPLANATION:  Environment error. The      * 00063700
*                           system logger address space is not        * 00063800
*                           available for the remainder of this IPL.  * 00063900
*                           The system issues messages about this     * 00064000
*                           error during system logger                * 00064100
*                           initialization.                           * 00064200
*                                                                     * 00064300
*                           ACTION: See the explanation for system    * 00064400
*                           messages issued during system logger      * 00064500
*                           initialization.                           * 00064600
*                                                                     * 00064700
*       xxxx0815  08                                                  * 00064800
*                                                                     * 00064900
*                           IXGRSNCODENOTENABLED -                    * 00065000
*                                                                     * 00065100
*                           EXPLANATION:  Program error. The program  * 00065200
*                           issuing the request is not enabled for    * 00065300
*                           I/O and external interrupts, so the       * 00065400
*                           request fails.                            * 00065500
*                                                                     * 00065600
*                           ACTION:  Make sure the program issuing    * 00065700
*                           the request is enabled for I/O and        * 00065800
*                           external interrupts.                      * 00065900
*                                                                     * 00066000
*       xxxx0816  08                                                  * 00066100
*                                                                     * 00066200
*                           IXGRSNCODEBADANSLEN -                     * 00066300
*                                                                     * 00066400
*                           EXPLANATION:  Program error. The answer   * 00066500
*                           area length (ANSLEN parameter) is not     * 00066600
*                           large enough. The system logger returned  * 00066700
*                           the required size in the                  * 00066800
*                           Ansaa_Preferred_Size field of the answer  * 00066900
*                           area, mapped by IXGANSAA macro.           * 00067000
*                                                                     * 00067100
*                           ACTION:  Re-issue the request, specifying * 00067200
*                           an answer area of the required size.      * 00067300
*                                                                     * 00067400
*       xxxx0817  08                                                  * 00067500
*                                                                     * 00067600
*                           IXGRSNCODEBADANSAREA -                    * 00067700
*                                                                     * 00067800
*                           EXPLANATION: Program error. The storage   * 00067900
*                           area specified on the ANSAREA parameter   * 00068000
*                           cannot be accessed. This may occur after  * 00068100
*                           the system logger address space has       * 00068200
*                           terminated.                               * 00068300
*                                                                     * 00068400
*                           ACTION: Specify storage that is in the    * 00068500
*                           callers primary address space and in the  * 00068600
*                           same key as the calling program at the    * 00068700
*                           time the system logger service was        * 00068800
*                           issued. This storage must be accessible   * 00068900
*                           until the request completes.              * 00069000
*                                                                     * 00069100
*       xxxx0819  08                                                  * 00069200
*                                                                     * 00069300
*                           IXGRSNCODESRBMODE -                       * 00069400
*                                                                     * 00069500
*                           EXPLANATION:  Program error. The calling  * 00069600
*                           program is in SRB mode, but task mode is  * 00069700
*                           the required dispatchable unit mode for   * 00069800
*                           this system logger service.               * 00069900
*                                                                     * 00070000
*                           ACTION: Make sure the calling program is  * 00070100
*                           in task mode.                             * 00070200
*                                                                     * 00070300
*       xxxx081B  08        IXGRSNCODEPRIMARYNOTHOME -                * 00070400
*                                                                     * 00070500
*                                                                     * 00070600
*                           EXPLANATION: Program error. The primary   * 00070700
*                           address space does not equal the home     * 00070800
*                           address space.                            * 00070900
*                                                                     * 00071000
*                           ACTION: Either make sure that the primary * 00071100
*                           address space equals the home address     * 00071200
*                           space when issuing this type of system    * 00071300
*                           logger service.  Or perform a log stream  * 00071400
*                           connection (IXGCONN connect) request from * 00071500
*                           the same primary address space, then      * 00071600
*                           reissue the IXGQUERY request.             * 00071700
*                                                                     * 00071800
*       xxxx081C  08                                                  * 00071900
*                                                                     * 00072000
*                           IXGRSNCODENOTAUTHFUNC -                   * 00072100
*                                                                     * 00072200
*                           EXPLANATION: Program error.  The program  * 00072300
*                           connected to the log stream with the      * 00072400
*                           AUTH=WRITE parameter and was granted      * 00072500
*                           limited access (i.e. write only log data  * 00072600
*                           and disconnect) as per the defined        * 00072700
*                           security access profiles, and then tried  * 00072800
*                           to perform a log stream access service    * 00072900
*                           other than IXGWRITE, or IXGCONN (to       * 00073000
*                           disconnect).                              * 00073100
*                                                                     * 00073200
*                           ACTION: A connection to the log stream    * 00073300
*                           with the appropriate access authority     * 00073400
*                           must be established before requesting a   * 00073500
*                           log stream query (IXGQUERY).  Check with  * 00073600
*                           your installation's security              * 00073700
*                           administrator on obtaining the            * 00073800
*                           appropriate access to the log stream.     * 00073900
*                                                                     * 00074000
*                                                                     * 00074100
*       xxxx082D  08        IXGRSNCODEEXPIREDSTMTOKEN -               * 00074200
*                                                                     * 00074300
*                           EXPLANATION: Environment error. The       * 00074400
*                           stream token is no longer valid because   * 00074500
*                           the connector has been disconnected.      * 00074600
*                                                                     * 00074700
*                           ACTION: Re-connect to the log stream      * 00074800
*                           before issuing any functional requests.   * 00074900
*                                                                     * 00075000
*       xxxx0840  08                                                  * 00075100
*                                                                     * 00075200
*                           IXGRSNCODEBADVERSION -                    * 00075300
*                                                                     * 00075400
*                           EXPLANATION: Environment error. The       * 00075500
*                           parameter list passed to the service      * 00075600
*                           routine has an invalid version indicator. * 00075700
*                                                                     * 00075800
*                           ACTION: Ensure the level of MVS executing * 00075900
*                           the request and the macro library used to * 00076000
*                           compile the invoking routine are          * 00076100
*                           compatible.                               * 00076200
*                                                                     * 00076300
*       xxxx0861  08                                                  * 00076400
*                                                                     * 00076500
*                           IXGRSNCODEREBUILDINPROGRESS -             * 00076600
*                                                                     * 00076700
*                           EXPLANATION: Environment error. No        * 00076800
*                           requests can be processed for this log    * 00076900
*                           stream because a coupling facility        * 00077000
*                           structure re-build or a system-managed    * 00077100
*                           duplexing re-build is in progress for the * 00077200
*                           structure associated with this log        * 00077300
*                           stream.                                   * 00077400
*                                                                     * 00077500
*                           ACTION: Listen for ENF signal 48 that     * 00077600
*                           will indicate one of the following: # The * 00077700
*                           log stream is available because the       * 00077800
*                           re-build completed successfully. Re-issue * 00077900
*                           the request.  # The re-build failed and   * 00078000
*                           the log stream is not available. .        * 00078100
*                                                                     * 00078200
*       xxxx0862  08                                                  * 00078300
*                                                                     * 00078400
*                           IXGRSNCODEXESPURGE -                      * 00078500
*                                                                     * 00078600
*                           EXPLANATION: Environment error. An        * 00078700
*                           cross-system extended services (XES)      * 00078800
*                           request has been purged due to re-build   * 00078900
*                           processing.                               * 00079000
*                                                                     * 00079100
*                           ACTION: Listen for ENF signal 48 that     * 00079200
*                           will indicate one of the following: # The * 00079300
*                           log stream is available because the       * 00079400
*                           re-build completed successfully. Re-issue * 00079500
*                           the request.  # The re-build failed and   * 00079600
*                           the log stream is not available. .        * 00079700
*                                                                     * 00079800
*       xxxx0863  08                                                  * 00079900
*                                                                     * 00080000
*                           IXGRSNCODESTRUCTUREFAILED -               * 00080100
*                                                                     * 00080200
*                           EXPLANATION: Environment error. Either    * 00080300
*                           the coupling facility structure           * 00080400
*                           associated with the log stream has failed * 00080500
*                           or the coupling facility itself has       * 00080600
*                           failed.                                   * 00080700
*                                                                     * 00080800
*                           ACTION: Listen for ENF signal 48 that     * 00080900
*                           will indicate one of the following: # The * 00081000
*                           log stream is available because the       * 00081100
*                           re-build completed successfully. Re-issue * 00081200
*                           the request.  # The re-build failed and   * 00081300
*                           the log stream is not available.          * 00081400
*                                                                     * 00081500
*       xxxx0864  08                                                  * 00081600
*                                                                     * 00081700
*                           IXGRSNCODENOCONNECTIVITY -                * 00081800
*                                                                     * 00081900
*                           EXPLANATION: Environment error. No        * 00082000
*                           connectivity exists to the coupling       * 00082100
*                           facility associated with the log stream.  * 00082200
*                           The system logger will either attempt to  * 00082300
*                           re-build the log stream in another        * 00082400
*                           coupling facility or the log stream will  * 00082500
*                           be disconnected.                          * 00082600
*                                                                     * 00082700
*                           ACTION: Listen for ENF signal 48 that     * 00082800
*                           will indicate one of the following: # The * 00082900
*                           log stream is available because the       * 00083000
*                           re-build completed successfully. Re-issue * 00083100
*                           the request.  # The re-build failed and   * 00083200
*                           the log stream is not available. # The    * 00083300
*                           log stream has been disconnected from     * 00083400
*                           this system.                              * 00083500
*                                                                     * 00083600
*       xxxx0890  08                                                  * 00083700
*                                                                     * 00083800
*                           IXGRSNCODEADDRSPACENOTAVAIL -             * 00083900
*                                                                     * 00084000
*                           EXPLANATION: System error. The system     * 00084100
*                           logger address space failed and is not    * 00084200
*                           available.                                * 00084300
*                                                                     * 00084400
*                           ACTION: Do not issue system logger        * 00084500
*                           requests.                                 * 00084600
*                                                                     * 00084700
*       xxxx0891  08                                                  * 00084800
*                                                                     * 00084900
*                           IXGRSNCODEADDRSPACEINITIALIZING -         * 00085000
*                                                                     * 00085100
*                                                                     * 00085200
*                           EXPLANATION: System error. The system     * 00085300
*                           logger address space is not available     * 00085400
*                           because it is IPLing.                     * 00085500
*                                                                     * 00085600
*                           ACTION:  Listen for ENF signal 48, which  * 00085700
*                           will indicate when the system logger      * 00085800
*                           address space is available.  Once it's    * 00085900
*                           available, re-connect to the log stream,  * 00086000
*                           then re-issue this request. You can also  * 00086100
*                           listen for ENF signal 48, which will      * 00086200
*                           indicate if the system logger address     * 00086300
*                           space will not be available for the life  * 00086400
*                           of the IPL. In that case, do not issue    * 00086500
*                           system logger services.                   * 00086600
*                                                                     * 00086700
*       xxxx08D3  08        IXGRSNCODEFUNCNOTSUPPORTED -              * 00086800
*                                                                     * 00086900
*                                                                     * 00087000
*                           EXPLANATION: Environment error.  The      * 00087100
*                           query request failed because the active   * 00087200
*                           system logger couple data set (CDS)       * 00087300
*                           inventory is not at the correct level.    * 00087400
*                           When the system is using a LOGR CDS type, * 00087500
*                           the active system logger CDS should be at * 00087600
*                           least at the HBB7705 format level.  When  * 00087700
*                           the system is using a single-system scope * 00087800
*                           couple data set type, the active system   * 00087900
*                           logger CDS must be at least at the        * 00088000
*                           HBB77C0 format level.                     * 00088100
*                                                                     * 00088200
*       xxxx0C00  0C                                                  * 00088300
*                                                                     * 00088400
*                           EXPLANATION: System Logger Error.  A      * 00088500
*                           System Logger component error has been    * 00088600
*                           encountered.                              * 00088700
*                                                                     * 00088800
*                                                                     * 00088900
*                                                                     * 00089000
*01* ABEND CODES:                                                     * 00089100
*                                                                     * 00089200
*                                                                     * 00089300
*       1C5       IXG_ABEND_CODE - A System Logger abend has          * 00089400
*                 occurred.                                           * 00089500
*                                                                     * 00089600
*                                                                     * 00089700
*                                                                     * 00089800
*01* ABEND REASON CODES:                                              * 00089900
*                                                                     * 00090000
*       REASON    ABEND                                               * 00090100
*       CODE      CODE      DESCRIPTION                               * 00090200
*       --------  --------  -----------                               * 00090300
*                                                                     * 00090400
*                                                                     * 00090500
*       xxxx085F  1C5       IXGRSNCODEPERCTOREQUESTOR -               * 00090600
*                                                                     * 00090700
*                           EXPLANATION: Environment error.           * 00090800
*                           Percolation to the service requestor's    * 00090900
*                           task occurred because of an abend during  * 00091000
*                           system logger processing. Retry was not   * 00091100
*                           allowed.                                  * 00091200
*                                                                     * 00091300
*                           ACTION: Issue the request again. If the   * 00091400
*                           problem persists, contact the IBM Support * 00091500
*                           Center.                                   * 00091600
*                                                                     * 00091700
*                                                                     * 00091800
*                                                                     * 00091900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00092000
*                                                                     * 00092100
*02*   PROCESSOR:  ASSEM                                              * 00092200
*                                                                     * 00092300
*01* COMPONENT:  SCLOG                                                * 00092400
*                                                                     * 00092500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00092600
*                                                                     * 00092700
*01* EXAMPLES:                                                        * 00092800
*    None.                                                            * 00092900
*                                                                     * 00093000
*01* MACRO USAGE NOTES:                                               * 00093100
*                                                                     * 00093200
*                                                                     * 00093300
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00093400
*        global macro variable.  Any value other than 'NO' will       * 00093500
*        result in the macro expansion being printed.  The default is * 00093600
*        'YES'.  The following examples illustrate how the ZPRINT     * 00093700
*        variable should be set.                                      * 00093800
*                                                                     * 00093900
*                    GBLC &ZPRINT                                     * 00094000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00094100
*                                                                     * 00094200
*                                                                     * 00094300
*    2.  When using the NOCHECK option in conjunction with the Modify * 00094400
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00094500
*        Modify   or  Execute  form  invocation  which  specifies  or * 00094600
*        defaults  to  the  COMPLETE  option.   This insures that the * 00094700
*        parameter  list  is  initialized completely.   The parameter * 00094800
*        list  field which identifies the version number of the macro * 00094900
*        is only set when the Standard form or the Complete option of * 00095000
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00095100
*        explicitly  specified.  Be sure that the resulting parameter * 00095200
*        list version number covers all the keys that you use.        * 00095300
*                                                                     * 00095400
*                                                                     * 00095500
*    3.  The IXGQUERY macro supports multiple versions. The macro key * 00095600
*        list  below  contains the version level in which the key was * 00095700
*        first  introduced.  Positionals  are  identified by the word * 00095800
*        'Positional'  followed by the numeric value of its position. * 00095900
*        Nested  positionals  are  preceded  by their outer key.  The * 00096000
*        lowest value represents the original version and the highest * 00096100
*        value  represents  the  most  recent version of the IXGQUERY * 00096200
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00096300
*        least  as high as the highest version number of all the keys * 00096400
*        being used.                                                  * 00096500
*                                                                     * 00096600
*        VERSION   KEY                                                * 00096700
*                                                                     * 00096800
*              0      ANSAREA                                         * 00096900
*                     ANSLEN                                          * 00097000
*                     BUFFER                                          * 00097100
*                     BUFFLEN                                         * 00097200
*                     STREAMTOKEN                                     * 00097300
*              1      CHECKCONNSTATUS                                 * 00097400
*                     REQUEST                                         * 00097500
*              2      BUFFER64                                        * 00097600
*                                                                     * 00097700
*                                                                     * 00097800
*                                                                     * 00097900
*01* CHANGE ACTIVITY:                                                 * 00098000
*                                                                     * 00098100
*   Flag LineItem  FMID    Date   ID    Comment                       * 00098200
*                                                                     * 00098300
*    $L0=LOGGR    HBB6603 951201 PDXD:                                * 00098400
*    $L1=CFDUP    HBB7705 001024 PDJL:  Update                        * 00098500
*                                         IxgRsnCodeRebuildInProgress * 00098600
*    $01=OW48404  HBB7703 010218 PD00A8:                              * 00098700
*    $L2=64V2     HBB7709 020404 PD00A8:  Support Amode 64            * 00098800
*    $L3=CHREQ    HBB7720 040603 PDNJ:  Comments for query buffer     * 00098900
*                                         versions                    * 00099000
*    $02=OA11052  HBB7720 040603 PDNJ:  Update to length (CHREQ       * 00099100
*                                         rolldown)                   * 00099200
*    $L4=LOGSEP   HBB7730 050405 PD00A8:  Separation Support          * 00099300
*    $L5=ME09177  HBB7740 070131 PDDZ:  refer to pubs for reason code * 00099400
*                                         details                     * 00099500
*    $P1=ME17775  HBB7770 091124 PDDZ:  AR mode proper linkage        * 00099600
*    $L6=PR780    HBB7780 120130 PDDZ:  prolog cleanup                * 00099700
*    $03=OA38747  HBB7780 120828 PDDZ:  Logger ZAI location parms     * 00099800
*    $04=OA41313  HBB7780 130207 PDDZ:  cpools query zailocinfo -     * 00099900
*                                         ME25492                     * 00100000
*    $05=OA53111  HBB77A0 170818 PDDZ:  ZAI TPNAME - stack affinity   * 00100100
*    $L7=LOGRZ    HBB77C0 181231 PDDZ:  single-system scope CDS types * 00100200
*                                         LOGRY & LOGRZ               * 00100300
*    $06=OA56050  HBB77B0 190411 PDDZ:  WriteOnly access              * 00100400
****** END OF SPECIFICATIONS *****************************************/ 00100500
*/********************************************************************* 00100600
         MACRO                                                          00100700
&XLABEL  IXGQUERY &REQUEST=,&STREAMTOKEN=,&CHECKCONNSTATUS=,&BUFFER=,  *00100800
               &BUFFLEN=,&BUFFER64=,&ANSAREA=,&ANSLEN=,&RETCODE=,      *00100900
               &RSNCODE=,&PLISTVER=,&MF=                                00101000
.*                                                                      00101100
*                     MACDATE -19/04/11-<2>                             00101200
.*                                                                      00101300
.*******************************************************************    00101400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00101500
.*******************************************************************    00101600
                     GBLC  &ZPRINT     YES=PRINT NO=NO PRINT            00101700
                     GBLC  &ZTEST      YES=TEST NO=NO TEST              00101800
                     GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX      00101900
.*                                                                      00102000
                     GBLC  &ZIXGQUERY  YES=MACRO USED AT LEAST ONCE     00102100
.*******************************************************************    00102200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00102300
.*******************************************************************    00102400
                     LCLC  &ZMS        ERROR MESSAGE WORK AREA          00102500
                     LCLC  &ZCNDX      SYSNDX CHARACTERS                00102600
                     LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED       00102700
                     LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR      00102800
                     LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE      00102900
                     LCLA  &ZAWRK      USED AS A WORK AREA              00103000
                     LCLA  &ZASIZ      USED FOR SIZE OF VALUE           00103100
                     LCLA  &ZN         NUMERIC WORK VARIABLE            00103200
                     LCLC  &ZC         CHARACTER WORK VARIABLE          00103300
                     LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE      00103400
                     LCLA  &ZTLA       VALUE TOO LONG VARIABLE          00103500
                     LCLC  &ZMAC_G     "G" or null                      00103600
&ZMAC_G              SETC  ''                                           00103700
                     LCLC  &ZMAC_LR                                     00103800
&ZMAC_LR             SETC  'LR'                                         00103900
                     LCLC  &ZMAC_L                                      00104000
&ZMAC_L              SETC  'L'                                          00104100
                     LCLC  &ZMAC_ST                                     00104200
&ZMAC_ST             SETC  'ST'                                         00104300
                     LCLC  &ZMAC_LLGT                                   00104400
&ZMAC_LLGT           SETC  'L'                                          00104500
                     LCLC  &ZMAC_LGR                                    00104600
&ZMAC_LGR            SETC  'LR'                                         00104700
                     LCLC  &ZMAC_LG                                     00104800
&ZMAC_LG             SETC  'L'                                          00104900
                     LCLC  &ZMAC_STG                                    00105000
&ZMAC_STG            SETC  'ST'                                         00105100
                     LCLA  &ZMACRET    MACRO RETURN CODE                00105200
&ZMACRET             SETA  0           ASSUME NO ERRORS                 00105300
.*                                                                      00105400
                     LCLC  &ZCSYSLIST(255)      NONXKEY, POS ARRAY      00105500
                     LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()       00105600
                     LCLA  &ZPLLEN     PARAMETER LIST LENGTH            00105700
                     LCLC  &ZENDBASEPL          End of base PL          00105800
                     LCLA  &ZPLWORKA   PARAMETER LIST LENGTH            00105900
.*******************************************************************    00106000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00106100
.*******************************************************************    00106200
                     LCLA  &ZI         INDEX FOR ARRAY                  00106300
                     LCLA  &ZJ         INDEX FOR PARMS                  00106400
                     LCLA  &ZK         INDEX FOR PARSE                  00106500
                     LCLA  &ZLO        LOW RANGE VALUE                  00106600
                     LCLA  &ZHI        HIGH RANGE VALUE                 00106700
                     LCLC  &ZW         WORK AREA FOR PARM               00106800
.********************************************************************   00106900
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00107000
.********************************************************************   00107100
                     GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL          00107200
                     GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE   00107300
                     GBLA  &SYSALVL    SYSSTATE ARCHLVL                 00107400
                     GBLC  &SYSAM64    SYSSTATE AMODE64                 00107500
.*                                                                      00107600
                     AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED   00107700
                     AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED    00107800
                     SPLEVEL  TEST                                      00107900
.ZSYS2               ANOP  ,                                            00108000
                     AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1        00108100
                     AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1        00108200
                     SYSSTATE TEST                                      00108300
                     AGO   .ZSYS4                                       00108400
.ZSYS3               ANOP  ,                                            00108500
&SYSASCE             SETC  'P'         ASSUME SYSSTATE PRIMARY          00108600
.ZSYS4               ANOP  ,                                            00108700
                     AIF   ('&SYSAM64' NE 'YES').ZSYSN64                00108800
&ZMAC_LLGT           SETC 'LLGT'                                        00108900
&ZMAC_LGR            SETC 'LGR'                                         00109000
&ZMAC_LG             SETC 'LG'                                          00109100
&ZMAC_STG            SETC 'STG'                                         00109200
.ZSYSN64             ANOP  ,                                            00109300
.*******************************************************************    00109400
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00109500
.*******************************************************************    00109600
                     LCLC  &XREQUEST   ++ VALUE                         00109700
                     LCLC  &XSTREAMTOKEN        ++ NAME                 00109800
                     LCLC  &XCHECKCONNSTATUS    ++ VALUE                00109900
                     LCLC  &XBUFFER    ++ NAME                          00110000
                     LCLC  &XBUFFLEN   ++ NAME                          00110100
                     LCLC  &XBUFFER64  ++ NAME                          00110200
                     LCLC  &XANSAREA   ++ NAME                          00110300
                     LCLC  &XANSLEN    ++ NAME                          00110400
                     LCLC  &XRETCODE   ++ NAME                          00110500
                     LCLC  &XRSNCODE   ++ NAME                          00110600
                     LCLA  &XPLISTVER  ++ VALUE                         00110700
                     LCLC  &XMF        ++ VALUE                         00110800
                     LCLC  &XMFCTRL    ++ NAME                          00110900
                     LCLC  &XMFATTR    ++ VALUE                         00111000
                     LCLC  &XMFSCK     ++ VALUE                         00111100
.*******************************************************************    00111200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00111300
.*******************************************************************    00111400
                     LCLC  &ZXREQUEST  ++ INPUT VALUE                   00111500
                     LCLC  &ZXSTREAMTOKEN       ++ INPUT NAME           00111600
                     LCLC  &ZXCHECKCONNSTATUS   ++ INPUT VALUE          00111700
                     LCLC  &ZXBUFFER   ++ OUTPUT NAME                   00111800
                     LCLC  &ZXBUFFLEN  ++ INPUT NAME                    00111900
                     LCLC  &ZXBUFFER64          ++ OUTPUT NAME          00112000
                     LCLC  &ZXANSAREA  ++ INPUT NAME                    00112100
                     LCLC  &ZXANSLEN   ++ INPUT NAME                    00112200
                     LCLC  &ZXRETCODE  ++ OUTPUT NAME                   00112300
                     LCLC  &ZXRSNCODE  ++ OUTPUT NAME                   00112400
                     LCLC  &ZXPLISTVER          ++ INPUT VALUE          00112500
                     LCLC  &ZXMF       ++ INPUT VALUE                   00112600
                     LCLC  &ZXMFCTRL   ++ INPUT NAME                    00112700
                     LCLC  &ZXMFATTR   ++ INPUT VALUE                   00112800
                     LCLC  &ZXMFSCK    ++ INPUT VALUE                   00112900
.********************************************************************   00113000
.***AC.PLV01  PROCESS PLISTVER                                      *   00113100
.********************************************************************   00113200
&XPLISTVER      SETA  0                                                 00113300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00113400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00113500
&XPLISTVER      SETA  2                                                 00113600
.ZPLV0          ANOP  ,                                                 00113700
.*                                                                      00113800
                AIF   ('&REQUEST' EQ '').ZPLV1E                         00113900
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00114000
&XPLISTVER      SETA  1                                                 00114100
.ZPLV1E         ANOP  ,                                                 00114200
.*                                                                      00114300
                AIF   ('&CHECKCONNSTATUS' EQ '').ZPLV2E                 00114400
                AIF   (&XPLISTVER GE 1).ZPLV2E                          00114500
&XPLISTVER      SETA  1                                                 00114600
.ZPLV2E         ANOP  ,                                                 00114700
.*                                                                      00114800
                AIF   ('&BUFFER64' EQ '').ZPLV3E                        00114900
                AIF   (&XPLISTVER GE 2).ZPLV3E                          00115000
&XPLISTVER      SETA  2                                                 00115100
.ZPLV3E         ANOP  ,                                                 00115200
.*                                                                      00115300
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00115400
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00115500
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00115600
.*-------------------------------------------------------------------   00115700
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00115800
&ZMS            SETC  '"PLISTVER='                                      00115900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00116000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00116100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00116200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00116300
                AGO   .ZPVCK2                                           00116400
.ZPVCK3         ANOP  ,                                                 00116500
.*-------------------------------------------------------------------   00116600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00116700
&ZMS            SETC  '"PLISTVER='                                      00116800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00116900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00117000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00117100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00117200
                AGO   .ZPVCKE                                           00117300
.ZPVCK2         ANOP  ,                                                 00117400
.*-------------------------------------------------------------------   00117500
&ZCVAL          SETC  '&PLISTVER(1)'                                    00117600
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00117700
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00117800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00117900
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00118000
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00118100
.ZPVCK6         ANOP  ,                                                 00118200
&ZMS            SETC  '"PLISTVER='                                      00118300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00118400
&ZMS            SETC  '&ZMS THE RANGE IS "0-2"'                         00118500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00118600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00118700
&XPLISTVER      SETA  2                                                 00118800
                AGO   .ZPVCKE                                           00118900
.*-------------------------------------------------------------------   00119000
.ZPVCK4A        ANOP  ,                                                 00119100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00119200
&ZMS            SETC  'PLISTVER='                                       00119300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00119400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00119500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00119600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00119700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00119800
                AGO   .ZPVCK5                                           00119900
.ZPVCK4         ANOP  ,                                                 00120000
&XPLISTVER      SETA  &PLISTVER(1)                                      00120100
.ZPVCK5         ANOP  ,                                                 00120200
.ZPVCKE         ANOP  ,                                                 00120300
.********************************************************************   00120400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00120500
.********************************************************************   00120600
                     ACTR  10000                                        00120700
.*------------------------------------------------------------------    00120800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00120900
&XMF                 SETC  ''          INITIALIZE XVARIABLE             00121000
.*-------------------------------------------------------------------   00121100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121200
.ZG43                ANOP  ,                                            00121300
&ZTLC                SETC 'S'                                           00121400
                     AIF   ('&MF(1)' NE '&ZTLC').ZG44                   00121500
&XMF                 SETC  'S'         SET KEYWORD                      00121600
&XMFSCK              SETC  'COMPLETE'  SET XMFSCK                       00121700
                     AIF   (N'&MF LE 1).ZG43A   CK NUM                  00121800
&ZMS                 SETC  '"MF='                                       00121900
&ZMS                 SETC  '&ZMS.&MF"'                                  00122000
&ZMS                 SETC  '&ZMS "MF"'                                  00122100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00122200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00122300
.ZG43A               ANOP  ,                                            00122400
.*-------------------------------------------------------------------   00122500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00122600
.ZG44                ANOP  ,                                            00122700
&ZTLC                SETC 'L'                                           00122800
                     AIF   ('&MF(1)' NE '&ZTLC').ZG51                   00122900
&XMF                 SETC  'L'         SET KEYWORD                      00123000
                     AIF   (N'&MF LE 3).ZG44A   CK NUM                  00123100
&ZMS                 SETC  '"MF='                                       00123200
&ZMS                 SETC  '&ZMS.&MF"'                                  00123300
&ZMS                 SETC  '&ZMS "MF"'                                  00123400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00123500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00123600
.ZG44A               ANOP  ,                                            00123700
.*-------------------------------------------------------------------   00123800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00123900
                     AIF   (N'&SYSLIST NE 0).ZG44B  POSITIONALS?        00124000
                     AIF   ('&REQUEST' NE '').ZG44B  KEYS?              00124100
                     AIF   ('&STREAMTOKEN' NE '').ZG44B  KEYS?          00124200
                     AIF   ('&CHECKCONNSTATUS' NE '').ZG44B  KEYS?      00124300
                     AIF   ('&BUFFER' NE '').ZG44B  KEYS?               00124400
                     AIF   ('&BUFFLEN' NE '').ZG44B  KEYS?              00124500
                     AIF   ('&BUFFER64' NE '').ZG44B  KEYS?             00124600
                     AIF   ('&ANSAREA' NE '').ZG44B  KEYS?              00124700
                     AIF   ('&ANSLEN' NE '').ZG44B  KEYS?               00124800
                     AIF   ('&RETCODE' NE '').ZG44B  KEYS?              00124900
                     AIF   ('&RSNCODE' NE '').ZG44B  KEYS?              00125000
                     AGO    .ZG44C     INVOCATION OKAY                  00125100
.ZG44B               ANOP  ,                                            00125200
&ZMS                 SETC  'THE "L" FORM OF "MF"'                       00125300
&ZMS                 SETC  '&ZMS CAN ONLY HAVE'                         00125400
&ZMS                 SETC  '&ZMS THE "PLISTVER" KEY'                    00125500
                     MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'       00125600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00125700
.ZG44C               ANOP  ,                                            00125800
.*-------------------------------------------------------------------   00125900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00126000
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00126100
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00126200
                     AIF   (N'&MF(2) GT 1).ZG46B  MULTI                 00126300
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00126400
.ZG46B               AIF   (K'&MF(2) GT 0).ZG46C                        00126500
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00126600
&ZMS                 SETC  'WHEN "L" IS SPECIFIED'                      00126700
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00126800
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00126900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00127000
.ZG46C               ANOP  ,                                            00127100
.*-------------------------------------------------------------------   00127200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00127300
                     AIF   (K'&ZXMFCTRL LE 0).ZG46P  NOT I/O            00127400
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG46P               00127500
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00127600
&ZMS                 SETC  '"MF='                                       00127700
&ZMS                 SETC  '&ZMS.&MF"'                                  00127800
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00127900
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'            00128000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00128100
.ZG46P               ANOP  ,                                            00128200
.*-------------------------------------------------------------------   00128300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00128400
&ZXMFATTR            SETC  'INPUT'     SET IN/OUTPUT                    00128500
&XMFATTR             SETC  '0D'                                         00128600
                     AIF   (K'&MF(3) LE 0).ZG49B  PARM                  00128700
&XMFATTR             SETC  '&MF(3,1)'  SET XVARIABLE                    00128800
                     AIF   (N'&MF(3) GT 1).ZG49B  MULTI                 00128900
&XMFATTR             SETC  '&MF(3)'    SET XVARIABLE                    00129000
.ZG49B               ANOP  ,                                            00129100
.*-------------------------------------------------------------------   00129200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00129300
                     AIF   (K'&ZXMFATTR LE 0).ZG49P  NOT I/O            00129400
                     AIF   ('&XMFATTR'(1,1) NE '(').ZG49P               00129500
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00129600
&ZMS                 SETC  '"MF='                                       00129700
&ZMS                 SETC  '&ZMS.&MF"'                                  00129800
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00129900
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'            00130000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00130100
.ZG49P               ANOP  ,                                            00130200
.*-------------------------------------------------------------------   00130300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00130400
                     AIF   (K'&ZXMFATTR LE 0).ZG49S  NOT I/O            00130500
                     AIF   (K'&XMFATTR LE 60).ZG49S  LNG OK             00130600
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00130700
&ZMS                 SETC  '"MF='                                       00130800
&ZMS                 SETC  '&ZMS.&MF"'                                  00130900
&ZMS                 SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'        00131000
                     MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'           00131100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00131200
.ZG49S               ANOP  ,                                            00131300
.*-------------------------------------------------------------------   00131400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00131500
.ZG51                ANOP  ,                                            00131600
&ZTLC                SETC 'M'                                           00131700
                     AIF   ('&MF(1)' NE '&ZTLC').ZG60                   00131800
&XMF                 SETC  'M'         SET KEYWORD                      00131900
                     AIF   (N'&MF LE 3).ZG51A   CK NUM                  00132000
&ZMS                 SETC  '"MF='                                       00132100
&ZMS                 SETC  '&ZMS.&MF"'                                  00132200
&ZMS                 SETC  '&ZMS "MF"'                                  00132300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00132400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00132500
.ZG51A               ANOP  ,                                            00132600
.*-------------------------------------------------------------------   00132700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00132800
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00132900
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00133000
                     AIF   (N'&MF(2) GT 1).ZG53B  MULTI                 00133100
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00133200
.ZG53B               AIF   (K'&MF(2) GT 0).ZG53C                        00133300
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00133400
&ZMS                 SETC  'WHEN "M" IS SPECIFIED'                      00133500
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00133600
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00133700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00133800
.ZG53C               ANOP  ,                                            00133900
.*-------------------------------------------------------------------   00134000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00134100
                     AIF   (K'&ZXMFCTRL LE 0).ZG53R  NOT I/O            00134200
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG53R               00134300
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00134400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG53P                 00134500
                     AIF   (K'&ZCGPR GT 2).ZG53Q                        00134600
                     AIF   ('&ZCGPR' EQ '0').ZG53Q                      00134700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00134800
                     AIF   (T'&ZCGPR NE 'N').ZG53Q  INVALID REG NAME    00134900
.ZG53P               ANOP  ,                                            00135000
                     AIF   (T'&ZCGPR NE 'N').ZG53R  NON NUMERIC         00135100
                     AIF   ('&ZCGPR' LT '1').ZG53Q                      00135200
                     AIF   ('&ZCGPR' LE '12').ZG53R                     00135300
.ZG53Q               ANOP  ,                                            00135400
&ZMS                 SETC  '"MF='                                       00135500
&ZMS                 SETC  '&ZMS.&MF"'                                  00135600
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00135700
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00135800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00135900
.ZG53R               ANOP  ,                                            00136000
.*-------------------------------------------------------------------   00136100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00136200
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00136300
.ZG57A   AIF   ('&MF(3)' NE 'COMPLETE').ZG58A                           00136400
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00136500
.*-------------------------------------------------------------------   00136600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00136700
.ZG58A   AIF   ('&MF(3)' NE 'NOCHECK').ZG59A                            00136800
&XMFSCK              SETC  'NOCHECK'   SET KEYWORD                      00136900
.*-------------------------------------------------------------------   00137000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00137100
.ZG59A               AIF   (K'&XMFSCK GT 0).ZG59C  KEYWORD              00137200
                     AIF   (K'&MF(3) LE 0).ZG59B                        00137300
&ZMS                 SETC  '"MF='                                       00137400
&ZMS                 SETC  '&ZMS.&MF"'                                  00137500
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00137600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00137700
&ZMS                 SETC  '&ZMS "COMPLETE"'                            00137800
&ZMS                 SETC  '&ZMS OR "NOCHECK".'                         00137900
                     MNOTE 8,' &ZMS '                                   00138000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00138100
.ZG59B               ANOP  ,                                            00138200
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00138300
.ZG59C               ANOP  ,                                            00138400
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00138500
.*-------------------------------------------------------------------   00138600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138700
.ZG60                ANOP  ,                                            00138800
&ZTLC                SETC 'E'                                           00138900
                     AIF   ('&MF(1)' NE '&ZTLC').ZG69                   00139000
&XMF                 SETC  'E'         SET KEYWORD                      00139100
                     AIF   (N'&MF LE 3).ZG60A   CK NUM                  00139200
&ZMS                 SETC  '"MF='                                       00139300
&ZMS                 SETC  '&ZMS.&MF"'                                  00139400
&ZMS                 SETC  '&ZMS "MF"'                                  00139500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00139600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00139700
.ZG60A               ANOP  ,                                            00139800
.*-------------------------------------------------------------------   00139900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00140000
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00140100
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00140200
                     AIF   (N'&MF(2) GT 1).ZG62B  MULTI                 00140300
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00140400
.ZG62B               AIF   (K'&MF(2) GT 0).ZG62C                        00140500
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00140600
&ZMS                 SETC  'WHEN "E" IS SPECIFIED'                      00140700
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00140800
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00140900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00141000
.ZG62C               ANOP  ,                                            00141100
.*-------------------------------------------------------------------   00141200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00141300
                     AIF   (K'&ZXMFCTRL LE 0).ZG62R  NOT I/O            00141400
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG62R               00141500
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00141600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG62P                 00141700
                     AIF   (K'&ZCGPR GT 2).ZG62Q                        00141800
                     AIF   ('&ZCGPR' EQ '0').ZG62Q                      00141900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00142000
                     AIF   (T'&ZCGPR NE 'N').ZG62Q  INVALID REG NAME    00142100
.ZG62P               ANOP  ,                                            00142200
                     AIF   (T'&ZCGPR NE 'N').ZG62R  NON NUMERIC         00142300
                     AIF   ('&ZCGPR' LT '1').ZG62Q                      00142400
                     AIF   ('&ZCGPR' LE '12').ZG62R                     00142500
.ZG62Q               ANOP  ,                                            00142600
&ZMS                 SETC  '"MF='                                       00142700
&ZMS                 SETC  '&ZMS.&MF"'                                  00142800
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00142900
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00143000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00143100
.ZG62R               ANOP  ,                                            00143200
.*-------------------------------------------------------------------   00143300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00143400
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00143500
.ZG66A   AIF   ('&MF(3)' NE 'COMPLETE').ZG67A                           00143600
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00143700
.*-------------------------------------------------------------------   00143800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00143900
.ZG67A   AIF   ('&MF(3)' NE 'NOCHECK').ZG68A                            00144000
&XMFSCK              SETC  'NOCHECK'   SET KEYWORD                      00144100
.*-------------------------------------------------------------------   00144200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00144300
.ZG68A               AIF   (K'&XMFSCK GT 0).ZG68C  KEYWORD              00144400
                     AIF   (K'&MF(3) LE 0).ZG68B                        00144500
&ZMS                 SETC  '"MF='                                       00144600
&ZMS                 SETC  '&ZMS.&MF"'                                  00144700
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00144800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00144900
&ZMS                 SETC  '&ZMS "COMPLETE"'                            00145000
&ZMS                 SETC  '&ZMS OR "NOCHECK".'                         00145100
                     MNOTE 8,' &ZMS '                                   00145200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00145300
.ZG68B               ANOP  ,                                            00145400
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00145500
.ZG68C               ANOP  ,                                            00145600
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00145700
.*------------------------------------------------------------------    00145800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145900
.ZG69                ANOP  ,                                            00146000
&ZXMF                SETC  'INPUT'     SET IN/OUTPUT                    00146100
                     AIF   (K'&XMF GT 0).ZG69E  VALID ARG               00146200
                     AIF   (T'&MF EQ 'O').ZG69D  OMITTED                00146300
&ZASYSLNDX           SETA  0                                            00146400
.ZG69A               ANOP  ,           POSITIONAL MACRO KEY             00146500
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00146600
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG69C             00146700
&ZTLC                SETC 'MF'                                          00146800
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG69A    00146900
.ZG69B               ANOP  ,                                            00147000
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00147100
&ZMS                 SETC  'THE "MF" KEY'                               00147200
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00147300
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00147400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00147500
                     AGO   .ZG69E                                       00147600
.ZG69C               ANOP  ,                                            00147700
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00147800
&ZMS                 SETC  '"MF='                                       00147900
&ZMS                 SETC  '&ZMS.&MF"'                                  00148000
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00148100
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00148200
&ZMS                 SETC  '&ZMS "S",'                                  00148300
&ZMS                 SETC  '&ZMS "L",'                                  00148400
&ZMS                 SETC  '&ZMS "M",'                                  00148500
&ZMS                 SETC  '&ZMS OR "E".'                               00148600
                     MNOTE 8,' &ZMS '                                   00148700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00148800
                     AGO   .ZG69E                                       00148900
.ZG69D               ANOP  ,                                            00149000
&XMF                 SETC  'S'         SET DEFAULT KEYWORD              00149100
&XMFSCK              SETC  'COMPLETE'  COMPLETE CHECKING                00149200
.ZG69E               ANOP  ,                                            00149300
.********************************************************************   00149400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00149500
.********************************************************************   00149600
                     ACTR  10000                                        00149700
.*-------------------------------------------------------------------   00149800
.***AG.MF03 MF=(SLME)                                                   00149900
                     AIF   ('&XMF' EQ 'L').ZGMFX                        00150000
                     AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX              00150100
.*------------------------------------------------------------------    00150200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150300
&XREQUEST            SETC  ''          INITIALIZE XVARIABLE             00150400
.*-------------------------------------------------------------------   00150500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150600
.ZG3                 ANOP  ,                                            00150700
                     AIF   (K'&REQUEST(1) LE 0).ZG3A                    00150800
&ZTLC                SETC 'LSCONNINFO'                                  00150900
                     AIF   ('&REQUEST(1)' NE '&ZTLC').ZG18              00151000
&XREQUEST            SETC  'LSCONNINFO'         SET KEYWORD             00151100
                     AIF   (N'&REQUEST LE 1).ZG3A  CK NUM               00151200
&ZMS                 SETC  '"REQUEST='                                  00151300
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00151400
&ZMS                 SETC  '&ZMS "REQUEST"'                             00151500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00151600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00151700
.ZG3A                ANOP  ,                                            00151800
.*------------------------------------------------------------------    00151900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152000
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00152100
.ZG3A0               AIF   (K'&BUFFER64 LE 0).ZG3A1  OK                 00152200
&ZCVAL               SETC '&ZCVAL BUFFER64'     INCORRECT KEY USED      00152300
.ZG3A1               AIF   (K'&ZCVAL LE 0).ZG3A2  OK                    00152400
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00152500
&ZMS                 SETC  '"REQUEST'                                   00152600
&ZMS                 SETC  '&ZMS.=&REQUEST"'                            00152700
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00152800
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00152900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00153000
.ZG3A2               ANOP  ,                                            00153100
.*----------------------------------------------------------------***   00153200
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00153300
                     AIF   (N'&STREAMTOKEN LE 1).ZG5A  CK NUM           00153400
&ZMS                 SETC  '"STREAMTOKEN='                              00153500
&ZMS                 SETC  '&ZMS.&STREAMTOKEN"'                         00153600
&ZMS                 SETC  '&ZMS "STREAMTOKEN"'                         00153700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00153800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00153900
.ZG5A                ANOP  ,                                            00154000
.*-------------------------------------------------------------------   00154100
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00154200
&ZXSTREAMTOKEN       SETC  'INPUT'     SET IN/OUTPUT                    00154300
&XSTREAMTOKEN        SETC  '&STREAMTOKEN(1)'    SET XVARIABLE           00154400
                     AIF   (N'&STREAMTOKEN GT 1).ZG5B  MULTI            00154500
&XSTREAMTOKEN        SETC  '&STREAMTOKEN'       SET XVARIABLE           00154600
.ZG5B                AIF   (K'&STREAMTOKEN(1) GT 0).ZG5C                00154700
&ZXSTREAMTOKEN       SETC  ''          RESET IN/OUTPUT                  00154800
&ZMS                 SETC  'WHEN "LSCONNINFO" IS SPECIFIED'             00154900
&ZMS                 SETC  '&ZMS , "STREAMTOKEN" KEY AND ITS'           00155000
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00155100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00155200
.ZG5C                ANOP  ,                                            00155300
.*-------------------------------------------------------------------   00155400
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00155500
                     AIF   (K'&ZXSTREAMTOKEN LE 0).ZG5R  NOT I/O        00155600
                     AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZG5R           00155700
&ZCGPR               SETC  '&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2)         00155800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                  00155900
                     AIF   (K'&ZCGPR GT 2).ZG5Q                         00156000
                     AIF   ('&ZCGPR' EQ '0').ZG5Q                       00156100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00156200
                     AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME     00156300
.ZG5P                ANOP  ,                                            00156400
                     AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC          00156500
                     AIF   ('&ZCGPR' LT '2').ZG5Q                       00156600
                     AIF   ('&ZCGPR' LE '12').ZG5R                      00156700
.ZG5Q                ANOP  ,                                            00156800
&ZMS                 SETC  '"STREAMTOKEN='                              00156900
&ZMS                 SETC  '&ZMS.&STREAMTOKEN"'                         00157000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00157100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00157200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00157300
.ZG5R                ANOP  ,                                            00157400
.*------------------------------------------------------------------    00157500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157600
&XCHECKCONNSTATUS    SETC  ''          INITIALIZE XVARIABLE             00157700
.*-------------------------------------------------------------------   00157800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157900
.ZG9                 ANOP  ,                                            00158000
                     AIF   (K'&CHECKCONNSTATUS(1) LE 0).ZG9A            00158100
&ZTLC                SETC 'NO'                                          00158200
                     AIF   ('&CHECKCONNSTATUS(1)' NE '&ZTLC').ZG16      00158300
&XCHECKCONNSTATUS    SETC  'NO'        SET KEYWORD                      00158400
                     AIF   (N'&CHECKCONNSTATUS LE 1).ZG9A  CK NUM       00158500
&ZMS                 SETC  '"CHECKCONNSTATUS='                          00158600
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00158700
&ZMS                 SETC  '&ZMS "CHECKCONNSTATUS"'                     00158800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00158900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00159000
.ZG9A                ANOP  ,                                            00159100
.*----------------------------------------------------------------***   00159200
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00159300
                     AIF   (N'&BUFFER LE 1).ZG11A  CK NUM               00159400
&ZMS                 SETC  '"BUFFER='                                   00159500
&ZMS                 SETC  '&ZMS.&BUFFER"'                              00159600
&ZMS                 SETC  '&ZMS "BUFFER"'                              00159700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00159800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00159900
.ZG11A               ANOP  ,                                            00160000
.*-------------------------------------------------------------------   00160100
.***AG.KXVAR06 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00160200
&ZXBUFFER            SETC  'OUTPUT'    SET IN/OUTPUT                    00160300
&XBUFFER             SETC  '&BUFFER(1)'         SET XVARIABLE           00160400
                     AIF   (N'&BUFFER GT 1).ZG11B  MULTI                00160500
&XBUFFER             SETC  '&BUFFER'   SET XVARIABLE                    00160600
.ZG11B               AIF   (K'&BUFFER(1) GT 0).ZG11C                    00160700
&ZXBUFFER            SETC  ''          RESET IN/OUTPUT                  00160800
&ZMS                 SETC  ' '                                          00160900
&ZMS                 SETC  '&ZMS "BUFFER" KEY AND ITS'                  00161000
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00161100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00161200
.ZG11C               ANOP  ,                                            00161300
.*-------------------------------------------------------------------   00161400
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00161500
                     AIF   (K'&ZXBUFFER LE 0).ZG11R  NOT I/O            00161600
                     AIF   ('&XBUFFER'(1,1) NE '(').ZG11R               00161700
&ZCGPR               SETC  '&XBUFFER'(2,K'&XBUFFER-2)                   00161800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                 00161900
                     AIF   (K'&ZCGPR GT 2).ZG11Q                        00162000
                     AIF   ('&ZCGPR' EQ '0').ZG11Q                      00162100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00162200
                     AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME    00162300
.ZG11P               ANOP  ,                                            00162400
                     AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC         00162500
                     AIF   ('&ZCGPR' LT '2').ZG11Q                      00162600
                     AIF   ('&ZCGPR' LE '12').ZG11R                     00162700
.ZG11Q               ANOP  ,                                            00162800
&ZMS                 SETC  '"BUFFER='                                   00162900
&ZMS                 SETC  '&ZMS.&BUFFER"'                              00163000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00163100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00163200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00163300
.ZG11R               ANOP  ,                                            00163400
.*----------------------------------------------------------------***   00163500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00163600
                     AIF   (N'&BUFFLEN LE 1).ZG14A  CK NUM              00163700
&ZMS                 SETC  '"BUFFLEN='                                  00163800
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00163900
&ZMS                 SETC  '&ZMS "BUFFLEN"'                             00164000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00164100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00164200
.ZG14A               ANOP  ,                                            00164300
.*-------------------------------------------------------------------   00164400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00164500
&ZXBUFFLEN           SETC  'INPUT'     SET IN/OUTPUT                    00164600
&XBUFFLEN            SETC  '&BUFFLEN(1)'        SET XVARIABLE           00164700
                     AIF   (N'&BUFFLEN GT 1).ZG14B  MULTI               00164800
&XBUFFLEN            SETC  '&BUFFLEN'  SET XVARIABLE                    00164900
.ZG14B               AIF   (K'&BUFFLEN(1) GT 0).ZG14C                   00165000
&ZXBUFFLEN           SETC  ''          RESET IN/OUTPUT                  00165100
&ZMS                 SETC  ' '                                          00165200
&ZMS                 SETC  '&ZMS "BUFFLEN" KEY AND ITS'                 00165300
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00165400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00165500
.ZG14C               ANOP  ,                                            00165600
.*-------------------------------------------------------------------   00165700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00165800
                     AIF   (K'&ZXBUFFLEN LE 0).ZG14R  NOT I/O           00165900
                     AIF   ('&XBUFFLEN'(1,1) NE '(').ZG14R              00166000
&ZCGPR               SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                 00166100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                 00166200
                     AIF   (K'&ZCGPR GT 2).ZG14Q                        00166300
                     AIF   ('&ZCGPR' EQ '0').ZG14Q                      00166400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00166500
                     AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME    00166600
.ZG14P               ANOP  ,                                            00166700
                     AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC         00166800
                     AIF   ('&ZCGPR' LT '2').ZG14Q                      00166900
                     AIF   ('&ZCGPR' LE '12').ZG14R                     00167000
.ZG14Q               ANOP  ,                                            00167100
&ZMS                 SETC  '"BUFFLEN='                                  00167200
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00167300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00167400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00167500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00167600
.ZG14R               ANOP  ,                                            00167700
.*-------------------------------------------------------------------   00167800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167900
.ZG16                ANOP  ,                                            00168000
&ZTLC                SETC 'YES'                                         00168100
                     AIF   ('&CHECKCONNSTATUS(1)' NE '&ZTLC').ZG17      00168200
&XCHECKCONNSTATUS    SETC  'YES'       SET KEYWORD                      00168300
                     AIF   (N'&CHECKCONNSTATUS LE 1).ZG16A  CK NUM      00168400
&ZMS                 SETC  '"CHECKCONNSTATUS='                          00168500
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00168600
&ZMS                 SETC  '&ZMS "CHECKCONNSTATUS"'                     00168700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00168800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00168900
.ZG16A               ANOP  ,                                            00169000
.*------------------------------------------------------------------    00169100
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169200
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00169300
.ZG16A0              AIF   (K'&BUFFER LE 0).ZG16A1  OK                  00169400
&ZCVAL               SETC '&ZCVAL BUFFER'       INCORRECT KEY USED      00169500
.ZG16A1              AIF   (K'&BUFFLEN LE 0).ZG16A2  OK                 00169600
&ZCVAL               SETC '&ZCVAL BUFFLEN'      INCORRECT KEY USED      00169700
.ZG16A2              AIF   (K'&ZCVAL LE 0).ZG16A3  OK                   00169800
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00169900
&ZMS                 SETC  '"CHECKCONNSTATUS'                           00170000
&ZMS                 SETC  '&ZMS.=&CHECKCONNSTATUS"'                    00170100
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00170200
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00170300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00170400
.ZG16A3              ANOP  ,                                            00170500
.*------------------------------------------------------------------    00170600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170700
.ZG17                ANOP  ,                                            00170800
&ZXCHECKCONNSTATUS   SETC  'INPUT'     SET IN/OUTPUT                    00170900
                     AIF   (K'&XCHECKCONNSTATUS GT 0).ZG17E  VALID ARG  00171000
                     AIF   (T'&CHECKCONNSTATUS EQ 'O').ZG17D  OMITTED   00171100
&ZASYSLNDX           SETA  0                                            00171200
.ZG17A               ANOP  ,           POSITIONAL MACRO KEY             00171300
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00171400
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C             00171500
&ZTLC                SETC 'CHECKCONNSTATUS'                             00171600
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG17A    00171700
.ZG17B               ANOP  ,                                            00171800
&ZXCHECKCONNSTATUS   SETC  ''          RESET IN/OUTPUT                  00171900
&ZMS                 SETC  'THE "CHECKCONNSTATUS" KEY'                  00172000
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00172100
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00172200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00172300
                     AGO   .ZG17E                                       00172400
.ZG17C               ANOP  ,                                            00172500
&ZXCHECKCONNSTATUS   SETC  ''          RESET IN/OUTPUT                  00172600
&ZMS                 SETC  '"CHECKCONNSTATUS='                          00172700
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00172800
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00172900
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00173000
&ZMS                 SETC  '&ZMS "NO"'                                  00173100
&ZMS                 SETC  '&ZMS OR "YES".'                             00173200
                     MNOTE 8,' &ZMS '                                   00173300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00173400
                     AGO   .ZG17E                                       00173500
.ZG17D               ANOP  ,                                            00173600
&XCHECKCONNSTATUS    SETC  'NO'        SET DEFAULT KEYWORD              00173700
.ZG17E               ANOP  ,                                            00173800
.*-------------------------------------------------------------------   00173900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174000
.ZG18                ANOP  ,                                            00174100
&ZTLC                SETC 'ZAILOCINFO'                                  00174200
                     AIF   ('&REQUEST(1)' NE '&ZTLC').ZG25              00174300
&XREQUEST            SETC  'ZAILOCINFO'         SET KEYWORD             00174400
                     AIF   (N'&REQUEST LE 1).ZG18A  CK NUM              00174500
&ZMS                 SETC  '"REQUEST='                                  00174600
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00174700
&ZMS                 SETC  '&ZMS "REQUEST"'                             00174800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00174900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00175000
.ZG18A               ANOP  ,                                            00175100
.*------------------------------------------------------------------    00175200
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00175300
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00175400
.ZG18A0              AIF   (K'&STREAMTOKEN LE 0).ZG18A1  OK             00175500
&ZCVAL               SETC '&ZCVAL STREAMTOKEN'  INCORRECT KEY USED      00175600
.ZG18A1              AIF   (K'&CHECKCONNSTATUS LE 0).ZG18A2  OK         00175700
&ZCVAL               SETC '&ZCVAL CHECKCONNSTATUS'  INCORRECT KEY USED  00175800
.ZG18A2              AIF   (K'&BUFFER LE 0).ZG18A3  OK                  00175900
&ZCVAL               SETC '&ZCVAL BUFFER'       INCORRECT KEY USED      00176000
.ZG18A3              AIF   (K'&ZCVAL LE 0).ZG18A4  OK                   00176100
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00176200
&ZMS                 SETC  '"REQUEST'                                   00176300
&ZMS                 SETC  '&ZMS.=&REQUEST"'                            00176400
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00176500
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00176600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00176700
.ZG18A4              ANOP  ,                                            00176800
.*----------------------------------------------------------------***   00176900
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00177000
                     AIF   (N'&BUFFER64 LE 1).ZG20A  CK NUM             00177100
&ZMS                 SETC  '"BUFFER64='                                 00177200
&ZMS                 SETC  '&ZMS.&BUFFER64"'                            00177300
&ZMS                 SETC  '&ZMS "BUFFER64"'                            00177400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00177500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00177600
.ZG20A               ANOP  ,                                            00177700
.*-------------------------------------------------------------------   00177800
.***AG.KXVAR06 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00177900
&ZXBUFFER64          SETC  'OUTPUT'    SET IN/OUTPUT                    00178000
&XBUFFER64           SETC  '&BUFFER64(1)'       SET XVARIABLE           00178100
                     AIF   (N'&BUFFER64 GT 1).ZG20B  MULTI              00178200
&XBUFFER64           SETC  '&BUFFER64'          SET XVARIABLE           00178300
.ZG20B               AIF   (K'&BUFFER64(1) GT 0).ZG20C                  00178400
&ZXBUFFER64          SETC  ''          RESET IN/OUTPUT                  00178500
&ZMS                 SETC  'WHEN "ZAILOCINFO" IS SPECIFIED'             00178600
&ZMS                 SETC  '&ZMS , "BUFFER64" KEY AND ITS'              00178700
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00178800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00178900
.ZG20C               ANOP  ,                                            00179000
.*-------------------------------------------------------------------   00179100
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00179200
                     AIF   (K'&ZXBUFFER64 LE 0).ZG20R  NOT I/O          00179300
                     AIF   ('&XBUFFER64'(1,1) NE '(').ZG20R             00179400
&ZCGPR               SETC  '&XBUFFER64'(2,K'&XBUFFER64-2)               00179500
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                 00179600
                     AIF   (K'&ZCGPR GT 2).ZG20Q                        00179700
                     AIF   ('&ZCGPR' EQ '0').ZG20Q                      00179800
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00179900
                     AIF   (T'&ZCGPR NE 'N').ZG20Q  INVALID REG NAME    00180000
.ZG20P               ANOP  ,                                            00180100
                     AIF   (T'&ZCGPR NE 'N').ZG20R  NON NUMERIC         00180200
                     AIF   ('&ZCGPR' LT '2').ZG20Q                      00180300
                     AIF   ('&ZCGPR' LE '12').ZG20R                     00180400
.ZG20Q               ANOP  ,                                            00180500
&ZMS                 SETC  '"BUFFER64='                                 00180600
&ZMS                 SETC  '&ZMS.&BUFFER64"'                            00180700
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00180800
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00180900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00181000
.ZG20R               ANOP  ,                                            00181100
.*----------------------------------------------------------------***   00181200
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00181300
                     AIF   (N'&BUFFLEN LE 1).ZG23A  CK NUM              00181400
&ZMS                 SETC  '"BUFFLEN='                                  00181500
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00181600
&ZMS                 SETC  '&ZMS "BUFFLEN"'                             00181700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00181800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00181900
.ZG23A               ANOP  ,                                            00182000
.*-------------------------------------------------------------------   00182100
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00182200
&ZXBUFFLEN           SETC  'INPUT'     SET IN/OUTPUT                    00182300
&XBUFFLEN            SETC  '&BUFFLEN(1)'        SET XVARIABLE           00182400
                     AIF   (N'&BUFFLEN GT 1).ZG23B  MULTI               00182500
&XBUFFLEN            SETC  '&BUFFLEN'  SET XVARIABLE                    00182600
.ZG23B               AIF   (K'&BUFFLEN(1) GT 0).ZG23C                   00182700
&ZXBUFFLEN           SETC  ''          RESET IN/OUTPUT                  00182800
&ZMS                 SETC  'WHEN "ZAILOCINFO" IS SPECIFIED'             00182900
&ZMS                 SETC  '&ZMS , "BUFFLEN" KEY AND ITS'               00183000
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00183100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00183200
.ZG23C               ANOP  ,                                            00183300
.*-------------------------------------------------------------------   00183400
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00183500
                     AIF   (K'&ZXBUFFLEN LE 0).ZG23R  NOT I/O           00183600
                     AIF   ('&XBUFFLEN'(1,1) NE '(').ZG23R              00183700
&ZCGPR               SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                 00183800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                 00183900
                     AIF   (K'&ZCGPR GT 2).ZG23Q                        00184000
                     AIF   ('&ZCGPR' EQ '0').ZG23Q                      00184100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00184200
                     AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME    00184300
.ZG23P               ANOP  ,                                            00184400
                     AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC         00184500
                     AIF   ('&ZCGPR' LT '2').ZG23Q                      00184600
                     AIF   ('&ZCGPR' LE '12').ZG23R                     00184700
.ZG23Q               ANOP  ,                                            00184800
&ZMS                 SETC  '"BUFFLEN='                                  00184900
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00185000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00185100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00185200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00185300
.ZG23R               ANOP  ,                                            00185400
.*------------------------------------------------------------------    00185500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00185600
.ZG25                ANOP  ,                                            00185700
&ZXREQUEST           SETC  'INPUT'     SET IN/OUTPUT                    00185800
                     AIF   (K'&XREQUEST GT 0).ZG25E  VALID ARG          00185900
                     AIF   (T'&REQUEST EQ 'O').ZG25D  OMITTED           00186000
&ZASYSLNDX           SETA  0                                            00186100
.ZG25A               ANOP  ,           POSITIONAL MACRO KEY             00186200
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00186300
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C             00186400
&ZTLC                SETC 'REQUEST'                                     00186500
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG25A    00186600
.ZG25B               ANOP  ,                                            00186700
&ZXREQUEST           SETC  ''          RESET IN/OUTPUT                  00186800
&ZMS                 SETC  'THE "REQUEST" KEY'                          00186900
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00187000
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00187100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00187200
                     AGO   .ZG25E                                       00187300
.ZG25C               ANOP  ,                                            00187400
&ZXREQUEST           SETC  ''          RESET IN/OUTPUT                  00187500
&ZMS                 SETC  '"REQUEST='                                  00187600
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00187700
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00187800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00187900
&ZMS                 SETC  '&ZMS "LSCONNINFO"'                          00188000
&ZMS                 SETC  '&ZMS OR "ZAILOCINFO".'                      00188100
                     MNOTE 8,' &ZMS '                                   00188200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00188300
                     AGO   .ZG25E                                       00188400
.ZG25D               ANOP  ,                                            00188500
&XREQUEST            SETC  'LSCONNINFO'         SET DEFAULT KEYWORD     00188600
.ZG25E               ANOP  ,                                            00188700
.*----------------------------------------------------------------***   00188800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00188900
                     AIF   (N'&ANSAREA LE 1).ZG27A  CK NUM              00189000
&ZMS                 SETC  '"ANSAREA='                                  00189100
&ZMS                 SETC  '&ZMS.&ANSAREA"'                             00189200
&ZMS                 SETC  '&ZMS "ANSAREA"'                             00189300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00189400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00189500
.ZG27A               ANOP  ,                                            00189600
.*-------------------------------------------------------------------   00189700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00189800
&ZXANSAREA           SETC  'INPUT'     SET IN/OUTPUT                    00189900
&XANSAREA            SETC  '&ANSAREA(1)'        SET XVARIABLE           00190000
                     AIF   (N'&ANSAREA GT 1).ZG27B  MULTI               00190100
&XANSAREA            SETC  '&ANSAREA'  SET XVARIABLE                    00190200
.ZG27B               AIF   (K'&ANSAREA(1) GT 0).ZG27C                   00190300
&ZXANSAREA           SETC  ''          RESET IN/OUTPUT                  00190400
&ZMS                 SETC  ' '                                          00190500
&ZMS                 SETC  '&ZMS "ANSAREA" KEY AND ITS'                 00190600
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00190700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00190800
.ZG27C               ANOP  ,                                            00190900
.*-------------------------------------------------------------------   00191000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00191100
                     AIF   (K'&ZXANSAREA LE 0).ZG27R  NOT I/O           00191200
                     AIF   ('&XANSAREA'(1,1) NE '(').ZG27R              00191300
&ZCGPR               SETC  '&XANSAREA'(2,K'&XANSAREA-2)                 00191400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                 00191500
                     AIF   (K'&ZCGPR GT 2).ZG27Q                        00191600
                     AIF   ('&ZCGPR' EQ '0').ZG27Q                      00191700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00191800
                     AIF   (T'&ZCGPR NE 'N').ZG27Q  INVALID REG NAME    00191900
.ZG27P               ANOP  ,                                            00192000
                     AIF   (T'&ZCGPR NE 'N').ZG27R  NON NUMERIC         00192100
                     AIF   ('&ZCGPR' LT '2').ZG27Q                      00192200
                     AIF   ('&ZCGPR' LE '12').ZG27R                     00192300
.ZG27Q               ANOP  ,                                            00192400
&ZMS                 SETC  '"ANSAREA='                                  00192500
&ZMS                 SETC  '&ZMS.&ANSAREA"'                             00192600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00192700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00192800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00192900
.ZG27R               ANOP  ,                                            00193000
.*----------------------------------------------------------------***   00193100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00193200
                     AIF   (N'&ANSLEN LE 1).ZG30A  CK NUM               00193300
&ZMS                 SETC  '"ANSLEN='                                   00193400
&ZMS                 SETC  '&ZMS.&ANSLEN"'                              00193500
&ZMS                 SETC  '&ZMS "ANSLEN"'                              00193600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00193700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00193800
.ZG30A               ANOP  ,                                            00193900
.*-------------------------------------------------------------------   00194000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00194100
&ZXANSLEN            SETC  'INPUT'     SET IN/OUTPUT                    00194200
&XANSLEN             SETC  '&ANSLEN(1)'         SET XVARIABLE           00194300
                     AIF   (N'&ANSLEN GT 1).ZG30B  MULTI                00194400
&XANSLEN             SETC  '&ANSLEN'   SET XVARIABLE                    00194500
.ZG30B               AIF   (K'&ANSLEN(1) GT 0).ZG30C                    00194600
&ZXANSLEN            SETC  ''          RESET IN/OUTPUT                  00194700
&ZMS                 SETC  ' '                                          00194800
&ZMS                 SETC  '&ZMS "ANSLEN" KEY AND ITS'                  00194900
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00195000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00195100
.ZG30C               ANOP  ,                                            00195200
.*-------------------------------------------------------------------   00195300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00195400
                     AIF   (K'&ZXANSLEN LE 0).ZG30R  NOT I/O            00195500
                     AIF   ('&XANSLEN'(1,1) NE '(').ZG30R               00195600
&ZCGPR               SETC  '&XANSLEN'(2,K'&XANSLEN-2)                   00195700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG30P                 00195800
                     AIF   (K'&ZCGPR GT 2).ZG30Q                        00195900
                     AIF   ('&ZCGPR' EQ '0').ZG30Q                      00196000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00196100
                     AIF   (T'&ZCGPR NE 'N').ZG30Q  INVALID REG NAME    00196200
.ZG30P               ANOP  ,                                            00196300
                     AIF   (T'&ZCGPR NE 'N').ZG30R  NON NUMERIC         00196400
                     AIF   ('&ZCGPR' LT '2').ZG30Q                      00196500
                     AIF   ('&ZCGPR' LE '12').ZG30R                     00196600
.ZG30Q               ANOP  ,                                            00196700
&ZMS                 SETC  '"ANSLEN='                                   00196800
&ZMS                 SETC  '&ZMS.&ANSLEN"'                              00196900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00197000
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00197100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00197200
.ZG30R               ANOP  ,                                            00197300
.*----------------------------------------------------------------***   00197400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00197500
                     AIF   (N'&RETCODE LE 1).ZG33A  CK NUM              00197600
&ZMS                 SETC  '"RETCODE='                                  00197700
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00197800
&ZMS                 SETC  '&ZMS "RETCODE"'                             00197900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00198000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00198100
.ZG33A               ANOP  ,                                            00198200
.*-------------------------------------------------------------------   00198300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00198400
                     AIF   (K'&RETCODE(1) LE 0).ZG33C  NO PARM          00198500
&ZXRETCODE           SETC  'OUTPUT'    SET OUTPUT                       00198600
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00198700
                     AIF   (N'&RETCODE GT 1).ZG33C                      00198800
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00198900
.ZG33C               ANOP  ,                                            00199000
.*-------------------------------------------------------------------   00199100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00199200
                     AIF   (K'&ZXRETCODE LE 0).ZG33R  NOT I/O           00199300
                     AIF   ('&XRETCODE'(1,1) NE '(').ZG33R              00199400
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00199500
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                 00199600
                     AIF   (K'&ZCGPR GT 2).ZG33Q                        00199700
                     AIF   ('&ZCGPR' EQ '0').ZG33Q                      00199800
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00199900
                     AIF   (T'&ZCGPR NE 'N').ZG33Q  INVALID REG NAME    00200000
.ZG33P               ANOP  ,                                            00200100
                     AIF   (T'&ZCGPR NE 'N').ZG33R  NON NUMERIC         00200200
                     AIF   ('&ZCGPR' EQ '15').ZG33R                     00200300
                     AIF   ('&ZCGPR' LT '2').ZG33Q                      00200400
                     AIF   ('&ZCGPR' LE '12').ZG33R                     00200500
.ZG33Q               ANOP  ,                                            00200600
&ZMS                 SETC  '"RETCODE='                                  00200700
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00200800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00200900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'     00201000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00201100
.ZG33R               ANOP  ,                                            00201200
.*----------------------------------------------------------------***   00201300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00201400
                     AIF   (N'&RSNCODE LE 1).ZG36A  CK NUM              00201500
&ZMS                 SETC  '"RSNCODE='                                  00201600
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00201700
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00201800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00201900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00202000
.ZG36A               ANOP  ,                                            00202100
.*-------------------------------------------------------------------   00202200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00202300
                     AIF   (K'&RSNCODE(1) LE 0).ZG36C  NO PARM          00202400
&ZXRSNCODE           SETC  'OUTPUT'    SET OUTPUT                       00202500
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00202600
                     AIF   (N'&RSNCODE GT 1).ZG36C                      00202700
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00202800
.ZG36C               ANOP  ,                                            00202900
.*-------------------------------------------------------------------   00203000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00203100
                     AIF   (K'&ZXRSNCODE LE 0).ZG36R  NOT I/O           00203200
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZG36R              00203300
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00203400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG36P                 00203500
                     AIF   (K'&ZCGPR GT 2).ZG36Q                        00203600
                     AIF   ('&ZCGPR' EQ '0').ZG36R                      00203700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00203800
                     AIF   (T'&ZCGPR NE 'N').ZG36Q  INVALID REG NAME    00203900
.ZG36P               ANOP  ,                                            00204000
                     AIF   (T'&ZCGPR NE 'N').ZG36R  NON NUMERIC         00204100
                     AIF   ('&ZCGPR' EQ '0').ZG36R                      00204200
                     AIF   ('&ZCGPR' LT '2').ZG36Q                      00204300
                     AIF   ('&ZCGPR' LE '12').ZG36R                     00204400
.ZG36Q               ANOP  ,                                            00204500
&ZMS                 SETC  '"RSNCODE='                                  00204600
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00204700
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00204800
                     MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'      00204900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00205000
.ZG36R               ANOP  ,                                            00205100
.******************************************************************     00205200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00205300
.******************************************************************     00205400
                     ACTR  10000                                        00205500
.*----------------------------------------------------------------***   00205600
.***AH.P02 EXTRA POSITIONALS                                            00205700
                     AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS         00205800
                     AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL         00205900
                     AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL     00206000
                     AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL      00206100
.ZGLISTX1            ANOP  ,                                            00206200
&ZCVAL               SETC  ''          ERROR FIELD                      00206300
&ZAWRK               SETA  0           POSITIONAL NUMBER                00206400
.ZGLIST2             ANOP  ,                                            00206500
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00206600
                     AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE         00206700
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00206800
                     AGO   .ZGLIST2                                     00206900
.*                                                                      00207000
.ZGLIST3             ANOP  ,                                            00207100
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00207200
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'                    00207300
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00207400
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00207500
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00207600
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00207700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00207800
.ZGLISTX             ANOP  ,                                            00207900
&ZASYSLNDX           SETA  0                                            00208000
.*-------------------------------------------------------------------   00208100
.***AG.MF04 MF=(SLME)                                                   00208200
.ZGMFX               ANOP  ,           END OF FULL SYNTAX CHECK         00208300
.********************************************************************   00208400
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00208500
.********************************************************************   00208600
                     ACTR  10000                                        00208700
.*-------------------------------------------------------------------   00208800
.***AE.MF01 MF=(SLME)                                                   00208900
                     AIF   ('&XMF' EQ 'L').ZEMFX                        00209000
                     AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX               00209100
.********************************************************************   00209200
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00209300
.********************************************************************   00209400
&XREQUEST            SETC  ''          INITIALIZE XVARIABLE             00209500
&XCHECKCONNSTATUS    SETC  ''          INITIALIZE XVARIABLE             00209600
.*-------------------------------------------------------------------   00209700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00209800
&ZTLC                SETC 'LSCONNINFO'                                  00209900
                     AIF   ('&REQUEST(1)' NE '&ZTLC').ZE3A              00210000
&XREQUEST            SETC  'LSCONNINFO'         SET KEYWORD             00210100
                     AIF   (N'&REQUEST LE 1).ZE3A  CK NUM               00210200
&ZMS                 SETC  '"REQUEST='                                  00210300
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00210400
&ZMS                 SETC  '&ZMS "REQUEST"'                             00210500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00210600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00210700
.ZE3A                ANOP  ,                                            00210800
.*----------------------------------------------------------------***   00210900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00211000
                     AIF   (N'&STREAMTOKEN LE 1).ZE5A  CK NUM           00211100
&ZMS                 SETC  '"STREAMTOKEN='                              00211200
&ZMS                 SETC  '&ZMS.&STREAMTOKEN"'                         00211300
&ZMS                 SETC  '&ZMS "STREAMTOKEN"'                         00211400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00211500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00211600
.ZE5A                ANOP  ,                                            00211700
.*-------------------------------------------------------------------   00211800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00211900
                     AIF   (K'&STREAMTOKEN(1) LE 0).ZE5B NO PRM         00212000
&ZXSTREAMTOKEN       SETC  'INPUT'     SET IN/OUTPUT                    00212100
&XSTREAMTOKEN        SETC  '&STREAMTOKEN(1)'    SET XVARIABLE           00212200
                     AIF   (N'&STREAMTOKEN GT 1).ZE5B                   00212300
.*                   ANOP                                               00212400
&XSTREAMTOKEN        SETC  '&STREAMTOKEN'       SET XVARIABLE           00212500
.ZE5B                ANOP  ,                                            00212600
.*-------------------------------------------------------------------   00212700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00212800
                     AIF   (K'&ZXSTREAMTOKEN LE 0).ZE5R  NOT I/O        00212900
                     AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZE5R           00213000
&ZCGPR               SETC  '&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2)         00213100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                  00213200
                     AIF   (K'&ZCGPR GT 2).ZE5Q                         00213300
                     AIF   ('&ZCGPR' EQ '0').ZE5Q                       00213400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00213500
                     AIF   (T'&ZCGPR NE 'N').ZE5Q  INVALID REG NAME     00213600
.ZE5P                ANOP  ,                                            00213700
                     AIF   (T'&ZCGPR NE 'N').ZE5R  NON NUMERIC          00213800
                     AIF   ('&ZCGPR' LT '2').ZE5Q                       00213900
                     AIF   ('&ZCGPR' LE '12').ZE5R                      00214000
.ZE5Q                ANOP  ,                                            00214100
&ZMS                 SETC  '"STREAMTOKEN='                              00214200
&ZMS                 SETC  '&ZMS.&STREAMTOKEN"'                         00214300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00214400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00214500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00214600
.ZE5R                ANOP  ,                                            00214700
.*-------------------------------------------------------------------   00214800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00214900
&ZTLC                SETC 'NO'                                          00215000
                     AIF   ('&CHECKCONNSTATUS(1)' NE '&ZTLC').ZE9A      00215100
&XCHECKCONNSTATUS    SETC  'NO'        SET KEYWORD                      00215200
                     AIF   (N'&CHECKCONNSTATUS LE 1).ZE9A  CK NUM       00215300
&ZMS                 SETC  '"CHECKCONNSTATUS='                          00215400
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00215500
&ZMS                 SETC  '&ZMS "CHECKCONNSTATUS"'                     00215600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00215700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00215800
.ZE9A                ANOP  ,                                            00215900
.*----------------------------------------------------------------***   00216000
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         00216100
                     AIF   (N'&BUFFER LE 1).ZE11A  CK NUM               00216200
&ZMS                 SETC  '"BUFFER='                                   00216300
&ZMS                 SETC  '&ZMS.&BUFFER"'                              00216400
&ZMS                 SETC  '&ZMS "BUFFER"'                              00216500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00216600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00216700
.ZE11A               ANOP  ,                                            00216800
.*-------------------------------------------------------------------   00216900
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    00217000
                     AIF   (K'&BUFFER(1) LE 0).ZE11B NO PRM             00217100
&ZXBUFFER            SETC  'OUTPUT'    SET IN/OUTPUT                    00217200
&XBUFFER             SETC  '&BUFFER(1)'         SET XVARIABLE           00217300
                     AIF   (N'&BUFFER GT 1).ZE11B                       00217400
.*                   ANOP                                               00217500
&XBUFFER             SETC  '&BUFFER'   SET XVARIABLE                    00217600
.ZE11B               ANOP  ,                                            00217700
.*-------------------------------------------------------------------   00217800
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00217900
                     AIF   (K'&ZXBUFFER LE 0).ZE11R  NOT I/O            00218000
                     AIF   ('&XBUFFER'(1,1) NE '(').ZE11R               00218100
&ZCGPR               SETC  '&XBUFFER'(2,K'&XBUFFER-2)                   00218200
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE11P                 00218300
                     AIF   (K'&ZCGPR GT 2).ZE11Q                        00218400
                     AIF   ('&ZCGPR' EQ '0').ZE11Q                      00218500
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00218600
                     AIF   (T'&ZCGPR NE 'N').ZE11Q  INVALID REG NAME    00218700
.ZE11P               ANOP  ,                                            00218800
                     AIF   (T'&ZCGPR NE 'N').ZE11R  NON NUMERIC         00218900
                     AIF   ('&ZCGPR' LT '2').ZE11Q                      00219000
                     AIF   ('&ZCGPR' LE '12').ZE11R                     00219100
.ZE11Q               ANOP  ,                                            00219200
&ZMS                 SETC  '"BUFFER='                                   00219300
&ZMS                 SETC  '&ZMS.&BUFFER"'                              00219400
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00219500
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00219600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00219700
.ZE11R               ANOP  ,                                            00219800
.*----------------------------------------------------------------***   00219900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00220000
                     AIF   (N'&BUFFLEN LE 1).ZE14A  CK NUM              00220100
&ZMS                 SETC  '"BUFFLEN='                                  00220200
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00220300
&ZMS                 SETC  '&ZMS "BUFFLEN"'                             00220400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00220500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00220600
.ZE14A               ANOP  ,                                            00220700
.*-------------------------------------------------------------------   00220800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00220900
                     AIF   (K'&BUFFLEN(1) LE 0).ZE14B NO PRM            00221000
&ZXBUFFLEN           SETC  'INPUT'     SET IN/OUTPUT                    00221100
&XBUFFLEN            SETC  '&BUFFLEN(1)'        SET XVARIABLE           00221200
                     AIF   (N'&BUFFLEN GT 1).ZE14B                      00221300
.*                   ANOP                                               00221400
&XBUFFLEN            SETC  '&BUFFLEN'  SET XVARIABLE                    00221500
.ZE14B               ANOP  ,                                            00221600
.*-------------------------------------------------------------------   00221700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00221800
                     AIF   (K'&ZXBUFFLEN LE 0).ZE14R  NOT I/O           00221900
                     AIF   ('&XBUFFLEN'(1,1) NE '(').ZE14R              00222000
&ZCGPR               SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                 00222100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE14P                 00222200
                     AIF   (K'&ZCGPR GT 2).ZE14Q                        00222300
                     AIF   ('&ZCGPR' EQ '0').ZE14Q                      00222400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00222500
                     AIF   (T'&ZCGPR NE 'N').ZE14Q  INVALID REG NAME    00222600
.ZE14P               ANOP  ,                                            00222700
                     AIF   (T'&ZCGPR NE 'N').ZE14R  NON NUMERIC         00222800
                     AIF   ('&ZCGPR' LT '2').ZE14Q                      00222900
                     AIF   ('&ZCGPR' LE '12').ZE14R                     00223000
.ZE14Q               ANOP  ,                                            00223100
&ZMS                 SETC  '"BUFFLEN='                                  00223200
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00223300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00223400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00223500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00223600
.ZE14R               ANOP  ,                                            00223700
.*-------------------------------------------------------------------   00223800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00223900
&ZTLC                SETC 'YES'                                         00224000
                     AIF   ('&CHECKCONNSTATUS(1)' NE '&ZTLC').ZE16A     00224100
&XCHECKCONNSTATUS    SETC  'YES'       SET KEYWORD                      00224200
                     AIF   (N'&CHECKCONNSTATUS LE 1).ZE16A  CK NUM      00224300
&ZMS                 SETC  '"CHECKCONNSTATUS='                          00224400
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00224500
&ZMS                 SETC  '&ZMS "CHECKCONNSTATUS"'                     00224600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00224700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00224800
.ZE16A               ANOP  ,                                            00224900
.*------------------------------------------------------------------    00225000
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00225100
.ZE17                AIF   (K'&XCHECKCONNSTATUS GT 0).ZE17A             00225200
                     AIF   (K'&CHECKCONNSTATUS(1) LE 0).ZE17B           00225300
&ZMS                 SETC  '"CHECKCONNSTATUS='                          00225400
&ZMS                 SETC  '&ZMS.&CHECKCONNSTATUS"'                     00225500
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00225600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00225700
&ZMS                 SETC  '&ZMS "NO"'                                  00225800
&ZMS                 SETC  '&ZMS OR "YES".'                             00225900
                     MNOTE 8,' &ZMS '                                   00226000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00226100
                     AGO   .ZE17B                                       00226200
.*                                                                      00226300
.ZE17A               ANOP  ,                                            00226400
&ZXCHECKCONNSTATUS   SETC  'INPUT'     SET IN/OUTPUT                    00226500
.ZE17B               ANOP  ,                                            00226600
.*-------------------------------------------------------------------   00226700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00226800
&ZTLC                SETC 'ZAILOCINFO'                                  00226900
                     AIF   ('&REQUEST(1)' NE '&ZTLC').ZE18A             00227000
&XREQUEST            SETC  'ZAILOCINFO'         SET KEYWORD             00227100
                     AIF   (N'&REQUEST LE 1).ZE18A  CK NUM              00227200
&ZMS                 SETC  '"REQUEST='                                  00227300
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00227400
&ZMS                 SETC  '&ZMS "REQUEST"'                             00227500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00227600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00227700
.ZE18A               ANOP  ,                                            00227800
.*----------------------------------------------------------------***   00227900
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         00228000
                     AIF   (N'&BUFFER64 LE 1).ZE20A  CK NUM             00228100
&ZMS                 SETC  '"BUFFER64='                                 00228200
&ZMS                 SETC  '&ZMS.&BUFFER64"'                            00228300
&ZMS                 SETC  '&ZMS "BUFFER64"'                            00228400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00228500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00228600
.ZE20A               ANOP  ,                                            00228700
.*-------------------------------------------------------------------   00228800
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    00228900
                     AIF   (K'&BUFFER64(1) LE 0).ZE20B NO PRM           00229000
&ZXBUFFER64          SETC  'OUTPUT'    SET IN/OUTPUT                    00229100
&XBUFFER64           SETC  '&BUFFER64(1)'       SET XVARIABLE           00229200
                     AIF   (N'&BUFFER64 GT 1).ZE20B                     00229300
.*                   ANOP                                               00229400
&XBUFFER64           SETC  '&BUFFER64'          SET XVARIABLE           00229500
.ZE20B               ANOP  ,                                            00229600
.*-------------------------------------------------------------------   00229700
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00229800
                     AIF   (K'&ZXBUFFER64 LE 0).ZE20R  NOT I/O          00229900
                     AIF   ('&XBUFFER64'(1,1) NE '(').ZE20R             00230000
&ZCGPR               SETC  '&XBUFFER64'(2,K'&XBUFFER64-2)               00230100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE20P                 00230200
                     AIF   (K'&ZCGPR GT 2).ZE20Q                        00230300
                     AIF   ('&ZCGPR' EQ '0').ZE20Q                      00230400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00230500
                     AIF   (T'&ZCGPR NE 'N').ZE20Q  INVALID REG NAME    00230600
.ZE20P               ANOP  ,                                            00230700
                     AIF   (T'&ZCGPR NE 'N').ZE20R  NON NUMERIC         00230800
                     AIF   ('&ZCGPR' LT '2').ZE20Q                      00230900
                     AIF   ('&ZCGPR' LE '12').ZE20R                     00231000
.ZE20Q               ANOP  ,                                            00231100
&ZMS                 SETC  '"BUFFER64='                                 00231200
&ZMS                 SETC  '&ZMS.&BUFFER64"'                            00231300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00231400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00231500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00231600
.ZE20R               ANOP  ,                                            00231700
.*----------------------------------------------------------------***   00231800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00231900
                     AIF   (N'&BUFFLEN LE 1).ZE23A  CK NUM              00232000
&ZMS                 SETC  '"BUFFLEN='                                  00232100
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00232200
&ZMS                 SETC  '&ZMS "BUFFLEN"'                             00232300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00232400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00232500
.ZE23A               ANOP  ,                                            00232600
.*-------------------------------------------------------------------   00232700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00232800
                     AIF   (K'&BUFFLEN(1) LE 0).ZE23B NO PRM            00232900
&ZXBUFFLEN           SETC  'INPUT'     SET IN/OUTPUT                    00233000
&XBUFFLEN            SETC  '&BUFFLEN(1)'        SET XVARIABLE           00233100
                     AIF   (N'&BUFFLEN GT 1).ZE23B                      00233200
.*                   ANOP                                               00233300
&XBUFFLEN            SETC  '&BUFFLEN'  SET XVARIABLE                    00233400
.ZE23B               ANOP  ,                                            00233500
.*-------------------------------------------------------------------   00233600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00233700
                     AIF   (K'&ZXBUFFLEN LE 0).ZE23R  NOT I/O           00233800
                     AIF   ('&XBUFFLEN'(1,1) NE '(').ZE23R              00233900
&ZCGPR               SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                 00234000
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE23P                 00234100
                     AIF   (K'&ZCGPR GT 2).ZE23Q                        00234200
                     AIF   ('&ZCGPR' EQ '0').ZE23Q                      00234300
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00234400
                     AIF   (T'&ZCGPR NE 'N').ZE23Q  INVALID REG NAME    00234500
.ZE23P               ANOP  ,                                            00234600
                     AIF   (T'&ZCGPR NE 'N').ZE23R  NON NUMERIC         00234700
                     AIF   ('&ZCGPR' LT '2').ZE23Q                      00234800
                     AIF   ('&ZCGPR' LE '12').ZE23R                     00234900
.ZE23Q               ANOP  ,                                            00235000
&ZMS                 SETC  '"BUFFLEN='                                  00235100
&ZMS                 SETC  '&ZMS.&BUFFLEN"'                             00235200
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00235300
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00235400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00235500
.ZE23R               ANOP  ,                                            00235600
.*------------------------------------------------------------------    00235700
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00235800
.ZE25                AIF   (K'&XREQUEST GT 0).ZE25A                     00235900
                     AIF   (K'&REQUEST(1) LE 0).ZE25B                   00236000
&ZMS                 SETC  '"REQUEST='                                  00236100
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00236200
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00236300
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00236400
&ZMS                 SETC  '&ZMS "LSCONNINFO"'                          00236500
&ZMS                 SETC  '&ZMS OR "ZAILOCINFO".'                      00236600
                     MNOTE 8,' &ZMS '                                   00236700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00236800
                     AGO   .ZE25B                                       00236900
.*                                                                      00237000
.ZE25A               ANOP  ,                                            00237100
&ZXREQUEST           SETC  'INPUT'     SET IN/OUTPUT                    00237200
.ZE25B               ANOP  ,                                            00237300
.*----------------------------------------------------------------***   00237400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00237500
                     AIF   (N'&ANSAREA LE 1).ZE27A  CK NUM              00237600
&ZMS                 SETC  '"ANSAREA='                                  00237700
&ZMS                 SETC  '&ZMS.&ANSAREA"'                             00237800
&ZMS                 SETC  '&ZMS "ANSAREA"'                             00237900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00238000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00238100
.ZE27A               ANOP  ,                                            00238200
.*-------------------------------------------------------------------   00238300
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00238400
                     AIF   (K'&ANSAREA(1) LE 0).ZE27B NO PRM            00238500
&ZXANSAREA           SETC  'INPUT'     SET IN/OUTPUT                    00238600
&XANSAREA            SETC  '&ANSAREA(1)'        SET XVARIABLE           00238700
                     AIF   (N'&ANSAREA GT 1).ZE27B                      00238800
.*                   ANOP                                               00238900
&XANSAREA            SETC  '&ANSAREA'  SET XVARIABLE                    00239000
.ZE27B               ANOP  ,                                            00239100
.*-------------------------------------------------------------------   00239200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00239300
                     AIF   (K'&ZXANSAREA LE 0).ZE27R  NOT I/O           00239400
                     AIF   ('&XANSAREA'(1,1) NE '(').ZE27R              00239500
&ZCGPR               SETC  '&XANSAREA'(2,K'&XANSAREA-2)                 00239600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE27P                 00239700
                     AIF   (K'&ZCGPR GT 2).ZE27Q                        00239800
                     AIF   ('&ZCGPR' EQ '0').ZE27Q                      00239900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00240000
                     AIF   (T'&ZCGPR NE 'N').ZE27Q  INVALID REG NAME    00240100
.ZE27P               ANOP  ,                                            00240200
                     AIF   (T'&ZCGPR NE 'N').ZE27R  NON NUMERIC         00240300
                     AIF   ('&ZCGPR' LT '2').ZE27Q                      00240400
                     AIF   ('&ZCGPR' LE '12').ZE27R                     00240500
.ZE27Q               ANOP  ,                                            00240600
&ZMS                 SETC  '"ANSAREA='                                  00240700
&ZMS                 SETC  '&ZMS.&ANSAREA"'                             00240800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00240900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00241000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00241100
.ZE27R               ANOP  ,                                            00241200
.*----------------------------------------------------------------***   00241300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00241400
                     AIF   (N'&ANSLEN LE 1).ZE30A  CK NUM               00241500
&ZMS                 SETC  '"ANSLEN='                                   00241600
&ZMS                 SETC  '&ZMS.&ANSLEN"'                              00241700
&ZMS                 SETC  '&ZMS "ANSLEN"'                              00241800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00241900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00242000
.ZE30A               ANOP  ,                                            00242100
.*-------------------------------------------------------------------   00242200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00242300
                     AIF   (K'&ANSLEN(1) LE 0).ZE30B NO PRM             00242400
&ZXANSLEN            SETC  'INPUT'     SET IN/OUTPUT                    00242500
&XANSLEN             SETC  '&ANSLEN(1)'         SET XVARIABLE           00242600
                     AIF   (N'&ANSLEN GT 1).ZE30B                       00242700
.*                   ANOP                                               00242800
&XANSLEN             SETC  '&ANSLEN'   SET XVARIABLE                    00242900
.ZE30B               ANOP  ,                                            00243000
.*-------------------------------------------------------------------   00243100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00243200
                     AIF   (K'&ZXANSLEN LE 0).ZE30R  NOT I/O            00243300
                     AIF   ('&XANSLEN'(1,1) NE '(').ZE30R               00243400
&ZCGPR               SETC  '&XANSLEN'(2,K'&XANSLEN-2)                   00243500
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE30P                 00243600
                     AIF   (K'&ZCGPR GT 2).ZE30Q                        00243700
                     AIF   ('&ZCGPR' EQ '0').ZE30Q                      00243800
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00243900
                     AIF   (T'&ZCGPR NE 'N').ZE30Q  INVALID REG NAME    00244000
.ZE30P               ANOP  ,                                            00244100
                     AIF   (T'&ZCGPR NE 'N').ZE30R  NON NUMERIC         00244200
                     AIF   ('&ZCGPR' LT '2').ZE30Q                      00244300
                     AIF   ('&ZCGPR' LE '12').ZE30R                     00244400
.ZE30Q               ANOP  ,                                            00244500
&ZMS                 SETC  '"ANSLEN='                                   00244600
&ZMS                 SETC  '&ZMS.&ANSLEN"'                              00244700
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00244800
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00244900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00245000
.ZE30R               ANOP  ,                                            00245100
.*----------------------------------------------------------------***   00245200
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00245300
                     AIF   (N'&RETCODE LE 1).ZE33A  CK NUM              00245400
&ZMS                 SETC  '"RETCODE='                                  00245500
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00245600
&ZMS                 SETC  '&ZMS "RETCODE"'                             00245700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00245800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00245900
.ZE33A               ANOP  ,                                            00246000
.*-------------------------------------------------------------------   00246100
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00246200
                     AIF   (K'&RETCODE(1) LE 0).ZE33B NO PRM            00246300
&ZXRETCODE           SETC  'OUTPUT'    SET IN/OUTPUT                    00246400
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00246500
                     AIF   (N'&RETCODE GT 1).ZE33B                      00246600
.*                   ANOP                                               00246700
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00246800
.ZE33B               ANOP  ,                                            00246900
.*-------------------------------------------------------------------   00247000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00247100
                     AIF   (K'&ZXRETCODE LE 0).ZE33R  NOT I/O           00247200
                     AIF   ('&XRETCODE'(1,1) NE '(').ZE33R              00247300
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00247400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE33P                 00247500
                     AIF   (K'&ZCGPR GT 2).ZE33Q                        00247600
                     AIF   ('&ZCGPR' EQ '0').ZE33Q                      00247700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00247800
                     AIF   (T'&ZCGPR NE 'N').ZE33Q  INVALID REG NAME    00247900
.ZE33P               ANOP  ,                                            00248000
                     AIF   (T'&ZCGPR NE 'N').ZE33R  NON NUMERIC         00248100
                     AIF   ('&ZCGPR' LT '2').ZE33Q                      00248200
                     AIF   ('&ZCGPR' LE '12').ZE33R                     00248300
.ZE33Q               ANOP  ,                                            00248400
&ZMS                 SETC  '"RETCODE='                                  00248500
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00248600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00248700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00248800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00248900
.ZE33R               ANOP  ,                                            00249000
.*----------------------------------------------------------------***   00249100
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00249200
                     AIF   (N'&RSNCODE LE 1).ZE36A  CK NUM              00249300
&ZMS                 SETC  '"RSNCODE='                                  00249400
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00249500
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00249600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00249700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00249800
.ZE36A               ANOP  ,                                            00249900
.*-------------------------------------------------------------------   00250000
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00250100
                     AIF   (K'&RSNCODE(1) LE 0).ZE36B NO PRM            00250200
&ZXRSNCODE           SETC  'OUTPUT'    SET IN/OUTPUT                    00250300
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00250400
                     AIF   (N'&RSNCODE GT 1).ZE36B                      00250500
.*                   ANOP                                               00250600
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00250700
.ZE36B               ANOP  ,                                            00250800
.*-------------------------------------------------------------------   00250900
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00251000
                     AIF   (K'&ZXRSNCODE LE 0).ZE36R  NOT I/O           00251100
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZE36R              00251200
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00251300
                     AIF   ('&ZCGPR'(1,1) NE '0').ZE36P                 00251400
                     AIF   (K'&ZCGPR GT 2).ZE36Q                        00251500
                     AIF   ('&ZCGPR' EQ '0').ZE36Q                      00251600
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00251700
                     AIF   (T'&ZCGPR NE 'N').ZE36Q  INVALID REG NAME    00251800
.ZE36P               ANOP  ,                                            00251900
                     AIF   (T'&ZCGPR NE 'N').ZE36R  NON NUMERIC         00252000
                     AIF   ('&ZCGPR' LT '2').ZE36Q                      00252100
                     AIF   ('&ZCGPR' LE '12').ZE36R                     00252200
.ZE36Q               ANOP  ,                                            00252300
&ZMS                 SETC  '"RSNCODE='                                  00252400
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00252500
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00252600
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00252700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00252800
.ZE36R               ANOP  ,                                            00252900
.******************************************************************     00253000
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00253100
.******************************************************************     00253200
                     ACTR  10000                                        00253300
.*----------------------------------------------------------------***   00253400
.***AF.P02 EXTRA POSITIONALS                                            00253500
                     AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS         00253600
&ZCVAL               SETC  ''          ERROR FIELD                      00253700
&ZAWRK               SETA  0           POSITIONAL NUMBER                00253800
.ZELIST2             ANOP  ,                                            00253900
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00254000
                     AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE         00254100
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00254200
                     AGO   .ZELIST2                                     00254300
.*                                                                      00254400
.ZELIST3             ANOP  ,                                            00254500
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00254600
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'                    00254700
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00254800
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00254900
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00255000
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00255100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00255200
.ZELISTX             ANOP  ,                                            00255300
&ZASYSLNDX           SETA  0                                            00255400
.*-------------------------------------------------------------------   00255500
.***AE.MF02 MF=(SLME)                                                   00255600
.ZEMFX               ANOP  ,           END OF PARTIAL SYNTAX CHECK      00255700
.*******************************************************************    00255800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00255900
.*******************************************************************    00256000
                     AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED         00256100
.*******************************************************************    00256200
.***AE.01  START OF IXGQUERY MACRO CODE                                 00256300
.*******************************************************************    00256400
                     LCLC  &M0M0001                 NAME                00256500
&M0M0001             SETC  '&XLABEL'                SET NAME            00256600
                     AIF   (K'&XLABEL NE 0).XLAB2                       00256700
&M0M0001             SETC  'M00M&SYSNDX'            DEFAULT NAME        00256800
.*                                                                      00256900
.XLAB2               ANOP  ,                                            00257000
                     AIF   ('&XMF' EQ 'L').XLAB3                        00257100
&M0M0001 DS    0H                             IXGQUERY-2                00257200
.XLAB3               ANOP  ,                                            00257300
.*******************************************************************    00257400
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00257500
.*******************************************************************    00257600
              PUSH  PRINT                                               00257700
                     AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON   00257800
                     PRINT OFF         ++ PR01                          00257900
                     AGO   .ZPRNTXX                                     00258000
.ZPRINTX             PRINT ON                                           00258100
.ZPRNTXX             ANOP  ,                                            00258200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00258300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00258400
.********************************************************************   00258500
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00258600
.********************************************************************   00258700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00258800
                      LCLA  &ZOPN1         INVOCATION INDEX             00258900
                      LCLC  &ZOPL(4095)    LABEL                        00259000
                      LCLC  &ZOPO(4095)    OPERATION                    00259100
                      LCLC  &ZOPV(4095)    VALUE                        00259200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00259300
.*                                                                      00259400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00259500
.******************************************************************     00259600
.***AL.L10 IXGQUERY FMT=LIST MF=S!L PARAMETERS                          00259700
.******************************************************************     00259800
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00259900
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00260000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00260100
&XMFATTR              SETC  '0D'                                        00260200
.*                                                                      00260300
&ZOPN                 SETA  &ZOPN+1                                     00260400
&ZOPL(&ZOPN)          SETC  ' '                                         00260500
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00260600
&ZOPO(&ZOPN)          SETC  'B'                                         00260700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00260800
                      AGO   .ZALVL6B                                    00260900
.ZALVL6A              ANOP                                              00261000
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00261100
&ZOPV(&ZOPN)          SETC  '4,8'                                       00261200
&ZOPN                 SETA  &ZOPN+1                                     00261300
&ZOPL(&ZOPN)          SETC  ' '                                         00261400
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00261500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00261600
.ZALVL6B              ANOP                                              00261700
&ZOPD(&ZOPN)          SETC  '++ IXGQUERY ARG PARMS'                     00261800
.*                                                                      00261900
&ZOPN                 SETA  &ZOPN+1                                     00262000
&ZOPL(&ZOPN)          SETC  ' '                                         00262100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00262200
&ZOPV(&ZOPN)          SETC  '1'                                         00262300
&ZOPD(&ZOPN)          SETC  ' '                                         00262400
.*                                                                      00262500
.ZLMFSL2              ANOP  ,                                           00262600
.*-------------------------------------------------------------------   00262700
.***AM.L00  IXGQUERY FMT=LIST name                                      00262800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00262900
&ZOPN                 SETA &ZOPN+1                                      00263000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00263100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00263200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00263300
&ZOPD(&ZOPN)          SETC '++ IXGQUERY NAME'                           00263400
.ZLMFSL2M             ANOP  ,                                           00263500
.*-------------------------------------------------------------------   00263600
.***AM.L01  IXGQUERY FMT=LIST PARAMETERS                                00263700
&ZOPN                 SETA &ZOPN+1                                      00263800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00263900
&ZOPO(&ZOPN)          SETC 'DS'                                         00264000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00264100
&ZOPD(&ZOPN)          SETC '++ IXGQUERY PARM LIST'                      00264200
.*-------------------------------------------------------------------   00264300
.***AM.L02 XVERSION XL1                                                 00264400
&ZOPN                 SETA &ZOPN+1                                      00264500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00264600
&ZOPO(&ZOPN)          SETC 'DS'                                         00264700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00264800
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00264900
.*-------------------------------------------------------------------   00265000
.***AM.L03 XIXGFLAGS BL.8                                               00265100
&ZOPN                 SETA &ZOPN+1                                      00265200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIXGFLAGS'                        00265300
&ZOPO(&ZOPN)          SETC 'DS'                                         00265400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00265500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00265600
.*                                                                      00265700
&ZOPN                 SETA  &ZOPN+1                                     00265800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCHECKCONNSTATUS_YES'            00265900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00266000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00266100
&ZOPD(&ZOPN)          SETC  '++ XCHECKCONNSTATUS.'                      00266200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00266300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00266400
.*                                                                      00266500
&ZOPN                 SETA  &ZOPN+1                                     00266600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_REQUEST'                 00266700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00266800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00266900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00267000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REQUEST'                      00267100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00267200
.*                                                                      00267300
&ZOPN                 SETA  &ZOPN+1                                     00267400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_ZAILOCINFO'             00267500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00267600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00267700
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00267800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ZAILOCINFO'                   00267900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00268000
.*-------------------------------------------------------------------   00268100
.***AM.L09  XRSV0001 CL2                                                00268200
&ZOPN                 SETA &ZOPN+1                                      00268300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00268400
&ZOPO(&ZOPN)          SETC 'DS'                                         00268500
&ZOPV(&ZOPN)          SETC 'CL2'                                        00268600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00268700
.*-------------------------------------------------------------------   00268800
.***AM.L09  XPLISTPTR A                                                 00268900
&ZOPN                 SETA &ZOPN+1                                      00269000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTPTR'                        00269100
&ZOPO(&ZOPN)          SETC 'DS'                                         00269200
&ZOPV(&ZOPN)          SETC 'A'                                          00269300
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00269400
.*-------------------------------------------------------------------   00269500
.***AM.L09 ADDR XBUFFER A                                               00269600
&ZOPN                 SETA &ZOPN+1                                      00269700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ADDR'                     00269800
&ZOPO(&ZOPN)          SETC 'DS'                                         00269900
&ZOPV(&ZOPN)          SETC 'A'                                          00270000
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ADDR'                          00270100
.*-------------------------------------------------------------------   00270200
.***AM.L09  XBUFFLEN F                                                  00270300
&ZOPN                 SETA &ZOPN+1                                      00270400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFLEN'                         00270500
&ZOPO(&ZOPN)          SETC 'DS'                                         00270600
&ZOPV(&ZOPN)          SETC 'F'                                          00270700
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFLEN '                             00270800
.*-------------------------------------------------------------------   00270900
.***AM.L09  XANSAREA A                                                  00271000
&ZOPN                 SETA &ZOPN+1                                      00271100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA'                         00271200
&ZOPO(&ZOPN)          SETC 'DS'                                         00271300
&ZOPV(&ZOPN)          SETC 'A'                                          00271400
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA '                             00271500
.*-------------------------------------------------------------------   00271600
.***AM.L09  XANSLEN F                                                   00271700
&ZOPN                 SETA &ZOPN+1                                      00271800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00271900
&ZOPO(&ZOPN)          SETC 'DS'                                         00272000
&ZOPV(&ZOPN)          SETC 'F'                                          00272100
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN '                              00272200
.*-------------------------------------------------------------------   00272300
.***AM.L09  XSTREAMTOKEN CL16                                           00272400
&ZOPN                 SETA &ZOPN+1                                      00272500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTREAMTOKEN'                     00272600
&ZOPO(&ZOPN)          SETC 'DS'                                         00272700
&ZOPV(&ZOPN)          SETC 'CL16'                                       00272800
&ZOPD(&ZOPN)          SETC '++ &ZXSTREAMTOKEN '                         00272900
.*-------------------------------------------------------------------   00273000
.***AM.MLM2 SAVED LOCATION COUNTER                                      00273100
                      AIF  (&XPLISTVER GE 2).ZL13LA                     00273200
                      AIF  ('&ZENDBASEPL' NE '').ZL13LA                 00273300
&ZENDBASEPL           SETC 'YES'                                        00273400
&ZOPN                 SETA &ZOPN+1                                      00273500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00273600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00273700
&ZOPV(&ZOPN)          SETC '*'                                          00273800
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00273900
.ZL13LA               ANOP  ,                                           00274000
.*-------------------------------------------------------------------   00274100
.***AM.LVER1                                                            00274200
                      AIF  (&XPLISTVER LT 2).ZL13L                      00274300
.*-------------------------------------------------------------------   00274400
.*-------------------------------------------------------------------   00274500
.***AM.L09 ADDR64 XBUFFER64 AD                                          00274600
&ZOPN                 SETA &ZOPN+1                                      00274700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER64_ADDR64'                 00274800
&ZOPO(&ZOPN)          SETC 'DS'                                         00274900
&ZOPV(&ZOPN)          SETC 'AD'                                         00275000
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER64 ADDR64'                      00275100
.*-------------------------------------------------------------------   00275200
.***AM.LVER2                                                            00275300
.ZL13L                ANOP  ,                                           00275400
.*-------------------------------------------------------------------   00275500
.*-------------------------------------------------------------------   00275600
.***AM.L10 END OF IXGQUERY LIST PARAMETERS                              00275700
&ZOPN                 SETA &ZOPN+1                                      00275800
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00275900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00276000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00276100
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00276200
.*                                                                      00276300
&ZOPN                 SETA &ZOPN+1                                      00276400
&ZOPL(&ZOPN)          SETC ' '                                          00276500
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00276600
&ZOPV(&ZOPN)          SETC '1'                                          00276700
&ZOPD(&ZOPN)          SETC ' '                                          00276800
.*-------------------------------------------------------------------   00276900
.***AL.L12 IXGQUERY FMT=LIST MF=S!L PARAMETERS                          00277000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00277100
.*                                                                      00277200
&ZOPN                 SETA  &ZOPN+1                                     00277300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00277400
&ZOPO(&ZOPN)          SETC  'DC'                                        00277500
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00277600
&ZOPD(&ZOPN)          SETC  '++ IXGQUERY ARG PARMS'                     00277700
.*                                                                      00277800
.ZLMFSLX              ANOP  ,                                           00277900
.*-------------------------------------------------------------------   00278000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00278100
&ZPLLEN               SETA 40                                           00278200
.*                                                                      00278300
                      AIF  (&XPLISTVER LT 2).ZLLEN2Z                    00278400
&ZPLLEN               SETA 48                                           00278500
.ZLLEN2Z              ANOP  ,                                           00278600
.*                                                                      00278700
.******************************************************************     00278800
.***AI.L01 IXGQUERY FMT=LIST FILL IN PARAMETER AREA                     00278900
.******************************************************************     00279000
                      ACTR  10000                                       00279100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00279200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00279300
&ZCVAL                SETC  'LAE'          XAX MODE                     00279400
.ZIMFXA               ANOP ,                                            00279500
.*                                                                      00279600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00279700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00279800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00279900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00280000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00280100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00280200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00280300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00280400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00280500
&ZOPN                 SETA  &ZOPN+1                                     00280600
&ZOPL(&ZOPN)          SETC  ' '                                         00280700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00280800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00280900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00281000
                      AGO   .ZIMFNX                                     00281100
.*                                                                      00281200
.ZIMFN2               ANOP ,                                            00281300
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00281400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00281500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00281600
&ZOPN                 SETA  &ZOPN+1                                     00281700
&ZOPL(&ZOPN)          SETC  ' '                                         00281800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00281900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00282000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00282100
                      AGO   .ZIMFNX                                     00282200
.ZIMFNX1              ANOP ,                                            00282300
&ZOPN                 SETA  &ZOPN+1                                     00282400
&ZOPL(&ZOPN)          SETC  ' '                                         00282500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00282600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00282700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00282800
.ZIMFNX               ANOP ,                                            00282900
.********************************************************************   00283000
.***AI.L02 IXGQUERY FMT=LIST INITIALIZE PARAMETER AREA                  00283100
.********************************************************************   00283200
.***AI.L03 MF=(SLME)                                                    00283300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00283400
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00283500
.*                                                                      00283600
&ZOPN                 SETA  &ZOPN+1                                     00283700
&ZOPL(&ZOPN)          SETC  ' '                                         00283800
&ZOPO(&ZOPN)          SETC  'XC'                                        00283900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00284000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00284100
.ZIMFLX               ANOP  ,                                           00284200
.*-------------------------------------------------------------------   00284300
.***AI.L04B XVERSION XL1                                                00284400
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00284500
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVY            00284600
.ZIMFVX               ANOP  ,                                           00284700
                      AIF   ('&PLISTVER' EQ '').ZIMFVZ                  00284800
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVZ            00284900
.ZIMFVY               ANOP  ,                                           00285000
&ZOPN                 SETA  &ZOPN+1                                     00285100
&ZOPL(&ZOPN)          SETC  ' '                                         00285200
&ZOPO(&ZOPN)          SETC  'MVI'                                       00285300
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00285400
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00285500
.ZIMFVZ               ANOP  ,                                           00285600
.*-------------------------------------------------------------------   00285700
.***AI.L05 XIXGFLAGS BL1                                                00285800
&ZW                   SETC  ''                                          00285900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00286000
&ZMS                  SETC  ''                                          00286100
&ZC                   SETC  ''                                          00286200
.*-------------------------------------------------------------------   00286300
.***AI.L08 XIXGFLAGS "YES"                                              00286400
.***      BL1'1XXXXXXX'                                                 00286500
         AIF   ('&XCHECKCONNSTATUS' NE 'YES').ZI3A                      00286600
&ZW                   SETC  '&ZW.1'                                     00286700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00286800
&ZMS                  SETC  '&ZMS.1'                                    00286900
                      AGO   .ZI3C                                       00287000
.*                                                                      00287100
.ZI3A                 ANOP  ,                                           00287200
&ZW                   SETC  '&ZW.0'                                     00287300
         AIF   ('&ZXCHECKCONNSTATUS' EQ '').ZI3B                        00287400
&ZMS                  SETC  '&ZMS.0'                                    00287500
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00287600
                      AGO   .ZI3C                                       00287700
.*                                                                      00287800
.ZI3B                 ANOP  ,                                           00287900
&ZMS                  SETC  '&ZMS.1'                                    00288000
.ZI3C                 ANOP  ,                                           00288100
.*-------------------------------------------------------------------   00288200
.***AI.L08 XIXGFLAGS "REQUEST"                                          00288300
.***      BL1'X1XXXXXX'                                                 00288400
         AIF   ('&REQUEST' EQ '').ZI4A                                  00288500
&ZW                   SETC  '&ZW.1'                                     00288600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00288700
&ZMS                  SETC  '&ZMS.0'                                    00288800
                      AGO   .ZI4C                                       00288900
.*                                                                      00289000
.ZI4A                 ANOP  ,                                           00289100
&ZW                   SETC  '&ZW.0'                                     00289200
&ZMS                  SETC  '&ZMS.1'                                    00289300
.ZI4C                 ANOP  ,                                           00289400
.*-------------------------------------------------------------------   00289500
.***AI.L08 XIXGFLAGS "ZAILOCINFO"                                       00289600
.***      BL1'XX1XXXXX'                                                 00289700
         AIF   ('&XREQUEST' NE 'ZAILOCINFO').ZI5A                       00289800
&ZW                   SETC  '&ZW.100000'                                00289900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00290000
&ZMS                  SETC  '&ZMS.111111'                               00290100
                      AGO   .ZI5C                                       00290200
.*                                                                      00290300
.ZI5A                 ANOP  ,                                           00290400
&ZW                   SETC  '&ZW.000000'                                00290500
         AIF   ('&ZXREQUEST' EQ '').ZI5B                                00290600
&ZMS                  SETC  '&ZMS.011111'                               00290700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00290800
                      AGO   .ZI5C                                       00290900
.*                                                                      00291000
.ZI5B                 ANOP  ,                                           00291100
&ZMS                  SETC  '&ZMS.111111'                               00291200
.ZI5C                 ANOP  ,                                           00291300
.*-------------------------------------------------------------------   00291400
.***AI.L11 XIXGFLAGS BL1                                                00291500
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI5D               00291600
                      AIF   ('&ZC' NE 'YES').ZI5D                       00291700
&ZOPN                 SETA  &ZOPN+1                                     00291800
&ZOPL(&ZOPN)          SETC  ' '                                         00291900
&ZOPO(&ZOPN)          SETC  'NI'                                        00292000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            00292100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00292200
.ZI5D                 ANOP  ,                                           00292300
                      AIF   ('&ZCLNG' NE 'YES').ZI5E  ALL ZERO BITS     00292400
&ZOPN                 SETA  &ZOPN+1                                     00292500
&ZOPL(&ZOPN)          SETC  ' '                                         00292600
&ZOPO(&ZOPN)          SETC  'OI'                                        00292700
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00292800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00292900
.ZI5E                 ANOP  ,                                           00293000
.*-------------------------------------------------------------------   00293100
.***AI.L19 ADDR XBUFFER A                                               00293200
                      AIF   ('&ZXBUFFER' EQ '').ZI8H                    00293300
&ZCLNG                SETC  '&XBUFFER'                                  00293400
&ZCGPR                SETC  '14'                                        00293500
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI8F  IN GPR                    00293600
.*                                                                      00293700
&ZOPN                 SETA  &ZOPN+1                                     00293800
&ZOPL(&ZOPN)          SETC  ' '                                         00293900
&ZOPO(&ZOPN)          SETC  'LA'                                        00294000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00294100
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00294200
.*                                                                      00294300
                      AGO   .ZI8G                                       00294400
.*                                                                      00294500
.ZI8F                 ANOP  ,                                           00294600
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00294700
.*                                                                      00294800
.ZI8G                 ANOP  ,                                           00294900
.*                                                                      00295000
&ZOPN                 SETA  &ZOPN+1                                     00295100
&ZOPL(&ZOPN)          SETC  ' '                                         00295200
&ZOPO(&ZOPN)          SETC  'ST'                                        00295300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00295400
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00295500
.*                                                                      00295600
.ZI8H                 ANOP  ,                                           00295700
.*-------------------------------------------------------------------   00295800
.***AI.L25  XBUFFLEN F                                                  00295900
                      AIF   ('&ZXBUFFLEN' EQ '').ZI9E                   00296000
                      AIF   ('&ZXBUFFLEN' EQ 'OUTPUT').ZI9E             00296100
&ZCGPR                SETC  '&XBUFFLEN'                                 00296200
.*                                                                      00296300
                      AIF   ('&XBUFFLEN'(1,1) NE '(').ZI9B              00296400
&ZCGPR   SETC  '0('.'&XBUFFLEN'(2,K'&XBUFFLEN-2).')'                    00296500
                      AGO   .ZI9D                                       00296600
.ZI9B                 ANOP  ,                                           00296700
.*                                                                      00296800
&ZC                   SETC  '&XBUFFLEN'(1,1)                            00296900
                      AIF   (T'&ZC NE 'N').ZI9D                         00297000
&ZC                   SETC  '&XBUFFLEN'                                 00297100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00297200
&ZCGPR                SETC  '=AL4(&XBUFFLEN)'                           00297300
.*                                                                      00297400
.ZI9D                 ANOP  ,                                           00297500
.*                                                                      00297600
&ZOPN                 SETA  &ZOPN+1                                     00297700
&ZOPL(&ZOPN)          SETC  ' '                                         00297800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00297900
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00298000
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFLEN XBUFFLEN'                    00298100
.*                                                                      00298200
.ZI9E                 ANOP  ,                                           00298300
.*-------------------------------------------------------------------   00298400
.***AI.L19  XANSAREA A                                                  00298500
                      AIF   ('&ZXANSAREA' EQ '').ZI10H                  00298600
&ZCLNG                SETC  '&XANSAREA'                                 00298700
&ZCGPR                SETC  '14'                                        00298800
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI10F  IN GPR                  00298900
.*                                                                      00299000
&ZOPN                 SETA  &ZOPN+1                                     00299100
&ZOPL(&ZOPN)          SETC  ' '                                         00299200
&ZOPO(&ZOPN)          SETC  'LA'                                        00299300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00299400
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00299500
.*                                                                      00299600
                      AGO   .ZI10G                                      00299700
.*                                                                      00299800
.ZI10F                ANOP  ,                                           00299900
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00300000
.*                                                                      00300100
.ZI10G                ANOP  ,                                           00300200
.*                                                                      00300300
&ZOPN                 SETA  &ZOPN+1                                     00300400
&ZOPL(&ZOPN)          SETC  ' '                                         00300500
&ZOPO(&ZOPN)          SETC  'ST'                                        00300600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00300700
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00300800
.*                                                                      00300900
.ZI10H                ANOP  ,                                           00301000
.*-------------------------------------------------------------------   00301100
.***AI.L25  XANSLEN F                                                   00301200
                      AIF   ('&ZXANSLEN' EQ '').ZI11E                   00301300
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI11E             00301400
&ZCGPR                SETC  '&XANSLEN'                                  00301500
.*                                                                      00301600
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI11B              00301700
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00301800
                      AGO   .ZI11D                                      00301900
.ZI11B                ANOP  ,                                           00302000
.*                                                                      00302100
&ZC                   SETC  '&XANSLEN'(1,1)                             00302200
                      AIF   (T'&ZC NE 'N').ZI11D                        00302300
&ZC                   SETC  '&XANSLEN'                                  00302400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00302500
&ZCGPR                SETC  '=AL4(&XANSLEN)'                            00302600
.*                                                                      00302700
.ZI11D                ANOP  ,                                           00302800
.*                                                                      00302900
&ZOPN                 SETA  &ZOPN+1                                     00303000
&ZOPL(&ZOPN)          SETC  ' '                                         00303100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00303200
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00303300
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00303400
.*                                                                      00303500
.ZI11E                ANOP  ,                                           00303600
.*-------------------------------------------------------------------   00303700
.***AI.L25  XSTREAMTOKEN CL16                                           00303800
                      AIF   ('&ZXSTREAMTOKEN' EQ '').ZI12E              00303900
                      AIF   ('&ZXSTREAMTOKEN' EQ 'OUTPUT').ZI12E        00304000
&ZCGPR                SETC  '&XSTREAMTOKEN'                             00304100
.*                                                                      00304200
                      AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZI12B         00304300
&ZCGPR   SETC  '0('.'&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2).')'            00304400
.ZI12B                ANOP  ,                                           00304500
.*                                                                      00304600
&ZOPN                 SETA  &ZOPN+1                                     00304700
&ZOPL(&ZOPN)          SETC  ' '                                         00304800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00304900
&ZOPV(&ZOPN)          SETC  '24(16,1),&ZCGPR'                           00305000
&ZOPD(&ZOPN)          SETC  '++ &ZXSTREAMTOKEN XSTREAMTOKEN'            00305100
.*                                                                      00305200
.ZI12E                ANOP  ,                                           00305300
.*-------------------------------------------------------------------   00305400
.***AI.LVER01                                                           00305500
                      AIF  (&XPLISTVER LT 2).ZI13Z                      00305600
.*-------------------------------------------------------------------   00305700
.***AI.L19 ADDR64 XBUFFER64 AD                                          00305800
                      AIF   ('&ZXBUFFER64' EQ '').ZI13H                 00305900
&ZCLNG                SETC  '&XBUFFER64'                                00306000
&ZCGPR                SETC  '14'                                        00306100
         AIF   ('&XBUFFER64'(1,1) EQ '(').ZI13F  IN GPR                 00306200
.*                                                                      00306300
&ZOPN                 SETA  &ZOPN+1                                     00306400
&ZOPL(&ZOPN)          SETC  ' '                                         00306500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00306600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00306700
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER64 XBUFFER64'                  00306800
.*                                                                      00306900
                      AGO   .ZI13G                                      00307000
.*                                                                      00307100
.ZI13F                ANOP  ,                                           00307200
&ZCGPR   SETC  '&XBUFFER64'(2,K'&XBUFFER64-2)                           00307300
.*                                                                      00307400
.ZI13G                ANOP  ,                                           00307500
                      AIF   ('&SYSAM64' EQ 'YES').ZI13H1A               00307600
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI13C2             00307700
.*                                                                      00307800
&ZOPN                 SETA  &ZOPN+1                                     00307900
&ZOPL(&ZOPN)          SETC  ' '                                         00308000
&ZOPO(&ZOPN)          SETC  'XC'                                        00308100
&ZOPV(&ZOPN)          SETC  '40(4,1),40(1)'                             00308200
.ZI13C2               ANOP  ,                                           00308300
.*                                                                      00308400
&ZOPN                 SETA  &ZOPN+1                                     00308500
&ZOPL(&ZOPN)          SETC  ' '                                         00308600
&ZOPO(&ZOPN)          SETC  'ST'                                        00308700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+40(,1)'                           00308800
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER64 XBUFFER64'                  00308900
.*                                                                      00309000
                      AGO   .ZI13H                                      00309100
.ZI13H1A              ANOP  ,                                           00309200
.*                                                                      00309300
&ZOPN                 SETA  &ZOPN+1                                     00309400
&ZOPL(&ZOPN)          SETC  ' '                                         00309500
&ZOPO(&ZOPN)          SETC  'STG'                                       00309600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,40(,1)'                             00309700
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER64 XBUFFER64'                  00309800
.*                                                                      00309900
.ZI13H                ANOP  ,                                           00310000
.*-------------------------------------------------------------------   00310100
.***AI.LVER02                                                           00310200
.ZI13Z                ANOP  ,                                           00310300
.*-------------------------------------------------------------------   00310400
.***AI.C01 RESTORE ADDR OF PARM LIST PTR                                00310500
.*                                                                      00310600
&ZOPN                 SETA  &ZOPN+1                                     00310700
&ZOPL(&ZOPN)          SETC  ' '                                         00310800
&ZOPO(&ZOPN)          SETC  'ST'                                        00310900
&ZOPV(&ZOPN)          SETC  '1,4(,1)'                                   00311000
&ZOPD(&ZOPN)          SETC  '++ STORE ADDR OF PARM LIST'                00311100
.*                                                                      00311200
&ZOPN                 SETA  &ZOPN+1                                     00311300
&ZOPL(&ZOPN)          SETC  ' '                                         00311400
&ZOPO(&ZOPN)          SETC  'LA'                                        00311500
&ZOPV(&ZOPN)          SETC  '1,4(,1)'                                   00311600
&ZOPD(&ZOPN)          SETC  '++ LOAD ADDR OF PARM LIST PTR INTO R1'     00311700
.*-------------------------------------------------------------------   00311800
&ZOPN1                SETA &ZOPN                                        00311900
.*-------------------------------------------------------------------   00312000
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00312100
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00312200
.*******************************************************************    00312300
.***  PROCESS IXGQUERY OUTPUT PARAMETERS                                00312400
.*******************************************************************    00312500
                      ACTR  10000                                       00312600
.*******************************************************************    00312700
.***AO.X02  RETURN CODE PROCESSING                                      00312800
.*******************************************************************    00312900
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00313000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00313100
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00313200
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00313300
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00313400
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00313500
&ZOPN                 SETA  &ZOPN+1                                     00313600
&ZOPL(&ZOPN)          SETC  ' '                                         00313700
&ZOPO(&ZOPN)          SETC  'ST'                                        00313800
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00313900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00314000
                      AGO   .ZMRETX                                     00314100
.*                                                                      00314200
.ZMRET2               ANOP  ,                                           00314300
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00314400
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00314500
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00314600
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00314700
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00314800
&ZOPN                 SETA  &ZOPN+1                                     00314900
&ZOPL(&ZOPN)          SETC  ' '                                         00315000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00315100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00315200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00315300
.ZMRETX               ANOP  ,                                           00315400
.*******************************************************************    00315500
.***AO.X03  REASON CODE PROCESSING                                      00315600
.*******************************************************************    00315700
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00315800
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00315900
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00316000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00316100
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00316200
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00316300
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00316400
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00316500
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00316600
&ZOPN                 SETA  &ZOPN+1                                     00316700
&ZOPL(&ZOPN)          SETC  ' '                                         00316800
&ZOPO(&ZOPN)          SETC  'ST'                                        00316900
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00317000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00317100
                      AGO   .ZMRSNX                                     00317200
.*                                                                      00317300
.ZMRSN2               ANOP  ,                                           00317400
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00317500
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00317600
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00317700
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00317800
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00317900
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00318000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00318100
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00318200
&ZOPN                 SETA  &ZOPN+1                                     00318300
&ZOPL(&ZOPN)          SETC  ' '                                         00318400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00318500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00318600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00318700
.ZMRSNX               ANOP  ,                                           00318800
.*******************************************************************    00318900
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00319000
.*******************************************************************    00319100
.ZMFLX                ANOP  ,              MF=L PROCESSING              00319200
.*******************************************************************    00319300
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00319400
.*******************************************************************    00319500
                      ACTR  10000                                       00319600
.*                                                                      00319700
                      LCLA  &ZLC           COLUMN POSITION              00319800
                      LCLA  &ZOPX          LIST TABLE INDEX             00319900
                      LCLC  &ZLL           LABEL                        00320000
                      LCLC  &ZLOP          OPERATION                    00320100
                      LCLC  &ZLV           VALUE                        00320200
                      LCLC  &ZLD           DESCRIPTION                  00320300
.*                                                                      00320400
&ZOPX                 SETA  1                                           00320500
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00320600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00320700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00320800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00320900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00321000
                      AIF   (K'&ZLD LE 0).ZL5                           00321100
&ZLC                  SETA  35             COMMENT COLUMN               00321200
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00321300
&ZLC                  SETA  33             COMMMENT COLUMN              00321400
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00321500
&ZLV                  SETC  '&ZLV'.' '                                  00321600
                      AGO   .ZL3                                        00321700
.*                                                                      00321800
.ZL4                  ANOP  ,                                           00321900
&ZLV                  SETC  '&ZLV'.' '                                  00322000
.ZL5                  ANOP  ,                                           00322100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00322200
.*                                                                      00322300
&ZLL     &ZLOP &ZLV                                                     00322400
.*                                                                      00322500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00322600
                      AGO   .ZL2           CONTINUE LOOPING             00322700
.*                                                                      00322800
.ZLX                  ANOP  ,                                           00322900
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00323000
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00323100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00323200
         AIF   ('&SYSASCE' EQ 'P').QUPRIM  SYSSTATE PRIMARY             00323300
         SLR   15,15                SET GPR 15 TO ZERO                  00323400
         SAR   15,15                ENSURE AR 15 IS ZERO FOR PRIMARY    00323500
.QUPRIM  ANOP                                                           00323600
         AIF   ('&SYSAM64' EQ 'YES').QUA64                              00323700
         L     15,16(0,0)           GET CVT ADDRESS                     00323800
         AGO   .QUCONT                                                  00323900
.QUA64   LLGT  15,16(0,0)           GET CVT Address                     00324000
.QUCONT  L     15,140(15,0)         GET ECVT ADDRESS                    00324100
         L     15,288(15,0)         GET LSAB ADDRESS                    00324200
         L     15,124(15,0)         GET ENTRY POINT ADDRESS             00324300
         LA    0,12                 EX OF QUERY SERVICE                 00324400
         BALR  14,15                INVOKE SERVICE ROUTINE              00324500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00324600
.ZLINKX               ANOP  ,                                           00324700
.*******************************************************************    00324800
.***AP.X01  FORMAT GENERATED CODE                                       00324900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00325000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00325100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00325200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00325300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00325400
                      AIF   (K'&ZLD LE 0).ZL51                          00325500
&ZLC                  SETA  35             COMMENT COLUMN               00325600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00325700
&ZLC                  SETA  33             COMMENT COLUMN               00325800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00325900
&ZLV                  SETC  '&ZLV'.' '                                  00326000
                      AGO   .ZL31                                       00326100
.*                                                                      00326200
.ZL41                 ANOP  ,                                           00326300
&ZLV                  SETC  '&ZLV'.' '                                  00326400
.ZL51                 ANOP  ,                                           00326500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00326600
.*                                                                      00326700
&ZLL     &ZLOP &ZLV                                                     00326800
.*                                                                      00326900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00327000
                      AGO   .ZL21          CONTINUE LOOPING             00327100
.*                                                                      00327200
.ZLX1                 ANOP  ,                                           00327300
.*******************************************************************    00327400
.***AP.X02  END OF IXGQUERY MACRO                                       00327500
&ZIXGQUERY            SETC  'YES'          SET IXGQUERY USED            00327600
         POP   PRINT                                                    00327700
*                                            IXGQUERY-2                 00327800
         SPACE 1                                                        00327900
.ZLX2                 ANOP  ,                                           00328000
         MEND                                                           00328100
**********************************************************************/ 00328200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00328300
*%IXGQUERY: MACRO KEYS(REQUEST,STREAMTOKEN,CHECKCONNSTATUS,BUFFER,      00328400
*                 BUFFLEN,BUFFER64,ANSAREA,ANSLEN,RETCODE,RSNCODE,      00328500
*                 PLISTVER,MF);                                         00328600
*  ANS('?'!!MACLABEL!!' '!!'IXGQUERP '!!MACLIST!!                       00328700
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00328800
*%END IXGQUERY;                                                         00328900

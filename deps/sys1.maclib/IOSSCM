*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IOSSCM                                -01/14/15-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  IOS Storage Class Memory Service              * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2015                               * 00001200
*                                                                     * 00001300
* STATUS= HBB77A0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      IOSSCM is used to retrieve Storage Class Memory (SCM) related  * 00002100
*      information such as the number of SCM resources and            * 00002200
*      performance statistics.                                        * 00002300
*                                                                     * 00002400
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00002500
*                                                                     * 00002600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002700
*                                                                     * 00002800
*01* ENVIRONMENT:                                                     * 00002900
*                                                                     * 00003000
*                                                                     * 00003100
*      Dispatchable unit mode: Task or SRB mode.                      * 00003200
*                                                                     * 00003300
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00003400
*                        key.                                         * 00003500
*                                                                     * 00003600
*                        For LINKAGE=BRANCH the caller must be in     * 00003700
*                        Supervisor State, Key 0                      * 00003800
*                                                                     * 00003900
*      AMODE:            31- or 64-bit.                               * 00004000
*                                                                     * 00004100
*      ASC mode:         Primary.                                     * 00004200
*                                                                     * 00004300
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00004400
*                                                                     * 00004500
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004600
*                                                                     * 00004700
*      Locks:            No locks held.                               * 00004800
*                                                                     * 00004900
*      Control parameters: Control parameters must be in the primary  * 00005000
*                        address space.                               * 00005100
*                                                                     * 00005200
*                        For LINKAGE=SYSTEM the parameter list may    * 00005300
*                        not be in high virtual storage (above 2Gig). * 00005400
*                                                                     * 00005500
*                        For LINKAGE=BRANCH the parameter list and    * 00005600
*                        the data areas pointed to by the parameter   * 00005700
*                        list must reside in fixed or DREF storage.   * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*01* RESTRICTIONS:                                                    * 00006200
*                                                                     * 00006300
*    The LINKAGE=BRANCH option is limited to callers which meet the   * 00006400
*    following criteria:                                              * 00006500
*                                                                     * 00006600
*                                                                     * 00006700
*    o   Supervisor state, Key 0                                      * 00006800
*                                                                     * 00006900
*    o   The parameter list (including any data areas pointed to by   * 00007000
*        the parameter list) resides in fixed or DREF storage         * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*                                                                     * 00007400
*01* PROGRAMMING REQUIREMENTS:                                        * 00007500
*                                                                     * 00007600
*    None                                                             * 00007700
*                                                                     * 00007800
*01* PERFORMANCE IMPLICATIONS:                                        * 00007900
*                                                                     * 00008000
*    None.                                                            * 00008100
*                                                                     * 00008200
*01* MACRO USAGE NOTES:                                               * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00008600
*        global macro variable.  Any value other than 'NO' will       * 00008700
*        result in the macro expansion being printed.  The default is * 00008800
*        'YES'.  The following examples illustrate how the ZPRINT     * 00008900
*        variable should be set.                                      * 00009000
*                                                                     * 00009100
*                    GBLC &ZPRINT                                     * 00009200
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*    2.  All  keys currently contained in the IOSSCM macro correspond * 00009600
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00009700
*        MAX.                                                         * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*01* INPUT REGISTER INFORMATION:                                      * 00010300
*                                                                     * 00010400
*    Before  issuing the IOSSCM macro with LINKAGE=BRANCH, the caller * 00010500
*    must  ensure  that  general  purpose  register  13  contains the * 00010600
*    address  of  a  216  byte  save area.   The save area must be in * 00010700
*    primary storage in the first 2G of storage.  The caller does not * 00010800
*    have  to  place  any  information into any other general purpose * 00010900
*    register  (GPR)  unless  using  it  as  register  notation for a * 00011000
*    particular parameter, or using it as a base register.            * 00011100
*                                                                     * 00011200
*    Before  issuing the IOSSCM macro with LINKAGE=SYSTEM, the caller * 00011300
*    does  not have to place any information into any general purpose * 00011400
*    register  (GPR)  unless  using  it  as  register  notation for a * 00011500
*    particular parameter, or using it as a base register.            * 00011600
*                                                                     * 00011700
*01* OUTPUT REGISTER INFORMATION:                                     * 00011800
*                                                                     * 00011900
*    The  contents  of  registers  14  through  1  are altered during * 00012000
*    processing.                                                      * 00012100
*                                                                     * 00012200
*    When control returns to the caller, the GPRs contain:            * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*    REGISTER  CONTENTS                                               * 00012600
*                                                                     * 00012700
*    0         Reason Code                                            * 00012800
*                                                                     * 00012900
*    1         Unpredictable (Used as a work register by the system)  * 00013000
*                                                                     * 00013100
*    2-13      Unchanged                                              * 00013200
*                                                                     * 00013300
*    14        Unpredictable (Used as a work register by the system)  * 00013400
*                                                                     * 00013500
*    15        Return Code                                            * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*01* SYNTAX:                                                          * 00014000
*                                                                     * 00014100
*Ýxlabel¨  IOSSCM  Ð  CONFIGINFO                                      * 00014200
*                  !     ,INFOAREA=xinfoarea                          * 00014300
*                  !     ,INFOAREALEN=xinfoarealen                    * 00014400
*                  !    Ý,OUTVERSION=»xoutversion!0º¨                 * 00014500
*                  ¿ ,DEVINFO                                         * 00014600
*                        ,INFOAREA=xinfoarea                          * 00014700
*                        ,INFOAREALEN=xinfoarealen                    * 00014800
*                       Ý,OUTVERSION=»xoutversion!0º¨                 * 00014900
*                   Ý,LINKAGE=»SYSTEM!BRANCHº¨                        * 00015000
*                   Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨           * 00015100
*                  ÐÝ,MF=S¨                                           * 00015200
*                  ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                    * 00015300
*                  ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                      * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*      Where:                                                         * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*      Ýxlabel¨                                                       * 00016000
*          is an optional symbol, starting in column 1, that is the   * 00016100
*          name on the IOSSCM macro invocation.  The name must        * 00016200
*          conform to the rules for an ordinary assembler language    * 00016300
*          symbol.                                                    * 00016400
*          DEFAULT: No name.                                          * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*      The following is a set of mutually exclusive keys.  This set   * 00017000
*      is required; only one key must be specified.                   * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*      CONFIGINFO                                                     * 00017400
*          Requests that Storage Class Memory configuration           * 00017500
*          information be returned.  SCM configuration information    * 00017600
*          includes, for example, the number of SCM resource parts    * 00017700
*          and the size of an SCM measurement block.                  * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*          INFOAREA=xinfoarea                                         * 00018100
*              is the name (RS-type), or address in register          * 00018200
*              (2)-(12), of a required 8 byte input that contains the * 00018300
*              address of an area which is to receive the             * 00018400
*              configuration information.  The area must be           * 00018500
*              addressable in the primary address space.  The         * 00018600
*              INFOAREA data returned is mapped by macro IOSDSCCI.    * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*          INFOAREALEN=xinfoarealen                                   * 00019200
*              is the name (RS-type), or address in register          * 00019300
*              (2)-(12), of a required fullword input/output that     * 00019400
*              contains the length of the configuration information   * 00019500
*              area.  If the information area is not large enough to  * 00019600
*              contain all of the data for the output version         * 00019700
*              requested, the service will return a program error and * 00019800
*              this field will be updated with the length required.   * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*          ÝOUTVERSION=»xoutversion!0º¨                               * 00020400
*              is the name (RS-type), or address in register          * 00020500
*              (2)-(12), of an optional byte input that specifies the * 00020600
*              version of the output information to be returned.  The * 00020700
*              output version controls the size and format of the     * 00020800
*              information returned.  If the output version requested * 00020900
*              is higher than the highest supported version, the      * 00021000
*              highest supported version will be used and a warning   * 00021100
*              code will be returned.  The output SCCI infoarea       * 00021200
*              contains the version of the information returned.      * 00021300
*              DEFAULT: 0                                             * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*      DEVINFO                                                        * 00021800
*          Requests that Storage Class Memory device (subchannel)     * 00021900
*          information be returned.  SCM device information includes  * 00022000
*          I/O statistics for requests that were issued to each SCM   * 00022100
*          device.  Note, the SCM device or subchannel is not         * 00022200
*          associated with a specific Flash Express adapter card      * 00022300
*          pair; any SCM device can be used to do I/O to any adapter  * 00022400
*          card pair.                                                 * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*          INFOAREA=xinfoarea                                         * 00022800
*              is the name (RS-type), or address in register          * 00022900
*              (2)-(12), of a required 8 byte input that contains the * 00023000
*              address of an area which is to receive the SCM device  * 00023100
*              information.  The area must be addressable in the      * 00023200
*              primary address space.  The INFOAREA data returned is  * 00023300
*              mapped by macro IOSDSCDI.                              * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*          INFOAREALEN=xinfoarealen                                   * 00023900
*              is the name (RS-type), or address in register          * 00024000
*              (2)-(12), of a required fullword input/output that     * 00024100
*              contains the length of the SCM device information      * 00024200
*              area.  The area must be large enough to return         * 00024300
*              information for each SCM device/subchannel.  The       * 00024400
*              number of SCM devices/subchannels can be obtained via  * 00024500
*              the IOSSCM CONFIGINFO service.  If the information     * 00024600
*              area is not large enough to contain all of the data    * 00024700
*              for the output version requested, the service will     * 00024800
*              return a program error and this field will be updated  * 00024900
*              with the length required.                              * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*          ÝOUTVERSION=»xoutversion!0º¨                               * 00025500
*              is the name (RS-type), or address in register          * 00025600
*              (2)-(12), of an optional byte input that specifies the * 00025700
*              version of the output information to be returned.  The * 00025800
*              output version controls the size and format of the     * 00025900
*              information returned.  If the output version requested * 00026000
*              is higher than the highest supported version, the      * 00026100
*              highest supported version will be used and a warning   * 00026200
*              code will be returned.  The output SCDI infoarea       * 00026300
*              contains the version of the information returned.      * 00026400
*              DEFAULT: 0                                             * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*      End of a set of mutually exclusive required keys.              * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*      ÝLINKAGE=»SYSTEM!BRANCHº¨                                      * 00027500
*          is an optional keyword input that indicates whether a      * 00027600
*          branch-entry linkage should be generated or a Program Call * 00027700
*          should be issued for the routine invocation.               * 00027800
*          DEFAULT: SYSTEM                                            * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*          LINKAGE=SYSTEM                                             * 00028200
*              requests Program Call invocation.                      * 00028300
*                                                                     * 00028400
*          LINKAGE=BRANCH                                             * 00028500
*              requests branch-entry invocation.  See INVOCATION      * 00028600
*              REQUIREMENTS for the restrictions on branch-entry      * 00028700
*              invocation.                                            * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00029500
*          is an optional byte input decimal value in the "1-1" range * 00029600
*          that specifies the macro version.  PLISTVER is the only    * 00029700
*          key allowed on the list form of MF and determines which    * 00029800
*          parameter list is generated.  Note that MAX may be         * 00029900
*          specified instead of a number, and the parameter list will * 00030000
*          be of the largest size currently supported. This size may  * 00030100
*          grow from release to release (thus possibly affecting the  * 00030200
*          amount of storage needed by your program).  If your        * 00030300
*          program can tolerate this, IBM recommends that you always  * 00030400
*          specify MAX when creating the list form parameter list as  * 00030500
*          that will ensure that the list form parameter list is      * 00030600
*          always long enough to hold whatever parameters might be    * 00030700
*          specified on the execute form.                             * 00030800
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00030900
*          default is the lowest version which allows all of the      * 00031000
*          parameters specified on the invocation to be processed.    * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*      ÝMF=»S!L!Eº¨                                                   * 00031600
*          is an optional keyword input which specifies the macro     * 00031700
*          form.                                                      * 00031800
*          DEFAULT: S                                                 * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*          ÝMF=S¨                                                     * 00032200
*              specifies the standard form of the macro.  The "S"     * 00032300
*              form generates code to put the parameters into an      * 00032400
*              in-line parameter list and invoke the desired service. * 00032500
*              Full checking for required macro keys is done along    * 00032600
*              with supplying defaults for omitted optional           * 00032700
*              parameters.                                            * 00032800
*                                                                     * 00032900
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00033000
*              specifies the list form of the macro.  The "L" form    * 00033100
*              defines an area to be used for the parameter list.     * 00033200
*              Only the PLISTVER key may be specified on the          * 00033300
*              invocation.  All other macro parameters are flagged as * 00033400
*              errors.  If PLISTVER is not specified, the original    * 00033500
*              parameter list definition is used.                     * 00033600
*                                                                     * 00033700
*            ,xmfctrl                                                 * 00033800
*              is a required input.  It is the name of a storage area * 00033900
*              for the parameter list.                                * 00034000
*                                                                     * 00034100
*            »,xmfattr!0Dº                                            * 00034200
*              is an optional 60 character input string that varies   * 00034300
*              from 1 to 60 characters. Use it to force boundary      * 00034400
*              alignment of the parameter list. Use only 0F or 0D.    * 00034500
*              DEFAULT: 0D which forces the parameter list to a       * 00034600
*              doubleword boundary.                                   * 00034700
*                                                                     * 00034800
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00034900
*              specifies the execute form of the macro.  The "E" form * 00035000
*              generates code to put the parameters into the          * 00035100
*              parameter list specified by xmfctrl and provides full  * 00035200
*              syntax checking with default setting.                  * 00035300
*                                                                     * 00035400
*            ,xmfctrl                                                 * 00035500
*              is a required input.  It is the name (RS-type), or     * 00035600
*              address in register (1)-(12), of a storage area for    * 00035700
*              the parameter list.                                    * 00035800
*                                                                     * 00035900
*            »,COMPLETEº                                              * 00036000
*              is an optional keyword input which specifies the       * 00036100
*              degree of macro parameter syntax checking.             * 00036200
*              DEFAULT: COMPLETE                                      * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*              COMPLETE                                               * 00036600
*                  Checking for required macro keys is done and       * 00036700
*                  defaults are supplied for omitted optional         * 00036800
*                  parameters.                                        * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*                                                                     * 00037600
*01* RETURN CODES:                                                    * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*       X'00'     Meaning: IOSSCM completed successfully.             * 00038100
*                                                                     * 00038200
*                 Action: None                                        * 00038300
*                                                                     * 00038400
*       X'04'     Meaning: Warning                                    * 00038500
*                                                                     * 00038600
*                 Action: See actions for each reason                 * 00038700
*                                                                     * 00038800
*                 Reason codes                                        * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                 X'01'     Meaning: The requested output version     * 00039200
*                           (OUTVERSION) is not supported.  The       * 00039300
*                           information area was updated based on the * 00039400
*                           highest supported version.                * 00039500
*                                                                     * 00039600
*                           Action: Examine the returned output       * 00039700
*                           version field to determine the format and * 00039800
*                           content of the data that was returned.    * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*       X'08'     Meaning: Program error                              * 00040300
*                                                                     * 00040400
*                 Action: None                                        * 00040500
*                                                                     * 00040600
*                 Reason codes                                        * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                 X'01'     Meaning: The system could not reference   * 00041000
*                           or update the INFOAREA provided by the    * 00041100
*                           caller.                                   * 00041200
*                                                                     * 00041300
*                           Action: Correct the IOSSCM invocation to  * 00041400
*                           pass an information area to which the     * 00041500
*                           caller has write access.                  * 00041600
*                                                                     * 00041700
*                 X'02'     Meaning: The system could not access the  * 00041800
*                           passed parameter list.                    * 00041900
*                                                                     * 00042000
*                           Action: Correct the IOSSCM invocation to  * 00042100
*                           pass a parameter list to which the caller * 00042200
*                           has access.                               * 00042300
*                                                                     * 00042400
*                 X'03'     Meaning: The output area specified by the * 00042500
*                           caller via the INFOAREA and INFOAREALEN   * 00042600
*                           keywords is not large enough to contain   * 00042700
*                           the requested information.  The           * 00042800
*                           INFOAREALEN parameter has been updated    * 00042900
*                           with the required storage length.         * 00043000
*                                                                     * 00043100
*                           Action: Obtain a storage area to be used  * 00043200
*                           for the output information using the      * 00043300
*                           INFOAREALEN value returned by the         * 00043400
*                           service.  Reissue the IOSSCM service.     * 00043500
*                                                                     * 00043600
*                                                                     * 00043700
*                                                                     * 00043800
*       X'0C'     Meaning: Environmental Error                        * 00043900
*                                                                     * 00044000
*                 Action: None                                        * 00044100
*                                                                     * 00044200
*                 Reason codes                                        * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*                 X'01'     Meaning: Storage Class Memory is not      * 00044600
*                           supported by the processor.               * 00044700
*                                                                     * 00044800
*                           Action: None                              * 00044900
*                                                                     * 00045000
*                 X'02'     Meaning: IOSSCM service is not available  * 00045100
*                                                                     * 00045200
*                           Action: None                              * 00045300
*                                                                     * 00045400
*                 X'03'     Meaning: IOSSCM detected that the caller  * 00045500
*                           is not in Primary ASC mode.               * 00045600
*                           (LINKAGE=SYSTEM)                          * 00045700
*                                                                     * 00045800
*                           Action: None                              * 00045900
*                                                                     * 00046000
*                 X'04'     Meaning: IOSSCM detected that the caller  * 00046100
*                           is not enabled for I/O interrupts.        * 00046200
*                           (LINKAGE=SYSTEM)                          * 00046300
*                                                                     * 00046400
*                           Action: None                              * 00046500
*                                                                     * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*       X'20'     Meaning: System error                               * 00046900
*                                                                     * 00047000
*                 Action: None                                        * 00047100
*                                                                     * 00047200
*                                                                     * 00047300
*                                                                     * 00047400
*01* REASON CODES:                                                    * 00047500
*         Refer to the return codes section.                          * 00047600
*                                                                     * 00047700
*01* MODULE TYPE:  ASSEM MACRO                                        * 00047800
*                                                                     * 00047900
*02*   PROCESSOR:  ASSEM                                              * 00048000
*                                                                     * 00048100
*01* COMPONENT:  SC1C3                                                * 00048200
*                                                                     * 00048300
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00048400
*                                                                     * 00048500
*01* CHANGE ACTIVITY:                                                 * 00048600
*                                                                     * 00048700
*   Flag LineItem  FMID    Date   ID    Comment                       * 00048800
*                                                                     * 00048900
*    $L0=IOSSCM2  HBB77A0 141231 PDB7:  z/OS SCM Service              * 00049000
****** END OF SPECIFICATIONS *****************************************/ 00049100
*/********************************************************************* 00049200
         MACRO                                                          00049300
&XLABEL  IOSSCM &INFOAREA=,&INFOAREALEN=,&OUTVERSION=,&LINKAGE=,       *00049400
               &PLISTVER=,&MF=                                          00049500
.*                                                                      00049600
*                 MACDATE -01/14/15-<1>                                 00049700
.*                                                                      00049800
.*******************************************************************    00049900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00050000
.*******************************************************************    00050100
                 GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                00050200
                 GBLC  &ZTEST      YES=TEST NO=NO TEST                  00050300
                 GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX          00050400
.*                                                                      00050500
                 GBLC  &ZIOSSCM    YES=MACRO USED AT LEAST ONCE         00050600
.*******************************************************************    00050700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00050800
.*******************************************************************    00050900
                 LCLC  &ZMS        ERROR MESSAGE WORK AREA              00051000
                 LCLC  &ZCNDX      SYSNDX CHARACTERS                    00051100
                 LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED           00051200
                 LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR          00051300
                 LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE          00051400
                 LCLA  &ZAWRK      USED AS A WORK AREA                  00051500
                 LCLA  &ZASIZ      USED FOR SIZE OF VALUE               00051600
                 LCLA  &ZN         NUMERIC WORK VARIABLE                00051700
                 LCLC  &ZC         CHARACTER WORK VARIABLE              00051800
                 LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE          00051900
                 LCLA  &ZTLA       VALUE TOO LONG VARIABLE              00052000
                 LCLC  &ZMAC_G     "G" or null                          00052100
&ZMAC_G          SETC  ''                                               00052200
                 LCLC  &ZMAC_LR                                         00052300
&ZMAC_LR         SETC  'LR'                                             00052400
                 LCLC  &ZMAC_L                                          00052500
&ZMAC_L          SETC  'L'                                              00052600
                 LCLC  &ZMAC_ST                                         00052700
&ZMAC_ST         SETC  'ST'                                             00052800
                 LCLC  &ZMAC_LLGT                                       00052900
&ZMAC_LLGT       SETC  'L'                                              00053000
                 LCLC  &ZMAC_LGR                                        00053100
&ZMAC_LGR        SETC  'LR'                                             00053200
                 LCLC  &ZMAC_LG                                         00053300
&ZMAC_LG         SETC  'L'                                              00053400
                 LCLC  &ZMAC_STG                                        00053500
&ZMAC_STG        SETC  'ST'                                             00053600
                 LCLA  &ZMACRET    MACRO RETURN CODE                    00053700
&ZMACRET         SETA  0           ASSUME NO ERRORS                     00053800
.*                                                                      00053900
                 LCLC  &ZCSYSLIST(255)          NONXKEY, POS ARRAY      00054000
                 LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()           00054100
                 LCLA  &ZPLLEN     PARAMETER LIST LENGTH                00054200
                 LCLC  &ZENDBASEPL              End of base PL          00054300
                 LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                00054400
.*******************************************************************    00054500
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00054600
.*******************************************************************    00054700
                 LCLA  &ZI         INDEX FOR ARRAY                      00054800
                 LCLA  &ZJ         INDEX FOR PARMS                      00054900
                 LCLA  &ZK         INDEX FOR PARSE                      00055000
                 LCLA  &ZLO        LOW RANGE VALUE                      00055100
                 LCLA  &ZHI        HIGH RANGE VALUE                     00055200
                 LCLC  &ZW         WORK AREA FOR PARM                   00055300
.********************************************************************   00055400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00055500
.********************************************************************   00055600
                 GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL              00055700
                 GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE       00055800
                 GBLA  &SYSALVL    SYSSTATE ARCHLVL                     00055900
                 GBLC  &SYSAM64    SYSSTATE AMODE64                     00056000
.*                                                                      00056100
                 AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED       00056200
                 AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED        00056300
                 SPLEVEL  TEST                                          00056400
.ZSYS2           ANOP  ,                                                00056500
                 AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1            00056600
                 AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1            00056700
                 SYSSTATE TEST                                          00056800
                 AGO   .ZSYS4                                           00056900
.ZSYS3           ANOP  ,                                                00057000
&SYSASCE         SETC  'P'         ASSUME SYSSTATE PRIMARY              00057100
.ZSYS4           ANOP  ,                                                00057200
                 AIF   ('&SYSAM64' NE 'YES').ZSYSN64                    00057300
&ZMAC_LLGT       SETC 'LLGT'                                            00057400
&ZMAC_LGR        SETC 'LGR'                                             00057500
&ZMAC_LG         SETC 'LG'                                              00057600
&ZMAC_STG        SETC 'STG'                                             00057700
.ZSYSN64         ANOP  ,                                                00057800
&ZMAC_G          SETC 'G'                                               00057900
&ZMAC_LR         SETC 'LGR'                                             00058000
&ZMAC_L          SETC 'LG'                                              00058100
&ZMAC_ST         SETC 'STG'                                             00058200
.*******************************************************************    00058300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00058400
.*******************************************************************    00058500
                 LCLC  &XFUNCTION  ++ VALUE                             00058600
                 LCLC  &XCONFIGINFO             ++ VALUE                00058700
                 LCLC  &XINFOAREA  ++ NAME                              00058800
                 LCLC  &XINFOAREALEN            ++ NAME                 00058900
                 LCLC  &XOUTVERSION             ++ NAME                 00059000
                 LCLC  &XDEVINFO   ++ VALUE                             00059100
                 LCLC  &XLINKAGE   ++ VALUE                             00059200
                 LCLA  &XPLISTVER  ++ VALUE                             00059300
                 LCLC  &XMF        ++ VALUE                             00059400
                 LCLC  &XMFCTRL    ++ NAME                              00059500
                 LCLC  &XMFATTR    ++ VALUE                             00059600
                 LCLC  &XMFSCK     ++ VALUE                             00059700
.*******************************************************************    00059800
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00059900
.*******************************************************************    00060000
                 LCLC  &ZXFUNCTION              ++ INPUT VALUE          00060100
                 LCLC  &ZXCONFIGINFO            ++ INPUT VALUE          00060200
                 LCLC  &ZXINFOAREA              ++ INPUT NAME           00060300
                 LCLC  &ZXINFOAREALEN           ++ INOUT NAME           00060400
                 LCLC  &ZXOUTVERSION            ++ INPUT NAME           00060500
                 LCLC  &ZXDEVINFO  ++ INPUT VALUE                       00060600
                 LCLC  &ZXLINKAGE  ++ INPUT VALUE                       00060700
                 LCLC  &ZXPLISTVER              ++ INPUT VALUE          00060800
                 LCLC  &ZXMF       ++ INPUT VALUE                       00060900
                 LCLC  &ZXMFCTRL   ++ INPUT NAME                        00061000
                 LCLC  &ZXMFATTR   ++ INPUT VALUE                       00061100
                 LCLC  &ZXMFSCK    ++ INPUT VALUE                       00061200
.********************************************************************   00061300
.***AC.PLV01  PROCESS PLISTVER                                      *   00061400
.********************************************************************   00061500
&XPLISTVER      SETA  1                                                 00061600
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00061700
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00061800
&XPLISTVER      SETA  1                                                 00061900
.ZPLV0          ANOP  ,                                                 00062000
.*                                                                      00062100
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00062200
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00062300
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00062400
.*-------------------------------------------------------------------   00062500
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00062600
&ZMS            SETC  '"PLISTVER='                                      00062700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00062800
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00062900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00063000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00063100
                AGO   .ZPVCK2                                           00063200
.ZPVCK3         ANOP  ,                                                 00063300
.*-------------------------------------------------------------------   00063400
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00063500
&ZMS            SETC  '"PLISTVER='                                      00063600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00063700
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00063800
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00063900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00064000
                AGO   .ZPVCKE                                           00064100
.ZPVCK2         ANOP  ,                                                 00064200
.*-------------------------------------------------------------------   00064300
&ZCVAL          SETC  '&PLISTVER(1)'                                    00064400
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00064500
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00064600
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00064700
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00064800
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00064900
.ZPVCK6         ANOP  ,                                                 00065000
&ZMS            SETC  '"PLISTVER='                                      00065100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00065200
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00065300
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00065400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00065500
&XPLISTVER      SETA  1                                                 00065600
                AGO   .ZPVCKE                                           00065700
.*-------------------------------------------------------------------   00065800
.ZPVCK4A        ANOP  ,                                                 00065900
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00066000
&ZMS            SETC  'PLISTVER='                                       00066100
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00066200
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00066300
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00066400
                MNOTE 8,' &ZMS IS REQUIRED.'                            00066500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00066600
                AGO   .ZPVCK5                                           00066700
.ZPVCK4         ANOP  ,                                                 00066800
&XPLISTVER      SETA  &PLISTVER(1)                                      00066900
.ZPVCK5         ANOP  ,                                                 00067000
.ZPVCKE         ANOP  ,                                                 00067100
.********************************************************************   00067200
.***AG.MF01 PROCESS MF MACRO FORMS                                      00067300
.********************************************************************   00067400
                 ACTR  10000                                            00067500
.*------------------------------------------------------------------    00067600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067700
&XMF             SETC  ''          INITIALIZE XVARIABLE                 00067800
.*-------------------------------------------------------------------   00067900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00068000
.ZG39            ANOP  ,                                                00068100
&ZTLC            SETC 'S'                                               00068200
                 AIF   ('&MF(1)' NE '&ZTLC').ZG40                       00068300
&XMF             SETC  'S'         SET KEYWORD                          00068400
                 AIF   (N'&MF LE 1).ZG39A       CK NUM                  00068500
&ZMS             SETC  '"MF='                                           00068600
&ZMS             SETC  '&ZMS.&MF"'                                      00068700
&ZMS             SETC  '&ZMS "MF"'                                      00068800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00068900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00069000
.ZG39A           ANOP  ,                                                00069100
.*-------------------------------------------------------------------   00069200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00069300
.ZG40            ANOP  ,                                                00069400
&ZTLC            SETC 'L'                                               00069500
                 AIF   ('&MF(1)' NE '&ZTLC').ZG47                       00069600
&XMF             SETC  'L'         SET KEYWORD                          00069700
                 AIF   (N'&MF LE 3).ZG40A       CK NUM                  00069800
&ZMS             SETC  '"MF='                                           00069900
&ZMS             SETC  '&ZMS.&MF"'                                      00070000
&ZMS             SETC  '&ZMS "MF"'                                      00070100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00070200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00070300
.ZG40A           ANOP  ,                                                00070400
.*-------------------------------------------------------------------   00070500
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00070600
                 AIF   (N'&SYSLIST NE 0).ZG40B  POSITIONALS?            00070700
                 AIF   ('&INFOAREA' NE '').ZG40B  KEYS?                 00070800
                 AIF   ('&INFOAREALEN' NE '').ZG40B  KEYS?              00070900
                 AIF   ('&OUTVERSION' NE '').ZG40B  KEYS?               00071000
                 AIF   ('&LINKAGE' NE '').ZG40B  KEYS?                  00071100
                 AGO    .ZG40C     INVOCATION OKAY                      00071200
.ZG40B           ANOP  ,                                                00071300
&ZMS             SETC  'THE "L" FORM OF "MF"'                           00071400
&ZMS             SETC  '&ZMS CAN ONLY HAVE'                             00071500
&ZMS             SETC  '&ZMS THE "PLISTVER" KEY'                        00071600
                 MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'           00071700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00071800
.ZG40C           ANOP  ,                                                00071900
.*-------------------------------------------------------------------   00072000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00072100
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00072200
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00072300
                 AIF   (N'&MF(2) GT 1).ZG42B    MULTI                   00072400
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00072500
.ZG42B           AIF   (K'&MF(2) GT 0).ZG42C                            00072600
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00072700
&ZMS             SETC  'WHEN "L" IS SPECIFIED'                          00072800
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00072900
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00073000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00073100
.ZG42C           ANOP  ,                                                00073200
.*-------------------------------------------------------------------   00073300
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00073400
                 AIF   (K'&ZXMFCTRL LE 0).ZG42P  NOT I/O                00073500
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG42P                   00073600
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00073700
&ZMS             SETC  '"MF='                                           00073800
&ZMS             SETC  '&ZMS.&MF"'                                      00073900
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00074000
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                00074100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00074200
.ZG42P           ANOP  ,                                                00074300
.*-------------------------------------------------------------------   00074400
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00074500
&ZXMFATTR        SETC  'INPUT'     SET IN/OUTPUT                        00074600
&XMFATTR         SETC  '0D'                                             00074700
                 AIF   (K'&MF(3) LE 0).ZG45B    PARM                    00074800
&XMFATTR         SETC  '&MF(3,1)'  SET XVARIABLE                        00074900
                 AIF   (N'&MF(3) GT 1).ZG45B    MULTI                   00075000
&XMFATTR         SETC  '&MF(3)'    SET XVARIABLE                        00075100
.ZG45B           ANOP  ,                                                00075200
.*-------------------------------------------------------------------   00075300
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00075400
                 AIF   (K'&ZXMFATTR LE 0).ZG45P  NOT I/O                00075500
                 AIF   ('&XMFATTR'(1,1) NE '(').ZG45P                   00075600
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00075700
&ZMS             SETC  '"MF='                                           00075800
&ZMS             SETC  '&ZMS.&MF"'                                      00075900
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00076000
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                00076100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00076200
.ZG45P           ANOP  ,                                                00076300
.*-------------------------------------------------------------------   00076400
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00076500
                 AIF   (K'&ZXMFATTR LE 0).ZG45S  NOT I/O                00076600
                 AIF   (K'&XMFATTR LE 60).ZG45S  LNG OK                 00076700
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00076800
&ZMS             SETC  '"MF='                                           00076900
&ZMS             SETC  '&ZMS.&MF"'                                      00077000
&ZMS             SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'            00077100
                 MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'               00077200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00077300
.ZG45S           ANOP  ,                                                00077400
.*-------------------------------------------------------------------   00077500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00077600
.ZG47            ANOP  ,                                                00077700
&ZTLC            SETC 'E'                                               00077800
                 AIF   ('&MF(1)' NE '&ZTLC').ZG55                       00077900
&XMF             SETC  'E'         SET KEYWORD                          00078000
                 AIF   (N'&MF LE 3).ZG47A       CK NUM                  00078100
&ZMS             SETC  '"MF='                                           00078200
&ZMS             SETC  '&ZMS.&MF"'                                      00078300
&ZMS             SETC  '&ZMS "MF"'                                      00078400
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00078500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00078600
.ZG47A           ANOP  ,                                                00078700
.*-------------------------------------------------------------------   00078800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00078900
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00079000
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00079100
                 AIF   (N'&MF(2) GT 1).ZG49B    MULTI                   00079200
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00079300
.ZG49B           AIF   (K'&MF(2) GT 0).ZG49C                            00079400
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00079500
&ZMS             SETC  'WHEN "E" IS SPECIFIED'                          00079600
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00079700
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00079800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00079900
.ZG49C           ANOP  ,                                                00080000
.*-------------------------------------------------------------------   00080100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00080200
                 AIF   (K'&ZXMFCTRL LE 0).ZG49R  NOT I/O                00080300
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG49R                   00080400
&ZCGPR           SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                       00080500
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                     00080600
                 AIF   (K'&ZCGPR GT 2).ZG49Q                            00080700
                 AIF   ('&ZCGPR' EQ '0').ZG49Q                          00080800
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00080900
                 AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME        00081000
.ZG49P           ANOP  ,                                                00081100
                 AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC             00081200
                 AIF   ('&ZCGPR' LT '1').ZG49Q                          00081300
                 AIF   ('&ZCGPR' LE '12').ZG49R                         00081400
.ZG49Q           ANOP  ,                                                00081500
&ZMS             SETC  '"MF='                                           00081600
&ZMS             SETC  '&ZMS.&MF"'                                      00081700
&ZMS             SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'        00081800
                 MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                 00081900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00082000
.ZG49R           ANOP  ,                                                00082100
.*-------------------------------------------------------------------   00082200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00082300
&XMFSCK          SETC  ''          INITIALIZE XVARIABLE                 00082400
.ZG53A   AIF   ('&MF(3)' NE 'COMPLETE').ZG54A                           00082500
&XMFSCK          SETC  'COMPLETE'  SET KEYWORD                          00082600
.*-------------------------------------------------------------------   00082700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00082800
.ZG54A           AIF   (K'&XMFSCK GT 0).ZG54C   KEYWORD                 00082900
                 AIF   (K'&MF(3) LE 0).ZG54B                            00083000
&ZMS             SETC  '"MF='                                           00083100
&ZMS             SETC  '&ZMS.&MF"'                                      00083200
&ZMS             SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '        00083300
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00083400
&ZMS             SETC  '&ZMS "COMPLETE".'                               00083500
                 MNOTE 8,' &ZMS '                                       00083600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00083700
.ZG54B           ANOP  ,                                                00083800
&XMFSCK          SETC  'COMPLETE'  SET DEFAULT KEYWORD                  00083900
.ZG54C           ANOP  ,                                                00084000
&ZXMFSCK         SETC  'INPUT'     SET IN/OUTPUT                        00084100
.*------------------------------------------------------------------    00084200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084300
.ZG55            ANOP  ,                                                00084400
&ZXMF            SETC  'INPUT'     SET IN/OUTPUT                        00084500
                 AIF   (K'&XMF GT 0).ZG55E      VALID ARG               00084600
                 AIF   (T'&MF EQ 'O').ZG55D     OMITTED                 00084700
&ZASYSLNDX       SETA  0                                                00084800
.ZG55A           ANOP  ,           POSITIONAL MACRO KEY                 00084900
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00085000
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG55C                 00085100
&ZTLC            SETC 'MF'                                              00085200
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG55A        00085300
.ZG55B           ANOP  ,                                                00085400
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00085500
&ZMS             SETC  'THE "MF" KEY'                                   00085600
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00085700
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00085800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00085900
                 AGO   .ZG55E                                           00086000
.ZG55C           ANOP  ,                                                00086100
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00086200
&ZMS             SETC  '"MF='                                           00086300
&ZMS             SETC  '&ZMS.&MF"'                                      00086400
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00086500
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00086600
&ZMS             SETC  '&ZMS "S",'                                      00086700
&ZMS             SETC  '&ZMS "L",'                                      00086800
&ZMS             SETC  '&ZMS OR "E".'                                   00086900
                 MNOTE 8,' &ZMS '                                       00087000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00087100
                 AGO   .ZG55E                                           00087200
.ZG55D           ANOP  ,                                                00087300
&XMF             SETC  'S'         SET DEFAULT KEYWORD                  00087400
&XMFSCK          SETC  'COMPLETE'  COMPLETE CHECKING                    00087500
.ZG55E           ANOP  ,                                                00087600
.********************************************************************   00087700
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00087800
.********************************************************************   00087900
                 ACTR  10000                                            00088000
.*-------------------------------------------------------------------   00088100
.***AG.MF03 MF=(SLE)                                                    00088200
                 AIF   ('&XMF' EQ 'L').ZGMFX                            00088300
.*-------------------------------------------------------------------   00088400
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00088500
&XFUNCTION       SETC  ''          INITIALIZE XVARIABLE                 00088600
&ZASYSLNDX       SETA  0                                                00088700
.ZG2A            ANOP  ,           POSITIONAL KEY SEARCH                00088800
&ZASYSLNDX       SETA  &ZASYSLNDX+1             NEXT POSITIONAL         00088900
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00089000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00089100
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CONFIGINFO').ZG2A            00089200
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00089300
&ZXFUNCTION      SETC  'INPUT'     SET IN/OUTPUT                        00089400
&XFUNCTION       SETC  'CONFIGINFO'             SET XVARIABLE           00089500
&ZXCONFIGINFO    SETC  'INPUT'     SET IN/OUTPUT                        00089600
&XCONFIGINFO     SETC  'CONFIGINFO'             SET XVARIABLE PARM      00089700
.ZG2B            ANOP  ,                                                00089800
.*-------------------------------------------------------------------   00089900
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00090000
&ZASYSLNDX       SETA  0                                                00090100
.ZG12A           ANOP  ,           POSITIONAL KEY SEARCH                00090200
&ZASYSLNDX       SETA  &ZASYSLNDX+1             NEXT POSITIONAL         00090300
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG12C  DONE                   00090400
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG12A            00090500
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'DEVINFO').ZG12A              00090600
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00090700
                 AIF   (K'&XFUNCTION LE 0).ZG12B  VALID                 00090800
&ZMS             SETC  '"DEVINFO'                                       00090900
&ZMS             SETC  '&ZMS."'                                         00091000
&ZMS             SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'            00091100
&ZMS             SETC  '&ZMS "&XFUNCTION"'                              00091200
                 MNOTE 8,' &ZMS KEY.'                                   00091300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00091400
                 AGO   .ZG12C                                           00091500
.*                                                                      00091600
.ZG12B           ANOP  ,                                                00091700
&ZXFUNCTION      SETC  'INPUT'     SET IN/OUTPUT                        00091800
&XFUNCTION       SETC  'DEVINFO'   SET XVARIABLE                        00091900
&ZXDEVINFO       SETC  'INPUT'     SET IN/OUTPUT                        00092000
&XDEVINFO        SETC  'DEVINFO'   SET XVARIABLE PARM                   00092100
.ZG12C           ANOP  ,                                                00092200
.*------------------------------------------------------------------    00092300
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00092400
                 AIF   (K'&XFUNCTION GT 0).ZG22B                        00092500
&ZXFUNCTION      SETC  ''          RESET IN/OUTPUT                      00092600
&ZXCONFIGINFO    SETC  ''          RESET IN/OUTPUT                      00092700
&XFUNCTION       SETC  ''          ENSURE NULL                          00092800
&XCONFIGINFO     SETC  ''          ENSURE NULL                          00092900
&ZMS             SETC  'ONE OF THE FOLLOWING'                           00093000
&ZMS             SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'              00093100
&ZMS             SETC  '&ZMS REQUIRED:'                                 00093200
&ZMS             SETC  '&ZMS "CONFIGINFO"'      VALID ME KEY            00093300
&ZMS             SETC  '&ZMS OR "DEVINFO".'     VALID ME KEY            00093400
                 MNOTE 8,' &ZMS '                                       00093500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00093600
.ZG22B           ANOP  ,                                                00093700
.*-------------------------------------------------------------------   00093800
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00093900
.ZG2ZY  AIF    ('&XFUNCTION' NE 'CONFIGINFO').ZG12ZY                    00094000
.*----------------------------------------------------------------***   00094100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00094200
                 AIF   (N'&INFOAREA LE 1).ZG4A  CK NUM                  00094300
&ZMS             SETC  '"INFOAREA='                                     00094400
&ZMS             SETC  '&ZMS.&INFOAREA"'                                00094500
&ZMS             SETC  '&ZMS "INFOAREA"'                                00094600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00094700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00094800
.ZG4A            ANOP  ,                                                00094900
.*-------------------------------------------------------------------   00095000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00095100
&ZXINFOAREA      SETC  'INPUT'     SET IN/OUTPUT                        00095200
&XINFOAREA       SETC  '&INFOAREA(1)'           SET XVARIABLE           00095300
                 AIF   (N'&INFOAREA GT 1).ZG4B  MULTI                   00095400
&XINFOAREA       SETC  '&INFOAREA'              SET XVARIABLE           00095500
.ZG4B            AIF   (K'&INFOAREA(1) GT 0).ZG4C                       00095600
&ZXINFOAREA      SETC  ''          RESET IN/OUTPUT                      00095700
&ZMS             SETC  ' '                                              00095800
&ZMS             SETC  '&ZMS "INFOAREA" KEY AND ITS'                    00095900
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00096000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00096100
.ZG4C            ANOP  ,                                                00096200
.*-------------------------------------------------------------------   00096300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00096400
                 AIF   (K'&ZXINFOAREA LE 0).ZG4R  NOT I/O               00096500
                 AIF   ('&XINFOAREA'(1,1) NE '(').ZG4R                  00096600
&ZCGPR           SETC  '&XINFOAREA'(2,K'&XINFOAREA-2)                   00096700
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                      00096800
                 AIF   (K'&ZCGPR GT 2).ZG4Q                             00096900
                 AIF   ('&ZCGPR' EQ '0').ZG4Q                           00097000
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00097100
                 AIF   (T'&ZCGPR NE 'N').ZG4Q   INVALID REG NAME        00097200
.ZG4P            ANOP  ,                                                00097300
                 AIF   (T'&ZCGPR NE 'N').ZG4R   NON NUMERIC             00097400
                 AIF   ('&ZCGPR' LT '2').ZG4Q                           00097500
                 AIF   ('&ZCGPR' LE '12').ZG4R                          00097600
.ZG4Q            ANOP  ,                                                00097700
&ZMS             SETC  '"INFOAREA='                                     00097800
&ZMS             SETC  '&ZMS.&INFOAREA"'                                00097900
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00098000
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00098100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00098200
.ZG4R            ANOP  ,                                                00098300
.*----------------------------------------------------------------***   00098400
.***AG.KXVAR05 NAME, RQD INOUT, KEYS -XVARIABLE KEY                     00098500
                 AIF   (N'&INFOAREALEN LE 1).ZG7A  CK NUM               00098600
&ZMS             SETC  '"INFOAREALEN='                                  00098700
&ZMS             SETC  '&ZMS.&INFOAREALEN"'                             00098800
&ZMS             SETC  '&ZMS "INFOAREALEN"'                             00098900
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00099000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00099100
.ZG7A            ANOP  ,                                                00099200
.*-------------------------------------------------------------------   00099300
.***AG.KXVAR06 NAME, RQD INOUT, KEYS -XVARIABLE                         00099400
&ZXINFOAREALEN   SETC  'INOUT'     SET IN/OUTPUT                        00099500
&XINFOAREALEN    SETC  '&INFOAREALEN(1)'        SET XVARIABLE           00099600
                 AIF   (N'&INFOAREALEN GT 1).ZG7B  MULTI                00099700
&XINFOAREALEN    SETC  '&INFOAREALEN'           SET XVARIABLE           00099800
.ZG7B            AIF   (K'&INFOAREALEN(1) GT 0).ZG7C                    00099900
&ZXINFOAREALEN   SETC  ''          RESET IN/OUTPUT                      00100000
&ZMS             SETC  ' '                                              00100100
&ZMS             SETC  '&ZMS "INFOAREALEN" KEY AND ITS'                 00100200
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00100300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00100400
.ZG7C            ANOP  ,                                                00100500
.*-------------------------------------------------------------------   00100600
.***AG.KCK02 NAME, RQD INOUT, KEYS -GPR OUT OF RANGE                    00100700
                 AIF   (K'&ZXINFOAREALEN LE 0).ZG7R  NOT I/O            00100800
                 AIF   ('&XINFOAREALEN'(1,1) NE '(').ZG7R               00100900
&ZCGPR           SETC  '&XINFOAREALEN'(2,K'&XINFOAREALEN-2)             00101000
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                      00101100
                 AIF   (K'&ZCGPR GT 2).ZG7Q                             00101200
                 AIF   ('&ZCGPR' EQ '0').ZG7Q                           00101300
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00101400
                 AIF   (T'&ZCGPR NE 'N').ZG7Q   INVALID REG NAME        00101500
.ZG7P            ANOP  ,                                                00101600
                 AIF   (T'&ZCGPR NE 'N').ZG7R   NON NUMERIC             00101700
                 AIF   ('&ZCGPR' LT '2').ZG7Q                           00101800
                 AIF   ('&ZCGPR' LE '12').ZG7R                          00101900
.ZG7Q            ANOP  ,                                                00102000
&ZMS             SETC  '"INFOAREALEN='                                  00102100
&ZMS             SETC  '&ZMS.&INFOAREALEN"'                             00102200
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00102300
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00102400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00102500
.ZG7R            ANOP  ,                                                00102600
.*----------------------------------------------------------------***   00102700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00102800
                 AIF   (N'&OUTVERSION LE 1).ZG10A  CK NUM               00102900
&ZMS             SETC  '"OUTVERSION='                                   00103000
&ZMS             SETC  '&ZMS.&OUTVERSION"'                              00103100
&ZMS             SETC  '&ZMS "OUTVERSION"'                              00103200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00103300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00103400
.ZG10A           ANOP  ,                                                00103500
.*-------------------------------------------------------------------   00103600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00103700
&ZXOUTVERSION    SETC  'INPUT'     SET IN/OUTPUT                        00103800
&XOUTVERSION     SETC  '0'                                              00103900
                 AIF   (K'&OUTVERSION(1) LE 0).ZG10B  PARM              00104000
&XOUTVERSION     SETC  '&OUTVERSION(1)'         SET XVARIABLE           00104100
                 AIF   (N'&OUTVERSION GT 1).ZG10B  MULTI                00104200
&XOUTVERSION     SETC  '&OUTVERSION'            SET XVARIABLE           00104300
.ZG10B           ANOP  ,                                                00104400
.*-------------------------------------------------------------------   00104500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00104600
                 AIF   (K'&ZXOUTVERSION LE 0).ZG10R  NOT I/O            00104700
                 AIF   ('&XOUTVERSION'(1,1) NE '(').ZG10R               00104800
&ZCGPR           SETC  '&XOUTVERSION'(2,K'&XOUTVERSION-2)               00104900
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                     00105000
                 AIF   (K'&ZCGPR GT 2).ZG10Q                            00105100
                 AIF   ('&ZCGPR' EQ '0').ZG10Q                          00105200
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00105300
                 AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME        00105400
.ZG10P           ANOP  ,                                                00105500
                 AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC             00105600
                 AIF   ('&ZCGPR' LT '2').ZG10Q                          00105700
                 AIF   ('&ZCGPR' LE '12').ZG10R                         00105800
.ZG10Q           ANOP  ,                                                00105900
&ZMS             SETC  '"OUTVERSION='                                   00106000
&ZMS             SETC  '&ZMS.&OUTVERSION"'                              00106100
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00106200
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00106300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00106400
.ZG10R           ANOP  ,                                                00106500
.*-------------------------------------------------------------------   00106600
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00106700
.ZG12ZY  AIF    ('&XFUNCTION' NE 'DEVINFO').ZG22ZY                      00106800
.*----------------------------------------------------------------***   00106900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00107000
                 AIF   (N'&INFOAREA LE 1).ZG14A  CK NUM                 00107100
&ZMS             SETC  '"INFOAREA='                                     00107200
&ZMS             SETC  '&ZMS.&INFOAREA"'                                00107300
&ZMS             SETC  '&ZMS "INFOAREA"'                                00107400
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00107500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00107600
.ZG14A           ANOP  ,                                                00107700
.*-------------------------------------------------------------------   00107800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00107900
&ZXINFOAREA      SETC  'INPUT'     SET IN/OUTPUT                        00108000
&XINFOAREA       SETC  '&INFOAREA(1)'           SET XVARIABLE           00108100
                 AIF   (N'&INFOAREA GT 1).ZG14B  MULTI                  00108200
&XINFOAREA       SETC  '&INFOAREA'              SET XVARIABLE           00108300
.ZG14B           AIF   (K'&INFOAREA(1) GT 0).ZG14C                      00108400
&ZXINFOAREA      SETC  ''          RESET IN/OUTPUT                      00108500
&ZMS             SETC  ' '                                              00108600
&ZMS             SETC  '&ZMS "INFOAREA" KEY AND ITS'                    00108700
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00108800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00108900
.ZG14C           ANOP  ,                                                00109000
.*-------------------------------------------------------------------   00109100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00109200
                 AIF   (K'&ZXINFOAREA LE 0).ZG14R  NOT I/O              00109300
                 AIF   ('&XINFOAREA'(1,1) NE '(').ZG14R                 00109400
&ZCGPR           SETC  '&XINFOAREA'(2,K'&XINFOAREA-2)                   00109500
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                     00109600
                 AIF   (K'&ZCGPR GT 2).ZG14Q                            00109700
                 AIF   ('&ZCGPR' EQ '0').ZG14Q                          00109800
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00109900
                 AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME        00110000
.ZG14P           ANOP  ,                                                00110100
                 AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC             00110200
                 AIF   ('&ZCGPR' LT '2').ZG14Q                          00110300
                 AIF   ('&ZCGPR' LE '12').ZG14R                         00110400
.ZG14Q           ANOP  ,                                                00110500
&ZMS             SETC  '"INFOAREA='                                     00110600
&ZMS             SETC  '&ZMS.&INFOAREA"'                                00110700
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00110800
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00110900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00111000
.ZG14R           ANOP  ,                                                00111100
.*----------------------------------------------------------------***   00111200
.***AG.KXVAR05 NAME, RQD INOUT, KEYS -XVARIABLE KEY                     00111300
                 AIF   (N'&INFOAREALEN LE 1).ZG17A  CK NUM              00111400
&ZMS             SETC  '"INFOAREALEN='                                  00111500
&ZMS             SETC  '&ZMS.&INFOAREALEN"'                             00111600
&ZMS             SETC  '&ZMS "INFOAREALEN"'                             00111700
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00111800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00111900
.ZG17A           ANOP  ,                                                00112000
.*-------------------------------------------------------------------   00112100
.***AG.KXVAR06 NAME, RQD INOUT, KEYS -XVARIABLE                         00112200
&ZXINFOAREALEN   SETC  'INOUT'     SET IN/OUTPUT                        00112300
&XINFOAREALEN    SETC  '&INFOAREALEN(1)'        SET XVARIABLE           00112400
                 AIF   (N'&INFOAREALEN GT 1).ZG17B  MULTI               00112500
&XINFOAREALEN    SETC  '&INFOAREALEN'           SET XVARIABLE           00112600
.ZG17B           AIF   (K'&INFOAREALEN(1) GT 0).ZG17C                   00112700
&ZXINFOAREALEN   SETC  ''          RESET IN/OUTPUT                      00112800
&ZMS             SETC  ' '                                              00112900
&ZMS             SETC  '&ZMS "INFOAREALEN" KEY AND ITS'                 00113000
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00113100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00113200
.ZG17C           ANOP  ,                                                00113300
.*-------------------------------------------------------------------   00113400
.***AG.KCK02 NAME, RQD INOUT, KEYS -GPR OUT OF RANGE                    00113500
                 AIF   (K'&ZXINFOAREALEN LE 0).ZG17R  NOT I/O           00113600
                 AIF   ('&XINFOAREALEN'(1,1) NE '(').ZG17R              00113700
&ZCGPR           SETC  '&XINFOAREALEN'(2,K'&XINFOAREALEN-2)             00113800
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                     00113900
                 AIF   (K'&ZCGPR GT 2).ZG17Q                            00114000
                 AIF   ('&ZCGPR' EQ '0').ZG17Q                          00114100
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00114200
                 AIF   (T'&ZCGPR NE 'N').ZG17Q  INVALID REG NAME        00114300
.ZG17P           ANOP  ,                                                00114400
                 AIF   (T'&ZCGPR NE 'N').ZG17R  NON NUMERIC             00114500
                 AIF   ('&ZCGPR' LT '2').ZG17Q                          00114600
                 AIF   ('&ZCGPR' LE '12').ZG17R                         00114700
.ZG17Q           ANOP  ,                                                00114800
&ZMS             SETC  '"INFOAREALEN='                                  00114900
&ZMS             SETC  '&ZMS.&INFOAREALEN"'                             00115000
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00115100
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00115200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00115300
.ZG17R           ANOP  ,                                                00115400
.*----------------------------------------------------------------***   00115500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00115600
                 AIF   (N'&OUTVERSION LE 1).ZG20A  CK NUM               00115700
&ZMS             SETC  '"OUTVERSION='                                   00115800
&ZMS             SETC  '&ZMS.&OUTVERSION"'                              00115900
&ZMS             SETC  '&ZMS "OUTVERSION"'                              00116000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00116100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00116200
.ZG20A           ANOP  ,                                                00116300
.*-------------------------------------------------------------------   00116400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00116500
&ZXOUTVERSION    SETC  'INPUT'     SET IN/OUTPUT                        00116600
&XOUTVERSION     SETC  '0'                                              00116700
                 AIF   (K'&OUTVERSION(1) LE 0).ZG20B  PARM              00116800
&XOUTVERSION     SETC  '&OUTVERSION(1)'         SET XVARIABLE           00116900
                 AIF   (N'&OUTVERSION GT 1).ZG20B  MULTI                00117000
&XOUTVERSION     SETC  '&OUTVERSION'            SET XVARIABLE           00117100
.ZG20B           ANOP  ,                                                00117200
.*-------------------------------------------------------------------   00117300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00117400
                 AIF   (K'&ZXOUTVERSION LE 0).ZG20R  NOT I/O            00117500
                 AIF   ('&XOUTVERSION'(1,1) NE '(').ZG20R               00117600
&ZCGPR           SETC  '&XOUTVERSION'(2,K'&XOUTVERSION-2)               00117700
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                     00117800
                 AIF   (K'&ZCGPR GT 2).ZG20Q                            00117900
                 AIF   ('&ZCGPR' EQ '0').ZG20Q                          00118000
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00118100
                 AIF   (T'&ZCGPR NE 'N').ZG20Q  INVALID REG NAME        00118200
.ZG20P           ANOP  ,                                                00118300
                 AIF   (T'&ZCGPR NE 'N').ZG20R  NON NUMERIC             00118400
                 AIF   ('&ZCGPR' LT '2').ZG20Q                          00118500
                 AIF   ('&ZCGPR' LE '12').ZG20R                         00118600
.ZG20Q           ANOP  ,                                                00118700
&ZMS             SETC  '"OUTVERSION='                                   00118800
&ZMS             SETC  '&ZMS.&OUTVERSION"'                              00118900
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00119000
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00119100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00119200
.ZG20R           ANOP  ,                                                00119300
.*-------------------------------------------------------------------   00119400
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00119500
.ZG22ZY          ANOP ,            END MUTUALLY EXCLUSIVE KEYS          00119600
.*----------------------------------------------------------------***   00119700
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00119800
                 AIF   (N'&LINKAGE LE 1).ZG24A  CK NUM                  00119900
&ZMS             SETC  '"LINKAGE='                                      00120000
&ZMS             SETC  '&ZMS.&LINKAGE"'                                 00120100
&ZMS             SETC  '&ZMS "LINKAGE"'                                 00120200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00120300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00120400
.ZG24A           ANOP  ,                                                00120500
.*-------------------------------------------------------------------   00120600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120700
&XLINKAGE        SETC  ''          INITIALIZE XVARIABLE                 00120800
.ZG25A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG26A                        00120900
&XLINKAGE        SETC  'SYSTEM'    SET KEYWORD                          00121000
.*-------------------------------------------------------------------   00121100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121200
.ZG26A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG27A                        00121300
&XLINKAGE        SETC  'BRANCH'    SET KEYWORD                          00121400
.*-------------------------------------------------------------------   00121500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121600
.ZG27A           AIF   (K'&XLINKAGE GT 0).ZG27C  KEYWORD                00121700
                 AIF   (K'&LINKAGE(1) LE 0).ZG27B                       00121800
&ZMS             SETC  '"LINKAGE='                                      00121900
&ZMS             SETC  '&ZMS.&LINKAGE"'                                 00122000
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00122100
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00122200
&ZMS             SETC  '&ZMS "SYSTEM"'                                  00122300
&ZMS             SETC  '&ZMS OR "BRANCH".'                              00122400
                 MNOTE 8,' &ZMS '                                       00122500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00122600
.ZG27B           ANOP  ,                                                00122700
&XLINKAGE        SETC  'SYSTEM'    SET DEFAULT KEYWORD                  00122800
.ZG27C           ANOP  ,                                                00122900
&ZXLINKAGE       SETC  'INPUT'     SET IN/OUTPUT                        00123000
.******************************************************************     00123100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00123200
.******************************************************************     00123300
                 ACTR  10000                                            00123400
.*-------------------------------------------------------------------   00123500
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00123600
&ZCVAL           SETC  ''          ERROR FIELD                          00123700
&ZAWRK           SETA  0           POSITIONAL COUNTER                   00123800
&ZASYSLNDX       SETA  0           NON-X KEY COUNTER                    00123900
.ZGLIST2         ANOP  ,                                                00124000
&ZASYSLNDX       SETA  &ZASYSLNDX+1             NEXT NON-X KEY          00124100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00124200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00124300
&ZAWRK           SETA  &ZAWRK+1    NEXT POSITIONAL                      00124400
                 AIF   (&ZAWRK LE 0).ZGLIST2                            00124500
&ZCVAL           SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA              00124600
                 AGO   .ZGLIST2                                         00124700
.*                                                                      00124800
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00124900
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)    STRIP COMMA             00125000
&ZMS             SETC  'POSITIONAL ARGUMENT(S),'                        00125100
&ZMS             SETC  '&ZMS "&ZCVAL"'                                  00125200
&ZMS             SETC  '&ZMS CANNOT BE USED.'                           00125300
&ZMS             SETC  '&ZMS NO POSITIONAL ARGUMENTS'                   00125400
                 MNOTE 8,' &ZMS ARE ALLOWED.'                           00125500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00125600
.ZGLISTX         ANOP  ,                                                00125700
&ZASYSLNDX       SETA  0                                                00125800
.*-------------------------------------------------------------------   00125900
.***AG.MF04 MF=(SLE)                                                    00126000
.ZGMFX           ANOP  ,           END OF FULL SYNTAX CHECK             00126100
.*******************************************************************    00126200
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00126300
.*******************************************************************    00126400
                 AIF   (&ZMACRET NE 0).ZLX2     ERROR DETECTED          00126500
.*******************************************************************    00126600
.***AE.01  START OF IOSSCM MACRO CODE                                   00126700
.*******************************************************************    00126800
                 LCLC  &M0M0001                 NAME                    00126900
&M0M0001         SETC  '&XLABEL'                SET NAME                00127000
                 AIF   (K'&XLABEL NE 0).XLAB2                           00127100
&M0M0001         SETC  'M00M&SYSNDX'            DEFAULT NAME            00127200
.*                                                                      00127300
.XLAB2           ANOP  ,                                                00127400
                 AIF   ('&XMF' EQ 'L').XLAB3                            00127500
&M0M0001 DS    0H                             IOSSCM-1                  00127600
.XLAB3           ANOP  ,                                                00127700
.*******************************************************************    00127800
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00127900
.*******************************************************************    00128000
              PUSH  PRINT                                               00128100
                 AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON       00128200
                 PRINT OFF         ++ PR01                              00128300
                 AGO   .ZPRNTXX                                         00128400
.ZPRINTX         PRINT ON                                               00128500
.ZPRNTXX         ANOP  ,                                                00128600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00128700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00128800
.********************************************************************   00128900
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00129000
.********************************************************************   00129100
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00129200
                      LCLA  &ZOPN1         INVOCATION INDEX             00129300
                      LCLC  &ZOPL(4095)    LABEL                        00129400
                      LCLC  &ZOPO(4095)    OPERATION                    00129500
                      LCLC  &ZOPV(4095)    VALUE                        00129600
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00129700
.*                                                                      00129800
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00129900
.******************************************************************     00130000
.***AL.L10 IOSSCM FMT=LIST MF=S!L PARAMETERS                            00130100
.******************************************************************     00130200
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00130300
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00130400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00130500
&XMFATTR              SETC  '0D'                                        00130600
.*                                                                      00130700
&ZOPN                 SETA  &ZOPN+1                                     00130800
&ZOPL(&ZOPN)          SETC  ' '                                         00130900
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00131000
&ZOPV(&ZOPN)          SETC  '4,8'                                       00131100
&ZOPN                 SETA  &ZOPN+1                                     00131200
&ZOPL(&ZOPN)          SETC  ' '                                         00131300
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00131400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00131500
&ZOPD(&ZOPN)          SETC  '++ IOSSCM ARG PARMS'                       00131600
.*                                                                      00131700
&ZOPN                 SETA  &ZOPN+1                                     00131800
&ZOPL(&ZOPN)          SETC  ' '                                         00131900
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00132000
&ZOPV(&ZOPN)          SETC  '1'                                         00132100
&ZOPD(&ZOPN)          SETC  ' '                                         00132200
.*                                                                      00132300
.ZLMFSL2              ANOP  ,                                           00132400
.*-------------------------------------------------------------------   00132500
.***AM.L00  IOSSCM FMT=LIST name                                        00132600
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00132700
&ZOPN                 SETA &ZOPN+1                                      00132800
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00132900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00133000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00133100
&ZOPD(&ZOPN)          SETC '++ IOSSCM NAME'                             00133200
.ZLMFSL2M             ANOP  ,                                           00133300
.*-------------------------------------------------------------------   00133400
.***AM.L01  IOSSCM FMT=LIST PARAMETERS                                  00133500
&ZOPN                 SETA &ZOPN+1                                      00133600
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00133700
&ZOPO(&ZOPN)          SETC 'DS'                                         00133800
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00133900
&ZOPD(&ZOPN)          SETC '++ IOSSCM PARM LIST'                        00134000
.*-------------------------------------------------------------------   00134100
.***AM.L02 XVERSION XL1                                                 00134200
&ZOPN                 SETA &ZOPN+1                                      00134300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00134400
&ZOPO(&ZOPN)          SETC 'DS'                                         00134500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00134600
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00134700
.*-------------------------------------------------------------------   00134800
.***AM.L04 XFUNCTION CL2                                                00134900
&ZOPN                 SETA &ZOPN+1                                      00135000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNCTION'                        00135100
&ZOPO(&ZOPN)          SETC 'DS'                                         00135200
&ZOPV(&ZOPN)          SETC 'CL2'                                        00135300
&ZOPD(&ZOPN)          SETC '++ &ZXFUNCTION XFUNCTION'                   00135400
.*                                                                      00135500
&ZOPN                 SETA  &ZOPN+1                                     00135600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNCTION_CONFIGINFO'            00135700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00135800
&ZOPV(&ZOPN)          SETC  'C''CF'',2'                                 00135900
&ZOPD(&ZOPN)          SETC  '++ XFUNCTION.'                             00136000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CONFIGINFO'                   00136100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00136200
.*                                                                      00136300
&ZOPN                 SETA  &ZOPN+1                                     00136400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNCTION_DEVINFO'               00136500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00136600
&ZOPV(&ZOPN)          SETC  'C''DV'',2'                                 00136700
&ZOPD(&ZOPN)          SETC  '++ XFUNCTION.'                             00136800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEVINFO'                      00136900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00137000
.*-------------------------------------------------------------------   00137100
.***AM.L09  XRESERVED1 CL1                                              00137200
&ZOPN                 SETA &ZOPN+1                                      00137300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00137400
&ZOPO(&ZOPN)          SETC 'DS'                                         00137500
&ZOPV(&ZOPN)          SETC 'CL1'                                        00137600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00137700
.*-------------------------------------------------------------------   00137800
.***AM.L03 XFLAGS BL.16                                                 00137900
&ZOPN                 SETA &ZOPN+1                                      00138000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00138100
&ZOPO(&ZOPN)          SETC 'DS'                                         00138200
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00138300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00138400
.*                                                                      00138500
&ZOPN                 SETA  &ZOPN+1                                     00138600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_OUTVERSION'              00138700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00138800
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00138900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00139000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).OUTVERSION'                   00139100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00139200
.*-------------------------------------------------------------------   00139300
.***AM.L09  XRESERVED2 CL1                                              00139400
&ZOPN                 SETA &ZOPN+1                                      00139500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       00139600
&ZOPO(&ZOPN)          SETC 'DS'                                         00139700
&ZOPV(&ZOPN)          SETC 'CL1'                                        00139800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00139900
.*-------------------------------------------------------------------   00140000
.***AM.L09  XOUTVERSION XL1                                             00140100
&ZOPN                 SETA &ZOPN+1                                      00140200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTVERSION'                      00140300
&ZOPO(&ZOPN)          SETC 'DS'                                         00140400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00140500
&ZOPD(&ZOPN)          SETC '++ &ZXOUTVERSION '                          00140600
.*-------------------------------------------------------------------   00140700
.***AM.L09  XINFOAREA AD                                                00140800
&ZOPN                 SETA &ZOPN+1                                      00140900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINFOAREA'                        00141000
&ZOPO(&ZOPN)          SETC 'DS'                                         00141100
&ZOPV(&ZOPN)          SETC 'AD'                                         00141200
&ZOPD(&ZOPN)          SETC '++ &ZXINFOAREA '                            00141300
.*-------------------------------------------------------------------   00141400
.***AM.L09  XINFOAREALEN F                                              00141500
&ZOPN                 SETA &ZOPN+1                                      00141600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINFOAREALEN'                     00141700
&ZOPO(&ZOPN)          SETC 'DS'                                         00141800
&ZOPV(&ZOPN)          SETC 'F'                                          00141900
&ZOPD(&ZOPN)          SETC '++ &ZXINFOAREALEN '                         00142000
.*-------------------------------------------------------------------   00142100
.***AM.L09  XRESERVED3 CL4                                              00142200
&ZOPN                 SETA &ZOPN+1                                      00142300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED3'                       00142400
&ZOPO(&ZOPN)          SETC 'DS'                                         00142500
&ZOPV(&ZOPN)          SETC 'CL4'                                        00142600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00142700
.*-------------------------------------------------------------------   00142800
.***AM.L10 END OF IOSSCM LIST PARAMETERS                                00142900
&ZOPN                 SETA &ZOPN+1                                      00143000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00143100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00143200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00143300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00143400
.*                                                                      00143500
&ZOPN                 SETA &ZOPN+1                                      00143600
&ZOPL(&ZOPN)          SETC ' '                                          00143700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00143800
&ZOPV(&ZOPN)          SETC '1'                                          00143900
&ZOPD(&ZOPN)          SETC ' '                                          00144000
.*-------------------------------------------------------------------   00144100
.***AL.L12 IOSSCM FMT=LIST MF=S!L PARAMETERS                            00144200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00144300
.*                                                                      00144400
&ZOPN                 SETA  &ZOPN+1                                     00144500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00144600
&ZOPO(&ZOPN)          SETC  'DC'                                        00144700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00144800
&ZOPD(&ZOPN)          SETC  '++ IOSSCM ARG PARMS'                       00144900
.*                                                                      00145000
.ZLMFSLX              ANOP  ,                                           00145100
.*-------------------------------------------------------------------   00145200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00145300
&ZPLLEN               SETA 24                                           00145400
.*                                                                      00145500
.******************************************************************     00145600
.***AI.L01 IOSSCM FMT=LIST FILL IN PARAMETER AREA                       00145700
.******************************************************************     00145800
                      ACTR  10000                                       00145900
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00146000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00146100
&ZCVAL                SETC  'LAE'          XAX MODE                     00146200
.ZIMFXA               ANOP ,                                            00146300
.*                                                                      00146400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00146500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00146600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00146700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00146800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00146900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00147000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00147100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00147200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00147300
&ZOPN                 SETA  &ZOPN+1                                     00147400
&ZOPL(&ZOPN)          SETC  ' '                                         00147500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00147600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00147700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00147800
                      AGO   .ZIMFNX                                     00147900
.*                                                                      00148000
.ZIMFN2               ANOP ,                                            00148100
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00148200
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00148300
&ZOPN                 SETA  &ZOPN+1                                     00148400
&ZOPL(&ZOPN)          SETC  ' '                                         00148500
&ZOPO(&ZOPN)          SETC  'LAE'                                       00148600
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00148700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00148800
                      AGO   .ZIMFNX                                     00148900
.ZIMFNX1              ANOP ,                                            00149000
&ZOPN                 SETA  &ZOPN+1                                     00149100
&ZOPL(&ZOPN)          SETC  ' '                                         00149200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00149300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00149400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00149500
.ZIMFNX               ANOP ,                                            00149600
.********************************************************************   00149700
.***AI.L02 IOSSCM FMT=LIST INITIALIZE PARAMETER AREA                    00149800
.********************************************************************   00149900
.***AI.L03 MF=(SLE)                                                     00150000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00150100
.*                                                                      00150200
&ZOPN                 SETA  &ZOPN+1                                     00150300
&ZOPL(&ZOPN)          SETC  ' '                                         00150400
&ZOPO(&ZOPN)          SETC  'XC'                                        00150500
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00150600
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00150700
.ZIMFLX               ANOP  ,                                           00150800
.*-------------------------------------------------------------------   00150900
.***AI.L04B XVERSION XL1                                                00151000
                      AIF   (&XPLISTVER EQ 0).ZIMFVZ                    00151100
&ZOPN                 SETA  &ZOPN+1                                     00151200
&ZOPL(&ZOPN)          SETC  ' '                                         00151300
&ZOPO(&ZOPN)          SETC  'MVI'                                       00151400
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00151500
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00151600
.ZIMFVZ               ANOP  ,                                           00151700
.*-------------------------------------------------------------------   00151800
.***AI.L06 XFUNCTION CL2                                                00151900
&ZW                   SETC  ''                                          00152000
.*-------------------------------------------------------------------   00152100
.***AI.L12 XFUNCTION "CONFIGINFO" CL2                                   00152200
         AIF   ('&XFUNCTION' NE 'CONFIGINFO').ZI3A                      00152300
&ZW                   SETC  'CF'                                        00152400
.ZI3A                 ANOP  ,                                           00152500
.*-------------------------------------------------------------------   00152600
.***AI.L12 XFUNCTION "DEVINFO" CL2                                      00152700
         AIF   ('&XFUNCTION' NE 'DEVINFO').ZI4A                         00152800
&ZW                   SETC  'DV'                                        00152900
.ZI4A                 ANOP  ,                                           00153000
.*-------------------------------------------------------------------   00153100
.***AI.L14 XFUNCTION CL2                                                00153200
                      AIF   ('&ZW' EQ '').ZI4B                          00153300
.*                                                                      00153400
&ZOPN                 SETA  &ZOPN+1                                     00153500
&ZOPL(&ZOPN)          SETC  ' '                                         00153600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00153700
&ZOPV(&ZOPN)          SETC  '1(2,1),=CL2''&ZW'''                        00153800
&ZOPD(&ZOPN)          SETC  '++ &ZXFUNCTION XFUNCTION'                  00153900
.ZI4B                 ANOP  ,                                           00154000
.*-------------------------------------------------------------------   00154100
.***AI.L05 XFLAGS BL2                                                   00154200
&ZW                   SETC  ''                                          00154300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00154400
.*-------------------------------------------------------------------   00154500
.***AI.L08 XFLAGS "OUTVERSION"                                          00154600
.***      BL2'1XXXXXXXXXXXXXXX'                                         00154700
         AIF   ('&OUTVERSION' EQ '').ZI7A                               00154800
&ZW                   SETC  '&ZW.1000000000000000'                      00154900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00155000
                      AGO   .ZI7C                                       00155100
.*                                                                      00155200
.ZI7A                 ANOP  ,                                           00155300
&ZW                   SETC  '&ZW.0000000000000000'                      00155400
.ZI7C                 ANOP  ,                                           00155500
.*-------------------------------------------------------------------   00155600
.***AI.L10 XFLAGS BL2                                                   00155700
                      AIF   ('&ZCLNG' NE 'YES').ZI7E  ALL ZERO BITS     00155800
&ZOPN                 SETA  &ZOPN+1                                     00155900
&ZOPL(&ZOPN)          SETC  ' '                                         00156000
&ZOPO(&ZOPN)          SETC  'OC'                                        00156100
&ZOPV(&ZOPN)          SETC  '4(2,1),=BL2''&ZW'''                        00156200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00156300
.ZI7E                 ANOP  ,                                           00156400
.*-------------------------------------------------------------------   00156500
.***AI.L25  XOUTVERSION XL1                                             00156600
                      AIF   ('&ZXOUTVERSION' EQ '').ZI9E                00156700
                      AIF   ('&ZXOUTVERSION' EQ 'OUTPUT').ZI9E          00156800
&ZCGPR                SETC  '&XOUTVERSION'                              00156900
         AIF   ('&XOUTVERSION' EQ '0').ZI9E                             00157000
         AIF   ('&XOUTVERSION' EQ '0').ZI9E                             00157100
.*                                                                      00157200
                      AIF   ('&XOUTVERSION'(1,1) NE '(').ZI9B           00157300
&ZCGPR   SETC  '0('.'&XOUTVERSION'(2,K'&XOUTVERSION-2).')'              00157400
                      AGO   .ZI9D                                       00157500
.ZI9B                 ANOP  ,                                           00157600
.*                                                                      00157700
&ZC                   SETC  '&XOUTVERSION'(1,1)                         00157800
                      AIF   (T'&ZC NE 'N').ZI9D                         00157900
&ZC                   SETC  '&XOUTVERSION'                              00158000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00158100
&ZCGPR                SETC  '=AL1(&XOUTVERSION)'                        00158200
.*                                                                      00158300
.ZI9D                 ANOP  ,                                           00158400
.*                                                                      00158500
&ZOPN                 SETA  &ZOPN+1                                     00158600
&ZOPL(&ZOPN)          SETC  ' '                                         00158700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00158800
&ZOPV(&ZOPN)          SETC  '7(1,1),&ZCGPR'                             00158900
&ZOPD(&ZOPN)          SETC  '++ &ZXOUTVERSION XOUTVERSION'              00159000
.*                                                                      00159100
.ZI9E                 ANOP  ,                                           00159200
.*-------------------------------------------------------------------   00159300
.***AI.L25  XINFOAREA AL8                                               00159400
                      AIF   ('&ZXINFOAREA' EQ '').ZI10E                 00159500
                      AIF   ('&ZXINFOAREA' EQ 'OUTPUT').ZI10E           00159600
&ZCGPR                SETC  '&XINFOAREA'                                00159700
.*                                                                      00159800
                      AIF   ('&XINFOAREA'(1,1) NE '(').ZI10B            00159900
&ZCGPR   SETC  '0('.'&XINFOAREA'(2,K'&XINFOAREA-2).')'                  00160000
                      AGO   .ZI10D                                      00160100
.ZI10B                ANOP  ,                                           00160200
.*                                                                      00160300
&ZC                   SETC  '&XINFOAREA'(1,1)                           00160400
                      AIF   (T'&ZC NE 'N').ZI10D                        00160500
&ZC                   SETC  '&XINFOAREA'                                00160600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00160700
&ZCGPR                SETC  '=AD(&XINFOAREA)'                           00160800
.*                                                                      00160900
.ZI10D                ANOP  ,                                           00161000
.*                                                                      00161100
&ZOPN                 SETA  &ZOPN+1                                     00161200
&ZOPL(&ZOPN)          SETC  ' '                                         00161300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00161400
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00161500
&ZOPD(&ZOPN)          SETC  '++ &ZXINFOAREA XINFOAREA'                  00161600
.*                                                                      00161700
.ZI10E                ANOP  ,                                           00161800
.*-------------------------------------------------------------------   00161900
.***AI.L25  XINFOAREALEN F                                              00162000
                      AIF   ('&ZXINFOAREALEN' EQ '').ZI11E              00162100
                      AIF   ('&ZXINFOAREALEN' EQ 'OUTPUT').ZI11E        00162200
&ZCGPR                SETC  '&XINFOAREALEN'                             00162300
.*                                                                      00162400
                      AIF   ('&XINFOAREALEN'(1,1) NE '(').ZI11B         00162500
&ZCGPR   SETC  '0('.'&XINFOAREALEN'(2,K'&XINFOAREALEN-2).')'            00162600
                      AGO   .ZI11D                                      00162700
.ZI11B                ANOP  ,                                           00162800
.*                                                                      00162900
&ZC                   SETC  '&XINFOAREALEN'(1,1)                        00163000
                      AIF   (T'&ZC NE 'N').ZI11D                        00163100
&ZC                   SETC  '&XINFOAREALEN'                             00163200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00163300
&ZCGPR                SETC  '=FL4''&XINFOAREALEN'''                     00163400
.*                                                                      00163500
.ZI11D                ANOP  ,                                           00163600
.*                                                                      00163700
&ZOPN                 SETA  &ZOPN+1                                     00163800
&ZOPL(&ZOPN)          SETC  ' '                                         00163900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00164000
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00164100
&ZOPD(&ZOPN)          SETC  '++ &ZXINFOAREALEN XINFOAREALEN'            00164200
.*                                                                      00164300
.ZI11E                ANOP  ,                                           00164400
.*-------------------------------------------------------------------   00164500
&ZOPN1                SETA &ZOPN                                        00164600
.*******************************************************************    00164700
.***  PROCESS IOSSCM OUTPUT PARAMETERS                                  00164800
.*******************************************************************    00164900
                      ACTR  10000                                       00165000
.*------------------------------------------------------------------    00165100
.***AO.L02 XINFOAREALEN F                                               00165200
         AIF   ('&ZXINFOAREALEN' EQ 'OUTPUT').ZO11A  OUTPUT             00165300
         AIF   ('&ZXINFOAREALEN' NE 'INOUT').ZO11C  INOUT               00165400
.ZO11A    AIF   ('&XINFOAREALEN'(1,1) NE '(').ZO11B  ADDR IN GPR        00165500
&ZCGPR   SETC  '&XINFOAREALEN'(2,K'&XINFOAREALEN-2)                     00165600
&ZOPN                 SETA  &ZOPN+1                                     00165700
&ZOPL(&ZOPN)          SETC  ' '                                         00165800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00165900
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),16(1)'                         00166000
&ZOPD(&ZOPN)          SETC  '++ XINFOAREALEN F'                         00166100
                      AGO   .ZO11C                                      00166200
.*                                                                      00166300
.ZO11B                ANOP  ,                                           00166400
&ZAWRK   SETA  K'&XINFOAREALEN                                          00166500
         AIF   ('&XINFOAREALEN'(&ZAWRK,1) NE ')').ZO11G                 00166600
&ZN      SETA  2                                                        00166700
.ZO11H    ANOP                                                          00166800
         AIF   (&ZN GE &ZAWRK).ZO11G                                    00166900
         AIF   ('&XINFOAREALEN'(&ZN,1) NE '(').ZO11I                    00167000
&ZC      SETC  '&XINFOAREALEN'(1,&ZN).'4'.','                           00167100
&ZC      SETC  '&ZC'.'&XINFOAREALEN'(&ZN+1,&ZAWRK-&ZN).',16(1)'         00167200
         AGO   .ZO11J                                                   00167300
.ZO11I    ANOP                                                          00167400
&ZN      SETA  &ZN+1                                                    00167500
         AGO   .ZO11H                                                   00167600
.ZO11G    ANOP                                                          00167700
&ZC      SETC  '&XINFOAREALEN.(4),16(1)'                                00167800
.ZO11J    ANOP                                                          00167900
&ZOPN                 SETA  &ZOPN+1                                     00168000
&ZOPL(&ZOPN)          SETC  ' '                                         00168100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00168200
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00168300
&ZOPD(&ZOPN)          SETC  '++ XINFOAREALEN F'                         00168400
.ZO11C                ANOP  ,                                           00168500
.*******************************************************************    00168600
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00168700
.*******************************************************************    00168800
.ZMFLX                ANOP  ,              MF=L PROCESSING              00168900
.*******************************************************************    00169000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00169100
.*******************************************************************    00169200
                      ACTR  10000                                       00169300
.*                                                                      00169400
                      LCLA  &ZLC           COLUMN POSITION              00169500
                      LCLA  &ZOPX          LIST TABLE INDEX             00169600
                      LCLC  &ZLL           LABEL                        00169700
                      LCLC  &ZLOP          OPERATION                    00169800
                      LCLC  &ZLV           VALUE                        00169900
                      LCLC  &ZLD           DESCRIPTION                  00170000
.*                                                                      00170100
&ZOPX                 SETA  1                                           00170200
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00170300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00170400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00170500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00170600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00170700
                      AIF   (K'&ZLD LE 0).ZL5                           00170800
&ZLC                  SETA  35             COMMENT COLUMN               00170900
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00171000
&ZLC                  SETA  33             COMMMENT COLUMN              00171100
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00171200
&ZLV                  SETC  '&ZLV'.' '                                  00171300
                      AGO   .ZL3                                        00171400
.*                                                                      00171500
.ZL4                  ANOP  ,                                           00171600
&ZLV                  SETC  '&ZLV'.' '                                  00171700
.ZL5                  ANOP  ,                                           00171800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00171900
.*                                                                      00172000
&ZLL     &ZLOP &ZLV                                                     00172100
.*                                                                      00172200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00172300
                      AGO   .ZL2           CONTINUE LOOPING             00172400
.*                                                                      00172500
.ZLX                  ANOP  ,                                           00172600
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00172700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00172800
.*====================================================================  00172900
.* Macro Invocation - Generate Assembler code                           00173000
.*====================================================================  00173100
                                                                        00173200
.******************************************************************     00173300
.* Gets the address of the service routine address                *     00173400
.******************************************************************     00173500
.LNKCM1  ANOP                                                           00173600
         SYSSTATE TEST                                                  00173700
         AIF   ('&SYSAM64' NE 'YES').IOSCSM641                          00173800
         LLGT  15,16(0,0)                                               00173900
         AGO   .IOSCSM642                                               00174000
.IOSCSM641 ANOP                                                         00174100
         L     15,16(0,0)                                               00174200
         LLGTR 1,1                                                      00174300
.IOSCSM642 ANOP                                                         00174400
         L     15,124(15,0)                                             00174500
         L     15,208(15,0)                                             00174600
.*** Check the version of the IOVT ********************************     00174700
.*** Version must be 2 or higher for IOSVSCM address field to exist     00174800
         CLI   4(15),2                                                  00174900
         JL    CSMERR_&SYSNDX                                           00175000
.*** Check for a zero address for IOSVSCM *************************     00175100
         ICM   15,B'1111',464(15)                                       00175200
         JZ    CSMERR_&SYSNDX     ++ If 0, set return code              00175300
         LA    0,12               ++ SET IOSSCM FUNCTION CODE           00175400
         AIF    ('&XLINKAGE' NE 'BRANCH').LNKPC1                        00175500
.*** Branch Entry specific processing *****************************     00175600
         BASR  14,15              ++ CALL IOSSCM routine                00175700
         J     CSMEXIT_&SYSNDX    ++ Exit                               00175800
         AGO   .DONESCM                                                 00175900
.*                                                                      00176000
.LNKPC1  ANOP                                                           00176100
.*** System (PC) entry specific processing ************************     00176200
         L     14,16(0,0)         ++ GET CVT ADDRESS                    00176300
         L     14,772(14,0)       ++ GET SFT ADDRESS                    00176400
.*********************************************************************  00176500
.*  Get LX/EX for IOSSCM services  (IOSVUPCR unauthorized entry)     *  00176600
.*                                                                   *  00176700
.*  Note: LX/EX is calculated by multiplying the PC number (79)      *  00176800
.*        times the length of a PC/AUTH table entry (4) and          *  00176900
.*        then subtracting 4.                                        *  00177000
.*********************************************************************  00177100
         L     14,312(14,0)       ++ GET LX/EX FOR IOSSCM               00177200
         PC    0(14)              ++ PC TO IOSSCM ROUTINE               00177300
         J     CSMEXIT_&SYSNDX    ++ Exit                               00177400
         AGO   .DONESCM                                                 00177500
.*                                                                      00177600
.DONESCM ANOP                                                           00177700
.*** Error RC/RSN when IOSVSCM is not on the system ***************     00177800
CSMERR_&SYSNDX  LA    15,12       ++ SET ERROR RETURN CODE              00177900
         LA    0,2                ++ SET ERROR REASON CODE              00178000
CSMEXIT_&SYSNDX DS    0H                                                00178100
.*                                                                      00178200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00178300
.ZLINKX               ANOP  ,                                           00178400
.*******************************************************************    00178500
.***AP.X01  FORMAT GENERATED CODE                                       00178600
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00178700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00178800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00178900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00179000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00179100
                      AIF   (K'&ZLD LE 0).ZL51                          00179200
&ZLC                  SETA  35             COMMENT COLUMN               00179300
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00179400
&ZLC                  SETA  33             COMMENT COLUMN               00179500
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00179600
&ZLV                  SETC  '&ZLV'.' '                                  00179700
                      AGO   .ZL31                                       00179800
.*                                                                      00179900
.ZL41                 ANOP  ,                                           00180000
&ZLV                  SETC  '&ZLV'.' '                                  00180100
.ZL51                 ANOP  ,                                           00180200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00180300
.*                                                                      00180400
&ZLL     &ZLOP &ZLV                                                     00180500
.*                                                                      00180600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00180700
                      AGO   .ZL21          CONTINUE LOOPING             00180800
.*                                                                      00180900
.ZLX1                 ANOP  ,                                           00181000
.*******************************************************************    00181100
.***AP.X02  END OF IOSSCM MACRO                                         00181200
&ZIOSSCM              SETC  'YES'          SET IOSSCM USED              00181300
         POP   PRINT                                                    00181400
*                                            IOSSCM-1                   00181500
         SPACE 1                                                        00181600
.ZLX2                 ANOP  ,                                           00181700
         MEND                                                           00181800
**********************************************************************/ 00181900
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00182000
*%IOSSCM: MACRO KEYS(CONFIGINFO,INFOAREA,INFOAREALEN,OUTVERSION,        00182100
*                 DEVINFO,LINKAGE,RETCODE,RSNCODE,PLISTVER,MF);         00182200
*  ANS('?'!!MACLABEL!!' '!!'IOSSCMP '!!MACLIST!!                        00182300
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00182400
*%END IOSSCM;                                                           00182500

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWM4MSTR                              -01/31/13-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Indicate the start of a work unit             * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2013                               * 00001200
*                                                                     * 00001300
* STATUS= HBB7790                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The purpose of this service is to indicate that a work unit is * 00002100
*      beginning execution. The work unit runs under the specified    * 00002200
*      monitoring environment, but is reported to EWLM completely     * 00002300
*      independent from a potentially running transaction on the same * 00002400
*      monitoring environment that is defined by IWM4MINI and         * 00002500
*      IWM4RPT/IWM4MNTF calls. You can use the set of services        * 00002600
*      IWM4MSTR, IWM4MSTO, IWM4MUPD to provide data for "mini work    * 00002700
*      units" running within a long-running transaction.              * 00002800
*      In addition a work unit started by IWM4MSTR can participate in * 00002900
*      asynchronous and synchronous work unit flows.                  * 00003000
*                                                                     * 00003100
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00003200
*                                                                     * 00003300
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003400
*                                                                     * 00003500
*01* ENVIRONMENT:                                                     * 00003600
*                                                                     * 00003700
*                                                                     * 00003800
*      Dispatchable unit mode: Task or SRB mode.                      * 00003900
*                                                                     * 00004000
*      Minimum authorization: Supervisor state or program key mask    * 00004100
*                        (PKM) allowing keys 0-7.                     * 00004200
*                                                                     * 00004300
*      AMODE:            31- or 64-bit.  If in 64-Bit addressing      * 00004400
*                        mode, code SYSSTATE AMODE64=YES before       * 00004500
*                        invoking this macro.                         * 00004600
*                                                                     * 00004700
*      ASC mode:         Primary.                                     * 00004800
*                                                                     * 00004900
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00005000
*                                                                     * 00005100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00005200
*                                                                     * 00005300
*      Locks:            No restriction.                              * 00005400
*                                                                     * 00005500
*      Control parameters: Control parameters must be in the primary  * 00005600
*                        address space.                               * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*01* PROGRAMMING REQUIREMENTS:                                        * 00006100
*                                                                     * 00006200
*                                                                     * 00006300
*    1.  The macro CVT must be included to use this macro.            * 00006400
*                                                                     * 00006500
*    2.  The macro IWMYCON must be included to use this macro.        * 00006600
*                                                                     * 00006700
*    3.  The macro IWMPB must be in the library concatenation, since  * 00006800
*        it is included by IWMYCON.                                   * 00006900
*                                                                     * 00007000
*    4.  Note that the high order halfword of bits 0-31 of register   * 00007100
*        0, and the reason code variable when specified, may be       * 00007200
*        non-zero and represents diagnostic data which is NOT part of * 00007300
*        the external interface.  The high order halfword should thus * 00007400
*        be excluded from comparison with the reason code values      * 00007500
*        described above.  The constant, IWMRSNCODE_MASK_CONST        * 00007600
*        defined in IWMYCON, may be used for this purpose.            * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*01* RESTRICTIONS:                                                    * 00008100
*                                                                     * 00008200
*                                                                     * 00008300
*    1.  This macro may not be used prior to the completion of WLM    * 00008400
*        address space initialization                                 * 00008500
*                                                                     * 00008600
*    2.  The caller must have issued the IWM4MCRE macro successfully  * 00008700
*        and the created delay monitoring environment must be enabled * 00008800
*        for EWLM support.  This means the delay monitoring           * 00008900
*        environment must be created by one of the following ways:    * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*        o   IWM4CONN EWLM=YES ...  and IWM4MCRE SUBSYSP=CONNECT ...  * 00009300
*            OR                                                       * 00009400
*                                                                     * 00009500
*        o   IWM4MCRE SUBSYSP=VALUE EWLM=YES ...                      * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*    3.  The caller is responsible for error recovery.                * 00010000
*                                                                     * 00010100
*    4.  The current PSW key must be 0 or match the key specified on  * 00010200
*        IWM4MCRE provided the latter is a system key (0-7).          * 00010300
*                                                                     * 00010400
*    5.  The caller must serialize to prevent any delay monitoring    * 00010500
*        services from being invoked concurrently for the environment * 00010600
*        represented by the monitoring token.                         * 00010700
*                                                                     * 00010800
*    6.  This macro may only be used on z/OS V2R1 or higher.          * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*                                                                     * 00011200
*01* INPUT REGISTER INFORMATION:                                      * 00011300
*                                                                     * 00011400
*    Before issuing the IWM4MSTR macro, the caller does not have to   * 00011500
*    place any information into any register unless using it in       * 00011600
*    register notation for a particular parameter, or using it as a   * 00011700
*    base register.                                                   * 00011800
*                                                                     * 00011900
*    The following general purpose registers (GPRs) have to contain   * 00012000
*    the specified information:                                       * 00012100
*                                                                     * 00012200
*                                                                     * 00012300
*    REGISTER  CONTENTS                                               * 00012400
*                                                                     * 00012500
*    13        The address of a 216-byte standard save area in the    * 00012600
*              primary address space.                                 * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*01* OUTPUT REGISTER INFORMATION:                                     * 00013100
*                                                                     * 00013200
*    When control returns to the caller, the GPRs contain:            * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*    REGISTER  CONTENTS                                               * 00013600
*                                                                     * 00013700
*    0         Reason code if the return code in GPR 15 is not 0,     * 00013800
*              otherwise, used as a work register by the system. The  * 00013900
*              reason code is stored in bits 0-31                     * 00014000
*                                                                     * 00014100
*    1         Used as work register by the system                    * 00014200
*                                                                     * 00014300
*    2-13      Unchanged                                              * 00014400
*                                                                     * 00014500
*    14        Used as work register by the system                    * 00014600
*                                                                     * 00014700
*    15        Return Code stored in bits 0-31                        * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*    When control returns to the caller, the ARs contain:             * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*    REGISTER  CONTENTS                                               * 00015500
*                                                                     * 00015600
*    0-1       Used as work registers by the system                   * 00015700
*                                                                     * 00015800
*    2-13      Unchanged                                              * 00015900
*                                                                     * 00016000
*    14-15     Used as work registers by the system.                  * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*    Some callers depend on register contents remaining the same      * 00016500
*    before and after issuing a service.  If the system changes the   * 00016600
*    contents of registers on which the caller depends, the caller    * 00016700
*    must save them before issuing the service, and restore them      * 00016800
*    after the system returns control.                                * 00016900
*                                                                     * 00017000
*01* PERFORMANCE IMPLICATIONS:                                        * 00017100
*                                                                     * 00017200
*    None                                                             * 00017300
*                                                                     * 00017400
*01* SYNTAX:                                                          * 00017500
*                                                                     * 00017600
*Ýxlabel¨  IWM4MSTR  Ð  MONTKN=xmontkn                                * 00017700
*                    ¿ ,MONTKN64=xmontkn64                            * 00017800
*                     Ý,END_FLOW=»NO!YESº¨                            * 00017900
*                     Ý,MSG_RECEIVED=»NO!YESº¨                        * 00018000
*                     Ý,EWLM=»NOº¨                                    * 00018100
*                     Ý,ARRIVALTIME=»xarrivaltime!NO_ARRIVALTIMEº¨    * 00018200
*                    Ð ,EWLM_S_PACORR=xewlm_s_pacorr                  * 00018300
*                    ¿ ,EWLM_S_CURCORR=xewlm_s_curcorr                * 00018400
*                         Ý,EWLM_RCVD_CORR                            * 00018500
*                                          =»xewlm_rcvd_corr!NO_EWLM_ * 00018600
*                                          RCVD_CORRº¨                * 00018700
*                     Ý,RETCODE=xretcode¨                             * 00018800
*                     Ý,RSNCODE=xrsncode¨                             * 00018900
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00019000
*                    ÐÝ,MF=S¨                                         * 00019100
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00019200
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*      Where:                                                         * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*      Ýxlabel¨                                                       * 00019900
*          is an optional symbol, starting in column 1, that is the   * 00020000
*          name on the IWM4MSTR macro invocation.  The name must      * 00020100
*          conform to the rules for an ordinary assembler language    * 00020200
*          symbol.                                                    * 00020300
*          DEFAULT: No name.                                          * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*      The following is a set of mutually exclusive keys.  This set   * 00020900
*      is required; only one key must be specified.                   * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*      MONTKN=xmontkn                                                 * 00021300
*          belongs to a set of mutually exclusive keys. It is the     * 00021400
*          name (RS-type), or address in register (2)-(12), of a 32   * 00021500
*          bit input which contains the delay monitoring token.       * 00021600
*                                                                     * 00021700
*      MONTKN64=xmontkn64                                             * 00021800
*          belongs to a set of mutually exclusive keys. It is the     * 00021900
*          name (RS-type), or address in register (2)-(12), of a 64   * 00022000
*          bit input which contains the long delay monitoring token.  * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*      End of a set of mutually exclusive required keys.              * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*      ÝEND_FLOW=»NO!YESº¨                                            * 00022900
*          is an optional keyword input which indicates the           * 00023000
*          completion of a message flow.                              * 00023100
*          DEFAULT: NO                                                * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*          END_FLOW=NO                                                * 00023500
*                                                                     * 00023600
*              indicates that a message flow has not completed.       * 00023700
*                                                                     * 00023800
*          END_FLOW=YES                                               * 00023900
*                                                                     * 00024000
*              indicates that a message flow has completed.  Specify  * 00024100
*              END_FLOW=YES, if you know that this work unit is the   * 00024200
*              last one in a work unit flow. This indication can not  * 00024300
*              be cleared, if it has been set.                        * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*                                                                     * 00025000
*      ÝMSG_RECEIVED=»NO!YESº¨                                        * 00025100
*          is an optional keyword input which indicates whether this  * 00025200
*          work unit has been started as a result of a receipt of a   * 00025300
*          message.                                                   * 00025400
*          DEFAULT: NO                                                * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*          MSG_RECEIVED=NO                                            * 00025800
*                                                                     * 00025900
*              indicates that this work unit has not been started by  * 00026000
*              receipt of a message.                                  * 00026100
*                                                                     * 00026200
*          MSG_RECEIVED=YES                                           * 00026300
*                                                                     * 00026400
*              indicates that this work unit has been started as a    * 00026500
*              result of a receipt of a message.                      * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*      ÝEWLM=»NOº¨                                                    * 00027300
*          is an optional keyword input which indicates if this work  * 00027400
*          manager intents to participate in cross platform           * 00027500
*          Enterprise Workload Management (eWLM).                     * 00027600
*          DEFAULT: NO                                                * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*          EWLM=NO                                                    * 00028000
*              The work manager interacts only with WLM and no        * 00028100
*              interaction with eWLM takes place.                     * 00028200
*              DEFAULT: NO                                            * 00028300
*                                                                     * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*      ÝARRIVALTIME=»xarrivaltime!NO_ARRIVALTIMEº¨                    * 00029000
*          is the name (RS-type), or address in register (2)-(12), of * 00029100
*          an optional 8 character input which contains a timestamp   * 00029200
*          in STCK format.  This timestamp is subtracted from the     * 00029300
*          current timestamp and assigned as queued time to the work  * 00029400
*          unit.                                                      * 00029500
*          For example, you may use this parameter, if the work unit  * 00029600
*          is started by receipt of a message from a queue and you    * 00029700
*          know the put time (the timestamp when the message has been * 00029800
*          put onto the queue).                                       * 00029900
*                                                                     * 00030000
*          DEFAULT: NO_ARRIVALTIME indicates that parameter           * 00030100
*          ARRIVALTIME has not been specified.                        * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*      The following is a set of mutually exclusive keys.  This set   * 00030700
*      is required; only one key must be specified.                   * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*      EWLM_S_PACORR=xewlm_s_pacorr                                   * 00031100
*          belongs to a set of mutually exclusive keys. It is the     * 00031200
*          name (RS-type), or address in register (2)-(12), of a      * 00031300
*          character input which contains a cross platform Enterprise * 00031400
*          Workload Management (EWLM) parent correlator received from * 00031500
*          another application.                                       * 00031600
*                                                                     * 00031700
*      EWLM_S_CURCORR=xewlm_s_curcorr                                 * 00031800
*          belongs to a set of mutually exclusive keys. It is the     * 00031900
*          name (RS-type), or address in register (2)-(12), of a      * 00032000
*          character input which contains a cross platform Enterprise * 00032100
*          Workload Management (EWLM) correlator for the current      * 00032200
*          application.                                               * 00032300
*          The correlator passed to this parameter is used as the     * 00032400
*          current correlator of this work unit. It has usually been  * 00032500
*          created by means of a previous IWM4CLFY call with the      * 00032600
*          EWLM_CHCORR parameter (see below).                         * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*          ÝEWLM_RCVD_CORR=»xewlm_rcvd_corr!NO_EWLM_RCVD_CORRº¨       * 00033100
*              is the name (RS-type), or address in register          * 00033200
*              (2)-(12), of an optional character input which         * 00033300
*              contains a cross platform Enterprise Workload          * 00033400
*              Management (EWLM) correlator received from another     * 00033500
*              application.                                           * 00033600
*              Normally this is a received correlator which has the   * 00033700
*              independent flag and the asynchronous flag set. It     * 00033800
*              should not be passed to the EWLM_S_PACORR or the       * 00033900
*              EWLM_S_CURCORR parameter. If you pass this correlator  * 00034000
*              to one of them then the started work unit is not       * 00034100
*              reclassified and runs under the classification of this * 00034200
*              correlator. When you receive a correlator with the     * 00034300
*              independent flag set then you should:                  * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*              1.  Reclassify the work unit by issuing IWM4CLFY       * 00034700
*                  EWLM_CORR=r_corr EWLM_CHCORR=c_corr. r_corr is the * 00034800
*                  received correlator and c_corr is the correlator   * 00034900
*                  created by IWM4CLFY.                               * 00035000
*                                                                     * 00035100
*              2.  Start the work unit by issuing IWM4MSTR            * 00035200
*                  EWLM_S_CURCORR=c_corr EWLM_RCVD_CORR=r_corr .      * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*              DEFAULT: NO_EWLM_RCVD_CORR                             * 00035600
*              indicates that parameter EWLM_RCVD_CORR has not been   * 00035700
*              specified.                                             * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*      End of a set of mutually exclusive required keys.              * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                                                                     * 00036700
*      ÝRETCODE=xretcode¨                                             * 00036800
*          is the name (RS-type) of an optional fullword output       * 00036900
*          variable, or register (2)-(12) or (15), into which the     * 00037000
*          return code is to be copied from GPR 15.  If you specify   * 00037100
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00037200
*          the value will be left in GPR 15.                          * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*      ÝRSNCODE=xrsncode¨                                             * 00037800
*          is the name (RS-type) of an optional fullword output       * 00037900
*          variable into which the reason code is to be copied from   * 00038000
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00038100
*          R0 (within or without parentheses), the value will be left * 00038200
*          in GPR 0.                                                  * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00038800
*          is an optional byte input decimal value in the "0-0" range * 00038900
*          that specifies the macro version.  PLISTVER is the only    * 00039000
*          key allowed on the list form of MF and determines which    * 00039100
*          parameter list is generated.  Note that MAX may be         * 00039200
*          specified instead of a number, and the parameter list will * 00039300
*          be of the largest size currently supported. This size may  * 00039400
*          grow from release to release (thus possibly affecting the  * 00039500
*          amount of storage needed by your program).  If your        * 00039600
*          program can tolerate this, IBM recommends that you always  * 00039700
*          specify MAX when creating the list form parameter list as  * 00039800
*          that will ensure that the list form parameter list is      * 00039900
*          always long enough to hold whatever parameters might be    * 00040000
*          specified on the execute form.                             * 00040100
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00040200
*          default is the lowest version which allows all of the      * 00040300
*          parameters specified on the invocation to be processed.    * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*      ÝMF=»S!L!Eº¨                                                   * 00040900
*          is an optional keyword input which specifies the macro     * 00041000
*          form.                                                      * 00041100
*          DEFAULT: S                                                 * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*          ÝMF=S¨                                                     * 00041500
*              specifies the standard form of the macro.  The "S"     * 00041600
*              form generates code to put the parameters into an      * 00041700
*              in-line parameter list and invoke the desired service. * 00041800
*              Full checking for required macro keys is done along    * 00041900
*              with supplying defaults for omitted optional           * 00042000
*              parameters.                                            * 00042100
*                                                                     * 00042200
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00042300
*              specifies the list form of the macro.  The "L" form    * 00042400
*              defines an area to be used for the parameter list.     * 00042500
*              Only the PLISTVER key may be specified on the          * 00042600
*              invocation.  All other macro parameters are flagged as * 00042700
*              errors.  If PLISTVER is not specified, the original    * 00042800
*              parameter list definition is used.                     * 00042900
*                                                                     * 00043000
*            ,xmfctrl                                                 * 00043100
*              is a required input.  It is the name of a storage area * 00043200
*              for the parameter list.                                * 00043300
*                                                                     * 00043400
*            »,xmfattr!0Dº                                            * 00043500
*              is an optional 60 character input string that varies   * 00043600
*              from 1 to 60 characters. Use it to force boundary      * 00043700
*              alignment of the parameter list. Use only 0F or 0D.    * 00043800
*              DEFAULT: 0D which forces the parameter list to a       * 00043900
*              doubleword boundary.                                   * 00044000
*                                                                     * 00044100
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00044200
*              specifies the execute form of the macro.  The "E" form * 00044300
*              generates code to put the parameters into the          * 00044400
*              parameter list specified by xmfctrl and provides full  * 00044500
*              syntax checking with default setting.                  * 00044600
*                                                                     * 00044700
*            ,xmfctrl                                                 * 00044800
*              is a required input.  It is the name (RS-type), or     * 00044900
*              address in register (1)-(12), of a storage area for    * 00045000
*              the parameter list.                                    * 00045100
*                                                                     * 00045200
*            »,COMPLETEº                                              * 00045300
*              is an optional keyword input which specifies the       * 00045400
*              degree of macro parameter syntax checking.             * 00045500
*              DEFAULT: COMPLETE                                      * 00045600
*                                                                     * 00045700
*                                                                     * 00045800
*              COMPLETE                                               * 00045900
*                  Checking for required macro keys is done and       * 00046000
*                  defaults are supplied for omitted optional         * 00046100
*                  parameters.                                        * 00046200
*                                                                     * 00046300
*                                                                     * 00046400
*                                                                     * 00046500
*                                                                     * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*01* ABEND CODES:  None.                                              * 00047000
*                                                                     * 00047100
*01* RETURN CODES:                                                    * 00047200
*                                                                     * 00047300
*                                                                     * 00047400
*            0    Name: IwmRetCodeOk                                  * 00047500
*                                                                     * 00047600
*                 Meaning: Successful completion.                     * 00047700
*                                                                     * 00047800
*                 Action: None required.                              * 00047900
*                                                                     * 00048000
*            4    Name: IwmRetCodeWarning                             * 00048100
*                                                                     * 00048200
*                 Meaning: Successful completion, unusual conditions  * 00048300
*                 noted.                                              * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*                 HEX REASON  MEANING/ACTION                          * 00048700
*                 CODE                                                * 00048800
*                                                                     * 00048900
*                 xxxx0402    Name: IwmRsnCodeNoMonEnv                * 00049000
*                                                                     * 00049100
*                             Meaning:  The input monitoring token    * 00049200
*                             indicates no monitoring environment was * 00049300
*                             established.                            * 00049400
*                                                                     * 00049500
*                             Action: Establish a monitoring          * 00049600
*                             environment by macro IWM4MCRE.          * 00049700
*                                                                     * 00049800
*                 xxxx0442    Name: IwmRsnCodeCorrelatorUnknown       * 00049900
*                                                                     * 00050000
*                             Meaning:  A unknown correlator has been * 00050100
*                             passed to the EWLM_RCVD_CORR parameter. * 00050200
*                             It is ignored.                          * 00050300
*                                                                     * 00050400
*                             Action: None required.                  * 00050500
*                                                                     * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*            8    Name: IwmRetCodeInvocError                          * 00050900
*                                                                     * 00051000
*                 Meaning: Invalid invocation environment or          * 00051100
*                 parameters.                                         * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                 HEX REASON  MEANING/ACTION                          * 00051500
*                 CODE                                                * 00051600
*                                                                     * 00051700
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00051800
*                                                                     * 00051900
*                             Meaning:  Input monitoring environment  * 00052000
*                             does not pass short form validity       * 00052100
*                             checking.                               * 00052200
*                                                                     * 00052300
*                             Action: Check for possible storage      * 00052400
*                             overlay.                                * 00052500
*                                                                     * 00052600
*                 xxxx0894    Name: IwmRsnCodeInvalidEwlmCorr         * 00052700
*                                                                     * 00052800
*                             Meaning:  An unknown EWLM correlator    * 00052900
*                             has been passed to the EWLM_S_PACORR or * 00053000
*                             EWLM_S_CURCORR parameter.               * 00053100
*                                                                     * 00053200
*                             Action: Specify a supported correlator. * 00053300
*                             You can create a supported correlator   * 00053400
*                             by macro IWM4CLFY.                      * 00053500
*                                                                     * 00053600
*                 xxxx0895    Name: IwmRsnCodeEWLMServNotEnabled      * 00053700
*                                                                     * 00053800
*                             Meaning:  The EWLM service was not      * 00053900
*                             enabled for a delay monitoring          * 00054000
*                             environment.                            * 00054100
*                                                                     * 00054200
*                             Action: Create a monitoring environment * 00054300
*                             with EWLM=YES (either on macro IWM4CON  * 00054400
*                             or macro IWM4MCRE).                     * 00054500
*                                                                     * 00054600
*                 xxxx08AD    Name: IwmRsnCodeAlreadyActive           * 00054700
*                                                                     * 00054800
*                             Meaning:  A work unit started by        * 00054900
*                             IWM4MSTR is already active.             * 00055000
*                                                                     * 00055100
*                             Action: Stop the active work unit by    * 00055200
*                             macro IWM4MSTO before creating a new    * 00055300
*                             one.                                    * 00055400
*                                                                     * 00055500
*                 xxxx08AF    Name: IwmRsnCodeArrTimeGTStartTime      * 00055600
*                                                                     * 00055700
*                             Meaning:  The arrivaltime passed is     * 00055800
*                             greater than the current timestamp.     * 00055900
*                                                                     * 00056000
*                             Action: Check the format of the passed  * 00056100
*                             arrivaltime.                            * 00056200
*                                                                     * 00056300
*                                                                     * 00056400
*                                                                     * 00056500
*                                                                     * 00056600
*                                                                     * 00056700
*01* REASON CODES:                                                    * 00056800
*                                                                     * 00056900
*       A reason code will be returned whenever the return code is    * 00057000
*       non-zero.  Reason codes, as appropriate, are defined under    * 00057100
*       their corresponding return code.  Reason code and return code * 00057200
*       constants are defined within IWMYCON.  Note that the high     * 00057300
*       order halfword of bits 0-31 of register 0, and the reason     * 00057400
*       code variable when specified, may be non-zero and represents  * 00057500
*       diagnostic data which is NOT part of the external interface.  * 00057600
*       The high order halfword should thus be excluded from          * 00057700
*       comparison with the reason code values described above.  The  * 00057800
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00057900
*       used for this purpose.                                        * 00058000
*                                                                     * 00058100
*01* MODULE TYPE:  ASSEM MACRO                                        * 00058200
*                                                                     * 00058300
*02*   PROCESSOR:  ASSEM                                              * 00058400
*                                                                     * 00058500
*01* COMPONENT:  SCWLM                                                * 00058600
*                                                                     * 00058700
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00058800
*                                                                     * 00058900
*01* EXAMPLES:                                                        * 00059000
*                                                                     * 00059100
*01* MACRO USAGE NOTES:                                               * 00059200
*                                                                     * 00059300
*                                                                     * 00059400
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00059500
*        global macro variable.  Any value other than 'NO' will       * 00059600
*        result in the macro expansion being printed.  The default is * 00059700
*        'YES'.  The following examples illustrate how the ZPRINT     * 00059800
*        variable should be set.                                      * 00059900
*                                                                     * 00060000
*                    GBLC &ZPRINT                                     * 00060100
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00060200
*                                                                     * 00060300
*                                                                     * 00060400
*    2.  All   keys   currently   contained  in  the  IWM4MSTR  macro * 00060500
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00060600
*        value of 0 or MAX.                                           * 00060700
*                                                                     * 00060800
*                                                                     * 00060900
*                                                                     * 00061000
*                                                                     * 00061100
*01* CHANGE ACTIVITY:                                                 * 00061200
*                                                                     * 00061300
*   Flag LineItem  FMID    Date   ID    Comment                       * 00061400
*                                                                     * 00061500
*    $L0=LPBABV   HBB7790 121023 3241AH:  Initial version PB above 2G * 00061600
*    $P0=ME24923  HBB7790 121016 3241AH:  Fix SYSAM64 logic           * 00061700
*    $P1=ME25540  HBB7790 130122 3241DW:  Literal not accessible in   * 00061800
*                                         AMODE 64                    * 00061900
****** END OF SPECIFICATIONS *****************************************/ 00062000
*/********************************************************************* 00062100
         MACRO                                                          00062200
&XLABEL  IWM4MSTR &MONTKN=,&MONTKN64=,&END_FLOW=,&MSG_RECEIVED=,&EWLM=,*00062300
               &ARRIVALTIME=,&EWLM_S_PACORR=,&EWLM_S_CURCORR=,         *00062400
               &EWLM_RCVD_CORR=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=     00062500
.*                                                                      00062600
*                    MACDATE -01/31/13-<0>                              00062700
.*                                                                      00062800
.*******************************************************************    00062900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00063000
.*******************************************************************    00063100
                    GBLC  &ZPRINT     YES=PRINT NO=NO PRINT             00063200
                    GBLC  &ZTEST      YES=TEST NO=NO TEST               00063300
                    GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX       00063400
.*                                                                      00063500
                    GBLC  &ZIWM4MSTR  YES=MACRO USED AT LEAST ONCE      00063600
.*******************************************************************    00063700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00063800
.*******************************************************************    00063900
                    LCLC  &ZMS        ERROR MESSAGE WORK AREA           00064000
                    LCLC  &ZCNDX      SYSNDX CHARACTERS                 00064100
                    LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED        00064200
                    LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR       00064300
                    LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE       00064400
                    LCLA  &ZAWRK      USED AS A WORK AREA               00064500
                    LCLA  &ZASIZ      USED FOR SIZE OF VALUE            00064600
                    LCLA  &ZN         NUMERIC WORK VARIABLE             00064700
                    LCLC  &ZC         CHARACTER WORK VARIABLE           00064800
                    LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE       00064900
                    LCLA  &ZTLA       VALUE TOO LONG VARIABLE           00065000
                    LCLC  &ZMAC_G     "G" or null                       00065100
&ZMAC_G             SETC  ''                                            00065200
                    LCLC  &ZMAC_LR                                      00065300
&ZMAC_LR            SETC  'LR'                                          00065400
                    LCLC  &ZMAC_L                                       00065500
&ZMAC_L             SETC  'L'                                           00065600
                    LCLC  &ZMAC_ST                                      00065700
&ZMAC_ST            SETC  'ST'                                          00065800
                    LCLC  &ZMAC_LLGT                                    00065900
&ZMAC_LLGT          SETC  'L'                                           00066000
                    LCLC  &ZMAC_LGR                                     00066100
&ZMAC_LGR           SETC  'LR'                                          00066200
                    LCLC  &ZMAC_LG                                      00066300
&ZMAC_LG            SETC  'L'                                           00066400
                    LCLC  &ZMAC_STG                                     00066500
&ZMAC_STG           SETC  'ST'                                          00066600
                    LCLA  &ZMACRET    MACRO RETURN CODE                 00066700
&ZMACRET            SETA  0           ASSUME NO ERRORS                  00066800
.*                                                                      00066900
                    LCLC  &ZCSYSLIST(255)       NONXKEY, POS ARRAY      00067000
                    LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()        00067100
                    LCLA  &ZPLLEN     PARAMETER LIST LENGTH             00067200
                    LCLC  &ZENDBASEPL           End of base PL          00067300
                    LCLA  &ZPLWORKA   PARAMETER LIST LENGTH             00067400
.*******************************************************************    00067500
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00067600
.*******************************************************************    00067700
                    LCLA  &ZI         INDEX FOR ARRAY                   00067800
                    LCLA  &ZJ         INDEX FOR PARMS                   00067900
                    LCLA  &ZK         INDEX FOR PARSE                   00068000
                    LCLA  &ZLO        LOW RANGE VALUE                   00068100
                    LCLA  &ZHI        HIGH RANGE VALUE                  00068200
                    LCLC  &ZW         WORK AREA FOR PARM                00068300
.********************************************************************   00068400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00068500
.********************************************************************   00068600
                    GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL           00068700
                    GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE    00068800
                    GBLA  &SYSALVL    SYSSTATE ARCHLVL                  00068900
                    GBLC  &SYSAM64    SYSSTATE AMODE64                  00069000
.*                                                                      00069100
                    AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED    00069200
                    AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED     00069300
                    SPLEVEL  TEST                                       00069400
.ZSYS2              ANOP  ,                                             00069500
                    AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1         00069600
                    AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1         00069700
                    SYSSTATE TEST                                       00069800
                    AGO   .ZSYS4                                        00069900
.ZSYS3              ANOP  ,                                             00070000
&SYSASCE            SETC  'P'         ASSUME SYSSTATE PRIMARY           00070100
.ZSYS4              ANOP  ,                                             00070200
                    AIF   ('&SYSAM64' NE 'YES').ZSYSN64                 00070300
&ZMAC_LLGT          SETC 'LLGT'                                         00070400
&ZMAC_LGR           SETC 'LGR'                                          00070500
&ZMAC_LG            SETC 'LG'                                           00070600
&ZMAC_STG           SETC 'STG'                                          00070700
.ZSYSN64            ANOP  ,                                             00070800
&ZMAC_G             SETC 'G'                                            00070900
&ZMAC_LR            SETC 'LGR'                                          00071000
&ZMAC_L             SETC 'LG'                                           00071100
&ZMAC_ST            SETC 'STG'                                          00071200
.*******************************************************************    00071300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00071400
.*******************************************************************    00071500
                    LCLC  &XUSEDMONTKNKEY       ++ NAME                 00071600
                    LCLC  &XMONTKN    ++ NAME                           00071700
                    LCLC  &XMONTKN64  ++ NAME                           00071800
                    LCLC  &XEND_FLOW  ++ VALUE                          00071900
                    LCLC  &XMSG_RECEIVED        ++ VALUE                00072000
                    LCLC  &XEWLM      ++ VALUE                          00072100
                    LCLC  &XARRIVALTIME         ++ NAME                 00072200
                    LCLC  &XUSEDEWLMS           ++ NAME                 00072300
                    LCLC  &XEWLM_S_PACORR       ++ NAME                 00072400
                    LCLC  &XEWLM_S_CURCORR      ++ NAME                 00072500
                    LCLC  &XEWLM_RCVD_CORR      ++ NAME                 00072600
                    LCLC  &XRETCODE   ++ NAME                           00072700
                    LCLC  &XRSNCODE   ++ NAME                           00072800
                    LCLA  &XPLISTVER  ++ VALUE                          00072900
                    LCLC  &XMF        ++ VALUE                          00073000
                    LCLC  &XMFCTRL    ++ NAME                           00073100
                    LCLC  &XMFATTR    ++ VALUE                          00073200
                    LCLC  &XMFSCK     ++ VALUE                          00073300
.*******************************************************************    00073400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00073500
.*******************************************************************    00073600
                    LCLC  &ZXUSEDMONTKNKEY      ++ INPUT NAME           00073700
                    LCLC  &ZXMONTKN   ++ INPUT NAME                     00073800
                    LCLC  &ZXMONTKN64           ++ INPUT NAME           00073900
                    LCLC  &ZXEND_FLOW           ++ INPUT VALUE          00074000
                    LCLC  &ZXMSG_RECEIVED       ++ INPUT VALUE          00074100
                    LCLC  &ZXEWLM     ++ INPUT VALUE                    00074200
                    LCLC  &ZXARRIVALTIME        ++ INPUT NAME           00074300
                    LCLC  &ZXUSEDEWLMS          ++ INPUT NAME           00074400
                    LCLC  &ZXEWLM_S_PACORR      ++ INPUT NAME           00074500
                    LCLC  &ZXEWLM_S_CURCORR     ++ INPUT NAME           00074600
                    LCLC  &ZXEWLM_RCVD_CORR     ++ INPUT NAME           00074700
                    LCLC  &ZXRETCODE  ++ OUTPUT NAME                    00074800
                    LCLC  &ZXRSNCODE  ++ OUTPUT NAME                    00074900
                    LCLC  &ZXPLISTVER           ++ INPUT VALUE          00075000
                    LCLC  &ZXMF       ++ INPUT VALUE                    00075100
                    LCLC  &ZXMFCTRL   ++ INPUT NAME                     00075200
                    LCLC  &ZXMFATTR   ++ INPUT VALUE                    00075300
                    LCLC  &ZXMFSCK    ++ INPUT VALUE                    00075400
.********************************************************************   00075500
.***AC.PLV01  PROCESS PLISTVER                                      *   00075600
.********************************************************************   00075700
&XPLISTVER      SETA  0                                                 00075800
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00075900
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00076000
&XPLISTVER      SETA  0                                                 00076100
.ZPLV0          ANOP  ,                                                 00076200
.*                                                                      00076300
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00076400
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00076500
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00076600
.*-------------------------------------------------------------------   00076700
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00076800
&ZMS            SETC  '"PLISTVER='                                      00076900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00077000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00077100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00077200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00077300
                AGO   .ZPVCK2                                           00077400
.ZPVCK3         ANOP  ,                                                 00077500
.*-------------------------------------------------------------------   00077600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00077700
&ZMS            SETC  '"PLISTVER='                                      00077800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00077900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00078000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00078100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00078200
                AGO   .ZPVCKE                                           00078300
.ZPVCK2         ANOP  ,                                                 00078400
.*-------------------------------------------------------------------   00078500
&ZCVAL          SETC  '&PLISTVER(1)'                                    00078600
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00078700
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00078800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00078900
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00079000
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00079100
.ZPVCK6         ANOP  ,                                                 00079200
&ZMS            SETC  '"PLISTVER='                                      00079300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00079400
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00079500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00079600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00079700
&XPLISTVER      SETA  0                                                 00079800
                AGO   .ZPVCKE                                           00079900
.*-------------------------------------------------------------------   00080000
.ZPVCK4A        ANOP  ,                                                 00080100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00080200
&ZMS            SETC  'PLISTVER='                                       00080300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00080400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00080500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00080600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00080700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00080800
                AGO   .ZPVCK5                                           00080900
.ZPVCK4         ANOP  ,                                                 00081000
&XPLISTVER      SETA  &PLISTVER(1)                                      00081100
.ZPVCK5         ANOP  ,                                                 00081200
.ZPVCKE         ANOP  ,                                                 00081300
.********************************************************************   00081400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00081500
.********************************************************************   00081600
                    ACTR  10000                                         00081700
.*------------------------------------------------------------------    00081800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00081900
&XMF                SETC  ''          INITIALIZE XVARIABLE              00082000
.*-------------------------------------------------------------------   00082100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00082200
.ZG40               ANOP  ,                                             00082300
&ZTLC               SETC 'S'                                            00082400
                    AIF   ('&MF(1)' NE '&ZTLC').ZG41                    00082500
&XMF                SETC  'S'         SET KEYWORD                       00082600
                    AIF   (N'&MF LE 1).ZG40A    CK NUM                  00082700
&ZMS                SETC  '"MF='                                        00082800
&ZMS                SETC  '&ZMS.&MF"'                                   00082900
&ZMS                SETC  '&ZMS "MF"'                                   00083000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00083100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00083200
.ZG40A              ANOP  ,                                             00083300
.*-------------------------------------------------------------------   00083400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00083500
.ZG41               ANOP  ,                                             00083600
&ZTLC               SETC 'L'                                            00083700
                    AIF   ('&MF(1)' NE '&ZTLC').ZG48                    00083800
&XMF                SETC  'L'         SET KEYWORD                       00083900
                    AIF   (N'&MF LE 3).ZG41A    CK NUM                  00084000
&ZMS                SETC  '"MF='                                        00084100
&ZMS                SETC  '&ZMS.&MF"'                                   00084200
&ZMS                SETC  '&ZMS "MF"'                                   00084300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00084400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00084500
.ZG41A              ANOP  ,                                             00084600
.*-------------------------------------------------------------------   00084700
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00084800
                    AIF   (N'&SYSLIST NE 0).ZG41B  POSITIONALS?         00084900
                    AIF   ('&MONTKN' NE '').ZG41B  KEYS?                00085000
                    AIF   ('&MONTKN64' NE '').ZG41B  KEYS?              00085100
                    AIF   ('&END_FLOW' NE '').ZG41B  KEYS?              00085200
                    AIF   ('&MSG_RECEIVED' NE '').ZG41B  KEYS?          00085300
                    AIF   ('&EWLM' NE '').ZG41B  KEYS?                  00085400
                    AIF   ('&ARRIVALTIME' NE '').ZG41B  KEYS?           00085500
                    AIF   ('&EWLM_S_PACORR' NE '').ZG41B  KEYS?         00085600
                    AIF   ('&EWLM_S_CURCORR' NE '').ZG41B  KEYS?        00085700
                    AIF   ('&EWLM_RCVD_CORR' NE '').ZG41B  KEYS?        00085800
                    AIF   ('&RETCODE' NE '').ZG41B  KEYS?               00085900
                    AIF   ('&RSNCODE' NE '').ZG41B  KEYS?               00086000
                    AGO    .ZG41C     INVOCATION OKAY                   00086100
.ZG41B              ANOP  ,                                             00086200
&ZMS                SETC  'THE "L" FORM OF "MF"'                        00086300
&ZMS                SETC  '&ZMS CAN ONLY HAVE'                          00086400
&ZMS                SETC  '&ZMS THE "PLISTVER" KEY'                     00086500
                    MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'        00086600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00086700
.ZG41C              ANOP  ,                                             00086800
.*-------------------------------------------------------------------   00086900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00087000
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00087100
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00087200
                    AIF   (N'&MF(2) GT 1).ZG43B  MULTI PARMS            00087300
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00087400
.ZG43B              AIF   (K'&MF(2) GT 0).ZG43C                         00087500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00087600
&ZMS                SETC  'WHEN "L" IS SPECIFIED'                       00087700
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00087800
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00087900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00088000
.ZG43C              ANOP  ,                                             00088100
.*-------------------------------------------------------------------   00088200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00088300
                    AIF   (K'&ZXMFCTRL LE 0).ZG43P  NOT I/O             00088400
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG43P                00088500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00088600
&ZMS                SETC  '"MF='                                        00088700
&ZMS                SETC  '&ZMS.&MF"'                                   00088800
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00088900
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'             00089000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00089100
.ZG43P              ANOP  ,                                             00089200
.*-------------------------------------------------------------------   00089300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00089400
&ZXMFATTR           SETC  'INPUT'     SET IN/OUTPUT                     00089500
&XMFATTR            SETC  '0D'                                          00089600
                    AIF   (K'&MF(3) LE 0).ZG46B  PARM                   00089700
&XMFATTR            SETC  '&MF(3,1)'  SET XVARIABLE                     00089800
                    AIF   (N'&MF(3) GT 1).ZG46B  MULTI                  00089900
&XMFATTR            SETC  '&MF(3)'    SET XVARIABLE                     00090000
.ZG46B              ANOP  ,                                             00090100
.*-------------------------------------------------------------------   00090200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00090300
                    AIF   (K'&ZXMFATTR LE 0).ZG46P  NOT I/O             00090400
                    AIF   ('&XMFATTR'(1,1) NE '(').ZG46P                00090500
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00090600
&ZMS                SETC  '"MF='                                        00090700
&ZMS                SETC  '&ZMS.&MF"'                                   00090800
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00090900
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'             00091000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00091100
.ZG46P              ANOP  ,                                             00091200
.*-------------------------------------------------------------------   00091300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00091400
                    AIF   (K'&ZXMFATTR LE 0).ZG46S  NOT I/O             00091500
                    AIF   (K'&XMFATTR LE 60).ZG46S  LNG OK              00091600
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00091700
&ZMS                SETC  '"MF='                                        00091800
&ZMS                SETC  '&ZMS.&MF"'                                   00091900
&ZMS                SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'         00092000
                    MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'            00092100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00092200
.ZG46S              ANOP  ,                                             00092300
.*-------------------------------------------------------------------   00092400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092500
.ZG48               ANOP  ,                                             00092600
&ZTLC               SETC 'E'                                            00092700
                    AIF   ('&MF(1)' NE '&ZTLC').ZG56                    00092800
&XMF                SETC  'E'         SET KEYWORD                       00092900
                    AIF   (N'&MF LE 3).ZG48A    CK NUM                  00093000
&ZMS                SETC  '"MF='                                        00093100
&ZMS                SETC  '&ZMS.&MF"'                                   00093200
&ZMS                SETC  '&ZMS "MF"'                                   00093300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00093400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00093500
.ZG48A              ANOP  ,                                             00093600
.*-------------------------------------------------------------------   00093700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00093800
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00093900
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00094000
                    AIF   (N'&MF(2) GT 1).ZG50B  MULTI PARMS            00094100
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00094200
.ZG50B              AIF   (K'&MF(2) GT 0).ZG50C                         00094300
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00094400
&ZMS                SETC  'WHEN "E" IS SPECIFIED'                       00094500
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00094600
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00094700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00094800
.ZG50C              ANOP  ,                                             00094900
.*-------------------------------------------------------------------   00095000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00095100
                    AIF   (K'&ZXMFCTRL LE 0).ZG50R  NOT I/O             00095200
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG50R                00095300
&ZCGPR              SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                    00095400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG50P                  00095500
                    AIF   (K'&ZCGPR GT 2).ZG50Q                         00095600
                    AIF   ('&ZCGPR' EQ '0').ZG50Q                       00095700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00095800
                    AIF   (T'&ZCGPR NE 'N').ZG50Q  INVALID REG NAME     00095900
.ZG50P              ANOP  ,                                             00096000
                    AIF   (T'&ZCGPR NE 'N').ZG50R  NON NUMERIC          00096100
                    AIF   ('&ZCGPR' LT '1').ZG50Q                       00096200
                    AIF   ('&ZCGPR' LE '12').ZG50R                      00096300
.ZG50Q              ANOP  ,                                             00096400
&ZMS                SETC  '"MF='                                        00096500
&ZMS                SETC  '&ZMS.&MF"'                                   00096600
&ZMS                SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'     00096700
                    MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'              00096800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00096900
.ZG50R              ANOP  ,                                             00097000
.*-------------------------------------------------------------------   00097100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00097200
&XMFSCK             SETC  ''          INITIALIZE XVARIABLE              00097300
.ZG54A   AIF   ('&MF(3)' NE 'COMPLETE').ZG55A                           00097400
&XMFSCK             SETC  'COMPLETE'  SET KEYWORD                       00097500
.*-------------------------------------------------------------------   00097600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00097700
.ZG55A              AIF   (K'&XMFSCK GT 0).ZG55C  KEYWORD               00097800
                    AIF   (K'&MF(3) LE 0).ZG55B                         00097900
&ZMS                SETC  '"MF='                                        00098000
&ZMS                SETC  '&ZMS.&MF"'                                   00098100
&ZMS                SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '     00098200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00098300
&ZMS                SETC  '&ZMS "COMPLETE".'                            00098400
                    MNOTE 8,' &ZMS '                                    00098500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00098600
.ZG55B              ANOP  ,                                             00098700
&XMFSCK             SETC  'COMPLETE'  SET DEFAULT KEYWORD               00098800
.ZG55C              ANOP  ,                                             00098900
&ZXMFSCK            SETC  'INPUT'     SET IN/OUTPUT                     00099000
.*------------------------------------------------------------------    00099100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099200
.ZG56               ANOP  ,                                             00099300
&ZXMF               SETC  'INPUT'     SET IN/OUTPUT                     00099400
                    AIF   (K'&XMF GT 0).ZG56E   VALID ARG               00099500
                    AIF   (T'&MF EQ 'O').ZG56D  OMITTED                 00099600
&ZASYSLNDX          SETA  0                                             00099700
.ZG56A              ANOP  ,           POSITIONAL MACRO KEY              00099800
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00099900
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG56C              00100000
&ZTLC               SETC 'MF'                                           00100100
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG56A     00100200
.ZG56B              ANOP  ,                                             00100300
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00100400
&ZMS                SETC  'THE "MF" KEY'                                00100500
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00100600
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00100700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00100800
                    AGO   .ZG56E                                        00100900
.ZG56C              ANOP  ,                                             00101000
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00101100
&ZMS                SETC  '"MF='                                        00101200
&ZMS                SETC  '&ZMS.&MF"'                                   00101300
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00101400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00101500
&ZMS                SETC  '&ZMS "S",'                                   00101600
&ZMS                SETC  '&ZMS "L",'                                   00101700
&ZMS                SETC  '&ZMS OR "E".'                                00101800
                    MNOTE 8,' &ZMS '                                    00101900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00102000
                    AGO   .ZG56E                                        00102100
.ZG56D              ANOP  ,                                             00102200
&XMF                SETC  'S'         SET DEFAULT KEYWORD               00102300
&XMFSCK             SETC  'COMPLETE'  COMPLETE CHECKING                 00102400
.ZG56E              ANOP  ,                                             00102500
.********************************************************************   00102600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00102700
.********************************************************************   00102800
                    ACTR  10000                                         00102900
.*-------------------------------------------------------------------   00103000
.***AG.MF03 MF=(SLE)                                                    00103100
                    AIF   ('&XMF' EQ 'L').ZGMFX                         00103200
.*----------------------------------------------------------------***   00103300
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00103400
&XUSEDMONTKNKEY     SETC  ''          INITIALIZE XVARIABLE              00103500
                    AIF   (K'&MONTKN LE 0).ZG2C                         00103600
&ZXUSEDMONTKNKEY    SETC  'INPUT'     SET IN/OUTPUT                     00103700
&XUSEDMONTKNKEY     SETC  'MONTKN'    SET XVARIABLE                     00103800
&ZXMONTKN           SETC  'INPUT'     SET IN/OUTPUT                     00103900
&XMONTKN            SETC  '&MONTKN(1)'          SET XVARIABLE PARM      00104000
                    AIF   (N'&MONTKN GT 1).ZG2A                         00104100
&XMONTKN            SETC  '&MONTKN'   SET XVARIABLE PARM                00104200
.ZG2A               AIF   (N'&MONTKN LE 1).ZG2B  CK NUM                 00104300
&ZMS                SETC  '"MONTKN='                                    00104400
&ZMS                SETC  '&ZMS.&MONTKN"'                               00104500
&ZMS                SETC  '&ZMS "MONTKN"'                               00104600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00104700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00104800
.ZG2B               AIF   (K'&XMONTKN GT 0).ZG2C  ONE PARM              00104900
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00105000
&ZXMONTKN           SETC  ''          RESET IN/OUTPUT                   00105100
&ZMS                SETC  ' '                                           00105200
&ZMS                SETC  '&ZMS "MONTKN" KEY AND ITS'                   00105300
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00105400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00105500
.ZG2C               ANOP  ,                                             00105600
.*----------------------------------------------------------------***   00105700
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00105800
                    AIF   (K'&MONTKN64 LE 0).ZG3D  NO ME KEY            00105900
                    AIF   (N'&MONTKN64 LE 1).ZG3A  CK NUM               00106000
&ZMS                SETC  '"MONTKN64='                                  00106100
&ZMS                SETC  '&ZMS.&MONTKN64"'                             00106200
&ZMS                SETC  '&ZMS "MONTKN64"'                             00106300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00106400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00106500
.ZG3A               AIF   (K'&XUSEDMONTKNKEY LE 0).ZG3B                 00106600
&ZMS                SETC  '"MONTKN64'                                   00106700
&ZMS                SETC  '&ZMS.=&MONTKN64"'                            00106800
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00106900
&ZMS                SETC  '&ZMS "&XUSEDMONTKNKEY"'                      00107000
                    MNOTE 8,' &ZMS KEY.'                                00107100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00107200
                    AGO   .ZG3D                                         00107300
.*                                                                      00107400
.ZG3B               ANOP  ,                                             00107500
&ZXUSEDMONTKNKEY    SETC  'INPUT'     SET IN/OUTPUT                     00107600
&XUSEDMONTKNKEY     SETC  'MONTKN64'  SET XVARIABLE                     00107700
&ZXMONTKN64         SETC  'INPUT'     SET IN/OUTPUT                     00107800
&XMONTKN64          SETC  '&MONTKN64(1)'        SET XVARIABLE PARM      00107900
                    AIF   (N'&MONTKN64 GT 1).ZG3C                       00108000
&XMONTKN64          SETC  '&MONTKN64'           SET XVARIABLE PARM      00108100
.ZG3C               AIF   (K'&XMONTKN64 GT 0).ZG3D  ONE PARM            00108200
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00108300
&ZXMONTKN64         SETC  ''          RESET IN/OUTPUT                   00108400
&ZMS                SETC  ' '                                           00108500
&ZMS                SETC  '&ZMS "MONTKN64" KEY AND ITS'                 00108600
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00108700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00108800
.ZG3D               ANOP  ,                                             00108900
.*------------------------------------------------------------------    00109000
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00109100
                    AIF   (K'&XUSEDMONTKNKEY GT 0).ZG4B                 00109200
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00109300
&ZXMONTKN           SETC  ''          RESET IN/OUTPUT                   00109400
&XUSEDMONTKNKEY     SETC  ''          ENSURE NULL                       00109500
&XMONTKN            SETC  ''          ENSURE NULL                       00109600
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00109700
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00109800
&ZMS                SETC  '&ZMS REQUIRED:'                              00109900
&ZMS                SETC  '&ZMS "MONTKN"'       VALID ME KEY            00110000
&ZMS                SETC  '&ZMS OR "MONTKN64".'  VALID ME KEY           00110100
                    MNOTE 8,' &ZMS '                                    00110200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00110300
.ZG4B               ANOP  ,                                             00110400
.*-------------------------------------------------------------------   00110500
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00110600
.ZG2ZY  AIF    ('&XUSEDMONTKNKEY' NE 'MONTKN').ZG3ZY                    00110700
.*-------------------------------------------------------------------   00110800
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00110900
                    AIF   (K'&ZXMONTKN LE 0).ZG2R  NOT I/O              00111000
                    AIF   ('&XMONTKN'(1,1) NE '(').ZG2R                 00111100
&ZCGPR              SETC  '&XMONTKN'(2,K'&XMONTKN-2)                    00111200
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                   00111300
                    AIF   (K'&ZCGPR GT 2).ZG2Q                          00111400
                    AIF   ('&ZCGPR' EQ '0').ZG2Q                        00111500
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00111600
                    AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME      00111700
.ZG2P               ANOP  ,                                             00111800
                    AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC           00111900
                    AIF   ('&ZCGPR' LT '2').ZG2Q                        00112000
                    AIF   ('&ZCGPR' LE '12').ZG2R                       00112100
.ZG2Q               ANOP  ,                                             00112200
&ZMS                SETC  '"MONTKN='                                    00112300
&ZMS                SETC  '&ZMS.&MONTKN"'                               00112400
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00112500
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00112600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00112700
.ZG2R               ANOP  ,                                             00112800
.*-------------------------------------------------------------------   00112900
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00113000
.ZG3ZY  AIF    ('&XUSEDMONTKNKEY' NE 'MONTKN64').ZG4ZY                  00113100
.*-------------------------------------------------------------------   00113200
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00113300
                    AIF   (K'&ZXMONTKN64 LE 0).ZG3R  NOT I/O            00113400
                    AIF   ('&XMONTKN64'(1,1) NE '(').ZG3R               00113500
&ZCGPR              SETC  '&XMONTKN64'(2,K'&XMONTKN64-2)                00113600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                   00113700
                    AIF   (K'&ZCGPR GT 2).ZG3Q                          00113800
                    AIF   ('&ZCGPR' EQ '0').ZG3Q                        00113900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00114000
                    AIF   (T'&ZCGPR NE 'N').ZG3Q  INVALID REG NAME      00114100
.ZG3P               ANOP  ,                                             00114200
                    AIF   (T'&ZCGPR NE 'N').ZG3R  NON NUMERIC           00114300
                    AIF   ('&ZCGPR' LT '2').ZG3Q                        00114400
                    AIF   ('&ZCGPR' LE '12').ZG3R                       00114500
.ZG3Q               ANOP  ,                                             00114600
&ZMS                SETC  '"MONTKN64='                                  00114700
&ZMS                SETC  '&ZMS.&MONTKN64"'                             00114800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00114900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00115000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00115100
.ZG3R               ANOP  ,                                             00115200
.*-------------------------------------------------------------------   00115300
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00115400
.ZG4ZY              ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00115500
.*----------------------------------------------------------------***   00115600
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00115700
                    AIF   (N'&END_FLOW LE 1).ZG6A  CK NUM               00115800
&ZMS                SETC  '"END_FLOW='                                  00115900
&ZMS                SETC  '&ZMS.&END_FLOW"'                             00116000
&ZMS                SETC  '&ZMS "END_FLOW"'                             00116100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00116200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00116300
.ZG6A               ANOP  ,                                             00116400
.*-------------------------------------------------------------------   00116500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00116600
&XEND_FLOW          SETC  ''          INITIALIZE XVARIABLE              00116700
.ZG7A   AIF   ('&END_FLOW(1)' NE 'NO').ZG8A                             00116800
&XEND_FLOW          SETC  'NO'        SET KEYWORD                       00116900
.*-------------------------------------------------------------------   00117000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00117100
.ZG8A   AIF   ('&END_FLOW(1)' NE 'YES').ZG9A                            00117200
&XEND_FLOW          SETC  'YES'       SET KEYWORD                       00117300
.*-------------------------------------------------------------------   00117400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00117500
.ZG9A               AIF   (K'&XEND_FLOW GT 0).ZG9C  KEYWORD             00117600
                    AIF   (K'&END_FLOW(1) LE 0).ZG9B                    00117700
&ZMS                SETC  '"END_FLOW='                                  00117800
&ZMS                SETC  '&ZMS.&END_FLOW"'                             00117900
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00118000
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00118100
&ZMS                SETC  '&ZMS "NO"'                                   00118200
&ZMS                SETC  '&ZMS OR "YES".'                              00118300
                    MNOTE 8,' &ZMS '                                    00118400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00118500
.ZG9B               ANOP  ,                                             00118600
&XEND_FLOW          SETC  'NO'        SET DEFAULT KEYWORD               00118700
.ZG9C               ANOP  ,                                             00118800
&ZXEND_FLOW         SETC  'INPUT'     SET IN/OUTPUT                     00118900
.*----------------------------------------------------------------***   00119000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00119100
                    AIF   (N'&MSG_RECEIVED LE 1).ZG11A  CK NUM          00119200
&ZMS                SETC  '"MSG_RECEIVED='                              00119300
&ZMS                SETC  '&ZMS.&MSG_RECEIVED"'                         00119400
&ZMS                SETC  '&ZMS "MSG_RECEIVED"'                         00119500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00119600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00119700
.ZG11A              ANOP  ,                                             00119800
.*-------------------------------------------------------------------   00119900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120000
&XMSG_RECEIVED      SETC  ''          INITIALIZE XVARIABLE              00120100
.ZG12A   AIF   ('&MSG_RECEIVED(1)' NE 'NO').ZG13A                       00120200
&XMSG_RECEIVED      SETC  'NO'        SET KEYWORD                       00120300
.*-------------------------------------------------------------------   00120400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120500
.ZG13A   AIF   ('&MSG_RECEIVED(1)' NE 'YES').ZG14A                      00120600
&XMSG_RECEIVED      SETC  'YES'       SET KEYWORD                       00120700
.*-------------------------------------------------------------------   00120800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120900
.ZG14A              AIF   (K'&XMSG_RECEIVED GT 0).ZG14C  KEYWORD        00121000
                    AIF   (K'&MSG_RECEIVED(1) LE 0).ZG14B               00121100
&ZMS                SETC  '"MSG_RECEIVED='                              00121200
&ZMS                SETC  '&ZMS.&MSG_RECEIVED"'                         00121300
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00121400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00121500
&ZMS                SETC  '&ZMS "NO"'                                   00121600
&ZMS                SETC  '&ZMS OR "YES".'                              00121700
                    MNOTE 8,' &ZMS '                                    00121800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00121900
.ZG14B              ANOP  ,                                             00122000
&XMSG_RECEIVED      SETC  'NO'        SET DEFAULT KEYWORD               00122100
.ZG14C              ANOP  ,                                             00122200
&ZXMSG_RECEIVED     SETC  'INPUT'     SET IN/OUTPUT                     00122300
.*----------------------------------------------------------------***   00122400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00122500
                    AIF   (N'&EWLM LE 1).ZG16A  CK NUM                  00122600
&ZMS                SETC  '"EWLM='                                      00122700
&ZMS                SETC  '&ZMS.&EWLM"'                                 00122800
&ZMS                SETC  '&ZMS "EWLM"'                                 00122900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00123000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00123100
.ZG16A              ANOP  ,                                             00123200
.*-------------------------------------------------------------------   00123300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00123400
&XEWLM              SETC  ''          INITIALIZE XVARIABLE              00123500
.ZG17A   AIF   ('&EWLM(1)' NE 'NO').ZG18A                               00123600
&XEWLM              SETC  'NO'        SET KEYWORD                       00123700
.*-------------------------------------------------------------------   00123800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00123900
.ZG18A              AIF   (K'&XEWLM GT 0).ZG18C  KEYWORD                00124000
                    AIF   (K'&EWLM(1) LE 0).ZG18B                       00124100
&ZMS                SETC  '"EWLM='                                      00124200
&ZMS                SETC  '&ZMS.&EWLM"'                                 00124300
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00124400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00124500
&ZMS                SETC  '&ZMS "NO".'                                  00124600
                    MNOTE 8,' &ZMS '                                    00124700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00124800
.ZG18B              ANOP  ,                                             00124900
&XEWLM              SETC  'NO'        SET DEFAULT KEYWORD               00125000
.ZG18C              ANOP  ,                                             00125100
&ZXEWLM             SETC  'INPUT'     SET IN/OUTPUT                     00125200
.*----------------------------------------------------------------***   00125300
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00125400
                    AIF   (N'&ARRIVALTIME LE 1).ZG20A  CK NUM           00125500
&ZMS                SETC  '"ARRIVALTIME='                               00125600
&ZMS                SETC  '&ZMS.&ARRIVALTIME"'                          00125700
&ZMS                SETC  '&ZMS "ARRIVALTIME"'                          00125800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00125900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00126000
.ZG20A              ANOP  ,                                             00126100
.*-------------------------------------------------------------------   00126200
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00126300
&ZXARRIVALTIME      SETC  'INPUT'     SET IN/OUTPUT                     00126400
&XARRIVALTIME       SETC  'NO_ARRIVALTIME'                              00126500
                    AIF   (K'&ARRIVALTIME(1) LE 0).ZG20B  PARM          00126600
&XARRIVALTIME       SETC  '&ARRIVALTIME(1)'     SET XVARIABLE           00126700
                    AIF   (N'&ARRIVALTIME GT 1).ZG20B  MULTI            00126800
&XARRIVALTIME       SETC  '&ARRIVALTIME'        SET XVARIABLE           00126900
.ZG20B              ANOP  ,                                             00127000
.*-------------------------------------------------------------------   00127100
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00127200
                    AIF   (K'&ZXARRIVALTIME LE 0).ZG20R  NOT I/O        00127300
         AIF   ('&XARRIVALTIME' EQ 'NO_ARRIVALTIME').ZG20R              00127400
                    AIF   ('&XARRIVALTIME'(1,1) NE '(').ZG20R           00127500
&ZCGPR              SETC  '&XARRIVALTIME'(2,K'&XARRIVALTIME-2)          00127600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                  00127700
                    AIF   (K'&ZCGPR GT 2).ZG20Q                         00127800
                    AIF   ('&ZCGPR' EQ '0').ZG20Q                       00127900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00128000
                    AIF   (T'&ZCGPR NE 'N').ZG20Q  INVALID REG NAME     00128100
.ZG20P              ANOP  ,                                             00128200
                    AIF   (T'&ZCGPR NE 'N').ZG20R  NON NUMERIC          00128300
                    AIF   ('&ZCGPR' LT '2').ZG20Q                       00128400
                    AIF   ('&ZCGPR' LE '12').ZG20R                      00128500
.ZG20Q              ANOP  ,                                             00128600
&ZMS                SETC  '"ARRIVALTIME='                               00128700
&ZMS                SETC  '&ZMS.&ARRIVALTIME"'                          00128800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00128900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00129000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00129100
.ZG20R              ANOP  ,                                             00129200
.*----------------------------------------------------------------***   00129300
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00129400
&XUSEDEWLMS         SETC  ''          INITIALIZE XVARIABLE              00129500
                    AIF   (K'&EWLM_S_PACORR LE 0).ZG23C                 00129600
&ZXUSEDEWLMS        SETC  'INPUT'     SET IN/OUTPUT                     00129700
&XUSEDEWLMS         SETC  'EWLM_S_PACORR'       SET XVARIABLE           00129800
&ZXEWLM_S_PACORR    SETC  'INPUT'     SET IN/OUTPUT                     00129900
&XEWLM_S_PACORR     SETC  '&EWLM_S_PACORR(1)'   SET XVARIABLE PARM      00130000
                    AIF   (N'&EWLM_S_PACORR GT 1).ZG23A                 00130100
&XEWLM_S_PACORR     SETC  '&EWLM_S_PACORR'      SET XVARIABLE PARM      00130200
.ZG23A              AIF   (N'&EWLM_S_PACORR LE 1).ZG23B  CK NUM         00130300
&ZMS                SETC  '"EWLM_S_PACORR='                             00130400
&ZMS                SETC  '&ZMS.&EWLM_S_PACORR"'                        00130500
&ZMS                SETC  '&ZMS "EWLM_S_PACORR"'                        00130600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00130700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00130800
.ZG23B              AIF   (K'&XEWLM_S_PACORR GT 0).ZG23C  ONE PARM      00130900
&ZXUSEDEWLMS        SETC  ''          RESET IN/OUTPUT                   00131000
&ZXEWLM_S_PACORR    SETC  ''          RESET IN/OUTPUT                   00131100
&ZMS                SETC  ' '                                           00131200
&ZMS                SETC  '&ZMS "EWLM_S_PACORR" KEY AND ITS'            00131300
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00131400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00131500
.ZG23C              ANOP  ,                                             00131600
.*----------------------------------------------------------------***   00131700
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00131800
                    AIF   (K'&EWLM_S_CURCORR LE 0).ZG24D  NO ME KEY     00131900
                    AIF   (N'&EWLM_S_CURCORR LE 1).ZG24A  CK NUM        00132000
&ZMS                SETC  '"EWLM_S_CURCORR='                            00132100
&ZMS                SETC  '&ZMS.&EWLM_S_CURCORR"'                       00132200
&ZMS                SETC  '&ZMS "EWLM_S_CURCORR"'                       00132300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00132400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00132500
.ZG24A              AIF   (K'&XUSEDEWLMS LE 0).ZG24B                    00132600
&ZMS                SETC  '"EWLM_S_CURCORR'                             00132700
&ZMS                SETC  '&ZMS.=&EWLM_S_CURCORR"'                      00132800
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00132900
&ZMS                SETC  '&ZMS "&XUSEDEWLMS"'                          00133000
                    MNOTE 8,' &ZMS KEY.'                                00133100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00133200
                    AGO   .ZG24D                                        00133300
.*                                                                      00133400
.ZG24B              ANOP  ,                                             00133500
&ZXUSEDEWLMS        SETC  'INPUT'     SET IN/OUTPUT                     00133600
&XUSEDEWLMS         SETC  'EWLM_S_CURCORR'      SET XVARIABLE           00133700
&ZXEWLM_S_CURCORR   SETC  'INPUT'     SET IN/OUTPUT                     00133800
&XEWLM_S_CURCORR    SETC  '&EWLM_S_CURCORR(1)'  SET XVARIABLE PARM      00133900
                    AIF   (N'&EWLM_S_CURCORR GT 1).ZG24C                00134000
&XEWLM_S_CURCORR    SETC  '&EWLM_S_CURCORR'     SET XVARIABLE PARM      00134100
.ZG24C              AIF   (K'&XEWLM_S_CURCORR GT 0).ZG24D  ONE PARM     00134200
&ZXUSEDEWLMS        SETC  ''          RESET IN/OUTPUT                   00134300
&ZXEWLM_S_CURCORR   SETC  ''          RESET IN/OUTPUT                   00134400
&ZMS                SETC  ' '                                           00134500
&ZMS                SETC  '&ZMS "EWLM_S_CURCORR" KEY AND ITS'           00134600
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00134700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00134800
.ZG24D              ANOP  ,                                             00134900
.*------------------------------------------------------------------    00135000
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00135100
                    AIF   (K'&XUSEDEWLMS GT 0).ZG28B                    00135200
&ZXUSEDEWLMS        SETC  ''          RESET IN/OUTPUT                   00135300
&ZXEWLM_S_PACORR    SETC  ''          RESET IN/OUTPUT                   00135400
&XUSEDEWLMS         SETC  ''          ENSURE NULL                       00135500
&XEWLM_S_PACORR     SETC  ''          ENSURE NULL                       00135600
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00135700
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00135800
&ZMS                SETC  '&ZMS REQUIRED:'                              00135900
&ZMS                SETC  '&ZMS "EWLM_S_PACORR"'  VALID ME KEY          00136000
&ZMS                SETC  '&ZMS OR "EWLM_S_CURCORR".'  VALID ME KEY     00136100
                    MNOTE 8,' &ZMS '                                    00136200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00136300
.ZG28B              ANOP  ,                                             00136400
.*-------------------------------------------------------------------   00136500
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00136600
.ZG23ZY  AIF    ('&XUSEDEWLMS' NE 'EWLM_S_PACORR').ZG24ZY               00136700
.*-------------------------------------------------------------------   00136800
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00136900
&ZCVAL              SETC ''           ERROR KEY FIELD                   00137000
.ZG23I0             AIF   (K'&EWLM_RCVD_CORR LE 0).ZG23I1               00137100
&ZCVAL              SETC '&ZCVAL EWLM_RCVD_CORR'  DISALLOWED KEY        00137200
.ZG23I1             AIF   (K'&ZCVAL LE 0).ZG23J  KEY                    00137300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00137400
&ZMS                SETC  '"EWLM_S_PACORR'                              00137500
&ZMS                SETC  '&ZMS.=&EWLM_S_PACORR"'                       00137600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00137700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00137800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00137900
.ZG23J              ANOP  ,                                             00138000
.*-------------------------------------------------------------------   00138100
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00138200
                    AIF   (K'&ZXEWLM_S_PACORR LE 0).ZG23R  NOT I/O      00138300
                    AIF   ('&XEWLM_S_PACORR'(1,1) NE '(').ZG23R         00138400
&ZCGPR              SETC  '&XEWLM_S_PACORR'(2,K'&XEWLM_S_PACORR-2)      00138500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                  00138600
                    AIF   (K'&ZCGPR GT 2).ZG23Q                         00138700
                    AIF   ('&ZCGPR' EQ '0').ZG23Q                       00138800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00138900
                    AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME     00139000
.ZG23P              ANOP  ,                                             00139100
                    AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC          00139200
                    AIF   ('&ZCGPR' LT '2').ZG23Q                       00139300
                    AIF   ('&ZCGPR' LE '12').ZG23R                      00139400
.ZG23Q              ANOP  ,                                             00139500
&ZMS                SETC  '"EWLM_S_PACORR='                             00139600
&ZMS                SETC  '&ZMS.&EWLM_S_PACORR"'                        00139700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00139800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00139900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00140000
.ZG23R              ANOP  ,                                             00140100
.*-------------------------------------------------------------------   00140200
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00140300
.ZG24ZY  AIF    ('&XUSEDEWLMS' NE 'EWLM_S_CURCORR').ZG28ZY              00140400
.*-------------------------------------------------------------------   00140500
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00140600
                    AIF   (K'&ZXEWLM_S_CURCORR LE 0).ZG24R  NOT I/O     00140700
                    AIF   ('&XEWLM_S_CURCORR'(1,1) NE '(').ZG24R        00140800
&ZCGPR              SETC  '&XEWLM_S_CURCORR'(2,K'&XEWLM_S_CURCORR-2)    00140900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                  00141000
                    AIF   (K'&ZCGPR GT 2).ZG24Q                         00141100
                    AIF   ('&ZCGPR' EQ '0').ZG24Q                       00141200
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00141300
                    AIF   (T'&ZCGPR NE 'N').ZG24Q  INVALID REG NAME     00141400
.ZG24P              ANOP  ,                                             00141500
                    AIF   (T'&ZCGPR NE 'N').ZG24R  NON NUMERIC          00141600
                    AIF   ('&ZCGPR' LT '2').ZG24Q                       00141700
                    AIF   ('&ZCGPR' LE '12').ZG24R                      00141800
.ZG24Q              ANOP  ,                                             00141900
&ZMS                SETC  '"EWLM_S_CURCORR='                            00142000
&ZMS                SETC  '&ZMS.&EWLM_S_CURCORR"'                       00142100
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00142200
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00142300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00142400
.ZG24R              ANOP  ,                                             00142500
.*----------------------------------------------------------------***   00142600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00142700
                    AIF   (N'&EWLM_RCVD_CORR LE 1).ZG26A  CK NUM        00142800
&ZMS                SETC  '"EWLM_RCVD_CORR='                            00142900
&ZMS                SETC  '&ZMS.&EWLM_RCVD_CORR"'                       00143000
&ZMS                SETC  '&ZMS "EWLM_RCVD_CORR"'                       00143100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00143200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00143300
.ZG26A              ANOP  ,                                             00143400
.*-------------------------------------------------------------------   00143500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00143600
&ZXEWLM_RCVD_CORR   SETC  'INPUT'     SET IN/OUTPUT                     00143700
&XEWLM_RCVD_CORR    SETC  'NO_EWLM_RCVD_CORR'                           00143800
                    AIF   (K'&EWLM_RCVD_CORR(1) LE 0).ZG26B  PARM       00143900
&XEWLM_RCVD_CORR    SETC  '&EWLM_RCVD_CORR(1)'  SET XVARIABLE           00144000
                    AIF   (N'&EWLM_RCVD_CORR GT 1).ZG26B  MULTI         00144100
&XEWLM_RCVD_CORR    SETC  '&EWLM_RCVD_CORR'     SET XVARIABLE           00144200
.ZG26B              ANOP  ,                                             00144300
.*-------------------------------------------------------------------   00144400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00144500
                    AIF   (K'&ZXEWLM_RCVD_CORR LE 0).ZG26R  NOT I/O     00144600
         AIF   ('&XEWLM_RCVD_CORR' EQ 'NO_EWLM_RCVD_CORR').ZG26R        00144700
                    AIF   ('&XEWLM_RCVD_CORR'(1,1) NE '(').ZG26R        00144800
&ZCGPR              SETC  '&XEWLM_RCVD_CORR'(2,K'&XEWLM_RCVD_CORR-2)    00144900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                  00145000
                    AIF   (K'&ZCGPR GT 2).ZG26Q                         00145100
                    AIF   ('&ZCGPR' EQ '0').ZG26Q                       00145200
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00145300
                    AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME     00145400
.ZG26P              ANOP  ,                                             00145500
                    AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC          00145600
                    AIF   ('&ZCGPR' LT '2').ZG26Q                       00145700
                    AIF   ('&ZCGPR' LE '12').ZG26R                      00145800
.ZG26Q              ANOP  ,                                             00145900
&ZMS                SETC  '"EWLM_RCVD_CORR='                            00146000
&ZMS                SETC  '&ZMS.&EWLM_RCVD_CORR"'                       00146100
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00146200
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00146300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00146400
.ZG26R              ANOP  ,                                             00146500
.*-------------------------------------------------------------------   00146600
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00146700
.ZG28ZY             ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00146800
.*----------------------------------------------------------------***   00146900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00147000
                    AIF   (N'&RETCODE LE 1).ZG30A  CK NUM               00147100
&ZMS                SETC  '"RETCODE='                                   00147200
&ZMS                SETC  '&ZMS.&RETCODE"'                              00147300
&ZMS                SETC  '&ZMS "RETCODE"'                              00147400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00147500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00147600
.ZG30A              ANOP  ,                                             00147700
.*-------------------------------------------------------------------   00147800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00147900
                    AIF   (K'&RETCODE(1) LE 0).ZG30C  NO PARM           00148000
&ZXRETCODE          SETC  'OUTPUT'    SET OUTPUT                        00148100
&XRETCODE           SETC  '&RETCODE(1)'         SET XVARIABLE           00148200
                    AIF   (N'&RETCODE GT 1).ZG30C                       00148300
&XRETCODE           SETC  '&RETCODE'  SET XVARIABLE                     00148400
.ZG30C              ANOP  ,                                             00148500
.*-------------------------------------------------------------------   00148600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00148700
                    AIF   (K'&ZXRETCODE LE 0).ZG30R  NOT I/O            00148800
                    AIF   ('&XRETCODE'(1,1) NE '(').ZG30R               00148900
&ZCGPR              SETC  '&XRETCODE'(2,K'&XRETCODE-2)                  00149000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG30P                  00149100
                    AIF   (K'&ZCGPR GT 2).ZG30Q                         00149200
                    AIF   ('&ZCGPR' EQ '0').ZG30Q                       00149300
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00149400
                    AIF   (T'&ZCGPR NE 'N').ZG30Q  INVALID REG NAME     00149500
.ZG30P              ANOP  ,                                             00149600
                    AIF   (T'&ZCGPR NE 'N').ZG30R  NON NUMERIC          00149700
                    AIF   ('&ZCGPR' EQ '15').ZG30R                      00149800
                    AIF   ('&ZCGPR' LT '2').ZG30Q                       00149900
                    AIF   ('&ZCGPR' LE '12').ZG30R                      00150000
.ZG30Q              ANOP  ,                                             00150100
&ZMS                SETC  '"RETCODE='                                   00150200
&ZMS                SETC  '&ZMS.&RETCODE"'                              00150300
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00150400
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'      00150500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00150600
.ZG30R              ANOP  ,                                             00150700
.*----------------------------------------------------------------***   00150800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00150900
                    AIF   (N'&RSNCODE LE 1).ZG33A  CK NUM               00151000
&ZMS                SETC  '"RSNCODE='                                   00151100
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00151200
&ZMS                SETC  '&ZMS "RSNCODE"'                              00151300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00151400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00151500
.ZG33A              ANOP  ,                                             00151600
.*-------------------------------------------------------------------   00151700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00151800
                    AIF   (K'&RSNCODE(1) LE 0).ZG33C  NO PARM           00151900
&ZXRSNCODE          SETC  'OUTPUT'    SET OUTPUT                        00152000
&XRSNCODE           SETC  '&RSNCODE(1)'         SET XVARIABLE           00152100
                    AIF   (N'&RSNCODE GT 1).ZG33C                       00152200
&XRSNCODE           SETC  '&RSNCODE'  SET XVARIABLE                     00152300
.ZG33C              ANOP  ,                                             00152400
.*-------------------------------------------------------------------   00152500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00152600
                    AIF   (K'&ZXRSNCODE LE 0).ZG33R  NOT I/O            00152700
                    AIF   ('&XRSNCODE'(1,1) NE '(').ZG33R               00152800
&ZCGPR              SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                  00152900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                  00153000
                    AIF   (K'&ZCGPR GT 2).ZG33Q                         00153100
                    AIF   ('&ZCGPR' EQ '0').ZG33R                       00153200
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00153300
                    AIF   (T'&ZCGPR NE 'N').ZG33Q  INVALID REG NAME     00153400
.ZG33P              ANOP  ,                                             00153500
                    AIF   (T'&ZCGPR NE 'N').ZG33R  NON NUMERIC          00153600
                    AIF   ('&ZCGPR' EQ '0').ZG33R                       00153700
                    AIF   ('&ZCGPR' LT '2').ZG33Q                       00153800
                    AIF   ('&ZCGPR' LE '12').ZG33R                      00153900
.ZG33Q              ANOP  ,                                             00154000
&ZMS                SETC  '"RSNCODE='                                   00154100
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00154200
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00154300
                    MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'       00154400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00154500
.ZG33R              ANOP  ,                                             00154600
.******************************************************************     00154700
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00154800
.******************************************************************     00154900
                    ACTR  10000                                         00155000
.*----------------------------------------------------------------***   00155100
.***AH.P02 EXTRA POSITIONALS                                            00155200
                    AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS          00155300
                    AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL          00155400
                    AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL      00155500
                    AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL       00155600
.ZGLISTX1           ANOP  ,                                             00155700
&ZCVAL              SETC  ''          ERROR FIELD                       00155800
&ZAWRK              SETA  0           POSITIONAL NUMBER                 00155900
.ZGLIST2            ANOP  ,                                             00156000
&ZAWRK              SETA  &ZAWRK+1    NEXT POSITIONAL                   00156100
                    AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE          00156200
&ZCVAL              SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA               00156300
                    AGO   .ZGLIST2                                      00156400
.*                                                                      00156500
.ZGLIST3            ANOP  ,                                             00156600
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA            00156700
&ZMS                SETC  'POSITIONAL ARGUMENT(S),'                     00156800
&ZMS                SETC  '&ZMS "&ZCVAL"'                               00156900
&ZMS                SETC  '&ZMS CANNOT BE USED.'                        00157000
&ZMS                SETC  '&ZMS NO POSITIONAL ARGUMENTS'                00157100
                    MNOTE 8,' &ZMS ARE ALLOWED.'                        00157200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00157300
.ZGLISTX            ANOP  ,                                             00157400
&ZASYSLNDX          SETA  0                                             00157500
.*-------------------------------------------------------------------   00157600
.***AG.MF04 MF=(SLE)                                                    00157700
.ZGMFX              ANOP  ,           END OF FULL SYNTAX CHECK          00157800
.*******************************************************************    00157900
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00158000
.*******************************************************************    00158100
                    AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED          00158200
.*******************************************************************    00158300
.***AE.01  START OF IWM4MSTR MACRO CODE                                 00158400
.*******************************************************************    00158500
                    LCLC  &M0M0001                 NAME                 00158600
&M0M0001            SETC  '&XLABEL'                SET NAME             00158700
                    AIF   (K'&XLABEL NE 0).XLAB2                        00158800
&M0M0001            SETC  'M00M&SYSNDX'            DEFAULT NAME         00158900
.*                                                                      00159000
.XLAB2              ANOP  ,                                             00159100
                    AIF   ('&XMF' EQ 'L').XLAB3                         00159200
&M0M0001 DS    0H                             IWM4MSTR-0                00159300
.XLAB3              ANOP  ,                                             00159400
.*******************************************************************    00159500
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00159600
.*******************************************************************    00159700
              PUSH  PRINT                                               00159800
                    AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON    00159900
                    PRINT OFF         ++ PR01                           00160000
                    AGO   .ZPRNTXX                                      00160100
.ZPRINTX            PRINT ON                                            00160200
.ZPRNTXX            ANOP  ,                                             00160300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00160400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00160500
.********************************************************************   00160600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00160700
.********************************************************************   00160800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00160900
                      LCLA  &ZOPN1         INVOCATION INDEX             00161000
                      LCLC  &ZOPL(4095)    LABEL                        00161100
                      LCLC  &ZOPO(4095)    OPERATION                    00161200
                      LCLC  &ZOPV(4095)    VALUE                        00161300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00161400
.*                                                                      00161500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00161600
.******************************************************************     00161700
.***AL.L10 IWM4MSTR FMT=LIST MF=S!L PARAMETERS                          00161800
.******************************************************************     00161900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00162000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00162100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00162200
&XMFATTR              SETC  '0D'                                        00162300
.*                                                                      00162400
&ZOPN                 SETA  &ZOPN+1                                     00162500
&ZOPL(&ZOPN)          SETC  ' '                                         00162600
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00162700
&ZOPV(&ZOPN)          SETC  '4,8'                                       00162800
&ZOPN                 SETA  &ZOPN+1                                     00162900
&ZOPL(&ZOPN)          SETC  ' '                                         00163000
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00163100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00163200
&ZOPD(&ZOPN)          SETC  '++ IWM4MSTR ARG PARMS'                     00163300
.*                                                                      00163400
&ZOPN                 SETA  &ZOPN+1                                     00163500
&ZOPL(&ZOPN)          SETC  ' '                                         00163600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00163700
&ZOPV(&ZOPN)          SETC  '1'                                         00163800
&ZOPD(&ZOPN)          SETC  ' '                                         00163900
.*                                                                      00164000
.ZLMFSL2              ANOP  ,                                           00164100
.*-------------------------------------------------------------------   00164200
.***AM.L00  IWM4MSTR FMT=LIST name                                      00164300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00164400
&ZOPN                 SETA &ZOPN+1                                      00164500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00164600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00164700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00164800
&ZOPD(&ZOPN)          SETC '++ IWM4MSTR NAME'                           00164900
.ZLMFSL2M             ANOP  ,                                           00165000
.*-------------------------------------------------------------------   00165100
.***AM.L01  IWM4MSTR FMT=LIST PARAMETERS                                00165200
&ZOPN                 SETA &ZOPN+1                                      00165300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00165400
&ZOPO(&ZOPN)          SETC 'DS'                                         00165500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00165600
&ZOPD(&ZOPN)          SETC '++ IWM4MSTR PARM LIST'                      00165700
.*-------------------------------------------------------------------   00165800
.***AM.L02 XVERSION XL1                                                 00165900
&ZOPN                 SETA &ZOPN+1                                      00166000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00166100
&ZOPO(&ZOPN)          SETC 'DS'                                         00166200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00166300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00166400
.*-------------------------------------------------------------------   00166500
.***AM.L03 XMSTRT_OPTIONS BL.16                                         00166600
&ZOPN                 SETA &ZOPN+1                                      00166700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMSTRT_OPTIONS'                   00166800
&ZOPO(&ZOPN)          SETC 'DS'                                         00166900
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00167000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00167100
.*                                                                      00167200
&ZOPN                 SETA  &ZOPN+1                                     00167300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XEND_FLOW_YES'                   00167400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00167500
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00167600
&ZOPD(&ZOPN)          SETC  '++ XEND_FLOW.'                             00167700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00167800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00167900
.*                                                                      00168000
&ZOPN                 SETA  &ZOPN+1                                     00168100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMSG_RECEIVED_YES'               00168200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00168300
&ZOPV(&ZOPN)          SETC  'B''0100000000000000'''                     00168400
&ZOPD(&ZOPN)          SETC  '++ XMSG_RECEIVED.'                         00168500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00168600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00168700
.*                                                                      00168800
&ZOPN                 SETA  &ZOPN+1                                     00168900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._IWM4MSTR'                        00169000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00169100
&ZOPV(&ZOPN)          SETC  'B''0000000000000001'''                     00169200
&ZOPD(&ZOPN)          SETC  '++ MACUSED.'                               00169300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IWM4MSTR'                     00169400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00169500
.*-------------------------------------------------------------------   00169600
.***AM.L09  XRSV0003 CL1                                                00169700
&ZOPN                 SETA &ZOPN+1                                      00169800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00169900
&ZOPO(&ZOPN)          SETC 'DS'                                         00170000
&ZOPV(&ZOPN)          SETC 'CL1'                                        00170100
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00170200
.*-------------------------------------------------------------------   00170300
.***AM.L09  XMONTKN BL.32                                               00170400
&ZOPN                 SETA &ZOPN+1                                      00170500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00170600
&ZOPO(&ZOPN)          SETC 'DS'                                         00170700
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00170800
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN '                              00170900
.*-------------------------------------------------------------------   00171000
.***AM.L09 ADDR3164 XEWLM_S_PACORR AD                                   00171100
&ZOPN                 SETA &ZOPN+1                                      00171200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEWLM_S_PACORR_ADDR3164'          00171300
&ZOPO(&ZOPN)          SETC 'DS'                                         00171400
&ZOPV(&ZOPN)          SETC 'AD'                                         00171500
&ZOPD(&ZOPN)          SETC '++ &ZXEWLM_S_PACORR ADDR3164'               00171600
.*-------------------------------------------------------------------   00171700
.***AM.L09 ADDR3164 XEWLM_S_CURCORR AD                                  00171800
&ZOPN                 SETA &ZOPN+1                                      00171900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEWLM_S_CURCORR_ADDR3164'         00172000
&ZOPO(&ZOPN)          SETC 'DS'                                         00172100
&ZOPV(&ZOPN)          SETC 'AD'                                         00172200
&ZOPD(&ZOPN)          SETC '++ &ZXEWLM_S_CURCORR ADDR3164'              00172300
.*-------------------------------------------------------------------   00172400
.***AM.L09 ADDR3164 XEWLM_RCVD_CORR AD                                  00172500
&ZOPN                 SETA &ZOPN+1                                      00172600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEWLM_RCVD_CORR_ADDR3164'         00172700
&ZOPO(&ZOPN)          SETC 'DS'                                         00172800
&ZOPV(&ZOPN)          SETC 'AD'                                         00172900
&ZOPD(&ZOPN)          SETC '++ &ZXEWLM_RCVD_CORR ADDR3164'              00173000
.*-------------------------------------------------------------------   00173100
.***AM.L09 ADDR3164 XARRIVALTIME AD                                     00173200
&ZOPN                 SETA &ZOPN+1                                      00173300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XARRIVALTIME_ADDR3164'            00173400
&ZOPO(&ZOPN)          SETC 'DS'                                         00173500
&ZOPV(&ZOPN)          SETC 'AD'                                         00173600
&ZOPD(&ZOPN)          SETC '++ &ZXARRIVALTIME ADDR3164'                 00173700
.*-------------------------------------------------------------------   00173800
.***AM.L09  XMONTKN64 BL.64                                             00173900
&ZOPN                 SETA &ZOPN+1                                      00174000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN64'                        00174100
&ZOPO(&ZOPN)          SETC 'DS'                                         00174200
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00174300
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN64 '                            00174400
.*-------------------------------------------------------------------   00174500
.***AM.L10 END OF IWM4MSTR LIST PARAMETERS                              00174600
&ZOPN                 SETA &ZOPN+1                                      00174700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00174800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00174900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00175000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00175100
.*                                                                      00175200
&ZOPN                 SETA &ZOPN+1                                      00175300
&ZOPL(&ZOPN)          SETC ' '                                          00175400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00175500
&ZOPV(&ZOPN)          SETC '1'                                          00175600
&ZOPD(&ZOPN)          SETC ' '                                          00175700
.*-------------------------------------------------------------------   00175800
.***AL.L12 IWM4MSTR FMT=LIST MF=S!L PARAMETERS                          00175900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00176000
.*                                                                      00176100
&ZOPN                 SETA  &ZOPN+1                                     00176200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00176300
&ZOPO(&ZOPN)          SETC  'DC'                                        00176400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00176500
&ZOPD(&ZOPN)          SETC  '++ IWM4MSTR ARG PARMS'                     00176600
.*                                                                      00176700
.ZLMFSLX              ANOP  ,                                           00176800
.*-------------------------------------------------------------------   00176900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00177000
&ZPLLEN               SETA 48                                           00177100
.*                                                                      00177200
.******************************************************************     00177300
.***AI.L01 IWM4MSTR FMT=LIST FILL IN PARAMETER AREA                     00177400
.******************************************************************     00177500
                      ACTR  10000                                       00177600
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00177700
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00177800
&ZCVAL                SETC  'LAE'          XAX MODE                     00177900
.ZIMFXA               ANOP ,                                            00178000
.*                                                                      00178100
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00178200
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00178300
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00178400
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00178500
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00178600
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00178700
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00178800
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00178900
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00179000
&ZOPN                 SETA  &ZOPN+1                                     00179100
&ZOPL(&ZOPN)          SETC  ' '                                         00179200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00179300
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00179400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00179500
                      AGO   .ZIMFNX                                     00179600
.*                                                                      00179700
.ZIMFN2               ANOP ,                                            00179800
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00179900
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00180000
&ZOPN                 SETA  &ZOPN+1                                     00180100
&ZOPL(&ZOPN)          SETC  ' '                                         00180200
&ZOPO(&ZOPN)          SETC  'LAE'                                       00180300
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00180400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00180500
                      AGO   .ZIMFNX                                     00180600
.ZIMFNX1              ANOP ,                                            00180700
&ZOPN                 SETA  &ZOPN+1                                     00180800
&ZOPL(&ZOPN)          SETC  ' '                                         00180900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00181000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00181100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00181200
.ZIMFNX               ANOP ,                                            00181300
.********************************************************************   00181400
.***AI.L02 IWM4MSTR FMT=LIST INITIALIZE PARAMETER AREA                  00181500
.********************************************************************   00181600
.***AI.L03 MF=(SLE)                                                     00181700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00181800
.*                                                                      00181900
&ZOPN                 SETA  &ZOPN+1                                     00182000
&ZOPL(&ZOPN)          SETC  ' '                                         00182100
&ZOPO(&ZOPN)          SETC  'XC'                                        00182200
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00182300
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00182400
.ZIMFLX               ANOP  ,                                           00182500
.*-------------------------------------------------------------------   00182600
.***AI.L05 XMSTRT_OPTIONS BL2                                           00182700
&ZW                   SETC  ''                                          00182800
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00182900
.*-------------------------------------------------------------------   00183000
.***AI.L08 XMSTRT_OPTIONS "YES"                                         00183100
.***      BL2'1XXXXXXXXXXXXXXX'                                         00183200
         AIF   ('&XEND_FLOW' NE 'YES').ZI3A                             00183300
&ZW                   SETC  '&ZW.1'                                     00183400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00183500
                      AGO   .ZI3C                                       00183600
.*                                                                      00183700
.ZI3A                 ANOP  ,                                           00183800
&ZW                   SETC  '&ZW.0'                                     00183900
.ZI3C                 ANOP  ,                                           00184000
.*-------------------------------------------------------------------   00184100
.***AI.L08 XMSTRT_OPTIONS "YES"                                         00184200
.***      BL2'X1XXXXXXXXXXXXXX'                                         00184300
         AIF   ('&XMSG_RECEIVED' NE 'YES').ZI4A                         00184400
&ZW                   SETC  '&ZW.1'                                     00184500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00184600
                      AGO   .ZI4C                                       00184700
.*                                                                      00184800
.ZI4A                 ANOP  ,                                           00184900
&ZW                   SETC  '&ZW.0'                                     00185000
.ZI4C                 ANOP  ,                                           00185100
.*-------------------------------------------------------------------   00185200
.***AI.L08 XMSTRT_OPTIONS "IWM4MSTR"                                    00185300
.***      BL2'XXXXXXXXXXXXXXX1'                                         00185400
&ZW                   SETC  '&ZW.00000000000001'                        00185500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00185600
.*-------------------------------------------------------------------   00185700
.***AI.L10 XMSTRT_OPTIONS BL2                                           00185800
                      AIF   ('&ZCLNG' NE 'YES').ZI5E  ALL ZERO BITS     00185900
&ZOPN                 SETA  &ZOPN+1                                     00186000
&ZOPL(&ZOPN)          SETC  ' '                                         00186100
&ZOPO(&ZOPN)          SETC  'OC'                                        00186200
&ZOPV(&ZOPN)          SETC  '1(2,1),=BL2''&ZW'''                        00186300
&ZOPD(&ZOPN)          SETC  '++ 56 BL2'                                 00186400
.ZI5E                 ANOP  ,                                           00186500
.*-------------------------------------------------------------------   00186600
.***AI.L25  XMONTKN XL4                                                 00186700
                      AIF   ('&ZXMONTKN' EQ '').ZI7E                    00186800
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI7E              00186900
&ZCGPR                SETC  '&XMONTKN'                                  00187000
.*                                                                      00187100
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI7B               00187200
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      00187300
                      AGO   .ZI7D                                       00187400
.ZI7B                 ANOP  ,                                           00187500
.*                                                                      00187600
&ZC                   SETC  '&XMONTKN'(1,1)                             00187700
                      AIF   (T'&ZC NE 'N').ZI7D                         00187800
&ZC                   SETC  '&XMONTKN'                                  00187900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00188000
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          00188100
.*                                                                      00188200
.ZI7D                 ANOP  ,                                           00188300
.*                                                                      00188400
&ZOPN                 SETA  &ZOPN+1                                     00188500
&ZOPL(&ZOPN)          SETC  ' '                                         00188600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00188700
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00188800
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      00188900
.*                                                                      00189000
.ZI7E                 ANOP  ,                                           00189100
.*-------------------------------------------------------------------   00189200
.***AI.L19 ADDR3164 XEWLM_S_PACORR AD                                   00189300
                      AIF   ('&ZXEWLM_S_PACORR' EQ '').ZI8H             00189400
&ZCLNG                SETC  '&XEWLM_S_PACORR'                           00189500
&ZCGPR                SETC  '14'                                        00189600
         AIF   ('&XEWLM_S_PACORR'(1,1) EQ '(').ZI8F  IN GPR             00189700
.*                                                                      00189800
&ZOPN                 SETA  &ZOPN+1                                     00189900
&ZOPL(&ZOPN)          SETC  ' '                                         00190000
&ZOPO(&ZOPN)          SETC  'LA'                                        00190100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00190200
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_PACORR XEWLM_S_PACORR'        00190300
.*                                                                      00190400
                      AGO   .ZI8G                                       00190500
.*                                                                      00190600
.ZI8F                 ANOP  ,                                           00190700
&ZCGPR   SETC  '&XEWLM_S_PACORR'(2,K'&XEWLM_S_PACORR-2)                 00190800
.*                                                                      00190900
.ZI8G                 ANOP  ,                                           00191000
                      AIF   ('&SYSAM64' EQ 'YES').ZI8H1A                00191100
.*                                                                      00191200
&ZOPN                 SETA  &ZOPN+1                                     00191300
&ZOPL(&ZOPN)          SETC  ' '                                         00191400
&ZOPO(&ZOPN)          SETC  'ST'                                        00191500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+8(,1)'                            00191600
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_PACORR XEWLM_S_PACORR'        00191700
.*                                                                      00191800
                      AGO   .ZI8H                                       00191900
.ZI8H1A               ANOP  ,                                           00192000
.*                                                                      00192100
&ZOPN                 SETA  &ZOPN+1                                     00192200
&ZOPL(&ZOPN)          SETC  ' '                                         00192300
&ZOPO(&ZOPN)          SETC  'STG'                                       00192400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00192500
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_PACORR XEWLM_S_PACORR'        00192600
.*                                                                      00192700
.ZI8H                 ANOP  ,                                           00192800
.*-------------------------------------------------------------------   00192900
.***AI.L19 ADDR3164 XEWLM_S_CURCORR AD                                  00193000
                      AIF   ('&ZXEWLM_S_CURCORR' EQ '').ZI9H            00193100
&ZCLNG                SETC  '&XEWLM_S_CURCORR'                          00193200
&ZCGPR                SETC  '14'                                        00193300
         AIF   ('&XEWLM_S_CURCORR'(1,1) EQ '(').ZI9F  IN GPR            00193400
.*                                                                      00193500
&ZOPN                 SETA  &ZOPN+1                                     00193600
&ZOPL(&ZOPN)          SETC  ' '                                         00193700
&ZOPO(&ZOPN)          SETC  'LA'                                        00193800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00193900
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_CURCORR XEWLM_S_CURCORR'      00194000
.*                                                                      00194100
                      AGO   .ZI9G                                       00194200
.*                                                                      00194300
.ZI9F                 ANOP  ,                                           00194400
&ZCGPR   SETC  '&XEWLM_S_CURCORR'(2,K'&XEWLM_S_CURCORR-2)               00194500
.*                                                                      00194600
.ZI9G                 ANOP  ,                                           00194700
                      AIF   ('&SYSAM64' EQ 'YES').ZI9H1A                00194800
.*                                                                      00194900
&ZOPN                 SETA  &ZOPN+1                                     00195000
&ZOPL(&ZOPN)          SETC  ' '                                         00195100
&ZOPO(&ZOPN)          SETC  'ST'                                        00195200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+16(,1)'                           00195300
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_CURCORR XEWLM_S_CURCORR'      00195400
.*                                                                      00195500
                      AGO   .ZI9H                                       00195600
.ZI9H1A               ANOP  ,                                           00195700
.*                                                                      00195800
&ZOPN                 SETA  &ZOPN+1                                     00195900
&ZOPL(&ZOPN)          SETC  ' '                                         00196000
&ZOPO(&ZOPN)          SETC  'STG'                                       00196100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00196200
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_CURCORR XEWLM_S_CURCORR'      00196300
.*                                                                      00196400
.ZI9H                 ANOP  ,                                           00196500
.*-------------------------------------------------------------------   00196600
.***AI.L18 ADDR3164 XEWLM_RCVD_CORR AD                                  00196700
         AIF   ('&XEWLM_RCVD_CORR' NE 'NO_EWLM_RCVD_CORR').ZI10         00196800
&ZXEWLM_RCVD_CORR     SETC  ''             RESET INPUT/OUTPUT           00196900
.ZI10                 ANOP  ,                                           00197000
.*-------------------------------------------------------------------   00197100
.***AI.L19 ADDR3164 XEWLM_RCVD_CORR AD                                  00197200
                      AIF   ('&ZXEWLM_RCVD_CORR' EQ '').ZI10H           00197300
&ZCLNG                SETC  '&XEWLM_RCVD_CORR'                          00197400
&ZCGPR                SETC  '14'                                        00197500
         AIF   ('&XEWLM_RCVD_CORR'(1,1) EQ '(').ZI10F  IN GPR           00197600
.*                                                                      00197700
&ZOPN                 SETA  &ZOPN+1                                     00197800
&ZOPL(&ZOPN)          SETC  ' '                                         00197900
&ZOPO(&ZOPN)          SETC  'LA'                                        00198000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00198100
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_RCVD_CORR XEWLM_RCVD_CORR'      00198200
.*                                                                      00198300
                      AGO   .ZI10G                                      00198400
.*                                                                      00198500
.ZI10F                ANOP  ,                                           00198600
&ZCGPR   SETC  '&XEWLM_RCVD_CORR'(2,K'&XEWLM_RCVD_CORR-2)               00198700
.*                                                                      00198800
.ZI10G                ANOP  ,                                           00198900
                      AIF   ('&SYSAM64' EQ 'YES').ZI10H1A               00199000
.*                                                                      00199100
&ZOPN                 SETA  &ZOPN+1                                     00199200
&ZOPL(&ZOPN)          SETC  ' '                                         00199300
&ZOPO(&ZOPN)          SETC  'ST'                                        00199400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+24(,1)'                           00199500
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_RCVD_CORR XEWLM_RCVD_CORR'      00199600
.*                                                                      00199700
                      AGO   .ZI10H                                      00199800
.ZI10H1A              ANOP  ,                                           00199900
.*                                                                      00200000
&ZOPN                 SETA  &ZOPN+1                                     00200100
&ZOPL(&ZOPN)          SETC  ' '                                         00200200
&ZOPO(&ZOPN)          SETC  'STG'                                       00200300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,24(,1)'                             00200400
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_RCVD_CORR XEWLM_RCVD_CORR'      00200500
.*                                                                      00200600
.ZI10H                ANOP  ,                                           00200700
.*-------------------------------------------------------------------   00200800
.***AI.L18 ADDR3164 XARRIVALTIME AD                                     00200900
         AIF   ('&XARRIVALTIME' NE 'NO_ARRIVALTIME').ZI11               00201000
&ZXARRIVALTIME        SETC  ''             RESET INPUT/OUTPUT           00201100
.ZI11                 ANOP  ,                                           00201200
.*-------------------------------------------------------------------   00201300
.***AI.L19 ADDR3164 XARRIVALTIME AD                                     00201400
                      AIF   ('&ZXARRIVALTIME' EQ '').ZI11H              00201500
&ZCLNG                SETC  '&XARRIVALTIME'                             00201600
&ZCGPR                SETC  '14'                                        00201700
         AIF   ('&XARRIVALTIME'(1,1) EQ '(').ZI11F  IN GPR              00201800
.*                                                                      00201900
&ZOPN                 SETA  &ZOPN+1                                     00202000
&ZOPL(&ZOPN)          SETC  ' '                                         00202100
&ZOPO(&ZOPN)          SETC  'LA'                                        00202200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00202300
&ZOPD(&ZOPN)          SETC  '++ &ZXARRIVALTIME XARRIVALTIME'            00202400
.*                                                                      00202500
                      AGO   .ZI11G                                      00202600
.*                                                                      00202700
.ZI11F                ANOP  ,                                           00202800
&ZCGPR   SETC  '&XARRIVALTIME'(2,K'&XARRIVALTIME-2)                     00202900
.*                                                                      00203000
.ZI11G                ANOP  ,                                           00203100
                      AIF   ('&SYSAM64' EQ 'YES').ZI11H1A               00203200
.*                                                                      00203300
&ZOPN                 SETA  &ZOPN+1                                     00203400
&ZOPL(&ZOPN)          SETC  ' '                                         00203500
&ZOPO(&ZOPN)          SETC  'ST'                                        00203600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+32(,1)'                           00203700
&ZOPD(&ZOPN)          SETC  '++ &ZXARRIVALTIME XARRIVALTIME'            00203800
.*                                                                      00203900
                      AGO   .ZI11H                                      00204000
.ZI11H1A              ANOP  ,                                           00204100
.*                                                                      00204200
&ZOPN                 SETA  &ZOPN+1                                     00204300
&ZOPL(&ZOPN)          SETC  ' '                                         00204400
&ZOPO(&ZOPN)          SETC  'STG'                                       00204500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,32(,1)'                             00204600
&ZOPD(&ZOPN)          SETC  '++ &ZXARRIVALTIME XARRIVALTIME'            00204700
.*                                                                      00204800
.ZI11H                ANOP  ,                                           00204900
.*-------------------------------------------------------------------   00205000
.***AI.L25  XMONTKN64 XL8                                               00205100
                      AIF   ('&ZXMONTKN64' EQ '').ZI12E                 00205200
                      AIF   ('&ZXMONTKN64' EQ 'OUTPUT').ZI12E           00205300
&ZCGPR                SETC  '&XMONTKN64'                                00205400
.*                                                                      00205500
                      AIF   ('&XMONTKN64'(1,1) NE '(').ZI12B            00205600
&ZCGPR   SETC  '0('.'&XMONTKN64'(2,K'&XMONTKN64-2).')'                  00205700
                      AGO   .ZI12D                                      00205800
.ZI12B                ANOP  ,                                           00205900
.*                                                                      00206000
&ZC                   SETC  '&XMONTKN64'(1,1)                           00206100
                      AIF   (T'&ZC NE 'N').ZI12D                        00206200
&ZC                   SETC  '&XMONTKN64'                                00206300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00206400
&ZCGPR                SETC  '=BL8''&XMONTKN64'''                        00206500
.*                                                                      00206600
.ZI12D                ANOP  ,                                           00206700
.*                                                                      00206800
&ZOPN                 SETA  &ZOPN+1                                     00206900
&ZOPL(&ZOPN)          SETC  ' '                                         00207000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00207100
&ZOPV(&ZOPN)          SETC  '40(8,1),&ZCGPR'                            00207200
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN64 XMONTKN64'                  00207300
.*                                                                      00207400
.ZI12E                ANOP  ,                                           00207500
.*-------------------------------------------------------------------   00207600
&ZOPN1                SETA &ZOPN                                        00207700
.*******************************************************************    00207800
.***  PROCESS IWM4MSTR OUTPUT PARAMETERS                                00207900
.*******************************************************************    00208000
                      ACTR  10000                                       00208100
.*******************************************************************    00208200
.***AO.X02  RETURN CODE PROCESSING                                      00208300
.*******************************************************************    00208400
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00208500
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00208600
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00208700
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00208800
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00208900
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00209000
&ZOPN                 SETA  &ZOPN+1                                     00209100
&ZOPL(&ZOPN)          SETC  ' '                                         00209200
&ZOPO(&ZOPN)          SETC  'ST'                                        00209300
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00209400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00209500
                      AGO   .ZMRETX                                     00209600
.*                                                                      00209700
.ZMRET2               ANOP  ,                                           00209800
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00209900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00210000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00210100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00210200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00210300
&ZOPN                 SETA  &ZOPN+1                                     00210400
&ZOPL(&ZOPN)          SETC  ' '                                         00210500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00210600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00210700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00210800
.ZMRETX               ANOP  ,                                           00210900
.*******************************************************************    00211000
.***AO.X03  REASON CODE PROCESSING                                      00211100
.*******************************************************************    00211200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00211300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00211400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00211500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00211600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00211700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00211800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00211900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00212000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00212100
&ZOPN                 SETA  &ZOPN+1                                     00212200
&ZOPL(&ZOPN)          SETC  ' '                                         00212300
&ZOPO(&ZOPN)          SETC  'ST'                                        00212400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00212500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00212600
                      AGO   .ZMRSNX                                     00212700
.*                                                                      00212800
.ZMRSN2               ANOP  ,                                           00212900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00213000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00213100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00213200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00213300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00213400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00213500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00213600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00213700
&ZOPN                 SETA  &ZOPN+1                                     00213800
&ZOPL(&ZOPN)          SETC  ' '                                         00213900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00214000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00214100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00214200
.ZMRSNX               ANOP  ,                                           00214300
.*******************************************************************    00214400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00214500
.*******************************************************************    00214600
.ZMFLX                ANOP  ,              MF=L PROCESSING              00214700
.*******************************************************************    00214800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00214900
.*******************************************************************    00215000
                      ACTR  10000                                       00215100
.*                                                                      00215200
                      LCLA  &ZLC           COLUMN POSITION              00215300
                      LCLA  &ZOPX          LIST TABLE INDEX             00215400
                      LCLC  &ZLL           LABEL                        00215500
                      LCLC  &ZLOP          OPERATION                    00215600
                      LCLC  &ZLV           VALUE                        00215700
                      LCLC  &ZLD           DESCRIPTION                  00215800
.*                                                                      00215900
&ZOPX                 SETA  1                                           00216000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00216100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00216200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00216300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00216400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00216500
                      AIF   (K'&ZLD LE 0).ZL5                           00216600
&ZLC                  SETA  35             COMMENT COLUMN               00216700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00216800
&ZLC                  SETA  33             COMMMENT COLUMN              00216900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00217000
&ZLV                  SETC  '&ZLV'.' '                                  00217100
                      AGO   .ZL3                                        00217200
.*                                                                      00217300
.ZL4                  ANOP  ,                                           00217400
&ZLV                  SETC  '&ZLV'.' '                                  00217500
.ZL5                  ANOP  ,                                           00217600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00217700
.*                                                                      00217800
&ZLL     &ZLOP &ZLV                                                     00217900
.*                                                                      00218000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00218100
                      AGO   .ZL2           CONTINUE LOOPING             00218200
.*                                                                      00218300
.ZLX                  ANOP  ,                                           00218400
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00218500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00218600
         AIF   ('&XEWLM' NE 'YES').Mstr_NoEwlm                     @L0A 00218700
         LCLC  &T_Montkn                                                00218800
.*--------------------------------------------------------------------- 00218900
.* Do we run on HBB7790 or higher                                       00219000
.*--------------------------------------------------------------------- 00219100
         LLGT  14,16(0,0)              Get CVT address                  00219200
         TM    CVTOSLV6-CVT(14),CVTH7790   Test for HBB7790             00219300
         JO    Mstr&SYSNDX._Begin      Branch when Lvl is present  @P1C 00219400
         LA    0,IwmRsnCodeBadVersion  HBB7790 is required              00219500
         LA    15,IwmRetCodeInvocError Set Return Code                  00219600
         J     Mstr&SYSNDX._End        Branch to end label         @P1C 00219700
Mstr&SYSNDX._Begin DS 0H                                                00219800
.*--------------------------------------------------------------------- 00219900
.* MONTKN / MONTKN64 - Setup                                            00220000
.*--------------------------------------------------------------------- 00220100
         AIF ('&MONTKN' EQ '').Mstr_Montkn64                            00220200
&T_Montkn SETC '&MONTKN'                                                00220300
         AIF   ('&MONTKN'(1,1) NE '(').Mstr_Montkn31_Code               00220400
&T_Montkn SETC '&MONTKN'(2,K'&MONTKN-2)                                 00220500
&T_Montkn SETC '0(&T_Montkn.)'                                          00220600
.Mstr_Montkn31_Code ANOP                                                00220700
.* R14 is now a valid base displacement                                 00220800
         LLGT  14,&T_Montkn            Fetch 31bit Monitoring Token     00220900
         AGO .Mstr_Montkn_End                                           00221000
.Mstr_Montkn64 ANOP                                                     00221100
&T_Montkn SETC '&MONTKN64'                                              00221200
         AIF   ('&MONTKN64'(1,1) NE '(').Mstr_Montkn64_Code             00221300
&T_Montkn SETC '&MONTKN64'(2,K'&MONTKN-2)                               00221400
&T_Montkn SETC '0(&T_Montkn.)'                                          00221500
.Mstr_Montkn64_Code ANOP                                                00221600
.* R14 is now a valid base displacement                                 00221700
         LG    14,&T_Montkn            Fetch 64bit Monitoring Token     00221800
.Mstr_Montkn_End ANOP                                                   00221900
         LTGR  14,14                   Test the MONTKN value            00222000
         JNZ   Mstr&SYSNDX._EnvPresent Branch when MON env is present   00222100
*                                                                  @P1C 00222200
         LA    0,IwmRsnCodeNoMonenv    Set reason code = No Mon Env     00222300
         LA    15,IwmRetCodeWarning    Set warning return code          00222400
         J     Mstr&SYSNDX._End        Branch to end label         @P1C 00222500
Mstr&SYSNDX._EnvPresent DS 0H                                           00222600
         AIF   ('&SYSAM64' EQ 'YES').Mstr_A64_Switch1              @P0C 00222700
         SAM64                                                          00222800
.Mstr_A64_Switch1 ANOP                                                  00222900
         LLILF 15,PB_ID_CONST          Load PB eyecatcher into R15 @P1A 00223000
         CL    15,PB_ID-PB(,14)        Test Mon eyecatcher         @P1C 00223100
         JE    Mstr&SYSNDX._EnvOk      Branch when MON env passes  @P1C 00223200
         AIF   ('&SYSAM64' EQ 'YES').Mstr_A31_Switch1              @P0C 00223300
         SAM31                                                          00223400
.Mstr_A31_Switch1 ANOP                                                  00223500
         LA    0,IwmRsnCodeBadMonenv   Set reason code = Bad Mon Env    00223600
         LA    15,IwmRetCodeInvocError SET INVOCATION ERROR RETURN CODE 00223700
         J     Mstr&SYSNDX._End        Branch to end label         @P1C 00223800
Mstr&SYSNDX._EnvOk DS 0H                                                00223900
**  Why do we not store the value into the parameter list?? Dieter      00224000
         ST    1,PB_EWLM_PARMLIST-PB(,14) Store Addr of parmlist        00224100
         MVI   PB_EWLM_REQUEST-PB(14),PB_EWLM_REQUEST_IWM4MSTR          00224200
         AIF   ('&SYSAM64' EQ 'YES').Mstr_A31_Switch2              @P0C 00224300
         SAM31                                                          00224400
.Mstr_A31_Switch2 ANOP                                                  00224500
         LGR   1,14                    GPR1  ->  PB                     00224600
         LLGT  14,16(0,0)              Get CVT Address                  00224700
         LLGT  14,X'8C'(14,0)          Get ECVT Address                 00224800
         LLGT  14,X'C4'(14,0)          Get WMVT Address                 00224900
         AIF   ('&SYSAM64' NE 'YES').Mstr_Amode31                       00225000
         LLGT  15,X'16C'(14,0)         Get M_Upde Entry Point Addr      00225100
         BASR  14,15                   Call 64bit Entry Point           00225200
         AGO   .Mstr_End                                                00225300
.Mstr_Amode31 ANOP                                                      00225400
         LLGTR 1,1                     Clear High Half of R1            00225500
         LLGT  15,X'168'(14,0)         Get M_Upde Entry Point Addr      00225600
         BASR  14,15                   Call 31bit Entry Point           00225700
         AGO   .Mstr_End                                           @L0A 00225800
.Mstr_NoEwlm  ANOP                                                 @L0A 00225900
         LA    15,IWMRETCODEOK         Set RC=0                    @L0A 00226000
.Mstr_End ANOP                                                          00226100
Mstr&SYSNDX._End DS 0H                 END LABEL                        00226200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00226300
.ZLINKX               ANOP  ,                                           00226400
.*******************************************************************    00226500
.***AP.X01  FORMAT GENERATED CODE                                       00226600
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00226700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00226800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00226900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00227000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00227100
                      AIF   (K'&ZLD LE 0).ZL51                          00227200
&ZLC                  SETA  35             COMMENT COLUMN               00227300
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00227400
&ZLC                  SETA  33             COMMENT COLUMN               00227500
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00227600
&ZLV                  SETC  '&ZLV'.' '                                  00227700
                      AGO   .ZL31                                       00227800
.*                                                                      00227900
.ZL41                 ANOP  ,                                           00228000
&ZLV                  SETC  '&ZLV'.' '                                  00228100
.ZL51                 ANOP  ,                                           00228200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00228300
.*                                                                      00228400
&ZLL     &ZLOP &ZLV                                                     00228500
.*                                                                      00228600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00228700
                      AGO   .ZL21          CONTINUE LOOPING             00228800
.*                                                                      00228900
.ZLX1                 ANOP  ,                                           00229000
.*******************************************************************    00229100
.***AP.X02  END OF IWM4MSTR MACRO                                       00229200
&ZIWM4MSTR            SETC  'YES'          SET IWM4MSTR USED            00229300
         POP   PRINT                                                    00229400
*                                            IWM4MSTR-0                 00229500
         SPACE 1                                                        00229600
.ZLX2                 ANOP  ,                                           00229700
         MEND                                                           00229800
**********************************************************************/ 00229900
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00230000
*%IWM4MSTR: MACRO KEYS(MONTKN,MONTKN64,END_FLOW,MSG_RECEIVED,EWLM,      00230100
*                 ARRIVALTIME,EWLM_S_PACORR,EWLM_S_CURCORR,             00230200
*                 EWLM_RCVD_CORR,RETCODE,RSNCODE,PLISTVER,MF);          00230300
*  ANS('?'!!MACLABEL!!' '!!'IWM4MSRP '!!MACLIST!!                       00230400
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00230500
*%END IWM4MSTR;                                                         00230600

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  HSPSERV                               -92/07/31-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Hiperspace Services                           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5695-047 COPYRIGHT IBM CORP. 1988, 1992                         * 00001200
*                                                                     * 00001300
* STATUS= HBB4430                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*                                                                     * 00002100
*      HSPSERV provides the interface to the hiperspace read and      * 00002200
*      write services SREAD, CREAD, SWRITE, and CWRITE.  These        * 00002300
*      services are used to read one or more blocks of data from a    * 00002400
*      hiperspace to an address space or to write one or more blocks  * 00002500
*      of data from an address space to a hiperspace.  A block is a   * 00002600
*      unit of 4K bytes starting on a 4k boundary.  The HSPSERV user  * 00002700
*      specifies the area in the hiperspace to be read or written by  * 00002800
*      indicating the STOKEN of the hiperspace and the starting VSA   * 00002900
*      in the hiperspace.  The area of the address space from which   * 00003000
*      to read or write is specified via the starting VSA in the      * 00003100
*      caller's home address space.  As an option, for CACHE type     * 00003200
*      hiperspaces only, the caller's primary address space or the    * 00003300
*      Common Storage Area (CSA) may be specified for a read or write * 00003400
*      in lieu of the caller's home address space.                    * 00003500
*                                                                     * 00003600
*      The caller may also optionally specify an ALET, via the        * 00003700
*      HSPALET keyword, that addresses the hiperspace on the caller's * 00003800
*      current DU or PASN access list.  Providing an ALET will, in    * 00003900
*      many environments, serve to expedite the processing of an      * 00004000
*      HSPSERV request.                                               * 00004100
*                                                                     * 00004200
*      Problem programs running with PSW key 8-F are required to      * 00004300
*      specify an ALET when accessing a shared SCROLL type            * 00004400
*      hiperspace, as are programs that access a non-shared SCROLL    * 00004500
*      hiperspace and whose home and primary address spaces are       * 00004600
*      different.  HSPSERV with HSPALET may not be invoked while a    * 00004700
*      DIV SAVE is current for the hiperspace being accessed, and     * 00004800
*      HSPALET may not be specified in conjunction with the           * 00004900
*      RELEASE=YES option on SREAD.                                   * 00005000
*                                                                     * 00005100
*      If HSPALET is specified, the caller must provide a 144 byte    * 00005200
*      work area in the caller's primary address space and addressed  * 00005300
*      by AR/GPR 13 (note that AR 13 must accurately address this     * 00005400
*      area, even for non-AR mode callers), and must also issue the   * 00005500
*      SYSSTATE macro prior to invoking HSPSERV so that the caller's  * 00005600
*      ASC mode is appropriately reflected.  The use of HSPALET may   * 00005700
*      cause the parameter list and range list to be modified by      * 00005800
*      hiperspace services.                                           * 00005900
*                                                                     * 00006000
*      If any I/O is required to read or write a data page (I/O will  * 00006100
*      be required only for SCROLL type hiperspaces and only when     * 00006200
*      reading or writing to auxiliary storage or to a DIV object on  * 00006300
*      permanent DASD), it will be done asynchronously with the       * 00006400
*      request.  That is, the caller will receive control back after  * 00006500
*      the I/O is initiated, but possibly before the I/O physically   * 00006600
*      completes.  Even though the I/O may not be complete the        * 00006700
*      address space virtual storage can be immediately used upon     * 00006800
*      return.  The system will ensure that the correct data is       * 00006900
*      available when referenced.  CACHE reads and writes are always  * 00007000
*      done synchronously with the request.                           * 00007100
*                                                                     * 00007200
*      The following restrictions apply:                              * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*      1.  The HSPSERV read and write services cannot be used for a   * 00007600
*          hiperspace that is mapped as a DIV object.  A SCROLL type  * 00007700
*          hiperspace itself, however, may map a DIV object on        * 00007800
*          permanent storage.                                         * 00007900
*                                                                     * 00008000
*      2.  If a hiperspace maps a DIV object, then an SWRITE may not  * 00008100
*          be issued against any range in the hiperspace while a DIV  * 00008200
*          SAVE for any part of that range is current.  Furthermore,  * 00008300
*          if HSPALET is specified then neither SWRITE nor SREAD may  * 00008400
*          be issued against any portion of the hiperspace while a    * 00008500
*          DIV SAVE is current for any part of the hiperspace.        * 00008600
*                                                                     * 00008700
*      3.  All READ and WRITE calls for a non-shared SCROLL type      * 00008800
*          hiperspace must be done while in non-cross memory mode     * 00008900
*          (i.e., home=primary=secondary), except when the HSPALET    * 00009000
*          keyword is used.  The caller's home and primary address    * 00009100
*          spaces may be different for all READs and WRITEs to a      * 00009200
*          shared SCROLL type hiperspace, independent of the HSPALET  * 00009300
*          keyword.                                                   * 00009400
*                                                                     * 00009500
*          Regardless of whether the SCROLL type hiperspace is shared * 00009600
*          or non-shared and whether or not HSPALET is specified, the * 00009700
*          virtual storage in the address space must be in a private  * 00009800
*          area subpool in the caller's home address space.           * 00009900
*                                                                     * 00010000
*          For a READ or WRITE against a CACHE type hiperspace, the   * 00010100
*          caller's home address space may be different from the      * 00010200
*          caller's primary address space. In this case, the          * 00010300
*          specified virtual storage in the address space may be in a * 00010400
*          private area subpool of the caller's primary address space * 00010500
*          in lieu of the private area in the caller's home address   * 00010600
*          space or in the Common Storage Area (CSA).                 * 00010700
*                                                                     * 00010800
*      4.  The address space virtual for a SCROLL type hiperspace     * 00010900
*          must be from a non-DREF private area subpool and cannot be * 00011000
*          page fixed.  For a CACHE type hiperspace, the address      * 00011100
*          space virtual may be from a private area subpool (DREF or  * 00011200
*          non-DREF) or from the common area, but not both on the     * 00011300
*          same invocation.  It may be page fixed. For both types of  * 00011400
*          hiperspaces, the address space virtual cannot be part of a * 00011500
*          VIO window nor may it map a DIV object.                    * 00011600
*                                                                     * 00011700
*          Unless the caller is executing with PSW key zero, the      * 00011800
*          access key of the address space virtual will be compared   * 00011900
*          with the caller's PSW key.  If there is a mismatch, an     * 00012000
*          SREAD, SWRITE, or CREAD request will not be honored. A     * 00012100
*          CWRITE request, on a key mismatch, will be honored only if * 00012200
*          the address space virtual storage is not fetch protected.  * 00012300
*                                                                     * 00012400
*          NOTE: On a key mismatch an SWRITE is not honored even if   * 00012500
*          the address space virtual storage is not fetch protected   * 00012600
*          because an SWRITE, as explained later, is a destructive    * 00012700
*          write.                                                     * 00012800
*                                                                     * 00012900
*      5.  If the specified hiperspace is a non-shared SCROLL type    * 00013000
*          and HSPALET is not specified, then any non-authorized      * 00013100
*          (problem program, PSW key 8-F) HSPSERV caller must run     * 00013200
*          under the task that owns the hiperspace.  If HSPALET is    * 00013300
*          specified or the caller is authorized, the hiperspace may  * 00013400
*          be owned by any task within the caller's home address      * 00013500
*          space.                                                     * 00013600
*                                                                     * 00013700
*          If the specified hiperspace is a CACHE type or a shared    * 00013800
*          SCROLL type, it may be owned by any task in the system     * 00013900
*          provided that any one of the following is true:            * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*          o   the owner is in the caller's home address space        * 00014300
*                                                                     * 00014400
*          o   the owner is in the caller's primary address space     * 00014500
*                                                                     * 00014600
*          o   the owner is in a non-swappable address space.         * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*          Unless the caller is executing with PSW key zero, the      * 00015100
*          access key of the hiperspace will be compared with the     * 00015200
*          caller's PSW key.  If there is a mismatch, an SWRITE or    * 00015300
*          CWRITE request or an SREAD with RELEASE request will not   * 00015400
*          be honored. An SREAD (without RELEASE) or a CREAD request, * 00015500
*          on a key mismatch, will be honored only if the hiperspace  * 00015600
*          was created with fetch protection off.                     * 00015700
*                                                                     * 00015800
*      6.  The specified VSA of both the hiperspace and the address   * 00015900
*          space must be on a 4k boundary.  Data can only be moved in * 00016000
*          units of 4k bytes.                                         * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*      REGISTER USAGE:                                                * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*   GPRs 2 through 13 and ARs 2 through 13 are preserved.  GPRs 14    * 00016800
*   through 1 and ARs 14 through 1 are unpredictable.                 * 00016900
*                                                                     * 00017000
*01* EXTERNAL CLASSIFICATION:                                         * 00017100
*                                                                     * 00017200
*02* PI:   BASE                                                       * 00017300
*                                                                     * 00017400
*02* NONE: FIELDS                                                     * 00017500
*          IOPATH=YES                                                 * 00017600
*                                                                     * 00017700
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00017800
*                                                                     * 00017900
*01* ENVIRONMENT:                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*      Dispatchable unit mode: Task or SRB mode.                      * 00018300
*                                                                     * 00018400
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00018500
*                        key.                                         * 00018600
*                                                                     * 00018700
*                        In order to do a CREAD or CWRITE, the caller * 00018800
*                        must be executing in supervisor state and/or * 00018900
*                        with a system key (0-7).                     * 00019000
*                                                                     * 00019100
*      AMODE:            31-bit.                                      * 00019200
*                                                                     * 00019300
*      ASC mode:         Primary or Access Register.                  * 00019400
*                                                                     * 00019500
*      Serialization:                                                 * 00019600
*                                                                     * 00019700
*                        SCROLL type hiperspace calls must be issued  * 00019800
*                        while enabled and unlocked.                  * 00019900
*                                                                     * 00020000
*                        CACHE type hiperspace calls with IOPATH(YES) * 00020100
*                        not specified may be issued while enabled or * 00020200
*                        disabled.  If IOPATH(YES) is specified, then * 00020300
*                        the caller must be disabled.  Locks below    * 00020400
*                        the RSM lock in the locking hierarchy may be * 00020500
*                        held. The RSM lock and any locks higher than * 00020600
*                        the RSM lock may not be held.                * 00020700
*                                                                     * 00020800
*      Restrictions:     For a CACHE type hiperspace, the input       * 00020900
*                        parameter list, range list, and, if HSPALET  * 00021000
*                        was specified, work area must be in          * 00021100
*                        non-pageable storage and be either in the    * 00021200
*                        common area or in the private area of the    * 00021300
*                        caller's primary address space.              * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*01* SYNTAX:                                                          * 00021800
*                                                                     * 00021900
*Ýxlabel¨  HSPSERV  Ð  SREAD                                          * 00022000
*                   !     ,STOKEN=xstoken                             * 00022100
*                   !    Ý,NUMRANGE=»xnumrange!1º¨                    * 00022200
*                   !     ,RANGLIST=xranglist                         * 00022300
*                   !   ÐÝ,RELEASE=NO                                 * 00022400
*                   !   !    Ý,HSPALET=»xhspalet!0º¨¨                 * 00022500
*                   !   ¿Ý,RELEASE=YES¨                               * 00022600
*                   Ô ,SWRITE                                         * 00022700
*                   !     ,STOKEN=xstoken                             * 00022800
*                   !    Ý,NUMRANGE=»xnumrange!1º¨                    * 00022900
*                   !     ,RANGLIST=xranglist                         * 00023000
*                   !    Ý,HSPALET=»xhspalet!0º¨                      * 00023100
*                   Ô ,CREAD                                          * 00023200
*                   !     ,STOKEN=xstoken                             * 00023300
*                   !    Ý,ADDRSP=»HOME!PRIMARY!COMMONº¨              * 00023400
*                   !    Ý,NUMRANGE=»xnumrange!1º¨                    * 00023500
*                   !     ,RANGLIST=xranglist                         * 00023600
*                   !   ÐÝ,IOPATH=NO                                  * 00023700
*                   !   !    Ý,HSPALET=»xhspalet!0º¨¨                 * 00023800
*                   !   ¿Ý,IOPATH=YES¨                                * 00023900
*                   ¿ ,CWRITE                                         * 00024000
*                         ,STOKEN=xstoken                             * 00024100
*                        Ý,ADDRSP=»HOME!PRIMARY!COMMONº¨              * 00024200
*                        Ý,NUMRANGE=»xnumrange!1º¨                    * 00024300
*                         ,RANGLIST=xranglist                         * 00024400
*                        Ý,KEEP=»YES!NOº¨                             * 00024500
*                       ÐÝ,IOPATH=NO                                  * 00024600
*                       !    Ý,HSPALET=»xhspalet!0º¨¨                 * 00024700
*                       ¿Ý,IOPATH=YES¨                                * 00024800
*                    Ý,RETCODE=xretcode¨                              * 00024900
*                    Ý,RSNCODE=xrsncode¨                              * 00025000
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00025100
*                   ÐÝ,MF=S¨                                          * 00025200
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00025300
*                   ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00025400
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*      Where:                                                         * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*      Ýxlabel¨                                                       * 00026100
*          is an optional symbol, starting in column 1, that is the   * 00026200
*          name on the HSPSERV macro invocation.  The name must       * 00026300
*          conform to the rules for an ordinary assembler language    * 00026400
*          symbol.                                                    * 00026500
*          DEFAULT: No name.                                          * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*      The following is a set of mutually exclusive keys.  This set   * 00027100
*      is required; only one key must be specified.                   * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*      SREAD                                                          * 00027500
*          is a keyword used to request that data be read from a      * 00027600
*          SCROLL hiperspace.                                         * 00027700
*                                                                     * 00027800
*          For a SCROLL type hiperspace, the data is always           * 00027900
*          retrievable (compare to CACHE type), but may or may not be * 00028000
*          read synchronously with the request.  That is, if physical * 00028100
*          I/O is required to satisfy the request, it may not be      * 00028200
*          complete when control is returned to the caller.  The      * 00028300
*          caller may, however, always reference the data immediately * 00028400
*          upon return from SREAD.  The system will automatically     * 00028500
*          ensure that the correct data is presented.                 * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*          STOKEN=xstoken                                             * 00028900
*              is the name (RS-type), or address in register          * 00029000
*              (2)-(12), of a required 8 character input variable     * 00029100
*              that contains the STOKEN for the SCROLL hiperspace     * 00029200
*              from which the data is to be read.  For non-authorized * 00029300
*              callers, the hiperspace must be owned by the           * 00029400
*              requesting task.  For authorized callers (supervisor   * 00029500
*              state and/or system key), the owner of the hiperspace  * 00029600
*              may be any task within the caller's home address       * 00029700
*              space.  For non-zero PSW key callers, the hiperspace   * 00029800
*              storage access key must be the same as the caller's    * 00029900
*              PSW key or, if RELEASE=YES is not specified, the       * 00030000
*              hiperspace must have been created with fetch           * 00030100
*              protection off.  For non-zero PSW key callers, if      * 00030200
*              RELEASE=YES is specified, then the keys must match.    * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*          ÝNUMRANGE=»xnumrange!1º¨                                   * 00030800
*              is the name (RS-type), or address in register          * 00030900
*              (2)-(12), of an optional fullword input that specifies * 00031000
*              the number of entries in the supplied range list.  The * 00031100
*              range list is used to specify one or more virtual      * 00031200
*              storage ranges which are to be read from the           * 00031300
*              hiperspace to the address space.  The value specified  * 00031400
*              must be a positive integer between 1 and 50.           * 00031500
*                                                                     * 00031600
*              DEFAULT: 1.                                            * 00031700
*              If NUMRANGE is omitted, then only one virtual range    * 00031800
*              will be read                                           * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*          RANGLIST=xranglist                                         * 00032400
*              is the name (RS-type), or address in register          * 00032500
*              (2)-(12), of a required 4 byte input that contains the * 00032600
*              address of a range list.  The range list consists of a * 00032700
*              number of entries (as specified by NUMRANGE) where     * 00032800
*              each entry specifies the address of the SREAD source   * 00032900
*              in the hiperspace, the SREAD target address in the     * 00033000
*              address space, and the number of blocks (4K bytes) to  * 00033100
*              be read.                                               * 00033200
*                                                                     * 00033300
*              More specifically, each entry consists of three words  * 00033400
*              as follows:                                            * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*  FIRST WORD    contains the starting virtual address in the address * 00033800
*                space into which the data is to be read.  The        * 00033900
*                specified address must be on a 4k boundary.  Unless  * 00034000
*                the caller is executing with a zero PSW key, the     * 00034100
*                access key of the address space storage must be the  * 00034200
*                same as the caller's PSW key.                        * 00034300
*                                                                     * 00034400
*                The specified virtual storage must be from a         * 00034500
*                non-DREF private area subpool.  At the time of the   * 00034600
*                request none of the area may be fixed, be part of a  * 00034700
*                VIO window, or map a DIV object.                     * 00034800
*                                                                     * 00034900
*  SECOND WORD   contains the starting virtual address in the         * 00035000
*                hiperspace from which the SREAD is to be initiated.  * 00035100
*                The specified virtual address must be on a 4K        * 00035200
*                boundary.                                            * 00035300
*                                                                     * 00035400
*  THIRD WORD    contains the number of blocks (4K bytes) to be read  * 00035500
*                from the hiperspace.                                 * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*  The range list must be addressable in the caller's primary address * 00036000
*  space.                                                             * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*          ÝRELEASE=»NO!YESº¨                                         * 00036600
*              is an optional keyword input that indicates whether or * 00036700
*              not the specified hiperspace pages should or should    * 00036800
*              not be released.                                       * 00036900
*              DEFAULT: NO                                            * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*              ÝRELEASE=NO                                            * 00037300
*                  specifies that the hiperspace pages should not be  * 00037400
*                  discarded after the read.  The same data will be   * 00037500
*                  available again on a subsequent SREAD assuming     * 00037600
*                  that it was not changed by an intervening SWRITE.  * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                  ÝHSPALET=»xhspalet!0º¨¨                            * 00038000
*                      is the name (RS-type), or address in register  * 00038100
*                      (2)-(12), of an optional fullword input        * 00038200
*                      variable that contains the ALET for the        * 00038300
*                      source hiperspace.  The ALET must be for a     * 00038400
*                      hiperspace on the caller's current DU or PASN  * 00038500
*                      access list.  HSPALET must be specified if the * 00038600
*                      caller is a non-authorized caller and is       * 00038700
*                      accessing a shared scroll type hiperspace.     * 00038800
*                      Otherwise it is optional.                      * 00038900
*                                                                     * 00039000
*                      DEFAULT: 0 (Only if HSPALET is omitted.  If    * 00039100
*                      HSPALET is specified then a value must be      * 00039200
*                      provided.)                                     * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*              ÝRELEASE=YES¨                                          * 00039700
*                  specifies that the data in the hiperspace, after   * 00039800
*                  the read, may be discarded.  This enables the      * 00039900
*                  system to free the resources which were used to    * 00040000
*                  back the hiperspace page.                          * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*      SWRITE                                                         * 00040700
*          is a keyword used to request that data be written to a     * 00040800
*          SCROLL hiperspace.                                         * 00040900
*                                                                     * 00041000
*          The write may or may not be done synchronously with the    * 00041100
*          request.  That is, if physical I/O is required to satisfy  * 00041200
*          the request, it may not be complete when control is        * 00041300
*          returned the caller.  Upon return from the SWRITE, the     * 00041400
*          data in the specified address space is unpredictable.  The * 00041500
*          virtual area, however, is available for immediate reuse.   * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*          STOKEN=xstoken                                             * 00041900
*              is the name (RS-type), or address in register          * 00042000
*              (2)-(12), of a required 8 character input variable     * 00042100
*              that contains the STOKEN for the SCROLL hiperspace     * 00042200
*              into which the data is to be written.  For             * 00042300
*              non-authorized callers, the hiperspace must be owned   * 00042400
*              by the requesting task.  For authorized callers        * 00042500
*              (supervisor state and/or system key), the owner of the * 00042600
*              hiperspace may be any task within the caller's home    * 00042700
*              address space.  For non-zero PSW key callers, the      * 00042800
*              hiperspace storage access key must be the same as the  * 00042900
*              caller's PSW key.                                      * 00043000
*                                                                     * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*          ÝNUMRANGE=»xnumrange!1º¨                                   * 00043500
*              is the name (RS-type), or address in register          * 00043600
*              (2)-(12), of an optional fullword input that specifies * 00043700
*              the number of entries in the supplied range list.  The * 00043800
*              range list is used to specify one or more virtual      * 00043900
*              storage ranges which are to be written to a hiperspace * 00044000
*              from an address space.  The value specified must be a  * 00044100
*              positive integer between 1 and 50.                     * 00044200
*                                                                     * 00044300
*              DEFAULT: 1.                                            * 00044400
*              If NUMRANGE is omitted, then only one virtual range    * 00044500
*              will be written.                                       * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*          RANGLIST=xranglist                                         * 00045100
*              is the name (RS-type), or address in register          * 00045200
*              (2)-(12), of a required 4 byte input that contains the * 00045300
*              address of a range list.  The range list consists of a * 00045400
*              number of entries (as specified by NUMRANGE) where     * 00045500
*              each entry specifies the address of the SWRITE source  * 00045600
*              in the address space, the SWRITE target address in the * 00045700
*              hiperspace, and the number of blocks (4K bytes) to be  * 00045800
*              written.                                               * 00045900
*                                                                     * 00046000
*              More specifically, each entry consists of three words  * 00046100
*              as follows:                                            * 00046200
*                                                                     * 00046300
*                                                                     * 00046400
*  FIRST WORD    contains the starting virtual address in the address * 00046500
*                space from which the write is to be initiated.  The  * 00046600
*                specified address must be on a 4K boundary.  If the  * 00046700
*                caller's PSW key is not zero, then The caller's PSW  * 00046800
*                key must match the access key of the virtual         * 00046900
*                storage.                                             * 00047000
*                                                                     * 00047100
*                The specified virtual storage must be from a         * 00047200
*                non-DREF private area subpool.  At the time of the   * 00047300
*                request none of the area may be fixed, be part of a  * 00047400
*                VIO window, or map a DIV object.                     * 00047500
*                                                                     * 00047600
*  SECOND WORD   contains the starting virtual address in the         * 00047700
*                hiperspace into which the data is to be written.     * 00047800
*                The specified address must be on a 4K boundary.      * 00047900
*                                                                     * 00048000
*  THIRD WORD    contains the number of blocks (4K bytes) to be       * 00048100
*                written to the hiperspace.                           * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                                                                     * 00048500
*  The range list must be addressable in the caller's primary address * 00048600
*  space.                                                             * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*                                                                     * 00049100
*          ÝHSPALET=»xhspalet!0º¨                                     * 00049200
*              is the name (RS-type), or address in register          * 00049300
*              (2)-(12), of an optional fullword input variable that  * 00049400
*              contains the ALET for the  target hiperspace.  The     * 00049500
*              ALET must be for a hiperspace on the caller's current  * 00049600
*              DU or PASN access list.  HSPALET must be specified if  * 00049700
*              the caller is a non-authorized caller and is accessing * 00049800
*              a shared scroll type hiperspace.  Otherwise it is      * 00049900
*              optional.                                              * 00050000
*                                                                     * 00050100
*              DEFAULT: 0 (Only if HSPALET is omitted.  If HSPALET is * 00050200
*              specified then a value must be provided.)              * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*      CREAD                                                          * 00050700
*          is a keyword used to request that data be read from a      * 00050800
*          CACHE hiperspace.                                          * 00050900
*                                                                     * 00051000
*          If all blocks requested to be read are available in the    * 00051100
*          hiperspace, then the read will be satisfied synchronously  * 00051200
*          with the request.  That is, immediately upon return from   * 00051300
*          the CREAD service, the data is available for reference in  * 00051400
*          the specified address space.  On the other hand, if one or * 00051500
*          more of the blocks to be read are no longer available in   * 00051600
*          the hiperspace, then a failing return code will be         * 00051700
*          returned (see return code 08 below).  What blocks are      * 00051800
*          successfully read, if any, is indeterminate.               * 00051900
*                                                                     * 00052000
*                                                                     * 00052100
*          STOKEN=xstoken                                             * 00052200
*              is the name (RS-type), or address in register          * 00052300
*              (2)-(12), of a required 8 character input variable     * 00052400
*              that contains the STOKEN for the CACHE hiperspace from * 00052500
*              which the data is to be read.  The owner of the        * 00052600
*              hiperspace may be any task in the system provided that * 00052700
*              that task is in the caller's home address space, in    * 00052800
*              the caller's primary address space, or in a            * 00052900
*              non-swappable address space.  For non-zero PSW key     * 00053000
*              caller's, the hiperspace storage access key must be    * 00053100
*              the same as the caller's PSW key or the hiperspace     * 00053200
*              must have been created with fetch protection off.      * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*          ÝADDRSP=»HOME!PRIMARY!COMMONº¨                             * 00053800
*              is an optional keyword input that specifies the        * 00053900
*              location of the virtual storage range into which the   * 00054000
*              data is to be read.                                    * 00054100
*                                                                     * 00054200
*              DEFAULT: HOME                                          * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*              ADDRSP=HOME                                            * 00054600
*                  specifies that the data is to be read from the     * 00054700
*                  hiperspace to the caller's home address space.     * 00054800
*                                                                     * 00054900
*              ADDRSP=PRIMARY                                         * 00055000
*                  specifies that the data is to be read from the     * 00055100
*                  hiperspace to the caller's primary address space.  * 00055200
*                                                                     * 00055300
*              ADDRSP=COMMON                                          * 00055400
*                  specifies that the data is to be read from the     * 00055500
*                  hiperspace to the common area.                     * 00055600
*                                                                     * 00055700
*                                                                     * 00055800
*                                                                     * 00055900
*                                                                     * 00056000
*                                                                     * 00056100
*                                                                     * 00056200
*          ÝNUMRANGE=»xnumrange!1º¨                                   * 00056300
*              is the name (RS-type), or address in register          * 00056400
*              (2)-(12), of an optional fullword input that specifies * 00056500
*              the number of entries in the supplied range list.  The * 00056600
*              range list is used to specify one or more virtual      * 00056700
*              storage ranges which are to be read from the           * 00056800
*              hiperspace to the address space.  The value specified  * 00056900
*              must be a positive integer between 1 and 50.           * 00057000
*                                                                     * 00057100
*              DEFAULT: 1.                                            * 00057200
*              If NUMRANGE is omitted, then only one virtual range    * 00057300
*              will be read.                                          * 00057400
*                                                                     * 00057500
*                                                                     * 00057600
*                                                                     * 00057700
*                                                                     * 00057800
*          RANGLIST=xranglist                                         * 00057900
*              is the name (RS-type), or address in register          * 00058000
*              (2)-(12), of a required 4 byte input that contains the * 00058100
*              address of a range list.  The range list consists of a * 00058200
*              number of entries (as specified by NUMRANGE) where     * 00058300
*              each entry specifies the address of the CREAD source   * 00058400
*              in the hiperspace, the CREAD target address in the     * 00058500
*              address space, and the number of blocks (4K bytes) to  * 00058600
*              be read.                                               * 00058700
*                                                                     * 00058800
*              More specifically, each entry consists of three words  * 00058900
*              as follows:                                            * 00059000
*                                                                     * 00059100
*                                                                     * 00059200
*  FIRST WORD    contains the starting virtual address in the address * 00059300
*                space into which the data is to be read.  The        * 00059400
*                specified address must be on a 4k boundary.  Unless  * 00059500
*                the caller is executing with a zero PSW key, the     * 00059600
*                access key of the address space storage must be the  * 00059700
*                same as the caller's PSW key.                        * 00059800
*                                                                     * 00059900
*                The specified virtual storage vannot be part of a    * 00060000
*                VIO window nor map a DIV object.                     * 00060100
*                                                                     * 00060200
*  SECOND WORD   contains the starting virtual address in the         * 00060300
*                hiperspace from which the CREAD is to be initiated.  * 00060400
*                The specified virtual address must be on a 4K        * 00060500
*                boundary.                                            * 00060600
*                                                                     * 00060700
*  THIRD WORD    contains the number of blocks (4K bytes) to be read  * 00060800
*                from the hiperspace.                                 * 00060900
*                                                                     * 00061000
*                                                                     * 00061100
*                                                                     * 00061200
*  The range list must be addressable in the caller's primary address * 00061300
*  space.                                                             * 00061400
*                                                                     * 00061500
*                                                                     * 00061600
*                                                                     * 00061700
*                                                                     * 00061800
*          ÝIOPATH=»NO!YESº¨                                          * 00061900
*              is an optional keyword input that specifies whether or * 00062000
*              not the CREAD call is emanating from within the        * 00062100
*              system's paging I/O path.  The IOPATH=YES              * 00062200
*              specification is for internal use and is not part of   * 00062300
*              the intended interface. The IOPATH=NO specification is * 00062400
*              the default and does not need to be specified to       * 00062500
*              specify the HSPALET keyword.                           * 00062600
*              DEFAULT: NO                                            * 00062700
*                                                                     * 00062800
*                                                                     * 00062900
*              ÝIOPATH=NO                                             * 00063000
*                  specifies that the CREAD request is not being      * 00063100
*                  issued out of the system's I/O path.               * 00063200
*                                                                     * 00063300
*                                                                     * 00063400
*                  ÝHSPALET=»xhspalet!0º¨¨                            * 00063500
*                      is the name (RS-type), or address in register  * 00063600
*                      (2)-(12), of an optional fullword input        * 00063700
*                      variable that contains the ALET for the        * 00063800
*                      source hiperspace.  The ALET must be for a     * 00063900
*                      hiperspace on the caller's current DU or PASN  * 00064000
*                      access list.                                   * 00064100
*                                                                     * 00064200
*                      DEFAULT: 0 (Only if HSPALET is omitted.  If    * 00064300
*                      HSPALET is specified then a value must be      * 00064400
*                      provided.)                                     * 00064500
*                                                                     * 00064600
*                                                                     * 00064700
*                                                                     * 00064800
*              ÝIOPATH=YES¨                                           * 00064900
*                  specifies that the CREAD request is being issued   * 00065000
*                  out of the system's I/O path.                      * 00065100
*                                                                     * 00065200
*                  IF IOPATH(YES) is specified, then the following    * 00065300
*                  must be true:                                      * 00065400
*                                                                     * 00065500
*                                                                     * 00065600
*                                                                     * 00065700
*                  o   The caller must be disabled.                   * 00065800
*                                                                     * 00065900
*                  o   All address space pages (i.e., the target      * 00066000
*                      pages of the CREAD) must be in the invalid     * 00066100
*                      state.  The CREAD service will not change the  * 00066200
*                      state of these pages.                          * 00066300
*                                                                     * 00066400
*                  o   All address space pages must appear to be in   * 00066500
*                      the "page I/O current" state, but not have any * 00066600
*                      actual physical I/O current.  This is the      * 00066700
*                      state when RSM calls its I/O driver to         * 00066800
*                      initiate input I/O.                            * 00066900
*                                                                     * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*                                                                     * 00067300
*                                                                     * 00067400
*                                                                     * 00067500
*                                                                     * 00067600
*      CWRITE                                                         * 00067700
*          is a keyword used to request that data be written to a     * 00067800
*          CACHE hiperspace.                                          * 00067900
*                                                                     * 00068000
*          All writes are done synchronously with the request.  Upon  * 00068100
*          return, the write will be complete and, if KEEP=YES is not * 00068200
*          specified, the data in the specified address space will be * 00068300
*          unaltered and available for reference.  If, for some       * 00068400
*          reason, all the blocks in the request cannot be written to * 00068500
*          the hiperspace, then none will be written and the request  * 00068600
*          will be rejected (see return code 08).  In this case, the  * 00068700
*          data in the hiperspace, for the specified range, is        * 00068800
*          inpredictable.  Therefore, after an unsuccessful write,    * 00068900
*          subsequent CREADs should not be issued against the failing * 00069000
*          hiperspace range of virtual storage until an intervening   * 00069100
*          CWRITE is successful.                                      * 00069200
*                                                                     * 00069300
*                                                                     * 00069400
*          STOKEN=xstoken                                             * 00069500
*              is the name (RS-type), or address in register          * 00069600
*              (2)-(12), of a required 8 character input variable     * 00069700
*              that contains the STOKEN for the CACHE hiperspace into * 00069800
*              which the data is to be written.  The owner of the     * 00069900
*              hiperspace may be any task in the system provided that * 00070000
*              that task is in the caller's home address space, in    * 00070100
*              the caller's primary address space, or in a            * 00070200
*              non-swappable address space.  For non-zero PSW key     * 00070300
*              caller's, the hiperspace storage access key must be    * 00070400
*              the same as the caller's PSW key.                      * 00070500
*                                                                     * 00070600
*                                                                     * 00070700
*                                                                     * 00070800
*                                                                     * 00070900
*          ÝADDRSP=»HOME!PRIMARY!COMMONº¨                             * 00071000
*              is an optional keyword input that specifies the        * 00071100
*              location of the virtual storage range from which the   * 00071200
*              data is to be written.                                 * 00071300
*                                                                     * 00071400
*              DEFAULT: HOME                                          * 00071500
*                                                                     * 00071600
*                                                                     * 00071700
*              ADDRSP=HOME                                            * 00071800
*                  specifies that the data is to be written from the  * 00071900
*                  caller's home address space to the hiperspace.     * 00072000
*                                                                     * 00072100
*              ADDRSP=PRIMARY                                         * 00072200
*                  specifies that the data is to be written from the  * 00072300
*                  caller's primary address space to the hiperspace.  * 00072400
*                                                                     * 00072500
*              ADDRSP=COMMON                                          * 00072600
*                  specifies that the data is to be written from the  * 00072700
*                  common area to the hiperspace.                     * 00072800
*                                                                     * 00072900
*                                                                     * 00073000
*                                                                     * 00073100
*                                                                     * 00073200
*                                                                     * 00073300
*                                                                     * 00073400
*          ÝNUMRANGE=»xnumrange!1º¨                                   * 00073500
*              is the name (RS-type), or address in register          * 00073600
*              (2)-(12), of an optional fullword input that specifies * 00073700
*              the number of entries in the supplied range list.  The * 00073800
*              range list is used to specify one or more virtual      * 00073900
*              storage ranges which are to be written to a hiperspace * 00074000
*              from an address space.  The value specified must be a  * 00074100
*              positive integer between 1 and 50.                     * 00074200
*                                                                     * 00074300
*              DEFAULT: 1.                                            * 00074400
*              If NUMRANGE is omitted, then only one virtual range    * 00074500
*              will be written.                                       * 00074600
*                                                                     * 00074700
*                                                                     * 00074800
*                                                                     * 00074900
*                                                                     * 00075000
*          RANGLIST=xranglist                                         * 00075100
*              is the name (RS-type), or address in register          * 00075200
*              (2)-(12), of a required 4 byte input that contains the * 00075300
*              address of a range list.  The range list consists of a * 00075400
*              number of entries (as specified by NUMRANGE) where     * 00075500
*              each entry specifies the address of the CWRITE source  * 00075600
*              in the address space, the CWRITE target address in the * 00075700
*              hiperspace, and the number of blocks (4K bytes) to be  * 00075800
*              read.                                                  * 00075900
*                                                                     * 00076000
*              More specifically, each entry consists of three words  * 00076100
*              as follows:                                            * 00076200
*                                                                     * 00076300
*                                                                     * 00076400
*  FIRST WORD    contains the starting virtual address in the address * 00076500
*                space from which the write is to be initiated.  The  * 00076600
*                specified address must be on a 4K boundary.  If the  * 00076700
*                caller's PSW key is not zero and is not equal to the * 00076800
*                access key of the virtual storage then KEEP=NO       * 00076900
*                cannot be specified and the virtual storage cannot   * 00077000
*                be fetch protected.                                  * 00077100
*                                                                     * 00077200
*                The specified virtual storage vannot be part of a    * 00077300
*                VIO window nor map a DIV object.                     * 00077400
*                                                                     * 00077500
*  SECOND WORD   contains the starting virtual address in the         * 00077600
*                hiperspace into which the data is to be written.     * 00077700
*                The specified address must be on a 4K boundary.      * 00077800
*                                                                     * 00077900
*  THIRD WORD    contains the number of blocks (4K bytes) to be       * 00078000
*                written to the hiperspace.                           * 00078100
*                                                                     * 00078200
*                                                                     * 00078300
*                                                                     * 00078400
*  The range list must be addressable in the caller's primary address * 00078500
*  space.                                                             * 00078600
*                                                                     * 00078700
*                                                                     * 00078800
*                                                                     * 00078900
*                                                                     * 00079000
*          ÝKEEP=»YES!NOº¨                                            * 00079100
*              is an optional keyword input that specifies whether or * 00079200
*              not the data should be kept in the virtual storage of  * 00079300
*              the address space after the CWRITE.                    * 00079400
*              DEFAULT: YES                                           * 00079500
*                                                                     * 00079600
*                                                                     * 00079700
*              KEEP=YES                                               * 00079800
*                  specifies that the the source data is to be kept   * 00079900
*                  in the virtual storage of the address space        * 00080000
*                  following the CWRITE.                              * 00080100
*                                                                     * 00080200
*              KEEP=NO                                                * 00080300
*                  specifies that the source data need not be kept in * 00080400
*                  the virtual storage of the address space following * 00080500
*                  the CWRITE. In certain cases, depending upon the   * 00080600
*                  environment, a KEEP=NO CWRITE will have better     * 00080700
*                  performance than a KEEP=YES CWRITE.  Consequently, * 00080800
*                  it is better to use KEEP=NO on CWRITE in those     * 00080900
*                  instances when it is intended to overlay the       * 00081000
*                  address space virtual storage with new data        * 00081100
*                  following a CWRITE.                                * 00081200
*                                                                     * 00081300
*                                                                     * 00081400
*                                                                     * 00081500
*                                                                     * 00081600
*                                                                     * 00081700
*                                                                     * 00081800
*          ÝIOPATH=»NO!YESº¨                                          * 00081900
*              is an optional keyword input that specifies whether or * 00082000
*              not the CWRITE request is emanating from within the    * 00082100
*              system's paging I/O path.  The IOPATH=YES              * 00082200
*              specification is for internal use and is not part of   * 00082300
*              the intended interface. The IOPATH=NO specification is * 00082400
*              the default and does not need to be specified to       * 00082500
*              specify the HSPALET keyword.                           * 00082600
*              DEFAULT: NO                                            * 00082700
*                                                                     * 00082800
*                                                                     * 00082900
*              ÝIOPATH=NO                                             * 00083000
*                  specifies that the CWRITE is not being issued out  * 00083100
*                  of the system's I/O path.                          * 00083200
*                                                                     * 00083300
*                                                                     * 00083400
*                  ÝHSPALET=»xhspalet!0º¨¨                            * 00083500
*                      is the name (RS-type), or address in register  * 00083600
*                      (2)-(12), of an optional fullword input        * 00083700
*                      variable that contains the ALET for the        * 00083800
*                      target hiperspace.  The ALET must be for a     * 00083900
*                      hiperspace on the caller's current DU or PASN  * 00084000
*                      access list.                                   * 00084100
*                                                                     * 00084200
*                      DEFAULT: 0 (Only if HSPALET is omitted.  If    * 00084300
*                      HSPALET is specified then a value must be      * 00084400
*                      provided.)                                     * 00084500
*                                                                     * 00084600
*                                                                     * 00084700
*                                                                     * 00084800
*              ÝIOPATH=YES¨                                           * 00084900
*                  specifies that the CWRITE is being issued out of   * 00085000
*                  the system's I/O path.                             * 00085100
*                                                                     * 00085200
*                  IF IOPATH(YES) is specified, then the following    * 00085300
*                  must be true:                                      * 00085400
*                                                                     * 00085500
*                                                                     * 00085600
*                                                                     * 00085700
*                  o   The caller must be disabled.                   * 00085800
*                                                                     * 00085900
*                  o   All address space pages (i.e., the source      * 00086000
*                      pages of the CWRITE) must be in the invalid    * 00086100
*                      state.  The CWRITE service will not change the * 00086200
*                      state of these pages.                          * 00086300
*                                                                     * 00086400
*                  o   All address space pages must appear to be in   * 00086500
*                      the "page I/O current" state, but not have any * 00086600
*                      actual physical I/O current.  This is the      * 00086700
*                      state when (1) RSM calls its I/O driver to     * 00086800
*                      initiate output I/O or (2) when I/O has        * 00086900
*                      physically completed and RSM has not yet been  * 00087000
*                      notified of the I/O completion.                * 00087100
*                                                                     * 00087200
*                                                                     * 00087300
*                                                                     * 00087400
*                                                                     * 00087500
*                                                                     * 00087600
*                                                                     * 00087700
*                                                                     * 00087800
*                                                                     * 00087900
*                                                                     * 00088000
*      End of a set of mutually exclusive required keys.              * 00088100
*                                                                     * 00088200
*                                                                     * 00088300
*                                                                     * 00088400
*      ÝRETCODE=xretcode¨                                             * 00088500
*          is the name (RS-type) of an optional fullword output       * 00088600
*          variable, or register (2)-(12) or (15), into which the     * 00088700
*          return code is to be copied from GPR 15.  If you specify   * 00088800
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00088900
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00089000
*          with MF=M.                                                 * 00089100
*                                                                     * 00089200
*                                                                     * 00089300
*                                                                     * 00089400
*                                                                     * 00089500
*      ÝRSNCODE=xrsncode¨                                             * 00089600
*          is the name (RS-type) of an optional 4 character output    * 00089700
*          variable into which the reason code is to be copied from   * 00089800
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00089900
*          R0 (within or without parentheses), the value will be left * 00090000
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00090100
*                                                                     * 00090200
*                                                                     * 00090300
*                                                                     * 00090400
*                                                                     * 00090500
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00090600
*          is an optional byte input decimal value in the "0-1" range * 00090700
*          that specifies the macro version.  PLISTVER is the only    * 00090800
*          key allowed on the list form of MF and determines which    * 00090900
*          parameter list is generated.  The macro keys associated    * 00091000
*          with each supported version of the macro are listed in     * 00091100
*          MACRO USAGE NOTE 3.  Note that MAX may be specified        * 00091200
*          instead of a number, and the parameter list will be of the * 00091300
*          largest size currently supported. This size may grow from  * 00091400
*          release to release (thus possibly affecting the amount of  * 00091500
*          storage needed by your program).  If your program can      * 00091600
*          tolerate this, IBM recommends that you always specify MAX  * 00091700
*          when creating the list form parameter list as that will    * 00091800
*          ensure that the list form parameter list is always long    * 00091900
*          enough to hold whatever parameters might be specified on   * 00092000
*          the execute form.                                          * 00092100
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00092200
*          default is the lowest version which allows all of the      * 00092300
*          parameters specified on the invocation to be processed.    * 00092400
*                                                                     * 00092500
*                                                                     * 00092600
*                                                                     * 00092700
*                                                                     * 00092800
*      ÝMF=»S!L!M!Eº¨                                                 * 00092900
*          is an optional keyword input which specifies the macro     * 00093000
*          form.                                                      * 00093100
*          DEFAULT: S                                                 * 00093200
*                                                                     * 00093300
*                                                                     * 00093400
*          ÝMF=S¨                                                     * 00093500
*              specifies the standard form of the macro.  The "S"     * 00093600
*              form generates code to put the parameters into an      * 00093700
*              in-line parameter list and invoke the desired service. * 00093800
*              Full checking for required macro keys is done along    * 00093900
*              with supplying defaults for omitted optional           * 00094000
*              parameters.                                            * 00094100
*                                                                     * 00094200
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00094300
*              specifies the list form of the macro.  The "L" form    * 00094400
*              defines an area to be used for the parameter list.     * 00094500
*              Only the PLISTVER key may be specified on the          * 00094600
*              invocation.  All other macro parameters are flagged as * 00094700
*              errors.  If PLISTVER is not specified, the original    * 00094800
*              parameter list definition is used.                     * 00094900
*                                                                     * 00095000
*            ,xmfctrl                                                 * 00095100
*              is a required input.  It is the name of a storage area * 00095200
*              for the parameter list.                                * 00095300
*                                                                     * 00095400
*            »,xmfattr!0Dº                                            * 00095500
*              is an optional 60 character input string that varies   * 00095600
*              from 1 to 60 characters. Use it to force boundary      * 00095700
*              alignment of the parameter list. Use only 0F or 0D.    * 00095800
*              DEFAULT: 0D which forces the parameter list to a       * 00095900
*              doubleword boundary.                                   * 00096000
*                                                                     * 00096100
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00096200
*              specifies the modify form of the macro.  The "M" form  * 00096300
*              generates code to put the parameters into the          * 00096400
*              parameter list specified by xmfctrl.                   * 00096500
*                                                                     * 00096600
*            ,xmfctrl                                                 * 00096700
*              is a required input.  It is the name (RS-type), or     * 00096800
*              address in register (1)-(12), of a storage area for    * 00096900
*              the parameter list.                                    * 00097000
*                                                                     * 00097100
*            »,COMPLETE!NOCHECKº¨                                     * 00097200
*              is an optional keyword input which specifies the       * 00097300
*              degree of macro parameter syntax checking.             * 00097400
*              DEFAULT: COMPLETE                                      * 00097500
*                                                                     * 00097600
*                                                                     * 00097700
*              COMPLETE                                               * 00097800
*                  Checking for required macro keys is done and       * 00097900
*                  defaults are supplied for omitted optional         * 00098000
*                  parameters.  (See Macro Usage Note 2).             * 00098100
*                                                                     * 00098200
*              NOCHECK                                                * 00098300
*                  Checking for required macro keys is not done nor   * 00098400
*                  are defaults supplied for omitted optional         * 00098500
*                  parameters.                                        * 00098600
*                                                                     * 00098700
*                                                                     * 00098800
*                                                                     * 00098900
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00099000
*              specifies the execute form of the macro.  The "E" form * 00099100
*              generates code to put the parameters into the          * 00099200
*              parameter list specified by xmfctrl and invoke the     * 00099300
*              desired service.                                       * 00099400
*                                                                     * 00099500
*            ,xmfctrl                                                 * 00099600
*              is a required input.  It is the name (RS-type), or     * 00099700
*              address in register (1)-(12), of a storage area for    * 00099800
*              the parameter list.                                    * 00099900
*                                                                     * 00100000
*            »,COMPLETE!NOCHECKº                                      * 00100100
*              is an optional keyword input which specifies the       * 00100200
*              degree of macro parameter syntax checking.             * 00100300
*              DEFAULT: COMPLETE                                      * 00100400
*                                                                     * 00100500
*                                                                     * 00100600
*              COMPLETE                                               * 00100700
*                  Checking for required macro keys is done and       * 00100800
*                  defaults are supplied for omitted optional         * 00100900
*                  parameters.  (See Macro Usage Note 2).             * 00101000
*                                                                     * 00101100
*              NOCHECK                                                * 00101200
*                  Checking for required macro keys is not done nor   * 00101300
*                  are defaults supplied for omitted optional         * 00101400
*                  parameters.                                        * 00101500
*                                                                     * 00101600
*                                                                     * 00101700
*                                                                     * 00101800
*                                                                     * 00101900
*                                                                     * 00102000
*                                                                     * 00102100
*                                                                     * 00102200
*01* RETURN CODES:                                                    * 00102300
*                                                                     * 00102400
*                                                                     * 00102500
*            00   Successful completion                               * 00102600
*                                                                     * 00102700
*            04   Successful completion with exceptional              * 00102800
*                 circumstances                                       * 00102900
*                                                                     * 00103000
*            08   Request rejected.  (details in the returned reason  * 00103100
*                 code).                                              * 00103200
*                                                                     * 00103300
*            0C   System failure due to environmental problems.       * 00103400
*                                                                     * 00103500
*                                                                     * 00103600
*                                                                     * 00103700
*01* REASON CODES:                                                    * 00103800
*                                                                     * 00103900
*       In the following HSPSERV reason codes, "zz" will be 07 if     * 00104000
*       CREAD, 08 if CWRITE, 09 if SREAD, and 0A if SWRITE.  If the   * 00104100
*       service requested cannot be determined, then The bytes        * 00104200
*       indicated by "zz" will be FE.  The bytes designated "xx" are  * 00104300
*       for diagnostic purposes and have no significance to the       * 00104400
*       external interface.                                           * 00104500
*                                                                     * 00104600
*       REASON    RETURN                                              * 00104700
*       CODE      CODE      DESCRIPTION                               * 00104800
*       ××××××××  ××××××××  ×××××××××××                               * 00104900
*                                                                     * 00105000
*                                                                     * 00105100
*       xxzz01xx  08        The requested hiperspace data is not      * 00105200
*                           available (CREAD only)                    * 00105300
*                                                                     * 00105400
*       xxzz02xx  08        The request cannot be serviced at the     * 00105500
*                           current time because the address space    * 00105600
*                           page has been paged-out and cannot be     * 00105700
*                           synchronously paged-in or the page is     * 00105800
*                           marked freshly getmained and is not       * 00105900
*                           backed in real (CWRITE only).  The        * 00106000
*                           HSPSERV request can be repeated after the * 00106100
*                           page is referenced.  Referencing the page * 00106200
*                           will cause it to be paged-in.             * 00106300
*                                                                     * 00106400
*       xxzz03xx  08        The request cannot be serviced at the     * 00106500
*                           current time because the necessary system * 00106600
*                           resources to service the request are not  * 00106700
*                           currently available (CWRITE only).        * 00106800
*                                                                     * 00106900
*       xxzz04xx  08        The request cannot be serviced at the     * 00107000
*                           current time because the current          * 00107100
*                           environment precludes synchronously       * 00107200
*                           servicing of the request (CREAD and       * 00107300
*                           CWRITE only).                             * 00107400
*                                                                     * 00107500
*       xxzz05xx  08        A necessary hiperspace page cannot be     * 00107600
*                           accessed due to a system error.           * 00107700
*                                                                     * 00107800
*       xxzz06xx  08        A necessary address space page cannot be  * 00107900
*                           accessed due to a system error.           * 00108000
*                                                                     * 00108100
*                                                                     * 00108200
*                                                                     * 00108300
*01* ABEND CODES:                                                     * 00108400
*                                                                     * 00108500
*                                                                     * 00108600
*       01D       Hiperspace service failed for non-environmental     * 00108700
*                 error.                                              * 00108800
*                                                                     * 00108900
*                                                                     * 00109000
*                                                                     * 00109100
*01* ABEND REASON CODES:                                              * 00109200
*                                                                     * 00109300
*       REASON    ABEND                                               * 00109400
*       CODE      CODE      DESCRIPTION                               * 00109500
*       ××××××××  ××××××××  ×××××××××××                               * 00109600
*                                                                     * 00109700
*                                                                     * 00109800
*       xxzz07xx  01D       CREAD or CWRITE requested by an           * 00109900
*                           unauthorized caller.                      * 00110000
*                                                                     * 00110100
*       xxzz08xx  01D       The indicated address space does not      * 00110200
*                           exist or cannot be accessed by the caller * 00110300
*                           for the requested service.                * 00110400
*                                                                     * 00110500
*       xxzz09xx  01D       The indicated hiperspace does not exist   * 00110600
*                           or cannot be accessed by the caller for   * 00110700
*                           the requested service which could be      * 00110800
*                           caused by the owner of the hiperspace     * 00110900
*                           being swapped out.                        * 00111000
*                                                                     * 00111100
*       xxzz0Axx  01D       Request type unrecognized.                * 00111200
*                                                                     * 00111300
*       xxzz0Bxx  01D       Storage protect key violation on the      * 00111400
*                           specified hiperspace virtual storage.     * 00111500
*                                                                     * 00111600
*       xxzz0Cxx  01D       The indicated address space virtual is    * 00111700
*                           not GETMAINed.                            * 00111800
*                                                                     * 00111900
*       xxzz0Dxx  01D       Storage protect key violation on the      * 00112000
*                           specified address space virtual storage.  * 00112100
*                                                                     * 00112200
*       xxzz0Exx  01D       The specified address space virtual did   * 00112300
*                           not start on a 4K boundary or was not     * 00112400
*                           within the bounds of the private area.    * 00112500
*                                                                     * 00112600
*       xxzz0Fxx  01D       The specified hiperspace virtual did not  * 00112700
*                           start on a 4K boundary or was not within  * 00112800
*                           the bounds of the hiperspace.             * 00112900
*                                                                     * 00113000
*       xxzz10xx  01D       SREAD or SWRITE issued against address    * 00113100
*                           space virtual storage that maps a DIV     * 00113200
*                           object, is VIO storage, is fixed, or is   * 00113300
*                           part of a DERF subpool.                   * 00113400
*                                                                     * 00113500
*       xxzz11xx  01D       The value specified for NUMRANGE was not  * 00113600
*                           in the acceptable range.                  * 00113700
*                                                                     * 00113800
*       xxzz12xx  01D       SREAD or SWRITE invoked while in          * 00113900
*                           cross-memory mode.                        * 00114000
*                                                                     * 00114100
*       xxzz13xx  01D       SREAD or SWRITE issued against a          * 00114200
*                           non-SCROLL type hiperspace.               * 00114300
*                                                                     * 00114400
*       xxzz14xx  01D       Caller not in 31 bit addressing mode.     * 00114500
*                                                                     * 00114600
*       xxzz15xx  01D       Specified parameter list or range list    * 00114700
*                           not accessable.                           * 00114800
*                                                                     * 00114900
*       xxzz16xx  01D       Invalid parameter list version specified. * 00115000
*                                                                     * 00115100
*       xxzz17xx  01D       Parameter list contains invalid or        * 00115200
*                           inconsistent                              * 00115300
*                                                                     * 00115400
*       xxzz18xx  01D       SWRITE issued for a hiperspace range for  * 00115500
*                           which a DIV SAVE is current.              * 00115600
*                                                                     * 00115700
*       xxzz19xx  01D       Unauthorized user issued HSPSERV against  * 00115800
*                           a shared scroll hiperspace without        * 00115900
*                           supplying an ALET.                        * 00116000
*                                                                     * 00116100
*       xxzz1Axx  01D       The supplied ALET is not for the          * 00116200
*                           hiperspace indicated by the specified     * 00116300
*                           STOKEN.                                   * 00116400
*                                                                     * 00116500
*       xxzz1Bxx  01D       The address space page is page protected. * 00116600
*                                                                     * 00116700
*                                                                     * 00116800
*                                                                     * 00116900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00117000
*                                                                     * 00117100
*02*   PROCESSOR:  ASSEM                                              * 00117200
*                                                                     * 00117300
*01* COMPONENT:  SC1CR                                                * 00117400
*                                                                     * 00117500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00117600
*                                                                     * 00117700
*01* MACRO USAGE NOTES:                                               * 00117800
*                                                                     * 00117900
*                                                                     * 00118000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00118100
*        global macro variable.  Any value other than 'NO' will       * 00118200
*        result in the macro expansion being printed.  The default is * 00118300
*        'YES'.  The following examples illustrate how the ZPRINT     * 00118400
*        variable should be set.                                      * 00118500
*                                                                     * 00118600
*                    GBLC &ZPRINT                                     * 00118700
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00118800
*                                                                     * 00118900
*                                                                     * 00119000
*    2.  When using the NOCHECK option in conjunction with the Modify * 00119100
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00119200
*        Modify   or  Execute  form  invocation  which  specifies  or * 00119300
*        defaults  to  the  COMPLETE  option.   This insures that the * 00119400
*        parameter  list  is  initialized completely.   The parameter * 00119500
*        list  field which identifies the version number of the macro * 00119600
*        is only set when the Standard form or the Complete option of * 00119700
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00119800
*        explicitly  specified.  Be sure that the resulting parameter * 00119900
*        list version number covers all the keys that you use.        * 00120000
*                                                                     * 00120100
*                                                                     * 00120200
*    3.  The  HSPSERV macro supports multiple versions. The macro key * 00120300
*        list  below  contains the version level in which the key was * 00120400
*        first  introduced.  Positionals  are  identified by the word * 00120500
*        'Positional'  followed by the numeric value of its position. * 00120600
*        Nested  positionals  are  preceded  by their outer key.  The * 00120700
*        lowest value represents the original version and the highest * 00120800
*        value  represents  the  most  recent  version of the HSPSERV * 00120900
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00121000
*        least  as high as the highest version number of all the keys * 00121100
*        being used.                                                  * 00121200
*                                                                     * 00121300
*        VERSION   KEY                                                * 00121400
*                                                                     * 00121500
*              0      ADDRSP                                          * 00121600
*                     CREAD                                           * 00121700
*                     CWRITE                                          * 00121800
*                     IOPATH                                          * 00121900
*                     KEEP                                            * 00122000
*                     NUMRANGE                                        * 00122100
*                     RANGLIST                                        * 00122200
*                     RELEASE                                         * 00122300
*                     SREAD                                           * 00122400
*                     STOKEN                                          * 00122500
*                     SWRITE                                          * 00122600
*              1      HSPALET                                         * 00122700
*                                                                     * 00122800
*                                                                     * 00122900
*                                                                     * 00123000
*01* CHANGE ACTIVITY:                                                 * 00123100
*                                                                     * 00123200
*   Flag LineItem  FMID    Date   ID    Comment                       * 00123300
*                                                                     * 00123400
*    $L0=HIPER    JBB3311 880210 PDAC:  Hiperspaces.                  * 00123500
*    $D1=DCR0013  JBB3311 880427 PDAC:  Keep Option.                  * 00123600
*    $L1=MVPGM14  JBB3313 890721 PDK1:  HSPALET option                * 00123700
*    $01=OY40152  JBB3311 910314 PD00W3:  Ensure owning address space * 00123800
*                                         is not swapped out when     * 00123900
*                                         data space or hiperspace is * 00124000
*                                         referenced.                 * 00124100
*    $P1=PKB1005  HBB4430 920731 PD00NL:  Ensure HPSERV SREAD/WRITE   * 00124200
*                                         can not change PGSER        * 00124300
*                                         protected storage.          * 00124400
*    $P2=PIG2843  HBB5510 930902 PD00HM:  Removed Highlight tags due  * 00124500
*                                         to assembler error.         * 00124600
*    $P3=PIG3765  HBB5510 931118 PD00JV:  Use AMG ZNDX variable for   * 00124700
*                                         parameter list generation.  * 00124800
*    $P4=ME26240  HBB77A0 130804 PD00DV:  Add internal use only       * 00124900
*                                         IOPATH keyword.             * 00125000
*    $P5=ME26523  HBB77A0 130804 PD00DV:  Fix wording.                * 00125100
****** END OF SPECIFICATIONS *****************************************/ 00125200
*/********************************************************************* 00125300
         MACRO                                                          00125400
&XLABEL  HSPSERV &STOKEN=,&NUMRANGE=,&RANGLIST=,&RELEASE=,&HSPALET=,   *00125500
               &ADDRSP=,&IOPATH=,&KEEP=,&RETCODE=,&RSNCODE=,&PLISTVER=,*00125600
               &MF=                                                     00125700
.*                                                                      00125800
*              MACDATE -92/07/31-<1>                                    00125900
.*                                                                      00126000
.*******************************************************************    00126100
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00126200
.*******************************************************************    00126300
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00126400
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00126500
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00126600
.*                                                                      00126700
              GBLC  &ZHSPSERV   YES=MACRO USED AT LEAST ONCE            00126800
.*******************************************************************    00126900
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00127000
.*******************************************************************    00127100
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00127200
              LCLC  &ZCNDX      SYSNDX CHARACTERS                       00127300
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00127400
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00127500
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00127600
              LCLA  &ZAWRK      USED AS A WORK AREA                     00127700
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00127800
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00127900
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00128000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00128100
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00128200
              LCLC  &ZMAC_G     "G" or null                             00128300
&ZMAC_G       SETC  ''                                                  00128400
              LCLC  &ZMAC_LR                                            00128500
&ZMAC_LR      SETC  'LR'                                                00128600
              LCLC  &ZMAC_L                                             00128700
&ZMAC_L       SETC  'L'                                                 00128800
              LCLC  &ZMAC_ST                                            00128900
&ZMAC_ST      SETC  'ST'                                                00129000
              LCLC  &ZMAC_LLGT                                          00129100
&ZMAC_LLGT    SETC  'L'                                                 00129200
              LCLC  &ZMAC_LGR                                           00129300
&ZMAC_LGR     SETC  'LR'                                                00129400
              LCLC  &ZMAC_LG                                            00129500
&ZMAC_LG      SETC  'L'                                                 00129600
              LCLC  &ZMAC_STG                                           00129700
&ZMAC_STG     SETC  'ST'                                                00129800
              LCLA  &ZMACRET    MACRO RETURN CODE                       00129900
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00130000
.*                                                                      00130100
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00130200
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00130300
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00130400
              LCLC  &ZENDBASEPL                 End of base PL          00130500
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00130600
.*******************************************************************    00130700
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00130800
.*******************************************************************    00130900
              LCLA  &ZI         INDEX FOR ARRAY                         00131000
              LCLA  &ZJ         INDEX FOR PARMS                         00131100
              LCLA  &ZK         INDEX FOR PARSE                         00131200
              LCLA  &ZLO        LOW RANGE VALUE                         00131300
              LCLA  &ZHI        HIGH RANGE VALUE                        00131400
              LCLC  &ZW         WORK AREA FOR PARM                      00131500
.********************************************************************   00131600
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00131700
.********************************************************************   00131800
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00131900
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00132000
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00132100
              GBLC  &SYSAM64    SYSSTATE AMODE64                        00132200
.*                                                                      00132300
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00132400
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00132500
              SPLEVEL  TEST                                             00132600
.ZSYS2        ANOP  ,                                                   00132700
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00132800
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00132900
              SYSSTATE TEST                                             00133000
              AGO   .ZSYS4                                              00133100
.ZSYS3        ANOP  ,                                                   00133200
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00133300
.ZSYS4        ANOP  ,                                                   00133400
              AIF   ('&SYSAM64' NE 'YES').ZSYSN64                       00133500
&ZMAC_LLGT    SETC 'LLGT'                                               00133600
&ZMAC_LGR     SETC 'LGR'                                                00133700
&ZMAC_LG      SETC 'LG'                                                 00133800
&ZMAC_STG     SETC 'STG'                                                00133900
.ZSYSN64      ANOP  ,                                                   00134000
.*******************************************************************    00134100
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00134200
.*******************************************************************    00134300
              LCLC  &XSERVICE   ++ VALUE                                00134400
              LCLC  &XSREAD     ++ VALUE                                00134500
              LCLC  &XSTOKEN    ++ NAME                                 00134600
              LCLC  &XNUMRANGE  ++ NAME                                 00134700
              LCLC  &XRANGLIST  ++ NAME                                 00134800
              LCLC  &XRELEASE   ++ VALUE                                00134900
              LCLC  &XHSPALET   ++ NAME                                 00135000
              LCLC  &XSWRITE    ++ VALUE                                00135100
              LCLC  &XCREAD     ++ VALUE                                00135200
              LCLC  &XADDRSP    ++ VALUE                                00135300
              LCLC  &XIOPATH    ++ VALUE                                00135400
              LCLC  &XCWRITE    ++ VALUE                                00135500
              LCLC  &XKEEP      ++ VALUE                                00135600
              LCLC  &XRETCODE   ++ NAME                                 00135700
              LCLC  &XRSNCODE   ++ NAME                                 00135800
              LCLA  &XPLISTVER  ++ VALUE                                00135900
              LCLC  &XMF        ++ VALUE                                00136000
              LCLC  &XMFCTRL    ++ NAME                                 00136100
              LCLC  &XMFATTR    ++ VALUE                                00136200
              LCLC  &XMFSCK     ++ VALUE                                00136300
.*******************************************************************    00136400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00136500
.*******************************************************************    00136600
              LCLC  &ZXSERVICE  ++ INPUT VALUE                          00136700
              LCLC  &ZXSREAD    ++ INPUT VALUE                          00136800
              LCLC  &ZXSTOKEN   ++ INPUT NAME                           00136900
              LCLC  &ZXNUMRANGE                 ++ INPUT NAME           00137000
              LCLC  &ZXRANGLIST                 ++ INPUT NAME           00137100
              LCLC  &ZXRELEASE  ++ INPUT VALUE                          00137200
              LCLC  &ZXHSPALET  ++ INPUT NAME                           00137300
              LCLC  &ZXSWRITE   ++ INPUT VALUE                          00137400
              LCLC  &ZXCREAD    ++ INPUT VALUE                          00137500
              LCLC  &ZXADDRSP   ++ INPUT VALUE                          00137600
              LCLC  &ZXIOPATH   ++ INPUT VALUE                          00137700
              LCLC  &ZXCWRITE   ++ INPUT VALUE                          00137800
              LCLC  &ZXKEEP     ++ INPUT VALUE                          00137900
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00138000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00138100
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00138200
              LCLC  &ZXMF       ++ INPUT VALUE                          00138300
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00138400
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00138500
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00138600
.********************************************************************   00138700
.***AC.PLV01  PROCESS PLISTVER                                      *   00138800
.********************************************************************   00138900
&XPLISTVER      SETA  0                                                 00139000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00139100
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00139200
&XPLISTVER      SETA  1                                                 00139300
.ZPLV0          ANOP  ,                                                 00139400
.*                                                                      00139500
                AIF   ('&HSPALET' EQ '').ZPLV1E                         00139600
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00139700
&XPLISTVER      SETA  1                                                 00139800
.ZPLV1E         ANOP  ,                                                 00139900
.*                                                                      00140000
                AIF   ('&HSPALET' EQ '').ZPLV2E                         00140100
                AIF   (&XPLISTVER GE 1).ZPLV2E                          00140200
&XPLISTVER      SETA  1                                                 00140300
.ZPLV2E         ANOP  ,                                                 00140400
.*                                                                      00140500
                AIF   ('&HSPALET' EQ '').ZPLV3E                         00140600
                AIF   (&XPLISTVER GE 1).ZPLV3E                          00140700
&XPLISTVER      SETA  1                                                 00140800
.ZPLV3E         ANOP  ,                                                 00140900
.*                                                                      00141000
                AIF   ('&HSPALET' EQ '').ZPLV4E                         00141100
                AIF   (&XPLISTVER GE 1).ZPLV4E                          00141200
&XPLISTVER      SETA  1                                                 00141300
.ZPLV4E         ANOP  ,                                                 00141400
.*                                                                      00141500
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00141600
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00141700
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00141800
.*-------------------------------------------------------------------   00141900
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00142000
&ZMS            SETC  '"PLISTVER='                                      00142100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00142200
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00142300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00142400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00142500
                AGO   .ZPVCK2                                           00142600
.ZPVCK3         ANOP  ,                                                 00142700
.*-------------------------------------------------------------------   00142800
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00142900
&ZMS            SETC  '"PLISTVER='                                      00143000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00143100
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00143200
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00143300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00143400
                AGO   .ZPVCKE                                           00143500
.ZPVCK2         ANOP  ,                                                 00143600
.*-------------------------------------------------------------------   00143700
&ZCVAL          SETC  '&PLISTVER(1)'                                    00143800
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00143900
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00144000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00144100
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00144200
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00144300
.ZPVCK6         ANOP  ,                                                 00144400
&ZMS            SETC  '"PLISTVER='                                      00144500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00144600
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00144700
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00144800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00144900
&XPLISTVER      SETA  1                                                 00145000
                AGO   .ZPVCKE                                           00145100
.*-------------------------------------------------------------------   00145200
.ZPVCK4A        ANOP  ,                                                 00145300
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00145400
&ZMS            SETC  'PLISTVER='                                       00145500
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00145600
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00145700
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00145800
                MNOTE 8,' &ZMS IS REQUIRED.'                            00145900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00146000
                AGO   .ZPVCK5                                           00146100
.ZPVCK4         ANOP  ,                                                 00146200
&XPLISTVER      SETA  &PLISTVER(1)                                      00146300
.ZPVCK5         ANOP  ,                                                 00146400
.ZPVCKE         ANOP  ,                                                 00146500
.********************************************************************   00146600
.***AG.MF01 PROCESS MF MACRO FORMS                                      00146700
.********************************************************************   00146800
              ACTR  10000                                               00146900
.*------------------------------------------------------------------    00147000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147100
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00147200
.*-------------------------------------------------------------------   00147300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147400
.ZG98         ANOP  ,                                                   00147500
&ZTLC         SETC 'S'                                                  00147600
              AIF   ('&MF(1)' NE '&ZTLC').ZG99                          00147700
&XMF          SETC  'S'         SET KEYWORD                             00147800
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00147900
              AIF   (N'&MF LE 1).ZG98A          CK NUM                  00148000
&ZMS          SETC  '"MF='                                              00148100
&ZMS          SETC  '&ZMS.&MF"'                                         00148200
&ZMS          SETC  '&ZMS "MF"'                                         00148300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00148400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148500
.ZG98A        ANOP  ,                                                   00148600
.*-------------------------------------------------------------------   00148700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148800
.ZG99         ANOP  ,                                                   00148900
&ZTLC         SETC 'L'                                                  00149000
              AIF   ('&MF(1)' NE '&ZTLC').ZG106                         00149100
&XMF          SETC  'L'         SET KEYWORD                             00149200
              AIF   (N'&MF LE 3).ZG99A          CK NUM                  00149300
&ZMS          SETC  '"MF='                                              00149400
&ZMS          SETC  '&ZMS.&MF"'                                         00149500
&ZMS          SETC  '&ZMS "MF"'                                         00149600
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00149700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149800
.ZG99A        ANOP  ,                                                   00149900
.*-------------------------------------------------------------------   00150000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00150100
              AIF   (N'&SYSLIST NE 0).ZG99B     POSITIONALS?            00150200
              AIF   ('&STOKEN' NE '').ZG99B     KEYS?                   00150300
              AIF   ('&NUMRANGE' NE '').ZG99B   KEYS?                   00150400
              AIF   ('&RANGLIST' NE '').ZG99B   KEYS?                   00150500
              AIF   ('&RELEASE' NE '').ZG99B    KEYS?                   00150600
              AIF   ('&HSPALET' NE '').ZG99B    KEYS?                   00150700
              AIF   ('&ADDRSP' NE '').ZG99B     KEYS?                   00150800
              AIF   ('&IOPATH' NE '').ZG99B     KEYS?                   00150900
              AIF   ('&KEEP' NE '').ZG99B       KEYS?                   00151000
              AIF   ('&RETCODE' NE '').ZG99B    KEYS?                   00151100
              AIF   ('&RSNCODE' NE '').ZG99B    KEYS?                   00151200
              AGO    .ZG99C     INVOCATION OKAY                         00151300
.ZG99B        ANOP  ,                                                   00151400
&ZMS          SETC  'THE "L" FORM OF "MF"'                              00151500
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00151600
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00151700
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00151800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151900
.ZG99C        ANOP  ,                                                   00152000
.*-------------------------------------------------------------------   00152100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00152200
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00152300
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00152400
              AIF   (N'&MF(2) GT 1).ZG101B      MULTI                   00152500
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00152600
.ZG101B       AIF   (K'&MF(2) GT 0).ZG101C                              00152700
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00152800
&ZMS          SETC  ' '                                                 00152900
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00153000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00153100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00153200
.ZG101C       ANOP  ,                                                   00153300
.*-------------------------------------------------------------------   00153400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00153500
              AIF   (K'&ZXMFCTRL LE 0).ZG101P   NOT I/O                 00153600
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG101P                     00153700
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00153800
&ZMS          SETC  '"MF='                                              00153900
&ZMS          SETC  '&ZMS.&MF"'                                         00154000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00154100
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00154200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00154300
.ZG101P       ANOP  ,                                                   00154400
.*-------------------------------------------------------------------   00154500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00154600
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00154700
&XMFATTR      SETC  '0D'                                                00154800
              AIF   (K'&MF(3) LE 0).ZG104B      PARM                    00154900
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00155000
              AIF   (N'&MF(3) GT 1).ZG104B      MULTI                   00155100
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00155200
.ZG104B       ANOP  ,                                                   00155300
.*-------------------------------------------------------------------   00155400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00155500
              AIF   (K'&ZXMFATTR LE 0).ZG104P   NOT I/O                 00155600
              AIF   ('&XMFATTR'(1,1) NE '(').ZG104P                     00155700
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00155800
&ZMS          SETC  '"MF='                                              00155900
&ZMS          SETC  '&ZMS.&MF"'                                         00156000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00156100
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00156200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00156300
.ZG104P       ANOP  ,                                                   00156400
.*-------------------------------------------------------------------   00156500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00156600
              AIF   (K'&ZXMFATTR LE 0).ZG104S   NOT I/O                 00156700
              AIF   (K'&XMFATTR LE 60).ZG104S   LNG OK                  00156800
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00156900
&ZMS          SETC  '"MF='                                              00157000
&ZMS          SETC  '&ZMS.&MF"'                                         00157100
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00157200
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00157300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157400
.ZG104S       ANOP  ,                                                   00157500
.*-------------------------------------------------------------------   00157600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157700
.ZG106        ANOP  ,                                                   00157800
&ZTLC         SETC 'M'                                                  00157900
              AIF   ('&MF(1)' NE '&ZTLC').ZG115                         00158000
&XMF          SETC  'M'         SET KEYWORD                             00158100
              AIF   (N'&MF LE 3).ZG106A         CK NUM                  00158200
&ZMS          SETC  '"MF='                                              00158300
&ZMS          SETC  '&ZMS.&MF"'                                         00158400
&ZMS          SETC  '&ZMS "MF"'                                         00158500
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00158600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00158700
.ZG106A       ANOP  ,                                                   00158800
.*-------------------------------------------------------------------   00158900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00159000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00159100
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00159200
              AIF   (N'&MF(2) GT 1).ZG108B      MULTI                   00159300
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00159400
.ZG108B       AIF   (K'&MF(2) GT 0).ZG108C                              00159500
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00159600
&ZMS          SETC  'WHEN "M" IS SPECIFIED'                             00159700
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00159800
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00159900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00160000
.ZG108C       ANOP  ,                                                   00160100
.*-------------------------------------------------------------------   00160200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00160300
              AIF   (K'&ZXMFCTRL LE 0).ZG108R   NOT I/O                 00160400
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG108R                     00160500
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00160600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG108P                       00160700
              AIF   (K'&ZCGPR GT 2).ZG108Q                              00160800
              AIF   ('&ZCGPR' EQ '0').ZG108Q                            00160900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00161000
              AIF   (T'&ZCGPR NE 'N').ZG108Q    INVALID REG NAME        00161100
.ZG108P       ANOP  ,                                                   00161200
              AIF   (T'&ZCGPR NE 'N').ZG108R    NON NUMERIC             00161300
              AIF   ('&ZCGPR' LT '1').ZG108Q                            00161400
              AIF   ('&ZCGPR' LE '12').ZG108R                           00161500
.ZG108Q       ANOP  ,                                                   00161600
&ZMS          SETC  '"MF='                                              00161700
&ZMS          SETC  '&ZMS.&MF"'                                         00161800
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00161900
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00162000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162100
.ZG108R       ANOP  ,                                                   00162200
.*-------------------------------------------------------------------   00162300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00162400
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00162500
.ZG112A   AIF   ('&MF(3)' NE 'COMPLETE').ZG113A                         00162600
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00162700
.*-------------------------------------------------------------------   00162800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00162900
.ZG113A   AIF   ('&MF(3)' NE 'NOCHECK').ZG114A                          00163000
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00163100
.*-------------------------------------------------------------------   00163200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00163300
.ZG114A       AIF   (K'&XMFSCK GT 0).ZG114C     KEYWORD                 00163400
              AIF   (K'&MF(3) LE 0).ZG114B                              00163500
&ZMS          SETC  '"MF='                                              00163600
&ZMS          SETC  '&ZMS.&MF"'                                         00163700
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00163800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00163900
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00164000
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00164100
              MNOTE 8,' &ZMS '                                          00164200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00164300
.ZG114B       ANOP  ,                                                   00164400
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00164500
.ZG114C       ANOP  ,                                                   00164600
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00164700
.*-------------------------------------------------------------------   00164800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00164900
.ZG115        ANOP  ,                                                   00165000
&ZTLC         SETC 'E'                                                  00165100
              AIF   ('&MF(1)' NE '&ZTLC').ZG124                         00165200
&XMF          SETC  'E'         SET KEYWORD                             00165300
              AIF   (N'&MF LE 3).ZG115A         CK NUM                  00165400
&ZMS          SETC  '"MF='                                              00165500
&ZMS          SETC  '&ZMS.&MF"'                                         00165600
&ZMS          SETC  '&ZMS "MF"'                                         00165700
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00165800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00165900
.ZG115A       ANOP  ,                                                   00166000
.*-------------------------------------------------------------------   00166100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00166200
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00166300
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00166400
              AIF   (N'&MF(2) GT 1).ZG117B      MULTI                   00166500
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00166600
.ZG117B       AIF   (K'&MF(2) GT 0).ZG117C                              00166700
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00166800
&ZMS          SETC  'WHEN "E" IS SPECIFIED'                             00166900
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00167000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00167100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00167200
.ZG117C       ANOP  ,                                                   00167300
.*-------------------------------------------------------------------   00167400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00167500
              AIF   (K'&ZXMFCTRL LE 0).ZG117R   NOT I/O                 00167600
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG117R                     00167700
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00167800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG117P                       00167900
              AIF   (K'&ZCGPR GT 2).ZG117Q                              00168000
              AIF   ('&ZCGPR' EQ '0').ZG117Q                            00168100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00168200
              AIF   (T'&ZCGPR NE 'N').ZG117Q    INVALID REG NAME        00168300
.ZG117P       ANOP  ,                                                   00168400
              AIF   (T'&ZCGPR NE 'N').ZG117R    NON NUMERIC             00168500
              AIF   ('&ZCGPR' LT '1').ZG117Q                            00168600
              AIF   ('&ZCGPR' LE '12').ZG117R                           00168700
.ZG117Q       ANOP  ,                                                   00168800
&ZMS          SETC  '"MF='                                              00168900
&ZMS          SETC  '&ZMS.&MF"'                                         00169000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00169100
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00169200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00169300
.ZG117R       ANOP  ,                                                   00169400
.*-------------------------------------------------------------------   00169500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00169600
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00169700
.ZG121A   AIF   ('&MF(3)' NE 'COMPLETE').ZG122A                         00169800
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00169900
.*-------------------------------------------------------------------   00170000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00170100
.ZG122A   AIF   ('&MF(3)' NE 'NOCHECK').ZG123A                          00170200
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00170300
.*-------------------------------------------------------------------   00170400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00170500
.ZG123A       AIF   (K'&XMFSCK GT 0).ZG123C     KEYWORD                 00170600
              AIF   (K'&MF(3) LE 0).ZG123B                              00170700
&ZMS          SETC  '"MF='                                              00170800
&ZMS          SETC  '&ZMS.&MF"'                                         00170900
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00171000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00171100
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00171200
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00171300
              MNOTE 8,' &ZMS '                                          00171400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00171500
.ZG123B       ANOP  ,                                                   00171600
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00171700
.ZG123C       ANOP  ,                                                   00171800
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00171900
.*------------------------------------------------------------------    00172000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00172100
.ZG124        ANOP  ,                                                   00172200
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00172300
              AIF   (K'&XMF GT 0).ZG124E        VALID ARG               00172400
              AIF   (T'&MF EQ 'O').ZG124D       OMITTED                 00172500
&ZASYSLNDX    SETA  0                                                   00172600
.ZG124A       ANOP  ,           POSITIONAL MACRO KEY                    00172700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00172800
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG124C                   00172900
&ZTLC         SETC 'MF'                                                 00173000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG124A          00173100
.ZG124B       ANOP  ,                                                   00173200
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00173300
&ZMS          SETC  'THE "MF" KEY'                                      00173400
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00173500
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00173600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00173700
              AGO   .ZG124E                                             00173800
.ZG124C       ANOP  ,                                                   00173900
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00174000
&ZMS          SETC  '"MF='                                              00174100
&ZMS          SETC  '&ZMS.&MF"'                                         00174200
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00174300
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00174400
&ZMS          SETC  '&ZMS "S",'                                         00174500
&ZMS          SETC  '&ZMS "L",'                                         00174600
&ZMS          SETC  '&ZMS "M",'                                         00174700
&ZMS          SETC  '&ZMS OR "E".'                                      00174800
              MNOTE 8,' &ZMS '                                          00174900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175000
              AGO   .ZG124E                                             00175100
.ZG124D       ANOP  ,                                                   00175200
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00175300
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00175400
.ZG124E       ANOP  ,                                                   00175500
.********************************************************************   00175600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00175700
.********************************************************************   00175800
              ACTR  10000                                               00175900
.*-------------------------------------------------------------------   00176000
.***AG.MF03 MF=(SLME)                                                   00176100
              AIF   ('&XMF' EQ 'L').ZGMFX                               00176200
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00176300
.*-------------------------------------------------------------------   00176400
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00176500
&XSERVICE     SETC  ''          INITIALIZE XVARIABLE                    00176600
&ZASYSLNDX    SETA  0                                                   00176700
.ZG2A         ANOP  ,           POSITIONAL KEY SEARCH                   00176800
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00176900
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00177000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00177100
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'SREAD').ZG2A                 00177200
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00177300
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00177400
&XSERVICE     SETC  'SREAD'     SET XVARIABLE                           00177500
&ZXSREAD      SETC  'INPUT'     SET IN/OUTPUT                           00177600
&XSREAD       SETC  'SREAD'     SET XVARIABLE PARM                      00177700
.ZG2B         ANOP  ,                                                   00177800
.*-------------------------------------------------------------------   00177900
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00178000
&ZASYSLNDX    SETA  0                                                   00178100
.ZG20A        ANOP  ,           POSITIONAL KEY SEARCH                   00178200
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00178300
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG20C  DONE                   00178400
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG20A            00178500
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'SWRITE').ZG20A               00178600
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00178700
              AIF   (K'&XSERVICE LE 0).ZG20B    VALID                   00178800
&ZMS          SETC  '"SWRITE'                                           00178900
&ZMS          SETC  '&ZMS."'                                            00179000
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00179100
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00179200
              MNOTE 8,' &ZMS KEY.'                                      00179300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00179400
              AGO   .ZG20C                                              00179500
.*                                                                      00179600
.ZG20B        ANOP  ,                                                   00179700
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00179800
&XSERVICE     SETC  'SWRITE'    SET XVARIABLE                           00179900
&ZXSWRITE     SETC  'INPUT'     SET IN/OUTPUT                           00180000
&XSWRITE      SETC  'SWRITE'    SET XVARIABLE PARM                      00180100
.ZG20C        ANOP  ,                                                   00180200
.*-------------------------------------------------------------------   00180300
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00180400
&ZASYSLNDX    SETA  0                                                   00180500
.ZG33A        ANOP  ,           POSITIONAL KEY SEARCH                   00180600
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00180700
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG33C  DONE                   00180800
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG33A            00180900
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CREAD').ZG33A                00181000
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00181100
              AIF   (K'&XSERVICE LE 0).ZG33B    VALID                   00181200
&ZMS          SETC  '"CREAD'                                            00181300
&ZMS          SETC  '&ZMS."'                                            00181400
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00181500
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00181600
              MNOTE 8,' &ZMS KEY.'                                      00181700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00181800
              AGO   .ZG33C                                              00181900
.*                                                                      00182000
.ZG33B        ANOP  ,                                                   00182100
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00182200
&XSERVICE     SETC  'CREAD'     SET XVARIABLE                           00182300
&ZXCREAD      SETC  'INPUT'     SET IN/OUTPUT                           00182400
&XCREAD       SETC  'CREAD'     SET XVARIABLE PARM                      00182500
.ZG33C        ANOP  ,                                                   00182600
.*-------------------------------------------------------------------   00182700
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00182800
&ZASYSLNDX    SETA  0                                                   00182900
.ZG57A        ANOP  ,           POSITIONAL KEY SEARCH                   00183000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00183100
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG57C  DONE                   00183200
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG57A            00183300
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CWRITE').ZG57A               00183400
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00183500
              AIF   (K'&XSERVICE LE 0).ZG57B    VALID                   00183600
&ZMS          SETC  '"CWRITE'                                           00183700
&ZMS          SETC  '&ZMS."'                                            00183800
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00183900
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00184000
              MNOTE 8,' &ZMS KEY.'                                      00184100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00184200
              AGO   .ZG57C                                              00184300
.*                                                                      00184400
.ZG57B        ANOP  ,                                                   00184500
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00184600
&XSERVICE     SETC  'CWRITE'    SET XVARIABLE                           00184700
&ZXCWRITE     SETC  'INPUT'     SET IN/OUTPUT                           00184800
&XCWRITE      SETC  'CWRITE'    SET XVARIABLE PARM                      00184900
.ZG57C        ANOP  ,                                                   00185000
.*------------------------------------------------------------------    00185100
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00185200
              AIF   (K'&XSERVICE GT 0).ZG86B                            00185300
&ZXSERVICE    SETC  ''          RESET IN/OUTPUT                         00185400
&ZXSREAD      SETC  ''          RESET IN/OUTPUT                         00185500
&XSERVICE     SETC  ''          ENSURE NULL                             00185600
&XSREAD       SETC  ''          ENSURE NULL                             00185700
&ZMS          SETC  'ONE OF THE FOLLOWING'                              00185800
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 00185900
&ZMS          SETC  '&ZMS REQUIRED:'                                    00186000
&ZMS          SETC  '&ZMS "SREAD",'             VALID ME KEY            00186100
&ZMS          SETC  '&ZMS "SWRITE",'            VALID ME KEY            00186200
&ZMS          SETC  '&ZMS "CREAD",'             VALID ME KEY            00186300
&ZMS          SETC  '&ZMS OR "CWRITE".'         VALID ME KEY            00186400
              MNOTE 8,' &ZMS '                                          00186500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00186600
.ZG86B        ANOP  ,                                                   00186700
.*-------------------------------------------------------------------   00186800
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00186900
.ZG2ZY  AIF    ('&XSERVICE' NE 'SREAD').ZG20ZY                          00187000
.*-------------------------------------------------------------------   00187100
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00187200
&ZCVAL        SETC ''           ERROR KEY FIELD                         00187300
.ZG2I0        AIF   (K'&ADDRSP LE 0).ZG2I1                              00187400
&ZCVAL        SETC '&ZCVAL ADDRSP'              DISALLOWED KEY          00187500
.ZG2I1        AIF   (K'&IOPATH LE 0).ZG2I2                              00187600
&ZCVAL        SETC '&ZCVAL IOPATH'              DISALLOWED KEY          00187700
.ZG2I2        AIF   (K'&KEEP LE 0).ZG2I3                                00187800
&ZCVAL        SETC '&ZCVAL KEEP'                DISALLOWED KEY          00187900
.ZG2I3        AIF   (K'&ZCVAL LE 0).ZG2J        KEY                     00188000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00188100
&ZMS          SETC  '"SREAD'                                            00188200
&ZMS          SETC  '&ZMS."'                                            00188300
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00188400
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00188500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00188600
.ZG2J         ANOP  ,                                                   00188700
.*----------------------------------------------------------------***   00188800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00188900
              AIF   (N'&STOKEN LE 1).ZG4A       CK NUM                  00189000
&ZMS          SETC  '"STOKEN='                                          00189100
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00189200
&ZMS          SETC  '&ZMS "STOKEN"'                                     00189300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00189400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00189500
.ZG4A         ANOP  ,                                                   00189600
.*-------------------------------------------------------------------   00189700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00189800
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00189900
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00190000
              AIF   (N'&STOKEN GT 1).ZG4B       MULTI                   00190100
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00190200
.ZG4B         AIF   (K'&STOKEN(1) GT 0).ZG4C                            00190300
&ZXSTOKEN     SETC  ''          RESET IN/OUTPUT                         00190400
&ZMS          SETC  ' '                                                 00190500
&ZMS          SETC  '&ZMS "STOKEN" KEY AND ITS'                         00190600
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00190700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00190800
.ZG4C         ANOP  ,                                                   00190900
.*-------------------------------------------------------------------   00191000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00191100
              AIF   (K'&ZXSTOKEN LE 0).ZG4R     NOT I/O                 00191200
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG4R                       00191300
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00191400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                         00191500
              AIF   (K'&ZCGPR GT 2).ZG4Q                                00191600
              AIF   ('&ZCGPR' EQ '0').ZG4Q                              00191700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00191800
              AIF   (T'&ZCGPR NE 'N').ZG4Q      INVALID REG NAME        00191900
.ZG4P         ANOP  ,                                                   00192000
              AIF   (T'&ZCGPR NE 'N').ZG4R      NON NUMERIC             00192100
              AIF   ('&ZCGPR' LT '2').ZG4Q                              00192200
              AIF   ('&ZCGPR' LE '12').ZG4R                             00192300
.ZG4Q         ANOP  ,                                                   00192400
&ZMS          SETC  '"STOKEN='                                          00192500
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00192600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00192700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00192800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00192900
.ZG4R         ANOP  ,                                                   00193000
.*----------------------------------------------------------------***   00193100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00193200
              AIF   (N'&NUMRANGE LE 1).ZG7A     CK NUM                  00193300
&ZMS          SETC  '"NUMRANGE='                                        00193400
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00193500
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00193600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00193700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00193800
.ZG7A         ANOP  ,                                                   00193900
.*-------------------------------------------------------------------   00194000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00194100
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00194200
&XNUMRANGE    SETC  '1'                                                 00194300
              AIF   (K'&NUMRANGE(1) LE 0).ZG7B  PARM                    00194400
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00194500
              AIF   (N'&NUMRANGE GT 1).ZG7B     MULTI                   00194600
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00194700
.ZG7B         ANOP  ,                                                   00194800
.*-------------------------------------------------------------------   00194900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00195000
              AIF   (K'&ZXNUMRANGE LE 0).ZG7R   NOT I/O                 00195100
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZG7R                     00195200
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00195300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                         00195400
              AIF   (K'&ZCGPR GT 2).ZG7Q                                00195500
              AIF   ('&ZCGPR' EQ '0').ZG7Q                              00195600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00195700
              AIF   (T'&ZCGPR NE 'N').ZG7Q      INVALID REG NAME        00195800
.ZG7P         ANOP  ,                                                   00195900
              AIF   (T'&ZCGPR NE 'N').ZG7R      NON NUMERIC             00196000
              AIF   ('&ZCGPR' LT '2').ZG7Q                              00196100
              AIF   ('&ZCGPR' LE '12').ZG7R                             00196200
.ZG7Q         ANOP  ,                                                   00196300
&ZMS          SETC  '"NUMRANGE='                                        00196400
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00196500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00196600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00196700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00196800
.ZG7R         ANOP  ,                                                   00196900
.*----------------------------------------------------------------***   00197000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00197100
              AIF   (N'&RANGLIST LE 1).ZG10A    CK NUM                  00197200
&ZMS          SETC  '"RANGLIST='                                        00197300
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00197400
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00197500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00197600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00197700
.ZG10A        ANOP  ,                                                   00197800
.*-------------------------------------------------------------------   00197900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00198000
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00198100
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00198200
              AIF   (N'&RANGLIST GT 1).ZG10B    MULTI                   00198300
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00198400
.ZG10B        AIF   (K'&RANGLIST(1) GT 0).ZG10C                         00198500
&ZXRANGLIST   SETC  ''          RESET IN/OUTPUT                         00198600
&ZMS          SETC  ' '                                                 00198700
&ZMS          SETC  '&ZMS "RANGLIST" KEY AND ITS'                       00198800
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00198900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00199000
.ZG10C        ANOP  ,                                                   00199100
.*-------------------------------------------------------------------   00199200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00199300
              AIF   (K'&ZXRANGLIST LE 0).ZG10R  NOT I/O                 00199400
              AIF   ('&XRANGLIST'(1,1) NE '(').ZG10R                    00199500
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00199600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        00199700
              AIF   (K'&ZCGPR GT 2).ZG10Q                               00199800
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             00199900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00200000
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        00200100
.ZG10P        ANOP  ,                                                   00200200
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             00200300
              AIF   ('&ZCGPR' LT '2').ZG10Q                             00200400
              AIF   ('&ZCGPR' LE '12').ZG10R                            00200500
.ZG10Q        ANOP  ,                                                   00200600
&ZMS          SETC  '"RANGLIST='                                        00200700
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00200800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00200900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00201000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00201100
.ZG10R        ANOP  ,                                                   00201200
.*------------------------------------------------------------------    00201300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00201400
&XRELEASE     SETC  ''          INITIALIZE XVARIABLE                    00201500
.*-------------------------------------------------------------------   00201600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00201700
.ZG14         ANOP  ,                                                   00201800
              AIF   (K'&RELEASE(1) LE 0).ZG14A                          00201900
&ZTLC         SETC 'NO'                                                 00202000
              AIF   ('&RELEASE(1)' NE '&ZTLC').ZG18                     00202100
&XRELEASE     SETC  'NO'        SET KEYWORD                             00202200
              AIF   (N'&RELEASE LE 1).ZG14A     CK NUM                  00202300
&ZMS          SETC  '"RELEASE='                                         00202400
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00202500
&ZMS          SETC  '&ZMS "RELEASE"'                                    00202600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00202700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00202800
.ZG14A        ANOP  ,                                                   00202900
.*----------------------------------------------------------------***   00203000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00203100
              AIF   (N'&HSPALET LE 1).ZG16A     CK NUM                  00203200
&ZMS          SETC  '"HSPALET='                                         00203300
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00203400
&ZMS          SETC  '&ZMS "HSPALET"'                                    00203500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00203600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00203700
.ZG16A        ANOP  ,                                                   00203800
.*-------------------------------------------------------------------   00203900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00204000
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00204100
&XHSPALET     SETC  '0'                                                 00204200
              AIF   (K'&HSPALET(1) LE 0).ZG16B  PARM                    00204300
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00204400
              AIF   (N'&HSPALET GT 1).ZG16B     MULTI                   00204500
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00204600
.ZG16B        ANOP  ,                                                   00204700
.*-------------------------------------------------------------------   00204800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00204900
              AIF   (K'&ZXHSPALET LE 0).ZG16R   NOT I/O                 00205000
         AIF   ('&XHSPALET' EQ '0').ZG16R                               00205100
              AIF   ('&XHSPALET'(1,1) NE '(').ZG16R                     00205200
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00205300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        00205400
              AIF   (K'&ZCGPR GT 2).ZG16Q                               00205500
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             00205600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00205700
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        00205800
.ZG16P        ANOP  ,                                                   00205900
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             00206000
              AIF   ('&ZCGPR' LT '2').ZG16Q                             00206100
              AIF   ('&ZCGPR' LE '12').ZG16R                            00206200
.ZG16Q        ANOP  ,                                                   00206300
&ZMS          SETC  '"HSPALET='                                         00206400
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00206500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00206600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00206700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00206800
.ZG16R        ANOP  ,                                                   00206900
.*-------------------------------------------------------------------   00207000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00207100
.ZG18         ANOP  ,                                                   00207200
&ZTLC         SETC 'YES'                                                00207300
              AIF   ('&RELEASE(1)' NE '&ZTLC').ZG19                     00207400
&XRELEASE     SETC  'YES'       SET KEYWORD                             00207500
              AIF   (N'&RELEASE LE 1).ZG18A     CK NUM                  00207600
&ZMS          SETC  '"RELEASE='                                         00207700
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00207800
&ZMS          SETC  '&ZMS "RELEASE"'                                    00207900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00208000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00208100
.ZG18A        ANOP  ,                                                   00208200
.*------------------------------------------------------------------    00208300
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00208400
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00208500
.ZG18A0       AIF   (K'&HSPALET LE 0).ZG18A1    OK                      00208600
&ZCVAL        SETC '&ZCVAL HSPALET'             INCORRECT KEY USED      00208700
.ZG18A1       AIF   (K'&ZCVAL LE 0).ZG18A2      OK                      00208800
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00208900
&ZMS          SETC  '"RELEASE'                                          00209000
&ZMS          SETC  '&ZMS.=&RELEASE"'                                   00209100
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00209200
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00209300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00209400
.ZG18A2       ANOP  ,                                                   00209500
.*------------------------------------------------------------------    00209600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00209700
.ZG19         ANOP  ,                                                   00209800
&ZXRELEASE    SETC  'INPUT'     SET IN/OUTPUT                           00209900
              AIF   (K'&XRELEASE GT 0).ZG19E    VALID ARG               00210000
              AIF   (T'&RELEASE EQ 'O').ZG19D   OMITTED                 00210100
&ZASYSLNDX    SETA  0                                                   00210200
.ZG19A        ANOP  ,           POSITIONAL MACRO KEY                    00210300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00210400
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG19C                    00210500
&ZTLC         SETC 'RELEASE'                                            00210600
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG19A           00210700
.ZG19B        ANOP  ,                                                   00210800
&ZXRELEASE    SETC  ''          RESET IN/OUTPUT                         00210900
&ZMS          SETC  'THE "RELEASE" KEY'                                 00211000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00211100
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00211200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00211300
              AGO   .ZG19E                                              00211400
.ZG19C        ANOP  ,                                                   00211500
&ZXRELEASE    SETC  ''          RESET IN/OUTPUT                         00211600
&ZMS          SETC  '"RELEASE='                                         00211700
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00211800
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00211900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00212000
&ZMS          SETC  '&ZMS "NO"'                                         00212100
&ZMS          SETC  '&ZMS OR "YES".'                                    00212200
              MNOTE 8,' &ZMS '                                          00212300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00212400
              AGO   .ZG19E                                              00212500
.ZG19D        ANOP  ,                                                   00212600
&XRELEASE     SETC  'NO'        SET DEFAULT KEYWORD                     00212700
.ZG19E        ANOP  ,                                                   00212800
.*-------------------------------------------------------------------   00212900
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00213000
.ZG20ZY  AIF    ('&XSERVICE' NE 'SWRITE').ZG33ZY                        00213100
.*-------------------------------------------------------------------   00213200
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00213300
&ZCVAL        SETC ''           ERROR KEY FIELD                         00213400
.ZG20I0       AIF   (K'&RELEASE LE 0).ZG20I1                            00213500
&ZCVAL        SETC '&ZCVAL RELEASE'             DISALLOWED KEY          00213600
.ZG20I1       AIF   (K'&ADDRSP LE 0).ZG20I2                             00213700
&ZCVAL        SETC '&ZCVAL ADDRSP'              DISALLOWED KEY          00213800
.ZG20I2       AIF   (K'&IOPATH LE 0).ZG20I3                             00213900
&ZCVAL        SETC '&ZCVAL IOPATH'              DISALLOWED KEY          00214000
.ZG20I3       AIF   (K'&KEEP LE 0).ZG20I4                               00214100
&ZCVAL        SETC '&ZCVAL KEEP'                DISALLOWED KEY          00214200
.ZG20I4       AIF   (K'&ZCVAL LE 0).ZG20J       KEY                     00214300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00214400
&ZMS          SETC  '"SWRITE'                                           00214500
&ZMS          SETC  '&ZMS."'                                            00214600
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00214700
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00214800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00214900
.ZG20J        ANOP  ,                                                   00215000
.*----------------------------------------------------------------***   00215100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00215200
              AIF   (N'&STOKEN LE 1).ZG22A      CK NUM                  00215300
&ZMS          SETC  '"STOKEN='                                          00215400
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00215500
&ZMS          SETC  '&ZMS "STOKEN"'                                     00215600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00215700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00215800
.ZG22A        ANOP  ,                                                   00215900
.*-------------------------------------------------------------------   00216000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00216100
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00216200
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00216300
              AIF   (N'&STOKEN GT 1).ZG22B      MULTI                   00216400
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00216500
.ZG22B        AIF   (K'&STOKEN(1) GT 0).ZG22C                           00216600
&ZXSTOKEN     SETC  ''          RESET IN/OUTPUT                         00216700
&ZMS          SETC  ' '                                                 00216800
&ZMS          SETC  '&ZMS "STOKEN" KEY AND ITS'                         00216900
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00217000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00217100
.ZG22C        ANOP  ,                                                   00217200
.*-------------------------------------------------------------------   00217300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00217400
              AIF   (K'&ZXSTOKEN LE 0).ZG22R    NOT I/O                 00217500
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG22R                      00217600
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00217700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                        00217800
              AIF   (K'&ZCGPR GT 2).ZG22Q                               00217900
              AIF   ('&ZCGPR' EQ '0').ZG22Q                             00218000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00218100
              AIF   (T'&ZCGPR NE 'N').ZG22Q     INVALID REG NAME        00218200
.ZG22P        ANOP  ,                                                   00218300
              AIF   (T'&ZCGPR NE 'N').ZG22R     NON NUMERIC             00218400
              AIF   ('&ZCGPR' LT '2').ZG22Q                             00218500
              AIF   ('&ZCGPR' LE '12').ZG22R                            00218600
.ZG22Q        ANOP  ,                                                   00218700
&ZMS          SETC  '"STOKEN='                                          00218800
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00218900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00219000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00219100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00219200
.ZG22R        ANOP  ,                                                   00219300
.*----------------------------------------------------------------***   00219400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00219500
              AIF   (N'&NUMRANGE LE 1).ZG25A    CK NUM                  00219600
&ZMS          SETC  '"NUMRANGE='                                        00219700
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00219800
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00219900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00220000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00220100
.ZG25A        ANOP  ,                                                   00220200
.*-------------------------------------------------------------------   00220300
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00220400
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00220500
&XNUMRANGE    SETC  '1'                                                 00220600
              AIF   (K'&NUMRANGE(1) LE 0).ZG25B  PARM                   00220700
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00220800
              AIF   (N'&NUMRANGE GT 1).ZG25B    MULTI                   00220900
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00221000
.ZG25B        ANOP  ,                                                   00221100
.*-------------------------------------------------------------------   00221200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00221300
              AIF   (K'&ZXNUMRANGE LE 0).ZG25R  NOT I/O                 00221400
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZG25R                    00221500
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00221600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                        00221700
              AIF   (K'&ZCGPR GT 2).ZG25Q                               00221800
              AIF   ('&ZCGPR' EQ '0').ZG25Q                             00221900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00222000
              AIF   (T'&ZCGPR NE 'N').ZG25Q     INVALID REG NAME        00222100
.ZG25P        ANOP  ,                                                   00222200
              AIF   (T'&ZCGPR NE 'N').ZG25R     NON NUMERIC             00222300
              AIF   ('&ZCGPR' LT '2').ZG25Q                             00222400
              AIF   ('&ZCGPR' LE '12').ZG25R                            00222500
.ZG25Q        ANOP  ,                                                   00222600
&ZMS          SETC  '"NUMRANGE='                                        00222700
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00222800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00222900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00223000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00223100
.ZG25R        ANOP  ,                                                   00223200
.*----------------------------------------------------------------***   00223300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00223400
              AIF   (N'&RANGLIST LE 1).ZG28A    CK NUM                  00223500
&ZMS          SETC  '"RANGLIST='                                        00223600
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00223700
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00223800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00223900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00224000
.ZG28A        ANOP  ,                                                   00224100
.*-------------------------------------------------------------------   00224200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00224300
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00224400
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00224500
              AIF   (N'&RANGLIST GT 1).ZG28B    MULTI                   00224600
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00224700
.ZG28B        AIF   (K'&RANGLIST(1) GT 0).ZG28C                         00224800
&ZXRANGLIST   SETC  ''          RESET IN/OUTPUT                         00224900
&ZMS          SETC  ' '                                                 00225000
&ZMS          SETC  '&ZMS "RANGLIST" KEY AND ITS'                       00225100
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00225200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00225300
.ZG28C        ANOP  ,                                                   00225400
.*-------------------------------------------------------------------   00225500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00225600
              AIF   (K'&ZXRANGLIST LE 0).ZG28R  NOT I/O                 00225700
              AIF   ('&XRANGLIST'(1,1) NE '(').ZG28R                    00225800
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00225900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                        00226000
              AIF   (K'&ZCGPR GT 2).ZG28Q                               00226100
              AIF   ('&ZCGPR' EQ '0').ZG28Q                             00226200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00226300
              AIF   (T'&ZCGPR NE 'N').ZG28Q     INVALID REG NAME        00226400
.ZG28P        ANOP  ,                                                   00226500
              AIF   (T'&ZCGPR NE 'N').ZG28R     NON NUMERIC             00226600
              AIF   ('&ZCGPR' LT '2').ZG28Q                             00226700
              AIF   ('&ZCGPR' LE '12').ZG28R                            00226800
.ZG28Q        ANOP  ,                                                   00226900
&ZMS          SETC  '"RANGLIST='                                        00227000
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00227100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00227200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00227300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00227400
.ZG28R        ANOP  ,                                                   00227500
.*----------------------------------------------------------------***   00227600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00227700
              AIF   (N'&HSPALET LE 1).ZG31A     CK NUM                  00227800
&ZMS          SETC  '"HSPALET='                                         00227900
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00228000
&ZMS          SETC  '&ZMS "HSPALET"'                                    00228100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00228200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00228300
.ZG31A        ANOP  ,                                                   00228400
.*-------------------------------------------------------------------   00228500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00228600
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00228700
&XHSPALET     SETC  '0'                                                 00228800
              AIF   (K'&HSPALET(1) LE 0).ZG31B  PARM                    00228900
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00229000
              AIF   (N'&HSPALET GT 1).ZG31B     MULTI                   00229100
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00229200
.ZG31B        ANOP  ,                                                   00229300
.*-------------------------------------------------------------------   00229400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00229500
              AIF   (K'&ZXHSPALET LE 0).ZG31R   NOT I/O                 00229600
         AIF   ('&XHSPALET' EQ '0').ZG31R                               00229700
              AIF   ('&XHSPALET'(1,1) NE '(').ZG31R                     00229800
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00229900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                        00230000
              AIF   (K'&ZCGPR GT 2).ZG31Q                               00230100
              AIF   ('&ZCGPR' EQ '0').ZG31Q                             00230200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00230300
              AIF   (T'&ZCGPR NE 'N').ZG31Q     INVALID REG NAME        00230400
.ZG31P        ANOP  ,                                                   00230500
              AIF   (T'&ZCGPR NE 'N').ZG31R     NON NUMERIC             00230600
              AIF   ('&ZCGPR' LT '2').ZG31Q                             00230700
              AIF   ('&ZCGPR' LE '12').ZG31R                            00230800
.ZG31Q        ANOP  ,                                                   00230900
&ZMS          SETC  '"HSPALET='                                         00231000
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00231100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00231200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00231300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00231400
.ZG31R        ANOP  ,                                                   00231500
.*-------------------------------------------------------------------   00231600
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00231700
.ZG33ZY  AIF    ('&XSERVICE' NE 'CREAD').ZG57ZY                         00231800
.*-------------------------------------------------------------------   00231900
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00232000
&ZCVAL        SETC ''           ERROR KEY FIELD                         00232100
.ZG33I0       AIF   (K'&RELEASE LE 0).ZG33I1                            00232200
&ZCVAL        SETC '&ZCVAL RELEASE'             DISALLOWED KEY          00232300
.ZG33I1       AIF   (K'&KEEP LE 0).ZG33I2                               00232400
&ZCVAL        SETC '&ZCVAL KEEP'                DISALLOWED KEY          00232500
.ZG33I2       AIF   (K'&ZCVAL LE 0).ZG33J       KEY                     00232600
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00232700
&ZMS          SETC  '"CREAD'                                            00232800
&ZMS          SETC  '&ZMS."'                                            00232900
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00233000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00233100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00233200
.ZG33J        ANOP  ,                                                   00233300
.*----------------------------------------------------------------***   00233400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00233500
              AIF   (N'&STOKEN LE 1).ZG35A      CK NUM                  00233600
&ZMS          SETC  '"STOKEN='                                          00233700
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00233800
&ZMS          SETC  '&ZMS "STOKEN"'                                     00233900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00234000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00234100
.ZG35A        ANOP  ,                                                   00234200
.*-------------------------------------------------------------------   00234300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00234400
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00234500
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00234600
              AIF   (N'&STOKEN GT 1).ZG35B      MULTI                   00234700
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00234800
.ZG35B        AIF   (K'&STOKEN(1) GT 0).ZG35C                           00234900
&ZXSTOKEN     SETC  ''          RESET IN/OUTPUT                         00235000
&ZMS          SETC  ' '                                                 00235100
&ZMS          SETC  '&ZMS "STOKEN" KEY AND ITS'                         00235200
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00235300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00235400
.ZG35C        ANOP  ,                                                   00235500
.*-------------------------------------------------------------------   00235600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00235700
              AIF   (K'&ZXSTOKEN LE 0).ZG35R    NOT I/O                 00235800
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG35R                      00235900
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00236000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                        00236100
              AIF   (K'&ZCGPR GT 2).ZG35Q                               00236200
              AIF   ('&ZCGPR' EQ '0').ZG35Q                             00236300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00236400
              AIF   (T'&ZCGPR NE 'N').ZG35Q     INVALID REG NAME        00236500
.ZG35P        ANOP  ,                                                   00236600
              AIF   (T'&ZCGPR NE 'N').ZG35R     NON NUMERIC             00236700
              AIF   ('&ZCGPR' LT '2').ZG35Q                             00236800
              AIF   ('&ZCGPR' LE '12').ZG35R                            00236900
.ZG35Q        ANOP  ,                                                   00237000
&ZMS          SETC  '"STOKEN='                                          00237100
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00237200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00237300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00237400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00237500
.ZG35R        ANOP  ,                                                   00237600
.*----------------------------------------------------------------***   00237700
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00237800
              AIF   (N'&ADDRSP LE 1).ZG38A      CK NUM                  00237900
&ZMS          SETC  '"ADDRSP='                                          00238000
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00238100
&ZMS          SETC  '&ZMS "ADDRSP"'                                     00238200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00238300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00238400
.ZG38A        ANOP  ,                                                   00238500
.*-------------------------------------------------------------------   00238600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00238700
&XADDRSP      SETC  ''          INITIALIZE XVARIABLE                    00238800
.ZG39A   AIF   ('&ADDRSP(1)' NE 'HOME').ZG40A                           00238900
&XADDRSP      SETC  'HOME'      SET KEYWORD                             00239000
.*-------------------------------------------------------------------   00239100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00239200
.ZG40A   AIF   ('&ADDRSP(1)' NE 'PRIMARY').ZG41A                        00239300
&XADDRSP      SETC  'PRIMARY'   SET KEYWORD                             00239400
.*-------------------------------------------------------------------   00239500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00239600
.ZG41A   AIF   ('&ADDRSP(1)' NE 'COMMON').ZG42A                         00239700
&XADDRSP      SETC  'COMMON'    SET KEYWORD                             00239800
.*-------------------------------------------------------------------   00239900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00240000
.ZG42A        AIF   (K'&XADDRSP GT 0).ZG42C     KEYWORD                 00240100
              AIF   (K'&ADDRSP(1) LE 0).ZG42B                           00240200
&ZMS          SETC  '"ADDRSP='                                          00240300
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00240400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00240500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00240600
&ZMS          SETC  '&ZMS "HOME",'                                      00240700
&ZMS          SETC  '&ZMS "PRIMARY",'                                   00240800
&ZMS          SETC  '&ZMS OR "COMMON".'                                 00240900
              MNOTE 8,' &ZMS '                                          00241000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00241100
.ZG42B        ANOP  ,                                                   00241200
&XADDRSP      SETC  'HOME'      SET DEFAULT KEYWORD                     00241300
.ZG42C        ANOP  ,                                                   00241400
&ZXADDRSP     SETC  'INPUT'     SET IN/OUTPUT                           00241500
.*----------------------------------------------------------------***   00241600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00241700
              AIF   (N'&NUMRANGE LE 1).ZG44A    CK NUM                  00241800
&ZMS          SETC  '"NUMRANGE='                                        00241900
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00242000
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00242100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00242200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00242300
.ZG44A        ANOP  ,                                                   00242400
.*-------------------------------------------------------------------   00242500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00242600
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00242700
&XNUMRANGE    SETC  '1'                                                 00242800
              AIF   (K'&NUMRANGE(1) LE 0).ZG44B  PARM                   00242900
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00243000
              AIF   (N'&NUMRANGE GT 1).ZG44B    MULTI                   00243100
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00243200
.ZG44B        ANOP  ,                                                   00243300
.*-------------------------------------------------------------------   00243400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00243500
              AIF   (K'&ZXNUMRANGE LE 0).ZG44R  NOT I/O                 00243600
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZG44R                    00243700
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00243800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                        00243900
              AIF   (K'&ZCGPR GT 2).ZG44Q                               00244000
              AIF   ('&ZCGPR' EQ '0').ZG44Q                             00244100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00244200
              AIF   (T'&ZCGPR NE 'N').ZG44Q     INVALID REG NAME        00244300
.ZG44P        ANOP  ,                                                   00244400
              AIF   (T'&ZCGPR NE 'N').ZG44R     NON NUMERIC             00244500
              AIF   ('&ZCGPR' LT '2').ZG44Q                             00244600
              AIF   ('&ZCGPR' LE '12').ZG44R                            00244700
.ZG44Q        ANOP  ,                                                   00244800
&ZMS          SETC  '"NUMRANGE='                                        00244900
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00245000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00245100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00245200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00245300
.ZG44R        ANOP  ,                                                   00245400
.*----------------------------------------------------------------***   00245500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00245600
              AIF   (N'&RANGLIST LE 1).ZG47A    CK NUM                  00245700
&ZMS          SETC  '"RANGLIST='                                        00245800
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00245900
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00246000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00246100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00246200
.ZG47A        ANOP  ,                                                   00246300
.*-------------------------------------------------------------------   00246400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00246500
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00246600
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00246700
              AIF   (N'&RANGLIST GT 1).ZG47B    MULTI                   00246800
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00246900
.ZG47B        AIF   (K'&RANGLIST(1) GT 0).ZG47C                         00247000
&ZXRANGLIST   SETC  ''          RESET IN/OUTPUT                         00247100
&ZMS          SETC  ' '                                                 00247200
&ZMS          SETC  '&ZMS "RANGLIST" KEY AND ITS'                       00247300
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00247400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00247500
.ZG47C        ANOP  ,                                                   00247600
.*-------------------------------------------------------------------   00247700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00247800
              AIF   (K'&ZXRANGLIST LE 0).ZG47R  NOT I/O                 00247900
              AIF   ('&XRANGLIST'(1,1) NE '(').ZG47R                    00248000
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00248100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                        00248200
              AIF   (K'&ZCGPR GT 2).ZG47Q                               00248300
              AIF   ('&ZCGPR' EQ '0').ZG47Q                             00248400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00248500
              AIF   (T'&ZCGPR NE 'N').ZG47Q     INVALID REG NAME        00248600
.ZG47P        ANOP  ,                                                   00248700
              AIF   (T'&ZCGPR NE 'N').ZG47R     NON NUMERIC             00248800
              AIF   ('&ZCGPR' LT '2').ZG47Q                             00248900
              AIF   ('&ZCGPR' LE '12').ZG47R                            00249000
.ZG47Q        ANOP  ,                                                   00249100
&ZMS          SETC  '"RANGLIST='                                        00249200
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00249300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00249400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00249500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00249600
.ZG47R        ANOP  ,                                                   00249700
.*------------------------------------------------------------------    00249800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00249900
&XIOPATH      SETC  ''          INITIALIZE XVARIABLE                    00250000
.*-------------------------------------------------------------------   00250100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00250200
.ZG51         ANOP  ,                                                   00250300
              AIF   (K'&IOPATH(1) LE 0).ZG51A                           00250400
&ZTLC         SETC 'NO'                                                 00250500
              AIF   ('&IOPATH(1)' NE '&ZTLC').ZG55                      00250600
&XIOPATH      SETC  'NO'        SET KEYWORD                             00250700
              AIF   (N'&IOPATH LE 1).ZG51A      CK NUM                  00250800
&ZMS          SETC  '"IOPATH='                                          00250900
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00251000
&ZMS          SETC  '&ZMS "IOPATH"'                                     00251100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00251200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00251300
.ZG51A        ANOP  ,                                                   00251400
.*----------------------------------------------------------------***   00251500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00251600
              AIF   (N'&HSPALET LE 1).ZG53A     CK NUM                  00251700
&ZMS          SETC  '"HSPALET='                                         00251800
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00251900
&ZMS          SETC  '&ZMS "HSPALET"'                                    00252000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00252100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00252200
.ZG53A        ANOP  ,                                                   00252300
.*-------------------------------------------------------------------   00252400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00252500
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00252600
&XHSPALET     SETC  '0'                                                 00252700
              AIF   (K'&HSPALET(1) LE 0).ZG53B  PARM                    00252800
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00252900
              AIF   (N'&HSPALET GT 1).ZG53B     MULTI                   00253000
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00253100
.ZG53B        ANOP  ,                                                   00253200
.*-------------------------------------------------------------------   00253300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00253400
              AIF   (K'&ZXHSPALET LE 0).ZG53R   NOT I/O                 00253500
         AIF   ('&XHSPALET' EQ '0').ZG53R                               00253600
              AIF   ('&XHSPALET'(1,1) NE '(').ZG53R                     00253700
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00253800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG53P                        00253900
              AIF   (K'&ZCGPR GT 2).ZG53Q                               00254000
              AIF   ('&ZCGPR' EQ '0').ZG53Q                             00254100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00254200
              AIF   (T'&ZCGPR NE 'N').ZG53Q     INVALID REG NAME        00254300
.ZG53P        ANOP  ,                                                   00254400
              AIF   (T'&ZCGPR NE 'N').ZG53R     NON NUMERIC             00254500
              AIF   ('&ZCGPR' LT '2').ZG53Q                             00254600
              AIF   ('&ZCGPR' LE '12').ZG53R                            00254700
.ZG53Q        ANOP  ,                                                   00254800
&ZMS          SETC  '"HSPALET='                                         00254900
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00255000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00255100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00255200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00255300
.ZG53R        ANOP  ,                                                   00255400
.*-------------------------------------------------------------------   00255500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00255600
.ZG55         ANOP  ,                                                   00255700
&ZTLC         SETC 'YES'                                                00255800
              AIF   ('&IOPATH(1)' NE '&ZTLC').ZG56                      00255900
&XIOPATH      SETC  'YES'       SET KEYWORD                             00256000
              AIF   (N'&IOPATH LE 1).ZG55A      CK NUM                  00256100
&ZMS          SETC  '"IOPATH='                                          00256200
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00256300
&ZMS          SETC  '&ZMS "IOPATH"'                                     00256400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00256500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00256600
.ZG55A        ANOP  ,                                                   00256700
.*------------------------------------------------------------------    00256800
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00256900
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00257000
.ZG55A0       AIF   (K'&HSPALET LE 0).ZG55A1    OK                      00257100
&ZCVAL        SETC '&ZCVAL HSPALET'             INCORRECT KEY USED      00257200
.ZG55A1       AIF   (K'&ZCVAL LE 0).ZG55A2      OK                      00257300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00257400
&ZMS          SETC  '"IOPATH'                                           00257500
&ZMS          SETC  '&ZMS.=&IOPATH"'                                    00257600
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00257700
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00257800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00257900
.ZG55A2       ANOP  ,                                                   00258000
.*------------------------------------------------------------------    00258100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00258200
.ZG56         ANOP  ,                                                   00258300
&ZXIOPATH     SETC  'INPUT'     SET IN/OUTPUT                           00258400
              AIF   (K'&XIOPATH GT 0).ZG56E     VALID ARG               00258500
              AIF   (T'&IOPATH EQ 'O').ZG56D    OMITTED                 00258600
&ZASYSLNDX    SETA  0                                                   00258700
.ZG56A        ANOP  ,           POSITIONAL MACRO KEY                    00258800
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00258900
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG56C                    00259000
&ZTLC         SETC 'IOPATH'                                             00259100
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG56A           00259200
.ZG56B        ANOP  ,                                                   00259300
&ZXIOPATH     SETC  ''          RESET IN/OUTPUT                         00259400
&ZMS          SETC  'THE "IOPATH" KEY'                                  00259500
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00259600
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00259700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00259800
              AGO   .ZG56E                                              00259900
.ZG56C        ANOP  ,                                                   00260000
&ZXIOPATH     SETC  ''          RESET IN/OUTPUT                         00260100
&ZMS          SETC  '"IOPATH='                                          00260200
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00260300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00260400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00260500
&ZMS          SETC  '&ZMS "NO"'                                         00260600
&ZMS          SETC  '&ZMS OR "YES".'                                    00260700
              MNOTE 8,' &ZMS '                                          00260800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00260900
              AGO   .ZG56E                                              00261000
.ZG56D        ANOP  ,                                                   00261100
&XIOPATH      SETC  'NO'        SET DEFAULT KEYWORD                     00261200
.ZG56E        ANOP  ,                                                   00261300
.*-------------------------------------------------------------------   00261400
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00261500
.ZG57ZY  AIF    ('&XSERVICE' NE 'CWRITE').ZG86ZY                        00261600
.*-------------------------------------------------------------------   00261700
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               00261800
&ZCVAL        SETC ''           ERROR KEY FIELD                         00261900
.ZG57I0       AIF   (K'&RELEASE LE 0).ZG57I1                            00262000
&ZCVAL        SETC '&ZCVAL RELEASE'             DISALLOWED KEY          00262100
.ZG57I1       AIF   (K'&ZCVAL LE 0).ZG57J       KEY                     00262200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00262300
&ZMS          SETC  '"CWRITE'                                           00262400
&ZMS          SETC  '&ZMS."'                                            00262500
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00262600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00262700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00262800
.ZG57J        ANOP  ,                                                   00262900
.*----------------------------------------------------------------***   00263000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00263100
              AIF   (N'&STOKEN LE 1).ZG59A      CK NUM                  00263200
&ZMS          SETC  '"STOKEN='                                          00263300
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00263400
&ZMS          SETC  '&ZMS "STOKEN"'                                     00263500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00263600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00263700
.ZG59A        ANOP  ,                                                   00263800
.*-------------------------------------------------------------------   00263900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00264000
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00264100
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00264200
              AIF   (N'&STOKEN GT 1).ZG59B      MULTI                   00264300
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00264400
.ZG59B        AIF   (K'&STOKEN(1) GT 0).ZG59C                           00264500
&ZXSTOKEN     SETC  ''          RESET IN/OUTPUT                         00264600
&ZMS          SETC  ' '                                                 00264700
&ZMS          SETC  '&ZMS "STOKEN" KEY AND ITS'                         00264800
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00264900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00265000
.ZG59C        ANOP  ,                                                   00265100
.*-------------------------------------------------------------------   00265200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00265300
              AIF   (K'&ZXSTOKEN LE 0).ZG59R    NOT I/O                 00265400
              AIF   ('&XSTOKEN'(1,1) NE '(').ZG59R                      00265500
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00265600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG59P                        00265700
              AIF   (K'&ZCGPR GT 2).ZG59Q                               00265800
              AIF   ('&ZCGPR' EQ '0').ZG59Q                             00265900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00266000
              AIF   (T'&ZCGPR NE 'N').ZG59Q     INVALID REG NAME        00266100
.ZG59P        ANOP  ,                                                   00266200
              AIF   (T'&ZCGPR NE 'N').ZG59R     NON NUMERIC             00266300
              AIF   ('&ZCGPR' LT '2').ZG59Q                             00266400
              AIF   ('&ZCGPR' LE '12').ZG59R                            00266500
.ZG59Q        ANOP  ,                                                   00266600
&ZMS          SETC  '"STOKEN='                                          00266700
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00266800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00266900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00267000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00267100
.ZG59R        ANOP  ,                                                   00267200
.*----------------------------------------------------------------***   00267300
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00267400
              AIF   (N'&ADDRSP LE 1).ZG62A      CK NUM                  00267500
&ZMS          SETC  '"ADDRSP='                                          00267600
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00267700
&ZMS          SETC  '&ZMS "ADDRSP"'                                     00267800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00267900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00268000
.ZG62A        ANOP  ,                                                   00268100
.*-------------------------------------------------------------------   00268200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00268300
&XADDRSP      SETC  ''          INITIALIZE XVARIABLE                    00268400
.ZG63A   AIF   ('&ADDRSP(1)' NE 'HOME').ZG64A                           00268500
&XADDRSP      SETC  'HOME'      SET KEYWORD                             00268600
.*-------------------------------------------------------------------   00268700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00268800
.ZG64A   AIF   ('&ADDRSP(1)' NE 'PRIMARY').ZG65A                        00268900
&XADDRSP      SETC  'PRIMARY'   SET KEYWORD                             00269000
.*-------------------------------------------------------------------   00269100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00269200
.ZG65A   AIF   ('&ADDRSP(1)' NE 'COMMON').ZG66A                         00269300
&XADDRSP      SETC  'COMMON'    SET KEYWORD                             00269400
.*-------------------------------------------------------------------   00269500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00269600
.ZG66A        AIF   (K'&XADDRSP GT 0).ZG66C     KEYWORD                 00269700
              AIF   (K'&ADDRSP(1) LE 0).ZG66B                           00269800
&ZMS          SETC  '"ADDRSP='                                          00269900
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00270000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00270100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00270200
&ZMS          SETC  '&ZMS "HOME",'                                      00270300
&ZMS          SETC  '&ZMS "PRIMARY",'                                   00270400
&ZMS          SETC  '&ZMS OR "COMMON".'                                 00270500
              MNOTE 8,' &ZMS '                                          00270600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00270700
.ZG66B        ANOP  ,                                                   00270800
&XADDRSP      SETC  'HOME'      SET DEFAULT KEYWORD                     00270900
.ZG66C        ANOP  ,                                                   00271000
&ZXADDRSP     SETC  'INPUT'     SET IN/OUTPUT                           00271100
.*----------------------------------------------------------------***   00271200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00271300
              AIF   (N'&NUMRANGE LE 1).ZG68A    CK NUM                  00271400
&ZMS          SETC  '"NUMRANGE='                                        00271500
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00271600
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00271700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00271800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00271900
.ZG68A        ANOP  ,                                                   00272000
.*-------------------------------------------------------------------   00272100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00272200
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00272300
&XNUMRANGE    SETC  '1'                                                 00272400
              AIF   (K'&NUMRANGE(1) LE 0).ZG68B  PARM                   00272500
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00272600
              AIF   (N'&NUMRANGE GT 1).ZG68B    MULTI                   00272700
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00272800
.ZG68B        ANOP  ,                                                   00272900
.*-------------------------------------------------------------------   00273000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00273100
              AIF   (K'&ZXNUMRANGE LE 0).ZG68R  NOT I/O                 00273200
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZG68R                    00273300
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00273400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG68P                        00273500
              AIF   (K'&ZCGPR GT 2).ZG68Q                               00273600
              AIF   ('&ZCGPR' EQ '0').ZG68Q                             00273700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00273800
              AIF   (T'&ZCGPR NE 'N').ZG68Q     INVALID REG NAME        00273900
.ZG68P        ANOP  ,                                                   00274000
              AIF   (T'&ZCGPR NE 'N').ZG68R     NON NUMERIC             00274100
              AIF   ('&ZCGPR' LT '2').ZG68Q                             00274200
              AIF   ('&ZCGPR' LE '12').ZG68R                            00274300
.ZG68Q        ANOP  ,                                                   00274400
&ZMS          SETC  '"NUMRANGE='                                        00274500
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00274600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00274700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00274800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00274900
.ZG68R        ANOP  ,                                                   00275000
.*----------------------------------------------------------------***   00275100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00275200
              AIF   (N'&RANGLIST LE 1).ZG71A    CK NUM                  00275300
&ZMS          SETC  '"RANGLIST='                                        00275400
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00275500
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00275600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00275700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00275800
.ZG71A        ANOP  ,                                                   00275900
.*-------------------------------------------------------------------   00276000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00276100
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00276200
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00276300
              AIF   (N'&RANGLIST GT 1).ZG71B    MULTI                   00276400
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00276500
.ZG71B        AIF   (K'&RANGLIST(1) GT 0).ZG71C                         00276600
&ZXRANGLIST   SETC  ''          RESET IN/OUTPUT                         00276700
&ZMS          SETC  ' '                                                 00276800
&ZMS          SETC  '&ZMS "RANGLIST" KEY AND ITS'                       00276900
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00277000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00277100
.ZG71C        ANOP  ,                                                   00277200
.*-------------------------------------------------------------------   00277300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00277400
              AIF   (K'&ZXRANGLIST LE 0).ZG71R  NOT I/O                 00277500
              AIF   ('&XRANGLIST'(1,1) NE '(').ZG71R                    00277600
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00277700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG71P                        00277800
              AIF   (K'&ZCGPR GT 2).ZG71Q                               00277900
              AIF   ('&ZCGPR' EQ '0').ZG71Q                             00278000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00278100
              AIF   (T'&ZCGPR NE 'N').ZG71Q     INVALID REG NAME        00278200
.ZG71P        ANOP  ,                                                   00278300
              AIF   (T'&ZCGPR NE 'N').ZG71R     NON NUMERIC             00278400
              AIF   ('&ZCGPR' LT '2').ZG71Q                             00278500
              AIF   ('&ZCGPR' LE '12').ZG71R                            00278600
.ZG71Q        ANOP  ,                                                   00278700
&ZMS          SETC  '"RANGLIST='                                        00278800
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00278900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00279000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00279100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00279200
.ZG71R        ANOP  ,                                                   00279300
.*----------------------------------------------------------------***   00279400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00279500
              AIF   (N'&KEEP LE 1).ZG74A        CK NUM                  00279600
&ZMS          SETC  '"KEEP='                                            00279700
&ZMS          SETC  '&ZMS.&KEEP"'                                       00279800
&ZMS          SETC  '&ZMS "KEEP"'                                       00279900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00280000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00280100
.ZG74A        ANOP  ,                                                   00280200
.*-------------------------------------------------------------------   00280300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00280400
&XKEEP        SETC  ''          INITIALIZE XVARIABLE                    00280500
.ZG75A   AIF   ('&KEEP(1)' NE 'YES').ZG76A                              00280600
&XKEEP        SETC  'YES'       SET KEYWORD                             00280700
.*-------------------------------------------------------------------   00280800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00280900
.ZG76A   AIF   ('&KEEP(1)' NE 'NO').ZG77A                               00281000
&XKEEP        SETC  'NO'        SET KEYWORD                             00281100
.*-------------------------------------------------------------------   00281200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00281300
.ZG77A        AIF   (K'&XKEEP GT 0).ZG77C       KEYWORD                 00281400
              AIF   (K'&KEEP(1) LE 0).ZG77B                             00281500
&ZMS          SETC  '"KEEP='                                            00281600
&ZMS          SETC  '&ZMS.&KEEP"'                                       00281700
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00281800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00281900
&ZMS          SETC  '&ZMS "YES"'                                        00282000
&ZMS          SETC  '&ZMS OR "NO".'                                     00282100
              MNOTE 8,' &ZMS '                                          00282200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00282300
.ZG77B        ANOP  ,                                                   00282400
&XKEEP        SETC  'YES'       SET DEFAULT KEYWORD                     00282500
.ZG77C        ANOP  ,                                                   00282600
&ZXKEEP       SETC  'INPUT'     SET IN/OUTPUT                           00282700
.*------------------------------------------------------------------    00282800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00282900
&XIOPATH      SETC  ''          INITIALIZE XVARIABLE                    00283000
.*-------------------------------------------------------------------   00283100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00283200
.ZG80         ANOP  ,                                                   00283300
              AIF   (K'&IOPATH(1) LE 0).ZG80A                           00283400
&ZTLC         SETC 'NO'                                                 00283500
              AIF   ('&IOPATH(1)' NE '&ZTLC').ZG84                      00283600
&XIOPATH      SETC  'NO'        SET KEYWORD                             00283700
              AIF   (N'&IOPATH LE 1).ZG80A      CK NUM                  00283800
&ZMS          SETC  '"IOPATH='                                          00283900
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00284000
&ZMS          SETC  '&ZMS "IOPATH"'                                     00284100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00284200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00284300
.ZG80A        ANOP  ,                                                   00284400
.*----------------------------------------------------------------***   00284500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00284600
              AIF   (N'&HSPALET LE 1).ZG82A     CK NUM                  00284700
&ZMS          SETC  '"HSPALET='                                         00284800
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00284900
&ZMS          SETC  '&ZMS "HSPALET"'                                    00285000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00285100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00285200
.ZG82A        ANOP  ,                                                   00285300
.*-------------------------------------------------------------------   00285400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00285500
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00285600
&XHSPALET     SETC  '0'                                                 00285700
              AIF   (K'&HSPALET(1) LE 0).ZG82B  PARM                    00285800
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00285900
              AIF   (N'&HSPALET GT 1).ZG82B     MULTI                   00286000
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00286100
.ZG82B        ANOP  ,                                                   00286200
.*-------------------------------------------------------------------   00286300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00286400
              AIF   (K'&ZXHSPALET LE 0).ZG82R   NOT I/O                 00286500
         AIF   ('&XHSPALET' EQ '0').ZG82R                               00286600
              AIF   ('&XHSPALET'(1,1) NE '(').ZG82R                     00286700
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00286800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG82P                        00286900
              AIF   (K'&ZCGPR GT 2).ZG82Q                               00287000
              AIF   ('&ZCGPR' EQ '0').ZG82Q                             00287100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00287200
              AIF   (T'&ZCGPR NE 'N').ZG82Q     INVALID REG NAME        00287300
.ZG82P        ANOP  ,                                                   00287400
              AIF   (T'&ZCGPR NE 'N').ZG82R     NON NUMERIC             00287500
              AIF   ('&ZCGPR' LT '2').ZG82Q                             00287600
              AIF   ('&ZCGPR' LE '12').ZG82R                            00287700
.ZG82Q        ANOP  ,                                                   00287800
&ZMS          SETC  '"HSPALET='                                         00287900
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00288000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00288100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00288200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00288300
.ZG82R        ANOP  ,                                                   00288400
.*-------------------------------------------------------------------   00288500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00288600
.ZG84         ANOP  ,                                                   00288700
&ZTLC         SETC 'YES'                                                00288800
              AIF   ('&IOPATH(1)' NE '&ZTLC').ZG85                      00288900
&XIOPATH      SETC  'YES'       SET KEYWORD                             00289000
              AIF   (N'&IOPATH LE 1).ZG84A      CK NUM                  00289100
&ZMS          SETC  '"IOPATH='                                          00289200
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00289300
&ZMS          SETC  '&ZMS "IOPATH"'                                     00289400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00289500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00289600
.ZG84A        ANOP  ,                                                   00289700
.*------------------------------------------------------------------    00289800
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00289900
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00290000
.ZG84A0       AIF   (K'&HSPALET LE 0).ZG84A1    OK                      00290100
&ZCVAL        SETC '&ZCVAL HSPALET'             INCORRECT KEY USED      00290200
.ZG84A1       AIF   (K'&ZCVAL LE 0).ZG84A2      OK                      00290300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00290400
&ZMS          SETC  '"IOPATH'                                           00290500
&ZMS          SETC  '&ZMS.=&IOPATH"'                                    00290600
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00290700
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00290800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00290900
.ZG84A2       ANOP  ,                                                   00291000
.*------------------------------------------------------------------    00291100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00291200
.ZG85         ANOP  ,                                                   00291300
&ZXIOPATH     SETC  'INPUT'     SET IN/OUTPUT                           00291400
              AIF   (K'&XIOPATH GT 0).ZG85E     VALID ARG               00291500
              AIF   (T'&IOPATH EQ 'O').ZG85D    OMITTED                 00291600
&ZASYSLNDX    SETA  0                                                   00291700
.ZG85A        ANOP  ,           POSITIONAL MACRO KEY                    00291800
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00291900
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG85C                    00292000
&ZTLC         SETC 'IOPATH'                                             00292100
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG85A           00292200
.ZG85B        ANOP  ,                                                   00292300
&ZXIOPATH     SETC  ''          RESET IN/OUTPUT                         00292400
&ZMS          SETC  'THE "IOPATH" KEY'                                  00292500
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00292600
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00292700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00292800
              AGO   .ZG85E                                              00292900
.ZG85C        ANOP  ,                                                   00293000
&ZXIOPATH     SETC  ''          RESET IN/OUTPUT                         00293100
&ZMS          SETC  '"IOPATH='                                          00293200
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00293300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00293400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00293500
&ZMS          SETC  '&ZMS "NO"'                                         00293600
&ZMS          SETC  '&ZMS OR "YES".'                                    00293700
              MNOTE 8,' &ZMS '                                          00293800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00293900
              AGO   .ZG85E                                              00294000
.ZG85D        ANOP  ,                                                   00294100
&XIOPATH      SETC  'NO'        SET DEFAULT KEYWORD                     00294200
.ZG85E        ANOP  ,                                                   00294300
.*-------------------------------------------------------------------   00294400
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00294500
.ZG86ZY       ANOP ,            END MUTUALLY EXCLUSIVE KEYS             00294600
.*----------------------------------------------------------------***   00294700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00294800
              AIF   (N'&RETCODE LE 1).ZG88A     CK NUM                  00294900
&ZMS          SETC  '"RETCODE='                                         00295000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00295100
&ZMS          SETC  '&ZMS "RETCODE"'                                    00295200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00295300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00295400
.ZG88A        ANOP  ,                                                   00295500
.*-------------------------------------------------------------------   00295600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00295700
              AIF   (K'&RETCODE(1) LE 0).ZG88C  NO PARM                 00295800
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00295900
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00296000
              AIF   (N'&RETCODE GT 1).ZG88C                             00296100
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00296200
.ZG88C        ANOP  ,                                                   00296300
.*-------------------------------------------------------------------   00296400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00296500
              AIF   (K'&ZXRETCODE LE 0).ZG88R   NOT I/O                 00296600
              AIF   ('&XRETCODE'(1,1) NE '(').ZG88R                     00296700
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00296800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG88P                        00296900
              AIF   (K'&ZCGPR GT 2).ZG88Q                               00297000
              AIF   ('&ZCGPR' EQ '0').ZG88Q                             00297100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00297200
              AIF   (T'&ZCGPR NE 'N').ZG88Q     INVALID REG NAME        00297300
.ZG88P        ANOP  ,                                                   00297400
              AIF   (T'&ZCGPR NE 'N').ZG88R     NON NUMERIC             00297500
              AIF   ('&ZCGPR' EQ '15').ZG88R                            00297600
              AIF   ('&ZCGPR' LT '2').ZG88Q                             00297700
              AIF   ('&ZCGPR' LE '12').ZG88R                            00297800
.ZG88Q        ANOP  ,                                                   00297900
&ZMS          SETC  '"RETCODE='                                         00298000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00298100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00298200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'            00298300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00298400
.ZG88R        ANOP  ,                                                   00298500
.*----------------------------------------------------------------***   00298600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00298700
              AIF   (N'&RSNCODE LE 1).ZG91A     CK NUM                  00298800
&ZMS          SETC  '"RSNCODE='                                         00298900
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00299000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00299100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00299200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00299300
.ZG91A        ANOP  ,                                                   00299400
.*-------------------------------------------------------------------   00299500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00299600
              AIF   (K'&RSNCODE(1) LE 0).ZG91C  NO PARM                 00299700
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00299800
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00299900
              AIF   (N'&RSNCODE GT 1).ZG91C                             00300000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00300100
.ZG91C        ANOP  ,                                                   00300200
.*-------------------------------------------------------------------   00300300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00300400
              AIF   (K'&ZXRSNCODE LE 0).ZG91R   NOT I/O                 00300500
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG91R                     00300600
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00300700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG91P                        00300800
              AIF   (K'&ZCGPR GT 2).ZG91Q                               00300900
              AIF   ('&ZCGPR' EQ '0').ZG91R                             00301000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00301100
              AIF   (T'&ZCGPR NE 'N').ZG91Q     INVALID REG NAME        00301200
.ZG91P        ANOP  ,                                                   00301300
              AIF   (T'&ZCGPR NE 'N').ZG91R     NON NUMERIC             00301400
              AIF   ('&ZCGPR' EQ '0').ZG91R                             00301500
              AIF   ('&ZCGPR' LT '2').ZG91Q                             00301600
              AIF   ('&ZCGPR' LE '12').ZG91R                            00301700
.ZG91Q        ANOP  ,                                                   00301800
&ZMS          SETC  '"RSNCODE='                                         00301900
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00302000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00302100
              MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'             00302200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00302300
.ZG91R        ANOP  ,                                                   00302400
.******************************************************************     00302500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00302600
.******************************************************************     00302700
              ACTR  10000                                               00302800
.*-------------------------------------------------------------------   00302900
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00303000
&ZCVAL        SETC  ''          ERROR FIELD                             00303100
&ZAWRK        SETA  0           POSITIONAL COUNTER                      00303200
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       00303300
.ZGLIST2      ANOP  ,                                                   00303400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          00303500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00303600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00303700
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00303800
              AIF   (&ZAWRK LE 0).ZGLIST2                               00303900
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 00304000
              AGO   .ZGLIST2                                            00304100
.*                                                                      00304200
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00304300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00304400
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00304500
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00304600
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00304700
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00304800
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00304900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00305000
.ZGLISTX      ANOP  ,                                                   00305100
&ZASYSLNDX    SETA  0                                                   00305200
.*-------------------------------------------------------------------   00305300
.***AG.MF04 MF=(SLME)                                                   00305400
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00305500
.********************************************************************   00305600
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00305700
.********************************************************************   00305800
              ACTR  10000                                               00305900
.*-------------------------------------------------------------------   00306000
.***AE.MF01 MF=(SLME)                                                   00306100
              AIF   ('&XMF' EQ 'L').ZEMFX                               00306200
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00306300
.********************************************************************   00306400
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00306500
.********************************************************************   00306600
&XRELEASE     SETC  ''          INITIALIZE XVARIABLE                    00306700
&XADDRSP      SETC  ''          INITIALIZE XVARIABLE                    00306800
&XIOPATH      SETC  ''          INITIALIZE XVARIABLE                    00306900
&XKEEP        SETC  ''          INITIALIZE XVARIABLE                    00307000
.*-------------------------------------------------------------------   00307100
.***AE.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00307200
&XSERVICE     SETC  ''          INITIALIZE XVARIABLE                    00307300
&ZASYSLNDX    SETA  0                                                   00307400
.ZE2A         ANOP  ,           POSITIONAL KEY SEARCH                   00307500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00307600
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE2B  DONE                    00307700
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE2A             00307800
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'SREAD').ZE2A                 00307900
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00308000
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00308100
&XSERVICE     SETC  'SREAD'     SET XVARIABLE                           00308200
&ZXSREAD      SETC  'INPUT'     SET IN/OUTPUT                           00308300
&XSREAD       SETC  'SREAD'     SET XVARIABLE                           00308400
.ZE2B         ANOP  ,                                                   00308500
.*-------------------------------------------------------------------   00308600
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00308700
&ZASYSLNDX    SETA  0                                                   00308800
.ZE20A        ANOP  ,           POSITIONAL KEY SEARCH                   00308900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00309000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE20C  DONE                   00309100
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE20A            00309200
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'SWRITE').ZE20A               00309300
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00309400
              AIF   (K'&XSERVICE LE 0).ZE20B    VALID                   00309500
&ZMS          SETC  '"SWRITE'                                           00309600
&ZMS          SETC  '&ZMS."'                                            00309700
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00309800
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00309900
              MNOTE 8,' &ZMS KEY.'                                      00310000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00310100
              AGO   .ZE20C                                              00310200
.*                                                                      00310300
.ZE20B        ANOP  ,                                                   00310400
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00310500
&XSERVICE     SETC  'SWRITE'    SET XVARIABLE                           00310600
&ZXSWRITE     SETC  'INPUT'     SET IN/OUTPUT                           00310700
&XSWRITE      SETC  'SWRITE'    SET XVARIABLE                           00310800
.ZE20C        ANOP  ,                                                   00310900
.*-------------------------------------------------------------------   00311000
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00311100
&ZASYSLNDX    SETA  0                                                   00311200
.ZE33A        ANOP  ,           POSITIONAL KEY SEARCH                   00311300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00311400
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE33C  DONE                   00311500
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE33A            00311600
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CREAD').ZE33A                00311700
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00311800
              AIF   (K'&XSERVICE LE 0).ZE33B    VALID                   00311900
&ZMS          SETC  '"CREAD'                                            00312000
&ZMS          SETC  '&ZMS."'                                            00312100
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00312200
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00312300
              MNOTE 8,' &ZMS KEY.'                                      00312400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00312500
              AGO   .ZE33C                                              00312600
.*                                                                      00312700
.ZE33B        ANOP  ,                                                   00312800
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00312900
&XSERVICE     SETC  'CREAD'     SET XVARIABLE                           00313000
&ZXCREAD      SETC  'INPUT'     SET IN/OUTPUT                           00313100
&XCREAD       SETC  'CREAD'     SET XVARIABLE                           00313200
.ZE33C        ANOP  ,                                                   00313300
.*-------------------------------------------------------------------   00313400
.***AE.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00313500
&ZASYSLNDX    SETA  0                                                   00313600
.ZE57A        ANOP  ,           POSITIONAL KEY SEARCH                   00313700
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00313800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZE57C  DONE                   00313900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZE57A            00314000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CWRITE').ZE57A               00314100
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00314200
              AIF   (K'&XSERVICE LE 0).ZE57B    VALID                   00314300
&ZMS          SETC  '"CWRITE'                                           00314400
&ZMS          SETC  '&ZMS."'                                            00314500
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00314600
&ZMS          SETC  '&ZMS "&XSERVICE"'                                  00314700
              MNOTE 8,' &ZMS KEY.'                                      00314800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00314900
              AGO   .ZE57C                                              00315000
.*                                                                      00315100
.ZE57B        ANOP  ,                                                   00315200
&ZXSERVICE    SETC  'INPUT'     SET IN/OUTPUT                           00315300
&XSERVICE     SETC  'CWRITE'    SET XVARIABLE                           00315400
&ZXCWRITE     SETC  'INPUT'     SET IN/OUTPUT                           00315500
&XCWRITE      SETC  'CWRITE'    SET XVARIABLE                           00315600
.ZE57C        ANOP  ,                                                   00315700
.*------------------------------------------------------------------    00315800
.***AE.KMEKY07 VALUE, RQD INPUT, ME KEYS -CHECK IF ENTERED              00315900
              AIF   (K'&XSERVICE GT 0).ZE86B                            00316000
&ZXSERVICE    SETC  ''          RESET IN/OUTPUT                         00316100
&XSERVICE     SETC  ''          SET NULL                                00316200
&ZXSREAD      SETC  ''          RESET OUTPUT                            00316300
&XSREAD       SETC  ''          SET NULL PARM                           00316400
.ZE86B        ANOP  ,                                                   00316500
.*-------------------------------------------------------------------   00316600
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00316700
.ZE2     AIF   ('&XSERVICE' NE 'SREAD').ZE20                            00316800
.*-------------------------------------------------------------------   00316900
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00317000
              AIF   (K'&ZXSREAD LE 0).ZE2R      NOT I/O                 00317100
              AIF   ('&XSREAD'(1,1) NE '(').ZE2R                        00317200
&ZCGPR        SETC  '&XSREAD'(2,K'&XSREAD-2)                            00317300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                         00317400
              AIF   (K'&ZCGPR GT 2).ZE2Q                                00317500
              AIF   ('&ZCGPR' EQ '0').ZE2Q                              00317600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00317700
              AIF   (T'&ZCGPR NE 'N').ZE2Q      INVALID REG NAME        00317800
.ZE2P         ANOP  ,                                                   00317900
              AIF   (T'&ZCGPR NE 'N').ZE2R      NON NUMERIC             00318000
              AIF   ('&ZCGPR' LT '2').ZE2Q                              00318100
              AIF   ('&ZCGPR' LE '12').ZE2R                             00318200
.ZE2Q         ANOP  ,                                                   00318300
&ZMS          SETC  '"SREAD='                                           00318400
&ZMS          SETC  '&ZMS.&SREAD"'                                      00318500
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00318600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00318700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00318800
.ZE2R         ANOP  ,                                                   00318900
.*----------------------------------------------------------------***   00319000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00319100
              AIF   (N'&STOKEN LE 1).ZE4A       CK NUM                  00319200
&ZMS          SETC  '"STOKEN='                                          00319300
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00319400
&ZMS          SETC  '&ZMS "STOKEN"'                                     00319500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00319600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00319700
.ZE4A         ANOP  ,                                                   00319800
.*-------------------------------------------------------------------   00319900
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00320000
              AIF   (K'&STOKEN(1) LE 0).ZE4B    NO PRM                  00320100
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00320200
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00320300
              AIF   (N'&STOKEN GT 1).ZE4B                               00320400
.*            ANOP                                                      00320500
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00320600
.ZE4B         ANOP  ,                                                   00320700
.*-------------------------------------------------------------------   00320800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00320900
              AIF   (K'&ZXSTOKEN LE 0).ZE4R     NOT I/O                 00321000
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE4R                       00321100
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00321200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE4P                         00321300
              AIF   (K'&ZCGPR GT 2).ZE4Q                                00321400
              AIF   ('&ZCGPR' EQ '0').ZE4Q                              00321500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00321600
              AIF   (T'&ZCGPR NE 'N').ZE4Q      INVALID REG NAME        00321700
.ZE4P         ANOP  ,                                                   00321800
              AIF   (T'&ZCGPR NE 'N').ZE4R      NON NUMERIC             00321900
              AIF   ('&ZCGPR' LT '2').ZE4Q                              00322000
              AIF   ('&ZCGPR' LE '12').ZE4R                             00322100
.ZE4Q         ANOP  ,                                                   00322200
&ZMS          SETC  '"STOKEN='                                          00322300
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00322400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00322500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00322600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00322700
.ZE4R         ANOP  ,                                                   00322800
.*----------------------------------------------------------------***   00322900
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00323000
              AIF   (N'&NUMRANGE LE 1).ZE7A     CK NUM                  00323100
&ZMS          SETC  '"NUMRANGE='                                        00323200
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00323300
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00323400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00323500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00323600
.ZE7A         ANOP  ,                                                   00323700
.*-------------------------------------------------------------------   00323800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00323900
              AIF   (K'&NUMRANGE(1) LE 0).ZE7B  NO PRM                  00324000
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00324100
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00324200
              AIF   (N'&NUMRANGE GT 1).ZE7B                             00324300
.*            ANOP                                                      00324400
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00324500
.ZE7B         ANOP  ,                                                   00324600
.*-------------------------------------------------------------------   00324700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00324800
              AIF   (K'&ZXNUMRANGE LE 0).ZE7R   NOT I/O                 00324900
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZE7R                     00325000
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00325100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE7P                         00325200
              AIF   (K'&ZCGPR GT 2).ZE7Q                                00325300
              AIF   ('&ZCGPR' EQ '0').ZE7Q                              00325400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00325500
              AIF   (T'&ZCGPR NE 'N').ZE7Q      INVALID REG NAME        00325600
.ZE7P         ANOP  ,                                                   00325700
              AIF   (T'&ZCGPR NE 'N').ZE7R      NON NUMERIC             00325800
              AIF   ('&ZCGPR' LT '2').ZE7Q                              00325900
              AIF   ('&ZCGPR' LE '12').ZE7R                             00326000
.ZE7Q         ANOP  ,                                                   00326100
&ZMS          SETC  '"NUMRANGE='                                        00326200
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00326300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00326400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00326500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00326600
.ZE7R         ANOP  ,                                                   00326700
.*----------------------------------------------------------------***   00326800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00326900
              AIF   (N'&RANGLIST LE 1).ZE10A    CK NUM                  00327000
&ZMS          SETC  '"RANGLIST='                                        00327100
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00327200
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00327300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00327400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00327500
.ZE10A        ANOP  ,                                                   00327600
.*-------------------------------------------------------------------   00327700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00327800
              AIF   (K'&RANGLIST(1) LE 0).ZE10B NO PRM                  00327900
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00328000
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00328100
              AIF   (N'&RANGLIST GT 1).ZE10B                            00328200
.*            ANOP                                                      00328300
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00328400
.ZE10B        ANOP  ,                                                   00328500
.*-------------------------------------------------------------------   00328600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00328700
              AIF   (K'&ZXRANGLIST LE 0).ZE10R  NOT I/O                 00328800
              AIF   ('&XRANGLIST'(1,1) NE '(').ZE10R                    00328900
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00329000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        00329100
              AIF   (K'&ZCGPR GT 2).ZE10Q                               00329200
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             00329300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00329400
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        00329500
.ZE10P        ANOP  ,                                                   00329600
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             00329700
              AIF   ('&ZCGPR' LT '2').ZE10Q                             00329800
              AIF   ('&ZCGPR' LE '12').ZE10R                            00329900
.ZE10Q        ANOP  ,                                                   00330000
&ZMS          SETC  '"RANGLIST='                                        00330100
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00330200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00330300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00330400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00330500
.ZE10R        ANOP  ,                                                   00330600
.*-------------------------------------------------------------------   00330700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00330800
&ZTLC         SETC 'NO'                                                 00330900
              AIF   ('&RELEASE(1)' NE '&ZTLC').ZE14A                    00331000
&XRELEASE     SETC  'NO'        SET KEYWORD                             00331100
              AIF   (N'&RELEASE LE 1).ZE14A     CK NUM                  00331200
&ZMS          SETC  '"RELEASE='                                         00331300
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00331400
&ZMS          SETC  '&ZMS "RELEASE"'                                    00331500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00331600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00331700
.ZE14A        ANOP  ,                                                   00331800
.*----------------------------------------------------------------***   00331900
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00332000
              AIF   (N'&HSPALET LE 1).ZE16A     CK NUM                  00332100
&ZMS          SETC  '"HSPALET='                                         00332200
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00332300
&ZMS          SETC  '&ZMS "HSPALET"'                                    00332400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00332500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00332600
.ZE16A        ANOP  ,                                                   00332700
.*-------------------------------------------------------------------   00332800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00332900
              AIF   (K'&HSPALET(1) LE 0).ZE16B  NO PRM                  00333000
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00333100
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00333200
              AIF   (N'&HSPALET GT 1).ZE16B                             00333300
.*            ANOP                                                      00333400
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00333500
.ZE16B        ANOP  ,                                                   00333600
.*-------------------------------------------------------------------   00333700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00333800
              AIF   (K'&ZXHSPALET LE 0).ZE16R   NOT I/O                 00333900
              AIF   ('&XHSPALET'(1,1) NE '(').ZE16R                     00334000
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00334100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE16P                        00334200
              AIF   (K'&ZCGPR GT 2).ZE16Q                               00334300
              AIF   ('&ZCGPR' EQ '0').ZE16Q                             00334400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00334500
              AIF   (T'&ZCGPR NE 'N').ZE16Q     INVALID REG NAME        00334600
.ZE16P        ANOP  ,                                                   00334700
              AIF   (T'&ZCGPR NE 'N').ZE16R     NON NUMERIC             00334800
              AIF   ('&ZCGPR' LT '2').ZE16Q                             00334900
              AIF   ('&ZCGPR' LE '12').ZE16R                            00335000
.ZE16Q        ANOP  ,                                                   00335100
&ZMS          SETC  '"HSPALET='                                         00335200
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00335300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00335400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00335500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00335600
.ZE16R        ANOP  ,                                                   00335700
.*-------------------------------------------------------------------   00335800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00335900
&ZTLC         SETC 'YES'                                                00336000
              AIF   ('&RELEASE(1)' NE '&ZTLC').ZE18A                    00336100
&XRELEASE     SETC  'YES'       SET KEYWORD                             00336200
              AIF   (N'&RELEASE LE 1).ZE18A     CK NUM                  00336300
&ZMS          SETC  '"RELEASE='                                         00336400
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00336500
&ZMS          SETC  '&ZMS "RELEASE"'                                    00336600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00336700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00336800
.ZE18A        ANOP  ,                                                   00336900
.*------------------------------------------------------------------    00337000
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00337100
.ZE19         AIF   (K'&XRELEASE GT 0).ZE19A                            00337200
              AIF   (K'&RELEASE(1) LE 0).ZE19B                          00337300
&ZMS          SETC  '"RELEASE='                                         00337400
&ZMS          SETC  '&ZMS.&RELEASE"'                                    00337500
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00337600
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00337700
&ZMS          SETC  '&ZMS "NO"'                                         00337800
&ZMS          SETC  '&ZMS OR "YES".'                                    00337900
              MNOTE 8,' &ZMS '                                          00338000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00338100
              AGO   .ZE19B                                              00338200
.*                                                                      00338300
.ZE19A        ANOP  ,                                                   00338400
&ZXRELEASE    SETC  'INPUT'     SET IN/OUTPUT                           00338500
.ZE19B        ANOP  ,                                                   00338600
.*-------------------------------------------------------------------   00338700
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00338800
.ZE20     AIF   ('&XSERVICE' NE 'SWRITE').ZE33                          00338900
.*-------------------------------------------------------------------   00339000
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00339100
              AIF   (K'&ZXSWRITE LE 0).ZE20R    NOT I/O                 00339200
              AIF   ('&XSWRITE'(1,1) NE '(').ZE20R                      00339300
&ZCGPR        SETC  '&XSWRITE'(2,K'&XSWRITE-2)                          00339400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE20P                        00339500
              AIF   (K'&ZCGPR GT 2).ZE20Q                               00339600
              AIF   ('&ZCGPR' EQ '0').ZE20Q                             00339700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00339800
              AIF   (T'&ZCGPR NE 'N').ZE20Q     INVALID REG NAME        00339900
.ZE20P        ANOP  ,                                                   00340000
              AIF   (T'&ZCGPR NE 'N').ZE20R     NON NUMERIC             00340100
              AIF   ('&ZCGPR' LT '2').ZE20Q                             00340200
              AIF   ('&ZCGPR' LE '12').ZE20R                            00340300
.ZE20Q        ANOP  ,                                                   00340400
&ZMS          SETC  '"SWRITE='                                          00340500
&ZMS          SETC  '&ZMS.&SWRITE"'                                     00340600
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00340700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00340800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00340900
.ZE20R        ANOP  ,                                                   00341000
.*----------------------------------------------------------------***   00341100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00341200
              AIF   (N'&STOKEN LE 1).ZE22A      CK NUM                  00341300
&ZMS          SETC  '"STOKEN='                                          00341400
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00341500
&ZMS          SETC  '&ZMS "STOKEN"'                                     00341600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00341700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00341800
.ZE22A        ANOP  ,                                                   00341900
.*-------------------------------------------------------------------   00342000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00342100
              AIF   (K'&STOKEN(1) LE 0).ZE22B   NO PRM                  00342200
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00342300
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00342400
              AIF   (N'&STOKEN GT 1).ZE22B                              00342500
.*            ANOP                                                      00342600
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00342700
.ZE22B        ANOP  ,                                                   00342800
.*-------------------------------------------------------------------   00342900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00343000
              AIF   (K'&ZXSTOKEN LE 0).ZE22R    NOT I/O                 00343100
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE22R                      00343200
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00343300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE22P                        00343400
              AIF   (K'&ZCGPR GT 2).ZE22Q                               00343500
              AIF   ('&ZCGPR' EQ '0').ZE22Q                             00343600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00343700
              AIF   (T'&ZCGPR NE 'N').ZE22Q     INVALID REG NAME        00343800
.ZE22P        ANOP  ,                                                   00343900
              AIF   (T'&ZCGPR NE 'N').ZE22R     NON NUMERIC             00344000
              AIF   ('&ZCGPR' LT '2').ZE22Q                             00344100
              AIF   ('&ZCGPR' LE '12').ZE22R                            00344200
.ZE22Q        ANOP  ,                                                   00344300
&ZMS          SETC  '"STOKEN='                                          00344400
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00344500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00344600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00344700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00344800
.ZE22R        ANOP  ,                                                   00344900
.*----------------------------------------------------------------***   00345000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00345100
              AIF   (N'&NUMRANGE LE 1).ZE25A    CK NUM                  00345200
&ZMS          SETC  '"NUMRANGE='                                        00345300
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00345400
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00345500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00345600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00345700
.ZE25A        ANOP  ,                                                   00345800
.*-------------------------------------------------------------------   00345900
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00346000
              AIF   (K'&NUMRANGE(1) LE 0).ZE25B NO PRM                  00346100
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00346200
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00346300
              AIF   (N'&NUMRANGE GT 1).ZE25B                            00346400
.*            ANOP                                                      00346500
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00346600
.ZE25B        ANOP  ,                                                   00346700
.*-------------------------------------------------------------------   00346800
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00346900
              AIF   (K'&ZXNUMRANGE LE 0).ZE25R  NOT I/O                 00347000
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZE25R                    00347100
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00347200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE25P                        00347300
              AIF   (K'&ZCGPR GT 2).ZE25Q                               00347400
              AIF   ('&ZCGPR' EQ '0').ZE25Q                             00347500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00347600
              AIF   (T'&ZCGPR NE 'N').ZE25Q     INVALID REG NAME        00347700
.ZE25P        ANOP  ,                                                   00347800
              AIF   (T'&ZCGPR NE 'N').ZE25R     NON NUMERIC             00347900
              AIF   ('&ZCGPR' LT '2').ZE25Q                             00348000
              AIF   ('&ZCGPR' LE '12').ZE25R                            00348100
.ZE25Q        ANOP  ,                                                   00348200
&ZMS          SETC  '"NUMRANGE='                                        00348300
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00348400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00348500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00348600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00348700
.ZE25R        ANOP  ,                                                   00348800
.*----------------------------------------------------------------***   00348900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00349000
              AIF   (N'&RANGLIST LE 1).ZE28A    CK NUM                  00349100
&ZMS          SETC  '"RANGLIST='                                        00349200
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00349300
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00349400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00349500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00349600
.ZE28A        ANOP  ,                                                   00349700
.*-------------------------------------------------------------------   00349800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00349900
              AIF   (K'&RANGLIST(1) LE 0).ZE28B NO PRM                  00350000
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00350100
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00350200
              AIF   (N'&RANGLIST GT 1).ZE28B                            00350300
.*            ANOP                                                      00350400
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00350500
.ZE28B        ANOP  ,                                                   00350600
.*-------------------------------------------------------------------   00350700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00350800
              AIF   (K'&ZXRANGLIST LE 0).ZE28R  NOT I/O                 00350900
              AIF   ('&XRANGLIST'(1,1) NE '(').ZE28R                    00351000
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00351100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE28P                        00351200
              AIF   (K'&ZCGPR GT 2).ZE28Q                               00351300
              AIF   ('&ZCGPR' EQ '0').ZE28Q                             00351400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00351500
              AIF   (T'&ZCGPR NE 'N').ZE28Q     INVALID REG NAME        00351600
.ZE28P        ANOP  ,                                                   00351700
              AIF   (T'&ZCGPR NE 'N').ZE28R     NON NUMERIC             00351800
              AIF   ('&ZCGPR' LT '2').ZE28Q                             00351900
              AIF   ('&ZCGPR' LE '12').ZE28R                            00352000
.ZE28Q        ANOP  ,                                                   00352100
&ZMS          SETC  '"RANGLIST='                                        00352200
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00352300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00352400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00352500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00352600
.ZE28R        ANOP  ,                                                   00352700
.*----------------------------------------------------------------***   00352800
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00352900
              AIF   (N'&HSPALET LE 1).ZE31A     CK NUM                  00353000
&ZMS          SETC  '"HSPALET='                                         00353100
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00353200
&ZMS          SETC  '&ZMS "HSPALET"'                                    00353300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00353400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00353500
.ZE31A        ANOP  ,                                                   00353600
.*-------------------------------------------------------------------   00353700
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00353800
              AIF   (K'&HSPALET(1) LE 0).ZE31B  NO PRM                  00353900
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00354000
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00354100
              AIF   (N'&HSPALET GT 1).ZE31B                             00354200
.*            ANOP                                                      00354300
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00354400
.ZE31B        ANOP  ,                                                   00354500
.*-------------------------------------------------------------------   00354600
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00354700
              AIF   (K'&ZXHSPALET LE 0).ZE31R   NOT I/O                 00354800
              AIF   ('&XHSPALET'(1,1) NE '(').ZE31R                     00354900
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00355000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE31P                        00355100
              AIF   (K'&ZCGPR GT 2).ZE31Q                               00355200
              AIF   ('&ZCGPR' EQ '0').ZE31Q                             00355300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00355400
              AIF   (T'&ZCGPR NE 'N').ZE31Q     INVALID REG NAME        00355500
.ZE31P        ANOP  ,                                                   00355600
              AIF   (T'&ZCGPR NE 'N').ZE31R     NON NUMERIC             00355700
              AIF   ('&ZCGPR' LT '2').ZE31Q                             00355800
              AIF   ('&ZCGPR' LE '12').ZE31R                            00355900
.ZE31Q        ANOP  ,                                                   00356000
&ZMS          SETC  '"HSPALET='                                         00356100
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00356200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00356300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00356400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00356500
.ZE31R        ANOP  ,                                                   00356600
.*-------------------------------------------------------------------   00356700
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00356800
.ZE33     AIF   ('&XSERVICE' NE 'CREAD').ZE57                           00356900
.*-------------------------------------------------------------------   00357000
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00357100
              AIF   (K'&ZXCREAD LE 0).ZE33R     NOT I/O                 00357200
              AIF   ('&XCREAD'(1,1) NE '(').ZE33R                       00357300
&ZCGPR        SETC  '&XCREAD'(2,K'&XCREAD-2)                            00357400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE33P                        00357500
              AIF   (K'&ZCGPR GT 2).ZE33Q                               00357600
              AIF   ('&ZCGPR' EQ '0').ZE33Q                             00357700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00357800
              AIF   (T'&ZCGPR NE 'N').ZE33Q     INVALID REG NAME        00357900
.ZE33P        ANOP  ,                                                   00358000
              AIF   (T'&ZCGPR NE 'N').ZE33R     NON NUMERIC             00358100
              AIF   ('&ZCGPR' LT '2').ZE33Q                             00358200
              AIF   ('&ZCGPR' LE '12').ZE33R                            00358300
.ZE33Q        ANOP  ,                                                   00358400
&ZMS          SETC  '"CREAD='                                           00358500
&ZMS          SETC  '&ZMS.&CREAD"'                                      00358600
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00358700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00358800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00358900
.ZE33R        ANOP  ,                                                   00359000
.*----------------------------------------------------------------***   00359100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00359200
              AIF   (N'&STOKEN LE 1).ZE35A      CK NUM                  00359300
&ZMS          SETC  '"STOKEN='                                          00359400
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00359500
&ZMS          SETC  '&ZMS "STOKEN"'                                     00359600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00359700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00359800
.ZE35A        ANOP  ,                                                   00359900
.*-------------------------------------------------------------------   00360000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00360100
              AIF   (K'&STOKEN(1) LE 0).ZE35B   NO PRM                  00360200
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00360300
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00360400
              AIF   (N'&STOKEN GT 1).ZE35B                              00360500
.*            ANOP                                                      00360600
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00360700
.ZE35B        ANOP  ,                                                   00360800
.*-------------------------------------------------------------------   00360900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00361000
              AIF   (K'&ZXSTOKEN LE 0).ZE35R    NOT I/O                 00361100
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE35R                      00361200
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00361300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE35P                        00361400
              AIF   (K'&ZCGPR GT 2).ZE35Q                               00361500
              AIF   ('&ZCGPR' EQ '0').ZE35Q                             00361600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00361700
              AIF   (T'&ZCGPR NE 'N').ZE35Q     INVALID REG NAME        00361800
.ZE35P        ANOP  ,                                                   00361900
              AIF   (T'&ZCGPR NE 'N').ZE35R     NON NUMERIC             00362000
              AIF   ('&ZCGPR' LT '2').ZE35Q                             00362100
              AIF   ('&ZCGPR' LE '12').ZE35R                            00362200
.ZE35Q        ANOP  ,                                                   00362300
&ZMS          SETC  '"STOKEN='                                          00362400
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00362500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00362600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00362700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00362800
.ZE35R        ANOP  ,                                                   00362900
.*----------------------------------------------------------------***   00363000
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00363100
              AIF   (N'&ADDRSP LE 1).ZE38A      CK NUM                  00363200
&ZMS          SETC  '"ADDRSP='                                          00363300
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00363400
&ZMS          SETC  '&ZMS "ADDRSP"'                                     00363500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00363600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00363700
.ZE38A        ANOP  ,                                                   00363800
.*-------------------------------------------------------------------   00363900
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00364000
.ZE39A   AIF   ('&ADDRSP(1)' NE 'HOME').ZE40A                           00364100
&XADDRSP      SETC  'HOME'      SET KEYWORD                             00364200
.*-------------------------------------------------------------------   00364300
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00364400
.ZE40A   AIF   ('&ADDRSP(1)' NE 'PRIMARY').ZE41A                        00364500
&XADDRSP      SETC  'PRIMARY'   SET KEYWORD                             00364600
.*-------------------------------------------------------------------   00364700
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00364800
.ZE41A   AIF   ('&ADDRSP(1)' NE 'COMMON').ZE42A                         00364900
&XADDRSP      SETC  'COMMON'    SET KEYWORD                             00365000
.*-------------------------------------------------------------------   00365100
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00365200
.ZE42A        AIF   (K'&XADDRSP GT 0).ZE42B                             00365300
              AIF   (K'&ADDRSP(1) LE 0).ZE42C                           00365400
&ZMS          SETC  '"ADDRSP='                                          00365500
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00365600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00365700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00365800
&ZMS          SETC  '&ZMS "HOME",'                                      00365900
&ZMS          SETC  '&ZMS "PRIMARY",'                                   00366000
&ZMS          SETC  '&ZMS OR "COMMON".'                                 00366100
              MNOTE 8,' &ZMS '                                          00366200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00366300
              AGO   .ZE42C                                              00366400
.*                                                                      00366500
.ZE42B        ANOP  ,                                                   00366600
&ZXADDRSP     SETC  'INPUT'     SET IN/OUTPUT                           00366700
.ZE42C        ANOP  ,                                                   00366800
.*----------------------------------------------------------------***   00366900
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00367000
              AIF   (N'&NUMRANGE LE 1).ZE44A    CK NUM                  00367100
&ZMS          SETC  '"NUMRANGE='                                        00367200
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00367300
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00367400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00367500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00367600
.ZE44A        ANOP  ,                                                   00367700
.*-------------------------------------------------------------------   00367800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00367900
              AIF   (K'&NUMRANGE(1) LE 0).ZE44B NO PRM                  00368000
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00368100
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00368200
              AIF   (N'&NUMRANGE GT 1).ZE44B                            00368300
.*            ANOP                                                      00368400
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00368500
.ZE44B        ANOP  ,                                                   00368600
.*-------------------------------------------------------------------   00368700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00368800
              AIF   (K'&ZXNUMRANGE LE 0).ZE44R  NOT I/O                 00368900
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZE44R                    00369000
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00369100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE44P                        00369200
              AIF   (K'&ZCGPR GT 2).ZE44Q                               00369300
              AIF   ('&ZCGPR' EQ '0').ZE44Q                             00369400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00369500
              AIF   (T'&ZCGPR NE 'N').ZE44Q     INVALID REG NAME        00369600
.ZE44P        ANOP  ,                                                   00369700
              AIF   (T'&ZCGPR NE 'N').ZE44R     NON NUMERIC             00369800
              AIF   ('&ZCGPR' LT '2').ZE44Q                             00369900
              AIF   ('&ZCGPR' LE '12').ZE44R                            00370000
.ZE44Q        ANOP  ,                                                   00370100
&ZMS          SETC  '"NUMRANGE='                                        00370200
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00370300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00370400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00370500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00370600
.ZE44R        ANOP  ,                                                   00370700
.*----------------------------------------------------------------***   00370800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00370900
              AIF   (N'&RANGLIST LE 1).ZE47A    CK NUM                  00371000
&ZMS          SETC  '"RANGLIST='                                        00371100
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00371200
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00371300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00371400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00371500
.ZE47A        ANOP  ,                                                   00371600
.*-------------------------------------------------------------------   00371700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00371800
              AIF   (K'&RANGLIST(1) LE 0).ZE47B NO PRM                  00371900
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00372000
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00372100
              AIF   (N'&RANGLIST GT 1).ZE47B                            00372200
.*            ANOP                                                      00372300
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00372400
.ZE47B        ANOP  ,                                                   00372500
.*-------------------------------------------------------------------   00372600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00372700
              AIF   (K'&ZXRANGLIST LE 0).ZE47R  NOT I/O                 00372800
              AIF   ('&XRANGLIST'(1,1) NE '(').ZE47R                    00372900
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00373000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE47P                        00373100
              AIF   (K'&ZCGPR GT 2).ZE47Q                               00373200
              AIF   ('&ZCGPR' EQ '0').ZE47Q                             00373300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00373400
              AIF   (T'&ZCGPR NE 'N').ZE47Q     INVALID REG NAME        00373500
.ZE47P        ANOP  ,                                                   00373600
              AIF   (T'&ZCGPR NE 'N').ZE47R     NON NUMERIC             00373700
              AIF   ('&ZCGPR' LT '2').ZE47Q                             00373800
              AIF   ('&ZCGPR' LE '12').ZE47R                            00373900
.ZE47Q        ANOP  ,                                                   00374000
&ZMS          SETC  '"RANGLIST='                                        00374100
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00374200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00374300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00374400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00374500
.ZE47R        ANOP  ,                                                   00374600
.*-------------------------------------------------------------------   00374700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00374800
&ZTLC         SETC 'NO'                                                 00374900
              AIF   ('&IOPATH(1)' NE '&ZTLC').ZE51A                     00375000
&XIOPATH      SETC  'NO'        SET KEYWORD                             00375100
              AIF   (N'&IOPATH LE 1).ZE51A      CK NUM                  00375200
&ZMS          SETC  '"IOPATH='                                          00375300
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00375400
&ZMS          SETC  '&ZMS "IOPATH"'                                     00375500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00375600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00375700
.ZE51A        ANOP  ,                                                   00375800
.*----------------------------------------------------------------***   00375900
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00376000
              AIF   (N'&HSPALET LE 1).ZE53A     CK NUM                  00376100
&ZMS          SETC  '"HSPALET='                                         00376200
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00376300
&ZMS          SETC  '&ZMS "HSPALET"'                                    00376400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00376500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00376600
.ZE53A        ANOP  ,                                                   00376700
.*-------------------------------------------------------------------   00376800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00376900
              AIF   (K'&HSPALET(1) LE 0).ZE53B  NO PRM                  00377000
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00377100
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00377200
              AIF   (N'&HSPALET GT 1).ZE53B                             00377300
.*            ANOP                                                      00377400
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00377500
.ZE53B        ANOP  ,                                                   00377600
.*-------------------------------------------------------------------   00377700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00377800
              AIF   (K'&ZXHSPALET LE 0).ZE53R   NOT I/O                 00377900
              AIF   ('&XHSPALET'(1,1) NE '(').ZE53R                     00378000
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00378100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE53P                        00378200
              AIF   (K'&ZCGPR GT 2).ZE53Q                               00378300
              AIF   ('&ZCGPR' EQ '0').ZE53Q                             00378400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00378500
              AIF   (T'&ZCGPR NE 'N').ZE53Q     INVALID REG NAME        00378600
.ZE53P        ANOP  ,                                                   00378700
              AIF   (T'&ZCGPR NE 'N').ZE53R     NON NUMERIC             00378800
              AIF   ('&ZCGPR' LT '2').ZE53Q                             00378900
              AIF   ('&ZCGPR' LE '12').ZE53R                            00379000
.ZE53Q        ANOP  ,                                                   00379100
&ZMS          SETC  '"HSPALET='                                         00379200
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00379300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00379400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00379500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00379600
.ZE53R        ANOP  ,                                                   00379700
.*-------------------------------------------------------------------   00379800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00379900
&ZTLC         SETC 'YES'                                                00380000
              AIF   ('&IOPATH(1)' NE '&ZTLC').ZE55A                     00380100
&XIOPATH      SETC  'YES'       SET KEYWORD                             00380200
              AIF   (N'&IOPATH LE 1).ZE55A      CK NUM                  00380300
&ZMS          SETC  '"IOPATH='                                          00380400
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00380500
&ZMS          SETC  '&ZMS "IOPATH"'                                     00380600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00380700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00380800
.ZE55A        ANOP  ,                                                   00380900
.*------------------------------------------------------------------    00381000
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00381100
.ZE56         AIF   (K'&XIOPATH GT 0).ZE56A                             00381200
              AIF   (K'&IOPATH(1) LE 0).ZE56B                           00381300
&ZMS          SETC  '"IOPATH='                                          00381400
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00381500
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00381600
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00381700
&ZMS          SETC  '&ZMS "NO"'                                         00381800
&ZMS          SETC  '&ZMS OR "YES".'                                    00381900
              MNOTE 8,' &ZMS '                                          00382000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00382100
              AGO   .ZE56B                                              00382200
.*                                                                      00382300
.ZE56A        ANOP  ,                                                   00382400
&ZXIOPATH     SETC  'INPUT'     SET IN/OUTPUT                           00382500
.ZE56B        ANOP  ,                                                   00382600
.*-------------------------------------------------------------------   00382700
.***AE.KMEKY08 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00382800
.ZE57     AIF   ('&XSERVICE' NE 'CWRITE').ZE86                          00382900
.*-------------------------------------------------------------------   00383000
.***AE.KCK02 VALUE, RQD INPUT, ME KEYS -GPR OUT OF RANGE                00383100
              AIF   (K'&ZXCWRITE LE 0).ZE57R    NOT I/O                 00383200
              AIF   ('&XCWRITE'(1,1) NE '(').ZE57R                      00383300
&ZCGPR        SETC  '&XCWRITE'(2,K'&XCWRITE-2)                          00383400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE57P                        00383500
              AIF   (K'&ZCGPR GT 2).ZE57Q                               00383600
              AIF   ('&ZCGPR' EQ '0').ZE57Q                             00383700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00383800
              AIF   (T'&ZCGPR NE 'N').ZE57Q     INVALID REG NAME        00383900
.ZE57P        ANOP  ,                                                   00384000
              AIF   (T'&ZCGPR NE 'N').ZE57R     NON NUMERIC             00384100
              AIF   ('&ZCGPR' LT '2').ZE57Q                             00384200
              AIF   ('&ZCGPR' LE '12').ZE57R                            00384300
.ZE57Q        ANOP  ,                                                   00384400
&ZMS          SETC  '"CWRITE='                                          00384500
&ZMS          SETC  '&ZMS.&CWRITE"'                                     00384600
&ZMS          SETC  '&ZMS ARGUMENT 0 MUST SPECIFY A REGISTER'           00384700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00384800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00384900
.ZE57R        ANOP  ,                                                   00385000
.*----------------------------------------------------------------***   00385100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00385200
              AIF   (N'&STOKEN LE 1).ZE59A      CK NUM                  00385300
&ZMS          SETC  '"STOKEN='                                          00385400
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00385500
&ZMS          SETC  '&ZMS "STOKEN"'                                     00385600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00385700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00385800
.ZE59A        ANOP  ,                                                   00385900
.*-------------------------------------------------------------------   00386000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00386100
              AIF   (K'&STOKEN(1) LE 0).ZE59B   NO PRM                  00386200
&ZXSTOKEN     SETC  'INPUT'     SET IN/OUTPUT                           00386300
&XSTOKEN      SETC  '&STOKEN(1)'                SET XVARIABLE           00386400
              AIF   (N'&STOKEN GT 1).ZE59B                              00386500
.*            ANOP                                                      00386600
&XSTOKEN      SETC  '&STOKEN'   SET XVARIABLE                           00386700
.ZE59B        ANOP  ,                                                   00386800
.*-------------------------------------------------------------------   00386900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00387000
              AIF   (K'&ZXSTOKEN LE 0).ZE59R    NOT I/O                 00387100
              AIF   ('&XSTOKEN'(1,1) NE '(').ZE59R                      00387200
&ZCGPR        SETC  '&XSTOKEN'(2,K'&XSTOKEN-2)                          00387300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE59P                        00387400
              AIF   (K'&ZCGPR GT 2).ZE59Q                               00387500
              AIF   ('&ZCGPR' EQ '0').ZE59Q                             00387600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00387700
              AIF   (T'&ZCGPR NE 'N').ZE59Q     INVALID REG NAME        00387800
.ZE59P        ANOP  ,                                                   00387900
              AIF   (T'&ZCGPR NE 'N').ZE59R     NON NUMERIC             00388000
              AIF   ('&ZCGPR' LT '2').ZE59Q                             00388100
              AIF   ('&ZCGPR' LE '12').ZE59R                            00388200
.ZE59Q        ANOP  ,                                                   00388300
&ZMS          SETC  '"STOKEN='                                          00388400
&ZMS          SETC  '&ZMS.&STOKEN"'                                     00388500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00388600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00388700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00388800
.ZE59R        ANOP  ,                                                   00388900
.*----------------------------------------------------------------***   00389000
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00389100
              AIF   (N'&ADDRSP LE 1).ZE62A      CK NUM                  00389200
&ZMS          SETC  '"ADDRSP='                                          00389300
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00389400
&ZMS          SETC  '&ZMS "ADDRSP"'                                     00389500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00389600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00389700
.ZE62A        ANOP  ,                                                   00389800
.*-------------------------------------------------------------------   00389900
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00390000
.ZE63A   AIF   ('&ADDRSP(1)' NE 'HOME').ZE64A                           00390100
&XADDRSP      SETC  'HOME'      SET KEYWORD                             00390200
.*-------------------------------------------------------------------   00390300
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00390400
.ZE64A   AIF   ('&ADDRSP(1)' NE 'PRIMARY').ZE65A                        00390500
&XADDRSP      SETC  'PRIMARY'   SET KEYWORD                             00390600
.*-------------------------------------------------------------------   00390700
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00390800
.ZE65A   AIF   ('&ADDRSP(1)' NE 'COMMON').ZE66A                         00390900
&XADDRSP      SETC  'COMMON'    SET KEYWORD                             00391000
.*-------------------------------------------------------------------   00391100
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00391200
.ZE66A        AIF   (K'&XADDRSP GT 0).ZE66B                             00391300
              AIF   (K'&ADDRSP(1) LE 0).ZE66C                           00391400
&ZMS          SETC  '"ADDRSP='                                          00391500
&ZMS          SETC  '&ZMS.&ADDRSP"'                                     00391600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00391700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00391800
&ZMS          SETC  '&ZMS "HOME",'                                      00391900
&ZMS          SETC  '&ZMS "PRIMARY",'                                   00392000
&ZMS          SETC  '&ZMS OR "COMMON".'                                 00392100
              MNOTE 8,' &ZMS '                                          00392200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00392300
              AGO   .ZE66C                                              00392400
.*                                                                      00392500
.ZE66B        ANOP  ,                                                   00392600
&ZXADDRSP     SETC  'INPUT'     SET IN/OUTPUT                           00392700
.ZE66C        ANOP  ,                                                   00392800
.*----------------------------------------------------------------***   00392900
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00393000
              AIF   (N'&NUMRANGE LE 1).ZE68A    CK NUM                  00393100
&ZMS          SETC  '"NUMRANGE='                                        00393200
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00393300
&ZMS          SETC  '&ZMS "NUMRANGE"'                                   00393400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00393500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00393600
.ZE68A        ANOP  ,                                                   00393700
.*-------------------------------------------------------------------   00393800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00393900
              AIF   (K'&NUMRANGE(1) LE 0).ZE68B NO PRM                  00394000
&ZXNUMRANGE   SETC  'INPUT'     SET IN/OUTPUT                           00394100
&XNUMRANGE    SETC  '&NUMRANGE(1)'              SET XVARIABLE           00394200
              AIF   (N'&NUMRANGE GT 1).ZE68B                            00394300
.*            ANOP                                                      00394400
&XNUMRANGE    SETC  '&NUMRANGE'                 SET XVARIABLE           00394500
.ZE68B        ANOP  ,                                                   00394600
.*-------------------------------------------------------------------   00394700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00394800
              AIF   (K'&ZXNUMRANGE LE 0).ZE68R  NOT I/O                 00394900
              AIF   ('&XNUMRANGE'(1,1) NE '(').ZE68R                    00395000
&ZCGPR        SETC  '&XNUMRANGE'(2,K'&XNUMRANGE-2)                      00395100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE68P                        00395200
              AIF   (K'&ZCGPR GT 2).ZE68Q                               00395300
              AIF   ('&ZCGPR' EQ '0').ZE68Q                             00395400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00395500
              AIF   (T'&ZCGPR NE 'N').ZE68Q     INVALID REG NAME        00395600
.ZE68P        ANOP  ,                                                   00395700
              AIF   (T'&ZCGPR NE 'N').ZE68R     NON NUMERIC             00395800
              AIF   ('&ZCGPR' LT '2').ZE68Q                             00395900
              AIF   ('&ZCGPR' LE '12').ZE68R                            00396000
.ZE68Q        ANOP  ,                                                   00396100
&ZMS          SETC  '"NUMRANGE='                                        00396200
&ZMS          SETC  '&ZMS.&NUMRANGE"'                                   00396300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00396400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00396500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00396600
.ZE68R        ANOP  ,                                                   00396700
.*----------------------------------------------------------------***   00396800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00396900
              AIF   (N'&RANGLIST LE 1).ZE71A    CK NUM                  00397000
&ZMS          SETC  '"RANGLIST='                                        00397100
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00397200
&ZMS          SETC  '&ZMS "RANGLIST"'                                   00397300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00397400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00397500
.ZE71A        ANOP  ,                                                   00397600
.*-------------------------------------------------------------------   00397700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00397800
              AIF   (K'&RANGLIST(1) LE 0).ZE71B NO PRM                  00397900
&ZXRANGLIST   SETC  'INPUT'     SET IN/OUTPUT                           00398000
&XRANGLIST    SETC  '&RANGLIST(1)'              SET XVARIABLE           00398100
              AIF   (N'&RANGLIST GT 1).ZE71B                            00398200
.*            ANOP                                                      00398300
&XRANGLIST    SETC  '&RANGLIST'                 SET XVARIABLE           00398400
.ZE71B        ANOP  ,                                                   00398500
.*-------------------------------------------------------------------   00398600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00398700
              AIF   (K'&ZXRANGLIST LE 0).ZE71R  NOT I/O                 00398800
              AIF   ('&XRANGLIST'(1,1) NE '(').ZE71R                    00398900
&ZCGPR        SETC  '&XRANGLIST'(2,K'&XRANGLIST-2)                      00399000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE71P                        00399100
              AIF   (K'&ZCGPR GT 2).ZE71Q                               00399200
              AIF   ('&ZCGPR' EQ '0').ZE71Q                             00399300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00399400
              AIF   (T'&ZCGPR NE 'N').ZE71Q     INVALID REG NAME        00399500
.ZE71P        ANOP  ,                                                   00399600
              AIF   (T'&ZCGPR NE 'N').ZE71R     NON NUMERIC             00399700
              AIF   ('&ZCGPR' LT '2').ZE71Q                             00399800
              AIF   ('&ZCGPR' LE '12').ZE71R                            00399900
.ZE71Q        ANOP  ,                                                   00400000
&ZMS          SETC  '"RANGLIST='                                        00400100
&ZMS          SETC  '&ZMS.&RANGLIST"'                                   00400200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00400300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00400400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00400500
.ZE71R        ANOP  ,                                                   00400600
.*----------------------------------------------------------------***   00400700
.***AE.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00400800
              AIF   (N'&KEEP LE 1).ZE74A        CK NUM                  00400900
&ZMS          SETC  '"KEEP='                                            00401000
&ZMS          SETC  '&ZMS.&KEEP"'                                       00401100
&ZMS          SETC  '&ZMS "KEEP"'                                       00401200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00401300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00401400
.ZE74A        ANOP  ,                                                   00401500
.*-------------------------------------------------------------------   00401600
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00401700
.ZE75A   AIF   ('&KEEP(1)' NE 'YES').ZE76A                              00401800
&XKEEP        SETC  'YES'       SET KEYWORD                             00401900
.*-------------------------------------------------------------------   00402000
.***AE.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00402100
.ZE76A   AIF   ('&KEEP(1)' NE 'NO').ZE77A                               00402200
&XKEEP        SETC  'NO'        SET KEYWORD                             00402300
.*-------------------------------------------------------------------   00402400
.***AE.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00402500
.ZE77A        AIF   (K'&XKEEP GT 0).ZE77B                               00402600
              AIF   (K'&KEEP(1) LE 0).ZE77C                             00402700
&ZMS          SETC  '"KEEP='                                            00402800
&ZMS          SETC  '&ZMS.&KEEP"'                                       00402900
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00403000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00403100
&ZMS          SETC  '&ZMS "YES"'                                        00403200
&ZMS          SETC  '&ZMS OR "NO".'                                     00403300
              MNOTE 8,' &ZMS '                                          00403400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00403500
              AGO   .ZE77C                                              00403600
.*                                                                      00403700
.ZE77B        ANOP  ,                                                   00403800
&ZXKEEP       SETC  'INPUT'     SET IN/OUTPUT                           00403900
.ZE77C        ANOP  ,                                                   00404000
.*-------------------------------------------------------------------   00404100
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00404200
&ZTLC         SETC 'NO'                                                 00404300
              AIF   ('&IOPATH(1)' NE '&ZTLC').ZE80A                     00404400
&XIOPATH      SETC  'NO'        SET KEYWORD                             00404500
              AIF   (N'&IOPATH LE 1).ZE80A      CK NUM                  00404600
&ZMS          SETC  '"IOPATH='                                          00404700
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00404800
&ZMS          SETC  '&ZMS "IOPATH"'                                     00404900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00405000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00405100
.ZE80A        ANOP  ,                                                   00405200
.*----------------------------------------------------------------***   00405300
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00405400
              AIF   (N'&HSPALET LE 1).ZE82A     CK NUM                  00405500
&ZMS          SETC  '"HSPALET='                                         00405600
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00405700
&ZMS          SETC  '&ZMS "HSPALET"'                                    00405800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00405900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00406000
.ZE82A        ANOP  ,                                                   00406100
.*-------------------------------------------------------------------   00406200
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00406300
              AIF   (K'&HSPALET(1) LE 0).ZE82B  NO PRM                  00406400
&ZXHSPALET    SETC  'INPUT'     SET IN/OUTPUT                           00406500
&XHSPALET     SETC  '&HSPALET(1)'               SET XVARIABLE           00406600
              AIF   (N'&HSPALET GT 1).ZE82B                             00406700
.*            ANOP                                                      00406800
&XHSPALET     SETC  '&HSPALET'  SET XVARIABLE                           00406900
.ZE82B        ANOP  ,                                                   00407000
.*-------------------------------------------------------------------   00407100
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00407200
              AIF   (K'&ZXHSPALET LE 0).ZE82R   NOT I/O                 00407300
              AIF   ('&XHSPALET'(1,1) NE '(').ZE82R                     00407400
&ZCGPR        SETC  '&XHSPALET'(2,K'&XHSPALET-2)                        00407500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE82P                        00407600
              AIF   (K'&ZCGPR GT 2).ZE82Q                               00407700
              AIF   ('&ZCGPR' EQ '0').ZE82Q                             00407800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00407900
              AIF   (T'&ZCGPR NE 'N').ZE82Q     INVALID REG NAME        00408000
.ZE82P        ANOP  ,                                                   00408100
              AIF   (T'&ZCGPR NE 'N').ZE82R     NON NUMERIC             00408200
              AIF   ('&ZCGPR' LT '2').ZE82Q                             00408300
              AIF   ('&ZCGPR' LE '12').ZE82R                            00408400
.ZE82Q        ANOP  ,                                                   00408500
&ZMS          SETC  '"HSPALET='                                         00408600
&ZMS          SETC  '&ZMS.&HSPALET"'                                    00408700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00408800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00408900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00409000
.ZE82R        ANOP  ,                                                   00409100
.*-------------------------------------------------------------------   00409200
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00409300
&ZTLC         SETC 'YES'                                                00409400
              AIF   ('&IOPATH(1)' NE '&ZTLC').ZE84A                     00409500
&XIOPATH      SETC  'YES'       SET KEYWORD                             00409600
              AIF   (N'&IOPATH LE 1).ZE84A      CK NUM                  00409700
&ZMS          SETC  '"IOPATH='                                          00409800
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00409900
&ZMS          SETC  '&ZMS "IOPATH"'                                     00410000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00410100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00410200
.ZE84A        ANOP  ,                                                   00410300
.*------------------------------------------------------------------    00410400
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00410500
.ZE85         AIF   (K'&XIOPATH GT 0).ZE85A                             00410600
              AIF   (K'&IOPATH(1) LE 0).ZE85B                           00410700
&ZMS          SETC  '"IOPATH='                                          00410800
&ZMS          SETC  '&ZMS.&IOPATH"'                                     00410900
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00411000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00411100
&ZMS          SETC  '&ZMS "NO"'                                         00411200
&ZMS          SETC  '&ZMS OR "YES".'                                    00411300
              MNOTE 8,' &ZMS '                                          00411400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00411500
              AGO   .ZE85B                                              00411600
.*                                                                      00411700
.ZE85A        ANOP  ,                                                   00411800
&ZXIOPATH     SETC  'INPUT'     SET IN/OUTPUT                           00411900
.ZE85B        ANOP  ,                                                   00412000
.*-------------------------------------------------------------------   00412100
.***AE.KMEKY09 VALUE, RQD INPUT, ME KEYS -END                           00412200
.ZE86         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00412300
.*----------------------------------------------------------------***   00412400
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00412500
              AIF   (N'&RETCODE LE 1).ZE88A     CK NUM                  00412600
&ZMS          SETC  '"RETCODE='                                         00412700
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00412800
&ZMS          SETC  '&ZMS "RETCODE"'                                    00412900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00413000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00413100
.ZE88A        ANOP  ,                                                   00413200
.*-------------------------------------------------------------------   00413300
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00413400
              AIF   (K'&RETCODE(1) LE 0).ZE88B  NO PRM                  00413500
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00413600
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00413700
              AIF   (N'&RETCODE GT 1).ZE88B                             00413800
.*            ANOP                                                      00413900
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00414000
.ZE88B        ANOP  ,                                                   00414100
.*-------------------------------------------------------------------   00414200
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00414300
              AIF   (K'&ZXRETCODE LE 0).ZE88R   NOT I/O                 00414400
              AIF   ('&XRETCODE'(1,1) NE '(').ZE88R                     00414500
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00414600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE88P                        00414700
              AIF   (K'&ZCGPR GT 2).ZE88Q                               00414800
              AIF   ('&ZCGPR' EQ '0').ZE88Q                             00414900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00415000
              AIF   (T'&ZCGPR NE 'N').ZE88Q     INVALID REG NAME        00415100
.ZE88P        ANOP  ,                                                   00415200
              AIF   (T'&ZCGPR NE 'N').ZE88R     NON NUMERIC             00415300
              AIF   ('&ZCGPR' LT '2').ZE88Q                             00415400
              AIF   ('&ZCGPR' LE '12').ZE88R                            00415500
.ZE88Q        ANOP  ,                                                   00415600
&ZMS          SETC  '"RETCODE='                                         00415700
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00415800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00415900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00416000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00416100
.ZE88R        ANOP  ,                                                   00416200
.*----------------------------------------------------------------***   00416300
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00416400
              AIF   (N'&RSNCODE LE 1).ZE91A     CK NUM                  00416500
&ZMS          SETC  '"RSNCODE='                                         00416600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00416700
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00416800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00416900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00417000
.ZE91A        ANOP  ,                                                   00417100
.*-------------------------------------------------------------------   00417200
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00417300
              AIF   (K'&RSNCODE(1) LE 0).ZE91B  NO PRM                  00417400
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00417500
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00417600
              AIF   (N'&RSNCODE GT 1).ZE91B                             00417700
.*            ANOP                                                      00417800
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00417900
.ZE91B        ANOP  ,                                                   00418000
.*-------------------------------------------------------------------   00418100
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00418200
              AIF   (K'&ZXRSNCODE LE 0).ZE91R   NOT I/O                 00418300
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE91R                     00418400
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00418500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE91P                        00418600
              AIF   (K'&ZCGPR GT 2).ZE91Q                               00418700
              AIF   ('&ZCGPR' EQ '0').ZE91Q                             00418800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00418900
              AIF   (T'&ZCGPR NE 'N').ZE91Q     INVALID REG NAME        00419000
.ZE91P        ANOP  ,                                                   00419100
              AIF   (T'&ZCGPR NE 'N').ZE91R     NON NUMERIC             00419200
              AIF   ('&ZCGPR' LT '2').ZE91Q                             00419300
              AIF   ('&ZCGPR' LE '12').ZE91R                            00419400
.ZE91Q        ANOP  ,                                                   00419500
&ZMS          SETC  '"RSNCODE='                                         00419600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00419700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00419800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00419900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00420000
.ZE91R        ANOP  ,                                                   00420100
.******************************************************************     00420200
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00420300
.******************************************************************     00420400
              ACTR  10000                                               00420500
.*-------------------------------------------------------------------   00420600
.***AF.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00420700
&ZCVAL        SETC  ''          ERROR FIELD                             00420800
&ZAWRK        SETA  0           POSITIONAL COUNTER                      00420900
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       00421000
.ZELIST2      ANOP  ,                                                   00421100
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          00421200
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZELIST3  DONE                 00421300
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZELIST2          00421400
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00421500
              AIF   (&ZAWRK LE 0).ZELIST2                               00421600
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 00421700
              AGO   .ZELIST2                                            00421800
.*                                                                      00421900
.ZELIST3  AIF  (K'&ZCVAL LE 0).ZELISTX                                  00422000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00422100
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00422200
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00422300
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00422400
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00422500
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00422600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00422700
.ZELISTX      ANOP  ,                                                   00422800
&ZASYSLNDX    SETA  0                                                   00422900
.*-------------------------------------------------------------------   00423000
.***AE.MF02 MF=(SLME)                                                   00423100
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00423200
.*******************************************************************    00423300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00423400
.*******************************************************************    00423500
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00423600
.*******************************************************************    00423700
.***AE.01  START OF HSPSERV MACRO CODE                                  00423800
.*******************************************************************    00423900
              LCLC  &M0M0001                 NAME                       00424000
&M0M0001      SETC  '&XLABEL'                SET NAME                   00424100
              AIF   (K'&XLABEL NE 0).XLAB2                              00424200
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00424300
.*                                                                      00424400
.XLAB2        ANOP  ,                                                   00424500
              AIF   ('&XMF' EQ 'L').XLAB3                               00424600
&M0M0001 DS    0H                             HSPSERV-1                 00424700
.XLAB3        ANOP  ,                                                   00424800
.*******************************************************************    00424900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00425000
.*******************************************************************    00425100
              PUSH  PRINT                                               00425200
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00425300
              PRINT OFF         ++ PR01                                 00425400
              AGO   .ZPRNTXX                                            00425500
.ZPRINTX      PRINT ON                                                  00425600
.ZPRNTXX      ANOP  ,                                                   00425700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00425800
.********************************************************************** 00425900
.*                                                                      00426000
.*  Issue message if IOPATH=YES was specified                      @P4A 00426100
.*                                                                      00426200
.********************************************************************** 00426300
         AIF   ('&IOPATH' EQ '' OR '&IOPATH' EQ 'NO').SKIPIOM      @P4A 00426400
&ZMS     SETC  'IOPATH=YES IS AN INTERNAL ONLY SPECIFICATION'      @P4A 00426500
&ZMS     SETC  '&ZMS AND IS NOT ALLOWED IN THIS INVOCATION. '      @P4A 00426600
         MNOTE 8,' &ZMS '                                          @P4A 00426700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE        @P4A 00426800
.SKIPIOM ANOP  ,                                                   @P4A 00426900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00427000
.********************************************************************   00427100
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00427200
.********************************************************************   00427300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00427400
                      LCLA  &ZOPN1         INVOCATION INDEX             00427500
                      LCLC  &ZOPL(4095)    LABEL                        00427600
                      LCLC  &ZOPO(4095)    OPERATION                    00427700
                      LCLC  &ZOPV(4095)    VALUE                        00427800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00427900
.*                                                                      00428000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00428100
.******************************************************************     00428200
.***AL.L10 HSPSERV FMT=LIST MF=S!L PARAMETERS                           00428300
.******************************************************************     00428400
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00428500
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00428600
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00428700
&XMFATTR              SETC  '0D'                                        00428800
.*                                                                      00428900
&ZOPN                 SETA  &ZOPN+1                                     00429000
&ZOPL(&ZOPN)          SETC  ' '                                         00429100
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00429200
&ZOPO(&ZOPN)          SETC  'B'                                         00429300
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00429400
                      AGO   .ZALVL6B                                    00429500
.ZALVL6A              ANOP                                              00429600
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00429700
&ZOPV(&ZOPN)          SETC  '4,8'                                       00429800
&ZOPN                 SETA  &ZOPN+1                                     00429900
&ZOPL(&ZOPN)          SETC  ' '                                         00430000
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00430100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00430200
.ZALVL6B              ANOP                                              00430300
&ZOPD(&ZOPN)          SETC  '++ HSPSERV ARG PARMS'                      00430400
.*                                                                      00430500
&ZOPN                 SETA  &ZOPN+1                                     00430600
&ZOPL(&ZOPN)          SETC  ' '                                         00430700
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00430800
&ZOPV(&ZOPN)          SETC  '1'                                         00430900
&ZOPD(&ZOPN)          SETC  ' '                                         00431000
.*                                                                      00431100
.ZLMFSL2              ANOP  ,                                           00431200
.*-------------------------------------------------------------------   00431300
.***AM.L00  HSPSERV FMT=LIST name                                       00431400
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00431500
&ZOPN                 SETA &ZOPN+1                                      00431600
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00431700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00431800
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00431900
&ZOPD(&ZOPN)          SETC '++ HSPSERV NAME'                            00432000
.ZLMFSL2M             ANOP  ,                                           00432100
.*-------------------------------------------------------------------   00432200
.***AM.L01  HSPSERV FMT=LIST PARAMETERS                                 00432300
&ZOPN                 SETA &ZOPN+1                                      00432400
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00432500
&ZOPO(&ZOPN)          SETC 'DS'                                         00432600
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00432700
&ZOPD(&ZOPN)          SETC '++ HSPSERV PARM LIST'                       00432800
.*-------------------------------------------------------------------   00432900
.***AM.L02 XVERSION XL1                                                 00433000
&ZOPN                 SETA &ZOPN+1                                      00433100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00433200
&ZOPO(&ZOPN)          SETC 'DS'                                         00433300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00433400
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00433500
.*-------------------------------------------------------------------   00433600
.***AM.L05 XSERVICE XL1                                                 00433700
&ZOPN                 SETA &ZOPN+1                                      00433800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVICE'                         00433900
&ZOPO(&ZOPN)          SETC 'DS'                                         00434000
&ZOPV(&ZOPN)          SETC 'XL1'                                        00434100
&ZOPD(&ZOPN)          SETC '++ &ZXSERVICE XSERVICE'                     00434200
.*                                                                      00434300
&ZOPN                 SETA  &ZOPN+1                                     00434400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._SREAD'                           00434500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00434600
&ZOPV(&ZOPN)          SETC  '1'                                         00434700
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00434800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SREAD'                        00434900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00435000
.*                                                                      00435100
&ZOPN                 SETA  &ZOPN+1                                     00435200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._SWRITE'                          00435300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00435400
&ZOPV(&ZOPN)          SETC  '2'                                         00435500
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00435600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SWRITE'                       00435700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00435800
.*                                                                      00435900
&ZOPN                 SETA  &ZOPN+1                                     00436000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._CREAD'                           00436100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00436200
&ZOPV(&ZOPN)          SETC  '3'                                         00436300
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00436400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CREAD'                        00436500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00436600
.*                                                                      00436700
&ZOPN                 SETA  &ZOPN+1                                     00436800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._CWRITE'                          00436900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00437000
&ZOPV(&ZOPN)          SETC  '4'                                         00437100
&ZOPD(&ZOPN)          SETC  '++ XSERVICE.'                              00437200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CWRITE'                       00437300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00437400
.*-------------------------------------------------------------------   00437500
.***AM.L09  XRVS00001 BL.16                                             00437600
&ZOPN                 SETA &ZOPN+1                                      00437700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRVS00001'                        00437800
&ZOPO(&ZOPN)          SETC 'DS'                                         00437900
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00438000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00438100
.*-------------------------------------------------------------------   00438200
.***AM.L03 XFLAGS1 BL.8                                                 00438300
&ZOPN                 SETA &ZOPN+1                                      00438400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS1'                          00438500
&ZOPO(&ZOPN)          SETC 'DS'                                         00438600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00438700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00438800
.*                                                                      00438900
&ZOPN                 SETA  &ZOPN+1                                     00439000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XRELEASE_YES'                    00439100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00439200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00439300
&ZOPD(&ZOPN)          SETC  '++ XRELEASE.'                              00439400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00439500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00439600
.*                                                                      00439700
&ZOPN                 SETA  &ZOPN+1                                     00439800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XIOPATH_YES'                     00439900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00440000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00440100
&ZOPD(&ZOPN)          SETC  '++ XIOPATH.'                               00440200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00440300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00440400
.*                                                                      00440500
&ZOPN                 SETA  &ZOPN+1                                     00440600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRSP_HOME'                    00440700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00440800
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00440900
&ZOPD(&ZOPN)          SETC  '++ XADDRSP.'                               00441000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).HOME'                         00441100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00441200
.*                                                                      00441300
&ZOPN                 SETA  &ZOPN+1                                     00441400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRSP_PRIMARY'                 00441500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00441600
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00441700
&ZOPD(&ZOPN)          SETC  '++ XADDRSP.'                               00441800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PRIMARY'                      00441900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00442000
.*                                                                      00442100
&ZOPN                 SETA  &ZOPN+1                                     00442200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XADDRSP_COMMON'                  00442300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00442400
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00442500
&ZOPD(&ZOPN)          SETC  '++ XADDRSP.'                               00442600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COMMON'                       00442700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00442800
.*                                                                      00442900
&ZOPN                 SETA  &ZOPN+1                                     00443000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XKEEP_YES'                       00443100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00443200
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00443300
&ZOPD(&ZOPN)          SETC  '++ XKEEP.'                                 00443400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00443500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00443600
.*-------------------------------------------------------------------   00443700
.***AM.L09  XRVS00002 BL.8                                              00443800
&ZOPN                 SETA &ZOPN+1                                      00443900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRVS00002'                        00444000
&ZOPO(&ZOPN)          SETC 'DS'                                         00444100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00444200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00444300
.*-------------------------------------------------------------------   00444400
.***AM.L09  XRVS00003 BL.16                                             00444500
&ZOPN                 SETA &ZOPN+1                                      00444600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRVS00003'                        00444700
&ZOPO(&ZOPN)          SETC 'DS'                                         00444800
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00444900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00445000
.*-------------------------------------------------------------------   00445100
.***AM.L09  XSTOKEN CL8                                                 00445200
&ZOPN                 SETA &ZOPN+1                                      00445300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTOKEN'                          00445400
&ZOPO(&ZOPN)          SETC 'DS'                                         00445500
&ZOPV(&ZOPN)          SETC 'CL8'                                        00445600
&ZOPD(&ZOPN)          SETC '++ &ZXSTOKEN '                              00445700
.*-------------------------------------------------------------------   00445800
.***AM.L09  XNUMRANGE F                                                 00445900
&ZOPN                 SETA &ZOPN+1                                      00446000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNUMRANGE'                        00446100
&ZOPO(&ZOPN)          SETC 'DS'                                         00446200
&ZOPV(&ZOPN)          SETC 'F'                                          00446300
&ZOPD(&ZOPN)          SETC '++ &ZXNUMRANGE '                            00446400
.*-------------------------------------------------------------------   00446500
.***AM.L09  XRANGLIST A                                                 00446600
&ZOPN                 SETA &ZOPN+1                                      00446700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRANGLIST'                        00446800
&ZOPO(&ZOPN)          SETC 'DS'                                         00446900
&ZOPV(&ZOPN)          SETC 'A'                                          00447000
&ZOPD(&ZOPN)          SETC '++ &ZXRANGLIST '                            00447100
.*-------------------------------------------------------------------   00447200
.***AM.MLM2 SAVED LOCATION COUNTER                                      00447300
                      AIF  (&XPLISTVER GE 1).ZL19LA                     00447400
                      AIF  ('&ZENDBASEPL' NE '').ZL19LA                 00447500
&ZENDBASEPL           SETC 'YES'                                        00447600
&ZOPN                 SETA &ZOPN+1                                      00447700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00447800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00447900
&ZOPV(&ZOPN)          SETC '*'                                          00448000
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00448100
.ZL19LA               ANOP  ,                                           00448200
.*-------------------------------------------------------------------   00448300
.***AM.LVER1                                                            00448400
                      AIF  (&XPLISTVER LT 1).ZL19L                      00448500
.*-------------------------------------------------------------------   00448600
.*-------------------------------------------------------------------   00448700
.***AM.L09  XHSPALET F                                                  00448800
&ZOPN                 SETA &ZOPN+1                                      00448900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XHSPALET'                         00449000
&ZOPO(&ZOPN)          SETC 'DS'                                         00449100
&ZOPV(&ZOPN)          SETC 'F'                                          00449200
&ZOPD(&ZOPN)          SETC '++ &ZXHSPALET '                             00449300
.*-------------------------------------------------------------------   00449400
.***AM.LVER2                                                            00449500
.ZL19L                ANOP  ,                                           00449600
.*-------------------------------------------------------------------   00449700
.*-------------------------------------------------------------------   00449800
.***AM.L10 END OF HSPSERV LIST PARAMETERS                               00449900
&ZOPN                 SETA &ZOPN+1                                      00450000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00450100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00450200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00450300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00450400
.*                                                                      00450500
&ZOPN                 SETA &ZOPN+1                                      00450600
&ZOPL(&ZOPN)          SETC ' '                                          00450700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00450800
&ZOPV(&ZOPN)          SETC '1'                                          00450900
&ZOPD(&ZOPN)          SETC ' '                                          00451000
.*-------------------------------------------------------------------   00451100
.***AL.L12 HSPSERV FMT=LIST MF=S!L PARAMETERS                           00451200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00451300
.*                                                                      00451400
&ZOPN                 SETA  &ZOPN+1                                     00451500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00451600
&ZOPO(&ZOPN)          SETC  'DC'                                        00451700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00451800
&ZOPD(&ZOPN)          SETC  '++ HSPSERV ARG PARMS'                      00451900
.*                                                                      00452000
.ZLMFSLX              ANOP  ,                                           00452100
.*-------------------------------------------------------------------   00452200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00452300
&ZPLLEN               SETA 24                                           00452400
.*                                                                      00452500
                      AIF  (&XPLISTVER LT 1).ZLLEN2Z                    00452600
&ZPLLEN               SETA 28                                           00452700
.ZLLEN2Z              ANOP  ,                                           00452800
.*                                                                      00452900
.******************************************************************     00453000
.***AI.L01 HSPSERV FMT=LIST FILL IN PARAMETER AREA                      00453100
.******************************************************************     00453200
                      ACTR  10000                                       00453300
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00453400
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00453500
&ZCVAL                SETC  'LAE'          XAX MODE                     00453600
.ZIMFXA               ANOP ,                                            00453700
.*                                                                      00453800
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00453900
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00454000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00454100
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00454200
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00454300
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00454400
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00454500
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00454600
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00454700
&ZOPN                 SETA  &ZOPN+1                                     00454800
&ZOPL(&ZOPN)          SETC  ' '                                         00454900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00455000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00455100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00455200
                      AGO   .ZIMFNX                                     00455300
.*                                                                      00455400
.ZIMFN2               ANOP ,                                            00455500
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00455600
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00455700
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00455800
&ZOPN                 SETA  &ZOPN+1                                     00455900
&ZOPL(&ZOPN)          SETC  ' '                                         00456000
&ZOPO(&ZOPN)          SETC  'LAE'                                       00456100
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00456200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00456300
                      AGO   .ZIMFNX                                     00456400
.ZIMFNX1              ANOP ,                                            00456500
&ZOPN                 SETA  &ZOPN+1                                     00456600
&ZOPL(&ZOPN)          SETC  ' '                                         00456700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00456800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00456900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00457000
.ZIMFNX               ANOP ,                                            00457100
.********************************************************************   00457200
.***AI.L02 HSPSERV FMT=LIST INITIALIZE PARAMETER AREA                   00457300
.********************************************************************   00457400
.***AI.L03 MF=(SLME)                                                    00457500
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00457600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00457700
.*                                                                      00457800
&ZOPN                 SETA  &ZOPN+1                                     00457900
&ZOPL(&ZOPN)          SETC  ' '                                         00458000
&ZOPO(&ZOPN)          SETC  'XC'                                        00458100
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00458200
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00458300
.ZIMFLX               ANOP  ,                                           00458400
.*-------------------------------------------------------------------   00458500
.***AI.L04A XVERSION XL1                                                00458600
                      AIF   (&XPLISTVER EQ 0).ZIMFVU                    00458700
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVV            00458800
.ZIMFVU               ANOP  ,                                           00458900
                      AIF   ('&PLISTVER' EQ '').ZIMFVW                  00459000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVW            00459100
.ZIMFVV               ANOP  ,                                           00459200
&ZOPN                 SETA  &ZOPN+1                                     00459300
&ZOPL(&ZOPN)          SETC  ' '                                         00459400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00459500
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00459600
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00459700
.ZIMFVW               ANOP  ,                                           00459800
.*-------------------------------------------------------------------   00459900
.***AI.L07 XSERVICE AL1                                                 00460000
&ZW                   SETC  ''                                          00460100
.*-------------------------------------------------------------------   00460200
.***AI.L15 XSERVICE "SREAD" AL1                                         00460300
         AIF   ('&XSERVICE' NE 'SREAD').ZI3A                            00460400
&ZW                   SETC  '1'                                         00460500
.ZI3A                 ANOP  ,                                           00460600
.*-------------------------------------------------------------------   00460700
.***AI.L15 XSERVICE "SWRITE" AL1                                        00460800
         AIF   ('&XSERVICE' NE 'SWRITE').ZI4A                           00460900
&ZW                   SETC  '2'                                         00461000
.ZI4A                 ANOP  ,                                           00461100
.*-------------------------------------------------------------------   00461200
.***AI.L15 XSERVICE "CREAD" AL1                                         00461300
         AIF   ('&XSERVICE' NE 'CREAD').ZI5A                            00461400
&ZW                   SETC  '3'                                         00461500
.ZI5A                 ANOP  ,                                           00461600
.*-------------------------------------------------------------------   00461700
.***AI.L15 XSERVICE "CWRITE" AL1                                        00461800
         AIF   ('&XSERVICE' NE 'CWRITE').ZI6A                           00461900
&ZW                   SETC  '4'                                         00462000
.ZI6A                 ANOP  ,                                           00462100
.*-------------------------------------------------------------------   00462200
.***AI.L17 XSERVICE AL1                                                 00462300
                      AIF   ('&ZW' NE '0').ZI6C                         00462400
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI6B              00462500
.ZI6C                 ANOP  ,                                           00462600
                      AIF   ('&ZW' EQ '').ZI6B                          00462700
.*                                                                      00462800
&ZOPN                 SETA  &ZOPN+1                                     00462900
&ZOPL(&ZOPN)          SETC  ' '                                         00463000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00463100
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  00463200
&ZOPD(&ZOPN)          SETC  '++ &ZXSERVICE XSERVICE'                    00463300
.ZI6B                 ANOP  ,                                           00463400
.*-------------------------------------------------------------------   00463500
.***AI.L05 XFLAGS1 BL1                                                  00463600
&ZW                   SETC  ''                                          00463700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00463800
&ZMS                  SETC  ''                                          00463900
&ZC                   SETC  ''                                          00464000
.*-------------------------------------------------------------------   00464100
.***AI.L08 XFLAGS1 "YES"                                                00464200
.***      BL1'1XXXXXXX'                                                 00464300
         AIF   ('&XRELEASE' NE 'YES').ZI9A                              00464400
&ZW                   SETC  '&ZW.1'                                     00464500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00464600
&ZMS                  SETC  '&ZMS.1'                                    00464700
                      AGO   .ZI9C                                       00464800
.*                                                                      00464900
.ZI9A                 ANOP  ,                                           00465000
&ZW                   SETC  '&ZW.0'                                     00465100
         AIF   ('&ZXRELEASE' EQ '').ZI9B                                00465200
&ZMS                  SETC  '&ZMS.0'                                    00465300
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00465400
                      AGO   .ZI9C                                       00465500
.*                                                                      00465600
.ZI9B                 ANOP  ,                                           00465700
&ZMS                  SETC  '&ZMS.1'                                    00465800
.ZI9C                 ANOP  ,                                           00465900
.*-------------------------------------------------------------------   00466000
.***AI.L08 XFLAGS1 "YES"                                                00466100
.***      BL1'X1XXXXXX'                                                 00466200
         AIF   ('&XIOPATH' NE 'YES').ZI10A                              00466300
&ZW                   SETC  '&ZW.1'                                     00466400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00466500
&ZMS                  SETC  '&ZMS.1'                                    00466600
                      AGO   .ZI10C                                      00466700
.*                                                                      00466800
.ZI10A                ANOP  ,                                           00466900
&ZW                   SETC  '&ZW.0'                                     00467000
         AIF   ('&ZXIOPATH' EQ '').ZI10B                                00467100
&ZMS                  SETC  '&ZMS.0'                                    00467200
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00467300
                      AGO   .ZI10C                                      00467400
.*                                                                      00467500
.ZI10B                ANOP  ,                                           00467600
&ZMS                  SETC  '&ZMS.1'                                    00467700
.ZI10C                ANOP  ,                                           00467800
.*-------------------------------------------------------------------   00467900
.***AI.L08 XFLAGS1 "HOME"                                               00468000
.***      BL1'XX1XXXXX'                                                 00468100
         AIF   ('&XADDRSP' NE 'HOME').ZI11A                             00468200
&ZW                   SETC  '&ZW.1'                                     00468300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00468400
&ZMS                  SETC  '&ZMS.1'                                    00468500
                      AGO   .ZI11C                                      00468600
.*                                                                      00468700
.ZI11A                ANOP  ,                                           00468800
&ZW                   SETC  '&ZW.0'                                     00468900
         AIF   ('&ZXADDRSP' EQ '').ZI11B                                00469000
&ZMS                  SETC  '&ZMS.0'                                    00469100
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00469200
                      AGO   .ZI11C                                      00469300
.*                                                                      00469400
.ZI11B                ANOP  ,                                           00469500
&ZMS                  SETC  '&ZMS.1'                                    00469600
.ZI11C                ANOP  ,                                           00469700
.*-------------------------------------------------------------------   00469800
.***AI.L08 XFLAGS1 "PRIMARY"                                            00469900
.***      BL1'XXX1XXXX'                                                 00470000
         AIF   ('&XADDRSP' NE 'PRIMARY').ZI12A                          00470100
&ZW                   SETC  '&ZW.1'                                     00470200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00470300
&ZMS                  SETC  '&ZMS.1'                                    00470400
                      AGO   .ZI12C                                      00470500
.*                                                                      00470600
.ZI12A                ANOP  ,                                           00470700
&ZW                   SETC  '&ZW.0'                                     00470800
         AIF   ('&ZXADDRSP' EQ '').ZI12B                                00470900
&ZMS                  SETC  '&ZMS.0'                                    00471000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00471100
                      AGO   .ZI12C                                      00471200
.*                                                                      00471300
.ZI12B                ANOP  ,                                           00471400
&ZMS                  SETC  '&ZMS.1'                                    00471500
.ZI12C                ANOP  ,                                           00471600
.*-------------------------------------------------------------------   00471700
.***AI.L08 XFLAGS1 "COMMON"                                             00471800
.***      BL1'XXXX1XXX'                                                 00471900
         AIF   ('&XADDRSP' NE 'COMMON').ZI13A                           00472000
&ZW                   SETC  '&ZW.1'                                     00472100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00472200
&ZMS                  SETC  '&ZMS.1'                                    00472300
                      AGO   .ZI13C                                      00472400
.*                                                                      00472500
.ZI13A                ANOP  ,                                           00472600
&ZW                   SETC  '&ZW.0'                                     00472700
         AIF   ('&ZXADDRSP' EQ '').ZI13B                                00472800
&ZMS                  SETC  '&ZMS.0'                                    00472900
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00473000
                      AGO   .ZI13C                                      00473100
.*                                                                      00473200
.ZI13B                ANOP  ,                                           00473300
&ZMS                  SETC  '&ZMS.1'                                    00473400
.ZI13C                ANOP  ,                                           00473500
.*-------------------------------------------------------------------   00473600
.***AI.L08 XFLAGS1 "YES"                                                00473700
.***      BL1'XXXXX1XX'                                                 00473800
         AIF   ('&XKEEP' NE 'YES').ZI14A                                00473900
&ZW                   SETC  '&ZW.100'                                   00474000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00474100
&ZMS                  SETC  '&ZMS.111'                                  00474200
                      AGO   .ZI14C                                      00474300
.*                                                                      00474400
.ZI14A                ANOP  ,                                           00474500
&ZW                   SETC  '&ZW.000'                                   00474600
         AIF   ('&ZXKEEP' EQ '').ZI14B                                  00474700
&ZMS                  SETC  '&ZMS.011'                                  00474800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00474900
                      AGO   .ZI14C                                      00475000
.*                                                                      00475100
.ZI14B                ANOP  ,                                           00475200
&ZMS                  SETC  '&ZMS.111'                                  00475300
.ZI14C                ANOP  ,                                           00475400
.*-------------------------------------------------------------------   00475500
.***AI.L11 XFLAGS1 BL1                                                  00475600
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI14D              00475700
                      AIF   ('&ZC' NE 'YES').ZI14D                      00475800
&ZOPN                 SETA  &ZOPN+1                                     00475900
&ZOPL(&ZOPN)          SETC  ' '                                         00476000
&ZOPO(&ZOPN)          SETC  'NI'                                        00476100
&ZOPV(&ZOPN)          SETC  '4(1),B''&ZMS'''                            00476200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00476300
.ZI14D                ANOP  ,                                           00476400
                      AIF   ('&ZCLNG' NE 'YES').ZI14E  ALL ZERO BITS    00476500
&ZOPN                 SETA  &ZOPN+1                                     00476600
&ZOPL(&ZOPN)          SETC  ' '                                         00476700
&ZOPO(&ZOPN)          SETC  'OI'                                        00476800
&ZOPV(&ZOPN)          SETC  '4(1),B''&ZW'''                             00476900
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00477000
.ZI14E                ANOP  ,                                           00477100
.*-------------------------------------------------------------------   00477200
.***AI.L25  XSTOKEN CL8                                                 00477300
                      AIF   ('&ZXSTOKEN' EQ '').ZI17E                   00477400
                      AIF   ('&ZXSTOKEN' EQ 'OUTPUT').ZI17E             00477500
&ZCGPR                SETC  '&XSTOKEN'                                  00477600
.*                                                                      00477700
                      AIF   ('&XSTOKEN'(1,1) NE '(').ZI17B              00477800
&ZCGPR   SETC  '0('.'&XSTOKEN'(2,K'&XSTOKEN-2).')'                      00477900
.ZI17B                ANOP  ,                                           00478000
.*                                                                      00478100
&ZOPN                 SETA  &ZOPN+1                                     00478200
&ZOPL(&ZOPN)          SETC  ' '                                         00478300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00478400
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00478500
&ZOPD(&ZOPN)          SETC  '++ &ZXSTOKEN XSTOKEN'                      00478600
.*                                                                      00478700
.ZI17E                ANOP  ,                                           00478800
.*-------------------------------------------------------------------   00478900
.***AI.L25  XNUMRANGE F                                                 00479000
                      AIF   ('&ZXNUMRANGE' EQ '').ZI18E                 00479100
                      AIF   ('&ZXNUMRANGE' EQ 'OUTPUT').ZI18E           00479200
&ZCGPR                SETC  '&XNUMRANGE'                                00479300
.*                                                                      00479400
                      AIF   ('&XNUMRANGE'(1,1) NE '(').ZI18B            00479500
&ZCGPR   SETC  '0('.'&XNUMRANGE'(2,K'&XNUMRANGE-2).')'                  00479600
                      AGO   .ZI18D                                      00479700
.ZI18B                ANOP  ,                                           00479800
.*                                                                      00479900
&ZC                   SETC  '&XNUMRANGE'(1,1)                           00480000
                      AIF   (T'&ZC NE 'N').ZI18D                        00480100
&ZC                   SETC  '&XNUMRANGE'                                00480200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               00480300
&ZCGPR                SETC  '=FL4''&XNUMRANGE'''                        00480400
.*                                                                      00480500
.ZI18D                ANOP  ,                                           00480600
.*                                                                      00480700
&ZOPN                 SETA  &ZOPN+1                                     00480800
&ZOPL(&ZOPN)          SETC  ' '                                         00480900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00481000
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00481100
&ZOPD(&ZOPN)          SETC  '++ &ZXNUMRANGE XNUMRANGE'                  00481200
.*                                                                      00481300
.ZI18E                ANOP  ,                                           00481400
.*-------------------------------------------------------------------   00481500
.***AI.L25  XRANGLIST AL4                                               00481600
                      AIF   ('&ZXRANGLIST' EQ '').ZI19E                 00481700
                      AIF   ('&ZXRANGLIST' EQ 'OUTPUT').ZI19E           00481800
&ZCGPR                SETC  '&XRANGLIST'                                00481900
.*                                                                      00482000
                      AIF   ('&XRANGLIST'(1,1) NE '(').ZI19B            00482100
&ZCGPR   SETC  '0('.'&XRANGLIST'(2,K'&XRANGLIST-2).')'                  00482200
                      AGO   .ZI19D                                      00482300
.ZI19B                ANOP  ,                                           00482400
.*                                                                      00482500
&ZC                   SETC  '&XRANGLIST'(1,1)                           00482600
                      AIF   (T'&ZC NE 'N').ZI19D                        00482700
&ZC                   SETC  '&XRANGLIST'                                00482800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               00482900
&ZCGPR                SETC  '=AL4(&XRANGLIST)'                          00483000
.*                                                                      00483100
.ZI19D                ANOP  ,                                           00483200
.*                                                                      00483300
&ZOPN                 SETA  &ZOPN+1                                     00483400
&ZOPL(&ZOPN)          SETC  ' '                                         00483500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00483600
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00483700
&ZOPD(&ZOPN)          SETC  '++ &ZXRANGLIST XRANGLIST'                  00483800
.*                                                                      00483900
.ZI19E                ANOP  ,                                           00484000
.*-------------------------------------------------------------------   00484100
.***AI.LVER01                                                           00484200
                      AIF  (&XPLISTVER LT 1).ZI20Z                      00484300
.*-------------------------------------------------------------------   00484400
.***AI.L18  XHSPALET F                                                  00484500
         AIF   ('&XHSPALET' NE '0').ZI20                                00484600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI20  CK *        00484700
&ZXHSPALET            SETC  ''             RESET INPUT/OUTPUT           00484800
.ZI20                 ANOP  ,                                           00484900
.*-------------------------------------------------------------------   00485000
.***AI.L25  XHSPALET F                                                  00485100
                      AIF   ('&ZXHSPALET' EQ '').ZI20E                  00485200
                      AIF   ('&ZXHSPALET' EQ 'OUTPUT').ZI20E            00485300
&ZCGPR                SETC  '&XHSPALET'                                 00485400
         AIF   ('&XHSPALET' NE '0').ZI20A                               00485500
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI20E                          00485600
.*                                                                      00485700
&ZCGPR                SETC  '=XL4''00'''                                00485800
.ZI20A                ANOP  ,                                           00485900
.*                                                                      00486000
                      AIF   ('&XHSPALET'(1,1) NE '(').ZI20B             00486100
&ZCGPR   SETC  '0('.'&XHSPALET'(2,K'&XHSPALET-2).')'                    00486200
                      AGO   .ZI20D                                      00486300
.ZI20B                ANOP  ,                                           00486400
.*                                                                      00486500
&ZC                   SETC  '&XHSPALET'(1,1)                            00486600
                      AIF   (T'&ZC NE 'N').ZI20D                        00486700
&ZC                   SETC  '&XHSPALET'                                 00486800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI20D               00486900
&ZCGPR                SETC  '=AL4(&XHSPALET)'                           00487000
.*                                                                      00487100
.ZI20D                ANOP  ,                                           00487200
.*                                                                      00487300
&ZOPN                 SETA  &ZOPN+1                                     00487400
&ZOPL(&ZOPN)          SETC  ' '                                         00487500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00487600
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00487700
&ZOPD(&ZOPN)          SETC  '++ &ZXHSPALET XHSPALET'                    00487800
.*                                                                      00487900
.ZI20E                ANOP  ,                                           00488000
.*-------------------------------------------------------------------   00488100
.***AI.LVER02                                                           00488200
.ZI20Z                ANOP  ,                                           00488300
.*-------------------------------------------------------------------   00488400
&ZOPN1                SETA &ZOPN                                        00488500
.*-------------------------------------------------------------------   00488600
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00488700
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00488800
.*******************************************************************    00488900
.***  PROCESS HSPSERV OUTPUT PARAMETERS                                 00489000
.*******************************************************************    00489100
                      ACTR  10000                                       00489200
.*******************************************************************    00489300
.***AO.X02  RETURN CODE PROCESSING                                      00489400
.*******************************************************************    00489500
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00489600
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00489700
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00489800
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00489900
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00490000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00490100
&ZOPN                 SETA  &ZOPN+1                                     00490200
&ZOPL(&ZOPN)          SETC  ' '                                         00490300
&ZOPO(&ZOPN)          SETC  'ST'                                        00490400
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00490500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00490600
                      AGO   .ZMRETX                                     00490700
.*                                                                      00490800
.ZMRET2               ANOP  ,                                           00490900
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00491000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00491100
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00491200
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00491300
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00491400
&ZOPN                 SETA  &ZOPN+1                                     00491500
&ZOPL(&ZOPN)          SETC  ' '                                         00491600
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00491700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00491800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00491900
.ZMRETX               ANOP  ,                                           00492000
.*******************************************************************    00492100
.***AO.X03  REASON CODE PROCESSING                                      00492200
.*******************************************************************    00492300
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00492400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00492500
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00492600
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00492700
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00492800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00492900
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00493000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00493100
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00493200
&ZOPN                 SETA  &ZOPN+1                                     00493300
&ZOPL(&ZOPN)          SETC  ' '                                         00493400
&ZOPO(&ZOPN)          SETC  'ST'                                        00493500
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00493600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00493700
                      AGO   .ZMRSNX                                     00493800
.*                                                                      00493900
.ZMRSN2               ANOP  ,                                           00494000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00494100
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00494200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00494300
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00494400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00494500
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00494600
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00494700
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00494800
&ZOPN                 SETA  &ZOPN+1                                     00494900
&ZOPL(&ZOPN)          SETC  ' '                                         00495000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00495100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00495200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00495300
.ZMRSNX               ANOP  ,                                           00495400
.*******************************************************************    00495500
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00495600
.*******************************************************************    00495700
.ZMFLX                ANOP  ,              MF=L PROCESSING              00495800
.*******************************************************************    00495900
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00496000
.*******************************************************************    00496100
                      ACTR  10000                                       00496200
.*                                                                      00496300
                      LCLA  &ZLC           COLUMN POSITION              00496400
                      LCLA  &ZOPX          LIST TABLE INDEX             00496500
                      LCLC  &ZLL           LABEL                        00496600
                      LCLC  &ZLOP          OPERATION                    00496700
                      LCLC  &ZLV           VALUE                        00496800
                      LCLC  &ZLD           DESCRIPTION                  00496900
.*                                                                      00497000
&ZOPX                 SETA  1                                           00497100
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00497200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00497300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00497400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00497500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00497600
                      AIF   (K'&ZLD LE 0).ZL5                           00497700
&ZLC                  SETA  35             COMMENT COLUMN               00497800
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00497900
&ZLC                  SETA  33             COMMMENT COLUMN              00498000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00498100
&ZLV                  SETC  '&ZLV'.' '                                  00498200
                      AGO   .ZL3                                        00498300
.*                                                                      00498400
.ZL4                  ANOP  ,                                           00498500
&ZLV                  SETC  '&ZLV'.' '                                  00498600
.ZL5                  ANOP  ,                                           00498700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00498800
.*                                                                      00498900
&ZLL     &ZLOP &ZLV                                                     00499000
.*                                                                      00499100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00499200
                      AGO   .ZL2           CONTINUE LOOPING             00499300
.*                                                                      00499400
.ZLX                  ANOP  ,                                           00499500
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00499600
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00499700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00499800
         LCLC  &ASYSE            LOCAL ASC ENVIRONMENT VAR         @L1A 00499900
         LCLC  &HLABO            LABEL FOR PC TO HSP SERVICES      @L1A 00500000
         LCLC  &HLABE            LABEL FOR END OF MACRO EXPANSION  @L1A 00500100
&HLABO   SETC  'HSP'.'&SYSNDX'.'O'     ESTABLISH HSPXXXXO LABEL    @L1A 00500200
&HLABE   SETC  'HSP'.'&SYSNDX'.'E'     ESTABLISH HSPXXXXE LABEL    @L1A 00500300
&ASYSE   SETC  '&SYSASCE'        RECORD CURRENT SYSSTATE VALUE     @L1A 00500400
.********************************************************************** 00500500
.*                                                                      00500600
.*  If an ALET was specified, or if this is the execute form of the     00500700
.*  macro, generate code to exploit the ALET.  For the case where the   00500800
.*  ALET is not specified but this is the execute form of the macro,    00500900
.*  a test must be generated to determine if the HSPSERV parameter list 00501000
.*  contains an ALET (only version 1 of parm list has an ALET).         00501100
.*                                                                      00501200
.********************************************************************** 00501300
         AIF   ('&HSPALET' EQ '' AND '&MF(1)' NE 'E').HSPPC        @L1A 00501400
         AIF   ('&HSPALET' NE '').HSPNCK     ALET SPECIFIED?       @L1A 00501500
         CLI   0(1),1            CHECK HSPSERV PARM LIST VERSION   @L1A 00501600
         BNE   &HLABO            IF NOT VERSION 1, PC TO HSP SERV  @L1A 00501700
.HSPNCK  AIF   ('&ASYSE' EQ 'AR' OR                                    C00501800
               '&ASYSE' EQ 'P').HSPAE1     IN AR OR PRIM MODE?     @L1A 00501900
         IAC   14                CAPTURE CURRENT PSW ASC MODE      @L1A 00502000
         ST    14,0(0,13)        RECORD CURRENT PSW ASC MODE       @L1A 00502100
.HSPAE1  AIF   ('&ASYSE' EQ 'AR').HSPAE2     ALREADY IN AR MODE?   @L1A 00502200
         SAC   512               SAC TO AR MODE                    @L1A 00502300
         SYSSTATE ASCENV=AR      INFORM ASSEMBLER OF AR MODE       @L1A 00502400
.HSPAE2  L     15,16(0,0)        GET CVT ADDRESS                   @L1A 00502500
         L     15,356(15,0)      GET PVT ADDRESS                   @L1A 00502600
         L     15,208(15,0)      GET BALR ADDRESS TO EXPLOIT ALET  @L1A 00502700
         BALR  14,15             CALL SERVICE TO EXPLOIT ALET      @L1A 00502800
         AIF   ('&ASYSE' EQ 'AR').HSPAE6  ORIGINAL MODE WAS AR?    @L1A 00502900
         AIF   ('&ASYSE' EQ 'P').HSPAE3   ORIGINAL MODE WAS PRIM?  @L1A 00503000
         L     14,0(0,13)        RETRIEVE ORIGINAL PSW ASC MODE    @L1A 00503100
         SAC   0(14)             RESTORE ORIGINAL PSW ASC MODE     @L1A 00503200
         AGO   .HSPAE4                                             @L1A 00503300
.HSPAE3  SAC   0                 RESTORE PRIMARY ASC MODE          @L1A 00503400
.HSPAE4  AIF   ('&ASYSE' NE 'P' AND                                    C00503500
               '&ASYSE' NE 'ANY').HSPAE5   ORIG MODE NOT PRIM/ANY? @L1A 00503600
         SYSSTATE ASCENV=&ASYSE                                    @L1A 00503700
         AGO   .HSPAE6                                             @L1A 00503800
.HSPAE5  SYSSTATE TEST                                             @L1A 00503900
.HSPAE6  AIF   ('&HSPALET' NE '').HSPPC    PC LNKG TO BR AROUND?   @L1A 00504000
         B     &HLABE            SKIP PC LINKAGE                   @L1A 00504100
.********************************************************************** 00504200
.*                                                                      00504300
.*  Generate code to PC to hiperspace services only when HSPALET was    00504400
.*  not specified.                                                      00504500
.*                                                                      00504600
.********************************************************************** 00504700
.HSPPC   AIF   ('&HSPALET' NE '').HSPEND                           @L1A 00504800
&HLABO   L     14,16(0,0)        GET CVT ADDRESS                   @L1C 00504900
         L     14,772(14,0)      GET SYSTEM FUNCTION TABLE ADDRESS      00505000
         L     14,208(14,0)      GET LX FOR SERVICE ROUTINE             00505100
         AIF   ('&XSERVICE' EQ 'CREAD').HSP001                          00505200
         AIF   ('&XSERVICE' EQ 'CWRITE').HSP001                         00505300
         AGO   .HSP002                                                  00505400
.HSP001  LA    15,6              EX OFFSET FOR CACHE SERVICES           00505500
         AGO   .HSP003                                                  00505600
.HSP002  LA    15,7              EX OFFSET FOR SCROLL SERVICES          00505700
.HSP003  OR    14,15             GENERATE LX/EX COMBINATION             00505800
         PC    0(14)             PC TO HSPSERV SERVICE                  00505900
.HSPEND  ANOP  ,                                                   @L1A 00506000
&HLABE   DS    0H                                                  @L1A 00506100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00506200
.ZLINKX               ANOP  ,                                           00506300
.*******************************************************************    00506400
.***AP.X01  FORMAT GENERATED CODE                                       00506500
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00506600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00506700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00506800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00506900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00507000
                      AIF   (K'&ZLD LE 0).ZL51                          00507100
&ZLC                  SETA  35             COMMENT COLUMN               00507200
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00507300
&ZLC                  SETA  33             COMMENT COLUMN               00507400
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00507500
&ZLV                  SETC  '&ZLV'.' '                                  00507600
                      AGO   .ZL31                                       00507700
.*                                                                      00507800
.ZL41                 ANOP  ,                                           00507900
&ZLV                  SETC  '&ZLV'.' '                                  00508000
.ZL51                 ANOP  ,                                           00508100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00508200
.*                                                                      00508300
&ZLL     &ZLOP &ZLV                                                     00508400
.*                                                                      00508500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00508600
                      AGO   .ZL21          CONTINUE LOOPING             00508700
.*                                                                      00508800
.ZLX1                 ANOP  ,                                           00508900
.*******************************************************************    00509000
.***AP.X02  END OF HSPSERV MACRO                                        00509100
&ZHSPSERV             SETC  'YES'          SET HSPSERV USED             00509200
         POP   PRINT                                                    00509300
*                                            HSPSERV-1                  00509400
         SPACE 1                                                        00509500
.ZLX2                 ANOP  ,                                           00509600
         MEND                                                           00509700
**********************************************************************/ 00509800
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00509900
*%HSPSERV: MACRO KEYS(SREAD,STOKEN,NUMRANGE,RANGLIST,RELEASE,HSPALET,   00510000
*                 SWRITE,CREAD,ADDRSP,IOPATH,CWRITE,KEEP,RETCODE,       00510100
*                 RSNCODE,PLISTVER,MF);                                 00510200
*  ANS('?'!!MACLABEL!!' '!!'HSPSERVP '!!MACLIST!!                       00510300
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00510400
*%END HSPSERV;                                                          00510500

         MACRO                                                                  
&NAME    IHBRDWRA  &RPL=,&IHBRW=,&ACB=,&AREA=,&AREALEN=,&RECLEN=,      *        
               &AAREA=,&AAREALN=,&ARECLEN=,&ECB=,&EXIT=,&CODESEL=,     *        
               &OPTCD=,&ARG=,&NIB=,&BRANCH=,&OBSQVAL=,&SIGDATA=,       *        
               &RESPOND=,&CONTROL=,&CHNGDIR=,&SSENSEO=,&STYPE=,        *        
               &SEQNO=,&USENSEO=,&IBSQVAL=,&RTYPE=,&IBSQAC=,&SSENSMO=, *        
               &OBSQAC=,&POST=,&CHAIN=,&OPTION=,&SCANOPT=,&BRACKET=,   *        
               &CRYPT=,&THRDPTY=,&SONCODE=,&PSTIMER=,&MAXSESS=,        *        
               &FORCETKO=                                                       
.* /***** START OF SPECIFICATIONS ************************************/         
.* /*                                                                */         
.* /*  MACRO NAME: IHBRDWRA                                          */         
.* /*                                                                */         
.* /*  DESCRIPTIVE NAME: INNER INTERFACE MACRO FOR API REQUEST       */         
.* /*                    MACROS                                      */         
.* /*                                                                */         
.* /*  COPYRIGHT:                                                    */         
.* /*             Licensed Materials - Property of IBM               */         
.* /*             5650-ZOS Copyright IBM Corp. 1977,  2016           */         
.* /*             Status = CSV2R2                                    */         
.* /*                                                                */         
.* /*             U.S. GOVERNMENT USERS RESTRICTED RIGHTS -          */         
.* /*             USE, DUPLICATION OR DISCLOSURE RESTRICTED BY       */         
.* /*             GSA ADP SCHEDULE CONTRACT WITH IBM CORP.           */         
.* /*                                                                */         
.* /*                                                                */         
.* /*                                                                */         
.* /*  FUNCTION: GENERATES IN-LINE CODE FOR THE FOLLOWING API        */         
.* /*            REQUEST MACROS THAT USE AN RPL:  CHANGE, CLSDST,    */         
.* /*            INQUIRE, INTRPRET, OPNDST, OPNSEC, RECEIVE,         */         
.* /*            REQSESS, RESETSR, SEND, SESSIONC, SETLOGON,         */         
.* /*            SIMLOGON, AND TERMSESS.  THE GENERATED              */         
.* /*            CODE LOADS THE RPL ADDRESS INTO REGISTER 1,         */         
.* /*            MODIFIES RPL FIELDS AS INDICATED BY THE RPL         */         
.* /*            MODIFIERS ON THE REQUEST MACRO, LOADS A             */         
.* /*            REQUEST CODE INTO REGISTER ZERO, AND BRANCHES       */         
.* /*            TO THE INTERFACE ROUTINE WHOSE ADDRESS IS IN        */         
.* /*            THE ACB LOCATED VIA THE RPL.  ANY CODE TO           */         
.* /*            MODIFY THE RPL IS BYPASSED IF THE RPL IS            */         
.* /*            ALREADY ACTIVE.                                     */         
.* /*                                                                */         
.* /*  NOTES: AS FOLLOW                                              */         
.* /*      1. RPL KEYWORDS LEVENT AND GEVENT ARE VALID               */         
.* /*             FOR OS/VS2 ONLY                                    */         
.* /*                                                                */         
.* /*  PROCESSOR: ASSEMBLER                                          */         
.* /*                                                                */         
.* /*  CREATED BY: MACRO DEVELOPMENT TEAM                            */         
.* /*                                                                */         
.* /*  INTERNAL MACROS: NONE                                         */         
.* /*                                                                */         
.* /*  EXTERNAL REFERENCES: NONE                                     */         
.* /*                                                                */         
.* /*  CHANGE ACTIVITY:                                              */         
.* /*  CHANGE 01 - 01/19/77 - ADDED QUEUED RESPONSE SUPPORT  @D34EKMP*/         
.* /*  CHANGE 02 - 02/16/77 - ADDED CONTROL SBI/BIS SUPPORT  @D34EKMP*/         
.* /*  CHANGE 03 - 04/27/77 - CORRECTED CONTROL SDT SUPPORT  @PI10125*/         
.* /*  CHANGE 04 - 05/25/77 - CORRECTED RPL SIGDATA SUPPORT  @VS45960*/         
.* /*  CHANGE 05 - 10/26/77 - CORRECTED INQ SESSKEY SUPPORT  @XM30862*/         
.* /*  CHANGE 06 - 06/15/77 - ADDED ENCR KEYWORD SUPPORT     @ZM35828*/         
.* /*  CHANGE 07 - 08/09/77 - CHANGE ENCR TO CRYPT           @D440518*/         
.* /*  CHANGE 08 - 01/20/78 - FIXED SETTING OF CRYPT BIT     @XM31389*/         
.* /*  CHANGE 09 - 05/09/80 - SYSROUTE OF OX26398            @ZA46611*/         
.* /*  CHANGE 10 - 12/23/80 - SUPPORT OF DCR4747.00          @D5B4747*/         
.* /*  CHANGE 11 - 12/08/80 - SUPPORT OF DCR4747.02          @D5B4747*/         
.* /*  CHANGE 12 - 01/20/81 - SUPPORT OF PTM8628             @P5Z8628*/         
.* /*  CHANGE 13 - 01/22/81 - SUPPORT OF PTM8733             @P5B8733*/         
.* /*  CHANGE 14 - 01/29/81 - SUPPORT OF DCR4790             @D5P4790*/         
.* /*  CHANGE 15 - 02/27/81 - SUPPORT OF PTM8805             @P5Z8805*/         
.* /*  CHANGE 16 - 03/06/81 - SUPPORT OF PTM8891             @P5P8891*/         
.* /*  CHANGE 17 - 12/03/82 - PTM P011983 (APAR OZ67334)     @P011983*/         
.* /*  CHANGE 18 - 03/01/83 - XRF SUPPORT                    @R489301*/         
.* /*  CHANGE 19 - 09/09/83 - XRF SUPPORT                    @R489306*/         
.* /*  CHANGE 20 - 11/30/83 - DCR 4911.00                    @R491100*/         
.* /*  CHANGE 21 - 01/09/84 - DCR 4911.01                    @R491101*/         
.* /*  CHANGE 22 - 02/13/84 - PTM P014769                    @P014769*/         
.* /*  CHANGE 23 - 03/27/84 - PTM P015113                    @P015113*/         
.* /*  CHANGE 24 - 06/11/84 - DCR 4893.20                    @R489320*/         
.* /*  CHANGE 25 - 11/01/85 - DCR5048 QALL,QSESSLIM,QNOTENAB @R504800*/         
.* /*  CHANGE 26 - 07/14/87 - APAR OY06517 - OPTSCAN NOT CHECKING FOR*/         
.* /*                         NULL PARAMETERS PASSED         @OY06517*/         
.* /*                                                                */         
.* /* $MAC(IHBRDWRA),COMP(API),PROD(VTAM): Inner interface macro for */         
.* /*                                      API requests              */         
.* /*                                                                */         
.* /* FLAG REASON   RELEASE DATE   ORIGIN  FLAG DESCRIPTORS          */         
.* /* ---- -------- ------- ------ ------  ------------------------- */         
.* /* $F1= FM8@@CLD HVT3303 890116 109772: RCR0006 MTS API Support   */         
.* /* $BB= ACC@@AMS HVT3401 891106 615520: PL/AS CONVERSION          */         
.* /* $B1= AP@@@CLD HVT3401 890418 496698: Persistent LU-LU Sessions */         
.* /* $V1= P078866  HVT3401 900622 496698: OPTCD4 not contiguous w/5 */         
.* /* $KF= JN@@@CLD NQNAME1 910521 591683: Enhanced NQN Support      */         
.* /* $01= OY36649  HVT3431 911014 349122: QUEUED SESSION TERMINATION*/         
.* /* $02= OY55765  VM341   920723 787924: Declare &PLOPT4 to correct*/         
.* /*                                      ASSEMBLER XF error        */         
.* /* $T1= P100451  HATAPPN 920728 879315: PSTIMER setting problems  */         
.* /* $T2= P104866  HATAPPN 921002 879315: Restrict OPT4 setting     */         
.* /* $T3= P103312  HATAPPN 921008 879315: OPTCD=NQN policing        */         
.* /* $KG= P105521  HATAPPN 921103 460208: CHNGDIR=NREQ/REQ REMOVAL  */         
.* /* $T4= P105823  HATAPPN 921113 879315: CORRECTIONS TO P105521    */         
.* /* $I1= FG@@@MST GENRES  921113 879315: Generic Resource          */         
.* /* $03= OY62380  SNAIP   930330 358168: Allow CHNGDIR=NREQ to be  */         
.* /*                                      specified though it is    */         
.* /*                                      ignored (still issued by  */         
.* /*                                      CICS)                     */         
.* /* $U2= P109955  GENRES  930812 879315: Check new OPTCDs by macro */         
.* /* $U3= P110087  GENRES  930818 879315: Downward compatibility    */         
.* /* $U4= P109285  KEEPFRR 931104 879315: Implement FZKDR001, allow */         
.* /*                                      OPTCD=KEEPSRB/NKEEPSRB    */         
.* /* $04= OY67066  EMERALD 940202 358168: Add support for INQUIRE   */         
.* /*                                      OPTCD=STATUS (AE fix for  */         
.* /*                                      OY63087)                  */         
.* /* $D1= IT@@@MST TSOGR   941102 062811: Add OPTCD=GNAMESUB & add  */         
.* /*                                      PARMS=MAXSESS for SETLOGON*/         
.* /* $W1= P117054  VMVSCS  941202 879315: Conditional CS mode       */         
.* /*                                                                */         
.* /* Flag Reason   Release  Date   Origin    Description            */         
.* /* ---- -------- -------- ------ --------  ---------------------- */         
.* /* $L1= R12GRAFF CSV1R2   000830 ROTHWELL: LU level GR AFFIN      */         
.* /* $A1= OW52776  CSV1R4   020208 JPERKINS: Close timing window in */         
.* /*                                         RPL Active checking    */         
.* /* $R1= X16MNPRT CSV1R6   031006 GIERLACH: MNPS Predatory Takeover*/         
.* /* $R2= D133106  X16MNPRT 031106 GIERLACH: FORCETKO with no OPTCD */         
.* /* $A2= OA49911  HVT6220  160509 Cruse   : 3270 Data Stream       */         
.* /*                                         Monitoring API         */         
.* /*                                         (sysroute of OA48802)  */         
.* /*                                                                */         
.* /***** END OF SPECIFICATIONS **************************************/         
.*                                                                              
.* A-000000-999999                                           @XL03HMV           
.*                                                                              
* IHBRDWRA - ACF/VTAM                                                           
*                                                            @D34EKMP           
* Licensed Materials - Property of IBM                           @A2C           
* 5650-ZOS Copyright IBM Corp. 1977,  2016                       @A2C           
* REFER TO COPYRIGHT INSTRUCTIONS FORM NUMBER G120-2083      @D34EKMP           
*                                                            @D34EKMP           
         GBLB  &IHBRPLY(20)                                                     
         GBLC  &IHBTBL(20)                                                      
         GBLA  &IHBNUM                                                          
         LCLA  &PLARG,&PLNIB,&PLAREA,&PLRLEN,&PLBUFL,&PLACTIV,&PLEXTDS          
         LCLA  &PLOPTC1,&PLDACB,&PLECB,&PLAAREA,&PLAARLN,&PLARCLN               
         LCLA  &ACBRTN,&SYN,&ASY,&POPTCD2,&POPTCD3,&OPTERR,&PLSSMO              
.*                                                                              
.* MSK1CTR is incremented when bits in RPLOPTC2 must be turned ON, but          
.*   MSK2CTR is incremented when these bits need to be turned OFF               
.* MSK3CTR is incremented when bits in RPLOPTC3 must be turned ON, but          
.*   MSK4CTR is incremented when these bits need to be turned OFF  @R1A         
.*                                                                              
         LCLA  &NUM,&LEN,&CNTINQ,&MSK1CTR,&MSK2CTR,&MSK3CTR,&MSK4CTR            
         LCLA  &CNTSTL,&PLUSFLD                                    @B1A         
         LCLA  &PLOPT4                                             @02A         
.* *************** VTL ADDITIONS ****************                               
         LCLA  &NM,&NUM2,&PLRH3,&PLSRTYP,&PLVTFL2,&PLCHN,&PLCNTRL               
         LCLA  &PLCNTDF,&PLCNTSC,&PLOBSQV,&PLIBSQV,&PLOBSQ,&PLIBSQ              
         LCLA  &PLSEQNO,&PLSSNSO,&PLUSNSO,&PLCNTDC,&PLSSEO,&PLSIGDA             
         LCLA  &SCODE                                          @R491100         
.* ************ END VTL ADDITIONS ***************                               
         LCLB  &CA,&CS,&PASS,&RELEASE,&NERASE,&EAU,&ERASE,&NOTIFY               
         LCLB  &SPEC,&ANY,&LBT,&LBM,&BLK,&COND,&UNCOND             @W1C         
         LCLB  &LOCK,&ACCEPT,&ACQUIRE,&QUIESCE,&START,&STOP                     
         LCLB  &CONALL,&CONANY,&Q,&NQ,&LGONMSG,&DEVCHAR,&TERMS,&APPSTAT         
         LCLB  &COUNTS,&RNNAME,&CIDXLAT,&TOPLGON,&BSCID,&DISPLAY                
         LCLB  &RELRQ,&NRELRQ                                                   
         LCLB  &UNCONDL,&ACTIVE,&SESSION,&PEND      (RETIRED BITS) @D1C         
         LCLB  &BIT0,&BIT01,&SPARM,&SPARM1,&SKEY                                
         LCLB  &NBUFLST,&BUFFLST,&CONTCHN,&NCNTCHN             @D5B4747         
         LCLB  &NLMPEO,&LMPEO,&USERRH,&NUSERRH                 @D5B4747         
         LCLB  &BACKUP,&USERVAR,&FORCED                        @R489320         
         LCLB  &NBACKUP                                        @R489301         
         LCLB  &SONCD,&NSONCD,&UNBIND,&SENSE,&NSENSE,&HOLD     @R491100         
         LCLB  &RSPQUE,&NRSPQU                                 @R491101         
         LCLB  &MTS,&NMTS                                          @F1A         
         LCLB  &TERMQ                                              @01A         
         LCLB  &STATUS                                             @04A         
         LCLB  &MXSES                                              @D1A         
.* *************** VTL ADDITIONS ****************                               
         LCLB  &KEEP,&TRUNC,&NIBTK                                              
         LCLB  &FMHDR,&NFMHDR                                                   
         LCLB  &KEEP1,&TRUNC1,&NIBTK1,&FMHDR1                                   
         LCLC  &OPT1,&OPT,&CHAR1,&CHAR2,&CHAR3,&CHAR4                           
         LCLC  &OPT4X                                              @I1A         
.* ************ END VTL ADDITIONS ***************                               
  LCLB  &CS1,&PASS1,&NERASE1,&EAU1,&ERASE1,&NOTIFY1                             
  LCLB  &ANY1,&LBT1,&LBM1,&BLK1,&COND1,&UNCOND1                    @W1C         
  LCLB  &LOCK1,&ACCEPT1,&ACQUIR1,&QUIESC1,&START1,&STOP1                        
  LCLB  &CONALL1,&CONANY1,&NQ1,&LGONMS1,&DEVCHR1,&TERMS1,&APSTAT1               
  LCLB  &COUNTS1,&RNNAME1,&CIDXLT1,&TOPLGN1,&BSCID1,&DISPLY1                    
  LCLB  &NRELRQ1,&SKEY1                                        @XM30862         
  LCLB  &UNCNDL1,&ACTIVE1,&PEND1                    (RETIRED BITS) @D1C         
  LCLB  &BUFLST1,&CNTCHN1,&LMPEO1,&USERRH1                     @D5B4747         
  LCLB  &BACKUP1,&USRVAR1,&FORCED1                             @R489320         
  LCLB  &SONCD1,&NSONCD1,&UNBIND1,&SENSE1,&NSENSE1,&HOLD1      @R491100         
  LCLB  &RSPQUE1,&NRSPQU1                                      @R491101         
  LCLB  &MTS1                                                      @F1A         
  LCLB  &TERMQ1                                                    @01A         
  LCLB  &QSESS,&QALL,&QNOTE                                    @R504800         
  LCLB  &QSESS1,&QNOTE1,&QALL1                                 @R504800         
  LCLB  &PERSIQ,&PERST,&NPERST,&RESTOR,&PSTIME,&NQN           @B1A @KFC         
  LCLB  &GNADD,&GNDEL,&GNSUB,&SESNM,&ENDAF,&ENDFA             @D1C @L1C         
  LCLB  &KPSRB,&NKPSRB,&KPSRB1,&NKPSRB1                            @U4A         
  LCLB  &CONDCS,&CONDCS1                                           @W1A         
  LCLB  &CSSPEC,&CONDCSS                                           @W1A         
  LCLB  &STATUS1                                                   @04A         
  LCLB  &MXSES1                                                    @D1A         
  LCLB  &FRCTKO                                                    @R1A         
  LCLB  @IDS3270                                                   @A2A         
.* ********** DISPLACEMENT OF RPL FIELDS **********                             
&PLARG   SETA  36    * THIS IS AN OS VTAM DISPLACEMENT *                        
&SCODE   SETA  31    * DISPLACEMENT INTO RPL TO SONCODE *                       
&PLAREA  SETA  32    * THIS IS AN OS VTAM DISPLACEMENT *                        
&PLRLEN  SETA  48    * THIS IS AN OS VTAM DISPLACEMENT *                        
&PLBUFL  SETA  52 * JAN 12, 73 CODE ADDED AS A RESULT OF PTM____ *              
&PLACTIV SETA  69     * THIS IS AN OS VTAM DISPLACEMENT *                       
&PLEXTDS SETA  68     * THIS IS AN OS VTAM DISPLACEMENT *                       
&PLOPTC1 SETA  40     * THIS IS AN OS VTAM DISPLACEMENT *                       
&POPTCD2 SETA  56     * THIS IS AN OS VTAM DISPLACEMENT *                       
&POPTCD3 SETA  96     * THIS IS AN OS VTAM DISPLACEMENT *                       
&PLDACB  SETA  24     * THIS IS AN OS VTAM DISPLACEMENT *                       
&PLECB   SETA  08     * THIS IS AN OS VTAM DISPLACEMENT *                       
&PLAAREA SETA  76     * THIS IS AN OS VTAM DISPLACEMENT *                       
&PLAARLN SETA  80     * THIS IS AN OS VTAM DISPLACEMENT *                       
&PLARCLN SETA  84     * THIS IS AN OS VTAM DISPLACEMENT *                       
&PLUSFLD SETA  92     * THIS IS AN OS VTAM DISPLACEMENT *          @B1A         
&PLOPT4  SETA  43     * THIS IS AN OS VTAM DISPLACEMENT *          @B1A         
.* *************** VTL ADDITIONS ****************                               
&PLRH3    SETA  16                       THIRD RH BYTE                          
&PLSRTYP  SETA  17                       SEND OR RECEIVE TYPE FIELD             
&PLVTFL2  SETA  20                       VTAM FLAGS FIELD                       
&PLCHN    SETA  18                       POSITION IN RU CHAIN FIELD             
&PLCNTRL  SETA  21                       RU CONTROL CODE FIELD                  
&PLCNTDF  SETA  21                       DATA FLOW CONTROL CODES FIELD          
&PLCNTDC  SETA  22                       DATA FLOW CONTROL CODES FIELD          
&PLCNTSC  SETA  23                       SESSION CONTROL CODES FIELD            
&PLOBSQV  SETA  60                       STSN OUTBOUND SEQ. NO. FIELD           
&PLIBSQV  SETA  62                       STSN INBOUND SEQ. NO. FIELD            
&PLOBSQ   SETA  64                       STSN OUTBOUND ACTION CODES             
&PLIBSQ   SETA  65                       STSN INBOUND ACTION CODES              
&PLSEQNO  SETA  66                       SEQUENCE NUMBER FIELD                  
&PLSSNSO  SETA  100                      SYSTEM SENSE OUTPUT FIELD              
&PLSSEO   SETA  100                      SYSTEM SENSE ERROR CODES               
&PLSSMO   SETA  101                      SYSTEM SENSE ERROR CODES               
&PLUSNSO  SETA  102                      USER SENSE OUTPUT FIELD                
&PLSIGDA  SETA  108                      SIGNAL DATA 4-BYTES  @VS45960          
.* ************ END VTL ADDITIONS ***************                               
&ASY     SETA  00                                                               
&SYN     SETA  00                                                               
&BIT0    SETB  0                                                                
&CNTINQ  SETA  0                                                                
&CNTSTL  SETA  0                                                   @B1A         
&MSK1CTR SETA  0                                                                
&MSK2CTR SETA  0                                                                
&MSK3CTR SETA  0                                                                
&MSK4CTR SETA  0                                                                
&OPTERR  SETA  0                                                                
&CA      SETB  0                                                                
&CS      SETB  0                                                                
&PASS    SETB  0                                                                
&RELEASE SETB  0                                                                
&NERASE  SETB  0                                                                
&EAU     SETB  0                                                                
&ERASE   SETB  0                                                                
&SPEC    SETB  0                                                                
&ANY     SETB  0                                                                
&BLK     SETB  0                                                                
&LBM     SETB  0                                                                
&LBT     SETB  0                                                                
&COND    SETB  0                                                                
&UNCOND  SETB  0                                                                
&LOCK    SETB  0                                                                
&ACCEPT  SETB  0                                                                
&ACQUIRE SETB  0                                                                
&CONALL  SETB  0                                                                
&CONANY  SETB  0                                                                
&QUIESCE SETB  0                                                                
&START   SETB  0                                                                
&STOP    SETB  0                                                                
&LGONMSG SETB  0                                                                
&DEVCHAR SETB  0                                                                
&TERMS   SETB  0                                                                
&APPSTAT SETB  0                                                                
&COUNTS  SETB  0                                                                
&RNNAME  SETB  0                                                                
&CIDXLAT SETB  0                                                                
&TOPLGON SETB  0                                                                
&BSCID   SETB  0                                                                
&DISPLAY SETB  0                                                                
&SPARM   SETB  0                                                                
&SKEY    SETB  0                                                                
&Q       SETB  0                                                                
&NQ      SETB  0                                                                
&RELRQ   SETB  0                                                                
&NRELRQ  SETB  0                                                                
&PEND    SETB  0                                                                
&SESSION SETB  0                                                                
&ACTIVE  SETB  0                                                                
&UNCONDL SETB  0                                                                
&NOTIFY  SETB  0                                                                
&NBUFLST SETB  0                                               @D5B4747         
&BUFFLST SETB  0                                               @D5B4747         
&CONTCHN SETB  0                                               @D5B4747         
&NCNTCHN SETB  0                                               @D5B4747         
&NLMPEO  SETB  0                                               @D5B4747         
&LMPEO   SETB  0                                               @D5B4747         
&USERRH  SETB  0                                               @D5B4747         
&NUSERRH SETB  0                                               @D5B4747         
&NBACKUP SETB  0                                               @R489301         
&BACKUP  SETB  0                                               @R489301         
&USERVAR SETB  0                                               @R489301         
&FORCED  SETB  0                                               @R489301         
&SONCD   SETB  0                                               @R491100         
&NSONCD  SETB  0                                               @R491100         
&UNBIND  SETB  0                                               @R491100         
&SENSE   SETB  0                                               @R491100         
&NSENSE  SETB  0                                               @R491100         
&HOLD    SETB  0                                               @R491100         
&RSPQUE  SETB  0                                               @R491101         
&NRSPQU  SETB  0                                               @R491101         
&QSESS   SETB  0                                               @R504800         
&QNOTE   SETB  0                                               @R504800         
&QALL    SETB  0                                               @R504800         
&MTS     SETB  0                                                   @F1A         
&NMTS    SETB  0                                                   @F1A         
&TERMQ   SETB  0                                                   @01A         
&PERSIQ  SETB  0                                                   @B1A         
&PERST   SETB  0                                                   @B1A         
&NPERST  SETB  0                                                   @B1A         
&RESTOR  SETB  0                                                   @B1A         
&PSTIME  SETB  0                                                   @B1A         
&CONDCS  SETB  0                                                   @W1A         
&CSSPEC  SETB  0                                                   @W1A         
&CONDCSS SETB  0                                                   @W1A         
&NQN     SETB  0                                                   @KFA         
&GNADD   SETB  0                                                   @I1A         
&GNDEL   SETB  0                                                   @I1A         
&GNSUB   SETB  0                                                   @D1A         
&SESNM   SETB  0                                                   @I1A         
&ENDAF   SETB  0                                                   @I1A         
&ENDFA   SETB  0                                                   @L1A         
&KPSRB   SETB  0                                                   @U4A         
&NKPSRB  SETB  0                                                   @U4A         
&STATUS  SETB  0                                                   @04A         
&MXSES   SETB  0                                                   @D1A         
&IDS3270 SETB  0                                                   @A2A         
.* *************** VTL ADDITIONS ****************                               
&KEEP    SETB  0                                                                
&TRUNC   SETB  0                                                                
&NIBTK   SETB  0                                                                
&FMHDR   SETB  0                                                                
&NFMHDR  SETB  0                                                                
&KEEP1      SETB  1                                                             
&TRUNC1     SETB  1                                                             
&NIBTK1     SETB  1                                                             
&FMHDR1     SETB  1                                                             
.* ************ END VTL ADDITIONS ***************                               
&BIT01      SETB  1                                                             
&CS1        SETB  1                                                             
&PASS1      SETB  1                                                             
&NERASE1    SETB  1                                                             
&EAU1       SETB  1                                                             
&ERASE1     SETB  1                                                             
&ANY1       SETB  1                                                             
&LBT1       SETB  1                                                             
&LBM1       SETB  1                                                             
&BLK1       SETB  1                                                             
&COND1      SETB  1                                                             
&UNCOND1    SETB  1                                                             
&LOCK1      SETB  1                                                             
&ACCEPT1    SETB  1                                                             
&ACQUIR1    SETB  1                                                             
&CONALL1    SETB  1                                                             
&CONANY1    SETB  1                                                             
&QUIESC1    SETB  1                                                             
&START1     SETB  1                                                             
&STOP1      SETB  1                                                             
&LGONMS1    SETB  1                                                             
&DEVCHR1    SETB  1                                                             
&TERMS1     SETB  1                                                             
&APSTAT1    SETB  1                                                             
&COUNTS1    SETB  1                                                             
&RNNAME1    SETB  1                                                             
&CIDXLT1    SETB  1                                                             
&TOPLGN1    SETB  1                                                             
&BSCID1     SETB  1                                                             
&DISPLY1    SETB  1                                                             
&SPARM1     SETB  1                                                             
&SKEY1      SETB  1                                          @XM30862           
&NQ1        SETB  1                                                             
&NRELRQ1    SETB  1                                                             
&PEND1      SETB  1                                                             
&ACTIVE1    SETB  1                                                             
&UNCNDL1    SETB  1                                                             
&NOTIFY1    SETB  1                                                             
&BUFLST1    SETB  1                                            @D5B4747         
&CNTCHN1    SETB  1                                            @D5B4747         
&LMPEO1     SETB  1                                            @D5B4747         
&USERRH1    SETB  1                                            @D5B4747         
&BACKUP1    SETB  1                                            @R489301         
&USRVAR1    SETB  1                                            @R489301         
&FORCED1    SETB  1                                            @R489301         
&SONCD1     SETB  1                                            @R491100         
&NSONCD1    SETB  1                                            @R491100         
&UNBIND1    SETB  1                                            @R491100         
&SENSE1     SETB  1                                            @R491100         
&NSENSE1    SETB  1                                            @R491100         
&HOLD1      SETB  1                                            @R491100         
&RSPQUE1    SETB  1                                            @R491101         
&NRSPQU1    SETB  1                                            @R491101         
&QSESS1     SETB  1                                            @R504800         
&QNOTE1     SETB  1                                            @R504800         
&QALL1      SETB  1                                            @R504800         
&MTS1       SETB  1                                                @F1A         
&TERMQ1     SETB  1                                                @01A         
&KPSRB1     SETB  1                                                @U4A         
&NKPSRB1    SETB  1                                                @U4A         
&STATUS1    SETB  1                                                @04A         
&CONDCS1    SETB  1                                                @W1A         
&MXSES1     SETB  1                                                @D1A         
&ACBRTN  SETA  8   DISPLACEMENT IN ACB OF THE ADDR OF THE INTERFACE RTN         
&OPT4X   SETC 'X''00'''             INITIALIZE OPT4X VALUE         @I1A         
         AIF   ('&SCANOPT' NE '').OPTSCAN  RECURSIVE CALL TO OPTSCAN?           
         AIF   ('&RPL' EQ '').NORPL  THIS IS AN ERROR CONDITION                 
.* ********************************************************************         
.*                        GETRPL SUBROUTINE                                     
.* GENERATES CODE TO LOAD THE ADDRESS OF THE RPL INTO REGISTER 1                
.* ********************************************************************         
.GETRPL  ANOP                                                                   
         AIF   ('&RPL'(1,1) NE '(').GEN1  THIS BR FOR NON REG FORM              
         AIF   ('&RPL' EQ '(1)').ENDRPL   NO LR INSTRUCTION NECESSARY           
&NAME    LR    1,&RPL(1)             PUT ADDRESS OF RPL IN REGISTER 1           
         CNOP  0,4                                                              
         AGO   .ENDRPL1                                                         
.GEN1    ANOP                                                                   
         CNOP  0,4                                                              
&NAME    LA    1,&RPL                PUT ADDRESS OF RPL IN REGISTER 1           
         AGO   .ENDRPL1                                                         
.ENDRPL  ANOP                                                                   
         CNOP  0,4                                                              
         AIF   ('&NAME' EQ '').ENDRPL1                                          
&NAME    EQU   *                                                                
.ENDRPL1 ANOP                                                                   
         AIF   ('&ACB' NE '' OR '&AREA' NE '' OR '&AREALEN' NE '').GEN          
         AIF   ('&ECB' NE '' OR '&AAREA' NE '' OR '&RECLEN' NE '').GEN          
         AIF   ('&ARG' NE '' OR '&OPTCD' NE '' OR '&AAREALN' NE '').GEN         
         AIF   ('&NIB' NE '' OR '&EXIT' NE '' OR '&CRYPT' NE '').GEN            
.*                                                           @D440518           
         AIF   ('&ARECLEN' NE '' OR '&BRANCH' NE '').GEN                        
         AIF   ('&SIGDATA' NE '' OR '&AREALEN' NE '').GEN                       
.* *************** VTL ADDITIONS ****************                               
         AIF   ('&RESPOND' NE '' OR '&CONTROL' NE '').GEN                       
         AIF   ('&CHNGDIR' NE '' OR '&SSENSEO' NE '').GEN                       
         AIF   ('&STYPE' NE '' OR '&RTYPE' NE '' ).GEN                          
         AIF   ('&IBSQAC' NE '' OR '&OBSQAC' NE '').GEN                         
         AIF   ('&POST' NE '' OR '&CHAIN' NE '').GEN                            
         AIF   ('&SEQNO' NE '' OR '&USENSEO' NE '').GEN                         
         AIF   ('&IBSQVAL' NE '' OR '&OBSQVAL' NE '').GEN                       
         AIF   ('&SSENSMO' NE '' OR '&BRACKET' NE '').GEN                       
         AIF   ('&THRDPTY' NE '' OR '&SONCODE' NE '').GEN                       
.* ************ END VTL ADDITIONS ***************                               
         AIF   ('&PSTIMER' NE '').GEN                              @B1A         
         AIF   ('&MAXSESS' NE '').GEN                              @R2A         
         AIF   ('&FORCETKO' NE '').GEN                             @R2A         
         AGO   .GENREQ                                                          
.* ********************************************************************         
.*                     MDFYRPL SUBROUTINE                                       
.* GENERATES CODE TO MODIFY RPL FIELDS AT EXECUTION TIME.  INVOKES THE          
.* FOLLOWING SUBROUTINES: MDFYOPT, GENMSK, MDFYRECD, AND THROUGH MDFY-          
.* RECD, MDFYRESP, MDFYCHN, MDFYCTRL, MDFYCDIR, MDFYSSNS, MDFYRTYP,             
.*                MDFYIBSQ, MDFYOBSQ, AND OPTSCAN.                              
.* ********************************************************************         
.GEN     ANOP                                                                   
         TM    &PLACTIV.(1),X'FF'     IS THE RPL ACTIVE?                        
         BO    IHB&SYSNDX            YES BR AROUND MODIFY CODE                  
.CKACB   ANOP                                                                   
         AIF   ('&ACB' EQ '').CKAREA IS THERE AN ACB PARAMETER?                 
         AIF   ('&ACB'(1,1) NE '(').GEN2  REGISTER NOTATION?                    
         ST    &ACB(1),&PLDACB.(1)   PUT ACB ADDRESS IN THE RPL                 
         AGO   .CKAREA                                                          
.GEN2    ANOP                                                                   
         LA    15,&ACB               GET ADDRESS OF NEW ACB                     
         ST 15,&PLDACB.(1)           AND PUT IT IN THE RPL                      
.CKAREA  ANOP                                                                   
         AIF   ('&AREA' EQ '').CKALEN  IS THERE AN AREA PARAMETER?              
         AIF   ('&AREA'(1,1) NE '(').GEN3  REGISTER NOTATION?                   
         ST    &AREA(1),&PLAREA.(1)  PUT ADDRESS OF AREA IN THE RPL             
         AGO   .CKALEN                                                          
.GEN3    ANOP                                                                   
         LA    15,&AREA              GET ADDRESS OF NEW AREA                    
         ST    15,&PLAREA.(1)         AND PUT IT IN THE RPL                     
.CKALEN  ANOP                                                                   
         AIF   ('&AREALEN' EQ '').CKRLEN  IS THERE AN AREA LENGTH PARM?         
         AIF   ('&AREALEN'(1,1) NE '(').GEN4  REGISTER NOTATION?                
         ST    &AREALEN(1),&PLBUFL.(1)     PUT AREA LENGTH IN THE RPL           
         AGO   .CKRLEN                                                          
.GEN4    ANOP                                                                   
         B     *+8                                                              
         DC    A(&AREALEN)                                                      
         L     15,*-4                GET NEW AREA LENGTH                        
         ST    15,&PLBUFL.(1)        AND PUT IT IN THE RPL                      
.CKRLEN  ANOP                                                                   
         AIF   ('&RECLEN' EQ '').CKAAR  IS THERE A RECORD LENGTH PARM?          
         AIF   ('&RECLEN'(1,1) NE '(').GEN5  REGISTER NOTATION?                 
         ST    &RECLEN(1),&PLRLEN.(1)  PUT NEW RECORD LENGTH IN THE RPL         
         AGO   .CKAAR                                                           
.GEN5    ANOP                                                                   
         B     *+8                                                              
         DC    A(&RECLEN)                                                       
         L     15,*-4                GET NEW RECORD LENGTH                      
         ST    15,&PLRLEN.(1)        AND PUT IT IN THE RPL                      
.CKAAR   ANOP                                                                   
         AIF   ('&AAREA' EQ '').CKAALN  IS THERE AN AAREA PARM?                 
         AIF   ('&AAREA'(1,1) NE '(').GEN6  REGISTER NOTATION?                  
         ST    &AAREA(1),&PLAAREA.(1)  PUT AAREA ADDRESS IN THE RPL             
         AGO   .CKAALN                                                          
.GEN6    ANOP                                                                   
         LA    15,&AAREA             GET ADDRESS OF AAREA                       
         ST    15,&PLAAREA.(1)       AND PUT IT IN THE RPL                      
.CKAALN  ANOP                                                                   
         AIF   ('&AAREALN' EQ '').CKARLN  IS THERE AN AAREALN PARM?             
         AIF   ('&AAREALN'(1,1) NE '(').GEN7  REGISTER NOTATION?                
         ST    &AAREALN(1),&PLAARLN.(1)   PUT AAREA LENGTH IN THE RPL           
         AGO   .CKARLN                                                          
.GEN7    ANOP                                                                   
         B     *+8                                                              
         DC    A(&AAREALN)                                                      
         L     15,*-4                GET NEW AAREA LENGTH                       
         ST    15,&PLAARLN.(1)       AND PUT IT IN THE RPL                      
.CKARLN  ANOP                                                                   
         AIF   ('&ARECLEN' EQ '').CKARG  IS THERE AN ARECORD LNG PARM?          
         AIF   ('&ARECLEN'(1,1) NE '(').GEN8  REGISTER NOTATION?                
         ST    &ARECLEN(1),&PLARCLN.(1)  PUT ARECORD LENGTH IN THE RPL          
         AGO   .CKARG                                                           
.GEN8    ANOP                                                                   
         B     *+8                                                              
         DC    A(&ARECLEN)                                                      
         L     15,*-4                GET NEW ARECORD LENGTH                     
         ST    15,&PLARCLN.(1)       AND PUT IT IN THE RPL                      
.CKARG   ANOP                                                                   
         AIF   ('&ARG' NE '' AND '&NIB' NE '').CKARGER  IS THERE AN ARG         
         AIF   ('&ARG' EQ '').CKNIB  IS THERE AN ARG PARAMETER?                 
         AIF   ('&ARG'(1,1) NE '(').GEN9  REGISTER NOTATION?                    
         ST    &ARG(1),&PLARG.(1)    PUT NEW ARGUMENT IN THE RPL                
         NI    &PLEXTDS.(1),X'FB'     SET NIB POINTER OFF                       
         AGO   .CKECB                                                           
.CKNIB   ANOP                                                                   
         AIF   ('&NIB' EQ '').CKECB  IS THERE AN NIB PARAMETER?                 
         AIF   ('&NIB'(1,1) NE '(').CKNIB1  REGISTER NOTATION?                  
         ST    &NIB(1),&PLARG.(1)    PUT NIB POINTER IN THE RPL                 
         OI    &PLEXTDS.(1),X'04'     SET NIB POINTER ON                        
         AGO   .CKECB                                                           
.CKNIB1  ANOP                                                                   
         LA    15,&NIB               GET NEW NIB POINTER                        
         ST    15,&PLARG.(1)         AND PUT IT IN THE RPL                      
         OI    &PLEXTDS.(1),X'04'     SET NIB POINTER ON                        
         AGO   .CKECB                                                           
.CKARGER ANOP                                                                   
  MNOTE 4,'PARAMETERS ARG AND NIB CONFLICT - BOTH DISREGARDED' @P011983         
         AGO   .CKECB                                                           
.GEN9    ANOP                                                                   
  MNOTE 4,'PARAMETER ARG DOES NOT REFLECT REGISTER NOTATION - IGNORED'          
.*                                                             @P011983         
.CKECB   ANOP                                                                   
         AIF   ('&ECB' NE '' AND '&EXIT' NE '').GEN10  BOTH SPECIFIED?          
         AIF   ('&ECB' NE '').ECBGEN  NO - IF ECB= WAS SPECIFIED, BR            
         AIF   ('&EXIT' EQ '').CKTHRDP  EXIT= SPECIFIED?  NO - BRANCH           
         AIF   ('&EXIT'(1,1) EQ '(').GEN10A  YES - REGISTER NOTATION?           
         LA    15,&EXIT              GET ADDRESS OF EXIT ROUTINE                
         ST    15,&PLECB.(1)         AND PUT IT IN THE RPL                      
         AGO   .FLGSETA                                                         
.GEN10A  ANOP                                                                   
         ST    &EXIT(1),&PLECB.(1)  PUT EXIT ROUTINE ADDRESS IN THE RPL         
.FLGSETA ANOP                                                                   
         NI    &PLOPTC1.(1),X'FE'        SET ECB FLAG OFF                       
         NI    &PLEXTDS.(1),X'BF'      SET NOEXIT BIT OFF                       
         OI    &PLEXTDS.(1),X'20'      SET EXIT BIT ON                          
         AGO   .CKTHRDP                                                         
.ECBGEN  ANOP                                                                   
         AIF   ('&ECB' EQ 'INTERNAL').FLGSETC    INTERNAL ECB SPECIFIED         
         AIF   ('&ECB'(1,1) EQ '(').GEN10B  REGISTER NOTATION? YES - BR         
         LA    15,&ECB               GET ADDRESS OF ECB                         
         ST    15,&PLECB.(1)         AND PUT IT IN THE RPL                      
         AGO   .FLGSETB                                                         
.GEN10B  ANOP                                                                   
         ST    &ECB(1),&PLECB.(1)    PUT NEW ECB ADDRESS IN THE RPL             
.FLGSETB ANOP                                                                   
         OI    &PLOPTC1.(1),X'01'        SET ECB FLAG ON                        
         OI    &PLEXTDS.(1),X'40'      SET NOEXIT BIT ON                        
         NI    &PLEXTDS.(1),X'DF'      SET EXIT BIT OFF                         
         AGO   .CKTHRDP                                                         
.GEN10   ANOP                                                                   
        MNOTE 4,'ECB AND EXIT MUTUALLY EXCLUSIVE; INTERNAL ECB ASSUMED'         
.FLGSETC ANOP                                                                   
         NI    &PLOPTC1.(1),X'FE'        SET ECB FLAG OFF                       
         OI    &PLEXTDS.(1),X'40'      SET NOEXIT BIT ON                        
         NI    &PLEXTDS.(1),X'DF'      SET EXIT BIT OFF                         
.* ********************************************************************         
.* CHECK FOR THRDPTY=NOTIFY!NONOTIFY                                            
.* ********************************************************************         
.CKTHRDP ANOP                                                  @G70AKMC         
         AIF   ('&THRDPTY' EQ '').THRDPND                      @G70AKMC         
         AIF   ('&THRDPTY' EQ 'NOTIFY').THRDP1                 @G70AKMC         
         AIF   ('&THRDPTY' EQ 'NONOTIFY').THRDP2               @G70AKMC         
         MNOTE 4,'THRDPTY=&THRDPTY IS NOT A VALID PARAMETER - IGNORED'          
.*                                                             @P011983         
         AGO   .THRDPND                                        @G70AKMC         
.THRDP1  ANOP                                                  @G70AKMC         
         AIF   ('&OPTCD' NE '').THRDP1A                        @G70AKMC         
         OI    &POPTCD2.(1),X'40'      SET THRDPTY BIT ON      @G70AKMC         
         AGO   .THRDPND                                        @G70AKMC         
.THRDP1A ANOP                                                  @G70AKMC         
&NOTIFY  SETB  1                                               @G70AKMC         
&NOTIFY1 SETB  0                                               @G70AKMC         
&MSK1CTR SETA  &MSK1CTR+1                                      @G70AKMC         
&MSK2CTR SETA  &MSK2CTR+1                                      @G70AKMC         
         AGO   .THRDPND                                        @G70AKMC         
.THRDP2  ANOP                                                  @G70AKMC         
         AIF   ('&OPTCD' NE '').THRDPND                        @G70AKMC         
         NI    &POPTCD2.(1),X'DF'      SET THRDPTY BIT OFF     @G70AKMC         
.THRDPND ANOP                                                  @G70AKMC         
.* ********************************************************************         
.* CHECK FOR SONCODE=CODE                                                       
.* ********************************************************************         
         AIF   ('&SONCODE' EQ '').SONEND                       @R491100         
         MVI   &SCODE.(1),&SONCODE     SET RPL SONCODE         @R491100         
.SONEND  ANOP                                                  @R491100         
.* ********************************************************************         
.* CHECK FOR PSTIMER=VALUE WITHOUT OPTCD                                        
.* (IF ANY OPTCD IS SPECIFIED, PSTIMER IS CHECKED AGAINST OPTCDS LATER)         
.* ********************************************************************         
         AIF   (('&OPTCD' NE '') OR ('&PSTIMER' EQ '')).PSTMND     @T1A         
         MNOTE 4,'PARMS=PSTIMER CAN ONLY BE SPECIFIED WITH OPTCD=PERSIS*        
               T - PSTIMER IGNORED'                                @T1A         
.PSTMND  ANOP                                                      @T1A         
.* ********************************************************************         
.* CHECK FOR MAXSESS=VALUE WITHOUT OPTCD                                        
.* (IF ANY OPTCD IS SPECIFIED, MAXSESS IS CHECKED AGAINST OPTCDS LATER)         
.*                                                                 @D1A         
.* ********************************************************************         
         AIF   (('&OPTCD' NE '') OR ('&MAXSESS' EQ '')).MXSSEND    @D1A         
         MNOTE 4,'PARMS=MAXSESS CAN ONLY BE SPECIFIED WITH OPTCD=GNAMEA*        
               DD - MAXSESS IGNORED'                               @D1A         
.MXSSEND ANOP                                                      @D1A         
.* ********************************************************************         
.* CHECK FOR FORCETKO=VALUE WITHOUT OPTCD                                       
.* (IF ANY OPTCD IS CODED, FORCETKO IS CHECKED AGAINST OPTCDS LATER)            
.* ********************************************************************         
         AIF   (('&OPTCD' NE '') OR ('&FORCETKO' EQ '')).FTOMND    @R2A         
         MNOTE 4,'PARMS=FORCETKO CAN ONLY BE SPECIFIED WITH OPTCD=PERSI*        
               ST - FORCETKO IGNORED'                              @R2A         
.FTOMND  ANOP                                                      @R2A         
.* ********************************************************************         
.*                       MDFYOPT SUBROUTINE                                     
.* VALIDITY CHECKS OPTCD OPTIONS AND SETS SWITCHES IN A MASK.  INVOKES          
.* GENMASK TO GENERATE CODE IF REQUIRED.  ISSUES MNOTES FOR INVALID             
.*                   OPTIONS THAT ARE SPECIFIED.                                
.* ********************************************************************         
.CKOPTCD ANOP                                                                   
         AIF   ('&OPTCD' EQ '').CKSEQNO                                         
&NUM     SETA N'&OPTCD                                                          
.SETOPT   ANOP                                                                  
&LEN     SETA K'&OPTCD(&NUM)                                                    
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'N').NOPTS                                
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'C').COPTS                                
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'E').EOPTS                                
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'A').AOPTS                                
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'B').BOPTS               @R489301         
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'U').UOPTS               @R489301         
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'F').FOPTS               @R489301         
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'H').HOPTS               @R491100         
         AIF  ('&OPTCD(&NUM)'(1,1) NE 'S').XOPTS                                
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'SPEC').SOPTS1                          
&SPEC    SETB 1                                                                 
&ANY1    SETB 0                                                                 
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.SOPTS1  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SYN').SOPTS2                          
&SYN     SETA 1                                                                 
         AGO  .GETNEXT                                                          
.SOPTS2  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSION').SOPTS3                      
&SESSION SETB 1                                                                 
&PEND1   SETB 0                                                                 
&ACTIVE1 SETB 0                                                                 
&UNCNDL1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.SOPTS3  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'START').SOPTS4                        
&START   SETB 1                                                                 
&CNTSTL  SETA &CNTSTL+1                                            @B1A         
         AGO  .GETNEXT                                                          
.SOPTS4  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'STOP').SOPTS5                         
&STOP    SETB 1                                                                 
&CNTSTL  SETA &CNTSTL+1                                            @B1A         
         AGO  .GETNEXT                                                          
.SOPTS5  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSPARM').SOPTS6                     
&SPARM   SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.SOPTS6  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSKEY').SOPTS7                      
&SKEY    SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                      @XM30862           
         AGO  .GETNEXT                                                          
.SOPTS7  ANOP                                                @R491100           
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SONCODE').SOPTS8   @R491100           
&SONCD   SETB 1                                              @R491100           
&SONCD1  SETB 0                                              @R491100           
&NSONCD1 SETB 0                                              @R491100           
&MSK3CTR SETA  &MSK3CTR+1                                    @R491100           
&MSK4CTR SETA  &MSK4CTR+1                                    @R491100           
         AGO  .GETNEXT                                       @R491100           
.SOPTS8  ANOP                                                @R491100           
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SENSE').SOPTS9     @R491100           
&SENSE   SETB 1                                              @R491100           
&SENSE1  SETB 0                                              @R491100           
&NSENSE1 SETB 0                                              @R491100           
&MSK3CTR SETA  &MSK3CTR+1                                    @R491100           
&MSK4CTR SETA  &MSK4CTR+1                                    @R491100           
         AGO  .GETNEXT                                       @R491100           
.SOPTS9  ANOP                                                @R491100           
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSNAME').SOPTS9A       @I1A         
&SESNM   SETB 1                                                    @I1A         
&OPT4X   SETC 'X''21'''             RPLIQSNM VALUE                 @U3C         
&CNTINQ  SETA &CNTINQ+1                                            @I1A         
         AGO  .GETNEXT                                             @I1A         
.SOPTS9A ANOP                                                      @I1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'STATUS').SOPTS10         @04A         
&STATUS  SETB 1                                                    @04A         
&CNTINQ  SETA &CNTINQ+1                                            @04A         
         AGO  .GETNEXT                                             @04A         
.SOPTS10 ANOP                                                      @04A         
         AGO  .INVLDOP                                                          
.XOPTS   ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNCONDL').XOPTS1A                     
&UNCONDL SETB 1                                                                 
&PEND1   SETB 0                                                                 
&ACTIVE1 SETB 0                                                                 
&UNCNDL1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTS1A ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNCOND').XOPTS1B     @D5B4747         
&UNCOND  SETB 1                                                                 
&UNCOND1 SETB 0                                                                 
&COND1   SETB 0                                                                 
&LOCK1   SETB 0                                                                 
&UNBIND1 SETB 0                                                @R491100         
&TERMQ1  SETB 0                                                    @01A         
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100         
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100         
         AGO  .GETNEXT                                                          
.XOPTS1B ANOP                                                  @D5B4747         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'USERRH').XOPTS1      @D5B4747         
&USERRH  SETB 1                                                @D5B4747         
&USERRH1 SETB 0                                                @D5B4747         
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747         
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747         
         AGO  .GETNEXT                                         @D5B4747         
.XOPTS1  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PEND').XOPTS2                         
&PEND    SETB 1                                                                 
&PEND1   SETB 0                                                                 
&ACTIVE1 SETB 0                                                                 
&UNCNDL1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTS2  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PASS').XOPTS3                         
&PASS    SETB 1                                                                 
&PASS1   SETB 0                                                                 
&TERMQ1  SETB 0                                                    @01A         
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
&MSK4CTR SETA  &MSK4CTR+1                                          @01A         
         AGO  .GETNEXT                                                          
.XOPTS3  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LOCK').XOPTS4                         
&LOCK    SETB 1                                                                 
&LOCK1   SETB 0                                                                 
&COND1   SETB 0                                                                 
&UNCOND1 SETB 0                                                                 
&UNBIND1 SETB 0                                                @R491100         
&TERMQ1  SETB 0                                                    @01A         
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100         
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100         
         AGO  .GETNEXT                                                          
.XOPTS4  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QUIESCE').XOPTS5                      
&QUIESCE SETB 1                                                                 
&CNTSTL  SETA &CNTSTL+1                                            @B1A         
         AGO  .GETNEXT                                                          
.XOPTS5  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'Q').XOPTS6A          @R504800         
&Q       SETB 1                                                                 
&NQ1     SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTS6A ANOP                                                  @R504800         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QALL').XOPTS6B       @R504800         
&QALL    SETB 1                                                @R504800         
&QSESS1  SETB 0                                                @R504800         
&QNOTE1  SETB 0                                                @R504800         
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800         
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800         
         AGO  .GETNEXT                                         @R504800         
.XOPTS6B ANOP                                                  @R504800         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QSESSLIM').XOPTS6C   @R504800         
&QSESS   SETB 1                                                @R504800         
&QALL1   SETB 0                                                @R504800         
&QNOTE1  SETB 0                                                @R504800         
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800         
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800         
         AGO  .GETNEXT                                         @R504800         
.XOPTS6C ANOP                                                  @R504800         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QNOTENAB').XOPTS6D   @R504800         
&QNOTE   SETB 1                                                @R504800         
&QALL1   SETB 0                                                @R504800         
&QSESS1  SETB 0                                                @R504800         
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800         
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800         
         AGO  .GETNEXT                                         @R504800         
.XOPTS6D ANOP                                                  @R504800         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RELRQ').XOPTS7                        
&RELRQ  SETB 1                                                                  
&NRELRQ1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTS7  ANOP                                                                   
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'RELEASE').XOPTS8                       
&RELEASE   SETB 1                                                               
&MSK2CTR SETA  &MSK2CTR+1                                                       
&PASS1   SETB 0                                                                 
&TERMQ1  SETB 0                                                    @01A         
&MSK4CTR SETA  &MSK4CTR+1                                          @01A         
         AGO  .GETNEXT                                                          
.XOPTS8  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BLK').XOPTS9                          
&BLK     SETB 1                                                                 
&BLK1    SETB 0                                                                 
&LBT1    SETB 0                                                                 
&LBM1    SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTS9  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LBM').COPTSA                          
&LBM     SETB 1                                                                 
&LBM1    SETB 0                                                                 
&LBT1    SETB 0                                                                 
&BLK1    SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.COPTSA  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LBT').XOPTSB                          
&LBT     SETB 1                                                                 
&LBT1    SETB 0                                                                 
&LBM1    SETB 0                                                                 
&BLK1    SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTSB  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LOGONMSG').XOPTSD                     
&LGONMSG SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.XOPTSD  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'DEVCHAR').XOPTSE                      
&DEVCHAR SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.XOPTSE  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TERMS').XOPTSF                        
&TERMS   SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.XOPTSF  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RNNAME').XOPTSG                       
&RNNAME  SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.XOPTSG  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TOPLOGON').XOPTSH                     
&TOPLGON SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.XOPTSH  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BSCID').XOPTSI                        
&BSCID   SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.XOPTSI  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'DISPLAY').XOPTSJ                      
&DISPLAY SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.XOPTSJ  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BUFFLST').XOPTSJ1    @D5B4747         
&BUFFLST SETB 1                                                @D5B4747         
&BUFLST1 SETB 0                                                @D5B4747         
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747         
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747         
         AGO  .GETNEXT                                         @D5B4747         
.XOPTSJ1 ANOP                                                  @D5B4747         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LMPEO').XOPTSJ3      @D5B4747         
&LMPEO   SETB 1                                                @D5B4747         
&LMPEO1  SETB 0                                                @D5B4747         
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747         
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747         
         AGO  .GETNEXT                                         @D5B4747         
.XOPTSJ3 ANOP                                                  @D5B4747         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'KEEPSRB').XOPTSK         @U4A         
&KPSRB   SETB 1                                                    @U4A         
&KPSRB1  SETB 0                                                    @U4A         
&NKPSRB1 SETB 0                                                    @U4A         
&MSK3CTR SETA  &MSK3CTR+1                                          @U4A         
&MSK4CTR SETA  &MSK4CTR+1                                          @U4A         
         AGO  .GETNEXT                                             @U4A         
.XOPTSK  ANOP                                                      @U4A         
.* *************** VTL ADDITIONS ****************                               
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'KEEP').XOPTSL                         
&KEEP    SETB 1                                                                 
&KEEP1   SETB 0                                                                 
&TRUNC1  SETB 0                                                                 
&NIBTK1  SETB 0                                                                 
&MSK3CTR SETA  &MSK3CTR+1                                                       
&MSK4CTR SETA  &MSK4CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTSL  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TRUNC').XOPTSM                        
&TRUNC   SETB 1                                                                 
&TRUNC1  SETB 0                                                                 
&NIBTK1  SETB 0                                                                 
&KEEP1   SETB 0                                                                 
&MSK3CTR SETA  &MSK3CTR+1                                                       
&MSK4CTR SETA  &MSK4CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTSM  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'FMHDR').XOPTSN                        
&FMHDR   SETB 1                                                                 
&FMHDR1  SETB 0                                                                 
&NFMHDR  SETB 0                                                                 
&MSK3CTR SETA  &MSK3CTR+1                                                       
&MSK4CTR SETA  &MSK4CTR+1                                                       
         AGO  .GETNEXT                                                          
.XOPTSN  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RSPQUED').XOPTSO     @R491101         
&RSPQUE  SETB 1                                                @R491101         
&NRSPQU1 SETB 0                                                @R491101         
&RSPQUE1 SETB 0                                                @R491101         
&MSK3CTR SETA  &MSK3CTR+1                                      @R491101         
&MSK4CTR SETA  &MSK4CTR+1                                      @R491101         
         AGO  .GETNEXT                                         @R491101         
.XOPTSO  ANOP                                                  @R491101         
.* ************ END VTL ADDITIONS ***************                               
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'MTS').XOPTSP             @F1A         
&MTS     SETB 1                                                    @F1A         
&MSK3CTR SETA  &MSK3CTR+1                                          @F1A         
         AGO  .GETNEXT                                             @F1A         
.XOPTSP  ANOP                                                      @F1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PERSIST').XOPTSQ         @B1A         
&PERST   SETB 1                                                    @B1A         
&OPT4X   SETC 'X''80'''             RPLPERS  VALUE                 @U3C         
&CNTSTL  SETA &CNTSTL+1                                            @B1A         
         AGO  .GETNEXT                                             @B1A         
.XOPTSQ  ANOP                                                      @B1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PERSESS').XOPTSR         @B1A         
&PERSIQ  SETB 1                                                    @B1A         
&OPT4X   SETC 'X''20'''             RPLINQPS VALUE                 @U3C         
&CNTINQ  SETA &CNTINQ+1                                            @B1A         
         AGO  .GETNEXT                                             @B1A         
.XOPTSR  ANOP                                                      @B1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RESTORE').XOPTSS         @B1A         
&OPT4X   SETC 'X''10'''             RPLOPRES VALUE                 @U3C         
&RESTOR  SETB 1                                                    @B1A         
&ACCEPT1 SETB 0                                                    @B1A         
&ACQUIR1 SETB 0                                                    @B1A         
&MSK1CTR SETA  &MSK1CTR+1                                          @B1A         
&MSK2CTR SETA  &MSK2CTR+1                                          @B1A         
         AGO  .GETNEXT                                             @B1A         
.XOPTSS  ANOP                                                      @B1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TERMQ').XOPTST           @01A         
&TERMQ   SETB 1                                                    @01A         
&TERMQ1  SETB 0                                                    @01A         
&LOCK1   SETB 0                                                    @01A         
&COND1   SETB 0                                                    @01A         
&UNCOND1 SETB 0                                                    @01A         
&UNBIND1 SETB 0                                                    @01A         
&PASS1   SETB 0                                                    @01A         
&MSK2CTR SETA  &MSK2CTR+1                                          @01A         
&MSK3CTR SETA  &MSK3CTR+1                                          @01A         
&MSK4CTR SETA  &MSK4CTR+1                                          @01A         
         AGO  .GETNEXT                                             @01A         
.XOPTST  ANOP                                                      @01A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'GNAMEADD').XOPTSU        @I1A         
&GNADD   SETB 1                                                    @I1A         
&OPT4X   SETC 'X''01'''             RPLSTGNA VALUE                 @U3C         
&CNTSTL  SETA &CNTSTL+1                                            @I1A         
         AGO  .GETNEXT                                             @I1A         
.XOPTSU  ANOP                                                      @I1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'GNAMEDEL').XOPTSTS  @I1A @D1C         
&GNDEL   SETB 1                                                    @I1A         
&OPT4X   SETC 'X''03'''             RPLSTGND VALUE                 @U3C         
&CNTSTL  SETA &CNTSTL+1                                            @I1A         
         AGO  .GETNEXT                                             @I1A         
.XOPTSTS ANOP                                                      @D1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'GNAMESUB').XOPTSV        @D1A         
&GNSUB   SETB 1                                                    @D1A         
&OPT4X   SETC 'X''05'''             RPLSTGNS VALUE                 @D1A         
&CNTSTL  SETA &CNTSTL+1                                            @D1A         
         AGO  .GETNEXT                                             @D1A         
.XOPTSV  ANOP                                                      @I1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'IDS3270').XOPTSW         @A2A         
&IDS3270 SETB 1                                                    @A2A         
         AGO  .GETNEXT                                             @A2A         
.XOPTSW  ANOP                                                      @A2A         
.*                                                                              
.INVLDOP ANOP                                                                   
     MNOTE 4,'OPTCD=&OPTCD(&NUM) IS NOT A VALID PARAMETER - IGNORED '           
.*                                                             @P011983         
         AGO .GETNEXT                                                           
.NOPTS   ANOP                                                                   
.* *************** VTL ADDITIONS ****************                               
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NIBTK').NOPTS2                        
&NIBTK   SETB 1                                                                 
&NIBTK1  SETB 0                                                                 
&KEEP1   SETB 0                                                                 
&TRUNC1  SETB 0                                                                 
&MSK3CTR SETA  &MSK3CTR+1                                                       
&MSK4CTR SETA  &MSK4CTR+1                                                       
         AGO  .GETNEXT                                                          
.NOPTS2  ANOP                                                                   
.* ************ END VTL ADDITIONS ***************                               
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NERASE').NOPTS3                       
&NERASE  SETB 1                                                                 
&NERASE1 SETB 0                                                                 
&EAU1    SETB 0                                                                 
&ERASE1  SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.NOPTS3  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NCONV').NOPTS41      @D5B4747         
.* *** NCONV NO LONGER SUPPORTED, IGNORED ***                      @W1C         
         AGO  .GETNEXT                                                          
.NOPTS41 ANOP                                                  @D5B4747         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NBUFFLST').NOPTS43   @D5B4747         
&NBUFLST SETB 1                                                @D5B4747         
&BUFLST1 SETB 0                                                @D5B4747         
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747         
         AGO  .GETNEXT                                         @D5B4747         
.NOPTS43 ANOP                                                  @D5B4747         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NKEEPSRB').NOPTS44       @U4A         
&NKPSRB  SETB 1                                                    @U4A         
&NKPSRB1 SETB 0                                                    @U4A         
&KPSRB1  SETB 0                                                    @U4A         
&MSK3CTR SETA  &MSK3CTR+1                                          @U4A         
&MSK4CTR SETA  &MSK4CTR+1                                          @U4A         
         AGO  .GETNEXT                                             @U4A         
.NOPTS44 ANOP                                                      @U4A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NCONTCHN').NOPTS45   @D5B4747         
&NCNTCHN SETB 1                                                @D5B4747         
&CNTCHN1 SETB 0                                                @D5B4747         
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747         
         AGO  .GETNEXT                                         @D5B4747         
.NOPTS45 ANOP                                                  @D5B4747         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NLMPEO').NOPTS46     @D5B4747         
&NLMPEO  SETB 1                                                @D5B4747         
&LMPEO1  SETB 0                                                @D5B4747         
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747         
         AGO  .GETNEXT                                         @D5B4747         
.NOPTS46 ANOP                                                  @P5B8733         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NUSERRH').NOPTS47    @D5B4747         
&NUSERRH SETB 1                                                @D5B4747         
&USERRH1 SETB 0                                                @D5B4747         
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747         
         AGO  .GETNEXT                                         @D5B4747         
.NOPTS47 ANOP                                                  @D5B4747         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NBACKUP').NOPTS48    @R489301         
&NBACKUP SETB 1                                                @R489301         
&BACKUP1 SETB 0                                                @R489301         
&MSK1CTR SETA  &MSK1CTR+1                                      @P015113         
&MSK2CTR SETA  &MSK2CTR+1                                      @P015113         
         AGO  .GETNEXT                                         @R489301         
.NOPTS48 ANOP                                                  @R489301         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NSONCODE').NOPTS49   @R491100         
&NSONCD  SETB 1                                                @R491100         
&NSONCD1 SETB 0                                                @R491100         
&SONCD1  SETB 0                                                @R491100         
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100         
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100         
         AGO  .GETNEXT                                         @R491100         
.NOPTS49 ANOP                                                  @R491100         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NSENSE').NOPTS50     @R491100         
&NSENSE  SETB 1                                                @R491100         
&NSENSE1 SETB 0                                                @R491100         
&SENSE1  SETB 0                                                @R491100         
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100         
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100         
         AGO  .GETNEXT                                         @R491100         
.NOPTS50 ANOP                                                  @R491100         
.* *************** VTL ADDITIONS ****************                               
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NFMHDR').NOPTS5                       
&NFMHDR  SETB 1                                                                 
&FMHDR1  SETB 0                                                                 
&MSK4CTR SETA  &MSK4CTR+1                                                       
         AGO  .GETNEXT                                                          
.NOPTS5  ANOP                                                                   
.* *********** END VTL ADDITIONS ****************                               
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NQ').NOPTS6                           
&NQ      SETB 1                                                                 
&NQ1     SETB 0                                                                 
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.NOPTS6  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NRELRQ').NOPTS8                       
&NRELRQ SETB 1                                                                  
&NRELRQ1 SETB 0                                                                 
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.NOPTS8  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NRSPQUED').NOPTS51   @R491101         
&NRSPQU  SETB 1                                                @R491101         
&NRSPQU1 SETB 0                                                @R491101         
&RSPQUE1 SETB 0                                                @R491101         
&MSK3CTR SETA  &MSK3CTR+1                                      @R491101         
&MSK4CTR SETA  &MSK4CTR+1                                      @R491101         
         AGO  .GETNEXT                                         @R491101         
.NOPTS51 ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NMTS').NOPTS52           @F1A         
&NMTS    SETB 1                                                    @F1A         
&MTS1    SETB 0                                                    @F1A         
&MSK4CTR SETA  &MSK4CTR+1                                          @F1A         
         AGO  .GETNEXT                                             @F1A         
.NOPTS52 ANOP                                                      @F1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NPERSIST').NOPTS53       @B1A         
&NPERST  SETB 1                                                    @B1A         
&OPT4X   SETC 'X''40'''             RPLNPERS VALUE                 @U3C         
&CNTSTL  SETA &CNTSTL+1                                            @B1A         
         AGO  .GETNEXT                                             @B1A         
.NOPTS53 ANOP                                                      @B1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NQN').NOPTS54            @KFA         
&NQN     SETB 1                                                    @KFA         
&OPT4X   SETC 'X''04'''             RPLNQN   VALUE                 @U3C         
&CNTINQ  SETA &CNTINQ+1                                            @KFA         
         AGO  .GETNEXT                                             @KFA         
.NOPTS54 ANOP                                                      @KFC         
         AGO  .INVLDOP                                                          
.COPTS   ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CS').COPTS2                           
&CSSPEC  SETB 1                                                    @W1A         
&CS      SETB 1                                                                 
&CS1     SETB 0                                                                 
&CONDCS1 SETB 0                                                    @W1A         
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.COPTS2  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'COND').COPTS3                         
&COND    SETB 1                                                                 
&COND1   SETB 0                                                                 
&LOCK1   SETB 0                                                                 
&UNCOND1  SETB 0                                                                
&UNBIND1  SETB 0                                               @R491100         
&TERMQ1  SETB 0                                                    @01A         
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100         
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100         
         AGO  .GETNEXT                                                          
.COPTS3  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONV').COPTS4                         
.* *** CONV NO LONGER SUPPORTED, IGNORED ***                       @W1C         
         AGO  .GETNEXT                                                          
.COPTS4  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONALL').COPTS5                       
&CONALL  SETB 1                                                                 
&CONALL1 SETB 0                                                                 
&CONANY1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.COPTS5  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONANY').COPTS6                       
&CONANY  SETB 1                                                                 
&CONANY1 SETB 0                                                                 
&CONALL1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.COPTS6  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CA').COPTS7                           
&CA      SETB 1                                                                 
&CS1     SETB 0                                                                 
&CONDCS1 SETB 0                                                    @W1A         
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.COPTS7  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'COUNTS').COPTS8                       
&COUNTS  SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.COPTS8  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CIDXLATE').COPTS9                     
&CIDXLAT SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.COPTS9  ANOP                                                  @R489301         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONTCHN').COPTS10        @W1C         
&CONTCHN SETB 1                                                @D5B4747         
&CNTCHN1 SETB 0                                                @D5B4747         
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747         
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747         
         AGO  .GETNEXT                                         @D5B4747         
.COPTS10 ANOP                                                      @W1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONDCS').XOPTS           @W1A         
&CONDCSS SETB 1                                                    @W1A         
&CONDCS  SETB 1                                                    @W1A         
&CONDCS1 SETB 0                                                    @W1A         
&CS      SETB 1                                                    @W1A         
&CS1     SETB 0                                                    @W1A         
&MSK1CTR SETA &MSK1CTR+1                                           @W1A         
&MSK2CTR SETA &MSK2CTR+1                                           @W1A         
         AGO  .GETNEXT                                             @W1A         
.BOPTS   ANOP                                                  @R489301         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BACKUP').XOPTS       @R489301         
&BACKUP  SETB 1                                                @R489301         
&BACKUP1 SETB 0                                                @R489301         
&MSK1CTR SETA  &MSK1CTR+1                                      @R489301         
&MSK2CTR SETA  &MSK2CTR+1                                      @R489301         
         AGO  .GETNEXT                                         @R489301         
.UOPTS   ANOP                                                  @R489301         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'USERVAR').UOPTS1     @R489301         
&USERVAR SETB 1                                                @R489301         
&CNTINQ  SETA  &CNTINQ+1                                       @R489301         
         AGO  .GETNEXT                                         @R489301         
.UOPTS1  ANOP                                                  @R489301         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNBIND').XOPTS       @R491100         
&UNBIND  SETB 1                                                @R491100         
&UNBIND1 SETB 0                                                @R491100         
&COND1   SETB 0                                                @R491100         
&LOCK1   SETB 0                                                @R491100         
&UNCOND1 SETB 0                                                @R491100         
&TERMQ1  SETB 0                                                    @01A         
&MSK1CTR SETA  &MSK1CTR+1                                      @R491100         
&MSK2CTR SETA  &MSK2CTR+1                                      @R491100         
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100         
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100         
         AGO  .GETNEXT                                         @R491100         
.FOPTS   ANOP                                                  @R489301         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'FORCED').XOPTS       @R489301         
&FORCED  SETB 1                                                @R489301         
&FORCED1 SETB 0                                                @R489301         
&MSK3CTR SETA  &MSK3CTR+1                                      @R489301         
&MSK4CTR SETA  &MSK4CTR+1                                      @R489301         
         AGO  .GETNEXT                                         @R489301         
.HOPTS   ANOP                                                  @R489301         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'HOLD').XOPTS         @R491100         
&HOLD    SETB 1                                                @R491100         
&CNTSTL  SETA &CNTSTL+1                                            @B1A         
         AGO  .GETNEXT                                         @R491100         
.EOPTS   ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ENDAFFIN').EOPTS1        @L1C         
&ENDAF   SETB 1                                                    @I1A         
&MSK1CTR SETA  &MSK1CTR+1                                          @I1A         
&MSK2CTR SETA  &MSK2CTR+1                                          @I1A         
&OPT4X   SETC 'X''41'''             RPLCGEAF VALUE                 @U3C         
         AGO  .GETNEXT                                             @I1A         
.EOPTS1  ANOP                                                      @L1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ENDAFFNF').EOPTS2        @L1A         
&ENDFA   SETB 1                                                    @L1A         
&MSK1CTR SETA  &MSK1CTR+1                                          @L1A         
&MSK2CTR SETA  &MSK2CTR+1                                          @L1A         
&OPT4X   SETC 'X''43'''             RPLCGEF  VALUE                 @L1A         
         AGO  .GETNEXT                                             @L1A         
.EOPTS2  ANOP                                                      @I1A         
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'EAU').EOPTS3                          
&EAU     SETB 1                                                                 
&EAU1    SETB 0                                                                 
&ERASE1  SETB 0                                                                 
&NERASE1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.EOPTS3  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ERASE').EOPTS4                        
&ERASE   SETB 1                                                                 
&ERASE1  SETB 0                                                                 
&EAU1    SETB 0                                                                 
&NERASE1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.EOPTS4  ANOP                                                                   
         AGO  .INVLDOP                                                          
.AOPTS   ANOP                                                                   
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'ANY').AOPTS1                           
&ANY     SETB 1                                                                 
&ANY1    SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.AOPTS1  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACCEPT').AOPTS2                       
&ACCEPT  SETB 1                                                                 
&ACCEPT1 SETB 0                                                                 
&ACQUIR1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.AOPTS2  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACQUIRE').AOPTS3                      
&ACQUIRE SETB 1                                                                 
&ACCEPT1 SETB 0                                                                 
&ACQUIR1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.AOPTS3  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ASY').AOPTS4                          
&ASY     SETA 1                                                                 
         AGO  .GETNEXT                                                          
.AOPTS4  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACTIVE').AOPTS5                       
&ACTIVE  SETB 1                                                                 
&PEND1   SETB 0                                                                 
&ACTIVE1 SETB 0                                                                 
&UNCNDL1 SETB 0                                                                 
&MSK1CTR SETA  &MSK1CTR+1                                                       
&MSK2CTR SETA  &MSK2CTR+1                                                       
         AGO  .GETNEXT                                                          
.AOPTS5  ANOP                                                                   
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'APPSTAT').AOPTS6                      
&APPSTAT SETB 1                                                                 
&CNTINQ  SETA &CNTINQ+1                                                         
         AGO  .GETNEXT                                                          
.AOPTS6  ANOP                                                                   
         AGO  .INVLDOP                                                          
.GETNEXT ANOP                                                                   
&NUM     SETA  &NUM-1                                                           
         AIF   ('&NUM' NE '0').SETOPT                                           
.* ********************************************************************         
.*                      GENMSK SUBROUTINE                                       
.* CHECKS FOR MUTUALLY EXCLUSIVE OPTIONS (OF OPTCD) AND GENERATES CODE          
.* TO MODIFY THE OPTION BYTES IN THE RPL.  ISSUES MNOTES FOR MUTUALLY           
.*                       EXCLUSIVE OPTIONS.                                     
.* ********************************************************************         
.GENMSK  ANOP                                                                   
.* ********************************************************************         
.* CHECK FOR PSTIMER=VALUE AND FORCETKO=VALUE            @B1A @T1M @R1C         
.* ********************************************************************         
         AIF   ('&PSTIMER' EQ '').PSTIMND  PSTIMER SPECIFIED? @B1A @T1M         
         AIF   (NOT(&PERST)).PSTMERR   OPTCD=PERSIST NOT SET?      @T1A         
&PSTIME  SETB  1                                              @B1A @T1M         
&MXSES1  SETB  0                                              @D1A @R1C         
&OPT4X   SETC 'X''88'''             RPLPERS VALUE + RPLSLTMR       @U3C         
&MSK2CTR SETA  &MSK2CTR+1                                          @D1A         
&MSK3CTR SETA  &MSK3CTR+1                                          @T1A         
&MSK4CTR SETA  &MSK4CTR+1                                          @T1A         
         AIF   ('&PSTIMER'(1,1) NE '(').TVAL  REG NOTATION?   @B1A @T1M         
         ST    &PSTIMER(1),&PLUSFLD.(1)  PUT TIMER VALUE IN RPL                 
.*                                                            @B1A @T1M         
         AGO   .PSFT                                     @B1A @T1M @R1C         
.PSTMERR ANOP                                                      @T1A         
         MNOTE 4,'PARMS=PSTIMER CAN ONLY BE SPECIFIED WITH OPTCD=PERSIS*        
               T - PSTIMER IGNORED'                                @T1A         
         AGO   .PSTIMND                                            @T1A         
.TVAL    ANOP                          CONSTANT SPECIFIED     @B1A @T1M         
         B     *+8                                            @B1A @T1M         
         DC    A(&PSTIMER)                                    @B1A @T1M         
         L     15,*-4                                         @B1A @T1M         
         ST    15,&PLUSFLD.(1)         PUT TIMER VALUE IN RPL @B1A @T1M         
.*                                                                 @R1A         
.* Check for FORCETKO coded with PSTIMER                           @R1A         
.PSFT    ANOP                      CHECK FORCETKO ENCODING         @R1A         
         AIF   ('&FORCETKO' EQ '').PSFTCM2  FORCETKO CODED?        @R1A         
         AIF   ('&FORCETKO' EQ 'ALL').PSFTA     FORCETKO=ALL?      @R1A         
         AIF   ('&FORCETKO' EQ 'NONE').PSFTN    FORCETKO=NONE?     @R1A         
         AIF   ('&FORCETKO' EQ 'SINGLE').PSFTS  FORCETKO=SINGLE?   @R1A         
         AIF   ('&FORCETKO' EQ 'MULTI').PSFTM   FORCETKO=MULTI?    @R1A         
         MNOTE 4,'FORCETKO MUST BE ALL, NONE, MULTI, OR SINGLE'    @R1A         
         AGO   .PSFTOND                                            @R1A         
.PSFTA   ANOP                                                      @R1A         
&OPT4X   SETC 'X''89'''            PERSIST+PSTIMER+FORCETKO=ALL    @R1A         
         AGO   .PSFTCMN                                            @R1A         
.PSFTN   ANOP                                                      @R1A         
&OPT4X   SETC 'X''8B'''            PERSIST+PSTIMER+FORCETKO=NONE   @R1A         
         AGO   .PSFTCMN                                            @R1A         
.PSFTS   ANOP                                                      @R1A         
&OPT4X   SETC 'X''8D'''            PERSIST+PSTIMER+FORCETKO=SINGLE @R1A         
         AGO   .PSFTCMN                                            @R1A         
.PSFTM   ANOP                                                      @R1A         
&OPT4X   SETC 'X''8F'''            PERSIST+PSTIMER+FORCETKO=MULTI  @R1A         
.PSFTCMN ANOP                                                      @R1A         
&FRCTKO  SETB  1                                                   @R1A         
.PSFTCM2 ANOP                      Set appropriate counters        @R1A         
         AGO   .PSFTOND            DONE WITH THESE PARMS           @R1A         
.*                                                                 @R1A         
.* No PSTIMER code, but still check for FORCETKO                   @R1A         
.PSTIMND ANOP                                                 @B1A @T1M         
         AIF   ('&FORCETKO' EQ '').PSFTOND  FORCETKO CODED?        @R1A         
         AIF   (NOT(&PERST)).PSFTERR   OPTCD=PERSIST NOT SET?      @R1A         
         AIF   ('&FORCETKO' EQ 'ALL').PNFTA     FORCETKO=ALL?      @R1A         
         AIF   ('&FORCETKO' EQ 'NONE').PNFTN    FORCETKO=NONE?     @R1A         
         AIF   ('&FORCETKO' EQ 'SINGLE').PNFTS  FORCETKO=SINGLE?   @R1A         
         AIF   ('&FORCETKO' EQ 'MULTI').PNFTM   FORCETKO=MULTI?    @R1A         
         MNOTE 4,'FORCETKO MUST BE ALL, NONE, MULTI, OR SINGLE'    @R1A         
         AGO   .PSFTOND                                            @R1A         
.PNFTA   ANOP                                                      @R1A         
&OPT4X   SETC 'X''81'''            PERSIST+FORCETKO=ALL            @R1A         
         AGO   .PNFTCMN                                            @R1A         
.PNFTN   ANOP                                                      @R1A         
&OPT4X   SETC 'X''83'''            PERSIST+FORCETKO=NONE           @R1A         
         AGO   .PNFTCMN                                            @R1A         
.PNFTS   ANOP                                                      @R1A         
&OPT4X   SETC 'X''85'''            PERSIST+FORCETKO=SINGLE         @R1A         
         AGO   .PNFTCMN                                            @R1A         
.PNFTM   ANOP                                                      @R1A         
&OPT4X   SETC 'X''87'''            PERSIST+FORCETKO=MULTI          @R1A         
.PNFTCMN ANOP                                                      @R1A         
&FRCTKO  SETB  1                                                   @R1A         
.*                                                                 @R1A         
.* Set mask flags not set above since PSTIMER was not coded        @R1A         
&MSK3CTR SETA  &MSK3CTR+1                                          @R1A         
&MSK4CTR SETA  &MSK4CTR+1                                          @R1A         
         AGO   .PSFTOND            DONE WITH THESE PARMS           @R1A         
.PSFTERR ANOP                      FORCETKO WITHOUT PERSIST        @R1A         
         MNOTE 4,'PARMS=FORCETKO CAN ONLY BE SPECIFIED WITH OPTCD=PERSI*        
               ST - FORCETKO IGNORED'                              @R1A         
.PSFTOND ANOP                                                      @R1A         
.* ********************************************************************         
.* CHECK FOR MAXSESS=VALUE                                         @D1A         
.* ********************************************************************         
         AIF   ('&MAXSESS' EQ '').MAXSEND  MAXSESS SPECIFIED?      @D1A         
         AIF   (NOT(&GNADD)).MAXSERR   OPTCD=GNAMEADD NOT SET?     @D1A         
&MXSES   SETB  1                                                   @D1A         
&MXSES1  SETB  0                                                   @D1A         
&MSK1CTR SETA  &MSK1CTR+1                                          @D1A         
&MSK2CTR SETA  &MSK2CTR+1                                          @D1A         
         AIF   ('&MAXSESS'(1,1) NE '(').MXVAL  REG NOTATION?       @D1A         
         ST    &MAXSESS(1),&PLUSFLD.(1)  PUT MAXSESS VALUE IN RPL               
.*                                                                 @D1A         
         AGO   .MAXSEND                                            @D1A         
.MAXSERR ANOP                                                      @D1A         
         MNOTE 4,'PARMS=MAXSESS CAN ONLY BE SPECIFIED WITH OPTCD=GNAMEA*        
               DD - MAXSESS IGNORED'                               @D1A         
         AGO   .MAXSEND                                            @D1A         
.MXVAL   ANOP                          CONSTANT SPECIFIED          @D1A         
         B     *+8                                                 @D1A         
         DC    A(&MAXSESS)                                         @D1A         
         L     15,*-4                                              @D1A         
         ST    15,&PLUSFLD.(1)         PUT MAXSESS VALUE IN RPL    @D1A         
.MAXSEND ANOP                                                      @D1A         
.*                                                                              
         AIF  ('&SYN' EQ '1' AND '&ASY' EQ '1').CNFLCT1                         
         AIF  ('&SYN' NE '1' AND '&ASY' NE '1').MODOPT                          
         AIF  ('&ASY' EQ '1').ASYSW                                             
         NI    &PLOPTC1.(1),X'F7'     TURN OFF THE ASY BIT                      
         AGO   .MODOPT                                                          
.ASYSW   ANOP                                                                   
         OI    &PLOPTC1.(1),X'08'     TURN ON THE ASY BIT                       
         AGO   .MODOPT                                                          
.CNFLCT1 ANOP                                                                   
     MNOTE 4,'PARAMETERS SYN AND ASY CONFLICT BOTH DISREGARDED'                 
.*                                                             @P011983         
.MODOPT  ANOP                                                                   
         AIF  ('&SPEC' EQ '1' AND '&ANY' EQ '1').CNFLCT2                        
.MODOPT2 ANOP                                                                   
         AIF  ('&CNTSTL' EQ '0' ).MODOPT3                          @B1A         
         AIF  ('&CNTSTL' GT '1' ).CNFLCT3                          @B1A         
         AIF  ('&IHBRW' EQ '21').STLOPT     MACRO IS SETLOGON      @T2A         
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON SETLOGON            @T2A         
         AIF  (NOT(&PERST OR &NPERST OR &GNADD OR &GNDEL               X        
               OR &GNSUB)).STLOPT                             @U2C @D1C         
&OPTERR  SETA &OPTERR+1                                            @T2A         
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE SETLOX        
               GON MACRO,   DISREGARDED'                           @T2A         
         AGO   .MODOPT3                                            @T2A         
.STLOPT  ANOP                                                      @T2A         
&START1  SETB  0                                                   @B1A         
&STOP1   SETB  0                                                   @B1A         
&QUIESC1 SETB  0                                                   @B1A         
&HOLD1   SETB  0                                                   @B1A         
&MSK3CTR SETA  &MSK3CTR+1                                                       
&MSK4CTR SETA  &MSK4CTR+1                                                       
.MODOPT3 ANOP                                                                   
         AIF  ('&PASS' EQ '1' AND '&RELEASE' EQ '1').CNFLCT5                    
.MODOPT5 ANOP                                                                   
         AIF  ('&CA' EQ '1' AND '&CSSPEC' EQ '1').CNFLCT6          @W1C         
         AIF  ('&CA' EQ '1' AND '&CONDCSS' EQ '1').CNFLCT6         @W1A         
         AIF  ('&CSSPEC' EQ '1' AND '&CONDCSS' EQ '1').CNFLCT6     @W1A         
.MODOPT6 ANOP                                                                   
         AIF  ('&ACCEPT' EQ '1' AND '&ACQUIRE' EQ '1').CNFLCT7                  
         AIF  ('&ACCEPT' EQ '1' AND '&RESTOR' EQ '1').CNFLCT7      @B1A         
         AIF  ('&ACQUIRE' EQ '1' AND '&RESTOR' EQ '1').CNFLCT7     @B1A         
         AIF  ('&IHBRW' EQ '23').MODOPT7    MACRO IS OPNDST        @T2A         
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON OPNDST              @T2A         
         AIF  (NOT(&RESTOR)).MODOPT7                               @T2A         
&OPTERR  SETA &OPTERR+1                                            @T2A         
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE OPNDSX        
               T MACRO,     DISREGARDED'                           @T2A         
.MODOPT7 ANOP                                                                   
         AIF  ('&Q' EQ '1' AND '&NQ' EQ '1').CNFLCT8                            
.MODOPT8 ANOP                                                                   
         AIF  ('&RELRQ' EQ '1' AND '&NRELRQ' EQ '1').CNFLCT9                    
.MODOPT9 ANOP                                                                   
         AIF  ('&ERASE' EQ '1' AND '&EAU' EQ '1').CNFLCTB                       
         AIF  ('&ERASE' EQ '1' AND '&NERASE' EQ '1').CNFLCTB                    
         AIF  ('&EAU' EQ '1' AND '&NERASE' EQ '1').CNFLCTB                      
.MODOPTB ANOP                                                                   
         AIF  ('&BLK' EQ '1' AND '&LBM' EQ '1').CNFLCTC                         
         AIF  ('&BLK' EQ '1' AND '&LBT' EQ '1').CNFLCTC                         
         AIF  ('&LBM' EQ '1' AND '&LBT' EQ '1').CNFLCTC                         
.MODOPTC ANOP                                                                   
         AIF  ('&LOCK' EQ '1' AND '&COND' EQ '1').CNFLCTD                       
         AIF  ('&LOCK' EQ '1' AND '&UNCOND' EQ '1').CNFLCTD                     
         AIF  ('&LOCK' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD    @R491100         
         AIF  ('&COND' EQ '1' AND '&UNCOND' EQ '1').CNFLCTD                     
         AIF  ('&COND' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD    @R491100         
         AIF  ('&UNCOND' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD  @R491100         
.MODOPTD ANOP                                                                   
         AIF  ('&CONALL' EQ '1' AND '&CONANY' EQ '1').CNFLCTE                   
.MODOPTE ANOP                                                                   
         AIF  ('&PEND' EQ '1' AND '&SESSION' EQ '1').CNFLCTF                    
         AIF  ('&PEND' EQ '1' AND '&ACTIVE' EQ '1').CNFLCTF                     
         AIF  ('&PEND' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF                    
         AIF  ('&ACTIVE' EQ '1' AND '&SESSION' EQ '1').CNFLCTF                  
         AIF  ('&ACTIVE' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF                  
         AIF  ('&SESSION' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF                 
.MDOPTE1 ANOP                                                  @D5B4747         
         AIF  ('&NBUFLST' EQ '1' AND '&BUFFLST' EQ '1').CNFLCF1                 
.*                                                             @D5B4747         
.MDOPTE2 ANOP                                                  @D5B4747         
         AIF  ('&CONTCHN' EQ '1' AND '&NCNTCHN' EQ '1').CNFLCF2                 
.*                                                             @D5B4747         
.MDOPTE3 ANOP                                                  @D5B4747         
         AIF  ('&NLMPEO' EQ '1' AND '&LMPEO' EQ '1').CNFLCF3                    
.*                                                             @D5B4747         
.MDOPTE4 ANOP                                                  @D5B4747         
         AIF  ('&NUSERRH' EQ '1' AND '&USERRH' EQ '1').CNFLCF4                  
.*                                                             @D5B4747         
.MDOPTE5 ANOP                                                      @F1A         
         AIF  ('&MTS' EQ '1' AND '&NMTS' EQ '1').CNFLCF5           @F1A         
.*                                                                              
.MDOPTE6 ANOP                                                      @01A         
         AIF  ('&PASS' EQ '1' AND '&TERMQ' EQ '1').CNFLCF6         @01A         
         AIF  ('&RELEASE' EQ '1' AND '&TERMQ' EQ '1').CNFLCF6      @01A         
.*                                                                              
.MDOPTE7 ANOP                                                      @01A         
         AIF  ('&LOCK' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7         @01A         
         AIF  ('&COND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7         @01A         
         AIF  ('&UNCOND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7       @01A         
         AIF  ('&UNBIND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7       @01A         
.*                                                                              
.MODOPTF ANOP                                                                   
         AIF  ('&CNTINQ' EQ '0' ).MODOPTG                                       
         AIF  ('&CNTINQ' GT '1' ).CNFLCTG                                       
         AIF  ('&IHBRW' EQ '26').INQOPT     MACRO IS INQUIRE       @T2A         
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON INQUIRE             @T2A         
         AIF  (NOT(&PERSIQ OR &NQN OR &SESNM)).INQOPT              @U2C         
&OPTERR  SETA &OPTERR+1                                            @T2A         
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE INQUIX        
               RE MACRO,    DISREGARDED'                           @T2A         
         AGO   .MODOPTG                                            @T2A         
.INQOPT  ANOP                                                      @T2A         
&LGONMS1 SETB  0                                                                
&DEVCHR1 SETB  0                                                                
&TERMS1  SETB  0                                                                
&APSTAT1 SETB  0                                                                
&COUNTS1 SETB  0                                                                
&RNNAME1 SETB  0                                                                
&CIDXLT1 SETB  0                                                                
&TOPLGN1 SETB  0                                                                
&BSCID1  SETB  0                                                                
&DISPLY1 SETB  0                                                                
&SPARM1  SETB  0                                                                
&SKEY1   SETB  0                                               @XM30862         
&USRVAR1 SETB  0                                               @P014769         
&STATUS1 SETB  0                                                   @04A         
&MSK3CTR SETA  &MSK3CTR+1                                                       
&MSK4CTR SETA  &MSK4CTR+1                                                       
.MODOPTG ANOP                                                                   
.* *************** VTL ADDITIONS ****************                               
         AIF  ('&KEEP' EQ '1' AND '&TRUNC' EQ '1').CNFLCTI                      
         AIF  ('&KEEP' EQ '1' AND '&NIBTK' EQ '1').CNFLCTI                      
         AIF  ('&TRUNC' EQ '1' AND '&NIBTK' EQ '1').CNFLCTI                     
.MODOPTI ANOP                                                                   
         AIF  ('&NFMHDR' EQ '1' AND '&FMHDR' EQ '1').CNFLCTK                    
.MODOPTK ANOP                                                                   
.* ************ END VTL ADDITIONS ***************                               
         AIF  ('&QALL' EQ '1' AND '&QSESS' EQ '1').CNFLCTL     @R504800         
         AIF  ('&QALL' EQ '1' AND '&QNOTE' EQ '1').CNFLCTL     @R504800         
         AIF  ('&QSESS' EQ '1' AND '&QNOTE' EQ '1').CNFLCTL    @R504800         
.MODOPTL ANOP                                                  @R504800         
         AIF  ('&NBACKUP' EQ '1' AND '&BACKUP' EQ '1').CNFLCTM @R489301         
.MODOPTM ANOP                                                  @R489301         
         AIF  ('&NSONCD' EQ '1' AND '&SONCD' EQ '1').CNFLCTN   @R491100         
.MODOPTN ANOP                                                  @R491100         
         AIF  ('&NSENSE' EQ '1' AND '&SENSE' EQ '1').CNFLCTO   @R491100         
.MODOPTO ANOP                                                  @R491100         
         AIF  ('&RSPQUE' EQ '1' AND '&NRSPQU' EQ '1').CNFLCTP  @R491101         
.MODOPTP ANOP                                                  @R491101         
         AIF  ('&IHBRW' EQ '25').MODOPTQ    MACRO IS CHANGE        @I1A         
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON CHANGE              @I1A         
         AIF  (NOT(&ENDAF OR &ENDFA)).MODOPTQ                 @I1A @L1C         
&OPTERR  SETA &OPTERR+1                                            @I1A         
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE CHANGX        
               E MACRO,     DISREGARDED'                           @I1A         
.MODOPTQ ANOP                                                      @I1A         
         AIF  ('&KPSRB' EQ '1' AND '&NKPSRB' EQ '1').CNFLCTR       @U4A         
.MODOPTR ANOP                                                      @U4A         
         AIF  ('&ENDAF' EQ '1' AND '&ENDFA' EQ '1').CNFLCTS        @L1A         
.MODOPTS ANOP                                                      @L1A         
         AIF  ('&IHBRW' EQ '34').MODOPTT    MACRO IS SEND          @A2A         
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON SEND                @A2A         
         AIF  (NOT(&IDS3270)).MODOPTT                              @A2A         
&OPTERR  SETA &OPTERR+1                                            @A2A         
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE SEND X        
               MACRO,     DISREGARDED'                             @A2A         
.MODOPTT ANOP                                                      @A2A         
         AGO   .CKDONE                                                          
.CNFLCT2 ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS SPEC AND ANY CONFLICT BOTH DISREGARDED' @P011983         
         AGO   .MODOPT2                                            @W1C         
.CNFLCT3 ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'TWO OR MORE OF THE FOLLOWING CONFLICTING VALUES WERE SPECIFX        
               IED'                                                @I1C         
   MNOTE 4,'     STOP, START, QUIESCE, HOLD, PERSIST, NPERSIST, '  @I1C         
   MNOTE 4,'     GNAMEADD, GNAMEDEL, GNAMESUB -  ALL DISREGARDED'               
.*                                                            @I1C @D1C         
         AGO   .MODOPT3                                                         
.CNFLCT5 ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS PASS AND RELEASE CONFLICT BOTH DISREGARDED'              
.*                                                             @P011983         
         AGO   .MODOPT5                                                         
.CNFLCT6 ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS CA, CS, AND CONDCS CONFLICT, ALL DISREGARDED'   X        
                                                                   @W1C         
         AGO   .MODOPT6                                                         
.CNFLCT7 ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS ACCEPT AND-OR ACQUIRE AND-OR RESTORE'       @B1C         
   MNOTE 4,'        CONFLICT, ALL DISREGARDED'                     @B1C         
         AGO   .MODOPT7                                                         
.CNFLCT8 ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS Q AND NQ CONFLICT BOTH DISREGARDED'     @P011983         
         AGO   .MODOPT8                                                         
.CNFLCT9 ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS RELRQ AND NRELRQ CONFLICT BOTH DISREGARDED'              
.*                                                             @P011983         
         AGO   .MODOPT9                                                         
.CNFLCTB ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS ERASE AND-OR EAU AND-OR NERASE'         @P011983         
   MNOTE 4,'        CONFLICT, ALL DISREGARDED     '            @P011983         
         AGO   .MODOPTB                                                         
.CNFLCTC ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS BLK AND-OR LBM AND-OR LBT'              @P011983         
   MNOTE 4,'        CONFLICT, ALL DISREGARDED     '            @P011983         
         AGO   .MODOPTC                                                         
.CNFLCTD ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS LOCK AND-OR COND AND-OR UNCOND'         @R491100         
   MNOTE 4,' AND-OR UNBIND  CONFLICT, ALL DISREGARDED'  @R491100                
         AGO   .MODOPTD                                                         
.CNFLCTE ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS CONALL AND CONANY CONFLICT, BOTH DISREGARDED '           
.*                                                             @P011983         
         AGO   .MODOPTE                                                         
.CNFLCTF ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
  MNOTE 4,'PARAMETERS PEND AND-OR SESSION AND-OR ACTIVE AND-OR UNCONDL'         
.*                                                             @P011983         
  MNOTE 4,'        CONFLICT, ALL DISREGARDED     '                              
.*                                                             @P011983         
         AGO   .MDOPTE1                                        @D5B4747         
.CNFLCF1 ANOP                                                  @D5B4747         
&OPTERR  SETA  &OPTERR+1                                       @D5B4747         
   MNOTE 4,'PARAMETERS NBUFFLST AND BUFFLST CONFLICT, BOTH DISREGARDED'         
.*                                                             @P011983         
         AGO   .MDOPTE2                                        @D5B4747         
.CNFLCF2 ANOP                                                  @D5B4747         
&OPTERR  SETA  &OPTERR+1                                       @D5B4747         
   MNOTE 4,'PARAMETERS CONTCHN AND NCONTCHN CONFLICT, BOTH DISREGARDED'         
.*                                                             @P011983         
         AGO   .MDOPTE3                                        @D5B4747         
.CNFLCF3 ANOP                                                  @D5B4747         
&OPTERR  SETA  &OPTERR+1                                       @D5B4747         
   MNOTE 4,'PARAMETERS NLMPEO AND LMPEO CONFLICT, BOTH DISREGARDED'             
.*                                                             @P011983         
         AGO   .MDOPTE4                                        @D5B4747         
.CNFLCF4 ANOP                                                  @D5B4747         
&OPTERR  SETA  &OPTERR+1                                       @D5B4747         
   MNOTE 4,'PARAMETERS USERRH AND NUSERRH CONFLICT, BOTH DISREGARDED'           
.*                                                             @P011983         
         AGO   .MDOPTE5                                            @F1A         
.CNFLCF5 ANOP                                                      @F1A         
&OPTERR  SETA  &OPTERR+1                                           @F1A         
   MNOTE 4,'PARAMETERS MTS AND NMTS CONFLICT, BOTH DISREGARDED'    @F1A         
.*                                                                              
         AGO   .MDOPTE6                                            @01A         
.CNFLCF6 ANOP                                                      @01A         
&OPTERR  SETA  &OPTERR+1                                           @01A         
   MNOTE 4,'PARAMETERS PASS AND-OR RELEASE AND TERMQ CONFLICT'     @01A         
   MNOTE 4,'ALL DISREGARDED'                                       @01A         
.*                                                                              
         AGO   .MDOPTE7                                            @01A         
.CNFLCF7 ANOP                                                      @01A         
&OPTERR  SETA  &OPTERR+1                                           @01A         
   MNOTE 4,'PARAMETERS LOCK AND-OR COND AND-OR UNCOND AND-OR'      @01A         
   MNOTE 4,'UNBIND AND TERMQ CONFLICT ALL DISREGARDED'             @01A         
.*                                                                              
         AGO   .MODOPTF                                        @D5B4747         
.CNFLCTG ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
  MNOTE 4,'TWO OR MORE OF THE FOLLOWING CONFLICTING VALUES WERE SPECIFIX        
               ED'                                                 @I1C         
  MNOTE 4,'     LOGONMSG, DEVCHAR, TERMS, APPSTAT, COUNTS, RNNAME, '   X        
                                                                   @I1C         
  MNOTE 4,'     CIDXLATE, TOPLOGON, BSCID, DISPLAY, SESSPARM, USERVAR,'X        
                                                                   @I1C         
  MNOTE 4,'     PERSESS, NQN, SESSNAME, STATUS'                    @04C         
  MNOTE 4,'       -  ALL DISREGARDED'                              @04A         
.*                                                                 @KFC         
        AGO   .MODOPTG                                                          
.* *************** VTL ADDITIONS ****************                               
.CNFLCTI ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS KEEP AND-OR TRUNC AND-OR NIBTK CONFLICT,'                
.*                                                             @P011983         
   MNOTE 4,'       ALL DISREGARDED      '                      @P011983         
          AGO  .MODOPTI                                                         
.CNFLCTK ANOP                                                                   
&OPTERR  SETA  &OPTERR+1                                                        
   MNOTE 4,'PARAMETERS NFMHDR AND FMHDR CONFLICT, BOTH DISREGARDED'             
.*                                                             @P011983         
         AGO  .MODOPTK                                                          
.CNFLCTL ANOP                                                  @R504800         
&OPTERR  SETA  &OPTERR+1                                       @R504800         
   MNOTE 4,'PARAMETERS QALL AND-OR QSESSLIM AND-OR QNOTENAB CONFLICT,'          
   MNOTE 4,'       ALL DISREGARDED      '                      @R504800         
         AGO  .MODOPTL                                         @R504800         
.CNFLCTM ANOP                                                  @R489301         
&OPTERR  SETA  &OPTERR+1                                       @R489301         
   MNOTE 4,'PARAMETERS NBACKUP AND BACKUP CONFLICT, BOTH DISREGARDED'           
.*                                                             @R489301         
         AGO  .MODOPTM                                         @R489301         
.CNFLCTN ANOP                                                  @R491100         
&OPTERR  SETA  &OPTERR+1                                       @R491100         
   MNOTE 4,'PARAMETERS NSONCODE AND SONCODE CONFLICT, BOTH DISREGARDED'         
.*                                                             @R491100         
         AGO  .MODOPTN                                         @R491100         
.CNFLCTO ANOP                                                  @R491100         
&OPTERR  SETA  &OPTERR+1                                       @R491100         
   MNOTE 4,'PARAMETERS NSENSE AND SENSE CONFLICT, BOTH DISREGARDED'             
.*                                                             @R491100         
         AGO  .MODOPTO                                         @R491100         
.CNFLCTP ANOP                                                  @R491101         
&OPTERR  SETA  &OPTERR+1                                       @R491101         
   MNOTE 4,'PARAMETERS RSPQUED AND NRSPQUED CONFLICT, BOTH DISREGARDED'         
.*                                                             @R491101         
         AGO  .MODOPTP                                         @R491101         
.CNFLCTR ANOP                                                      @U4A         
&OPTERR  SETA  &OPTERR+1                                           @U4A         
   MNOTE 4,'PARAMETERS KEEPSRB AND NKEEPSRB CONFLICT, BOTH DISREGARDED'         
.*                                                                 @U4A         
         AGO  .MODOPTR                                             @U4A         
.CNFLCTS ANOP                                                      @L1A         
&OPTERR  SETA  &OPTERR+1                                           @L1A         
  MNOTE 4,'PARAMETERS ENDAFFIN AND ENDAFFNF CONFLICT, BOTH DISREGARDED'         
.*                                                                 @L1A         
         AGO  .MODOPTS                                             @L1A         
.* ************ END VTL ADDITIONS ***************                               
.CKDONE  ANOP                                                                   
    AIF  ('&OPTCD' EQ '(SYN)' OR '&OPTCD' EQ '(ASY)').GOSET                     
    AIF  ('&OPTCD' EQ 'SYN' OR '&OPTCD' EQ 'ASY').GOSET                         
         AGO  .GOSET1                                                           
.GOSET   ANOP                                                                   
&NUM     SETA N'&OPTCD                                                          
         AIF  ('&NUM' EQ '1').CKSEQNO                                           
.GOSET1  ANOP                                                                   
    AIF  ('&OPTERR' GT '0').SETERR                                              
    AIF  ('&MSK1CTR' GT '0' AND '&MSK2CTR' GT '0').GOSET2                       
    AIF  ('&MSK1CTR' GT '0').GOSET2A                                            
    AIF  ('&MSK2CTR' GT '0').GOSET2B                                            
.GOSET34 ANOP                                                                   
    AIF  ('&MSK3CTR' GT '0' AND '&MSK4CTR' GT '0').GOSET3                       
    AIF  ('&MSK3CTR' GT '0').GOSET3A                                            
    AIF  ('&MSK4CTR' GT '0').GOSET3B                                            
    AGO  .CKSEQNO                                                               
.GOSET2  ANOP                                                                   
         B     *+14                                                @B1C         
.OPTMSK1 ANOP                                                                   
*  OPTMSK FOR OR                                                                
         DC    &OPT4X                                              @I1C         
*                                        OPTCD BYTE 4              @B1A         
         DC    B'&CS&NOTIFY&PASS&NERASE&EAU&ERASE&ANY&CONDCS'                   
*                                        OPTCD BYTE 5              @W1C         
         DC    B'&BLK&LBM&LBT&COND&UNCOND&LOCK&BUFFLST&CONTCHN'                 
*                                        OPTCD BYTE 6          @D5B4747         
         DC    B'&CONALL&CONANY&BACKUP&Q&BIT0&RELRQ&BIT0&LMPEO'                 
*                                        OPTCD BYTE 7          @R489306         
         DC    B'&ACQUIRE&ACCEPT&BIT0&PEND&MXSES&ACTIVE&UNCONDL&USERRH'         
*                                        OPTCD BYTE 8     @D5B4747 @D1C         
.OPTMSK2 ANOP                                                                   
*  OPTMSK FOR AND                                                               
         DC    X'00'                                               @I1C         
*                                        OPTCD BYTE 4              @B1A         
         DC    B'&CS1&NOTIFY1&PASS1&NERASE1&EAU1&ERASE1&ANY1&CONDCS1'           
*                                        OPTCD BYTE 5              @W1C         
         DC    B'&BLK1&LBM1&LBT1&COND1&UNCOND1&LOCK1&BUFLST1&CNTCHN1'           
*                                        OPTCD BYTE 6          @D5B4747         
         DC    B'&CONALL1&CONANY1&BACKUP1&NQ1&BIT01&NRELRQ1&BIT01&LMPEOX        
               1'                                                               
*                                        OPTCD BYTE 7          @R489306         
         DC    B'&ACQUIR1&ACCEPT1&BIT01&PEND1&MXSES1&ACTIVE1&UNCNDL1&USX        
               ERRH1'                                                           
*                                        OPTCD BYTE 8     @D5B4747 @D1C         
         NC    &POPTCD2.(4,1),*-4   TURN OFF UNNECESSARY OPTCD SWITCHES         
         OC    &POPTCD2.(4,1),*-15  TURN ON NEW SET OF OPTCD SWITCHES           
*                                                                  @V1C         
         NC    &PLOPT4.(1,1),*-17   TURN OFF UNNECESSARY OPTCD SWITCHES         
*                                                                  @V1C         
         OC    &PLOPT4.(1,1),*-28   TURN ON NEW SET OF OPTCD SWITCHES           
*                                                                  @V1C         
         AGO   .GOSET34                                                         
.GOSET2A ANOP                                                                   
         B     *+10                                                @B1C         
.OPT1MSK ANOP                                                                   
*  OPTMSK FOR OR                                                                
         DC    &OPT4X                                              @I1C         
*                                        OPTCD BYTE 4              @B1A         
         DC    B'&CS&NOTIFY&PASS&NERASE&EAU&ERASE&ANY&CONDCS'                   
*                                        OPTCD BYTE 5              @W1C         
         DC    B'&BLK&LBM&LBT&COND&UNCOND&LOCK&BUFFLST&CONTCHN'                 
*                                        OPTCD BYTE 6          @D5B4747         
         DC    B'&CONALL&CONANY&BACKUP&Q&BIT0&RELRQ&BIT0&LMPEO'                 
*                                        OPTCD BYTE 7          @R489306         
         DC    B'&ACQUIRE&ACCEPT&BIT0&PEND&MXSES&ACTIVE&UNCONDL&USERRH'         
*                                        OPTCD BYTE 8     @D5B4747 @D1C         
         DC    B'&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0'         @B1A         
*                                        FILLER FOR ALIGNMENT      @B1A         
         OC    &PLOPT4.(1,1),*-6   TURN ON NEW SET OF OPTCD SWITCHES            
*                                                                  @V1C         
         OC    &POPTCD2.(4,1),*-11 TURN ON NEW SET OF OPTCD SWITCHES            
*                                                                  @V1C         
         AGO   .GOSET34                                                         
.GOSET2B ANOP                                                                   
         B     *+10                                                @B1C         
.OPT2MSK ANOP                                                                   
*  OPTMSK FOR AND                                                               
         DC    X'00'                                               @I1C         
*                                        OPTCD BYTE 4              @B1A         
         DC    B'&CS1&NOTIFY1&PASS1&NERASE1&EAU1&ERASE1&ANY1&CONDCS1'           
*                                        OPTCD BYTE 5              @W1C         
         DC    B'&BLK1&LBM1&LBT1&COND1&UNCOND1&LOCK1&BUFLST1&CNTCHN1'           
*                                        OPTCD BYTE 6          @D5B4747         
         DC    B'&CONALL1&CONANY1&BACKUP1&NQ1&BIT01&NRELRQ1&BIT01&LMPEOX        
               1'                                                               
*                                        OPTCD BYTE 7          @R489306         
         DC    B'&ACQUIR1&ACCEPT1&BIT01&PEND1&MXSES1&ACTIVE1&UNCNDL1&USX        
               ERRH1'                                                           
*                                        OPTCD BYTE 8     @D5B4747 @D1C         
         DC    B'&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0'         @B1A         
*                                        FILLER FOR ALIGNMENT      @B1A         
         NC    &PLOPT4.(1,1),*-6    TURN OFF UNNECESSARY OPTCD SWITCHES         
*                                                                  @V1C         
         NC    &POPTCD2.(4,1),*-11  TURN OFF UNNECESSARY OPTCD SWITCHES         
*                                                                  @V1C         
         AGO   .GOSET34                                                         
.GOSET3  ANOP                                                                   
         B     *+14                                                @B1C         
.OPTMSK3 ANOP                                                                   
*  OPTMSK FOR OR                                                                
         DC    &OPT4X                                              @I1C         
*                                        OPTCD BYTE 4         @B1A @KFC         
         DC    B'&LGONMSG&DEVCHAR&TERMS&COUNTS&APPSTAT&STATUS&CIDXLAT&TX        
               OPLGON'                                             @04C         
*                                        OPTCD BYTE 9                           
         DC    B'&BSCID&DISPLAY&SPARM&SKEY&USERVAR&UNBIND&SONCD&SENSE'          
*                                        OPTCD BYTE 10        @R491100          
         DC    B'&QUIESCE&START&STOP&HOLD&BIT0&MTS&TERMQ&KPSRB'                 
*                                        OPTCD BYTE 11        @01C @U4C         
.* *************** VTL ADDITIONS ****************                               
         DC    B'&RSPQUE&KEEP&TRUNC&NIBTK&QSESS&QNOTE&QALL&FMHDR'               
*                                        OPTCD BYTE 12         @R504800         
.* ************ END VTL ADDITIONS ***************                               
.OPTMSK4 ANOP                                                                   
*  OPTMSK FOR AND                                                               
         DC    X'00'                                               @I1C         
*                                        OPTCD BYTE 4         @B1A @KFC         
         DC    B'&LGONMS1&DEVCHR1&TERMS1&COUNTS1&APSTAT1&STATUS1&CIDXLTX        
               1&TOPLGN1'                                          @04C         
*                                        OPTCD BYTE 9                           
         DC    B'&BSCID1&DISPLY1&SPARM1&SKEY1&USRVAR1&UNBIND1&SONCD1&SEX        
               NSE1'                                                            
*                                        OPTCD BYTE 10        @R491100          
         DC    B'&QUIESC1&START1&STOP1&HOLD1&BIT01&MTS1&TERMQ1&KPSRB1'          
*                                        OPTCD BYTE 11        @01C @U4C         
.* *************** VTL ADDITIONS ****************                               
         DC    B'&RSPQUE1&KEEP1&TRUNC1&NIBTK1&QSESS1&QNOTE1&QALL1&FMHDRX        
               1'                                                               
*                                        OPTCD BYTE 12         @R504800         
.* ************ END VTL ADDITIONS ***************                               
         NC    &POPTCD3.(4,1),*-4   TURN OFF UNNECESSARY OPTCD SWITCHES         
         OC    &POPTCD3.(4,1),*-15  TURN ON NEW SET OF OPTCD SWITCHES           
*                                                                  @B1C         
         NC    &PLOPT4.(1,1),*-17   TURN OFF UNNECESSARY OPTCD SWITCHES         
*                                                                  @B1A         
         OC    &PLOPT4.(1,1),*-28   TURN ON NEW SET OF OPTCD SWITCHES           
*                                                                  @B1A         
         AGO   .CKSEQNO                                                         
.GOSET3A ANOP                                                                   
         B     *+10                                                @B1C         
.OPT3MSK ANOP                                                                   
*  OPTMSK FOR OR                                                                
         DC    &OPT4X                                              @I1C         
*                                        OPTCD BYTE 4         @B1A @KFC         
         DC    B'&LGONMSG&DEVCHAR&TERMS&COUNTS&APPSTAT&STATUS&CIDXLAT&TX        
               OPLGON'                                             @04C         
*                                        OPTCD BYTE 9                           
         DC    B'&BSCID&DISPLAY&SPARM&SKEY&USERVAR&UNBIND&SONCD&SENSE'          
*                                        OPTCD BYTE 10        @R489306          
         DC    B'&QUIESCE&START&STOP&HOLD&BIT0&MTS&TERMQ&KPSRB'                 
*                                        OPTCD BYTE 11        @01C @U4C         
.* *************** VTL ADDITIONS ****************                               
         DC    B'&BIT0&KEEP&TRUNC&NIBTK&BIT0&BIT0&BIT0&FMHDR'                   
*                                        OPTCD BYTE 12                          
.* ************ END VTL ADDITIONS ***************                               
         DC    B'&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0'         @B1A         
*                                        FILLER FOR ALIGNMENT      @B1A         
         OC    &POPTCD3.(4,1),*-5  TURN ON NEW SET OF OPTCD SWITCHES            
*                                                                  @B1C         
         OC    &PLOPT4.(1,1),*-12  TURN ON NEW SET OF OPTCD SWITCHES            
*                                                                  @B1A         
         AGO   .CKSEQNO                                                         
.GOSET3B ANOP                                                                   
         B     *+10                                                @B1C         
.OPT4MSK ANOP                                                                   
*  OPTMSK FOR AND                                                               
         DC    X'00'                                               @I1C         
*                                        OPTCD BYTE 4         @B1A @KFC         
         DC    B'&LGONMS1&DEVCHR1&TERMS1&COUNTS1&APSTAT1&STATUS1&CIDXLTX        
               1&TOPLGN1'                                          @04C         
*                                        OPTCD BYTE 9                           
         DC    B'&BSCID1&DISPLY1&SPARM1&SKEY1&USRVAR1&UNBIND1&SONCD1&SEX        
               NSE1'                                                            
*                                        OPTCD BYTE 10        @R489306          
         DC    B'&QUIESC1&START1&STOP1&HOLD1&BIT01&MTS1&TERMQ1&KPSRB1'          
*                                        OPTCD BYTE 11        @01C @U4C         
.* *************** VTL ADDITIONS ****************                               
         DC    B'&BIT01&KEEP1&TRUNC1&NIBTK1&BIT01&BIT01&BIT01&FMHDR1'           
*                                        OPTCD BYTE 12                          
.* ************ END VTL ADDITIONS ***************                               
         DC    B'&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0&BIT0'         @B1A         
*                                        FILLER FOR ALIGNMENT      @B1A         
         NC    &POPTCD3.(4,1),*-5   TURN OFF UNNECESSARY OPTCD SWITCHES         
*                                                                  @B1C         
         NC    &PLOPT4.(1,1),*-12  TURN OFF NECESSARY OPTCD SWITCHES            
*                                                                  @B1A         
         AGO   .CKSEQNO                                                         
.* *************** VTL ADDITIONS ****************                               
.SETERR  ANOP                                                                   
   MNOTE 4,'**********************************************************'         
   MNOTE 4,'**           CONFLICTING OPTCD OPTIONS WERE             **'         
   MNOTE 4,'**     SPECIFIED NO RPL OPTCD PARAMETER MANIPULATIVE    **'         
   MNOTE 4,'**           INSTRUCTIONS WILL BE PRODUCED              **'         
   MNOTE 4,'**********************************************************'         
.*                                                             @P011983         
.* ********************************************************************         
.*                       MDFYRECD SUBROUTINE                                    
.* VALIDITY CHECKS AND GENERATES CODE FOR RECORD MODE RPL OPTIONS.              
.* INVOKES THE FOLLOWING SUBROUTINES: MDFYRESP, MDFYCHN, MDFYCTRL,              
.* MDFYRH3, MDFYSSNS, MDFYRTYP, MDFYIBSQ, MDFYOBSQ, AND OPTSCAN.                
.* ********************************************************************         
.CKSEQNO ANOP                                                                   
         AIF   ('&SEQNO' EQ '').CKIBSQV IS THERE A SEQ. NO. PARM?               
         AIF   ('&SEQNO'(1,1) NE '(').CKSEQN1    REGISTER NOTATION?             
         STH   &SEQNO(1),&PLSEQNO.(1)   PUT SEQ. NO. IN THE RPL                 
         AGO   .CKIBSQV                                                         
.CKSEQN1 ANOP                                                                   
&CHAR1   SETC  '&SEQNO'(1,2)                                                    
&LEN     SETA  K'&SEQNO                                                         
&CHAR2   SETC  '&SEQNO'(&LEN,1)                                                 
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ2                                      
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ2                                      
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ2                                      
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ2                                      
         AIF   ('&CHAR1' EQ 'A(').IHBCKP2                                       
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP2                                       
         AIF   ('&CHAR1' EQ 'S(').IHBCKP2                                       
         AIF   ('&CHAR1' LT '0').IHBERU2                                        
         AIF   ('&CHAR1' LE '9').IHBNUM2                                        
         AIF   ('&CHAR1' LT '00').IHBERU2                                       
.IHBNUM2 ANOP                                                                   
         B     *+6                                                              
         DC    AL2(&SEQNO)         SEQUENCE NUMBER SPECIFIED AS NUMERIC         
         AGO   .CKSEQN2                                                         
.IHBERU2 MNOTE 4,'SEQNO=&SEQNO INVALID - IGNORED'              @P011983         
         AGO   .CKIBSQV                                                         
.IHBCKP2 AIF   ('&CHAR2' EQ ')').IHBGOP2                                        
         AGO   .IHBERQ2                                                         
.IHBCKQ2 AIF   ('&CHAR2' EQ '''').IHBGOP2                                       
.IHBERQ2 MNOTE 4,SEQNO=&SEQNO INVALID - IGNORED'               @P011983         
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'              
.*                                                             @P011983         
         AGO   .CKIBSQV                                                         
.IHBGOP2  ANOP                                                                  
&CHAR3   SETC  '&SEQNO'(3,&LEN-3)                                               
&CHAR4   SETC  '&CHAR1'(2,1)                                                    
&CHAR1   SETC  '&CHAR1'(1,1)                                                    
         B     *+6                                                              
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   SEQUENCE NUMBER FIELD              
.CKSEQN2 ANOP                                                                   
         LH    15,*-2                   GET SEQUENCE NUMBER                     
         STH   15,&PLSEQNO.(1)          PUT SEQUENCE NUMBER IN THE RPL          
.CKIBSQV ANOP                                                                   
         AIF   ('&IBSQVAL' EQ '').CKOBSQV  STSN INBOUND SEQ. NO.?               
         AIF   ('&IBSQVAL'(1,1) NE '(').CKIBSV1  REGISTER NOTATION?             
         STH   &IBSQVAL(1),&PLIBSQV.(1) PUT STSN INBOUND SEQ NO IN RPL          
         AGO   .CKOBSQV                                                         
.CKIBSV1 ANOP                                                                   
&CHAR1   SETC  '&IBSQVAL'(1,2)                                                  
&LEN     SETA  K'&IBSQVAL                                                       
&CHAR2   SETC  '&IBSQVAL'(&LEN,1)                                               
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ3                                      
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ3                                      
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ3                                      
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ3                                      
         AIF   ('&CHAR1' EQ 'A(').IHBCKP3                                       
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP3                                       
         AIF   ('&CHAR1' EQ 'S(').IHBCKP3                                       
         AIF   ('&CHAR1' LT '0').IHBERU3                                        
         AIF   ('&CHAR1' LE '9').IHBNUM3                                        
         AIF   ('&CHAR1' LT '00').IHBERU3                                       
.IHBNUM3 ANOP                                                                   
         B     *+6                                                              
         DC    AL2(&IBSQVAL)       INBOUND SEQ NO SPECIFIED AS NUMERIC          
         AGO   .CKIBSV2                                                         
.IHBERU3 MNOTE 4,'IBSQVAL=&IBSQVAL INVALID - IGNORED'          @P011983         
         AGO   .CKOBSQV                                                         
.IHBCKP3 AIF   ('&CHAR2' EQ ')').IHBGOP3                                        
         AGO   .IHBERQ3                                                         
.IHBCKQ3 AIF   ('&CHAR2' EQ '''').IHBGOP3                                       
.IHBERQ3 MNOTE 4,IBSQVAL=&IBSQVAL INVALID - IGNORED'           @P011983         
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'              
.*                                                             @P011983         
         AGO   .CKOBSQV                                                         
.IHBGOP3  ANOP                                                                  
         B     *+6                                                              
&CHAR3   SETC  '&IBSQVAL'(3,&LEN-3)                                             
&CHAR4   SETC  '&CHAR1'(2,1)                                                    
&CHAR1   SETC  '&CHAR1'(1,1)                                                    
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   INBOUND SEQ NO FIELD               
.CKIBSV2 ANOP                                                                   
         LH    15,*-2                   GET STSN INBOUND SEQ NO                 
         STH   15,&PLIBSQV.(1)          PUT STSN INBOUND SEQ NO IN RPL          
.CKOBSQV ANOP                                                                   
         AIF   ('&OBSQVAL' EQ '').CKRESPO    STSN OUTBOUND SEQ. NO.?            
         AIF   ('&OBSQVAL'(1,1) NE '(').CKOBSV1   REGISTER NOTATION?            
         STH   &OBSQVAL(1),&PLOBSQV.(1) PUT STSN OUTBOUND SEQ NO IN RPL         
         AGO   .CKRESPO                                                         
.CKOBSV1  ANOP                                                                  
&CHAR1   SETC  '&OBSQVAL'(1,2)                                                  
&LEN     SETA  K'&OBSQVAL                                                       
&CHAR2   SETC  '&OBSQVAL'(&LEN,1)                                               
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ4                                      
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ4                                      
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ4                                      
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ4                                      
         AIF   ('&CHAR1' EQ 'A(').IHBCKP4                                       
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP4                                       
         AIF   ('&CHAR1' EQ 'S(').IHBCKP4                                       
         AIF   ('&CHAR1' LT '0').IHBERU4                                        
         AIF   ('&CHAR1' LE '9').IHBNUM4                                        
         AIF   ('&CHAR1' LT '00').IHBERU4                                       
.IHBNUM4 ANOP                                                                   
         B     *+6                                                              
         DC    AL2(&OBSQVAL)      OUTBOUND SEQ NO SPECIFIED AS NUMERIC          
         AGO   .CKOBSV2                                                         
.IHBERU4 MNOTE 4,'OBSQVAL=&OBSQVAL INVALID - IGNORED'          @P011983         
         AGO   .CKRESPO                                                         
.IHBCKP4 AIF   ('&CHAR2' EQ ')').IHBGOP4                                        
         AGO   .IHBERQ4                                                         
.IHBCKQ4 AIF   ('&CHAR2' EQ '''').IHBGOP4                                       
.IHBERQ4 MNOTE 4,OBSQVAL=&OBSQVAL INVALID - IGNORED'           @P011983         
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'              
.*                                                             @P011983         
         AGO   .CKRESPO                                                         
.IHBGOP4  ANOP                                                                  
&CHAR3   SETC  '&OBSQVAL'(3,&LEN-3)                                             
&CHAR4   SETC  '&CHAR1'(2,1)                                                    
&CHAR1   SETC  '&CHAR1'(1,1)                                                    
         B     *+6                                                              
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   OUTBOUND SEQ NO FIELD              
.CKOBSV2 ANOP                                                                   
         LH    15,*-2                   GET STSN OUTBOUND SEQ NO                
         STH   15,&PLOBSQV.(1)         PUT STSN OUTBOUND SEQ NO IN RPL          
.* ********************************************************************         
.*                      MDFYRESP SUBROUTINE                                     
.* INVOKES OPTSCAN TO CHECK FOR INVALID RESPOND OPTIONS.  GENERATES             
.* CODE TO MODIFY THE RESPOND FIELD IN THE RPL AND MNOTES WHEN MUTUALLY         
.*                EXCLUSIVE OPTIONS ARE SPECIFIED                               
.* THIS SECTION REWRITTEN FOR QRESP SUPPORT                    @D434436         
.* ********************************************************************         
.CKRESPO ANOP                                                                   
         AIF ('&RESPOND' EQ '').CKPOST  RESPOND OPTION SPECIFIED?               
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                        
&IHBTBL(1)  SETC  'NQRESP'                                                      
&IHBTBL(2)  SETC  'QRESP'                                                       
&IHBTBL(3)  SETC  'NEX'                                                         
&IHBTBL(4)  SETC  'EX'                                                          
&IHBTBL(5)  SETC  'FME'                                                         
&IHBTBL(6)  SETC  'NFME'                                                        
&IHBTBL(7)  SETC  'NRRN'                                                        
&IHBTBL(8)  SETC  'RRN'                                                         
&IHBNUM  SETA  8                                                                
         IHBRDWRA SCANOPT=&RESPOND,OPTION=RESPOND     GO TO OPTSCAN             
.CKRESP1 ANOP                           RETURN FROM OPTSCAN                     
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKRESP2   NQRESP OR QRESP?          
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKRESP4   NEX OR EX?                
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKRESP6   FME OR NFME?              
         AIF   (&IHBRPLY(7) OR &IHBRPLY(8)).CKRESP8   NRRN OR RRN?              
         AGO   .CKPOST                 NO VALID OPTIONS SPECIFIED               
.CKRESP2 ANOP                                                                   
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).RSPERR1  NQRESP AND QRESP?         
         AIF   (&IHBRPLY(1)).CKRESP3        NQRESP SPECIFIED                    
         AIF   (&IHBRPLY(2) EQ 0).CKRESP4   QRESP NOT SPECIFIED                 
         OI    &PLVTFL2.(1),X'08'       SET RPLQRI ON (RESPOND=QRESP)           
         AGO   .CKRESP4                                                         
.CKRESP3 ANOP                                                                   
         NI    &PLVTFL2.(1),X'F7'       SET RPLQRI OFF (RESPOND=NQRESP)         
.CKRESP4 ANOP                                                                   
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).RSPERR2  NEX AND EX?               
         AIF   (&IHBRPLY(3)).CKRESP5        NEX SPECIFIED                       
         AIF   (&IHBRPLY(4) EQ 0).CKRESP6   NEX NOT SPECIFIED                   
         OI    &PLVTFL2.(1),X'04'       SET RPLEX ON (RESPOND=EX)               
         AGO   .CKRESP6                                                         
.CKRESP5 ANOP                                                                   
         NI    &PLVTFL2.(1),X'FB'       SET RPLEX OFF (RESPOND=NEX)             
.CKRESP6 ANOP                                                                   
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).RSPERR3  FME AND NFME?             
         AIF   (&IHBRPLY(5)).CKRESP7    FME SPECIFIED                           
         AIF   (&IHBRPLY(6) EQ 0).CKRESP8   NFME NOT SPECIFIED                  
         OI    &PLVTFL2.(1),X'02'       SET RPLNFME ON (RESPOND=NFME)           
         AGO   .CKRESP8                                                         
.CKRESP7 ANOP                                                                   
         NI    &PLVTFL2.(1),X'FD'       SET RPLNFME OFF (RESPOND=FME)           
.CKRESP8 ANOP                                                                   
         AIF   (&IHBRPLY(7) AND &IHBRPLY(8)).RSPERR4  RRN AND NRRN?             
         AIF   (&IHBRPLY(7)).CKRESP9    NRRN SPECIFIED                          
         AIF   (&IHBRPLY(8) EQ 0).CKPOST    RRN NOT SPECIFIED                   
         OI    &PLVTFL2.(1),X'01'       SET RPLRRN ON (RESPOND=RRN)             
         AGO   .CKPOST                                                          
.CKRESP9 ANOP                                                                   
         NI    &PLVTFL2.(1),X'FE'       SET RPLRRN OFF (RESPOND=NRRN)           
         AGO   .CKPOST                                                          
.RSPERR1 MNOTE  4,'QRESP AND NQRESP SPECIFIED FOR RESPOND - BOTH IGNORE*        
               D'                                              @P011983         
         AGO   .CKRESP4                                                         
.RSPERR2 MNOTE  4,'EX AND NEX SPECIFIED FOR ''RESPOND'' - BOTH IGNORED'         
.*                                                             @P011983         
         AGO   .CKRESP6                                                         
.RSPERR3 MNOTE  4,'FME AND NFME SPECIFIED FOR RESPOND - BOTH IGNORED'           
.*                                                             @P011983         
         AGO   .CKRESP8                                                         
.RSPERR4 MNOTE  4,'RRN AND NRRN SPECIFIED FOR RESPOND - BOTH IGNORED'           
.*                                                             @P011983         
.**********************************************************************         
.*  END OF LOGIC SECTION REWRITTEN FOR RPL QRESP SUPPORT       @D434436         
.**********************************************************************         
.CKPOST  ANOP                                                                   
         AIF   ('&POST' EQ '').CKCHAIN  IS THERE A POST PARM?                   
         AIF   ('&POST' EQ 'SCHED').PSTSKED                                     
         AIF   ('&POST' EQ 'RESP').PSTRESP                                      
         MNOTE 4,'POST=&POST INVALID--IGNORED'                 @P011983         
         AGO   .CKCHAIN                                                         
.PSTSKED ANOP                                                                   
         OI    &PLVTFL2.(1),X'80'     SET RPLSCHED FLAG ON (POST=SCHED)         
         AGO   .CKCHAIN                                                         
.PSTRESP ANOP                                                                   
         NI    &PLVTFL2.(1),X'7F'     SET RPLSCHED FLAG OFF (POST=RESP)         
.* ********************************************************************         
.*                        MDFYCHN SUBROUTINE                                    
.* GENERATES CODE TO MODIFY THE CHAIN FIELD IN THE RPL.  ISSUES MNOTES          
.* FOR BOTH MUTUALLY EXCLUSIVE AND INVALID OPTIONS.                             
.* ********************************************************************         
.CKCHAIN ANOP                                                                   
         AIF   ('&CHAIN' EQ '').CKCTRL  CHAIN OPTION SPECIFIED?                 
         AIF   ('&CHAIN' EQ 'FIRST').CKCHN1                                     
         AIF   ('&CHAIN' EQ 'MIDDLE').CKCHN2                                    
         AIF   ('&CHAIN' EQ 'LAST').CKCHN3                                      
         AIF   ('&CHAIN' EQ 'ONLY').CKCHN4                                      
         MNOTE 4,'CHAIN=&CHAIN INVALID - IGNORED'              @P011983         
         AGO   .CKCTRL                                                          
.CKCHN1  ANOP                                                                   
         OI    &PLCHN.(1),X'80'         SET RPLFIRST ON (CHAIN=FIRST)           
         NI    &PLCHN.(1),X'8F'         SET OTHER BITS IN FIELD OFF             
         AGO   .CKCTRL                                                          
.CKCHN2  ANOP                                                                   
         OI    &PLCHN.(1),X'40'         SET RPLMIDLE ON (CHAIN=MIDDLE)          
         NI    &PLCHN.(1),X'4F'         SET OTHER BITS IN FIELD OFF             
         AGO   .CKCTRL                                                          
.CKCHN3  ANOP                                                                   
         OI    &PLCHN.(1),X'20'         SET RPLLAST ON (CHAIN=LAST)             
         NI    &PLCHN.(1),X'2F'         SET OTHER BITS IN FIELD OFF             
         AGO   .CKCTRL                                                          
.CKCHN4  ANOP                                                                   
         OI    &PLCHN.(1),X'10'         SET RPLONLY ON (CHAIN=ONLY)             
         NI    &PLCHN.(1),X'1F'         SET OTHER BITS IN FIELD OFF             
.* ********************************************************************         
.*                       MDFYCTRL SUBROUTINE                                    
.* GENERATES CODE TO MODIFY THE CONTROL FIELD (RPLCNTRL) IN THE RPL.            
.* ISSUES MNOTE FOR INVALID OPTION.                                             
.* ********************************************************************         
.CKCTRL ANOP                                                                    
         AIF   ('&CONTROL' EQ '').CKCDIR   CONTROL OPTION SPECIFIED?            
         XC    &PLCNTRL.(3,1),&PLCNTRL.(1) SET CONTROL CODES OFF                
         AIF   ('&CONTROL' NE 'DATA').CKCTRL1                                   
         OI    &PLCNTDF.(1),X'80'       SET RPLDATA ON (CONTROL=DATA)           
         AGO   .CKCDIR                                                          
.CKCTRL1 ANOP                                                                   
         AIF   ('&CONTROL' NE 'CANCEL').CKCTRL2                                 
         OI    &PLCNTDF.(1),X'40'      SET RPLCNCEL ON (CONTROL=CANCEL)         
         AGO   .CKCDIR                                                          
.CKCTRL2 ANOP                                                                   
         AIF   ('&CONTROL' NE 'QC').CKCTRL3                                     
         OI    &PLCNTDF.(1),X'20'       SET RPLQC ON (CONTROL=QC)               
         AGO   .CKCDIR                                                          
.CKCTRL3 ANOP                                                                   
         AIF   ('&CONTROL' NE 'QEC').CKCTRL4                                    
         OI    &PLCNTDF.(1),X'10'      SET RPLQEC ON (CONTROL=QEC)              
         AGO   .CKCDIR                                                          
.CKCTRL4 ANOP                                                                   
         AIF   ('&CONTROL' NE 'CHASE').CKCTRL5                                  
         OI    &PLCNTDF.(1),X'08'      SET RPLCHASE ON (CONTROL=CHASE)          
         AGO   .CKCDIR                                                          
.CKCTRL5 ANOP                                                                   
         AIF   ('&CONTROL' NE 'RELQ').CKCTRL6                                   
         OI    &PLCNTDF.(1),X'04'      SET RPLRELQ ON (CONTROL=RELQ)            
         AGO   .CKCDIR                                                          
.CKCTRL6 ANOP                                                                   
         AIF   ('&CONTROL' NE 'BID').CKCTRL9                                    
         OI    &PLCNTDC.(1),X'80'      SET RPLBID ON (CONTROL=BID)              
         AGO   .CKCDIR                                                          
.CKCTRL9 ANOP                                                                   
         AIF   ('&CONTROL' NE 'RTR').CKCTRLA                                    
         OI    &PLCNTDC.(1),X'40'      SET RPLRTR ON (CONTROL=RTR)              
         AGO   .CKCDIR                                                          
.CKCTRLA ANOP                                                                   
         AIF   ('&CONTROL' NE 'LUS').CKCTRLB                                    
         OI    &PLCNTDC.(1),X'20'      SET RPLLUS ON (CONTROL=LUS)              
         AGO   .CKCDIR                                                          
.CKCTRLB ANOP                                                                   
         AIF   ('&CONTROL' NE 'SIGNAL').CKCTRLC                                 
         OI    &PLCNTDC.(1),X'10'      SET RPLSIGNL ON (CONTROL=SIGNAL)         
         AGO   .CKCDIR                                                          
.CKCTRLC ANOP                                                                   
         AIF   ('&CONTROL' NE 'BIND').CKCTRLD                                   
         OI    &PLCNTDC.(1),X'08'      SET RPLTBIND ON (CONTROL=BIND)           
         AGO   .CKCDIR                                                          
.CKCTRLD ANOP                                                                   
         AIF   ('&CONTROL' NE 'SBI').CKCTRLE                                    
         OI    &PLCNTDC.(1),X'02'      SET RPLSBI ON (CONTROL=SBI)              
         AGO   .CKCDIR                                                          
.CKCTRLE ANOP                                                                   
         AIF   ('&CONTROL' NE 'BIS').CKCTRLF                                    
         OI    &PLCNTDC.(1),X'01'      SET RPLBIS ON (CONTROL=BIS)              
         AGO   .CKCDIR                                                          
.CKCTRLF ANOP                                                                   
         AIF   ('&CONTROL' NE 'SDT').CKCTRLH                                    
         OI    &PLCNTSC.(1),X'80'      SET RPLSDT ON (CONTROL=SDT)              
.*                                                           @PI10125           
         AGO   .CKCDIR                                                          
.CKCTRLH ANOP                                                                   
         AIF   ('&CONTROL' NE 'CLEAR').CKCTRLI                                  
         OI    &PLCNTSC.(1),X'40'      SET RPLCLEAR ON (CONTROL=CLEAR)          
         AGO   .CKCDIR                                                          
.CKCTRLI ANOP                                                                   
         AIF   ('&CONTROL' NE 'STSN').CKCTRLJ                                   
         OI    &PLCNTSC.(1),X'20'      SET RPLSTSN ON (CONTROL=STSN)            
         AGO   .CKCDIR                                                          
.CKCTRLJ ANOP                                                                   
         AIF   ('&CONTROL' NE 'SHUTD').CKCTRLK                                  
         OI    &PLCNTSC.(1),X'10'      SET RPLSHUTD ON (CONTROL=SHUTD)          
         AGO   .CKCDIR                                                          
.CKCTRLK ANOP                                                                   
         AIF   ('&CONTROL' NE 'SHUTC').CKCTRLL                                  
         OI    &PLCNTSC.(1),X'08'      SET RPLSHUTC ON (CONTROL=SHUTC)          
         AGO   .CKCDIR                                                          
.CKCTRLL ANOP                                                                   
         AIF   ('&CONTROL' NE 'RQR').CKCTRLM                                    
         OI    &PLCNTSC.(1),X'04'      SET RPLRQR ON (CONTROL=RQR)              
         AGO   .CKCDIR                                                          
.CKCTRLM ANOP                                                                   
         AIF   ('&CONTROL' NE 'RSHUTD').CKCTRLN                                 
         OI    &PLCNTSC.(1),X'02'      SET RPLRSHUT ON (CONTROL=RSHUTD)         
         AGO   .CKCDIR                                                          
.CKCTRLN ANOP                                                                   
         AIF   ('&CONTROL' NE 'SWITCH').CKCTRLO                @R489301         
         OI    &PLCNTSC.(1),X'01'      SET RPLSWTCH ON (CONTROL=SWITCH)         
         AGO   .CKCDIR                                         @R489301         
.CKCTRLO ANOP                                                  @R489301         
         MNOTE 4,'CONTROL=&CONTROL INVALID - DATA ASSUMED'     @P011983         
         OI    &PLCNTDF.(1),X'80'       SET RPLDATA ON (DEFAULT)                
.* ********************************************************************         
.*                     MDFYRH3 SUBROUTINE                                       
.*  INVOKES OPTSCAN SUBROUTINE TO CHECK FOR INVALID CHNGDIR & BRACKET           
.*  OPTIONS.  GENERATES CODE TO MODIFY THE CHNGDIR FIELD AND BRACKET            
.*             FIELD (RPLRH3) IN THE RPL.                                       
.* ********************************************************************         
.CKCDIR  ANOP                                                                   
         AIF ('&CHNGDIR' EQ '').CKBRCKT  RESPOND OPTION SPECIFIED?              
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                        
&IHBTBL(1)  SETC  'NCMD'                                                        
&IHBTBL(2)  SETC  'CMD'                                                         
&IHBTBL(3)  SETC  'NREQ'                                                        
&IHBTBL(4)  SETC  'REQ'                                                         
&IHBNUM  SETA  4                                                                
         IHBRDWRA  SCANOPT=&CHNGDIR,OPTION=CHNGDIR   GO TO OPTSCAN              
.CKCDIR1 ANOP                           RETURN FROM OPTSCAN                     
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKCDIR2     NCMD OR CMD?            
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKCDIR4     NREQ OR REQ?            
         MNOTE  4,'CHANGDIR=&CHNGDIR - INVALID IGNORED'        @P011983         
         AGO   .CKBRCKT                 NO VALID OPTIONS SPECIFIED              
.CKCDIR2 ANOP                                                                   
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).CDIRER1   NCMD AND CMD?            
         AIF   (&IHBRPLY(1)).CKCDIR3    NCMD SPECIFIED                          
         OI    &PLRH3.(1),X'20'          SET RPLCMD ON (CHNGDIR=CMD)            
         AGO   .CKCDIR4                                                         
.CKCDIR3 ANOP                                                                   
         NI    &PLRH3.(1),X'DF'          SET RPLCMD OFF (CHNGDIR=NCMD)          
.CKCDIR4 ANOP                                                                   
         AIF   (NOT(&IHBRPLY(4))).CKBRCKT                    @T4C  @03C         
         MNOTE 8,'CHNGDIR = REQ/NREQ NO LONGER SUPPORTED, IGNORED' @T4C         
         AGO   .CKBRCKT                                                         
.CDIRER1 MNOTE  4,'CMD AND NCMD SPECIFIED FOR CHNGDIR - BOTH IGNORED'           
.*                                                             @P011983         
.CKBRCKT ANOP                                                                   
         AIF   ('&BRACKET' EQ '').CKCDSEL  RESPOND OPTION SPECIFIED?            
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                        
&IHBTBL(1) SETC  'NBB'                                                          
&IHBTBL(2) SETC  'BB'                                                           
&IHBTBL(3) SETC  'NEB'                                                          
&IHBTBL(4) SETC  'EB'                                                           
&IHBTBL(5) SETC  'NCEB'                                       @P5P8891          
&IHBTBL(6) SETC  'CEB'                                        @P5P8891          
&IHBNUM  SETA  6                                              @P5P8891          
         IHBRDWRA  SCANOPT=&BRACKET,OPTION=BRACKET   GO TO OPTSCAN              
.CKBRCK1 ANOP                           RETURN FROM OPTSCAN                     
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKBRCK2     NBB OR BB?              
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKBRCK4     NEB OR EB?              
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKBRCK6     NCEB OR CEB?            
.*                                                            @P5P8891          
         MNOTE  4,'BRACKET=&BRACKET - INVALID IGNORED'         @P011983         
         AGO   .CKCDSEL                 NO VALID OPTIONS SPECIFIED              
.CKBRCK2 ANOP                                                                   
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).CBRKER1   NBB AND BB?              
         AIF   (&IHBRPLY(1)).CKBRCK3     NBB SPECIFIED                          
         OI    &PLRH3.(1),X'80'          SET RPLBB ON (BRACKET=BB)              
         AGO   .CKBRCK4                                                         
.CKBRCK3 ANOP                                                                   
         NI    &PLRH3.(1),X'7F'          SET RPLBB OFF (BRACKET=NBB)            
.CKBRCK4 ANOP                                                                   
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).CBRKER2   NEB AND EB?              
         AIF   (&IHBRPLY(3)).CKBRCK5       NEB SPECIFIED                        
         AIF   (&IHBRPLY(4) EQ 0).CKBRCK6   EB NOT SPECIFIED  @P5P8891          
         OI    &PLRH3.(1),X'40'         SET RPLEB ON (BRACKET=EB)               
         AGO   .CKBRCK6                                       @P5P8891          
.CKBRCK5 ANOP                                                                   
         NI    &PLRH3.(1),X'BF'         SET RPLEB OFF (BRACKET=NEB)             
.CKBRCK6 ANOP                                                 @P5P8891          
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).CBRKER3  CNEB AND CEB?             
.*                                                            @P5P8891          
         AIF   (&IHBRPLY(5)).CKBRCK7       NEB SPECIFIED      @P5P8891          
         AIF   (&IHBRPLY(6) EQ 0).CKCDSEL   EB NOT SPECIFIED  @P5P8891          
         OI    &PLRH3.(1),X'01'   SET RPLCEB ON (BRACKET=CEB) @P5P8891          
         AGO   .CKCDSEL                                       @D5P8891          
.CKBRCK7 ANOP                                                 @D5P8891          
         NI    &PLRH3.(1),X'FE'  SET RPLCEB OFF (BRACKET=NCEB)@D5P8891          
         AGO   .CKCDSEL                                       @P5P8891          
.CBRKER1 MNOTE  4,'BB AND NBB SPECIFIED FOR BRACKET - BOTH IGNORED'             
.*                                                             @P011983         
         AGO   .CKBRCK4                                                         
.CBRKER2 MNOTE  4,'EB AND NEB SPECIFIED FOR BRACKET - BOTH IGNORED'             
.*                                                             @P011983         
         AGO   .CKBRCK6                                       @P5P8891          
.CBRKER3 MNOTE  4,'CEB AND NCEB SPECIFIED FOR BRACKET - BOTH IGNORED'           
.*                                                             @P011983         
.CKCDSEL ANOP                                                                   
         AIF ('&CODESEL' EQ '').CKSSNS  CODESEL OPTION SPECIFIED?               
         AIF ('&CODESEL' EQ 'ALT').CKCDSL1  CODESEL OPTION (ALT)?               
     AIF ('&CODESEL' EQ 'STANDARD').CKCDSL2  CODESEL OPTION (STANDARD)?         
         MNOTE 4,'CODESEL=&CODESEL INVALID - IGNORED'          @P011983         
         AGO   .CKSSNS                                                          
.CKCDSL1 ANOP                                                                   
         OI    &PLRH3.(1),X'08'         SET RPLCSI ON (CODESEL=ALT)             
         AGO   .CKSSNS                                                          
.CKCDSL2 ANOP                                                                   
         NI    &PLRH3.(1),X'F7'        SET RPLCSI ON (CODESEL=STANDARD)         
.* ********************************************************************         
.*                     MDFYSSNS SUBROUTINE                                      
.*      GENERATES CODE TO MODIFY THE SSENSEO FIELD (RPLSSNSO)                   
.*      FIELD IN THE RPL.  ISSUES MNOTE FOR INVALID OPTIONS.                    
.* ********************************************************************         
.CKSSNS  ANOP                                                                   
         AIF ('&SSENSEO' EQ '').CKRTYP  SENSE OUTPUT OPTION SPECIFIED?          
         AIF ('&SSENSEO' EQ 'CPM').CKSSNS1                                      
         AIF ('&SSENSEO' EQ 'STATE').CKSSNS2                                    
         AIF ('&SSENSEO' EQ 'FI').CKSSNS3                                       
         AIF ('&SSENSEO' EQ 'RR').CKSSNS4                                       
         AIF ('&SSENSEO' EQ '0').CKSSNS5                       @G70AKMC         
         MNOTE 4,'SSENSEO=&SSENSEO INVALID - IGNORED'          @P011983         
         AGO   .CKRTYP                                                          
.CKSSNS1 ANOP                                                                   
         MVI   &PLSSEO.(1),X'40'        SET RPLCPMO ON (SSENSEO=CPM)            
         AGO   .CKRTYP                                                          
.CKSSNS2 ANOP                                                                   
         MVI   &PLSSEO.(1),X'20'        SET RPLSTATO ON (SSENSEO=STATE)         
         AGO   .CKRTYP                                                          
.CKSSNS3 ANOP                                                                   
         MVI   &PLSSEO.(1),X'10'        SET RPLFIO ON (SSENSEO=FI)              
         AGO   .CKRTYP                                                          
.CKSSNS4 ANOP                                                                   
         MVI   &PLSSEO.(1),X'08'        SET RPLRRO ON (SSENSEO=RR)              
         AGO   .CKRTYP                                         @G70AKMC         
.CKSSNS5 ANOP                                                  @G70AKMC         
         MVI   &PLSSEO.(1),X'00'     SET RPLRRO ON (SSENSEO=0) @G70AKMC         
.* ********************************************************************         
.*                 MDFYRTYP SUBROUTINE                                          
.* INVOKES OPTSCAN SUBROUTINE TO CHECK FOR INVALID RTYPE OPTIONS.               
.* GENERATES CODE TO MODIFY THE RTYPE FIELD (RPLRTYPE) FIELD IN THE             
.* RPL.  ISSUES MNOTES FOR MUTUALLY EXCLUSIVE OPTIONS.                          
.* ********************************************************************         
.CKRTYP  ANOP                                                                   
         AIF ('&RTYPE' EQ '').CKIBSQ       RTYPE OPTION SPECIFIED?              
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                        
&IHBTBL(1)  SETC  'NRESP'                                                       
&IHBTBL(2)  SETC  'RESP'                                                        
&IHBTBL(3)  SETC  'NDFSYN'                                                      
&IHBTBL(4)  SETC  'DFSYN'                                                       
&IHBTBL(5)  SETC  'NDFASY'                                                      
&IHBTBL(6)  SETC  'DFASY'                                                       
&IHBNUM  SETA  6                                                                
         IHBRDWRA  OPTION=RTYPE,SCANOPT=&RTYPE   GO TO OPTSCAN                  
.CKRTYP1 ANOP                           RETURN FROM OPTSCAN                     
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKRTYP2    NRESP OR RESP?           
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKRTYP4    NDFSYN OR DFSYN?         
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKRTYP6    DFASY OR NDFASY?         
         AGO   .CKIBSQ                 NO VALID OPTIONS SPECIFIED               
.CKRTYP2 ANOP                                                                   
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).RTYERR1    NRESP AND RESP?         
         AIF   (&IHBRPLY(1)).CKRTYP3    NRESP SPECIFIED                         
         OI    &PLSRTYP.(1),X'08'        SET RPLRRESP ON (RTYPE=RESP)           
         AGO   .CKRTYP4                                                         
.CKRTYP3 ANOP                                                                   
         NI    &PLSRTYP.(1),X'F7'       SET RPLRRESP OFF (RTYPE=NRESP)          
.CKRTYP4 ANOP                                                                   
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).RTYERR2  NDFSYN AND DFSYN?         
         AIF   (&IHBRPLY(3)).CKRTYP5    NDFSYN SPECIFIED                        
         AIF   (&IHBRPLY(4) EQ 0).CKRTYP6   DFSYN NOT SPECIFIED                 
         NI    &PLSRTYP.(1),X'FB'      SET RPLNFSYN OFF (RTYPE=DFSYN)           
         AGO   .CKRTYP6                                                         
.CKRTYP5 ANOP                                                                   
         OI    &PLSRTYP.(1),X'04'      SET RPLNFSYN ON (RTYPE=NDFSYN)           
.CKRTYP6 ANOP                                                                   
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).RTYERR3  NDFASY AND DFASY?         
         AIF   (&IHBRPLY(5)).CKRTYP7    NDFASY SPECIFIED                        
         AIF   (&IHBRPLY(6) EQ 0).CKIBSQ   DFASY NOT SPECIFIED                  
         OI    &PLSRTYP.(1),X'02'      SET RPLDFASY ON (RTYPE=DFASY)            
         AGO   .CKIBSQ                                                          
.CKRTYP7 ANOP                                                                   
         NI    &PLSRTYP.(1),X'FD'      SET RPLDFASY OFF (RTYPE=NDFASY)          
         AGO   .CKIBSQ                                                          
.RTYERR1 MNOTE  4,'NRESP AND RESP SPECIFIED FOR RTYPE - BOTH IGNORED'           
.*                                                             @P011983         
         AGO   .CKRTYP4                                                         
.RTYERR2 MNOTE  4,'NDFSYN AND DFSYN SPECIFIED FOR RTYPE - BOTH IGNORED'         
.*                                                             @P011983         
         AGO   .CKRTYP6                                                         
.RTYERR3 MNOTE  4,'DFASY AND NDFASY SPECIFIED FOR RTYPE - BOTH IGNORED'         
.*                                                             @P011983         
.* *******************************************************************          
.*                   MDFYIBSQ SUBROUTINE                                        
.* GENERATES CODE TO MODIFY THE IBSQAC FIELD (RPLIBSQ) IN THE RPL.              
.* ISSUES MNOTES FOR INVALID OPTIONS OR IF MORE THAN ONE OPTION IS              
.*                        SPECIFIED.                                            
.* *******************************************************************          
.CKIBSQ  ANOP                                                                   
         AIF   ('&IBSQAC' EQ '').CKOBSQ   IBSQAC OPTION SPECIFIED?              
         AIF   ('&IBSQAC' EQ 'SET').CKIBSQ2                                     
         AIF   ('&IBSQAC' EQ 'TESTSET').CKIBSQ3                                 
         AIF   ('&IBSQAC' EQ 'RESET').CKIBSQ4                                   
         AIF   ('&IBSQAC' EQ 'IGNORE').CKIBSQ5                                  
         AIF   ('&IBSQAC' EQ 'TESTPOS').CKIBSQ6                                 
         AIF   ('&IBSQAC' EQ 'TESTNEG').CKIBSQ7                                 
         AIF   ('&IBSQAC' EQ 'INVALID').CKIBSQ8                                 
         MNOTE 4,'IBSQAC=&IBSQAC INVALID - IGNORED'            @P011983         
         AGO   .CKOBSQ                                                          
.CKIBSQ2 ANOP                                                                   
         MVI   &PLIBSQ.(1),X'80'        SET RPLISET ON (IBSQAC=SET)             
         AGO   .CKOBSQ                                                          
.CKIBSQ3 ANOP                                                                   
         MVI   &PLIBSQ.(1),X'40'        SET RPLITST ON (IBSQAC=TESTSET)         
         AGO   .CKOBSQ                                                          
.CKIBSQ4 ANOP                                                                   
         MVI   &PLIBSQ.(1),X'20'        SET RPLIRSET ON (IBSQAC=RESET)          
         AGO   .CKOBSQ                                                          
.CKIBSQ5 ANOP                                                                   
         MVI   &PLIBSQ.(1),X'10'        SET RPLIIGN ON (IBSQAC=IGNORE)          
         AGO   .CKOBSQ                                                          
.CKIBSQ6 ANOP                                                                   
         MVI   &PLIBSQ.(1),X'08'        SET RPLIPOS ON (IBSQAC=TESTPOS)         
         AGO   .CKOBSQ                                                          
.CKIBSQ7 ANOP                                                                   
         MVI   &PLIBSQ.(1),X'04'        SET RPLINEG ON (IBSQAC=TESTNEG)         
         AGO   .CKOBSQ                                                          
.CKIBSQ8 ANOP                                                                   
         MVI   &PLIBSQ.(1),X'02'        SET RPLIINV ON (IBSQAC=INVALID)         
.* *******************************************************************          
.*                   MDFYOBSQ SUBROUTINE                                        
.* GENERATES CODE TO MODIFY THE 0BSQAC FIELD (RPLOBSG) IN THE RPL.              
.* ISSUES MNOTES FOR INVALID OPTIONS OR IF MORE THAN ONE OPTION IS              
.*                        SPECIFIED.                                            
.* *******************************************************************          
.CKOBSQ  ANOP                                                                   
         AIF   ('&OBSQAC' EQ '').CKUSENS  OBSQAC OPTION SPECIFIED?              
         AIF   ('&OBSQAC' EQ 'SET').CKOBSQ2                                     
         AIF   ('&OBSQAC' EQ 'TESTSET').CKOBSQ3                                 
         AIF   ('&OBSQAC' EQ 'RESET').CKOBSQ4                                   
         AIF   ('&OBSQAC' EQ 'IGNORE').CKOBSQ5                                  
         AIF   ('&OBSQAC' EQ 'TESTPOS').CKOBSQ6                                 
         AIF   ('&OBSQAC' EQ 'TESTNEG').CKOBSQ7                                 
         AIF   ('&OBSQAC' EQ 'INVALID').CKOBSQ8                                 
         MNOTE 4,'OBSQAC=&OBSQAC INVALID - IGNORED'            @P011983         
         AGO   .CKUSENS                                                         
.CKOBSQ2 ANOP                                                                   
         MVI   &PLOBSQ.(1),X'80'        SET RPLOSET ON (OBSQAC=SET)             
         AGO   .CKUSENS                                                         
.CKOBSQ3 ANOP                                                                   
         MVI   &PLOBSQ.(1),X'40'        SET RPLOTST ON (OBSQAC=TESTSET)         
         AGO   .CKUSENS                                                         
.CKOBSQ4 ANOP                                                                   
         MVI   &PLOBSQ.(1),X'20'        SET RPLORSET ON (OBSQAC=RESET)          
         AGO   .CKUSENS                                                         
.CKOBSQ5 ANOP                                                                   
         MVI   &PLOBSQ.(1),X'10'        SET RPLOIGN ON (OBSQAC=IGNORE)          
         AGO   .CKUSENS                                                         
.CKOBSQ6 ANOP                                                                   
         MVI   &PLOBSQ.(1),X'08'        SET RPLOPOS ON (OBSQAC=TESTPOS)         
         AGO   .CKUSENS                                                         
.CKOBSQ7 ANOP                                                                   
         MVI   &PLOBSQ.(1),X'04'        SET RPLONEG ON (OBSQAC=TESTNEG)         
         AGO   .CKUSENS                                                         
.CKOBSQ8 ANOP                                                                   
         MVI   &PLOBSQ.(1),X'02'        SET RPLOINV ON (OBSQAC=INVALID)         
.* ********************************************************************         
.*               CONTINUATION OF MDFYRECD SUBROUTINE                            
.*              (TO CHECK USENSEO AND STYPE OPERANDS)                           
.* ********************************************************************         
.CKUSENS ANOP                                                                   
         AIF   ('&USENSEO' EQ '').CKSIGDA IS THERE A USER SENSE PARM?           
         AIF   ('&USENSEO'(1,1) NE '(').CKUSEN1    REGISTER NOTATION?           
         STH   &USENSEO(1),&PLUSNSO.(1)   PUT USER SENSE IN THE RPL             
         AGO   .CKSIGDA                                                         
.CKUSEN1 ANOP                                                                   
&CHAR1   SETC  '&USENSEO'(1,2)                                                  
&LEN     SETA  K'&USENSEO                                                       
&CHAR2   SETC  '&USENSEO'(&LEN,1)                                               
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ5                                      
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ5                                      
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ5                                      
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ5                                      
         AIF   ('&CHAR1' EQ 'A(').IHBCKP5                                       
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP5                                       
         AIF   ('&CHAR1' EQ 'S(').IHBCKP5                                       
         AIF   ('&CHAR1' LT '0').IHBERU5                                        
         AIF   ('&CHAR1' LE '9').IHBNUM5                                        
         AIF   ('&CHAR1' LT '00').IHBERU5                                       
.IHBNUM5 ANOP                                                                   
         B     *+6                                                              
         DC    AL2(&USENSEO)      USER SENSE BYTE SPECIFIED AS NUMERIC          
         AGO   .CKUSEN2                                                         
.IHBERU5 MNOTE 4,'USENSEO=&USENSEO INVALID - IGNORED'          @P011983         
         AGO   .CKSIGDA                                                         
.IHBCKP5 AIF   ('&CHAR2' EQ ')').IHBGOP5                                        
         AGO   .IHBERQ5                                                         
.IHBCKQ5 AIF   ('&CHAR2' EQ '''').IHBGOP5                                       
.IHBERQ5 MNOTE 4,USENSEO=&USENSEO INVALID - IGNORED'           @P011983         
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'              
.*                                                             @P011983         
         AGO   .CKSIGDA                                                         
.IHBGOP5  ANOP                                                                  
&CHAR3   SETC  '&USENSEO'(3,&LEN-3)                                             
&CHAR4   SETC  '&CHAR1'(2,1)                                                    
&CHAR1   SETC  '&CHAR1'(1,1)                                                    
         B     *+6                                                              
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   USER SENSE BYTE FIELD              
.CKUSEN2 ANOP                                                                   
         LH    15,*-2                   GET USER SENSE BYTE                     
         STH   15,&PLUSNSO.(1)          PUT USER SENSE BYTE IN THE RPL          
.CKSIGDA ANOP                                                                   
         AIF   ('&SIGDATA' EQ '').CKSTYPE IS THERE SIGNAL DATA?                 
         AIF   ('&SIGDATA'(1,1) NE '(').CKSIGN1    REGISTER NOTATION?           
         ST    &SIGDATA(1),&PLSIGDA.(1)   PUT SIGNAL DATA IN THE RPL            
         AGO   .CKSTYPE                                                         
.CKSIGN1 ANOP                                                                   
&CHAR1   SETC  '&SIGDATA'(1,2)                                                  
&LEN     SETA  K'&SIGDATA                                                       
         CNOP  0,4                                           @ZA46611           
&CHAR2   SETC  '&SIGDATA'(&LEN,1)                                               
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ6                                      
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ6                                      
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ6                                      
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ6                                      
         AIF   ('&CHAR1' EQ 'A(').IHBCKP6                                       
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP6                                       
         AIF   ('&CHAR1' EQ 'S(').IHBCKP6                                       
         AIF   ('&CHAR1' LT '0').IHBERU6                                        
         AIF   ('&CHAR1' LE '9').IHBNUM6                                        
         AIF   ('&CHAR1' LT '00').IHBERU6                                       
.IHBNUM6 ANOP                                                                   
         CNOP  0,4                                                              
         B     *+8                                                              
         DC    AL4(&SIGDATA)      SIGNAL DATA SPECIFIED AS NUMERIC              
         AGO   .CKSIGN2                                                         
.IHBERU6 MNOTE 4,'SIGDATA=&SIGDATA INVALID - IGNORED'          @P011983         
         AGO   .CKSTYPE                                                         
.IHBCKP6 AIF   ('&CHAR2' EQ ')').IHBGOP6                                        
         AGO   .IHBERQ6                                                         
.IHBCKQ6 AIF   ('&CHAR2' EQ '''').IHBGOP6                                       
.IHBERQ6 MNOTE 4,'SIGDATA=&SIGDATA INVALID - IGNORED'          @P011983         
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'              
.*                                                             @P011983         
         AGO   .CKSTYPE                                                         
.IHBGOP6  ANOP                                                                  
&CHAR3   SETC  '&SIGDATA'(3,&LEN-3)                                             
&CHAR4   SETC  '&CHAR1'(2,1)                                                    
&CHAR1   SETC  '&CHAR1'(1,1)                                                    
         B     *+8                                                              
         DC    &CHAR1.L4&CHAR4&CHAR3&CHAR2   SIGNAL DATA FIELD                  
.CKSIGN2 ANOP                                                                   
         L     15,*-4                   GET SIGNAL DATA                         
         ST    15,&PLSIGDA.(1)          PUT SIGNAL DATA IN THE RPL              
.CKSTYPE ANOP                                                                   
         AIF   ('&STYPE' EQ '').CKSTYP3 IS THERE AN STYPE PARM?    @A2C         
         AIF   ('&STYPE' EQ 'REQ').CKSTYP1                                      
         AIF   ('&STYPE' EQ 'RESP').CKSTYP2                                     
         MNOTE 4,'STYPE=&STYPE INVALID - IGNORED'              @P011983         
         AGO   .CKSTYP3                                                         
.CKSTYP1 ANOP                                                                   
         NI    &PLSRTYP.(1),X'7F'       SET RPLSRESP OFF (STYPE=REQ)            
         AIF   (NOT(&IDS3270)).CKDSM    OPTCD=IDS3270 NOT CODED    @A2A         
         OI    &PLSRTYP.(1),X'40'       SET RPLS3270 ON            @A2A         
         AGO   .CKSENMO                                            @A2A         
.CKDSM   ANOP                                                      @A2A         
         NI    &PLSRTYP.(1),X'BF'       SET RPLS3270 OFF           @A2A         
         AGO   .CKSENMO                                                         
.CKSTYP2 ANOP                                                                   
         OI    &PLSRTYP.(1),X'80'       SET RPLSRESP ON (STYPE=RESP)            
         AIF   (NOT(&IDS3270)).CKSENMO                             @A2A         
         MNOTE 4,'OPTCD=IDS3270 INVALID FOR STYPE=RESP - IGNORED'  @A2A         
         AGO   .CKSENMO                                            @A2A         
.CKSTYP3 ANOP                                                                   
         AIF   ('&IHBRW' NE '34' OR NOT(&IDS3270)).CKSENMO         @A2A         
         MNOTE 4,'OPTCD=IDS3270 INVALID - STYPE UNCODED - IGNORED' @A2A         
.CKSENMO ANOP                                                                   
         AIF   ('&SSENSMO' EQ '').CKCRYPT USER SENSE PARM?   @D440518           
         AIF   ('&SSENSMO'(1,1) NE '(').CKSSEM1    REGISTER NOTATION?           
         STC   &SSENSMO,&PLSSMO.(1)   PUT USER SENSE IN THE RPL                 
         AGO   .CKCRYPT                                      @D440518           
.CKSSEM1 ANOP                                                                   
         MVI   &PLSSMO.(1),&SSENSMO   PUT USER SENSE IN THE RPL                 
.CKCRYPT ANOP                                                @D440518           
         AIF   ('&CRYPT' EQ '').CKBRNCH CRYPT PARAMETER?     @D440518           
         AIF   ('&CRYPT'(1,3) EQ 'YES').CRYES CRYPT REQUEST? @D440518           
         AIF   ('&CRYPT'(1,2) EQ 'NO').CRYNO CRYPT NON-REQ.? @D440518           
         MNOTE  4,'CRYPT=&CRYPT INVALID-IGNORED'             @D440518           
         AGO   .CKBRNCH                                      @ZM35828           
.CRYES   ANOP                                                @ZM35828           
         OI    &PLEXTDS.(1),X'08'  SET CRYPT REQUEST ON      @XM31389           
         AGO   .CKBRNCH                                      @ZM35828           
.CRYNO   ANOP                                                @ZM35828           
         NI    &PLEXTDS.(1),X'F7'  SET CRYPT OFF             @XM31389           
.* *************** END VTL ADDITIONS **********************                     
.CKBRNCH ANOP                                                                   
         AIF   ('&BRANCH' EQ '').GENLBL1 IS THERE AN BRANCH PARAMETER?          
         AIF   ('&BRANCH'(1,3) EQ 'YES').BRYES  REGISTER NOTATION?              
         AIF   ('&BRANCH'(1,2) EQ 'NO').BRNO  REGISTER NOTATION?                
         MNOTE 4,'BRANCH=&BRANCH IS NOT A VALID PARAMETER - IGNORED'            
.*                                                           @P011983           
         AGO   .GENLBL1                                                         
.BRYES   ANOP                                                                   
         OI    &PLEXTDS.(1),X'02'     SET BRANCH ENTRY BIT ON                   
         AGO   .GENLBL1                                                         
.BRNO    ANOP                                                                   
         NI    &PLEXTDS.(1),X'FD'     SET BRANCH ENTRY BIT OFF                  
.GENLBL1 ANOP                                                                   
         AIF   ('&IHBRW' EQ '').GENREQ                             @A1A         
         B     *+14                  Skip negative code            @A1A         
IHB&SYSNDX  EQU   *                                                             
         LA    0,&IHBRW              Load request code             @A1A         
         LCR   0,0                   Set negative to signal error  @A1A         
         B     IHB&SYSNDX.A          Continue                      @A1A         
.GENREQ  ANOP                                                                   
         AIF   ('&IHBRW' NE '').OKIBRW  IS THERE AN IHBRW PARAMETER?            
IHB&SYSNDX  EQU   *                                                @A1A         
         MNOTE 4,'IHBRW= WAS NOT SPECIFIED'                                     
         SR    0,0                   IHBRW NOT SPECIFIED OR INVALID             
         AGO   .ENDRTN                                                          
.OKIBRW  ANOP                                                                   
         LA    0,&IHBRW                        LOAD REQUEST CODE                
.ENDRTN  ANOP                                                                   
IHB&SYSNDX.A EQU   *                                               @A1A         
         L     15,&PLDACB.(1)        GET ADDRESS OF ACB                         
         L     15,&ACBRTN.(15)       GET ADDRESS OF INTERFACE RTN               
         BALR  14,15                 GO TO THE INTERFACE ROUTINE                
         MEXIT                                                                  
.NORPL   ANOP                                                                   
         MNOTE 12,'RPL= WAS NOT SPECIFIED'                                      
         MEXIT                                                                  
.* *************** VTL ADDITIONS ****************                               
.* ********************************************************************         
.*                          OPTSCAN SUBROUTINE                                  
.* SCANS ANY SET OF OPTIONS AGAINST A TABLE OF VALID VALUES AND SETS            
.* BITS IN A REPLY FIELD FOR EACH VALID OPTION FOUND.  GENERATES AN             
.* MNOTE FOR EACH OPTION NOT IN THE TABLE OR SPECIFIED MORE THAN ONCE.          
.* THE CALLING SUBROUTINE MUST CHECK TO SEE IF MUTUALLY EXCLUSIVE               
.* OPTIONS HAVE BEEN SPECIFIED SINCE OPTSCAN CANNOT.  THE CALLING               
.* SUBROUTINE MUST PASS THE VALID VALUES FOR THE OPTION TO BE CHECKED           
.* IN THE ORDER IN WHICH THE REPLY BITS ARE TO BE SET (LEFT-TO RIGHT)           
.* IN A TABLE UNDER THE NAME '&IHBTBL' AND HAVE EACH ENTRY IN THE               
.* TABLE IN AN EIGHT-BYTE FIELD PADDED TO THE RIGHT.  THE NUMBER OF             
.* ENTRIES IN THE TABLE MUST BE IN A FIELD CALLED '&IHBNUM'.  THE               
.* SUBROUTINE IS CALLED BY INVOKING IHBRDWRA RECURSIVELY USING THE              
.* OPERANDS 'SCANOPT' TO PASS THE OPTIONS SPECIFIED BY THE USER AND             
.* 'OPTION' TO INDICATE THE NAME OF THE PARAMETER WHOSE OPERANDS ARE            
.* BEING VALIDATED.  THE OPTSCAN SUBROUTINE WILL SET THE BITS IN A              
.* FIELD CALLED '&IHBRPLY' ON IF AN OPTION IS PRESENT, THE BITS BEING           
.* REPRESENTED IN THE SAME LEFT-TO-RIGHT ORDER AS WERE THE ENTRIES              
.*                    IN THE FIELD '&IHBTBL'.                                   
.* ********************************************************************         
.OPTSCAN ANOP                                                                   
&NUM2    SETA  &IHBNUM                                                          
&NUM     SETA  &IHBNUM                                                          
&NM      SETA  N'&SCANOPT                                                       
.OPTSCN1 ANOP                                                                   
&IHBRPLY(&NUM2)  SETB  0                LOOP TO INITIALIZE                      
&NUM2    SETA  &NUM2-1                    REPLY FIELD                           
         AIF   (&NUM2 GT 0).OPTSCN1                                             
.OPTSCN2 ANOP                                                                   
&LEN     SETA  K'&SCANOPT(&NM)      NUMBER OF CHARS IN VALUE                    
         AIF   (&LEN EQ 0).REINDEX  IGNORE IF NULL PARAMETER   @OY06517         
&OPT     SETC  '&SCANOPT(&NM)'                                                  
.OPTSCN3 ANOP                                                                   
         AIF ('&OPT' NE '&IHBTBL(&NUM)'(1,&LEN)).RESCAN                         
         AIF   (&IHBRPLY(&NUM) EQ 0).SETBIT                                     
         MNOTE 4,'&OPTION=&OPT SPECIFIED MORE THAN ONCE - ACCEPTED'             
.*                                                             @P011983         
         AGO   .REINDEX                                                         
.SETBIT  ANOP                                                                   
&IHBRPLY(&NUM)  SETB  1       TURN ON BIT IN REPLY FIELD                        
         AGO   .REINDEX                                                         
.RESCAN  ANOP                                                                   
&NUM  SETA  &NUM-1    SET POINTER TO PREVIOUS ENTRY IN TABLE                    
         AIF   (&NUM GT 0).OPTSCN3                                              
         MNOTE 4,'&OPTION=&OPT INVALID - IGNORED'              @P011983         
.REINDEX ANOP                                                                   
&NUM     SETA  &IHBNUM                                                          
         AIF   (&NM EQ 1).OPTSCN4     ALL VALUES CHECKED                        
&NM      SETA  &NM-1                  DECREMENT VALUE COUNTER                   
         AGO   .OPTSCN2                                                         
.OPTSCN4 ANOP                     RETURN TO CALLING SUBROUTINE:                 
.* ************ END VTL ADDITIONS ***************                               
         MEND                                                                   

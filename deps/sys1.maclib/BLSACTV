*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  BLSACTV                               -01/21/20-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  IPCS Active interfaces                        * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2001, 2021                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77D0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      BLSACTV provides interfaces to access storage in the active    * 00002100
*      system.                                                        * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00002400
*                                                                     * 00002500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002600
*                                                                     * 00002700
*01* ENVIRONMENT:                                                     * 00002800
*                                                                     * 00002900
*                                                                     * 00003000
*      Minimum authorization:                                         * 00003100
*                                                                     * 00003200
*                        The minimum authority for BLSACTV is problem * 00003300
*                        state and PSW key 8-15.                      * 00003400
*                                                                     * 00003500
*      Dispatchable unit mode: Task mode.                             * 00003600
*                                                                     * 00003700
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00003800
*                                                                     * 00003900
*      AMODE:            31- or 64-bit.                               * 00004000
*                                                                     * 00004100
*      ASC mode:         Primary or Access Register.                  * 00004200
*                                                                     * 00004300
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004400
*                                                                     * 00004500
*      Locks:            The caller must not hold any locks on entry. * 00004600
*                                                                     * 00004700
*      Control parameters:     Control parameters must be in the      * 00004800
*                        primary address space or, for AR-mode        * 00004900
*                        callers, must be in an address/data space    * 00005000
*                        that is addressable through a public entry   * 00005100
*                        on the caller's dispatchable unit access     * 00005200
*                        list (DU-AL) or primary address space access * 00005300
*                        list (PASN-AL) for SCOPE=COMMON data space.  * 00005400
*                        If control parameters reside in non-primary  * 00005500
*                        address space then address space control     * 00005600
*                        (ASC) environment must be set for            * 00005700
*                        compile/runtime using SYSTATE ASCENV=AR and  * 00005800
*                        SAC 512.  If control parameters reside in    * 00005900
*                        64-bit storage then addressing environment   * 00006000
*                        must be set for compile/runtime using        * 00006100
*                        SYSTATE AMODE64=YES and SAM64.               * 00006200
*                                                                     * 00006300
*                        The user-provided buffer (via the BUFFER or  * 00006400
*                        BUFFER64 parameter) has the same             * 00006500
*                        requirements and restrictions as the control * 00006600
*                        parameters.  Note. User-provided buffer for  * 00006700
*                        ZZZASTA requests must be in the primary      * 00006800
*                        address space and reside in 31-bit storage.  * 00006900
*                        User-provided buffer for ZZZASTDS requests   * 00007000
*                        for other owner's SCOPE=SINGLE data space    * 00007100
*                        must be in the primary address space.        * 00007200
*                                                                     * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*01* PROGRAMMING REQUIREMENTS:                                        * 00007600
*                                                                     * 00007700
*    The caller should include the BLSZACTV macro get equate symbols  * 00007800
*    for the return and reason codes.                                 * 00007900
*                                                                     * 00008000
*01* RESTRICTIONS:                                                    * 00008100
*                                                                     * 00008200
*    BLSACTV must not be issued while a functional recovery routine   * 00008300
*    (FRR) is established.                                            * 00008400
*                                                                     * 00008500
*01* INPUT REGISTER INFORMATION:                                      * 00008600
*                                                                     * 00008700
*    Before issuing the BLSACTV macro, the caller does not have to    * 00008800
*    place any information into any general purpose register (GPR) or * 00008900
*    access register (AR) unless using it in register notation for a  * 00009000
*    particular parameter, or using it as a base register.            * 00009100
*                                                                     * 00009200
*01* OUTPUT REGISTER INFORMATION:                                     * 00009300
*                                                                     * 00009400
*    When control returns to the caller, the GPRs contain:            * 00009500
*                                                                     * 00009600
*                                                                     * 00009700
*    REGISTER    CONTENTS                                             * 00009800
*                                                                     * 00009900
*    0           The value placed in register 0 by the target routine * 00010000
*                prior to its returning to the system.                * 00010100
*                                                                     * 00010200
*    1           The value placed in register 1 by the target routine * 00010300
*                prior to its returning to the system.                * 00010400
*                                                                     * 00010500
*    2-13        Unchanged                                            * 00010600
*                                                                     * 00010700
*    14          Used as a work register by the system                * 00010800
*                                                                     * 00010900
*    15          The value placed in register 15 by the target        * 00011000
*                routine prior to its returning to the system.        * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*    When control returns to the caller, the ARs contain:             * 00011500
*                                                                     * 00011600
*                                                                     * 00011700
*    REGISTER    CONTENTS                                             * 00011800
*                                                                     * 00011900
*    0           The value placed in access register 0 by the target  * 00012000
*                routine prior to its returning to the system.        * 00012100
*                                                                     * 00012200
*    1           The value placed in access register 1 by the target  * 00012300
*                routine prior to its returning to the system.        * 00012400
*                                                                     * 00012500
*    2-13        Unchanged                                            * 00012600
*                                                                     * 00012700
*    14          Used as a work register by the system                * 00012800
*                                                                     * 00012900
*    15          The value placed in access register 15 by the target * 00013000
*                routine prior to its returning to the system.        * 00013100
*                                                                     * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*    Some callers depend on register contents remaining the same      * 00013500
*    before and after issuing a service.  If the system changes the   * 00013600
*    contents of registers on which the caller depends, the caller    * 00013700
*    must save them before issuing the service, and restore them      * 00013800
*    after the system returns control.                                * 00013900
*                                                                     * 00014000
*01* PERFORMANCE IMPLICATIONS:                                        * 00014100
*    None.                                                            * 00014200
*                                                                     * 00014300
*01* SYNTAX:                                                          * 00014400
*                                                                     * 00014500
*Ýxlabel¨  BLSACTV     SPACEID=xspaceid                               * 00014600
*                   Ð ,AREAADDR=xareaaddr                             * 00014700
*                   Ô ,AREAADDR64=xareaaddr64                         * 00014800
*                   ¿ ,AREAADDR64C=xareaaddr64c                       * 00014900
*                   Ð ,BUFFER=Ýxbuffer¨                               * 00015000
*                   ¿ ,BUFFER64=Ýxbuffer64¨                           * 00015100
*                     ,BUFFERLEN=xbufferlen                           * 00015200
*                    Ý,BUFFERLENV=xbufferlenv¨                        * 00015300
*                    Ý,AUTHSTATE=xauthstate¨                          * 00015400
*                    Ý,AREAKEY=xareakey¨                              * 00015500
*                    Ý,NEXTKEY=xnextkey¨                              * 00015600
*                   ÐÝ,FIRSTADDR64=Ýxfirstaddr64¨                     * 00015700
*                   ¿ ,FIRSTADDR64C=Ýxfirstaddr64c¨¨                  * 00015800
*                   ÐÝ,LASTADDR64=Ýxlastaddr64¨                       * 00015900
*                   ¿ ,LASTADDR64C=Ýxlastaddr64c¨¨                    * 00016000
*                    Ý,COMPCODE=xcompcode¨                            * 00016100
*                    Ý,COMPRSN=xcomprsn¨                              * 00016200
*                    Ý,RETCODE=xretcode¨                              * 00016300
*                    Ý,RSNCODE=xrsncode¨                              * 00016400
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00016500
*                   ÐÝ,MF=S¨                                          * 00016600
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00016700
*                   ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00016800
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*      Where:                                                         * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*      Ýxlabel¨                                                       * 00017500
*          is an optional symbol, starting in column 1, that is the   * 00017600
*          name on the BLSACTV macro invocation.  The name must       * 00017700
*          conform to the rules for an ordinary assembler language    * 00017800
*          symbol.                                                    * 00017900
*          DEFAULT: No name.                                          * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      SPACEID=xspaceid                                               * 00018500
*          is the name (RX-type), or address in register (2)-(12), of * 00018600
*          a required 16 character input that identifies the space to * 00018700
*          be used. Macro BLSRDATS declares the structure in which    * 00018800
*          user encodes address space type, address space             * 00018900
*          identification and data space name. ZZZASTA, ZZZASTCV and  * 00019000
*          ZZZASTDS types are supported.                              * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*      The following is a set of mutually exclusive keys.  This set   * 00019600
*      is required; only one key must be specified.                   * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*      AREAADDR=xareaaddr                                             * 00020000
*          belongs to a set of mutually exclusive keys. It is the     * 00020100
*          name (RX-type), or address in register (2)-(12), of a 4    * 00020200
*          byte input that contains the address of the area in 31-bit * 00020300
*          storage to be fetched into the provided buffer             * 00020400
*                                                                     * 00020500
*      AREAADDR64=xareaaddr64                                         * 00020600
*          belongs to a set of mutually exclusive keys. It is the     * 00020700
*          name (RX-type), or address in register (2)-(12), of an 8   * 00020800
*          byte input that contains the address of the area to be     * 00020900
*          fetched into the provided buffer                           * 00021000
*                                                                     * 00021100
*      AREAADDR64C=xareaaddr64c                                       * 00021200
*          belongs to a set of mutually exclusive keys. It is the     * 00021300
*          name (RX-type), or address in register (2)-(12), of an 8   * 00021400
*          character input that contains the address of the area to   * 00021500
*          be fetched into the provided buffer.  This is the          * 00021600
*          character equivalent of the PTR(64) of AREAADDR64.         * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*      End of a set of mutually exclusive required keys.              * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*      The following is a set of mutually exclusive keys.  This set   * 00022500
*      is required; only one key must be specified.                   * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*      BUFFER=Ýxbuffer¨                                               * 00022900
*          belongs to a set of mutually exclusive keys. It is the     * 00023000
*          name (RX-type), or address in register (2)-(12), of a      * 00023100
*          character output that is to receive a copy of the area     * 00023200
*          specified by the AREAADDR or AREAADDR64 parameter.         * 00023300
*                                                                     * 00023400
*      BUFFER64=Ýxbuffer64¨                                           * 00023500
*          belongs to a set of mutually exclusive keys. It is the     * 00023600
*          name (RX-type), or address in register (2)-(12), of a      * 00023700
*          character output that is to receive a copy of the area     * 00023800
*          specified by the AREAADDR or AREAADDR64 parameter.         * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*      End of a set of mutually exclusive required keys.              * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*      BUFFERLEN=xbufferlen                                           * 00024700
*          is the name (RX-type), or address in register (2)-(12), of * 00024800
*          a required fullword input that contains the 31-bit length  * 00024900
*          of the buffer                                              * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*      ÝBUFFERLENV=xbufferlenv¨                                       * 00025500
*          is the name (RX-type), or address in register (2)-(12), of * 00025600
*          an optional fullword output that is to contain the number  * 00025700
*          of valid bytes placed into the buffer.                     * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*                                                                     * 00026200
*      ÝAUTHSTATE=xauthstate¨                                         * 00026300
*          is the name (RX-type), or address in register (2)-(12), of * 00026400
*          an optional byte output that is to contain the             * 00026500
*          authorization of the caller as determined by RACF          * 00026600
*          facility-class profiles.  Refer to equate symbols          * 00026700
*          BLSACTV_AUTHSTATE_xxx in macro BLSZACTV.                   * 00026800
*                                                                     * 00026900
*          The users with 'BLSACTV.SYSTEM' authority have access to   * 00027000
*          the absolute storage and whole virtual storage in any      * 00027100
*          address/data spaces. The users that run in supervisor      * 00027200
*          state or key < 8 have the same capabilities.               * 00027300
*                                                                     * 00027400
*          The users with 'BLSACTV.ADDRSPAC' authority have access to * 00027500
*          the whole virtual storage in primary address space and     * 00027600
*          SCOPE=COMMON or own SCOPE=SINGLE/ALL data spaces.          * 00027700
*                                                                     * 00027800
*          All other users have the same capabilities as the users    * 00027900
*          with 'BLSACTV.ADDRSPAC' authority except the accessible    * 00028000
*          virtual storage must have the caller's key or must be non  * 00028100
*          fetch-protected.                                           * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*      ÝAREAKEY=xareakey¨                                             * 00028700
*          is the name (RX-type), or address in register (2)-(12), of * 00028800
*          an optional byte output that is to contain the key of the  * 00028900
*          first byte of the area fetched into the provided area.     * 00029000
*          Note that the key will be in bits 0-3 (not 4-7) of the     * 00029100
*          byte.                                                      * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*      ÝNEXTKEY=xnextkey¨                                             * 00029700
*          is the name (RX-type), or address in register (2)-(12), of * 00029800
*          an optional byte output that is to contain the key of the  * 00029900
*          first byte of the area when a key was changed during       * 00030000
*          storage fetch. Note that the key will be in bits 0-3 (not  * 00030100
*          4-7) of the byte.  This field will only be valid for       * 00030200
*          reason code BlsactvRsnDifferentKey.                        * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*      The following is a set of mutually exclusive keys.  This set   * 00030800
*      is optional; only one key may be specified.                    * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*      ÝFIRSTADDR64=Ýxfirstaddr64¨                                    * 00031200
*          belongs to a set of mutually exclusive keys. It is the     * 00031300
*          name (RX-type), or address in register (2)-(12), of an     * 00031400
*          optional 8 byte output that will contain the address of    * 00031500
*          the first byte of the unavailable area. This field will    * 00031600
*          only be valid for reason code BlsactvRsnAreaNotAvailable.  * 00031700
*                                                                     * 00031800
*      FIRSTADDR64C=Ýxfirstaddr64c¨¨                                  * 00031900
*          belongs to a set of mutually exclusive keys. It is the     * 00032000
*          name (RX-type), or address in register (2)-(12), of an     * 00032100
*          optional 8 character output of the first byte of the       * 00032200
*          unavailable area. This field will only be valid for reason * 00032300
*          code BlsactvRsnAreaNotAvailable.  This is the character    * 00032400
*          equivalent of the PTR(64) of FIRSTADDR64.                  * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*      End of a set of mutually exclusive optional keys.              * 00032900
*      DEFAULT: FIRSTADDR64                                           * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*      The following is a set of mutually exclusive keys.  This set   * 00033400
*      is optional; only one key may be specified.                    * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*      ÝLASTADDR64=Ýxlastaddr64¨                                      * 00033800
*          belongs to a set of mutually exclusive keys. It is the     * 00033900
*          name (RX-type), or address in register (2)-(12), of an     * 00034000
*          optional 8 byte output that will contain the address of    * 00034100
*          the last byte of the unavailable area. This field will     * 00034200
*          only be valid for reason code BlsactvRsnAreaNotAvailable.  * 00034300
*                                                                     * 00034400
*      LASTADDR64C=Ýxlastaddr64c¨¨                                    * 00034500
*          belongs to a set of mutually exclusive keys. It is the     * 00034600
*          name (RX-type), or address in register (2)-(12), of an     * 00034700
*          optional 8 character output of the last byte of the        * 00034800
*          unavailable area. This field will only be valid for reason * 00034900
*          code BlsactvRsnAreaNotAvailable.  This is the character    * 00035000
*          equivalent of the PTR(64) of LASTADDR64.                   * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*      End of a set of mutually exclusive optional keys.              * 00035500
*      DEFAULT: LASTADDR64                                            * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*      ÝCOMPCODE=xcompcode¨                                           * 00036000
*          is the name (RX-type), or address in register (2)-(12), of * 00036100
*          an optional fullword output that is the completion code    * 00036200
*          associated with an error accessing the area specified by   * 00036300
*          the AREAADDR parameter.  It is in the format of the        * 00036400
*          SDWACMPC field mapped by IHASDWA.  For example, a system   * 00036500
*          completion code of 0C4 would result in a value of          * 00036600
*          X'000C4000'.  The value is valid only for reason codes     * 00036700
*          BlsactvRsnAreaNotAvailable and BlsctvRsnBadBuffer.         * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*      ÝCOMPRSN=xcomprsn¨                                             * 00037300
*          is the name (RX-type), or address in register (2)-(12), of * 00037400
*          an optional fullword output that is the reason code        * 00037500
*          associated with the completion code returned by the        * 00037600
*          COMPCODE parameter.  The value is valid only for reason    * 00037700
*          codes BlsactvRsnAreaNotAvailable and BlsctvRsnBadBuffer.   * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*                                                                     * 00038200
*      ÝRETCODE=xretcode¨                                             * 00038300
*          is the name (RS-type) of an optional fullword output       * 00038400
*          variable, or register (2)-(12) or (15), into which the     * 00038500
*          return code is to be copied from GPR 15.  If you specify   * 00038600
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00038700
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00038800
*          with MF=M.                                                 * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*      ÝRSNCODE=xrsncode¨                                             * 00039400
*          is the name (RS-type) of an optional fullword output       * 00039500
*          variable into which the reason code is to be copied from   * 00039600
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00039700
*          R0 (within or without parentheses), the value will be left * 00039800
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00040400
*          is an optional byte input decimal value in the "1-1" range * 00040500
*          that specifies the macro version.  PLISTVER is the only    * 00040600
*          key allowed on the list form of MF and determines which    * 00040700
*          parameter list is generated.  Note that MAX may be         * 00040800
*          specified instead of a number, and the parameter list will * 00040900
*          be of the largest size currently supported. This size may  * 00041000
*          grow from release to release (thus possibly affecting the  * 00041100
*          amount of storage needed by your program).  If your        * 00041200
*          program can tolerate this, IBM recommends that you always  * 00041300
*          specify MAX when creating the list form parameter list as  * 00041400
*          that will ensure that the list form parameter list is      * 00041500
*          always long enough to hold whatever parameters might be    * 00041600
*          specified on the execute form.                             * 00041700
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00041800
*          default is the lowest version which allows all of the      * 00041900
*          parameters specified on the invocation to be processed.    * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*      ÝMF=»S!L!M!Eº¨                                                 * 00042500
*          is an optional keyword input which specifies the macro     * 00042600
*          form.                                                      * 00042700
*          DEFAULT: S                                                 * 00042800
*                                                                     * 00042900
*                                                                     * 00043000
*          ÝMF=S¨                                                     * 00043100
*              specifies the standard form of the macro.  The "S"     * 00043200
*              form generates code to put the parameters into an      * 00043300
*              in-line parameter list and invoke the desired service. * 00043400
*              Full checking for required macro keys is done along    * 00043500
*              with supplying defaults for omitted optional           * 00043600
*              parameters.                                            * 00043700
*                                                                     * 00043800
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00043900
*              specifies the list form of the macro.  The "L" form    * 00044000
*              defines an area to be used for the parameter list.     * 00044100
*              Only the PLISTVER key may be specified on the          * 00044200
*              invocation.  All other macro parameters are flagged as * 00044300
*              errors.  If PLISTVER is not specified, the original    * 00044400
*              parameter list definition is used.                     * 00044500
*                                                                     * 00044600
*            ,xmfctrl                                                 * 00044700
*              is a required input.  It is the name of a storage area * 00044800
*              for the parameter list.                                * 00044900
*                                                                     * 00045000
*            »,xmfattr!0Dº                                            * 00045100
*              is an optional 60 character input string that varies   * 00045200
*              from 1 to 60 characters. Use it to force boundary      * 00045300
*              alignment of the parameter list. Use only 0F or 0D.    * 00045400
*              DEFAULT: 0D which forces the parameter list to a       * 00045500
*              doubleword boundary.                                   * 00045600
*                                                                     * 00045700
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00045800
*              specifies the modify form of the macro.  The "M" form  * 00045900
*              generates code to put the parameters into the          * 00046000
*              parameter list specified by xmfctrl.                   * 00046100
*                                                                     * 00046200
*            ,xmfctrl                                                 * 00046300
*              is a required input.  It is the name (RS-type), or     * 00046400
*              address in register (1)-(12), of a storage area for    * 00046500
*              the parameter list.                                    * 00046600
*                                                                     * 00046700
*            »,COMPLETE!NOCHECKº¨                                     * 00046800
*              is an optional keyword input which specifies the       * 00046900
*              degree of macro parameter syntax checking.             * 00047000
*              DEFAULT: COMPLETE                                      * 00047100
*                                                                     * 00047200
*                                                                     * 00047300
*              COMPLETE                                               * 00047400
*                  Checking for required macro keys is done and       * 00047500
*                  defaults are supplied for omitted optional         * 00047600
*                  parameters.  (See Macro Usage Note 2).             * 00047700
*                                                                     * 00047800
*              NOCHECK                                                * 00047900
*                  Checking for required macro keys is not done nor   * 00048000
*                  are defaults supplied for omitted optional         * 00048100
*                  parameters.                                        * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                                                                     * 00048500
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00048600
*              specifies the execute form of the macro.  The "E" form * 00048700
*              generates code to put the parameters into the          * 00048800
*              parameter list specified by xmfctrl and invoke the     * 00048900
*              desired service.                                       * 00049000
*                                                                     * 00049100
*            ,xmfctrl                                                 * 00049200
*              is a required input.  It is the name (RS-type), or     * 00049300
*              address in register (1)-(12), of a storage area for    * 00049400
*              the parameter list.                                    * 00049500
*                                                                     * 00049600
*            »,COMPLETE!NOCHECKº                                      * 00049700
*              is an optional keyword input which specifies the       * 00049800
*              degree of macro parameter syntax checking.             * 00049900
*              DEFAULT: COMPLETE                                      * 00050000
*                                                                     * 00050100
*                                                                     * 00050200
*              COMPLETE                                               * 00050300
*                  Checking for required macro keys is done and       * 00050400
*                  defaults are supplied for omitted optional         * 00050500
*                  parameters.  (See Macro Usage Note 2).             * 00050600
*                                                                     * 00050700
*              NOCHECK                                                * 00050800
*                  Checking for required macro keys is not done nor   * 00050900
*                  are defaults supplied for omitted optional         * 00051000
*                  parameters.                                        * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*01* ABEND CODES:  None.                                              * 00051900
*                                                                     * 00052000
*       None.                                                         * 00052100
*                                                                     * 00052200
*01* RETURN CODES:                                                    * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*                 Macro BLSZACTV provides equate symbols for the      * 00052600
*                 return and reason codes.                            * 00052700
*                                                                     * 00052800
*       0         Name: BlsactvRC_0                                   * 00052900
*                                                                     * 00053000
*                 Meaning: BLSACTV request successful.                * 00053100
*                                                                     * 00053200
*                 Action: None required.                              * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                 HEX REASON  MEANING/ACTION                          * 00053600
*                 CODE                                                * 00053700
*                                                                     * 00053800
*                 0           Name: BlsactvRsn_0                      * 00053900
*                                                                     * 00054000
*                             Meaning: BLSACTV request successful.    * 00054100
*                                                                     * 00054200
*                             Action: None required.                  * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*                                                                     * 00054700
*       4         Name: BlsactvRC_4                                   * 00054800
*                                                                     * 00054900
*                 Meaning: Environmental error                        * 00055000
*                                                                     * 00055100
*                 Action:  Refer to the action provided with the      * 00055200
*                 specific reason code.                               * 00055300
*                                                                     * 00055400
*                                                                     * 00055500
*                 HEX REASON  MEANING/ACTION                          * 00055600
*                 CODE                                                * 00055700
*                                                                     * 00055800
*                 xxxx0401    Name: BlsactvRsnAreaNotAvailable        * 00055900
*                                                                     * 00056000
*                             Meaning: Unable to access source area.  * 00056100
*                                                                     * 00056200
*                             Action: Make sure that the requested    * 00056300
*                             area of storage is valid.  If the       * 00056400
*                             length returned via the BUFFERLENV      * 00056500
*                             parameter is not 0 then that amount of  * 00056600
*                             storage has been copied to the provided * 00056700
*                             buffer and can be examined. FIRSTADDR64 * 00056800
*                             and LASTADDR64 contain first and last   * 00056900
*                             addresses of unavailable storage        * 00057000
*                             correspondingly.                        * 00057100
*                                                                     * 00057200
*                 xxxx0402    Name: BlsactvRsnDifferentKey            * 00057300
*                                                                     * 00057400
*                             Meaning: The page being fetched has a   * 00057500
*                             different key than the previous page    * 00057600
*                             that had been fetched. Fetching stops.  * 00057700
*                             The key is returned via the NEXTKEY     * 00057800
*                             parmeter. The BUFFERLENV parameter will * 00057900
*                             contain the length of the fetched       * 00058000
*                             storage.                                * 00058100
*                                                                     * 00058200
*                             Action: None required.                  * 00058300
*                                                                     * 00058400
*                 xxxx0403    Name: BlsactvRsnAddrWrapar              * 00058500
*                                                                     * 00058600
*                             Meaning: The fetched page is a last     * 00058700
*                             possible page for 64-bit addressing.    * 00058800
*                             Fetching stops. LASTADDR64 contains     * 00058900
*                             maximum possible 64-bit address. The    * 00059000
*                             BUFFERLENV parameter will contain the   * 00059100
*                             length of the fetched storage.          * 00059200
*                                                                     * 00059300
*                             Action: None required.                  * 00059400
*                                                                     * 00059500
*                                                                     * 00059600
*                                                                     * 00059700
*                                                                     * 00059800
*       8         Name: BlsactvRC_8                                   * 00059900
*                                                                     * 00060000
*                 Meaning:  BLSACTV request specifies parameters that * 00060100
*                 are not valid.                                      * 00060200
*                                                                     * 00060300
*                 Action:  Refer to the action provided with the      * 00060400
*                 specific reason code.                               * 00060500
*                                                                     * 00060600
*                                                                     * 00060700
*                 HEX REASON  MEANING/ACTION                          * 00060800
*                 CODE                                                * 00060900
*                                                                     * 00061000
*                 xxxx0801    Name: BlsactvRsnBadBuffer               * 00061100
*                                                                     * 00061200
*                             Meaning: Unable to store into provided  * 00061300
*                             buffer.                                 * 00061400
*                                                                     * 00061500
*                             Action: Check for one of possible       * 00061600
*                             errors:  Program exception during       * 00061700
*                             access the buffer.  The buffer has zero * 00061800
*                             address and ALET but its length is not  * 00061900
*                             zero.  Invalid buffer ALET.  The sum of * 00062000
*                             buffer address and its length exceeds   * 00062100
*                             maximium 64-bit address.                * 00062200
*                                                                     * 00062300
*                 xxxx0802    Name: BlsactvRsnBadVersion              * 00062400
*                                                                     * 00062500
*                             Meaning: Incorrect version number in    * 00062600
*                             the parameter list.                     * 00062700
*                                                                     * 00062800
*                             Action: Check the version and possible  * 00062900
*                             storage overlay.                        * 00063000
*                                                                     * 00063100
*                 xxxx0803    Name: BlsactvRsnBadReserved             * 00063200
*                                                                     * 00063300
*                             Meaning: Incorrect reserved field in    * 00063400
*                             the parameter list.                     * 00063500
*                                                                     * 00063600
*                             Action: Check the version and possible  * 00063700
*                             storage overlay.                        * 00063800
*                                                                     * 00063900
*                 xxxx0804    Name: BlsactvRsnAreaAddrNot4KBoundary   * 00064000
*                                                                     * 00064100
*                             Meaning: The area to be fetched is not  * 00064200
*                             on a 4K boundary.                       * 00064300
*                                                                     * 00064400
*                             Action: Specify an area on a 4K         * 00064500
*                             boundary.                               * 00064600
*                                                                     * 00064700
*                 xxxx0805    Name: BlsactvRsnLengthNot4KMultiple     * 00064800
*                                                                     * 00064900
*                             Meaning:  The length to be fetched is   * 00065000
*                             negative or is not a 4K multiple.       * 00065100
*                                                                     * 00065200
*                             Action: Specify positive length that is * 00065300
*                             a 4K boundary.                          * 00065400
*                                                                     * 00065500
*                 xxxx0806    Name: BlsactvRsnNotAuthorized           * 00065600
*                                                                     * 00065700
*                             Meaning: Program is not authorized for  * 00065800
*                             the type of request.                    * 00065900
*                                                                     * 00066000
*                             Action:  Check program authorization    * 00066100
*                             and the type of the request in SPACEID. * 00066200
*                                                                     * 00066300
*                 xxxx0807    Name: BlsactvRsnInvSpaceid              * 00066400
*                                                                     * 00066500
*                             Meaning: Invalid value in SPACEID       * 00066600
*                             parameter.                              * 00066700
*                                                                     * 00066800
*                             Action: Check the values in SPACEID     * 00066900
*                             parameter.                              * 00067000
*                                                                     * 00067100
*                 xxxx0808    Name: BlsactvRsnASNotFound              * 00067200
*                                                                     * 00067300
*                             Meaning: Specified address space is not * 00067400
*                             found.                                  * 00067500
*                                                                     * 00067600
*                             Action: Check ASID value in SPACEID     * 00067700
*                             parameter.                              * 00067800
*                                                                     * 00067900
*                 xxxx0809    Name: BlsactvRsnDSNotFound              * 00068000
*                                                                     * 00068100
*                             Meaning: Specified data space is not    * 00068200
*                             found.                                  * 00068300
*                                                                     * 00068400
*                             Action: Check ASID and data space name  * 00068500
*                             values in SPACEID parameter.            * 00068600
*                                                                     * 00068700
*                                                                     * 00068800
*                                                                     * 00068900
*       C         Name: BlsactvRC_12                                  * 00069000
*                                                                     * 00069100
*                 Meaning: Unexpected error.  The state of the        * 00069200
*                 request is unpredictable.                           * 00069300
*                                                                     * 00069400
*                 Action:  Contact IBM.                               * 00069500
*                                                                     * 00069600
*                                                                     * 00069700
*                 HEX REASON  MEANING/ACTION                          * 00069800
*                 CODE                                                * 00069900
*                                                                     * 00070000
*                 xxxx0C01    Name: BlsactvRsnUnExp01                 * 00070100
*                                                                     * 00070200
*                             Meaning: Unexpected error.              * 00070300
*                                                                     * 00070400
*                             Action: Contact IBM.                    * 00070500
*                                                                     * 00070600
*                 xxxx0C02    Name: BlsactvRsnUnExp02                 * 00070700
*                                                                     * 00070800
*                             Meaning: Unexpected error.              * 00070900
*                                                                     * 00071000
*                             Action: Contact IBM.                    * 00071100
*                                                                     * 00071200
*                 xxxx0C03    Name: BlsactvRsnUnExp03                 * 00071300
*                                                                     * 00071400
*                             Meaning: Unexpected error.              * 00071500
*                                                                     * 00071600
*                             Action: Contact IBM.                    * 00071700
*                                                                     * 00071800
*                 xxxx0C04    Name: BlsactvRsnUnExp04                 * 00071900
*                                                                     * 00072000
*                             Meaning: Unexpected error.              * 00072100
*                                                                     * 00072200
*                             Action: Contact IBM.                    * 00072300
*                                                                     * 00072400
*                 xxxx0C05    Name: BlsactvRsnUnExp05                 * 00072500
*                                                                     * 00072600
*                             Meaning: Unexpected error.              * 00072700
*                                                                     * 00072800
*                             Action: Contact IBM.                    * 00072900
*                                                                     * 00073000
*                 xxxx0C06    Name: BlsactvRsnUnExp06                 * 00073100
*                                                                     * 00073200
*                             Meaning: Unexpected error.              * 00073300
*                                                                     * 00073400
*                             Action: Contact IBM.                    * 00073500
*                                                                     * 00073600
*                 xxxx0C07    Name: BlsactvRsnUnExp07                 * 00073700
*                                                                     * 00073800
*                             Meaning: Unexpected error.              * 00073900
*                                                                     * 00074000
*                             Action: Contact IBM.                    * 00074100
*                                                                     * 00074200
*                 xxxx0C08    Name: BlsactvRsnUnExp08                 * 00074300
*                                                                     * 00074400
*                             Meaning: Unexpected error.              * 00074500
*                                                                     * 00074600
*                             Action: Contact IBM.                    * 00074700
*                                                                     * 00074800
*                 xxxx0C09    Name: BlsactvRsnUnExp09                 * 00074900
*                                                                     * 00075000
*                             Meaning: Unexpected error.              * 00075100
*                                                                     * 00075200
*                             Action: Contact IBM.                    * 00075300
*                                                                     * 00075400
*                 xxxx0C0A    Name: BlsactvRsnUnExp10                 * 00075500
*                                                                     * 00075600
*                             Meaning: Unexpected error.              * 00075700
*                                                                     * 00075800
*                             Action: Contact IBM.                    * 00075900
*                                                                     * 00076000
*                 xxxx0C0B    Name: BlsactvRsnUnExp11                 * 00076100
*                                                                     * 00076200
*                             Meaning: Unexpected error.              * 00076300
*                                                                     * 00076400
*                             Action: Contact IBM.                    * 00076500
*                                                                     * 00076600
*                 xxxx0C0C    Name: BlsactvRsnUnExp12                 * 00076700
*                                                                     * 00076800
*                             Meaning: Unexpected error.              * 00076900
*                                                                     * 00077000
*                             Action: Contact IBM.                    * 00077100
*                                                                     * 00077200
*                 xxxx0C0D    Name: BlsactvRsnUnExp13                 * 00077300
*                                                                     * 00077400
*                             Meaning: Unexpected error.              * 00077500
*                                                                     * 00077600
*                             Action: Contact IBM.                    * 00077700
*                                                                     * 00077800
*                 xxxx0C0E    Name: BlsactvRsnUnExp14                 * 00077900
*                                                                     * 00078000
*                             Meaning: Unexpected error.              * 00078100
*                                                                     * 00078200
*                             Action: Contact IBM.                    * 00078300
*                                                                     * 00078400
*                 xxxx0C0F    Name: BlsactvRsnUnExp15                 * 00078500
*                                                                     * 00078600
*                             Meaning: Unexpected error.              * 00078700
*                                                                     * 00078800
*                             Action: Contact IBM.                    * 00078900
*                                                                     * 00079000
*                 xxxx0C10    Name: BlsactvRsnUnExp16                 * 00079100
*                                                                     * 00079200
*                             Meaning: Unexpected error.              * 00079300
*                                                                     * 00079400
*                             Action: Contact IBM.                    * 00079500
*                                                                     * 00079600
*                 xxxx0C11    Name: BlsactvRsnUnExp17                 * 00079700
*                                                                     * 00079800
*                             Meaning: Unexpected error.              * 00079900
*                                                                     * 00080000
*                             Action: Contact IBM.                    * 00080100
*                                                                     * 00080200
*                 xxxx0C12    Name: BlsactvRsnUnExp18                 * 00080300
*                                                                     * 00080400
*                             Meaning: Unexpected error.              * 00080500
*                                                                     * 00080600
*                             Action: Contact IBM.                    * 00080700
*                                                                     * 00080800
*                 xxxx0C13    Name: BlsactvRsnUnExp19                 * 00080900
*                                                                     * 00081000
*                             Meaning: Unexpected error.              * 00081100
*                                                                     * 00081200
*                             Action: Contact IBM.                    * 00081300
*                                                                     * 00081400
*                 xxxx0C14    Name: BlsactvRsnUnExp20                 * 00081500
*                                                                     * 00081600
*                             Meaning: Unexpected error.              * 00081700
*                                                                     * 00081800
*                             Action: Contact IBM.                    * 00081900
*                                                                     * 00082000
*                 xxxx0C15    Name: BlsactvRsnUnExp21                 * 00082100
*                                                                     * 00082200
*                             Meaning: Unexpected error.              * 00082300
*                                                                     * 00082400
*                             Action: Contact IBM.                    * 00082500
*                                                                     * 00082600
*                 xxxx0C16    Name: BlsactvRsnUnExp22                 * 00082700
*                                                                     * 00082800
*                             Meaning: Unexpected error.              * 00082900
*                                                                     * 00083000
*                             Action: Contact IBM.                    * 00083100
*                                                                     * 00083200
*                 xxxx0C17    Name: BlsactvRsnUnExp23                 * 00083300
*                                                                     * 00083400
*                             Meaning: Unexpected error.              * 00083500
*                                                                     * 00083600
*                             Action: Contact IBM.                    * 00083700
*                                                                     * 00083800
*                 xxxx0C18    Name: BlsactvRsnUnExp24                 * 00083900
*                                                                     * 00084000
*                             Meaning: Unexpected error.              * 00084100
*                                                                     * 00084200
*                             Action: Contact IBM.                    * 00084300
*                                                                     * 00084400
*                 xxxx0C19    Name: BlsactvRsnUnExp25                 * 00084500
*                                                                     * 00084600
*                             Meaning: Unexpected error.              * 00084700
*                                                                     * 00084800
*                             Action: Contact IBM.                    * 00084900
*                                                                     * 00085000
*                 xxxx0C1A    Name: BlsactvRsnUnExp26                 * 00085100
*                                                                     * 00085200
*                             Meaning: Unexpected error.              * 00085300
*                                                                     * 00085400
*                             Action: Contact IBM.                    * 00085500
*                                                                     * 00085600
*                 xxxx0C1B    Name: BlsactvRsnUnExp27                 * 00085700
*                                                                     * 00085800
*                             Meaning: Unexpected error.              * 00085900
*                                                                     * 00086000
*                             Action: Contact IBM.                    * 00086100
*                                                                     * 00086200
*                 xxxx0C1C    Name: BlsactvRsnUnExp28                 * 00086300
*                                                                     * 00086400
*                             Meaning: Unexpected error.              * 00086500
*                                                                     * 00086600
*                             Action: Contact IBM.                    * 00086700
*                                                                     * 00086800
*                 xxxx0C1D    Name: BlsactvRsnUnExp29                 * 00086900
*                                                                     * 00087000
*                             Meaning: Unexpected error.              * 00087100
*                                                                     * 00087200
*                             Action: Contact IBM.                    * 00087300
*                                                                     * 00087400
*                 xxxx0C1E    Name: BlsactvRsnUnExp30                 * 00087500
*                                                                     * 00087600
*                             Meaning: Unexpected error.              * 00087700
*                                                                     * 00087800
*                             Action: Contact IBM.                    * 00087900
*                                                                     * 00088000
*                 xxxx0C1F    Name: BlsactvRsnUnExp31                 * 00088100
*                                                                     * 00088200
*                             Meaning: Unexpected error.              * 00088300
*                                                                     * 00088400
*                             Action: Contact IBM.                    * 00088500
*                                                                     * 00088600
*                 xxxx0C20    Name: BlsactvRsnUnExp32                 * 00088700
*                                                                     * 00088800
*                             Meaning: Unexpected error.              * 00088900
*                                                                     * 00089000
*                             Action: Contact IBM.                    * 00089100
*                                                                     * 00089200
*                                                                     * 00089300
*                                                                     * 00089400
*                                                                     * 00089500
*       10        Name: BlsactvRC_16                                  * 00089600
*                                                                     * 00089700
*                 Meaning:  Unable to access parameter list or        * 00089800
*                 invalid caller's environment.                       * 00089900
*                                                                     * 00090000
*                 Action:  Refer to the action provided with the      * 00090100
*                 specific reason code.                               * 00090200
*                                                                     * 00090300
*                                                                     * 00090400
*                 HEX REASON  MEANING/ACTION                          * 00090500
*                 CODE                                                * 00090600
*                                                                     * 00090700
*                 xxxx1001    Name: BlsactvRsnBadParmList             * 00090800
*                                                                     * 00090900
*                             Meaning: Unable to access parameter     * 00091000
*                             list.                                   * 00091100
*                                                                     * 00091200
*                             Action: Check for one of possible       * 00091300
*                             errors:  Program exception during       * 00091400
*                             access of parameter list.  Parameter    * 00091500
*                             list has zero address and ALET.         * 00091600
*                             Invalid parameter list ALET.  The sum   * 00091700
*                             of parameter list address and its       * 00091800
*                             length exceeds maximium 64-bit address. * 00091900
*                                                                     * 00092000
*                 xxxx1002    Name: BlsactvRsnInvAddrMode             * 00092100
*                                                                     * 00092200
*                             Meaning: Invalid addressing mode.       * 00092300
*                                                                     * 00092400
*                             Action: Only 31-bit and 64-bit          * 00092500
*                             addressing modes are valid.             * 00092600
*                                                                     * 00092700
*                 xxxx1003    Name: BlsactvRsnInvASCMode              * 00092800
*                                                                     * 00092900
*                             Meaning: Invalid ASC mode.              * 00093000
*                                                                     * 00093100
*                             Action: Only Primary and Access         * 00093200
*                             Register modes are valid.               * 00093300
*                                                                     * 00093400
*                 xxxx1004    Name: BlsactvRsnInvDUMode               * 00093500
*                                                                     * 00093600
*                             Meaning: Invalid dispatchable unit      * 00093700
*                             mode.                                   * 00093800
*                                                                     * 00093900
*                             Action: Only task mode is valid.        * 00094000
*                                                                     * 00094100
*                                                                     * 00094200
*                                                                     * 00094300
*                                                                     * 00094400
*                                                                     * 00094500
*01* REASON CODES:                                                    * 00094600
*                                                                     * 00094700
*       Reason codes, as appropriate, are defined under their         * 00094800
*       corresponding return code.                                    * 00094900
*                                                                     * 00095000
*01* MODULE TYPE:  ASSEM MACRO                                        * 00095100
*                                                                     * 00095200
*02*   PROCESSOR:  ASSEM                                              * 00095300
*                                                                     * 00095400
*01* COMPONENT:  SC132                                                * 00095500
*                                                                     * 00095600
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00095700
*                                                                     * 00095800
*01* EXAMPLES:                                                        * 00095900
*                                                                     * 00096000
*    Example 1                                                        * 00096100
*                                                                     * 00096200
*    Operation:                                                       * 00096300
*                                                                     * 00096400
*                                                                     * 00096500
*        Get a copy of an area of storage in the primary address      * 00096600
*        space.                                                       * 00096700
*                                                                     * 00096800
*                                                                     * 00096900
*                                                                     * 00097000
*    The code is as follows.                                          * 00097100
*                                                                     * 00097200
*          BLSACTV AREAADDR=AA,SPACEID=SI,               **           * 00097300
*                BUFFER=B,BUFFERLEN=BL,                  **           * 00097400
*                MF=(E,MYLIST)                                        * 00097500
*             ...                                                     * 00097600
*          DS    0D                                                   * 00097700
*    SI    DS    XL16                                                 * 00097800
*    AA    DS    A                                                    * 00097900
*    BL    DC    A(L'B)                                               * 00098000
*    B     DS    XL4096                                               * 00098100
*          BLSACTV MF=(L,MYLIST)                                      * 00098200
*                                                                     * 00098300
*                                                                     * 00098400
*01* MACRO USAGE NOTES:                                               * 00098500
*                                                                     * 00098600
*                                                                     * 00098700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00098800
*        global macro variable.  Any value other than 'NO' will       * 00098900
*        result in the macro expansion being printed.  The default is * 00099000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00099100
*        variable should be set.                                      * 00099200
*                                                                     * 00099300
*                    GBLC &ZPRINT                                     * 00099400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00099500
*                                                                     * 00099600
*                                                                     * 00099700
*    2.  When using the NOCHECK option in conjunction with the Modify * 00099800
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00099900
*        Modify   or  Execute  form  invocation  which  specifies  or * 00100000
*        defaults  to  the  COMPLETE  option.   This insures that the * 00100100
*        parameter  list  is  initialized completely.   The parameter * 00100200
*        list  field which identifies the version number of the macro * 00100300
*        is only set when the Standard form or the Complete option of * 00100400
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00100500
*        explicitly  specified.  Be sure that the resulting parameter * 00100600
*        list version number covers all the keys that you use.        * 00100700
*                                                                     * 00100800
*                                                                     * 00100900
*    3.  All keys currently contained in the BLSACTV macro correspond * 00101000
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00101100
*        MAX.                                                         * 00101200
*                                                                     * 00101300
*                                                                     * 00101400
*                                                                     * 00101500
*                                                                     * 00101600
*01* CHANGE ACTIVITY:                                                 * 00101700
*                                                                     * 00101800
*   Flag LineItem  FMID    Date   ID    Comment                       * 00101900
*                                                                     * 00102000
*    $L0=IPCSAAMG HBB7705 001017 PD00XB:  IPCS Active                 * 00102100
*    $L1=IPCSABLS HBB7705 001017 PD00XB:  IPCS Active                 * 00102200
*    $L2=SVAHQ4   HBB7740 060103 PDE1:  IPCS Active - ABSOLUTE        * 00102300
*                                         storage                     * 00102400
*    $D1=W355272  HBB77D0 200108 PDPS:  Externalize the interface     * 00102500
****** END OF SPECIFICATIONS *****************************************/ 00102600
*/********************************************************************* 00102700
         MACRO                                                          00102800
&XLABEL  BLSACTV &SPACEID=,&AREAADDR=,&AREAADDR64=,&AREAADDR64C=,      *00102900
               &BUFFER=,&BUFFER64=,&BUFFERLEN=,&BUFFERLENV=,           *00103000
               &AUTHSTATE=,&AREAKEY=,&NEXTKEY=,&FIRSTADDR64=,          *00103100
               &FIRSTADDR64C=,&LASTADDR64=,&LASTADDR64C=,&COMPCODE=,   *00103200
               &COMPRSN=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=            00103300
.*                                                                      00103400
*                  MACDATE -01/21/20-<1>                                00103500
.*                                                                      00103600
.*******************************************************************    00103700
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00103800
.*******************************************************************    00103900
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00104000
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00104100
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00104200
.*                                                                      00104300
                  GBLC  &ZBLSACTV   YES=MACRO USED AT LEAST ONCE        00104400
.*******************************************************************    00104500
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00104600
.*******************************************************************    00104700
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00104800
                  LCLC  &ZCNDX      SYSNDX CHARACTERS                   00104900
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00105000
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00105100
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00105200
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00105300
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00105400
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00105500
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00105600
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00105700
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00105800
                  LCLC  &ZMAC_G     "G" or null                         00105900
&ZMAC_G           SETC  ''                                              00106000
                  LCLC  &ZMAC_LR                                        00106100
&ZMAC_LR          SETC  'LR'                                            00106200
                  LCLC  &ZMAC_L                                         00106300
&ZMAC_L           SETC  'L'                                             00106400
                  LCLC  &ZMAC_ST                                        00106500
&ZMAC_ST          SETC  'ST'                                            00106600
                  LCLC  &ZMAC_LLGT                                      00106700
&ZMAC_LLGT        SETC  'L'                                             00106800
                  LCLC  &ZMAC_LGR                                       00106900
&ZMAC_LGR         SETC  'LR'                                            00107000
                  LCLC  &ZMAC_LG                                        00107100
&ZMAC_LG          SETC  'L'                                             00107200
                  LCLC  &ZMAC_STG                                       00107300
&ZMAC_STG         SETC  'ST'                                            00107400
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00107500
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00107600
.*                                                                      00107700
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00107800
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00107900
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00108000
                  LCLC  &ZENDBASEPL             End of base PL          00108100
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00108200
.*******************************************************************    00108300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00108400
.*******************************************************************    00108500
                  LCLA  &ZI         INDEX FOR ARRAY                     00108600
                  LCLA  &ZJ         INDEX FOR PARMS                     00108700
                  LCLA  &ZK         INDEX FOR PARSE                     00108800
                  LCLA  &ZLO        LOW RANGE VALUE                     00108900
                  LCLA  &ZHI        HIGH RANGE VALUE                    00109000
                  LCLC  &ZW         WORK AREA FOR PARM                  00109100
.********************************************************************   00109200
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00109300
.********************************************************************   00109400
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00109500
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00109600
                  GBLA  &SYSALVL    SYSSTATE ARCHLVL                    00109700
                  GBLC  &SYSAM64    SYSSTATE AMODE64                    00109800
.*                                                                      00109900
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00110000
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00110100
                  SPLEVEL  TEST                                         00110200
.ZSYS2            ANOP  ,                                               00110300
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00110400
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00110500
                  SYSSTATE TEST                                         00110600
                  AGO   .ZSYS4                                          00110700
.ZSYS3            ANOP  ,                                               00110800
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00110900
.ZSYS4            ANOP  ,                                               00111000
                  AIF   ('&SYSAM64' NE 'YES').ZSYSN64                   00111100
&ZMAC_LLGT        SETC 'LLGT'                                           00111200
&ZMAC_LGR         SETC 'LGR'                                            00111300
&ZMAC_LG          SETC 'LG'                                             00111400
&ZMAC_STG         SETC 'STG'                                            00111500
.ZSYSN64          ANOP  ,                                               00111600
                  AIF   (&SYSALVL LE 1).ZSYS4A                          00111700
&ZMAC_G           SETC 'G'                                              00111800
&ZMAC_LR          SETC 'LGR'                                            00111900
&ZMAC_L           SETC 'LG'                                             00112000
&ZMAC_ST          SETC 'STG'                                            00112100
.ZSYS4A           ANOP  ,                                               00112200
.*******************************************************************    00112300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00112400
.*******************************************************************    00112500
                  LCLC  &XSPACEID   ++ NAME                             00112600
                  LCLC  &XDUMMY1    ++ NAME                             00112700
                  LCLC  &XAREAADDR  ++ NAME                             00112800
                  LCLC  &XAREAADDR64            ++ NAME                 00112900
                  LCLC  &XAREAADDR64C           ++ NAME                 00113000
                  LCLC  &XDUMMYB    ++ NAME                             00113100
                  LCLC  &XBUFFER    ++ NAME                             00113200
                  LCLC  &XBUFFER64  ++ NAME                             00113300
                  LCLC  &XBUFFERLEN             ++ NAME                 00113400
                  LCLC  &XBUFFERLENV            ++ NAME                 00113500
                  LCLC  &XAUTHSTATE             ++ NAME                 00113600
                  LCLC  &XAREAKEY   ++ NAME                             00113700
                  LCLC  &XNEXTKEY   ++ NAME                             00113800
                  LCLC  &XDUMMYF    ++ NAME                             00113900
                  LCLC  &XFIRSTADDR64           ++ NAME                 00114000
                  LCLC  &XFIRSTADDR64C          ++ NAME                 00114100
                  LCLC  &XDUMMYL    ++ NAME                             00114200
                  LCLC  &XLASTADDR64            ++ NAME                 00114300
                  LCLC  &XLASTADDR64C           ++ NAME                 00114400
                  LCLC  &XCOMPCODE  ++ NAME                             00114500
                  LCLC  &XCOMPRSN   ++ NAME                             00114600
                  LCLC  &XRETCODE   ++ NAME                             00114700
                  LCLC  &XRSNCODE   ++ NAME                             00114800
                  LCLA  &XPLISTVER  ++ VALUE                            00114900
                  LCLC  &XMF        ++ VALUE                            00115000
                  LCLC  &XMFCTRL    ++ NAME                             00115100
                  LCLC  &XMFATTR    ++ VALUE                            00115200
                  LCLC  &XMFSCK     ++ VALUE                            00115300
.*******************************************************************    00115400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00115500
.*******************************************************************    00115600
                  LCLC  &ZXSPACEID  ++ INPUT NAME                       00115700
                  LCLC  &ZXDUMMY1   ++ INPUT NAME                       00115800
                  LCLC  &ZXAREAADDR             ++ INPUT NAME           00115900
                  LCLC  &ZXAREAADDR64           ++ INPUT NAME           00116000
                  LCLC  &ZXAREAADDR64C          ++ INPUT NAME           00116100
                  LCLC  &ZXDUMMYB   ++ OUTPUT NAME                      00116200
                  LCLC  &ZXBUFFER   ++ OUTPUT NAME                      00116300
                  LCLC  &ZXBUFFER64             ++ OUTPUT NAME          00116400
                  LCLC  &ZXBUFFERLEN            ++ INPUT NAME           00116500
                  LCLC  &ZXBUFFERLENV           ++ OUTPUT NAME          00116600
                  LCLC  &ZXAUTHSTATE            ++ OUTPUT NAME          00116700
                  LCLC  &ZXAREAKEY  ++ OUTPUT NAME                      00116800
                  LCLC  &ZXNEXTKEY  ++ OUTPUT NAME                      00116900
                  LCLC  &ZXDUMMYF   ++ OUTPUT NAME                      00117000
                  LCLC  &ZXFIRSTADDR64          ++ OUTPUT NAME          00117100
                  LCLC  &ZXFIRSTADDR64C         ++ OUTPUT NAME          00117200
                  LCLC  &ZXDUMMYL   ++ OUTPUT NAME                      00117300
                  LCLC  &ZXLASTADDR64           ++ OUTPUT NAME          00117400
                  LCLC  &ZXLASTADDR64C          ++ OUTPUT NAME          00117500
                  LCLC  &ZXCOMPCODE             ++ OUTPUT NAME          00117600
                  LCLC  &ZXCOMPRSN  ++ OUTPUT NAME                      00117700
                  LCLC  &ZXRETCODE  ++ OUTPUT NAME                      00117800
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00117900
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00118000
                  LCLC  &ZXMF       ++ INPUT VALUE                      00118100
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00118200
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00118300
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00118400
.********************************************************************   00118500
.***AC.PLV01  PROCESS PLISTVER                                      *   00118600
.********************************************************************   00118700
&XPLISTVER      SETA  1                                                 00118800
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00118900
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00119000
&XPLISTVER      SETA  1                                                 00119100
.ZPLV0          ANOP  ,                                                 00119200
.*                                                                      00119300
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00119400
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00119500
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00119600
.*-------------------------------------------------------------------   00119700
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00119800
&ZMS            SETC  '"PLISTVER='                                      00119900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00120000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00120100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00120200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00120300
                AGO   .ZPVCK2                                           00120400
.ZPVCK3         ANOP  ,                                                 00120500
.*-------------------------------------------------------------------   00120600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00120700
&ZMS            SETC  '"PLISTVER='                                      00120800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00120900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00121000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00121100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00121200
                AGO   .ZPVCKE                                           00121300
.ZPVCK2         ANOP  ,                                                 00121400
.*-------------------------------------------------------------------   00121500
&ZCVAL          SETC  '&PLISTVER(1)'                                    00121600
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00121700
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00121800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00121900
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00122000
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00122100
.ZPVCK6         ANOP  ,                                                 00122200
&ZMS            SETC  '"PLISTVER='                                      00122300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00122400
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00122500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00122600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00122700
&XPLISTVER      SETA  1                                                 00122800
                AGO   .ZPVCKE                                           00122900
.*-------------------------------------------------------------------   00123000
.ZPVCK4A        ANOP  ,                                                 00123100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00123200
&ZMS            SETC  'PLISTVER='                                       00123300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00123400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00123500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00123600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00123700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00123800
                AGO   .ZPVCK5                                           00123900
.ZPVCK4         ANOP  ,                                                 00124000
&XPLISTVER      SETA  &PLISTVER(1)                                      00124100
.ZPVCK5         ANOP  ,                                                 00124200
.ZPVCKE         ANOP  ,                                                 00124300
.********************************************************************   00124400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00124500
.********************************************************************   00124600
                  ACTR  10000                                           00124700
.*------------------------------------------------------------------    00124800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00124900
&XMF              SETC  ''          INITIALIZE XVARIABLE                00125000
.*-------------------------------------------------------------------   00125100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00125200
.ZG53             ANOP  ,                                               00125300
&ZTLC             SETC 'S'                                              00125400
                  AIF   ('&MF(1)' NE '&ZTLC').ZG54                      00125500
&XMF              SETC  'S'         SET KEYWORD                         00125600
&XMFSCK           SETC  'COMPLETE'  SET XMFSCK                          00125700
                  AIF   (N'&MF LE 1).ZG53A      CK NUM                  00125800
&ZMS              SETC  '"MF='                                          00125900
&ZMS              SETC  '&ZMS.&MF"'                                     00126000
&ZMS              SETC  '&ZMS "MF"'                                     00126100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00126200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00126300
.ZG53A            ANOP  ,                                               00126400
.*-------------------------------------------------------------------   00126500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126600
.ZG54             ANOP  ,                                               00126700
&ZTLC             SETC 'L'                                              00126800
                  AIF   ('&MF(1)' NE '&ZTLC').ZG61                      00126900
&XMF              SETC  'L'         SET KEYWORD                         00127000
                  AIF   (N'&MF LE 3).ZG54A      CK NUM                  00127100
&ZMS              SETC  '"MF='                                          00127200
&ZMS              SETC  '&ZMS.&MF"'                                     00127300
&ZMS              SETC  '&ZMS "MF"'                                     00127400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00127500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00127600
.ZG54A            ANOP  ,                                               00127700
.*-------------------------------------------------------------------   00127800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00127900
                  AIF   (N'&SYSLIST NE 0).ZG54B  POSITIONALS?           00128000
                  AIF   ('&SPACEID' NE '').ZG54B  KEYS?                 00128100
                  AIF   ('&AREAADDR' NE '').ZG54B  KEYS?                00128200
                  AIF   ('&AREAADDR64' NE '').ZG54B  KEYS?              00128300
                  AIF   ('&AREAADDR64C' NE '').ZG54B  KEYS?             00128400
                  AIF   ('&BUFFER' NE '').ZG54B  KEYS?                  00128500
                  AIF   ('&BUFFER64' NE '').ZG54B  KEYS?                00128600
                  AIF   ('&BUFFERLEN' NE '').ZG54B  KEYS?               00128700
                  AIF   ('&BUFFERLENV' NE '').ZG54B  KEYS?              00128800
                  AIF   ('&AUTHSTATE' NE '').ZG54B  KEYS?               00128900
                  AIF   ('&AREAKEY' NE '').ZG54B  KEYS?                 00129000
                  AIF   ('&NEXTKEY' NE '').ZG54B  KEYS?                 00129100
                  AIF   ('&FIRSTADDR64' NE '').ZG54B  KEYS?             00129200
                  AIF   ('&FIRSTADDR64C' NE '').ZG54B  KEYS?            00129300
                  AIF   ('&LASTADDR64' NE '').ZG54B  KEYS?              00129400
                  AIF   ('&LASTADDR64C' NE '').ZG54B  KEYS?             00129500
                  AIF   ('&COMPCODE' NE '').ZG54B  KEYS?                00129600
                  AIF   ('&COMPRSN' NE '').ZG54B  KEYS?                 00129700
                  AIF   ('&RETCODE' NE '').ZG54B  KEYS?                 00129800
                  AIF   ('&RSNCODE' NE '').ZG54B  KEYS?                 00129900
                  AGO    .ZG54C     INVOCATION OKAY                     00130000
.ZG54B            ANOP  ,                                               00130100
&ZMS              SETC  'THE "L" FORM OF "MF"'                          00130200
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00130300
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00130400
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00130500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00130600
.ZG54C            ANOP  ,                                               00130700
.*-------------------------------------------------------------------   00130800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00130900
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00131000
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00131100
                  AIF   (N'&MF(2) GT 1).ZG56B   MULTI                   00131200
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00131300
.ZG56B            AIF   (K'&MF(2) GT 0).ZG56C                           00131400
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00131500
&ZMS              SETC  'WHEN "L" IS SPECIFIED'                         00131600
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00131700
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00131800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00131900
.ZG56C            ANOP  ,                                               00132000
.*-------------------------------------------------------------------   00132100
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00132200
                  AIF   (K'&ZXMFCTRL LE 0).ZG56P  NOT I/O               00132300
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG56P                  00132400
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00132500
&ZMS              SETC  '"MF='                                          00132600
&ZMS              SETC  '&ZMS.&MF"'                                     00132700
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00132800
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00132900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00133000
.ZG56P            ANOP  ,                                               00133100
.*-------------------------------------------------------------------   00133200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00133300
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00133400
&XMFATTR          SETC  '0D'                                            00133500
                  AIF   (K'&MF(3) LE 0).ZG59B   PARM                    00133600
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00133700
                  AIF   (N'&MF(3) GT 1).ZG59B   MULTI                   00133800
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00133900
.ZG59B            ANOP  ,                                               00134000
.*-------------------------------------------------------------------   00134100
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00134200
                  AIF   (K'&ZXMFATTR LE 0).ZG59P  NOT I/O               00134300
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG59P                  00134400
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00134500
&ZMS              SETC  '"MF='                                          00134600
&ZMS              SETC  '&ZMS.&MF"'                                     00134700
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00134800
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00134900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00135000
.ZG59P            ANOP  ,                                               00135100
.*-------------------------------------------------------------------   00135200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00135300
                  AIF   (K'&ZXMFATTR LE 0).ZG59S  NOT I/O               00135400
                  AIF   (K'&XMFATTR LE 60).ZG59S  LNG OK                00135500
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00135600
&ZMS              SETC  '"MF='                                          00135700
&ZMS              SETC  '&ZMS.&MF"'                                     00135800
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00135900
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00136000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00136100
.ZG59S            ANOP  ,                                               00136200
.*-------------------------------------------------------------------   00136300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136400
.ZG61             ANOP  ,                                               00136500
&ZTLC             SETC 'M'                                              00136600
                  AIF   ('&MF(1)' NE '&ZTLC').ZG70                      00136700
&XMF              SETC  'M'         SET KEYWORD                         00136800
                  AIF   (N'&MF LE 3).ZG61A      CK NUM                  00136900
&ZMS              SETC  '"MF='                                          00137000
&ZMS              SETC  '&ZMS.&MF"'                                     00137100
&ZMS              SETC  '&ZMS "MF"'                                     00137200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00137300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00137400
.ZG61A            ANOP  ,                                               00137500
.*-------------------------------------------------------------------   00137600
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00137700
                  AIF   ('&BUFFERLENV' NE '').ZG61B  OUTPUT?            00137800
                  AIF   ('&AUTHSTATE' NE '').ZG61B                      00137900
                  AIF   ('&AREAKEY' NE '').ZG61B                        00138000
                  AIF   ('&NEXTKEY' NE '').ZG61B                        00138100
                  AIF   ('&FIRSTADDR64' NE '').ZG61B                    00138200
                  AIF   ('&FIRSTADDR64C' NE '').ZG61B                   00138300
                  AIF   ('&LASTADDR64' NE '').ZG61B                     00138400
                  AIF   ('&LASTADDR64C' NE '').ZG61B                    00138500
                  AIF   ('&COMPCODE' NE '').ZG61B                       00138600
                  AIF   ('&COMPRSN' NE '').ZG61B                        00138700
                  AGO    .ZG61C     INVOCATION OKAY                     00138800
.ZG61B            ANOP  ,                                               00138900
&ZMS              SETC  'THE "M" FORM OF "MF" CANNOT'                   00139000
&ZMS              SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'         00139100
&ZMS              SETC  '&ZMS SPECIFIED ON THE INVOCATION:'             00139200
&ZMS              SETC  '&ZMS "BUFFERLENV"'                             00139300
&ZMS              SETC  '&ZMS OR "AUTHSTATE"'                           00139400
&ZMS              SETC  '&ZMS OR "AREAKEY"'                             00139500
&ZMS              SETC  '&ZMS OR "NEXTKEY"'                             00139600
&ZMS              SETC  '&ZMS OR "FIRSTADDR64"'                         00139700
&ZMS              SETC  '&ZMS OR "FIRSTADDR64C"'                        00139800
&ZMS              SETC  '&ZMS OR "LASTADDR64"'                          00139900
&ZMS              SETC  '&ZMS OR "LASTADDR64C"'                         00140000
&ZMS              SETC  '&ZMS OR "COMPCODE"'                            00140100
                  MNOTE 8,' &ZMS '                                      00140200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00140300
&ZMS              SETC  '(CONTINUED) '                                  00140400
&ZMS              SETC  '&ZMS OR "COMPRSN"'                             00140500
                  MNOTE 8,' &ZMS '                                      00140600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00140700
.ZG61C            ANOP  ,                                               00140800
.*-------------------------------------------------------------------   00140900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00141000
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00141100
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00141200
                  AIF   (N'&MF(2) GT 1).ZG63B   MULTI                   00141300
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00141400
.ZG63B            AIF   (K'&MF(2) GT 0).ZG63C                           00141500
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00141600
&ZMS              SETC  'WHEN "M" IS SPECIFIED'                         00141700
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00141800
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00141900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00142000
.ZG63C            ANOP  ,                                               00142100
.*-------------------------------------------------------------------   00142200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00142300
                  AIF   (K'&ZXMFCTRL LE 0).ZG63R  NOT I/O               00142400
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG63R                  00142500
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00142600
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG63P                    00142700
                  AIF   (K'&ZCGPR GT 2).ZG63Q                           00142800
                  AIF   ('&ZCGPR' EQ '0').ZG63Q                         00142900
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00143000
                  AIF   (T'&ZCGPR NE 'N').ZG63Q  INVALID REG NAME       00143100
.ZG63P            ANOP  ,                                               00143200
                  AIF   (T'&ZCGPR NE 'N').ZG63R  NON NUMERIC            00143300
                  AIF   ('&ZCGPR' LT '1').ZG63Q                         00143400
                  AIF   ('&ZCGPR' LE '12').ZG63R                        00143500
.ZG63Q            ANOP  ,                                               00143600
&ZMS              SETC  '"MF='                                          00143700
&ZMS              SETC  '&ZMS.&MF"'                                     00143800
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00143900
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00144000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00144100
.ZG63R            ANOP  ,                                               00144200
.*-------------------------------------------------------------------   00144300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00144400
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00144500
.ZG67A   AIF   ('&MF(3)' NE 'COMPLETE').ZG68A                           00144600
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00144700
.*-------------------------------------------------------------------   00144800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00144900
.ZG68A   AIF   ('&MF(3)' NE 'NOCHECK').ZG69A                            00145000
&XMFSCK           SETC  'NOCHECK'   SET KEYWORD                         00145100
.*-------------------------------------------------------------------   00145200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00145300
.ZG69A            AIF   (K'&XMFSCK GT 0).ZG69C  KEYWORD                 00145400
                  AIF   (K'&MF(3) LE 0).ZG69B                           00145500
&ZMS              SETC  '"MF='                                          00145600
&ZMS              SETC  '&ZMS.&MF"'                                     00145700
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00145800
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00145900
&ZMS              SETC  '&ZMS "COMPLETE"'                               00146000
&ZMS              SETC  '&ZMS OR "NOCHECK".'                            00146100
                  MNOTE 8,' &ZMS '                                      00146200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00146300
.ZG69B            ANOP  ,                                               00146400
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00146500
.ZG69C            ANOP  ,                                               00146600
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00146700
.*-------------------------------------------------------------------   00146800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00146900
.ZG70             ANOP  ,                                               00147000
&ZTLC             SETC 'E'                                              00147100
                  AIF   ('&MF(1)' NE '&ZTLC').ZG79                      00147200
&XMF              SETC  'E'         SET KEYWORD                         00147300
                  AIF   (N'&MF LE 3).ZG70A      CK NUM                  00147400
&ZMS              SETC  '"MF='                                          00147500
&ZMS              SETC  '&ZMS.&MF"'                                     00147600
&ZMS              SETC  '&ZMS "MF"'                                     00147700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00147800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00147900
.ZG70A            ANOP  ,                                               00148000
.*-------------------------------------------------------------------   00148100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00148200
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00148300
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00148400
                  AIF   (N'&MF(2) GT 1).ZG72B   MULTI                   00148500
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00148600
.ZG72B            AIF   (K'&MF(2) GT 0).ZG72C                           00148700
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00148800
&ZMS              SETC  'WHEN "E" IS SPECIFIED'                         00148900
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00149000
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00149100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00149200
.ZG72C            ANOP  ,                                               00149300
.*-------------------------------------------------------------------   00149400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00149500
                  AIF   (K'&ZXMFCTRL LE 0).ZG72R  NOT I/O               00149600
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG72R                  00149700
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00149800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG72P                    00149900
                  AIF   (K'&ZCGPR GT 2).ZG72Q                           00150000
                  AIF   ('&ZCGPR' EQ '0').ZG72Q                         00150100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00150200
                  AIF   (T'&ZCGPR NE 'N').ZG72Q  INVALID REG NAME       00150300
.ZG72P            ANOP  ,                                               00150400
                  AIF   (T'&ZCGPR NE 'N').ZG72R  NON NUMERIC            00150500
                  AIF   ('&ZCGPR' LT '1').ZG72Q                         00150600
                  AIF   ('&ZCGPR' LE '12').ZG72R                        00150700
.ZG72Q            ANOP  ,                                               00150800
&ZMS              SETC  '"MF='                                          00150900
&ZMS              SETC  '&ZMS.&MF"'                                     00151000
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00151100
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00151200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00151300
.ZG72R            ANOP  ,                                               00151400
.*-------------------------------------------------------------------   00151500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00151600
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00151700
.ZG76A   AIF   ('&MF(3)' NE 'COMPLETE').ZG77A                           00151800
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00151900
.*-------------------------------------------------------------------   00152000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00152100
.ZG77A   AIF   ('&MF(3)' NE 'NOCHECK').ZG78A                            00152200
&XMFSCK           SETC  'NOCHECK'   SET KEYWORD                         00152300
.*-------------------------------------------------------------------   00152400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00152500
.ZG78A            AIF   (K'&XMFSCK GT 0).ZG78C  KEYWORD                 00152600
                  AIF   (K'&MF(3) LE 0).ZG78B                           00152700
&ZMS              SETC  '"MF='                                          00152800
&ZMS              SETC  '&ZMS.&MF"'                                     00152900
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00153000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00153100
&ZMS              SETC  '&ZMS "COMPLETE"'                               00153200
&ZMS              SETC  '&ZMS OR "NOCHECK".'                            00153300
                  MNOTE 8,' &ZMS '                                      00153400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00153500
.ZG78B            ANOP  ,                                               00153600
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00153700
.ZG78C            ANOP  ,                                               00153800
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00153900
.*------------------------------------------------------------------    00154000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00154100
.ZG79             ANOP  ,                                               00154200
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00154300
                  AIF   (K'&XMF GT 0).ZG79E     VALID ARG               00154400
                  AIF   (T'&MF EQ 'O').ZG79D    OMITTED                 00154500
&ZASYSLNDX        SETA  0                                               00154600
.ZG79A            ANOP  ,           POSITIONAL MACRO KEY                00154700
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00154800
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG79C                00154900
&ZTLC             SETC 'MF'                                             00155000
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG79A       00155100
.ZG79B            ANOP  ,                                               00155200
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00155300
&ZMS              SETC  'THE "MF" KEY'                                  00155400
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00155500
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00155600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00155700
                  AGO   .ZG79E                                          00155800
.ZG79C            ANOP  ,                                               00155900
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00156000
&ZMS              SETC  '"MF='                                          00156100
&ZMS              SETC  '&ZMS.&MF"'                                     00156200
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00156300
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00156400
&ZMS              SETC  '&ZMS "S",'                                     00156500
&ZMS              SETC  '&ZMS "L",'                                     00156600
&ZMS              SETC  '&ZMS "M",'                                     00156700
&ZMS              SETC  '&ZMS OR "E".'                                  00156800
                  MNOTE 8,' &ZMS '                                      00156900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00157000
                  AGO   .ZG79E                                          00157100
.ZG79D            ANOP  ,                                               00157200
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00157300
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00157400
.ZG79E            ANOP  ,                                               00157500
.********************************************************************   00157600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00157700
.********************************************************************   00157800
                  ACTR  10000                                           00157900
.*-------------------------------------------------------------------   00158000
.***AG.MF03 MF=(SLME)                                                   00158100
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00158200
                  AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                 00158300
.*----------------------------------------------------------------***   00158400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00158500
                  AIF   (N'&SPACEID LE 1).ZG2A  CK NUM                  00158600
&ZMS              SETC  '"SPACEID='                                     00158700
&ZMS              SETC  '&ZMS.&SPACEID"'                                00158800
&ZMS              SETC  '&ZMS "SPACEID"'                                00158900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00159000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00159100
.ZG2A             ANOP  ,                                               00159200
.*-------------------------------------------------------------------   00159300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00159400
&ZXSPACEID        SETC  'INPUT'     SET IN/OUTPUT                       00159500
&XSPACEID         SETC  '&SPACEID(1)'           SET XVARIABLE           00159600
                  AIF   (N'&SPACEID GT 1).ZG2B  MULTI                   00159700
&XSPACEID         SETC  '&SPACEID'  SET XVARIABLE                       00159800
.ZG2B             AIF   (K'&SPACEID(1) GT 0).ZG2C                       00159900
&ZXSPACEID        SETC  ''          RESET IN/OUTPUT                     00160000
&ZMS              SETC  ' '                                             00160100
&ZMS              SETC  '&ZMS "SPACEID" KEY AND ITS'                    00160200
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00160300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00160400
.ZG2C             ANOP  ,                                               00160500
.*-------------------------------------------------------------------   00160600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00160700
                  AIF   (K'&ZXSPACEID LE 0).ZG2R  NOT I/O               00160800
                  AIF   ('&XSPACEID'(1,1) NE '(').ZG2R                  00160900
&ZCGPR            SETC  '&XSPACEID'(2,K'&XSPACEID-2)                    00161000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                     00161100
                  AIF   (K'&ZCGPR GT 2).ZG2Q                            00161200
                  AIF   ('&ZCGPR' EQ '0').ZG2Q                          00161300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00161400
                  AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME        00161500
.ZG2P             ANOP  ,                                               00161600
                  AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC             00161700
                  AIF   ('&ZCGPR' LT '2').ZG2Q                          00161800
                  AIF   ('&ZCGPR' LE '12').ZG2R                         00161900
.ZG2Q             ANOP  ,                                               00162000
&ZMS              SETC  '"SPACEID='                                     00162100
&ZMS              SETC  '&ZMS.&SPACEID"'                                00162200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00162300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00162400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00162500
.ZG2R             ANOP  ,                                               00162600
.*----------------------------------------------------------------***   00162700
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00162800
&XDUMMY1          SETC  ''          INITIALIZE XVARIABLE                00162900
                  AIF   (K'&AREAADDR LE 0).ZG5C                         00163000
&ZXDUMMY1         SETC  'INPUT'     SET IN/OUTPUT                       00163100
&XDUMMY1          SETC  'AREAADDR'  SET XVARIABLE                       00163200
&ZXAREAADDR       SETC  'INPUT'     SET IN/OUTPUT                       00163300
&XAREAADDR        SETC  '&AREAADDR(1)'          SET XVARIABLE PARM      00163400
                  AIF   (N'&AREAADDR GT 1).ZG5A                         00163500
&XAREAADDR        SETC  '&AREAADDR'             SET XVARIABLE PARM      00163600
.ZG5A             AIF   (N'&AREAADDR LE 1).ZG5B  CK NUM                 00163700
&ZMS              SETC  '"AREAADDR='                                    00163800
&ZMS              SETC  '&ZMS.&AREAADDR"'                               00163900
&ZMS              SETC  '&ZMS "AREAADDR"'                               00164000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00164100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00164200
.ZG5B             AIF   (K'&XAREAADDR GT 0).ZG5C  ONE PARM              00164300
&ZXDUMMY1         SETC  ''          RESET IN/OUTPUT                     00164400
&ZXAREAADDR       SETC  ''          RESET IN/OUTPUT                     00164500
&ZMS              SETC  ' '                                             00164600
&ZMS              SETC  '&ZMS "AREAADDR" KEY AND ITS'                   00164700
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00164800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00164900
.ZG5C             ANOP  ,                                               00165000
.*----------------------------------------------------------------***   00165100
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00165200
                  AIF   (K'&AREAADDR64 LE 0).ZG6D  NO ME KEY            00165300
                  AIF   (N'&AREAADDR64 LE 1).ZG6A  CK NUM               00165400
&ZMS              SETC  '"AREAADDR64='                                  00165500
&ZMS              SETC  '&ZMS.&AREAADDR64"'                             00165600
&ZMS              SETC  '&ZMS "AREAADDR64"'                             00165700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00165800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00165900
.ZG6A             AIF   (K'&XDUMMY1 LE 0).ZG6B                          00166000
&ZMS              SETC  '"AREAADDR64'                                   00166100
&ZMS              SETC  '&ZMS.=&AREAADDR64"'                            00166200
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00166300
&ZMS              SETC  '&ZMS "&XDUMMY1"'                               00166400
                  MNOTE 8,' &ZMS KEY.'                                  00166500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00166600
                  AGO   .ZG6D                                           00166700
.*                                                                      00166800
.ZG6B             ANOP  ,                                               00166900
&ZXDUMMY1         SETC  'INPUT'     SET IN/OUTPUT                       00167000
&XDUMMY1          SETC  'AREAADDR64'            SET XVARIABLE           00167100
&ZXAREAADDR64     SETC  'INPUT'     SET IN/OUTPUT                       00167200
&XAREAADDR64      SETC  '&AREAADDR64(1)'        SET XVARIABLE PARM      00167300
                  AIF   (N'&AREAADDR64 GT 1).ZG6C                       00167400
&XAREAADDR64      SETC  '&AREAADDR64'           SET XVARIABLE PARM      00167500
.ZG6C             AIF   (K'&XAREAADDR64 GT 0).ZG6D  ONE PARM            00167600
&ZXDUMMY1         SETC  ''          RESET IN/OUTPUT                     00167700
&ZXAREAADDR64     SETC  ''          RESET IN/OUTPUT                     00167800
&ZMS              SETC  ' '                                             00167900
&ZMS              SETC  '&ZMS "AREAADDR64" KEY AND ITS'                 00168000
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00168100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00168200
.ZG6D             ANOP  ,                                               00168300
.*----------------------------------------------------------------***   00168400
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00168500
                  AIF   (K'&AREAADDR64C LE 0).ZG7D  NO ME KEY           00168600
                  AIF   (N'&AREAADDR64C LE 1).ZG7A  CK NUM              00168700
&ZMS              SETC  '"AREAADDR64C='                                 00168800
&ZMS              SETC  '&ZMS.&AREAADDR64C"'                            00168900
&ZMS              SETC  '&ZMS "AREAADDR64C"'                            00169000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00169100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00169200
.ZG7A             AIF   (K'&XDUMMY1 LE 0).ZG7B                          00169300
&ZMS              SETC  '"AREAADDR64C'                                  00169400
&ZMS              SETC  '&ZMS.=&AREAADDR64C"'                           00169500
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00169600
&ZMS              SETC  '&ZMS "&XDUMMY1"'                               00169700
                  MNOTE 8,' &ZMS KEY.'                                  00169800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00169900
                  AGO   .ZG7D                                           00170000
.*                                                                      00170100
.ZG7B             ANOP  ,                                               00170200
&ZXDUMMY1         SETC  'INPUT'     SET IN/OUTPUT                       00170300
&XDUMMY1          SETC  'AREAADDR64C'           SET XVARIABLE           00170400
&ZXAREAADDR64C    SETC  'INPUT'     SET IN/OUTPUT                       00170500
&XAREAADDR64C     SETC  '&AREAADDR64C(1)'       SET XVARIABLE PARM      00170600
                  AIF   (N'&AREAADDR64C GT 1).ZG7C                      00170700
&XAREAADDR64C     SETC  '&AREAADDR64C'          SET XVARIABLE PARM      00170800
.ZG7C             AIF   (K'&XAREAADDR64C GT 0).ZG7D  ONE PARM           00170900
&ZXDUMMY1         SETC  ''          RESET IN/OUTPUT                     00171000
&ZXAREAADDR64C    SETC  ''          RESET IN/OUTPUT                     00171100
&ZMS              SETC  ' '                                             00171200
&ZMS              SETC  '&ZMS "AREAADDR64C" KEY AND ITS'                00171300
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00171400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00171500
.ZG7D             ANOP  ,                                               00171600
.*------------------------------------------------------------------    00171700
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00171800
                  AIF   (K'&XDUMMY1 GT 0).ZG8B                          00171900
&ZXDUMMY1         SETC  ''          RESET IN/OUTPUT                     00172000
&ZXAREAADDR       SETC  ''          RESET IN/OUTPUT                     00172100
&XDUMMY1          SETC  ''          ENSURE NULL                         00172200
&XAREAADDR        SETC  ''          ENSURE NULL                         00172300
&ZMS              SETC  'ONE OF THE FOLLOWING'                          00172400
&ZMS              SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'             00172500
&ZMS              SETC  '&ZMS REQUIRED:'                                00172600
&ZMS              SETC  '&ZMS "AREAADDR",'      VALID ME KEY            00172700
&ZMS              SETC  '&ZMS "AREAADDR64",'    VALID ME KEY            00172800
&ZMS              SETC  '&ZMS OR "AREAADDR64C".'  VALID ME KEY          00172900
                  MNOTE 8,' &ZMS '                                      00173000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00173100
.ZG8B             ANOP  ,                                               00173200
.*-------------------------------------------------------------------   00173300
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00173400
.ZG5ZY  AIF    ('&XDUMMY1' NE 'AREAADDR').ZG6ZY                         00173500
.*-------------------------------------------------------------------   00173600
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00173700
                  AIF   (K'&ZXAREAADDR LE 0).ZG5R  NOT I/O              00173800
                  AIF   ('&XAREAADDR'(1,1) NE '(').ZG5R                 00173900
&ZCGPR            SETC  '&XAREAADDR'(2,K'&XAREAADDR-2)                  00174000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                     00174100
                  AIF   (K'&ZCGPR GT 2).ZG5Q                            00174200
                  AIF   ('&ZCGPR' EQ '0').ZG5Q                          00174300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00174400
                  AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME        00174500
.ZG5P             ANOP  ,                                               00174600
                  AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC             00174700
                  AIF   ('&ZCGPR' LT '2').ZG5Q                          00174800
                  AIF   ('&ZCGPR' LE '12').ZG5R                         00174900
.ZG5Q             ANOP  ,                                               00175000
&ZMS              SETC  '"AREAADDR='                                    00175100
&ZMS              SETC  '&ZMS.&AREAADDR"'                               00175200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00175300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00175400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00175500
.ZG5R             ANOP  ,                                               00175600
.*-------------------------------------------------------------------   00175700
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00175800
.ZG6ZY  AIF    ('&XDUMMY1' NE 'AREAADDR64').ZG7ZY                       00175900
.*-------------------------------------------------------------------   00176000
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00176100
                  AIF   (K'&ZXAREAADDR64 LE 0).ZG6R  NOT I/O            00176200
                  AIF   ('&XAREAADDR64'(1,1) NE '(').ZG6R               00176300
&ZCGPR            SETC  '&XAREAADDR64'(2,K'&XAREAADDR64-2)              00176400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                     00176500
                  AIF   (K'&ZCGPR GT 2).ZG6Q                            00176600
                  AIF   ('&ZCGPR' EQ '0').ZG6Q                          00176700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00176800
                  AIF   (T'&ZCGPR NE 'N').ZG6Q  INVALID REG NAME        00176900
.ZG6P             ANOP  ,                                               00177000
                  AIF   (T'&ZCGPR NE 'N').ZG6R  NON NUMERIC             00177100
                  AIF   ('&ZCGPR' LT '2').ZG6Q                          00177200
                  AIF   ('&ZCGPR' LE '12').ZG6R                         00177300
.ZG6Q             ANOP  ,                                               00177400
&ZMS              SETC  '"AREAADDR64='                                  00177500
&ZMS              SETC  '&ZMS.&AREAADDR64"'                             00177600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00177700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00177800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00177900
.ZG6R             ANOP  ,                                               00178000
.*-------------------------------------------------------------------   00178100
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00178200
.ZG7ZY  AIF    ('&XDUMMY1' NE 'AREAADDR64C').ZG8ZY                      00178300
.*-------------------------------------------------------------------   00178400
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00178500
                  AIF   (K'&ZXAREAADDR64C LE 0).ZG7R  NOT I/O           00178600
                  AIF   ('&XAREAADDR64C'(1,1) NE '(').ZG7R              00178700
&ZCGPR            SETC  '&XAREAADDR64C'(2,K'&XAREAADDR64C-2)            00178800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                     00178900
                  AIF   (K'&ZCGPR GT 2).ZG7Q                            00179000
                  AIF   ('&ZCGPR' EQ '0').ZG7Q                          00179100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00179200
                  AIF   (T'&ZCGPR NE 'N').ZG7Q  INVALID REG NAME        00179300
.ZG7P             ANOP  ,                                               00179400
                  AIF   (T'&ZCGPR NE 'N').ZG7R  NON NUMERIC             00179500
                  AIF   ('&ZCGPR' LT '2').ZG7Q                          00179600
                  AIF   ('&ZCGPR' LE '12').ZG7R                         00179700
.ZG7Q             ANOP  ,                                               00179800
&ZMS              SETC  '"AREAADDR64C='                                 00179900
&ZMS              SETC  '&ZMS.&AREAADDR64C"'                            00180000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00180100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00180200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00180300
.ZG7R             ANOP  ,                                               00180400
.*-------------------------------------------------------------------   00180500
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00180600
.ZG8ZY            ANOP ,            END MUTUALLY EXCLUSIVE KEYS         00180700
.*----------------------------------------------------------------***   00180800
.***AG.KMEKY01 NAME, RQD OUTPUT, ME KEYS -XVARIABLE                     00180900
&XDUMMYB          SETC  ''          INITIALIZE XVARIABLE                00181000
                  AIF   (K'&BUFFER LE 0).ZG10C                          00181100
&ZXDUMMYB         SETC  'OUTPUT'    SET IN/OUTPUT                       00181200
&XDUMMYB          SETC  'BUFFER'    SET XVARIABLE                       00181300
&ZXBUFFER         SETC  'OUTPUT'    SET IN/OUTPUT                       00181400
&XBUFFER          SETC  '&BUFFER(1)'            SET XVARIABLE PARM      00181500
                  AIF   (N'&BUFFER GT 1).ZG10A                          00181600
&XBUFFER          SETC  '&BUFFER'   SET XVARIABLE PARM                  00181700
.ZG10A            AIF   (N'&BUFFER LE 1).ZG10B  CK NUM                  00181800
&ZMS              SETC  '"BUFFER='                                      00181900
&ZMS              SETC  '&ZMS.&BUFFER"'                                 00182000
&ZMS              SETC  '&ZMS "BUFFER"'                                 00182100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00182200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00182300
.ZG10B            AIF   (K'&XBUFFER GT 0).ZG10C  ONE PARM               00182400
&ZXDUMMYB         SETC  ''          RESET IN/OUTPUT                     00182500
&ZXBUFFER         SETC  ''          RESET IN/OUTPUT                     00182600
&ZMS              SETC  ' '                                             00182700
&ZMS              SETC  '&ZMS "BUFFER" KEY AND ITS'                     00182800
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00182900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00183000
.ZG10C            ANOP  ,                                               00183100
.*----------------------------------------------------------------***   00183200
.***AG.KMEKY02 NAME, RQD OUTPUT, ME KEYS -XVARIABLE                     00183300
                  AIF   (K'&BUFFER64 LE 0).ZG11D  NO ME KEY             00183400
                  AIF   (N'&BUFFER64 LE 1).ZG11A  CK NUM                00183500
&ZMS              SETC  '"BUFFER64='                                    00183600
&ZMS              SETC  '&ZMS.&BUFFER64"'                               00183700
&ZMS              SETC  '&ZMS "BUFFER64"'                               00183800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00183900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00184000
.ZG11A            AIF   (K'&XDUMMYB LE 0).ZG11B                         00184100
&ZMS              SETC  '"BUFFER64'                                     00184200
&ZMS              SETC  '&ZMS.=&BUFFER64"'                              00184300
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00184400
&ZMS              SETC  '&ZMS "&XDUMMYB"'                               00184500
                  MNOTE 8,' &ZMS KEY.'                                  00184600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00184700
                  AGO   .ZG11D                                          00184800
.*                                                                      00184900
.ZG11B            ANOP  ,                                               00185000
&ZXDUMMYB         SETC  'OUTPUT'    SET IN/OUTPUT                       00185100
&XDUMMYB          SETC  'BUFFER64'  SET XVARIABLE                       00185200
&ZXBUFFER64       SETC  'OUTPUT'    SET IN/OUTPUT                       00185300
&XBUFFER64        SETC  '&BUFFER64(1)'          SET XVARIABLE PARM      00185400
                  AIF   (N'&BUFFER64 GT 1).ZG11C                        00185500
&XBUFFER64        SETC  '&BUFFER64'             SET XVARIABLE PARM      00185600
.ZG11C            AIF   (K'&XBUFFER64 GT 0).ZG11D  ONE PARM             00185700
&ZXDUMMYB         SETC  ''          RESET IN/OUTPUT                     00185800
&ZXBUFFER64       SETC  ''          RESET IN/OUTPUT                     00185900
&ZMS              SETC  ' '                                             00186000
&ZMS              SETC  '&ZMS "BUFFER64" KEY AND ITS'                   00186100
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00186200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00186300
.ZG11D            ANOP  ,                                               00186400
.*------------------------------------------------------------------    00186500
.***AG.KME4Y09 NAME, RQD OUTPUT, ME KEYS -CHECK IF KEY ENTERED          00186600
                  AIF   (K'&XDUMMYB GT 0).ZG12B                         00186700
&ZXDUMMYB         SETC  ''          RESET IN/OUTPUT                     00186800
&ZXBUFFER         SETC  ''          RESET IN/OUTPUT                     00186900
&XDUMMYB          SETC  ''          ENSURE NULL                         00187000
&XBUFFER          SETC  ''          ENSURE NULL                         00187100
&ZMS              SETC  'ONE OF THE FOLLOWING'                          00187200
&ZMS              SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'             00187300
&ZMS              SETC  '&ZMS REQUIRED:'                                00187400
&ZMS              SETC  '&ZMS "BUFFER"'         VALID ME KEY            00187500
&ZMS              SETC  '&ZMS OR "BUFFER64".'   VALID ME KEY            00187600
                  MNOTE 8,' &ZMS '                                      00187700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00187800
.ZG12B            ANOP  ,                                               00187900
.*-------------------------------------------------------------------   00188000
.***AG.KMEKY13 NAME, RQD OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00188100
.ZG10ZY  AIF    ('&XDUMMYB' NE 'BUFFER').ZG11ZY                         00188200
.*-------------------------------------------------------------------   00188300
.***AG.KCK02 NAME, RQD OUTPUT, ME KEYS -GPR OUT OF RANGE                00188400
                  AIF   (K'&ZXBUFFER LE 0).ZG10R  NOT I/O               00188500
                  AIF   ('&XBUFFER'(1,1) NE '(').ZG10R                  00188600
&ZCGPR            SETC  '&XBUFFER'(2,K'&XBUFFER-2)                      00188700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                    00188800
                  AIF   (K'&ZCGPR GT 2).ZG10Q                           00188900
                  AIF   ('&ZCGPR' EQ '0').ZG10Q                         00189000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00189100
                  AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME       00189200
.ZG10P            ANOP  ,                                               00189300
                  AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC            00189400
                  AIF   ('&ZCGPR' LT '2').ZG10Q                         00189500
                  AIF   ('&ZCGPR' LE '12').ZG10R                        00189600
.ZG10Q            ANOP  ,                                               00189700
&ZMS              SETC  '"BUFFER='                                      00189800
&ZMS              SETC  '&ZMS.&BUFFER"'                                 00189900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00190000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00190100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00190200
.ZG10R            ANOP  ,                                               00190300
.*-------------------------------------------------------------------   00190400
.***AG.KMEKY13 NAME, RQD OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00190500
.ZG11ZY  AIF    ('&XDUMMYB' NE 'BUFFER64').ZG12ZY                       00190600
.*-------------------------------------------------------------------   00190700
.***AG.KCK02 NAME, RQD OUTPUT, ME KEYS -GPR OUT OF RANGE                00190800
                  AIF   (K'&ZXBUFFER64 LE 0).ZG11R  NOT I/O             00190900
                  AIF   ('&XBUFFER64'(1,1) NE '(').ZG11R                00191000
&ZCGPR            SETC  '&XBUFFER64'(2,K'&XBUFFER64-2)                  00191100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                    00191200
                  AIF   (K'&ZCGPR GT 2).ZG11Q                           00191300
                  AIF   ('&ZCGPR' EQ '0').ZG11Q                         00191400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00191500
                  AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME       00191600
.ZG11P            ANOP  ,                                               00191700
                  AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC            00191800
                  AIF   ('&ZCGPR' LT '2').ZG11Q                         00191900
                  AIF   ('&ZCGPR' LE '12').ZG11R                        00192000
.ZG11Q            ANOP  ,                                               00192100
&ZMS              SETC  '"BUFFER64='                                    00192200
&ZMS              SETC  '&ZMS.&BUFFER64"'                               00192300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00192400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00192500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00192600
.ZG11R            ANOP  ,                                               00192700
.*-------------------------------------------------------------------   00192800
.***AG.KMEKY15 NAME, RQD OUTPUT, ME KEYS -END                           00192900
.ZG12ZY           ANOP ,            END MUTUALLY EXCLUSIVE KEYS         00193000
.*----------------------------------------------------------------***   00193100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00193200
                  AIF   (N'&BUFFERLEN LE 1).ZG14A  CK NUM               00193300
&ZMS              SETC  '"BUFFERLEN='                                   00193400
&ZMS              SETC  '&ZMS.&BUFFERLEN"'                              00193500
&ZMS              SETC  '&ZMS "BUFFERLEN"'                              00193600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00193700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00193800
.ZG14A            ANOP  ,                                               00193900
.*-------------------------------------------------------------------   00194000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00194100
&ZXBUFFERLEN      SETC  'INPUT'     SET IN/OUTPUT                       00194200
&XBUFFERLEN       SETC  '&BUFFERLEN(1)'         SET XVARIABLE           00194300
                  AIF   (N'&BUFFERLEN GT 1).ZG14B  MULTI                00194400
&XBUFFERLEN       SETC  '&BUFFERLEN'            SET XVARIABLE           00194500
.ZG14B            AIF   (K'&BUFFERLEN(1) GT 0).ZG14C                    00194600
&ZXBUFFERLEN      SETC  ''          RESET IN/OUTPUT                     00194700
&ZMS              SETC  ' '                                             00194800
&ZMS              SETC  '&ZMS "BUFFERLEN" KEY AND ITS'                  00194900
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00195000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00195100
.ZG14C            ANOP  ,                                               00195200
.*-------------------------------------------------------------------   00195300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00195400
                  AIF   (K'&ZXBUFFERLEN LE 0).ZG14R  NOT I/O            00195500
                  AIF   ('&XBUFFERLEN'(1,1) NE '(').ZG14R               00195600
&ZCGPR            SETC  '&XBUFFERLEN'(2,K'&XBUFFERLEN-2)                00195700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                    00195800
                  AIF   (K'&ZCGPR GT 2).ZG14Q                           00195900
                  AIF   ('&ZCGPR' EQ '0').ZG14Q                         00196000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00196100
                  AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME       00196200
.ZG14P            ANOP  ,                                               00196300
                  AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC            00196400
                  AIF   ('&ZCGPR' LT '2').ZG14Q                         00196500
                  AIF   ('&ZCGPR' LE '12').ZG14R                        00196600
.ZG14Q            ANOP  ,                                               00196700
&ZMS              SETC  '"BUFFERLEN='                                   00196800
&ZMS              SETC  '&ZMS.&BUFFERLEN"'                              00196900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00197000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00197100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00197200
.ZG14R            ANOP  ,                                               00197300
.*-------------------------------------------------------------------   00197400
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00197500
                  AIF   ('&XMF' EQ 'M').ZG18    BYPASS IF MF=M          00197600
.*----------------------------------------------------------------***   00197700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00197800
                  AIF   (N'&BUFFERLENV LE 1).ZG17A  CK NUM              00197900
&ZMS              SETC  '"BUFFERLENV='                                  00198000
&ZMS              SETC  '&ZMS.&BUFFERLENV"'                             00198100
&ZMS              SETC  '&ZMS "BUFFERLENV"'                             00198200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00198300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00198400
.ZG17A            ANOP  ,                                               00198500
.*-------------------------------------------------------------------   00198600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00198700
                  AIF   (K'&BUFFERLENV(1) LE 0).ZG17C  NO PARM          00198800
&ZXBUFFERLENV     SETC  'OUTPUT'    SET OUTPUT                          00198900
&XBUFFERLENV      SETC  '&BUFFERLENV(1)'        SET XVARIABLE           00199000
                  AIF   (N'&BUFFERLENV GT 1).ZG17C                      00199100
&XBUFFERLENV      SETC  '&BUFFERLENV'           SET XVARIABLE           00199200
.ZG17C            ANOP  ,                                               00199300
.*-------------------------------------------------------------------   00199400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00199500
                  AIF   (K'&ZXBUFFERLENV LE 0).ZG17R  NOT I/O           00199600
                  AIF   ('&XBUFFERLENV'(1,1) NE '(').ZG17R              00199700
&ZCGPR            SETC  '&XBUFFERLENV'(2,K'&XBUFFERLENV-2)              00199800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                    00199900
                  AIF   (K'&ZCGPR GT 2).ZG17Q                           00200000
                  AIF   ('&ZCGPR' EQ '0').ZG17Q                         00200100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00200200
                  AIF   (T'&ZCGPR NE 'N').ZG17Q  INVALID REG NAME       00200300
.ZG17P            ANOP  ,                                               00200400
                  AIF   (T'&ZCGPR NE 'N').ZG17R  NON NUMERIC            00200500
                  AIF   ('&ZCGPR' LT '2').ZG17Q                         00200600
                  AIF   ('&ZCGPR' LE '12').ZG17R                        00200700
.ZG17Q            ANOP  ,                                               00200800
&ZMS              SETC  '"BUFFERLENV='                                  00200900
&ZMS              SETC  '&ZMS.&BUFFERLENV"'                             00201000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00201100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00201200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00201300
.ZG17R            ANOP  ,                                               00201400
.*-------------------------------------------------------------------   00201500
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00201600
.ZG18             ANOP  ,           END OF BYPASS CHECK                 00201700
.*-------------------------------------------------------------------   00201800
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00201900
                  AIF   ('&XMF' EQ 'M').ZG21    BYPASS IF MF=M          00202000
.*----------------------------------------------------------------***   00202100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00202200
                  AIF   (N'&AUTHSTATE LE 1).ZG20A  CK NUM               00202300
&ZMS              SETC  '"AUTHSTATE='                                   00202400
&ZMS              SETC  '&ZMS.&AUTHSTATE"'                              00202500
&ZMS              SETC  '&ZMS "AUTHSTATE"'                              00202600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00202700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00202800
.ZG20A            ANOP  ,                                               00202900
.*-------------------------------------------------------------------   00203000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00203100
                  AIF   (K'&AUTHSTATE(1) LE 0).ZG20C  NO PARM           00203200
&ZXAUTHSTATE      SETC  'OUTPUT'    SET OUTPUT                          00203300
&XAUTHSTATE       SETC  '&AUTHSTATE(1)'         SET XVARIABLE           00203400
                  AIF   (N'&AUTHSTATE GT 1).ZG20C                       00203500
&XAUTHSTATE       SETC  '&AUTHSTATE'            SET XVARIABLE           00203600
.ZG20C            ANOP  ,                                               00203700
.*-------------------------------------------------------------------   00203800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00203900
                  AIF   (K'&ZXAUTHSTATE LE 0).ZG20R  NOT I/O            00204000
                  AIF   ('&XAUTHSTATE'(1,1) NE '(').ZG20R               00204100
&ZCGPR            SETC  '&XAUTHSTATE'(2,K'&XAUTHSTATE-2)                00204200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                    00204300
                  AIF   (K'&ZCGPR GT 2).ZG20Q                           00204400
                  AIF   ('&ZCGPR' EQ '0').ZG20Q                         00204500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00204600
                  AIF   (T'&ZCGPR NE 'N').ZG20Q  INVALID REG NAME       00204700
.ZG20P            ANOP  ,                                               00204800
                  AIF   (T'&ZCGPR NE 'N').ZG20R  NON NUMERIC            00204900
                  AIF   ('&ZCGPR' LT '2').ZG20Q                         00205000
                  AIF   ('&ZCGPR' LE '12').ZG20R                        00205100
.ZG20Q            ANOP  ,                                               00205200
&ZMS              SETC  '"AUTHSTATE='                                   00205300
&ZMS              SETC  '&ZMS.&AUTHSTATE"'                              00205400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00205500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00205600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00205700
.ZG20R            ANOP  ,                                               00205800
.*-------------------------------------------------------------------   00205900
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00206000
.ZG21             ANOP  ,           END OF BYPASS CHECK                 00206100
.*-------------------------------------------------------------------   00206200
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00206300
                  AIF   ('&XMF' EQ 'M').ZG24    BYPASS IF MF=M          00206400
.*----------------------------------------------------------------***   00206500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00206600
                  AIF   (N'&AREAKEY LE 1).ZG23A  CK NUM                 00206700
&ZMS              SETC  '"AREAKEY='                                     00206800
&ZMS              SETC  '&ZMS.&AREAKEY"'                                00206900
&ZMS              SETC  '&ZMS "AREAKEY"'                                00207000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00207100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00207200
.ZG23A            ANOP  ,                                               00207300
.*-------------------------------------------------------------------   00207400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00207500
                  AIF   (K'&AREAKEY(1) LE 0).ZG23C  NO PARM             00207600
&ZXAREAKEY        SETC  'OUTPUT'    SET OUTPUT                          00207700
&XAREAKEY         SETC  '&AREAKEY(1)'           SET XVARIABLE           00207800
                  AIF   (N'&AREAKEY GT 1).ZG23C                         00207900
&XAREAKEY         SETC  '&AREAKEY'  SET XVARIABLE                       00208000
.ZG23C            ANOP  ,                                               00208100
.*-------------------------------------------------------------------   00208200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00208300
                  AIF   (K'&ZXAREAKEY LE 0).ZG23R  NOT I/O              00208400
                  AIF   ('&XAREAKEY'(1,1) NE '(').ZG23R                 00208500
&ZCGPR            SETC  '&XAREAKEY'(2,K'&XAREAKEY-2)                    00208600
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                    00208700
                  AIF   (K'&ZCGPR GT 2).ZG23Q                           00208800
                  AIF   ('&ZCGPR' EQ '0').ZG23Q                         00208900
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00209000
                  AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME       00209100
.ZG23P            ANOP  ,                                               00209200
                  AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC            00209300
                  AIF   ('&ZCGPR' LT '2').ZG23Q                         00209400
                  AIF   ('&ZCGPR' LE '12').ZG23R                        00209500
.ZG23Q            ANOP  ,                                               00209600
&ZMS              SETC  '"AREAKEY='                                     00209700
&ZMS              SETC  '&ZMS.&AREAKEY"'                                00209800
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00209900
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00210000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00210100
.ZG23R            ANOP  ,                                               00210200
.*-------------------------------------------------------------------   00210300
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00210400
.ZG24             ANOP  ,           END OF BYPASS CHECK                 00210500
.*-------------------------------------------------------------------   00210600
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00210700
                  AIF   ('&XMF' EQ 'M').ZG27    BYPASS IF MF=M          00210800
.*----------------------------------------------------------------***   00210900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00211000
                  AIF   (N'&NEXTKEY LE 1).ZG26A  CK NUM                 00211100
&ZMS              SETC  '"NEXTKEY='                                     00211200
&ZMS              SETC  '&ZMS.&NEXTKEY"'                                00211300
&ZMS              SETC  '&ZMS "NEXTKEY"'                                00211400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00211500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00211600
.ZG26A            ANOP  ,                                               00211700
.*-------------------------------------------------------------------   00211800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00211900
                  AIF   (K'&NEXTKEY(1) LE 0).ZG26C  NO PARM             00212000
&ZXNEXTKEY        SETC  'OUTPUT'    SET OUTPUT                          00212100
&XNEXTKEY         SETC  '&NEXTKEY(1)'           SET XVARIABLE           00212200
                  AIF   (N'&NEXTKEY GT 1).ZG26C                         00212300
&XNEXTKEY         SETC  '&NEXTKEY'  SET XVARIABLE                       00212400
.ZG26C            ANOP  ,                                               00212500
.*-------------------------------------------------------------------   00212600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00212700
                  AIF   (K'&ZXNEXTKEY LE 0).ZG26R  NOT I/O              00212800
                  AIF   ('&XNEXTKEY'(1,1) NE '(').ZG26R                 00212900
&ZCGPR            SETC  '&XNEXTKEY'(2,K'&XNEXTKEY-2)                    00213000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                    00213100
                  AIF   (K'&ZCGPR GT 2).ZG26Q                           00213200
                  AIF   ('&ZCGPR' EQ '0').ZG26Q                         00213300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00213400
                  AIF   (T'&ZCGPR NE 'N').ZG26Q  INVALID REG NAME       00213500
.ZG26P            ANOP  ,                                               00213600
                  AIF   (T'&ZCGPR NE 'N').ZG26R  NON NUMERIC            00213700
                  AIF   ('&ZCGPR' LT '2').ZG26Q                         00213800
                  AIF   ('&ZCGPR' LE '12').ZG26R                        00213900
.ZG26Q            ANOP  ,                                               00214000
&ZMS              SETC  '"NEXTKEY='                                     00214100
&ZMS              SETC  '&ZMS.&NEXTKEY"'                                00214200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00214300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00214400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00214500
.ZG26R            ANOP  ,                                               00214600
.*-------------------------------------------------------------------   00214700
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00214800
.ZG27             ANOP  ,           END OF BYPASS CHECK                 00214900
.*-------------------------------------------------------------------   00215000
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00215100
                  AIF   ('&XMF' EQ 'M').ZG31    BYPASS IF MF=M          00215200
.*----------------------------------------------------------------***   00215300
.***AG.KMEKY01 NAME, OPT OUTPUT, ME KEYS -XVARIABLE                     00215400
&XDUMMYF          SETC  ''          INITIALIZE XVARIABLE                00215500
                  AIF   (K'&FIRSTADDR64 LE 0).ZG29C                     00215600
&ZXDUMMYF         SETC  'OUTPUT'    SET IN/OUTPUT                       00215700
&XDUMMYF          SETC  'FIRSTADDR64'           SET XVARIABLE           00215800
&ZXFIRSTADDR64    SETC  'OUTPUT'    SET IN/OUTPUT                       00215900
&XFIRSTADDR64     SETC  '&FIRSTADDR64(1)'       SET XVARIABLE PARM      00216000
                  AIF   (N'&FIRSTADDR64 GT 1).ZG29A                     00216100
&XFIRSTADDR64     SETC  '&FIRSTADDR64'          SET XVARIABLE PARM      00216200
.ZG29A            AIF   (N'&FIRSTADDR64 LE 1).ZG29B  CK NUM             00216300
&ZMS              SETC  '"FIRSTADDR64='                                 00216400
&ZMS              SETC  '&ZMS.&FIRSTADDR64"'                            00216500
&ZMS              SETC  '&ZMS "FIRSTADDR64"'                            00216600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00216700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00216800
.ZG29B            AIF   (K'&XFIRSTADDR64 GT 0).ZG29C  ONE PARM          00216900
&ZXDUMMYF         SETC  ''          RESET IN/OUTPUT                     00217000
&ZXFIRSTADDR64    SETC  ''          RESET IN/OUTPUT                     00217100
&ZMS              SETC  ' '                                             00217200
&ZMS              SETC  '&ZMS "FIRSTADDR64" KEY AND ITS'                00217300
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00217400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00217500
.ZG29C            ANOP  ,                                               00217600
.*----------------------------------------------------------------***   00217700
.***AG.KMEKY02 NAME, OPT OUTPUT, ME KEYS -XVARIABLE                     00217800
                  AIF   (K'&FIRSTADDR64C LE 0).ZG30D  NO ME KEY         00217900
                  AIF   (N'&FIRSTADDR64C LE 1).ZG30A  CK NUM            00218000
&ZMS              SETC  '"FIRSTADDR64C='                                00218100
&ZMS              SETC  '&ZMS.&FIRSTADDR64C"'                           00218200
&ZMS              SETC  '&ZMS "FIRSTADDR64C"'                           00218300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00218400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00218500
.ZG30A            AIF   (K'&XDUMMYF LE 0).ZG30B                         00218600
&ZMS              SETC  '"FIRSTADDR64C'                                 00218700
&ZMS              SETC  '&ZMS.=&FIRSTADDR64C"'                          00218800
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00218900
&ZMS              SETC  '&ZMS "&XDUMMYF"'                               00219000
                  MNOTE 8,' &ZMS KEY.'                                  00219100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00219200
                  AGO   .ZG30D                                          00219300
.*                                                                      00219400
.ZG30B            ANOP  ,                                               00219500
&ZXDUMMYF         SETC  'OUTPUT'    SET IN/OUTPUT                       00219600
&XDUMMYF          SETC  'FIRSTADDR64C'          SET XVARIABLE           00219700
&ZXFIRSTADDR64C   SETC  'OUTPUT'    SET IN/OUTPUT                       00219800
&XFIRSTADDR64C    SETC  '&FIRSTADDR64C(1)'      SET XVARIABLE PARM      00219900
                  AIF   (N'&FIRSTADDR64C GT 1).ZG30C                    00220000
&XFIRSTADDR64C    SETC  '&FIRSTADDR64C'         SET XVARIABLE PARM      00220100
.ZG30C            AIF   (K'&XFIRSTADDR64C GT 0).ZG30D  ONE PARM         00220200
&ZXDUMMYF         SETC  ''          RESET IN/OUTPUT                     00220300
&ZXFIRSTADDR64C   SETC  ''          RESET IN/OUTPUT                     00220400
&ZMS              SETC  ' '                                             00220500
&ZMS              SETC  '&ZMS "FIRSTADDR64C" KEY AND ITS'               00220600
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00220700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00220800
.ZG30D            ANOP  ,                                               00220900
.*------------------------------------------------------------------    00221000
.***AG.KMEKY08 NAME, OPT OUTPUT, ME KEYS -CHECK IF KEY ENTERED          00221100
                  AIF   (K'&XDUMMYF GT 0).ZG31B                         00221200
&ZXDUMMYF         SETC  ''          RESET IN/OUTPUT                     00221300
&XDUMMYF          SETC  'FIRSTADDR64'           SET DEFAULT             00221400
.ZG31B            ANOP  ,                                               00221500
.*-------------------------------------------------------------------   00221600
.***AG.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00221700
                  AIF   (K'&ZXFIRSTADDR64C LE 0).ZG31R  NOT I/O         00221800
                  AIF   ('&XFIRSTADDR64C'(1,1) NE '(').ZG31R            00221900
&ZCGPR            SETC  '&XFIRSTADDR64C'(2,K'&XFIRSTADDR64C-2)          00222000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                    00222100
                  AIF   (K'&ZCGPR GT 2).ZG31Q                           00222200
                  AIF   ('&ZCGPR' EQ '0').ZG31Q                         00222300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00222400
                  AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME       00222500
.ZG31P            ANOP  ,                                               00222600
                  AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC            00222700
                  AIF   ('&ZCGPR' LT '2').ZG31Q                         00222800
                  AIF   ('&ZCGPR' LE '12').ZG31R                        00222900
.ZG31Q            ANOP  ,                                               00223000
&ZMS              SETC  '"FIRSTADDR64C='                                00223100
&ZMS              SETC  '&ZMS.&FIRSTADDR64C"'                           00223200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00223300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00223400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00223500
.ZG31R            ANOP  ,                                               00223600
.*-------------------------------------------------------------------   00223700
.***AG.KMEKY13 NAME, OPT OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00223800
.ZG29ZY  AIF    ('&XDUMMYF' NE 'FIRSTADDR64').ZG30ZY                    00223900
.*-------------------------------------------------------------------   00224000
.***AG.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00224100
                  AIF   (K'&ZXFIRSTADDR64 LE 0).ZG29R  NOT I/O          00224200
                  AIF   ('&XFIRSTADDR64'(1,1) NE '(').ZG29R             00224300
&ZCGPR            SETC  '&XFIRSTADDR64'(2,K'&XFIRSTADDR64-2)            00224400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                    00224500
                  AIF   (K'&ZCGPR GT 2).ZG29Q                           00224600
                  AIF   ('&ZCGPR' EQ '0').ZG29Q                         00224700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00224800
                  AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME       00224900
.ZG29P            ANOP  ,                                               00225000
                  AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC            00225100
                  AIF   ('&ZCGPR' LT '2').ZG29Q                         00225200
                  AIF   ('&ZCGPR' LE '12').ZG29R                        00225300
.ZG29Q            ANOP  ,                                               00225400
&ZMS              SETC  '"FIRSTADDR64='                                 00225500
&ZMS              SETC  '&ZMS.&FIRSTADDR64"'                            00225600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00225700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00225800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00225900
.ZG29R            ANOP  ,                                               00226000
.*-------------------------------------------------------------------   00226100
.***AG.KMEKY13 NAME, OPT OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00226200
.ZG30ZY  AIF    ('&XDUMMYF' NE 'FIRSTADDR64C').ZG31ZY                   00226300
.*-------------------------------------------------------------------   00226400
.***AG.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00226500
                  AIF   (K'&ZXFIRSTADDR64C LE 0).ZG30R  NOT I/O         00226600
                  AIF   ('&XFIRSTADDR64C'(1,1) NE '(').ZG30R            00226700
&ZCGPR            SETC  '&XFIRSTADDR64C'(2,K'&XFIRSTADDR64C-2)          00226800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG30P                    00226900
                  AIF   (K'&ZCGPR GT 2).ZG30Q                           00227000
                  AIF   ('&ZCGPR' EQ '0').ZG30Q                         00227100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00227200
                  AIF   (T'&ZCGPR NE 'N').ZG30Q  INVALID REG NAME       00227300
.ZG30P            ANOP  ,                                               00227400
                  AIF   (T'&ZCGPR NE 'N').ZG30R  NON NUMERIC            00227500
                  AIF   ('&ZCGPR' LT '2').ZG30Q                         00227600
                  AIF   ('&ZCGPR' LE '12').ZG30R                        00227700
.ZG30Q            ANOP  ,                                               00227800
&ZMS              SETC  '"FIRSTADDR64C='                                00227900
&ZMS              SETC  '&ZMS.&FIRSTADDR64C"'                           00228000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00228100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00228200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00228300
.ZG30R            ANOP  ,                                               00228400
.*-------------------------------------------------------------------   00228500
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00228600
.ZG31             ANOP  ,           END OF BYPASS CHECK                 00228700
.*-------------------------------------------------------------------   00228800
.***AG.KMEKY15 NAME, OPT OUTPUT, ME KEYS -END                           00228900
.ZG31ZY           ANOP ,            END MUTUALLY EXCLUSIVE KEYS         00229000
.*-------------------------------------------------------------------   00229100
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00229200
                  AIF   ('&XMF' EQ 'M').ZG35    BYPASS IF MF=M          00229300
.*----------------------------------------------------------------***   00229400
.***AG.KMEKY01 NAME, OPT OUTPUT, ME KEYS -XVARIABLE                     00229500
&XDUMMYL          SETC  ''          INITIALIZE XVARIABLE                00229600
                  AIF   (K'&LASTADDR64 LE 0).ZG33C                      00229700
&ZXDUMMYL         SETC  'OUTPUT'    SET IN/OUTPUT                       00229800
&XDUMMYL          SETC  'LASTADDR64'            SET XVARIABLE           00229900
&ZXLASTADDR64     SETC  'OUTPUT'    SET IN/OUTPUT                       00230000
&XLASTADDR64      SETC  '&LASTADDR64(1)'        SET XVARIABLE PARM      00230100
                  AIF   (N'&LASTADDR64 GT 1).ZG33A                      00230200
&XLASTADDR64      SETC  '&LASTADDR64'           SET XVARIABLE PARM      00230300
.ZG33A            AIF   (N'&LASTADDR64 LE 1).ZG33B  CK NUM              00230400
&ZMS              SETC  '"LASTADDR64='                                  00230500
&ZMS              SETC  '&ZMS.&LASTADDR64"'                             00230600
&ZMS              SETC  '&ZMS "LASTADDR64"'                             00230700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00230800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00230900
.ZG33B            AIF   (K'&XLASTADDR64 GT 0).ZG33C  ONE PARM           00231000
&ZXDUMMYL         SETC  ''          RESET IN/OUTPUT                     00231100
&ZXLASTADDR64     SETC  ''          RESET IN/OUTPUT                     00231200
&ZMS              SETC  ' '                                             00231300
&ZMS              SETC  '&ZMS "LASTADDR64" KEY AND ITS'                 00231400
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00231500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00231600
.ZG33C            ANOP  ,                                               00231700
.*----------------------------------------------------------------***   00231800
.***AG.KMEKY02 NAME, OPT OUTPUT, ME KEYS -XVARIABLE                     00231900
                  AIF   (K'&LASTADDR64C LE 0).ZG34D  NO ME KEY          00232000
                  AIF   (N'&LASTADDR64C LE 1).ZG34A  CK NUM             00232100
&ZMS              SETC  '"LASTADDR64C='                                 00232200
&ZMS              SETC  '&ZMS.&LASTADDR64C"'                            00232300
&ZMS              SETC  '&ZMS "LASTADDR64C"'                            00232400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00232500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00232600
.ZG34A            AIF   (K'&XDUMMYL LE 0).ZG34B                         00232700
&ZMS              SETC  '"LASTADDR64C'                                  00232800
&ZMS              SETC  '&ZMS.=&LASTADDR64C"'                           00232900
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00233000
&ZMS              SETC  '&ZMS "&XDUMMYL"'                               00233100
                  MNOTE 8,' &ZMS KEY.'                                  00233200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00233300
                  AGO   .ZG34D                                          00233400
.*                                                                      00233500
.ZG34B            ANOP  ,                                               00233600
&ZXDUMMYL         SETC  'OUTPUT'    SET IN/OUTPUT                       00233700
&XDUMMYL          SETC  'LASTADDR64C'           SET XVARIABLE           00233800
&ZXLASTADDR64C    SETC  'OUTPUT'    SET IN/OUTPUT                       00233900
&XLASTADDR64C     SETC  '&LASTADDR64C(1)'       SET XVARIABLE PARM      00234000
                  AIF   (N'&LASTADDR64C GT 1).ZG34C                     00234100
&XLASTADDR64C     SETC  '&LASTADDR64C'          SET XVARIABLE PARM      00234200
.ZG34C            AIF   (K'&XLASTADDR64C GT 0).ZG34D  ONE PARM          00234300
&ZXDUMMYL         SETC  ''          RESET IN/OUTPUT                     00234400
&ZXLASTADDR64C    SETC  ''          RESET IN/OUTPUT                     00234500
&ZMS              SETC  ' '                                             00234600
&ZMS              SETC  '&ZMS "LASTADDR64C" KEY AND ITS'                00234700
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00234800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00234900
.ZG34D            ANOP  ,                                               00235000
.*------------------------------------------------------------------    00235100
.***AG.KMEKY08 NAME, OPT OUTPUT, ME KEYS -CHECK IF KEY ENTERED          00235200
                  AIF   (K'&XDUMMYL GT 0).ZG35B                         00235300
&ZXDUMMYL         SETC  ''          RESET IN/OUTPUT                     00235400
&XDUMMYL          SETC  'LASTADDR64'            SET DEFAULT             00235500
.ZG35B            ANOP  ,                                               00235600
.*-------------------------------------------------------------------   00235700
.***AG.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00235800
                  AIF   (K'&ZXLASTADDR64C LE 0).ZG35R  NOT I/O          00235900
                  AIF   ('&XLASTADDR64C'(1,1) NE '(').ZG35R             00236000
&ZCGPR            SETC  '&XLASTADDR64C'(2,K'&XLASTADDR64C-2)            00236100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                    00236200
                  AIF   (K'&ZCGPR GT 2).ZG35Q                           00236300
                  AIF   ('&ZCGPR' EQ '0').ZG35Q                         00236400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00236500
                  AIF   (T'&ZCGPR NE 'N').ZG35Q  INVALID REG NAME       00236600
.ZG35P            ANOP  ,                                               00236700
                  AIF   (T'&ZCGPR NE 'N').ZG35R  NON NUMERIC            00236800
                  AIF   ('&ZCGPR' LT '2').ZG35Q                         00236900
                  AIF   ('&ZCGPR' LE '12').ZG35R                        00237000
.ZG35Q            ANOP  ,                                               00237100
&ZMS              SETC  '"LASTADDR64C='                                 00237200
&ZMS              SETC  '&ZMS.&LASTADDR64C"'                            00237300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00237400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00237500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00237600
.ZG35R            ANOP  ,                                               00237700
.*-------------------------------------------------------------------   00237800
.***AG.KMEKY13 NAME, OPT OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00237900
.ZG33ZY  AIF    ('&XDUMMYL' NE 'LASTADDR64').ZG34ZY                     00238000
.*-------------------------------------------------------------------   00238100
.***AG.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00238200
                  AIF   (K'&ZXLASTADDR64 LE 0).ZG33R  NOT I/O           00238300
                  AIF   ('&XLASTADDR64'(1,1) NE '(').ZG33R              00238400
&ZCGPR            SETC  '&XLASTADDR64'(2,K'&XLASTADDR64-2)              00238500
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                    00238600
                  AIF   (K'&ZCGPR GT 2).ZG33Q                           00238700
                  AIF   ('&ZCGPR' EQ '0').ZG33Q                         00238800
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00238900
                  AIF   (T'&ZCGPR NE 'N').ZG33Q  INVALID REG NAME       00239000
.ZG33P            ANOP  ,                                               00239100
                  AIF   (T'&ZCGPR NE 'N').ZG33R  NON NUMERIC            00239200
                  AIF   ('&ZCGPR' LT '2').ZG33Q                         00239300
                  AIF   ('&ZCGPR' LE '12').ZG33R                        00239400
.ZG33Q            ANOP  ,                                               00239500
&ZMS              SETC  '"LASTADDR64='                                  00239600
&ZMS              SETC  '&ZMS.&LASTADDR64"'                             00239700
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00239800
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00239900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00240000
.ZG33R            ANOP  ,                                               00240100
.*-------------------------------------------------------------------   00240200
.***AG.KMEKY13 NAME, OPT OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00240300
.ZG34ZY  AIF    ('&XDUMMYL' NE 'LASTADDR64C').ZG35ZY                    00240400
.*-------------------------------------------------------------------   00240500
.***AG.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00240600
                  AIF   (K'&ZXLASTADDR64C LE 0).ZG34R  NOT I/O          00240700
                  AIF   ('&XLASTADDR64C'(1,1) NE '(').ZG34R             00240800
&ZCGPR            SETC  '&XLASTADDR64C'(2,K'&XLASTADDR64C-2)            00240900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                    00241000
                  AIF   (K'&ZCGPR GT 2).ZG34Q                           00241100
                  AIF   ('&ZCGPR' EQ '0').ZG34Q                         00241200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00241300
                  AIF   (T'&ZCGPR NE 'N').ZG34Q  INVALID REG NAME       00241400
.ZG34P            ANOP  ,                                               00241500
                  AIF   (T'&ZCGPR NE 'N').ZG34R  NON NUMERIC            00241600
                  AIF   ('&ZCGPR' LT '2').ZG34Q                         00241700
                  AIF   ('&ZCGPR' LE '12').ZG34R                        00241800
.ZG34Q            ANOP  ,                                               00241900
&ZMS              SETC  '"LASTADDR64C='                                 00242000
&ZMS              SETC  '&ZMS.&LASTADDR64C"'                            00242100
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00242200
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00242300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00242400
.ZG34R            ANOP  ,                                               00242500
.*-------------------------------------------------------------------   00242600
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00242700
.ZG35             ANOP  ,           END OF BYPASS CHECK                 00242800
.*-------------------------------------------------------------------   00242900
.***AG.KMEKY15 NAME, OPT OUTPUT, ME KEYS -END                           00243000
.ZG35ZY           ANOP ,            END MUTUALLY EXCLUSIVE KEYS         00243100
.*-------------------------------------------------------------------   00243200
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00243300
                  AIF   ('&XMF' EQ 'M').ZG38    BYPASS IF MF=M          00243400
.*----------------------------------------------------------------***   00243500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00243600
                  AIF   (N'&COMPCODE LE 1).ZG37A  CK NUM                00243700
&ZMS              SETC  '"COMPCODE='                                    00243800
&ZMS              SETC  '&ZMS.&COMPCODE"'                               00243900
&ZMS              SETC  '&ZMS "COMPCODE"'                               00244000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00244100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00244200
.ZG37A            ANOP  ,                                               00244300
.*-------------------------------------------------------------------   00244400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00244500
                  AIF   (K'&COMPCODE(1) LE 0).ZG37C  NO PARM            00244600
&ZXCOMPCODE       SETC  'OUTPUT'    SET OUTPUT                          00244700
&XCOMPCODE        SETC  '&COMPCODE(1)'          SET XVARIABLE           00244800
                  AIF   (N'&COMPCODE GT 1).ZG37C                        00244900
&XCOMPCODE        SETC  '&COMPCODE'             SET XVARIABLE           00245000
.ZG37C            ANOP  ,                                               00245100
.*-------------------------------------------------------------------   00245200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00245300
                  AIF   (K'&ZXCOMPCODE LE 0).ZG37R  NOT I/O             00245400
                  AIF   ('&XCOMPCODE'(1,1) NE '(').ZG37R                00245500
&ZCGPR            SETC  '&XCOMPCODE'(2,K'&XCOMPCODE-2)                  00245600
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                    00245700
                  AIF   (K'&ZCGPR GT 2).ZG37Q                           00245800
                  AIF   ('&ZCGPR' EQ '0').ZG37Q                         00245900
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00246000
                  AIF   (T'&ZCGPR NE 'N').ZG37Q  INVALID REG NAME       00246100
.ZG37P            ANOP  ,                                               00246200
                  AIF   (T'&ZCGPR NE 'N').ZG37R  NON NUMERIC            00246300
                  AIF   ('&ZCGPR' LT '2').ZG37Q                         00246400
                  AIF   ('&ZCGPR' LE '12').ZG37R                        00246500
.ZG37Q            ANOP  ,                                               00246600
&ZMS              SETC  '"COMPCODE='                                    00246700
&ZMS              SETC  '&ZMS.&COMPCODE"'                               00246800
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00246900
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00247000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00247100
.ZG37R            ANOP  ,                                               00247200
.*-------------------------------------------------------------------   00247300
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00247400
.ZG38             ANOP  ,           END OF BYPASS CHECK                 00247500
.*-------------------------------------------------------------------   00247600
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00247700
                  AIF   ('&XMF' EQ 'M').ZG41    BYPASS IF MF=M          00247800
.*----------------------------------------------------------------***   00247900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00248000
                  AIF   (N'&COMPRSN LE 1).ZG40A  CK NUM                 00248100
&ZMS              SETC  '"COMPRSN='                                     00248200
&ZMS              SETC  '&ZMS.&COMPRSN"'                                00248300
&ZMS              SETC  '&ZMS "COMPRSN"'                                00248400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00248500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00248600
.ZG40A            ANOP  ,                                               00248700
.*-------------------------------------------------------------------   00248800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00248900
                  AIF   (K'&COMPRSN(1) LE 0).ZG40C  NO PARM             00249000
&ZXCOMPRSN        SETC  'OUTPUT'    SET OUTPUT                          00249100
&XCOMPRSN         SETC  '&COMPRSN(1)'           SET XVARIABLE           00249200
                  AIF   (N'&COMPRSN GT 1).ZG40C                         00249300
&XCOMPRSN         SETC  '&COMPRSN'  SET XVARIABLE                       00249400
.ZG40C            ANOP  ,                                               00249500
.*-------------------------------------------------------------------   00249600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00249700
                  AIF   (K'&ZXCOMPRSN LE 0).ZG40R  NOT I/O              00249800
                  AIF   ('&XCOMPRSN'(1,1) NE '(').ZG40R                 00249900
&ZCGPR            SETC  '&XCOMPRSN'(2,K'&XCOMPRSN-2)                    00250000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                    00250100
                  AIF   (K'&ZCGPR GT 2).ZG40Q                           00250200
                  AIF   ('&ZCGPR' EQ '0').ZG40Q                         00250300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00250400
                  AIF   (T'&ZCGPR NE 'N').ZG40Q  INVALID REG NAME       00250500
.ZG40P            ANOP  ,                                               00250600
                  AIF   (T'&ZCGPR NE 'N').ZG40R  NON NUMERIC            00250700
                  AIF   ('&ZCGPR' LT '2').ZG40Q                         00250800
                  AIF   ('&ZCGPR' LE '12').ZG40R                        00250900
.ZG40Q            ANOP  ,                                               00251000
&ZMS              SETC  '"COMPRSN='                                     00251100
&ZMS              SETC  '&ZMS.&COMPRSN"'                                00251200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00251300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00251400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00251500
.ZG40R            ANOP  ,                                               00251600
.*-------------------------------------------------------------------   00251700
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00251800
.ZG41             ANOP  ,           END OF BYPASS CHECK                 00251900
.*----------------------------------------------------------------***   00252000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00252100
                  AIF   (N'&RETCODE LE 1).ZG43A  CK NUM                 00252200
&ZMS              SETC  '"RETCODE='                                     00252300
&ZMS              SETC  '&ZMS.&RETCODE"'                                00252400
&ZMS              SETC  '&ZMS "RETCODE"'                                00252500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00252600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00252700
.ZG43A            ANOP  ,                                               00252800
.*-------------------------------------------------------------------   00252900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00253000
                  AIF   (K'&RETCODE(1) LE 0).ZG43C  NO PARM             00253100
&ZXRETCODE        SETC  'OUTPUT'    SET OUTPUT                          00253200
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00253300
                  AIF   (N'&RETCODE GT 1).ZG43C                         00253400
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00253500
.ZG43C            ANOP  ,                                               00253600
.*-------------------------------------------------------------------   00253700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00253800
                  AIF   (K'&ZXRETCODE LE 0).ZG43R  NOT I/O              00253900
                  AIF   ('&XRETCODE'(1,1) NE '(').ZG43R                 00254000
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00254100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG43P                    00254200
                  AIF   (K'&ZCGPR GT 2).ZG43Q                           00254300
                  AIF   ('&ZCGPR' EQ '0').ZG43Q                         00254400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00254500
                  AIF   (T'&ZCGPR NE 'N').ZG43Q  INVALID REG NAME       00254600
.ZG43P            ANOP  ,                                               00254700
                  AIF   (T'&ZCGPR NE 'N').ZG43R  NON NUMERIC            00254800
                  AIF   ('&ZCGPR' EQ '15').ZG43R                        00254900
                  AIF   ('&ZCGPR' LT '2').ZG43Q                         00255000
                  AIF   ('&ZCGPR' LE '12').ZG43R                        00255100
.ZG43Q            ANOP  ,                                               00255200
&ZMS              SETC  '"RETCODE='                                     00255300
&ZMS              SETC  '&ZMS.&RETCODE"'                                00255400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00255500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'        00255600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00255700
.ZG43R            ANOP  ,                                               00255800
.*----------------------------------------------------------------***   00255900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00256000
                  AIF   (N'&RSNCODE LE 1).ZG46A  CK NUM                 00256100
&ZMS              SETC  '"RSNCODE='                                     00256200
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00256300
&ZMS              SETC  '&ZMS "RSNCODE"'                                00256400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00256500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00256600
.ZG46A            ANOP  ,                                               00256700
.*-------------------------------------------------------------------   00256800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00256900
                  AIF   (K'&RSNCODE(1) LE 0).ZG46C  NO PARM             00257000
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00257100
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00257200
                  AIF   (N'&RSNCODE GT 1).ZG46C                         00257300
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00257400
.ZG46C            ANOP  ,                                               00257500
.*-------------------------------------------------------------------   00257600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00257700
                  AIF   (K'&ZXRSNCODE LE 0).ZG46R  NOT I/O              00257800
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG46R                 00257900
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00258000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                    00258100
                  AIF   (K'&ZCGPR GT 2).ZG46Q                           00258200
                  AIF   ('&ZCGPR' EQ '0').ZG46R                         00258300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00258400
                  AIF   (T'&ZCGPR NE 'N').ZG46Q  INVALID REG NAME       00258500
.ZG46P            ANOP  ,                                               00258600
                  AIF   (T'&ZCGPR NE 'N').ZG46R  NON NUMERIC            00258700
                  AIF   ('&ZCGPR' EQ '0').ZG46R                         00258800
                  AIF   ('&ZCGPR' LT '2').ZG46Q                         00258900
                  AIF   ('&ZCGPR' LE '12').ZG46R                        00259000
.ZG46Q            ANOP  ,                                               00259100
&ZMS              SETC  '"RSNCODE='                                     00259200
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00259300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00259400
                  MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'         00259500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00259600
.ZG46R            ANOP  ,                                               00259700
.******************************************************************     00259800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00259900
.******************************************************************     00260000
                  ACTR  10000                                           00260100
.*----------------------------------------------------------------***   00260200
.***AH.P02 EXTRA POSITIONALS                                            00260300
                  AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS            00260400
                  AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL            00260500
                  AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL        00260600
                  AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL         00260700
.ZGLISTX1         ANOP  ,                                               00260800
&ZCVAL            SETC  ''          ERROR FIELD                         00260900
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00261000
.ZGLIST2          ANOP  ,                                               00261100
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00261200
                  AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE            00261300
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00261400
                  AGO   .ZGLIST2                                        00261500
.*                                                                      00261600
.ZGLIST3          ANOP  ,                                               00261700
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00261800
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'                       00261900
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00262000
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00262100
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00262200
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00262300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00262400
.ZGLISTX          ANOP  ,                                               00262500
&ZASYSLNDX        SETA  0                                               00262600
.*-------------------------------------------------------------------   00262700
.***AG.MF04 MF=(SLME)                                                   00262800
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00262900
.********************************************************************   00263000
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00263100
.********************************************************************   00263200
                  ACTR  10000                                           00263300
.*-------------------------------------------------------------------   00263400
.***AE.MF01 MF=(SLME)                                                   00263500
                  AIF   ('&XMF' EQ 'L').ZEMFX                           00263600
                  AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                  00263700
.********************************************************************   00263800
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00263900
.********************************************************************   00264000
.*----------------------------------------------------------------***   00264100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00264200
                  AIF   (N'&SPACEID LE 1).ZE2A  CK NUM                  00264300
&ZMS              SETC  '"SPACEID='                                     00264400
&ZMS              SETC  '&ZMS.&SPACEID"'                                00264500
&ZMS              SETC  '&ZMS "SPACEID"'                                00264600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00264700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00264800
.ZE2A             ANOP  ,                                               00264900
.*-------------------------------------------------------------------   00265000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00265100
                  AIF   (K'&SPACEID(1) LE 0).ZE2B NO PRM                00265200
&ZXSPACEID        SETC  'INPUT'     SET IN/OUTPUT                       00265300
&XSPACEID         SETC  '&SPACEID(1)'           SET XVARIABLE           00265400
                  AIF   (N'&SPACEID GT 1).ZE2B                          00265500
.*                ANOP                                                  00265600
&XSPACEID         SETC  '&SPACEID'  SET XVARIABLE                       00265700
.ZE2B             ANOP  ,                                               00265800
.*-------------------------------------------------------------------   00265900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00266000
                  AIF   (K'&ZXSPACEID LE 0).ZE2R  NOT I/O               00266100
                  AIF   ('&XSPACEID'(1,1) NE '(').ZE2R                  00266200
&ZCGPR            SETC  '&XSPACEID'(2,K'&XSPACEID-2)                    00266300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                     00266400
                  AIF   (K'&ZCGPR GT 2).ZE2Q                            00266500
                  AIF   ('&ZCGPR' EQ '0').ZE2Q                          00266600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00266700
                  AIF   (T'&ZCGPR NE 'N').ZE2Q  INVALID REG NAME        00266800
.ZE2P             ANOP  ,                                               00266900
                  AIF   (T'&ZCGPR NE 'N').ZE2R  NON NUMERIC             00267000
                  AIF   ('&ZCGPR' LT '2').ZE2Q                          00267100
                  AIF   ('&ZCGPR' LE '12').ZE2R                         00267200
.ZE2Q             ANOP  ,                                               00267300
&ZMS              SETC  '"SPACEID='                                     00267400
&ZMS              SETC  '&ZMS.&SPACEID"'                                00267500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00267600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00267700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00267800
.ZE2R             ANOP  ,                                               00267900
.*----------------------------------------------------------------***   00268000
.***AE.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00268100
&XDUMMY1          SETC  ''          INITIALIZE XVARIABLE                00268200
                  AIF   (K'&AREAADDR LE 0).ZE5C                         00268300
&ZXDUMMY1         SETC  'INPUT'     SET IN/OUTPUT                       00268400
&XDUMMY1          SETC  'AREAADDR'  SET XVARIABLE                       00268500
&ZXAREAADDR       SETC  'INPUT'     SET IN/OUTPUT                       00268600
&XAREAADDR        SETC  '&AREAADDR(1)'          SET XVARIABLE PARM      00268700
                  AIF   (N'&AREAADDR GT 1).ZE5A                         00268800
&XAREAADDR        SETC  '&AREAADDR'             SET XVARIABLE PARM      00268900
.ZE5A             AIF   (N'&AREAADDR LE 1).ZE5B  CK NUM                 00269000
&ZMS              SETC  '"AREAADDR='                                    00269100
&ZMS              SETC  '&ZMS.&AREAADDR"'                               00269200
&ZMS              SETC  '&ZMS "AREAADDR"'                               00269300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00269400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00269500
.ZE5B             AIF   (K'&XAREAADDR GT 0).ZE5C  ONE PARM              00269600
&ZXDUMMY1         SETC  ''          RESET IN/OUTPUT                     00269700
&ZXAREAADDR       SETC  ''          RESET IN/OUTPUT                     00269800
.ZE5C             ANOP  ,                                               00269900
.*----------------------------------------------------------------***   00270000
.***AE.KMEKY02 NAME, RQD INPUT, ME KEYS -NON-XVAR KEY                   00270100
                  AIF   (K'&AREAADDR64 LE 0).ZE6D  NO ME KEY            00270200
                  AIF   (N'&AREAADDR64 LE 1).ZE6A  CK NUM               00270300
&ZMS              SETC  '"AREAADDR64='                                  00270400
&ZMS              SETC  '&ZMS.&AREAADDR64"'                             00270500
&ZMS              SETC  '&ZMS "AREAADDR64"'                             00270600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00270700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00270800
.ZE6A             AIF   (K'&XDUMMY1 LE 0).ZE6B                          00270900
&ZMS              SETC  '"AREAADDR64'                                   00271000
&ZMS              SETC  '&ZMS.=&AREAADDR64"'                            00271100
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00271200
&ZMS              SETC  '&ZMS "&XDUMMY1"'                               00271300
                  MNOTE 8,' &ZMS KEY.'                                  00271400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00271500
                  AGO   .ZE6D                                           00271600
.*                                                                      00271700
.ZE6B             ANOP  ,                                               00271800
&ZXDUMMY1         SETC  'INPUT'     SET IN/OUTPUT                       00271900
&XDUMMY1          SETC  'AREAADDR64'            SET XVARIABLE           00272000
&ZXAREAADDR64     SETC  'INPUT'     SET IN/OUTPUT                       00272100
&XAREAADDR64      SETC  '&AREAADDR64(1)'        SET PARM                00272200
                  AIF   (N'&AREAADDR64 GT 1).ZE6C                       00272300
&XAREAADDR64      SETC  '&AREAADDR64'           SET PARM                00272400
.ZE6C             AIF   (K'&XAREAADDR64 GT 0).ZE6D  ONE PARM            00272500
&ZXDUMMY1         SETC  ''          RESET IN/OUTPUT                     00272600
&ZXAREAADDR64     SETC  ''          RESET IN/OUTPUT                     00272700
.ZE6D             ANOP  ,                                               00272800
.*----------------------------------------------------------------***   00272900
.***AE.KMEKY02 NAME, RQD INPUT, ME KEYS -NON-XVAR KEY                   00273000
                  AIF   (K'&AREAADDR64C LE 0).ZE7D  NO ME KEY           00273100
                  AIF   (N'&AREAADDR64C LE 1).ZE7A  CK NUM              00273200
&ZMS              SETC  '"AREAADDR64C='                                 00273300
&ZMS              SETC  '&ZMS.&AREAADDR64C"'                            00273400
&ZMS              SETC  '&ZMS "AREAADDR64C"'                            00273500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00273600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00273700
.ZE7A             AIF   (K'&XDUMMY1 LE 0).ZE7B                          00273800
&ZMS              SETC  '"AREAADDR64C'                                  00273900
&ZMS              SETC  '&ZMS.=&AREAADDR64C"'                           00274000
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00274100
&ZMS              SETC  '&ZMS "&XDUMMY1"'                               00274200
                  MNOTE 8,' &ZMS KEY.'                                  00274300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00274400
                  AGO   .ZE7D                                           00274500
.*                                                                      00274600
.ZE7B             ANOP  ,                                               00274700
&ZXDUMMY1         SETC  'INPUT'     SET IN/OUTPUT                       00274800
&XDUMMY1          SETC  'AREAADDR64C'           SET XVARIABLE           00274900
&ZXAREAADDR64C    SETC  'INPUT'     SET IN/OUTPUT                       00275000
&XAREAADDR64C     SETC  '&AREAADDR64C(1)'       SET PARM                00275100
                  AIF   (N'&AREAADDR64C GT 1).ZE7C                      00275200
&XAREAADDR64C     SETC  '&AREAADDR64C'          SET PARM                00275300
.ZE7C             AIF   (K'&XAREAADDR64C GT 0).ZE7D  ONE PARM           00275400
&ZXDUMMY1         SETC  ''          RESET IN/OUTPUT                     00275500
&ZXAREAADDR64C    SETC  ''          RESET IN/OUTPUT                     00275600
.ZE7D             ANOP  ,                                               00275700
.*------------------------------------------------------------------    00275800
.***AE.KMEKY07 NAME, RQD INPUT, ME KEYS -CHECK IF ENTERED               00275900
                  AIF   (K'&XDUMMY1 GT 0).ZE8B                          00276000
&ZXDUMMY1         SETC  ''          RESET IN/OUTPUT                     00276100
&XDUMMY1          SETC  ''          SET NULL                            00276200
&ZXAREAADDR       SETC  ''          RESET OUTPUT                        00276300
&XAREAADDR        SETC  ''          SET NULL PARM                       00276400
.ZE8B             ANOP  ,                                               00276500
.*-------------------------------------------------------------------   00276600
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00276700
.ZE5     AIF   ('&XDUMMY1' NE 'AREAADDR').ZE6                           00276800
.*-------------------------------------------------------------------   00276900
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00277000
                  AIF   (K'&ZXAREAADDR LE 0).ZE5R  NOT I/O              00277100
                  AIF   ('&XAREAADDR'(1,1) NE '(').ZE5R                 00277200
&ZCGPR            SETC  '&XAREAADDR'(2,K'&XAREAADDR-2)                  00277300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                     00277400
                  AIF   (K'&ZCGPR GT 2).ZE5Q                            00277500
                  AIF   ('&ZCGPR' EQ '0').ZE5Q                          00277600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00277700
                  AIF   (T'&ZCGPR NE 'N').ZE5Q  INVALID REG NAME        00277800
.ZE5P             ANOP  ,                                               00277900
                  AIF   (T'&ZCGPR NE 'N').ZE5R  NON NUMERIC             00278000
                  AIF   ('&ZCGPR' LT '2').ZE5Q                          00278100
                  AIF   ('&ZCGPR' LE '12').ZE5R                         00278200
.ZE5Q             ANOP  ,                                               00278300
&ZMS              SETC  '"AREAADDR='                                    00278400
&ZMS              SETC  '&ZMS.&AREAADDR"'                               00278500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00278600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00278700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00278800
.ZE5R             ANOP  ,                                               00278900
.*-------------------------------------------------------------------   00279000
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00279100
.ZE6     AIF   ('&XDUMMY1' NE 'AREAADDR64').ZE7                         00279200
.*-------------------------------------------------------------------   00279300
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00279400
                  AIF   (K'&ZXAREAADDR64 LE 0).ZE6R  NOT I/O            00279500
                  AIF   ('&XAREAADDR64'(1,1) NE '(').ZE6R               00279600
&ZCGPR            SETC  '&XAREAADDR64'(2,K'&XAREAADDR64-2)              00279700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE6P                     00279800
                  AIF   (K'&ZCGPR GT 2).ZE6Q                            00279900
                  AIF   ('&ZCGPR' EQ '0').ZE6Q                          00280000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00280100
                  AIF   (T'&ZCGPR NE 'N').ZE6Q  INVALID REG NAME        00280200
.ZE6P             ANOP  ,                                               00280300
                  AIF   (T'&ZCGPR NE 'N').ZE6R  NON NUMERIC             00280400
                  AIF   ('&ZCGPR' LT '2').ZE6Q                          00280500
                  AIF   ('&ZCGPR' LE '12').ZE6R                         00280600
.ZE6Q             ANOP  ,                                               00280700
&ZMS              SETC  '"AREAADDR64='                                  00280800
&ZMS              SETC  '&ZMS.&AREAADDR64"'                             00280900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00281000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00281100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00281200
.ZE6R             ANOP  ,                                               00281300
.*-------------------------------------------------------------------   00281400
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00281500
.ZE7     AIF   ('&XDUMMY1' NE 'AREAADDR64C').ZE8                        00281600
.*-------------------------------------------------------------------   00281700
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00281800
                  AIF   (K'&ZXAREAADDR64C LE 0).ZE7R  NOT I/O           00281900
                  AIF   ('&XAREAADDR64C'(1,1) NE '(').ZE7R              00282000
&ZCGPR            SETC  '&XAREAADDR64C'(2,K'&XAREAADDR64C-2)            00282100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE7P                     00282200
                  AIF   (K'&ZCGPR GT 2).ZE7Q                            00282300
                  AIF   ('&ZCGPR' EQ '0').ZE7Q                          00282400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00282500
                  AIF   (T'&ZCGPR NE 'N').ZE7Q  INVALID REG NAME        00282600
.ZE7P             ANOP  ,                                               00282700
                  AIF   (T'&ZCGPR NE 'N').ZE7R  NON NUMERIC             00282800
                  AIF   ('&ZCGPR' LT '2').ZE7Q                          00282900
                  AIF   ('&ZCGPR' LE '12').ZE7R                         00283000
.ZE7Q             ANOP  ,                                               00283100
&ZMS              SETC  '"AREAADDR64C='                                 00283200
&ZMS              SETC  '&ZMS.&AREAADDR64C"'                            00283300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00283400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00283500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00283600
.ZE7R             ANOP  ,                                               00283700
.*-------------------------------------------------------------------   00283800
.***AE.KMEKY09 NAME, RQD INPUT, ME KEYS -END                            00283900
.ZE8              ANOP  ,           END MUTUALLY EXCLUSIVE KEYS         00284000
.*----------------------------------------------------------------***   00284100
.***AE.KMEKY01 NAME, RQD OUTPUT, ME KEYS -XVARIABLE                     00284200
&XDUMMYB          SETC  ''          INITIALIZE XVARIABLE                00284300
                  AIF   (K'&BUFFER LE 0).ZE10C                          00284400
&ZXDUMMYB         SETC  'OUTPUT'    SET IN/OUTPUT                       00284500
&XDUMMYB          SETC  'BUFFER'    SET XVARIABLE                       00284600
&ZXBUFFER         SETC  'OUTPUT'    SET IN/OUTPUT                       00284700
&XBUFFER          SETC  '&BUFFER(1)'            SET XVARIABLE PARM      00284800
                  AIF   (N'&BUFFER GT 1).ZE10A                          00284900
&XBUFFER          SETC  '&BUFFER'   SET XVARIABLE PARM                  00285000
.ZE10A            AIF   (N'&BUFFER LE 1).ZE10B  CK NUM                  00285100
&ZMS              SETC  '"BUFFER='                                      00285200
&ZMS              SETC  '&ZMS.&BUFFER"'                                 00285300
&ZMS              SETC  '&ZMS "BUFFER"'                                 00285400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00285500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00285600
.ZE10B            AIF   (K'&XBUFFER GT 0).ZE10C  ONE PARM               00285700
&ZXDUMMYB         SETC  ''          RESET IN/OUTPUT                     00285800
&ZXBUFFER         SETC  ''          RESET IN/OUTPUT                     00285900
.ZE10C            ANOP  ,                                               00286000
.*----------------------------------------------------------------***   00286100
.***AE.KMEKY02 NAME, RQD OUTPUT, ME KEYS -NON-XVAR KEY                  00286200
                  AIF   (K'&BUFFER64 LE 0).ZE11D  NO ME KEY             00286300
                  AIF   (N'&BUFFER64 LE 1).ZE11A  CK NUM                00286400
&ZMS              SETC  '"BUFFER64='                                    00286500
&ZMS              SETC  '&ZMS.&BUFFER64"'                               00286600
&ZMS              SETC  '&ZMS "BUFFER64"'                               00286700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00286800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00286900
.ZE11A            AIF   (K'&XDUMMYB LE 0).ZE11B                         00287000
&ZMS              SETC  '"BUFFER64'                                     00287100
&ZMS              SETC  '&ZMS.=&BUFFER64"'                              00287200
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00287300
&ZMS              SETC  '&ZMS "&XDUMMYB"'                               00287400
                  MNOTE 8,' &ZMS KEY.'                                  00287500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00287600
                  AGO   .ZE11D                                          00287700
.*                                                                      00287800
.ZE11B            ANOP  ,                                               00287900
&ZXDUMMYB         SETC  'OUTPUT'    SET IN/OUTPUT                       00288000
&XDUMMYB          SETC  'BUFFER64'  SET XVARIABLE                       00288100
&ZXBUFFER64       SETC  'OUTPUT'    SET IN/OUTPUT                       00288200
&XBUFFER64        SETC  '&BUFFER64(1)'          SET PARM                00288300
                  AIF   (N'&BUFFER64 GT 1).ZE11C                        00288400
&XBUFFER64        SETC  '&BUFFER64'             SET PARM                00288500
.ZE11C            AIF   (K'&XBUFFER64 GT 0).ZE11D  ONE PARM             00288600
&ZXDUMMYB         SETC  ''          RESET IN/OUTPUT                     00288700
&ZXBUFFER64       SETC  ''          RESET IN/OUTPUT                     00288800
.ZE11D            ANOP  ,                                               00288900
.*------------------------------------------------------------------    00289000
.***AE.KMEKY07 NAME, RQD OUTPUT, ME KEYS -CHECK IF ENTERED              00289100
                  AIF   (K'&XDUMMYB GT 0).ZE12B                         00289200
&ZXDUMMYB         SETC  ''          RESET IN/OUTPUT                     00289300
&XDUMMYB          SETC  ''          SET NULL                            00289400
&ZXBUFFER         SETC  ''          RESET OUTPUT                        00289500
&XBUFFER          SETC  ''          SET NULL PARM                       00289600
.ZE12B            ANOP  ,                                               00289700
.*-------------------------------------------------------------------   00289800
.***AE.KMEKY08 NAME, RQD OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00289900
.ZE10     AIF   ('&XDUMMYB' NE 'BUFFER').ZE11                           00290000
.*-------------------------------------------------------------------   00290100
.***AE.KCK02 NAME, RQD OUTPUT, ME KEYS -GPR OUT OF RANGE                00290200
                  AIF   (K'&ZXBUFFER LE 0).ZE10R  NOT I/O               00290300
                  AIF   ('&XBUFFER'(1,1) NE '(').ZE10R                  00290400
&ZCGPR            SETC  '&XBUFFER'(2,K'&XBUFFER-2)                      00290500
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                    00290600
                  AIF   (K'&ZCGPR GT 2).ZE10Q                           00290700
                  AIF   ('&ZCGPR' EQ '0').ZE10Q                         00290800
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00290900
                  AIF   (T'&ZCGPR NE 'N').ZE10Q  INVALID REG NAME       00291000
.ZE10P            ANOP  ,                                               00291100
                  AIF   (T'&ZCGPR NE 'N').ZE10R  NON NUMERIC            00291200
                  AIF   ('&ZCGPR' LT '2').ZE10Q                         00291300
                  AIF   ('&ZCGPR' LE '12').ZE10R                        00291400
.ZE10Q            ANOP  ,                                               00291500
&ZMS              SETC  '"BUFFER='                                      00291600
&ZMS              SETC  '&ZMS.&BUFFER"'                                 00291700
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00291800
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00291900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00292000
.ZE10R            ANOP  ,                                               00292100
.*-------------------------------------------------------------------   00292200
.***AE.KMEKY08 NAME, RQD OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00292300
.ZE11     AIF   ('&XDUMMYB' NE 'BUFFER64').ZE12                         00292400
.*-------------------------------------------------------------------   00292500
.***AE.KCK02 NAME, RQD OUTPUT, ME KEYS -GPR OUT OF RANGE                00292600
                  AIF   (K'&ZXBUFFER64 LE 0).ZE11R  NOT I/O             00292700
                  AIF   ('&XBUFFER64'(1,1) NE '(').ZE11R                00292800
&ZCGPR            SETC  '&XBUFFER64'(2,K'&XBUFFER64-2)                  00292900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE11P                    00293000
                  AIF   (K'&ZCGPR GT 2).ZE11Q                           00293100
                  AIF   ('&ZCGPR' EQ '0').ZE11Q                         00293200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00293300
                  AIF   (T'&ZCGPR NE 'N').ZE11Q  INVALID REG NAME       00293400
.ZE11P            ANOP  ,                                               00293500
                  AIF   (T'&ZCGPR NE 'N').ZE11R  NON NUMERIC            00293600
                  AIF   ('&ZCGPR' LT '2').ZE11Q                         00293700
                  AIF   ('&ZCGPR' LE '12').ZE11R                        00293800
.ZE11Q            ANOP  ,                                               00293900
&ZMS              SETC  '"BUFFER64='                                    00294000
&ZMS              SETC  '&ZMS.&BUFFER64"'                               00294100
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00294200
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00294300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00294400
.ZE11R            ANOP  ,                                               00294500
.*-------------------------------------------------------------------   00294600
.***AE.KMEKY09 NAME, RQD OUTPUT, ME KEYS -END                           00294700
.ZE12             ANOP  ,           END MUTUALLY EXCLUSIVE KEYS         00294800
.*----------------------------------------------------------------***   00294900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00295000
                  AIF   (N'&BUFFERLEN LE 1).ZE14A  CK NUM               00295100
&ZMS              SETC  '"BUFFERLEN='                                   00295200
&ZMS              SETC  '&ZMS.&BUFFERLEN"'                              00295300
&ZMS              SETC  '&ZMS "BUFFERLEN"'                              00295400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00295500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00295600
.ZE14A            ANOP  ,                                               00295700
.*-------------------------------------------------------------------   00295800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00295900
                  AIF   (K'&BUFFERLEN(1) LE 0).ZE14B NO PRM             00296000
&ZXBUFFERLEN      SETC  'INPUT'     SET IN/OUTPUT                       00296100
&XBUFFERLEN       SETC  '&BUFFERLEN(1)'         SET XVARIABLE           00296200
                  AIF   (N'&BUFFERLEN GT 1).ZE14B                       00296300
.*                ANOP                                                  00296400
&XBUFFERLEN       SETC  '&BUFFERLEN'            SET XVARIABLE           00296500
.ZE14B            ANOP  ,                                               00296600
.*-------------------------------------------------------------------   00296700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00296800
                  AIF   (K'&ZXBUFFERLEN LE 0).ZE14R  NOT I/O            00296900
                  AIF   ('&XBUFFERLEN'(1,1) NE '(').ZE14R               00297000
&ZCGPR            SETC  '&XBUFFERLEN'(2,K'&XBUFFERLEN-2)                00297100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE14P                    00297200
                  AIF   (K'&ZCGPR GT 2).ZE14Q                           00297300
                  AIF   ('&ZCGPR' EQ '0').ZE14Q                         00297400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00297500
                  AIF   (T'&ZCGPR NE 'N').ZE14Q  INVALID REG NAME       00297600
.ZE14P            ANOP  ,                                               00297700
                  AIF   (T'&ZCGPR NE 'N').ZE14R  NON NUMERIC            00297800
                  AIF   ('&ZCGPR' LT '2').ZE14Q                         00297900
                  AIF   ('&ZCGPR' LE '12').ZE14R                        00298000
.ZE14Q            ANOP  ,                                               00298100
&ZMS              SETC  '"BUFFERLEN='                                   00298200
&ZMS              SETC  '&ZMS.&BUFFERLEN"'                              00298300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00298400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00298500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00298600
.ZE14R            ANOP  ,                                               00298700
.*----------------------------------------------------------------***   00298800
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00298900
                  AIF   (N'&BUFFERLENV LE 1).ZE17A  CK NUM              00299000
&ZMS              SETC  '"BUFFERLENV='                                  00299100
&ZMS              SETC  '&ZMS.&BUFFERLENV"'                             00299200
&ZMS              SETC  '&ZMS "BUFFERLENV"'                             00299300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00299400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00299500
.ZE17A            ANOP  ,                                               00299600
.*-------------------------------------------------------------------   00299700
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00299800
                  AIF   (K'&BUFFERLENV(1) LE 0).ZE17B NO PRM            00299900
&ZXBUFFERLENV     SETC  'OUTPUT'    SET IN/OUTPUT                       00300000
&XBUFFERLENV      SETC  '&BUFFERLENV(1)'        SET XVARIABLE           00300100
                  AIF   (N'&BUFFERLENV GT 1).ZE17B                      00300200
.*                ANOP                                                  00300300
&XBUFFERLENV      SETC  '&BUFFERLENV'           SET XVARIABLE           00300400
.ZE17B            ANOP  ,                                               00300500
.*-------------------------------------------------------------------   00300600
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00300700
                  AIF   (K'&ZXBUFFERLENV LE 0).ZE17R  NOT I/O           00300800
                  AIF   ('&XBUFFERLENV'(1,1) NE '(').ZE17R              00300900
&ZCGPR            SETC  '&XBUFFERLENV'(2,K'&XBUFFERLENV-2)              00301000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE17P                    00301100
                  AIF   (K'&ZCGPR GT 2).ZE17Q                           00301200
                  AIF   ('&ZCGPR' EQ '0').ZE17Q                         00301300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00301400
                  AIF   (T'&ZCGPR NE 'N').ZE17Q  INVALID REG NAME       00301500
.ZE17P            ANOP  ,                                               00301600
                  AIF   (T'&ZCGPR NE 'N').ZE17R  NON NUMERIC            00301700
                  AIF   ('&ZCGPR' LT '2').ZE17Q                         00301800
                  AIF   ('&ZCGPR' LE '12').ZE17R                        00301900
.ZE17Q            ANOP  ,                                               00302000
&ZMS              SETC  '"BUFFERLENV='                                  00302100
&ZMS              SETC  '&ZMS.&BUFFERLENV"'                             00302200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00302300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00302400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00302500
.ZE17R            ANOP  ,                                               00302600
.*----------------------------------------------------------------***   00302700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00302800
                  AIF   (N'&AUTHSTATE LE 1).ZE20A  CK NUM               00302900
&ZMS              SETC  '"AUTHSTATE='                                   00303000
&ZMS              SETC  '&ZMS.&AUTHSTATE"'                              00303100
&ZMS              SETC  '&ZMS "AUTHSTATE"'                              00303200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00303300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00303400
.ZE20A            ANOP  ,                                               00303500
.*-------------------------------------------------------------------   00303600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00303700
                  AIF   (K'&AUTHSTATE(1) LE 0).ZE20B NO PRM             00303800
&ZXAUTHSTATE      SETC  'OUTPUT'    SET IN/OUTPUT                       00303900
&XAUTHSTATE       SETC  '&AUTHSTATE(1)'         SET XVARIABLE           00304000
                  AIF   (N'&AUTHSTATE GT 1).ZE20B                       00304100
.*                ANOP                                                  00304200
&XAUTHSTATE       SETC  '&AUTHSTATE'            SET XVARIABLE           00304300
.ZE20B            ANOP  ,                                               00304400
.*-------------------------------------------------------------------   00304500
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00304600
                  AIF   (K'&ZXAUTHSTATE LE 0).ZE20R  NOT I/O            00304700
                  AIF   ('&XAUTHSTATE'(1,1) NE '(').ZE20R               00304800
&ZCGPR            SETC  '&XAUTHSTATE'(2,K'&XAUTHSTATE-2)                00304900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE20P                    00305000
                  AIF   (K'&ZCGPR GT 2).ZE20Q                           00305100
                  AIF   ('&ZCGPR' EQ '0').ZE20Q                         00305200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00305300
                  AIF   (T'&ZCGPR NE 'N').ZE20Q  INVALID REG NAME       00305400
.ZE20P            ANOP  ,                                               00305500
                  AIF   (T'&ZCGPR NE 'N').ZE20R  NON NUMERIC            00305600
                  AIF   ('&ZCGPR' LT '2').ZE20Q                         00305700
                  AIF   ('&ZCGPR' LE '12').ZE20R                        00305800
.ZE20Q            ANOP  ,                                               00305900
&ZMS              SETC  '"AUTHSTATE='                                   00306000
&ZMS              SETC  '&ZMS.&AUTHSTATE"'                              00306100
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00306200
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00306300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00306400
.ZE20R            ANOP  ,                                               00306500
.*----------------------------------------------------------------***   00306600
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00306700
                  AIF   (N'&AREAKEY LE 1).ZE23A  CK NUM                 00306800
&ZMS              SETC  '"AREAKEY='                                     00306900
&ZMS              SETC  '&ZMS.&AREAKEY"'                                00307000
&ZMS              SETC  '&ZMS "AREAKEY"'                                00307100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00307200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00307300
.ZE23A            ANOP  ,                                               00307400
.*-------------------------------------------------------------------   00307500
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00307600
                  AIF   (K'&AREAKEY(1) LE 0).ZE23B NO PRM               00307700
&ZXAREAKEY        SETC  'OUTPUT'    SET IN/OUTPUT                       00307800
&XAREAKEY         SETC  '&AREAKEY(1)'           SET XVARIABLE           00307900
                  AIF   (N'&AREAKEY GT 1).ZE23B                         00308000
.*                ANOP                                                  00308100
&XAREAKEY         SETC  '&AREAKEY'  SET XVARIABLE                       00308200
.ZE23B            ANOP  ,                                               00308300
.*-------------------------------------------------------------------   00308400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00308500
                  AIF   (K'&ZXAREAKEY LE 0).ZE23R  NOT I/O              00308600
                  AIF   ('&XAREAKEY'(1,1) NE '(').ZE23R                 00308700
&ZCGPR            SETC  '&XAREAKEY'(2,K'&XAREAKEY-2)                    00308800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE23P                    00308900
                  AIF   (K'&ZCGPR GT 2).ZE23Q                           00309000
                  AIF   ('&ZCGPR' EQ '0').ZE23Q                         00309100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00309200
                  AIF   (T'&ZCGPR NE 'N').ZE23Q  INVALID REG NAME       00309300
.ZE23P            ANOP  ,                                               00309400
                  AIF   (T'&ZCGPR NE 'N').ZE23R  NON NUMERIC            00309500
                  AIF   ('&ZCGPR' LT '2').ZE23Q                         00309600
                  AIF   ('&ZCGPR' LE '12').ZE23R                        00309700
.ZE23Q            ANOP  ,                                               00309800
&ZMS              SETC  '"AREAKEY='                                     00309900
&ZMS              SETC  '&ZMS.&AREAKEY"'                                00310000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00310100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00310200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00310300
.ZE23R            ANOP  ,                                               00310400
.*----------------------------------------------------------------***   00310500
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00310600
                  AIF   (N'&NEXTKEY LE 1).ZE26A  CK NUM                 00310700
&ZMS              SETC  '"NEXTKEY='                                     00310800
&ZMS              SETC  '&ZMS.&NEXTKEY"'                                00310900
&ZMS              SETC  '&ZMS "NEXTKEY"'                                00311000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00311100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00311200
.ZE26A            ANOP  ,                                               00311300
.*-------------------------------------------------------------------   00311400
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00311500
                  AIF   (K'&NEXTKEY(1) LE 0).ZE26B NO PRM               00311600
&ZXNEXTKEY        SETC  'OUTPUT'    SET IN/OUTPUT                       00311700
&XNEXTKEY         SETC  '&NEXTKEY(1)'           SET XVARIABLE           00311800
                  AIF   (N'&NEXTKEY GT 1).ZE26B                         00311900
.*                ANOP                                                  00312000
&XNEXTKEY         SETC  '&NEXTKEY'  SET XVARIABLE                       00312100
.ZE26B            ANOP  ,                                               00312200
.*-------------------------------------------------------------------   00312300
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00312400
                  AIF   (K'&ZXNEXTKEY LE 0).ZE26R  NOT I/O              00312500
                  AIF   ('&XNEXTKEY'(1,1) NE '(').ZE26R                 00312600
&ZCGPR            SETC  '&XNEXTKEY'(2,K'&XNEXTKEY-2)                    00312700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE26P                    00312800
                  AIF   (K'&ZCGPR GT 2).ZE26Q                           00312900
                  AIF   ('&ZCGPR' EQ '0').ZE26Q                         00313000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00313100
                  AIF   (T'&ZCGPR NE 'N').ZE26Q  INVALID REG NAME       00313200
.ZE26P            ANOP  ,                                               00313300
                  AIF   (T'&ZCGPR NE 'N').ZE26R  NON NUMERIC            00313400
                  AIF   ('&ZCGPR' LT '2').ZE26Q                         00313500
                  AIF   ('&ZCGPR' LE '12').ZE26R                        00313600
.ZE26Q            ANOP  ,                                               00313700
&ZMS              SETC  '"NEXTKEY='                                     00313800
&ZMS              SETC  '&ZMS.&NEXTKEY"'                                00313900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00314000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00314100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00314200
.ZE26R            ANOP  ,                                               00314300
.*----------------------------------------------------------------***   00314400
.***AE.KMEKY01 NAME, OPT OUTPUT, ME KEYS -XVARIABLE                     00314500
&XDUMMYF          SETC  ''          INITIALIZE XVARIABLE                00314600
                  AIF   (K'&FIRSTADDR64 LE 0).ZE29C                     00314700
&ZXDUMMYF         SETC  'OUTPUT'    SET IN/OUTPUT                       00314800
&XDUMMYF          SETC  'FIRSTADDR64'           SET XVARIABLE           00314900
&ZXFIRSTADDR64    SETC  'OUTPUT'    SET IN/OUTPUT                       00315000
&XFIRSTADDR64     SETC  '&FIRSTADDR64(1)'       SET XVARIABLE PARM      00315100
                  AIF   (N'&FIRSTADDR64 GT 1).ZE29A                     00315200
&XFIRSTADDR64     SETC  '&FIRSTADDR64'          SET XVARIABLE PARM      00315300
.ZE29A            AIF   (N'&FIRSTADDR64 LE 1).ZE29B  CK NUM             00315400
&ZMS              SETC  '"FIRSTADDR64='                                 00315500
&ZMS              SETC  '&ZMS.&FIRSTADDR64"'                            00315600
&ZMS              SETC  '&ZMS "FIRSTADDR64"'                            00315700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00315800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00315900
.ZE29B            AIF   (K'&XFIRSTADDR64 GT 0).ZE29C  ONE PARM          00316000
&ZXDUMMYF         SETC  ''          RESET IN/OUTPUT                     00316100
&ZXFIRSTADDR64    SETC  ''          RESET IN/OUTPUT                     00316200
.ZE29C            ANOP  ,                                               00316300
.*----------------------------------------------------------------***   00316400
.***AE.KMEKY02 NAME, OPT OUTPUT, ME KEYS -NON-XVAR KEY                  00316500
                  AIF   (K'&FIRSTADDR64C LE 0).ZE30D  NO ME KEY         00316600
                  AIF   (N'&FIRSTADDR64C LE 1).ZE30A  CK NUM            00316700
&ZMS              SETC  '"FIRSTADDR64C='                                00316800
&ZMS              SETC  '&ZMS.&FIRSTADDR64C"'                           00316900
&ZMS              SETC  '&ZMS "FIRSTADDR64C"'                           00317000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00317100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00317200
.ZE30A            AIF   (K'&XDUMMYF LE 0).ZE30B                         00317300
&ZMS              SETC  '"FIRSTADDR64C'                                 00317400
&ZMS              SETC  '&ZMS.=&FIRSTADDR64C"'                          00317500
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00317600
&ZMS              SETC  '&ZMS "&XDUMMYF"'                               00317700
                  MNOTE 8,' &ZMS KEY.'                                  00317800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00317900
                  AGO   .ZE30D                                          00318000
.*                                                                      00318100
.ZE30B            ANOP  ,                                               00318200
&ZXDUMMYF         SETC  'OUTPUT'    SET IN/OUTPUT                       00318300
&XDUMMYF          SETC  'FIRSTADDR64C'          SET XVARIABLE           00318400
&ZXFIRSTADDR64C   SETC  'OUTPUT'    SET IN/OUTPUT                       00318500
&XFIRSTADDR64C    SETC  '&FIRSTADDR64C(1)'      SET PARM                00318600
                  AIF   (N'&FIRSTADDR64C GT 1).ZE30C                    00318700
&XFIRSTADDR64C    SETC  '&FIRSTADDR64C'         SET PARM                00318800
.ZE30C            AIF   (K'&XFIRSTADDR64C GT 0).ZE30D  ONE PARM         00318900
&ZXDUMMYF         SETC  ''          RESET IN/OUTPUT                     00319000
&ZXFIRSTADDR64C   SETC  ''          RESET IN/OUTPUT                     00319100
.ZE30D            ANOP  ,                                               00319200
.*------------------------------------------------------------------    00319300
.***AE.KMEKY07 NAME, OPT OUTPUT, ME KEYS -CHECK IF ENTERED              00319400
                  AIF   (K'&XDUMMYF GT 0).ZE31B                         00319500
&ZXDUMMYF         SETC  ''          RESET IN/OUTPUT                     00319600
&XDUMMYF          SETC  ''          SET NULL                            00319700
&ZXFIRSTADDR64    SETC  ''          RESET OUTPUT                        00319800
&XFIRSTADDR64     SETC  ''          SET NULL PARM                       00319900
.ZE31B            ANOP  ,                                               00320000
.*-------------------------------------------------------------------   00320100
.***AE.KMEKY08 NAME, OPT OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00320200
.ZE29     AIF   ('&XDUMMYF' NE 'FIRSTADDR64').ZE30                      00320300
.*-------------------------------------------------------------------   00320400
.***AE.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00320500
                  AIF   (K'&ZXFIRSTADDR64 LE 0).ZE29R  NOT I/O          00320600
                  AIF   ('&XFIRSTADDR64'(1,1) NE '(').ZE29R             00320700
&ZCGPR            SETC  '&XFIRSTADDR64'(2,K'&XFIRSTADDR64-2)            00320800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE29P                    00320900
                  AIF   (K'&ZCGPR GT 2).ZE29Q                           00321000
                  AIF   ('&ZCGPR' EQ '0').ZE29Q                         00321100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00321200
                  AIF   (T'&ZCGPR NE 'N').ZE29Q  INVALID REG NAME       00321300
.ZE29P            ANOP  ,                                               00321400
                  AIF   (T'&ZCGPR NE 'N').ZE29R  NON NUMERIC            00321500
                  AIF   ('&ZCGPR' LT '2').ZE29Q                         00321600
                  AIF   ('&ZCGPR' LE '12').ZE29R                        00321700
.ZE29Q            ANOP  ,                                               00321800
&ZMS              SETC  '"FIRSTADDR64='                                 00321900
&ZMS              SETC  '&ZMS.&FIRSTADDR64"'                            00322000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00322100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00322200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00322300
.ZE29R            ANOP  ,                                               00322400
.*-------------------------------------------------------------------   00322500
.***AE.KMEKY08 NAME, OPT OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00322600
.ZE30     AIF   ('&XDUMMYF' NE 'FIRSTADDR64C').ZE31                     00322700
.*-------------------------------------------------------------------   00322800
.***AE.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00322900
                  AIF   (K'&ZXFIRSTADDR64C LE 0).ZE30R  NOT I/O         00323000
                  AIF   ('&XFIRSTADDR64C'(1,1) NE '(').ZE30R            00323100
&ZCGPR            SETC  '&XFIRSTADDR64C'(2,K'&XFIRSTADDR64C-2)          00323200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE30P                    00323300
                  AIF   (K'&ZCGPR GT 2).ZE30Q                           00323400
                  AIF   ('&ZCGPR' EQ '0').ZE30Q                         00323500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00323600
                  AIF   (T'&ZCGPR NE 'N').ZE30Q  INVALID REG NAME       00323700
.ZE30P            ANOP  ,                                               00323800
                  AIF   (T'&ZCGPR NE 'N').ZE30R  NON NUMERIC            00323900
                  AIF   ('&ZCGPR' LT '2').ZE30Q                         00324000
                  AIF   ('&ZCGPR' LE '12').ZE30R                        00324100
.ZE30Q            ANOP  ,                                               00324200
&ZMS              SETC  '"FIRSTADDR64C='                                00324300
&ZMS              SETC  '&ZMS.&FIRSTADDR64C"'                           00324400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00324500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00324600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00324700
.ZE30R            ANOP  ,                                               00324800
.*-------------------------------------------------------------------   00324900
.***AE.KMEKY09 NAME, OPT OUTPUT, ME KEYS -END                           00325000
.ZE31             ANOP  ,           END MUTUALLY EXCLUSIVE KEYS         00325100
.*----------------------------------------------------------------***   00325200
.***AE.KMEKY01 NAME, OPT OUTPUT, ME KEYS -XVARIABLE                     00325300
&XDUMMYL          SETC  ''          INITIALIZE XVARIABLE                00325400
                  AIF   (K'&LASTADDR64 LE 0).ZE33C                      00325500
&ZXDUMMYL         SETC  'OUTPUT'    SET IN/OUTPUT                       00325600
&XDUMMYL          SETC  'LASTADDR64'            SET XVARIABLE           00325700
&ZXLASTADDR64     SETC  'OUTPUT'    SET IN/OUTPUT                       00325800
&XLASTADDR64      SETC  '&LASTADDR64(1)'        SET XVARIABLE PARM      00325900
                  AIF   (N'&LASTADDR64 GT 1).ZE33A                      00326000
&XLASTADDR64      SETC  '&LASTADDR64'           SET XVARIABLE PARM      00326100
.ZE33A            AIF   (N'&LASTADDR64 LE 1).ZE33B  CK NUM              00326200
&ZMS              SETC  '"LASTADDR64='                                  00326300
&ZMS              SETC  '&ZMS.&LASTADDR64"'                             00326400
&ZMS              SETC  '&ZMS "LASTADDR64"'                             00326500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00326600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00326700
.ZE33B            AIF   (K'&XLASTADDR64 GT 0).ZE33C  ONE PARM           00326800
&ZXDUMMYL         SETC  ''          RESET IN/OUTPUT                     00326900
&ZXLASTADDR64     SETC  ''          RESET IN/OUTPUT                     00327000
.ZE33C            ANOP  ,                                               00327100
.*----------------------------------------------------------------***   00327200
.***AE.KMEKY02 NAME, OPT OUTPUT, ME KEYS -NON-XVAR KEY                  00327300
                  AIF   (K'&LASTADDR64C LE 0).ZE34D  NO ME KEY          00327400
                  AIF   (N'&LASTADDR64C LE 1).ZE34A  CK NUM             00327500
&ZMS              SETC  '"LASTADDR64C='                                 00327600
&ZMS              SETC  '&ZMS.&LASTADDR64C"'                            00327700
&ZMS              SETC  '&ZMS "LASTADDR64C"'                            00327800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00327900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00328000
.ZE34A            AIF   (K'&XDUMMYL LE 0).ZE34B                         00328100
&ZMS              SETC  '"LASTADDR64C'                                  00328200
&ZMS              SETC  '&ZMS.=&LASTADDR64C"'                           00328300
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00328400
&ZMS              SETC  '&ZMS "&XDUMMYL"'                               00328500
                  MNOTE 8,' &ZMS KEY.'                                  00328600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00328700
                  AGO   .ZE34D                                          00328800
.*                                                                      00328900
.ZE34B            ANOP  ,                                               00329000
&ZXDUMMYL         SETC  'OUTPUT'    SET IN/OUTPUT                       00329100
&XDUMMYL          SETC  'LASTADDR64C'           SET XVARIABLE           00329200
&ZXLASTADDR64C    SETC  'OUTPUT'    SET IN/OUTPUT                       00329300
&XLASTADDR64C     SETC  '&LASTADDR64C(1)'       SET PARM                00329400
                  AIF   (N'&LASTADDR64C GT 1).ZE34C                     00329500
&XLASTADDR64C     SETC  '&LASTADDR64C'          SET PARM                00329600
.ZE34C            AIF   (K'&XLASTADDR64C GT 0).ZE34D  ONE PARM          00329700
&ZXDUMMYL         SETC  ''          RESET IN/OUTPUT                     00329800
&ZXLASTADDR64C    SETC  ''          RESET IN/OUTPUT                     00329900
.ZE34D            ANOP  ,                                               00330000
.*------------------------------------------------------------------    00330100
.***AE.KMEKY07 NAME, OPT OUTPUT, ME KEYS -CHECK IF ENTERED              00330200
                  AIF   (K'&XDUMMYL GT 0).ZE35B                         00330300
&ZXDUMMYL         SETC  ''          RESET IN/OUTPUT                     00330400
&XDUMMYL          SETC  ''          SET NULL                            00330500
&ZXLASTADDR64     SETC  ''          RESET OUTPUT                        00330600
&XLASTADDR64      SETC  ''          SET NULL PARM                       00330700
.ZE35B            ANOP  ,                                               00330800
.*-------------------------------------------------------------------   00330900
.***AE.KMEKY08 NAME, OPT OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00331000
.ZE33     AIF   ('&XDUMMYL' NE 'LASTADDR64').ZE34                       00331100
.*-------------------------------------------------------------------   00331200
.***AE.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00331300
                  AIF   (K'&ZXLASTADDR64 LE 0).ZE33R  NOT I/O           00331400
                  AIF   ('&XLASTADDR64'(1,1) NE '(').ZE33R              00331500
&ZCGPR            SETC  '&XLASTADDR64'(2,K'&XLASTADDR64-2)              00331600
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE33P                    00331700
                  AIF   (K'&ZCGPR GT 2).ZE33Q                           00331800
                  AIF   ('&ZCGPR' EQ '0').ZE33Q                         00331900
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00332000
                  AIF   (T'&ZCGPR NE 'N').ZE33Q  INVALID REG NAME       00332100
.ZE33P            ANOP  ,                                               00332200
                  AIF   (T'&ZCGPR NE 'N').ZE33R  NON NUMERIC            00332300
                  AIF   ('&ZCGPR' LT '2').ZE33Q                         00332400
                  AIF   ('&ZCGPR' LE '12').ZE33R                        00332500
.ZE33Q            ANOP  ,                                               00332600
&ZMS              SETC  '"LASTADDR64='                                  00332700
&ZMS              SETC  '&ZMS.&LASTADDR64"'                             00332800
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00332900
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00333000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00333100
.ZE33R            ANOP  ,                                               00333200
.*-------------------------------------------------------------------   00333300
.***AE.KMEKY08 NAME, OPT OUTPUT, ME KEYS -PROCESS DEPENDENCIES          00333400
.ZE34     AIF   ('&XDUMMYL' NE 'LASTADDR64C').ZE35                      00333500
.*-------------------------------------------------------------------   00333600
.***AE.KCK02 NAME, OPT OUTPUT, ME KEYS -GPR OUT OF RANGE                00333700
                  AIF   (K'&ZXLASTADDR64C LE 0).ZE34R  NOT I/O          00333800
                  AIF   ('&XLASTADDR64C'(1,1) NE '(').ZE34R             00333900
&ZCGPR            SETC  '&XLASTADDR64C'(2,K'&XLASTADDR64C-2)            00334000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE34P                    00334100
                  AIF   (K'&ZCGPR GT 2).ZE34Q                           00334200
                  AIF   ('&ZCGPR' EQ '0').ZE34Q                         00334300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00334400
                  AIF   (T'&ZCGPR NE 'N').ZE34Q  INVALID REG NAME       00334500
.ZE34P            ANOP  ,                                               00334600
                  AIF   (T'&ZCGPR NE 'N').ZE34R  NON NUMERIC            00334700
                  AIF   ('&ZCGPR' LT '2').ZE34Q                         00334800
                  AIF   ('&ZCGPR' LE '12').ZE34R                        00334900
.ZE34Q            ANOP  ,                                               00335000
&ZMS              SETC  '"LASTADDR64C='                                 00335100
&ZMS              SETC  '&ZMS.&LASTADDR64C"'                            00335200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00335300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00335400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00335500
.ZE34R            ANOP  ,                                               00335600
.*-------------------------------------------------------------------   00335700
.***AE.KMEKY09 NAME, OPT OUTPUT, ME KEYS -END                           00335800
.ZE35             ANOP  ,           END MUTUALLY EXCLUSIVE KEYS         00335900
.*----------------------------------------------------------------***   00336000
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00336100
                  AIF   (N'&COMPCODE LE 1).ZE37A  CK NUM                00336200
&ZMS              SETC  '"COMPCODE='                                    00336300
&ZMS              SETC  '&ZMS.&COMPCODE"'                               00336400
&ZMS              SETC  '&ZMS "COMPCODE"'                               00336500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00336600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00336700
.ZE37A            ANOP  ,                                               00336800
.*-------------------------------------------------------------------   00336900
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00337000
                  AIF   (K'&COMPCODE(1) LE 0).ZE37B NO PRM              00337100
&ZXCOMPCODE       SETC  'OUTPUT'    SET IN/OUTPUT                       00337200
&XCOMPCODE        SETC  '&COMPCODE(1)'          SET XVARIABLE           00337300
                  AIF   (N'&COMPCODE GT 1).ZE37B                        00337400
.*                ANOP                                                  00337500
&XCOMPCODE        SETC  '&COMPCODE'             SET XVARIABLE           00337600
.ZE37B            ANOP  ,                                               00337700
.*-------------------------------------------------------------------   00337800
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00337900
                  AIF   (K'&ZXCOMPCODE LE 0).ZE37R  NOT I/O             00338000
                  AIF   ('&XCOMPCODE'(1,1) NE '(').ZE37R                00338100
&ZCGPR            SETC  '&XCOMPCODE'(2,K'&XCOMPCODE-2)                  00338200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE37P                    00338300
                  AIF   (K'&ZCGPR GT 2).ZE37Q                           00338400
                  AIF   ('&ZCGPR' EQ '0').ZE37Q                         00338500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00338600
                  AIF   (T'&ZCGPR NE 'N').ZE37Q  INVALID REG NAME       00338700
.ZE37P            ANOP  ,                                               00338800
                  AIF   (T'&ZCGPR NE 'N').ZE37R  NON NUMERIC            00338900
                  AIF   ('&ZCGPR' LT '2').ZE37Q                         00339000
                  AIF   ('&ZCGPR' LE '12').ZE37R                        00339100
.ZE37Q            ANOP  ,                                               00339200
&ZMS              SETC  '"COMPCODE='                                    00339300
&ZMS              SETC  '&ZMS.&COMPCODE"'                               00339400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00339500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00339600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00339700
.ZE37R            ANOP  ,                                               00339800
.*----------------------------------------------------------------***   00339900
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00340000
                  AIF   (N'&COMPRSN LE 1).ZE40A  CK NUM                 00340100
&ZMS              SETC  '"COMPRSN='                                     00340200
&ZMS              SETC  '&ZMS.&COMPRSN"'                                00340300
&ZMS              SETC  '&ZMS "COMPRSN"'                                00340400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00340500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00340600
.ZE40A            ANOP  ,                                               00340700
.*-------------------------------------------------------------------   00340800
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00340900
                  AIF   (K'&COMPRSN(1) LE 0).ZE40B NO PRM               00341000
&ZXCOMPRSN        SETC  'OUTPUT'    SET IN/OUTPUT                       00341100
&XCOMPRSN         SETC  '&COMPRSN(1)'           SET XVARIABLE           00341200
                  AIF   (N'&COMPRSN GT 1).ZE40B                         00341300
.*                ANOP                                                  00341400
&XCOMPRSN         SETC  '&COMPRSN'  SET XVARIABLE                       00341500
.ZE40B            ANOP  ,                                               00341600
.*-------------------------------------------------------------------   00341700
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00341800
                  AIF   (K'&ZXCOMPRSN LE 0).ZE40R  NOT I/O              00341900
                  AIF   ('&XCOMPRSN'(1,1) NE '(').ZE40R                 00342000
&ZCGPR            SETC  '&XCOMPRSN'(2,K'&XCOMPRSN-2)                    00342100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE40P                    00342200
                  AIF   (K'&ZCGPR GT 2).ZE40Q                           00342300
                  AIF   ('&ZCGPR' EQ '0').ZE40Q                         00342400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00342500
                  AIF   (T'&ZCGPR NE 'N').ZE40Q  INVALID REG NAME       00342600
.ZE40P            ANOP  ,                                               00342700
                  AIF   (T'&ZCGPR NE 'N').ZE40R  NON NUMERIC            00342800
                  AIF   ('&ZCGPR' LT '2').ZE40Q                         00342900
                  AIF   ('&ZCGPR' LE '12').ZE40R                        00343000
.ZE40Q            ANOP  ,                                               00343100
&ZMS              SETC  '"COMPRSN='                                     00343200
&ZMS              SETC  '&ZMS.&COMPRSN"'                                00343300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00343400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00343500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00343600
.ZE40R            ANOP  ,                                               00343700
.*----------------------------------------------------------------***   00343800
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00343900
                  AIF   (N'&RETCODE LE 1).ZE43A  CK NUM                 00344000
&ZMS              SETC  '"RETCODE='                                     00344100
&ZMS              SETC  '&ZMS.&RETCODE"'                                00344200
&ZMS              SETC  '&ZMS "RETCODE"'                                00344300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00344400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00344500
.ZE43A            ANOP  ,                                               00344600
.*-------------------------------------------------------------------   00344700
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00344800
                  AIF   (K'&RETCODE(1) LE 0).ZE43B NO PRM               00344900
&ZXRETCODE        SETC  'OUTPUT'    SET IN/OUTPUT                       00345000
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00345100
                  AIF   (N'&RETCODE GT 1).ZE43B                         00345200
.*                ANOP                                                  00345300
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00345400
.ZE43B            ANOP  ,                                               00345500
.*-------------------------------------------------------------------   00345600
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00345700
                  AIF   (K'&ZXRETCODE LE 0).ZE43R  NOT I/O              00345800
                  AIF   ('&XRETCODE'(1,1) NE '(').ZE43R                 00345900
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00346000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE43P                    00346100
                  AIF   (K'&ZCGPR GT 2).ZE43Q                           00346200
                  AIF   ('&ZCGPR' EQ '0').ZE43Q                         00346300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00346400
                  AIF   (T'&ZCGPR NE 'N').ZE43Q  INVALID REG NAME       00346500
.ZE43P            ANOP  ,                                               00346600
                  AIF   (T'&ZCGPR NE 'N').ZE43R  NON NUMERIC            00346700
                  AIF   ('&ZCGPR' LT '2').ZE43Q                         00346800
                  AIF   ('&ZCGPR' LE '12').ZE43R                        00346900
.ZE43Q            ANOP  ,                                               00347000
&ZMS              SETC  '"RETCODE='                                     00347100
&ZMS              SETC  '&ZMS.&RETCODE"'                                00347200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00347300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00347400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00347500
.ZE43R            ANOP  ,                                               00347600
.*----------------------------------------------------------------***   00347700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00347800
                  AIF   (N'&RSNCODE LE 1).ZE46A  CK NUM                 00347900
&ZMS              SETC  '"RSNCODE='                                     00348000
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00348100
&ZMS              SETC  '&ZMS "RSNCODE"'                                00348200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00348300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00348400
.ZE46A            ANOP  ,                                               00348500
.*-------------------------------------------------------------------   00348600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00348700
                  AIF   (K'&RSNCODE(1) LE 0).ZE46B NO PRM               00348800
&ZXRSNCODE        SETC  'OUTPUT'    SET IN/OUTPUT                       00348900
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00349000
                  AIF   (N'&RSNCODE GT 1).ZE46B                         00349100
.*                ANOP                                                  00349200
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00349300
.ZE46B            ANOP  ,                                               00349400
.*-------------------------------------------------------------------   00349500
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00349600
                  AIF   (K'&ZXRSNCODE LE 0).ZE46R  NOT I/O              00349700
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZE46R                 00349800
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00349900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE46P                    00350000
                  AIF   (K'&ZCGPR GT 2).ZE46Q                           00350100
                  AIF   ('&ZCGPR' EQ '0').ZE46Q                         00350200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00350300
                  AIF   (T'&ZCGPR NE 'N').ZE46Q  INVALID REG NAME       00350400
.ZE46P            ANOP  ,                                               00350500
                  AIF   (T'&ZCGPR NE 'N').ZE46R  NON NUMERIC            00350600
                  AIF   ('&ZCGPR' LT '2').ZE46Q                         00350700
                  AIF   ('&ZCGPR' LE '12').ZE46R                        00350800
.ZE46Q            ANOP  ,                                               00350900
&ZMS              SETC  '"RSNCODE='                                     00351000
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00351100
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00351200
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00351300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00351400
.ZE46R            ANOP  ,                                               00351500
.******************************************************************     00351600
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00351700
.******************************************************************     00351800
                  ACTR  10000                                           00351900
.*----------------------------------------------------------------***   00352000
.***AF.P02 EXTRA POSITIONALS                                            00352100
                  AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS            00352200
&ZCVAL            SETC  ''          ERROR FIELD                         00352300
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00352400
.ZELIST2          ANOP  ,                                               00352500
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00352600
                  AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE            00352700
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00352800
                  AGO   .ZELIST2                                        00352900
.*                                                                      00353000
.ZELIST3          ANOP  ,                                               00353100
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00353200
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'                       00353300
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00353400
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00353500
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00353600
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00353700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00353800
.ZELISTX          ANOP  ,                                               00353900
&ZASYSLNDX        SETA  0                                               00354000
.*-------------------------------------------------------------------   00354100
.***AE.MF02 MF=(SLME)                                                   00354200
.ZEMFX            ANOP  ,           END OF PARTIAL SYNTAX CHECK         00354300
.*******************************************************************    00354400
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00354500
.*******************************************************************    00354600
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00354700
.*******************************************************************    00354800
.***AE.01  START OF BLSACTV MACRO CODE                                  00354900
.*******************************************************************    00355000
                  LCLC  &M0M0001                 NAME                   00355100
&M0M0001          SETC  '&XLABEL'                SET NAME               00355200
                  AIF   (K'&XLABEL NE 0).XLAB2                          00355300
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00355400
.*                                                                      00355500
.XLAB2            ANOP  ,                                               00355600
                  AIF   ('&XMF' EQ 'L').XLAB3                           00355700
&M0M0001 DS    0H                             BLSACTV-1                 00355800
.XLAB3            ANOP  ,                                               00355900
.*******************************************************************    00356000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00356100
.*******************************************************************    00356200
              PUSH  PRINT                                               00356300
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00356400
                  PRINT OFF         ++ PR01                             00356500
                  AGO   .ZPRNTXX                                        00356600
.ZPRINTX          PRINT ON                                              00356700
.ZPRNTXX          ANOP  ,                                               00356800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00356900
*                                                                       00357000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00357100
.********************************************************************   00357200
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00357300
.********************************************************************   00357400
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00357500
                      LCLA  &ZOPN1         INVOCATION INDEX             00357600
                      LCLC  &ZOPL(4095)    LABEL                        00357700
                      LCLC  &ZOPO(4095)    OPERATION                    00357800
                      LCLC  &ZOPV(4095)    VALUE                        00357900
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00358000
.*                                                                      00358100
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00358200
.******************************************************************     00358300
.***AL.L10 BLSACTV FMT=LIST MF=S!L PARAMETERS                           00358400
.******************************************************************     00358500
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00358600
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00358700
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00358800
&XMFATTR              SETC  '0D'                                        00358900
.*                                                                      00359000
&ZOPN                 SETA  &ZOPN+1                                     00359100
&ZOPL(&ZOPN)          SETC  ' '                                         00359200
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00359300
&ZOPV(&ZOPN)          SETC  '4,8'                                       00359400
&ZOPN                 SETA  &ZOPN+1                                     00359500
&ZOPL(&ZOPN)          SETC  ' '                                         00359600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00359700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00359800
&ZOPD(&ZOPN)          SETC  '++ BLSACTV ARG PARMS'                      00359900
.*                                                                      00360000
&ZOPN                 SETA  &ZOPN+1                                     00360100
&ZOPL(&ZOPN)          SETC  ' '                                         00360200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00360300
&ZOPV(&ZOPN)          SETC  '1'                                         00360400
&ZOPD(&ZOPN)          SETC  ' '                                         00360500
.*                                                                      00360600
.ZLMFSL2              ANOP  ,                                           00360700
.*-------------------------------------------------------------------   00360800
.***AM.L00  BLSACTV FMT=LIST name                                       00360900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00361000
&ZOPN                 SETA &ZOPN+1                                      00361100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00361200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00361300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00361400
&ZOPD(&ZOPN)          SETC '++ BLSACTV NAME'                            00361500
.ZLMFSL2M             ANOP  ,                                           00361600
.*-------------------------------------------------------------------   00361700
.***AM.L01  BLSACTV FMT=LIST PARAMETERS                                 00361800
&ZOPN                 SETA &ZOPN+1                                      00361900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00362000
&ZOPO(&ZOPN)          SETC 'DS'                                         00362100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00362200
&ZOPD(&ZOPN)          SETC '++ BLSACTV PARM LIST'                       00362300
.*-------------------------------------------------------------------   00362400
.***AM.L02 XVERSION XL1                                                 00362500
&ZOPN                 SETA &ZOPN+1                                      00362600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00362700
&ZOPO(&ZOPN)          SETC 'DS'                                         00362800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00362900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00363000
.*-------------------------------------------------------------------   00363100
.***AM.L09  XRSV0000 CL3                                                00363200
&ZOPN                 SETA &ZOPN+1                                      00363300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0000'                         00363400
&ZOPO(&ZOPN)          SETC 'DS'                                         00363500
&ZOPV(&ZOPN)          SETC 'CL3'                                        00363600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00363700
.*-------------------------------------------------------------------   00363800
.***AM.L09  XRSVINFO CL4                                                00363900
&ZOPN                 SETA &ZOPN+1                                      00364000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVINFO'                         00364100
&ZOPO(&ZOPN)          SETC 'DS'                                         00364200
&ZOPV(&ZOPN)          SETC 'CL4'                                        00364300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00364400
.*-------------------------------------------------------------------   00364500
.***AM.L09  XSPACEID CL16                                               00364600
&ZOPN                 SETA &ZOPN+1                                      00364700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSPACEID'                         00364800
&ZOPO(&ZOPN)          SETC 'DS'                                         00364900
&ZOPV(&ZOPN)          SETC 'CL16'                                       00365000
&ZOPD(&ZOPN)          SETC '++ &ZXSPACEID '                             00365100
.*-------------------------------------------------------------------   00365200
.***AM.L09  XAREAADDR64 AD                                              00365300
&ZOPN                 SETA &ZOPN+1                                      00365400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAREAADDR64'                      00365500
&ZOPO(&ZOPN)          SETC 'DS'                                         00365600
&ZOPV(&ZOPN)          SETC 'AD'                                         00365700
&ZOPD(&ZOPN)          SETC '++ &ZXAREAADDR64 '                          00365800
.*-------------------------------------------------------------------   00365900
.***AM.L09 ADDR64 XBUFFER64 AD                                          00366000
&ZOPN                 SETA &ZOPN+1                                      00366100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER64_ADDR64'                 00366200
&ZOPO(&ZOPN)          SETC 'DS'                                         00366300
&ZOPV(&ZOPN)          SETC 'AD'                                         00366400
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER64 ADDR64'                      00366500
.*-------------------------------------------------------------------   00366600
.***AM.L09 ALET XBUFFER64 F                                             00366700
&ZOPN                 SETA &ZOPN+1                                      00366800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER64_ALET'                   00366900
&ZOPO(&ZOPN)          SETC 'DS'                                         00367000
&ZOPV(&ZOPN)          SETC 'F'                                          00367100
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER64 ALET'                        00367200
.*-------------------------------------------------------------------   00367300
.***AM.L09  XBUFFERLEN F                                                00367400
&ZOPN                 SETA &ZOPN+1                                      00367500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFERLEN'                       00367600
&ZOPO(&ZOPN)          SETC 'DS'                                         00367700
&ZOPV(&ZOPN)          SETC 'F'                                          00367800
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFERLEN '                           00367900
.*-------------------------------------------------------------------   00368000
.***AM.L09  XBUFFERLENV F                                               00368100
&ZOPN                 SETA &ZOPN+1                                      00368200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFERLENV'                      00368300
&ZOPO(&ZOPN)          SETC 'DS'                                         00368400
&ZOPV(&ZOPN)          SETC 'F'                                          00368500
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFERLENV '                          00368600
.*-------------------------------------------------------------------   00368700
.***AM.L09  XAUTHSTATE XL1                                              00368800
&ZOPN                 SETA &ZOPN+1                                      00368900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAUTHSTATE'                       00369000
&ZOPO(&ZOPN)          SETC 'DS'                                         00369100
&ZOPV(&ZOPN)          SETC 'XL1'                                        00369200
&ZOPD(&ZOPN)          SETC '++ &ZXAUTHSTATE '                           00369300
.*-------------------------------------------------------------------   00369400
.***AM.L09  XAREAKEY XL1                                                00369500
&ZOPN                 SETA &ZOPN+1                                      00369600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAREAKEY'                         00369700
&ZOPO(&ZOPN)          SETC 'DS'                                         00369800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00369900
&ZOPD(&ZOPN)          SETC '++ &ZXAREAKEY '                             00370000
.*-------------------------------------------------------------------   00370100
.***AM.L09  XNEXTKEY XL1                                                00370200
&ZOPN                 SETA &ZOPN+1                                      00370300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNEXTKEY'                         00370400
&ZOPO(&ZOPN)          SETC 'DS'                                         00370500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00370600
&ZOPD(&ZOPN)          SETC '++ &ZXNEXTKEY '                             00370700
.*-------------------------------------------------------------------   00370800
.***AM.L09  XRSV0001 CL1                                                00370900
&ZOPN                 SETA &ZOPN+1                                      00371000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00371100
&ZOPO(&ZOPN)          SETC 'DS'                                         00371200
&ZOPV(&ZOPN)          SETC 'CL1'                                        00371300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00371400
.*-------------------------------------------------------------------   00371500
.***AM.L09  XFIRSTADDR64 AD                                             00371600
&ZOPN                 SETA &ZOPN+1                                      00371700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFIRSTADDR64'                     00371800
&ZOPO(&ZOPN)          SETC 'DS'                                         00371900
&ZOPV(&ZOPN)          SETC 'AD'                                         00372000
&ZOPD(&ZOPN)          SETC '++ &ZXFIRSTADDR64 '                         00372100
.*-------------------------------------------------------------------   00372200
.***AM.L09  XLASTADDR64 AD                                              00372300
&ZOPN                 SETA &ZOPN+1                                      00372400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XLASTADDR64'                      00372500
&ZOPO(&ZOPN)          SETC 'DS'                                         00372600
&ZOPV(&ZOPN)          SETC 'AD'                                         00372700
&ZOPD(&ZOPN)          SETC '++ &ZXLASTADDR64 '                          00372800
.*-------------------------------------------------------------------   00372900
.***AM.L09  XCOMPCODE F                                                 00373000
&ZOPN                 SETA &ZOPN+1                                      00373100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOMPCODE'                        00373200
&ZOPO(&ZOPN)          SETC 'DS'                                         00373300
&ZOPV(&ZOPN)          SETC 'F'                                          00373400
&ZOPD(&ZOPN)          SETC '++ &ZXCOMPCODE '                            00373500
.*-------------------------------------------------------------------   00373600
.***AM.L09  XCOMPRSN F                                                  00373700
&ZOPN                 SETA &ZOPN+1                                      00373800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOMPRSN'                         00373900
&ZOPO(&ZOPN)          SETC 'DS'                                         00374000
&ZOPV(&ZOPN)          SETC 'F'                                          00374100
&ZOPD(&ZOPN)          SETC '++ &ZXCOMPRSN '                             00374200
.*-------------------------------------------------------------------   00374300
.***AM.MLM1 SAVED LOCATION COUNTER                                      00374400
                      AIF  ('&ZENDBASEPL' NE '').ZL17LB                 00374500
&ZENDBASEPL           SETC 'YES'                                        00374600
&ZOPN                 SETA &ZOPN+1                                      00374700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00374800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00374900
&ZOPV(&ZOPN)          SETC '*'                                          00375000
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00375100
.ZL17LB               ANOP  ,                                           00375200
.*-------------------------------------------------------------------   00375300
.***AM.PJR1 DEFINED ON XAREAADDR64                                      00375400
&ZOPN                 SETA &ZOPN+1                                      00375500
&ZOPL(&ZOPN)          SETC ' '                                          00375600
&ZOPO(&ZOPN)          SETC 'ORG'                                        00375700
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+24'                               00375800
&ZOPD(&ZOPN)          SETC ' '                                          00375900
.*-------------------------------------------------------------------   00376000
.***AM.L09  XAREAADDR64C CL8                                            00376100
&ZOPN                 SETA &ZOPN+1                                      00376200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAREAADDR64C'                     00376300
&ZOPO(&ZOPN)          SETC 'DS'                                         00376400
&ZOPV(&ZOPN)          SETC 'CL8'                                        00376500
&ZOPD(&ZOPN)          SETC '++ &ZXAREAADDR64C '                         00376600
.*-------------------------------------------------------------------   00376700
.***AM.PJR1 DEFINED ON XAREAADDR64                                      00376800
&ZOPN                 SETA &ZOPN+1                                      00376900
&ZOPL(&ZOPN)          SETC ' '                                          00377000
&ZOPO(&ZOPN)          SETC 'ORG'                                        00377100
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+24'                               00377200
&ZOPD(&ZOPN)          SETC ' '                                          00377300
.*-------------------------------------------------------------------   00377400
.***AM.L09  XAREAADDR64HIGHHALF CL4                                     00377500
&ZOPN                 SETA &ZOPN+1                                      00377600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAREAADDR64HIGHHALF'              00377700
&ZOPO(&ZOPN)          SETC 'DS'                                         00377800
&ZOPV(&ZOPN)          SETC 'CL4'                                        00377900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00378000
.*-------------------------------------------------------------------   00378100
.***AM.L09  XAREAADDR A                                                 00378200
&ZOPN                 SETA &ZOPN+1                                      00378300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAREAADDR'                        00378400
&ZOPO(&ZOPN)          SETC 'DS'                                         00378500
&ZOPV(&ZOPN)          SETC 'A'                                          00378600
&ZOPD(&ZOPN)          SETC '++ &ZXAREAADDR '                            00378700
.*-------------------------------------------------------------------   00378800
.***AM.PJR1 DEFINED ON XAREAADDR64                                      00378900
&ZOPN                 SETA &ZOPN+1                                      00379000
&ZOPL(&ZOPN)          SETC ' '                                          00379100
&ZOPO(&ZOPN)          SETC 'ORG'                                        00379200
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+24'                               00379300
&ZOPD(&ZOPN)          SETC ' '                                          00379400
.*-------------------------------------------------------------------   00379500
.***AM.L09  XRSV0002 CL4                                                00379600
&ZOPN                 SETA &ZOPN+1                                      00379700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00379800
&ZOPO(&ZOPN)          SETC 'DS'                                         00379900
&ZOPV(&ZOPN)          SETC 'CL4'                                        00380000
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00380100
.*-------------------------------------------------------------------   00380200
.***AM.L09  XRSV0003 CL4                                                00380300
&ZOPN                 SETA &ZOPN+1                                      00380400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00380500
&ZOPO(&ZOPN)          SETC 'DS'                                         00380600
&ZOPV(&ZOPN)          SETC 'CL4'                                        00380700
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00380800
.*-------------------------------------------------------------------   00380900
.***AM.L09  XBUFFER64_ADDR64HIGHHALF CL4                                00381000
&ZOPN                 SETA &ZOPN+1                                      00381100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER64_ADDR64HIGHHALF'         00381200
&ZOPO(&ZOPN)          SETC 'DS'                                         00381300
&ZOPV(&ZOPN)          SETC 'CL4'                                        00381400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00381500
.*-------------------------------------------------------------------   00381600
.***AM.L09 ADDR XBUFFER A                                               00381700
&ZOPN                 SETA &ZOPN+1                                      00381800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ADDR'                     00381900
&ZOPO(&ZOPN)          SETC 'DS'                                         00382000
&ZOPV(&ZOPN)          SETC 'A'                                          00382100
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ADDR'                          00382200
.*-------------------------------------------------------------------   00382300
.***AM.L09 ALET XBUFFER F                                               00382400
&ZOPN                 SETA &ZOPN+1                                      00382500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ALET'                     00382600
&ZOPO(&ZOPN)          SETC 'DS'                                         00382700
&ZOPV(&ZOPN)          SETC 'F'                                          00382800
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ALET'                          00382900
.*-------------------------------------------------------------------   00383000
.***AM.PJR1 DEFINED ON XFIRSTADDR64                                     00383100
&ZOPN                 SETA &ZOPN+1                                      00383200
&ZOPL(&ZOPN)          SETC ' '                                          00383300
&ZOPO(&ZOPN)          SETC 'ORG'                                        00383400
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+56'                               00383500
&ZOPD(&ZOPN)          SETC ' '                                          00383600
.*-------------------------------------------------------------------   00383700
.***AM.L09  XFIRSTADDR64C CL8                                           00383800
&ZOPN                 SETA &ZOPN+1                                      00383900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFIRSTADDR64C'                    00384000
&ZOPO(&ZOPN)          SETC 'DS'                                         00384100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00384200
&ZOPD(&ZOPN)          SETC '++ &ZXFIRSTADDR64C '                        00384300
.*-------------------------------------------------------------------   00384400
.***AM.PJR1 DEFINED ON XLASTADDR64                                      00384500
&ZOPN                 SETA &ZOPN+1                                      00384600
&ZOPL(&ZOPN)          SETC ' '                                          00384700
&ZOPO(&ZOPN)          SETC 'ORG'                                        00384800
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+64'                               00384900
&ZOPD(&ZOPN)          SETC ' '                                          00385000
.*-------------------------------------------------------------------   00385100
.***AM.L09  XLASTADDR64C CL8                                            00385200
&ZOPN                 SETA &ZOPN+1                                      00385300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XLASTADDR64C'                     00385400
&ZOPO(&ZOPN)          SETC 'DS'                                         00385500
&ZOPV(&ZOPN)          SETC 'CL8'                                        00385600
&ZOPD(&ZOPN)          SETC '++ &ZXLASTADDR64C '                         00385700
&ZOPN                 SETA &ZOPN+1                                      00385800
&ZOPL(&ZOPN)          SETC ' '                                          00385900
&ZOPO(&ZOPN)          SETC 'ORG'                                        00386000
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00386100
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00386200
.*-------------------------------------------------------------------   00386300
.***AM.L10 END OF BLSACTV LIST PARAMETERS                               00386400
&ZOPN                 SETA &ZOPN+1                                      00386500
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00386600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00386700
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00386800
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00386900
.*                                                                      00387000
&ZOPN                 SETA &ZOPN+1                                      00387100
&ZOPL(&ZOPN)          SETC ' '                                          00387200
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00387300
&ZOPV(&ZOPN)          SETC '1'                                          00387400
&ZOPD(&ZOPN)          SETC ' '                                          00387500
.*-------------------------------------------------------------------   00387600
.***AL.L12 BLSACTV FMT=LIST MF=S!L PARAMETERS                           00387700
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00387800
.*                                                                      00387900
&ZOPN                 SETA  &ZOPN+1                                     00388000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00388100
&ZOPO(&ZOPN)          SETC  'DC'                                        00388200
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00388300
&ZOPD(&ZOPN)          SETC  '++ BLSACTV ARG PARMS'                      00388400
.*                                                                      00388500
.ZLMFSLX              ANOP  ,                                           00388600
.*-------------------------------------------------------------------   00388700
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00388800
&ZPLLEN               SETA 80                                           00388900
.*                                                                      00389000
.******************************************************************     00389100
.***AI.L01 BLSACTV FMT=LIST FILL IN PARAMETER AREA                      00389200
.******************************************************************     00389300
                      ACTR  10000                                       00389400
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00389500
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00389600
&ZCVAL                SETC  'LAE'          XAX MODE                     00389700
.ZIMFXA               ANOP ,                                            00389800
.*                                                                      00389900
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00390000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00390100
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00390200
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00390300
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00390400
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00390500
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00390600
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00390700
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00390800
&ZOPN                 SETA  &ZOPN+1                                     00390900
&ZOPL(&ZOPN)          SETC  ' '                                         00391000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00391100
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00391200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00391300
                      AGO   .ZIMFNX                                     00391400
.*                                                                      00391500
.ZIMFN2               ANOP ,                                            00391600
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00391700
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00391800
&ZOPN                 SETA  &ZOPN+1                                     00391900
&ZOPL(&ZOPN)          SETC  ' '                                         00392000
&ZOPO(&ZOPN)          SETC  'LAE'                                       00392100
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00392200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00392300
                      AGO   .ZIMFNX                                     00392400
.ZIMFNX1              ANOP ,                                            00392500
&ZOPN                 SETA  &ZOPN+1                                     00392600
&ZOPL(&ZOPN)          SETC  ' '                                         00392700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00392800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00392900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00393000
.ZIMFNX               ANOP ,                                            00393100
.********************************************************************   00393200
.***AI.L02 BLSACTV FMT=LIST INITIALIZE PARAMETER AREA                   00393300
.********************************************************************   00393400
.***AI.L03 MF=(SLME)                                                    00393500
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00393600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00393700
.*                                                                      00393800
&ZOPN                 SETA  &ZOPN+1                                     00393900
&ZOPL(&ZOPN)          SETC  ' '                                         00394000
&ZOPO(&ZOPN)          SETC  'XC'                                        00394100
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00394200
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00394300
.ZIMFLX               ANOP  ,                                           00394400
.*-------------------------------------------------------------------   00394500
.***AI.L04A XVERSION XL1                                                00394600
                      AIF   (&XPLISTVER EQ 0).ZIMFVU                    00394700
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVV            00394800
.ZIMFVU               ANOP  ,                                           00394900
                      AIF   ('&PLISTVER' EQ '').ZIMFVW                  00395000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVW            00395100
.ZIMFVV               ANOP  ,                                           00395200
&ZOPN                 SETA  &ZOPN+1                                     00395300
&ZOPL(&ZOPN)          SETC  ' '                                         00395400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00395500
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00395600
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00395700
.ZIMFVW               ANOP  ,                                           00395800
.*-------------------------------------------------------------------   00395900
.***AI.L25  XSPACEID CL16                                               00396000
                      AIF   ('&ZXSPACEID' EQ '').ZI4E                   00396100
                      AIF   ('&ZXSPACEID' EQ 'OUTPUT').ZI4E             00396200
&ZCGPR                SETC  '&XSPACEID'                                 00396300
.*                                                                      00396400
                      AIF   ('&XSPACEID'(1,1) NE '(').ZI4B              00396500
&ZCGPR   SETC  '0('.'&XSPACEID'(2,K'&XSPACEID-2).')'                    00396600
.ZI4B                 ANOP  ,                                           00396700
.*                                                                      00396800
&ZOPN                 SETA  &ZOPN+1                                     00396900
&ZOPL(&ZOPN)          SETC  ' '                                         00397000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00397100
&ZOPV(&ZOPN)          SETC  '8(16,1),&ZCGPR'                            00397200
&ZOPD(&ZOPN)          SETC  '++ &ZXSPACEID XSPACEID'                    00397300
.*                                                                      00397400
.ZI4E                 ANOP  ,                                           00397500
.*-------------------------------------------------------------------   00397600
.***AI.L25  XAREAADDR64 AL8                                             00397700
                      AIF   ('&ZXAREAADDR64' EQ '').ZI5E                00397800
                      AIF   ('&ZXAREAADDR64' EQ 'OUTPUT').ZI5E          00397900
&ZCGPR                SETC  '&XAREAADDR64'                              00398000
.*                                                                      00398100
                      AIF   ('&XAREAADDR64'(1,1) NE '(').ZI5B           00398200
&ZCGPR   SETC  '0('.'&XAREAADDR64'(2,K'&XAREAADDR64-2).')'              00398300
                      AGO   .ZI5D                                       00398400
.ZI5B                 ANOP  ,                                           00398500
.*                                                                      00398600
&ZC                   SETC  '&XAREAADDR64'(1,1)                         00398700
                      AIF   (T'&ZC NE 'N').ZI5D                         00398800
&ZC                   SETC  '&XAREAADDR64'                              00398900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                00399000
&ZCGPR                SETC  '=AD(&XAREAADDR64)'                         00399100
.*                                                                      00399200
.ZI5D                 ANOP  ,                                           00399300
.*                                                                      00399400
&ZOPN                 SETA  &ZOPN+1                                     00399500
&ZOPL(&ZOPN)          SETC  ' '                                         00399600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00399700
&ZOPV(&ZOPN)          SETC  '24(8,1),&ZCGPR'                            00399800
&ZOPD(&ZOPN)          SETC  '++ &ZXAREAADDR64 XAREAADDR64'              00399900
.*                                                                      00400000
.ZI5E                 ANOP  ,                                           00400100
.*-------------------------------------------------------------------   00400200
.***AI.L19 ADDR64 XBUFFER64 AD                                          00400300
                      AIF   ('&ZXBUFFER64' EQ '').ZI6H                  00400400
&ZCLNG                SETC  '&XBUFFER64'                                00400500
&ZCGPR                SETC  '14'                                        00400600
         AIF   ('&XBUFFER64'(1,1) EQ '(').ZI6F  IN GPR                  00400700
.*                                                                      00400800
&ZOPN                 SETA  &ZOPN+1                                     00400900
&ZOPL(&ZOPN)          SETC  ' '                                         00401000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00401100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00401200
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER64 XBUFFER64'                  00401300
.*                                                                      00401400
                      AGO   .ZI6G                                       00401500
.*                                                                      00401600
.ZI6F                 ANOP  ,                                           00401700
&ZCGPR   SETC  '&XBUFFER64'(2,K'&XBUFFER64-2)                           00401800
.*                                                                      00401900
.ZI6G                 ANOP  ,                                           00402000
                      AIF   ('&SYSAM64' EQ 'YES').ZI6H1A                00402100
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI6C2              00402200
.*                                                                      00402300
&ZOPN                 SETA  &ZOPN+1                                     00402400
&ZOPL(&ZOPN)          SETC  ' '                                         00402500
&ZOPO(&ZOPN)          SETC  'XC'                                        00402600
&ZOPV(&ZOPN)          SETC  '32(4,1),32(1)'                             00402700
.ZI6C2                ANOP  ,                                           00402800
.*                                                                      00402900
&ZOPN                 SETA  &ZOPN+1                                     00403000
&ZOPL(&ZOPN)          SETC  ' '                                         00403100
&ZOPO(&ZOPN)          SETC  'ST'                                        00403200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+32(,1)'                           00403300
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER64 XBUFFER64'                  00403400
.*                                                                      00403500
                      AGO   .ZI6H                                       00403600
.ZI6H1A               ANOP  ,                                           00403700
.*                                                                      00403800
&ZOPN                 SETA  &ZOPN+1                                     00403900
&ZOPL(&ZOPN)          SETC  ' '                                         00404000
&ZOPO(&ZOPN)          SETC  'STG'                                       00404100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,32(,1)'                             00404200
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER64 XBUFFER64'                  00404300
.*                                                                      00404400
.ZI6H                 ANOP  ,                                           00404500
.*-------------------------------------------------------------------   00404600
.***AI.L23 ALET XBUFFER64 F                                             00404700
         AIF   ('&ZXBUFFER64' EQ '').ZI7G                               00404800
         AIF   ('&SYSASCE' EQ 'P').ZI7G    SYSSTATE PRIMARY             00404900
&ZCLNG                SETC  '&XBUFFER64'                                00405000
         AIF   ('&XBUFFER64'(1,1) EQ '(').ZI7E  IN AR                   00405100
.*                                                                      00405200
&ZCGPR                SETC  '14'                                        00405300
                      AGO   .ZI7F                                       00405400
.*                                                                      00405500
.ZI7E                 ANOP  ,                                           00405600
&ZCGPR   SETC  '&XBUFFER64'(2,K'&XBUFFER64-2)                           00405700
.*                                                                      00405800
.ZI7F                 ANOP  ,                                           00405900
.*                                                                      00406000
&ZOPN                 SETA  &ZOPN+1                                     00406100
&ZOPL(&ZOPN)          SETC  ' '                                         00406200
&ZOPO(&ZOPN)          SETC  'STAM'                                      00406300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,40(1)'                       00406400
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER64 XBUFFER64'                  00406500
.*                                                                      00406600
.ZI7G                 ANOP  ,                                           00406700
.*-------------------------------------------------------------------   00406800
.***AI.L25  XBUFFERLEN F                                                00406900
                      AIF   ('&ZXBUFFERLEN' EQ '').ZI8E                 00407000
                      AIF   ('&ZXBUFFERLEN' EQ 'OUTPUT').ZI8E           00407100
&ZCGPR                SETC  '&XBUFFERLEN'                               00407200
.*                                                                      00407300
                      AIF   ('&XBUFFERLEN'(1,1) NE '(').ZI8B            00407400
&ZCGPR   SETC  '0('.'&XBUFFERLEN'(2,K'&XBUFFERLEN-2).')'                00407500
                      AGO   .ZI8D                                       00407600
.ZI8B                 ANOP  ,                                           00407700
.*                                                                      00407800
&ZC                   SETC  '&XBUFFERLEN'(1,1)                          00407900
                      AIF   (T'&ZC NE 'N').ZI8D                         00408000
&ZC                   SETC  '&XBUFFERLEN'                               00408100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00408200
&ZCGPR                SETC  '=AL4(&XBUFFERLEN)'                         00408300
.*                                                                      00408400
.ZI8D                 ANOP  ,                                           00408500
.*                                                                      00408600
&ZOPN                 SETA  &ZOPN+1                                     00408700
&ZOPL(&ZOPN)          SETC  ' '                                         00408800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00408900
&ZOPV(&ZOPN)          SETC  '44(4,1),&ZCGPR'                            00409000
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFERLEN XBUFFERLEN'                00409100
.*                                                                      00409200
.ZI8E                 ANOP  ,                                           00409300
.*-------------------------------------------------------------------   00409400
.***AI.L25  XAREAADDR64C CL8                                            00409500
                      AIF   ('&ZXAREAADDR64C' EQ '').ZI19E              00409600
                      AIF   ('&ZXAREAADDR64C' EQ 'OUTPUT').ZI19E        00409700
&ZCGPR                SETC  '&XAREAADDR64C'                             00409800
.*                                                                      00409900
                      AIF   ('&XAREAADDR64C'(1,1) NE '(').ZI19B         00410000
&ZCGPR   SETC  '0('.'&XAREAADDR64C'(2,K'&XAREAADDR64C-2).')'            00410100
.ZI19B                ANOP  ,                                           00410200
.*                                                                      00410300
&ZOPN                 SETA  &ZOPN+1                                     00410400
&ZOPL(&ZOPN)          SETC  ' '                                         00410500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00410600
&ZOPV(&ZOPN)          SETC  '24(8,1),&ZCGPR'                            00410700
&ZOPD(&ZOPN)          SETC  '++ &ZXAREAADDR64C XAREAADDR64C'            00410800
.*                                                                      00410900
.ZI19E                ANOP  ,                                           00411000
.*-------------------------------------------------------------------   00411100
.***AI.L25  XAREAADDR AL4                                               00411200
                      AIF   ('&ZXAREAADDR' EQ '').ZI22E                 00411300
                      AIF   ('&ZXAREAADDR' EQ 'OUTPUT').ZI22E           00411400
&ZCGPR                SETC  '&XAREAADDR'                                00411500
.*                                                                      00411600
                      AIF   ('&XAREAADDR'(1,1) NE '(').ZI22B            00411700
&ZCGPR   SETC  '0('.'&XAREAADDR'(2,K'&XAREAADDR-2).')'                  00411800
                      AGO   .ZI22D                                      00411900
.ZI22B                ANOP  ,                                           00412000
.*                                                                      00412100
&ZC                   SETC  '&XAREAADDR'(1,1)                           00412200
                      AIF   (T'&ZC NE 'N').ZI22D                        00412300
&ZC                   SETC  '&XAREAADDR'                                00412400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI22D               00412500
&ZCGPR                SETC  '=AL4(&XAREAADDR)'                          00412600
.*                                                                      00412700
.ZI22D                ANOP  ,                                           00412800
.*                                                                      00412900
&ZOPN                 SETA  &ZOPN+1                                     00413000
&ZOPL(&ZOPN)          SETC  ' '                                         00413100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00413200
&ZOPV(&ZOPN)          SETC  '28(4,1),&ZCGPR'                            00413300
&ZOPD(&ZOPN)          SETC  '++ &ZXAREAADDR XAREAADDR'                  00413400
.*                                                                      00413500
.ZI22E                ANOP  ,                                           00413600
.*-------------------------------------------------------------------   00413700
.***AI.L19 ADDR XBUFFER A                                               00413800
                      AIF   ('&ZXBUFFER' EQ '').ZI27H                   00413900
&ZCLNG                SETC  '&XBUFFER'                                  00414000
&ZCGPR                SETC  '14'                                        00414100
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI27F  IN GPR                   00414200
.*                                                                      00414300
&ZOPN                 SETA  &ZOPN+1                                     00414400
&ZOPL(&ZOPN)          SETC  ' '                                         00414500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00414600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00414700
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00414800
.*                                                                      00414900
                      AGO   .ZI27G                                      00415000
.*                                                                      00415100
.ZI27F                ANOP  ,                                           00415200
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00415300
.*                                                                      00415400
.ZI27G                ANOP  ,                                           00415500
.*                                                                      00415600
&ZOPN                 SETA  &ZOPN+1                                     00415700
&ZOPL(&ZOPN)          SETC  ' '                                         00415800
&ZOPO(&ZOPN)          SETC  'ST'                                        00415900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,36(,1)'                             00416000
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00416100
.*                                                                      00416200
.ZI27H                ANOP  ,                                           00416300
.*-------------------------------------------------------------------   00416400
.***AI.L23 ALET XBUFFER F                                               00416500
         AIF   ('&ZXBUFFER' EQ '').ZI28G                                00416600
         AIF   ('&SYSASCE' EQ 'P').ZI28G   SYSSTATE PRIMARY             00416700
&ZCLNG                SETC  '&XBUFFER'                                  00416800
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI28E  IN AR                    00416900
.*                                                                      00417000
&ZCGPR                SETC  '14'                                        00417100
                      AGO   .ZI28F                                      00417200
.*                                                                      00417300
.ZI28E                ANOP  ,                                           00417400
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00417500
.*                                                                      00417600
.ZI28F                ANOP  ,                                           00417700
.*                                                                      00417800
&ZOPN                 SETA  &ZOPN+1                                     00417900
&ZOPL(&ZOPN)          SETC  ' '                                         00418000
&ZOPO(&ZOPN)          SETC  'STAM'                                      00418100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,40(1)'                       00418200
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00418300
.*                                                                      00418400
.ZI28G                ANOP  ,                                           00418500
.*-------------------------------------------------------------------   00418600
&ZOPN1                SETA &ZOPN                                        00418700
.*-------------------------------------------------------------------   00418800
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00418900
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00419000
.*******************************************************************    00419100
.***  PROCESS BLSACTV OUTPUT PARAMETERS                                 00419200
.*******************************************************************    00419300
                      ACTR  10000                                       00419400
.*------------------------------------------------------------------    00419500
.***AO.L02 XBUFFERLENV F                                                00419600
         AIF   ('&ZXBUFFERLENV' EQ 'OUTPUT').ZO9A  OUTPUT               00419700
         AIF   ('&ZXBUFFERLENV' NE 'INOUT').ZO9C  INOUT                 00419800
.ZO9A    AIF   ('&XBUFFERLENV'(1,1) NE '(').ZO9B  ADDR IN GPR           00419900
&ZCGPR   SETC  '&XBUFFERLENV'(2,K'&XBUFFERLENV-2)                       00420000
&ZOPN                 SETA  &ZOPN+1                                     00420100
&ZOPL(&ZOPN)          SETC  ' '                                         00420200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00420300
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),48(1)'                         00420400
&ZOPD(&ZOPN)          SETC  '++ XBUFFERLENV F'                          00420500
                      AGO   .ZO9C                                       00420600
.*                                                                      00420700
.ZO9B                 ANOP  ,                                           00420800
&ZAWRK   SETA  K'&XBUFFERLENV                                           00420900
         AIF   ('&XBUFFERLENV'(&ZAWRK,1) NE ')').ZO9G                   00421000
&ZN      SETA  2                                                        00421100
.ZO9H    ANOP                                                           00421200
         AIF   (&ZN GE &ZAWRK).ZO9G                                     00421300
         AIF   ('&XBUFFERLENV'(&ZN,1) NE '(').ZO9I                      00421400
&ZC      SETC  '&XBUFFERLENV'(1,&ZN).'4'.','                            00421500
&ZC      SETC  '&ZC'.'&XBUFFERLENV'(&ZN+1,&ZAWRK-&ZN).',48(1)'          00421600
         AGO   .ZO9J                                                    00421700
.ZO9I    ANOP                                                           00421800
&ZN      SETA  &ZN+1                                                    00421900
         AGO   .ZO9H                                                    00422000
.ZO9G    ANOP                                                           00422100
&ZC      SETC  '&XBUFFERLENV.(4),48(1)'                                 00422200
.ZO9J    ANOP                                                           00422300
&ZOPN                 SETA  &ZOPN+1                                     00422400
&ZOPL(&ZOPN)          SETC  ' '                                         00422500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00422600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00422700
&ZOPD(&ZOPN)          SETC  '++ XBUFFERLENV F'                          00422800
.ZO9C                 ANOP  ,                                           00422900
.*------------------------------------------------------------------    00423000
.***AO.L02 XAUTHSTATE FL1                                               00423100
         AIF   ('&ZXAUTHSTATE' EQ 'OUTPUT').ZO10A  OUTPUT               00423200
         AIF   ('&ZXAUTHSTATE' NE 'INOUT').ZO10C  INOUT                 00423300
.ZO10A    AIF   ('&XAUTHSTATE'(1,1) NE '(').ZO10B  ADDR IN GPR          00423400
&ZCGPR   SETC  '&XAUTHSTATE'(2,K'&XAUTHSTATE-2)                         00423500
&ZOPN                 SETA  &ZOPN+1                                     00423600
&ZOPL(&ZOPN)          SETC  ' '                                         00423700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00423800
&ZOPV(&ZOPN)          SETC  '0(1,&ZCGPR),52(1)'                         00423900
&ZOPD(&ZOPN)          SETC  '++ XAUTHSTATE FL1'                         00424000
                      AGO   .ZO10C                                      00424100
.*                                                                      00424200
.ZO10B                ANOP  ,                                           00424300
&ZAWRK   SETA  K'&XAUTHSTATE                                            00424400
         AIF   ('&XAUTHSTATE'(&ZAWRK,1) NE ')').ZO10G                   00424500
&ZN      SETA  2                                                        00424600
.ZO10H    ANOP                                                          00424700
         AIF   (&ZN GE &ZAWRK).ZO10G                                    00424800
         AIF   ('&XAUTHSTATE'(&ZN,1) NE '(').ZO10I                      00424900
&ZC      SETC  '&XAUTHSTATE'(1,&ZN).'1'.','                             00425000
&ZC      SETC  '&ZC'.'&XAUTHSTATE'(&ZN+1,&ZAWRK-&ZN).',52(1)'           00425100
         AGO   .ZO10J                                                   00425200
.ZO10I    ANOP                                                          00425300
&ZN      SETA  &ZN+1                                                    00425400
         AGO   .ZO10H                                                   00425500
.ZO10G    ANOP                                                          00425600
&ZC      SETC  '&XAUTHSTATE.(1),52(1)'                                  00425700
.ZO10J    ANOP                                                          00425800
&ZOPN                 SETA  &ZOPN+1                                     00425900
&ZOPL(&ZOPN)          SETC  ' '                                         00426000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00426100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00426200
&ZOPD(&ZOPN)          SETC  '++ XAUTHSTATE FL1'                         00426300
.ZO10C                ANOP  ,                                           00426400
.*------------------------------------------------------------------    00426500
.***AO.L02 XAREAKEY FL1                                                 00426600
         AIF   ('&ZXAREAKEY' EQ 'OUTPUT').ZO11A  OUTPUT                 00426700
         AIF   ('&ZXAREAKEY' NE 'INOUT').ZO11C  INOUT                   00426800
.ZO11A    AIF   ('&XAREAKEY'(1,1) NE '(').ZO11B  ADDR IN GPR            00426900
&ZCGPR   SETC  '&XAREAKEY'(2,K'&XAREAKEY-2)                             00427000
&ZOPN                 SETA  &ZOPN+1                                     00427100
&ZOPL(&ZOPN)          SETC  ' '                                         00427200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00427300
&ZOPV(&ZOPN)          SETC  '0(1,&ZCGPR),53(1)'                         00427400
&ZOPD(&ZOPN)          SETC  '++ XAREAKEY FL1'                           00427500
                      AGO   .ZO11C                                      00427600
.*                                                                      00427700
.ZO11B                ANOP  ,                                           00427800
&ZAWRK   SETA  K'&XAREAKEY                                              00427900
         AIF   ('&XAREAKEY'(&ZAWRK,1) NE ')').ZO11G                     00428000
&ZN      SETA  2                                                        00428100
.ZO11H    ANOP                                                          00428200
         AIF   (&ZN GE &ZAWRK).ZO11G                                    00428300
         AIF   ('&XAREAKEY'(&ZN,1) NE '(').ZO11I                        00428400
&ZC      SETC  '&XAREAKEY'(1,&ZN).'1'.','                               00428500
&ZC      SETC  '&ZC'.'&XAREAKEY'(&ZN+1,&ZAWRK-&ZN).',53(1)'             00428600
         AGO   .ZO11J                                                   00428700
.ZO11I    ANOP                                                          00428800
&ZN      SETA  &ZN+1                                                    00428900
         AGO   .ZO11H                                                   00429000
.ZO11G    ANOP                                                          00429100
&ZC      SETC  '&XAREAKEY.(1),53(1)'                                    00429200
.ZO11J    ANOP                                                          00429300
&ZOPN                 SETA  &ZOPN+1                                     00429400
&ZOPL(&ZOPN)          SETC  ' '                                         00429500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00429600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00429700
&ZOPD(&ZOPN)          SETC  '++ XAREAKEY FL1'                           00429800
.ZO11C                ANOP  ,                                           00429900
.*------------------------------------------------------------------    00430000
.***AO.L02 XNEXTKEY FL1                                                 00430100
         AIF   ('&ZXNEXTKEY' EQ 'OUTPUT').ZO12A  OUTPUT                 00430200
         AIF   ('&ZXNEXTKEY' NE 'INOUT').ZO12C  INOUT                   00430300
.ZO12A    AIF   ('&XNEXTKEY'(1,1) NE '(').ZO12B  ADDR IN GPR            00430400
&ZCGPR   SETC  '&XNEXTKEY'(2,K'&XNEXTKEY-2)                             00430500
&ZOPN                 SETA  &ZOPN+1                                     00430600
&ZOPL(&ZOPN)          SETC  ' '                                         00430700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00430800
&ZOPV(&ZOPN)          SETC  '0(1,&ZCGPR),54(1)'                         00430900
&ZOPD(&ZOPN)          SETC  '++ XNEXTKEY FL1'                           00431000
                      AGO   .ZO12C                                      00431100
.*                                                                      00431200
.ZO12B                ANOP  ,                                           00431300
&ZAWRK   SETA  K'&XNEXTKEY                                              00431400
         AIF   ('&XNEXTKEY'(&ZAWRK,1) NE ')').ZO12G                     00431500
&ZN      SETA  2                                                        00431600
.ZO12H    ANOP                                                          00431700
         AIF   (&ZN GE &ZAWRK).ZO12G                                    00431800
         AIF   ('&XNEXTKEY'(&ZN,1) NE '(').ZO12I                        00431900
&ZC      SETC  '&XNEXTKEY'(1,&ZN).'1'.','                               00432000
&ZC      SETC  '&ZC'.'&XNEXTKEY'(&ZN+1,&ZAWRK-&ZN).',54(1)'             00432100
         AGO   .ZO12J                                                   00432200
.ZO12I    ANOP                                                          00432300
&ZN      SETA  &ZN+1                                                    00432400
         AGO   .ZO12H                                                   00432500
.ZO12G    ANOP                                                          00432600
&ZC      SETC  '&XNEXTKEY.(1),54(1)'                                    00432700
.ZO12J    ANOP                                                          00432800
&ZOPN                 SETA  &ZOPN+1                                     00432900
&ZOPL(&ZOPN)          SETC  ' '                                         00433000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00433100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00433200
&ZOPD(&ZOPN)          SETC  '++ XNEXTKEY FL1'                           00433300
.ZO12C                ANOP  ,                                           00433400
.*------------------------------------------------------------------    00433500
.***AO.L02 XFIRSTADDR64 AL8                                             00433600
         AIF   ('&ZXFIRSTADDR64' EQ 'OUTPUT').ZO14A  OUTPUT             00433700
         AIF   ('&ZXFIRSTADDR64' NE 'INOUT').ZO14C  INOUT               00433800
.ZO14A    AIF   ('&XFIRSTADDR64'(1,1) NE '(').ZO14B  ADDR IN GPR        00433900
&ZCGPR   SETC  '&XFIRSTADDR64'(2,K'&XFIRSTADDR64-2)                     00434000
&ZOPN                 SETA  &ZOPN+1                                     00434100
&ZOPL(&ZOPN)          SETC  ' '                                         00434200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00434300
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),56(1)'                         00434400
&ZOPD(&ZOPN)          SETC  '++ XFIRSTADDR64 AL8'                       00434500
                      AGO   .ZO14C                                      00434600
.*                                                                      00434700
.ZO14B                ANOP  ,                                           00434800
&ZAWRK   SETA  K'&XFIRSTADDR64                                          00434900
         AIF   ('&XFIRSTADDR64'(&ZAWRK,1) NE ')').ZO14G                 00435000
&ZN      SETA  2                                                        00435100
.ZO14H    ANOP                                                          00435200
         AIF   (&ZN GE &ZAWRK).ZO14G                                    00435300
         AIF   ('&XFIRSTADDR64'(&ZN,1) NE '(').ZO14I                    00435400
&ZC      SETC  '&XFIRSTADDR64'(1,&ZN).'8'.','                           00435500
&ZC      SETC  '&ZC'.'&XFIRSTADDR64'(&ZN+1,&ZAWRK-&ZN).',56(1)'         00435600
         AGO   .ZO14J                                                   00435700
.ZO14I    ANOP                                                          00435800
&ZN      SETA  &ZN+1                                                    00435900
         AGO   .ZO14H                                                   00436000
.ZO14G    ANOP                                                          00436100
&ZC      SETC  '&XFIRSTADDR64.(8),56(1)'                                00436200
.ZO14J    ANOP                                                          00436300
&ZOPN                 SETA  &ZOPN+1                                     00436400
&ZOPL(&ZOPN)          SETC  ' '                                         00436500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00436600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00436700
&ZOPD(&ZOPN)          SETC  '++ XFIRSTADDR64 AL8'                       00436800
.ZO14C                ANOP  ,                                           00436900
.*------------------------------------------------------------------    00437000
.***AO.L02 XLASTADDR64 AL8                                              00437100
         AIF   ('&ZXLASTADDR64' EQ 'OUTPUT').ZO15A  OUTPUT              00437200
         AIF   ('&ZXLASTADDR64' NE 'INOUT').ZO15C  INOUT                00437300
.ZO15A    AIF   ('&XLASTADDR64'(1,1) NE '(').ZO15B  ADDR IN GPR         00437400
&ZCGPR   SETC  '&XLASTADDR64'(2,K'&XLASTADDR64-2)                       00437500
&ZOPN                 SETA  &ZOPN+1                                     00437600
&ZOPL(&ZOPN)          SETC  ' '                                         00437700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00437800
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),64(1)'                         00437900
&ZOPD(&ZOPN)          SETC  '++ XLASTADDR64 AL8'                        00438000
                      AGO   .ZO15C                                      00438100
.*                                                                      00438200
.ZO15B                ANOP  ,                                           00438300
&ZAWRK   SETA  K'&XLASTADDR64                                           00438400
         AIF   ('&XLASTADDR64'(&ZAWRK,1) NE ')').ZO15G                  00438500
&ZN      SETA  2                                                        00438600
.ZO15H    ANOP                                                          00438700
         AIF   (&ZN GE &ZAWRK).ZO15G                                    00438800
         AIF   ('&XLASTADDR64'(&ZN,1) NE '(').ZO15I                     00438900
&ZC      SETC  '&XLASTADDR64'(1,&ZN).'8'.','                            00439000
&ZC      SETC  '&ZC'.'&XLASTADDR64'(&ZN+1,&ZAWRK-&ZN).',64(1)'          00439100
         AGO   .ZO15J                                                   00439200
.ZO15I    ANOP                                                          00439300
&ZN      SETA  &ZN+1                                                    00439400
         AGO   .ZO15H                                                   00439500
.ZO15G    ANOP                                                          00439600
&ZC      SETC  '&XLASTADDR64.(8),64(1)'                                 00439700
.ZO15J    ANOP                                                          00439800
&ZOPN                 SETA  &ZOPN+1                                     00439900
&ZOPL(&ZOPN)          SETC  ' '                                         00440000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00440100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00440200
&ZOPD(&ZOPN)          SETC  '++ XLASTADDR64 AL8'                        00440300
.ZO15C                ANOP  ,                                           00440400
.*------------------------------------------------------------------    00440500
.***AO.L02 XCOMPCODE F                                                  00440600
         AIF   ('&ZXCOMPCODE' EQ 'OUTPUT').ZO16A  OUTPUT                00440700
         AIF   ('&ZXCOMPCODE' NE 'INOUT').ZO16C  INOUT                  00440800
.ZO16A    AIF   ('&XCOMPCODE'(1,1) NE '(').ZO16B  ADDR IN GPR           00440900
&ZCGPR   SETC  '&XCOMPCODE'(2,K'&XCOMPCODE-2)                           00441000
&ZOPN                 SETA  &ZOPN+1                                     00441100
&ZOPL(&ZOPN)          SETC  ' '                                         00441200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00441300
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),72(1)'                         00441400
&ZOPD(&ZOPN)          SETC  '++ XCOMPCODE F'                            00441500
                      AGO   .ZO16C                                      00441600
.*                                                                      00441700
.ZO16B                ANOP  ,                                           00441800
&ZAWRK   SETA  K'&XCOMPCODE                                             00441900
         AIF   ('&XCOMPCODE'(&ZAWRK,1) NE ')').ZO16G                    00442000
&ZN      SETA  2                                                        00442100
.ZO16H    ANOP                                                          00442200
         AIF   (&ZN GE &ZAWRK).ZO16G                                    00442300
         AIF   ('&XCOMPCODE'(&ZN,1) NE '(').ZO16I                       00442400
&ZC      SETC  '&XCOMPCODE'(1,&ZN).'4'.','                              00442500
&ZC      SETC  '&ZC'.'&XCOMPCODE'(&ZN+1,&ZAWRK-&ZN).',72(1)'            00442600
         AGO   .ZO16J                                                   00442700
.ZO16I    ANOP                                                          00442800
&ZN      SETA  &ZN+1                                                    00442900
         AGO   .ZO16H                                                   00443000
.ZO16G    ANOP                                                          00443100
&ZC      SETC  '&XCOMPCODE.(4),72(1)'                                   00443200
.ZO16J    ANOP                                                          00443300
&ZOPN                 SETA  &ZOPN+1                                     00443400
&ZOPL(&ZOPN)          SETC  ' '                                         00443500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00443600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00443700
&ZOPD(&ZOPN)          SETC  '++ XCOMPCODE F'                            00443800
.ZO16C                ANOP  ,                                           00443900
.*------------------------------------------------------------------    00444000
.***AO.L02 XCOMPRSN F                                                   00444100
         AIF   ('&ZXCOMPRSN' EQ 'OUTPUT').ZO17A  OUTPUT                 00444200
         AIF   ('&ZXCOMPRSN' NE 'INOUT').ZO17C  INOUT                   00444300
.ZO17A    AIF   ('&XCOMPRSN'(1,1) NE '(').ZO17B  ADDR IN GPR            00444400
&ZCGPR   SETC  '&XCOMPRSN'(2,K'&XCOMPRSN-2)                             00444500
&ZOPN                 SETA  &ZOPN+1                                     00444600
&ZOPL(&ZOPN)          SETC  ' '                                         00444700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00444800
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),76(1)'                         00444900
&ZOPD(&ZOPN)          SETC  '++ XCOMPRSN F'                             00445000
                      AGO   .ZO17C                                      00445100
.*                                                                      00445200
.ZO17B                ANOP  ,                                           00445300
&ZAWRK   SETA  K'&XCOMPRSN                                              00445400
         AIF   ('&XCOMPRSN'(&ZAWRK,1) NE ')').ZO17G                     00445500
&ZN      SETA  2                                                        00445600
.ZO17H    ANOP                                                          00445700
         AIF   (&ZN GE &ZAWRK).ZO17G                                    00445800
         AIF   ('&XCOMPRSN'(&ZN,1) NE '(').ZO17I                        00445900
&ZC      SETC  '&XCOMPRSN'(1,&ZN).'4'.','                               00446000
&ZC      SETC  '&ZC'.'&XCOMPRSN'(&ZN+1,&ZAWRK-&ZN).',76(1)'             00446100
         AGO   .ZO17J                                                   00446200
.ZO17I    ANOP                                                          00446300
&ZN      SETA  &ZN+1                                                    00446400
         AGO   .ZO17H                                                   00446500
.ZO17G    ANOP                                                          00446600
&ZC      SETC  '&XCOMPRSN.(4),76(1)'                                    00446700
.ZO17J    ANOP                                                          00446800
&ZOPN                 SETA  &ZOPN+1                                     00446900
&ZOPL(&ZOPN)          SETC  ' '                                         00447000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00447100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00447200
&ZOPD(&ZOPN)          SETC  '++ XCOMPRSN F'                             00447300
.ZO17C                ANOP  ,                                           00447400
.*------------------------------------------------------------------    00447500
.***AO.L02 XFIRSTADDR64C CL8                                            00447600
         AIF   ('&ZXFIRSTADDR64C' EQ 'OUTPUT').ZO30A  OUTPUT            00447700
         AIF   ('&ZXFIRSTADDR64C' NE 'INOUT').ZO30C  INOUT              00447800
.ZO30A    AIF   ('&XFIRSTADDR64C'(1,1) NE '(').ZO30B  ADDR IN GPR       00447900
&ZCGPR   SETC  '&XFIRSTADDR64C'(2,K'&XFIRSTADDR64C-2)                   00448000
&ZOPN                 SETA  &ZOPN+1                                     00448100
&ZOPL(&ZOPN)          SETC  ' '                                         00448200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00448300
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),56(1)'                         00448400
&ZOPD(&ZOPN)          SETC  '++ XFIRSTADDR64C CL8'                      00448500
                      AGO   .ZO30C                                      00448600
.*                                                                      00448700
.ZO30B                ANOP  ,                                           00448800
&ZAWRK   SETA  K'&XFIRSTADDR64C                                         00448900
         AIF   ('&XFIRSTADDR64C'(&ZAWRK,1) NE ')').ZO30G                00449000
&ZN      SETA  2                                                        00449100
.ZO30H    ANOP                                                          00449200
         AIF   (&ZN GE &ZAWRK).ZO30G                                    00449300
         AIF   ('&XFIRSTADDR64C'(&ZN,1) NE '(').ZO30I                   00449400
&ZC      SETC  '&XFIRSTADDR64C'(1,&ZN).'8'.','                          00449500
&ZC      SETC  '&ZC'.'&XFIRSTADDR64C'(&ZN+1,&ZAWRK-&ZN).',56(1)'        00449600
         AGO   .ZO30J                                                   00449700
.ZO30I    ANOP                                                          00449800
&ZN      SETA  &ZN+1                                                    00449900
         AGO   .ZO30H                                                   00450000
.ZO30G    ANOP                                                          00450100
&ZC      SETC  '&XFIRSTADDR64C.(8),56(1)'                               00450200
.ZO30J    ANOP                                                          00450300
&ZOPN                 SETA  &ZOPN+1                                     00450400
&ZOPL(&ZOPN)          SETC  ' '                                         00450500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00450600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00450700
&ZOPD(&ZOPN)          SETC  '++ XFIRSTADDR64C CL8'                      00450800
.ZO30C                ANOP  ,                                           00450900
.*------------------------------------------------------------------    00451000
.***AO.L02 XLASTADDR64C CL8                                             00451100
         AIF   ('&ZXLASTADDR64C' EQ 'OUTPUT').ZO32A  OUTPUT             00451200
         AIF   ('&ZXLASTADDR64C' NE 'INOUT').ZO32C  INOUT               00451300
.ZO32A    AIF   ('&XLASTADDR64C'(1,1) NE '(').ZO32B  ADDR IN GPR        00451400
&ZCGPR   SETC  '&XLASTADDR64C'(2,K'&XLASTADDR64C-2)                     00451500
&ZOPN                 SETA  &ZOPN+1                                     00451600
&ZOPL(&ZOPN)          SETC  ' '                                         00451700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00451800
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),64(1)'                         00451900
&ZOPD(&ZOPN)          SETC  '++ XLASTADDR64C CL8'                       00452000
                      AGO   .ZO32C                                      00452100
.*                                                                      00452200
.ZO32B                ANOP  ,                                           00452300
&ZAWRK   SETA  K'&XLASTADDR64C                                          00452400
         AIF   ('&XLASTADDR64C'(&ZAWRK,1) NE ')').ZO32G                 00452500
&ZN      SETA  2                                                        00452600
.ZO32H    ANOP                                                          00452700
         AIF   (&ZN GE &ZAWRK).ZO32G                                    00452800
         AIF   ('&XLASTADDR64C'(&ZN,1) NE '(').ZO32I                    00452900
&ZC      SETC  '&XLASTADDR64C'(1,&ZN).'8'.','                           00453000
&ZC      SETC  '&ZC'.'&XLASTADDR64C'(&ZN+1,&ZAWRK-&ZN).',64(1)'         00453100
         AGO   .ZO32J                                                   00453200
.ZO32I    ANOP                                                          00453300
&ZN      SETA  &ZN+1                                                    00453400
         AGO   .ZO32H                                                   00453500
.ZO32G    ANOP                                                          00453600
&ZC      SETC  '&XLASTADDR64C.(8),64(1)'                                00453700
.ZO32J    ANOP                                                          00453800
&ZOPN                 SETA  &ZOPN+1                                     00453900
&ZOPL(&ZOPN)          SETC  ' '                                         00454000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00454100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00454200
&ZOPD(&ZOPN)          SETC  '++ XLASTADDR64C CL8'                       00454300
.ZO32C                ANOP  ,                                           00454400
.*******************************************************************    00454500
.***AO.X02  RETURN CODE PROCESSING                                      00454600
.*******************************************************************    00454700
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00454800
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00454900
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00455000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00455100
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00455200
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00455300
&ZOPN                 SETA  &ZOPN+1                                     00455400
&ZOPL(&ZOPN)          SETC  ' '                                         00455500
&ZOPO(&ZOPN)          SETC  'ST'                                        00455600
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00455700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00455800
                      AGO   .ZMRETX                                     00455900
.*                                                                      00456000
.ZMRET2               ANOP  ,                                           00456100
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00456200
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00456300
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00456400
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00456500
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00456600
&ZOPN                 SETA  &ZOPN+1                                     00456700
&ZOPL(&ZOPN)          SETC  ' '                                         00456800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00456900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00457000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00457100
.ZMRETX               ANOP  ,                                           00457200
.*******************************************************************    00457300
.***AO.X03  REASON CODE PROCESSING                                      00457400
.*******************************************************************    00457500
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00457600
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00457700
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00457800
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00457900
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00458000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00458100
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00458200
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00458300
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00458400
&ZOPN                 SETA  &ZOPN+1                                     00458500
&ZOPL(&ZOPN)          SETC  ' '                                         00458600
&ZOPO(&ZOPN)          SETC  'ST'                                        00458700
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00458800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00458900
                      AGO   .ZMRSNX                                     00459000
.*                                                                      00459100
.ZMRSN2               ANOP  ,                                           00459200
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00459300
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00459400
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00459500
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00459600
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00459700
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00459800
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00459900
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00460000
&ZOPN                 SETA  &ZOPN+1                                     00460100
&ZOPL(&ZOPN)          SETC  ' '                                         00460200
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00460300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00460400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00460500
.ZMRSNX               ANOP  ,                                           00460600
.*******************************************************************    00460700
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00460800
.*******************************************************************    00460900
.ZMFLX                ANOP  ,              MF=L PROCESSING              00461000
.*******************************************************************    00461100
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00461200
.*******************************************************************    00461300
                      ACTR  10000                                       00461400
.*                                                                      00461500
                      LCLA  &ZLC           COLUMN POSITION              00461600
                      LCLA  &ZOPX          LIST TABLE INDEX             00461700
                      LCLC  &ZLL           LABEL                        00461800
                      LCLC  &ZLOP          OPERATION                    00461900
                      LCLC  &ZLV           VALUE                        00462000
                      LCLC  &ZLD           DESCRIPTION                  00462100
.*                                                                      00462200
&ZOPX                 SETA  1                                           00462300
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00462400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00462500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00462600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00462700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00462800
                      AIF   (K'&ZLD LE 0).ZL5                           00462900
&ZLC                  SETA  35             COMMENT COLUMN               00463000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00463100
&ZLC                  SETA  33             COMMMENT COLUMN              00463200
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00463300
&ZLV                  SETC  '&ZLV'.' '                                  00463400
                      AGO   .ZL3                                        00463500
.*                                                                      00463600
.ZL4                  ANOP  ,                                           00463700
&ZLV                  SETC  '&ZLV'.' '                                  00463800
.ZL5                  ANOP  ,                                           00463900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00464000
.*                                                                      00464100
&ZLL     &ZLOP &ZLV                                                     00464200
.*                                                                      00464300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00464400
                      AGO   .ZL2           CONTINUE LOOPING             00464500
.*                                                                      00464600
.ZLX                  ANOP  ,                                           00464700
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00464800
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00464900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00465000
         AIF   (&SYSALVL GT 1).AM641A                              @L1A 00465100
         L     14,16(0,0)              GET CVT ADDRESS             @L1A 00465200
         AGO   .AM641B                                             @L1A 00465300
.AM641A  ANOP                                                           00465400
         LLGT  14,16(0,0)              GET CVT ADDRESS             @L1A 00465500
.AM641B  ANOP                                                           00465600
         L     14,772(14,0)            GET SFT ADDRESS             @L1A 00465700
         L     14,544(14,0)            GET LX/EX FOR SERVICE RTN   @L1A 00465800
         PC    0(14)                                               @L1A 00465900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00466000
.ZLINKX               ANOP  ,                                           00466100
.*******************************************************************    00466200
.***AP.X01  FORMAT GENERATED CODE                                       00466300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00466400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00466500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00466600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00466700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00466800
                      AIF   (K'&ZLD LE 0).ZL51                          00466900
&ZLC                  SETA  35             COMMENT COLUMN               00467000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00467100
&ZLC                  SETA  33             COMMENT COLUMN               00467200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00467300
&ZLV                  SETC  '&ZLV'.' '                                  00467400
                      AGO   .ZL31                                       00467500
.*                                                                      00467600
.ZL41                 ANOP  ,                                           00467700
&ZLV                  SETC  '&ZLV'.' '                                  00467800
.ZL51                 ANOP  ,                                           00467900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00468000
.*                                                                      00468100
&ZLL     &ZLOP &ZLV                                                     00468200
.*                                                                      00468300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00468400
                      AGO   .ZL21          CONTINUE LOOPING             00468500
.*                                                                      00468600
.ZLX1                 ANOP  ,                                           00468700
.*******************************************************************    00468800
.***AP.X02  END OF BLSACTV MACRO                                        00468900
&ZBLSACTV             SETC  'YES'          SET BLSACTV USED             00469000
         POP   PRINT                                                    00469100
*                                            BLSACTV-1                  00469200
         SPACE 1                                                        00469300
.ZLX2                 ANOP  ,                                           00469400
         MEND                                                           00469500
**********************************************************************/ 00469600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00469700
*%BLSACTV: MACRO KEYS(SPACEID,AREAADDR,AREAADDR64,AREAADDR64C,BUFFER,   00469800
*                 BUFFER64,BUFFERLEN,BUFFERLENV,AUTHSTATE,AREAKEY,      00469900
*                 NEXTKEY,FIRSTADDR64,FIRSTADDR64C,LASTADDR64,          00470000
*                 LASTADDR64C,COMPCODE,COMPRSN,RETCODE,RSNCODE,         00470100
*                 PLISTVER,MF);                                         00470200
*  ANS('?'!!MACLABEL!!' '!!'BLSACTVP '!!MACLIST!!                       00470300
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00470400
*%END BLSACTV;                                                          00470500

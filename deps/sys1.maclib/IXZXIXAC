*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXZXIXAC                              -11/12/03-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Acknowledge processed message                 * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 (C) COPYRIGHT IBM CORP. 1996, 2004                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7709                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      Purpose:  The IXZXIXAC is invoked after a message has been     * 00002100
*      processed on the receiving system. This indicates to the JES   * 00002200
*      XCF Subtask that the message can be acknowledged to the sender * 00002300
*      if required and any resources, held by the receiving subtask   * 00002400
*      for the message, can be freed.                                 * 00002500
*                                                                     * 00002600
*      IBM use of this interface:  Any time a message is received     * 00002700
*      with the IXZXIXRM macro service, the message must be           * 00002800
*      acknowledged with the IXZXIXAC macro service.                  * 00002900
*                                                                     * 00003000
*      Customer use of this interface:  Any time a message is         * 00003100
*      received with the IXZXIXRM macro service, the message must be  * 00003200
*      acknowledged with the IXZXIXAC macro service.                  * 00003300
*                                                                     * 00003400
*      CDPI Implications:                                             * 00003500
*                                                                     * 00003600
*      This macro is a General Use Programming Interface.  It is      * 00003700
*      intended to be used as part of JES exits and JES3 dynamic      * 00003800
*      support programs. The macro is only used in JES environments.  * 00003900
*                                                                     * 00004000
*      EEC Implications:  This macro is not an EEC interface.         * 00004100
*                                                                     * 00004200
*      Related Macros:  The following macros are required in order to * 00004300
*      use this macro service:                                        * 00004400
*                                                                     * 00004500
*                                                                     * 00004600
*      o   JES2:                                                      * 00004700
*                                                                     * 00004800
*                                                                     * 00004900
*          -   $MODULE - must be included in the module and must have * 00005000
*              been invoked before the IXZXIXAC macro service.        * 00005100
*                                                                     * 00005200
*                                                                     * 00005300
*                                                                     * 00005400
*      o   JES3:                                                      * 00005500
*                                                                     * 00005600
*                                                                     * 00005700
*          -   IATYMOD - must be included in the module and must have * 00005800
*              been invoked before the IXZXIXAC macro service.        * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*                                                                     * 00006300
*                                                                     * 00006400
*      The following macros are used with this macro to manage the    * 00006500
*      transport of data and monitoring of system events:             * 00006600
*                                                                     * 00006700
*                                                                     * 00006800
*      o   IXZXIXMB - Build a mailbox                                 * 00006900
*                                                                     * 00007000
*      o   IXZXIXMC - Clear a mailbox                                 * 00007100
*                                                                     * 00007200
*      o   IXZXIXMD - Delete XCF Mailbox                              * 00007300
*                                                                     * 00007400
*      o   IXZXIXRM - Receive a message from a mailbox                * 00007500
*                                                                     * 00007600
*      o   IXZXIXSM - Send a message                                  * 00007700
*                                                                     * 00007800
*      o   IXZXIXIF - Obtain member information                       * 00007900
*                                                                     * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*      Requirements                                                   * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*      o   Authorization: Supervisor state - key 0 or key 1           * 00008600
*                                                                     * 00008700
*      o   Dispatchable unit mode: Task                               * 00008800
*                                                                     * 00008900
*      o   Cross memory mode: PASN = HASN = SASN                      * 00009000
*                                                                     * 00009100
*      o   AMODE: 31                                                  * 00009200
*                                                                     * 00009300
*      o   ASC mode: Primary                                          * 00009400
*                                                                     * 00009500
*      o   Serialization: Enabled for interrupts                      * 00009600
*                                                                     * 00009700
*      o   Locks:  This service assumes no locks are held by the      * 00009800
*          user.                                                      * 00009900
*                                                                     * 00010000
*      o   Control Parameters:  None                                  * 00010100
*                                                                     * 00010200
*      o   JES Environments:                                          * 00010300
*                                                                     * 00010400
*                                                                     * 00010500
*          -   JES2 Main Task                                         * 00010600
*                                                                     * 00010700
*          -   JES3 Main Task                                         * 00010800
*                                                                     * 00010900
*          -   JES2 Subtask                                           * 00011000
*                                                                     * 00011100
*          -   JES3 Subtask                                           * 00011200
*                                                                     * 00011300
*          -   JES3 FSS                                               * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*                                                                     * 00011900
*      Register Information                                           * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*      o   Input registers                                            * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*          -   R0-R15 - Undefined                                     * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*      o   Output registers                                           * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*          -   R0 - Reason code                                       * 00013300
*                                                                     * 00013400
*          -   R1 - Unpredictable                                     * 00013500
*                                                                     * 00013600
*          -   R2-R13 - Unchanged                                     * 00013700
*                                                                     * 00013800
*          -   R14 - Unpredictable                                    * 00013900
*                                                                     * 00014000
*          -   R15 - Return code                                      * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*      Programming Notes/Requirements:  The programmer must supply    * 00014700
*      the MSGTOKEN that is returned on the receive message service   * 00014800
*      IXZXIXRM.                                                      * 00014900
*                                                                     * 00015000
*      The programmer can return to the sender of a message, a one    * 00015100
*      segment of data that is specified by the DATA= keyword.  This  * 00015200
*      data is returned to the sender of the orginal message if an    * 00015300
*      acknowledgement was requested.                                 * 00015400
*                                                                     * 00015500
*      The sender of the message can retrieve the message from the    * 00015600
*      acknowledgement message buffer (field YIXAC_APPL_DATA in       * 00015700
*      IXZYIXAC contains the offset), or the segment is returned on   * 00015800
*      the IXZXIXSM macro if the call was synchronous (RESPDATA=      * 00015900
*      parameter).                                                    * 00016000
*                                                                     * 00016100
*      Restrictions                                                   * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*      o   Can not be issued until JES initialization has attached    * 00016500
*          and initializes the JES Common XCF Task.                   * 00016600
*                                                                     * 00016700
*      o   Must be done under the same task the issued the mailbox    * 00016800
*          build.                                                     * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*      Performance Implications:  This macro has minimal performance  * 00017300
*      impact, the service routine causes a subtasked function to be  * 00017400
*      performed.                                                     * 00017500
*                                                                     * 00017600
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00017700
*                                                                     * 00017800
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00017900
*                                                                     * 00018000
*01* SYNTAX:                                                          * 00018100
*                                                                     * 00018200
*Ýxlabel¨  IXZXIXAC     MSGTOKEN=xmsgtoken                            * 00018300
*                     Ý,USERRC=»xuserrc!NONEº¨                        * 00018400
*                     Ý,DATA=»xdata!0º¨                               * 00018500
*                     Ý,DATALEN=»xdatalen!0º¨                         * 00018600
*                      ,GROUPTOKEN=xgrouptoken                        * 00018700
*                     Ý,SYSRC=»xsysrc!0º¨                             * 00018800
*                     Ý,SYSRSN=»xsysrsn!0º¨                           * 00018900
*                     Ý,MSGATTR=»NONE!J3CONNECT!EXPRESSº¨             * 00019000
*                     Ý,STB=»NO!YESº¨                                 * 00019100
*                     Ý,RTNCODE=xrtncode¨                             * 00019200
*                     Ý,RSNCODE=xrsncode¨                             * 00019300
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00019400
*                    ÐÝ,MF=S¨                                         * 00019500
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00019600
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*      Where:                                                         * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*      Ýxlabel¨                                                       * 00020300
*          is an optional symbol, starting in column 1, that is the   * 00020400
*          name on the IXZXIXAC macro invocation.  The name must      * 00020500
*          conform to the rules for an ordinary assembler language    * 00020600
*          symbol.                                                    * 00020700
*          DEFAULT: No name.                                          * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*      MSGTOKEN=xmsgtoken                                             * 00021300
*          is the name (RS-type), or address in register (2)-(12), of * 00021400
*          a required 64 bit input that contains the message token    * 00021500
*          returned from the message receive service (IXZXIXRM).      * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*      ÝUSERRC=»xuserrc!NONEº¨                                        * 00022100
*          is the name (RS-type), or address in register (2)-(12), of * 00022200
*          an optional fullword input that contains a user specified  * 00022300
*          return code that is passed back to the sender of the       * 00022400
*          original message.                                          * 00022500
*          DEFAULT: NONE If you do not specify a value of USERRC=,    * 00022600
*          JES XCF returns a 0.                                       * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*                                                                     * 00023100
*      ÝDATA=»xdata!0º¨                                               * 00023200
*          is the name (RS-type), or address in register (2)-(12), of * 00023300
*          an optional 4 byte input that contains the address of the  * 00023400
*          message data that is to be returned with the               * 00023500
*          acknowledgement.  The data is only returned to the caller  * 00023600
*          if an acknowledgement was requested.                       * 00023700
*          DEFAULT: 0 No message data is to be returned to the        * 00023800
*          sender.                                                    * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*      ÝDATALEN=»xdatalen!0º¨                                         * 00024400
*          is the name (RS-type), or address in register (2)-(12), of * 00024500
*          an optional fullword input that contains the length of the * 00024600
*          message data to be sent.  This parameter is required if    * 00024700
*          the DATA= parameter is specified.                          * 00024800
*          DEFAULT: 0 No data is to be returned to the sender.        * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*      GROUPTOKEN=xgrouptoken                                         * 00025400
*          is the name (RS-type), or address in register (2)-(12), of * 00025500
*          a required fullword input that contains the JES XCF group  * 00025600
*          token.                                                     * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*      ÝSYSRC=»xsysrc!0º¨                                             * 00026200
*          is the name (RS-type), or address in register (2)-(12), of * 00026300
*          an optional fullword input that contains the system return * 00026400
*          code that is returned to the caller.  This is an internal  * 00026500
*          parameter and is not part of the General Use Programming   * 00026600
*          Interface.                                                 * 00026700
*          DEFAULT: 0                                                 * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*      ÝSYSRSN=»xsysrsn!0º¨                                           * 00027300
*          is the name (RS-type), or address in register (2)-(12), of * 00027400
*          an optional fullword input that contains the system return * 00027500
*          code that is returned to the caller.  This is an internal  * 00027600
*          parameter and is not part of the General Use Programming   * 00027700
*          Interface.                                                 * 00027800
*          DEFAULT: 0                                                 * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*      ÝMSGATTR=»NONE!J3CONNECT!EXPRESSº¨                             * 00028400
*          is an optional keyword input that assigns special          * 00028500
*          attributes to a message that is being sent. This is an     * 00028600
*          internal parameter and is not part of the general use      * 00028700
*          programming interface.                                     * 00028800
*          DEFAULT: NONE                                              * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*          MSGATTR=NONE                                               * 00029200
*              This message has no special message attributes.  This  * 00029300
*              is an internal parameter and is not part of the        * 00029400
*              general use programming interface.                     * 00029500
*                                                                     * 00029600
*          MSGATTR=J3CONNECT                                          * 00029700
*              This is a JES3 connect message. It should should be    * 00029800
*              sent to the receiver before JES3 connect processing    * 00029900
*              has completed and should be sent even if a slow down   * 00030000
*              is in progress. This is an internal parameter and is   * 00030100
*              not part of the general use programming interface.     * 00030200
*                                                                     * 00030300
*          MSGATTR=EXPRESS                                            * 00030400
*              This message should be sent, even in a buffer          * 00030500
*              constraint situation.  This is an internal parameter   * 00030600
*              and is not part of the general use programming         * 00030700
*              interface.                                             * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*      ÝSTB=»NO!YESº¨                                                 * 00031500
*          is an optional keyword input that indicates whether        * 00031600
*          acknowledgement messages should be sent to the sender, if  * 00031700
*          the system acknowledges the message.  This is an internal  * 00031800
*          parameter and is not part of the General Use Programming   * 00031900
*          Interface.                                                 * 00032000
*          DEFAULT: NO                                                * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*          STB=NO                                                     * 00032400
*              Acknowledgement messages will be sent to the sender of * 00032500
*              the original message, if the original message caused   * 00032600
*              an acknowledgement message to be generated.            * 00032700
*                                                                     * 00032800
*          STB=YES                                                    * 00032900
*              Acknowledgement messages will not be sent to the       * 00033000
*              originator of the message.                             * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*      ÝRTNCODE=xrtncode¨                                             * 00033800
*          is the name (RS-type) of an optional fullword output       * 00033900
*          variable, or register (2)-(12), into which the return code * 00034000
*          is to be copied from GPR 15.                               * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*      ÝRSNCODE=xrsncode¨                                             * 00034600
*          is the name (RS-type) of an optional fullword output       * 00034700
*          variable, or register (2)-(12), into which the reason code * 00034800
*          is to be copied from GPR 0.                                * 00034900
*                                                                     * 00035000
*                                                                     * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00035400
*          is an optional byte input decimal value in the "1-1" range * 00035500
*          that specifies the macro version.  PLISTVER is the only    * 00035600
*          key allowed on the list form of MF and determines which    * 00035700
*          parameter list is generated.  Note that MAX may be         * 00035800
*          specified instead of a number, and the parameter list will * 00035900
*          be of the largest size currently supported. This size may  * 00036000
*          grow from release to release (thus possibly affecting the  * 00036100
*          amount of storage needed by your program).  If your        * 00036200
*          program can tolerate this, IBM recommends that you always  * 00036300
*          specify MAX when creating the list form parameter list as  * 00036400
*          that will ensure that the list form parameter list is      * 00036500
*          always long enough to hold whatever parameters might be    * 00036600
*          specified on the execute form.                             * 00036700
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00036800
*          default is the lowest version which allows all of the      * 00036900
*          parameters specified on the invocation to be processed.    * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*      ÝMF=»S!L!Eº¨                                                   * 00037500
*          is an optional keyword input which specifies the macro     * 00037600
*          form.                                                      * 00037700
*          DEFAULT: S                                                 * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*          ÝMF=S¨                                                     * 00038100
*              specifies the standard form of the macro.  The "S"     * 00038200
*              form generates code to put the parameters into an      * 00038300
*              in-line parameter list and invoke the desired service. * 00038400
*              Full checking for required macro keys is done along    * 00038500
*              with supplying defaults for omitted optional           * 00038600
*              parameters.                                            * 00038700
*                                                                     * 00038800
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00038900
*              specifies the list form of the macro.  The "L" form    * 00039000
*              defines an area to be used for the parameter list.     * 00039100
*              Only the PLISTVER key may be specified on the          * 00039200
*              invocation.  All other macro parameters are flagged as * 00039300
*              errors.  If PLISTVER is not specified, the original    * 00039400
*              parameter list definition is used.                     * 00039500
*                                                                     * 00039600
*            ,xmfctrl                                                 * 00039700
*              is a required input.  It is the name of a storage area * 00039800
*              for the parameter list.                                * 00039900
*                                                                     * 00040000
*            »,xmfattr!0Dº                                            * 00040100
*              is an optional 60 character input string that varies   * 00040200
*              from 1 to 60 characters. Use it to force boundary      * 00040300
*              alignment of the parameter list. Use only 0F or 0D.    * 00040400
*              DEFAULT: 0D which forces the parameter list to a       * 00040500
*              doubleword boundary.                                   * 00040600
*                                                                     * 00040700
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00040800
*              specifies the execute form of the macro.  The "E" form * 00040900
*              generates code to put the parameters into the          * 00041000
*              parameter list specified by xmfctrl and provides full  * 00041100
*              syntax checking with default setting.                  * 00041200
*                                                                     * 00041300
*            ,xmfctrl                                                 * 00041400
*              is a required input.  It is the name (RS-type), or     * 00041500
*              address in register (1)-(12), of a storage area for    * 00041600
*              the parameter list.                                    * 00041700
*                                                                     * 00041800
*            »,COMPLETEº                                              * 00041900
*              is an optional keyword input which specifies the       * 00042000
*              degree of macro parameter syntax checking.             * 00042100
*              DEFAULT: COMPLETE                                      * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*              COMPLETE                                               * 00042500
*                  Checking for required macro keys is done and       * 00042600
*                  defaults are supplied for omitted optional         * 00042700
*                  parameters.                                        * 00042800
*                                                                     * 00042900
*                                                                     * 00043000
*                                                                     * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*01* RETURN CODES:                                                    * 00043600
*                                                                     * 00043700
*                                                                     * 00043800
*            0    Processing successful. If required an               * 00043900
*                 acknowledgment was sent.                            * 00044000
*                                                                     * 00044100
*            4    Processing did not complete due to user error.      * 00044200
*                                                                     * 00044300
*            8    Processing did not complete due to system error.    * 00044400
*                                                                     * 00044500
*            C    Processing did not complete due to a system abend.  * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*01* REASON CODES:                                                    * 00045000
*                                                                     * 00045100
*       REASON    RETURN                                              * 00045200
*       CODE      CODE      DESCRIPTION                               * 00045300
*       ××××××××  ××××××××  ×××××××××××                               * 00045400
*                                                                     * 00045500
*                                                                     * 00045600
*              0  0         Processing was sucessful, the message was * 00045700
*                           acknowledged.                             * 00045800
*                                                                     * 00045900
*              4  4         Processing failed because, the  parameter * 00046000
*                           list    passed      to  IXZXIXAC  service * 00046100
*                           routine does not have a valid eyecatcher  * 00046200
*                                                                     * 00046300
*              8  4         Processing  failed because, the parameter * 00046400
*                           list   passed  to  the  IXZXIXAC  service * 00046500
*                           routine had an invalid version indicator. * 00046600
*                           The caller may need to be recompiled.     * 00046700
*                                                                     * 00046800
*              C  4         Processing failed because, the grouptoken * 00046900
*                           passed  to  the  IXZXIXAC service routine * 00047000
*                           was not valid.                            * 00047100
*                                                                     * 00047200
*             10  4         Processing   failed  because,the  IXZIXAC * 00047300
*                           service  routine  was  called on a member * 00047400
*                           that is detaching.                        * 00047500
*                                                                     * 00047600
*             14  4         Processing  failed  because, the msgtoken * 00047700
*                           passed   to   the  IXZXIXAC  service  was * 00047800
*                           invalid or the message has been overlaid. * 00047900
*                                                                     * 00048000
*             18  4         Processing failed because, DATA was coded * 00048100
*                           without DATALEN or vice versa.            * 00048200
*                                                                     * 00048300
*             1C  4         Processing  failed because, the parameter * 00048400
*                           list   passed  to  the  IXZXIXAC  service * 00048500
*                           routine  contained an   incorrect DATALEN * 00048600
*                           value.     DATALEN  must  be  a  positive * 00048700
*                           integer up to 60 Kbytes.                  * 00048800
*                                                                     * 00048900
*              0  C         Processing  failed due to a system abend. * 00049000
*                           The request is rejected.                  * 00049100
*                                                                     * 00049200
*                                                                     * 00049300
*                                                                     * 00049400
*01* MODULE TYPE:  ASSEM MACRO                                        * 00049500
*                                                                     * 00049600
*02*   PROCESSOR:  ASSEM                                              * 00049700
*                                                                     * 00049800
*01* COMPONENT:  SCJSC                                                * 00049900
*                                                                     * 00050000
*01* MACRO USAGE NOTES:                                               * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00050400
*        global macro variable.  Any value other than 'NO' will       * 00050500
*        result in the macro expansion being printed.  The default is * 00050600
*        'YES'.  The following examples illustrate how the ZPRINT     * 00050700
*        variable should be set.                                      * 00050800
*                                                                     * 00050900
*                    GBLC &ZPRINT                                     * 00051000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*    2.  All   keys   currently   contained  in  the  IXZXIXAC  macro * 00051400
*        correspond  to  version  1.   If you specify PLISTVER, use a * 00051500
*        value of 1 or MAX.                                           * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*                                                                     * 00051900
*                                                                     * 00052000
*01* CHANGE ACTIVITY:                                                 * 00052100
*                                                                     * 00052200
*   Flag LineItem  FMID    Date   ID    Comment                       * 00052300
*                                                                     * 00052400
*    $N0=JESXCF   HBB5510 921201 PD0AL:                               * 00052500
*    $SP=JESXCF   HBB7709 031105 PD0RF:                               * 00052600
****** END OF SPECIFICATIONS *****************************************/ 00052700
*/* TLINE 1 *********************************************************** 00052800
         MACRO                                                          00052900
&XLABEL  IXZXIXAC &MSGTOKEN=,&USERRC=,&DATA=,&DATALEN=,&GROUPTOKEN=,   *00053000
               &SYSRC=,&SYSRSN=,&MSGATTR=,&STB=,&RTNCODE=,&RSNCODE=,   *00053100
               &PLISTVER=,&MF=                                          00053200
.*                                                                      00053300
*                MACDATE -11/12/03-<1>                                  00053400
.*                                                                      00053500
.*******************************************************************    00053600
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00053700
.*******************************************************************    00053800
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00053900
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00054000
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00054100
.*                                                                      00054200
                GBLC  &ZIXZXIXAC  YES=MACRO USED AT LEAST ONCE          00054300
.*******************************************************************    00054400
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00054500
.*******************************************************************    00054600
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00054700
                LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS          00054800
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00054900
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00055000
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00055100
                LCLA  &ZAWRK      USED AS A WORK AREA                   00055200
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00055300
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00055400
                LCLC  &ZC         CHARACTER WORK VARIABLE               00055500
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00055600
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00055700
                LCLC  &ZMAC_G     "G" or null                           00055800
&ZMAC_G         SETC  ''                                                00055900
                LCLC  &ZMAC_LR                                          00056000
&ZMAC_LR        SETC  'LR'                                              00056100
                LCLC  &ZMAC_L                                           00056200
&ZMAC_L         SETC  'L'                                               00056300
                LCLC  &ZMAC_ST                                          00056400
&ZMAC_ST        SETC  'ST'                                              00056500
                LCLA  &ZMACRET    MACRO RETURN CODE                     00056600
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00056700
.*                                                                      00056800
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00056900
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00057000
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00057100
                LCLC  &ZENDBASEPL               End of base PL          00057200
                LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                 00057300
.*******************************************************************    00057400
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00057500
.*******************************************************************    00057600
                LCLA  &ZI         INDEX FOR ARRAY                       00057700
                LCLA  &ZJ         INDEX FOR PARMS                       00057800
                LCLA  &ZK         INDEX FOR PARSE                       00057900
                LCLA  &ZLO        LOW RANGE VALUE                       00058000
                LCLA  &ZHI        HIGH RANGE VALUE                      00058100
                LCLC  &ZW         WORK AREA FOR PARM                    00058200
.********************************************************************   00058300
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00058400
.********************************************************************   00058500
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00058600
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00058700
                GBLA  &SYSALVL    SYSSTATE ARCHLVL                      00058800
                GBLC  &SYSAM64    SYSSTATE AMODE64                      00058900
.*                                                                      00059000
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00059100
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00059200
                SPLEVEL  TEST                                           00059300
.ZSYS2          ANOP  ,                                                 00059400
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00059500
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00059600
                SYSSTATE TEST                                           00059700
                AGO   .ZSYS4                                            00059800
.ZSYS3          ANOP  ,                                                 00059900
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00060000
.ZSYS4          ANOP  ,                                                 00060100
.*******************************************************************    00060200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00060300
.*******************************************************************    00060400
                LCLC  &XMSGTOKEN  ++ NAME                               00060500
                LCLC  &XUSERRC    ++ NAME                               00060600
                LCLC  &XDATA      ++ NAME                               00060700
                LCLC  &XDATALEN   ++ NAME                               00060800
                LCLC  &XGROUPTOKEN              ++ NAME                 00060900
                LCLC  &XSYSRC     ++ NAME                               00061000
                LCLC  &XSYSRSN    ++ NAME                               00061100
                LCLC  &XMSGATTR   ++ VALUE                              00061200
                LCLC  &XSTB       ++ VALUE                              00061300
                LCLC  &XRTNCODE   ++ NAME                               00061400
                LCLC  &XRSNCODE   ++ NAME                               00061500
                LCLA  &XPLISTVER  ++ VALUE                              00061600
                LCLC  &XMF        ++ VALUE                              00061700
                LCLC  &XMFCTRL    ++ NAME                               00061800
                LCLC  &XMFATTR    ++ VALUE                              00061900
                LCLC  &XMFSCK     ++ VALUE                              00062000
.*******************************************************************    00062100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00062200
.*******************************************************************    00062300
                LCLC  &ZXMSGTOKEN               ++ INPUT NAME           00062400
                LCLC  &ZXUSERRC   ++ INPUT NAME                         00062500
                LCLC  &ZXDATA     ++ INPUT NAME                         00062600
                LCLC  &ZXDATALEN  ++ INPUT NAME                         00062700
                LCLC  &ZXGROUPTOKEN             ++ INPUT NAME           00062800
                LCLC  &ZXSYSRC    ++ INPUT NAME                         00062900
                LCLC  &ZXSYSRSN   ++ INPUT NAME                         00063000
                LCLC  &ZXMSGATTR  ++ INPUT VALUE                        00063100
                LCLC  &ZXSTB      ++ INPUT VALUE                        00063200
                LCLC  &ZXRTNCODE  ++ OUTPUT NAME                        00063300
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00063400
                LCLC  &ZXPLISTVER               ++ INPUT VALUE          00063500
                LCLC  &ZXMF       ++ INPUT VALUE                        00063600
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00063700
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00063800
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00063900
.********************************************************************   00064000
.***AC.PLV01  PROCESS PLISTVER                                      *   00064100
.********************************************************************   00064200
&XPLISTVER      SETA  1                                                 00064300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00064400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00064500
&XPLISTVER      SETA  1                                                 00064600
.ZPLV0          ANOP  ,                                                 00064700
.*                                                                      00064800
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00064900
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00065000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00065100
.*-------------------------------------------------------------------   00065200
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00065300
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00065400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00065500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00065600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00065700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00065800
                AGO   .ZPVCK2                                           00065900
.ZPVCK3         ANOP  ,                                                 00066000
.*-------------------------------------------------------------------   00066100
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00066200
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00066300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00066400
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00066500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00066600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00066700
                AGO   .ZPVCKE                                           00066800
.ZPVCK2         ANOP  ,                                                 00066900
.*-------------------------------------------------------------------   00067000
&ZCVAL          SETC  '&PLISTVER(1)'                                    00067100
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00067200
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00067300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00067400
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00067500
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00067600
.ZPVCK6         ANOP  ,                                                 00067700
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00067800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00067900
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00068000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00068100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00068200
&XPLISTVER      SETA  1                                                 00068300
                AGO   .ZPVCKE                                           00068400
.*-------------------------------------------------------------------   00068500
.ZPVCK4A        ANOP  ,                                                 00068600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00068700
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00068800
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00068900
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00069000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00069100
                MNOTE 8,' &ZMS IS REQUIRED.'                            00069200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00069300
                AGO   .ZPVCK5                                           00069400
.ZPVCK4         ANOP  ,                                                 00069500
&XPLISTVER      SETA  &PLISTVER(1)                                      00069600
.ZPVCK5         ANOP  ,                                                 00069700
.ZPVCKE         ANOP  ,                                                 00069800
.********************************************************************   00069900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00070000
.********************************************************************   00070100
                ACTR  10000                                             00070200
.*------------------------------------------------------------------    00070300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00070400
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00070500
.*-------------------------------------------------------------------   00070600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00070700
.ZG44           ANOP  ,                                                 00070800
&ZTLC           SETC 'S'                                                00070900
                AIF   ('&MF(1)' NE '&ZTLC').ZG45                        00071000
&XMF            SETC  'S'         SET KEYWORD                           00071100
                AIF   (N'&MF LE 1).ZG44A        CK NUM                  00071200
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00071300
&ZMS            SETC  '&ZMS.&MF"'                                       00071400
&ZMS            SETC  '&ZMS "MF"'                                       00071500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00071600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00071700
.ZG44A          ANOP  ,                                                 00071800
.*-------------------------------------------------------------------   00071900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00072000
.ZG45           ANOP  ,                                                 00072100
&ZTLC           SETC 'L'                                                00072200
                AIF   ('&MF(1)' NE '&ZTLC').ZG52                        00072300
&XMF            SETC  'L'         SET KEYWORD                           00072400
                AIF   (N'&MF LE 3).ZG45A        CK NUM                  00072500
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00072600
&ZMS            SETC  '&ZMS.&MF"'                                       00072700
&ZMS            SETC  '&ZMS "MF"'                                       00072800
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00072900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00073000
.ZG45A          ANOP  ,                                                 00073100
.*-------------------------------------------------------------------   00073200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00073300
                AIF   (N'&SYSLIST NE 0).ZG45B   POSITIONALS?            00073400
                AIF   ('&MSGTOKEN' NE '').ZG45B  KEYS?                  00073500
                AIF   ('&USERRC' NE '').ZG45B   KEYS?                   00073600
                AIF   ('&DATA' NE '').ZG45B     KEYS?                   00073700
                AIF   ('&DATALEN' NE '').ZG45B  KEYS?                   00073800
                AIF   ('&GROUPTOKEN' NE '').ZG45B  KEYS?                00073900
                AIF   ('&SYSRC' NE '').ZG45B    KEYS?                   00074000
                AIF   ('&SYSRSN' NE '').ZG45B   KEYS?                   00074100
                AIF   ('&MSGATTR' NE '').ZG45B  KEYS?                   00074200
                AIF   ('&STB' NE '').ZG45B      KEYS?                   00074300
                AIF   ('&RTNCODE' NE '').ZG45B  KEYS?                   00074400
                AIF   ('&RSNCODE' NE '').ZG45B  KEYS?                   00074500
                AGO    .ZG45C     INVOCATION OKAY                       00074600
.ZG45B          ANOP  ,                                                 00074700
&ZMS            SETC  'THE "L" FORM OF "MF"'    *MFLA* MNOTE            00074800
&ZMS            SETC  '&ZMS CAN ONLY HAVE'                              00074900
&ZMS            SETC  '&ZMS THE "PLISTVER" KEY'                         00075000
                MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'            00075100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00075200
.ZG45C          ANOP  ,                                                 00075300
.*-------------------------------------------------------------------   00075400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00075500
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00075600
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00075700
                AIF   (N'&MF(2) GT 1).ZG47B     MULTI PARMS             00075800
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00075900
.ZG47B          AIF   (K'&MF(2) GT 0).ZG47C                             00076000
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00076100
&ZMS            SETC  'WHEN "L" IS SPECIFIED'   *KRQDA*                 00076200
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00076300
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00076400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00076500
.ZG47C          ANOP  ,                                                 00076600
.*-------------------------------------------------------------------   00076700
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00076800
                AIF   (K'&ZXMFCTRL LE 0).ZG47P  NOT I/O                 00076900
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG47P                    00077000
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00077100
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00077200
&ZMS            SETC  '&ZMS.&MF"'                                       00077300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00077400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00077500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00077600
.ZG47P          ANOP  ,                                                 00077700
.*-------------------------------------------------------------------   00077800
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00077900
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00078000
&XMFATTR        SETC  '0D'                                              00078100
                AIF   (K'&MF(3) LE 0).ZG50B     PARM                    00078200
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00078300
                AIF   (N'&MF(3) GT 1).ZG50B     MULTI PARMS             00078400
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00078500
.ZG50B          ANOP  ,                                                 00078600
.*-------------------------------------------------------------------   00078700
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00078800
                AIF   (K'&ZXMFATTR LE 0).ZG50P  NOT I/O                 00078900
                AIF   ('&XMFATTR'(1,1) NE '(').ZG50P                    00079000
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00079100
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00079200
&ZMS            SETC  '&ZMS.&MF"'                                       00079300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00079400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00079500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00079600
.ZG50P          ANOP  ,                                                 00079700
.*-------------------------------------------------------------------   00079800
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00079900
                AIF   (K'&ZXMFATTR LE 0).ZG50S  NOT I/O                 00080000
                AIF   (K'&XMFATTR LE 60).ZG50S  LNG OK                  00080100
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00080200
&ZMS            SETC  '"MF='      *KLNGA* MNOTE                         00080300
&ZMS            SETC  '&ZMS.&MF"'                                       00080400
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00080500
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00080600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00080700
.ZG50S          ANOP  ,                                                 00080800
.*-------------------------------------------------------------------   00080900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00081000
.ZG52           ANOP  ,                                                 00081100
&ZTLC           SETC 'E'                                                00081200
                AIF   ('&MF(1)' NE '&ZTLC').ZG60                        00081300
&XMF            SETC  'E'         SET KEYWORD                           00081400
                AIF   (N'&MF LE 3).ZG52A        CK NUM                  00081500
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00081600
&ZMS            SETC  '&ZMS.&MF"'                                       00081700
&ZMS            SETC  '&ZMS "MF"'                                       00081800
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00081900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00082000
.ZG52A          ANOP  ,                                                 00082100
.*-------------------------------------------------------------------   00082200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00082300
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00082400
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00082500
                AIF   (N'&MF(2) GT 1).ZG54B     MULTI PARMS             00082600
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00082700
.ZG54B          AIF   (K'&MF(2) GT 0).ZG54C                             00082800
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00082900
&ZMS            SETC  'WHEN "E" IS SPECIFIED'   *KRQDA*                 00083000
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00083100
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00083200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00083300
.ZG54C          ANOP  ,                                                 00083400
.*-------------------------------------------------------------------   00083500
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00083600
                AIF   (K'&ZXMFCTRL LE 0).ZG54R  NOT I/O                 00083700
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG54R                    00083800
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00083900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG54P                      00084000
                AIF   (K'&ZCGPR GT 2).ZG54Q                             00084100
                AIF   ('&ZCGPR' EQ '0').ZG54Q                           00084200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00084300
                AIF   (T'&ZCGPR NE 'N').ZG54Q   INVALID REG NAME        00084400
.ZG54P          ANOP  ,                                                 00084500
                AIF   (T'&ZCGPR NE 'N').ZG54R   NON NUMERIC             00084600
                AIF   ('&ZCGPR' LT '1').ZG54Q                           00084700
                AIF   ('&ZCGPR' LE '12').ZG54R                          00084800
.ZG54Q          ANOP  ,                                                 00084900
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00085000
&ZMS            SETC  '&ZMS.&MF"'                                       00085100
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00085200
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00085300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00085400
.ZG54R          ANOP  ,                                                 00085500
.*-------------------------------------------------------------------   00085600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00085700
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00085800
.ZG58A   AIF   ('&MF(3)' NE 'COMPLETE').ZG59A                           00085900
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00086000
.*-------------------------------------------------------------------   00086100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00086200
.ZG59A          AIF   (K'&XMFSCK GT 0).ZG59C    KEYWORD                 00086300
                AIF   (K'&MF(3) LE 0).ZG59B                             00086400
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00086500
&ZMS            SETC  '&ZMS.&MF"'                                       00086600
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00086700
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00086800
&ZMS            SETC  '&ZMS "COMPLETE".'                                00086900
                MNOTE 8,' &ZMS '                                        00087000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00087100
.ZG59B          ANOP  ,                                                 00087200
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00087300
.ZG59C          ANOP  ,                                                 00087400
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00087500
.*------------------------------------------------------------------    00087600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087700
.ZG60           ANOP  ,                                                 00087800
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00087900
                AIF   (K'&XMF GT 0).ZG60E       VALID ARG               00088000
                AIF   (T'&MF EQ 'O').ZG60D      OMITTED                 00088100
&ZASYSLNDX      SETA  0                                                 00088200
.ZG60A          ANOP  ,           POSITIONAL MACRO KEY                  00088300
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00088400
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG60C                  00088500
&ZTLC           SETC 'MF'                                               00088600
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG60A         00088700
.ZG60B          ANOP  ,                                                 00088800
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00088900
&ZMS            SETC  'THE "MF" KEY'            *KOPTA* MNOTE           00089000
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00089100
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00089200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00089300
                AGO   .ZG60E                                            00089400
.ZG60C          ANOP  ,                                                 00089500
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00089600
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00089700
&ZMS            SETC  '&ZMS.&MF"'                                       00089800
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00089900
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00090000
&ZMS            SETC  '&ZMS "S",'                                       00090100
&ZMS            SETC  '&ZMS "L",'                                       00090200
&ZMS            SETC  '&ZMS OR "E".'                                    00090300
                MNOTE 8,' &ZMS '                                        00090400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00090500
                AGO   .ZG60E                                            00090600
.ZG60D          ANOP  ,                                                 00090700
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00090800
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00090900
.ZG60E          ANOP  ,                                                 00091000
.********************************************************************   00091100
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00091200
.********************************************************************   00091300
                ACTR  10000                                             00091400
.*-------------------------------------------------------------------   00091500
.***AG.MF03 MF=(SLE)                                                    00091600
                AIF   ('&XMF' EQ 'L').ZGMFX                             00091700
.*----------------------------------------------------------------***   00091800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00091900
                AIF   (N'&MSGTOKEN LE 1).ZG2A   CK NUM                  00092000
&ZMS            SETC  '"MSGTOKEN='              *KPOSA* MNOTE           00092100
&ZMS            SETC  '&ZMS.&MSGTOKEN"'                                 00092200
&ZMS            SETC  '&ZMS "MSGTOKEN"'                                 00092300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00092400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00092500
.ZG2A           ANOP  ,                                                 00092600
.*-------------------------------------------------------------------   00092700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00092800
&ZXMSGTOKEN     SETC  'INPUT'     SET IN/OUTPUT                         00092900
&XMSGTOKEN      SETC  '&MSGTOKEN(1)'            SET XVARIABLE           00093000
                AIF   (N'&MSGTOKEN GT 1).ZG2B   MULTI PARMS             00093100
&XMSGTOKEN      SETC  '&MSGTOKEN'               SET XVARIABLE           00093200
.ZG2B           AIF   (K'&MSGTOKEN(1) GT 0).ZG2C                        00093300
&ZXMSGTOKEN     SETC  ''          RESET IN/OUTPUT                       00093400
&ZMS            SETC  ' '         *KRQDA*                               00093500
&ZMS            SETC  '&ZMS "MSGTOKEN" KEY AND ITS'                     00093600
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00093700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00093800
.ZG2C           ANOP  ,                                                 00093900
.*-------------------------------------------------------------------   00094000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00094100
                AIF   (K'&ZXMSGTOKEN LE 0).ZG2R  NOT I/O                00094200
                AIF   ('&XMSGTOKEN'(1,1) NE '(').ZG2R                   00094300
&ZCGPR          SETC  '&XMSGTOKEN'(2,K'&XMSGTOKEN-2)                    00094400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                       00094500
                AIF   (K'&ZCGPR GT 2).ZG2Q                              00094600
                AIF   ('&ZCGPR' EQ '0').ZG2Q                            00094700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00094800
                AIF   (T'&ZCGPR NE 'N').ZG2Q    INVALID REG NAME        00094900
.ZG2P           ANOP  ,                                                 00095000
                AIF   (T'&ZCGPR NE 'N').ZG2R    NON NUMERIC             00095100
                AIF   ('&ZCGPR' LT '2').ZG2Q                            00095200
                AIF   ('&ZCGPR' LE '12').ZG2R                           00095300
.ZG2Q           ANOP  ,                                                 00095400
&ZMS            SETC  '"MSGTOKEN='              *KGPRA* MNOTE           00095500
&ZMS            SETC  '&ZMS.&MSGTOKEN"'                                 00095600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00095700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00095800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00095900
.ZG2R           ANOP  ,                                                 00096000
.*----------------------------------------------------------------***   00096100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00096200
                AIF   (N'&USERRC LE 1).ZG5A     CK NUM                  00096300
&ZMS            SETC  '"USERRC='  *KPOSA* MNOTE                         00096400
&ZMS            SETC  '&ZMS.&USERRC"'                                   00096500
&ZMS            SETC  '&ZMS "USERRC"'                                   00096600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00096700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00096800
.ZG5A           ANOP  ,                                                 00096900
.*-------------------------------------------------------------------   00097000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00097100
&ZXUSERRC       SETC  'INPUT'     SET IN/OUTPUT                         00097200
&XUSERRC        SETC  'NONE'                                            00097300
                AIF   (K'&USERRC(1) LE 0).ZG5B  PARM                    00097400
&XUSERRC        SETC  '&USERRC(1)'              SET XVARIABLE           00097500
                AIF   (N'&USERRC GT 1).ZG5B     MULTI PARMS             00097600
&XUSERRC        SETC  '&USERRC'   SET XVARIABLE                         00097700
.ZG5B           ANOP  ,                                                 00097800
.*-------------------------------------------------------------------   00097900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00098000
                AIF   (K'&ZXUSERRC LE 0).ZG5R   NOT I/O                 00098100
         AIF   ('&XUSERRC' EQ 'NONE').ZG5R                              00098200
                AIF   ('&XUSERRC'(1,1) NE '(').ZG5R                     00098300
&ZCGPR          SETC  '&XUSERRC'(2,K'&XUSERRC-2)                        00098400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                       00098500
                AIF   (K'&ZCGPR GT 2).ZG5Q                              00098600
                AIF   ('&ZCGPR' EQ '0').ZG5Q                            00098700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00098800
                AIF   (T'&ZCGPR NE 'N').ZG5Q    INVALID REG NAME        00098900
.ZG5P           ANOP  ,                                                 00099000
                AIF   (T'&ZCGPR NE 'N').ZG5R    NON NUMERIC             00099100
                AIF   ('&ZCGPR' LT '2').ZG5Q                            00099200
                AIF   ('&ZCGPR' LE '12').ZG5R                           00099300
.ZG5Q           ANOP  ,                                                 00099400
&ZMS            SETC  '"USERRC='  *KGPRA* MNOTE                         00099500
&ZMS            SETC  '&ZMS.&USERRC"'                                   00099600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00099700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00099800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00099900
.ZG5R           ANOP  ,                                                 00100000
.*----------------------------------------------------------------***   00100100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00100200
                AIF   (N'&DATA LE 1).ZG8A       CK NUM                  00100300
&ZMS            SETC  '"DATA='    *KPOSA* MNOTE                         00100400
&ZMS            SETC  '&ZMS.&DATA"'                                     00100500
&ZMS            SETC  '&ZMS "DATA"'                                     00100600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00100700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00100800
.ZG8A           ANOP  ,                                                 00100900
.*-------------------------------------------------------------------   00101000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00101100
&ZXDATA         SETC  'INPUT'     SET IN/OUTPUT                         00101200
&XDATA          SETC  '0'                                               00101300
                AIF   (K'&DATA(1) LE 0).ZG8B    PARM                    00101400
&XDATA          SETC  '&DATA(1)'  SET XVARIABLE                         00101500
                AIF   (N'&DATA GT 1).ZG8B       MULTI PARMS             00101600
&XDATA          SETC  '&DATA'     SET XVARIABLE                         00101700
.ZG8B           ANOP  ,                                                 00101800
.*-------------------------------------------------------------------   00101900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00102000
                AIF   (K'&ZXDATA LE 0).ZG8R     NOT I/O                 00102100
                AIF   ('&XDATA'(1,1) NE '(').ZG8R                       00102200
&ZCGPR          SETC  '&XDATA'(2,K'&XDATA-2)                            00102300
                AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                       00102400
                AIF   (K'&ZCGPR GT 2).ZG8Q                              00102500
                AIF   ('&ZCGPR' EQ '0').ZG8Q                            00102600
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00102700
                AIF   (T'&ZCGPR NE 'N').ZG8Q    INVALID REG NAME        00102800
.ZG8P           ANOP  ,                                                 00102900
                AIF   (T'&ZCGPR NE 'N').ZG8R    NON NUMERIC             00103000
                AIF   ('&ZCGPR' LT '2').ZG8Q                            00103100
                AIF   ('&ZCGPR' LE '12').ZG8R                           00103200
.ZG8Q           ANOP  ,                                                 00103300
&ZMS            SETC  '"DATA='    *KGPRA* MNOTE                         00103400
&ZMS            SETC  '&ZMS.&DATA"'                                     00103500
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00103600
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00103700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00103800
.ZG8R           ANOP  ,                                                 00103900
.*----------------------------------------------------------------***   00104000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00104100
                AIF   (N'&DATALEN LE 1).ZG11A   CK NUM                  00104200
&ZMS            SETC  '"DATALEN='               *KPOSA* MNOTE           00104300
&ZMS            SETC  '&ZMS.&DATALEN"'                                  00104400
&ZMS            SETC  '&ZMS "DATALEN"'                                  00104500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00104600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00104700
.ZG11A          ANOP  ,                                                 00104800
.*-------------------------------------------------------------------   00104900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00105000
&ZXDATALEN      SETC  'INPUT'     SET IN/OUTPUT                         00105100
&XDATALEN       SETC  '0'                                               00105200
                AIF   (K'&DATALEN(1) LE 0).ZG11B  PARM                  00105300
&XDATALEN       SETC  '&DATALEN(1)'             SET XVARIABLE           00105400
                AIF   (N'&DATALEN GT 1).ZG11B   MULTI PARMS             00105500
&XDATALEN       SETC  '&DATALEN'  SET XVARIABLE                         00105600
.ZG11B          ANOP  ,                                                 00105700
.*-------------------------------------------------------------------   00105800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00105900
                AIF   (K'&ZXDATALEN LE 0).ZG11R  NOT I/O                00106000
                AIF   ('&XDATALEN'(1,1) NE '(').ZG11R                   00106100
&ZCGPR          SETC  '&XDATALEN'(2,K'&XDATALEN-2)                      00106200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                      00106300
                AIF   (K'&ZCGPR GT 2).ZG11Q                             00106400
                AIF   ('&ZCGPR' EQ '0').ZG11Q                           00106500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00106600
                AIF   (T'&ZCGPR NE 'N').ZG11Q   INVALID REG NAME        00106700
.ZG11P          ANOP  ,                                                 00106800
                AIF   (T'&ZCGPR NE 'N').ZG11R   NON NUMERIC             00106900
                AIF   ('&ZCGPR' LT '2').ZG11Q                           00107000
                AIF   ('&ZCGPR' LE '12').ZG11R                          00107100
.ZG11Q          ANOP  ,                                                 00107200
&ZMS            SETC  '"DATALEN='               *KGPRA* MNOTE           00107300
&ZMS            SETC  '&ZMS.&DATALEN"'                                  00107400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00107500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00107600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00107700
.ZG11R          ANOP  ,                                                 00107800
.*----------------------------------------------------------------***   00107900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00108000
                AIF   (N'&GROUPTOKEN LE 1).ZG14A  CK NUM                00108100
&ZMS            SETC  '"GROUPTOKEN='            *KPOSA* MNOTE           00108200
&ZMS            SETC  '&ZMS.&GROUPTOKEN"'                               00108300
&ZMS            SETC  '&ZMS "GROUPTOKEN"'                               00108400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00108500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00108600
.ZG14A          ANOP  ,                                                 00108700
.*-------------------------------------------------------------------   00108800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00108900
&ZXGROUPTOKEN   SETC  'INPUT'     SET IN/OUTPUT                         00109000
&XGROUPTOKEN    SETC  '&GROUPTOKEN(1)'          SET XVARIABLE           00109100
                AIF   (N'&GROUPTOKEN GT 1).ZG14B  MULTI PARMS           00109200
&XGROUPTOKEN    SETC  '&GROUPTOKEN'             SET XVARIABLE           00109300
.ZG14B          AIF   (K'&GROUPTOKEN(1) GT 0).ZG14C                     00109400
&ZXGROUPTOKEN   SETC  ''          RESET IN/OUTPUT                       00109500
&ZMS            SETC  ' '         *KRQDA*                               00109600
&ZMS            SETC  '&ZMS "GROUPTOKEN" KEY AND ITS'                   00109700
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00109800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00109900
.ZG14C          ANOP  ,                                                 00110000
.*-------------------------------------------------------------------   00110100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00110200
                AIF   (K'&ZXGROUPTOKEN LE 0).ZG14R  NOT I/O             00110300
                AIF   ('&XGROUPTOKEN'(1,1) NE '(').ZG14R                00110400
&ZCGPR          SETC  '&XGROUPTOKEN'(2,K'&XGROUPTOKEN-2)                00110500
                AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                      00110600
                AIF   (K'&ZCGPR GT 2).ZG14Q                             00110700
                AIF   ('&ZCGPR' EQ '0').ZG14Q                           00110800
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00110900
                AIF   (T'&ZCGPR NE 'N').ZG14Q   INVALID REG NAME        00111000
.ZG14P          ANOP  ,                                                 00111100
                AIF   (T'&ZCGPR NE 'N').ZG14R   NON NUMERIC             00111200
                AIF   ('&ZCGPR' LT '2').ZG14Q                           00111300
                AIF   ('&ZCGPR' LE '12').ZG14R                          00111400
.ZG14Q          ANOP  ,                                                 00111500
&ZMS            SETC  '"GROUPTOKEN='            *KGPRA* MNOTE           00111600
&ZMS            SETC  '&ZMS.&GROUPTOKEN"'                               00111700
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00111800
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00111900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00112000
.ZG14R          ANOP  ,                                                 00112100
.*----------------------------------------------------------------***   00112200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00112300
                AIF   (N'&SYSRC LE 1).ZG17A     CK NUM                  00112400
&ZMS            SETC  '"SYSRC='   *KPOSA* MNOTE                         00112500
&ZMS            SETC  '&ZMS.&SYSRC"'                                    00112600
&ZMS            SETC  '&ZMS "SYSRC"'                                    00112700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00112800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00112900
.ZG17A          ANOP  ,                                                 00113000
.*-------------------------------------------------------------------   00113100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00113200
&ZXSYSRC        SETC  'INPUT'     SET IN/OUTPUT                         00113300
&XSYSRC         SETC  '0'                                               00113400
                AIF   (K'&SYSRC(1) LE 0).ZG17B  PARM                    00113500
&XSYSRC         SETC  '&SYSRC(1)'               SET XVARIABLE           00113600
                AIF   (N'&SYSRC GT 1).ZG17B     MULTI PARMS             00113700
&XSYSRC         SETC  '&SYSRC'    SET XVARIABLE                         00113800
.ZG17B          ANOP  ,                                                 00113900
.*-------------------------------------------------------------------   00114000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00114100
                AIF   (K'&ZXSYSRC LE 0).ZG17R   NOT I/O                 00114200
                AIF   ('&XSYSRC'(1,1) NE '(').ZG17R                     00114300
&ZCGPR          SETC  '&XSYSRC'(2,K'&XSYSRC-2)                          00114400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                      00114500
                AIF   (K'&ZCGPR GT 2).ZG17Q                             00114600
                AIF   ('&ZCGPR' EQ '0').ZG17Q                           00114700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00114800
                AIF   (T'&ZCGPR NE 'N').ZG17Q   INVALID REG NAME        00114900
.ZG17P          ANOP  ,                                                 00115000
                AIF   (T'&ZCGPR NE 'N').ZG17R   NON NUMERIC             00115100
                AIF   ('&ZCGPR' LT '2').ZG17Q                           00115200
                AIF   ('&ZCGPR' LE '12').ZG17R                          00115300
.ZG17Q          ANOP  ,                                                 00115400
&ZMS            SETC  '"SYSRC='   *KGPRA* MNOTE                         00115500
&ZMS            SETC  '&ZMS.&SYSRC"'                                    00115600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00115700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00115800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00115900
.ZG17R          ANOP  ,                                                 00116000
.*----------------------------------------------------------------***   00116100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00116200
                AIF   (N'&SYSRSN LE 1).ZG20A    CK NUM                  00116300
&ZMS            SETC  '"SYSRSN='  *KPOSA* MNOTE                         00116400
&ZMS            SETC  '&ZMS.&SYSRSN"'                                   00116500
&ZMS            SETC  '&ZMS "SYSRSN"'                                   00116600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00116700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00116800
.ZG20A          ANOP  ,                                                 00116900
.*-------------------------------------------------------------------   00117000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00117100
&ZXSYSRSN       SETC  'INPUT'     SET IN/OUTPUT                         00117200
&XSYSRSN        SETC  '0'                                               00117300
                AIF   (K'&SYSRSN(1) LE 0).ZG20B  PARM                   00117400
&XSYSRSN        SETC  '&SYSRSN(1)'              SET XVARIABLE           00117500
                AIF   (N'&SYSRSN GT 1).ZG20B    MULTI PARMS             00117600
&XSYSRSN        SETC  '&SYSRSN'   SET XVARIABLE                         00117700
.ZG20B          ANOP  ,                                                 00117800
.*-------------------------------------------------------------------   00117900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00118000
                AIF   (K'&ZXSYSRSN LE 0).ZG20R  NOT I/O                 00118100
                AIF   ('&XSYSRSN'(1,1) NE '(').ZG20R                    00118200
&ZCGPR          SETC  '&XSYSRSN'(2,K'&XSYSRSN-2)                        00118300
                AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                      00118400
                AIF   (K'&ZCGPR GT 2).ZG20Q                             00118500
                AIF   ('&ZCGPR' EQ '0').ZG20Q                           00118600
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00118700
                AIF   (T'&ZCGPR NE 'N').ZG20Q   INVALID REG NAME        00118800
.ZG20P          ANOP  ,                                                 00118900
                AIF   (T'&ZCGPR NE 'N').ZG20R   NON NUMERIC             00119000
                AIF   ('&ZCGPR' LT '2').ZG20Q                           00119100
                AIF   ('&ZCGPR' LE '12').ZG20R                          00119200
.ZG20Q          ANOP  ,                                                 00119300
&ZMS            SETC  '"SYSRSN='  *KGPRA* MNOTE                         00119400
&ZMS            SETC  '&ZMS.&SYSRSN"'                                   00119500
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00119600
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00119700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00119800
.ZG20R          ANOP  ,                                                 00119900
.*----------------------------------------------------------------***   00120000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120100
                AIF   (N'&MSGATTR LE 1).ZG23A   CK NUM                  00120200
&ZMS            SETC  '"MSGATTR='               *KPOSA* MNOTE           00120300
&ZMS            SETC  '&ZMS.&MSGATTR"'                                  00120400
&ZMS            SETC  '&ZMS "MSGATTR"'                                  00120500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00120600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00120700
.ZG23A          ANOP  ,                                                 00120800
.*-------------------------------------------------------------------   00120900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121000
&XMSGATTR       SETC  ''          INITIALIZE XVARIABLE                  00121100
.ZG24A   AIF   ('&MSGATTR(1)' NE 'NONE').ZG25A                          00121200
&XMSGATTR       SETC  'NONE'      SET KEYWORD                           00121300
.*-------------------------------------------------------------------   00121400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121500
.ZG25A   AIF   ('&MSGATTR(1)' NE 'J3CONNECT').ZG26A                     00121600
&XMSGATTR       SETC  'J3CONNECT'               SET KEYWORD             00121700
.*-------------------------------------------------------------------   00121800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121900
.ZG26A   AIF   ('&MSGATTR(1)' NE 'EXPRESS').ZG27A                       00122000
&XMSGATTR       SETC  'EXPRESS'   SET KEYWORD                           00122100
.*-------------------------------------------------------------------   00122200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00122300
.ZG27A          AIF   (K'&XMSGATTR GT 0).ZG27C  KEYWORD                 00122400
                AIF   (K'&MSGATTR(1) LE 0).ZG27B                        00122500
&ZMS            SETC  '"MSGATTR='               *KUKWA* MNOTE           00122600
&ZMS            SETC  '&ZMS.&MSGATTR"'                                  00122700
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00122800
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00122900
&ZMS            SETC  '&ZMS "NONE",'                                    00123000
&ZMS            SETC  '&ZMS "J3CONNECT",'                               00123100
&ZMS            SETC  '&ZMS OR "EXPRESS".'                              00123200
                MNOTE 8,' &ZMS '                                        00123300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00123400
.ZG27B          ANOP  ,                                                 00123500
&XMSGATTR       SETC  'NONE'      SET DEFAULT KEYWORD                   00123600
.ZG27C          ANOP  ,                                                 00123700
&ZXMSGATTR      SETC  'INPUT'     SET IN/OUTPUT                         00123800
.*----------------------------------------------------------------***   00123900
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00124000
                AIF   (N'&STB LE 1).ZG29A       CK NUM                  00124100
&ZMS            SETC  '"STB='     *KPOSA* MNOTE                         00124200
&ZMS            SETC  '&ZMS.&STB"'                                      00124300
&ZMS            SETC  '&ZMS "STB"'                                      00124400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00124500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00124600
.ZG29A          ANOP  ,                                                 00124700
.*-------------------------------------------------------------------   00124800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00124900
&XSTB           SETC  ''          INITIALIZE XVARIABLE                  00125000
.ZG30A   AIF   ('&STB(1)' NE 'NO').ZG31A                                00125100
&XSTB           SETC  'NO'        SET KEYWORD                           00125200
.*-------------------------------------------------------------------   00125300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00125400
.ZG31A   AIF   ('&STB(1)' NE 'YES').ZG32A                               00125500
&XSTB           SETC  'YES'       SET KEYWORD                           00125600
.*-------------------------------------------------------------------   00125700
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00125800
.ZG32A          AIF   (K'&XSTB GT 0).ZG32C      KEYWORD                 00125900
                AIF   (K'&STB(1) LE 0).ZG32B                            00126000
&ZMS            SETC  '"STB='     *KUKWA* MNOTE                         00126100
&ZMS            SETC  '&ZMS.&STB"'                                      00126200
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00126300
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00126400
&ZMS            SETC  '&ZMS "NO"'                                       00126500
&ZMS            SETC  '&ZMS OR "YES".'                                  00126600
                MNOTE 8,' &ZMS '                                        00126700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00126800
.ZG32B          ANOP  ,                                                 00126900
&XSTB           SETC  'NO'        SET DEFAULT KEYWORD                   00127000
.ZG32C          ANOP  ,                                                 00127100
&ZXSTB          SETC  'INPUT'     SET IN/OUTPUT                         00127200
.*----------------------------------------------------------------***   00127300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00127400
                AIF   (N'&RTNCODE LE 1).ZG34A   CK NUM                  00127500
&ZMS            SETC  '"RTNCODE='               *KPOSA* MNOTE           00127600
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00127700
&ZMS            SETC  '&ZMS "RTNCODE"'                                  00127800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00127900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00128000
.ZG34A          ANOP  ,                                                 00128100
.*-------------------------------------------------------------------   00128200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00128300
                AIF   (K'&RTNCODE(1) LE 0).ZG34C  NO PARM               00128400
&ZXRTNCODE      SETC  'OUTPUT'    SET OUTPUT                            00128500
&XRTNCODE       SETC  '&RTNCODE(1)'             SET XVARIABLE           00128600
                AIF   (N'&RTNCODE GT 1).ZG34C                           00128700
&XRTNCODE       SETC  '&RTNCODE'  SET XVARIABLE                         00128800
.ZG34C          ANOP  ,                                                 00128900
.*-------------------------------------------------------------------   00129000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00129100
                AIF   (K'&ZXRTNCODE LE 0).ZG34R  NOT I/O                00129200
                AIF   ('&XRTNCODE'(1,1) NE '(').ZG34R                   00129300
&ZCGPR          SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                      00129400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                      00129500
                AIF   (K'&ZCGPR GT 2).ZG34Q                             00129600
                AIF   ('&ZCGPR' EQ '0').ZG34Q                           00129700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00129800
                AIF   (T'&ZCGPR NE 'N').ZG34Q   INVALID REG NAME        00129900
.ZG34P          ANOP  ,                                                 00130000
                AIF   (T'&ZCGPR NE 'N').ZG34R   NON NUMERIC             00130100
                AIF   ('&ZCGPR' LT '2').ZG34Q                           00130200
                AIF   ('&ZCGPR' LE '12').ZG34R                          00130300
.ZG34Q          ANOP  ,                                                 00130400
&ZMS            SETC  '"RTNCODE='               *KGPRA* MNOTE           00130500
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00130600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00130700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00130800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00130900
.ZG34R          ANOP  ,                                                 00131000
.*----------------------------------------------------------------***   00131100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00131200
                AIF   (N'&RSNCODE LE 1).ZG37A   CK NUM                  00131300
&ZMS            SETC  '"RSNCODE='               *KPOSA* MNOTE           00131400
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00131500
&ZMS            SETC  '&ZMS "RSNCODE"'                                  00131600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00131700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00131800
.ZG37A          ANOP  ,                                                 00131900
.*-------------------------------------------------------------------   00132000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00132100
                AIF   (K'&RSNCODE(1) LE 0).ZG37C  NO PARM               00132200
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            00132300
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           00132400
                AIF   (N'&RSNCODE GT 1).ZG37C                           00132500
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         00132600
.ZG37C          ANOP  ,                                                 00132700
.*-------------------------------------------------------------------   00132800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00132900
                AIF   (K'&ZXRSNCODE LE 0).ZG37R  NOT I/O                00133000
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG37R                   00133100
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      00133200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                      00133300
                AIF   (K'&ZCGPR GT 2).ZG37Q                             00133400
                AIF   ('&ZCGPR' EQ '0').ZG37Q                           00133500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00133600
                AIF   (T'&ZCGPR NE 'N').ZG37Q   INVALID REG NAME        00133700
.ZG37P          ANOP  ,                                                 00133800
                AIF   (T'&ZCGPR NE 'N').ZG37R   NON NUMERIC             00133900
                AIF   ('&ZCGPR' LT '2').ZG37Q                           00134000
                AIF   ('&ZCGPR' LE '12').ZG37R                          00134100
.ZG37Q          ANOP  ,                                                 00134200
&ZMS            SETC  '"RSNCODE='               *KGPRA* MNOTE           00134300
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00134400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00134500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00134600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00134700
.ZG37R          ANOP  ,                                                 00134800
.******************************************************************     00134900
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00135000
.******************************************************************     00135100
                ACTR  10000                                             00135200
.*----------------------------------------------------------------***   00135300
.***AH.P02 EXTRA POSITIONALS                                            00135400
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00135500
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00135600
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00135700
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00135800
.ZGLISTX1       ANOP  ,                                                 00135900
&ZCVAL          SETC  ''          ERROR FIELD                           00136000
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00136100
.ZGLIST2        ANOP  ,                                                 00136200
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00136300
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00136400
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00136500
                AGO   .ZGLIST2                                          00136600
.*                                                                      00136700
.ZGLIST3        ANOP  ,                                                 00136800
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00136900
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          00137000
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00137100
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00137200
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00137300
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00137400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00137500
.ZGLISTX        ANOP  ,                                                 00137600
&ZASYSLNDX      SETA  0                                                 00137700
.*-------------------------------------------------------------------   00137800
.***AG.MF04 MF=(SLE)                                                    00137900
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00138000
.*******************************************************************    00138100
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00138200
.*******************************************************************    00138300
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00138400
.*******************************************************************    00138500
.***AE.01  START OF IXZXIXAC MACRO CODE                                 00138600
.*******************************************************************    00138700
                LCLC  &M0M0001                 NAME                     00138800
&M0M0001        SETC  '&XLABEL'                SET NAME                 00138900
                AIF   (K'&XLABEL NE 0).XLAB2                            00139000
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00139100
.*                                                                      00139200
.XLAB2          ANOP  ,                                                 00139300
                AIF   ('&XMF' EQ 'L').XLAB3                             00139400
&M0M0001 DS    0H                             IXZXIXAC-1                00139500
.XLAB3          ANOP  ,                                                 00139600
.*******************************************************************    00139700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00139800
.*******************************************************************    00139900
              PUSH  PRINT                                               00140000
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00140100
                PRINT OFF         ++ PR01                               00140200
                AGO   .ZPRNTXX                                          00140300
.ZPRINTX        PRINT ON                                                00140400
.ZPRNTXX        ANOP  ,                                                 00140500
.********************************************************************   00140600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00140700
.********************************************************************   00140800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00140900
                      LCLA  &ZOPN1         INVOCATION INDEX             00141000
                      LCLC  &ZOPL(4095)    LABEL                        00141100
                      LCLC  &ZOPO(4095)    OPERATION                    00141200
                      LCLC  &ZOPV(4095)    VALUE                        00141300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00141400
.*                                                                      00141500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00141600
.******************************************************************     00141700
.***AL.L10 IXZXIXAC FMT=LIST MF=S!L PARAMETERS                          00141800
.******************************************************************     00141900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00142000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00142100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00142200
&XMFATTR              SETC  '0D'                                        00142300
.*                                                                      00142400
&ZOPN                 SETA  &ZOPN+1                                     00142500
&ZOPL(&ZOPN)          SETC  ' '                                         00142600
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00142700
&ZOPO(&ZOPN)          SETC  'B'                                         00142800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00142900
                      AGO   .ZALVL6B                                    00143000
.ZALVL6A              ANOP                                              00143100
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00143200
&ZOPV(&ZOPN)          SETC  '4,8'                                       00143300
&ZOPN                 SETA  &ZOPN+1                                     00143400
&ZOPL(&ZOPN)          SETC  ' '                                         00143500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00143600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00143700
.ZALVL6B              ANOP                                              00143800
&ZOPD(&ZOPN)          SETC  '++ IXZXIXAC ARG PARMS'                     00143900
.*                                                                      00144000
&ZOPN                 SETA  &ZOPN+1                                     00144100
&ZOPL(&ZOPN)          SETC  ' '                                         00144200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00144300
&ZOPV(&ZOPN)          SETC  '1'                                         00144400
&ZOPD(&ZOPN)          SETC  ' '                                         00144500
.*                                                                      00144600
.ZLMFSL2              ANOP  ,                                           00144700
.*-------------------------------------------------------------------   00144800
.***AM.L00  IXZXIXAC FMT=LIST name                                      00144900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00145000
&ZOPN                 SETA &ZOPN+1                                      00145100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00145200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00145300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00145400
&ZOPD(&ZOPN)          SETC '++ IXZXIXAC NAME'                           00145500
.ZLMFSL2M             ANOP  ,                                           00145600
.*-------------------------------------------------------------------   00145700
.***AM.L01  IXZXIXAC FMT=LIST PARAMETERS                                00145800
&ZOPN                 SETA &ZOPN+1                                      00145900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00146000
&ZOPO(&ZOPN)          SETC 'DS'                                         00146100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00146200
&ZOPD(&ZOPN)          SETC '++ IXZXIXAC PARM LIST'                      00146300
.*-------------------------------------------------------------------   00146400
.***AM.L02 XVERSION XL1                                                 00146500
&ZOPN                 SETA &ZOPN+1                                      00146600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00146700
&ZOPO(&ZOPN)          SETC 'DS'                                         00146800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00146900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00147000
.*-------------------------------------------------------------------   00147100
.***AM.L09  XEYECATCH CL6                                               00147200
&ZOPN                 SETA &ZOPN+1                                      00147300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEYECATCH'                        00147400
&ZOPO(&ZOPN)          SETC 'DS'                                         00147500
&ZOPV(&ZOPN)          SETC 'CL6'                                        00147600
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XEYECATCH'                     00147700
.*-------------------------------------------------------------------   00147800
.***AM.L03 XSTB BL.8                                                    00147900
&ZOPN                 SETA &ZOPN+1                                      00148000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTB'                             00148100
&ZOPO(&ZOPN)          SETC 'DS'                                         00148200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00148300
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00148400
.*                                                                      00148500
&ZOPN                 SETA  &ZOPN+1                                     00148600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTB_NO'                         00148700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00148800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00148900
&ZOPD(&ZOPN)          SETC  '++ XSTB.'                                  00149000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           00149100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00149200
.*                                                                      00149300
&ZOPN                 SETA  &ZOPN+1                                     00149400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTB_YES'                        00149500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00149600
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00149700
&ZOPD(&ZOPN)          SETC  '++ XSTB.'                                  00149800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00149900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00150000
.*-------------------------------------------------------------------   00150100
.***AM.L09  XMSGTOKEN BL.64                                             00150200
&ZOPN                 SETA &ZOPN+1                                      00150300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMSGTOKEN'                        00150400
&ZOPO(&ZOPN)          SETC 'DS'                                         00150500
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00150600
&ZOPD(&ZOPN)          SETC '++ &ZXMSGTOKEN  XMSGTOKEN'                  00150700
.*-------------------------------------------------------------------   00150800
.***AM.L09  XDATA A                                                     00150900
&ZOPN                 SETA &ZOPN+1                                      00151000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATA'                            00151100
&ZOPO(&ZOPN)          SETC 'DS'                                         00151200
&ZOPV(&ZOPN)          SETC 'A'                                          00151300
&ZOPD(&ZOPN)          SETC '++ &ZXDATA  XDATA'                          00151400
.*-------------------------------------------------------------------   00151500
.***AM.L09  XDATALEN F                                                  00151600
&ZOPN                 SETA &ZOPN+1                                      00151700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATALEN'                         00151800
&ZOPO(&ZOPN)          SETC 'DS'                                         00151900
&ZOPV(&ZOPN)          SETC 'F'                                          00152000
&ZOPD(&ZOPN)          SETC '++ &ZXDATALEN  XDATALEN'                    00152100
.*-------------------------------------------------------------------   00152200
.***AM.L09  XUSERRC F                                                   00152300
&ZOPN                 SETA &ZOPN+1                                      00152400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERRC'                          00152500
&ZOPO(&ZOPN)          SETC 'DS'                                         00152600
&ZOPV(&ZOPN)          SETC 'F'                                          00152700
&ZOPD(&ZOPN)          SETC '++ &ZXUSERRC  XUSERRC'                      00152800
.*-------------------------------------------------------------------   00152900
.***AM.L09  XGROUPTOKEN F                                               00153000
&ZOPN                 SETA &ZOPN+1                                      00153100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGROUPTOKEN'                      00153200
&ZOPO(&ZOPN)          SETC 'DS'                                         00153300
&ZOPV(&ZOPN)          SETC 'F'                                          00153400
&ZOPD(&ZOPN)          SETC '++ &ZXGROUPTOKEN  XGROUPTOKEN'              00153500
.*-------------------------------------------------------------------   00153600
.***AM.L09  XSYSRC F                                                    00153700
&ZOPN                 SETA &ZOPN+1                                      00153800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSRC'                           00153900
&ZOPO(&ZOPN)          SETC 'DS'                                         00154000
&ZOPV(&ZOPN)          SETC 'F'                                          00154100
&ZOPD(&ZOPN)          SETC '++ &ZXSYSRC  XSYSRC'                        00154200
.*-------------------------------------------------------------------   00154300
.***AM.L09  XSYSRSN F                                                   00154400
&ZOPN                 SETA &ZOPN+1                                      00154500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSRSN'                          00154600
&ZOPO(&ZOPN)          SETC 'DS'                                         00154700
&ZOPV(&ZOPN)          SETC 'F'                                          00154800
&ZOPD(&ZOPN)          SETC '++ &ZXSYSRSN  XSYSRSN'                      00154900
.*-------------------------------------------------------------------   00155000
.***AM.L03 XKEYS BL.8                                                   00155100
&ZOPN                 SETA &ZOPN+1                                      00155200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEYS'                            00155300
&ZOPO(&ZOPN)          SETC 'DS'                                         00155400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00155500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00155600
.*                                                                      00155700
&ZOPN                 SETA  &ZOPN+1                                     00155800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DATA'                    00155900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00156000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00156100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00156200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DATA'                         00156300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00156400
.*                                                                      00156500
&ZOPN                 SETA  &ZOPN+1                                     00156600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_DATALEN'                 00156700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00156800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00156900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00157000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DATALEN'                      00157100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00157200
.*                                                                      00157300
&ZOPN                 SETA  &ZOPN+1                                     00157400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_USERRC'                  00157500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00157600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00157700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00157800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).USERRC'                       00157900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00158000
.*                                                                      00158100
&ZOPN                 SETA  &ZOPN+1                                     00158200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SYSRC'                   00158300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00158400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00158500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00158600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SYSRC'                        00158700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00158800
.*                                                                      00158900
&ZOPN                 SETA  &ZOPN+1                                     00159000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SYSRSN'                  00159100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00159200
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00159300
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00159400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SYSRSN'                       00159500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00159600
.*-------------------------------------------------------------------   00159700
.***AM.L03 XMSGATTR BL.8                                                00159800
&ZOPN                 SETA &ZOPN+1                                      00159900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMSGATTR'                         00160000
&ZOPO(&ZOPN)          SETC 'DS'                                         00160100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00160200
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00160300
.*                                                                      00160400
&ZOPN                 SETA  &ZOPN+1                                     00160500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMSGATTR_J3CONNECT'              00160600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00160700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00160800
&ZOPD(&ZOPN)          SETC  '++ XMSGATTR.'                              00160900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).J3CONNECT'                    00161000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00161100
.*                                                                      00161200
&ZOPN                 SETA  &ZOPN+1                                     00161300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMSGATTR_EXPRESS'                00161400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00161500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00161600
&ZOPD(&ZOPN)          SETC  '++ XMSGATTR.'                              00161700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EXPRESS'                      00161800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00161900
.*-------------------------------------------------------------------   00162000
.***AM.L10 END OF IXZXIXAC LIST PARAMETERS                              00162100
&ZOPN                 SETA &ZOPN+1                                      00162200
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00162300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00162400
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00162500
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00162600
.*                                                                      00162700
&ZOPN                 SETA &ZOPN+1                                      00162800
&ZOPL(&ZOPN)          SETC ' '                                          00162900
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00163000
&ZOPV(&ZOPN)          SETC '1'                                          00163100
&ZOPD(&ZOPN)          SETC ' '                                          00163200
.*-------------------------------------------------------------------   00163300
.***AL.L12 IXZXIXAC FMT=LIST MF=S!L PARAMETERS                          00163400
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00163500
.*                                                                      00163600
&ZOPN                 SETA  &ZOPN+1                                     00163700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00163800
&ZOPO(&ZOPN)          SETC  'DC'                                        00163900
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00164000
&ZOPD(&ZOPN)          SETC  '++ IXZXIXAC ARG PARMS'                     00164100
.*                                                                      00164200
.ZLMFSLX              ANOP  ,                                           00164300
.*-------------------------------------------------------------------   00164400
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00164500
&ZPLLEN               SETA 42                                           00164600
.*                                                                      00164700
.******************************************************************     00164800
.***AI.L01 IXZXIXAC FMT=LIST FILL IN PARAMETER AREA                     00164900
.******************************************************************     00165000
                      ACTR  10000                                       00165100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00165200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00165300
&ZCVAL                SETC  'LAE'          XAX MODE                     00165400
.ZIMFXA               ANOP ,                                            00165500
.*                                                                      00165600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00165700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00165800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00165900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00166000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00166100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00166200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00166300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00166400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00166500
&ZOPN                 SETA  &ZOPN+1                                     00166600
&ZOPL(&ZOPN)          SETC  ' '                                         00166700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00166800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00166900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00167000
                      AGO   .ZIMFNX                                     00167100
.*                                                                      00167200
.ZIMFN2               ANOP ,                                            00167300
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00167400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00167500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00167600
&ZOPN                 SETA  &ZOPN+1                                     00167700
&ZOPL(&ZOPN)          SETC  ' '                                         00167800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00167900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00168000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00168100
                      AGO   .ZIMFNX                                     00168200
.ZIMFNX1              ANOP ,                                            00168300
&ZOPN                 SETA  &ZOPN+1                                     00168400
&ZOPL(&ZOPN)          SETC  ' '                                         00168500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00168600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00168700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00168800
.ZIMFNX               ANOP ,                                            00168900
.********************************************************************   00169000
.***AI.L02 IXZXIXAC FMT=LIST INITIALIZE PARAMETER AREA                  00169100
.********************************************************************   00169200
.***AI.L03 MF=(SLE)                                                     00169300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00169400
.*                                                                      00169500
&ZOPN                 SETA  &ZOPN+1                                     00169600
&ZOPL(&ZOPN)          SETC  ' '                                         00169700
&ZOPO(&ZOPN)          SETC  'XC'                                        00169800
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00169900
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00170000
.ZIMFLX               ANOP  ,                                           00170100
.*-------------------------------------------------------------------   00170200
.***AI.L04B XVERSION XL1                                                00170300
                      AIF   (&XPLISTVER EQ 0).ZIMFVZ                    00170400
&ZOPN                 SETA  &ZOPN+1                                     00170500
&ZOPL(&ZOPN)          SETC  ' '                                         00170600
&ZOPO(&ZOPN)          SETC  'MVI'                                       00170700
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00170800
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00170900
.ZIMFVZ               ANOP  ,                                           00171000
.*-------------------------------------------------------------------   00171100
.***AI.L60 XEYECATCH CL6                                                00171200
&ZOPN                 SETA  &ZOPN+1                                     00171300
&ZOPL(&ZOPN)          SETC  ' '                                         00171400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00171500
&ZOPV(&ZOPN)          SETC  '1(6,1),=CL6''YIXAC '''                     00171600
&ZOPD(&ZOPN)          SETC  '++ CL6 CONSTANT'                           00171700
.*-------------------------------------------------------------------   00171800
.***AI.L05 XSTB BL1                                                     00171900
&ZW                   SETC  ''                                          00172000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00172100
.*-------------------------------------------------------------------   00172200
.***AI.L08 XSTB "NO"                                                    00172300
.***      BL1'1XXXXXXX'                                                 00172400
         AIF   ('&XSTB' NE 'NO').ZI4A                                   00172500
&ZW                   SETC  '&ZW.1'                                     00172600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00172700
                      AGO   .ZI4C                                       00172800
.*                                                                      00172900
.ZI4A                 ANOP  ,                                           00173000
&ZW                   SETC  '&ZW.0'                                     00173100
.ZI4C                 ANOP  ,                                           00173200
.*-------------------------------------------------------------------   00173300
.***AI.L08 XSTB "YES"                                                   00173400
.***      BL1'X1XXXXXX'                                                 00173500
         AIF   ('&XSTB' NE 'YES').ZI5A                                  00173600
&ZW                   SETC  '&ZW.1000000'                               00173700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00173800
                      AGO   .ZI5C                                       00173900
.*                                                                      00174000
.ZI5A                 ANOP  ,                                           00174100
&ZW                   SETC  '&ZW.0000000'                               00174200
.ZI5C                 ANOP  ,                                           00174300
.*-------------------------------------------------------------------   00174400
.***AI.L11 XSTB BL1                                                     00174500
                      AIF   ('&ZCLNG' NE 'YES').ZI5E  ALL ZERO BITS     00174600
&ZOPN                 SETA  &ZOPN+1                                     00174700
&ZOPL(&ZOPN)          SETC  ' '                                         00174800
&ZOPO(&ZOPN)          SETC  'OI'                                        00174900
&ZOPV(&ZOPN)          SETC  '7(1),B''&ZW'''                             00175000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00175100
.ZI5E                 ANOP  ,                                           00175200
.*-------------------------------------------------------------------   00175300
.***AI.L25  XMSGTOKEN XL8                                               00175400
                      AIF   ('&ZXMSGTOKEN' EQ '').ZI6E                  00175500
                      AIF   ('&ZXMSGTOKEN' EQ 'OUTPUT').ZI6E            00175600
&ZCGPR                SETC  '&XMSGTOKEN'                                00175700
.*                                                                      00175800
                      AIF   ('&XMSGTOKEN'(1,1) NE '(').ZI6B             00175900
&ZCGPR   SETC  '0('.'&XMSGTOKEN'(2,K'&XMSGTOKEN-2).')'                  00176000
                      AGO   .ZI6D                                       00176100
.ZI6B                 ANOP  ,                                           00176200
.*                                                                      00176300
&ZC                   SETC  '&XMSGTOKEN'(1,1)                           00176400
                      AIF   (T'&ZC NE 'N').ZI6D                         00176500
&ZC                   SETC  '&XMSGTOKEN'                                00176600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI6D                00176700
&ZCGPR                SETC  '=BL8''&XMSGTOKEN'''                        00176800
.*                                                                      00176900
.ZI6D                 ANOP  ,                                           00177000
.*                                                                      00177100
&ZOPN                 SETA  &ZOPN+1                                     00177200
&ZOPL(&ZOPN)          SETC  ' '                                         00177300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00177400
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00177500
&ZOPD(&ZOPN)          SETC  '++ &ZXMSGTOKEN XMSGTOKEN'                  00177600
.*                                                                      00177700
.ZI6E                 ANOP  ,                                           00177800
.*-------------------------------------------------------------------   00177900
.***AI.L25  XDATA AL4                                                   00178000
                      AIF   ('&ZXDATA' EQ '').ZI7E                      00178100
                      AIF   ('&ZXDATA' EQ 'OUTPUT').ZI7E                00178200
&ZCGPR                SETC  '&XDATA'                                    00178300
         AIF   ('&XDATA' EQ '0').ZI7E                                   00178400
         AIF   ('&XDATA' EQ '0').ZI7E                                   00178500
.*                                                                      00178600
                      AIF   ('&XDATA'(1,1) NE '(').ZI7B                 00178700
&ZCGPR   SETC  '0('.'&XDATA'(2,K'&XDATA-2).')'                          00178800
                      AGO   .ZI7D                                       00178900
.ZI7B                 ANOP  ,                                           00179000
.*                                                                      00179100
&ZC                   SETC  '&XDATA'(1,1)                               00179200
                      AIF   (T'&ZC NE 'N').ZI7D                         00179300
&ZC                   SETC  '&XDATA'                                    00179400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00179500
&ZCGPR                SETC  '=AL4(&XDATA)'                              00179600
.*                                                                      00179700
.ZI7D                 ANOP  ,                                           00179800
.*                                                                      00179900
&ZOPN                 SETA  &ZOPN+1                                     00180000
&ZOPL(&ZOPN)          SETC  ' '                                         00180100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00180200
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00180300
&ZOPD(&ZOPN)          SETC  '++ &ZXDATA XDATA'                          00180400
.*                                                                      00180500
.ZI7E                 ANOP  ,                                           00180600
.*-------------------------------------------------------------------   00180700
.***AI.L25  XDATALEN F                                                  00180800
                      AIF   ('&ZXDATALEN' EQ '').ZI8E                   00180900
                      AIF   ('&ZXDATALEN' EQ 'OUTPUT').ZI8E             00181000
&ZCGPR                SETC  '&XDATALEN'                                 00181100
         AIF   ('&XDATALEN' EQ '0').ZI8E                                00181200
         AIF   ('&XDATALEN' EQ '0').ZI8E                                00181300
.*                                                                      00181400
                      AIF   ('&XDATALEN'(1,1) NE '(').ZI8B              00181500
&ZCGPR   SETC  '0('.'&XDATALEN'(2,K'&XDATALEN-2).')'                    00181600
                      AGO   .ZI8D                                       00181700
.ZI8B                 ANOP  ,                                           00181800
.*                                                                      00181900
&ZC                   SETC  '&XDATALEN'(1,1)                            00182000
                      AIF   (T'&ZC NE 'N').ZI8D                         00182100
&ZC                   SETC  '&XDATALEN'                                 00182200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00182300
&ZCGPR                SETC  '=FL4''&XDATALEN'''                         00182400
.*                                                                      00182500
.ZI8D                 ANOP  ,                                           00182600
.*                                                                      00182700
&ZOPN                 SETA  &ZOPN+1                                     00182800
&ZOPL(&ZOPN)          SETC  ' '                                         00182900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00183000
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00183100
&ZOPD(&ZOPN)          SETC  '++ &ZXDATALEN XDATALEN'                    00183200
.*                                                                      00183300
.ZI8E                 ANOP  ,                                           00183400
.*-------------------------------------------------------------------   00183500
.***AI.L18  XUSERRC F                                                   00183600
         AIF   ('&XUSERRC' NE 'NONE').ZI9                               00183700
&ZXUSERRC             SETC  ''             RESET INPUT/OUTPUT           00183800
.ZI9                  ANOP  ,                                           00183900
.*-------------------------------------------------------------------   00184000
.***AI.L25  XUSERRC F                                                   00184100
                      AIF   ('&ZXUSERRC' EQ '').ZI9E                    00184200
                      AIF   ('&ZXUSERRC' EQ 'OUTPUT').ZI9E              00184300
&ZCGPR                SETC  '&XUSERRC'                                  00184400
.*                                                                      00184500
                      AIF   ('&XUSERRC'(1,1) NE '(').ZI9B               00184600
&ZCGPR   SETC  '0('.'&XUSERRC'(2,K'&XUSERRC-2).')'                      00184700
                      AGO   .ZI9D                                       00184800
.ZI9B                 ANOP  ,                                           00184900
.*                                                                      00185000
&ZC                   SETC  '&XUSERRC'(1,1)                             00185100
                      AIF   (T'&ZC NE 'N').ZI9D                         00185200
&ZC                   SETC  '&XUSERRC'                                  00185300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00185400
&ZCGPR                SETC  '=FL4''&XUSERRC'''                          00185500
.*                                                                      00185600
.ZI9D                 ANOP  ,                                           00185700
.*                                                                      00185800
&ZOPN                 SETA  &ZOPN+1                                     00185900
&ZOPL(&ZOPN)          SETC  ' '                                         00186000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00186100
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00186200
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERRC XUSERRC'                      00186300
.*                                                                      00186400
.ZI9E                 ANOP  ,                                           00186500
.*-------------------------------------------------------------------   00186600
.***AI.L25  XGROUPTOKEN F                                               00186700
                      AIF   ('&ZXGROUPTOKEN' EQ '').ZI10E               00186800
                      AIF   ('&ZXGROUPTOKEN' EQ 'OUTPUT').ZI10E         00186900
&ZCGPR                SETC  '&XGROUPTOKEN'                              00187000
.*                                                                      00187100
                      AIF   ('&XGROUPTOKEN'(1,1) NE '(').ZI10B          00187200
&ZCGPR   SETC  '0('.'&XGROUPTOKEN'(2,K'&XGROUPTOKEN-2).')'              00187300
                      AGO   .ZI10D                                      00187400
.ZI10B                ANOP  ,                                           00187500
.*                                                                      00187600
&ZC                   SETC  '&XGROUPTOKEN'(1,1)                         00187700
                      AIF   (T'&ZC NE 'N').ZI10D                        00187800
&ZC                   SETC  '&XGROUPTOKEN'                              00187900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00188000
&ZCGPR                SETC  '=FL4''&XGROUPTOKEN'''                      00188100
.*                                                                      00188200
.ZI10D                ANOP  ,                                           00188300
.*                                                                      00188400
&ZOPN                 SETA  &ZOPN+1                                     00188500
&ZOPL(&ZOPN)          SETC  ' '                                         00188600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00188700
&ZOPV(&ZOPN)          SETC  '28(4,1),&ZCGPR'                            00188800
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPTOKEN XGROUPTOKEN'              00188900
.*                                                                      00189000
.ZI10E                ANOP  ,                                           00189100
.*-------------------------------------------------------------------   00189200
.***AI.L25  XSYSRC F                                                    00189300
                      AIF   ('&ZXSYSRC' EQ '').ZI11E                    00189400
                      AIF   ('&ZXSYSRC' EQ 'OUTPUT').ZI11E              00189500
&ZCGPR                SETC  '&XSYSRC'                                   00189600
         AIF   ('&XSYSRC' EQ '0').ZI11E                                 00189700
         AIF   ('&XSYSRC' EQ '0').ZI11E                                 00189800
.*                                                                      00189900
                      AIF   ('&XSYSRC'(1,1) NE '(').ZI11B               00190000
&ZCGPR   SETC  '0('.'&XSYSRC'(2,K'&XSYSRC-2).')'                        00190100
                      AGO   .ZI11D                                      00190200
.ZI11B                ANOP  ,                                           00190300
.*                                                                      00190400
&ZC                   SETC  '&XSYSRC'(1,1)                              00190500
                      AIF   (T'&ZC NE 'N').ZI11D                        00190600
&ZC                   SETC  '&XSYSRC'                                   00190700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00190800
&ZCGPR                SETC  '=FL4''&XSYSRC'''                           00190900
.*                                                                      00191000
.ZI11D                ANOP  ,                                           00191100
.*                                                                      00191200
&ZOPN                 SETA  &ZOPN+1                                     00191300
&ZOPL(&ZOPN)          SETC  ' '                                         00191400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00191500
&ZOPV(&ZOPN)          SETC  '32(4,1),&ZCGPR'                            00191600
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSRC XSYSRC'                        00191700
.*                                                                      00191800
.ZI11E                ANOP  ,                                           00191900
.*-------------------------------------------------------------------   00192000
.***AI.L25  XSYSRSN F                                                   00192100
                      AIF   ('&ZXSYSRSN' EQ '').ZI12E                   00192200
                      AIF   ('&ZXSYSRSN' EQ 'OUTPUT').ZI12E             00192300
&ZCGPR                SETC  '&XSYSRSN'                                  00192400
         AIF   ('&XSYSRSN' EQ '0').ZI12E                                00192500
         AIF   ('&XSYSRSN' EQ '0').ZI12E                                00192600
.*                                                                      00192700
                      AIF   ('&XSYSRSN'(1,1) NE '(').ZI12B              00192800
&ZCGPR   SETC  '0('.'&XSYSRSN'(2,K'&XSYSRSN-2).')'                      00192900
                      AGO   .ZI12D                                      00193000
.ZI12B                ANOP  ,                                           00193100
.*                                                                      00193200
&ZC                   SETC  '&XSYSRSN'(1,1)                             00193300
                      AIF   (T'&ZC NE 'N').ZI12D                        00193400
&ZC                   SETC  '&XSYSRSN'                                  00193500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00193600
&ZCGPR                SETC  '=FL4''&XSYSRSN'''                          00193700
.*                                                                      00193800
.ZI12D                ANOP  ,                                           00193900
.*                                                                      00194000
&ZOPN                 SETA  &ZOPN+1                                     00194100
&ZOPL(&ZOPN)          SETC  ' '                                         00194200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00194300
&ZOPV(&ZOPN)          SETC  '36(4,1),&ZCGPR'                            00194400
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSRSN XSYSRSN'                      00194500
.*                                                                      00194600
.ZI12E                ANOP  ,                                           00194700
.*-------------------------------------------------------------------   00194800
.***AI.L05 XKEYS BL1                                                    00194900
&ZW                   SETC  ''                                          00195000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00195100
.*-------------------------------------------------------------------   00195200
.***AI.L08 XKEYS "DATA"                                                 00195300
.***      BL1'1XXXXXXX'                                                 00195400
         AIF   ('&DATA' EQ '').ZI14A                                    00195500
&ZW                   SETC  '&ZW.1'                                     00195600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00195700
                      AGO   .ZI14C                                      00195800
.*                                                                      00195900
.ZI14A                ANOP  ,                                           00196000
&ZW                   SETC  '&ZW.0'                                     00196100
.ZI14C                ANOP  ,                                           00196200
.*-------------------------------------------------------------------   00196300
.***AI.L08 XKEYS "DATALEN"                                              00196400
.***      BL1'X1XXXXXX'                                                 00196500
         AIF   ('&DATALEN' EQ '').ZI15A                                 00196600
&ZW                   SETC  '&ZW.1'                                     00196700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00196800
                      AGO   .ZI15C                                      00196900
.*                                                                      00197000
.ZI15A                ANOP  ,                                           00197100
&ZW                   SETC  '&ZW.0'                                     00197200
.ZI15C                ANOP  ,                                           00197300
.*-------------------------------------------------------------------   00197400
.***AI.L08 XKEYS "USERRC"                                               00197500
.***      BL1'XX1XXXXX'                                                 00197600
         AIF   ('&USERRC' EQ '').ZI16A                                  00197700
&ZW                   SETC  '&ZW.1'                                     00197800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00197900
                      AGO   .ZI16C                                      00198000
.*                                                                      00198100
.ZI16A                ANOP  ,                                           00198200
&ZW                   SETC  '&ZW.0'                                     00198300
.ZI16C                ANOP  ,                                           00198400
.*-------------------------------------------------------------------   00198500
.***AI.L08 XKEYS "SYSRC"                                                00198600
.***      BL1'XXX1XXXX'                                                 00198700
         AIF   ('&SYSRC' EQ '').ZI17A                                   00198800
&ZW                   SETC  '&ZW.1'                                     00198900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00199000
                      AGO   .ZI17C                                      00199100
.*                                                                      00199200
.ZI17A                ANOP  ,                                           00199300
&ZW                   SETC  '&ZW.0'                                     00199400
.ZI17C                ANOP  ,                                           00199500
.*-------------------------------------------------------------------   00199600
.***AI.L08 XKEYS "SYSRSN"                                               00199700
.***      BL1'XXXX1XXX'                                                 00199800
         AIF   ('&SYSRSN' EQ '').ZI18A                                  00199900
&ZW                   SETC  '&ZW.1000'                                  00200000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00200100
                      AGO   .ZI18C                                      00200200
.*                                                                      00200300
.ZI18A                ANOP  ,                                           00200400
&ZW                   SETC  '&ZW.0000'                                  00200500
.ZI18C                ANOP  ,                                           00200600
.*-------------------------------------------------------------------   00200700
.***AI.L11 XKEYS BL1                                                    00200800
                      AIF   ('&ZCLNG' NE 'YES').ZI18E  ALL ZERO BITS    00200900
&ZOPN                 SETA  &ZOPN+1                                     00201000
&ZOPL(&ZOPN)          SETC  ' '                                         00201100
&ZOPO(&ZOPN)          SETC  'OI'                                        00201200
&ZOPV(&ZOPN)          SETC  '40(1),B''&ZW'''                            00201300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00201400
.ZI18E                ANOP  ,                                           00201500
.*-------------------------------------------------------------------   00201600
.***AI.L05 XMSGATTR BL1                                                 00201700
&ZW                   SETC  ''                                          00201800
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00201900
.*-------------------------------------------------------------------   00202000
.***AI.L08 XMSGATTR "J3CONNECT"                                         00202100
.***      BL1'1XXXXXXX'                                                 00202200
         AIF   ('&XMSGATTR' NE 'J3CONNECT').ZI20A                       00202300
&ZW                   SETC  '&ZW.1'                                     00202400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00202500
                      AGO   .ZI20C                                      00202600
.*                                                                      00202700
.ZI20A                ANOP  ,                                           00202800
&ZW                   SETC  '&ZW.0'                                     00202900
.ZI20C                ANOP  ,                                           00203000
.*-------------------------------------------------------------------   00203100
.***AI.L08 XMSGATTR "EXPRESS"                                           00203200
.***      BL1'X1XXXXXX'                                                 00203300
         AIF   ('&XMSGATTR' NE 'EXPRESS').ZI21A                         00203400
&ZW                   SETC  '&ZW.1000000'                               00203500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00203600
                      AGO   .ZI21C                                      00203700
.*                                                                      00203800
.ZI21A                ANOP  ,                                           00203900
&ZW                   SETC  '&ZW.0000000'                               00204000
.ZI21C                ANOP  ,                                           00204100
.*-------------------------------------------------------------------   00204200
.***AI.L11 XMSGATTR BL1                                                 00204300
                      AIF   ('&ZCLNG' NE 'YES').ZI21E  ALL ZERO BITS    00204400
&ZOPN                 SETA  &ZOPN+1                                     00204500
&ZOPL(&ZOPN)          SETC  ' '                                         00204600
&ZOPO(&ZOPN)          SETC  'OI'                                        00204700
&ZOPV(&ZOPN)          SETC  '41(1),B''&ZW'''                            00204800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00204900
.ZI21E                ANOP  ,                                           00205000
.*-------------------------------------------------------------------   00205100
&ZOPN1                SETA &ZOPN                                        00205200
.*******************************************************************    00205300
.***  PROCESS IXZXIXAC OUTPUT PARAMETERS                                00205400
.*******************************************************************    00205500
                      ACTR  10000                                       00205600
.*******************************************************************    00205700
.***AO.X01  LABEL TO BYPASS INVOCATION                                  00205800
.*******************************************************************    00205900
&ZOPN                 SETA  &ZOPN+1                                     00206000
&ZOPL(&ZOPN)          SETC  'AMGE&SYSNDX'                               00206100
&ZOPO(&ZOPN)          SETC  'DS'                                        00206200
&ZOPV(&ZOPN)          SETC  '0H'                                        00206300
&ZOPD(&ZOPN)          SETC  '++ BYPASS INVOCATION'                      00206400
.*******************************************************************    00206500
.***AO.X02  RETURN CODE PROCESSING                                      00206600
.*******************************************************************    00206700
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00206800
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00206900
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00207000
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00207100
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00207200
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00207300
&ZOPN                 SETA  &ZOPN+1                                     00207400
&ZOPL(&ZOPN)          SETC  ' '                                         00207500
&ZOPO(&ZOPN)          SETC  'ST'                                        00207600
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00207700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00207800
                      AGO   .ZMRETX                                     00207900
.*                                                                      00208000
.ZMRET2               ANOP  ,                                           00208100
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00208200
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00208300
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00208400
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00208500
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00208600
&ZOPN                 SETA  &ZOPN+1                                     00208700
&ZOPL(&ZOPN)          SETC  ' '                                         00208800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00208900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00209000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00209100
.ZMRETX               ANOP  ,                                           00209200
.*******************************************************************    00209300
.***AO.X03  REASON CODE PROCESSING                                      00209400
.*******************************************************************    00209500
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00209600
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00209700
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00209800
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00209900
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00210000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00210100
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00210200
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00210300
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00210400
&ZOPN                 SETA  &ZOPN+1                                     00210500
&ZOPL(&ZOPN)          SETC  ' '                                         00210600
&ZOPO(&ZOPN)          SETC  'ST'                                        00210700
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00210800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00210900
                      AGO   .ZMRSNX                                     00211000
.*                                                                      00211100
.ZMRSN2               ANOP  ,                                           00211200
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00211300
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00211400
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00211500
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00211600
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00211700
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00211800
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00211900
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00212000
&ZOPN                 SETA  &ZOPN+1                                     00212100
&ZOPL(&ZOPN)          SETC  ' '                                         00212200
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00212300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00212400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00212500
.ZMRSNX               ANOP  ,                                           00212600
.*******************************************************************    00212700
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00212800
.*******************************************************************    00212900
.ZMFLX                ANOP  ,              MF=L PROCESSING              00213000
.*******************************************************************    00213100
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00213200
.*******************************************************************    00213300
                      ACTR  10000                                       00213400
.*                                                                      00213500
                      LCLA  &ZLC           COLUMN POSITION              00213600
                      LCLA  &ZOPX          LIST TABLE INDEX             00213700
                      LCLC  &ZLL           LABEL                        00213800
                      LCLC  &ZLOP          OPERATION                    00213900
                      LCLC  &ZLV           VALUE                        00214000
                      LCLC  &ZLD           DESCRIPTION                  00214100
.*                                                                      00214200
&ZOPX                 SETA  1                                           00214300
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00214400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00214500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00214600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00214700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00214800
                      AIF   (K'&ZLD LE 0).ZL5                           00214900
&ZLC                  SETA  35             COMMENT COLUMN               00215000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00215100
&ZLC                  SETA  33             COMMMENT COLUMN              00215200
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00215300
&ZLV                  SETC  '&ZLV'.' '                                  00215400
                      AGO   .ZL3                                        00215500
.*                                                                      00215600
.ZL4                  ANOP  ,                                           00215700
&ZLV                  SETC  '&ZLV'.' '                                  00215800
.ZL5                  ANOP  ,                                           00215900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00216000
.*                                                                      00216100
&ZLL     &ZLOP &ZLV                                                     00216200
.*                                                                      00216300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00216400
                      AGO   .ZL2           CONTINUE LOOPING             00216500
.*                                                                      00216600
.ZLX                  ANOP  ,                                           00216700
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00216800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00216900
         GBLC  &ANVIRON           JES2 environment variable             00217000
         GBLB  &J3MN              JES3 Main Task environment            00217100
         GBLB  &J3ST              JES3 Subtask environment              00217200
         GBLB  &J3FSS             JES3 FSS environment                  00217300
         GBLB  &JSXCF             JESXCF environment                    00217400
         AIF   ('&ANVIRON' EQ 'JES2').IXAC050  Are we running under     00217500
.*                                JES2 Main task                        00217600
         AIF   ('&ANVIRON' EQ 'SUBTASK').IXAC050 Are we running under   00217700
.*                                JES2 Subtask                          00217800
         AIF   (&J3MN).IXAC050    Are we running under JES3 Main task   00217900
         AIF   (&J3ST).IXAC050    Are we running under JES3 Sub task    00218000
         AIF   (&J3FSS).IXAC050   Are we running under JES3 FSS         00218100
         MNOTE 8,'IXZ0001 Running in an invalid environment'            00218200
.IXAC050 ANOP                                                           00218300
         AIF   ('&GROUPTOKEN'(1,1) NE '(').IXAC100                      00218400
         LR    14,&GROUPTOKEN     Load the address of the group token   00218500
         L     14,0(14)           Load the group token                  00218600
         AGO   .IXAC150                                                 00218700
.IXAC100 ANOP                                                           00218800
         L     14,&GROUPTOKEN     Load the group token                  00218900
.IXAC150 ANOP                                                           00219000
         L     14,60(14)          Load the PC number of the             00219100
*                                 routine to be called                  00219200
         PC    0(14)              Call the acknowledge message          00219300
*                                 routine                               00219400
         AIF   ('&XMFCTRL'(1,1) NE '(').IXAC200                         00219500
         LR    1,&XMFCTRL         Restore the parameter list address    00219600
         AGO   .IXAC250                                                 00219700
.IXAC200 ANOP                                                           00219800
         LA    1,&XMFCTRL         Restore the parameter list address    00219900
.IXAC250 ANOP                                                           00220000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00220100
.ZLINKX               ANOP  ,                                           00220200
.*******************************************************************    00220300
.***AP.X01  FORMAT GENERATED CODE                                       00220400
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00220500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00220600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00220700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00220800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00220900
                      AIF   (K'&ZLD LE 0).ZL51                          00221000
&ZLC                  SETA  35             COMMENT COLUMN               00221100
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00221200
&ZLC                  SETA  33             COMMENT COLUMN               00221300
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00221400
&ZLV                  SETC  '&ZLV'.' '                                  00221500
                      AGO   .ZL31                                       00221600
.*                                                                      00221700
.ZL41                 ANOP  ,                                           00221800
&ZLV                  SETC  '&ZLV'.' '                                  00221900
.ZL51                 ANOP  ,                                           00222000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00222100
.*                                                                      00222200
&ZLL     &ZLOP &ZLV                                                     00222300
.*                                                                      00222400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00222500
                      AGO   .ZL21          CONTINUE LOOPING             00222600
.*                                                                      00222700
.ZLX1                 ANOP  ,                                           00222800
.*******************************************************************    00222900
.***AP.X02  END OF IXZXIXAC MACRO                                       00223000
&ZIXZXIXAC            SETC  'YES'          SET IXZXIXAC USED            00223100
         POP   PRINT                                                    00223200
*                                            IXZXIXAC-1                 00223300
         SPACE 1                                                        00223400
.ZLX2                 ANOP  ,                                           00223500
         MEND                                                           00223600
**********************************************************************/ 00223700
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00223800
*%IXZXIXAC: MACRO KEYS(MSGTOKEN,USERRC,DATA,DATALEN,GROUPTOKEN,SYSRC,   00223900
*                 SYSRSN,MSGATTR,STB,RTNCODE,RSNCODE,PLISTVER,MF);      00224000
*  ANS('?'!!MACLABEL!!' '!!'IXZPIXAC '!!MACLIST!!                       00224100
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00224200
*%END IXZXIXAC;                                                         00224300

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWM4QIN                               -04/28/07-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  WLM Queue Manager Insert Service              * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 2004                               * 00001200
*                                                                     * 00001300
* STATUS= HBB7709                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IWM4QIN service inserts a work request onto workload       * 00002100
*      management queues so its execution in a server address space   * 00002200
*      can be managed by WLM.                                         * 00002300
*                                                                     * 00002400
*      Before using this service, the caller must connect to WLM      * 00002500
*      using the IWM4CON service, specifying Queue_Manager=Yes, or    * 00002600
*      Server_Manager=Yes with Server_Type=Queue.                     * 00002700
*                                                                     * 00002800
*      The IWM4QIN service requires the use of enclaves to manage the * 00002900
*      performance goals and reporting of work.  It requires the use  * 00003000
*      of application environments to associate types of work         * 00003100
*      requests with servers capable of processing them.  Refer to    * 00003200
*      OS/390 MVS Workload Management Services for more information.  * 00003300
*                                                                     * 00003400
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003500
*                                                                     * 00003600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003700
*                                                                     * 00003800
*01* ENVIRONMENT:                                                     * 00003900
*                                                                     * 00004000
*                                                                     * 00004100
*      Minimum authorization: Supervisor state or program key mask    * 00004200
*                        (PKM) allowing keys 0-7.                     * 00004300
*                                                                     * 00004400
*      Dispatchable unit mode: Task or SRB mode.                      * 00004500
*                                                                     * 00004600
*      Cross Memory Mode: Any HASN, any SASN.  PASN must be the       * 00004700
*                        address space which connected to WLM (i.e.   * 00004800
*                        the address space that was home when IWM4CON * 00004900
*                        was issued for Queue_Manager=Yes, or         * 00005000
*                        Server_Manager=Yes with Server_Type=Queue).  * 00005100
*                                                                     * 00005200
*      AMODE:            31- or 64-bit.  If in 64-Bit addressing      * 00005300
*                        mode, code SYSSTATE AMODE64=YES before       * 00005400
*                        invoking this macro.                         * 00005500
*                                                                     * 00005600
*      ASC mode:         Primary.                                     * 00005700
*                                                                     * 00005800
*      Interrupt status: Enabled for I/O and external interrupts.     * 00005900
*                                                                     * 00006000
*      Locks:            No locks held.                               * 00006100
*                                                                     * 00006200
*      Control parameters: Control parameters must be in the primary  * 00006300
*                        address space.                               * 00006400
*                                                                     * 00006500
*                                                                     * 00006600
*                                                                     * 00006700
*01* PROGRAMMING REQUIREMENTS:                                        * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*    1.  The macro CVT must be included to use this macro.            * 00007100
*                                                                     * 00007200
*    2.  The macro IWMYCON must be included to use this macro.        * 00007300
*                                                                     * 00007400
*    3.  The macro IWMPB must be in the library concatenation, since  * 00007500
*        it is included by IWMYCON.                                   * 00007600
*                                                                     * 00007700
*    4.  Note that the high order halfword of register 0, and the     * 00007800
*        reason code variable when specified, may be non-zero and     * 00007900
*        represents diagnostic data which is NOT part of the external * 00008000
*        interface.  The high order halfword should thus be excluded  * 00008100
*        from comparison with the reason code values described above. * 00008200
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00008300
*        be used for this purpose.                                    * 00008400
*                                                                     * 00008500
*    5.  All character data, unless otherwise specified, is assumed   * 00008600
*        to be left justified and padded with blanks on the right, as * 00008700
*        needed, to occupy the specified number of bytes.             * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*01* RESTRICTIONS:                                                    * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*    1.  This macro may not be used prior to the completion of WLM    * 00009500
*        address space initialization.                                * 00009600
*                                                                     * 00009700
*    2.  This macro may only be used on MVS/ESA HBB6603 or higher.    * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*                                                                     * 00010100
*01* INPUT REGISTER INFORMATION:                                      * 00010200
*                                                                     * 00010300
*    Before issuing the IWM4QIN macro, the caller does not have to    * 00010400
*    place any information into any register unless using it in       * 00010500
*    register notation for a particular parameter, or using it as a   * 00010600
*    base register.                                                   * 00010700
*                                                                     * 00010800
*01* OUTPUT REGISTER INFORMATION:                                     * 00010900
*                                                                     * 00011000
*    When control returns to the caller, the GPRs contain:            * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*    REGISTER  CONTENTS                                               * 00011400
*                                                                     * 00011500
*    0         Reason code if GR15 return code is non-zero            * 00011600
*                                                                     * 00011700
*    1         Used as work registers by the system                   * 00011800
*                                                                     * 00011900
*    2-13      Unchanged                                              * 00012000
*                                                                     * 00012100
*    14        Used as work registers by the system                   * 00012200
*                                                                     * 00012300
*    15        Return code                                            * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*    When control returns to the caller, the ARs contain:             * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*    REGISTER  CONTENTS                                               * 00013100
*                                                                     * 00013200
*    0-1       Used as work registers by the system                   * 00013300
*                                                                     * 00013400
*    2-13      Unchanged                                              * 00013500
*                                                                     * 00013600
*    14-15     Used as work registers by the system                   * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*                                                                     * 00014000
*    Some callers depend on register contents remaining the same      * 00014100
*    before and after issuing a service.  If the system changes the   * 00014200
*    contents of registers on which the caller depends, the caller    * 00014300
*    must save them before issuing the service, and restore them      * 00014400
*    after the system returns control.                                * 00014500
*                                                                     * 00014600
*01* PERFORMANCE IMPLICATIONS:                                        * 00014700
*                                                                     * 00014800
*    None                                                             * 00014900
*                                                                     * 00015000
*01* SYNTAX:                                                          * 00015100
*                                                                     * 00015200
*Ýxlabel¨  IWM4QIN     CONNTKN=xconntkn                               * 00015300
*                     ,ETOKEN=xetoken                                 * 00015400
*                     ,USERDATA=xuserdata                             * 00015500
*                     ,APPLENV=xapplenv                               * 00015600
*                       ÐÝ,DYNAMIC=NO¨                                * 00015700
*                       ¿Ý,DYNAMIC=YES¨                               * 00015800
*                   ÐÝ,DEPENDENT=NO¨                                  * 00015900
*                   ¿Ý,DEPENDENT=YES¨                                 * 00016000
*                   ÐÝ,SECUSER=NO¨                                    * 00016100
*                   ¿Ý,SECUSER=YES                                    * 00016200
*                         ,USERID=xuserid¨                            * 00016300
*                    Ý,WLMWUTKN=xwlmwutkn¨                            * 00016400
*                    Ý,SERVER_TOKEN=»xserver_token!0º¨                * 00016500
*                    Ý,REGION_TOKEN=»xregion_token!0º¨                * 00016600
*                    Ý,RETCODE=xretcode¨                              * 00016700
*                    Ý,RSNCODE=xrsncode¨                              * 00016800
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00016900
*                   ÐÝ,MF=S¨                                          * 00017000
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00017100
*                   ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00017200
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*      Where:                                                         * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*      Ýxlabel¨                                                       * 00017900
*          is an optional symbol, starting in column 1, that is the   * 00018000
*          name on the IWM4QIN macro invocation.  The name must       * 00018100
*          conform to the rules for an ordinary assembler language    * 00018200
*          symbol.                                                    * 00018300
*          DEFAULT: No name.                                          * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*      CONNTKN=xconntkn                                               * 00018900
*          is the name (RS-type), or address in register (2)-(12), of * 00019000
*          a required 32 bit input which contains the connect token   * 00019100
*          returned by the IWM4CON macro.                             * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*      ETOKEN=xetoken                                                 * 00019700
*          is the name (RS-type), or address in register (2)-(12), of * 00019800
*          a required 8 character input which contains the enclave    * 00019900
*          token associated with the work request.  An enclave token  * 00020000
*          is obtained using either the IWM4ECRE or IWMESQRY macro.   * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*      USERDATA=xuserdata                                             * 00020600
*          is the name (RS-type), or address in register (2)-(12), of * 00020700
*          a required 16 character input which contains data to pass  * 00020800
*          to the server address space.  This user data is returned   * 00020900
*          to the caller of the IWM4SSL or IWM4SSM macro.  The format * 00021000
*          is undefined to MVS.                                       * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*      APPLENV=xapplenv                                               * 00021600
*          is the name (RS-type), or address in register (2)-(12), of * 00021700
*          a required 32 character input which contains an            * 00021800
*          application environment name.  An application environment  * 00021900
*          is defined in the workload manager service definition and  * 00022000
*          instructs WLM how to create a server address space.        * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*          ÝDYNAMIC=»NO!YESº¨                                         * 00022400
*              is an optional keyword input indicating whether the    * 00022500
*              insert is for a dynamic or static application          * 00022600
*              environment.                                           * 00022700
*              DEFAULT: NO                                            * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*              ÝDYNAMIC=NO¨                                           * 00023100
*                  The server manager connects to a static            * 00023200
*                  application environment according to the WLM       * 00023300
*                  service defintion (default).                       * 00023400
*                                                                     * 00023500
*              ÝDYNAMIC=YES¨                                          * 00023600
*                  The server manager connects to a dynamic           * 00023700
*                  application environment according to a prior       * 00023800
*                  definition via IWMAEDEF service.                   * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*                                                                     * 00024700
*      ÝDEPENDENT=»NO!YESº¨                                           * 00024800
*          is an optional keyword input indicating whether the insert * 00024900
*          is for a dependent or a standard request.                  * 00025000
*          DEFAULT: NO                                                * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*          ÝDEPENDENT=NO¨                                             * 00025400
*              The request is for an independent (standard) work      * 00025500
*              request (default).                                     * 00025600
*                                                                     * 00025700
*          ÝDEPENDENT=YES¨                                            * 00025800
*              The insert is for a dependent work request which is    * 00025900
*              required by already active server tasks to complete    * 00026000
*              their processing. The request is prioritized above     * 00026100
*              requests which are not marked as dependent.            * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*      ÝSECUSER=»NO!YESº¨                                             * 00026900
*          is an optional keyword input which specifies whether the   * 00027000
*          security environment of the user should be associated with * 00027100
*          the request at run time.                                   * 00027200
*          DEFAULT: NO                                                * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*          ÝSECUSER=NO¨                                               * 00027600
*              No security environment to be established.             * 00027700
*                                                                     * 00027800
*          ÝSECUSER=YES                                               * 00027900
*              Use the specified userid to establish a security       * 00028000
*              environment.                                           * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*              USERID=xuserid¨                                        * 00028400
*                  is the name (RS-type), or address in register      * 00028500
*                  (2)-(12), of a required 8 character input which    * 00028600
*                  contains the requester's userid.                   * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*      ÝWLMWUTKN=xwlmwutkn¨                                           * 00029600
*          is the name (RS-type), or address in register (2)-(12), of * 00029700
*          an optional 16 character output which will receive the     * 00029800
*          work unit token.  This token can be passed to the IWM4QDE  * 00029900
*          service to delete the work request.                        * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*      ÝSERVER_TOKEN=»xserver_token!0º¨                               * 00030500
*          is the name (RS-type), or address in register (2)-(12), of * 00030600
*          an optional 32 character input which contains a server     * 00030700
*          token returned by the IWM4SSL macro.  Use SERVER_TOKEN to  * 00030800
*          queue a secondary work request to the same server task     * 00030900
*          that selected a prior work request.  A secondary work      * 00031000
*          request is considered to be an extension of the prior work * 00031100
*          request.                                                   * 00031200
*                                                                     * 00031300
*          The following qualifications apply when specifying a       * 00031400
*          server token:                                              * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*          o   The server task is responsible for passing the server  * 00031800
*              token to the queueing manager so that it can insert a  * 00031900
*              secondary work request.                                * 00032000
*                                                                     * 00032100
*          o   Coordination is required between the queueing manager  * 00032200
*              and the server task so that the server task knows when * 00032300
*              to expect secondary work requests.  The server task    * 00032400
*              uses the IWM4SSM macro to select secondary work        * 00032500
*              requests.  It must select all secondary work requests  * 00032600
*              before it can resume normal selection using IWM4SSL.   * 00032700
*                                                                     * 00032800
*          o   The same application environment and enclave token     * 00032900
*              passed for the original work request must be passed    * 00033000
*              for each secondary work request.                       * 00033100
*                                                                     * 00033200
*          o   A secondary work request cannot be deleted using the   * 00033300
*              IWM4QDE macro.  IWM4QIN does not return a work unit    * 00033400
*              token (WLMWUTKN).                                      * 00033500
*                                                                     * 00033600
*          o   The SECUSER keyword is ignored.                        * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*          Coding SERVER_TOKEN=0 is equivalent to omitting the        * 00034100
*          SERVER_TOKEN keyword.                                      * 00034200
*          DEFAULT: 0                                                 * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*      ÝREGION_TOKEN=»xregion_token!0º¨                               * 00034800
*          is the name (RS-type), or address in register (2)-(12), of * 00034900
*          an optional 16 character input which contains a region     * 00035000
*          token returned by the IWM4SSL macro.  Use REGION_TOKEN to  * 00035100
*          queue a work request to a specific server region.  Such a  * 00035200
*          work request is considered to be part of a set of work     * 00035300
*          requests which all need access to the same status          * 00035400
*          information which is kept in the virtual storage of the    * 00035500
*          server region.                                             * 00035600
*                                                                     * 00035700
*          The following qualifications apply when specifying a       * 00035800
*          region token:                                              * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*          o   The application is responsible for passing the region  * 00036200
*              token to the queueing manager so that it can insert    * 00036300
*              the work request to the region.                        * 00036400
*                                                                     * 00036500
*          o   WLM has to know that temporal affinities for work      * 00036600
*              requests to a specific server region exist in order    * 00036700
*              not to stop the server region.  The application must   * 00036800
*              use the IWM4TAF macro to tell WLM when a temporal      * 00036900
*              affinity starts and when it ends.                      * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*          Coding REGION_TOKEN=0 is equivalent to omitting the        * 00037400
*          REGION_TOKEN keyword.                                      * 00037500
*          DEFAULT: 0                                                 * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*      ÝRETCODE=xretcode¨                                             * 00038100
*          is the name (RS-type) of an optional fullword output       * 00038200
*          variable, or register (2)-(12), into which the return code * 00038300
*          is to be copied from GPR 15.                               * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*      ÝRSNCODE=xrsncode¨                                             * 00038900
*          is the name (RS-type) of an optional fullword output       * 00039000
*          variable, or register (2)-(12), into which the reason code * 00039100
*          is to be copied from GPR 0.                                * 00039200
*                                                                     * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00039700
*          is an optional byte input decimal value in the "0-0" range * 00039800
*          that specifies the macro version.  PLISTVER is the only    * 00039900
*          key allowed on the list form of MF and determines which    * 00040000
*          parameter list is generated.  Note that MAX may be         * 00040100
*          specified instead of a number, and the parameter list will * 00040200
*          be of the largest size currently supported. This size may  * 00040300
*          grow from release to release (thus possibly affecting the  * 00040400
*          amount of storage needed by your program).  If your        * 00040500
*          program can tolerate this, IBM recommends that you always  * 00040600
*          specify MAX when creating the list form parameter list as  * 00040700
*          that will ensure that the list form parameter list is      * 00040800
*          always long enough to hold whatever parameters might be    * 00040900
*          specified on the execute form.                             * 00041000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00041100
*          default is the lowest version which allows all of the      * 00041200
*          parameters specified on the invocation to be processed.    * 00041300
*                                                                     * 00041400
*                                                                     * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*      ÝMF=»S!L!M!Eº¨                                                 * 00041800
*          is an optional keyword input which specifies the macro     * 00041900
*          form.                                                      * 00042000
*          DEFAULT: S                                                 * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*          ÝMF=S¨                                                     * 00042400
*              specifies the standard form of the macro.  The "S"     * 00042500
*              form generates code to put the parameters into an      * 00042600
*              in-line parameter list and invoke the desired service. * 00042700
*              Full checking for required macro keys is done along    * 00042800
*              with supplying defaults for omitted optional           * 00042900
*              parameters.                                            * 00043000
*                                                                     * 00043100
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00043200
*              specifies the list form of the macro.  The "L" form    * 00043300
*              defines an area to be used for the parameter list.     * 00043400
*              Only the PLISTVER key may be specified on the          * 00043500
*              invocation.  All other macro parameters are flagged as * 00043600
*              errors.  If PLISTVER is not specified, the original    * 00043700
*              parameter list definition is used.                     * 00043800
*                                                                     * 00043900
*            ,xmfctrl                                                 * 00044000
*              is a required input.  It is the name of a storage area * 00044100
*              for the parameter list.                                * 00044200
*                                                                     * 00044300
*            »,xmfattr!0Dº                                            * 00044400
*              is an optional 60 character input string that varies   * 00044500
*              from 1 to 60 characters. Use it to force boundary      * 00044600
*              alignment of the parameter list. Use only 0F or 0D.    * 00044700
*              DEFAULT: 0D which forces the parameter list to a       * 00044800
*              doubleword boundary.                                   * 00044900
*                                                                     * 00045000
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00045100
*              specifies the modify form of the macro.  The "M" form  * 00045200
*              generates code to put the parameters into the          * 00045300
*              parameter list specified by xmfctrl.                   * 00045400
*                                                                     * 00045500
*            ,xmfctrl                                                 * 00045600
*              is a required input.  It is the name (RS-type), or     * 00045700
*              address in register (1)-(12), of a storage area for    * 00045800
*              the parameter list.                                    * 00045900
*                                                                     * 00046000
*            »,COMPLETE!NOCHECKº¨                                     * 00046100
*              is an optional keyword input which specifies the       * 00046200
*              degree of macro parameter syntax checking.             * 00046300
*              DEFAULT: COMPLETE                                      * 00046400
*                                                                     * 00046500
*                                                                     * 00046600
*              COMPLETE                                               * 00046700
*                  Checking for required macro keys is done and       * 00046800
*                  defaults are supplied for omitted optional         * 00046900
*                  parameters.  (See Macro Usage Note 2).             * 00047000
*                                                                     * 00047100
*              NOCHECK                                                * 00047200
*                  Checking for required macro keys is not done nor   * 00047300
*                  are defaults supplied for omitted optional         * 00047400
*                  parameters.                                        * 00047500
*                                                                     * 00047600
*                                                                     * 00047700
*                                                                     * 00047800
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00047900
*              specifies the execute form of the macro.  The "E" form * 00048000
*              generates code to put the parameters into the          * 00048100
*              parameter list specified by xmfctrl and invoke the     * 00048200
*              desired service.                                       * 00048300
*                                                                     * 00048400
*            ,xmfctrl                                                 * 00048500
*              is a required input.  It is the name (RS-type), or     * 00048600
*              address in register (1)-(12), of a storage area for    * 00048700
*              the parameter list.                                    * 00048800
*                                                                     * 00048900
*            »,COMPLETE!NOCHECKº                                      * 00049000
*              is an optional keyword input which specifies the       * 00049100
*              degree of macro parameter syntax checking.             * 00049200
*              DEFAULT: COMPLETE                                      * 00049300
*                                                                     * 00049400
*                                                                     * 00049500
*              COMPLETE                                               * 00049600
*                  Checking for required macro keys is done and       * 00049700
*                  defaults are supplied for omitted optional         * 00049800
*                  parameters.  (See Macro Usage Note 2).             * 00049900
*                                                                     * 00050000
*              NOCHECK                                                * 00050100
*                  Checking for required macro keys is not done nor   * 00050200
*                  are defaults supplied for omitted optional         * 00050300
*                  parameters.                                        * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*                                                                     * 00050900
*                                                                     * 00051000
*                                                                     * 00051100
*01* ABEND CODES:  None.                                              * 00051200
*                                                                     * 00051300
*01* RETURN CODES:                                                    * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*            0    Name: IwmRetCodeOk                                  * 00051700
*                                                                     * 00051800
*                 Meaning: Successful completion.                     * 00051900
*                                                                     * 00052000
*                 Action: None required.                              * 00052100
*                                                                     * 00052200
*                                                                     * 00052300
*            4    Name: IwmRetCodeWarning                             * 00052400
*                                                                     * 00052500
*                 Meaning:  Successful completion, unusual conditions * 00052600
*                 noted.                                              * 00052700
*                                                                     * 00052800
*                                                                     * 00052900
*                 HEX REASON  MEANING/ACTION                          * 00053000
*                 CODE                                                * 00053100
*                                                                     * 00053200
*                 xxxx042E    Name: IwmRsnCodeServerNotFound          * 00053300
*                                                                     * 00053400
*                             Meaning: The server token does not      * 00053500
*                             identify an existing server task.  The  * 00053600
*                             server task may have terminated since   * 00053700
*                             the token was obtained.                 * 00053800
*                                                                     * 00053900
*                             Action: If the server task has not      * 00054000
*                             terminated, check that the correct      * 00054100
*                             token is specified.                     * 00054200
*                                                                     * 00054300
*                 xxxx043A    Name: IwmRsnCodeRegionNotFound          * 00054400
*                                                                     * 00054500
*                             Meaning: The region token does not      * 00054600
*                             identify a valid server region.         * 00054700
*                                                                     * 00054800
*                             Action: Please specify the correct      * 00054900
*                             region token.                           * 00055000
*                                                                     * 00055100
*                                                                     * 00055200
*                                                                     * 00055300
*                                                                     * 00055400
*            8    Name: IwmRetCodeInvocError                          * 00055500
*                                                                     * 00055600
*                 Meaning: Invalid invocation environment or          * 00055700
*                 parameters.                                         * 00055800
*                                                                     * 00055900
*                                                                     * 00056000
*                 HEX REASON  MEANING/ACTION                          * 00056100
*                 CODE                                                * 00056200
*                                                                     * 00056300
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00056400
*                                                                     * 00056500
*                             Meaning: Caller is disabled.            * 00056600
*                                                                     * 00056700
*                             Action: Avoid requesting this function  * 00056800
*                             while disabled.                         * 00056900
*                                                                     * 00057000
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00057100
*                                                                     * 00057200
*                             Meaning: Caller is locked.              * 00057300
*                                                                     * 00057400
*                             Action: Avoid requesting this function  * 00057500
*                             while locked.                           * 00057600
*                                                                     * 00057700
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00057800
*                                                                     * 00057900
*                             Meaning: Error accessing parameter      * 00058000
*                             list.                                   * 00058100
*                                                                     * 00058200
*                             Action: Check for possible storage      * 00058300
*                             overlay.                                * 00058400
*                                                                     * 00058500
*                 xxxx0821    Name:IwmRsnCodeBadConn                  * 00058600
*                                                                     * 00058700
*                             Meaning: Input connect token does not   * 00058800
*                             pass validity checking.                 * 00058900
*                                                                     * 00059000
*                             Action: Make sure to use the connect    * 00059100
*                             token returned by the IWM4CON service   * 00059200
*                             requesting Queue_Manager=Yes, or        * 00059300
*                             Server_Manager=Yes with                 * 00059400
*                             Server_Type=Queue.                      * 00059500
*                                                                     * 00059600
*                 xxxx0823    Name: IwmRsnCodeDatoff                  * 00059700
*                                                                     * 00059800
*                             Meaning: Caller invoked service while   * 00059900
*                             DATOFF                                  * 00060000
*                                                                     * 00060100
*                             Action: Avoid requesting this function  * 00060200
*                             in this environment.                    * 00060300
*                                                                     * 00060400
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 00060500
*                                                                     * 00060600
*                             Meaning: Caller invoked service but was * 00060700
*                             in 24 bit addressing mode.              * 00060800
*                                                                     * 00060900
*                             Action: Request this function only when * 00061000
*                             you are in 31 bit addressing mode.      * 00061100
*                                                                     * 00061200
*                 xxxx0825    Name: IwmRsnCodeAscModeNotPrimary       * 00061300
*                                                                     * 00061400
*                             Meaning: Caller invoked service but was * 00061500
*                             not in primary ASC mode.                * 00061600
*                                                                     * 00061700
*                             Action: Avoid requesting this function  * 00061800
*                             in this environment.                    * 00061900
*                                                                     * 00062000
*                 xxxx0827    Name: IwmRsnCodeRsvdNot0                * 00062100
*                                                                     * 00062200
*                             Meaning: Reserved field in parameter    * 00062300
*                             list was non-zero.                      * 00062400
*                                                                     * 00062500
*                             Action:  Check for use of keywords that * 00062600
*                             are not supported by the MVS release on * 00062700
*                             which the program is running.           * 00062800
*                                                                     * 00062900
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00063000
*                                                                     * 00063100
*                             Meaning: Version number in parameter    * 00063200
*                             list is not valid.                      * 00063300
*                                                                     * 00063400
*                             Action: Check for possible storage      * 00063500
*                             overlay of the parameter list.          * 00063600
*                                                                     * 00063700
*                 xxxx083A    Name: IwmRsnCodeBadEnclave              * 00063800
*                                                                     * 00063900
*                             Meaning: Enclave token in parameter     * 00064000
*                             list is not valid.                      * 00064100
*                                                                     * 00064200
*                             Action: Check the specification of the  * 00064300
*                             ETOKEN parameter.                       * 00064400
*                                                                     * 00064500
*                 xxxx083F    Name: IwmRsnCodePrimaryNotOwnConn       * 00064600
*                                                                     * 00064700
*                             Meaning: Primary address space does not * 00064800
*                             own the passed connect token.           * 00064900
*                                                                     * 00065000
*                             Action: Ensure that the primary address * 00065100
*                             space has previously connected to WLM   * 00065200
*                             using the IWM4CON macro.  Ensure that   * 00065300
*                             the connect token returned by the       * 00065400
*                             IWM4CON macro is passed to the IWM4QIN  * 00065500
*                             macro.                                  * 00065600
*                                                                     * 00065700
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 00065800
*                                                                     * 00065900
*                             Meaning: Caller's space connection is   * 00066000
*                             not enabled for this service.           * 00066100
*                                                                     * 00066200
*                             Action: Make sure that                  * 00066300
*                             Queue_Manager=Yes, or                   * 00066400
*                             Server_Manager=Yes with                 * 00066500
*                             Server_Type=Queue is specified on the   * 00066600
*                             IWM4CON request to enable this service. * 00066700
*                                                                     * 00066800
*                 xxxx0842    Name: IwmRsnCodeNoWLMConnect            * 00066900
*                                                                     * 00067000
*                             Meaning: Caller's space disconnected    * 00067100
*                             from WLM during processing of the       * 00067200
*                             insert request.                         * 00067300
*                                                                     * 00067400
*                             Action: None.                           * 00067500
*                                                                     * 00067600
*                 xxxx0845    Name: IwmRsnCodeWrongEnclave            * 00067700
*                                                                     * 00067800
*                             Meaning: The caller tried to queue a    * 00067900
*                             secondary work request to a specific    * 00068000
*                             server task using the SERVER_TOKEN      * 00068100
*                             parameter.  The caller's enclave token  * 00068200
*                             does not match the enclave token of the * 00068300
*                             last work request selected by the       * 00068400
*                             server task.                            * 00068500
*                                                                     * 00068600
*                             Action: Check that the correct enclave  * 00068700
*                             token was specified.  Check that the    * 00068800
*                             server task is invoking the IWM4SSL and * 00068900
*                             IWM4SSM macros in the correct sequence. * 00069000
*                                                                     * 00069100
*                 xxxx089C    Name: IwmRsnCodeDupAENameInsert         * 00069200
*                                                                     * 00069300
*                             Meaning: The caller tried to insert to  * 00069400
*                             an application environment with a       * 00069500
*                             duplicate name within the same node     * 00069600
*                             concurrently.                           * 00069700
*                                                                     * 00069800
*                             Action: Make sure not to insert         * 00069900
*                             requests to a dynamic and static        * 00070000
*                             application environment within the same * 00070100
*                             node concurrently.                      * 00070200
*                                                                     * 00070300
*                                                                     * 00070400
*                                                                     * 00070500
*                                                                     * 00070600
*            C    Name: IwmRetCodeEnvError                            * 00070700
*                                                                     * 00070800
*                 Meaning: Environmental error.                       * 00070900
*                                                                     * 00071000
*                                                                     * 00071100
*                 HEX REASON  MEANING/ACTION                          * 00071200
*                 CODE                                                * 00071300
*                                                                     * 00071400
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 00071500
*                                                                     * 00071600
*                             Meaning: Storage is not available for   * 00071700
*                             the request.                            * 00071800
*                                                                     * 00071900
*                             Action: Contact your system programmer. * 00072000
*                             There is a common storage shortage.     * 00072100
*                                                                     * 00072200
*                 xxxx0C16    Name: IwmRsnCodeServerUnavail           * 00072300
*                                                                     * 00072400
*                             Meaning: A server cannot be started to  * 00072500
*                             process the work request.  This is      * 00072600
*                             probably caused by one of the           * 00072700
*                             following:                              * 00072800
*                                                                     * 00072900
*                                                                     * 00073000
*                             1.  An error in the JCL procedure used  * 00073100
*                                 to start the server address space.  * 00073200
*                                                                     * 00073300
*                             2.  Repeated, unexpected terminations   * 00073400
*                                 of the server address space.        * 00073500
*                                                                     * 00073600
*                                                                     * 00073700
*                                                                     * 00073800
*                             In either of these cases, workload      * 00073900
*                             management stops the application        * 00074000
*                             environment.  A DISPLAY WLM command     * 00074100
*                             shows this state as INTERNALLY STOPPED. * 00074200
*                                                                     * 00074300
*                             Action: Look at the system log to       * 00074400
*                             determine what caused the error:        * 00074500
*                                                                     * 00074600
*                                                                     * 00074700
*                             1.  If it is a JCL error, correct the   * 00074800
*                                 error in the procedure.             * 00074900
*                                                                     * 00075000
*                             2.  If it is repeated terminations of   * 00075100
*                                 the server address space, correct   * 00075200
*                                 the application error causing the   * 00075300
*                                 termination.                        * 00075400
*                                                                     * 00075500
*                                                                     * 00075600
*                                                                     * 00075700
*                             In either case, the server environment  * 00075800
*                             can then be resumed using the VARY      * 00075900
*                             operator command: V                     * 00076000
*                             WLM,APLLENV=nnn,RESUME where nnn is the * 00076100
*                             applicable application environment      * 00076200
*                             name.                                   * 00076300
*                                                                     * 00076400
*                             NOTE:  A re-IPL of some or all of the   * 00076500
*                             systems in the sysplex does not reset   * 00076600
*                             the stopped state of the application    * 00076700
*                             environment.  The VARY command is the   * 00076800
*                             only way to resume the environment.     * 00076900
*                                                                     * 00077000
*                 xxxx0C1A    Name: IwmRsnCodeApplNotDefined          * 00077100
*                                                                     * 00077200
*                             Meaning:  The application environment   * 00077300
*                             name is not defined in the active WLM   * 00077400
*                             policy.                                 * 00077500
*                                                                     * 00077600
*                             Action: Check whether the correct       * 00077700
*                             application environment name is being   * 00077800
*                             used.  If so, a service administrator   * 00077900
*                             must define the application environment * 00078000
*                             in the WLM service definition.          * 00078100
*                                                                     * 00078200
*                 xxxx0C1B    Name: IwmRsnCodeApplNotSST              * 00078300
*                                                                     * 00078400
*                             Meaning:  The application environment   * 00078500
*                             name is defined for use by a different  * 00078600
*                             subsystem type in the active WLM        * 00078700
*                             policy.                                 * 00078800
*                                                                     * 00078900
*                             Action: Check whether the correct       * 00079000
*                             application environment name is being   * 00079100
*                             used.  If so, a service administrator   * 00079200
*                             must change the application environment * 00079300
*                             in the WLM service definition to        * 00079400
*                             specify the correct subsystem type.     * 00079500
*                                                                     * 00079600
*                 xxxx0C1D    Name: IwmRsnCodeQMgrNotActive           * 00079700
*                                                                     * 00079800
*                             Meaning:  The required Queue Manager is * 00079900
*                             not active.                             * 00080000
*                                                                     * 00080100
*                             Action: The Queue Manager with the same * 00080200
*                             subsystem type and name as the server   * 00080300
*                             must be started and connected to        * 00080400
*                             workload management before the request  * 00080500
*                             can be honored.                         * 00080600
*                                                                     * 00080700
*                 xxxx0C22    Name: IwmRsnCodeApplEnvQuiesced         * 00080800
*                                                                     * 00080900
*                             Meaning:  For server applications       * 00081000
*                             connecting to WLM with subsystem type   * 00081100
*                             IWEB only: The application environment  * 00081200
*                             has been quiesced. The work reqeust is  * 00081300
*                             not inserted to the WLM work queue.     * 00081400
*                                                                     * 00081500
*                             Action: Resume the application          * 00081600
*                             environment.                            * 00081700
*                                                                     * 00081800
*                 xxxx0C40    Name: IwmRsnCodeNoSafCheckPossible      * 00081900
*                                                                     * 00082000
*                             Meaning:  MLS is active but a security  * 00082100
*                             check could not be performed, probably  * 00082200
*                             for one of the following reasons:       * 00082300
*                                                                     * 00082400
*                                                                     * 00082500
*                             o   No security decision could be made. * 00082600
*                                 The RACF router was not loaded; the * 00082700
*                                 request, resource, subsystem        * 00082800
*                                 combination could not be found in   * 00082900
*                                 the RACF ROUTER table,...           * 00083000
*                                                                     * 00083100
*                             o   A resource or class name is not     * 00083200
*                                 defined to RACF or the class has    * 00083300
*                                 not been RAClisted.                 * 00083400
*                                                                     * 00083500
*                             o   The class was RAClisted, but the    * 00083600
*                                 data space cannot be accessed due   * 00083700
*                                 to an ALESERV failure.              * 00083800
*                                                                     * 00083900
*                             o   The class was RAClisted, but the    * 00084000
*                                 data space has been deleted.        * 00084100
*                                                                     * 00084200
*                             o   No security decision could be made. * 00084300
*                                 The RACF router was not loaded,;    * 00084400
*                                 the request, resource, subsystem    * 00084500
*                                 combination could not be found in   * 00084600
*                                 the RACF ROUTER table.              * 00084700
*                                                                     * 00084800
*                                                                     * 00084900
*                                                                     * 00085000
*                             Action: Contact your RACF Security      * 00085100
*                             Administrator.  Check if RACF is        * 00085200
*                             properly installed, configured and      * 00085300
*                             tuned. Correct the eventual problems.   * 00085400
*                                                                     * 00085500
*                 xxxx0C41    Name: IwmRsnCodeSafCheckFailed          * 00085600
*                                                                     * 00085700
*                             Meaning: MLS is active. Queue Manager   * 00085800
*                             and Server Manager are not authorized   * 00085900
*                             to communicate.                         * 00086000
*                                                                     * 00086100
*                             Action: Normally none. If QM and SM     * 00086200
*                             really must communicate, contact your   * 00086300
*                             RACF Security Administrator. Set the    * 00086400
*                             appropriate Security Labels.            * 00086500
*                                                                     * 00086600
*                 xxxx0C42    Name: IwmRsnCodeAletError               * 00086700
*                                                                     * 00086800
*                             Meaning: Error while accessing access   * 00086900
*                             list with ALESERV probably because of   * 00087000
*                             one of the following                    * 00087100
*                                                                     * 00087200
*                                                                     * 00087300
*                             1.  The current access list cannot be   * 00087400
*                                 expanded. There are no free access  * 00087500
*                                 list entries and the maximum size   * 00087600
*                                 has been reached.                   * 00087700
*                                                                     * 00087800
*                             2.  ALESERV could not obtain storage    * 00087900
*                                 for an expanded access list.        * 00088000
*                                                                     * 00088100
*                                                                     * 00088200
*                                                                     * 00088300
*                             Action: Delete unused entries and       * 00088400
*                             reissue the request in first case. Free * 00088500
*                             some storage and retry the request in   * 00088600
*                             second case.  Contact your System       * 00088700
*                             Programmer if none works                * 00088800
*                                                                     * 00088900
*                                                                     * 00089000
*                                                                     * 00089100
*                                                                     * 00089200
*            10   Name: IwmRetCodeCompError                           * 00089300
*                                                                     * 00089400
*                 Meaning: Component error.                           * 00089500
*                                                                     * 00089600
*                 Action: Contact your system programmer.             * 00089700
*                                                                     * 00089800
*                                                                     * 00089900
*                                                                     * 00090000
*01* REASON CODES:                                                    * 00090100
*                                                                     * 00090200
*       A unique reason code will be returned whenever the return     * 00090300
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00090400
*       under their corresponding return code.  Reason code and       * 00090500
*       return code constants are defined within IWMYCON.  Note that  * 00090600
*       the high order halfword of register 0, and the reason code    * 00090700
*       variable when specified, may be non-zero and represents       * 00090800
*       diagnostic data which is NOT part of the external interface.  * 00090900
*       The high order halfword should thus be excluded from          * 00091000
*       comparison with the reason code values described above.  The  * 00091100
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00091200
*       used for this purpose.                                        * 00091300
*                                                                     * 00091400
*01* MODULE TYPE:  ASSEM MACRO                                        * 00091500
*                                                                     * 00091600
*02*   PROCESSOR:  ASSEM                                              * 00091700
*                                                                     * 00091800
*01* COMPONENT:  SCWLM                                                * 00091900
*                                                                     * 00092000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00092100
*                                                                     * 00092200
*01* EXAMPLES:                                                        * 00092300
*                                                                     * 00092400
*    To insert a work request onto the WLM queue manager queues:      * 00092500
*                                                                     * 00092600
*               IWM4QIN  CONNTKN=CONNTOKEN,ETOKEN=ENCTOKEN,         X * 00092700
*                     USERDATA=USERDATA,APPLENV=APPLENV,SECUSER=NO, X * 00092800
*                     WLMWUTKN=WLMWUTKN,RETCODE=RC,RSNCODE=RSN        * 00092900
*      *                                                              * 00093000
*      * Storage areas                                                * 00093100
*      *                                                              * 00093200
*      CONNTOKEN DS   FL4             Contains the connect token      * 00093300
*      *                              associated with the use of WLM  * 00093400
*      *                              Queuing services as returned by * 00093500
*      *                              IWM4CON                         * 00093600
*      *                              (specifying QUEUE_MANAGER=YES   * 00093700
*      *                              or SERVER_MANAGER=YES           * 00093800
*      *                                   SERVER_TYPE=QUEUE          * 00093900
*      ENCTOKEN DS    CL8             Contains the Enclave token      * 00094000
*      *                              associated with the work        * 00094100
*      *                              request as returned by IWM4ECRE * 00094200
*      USERDATA DS    CL16            Contains data maintained by the * 00094300
*      *                              user                            * 00094400
*      APPLENV  DS    CL32            Contains the application        * 00094500
*      *                              environment name                * 00094600
*      WLMWUTKN DS    CL16            Work unit token                 * 00094700
*      RC       DS    F               Return code                     * 00094800
*      RSN      DS    F               Reason code                     * 00094900
*                                                                     * 00095000
*                                                                     * 00095100
*01* MACRO USAGE NOTES:                                               * 00095200
*                                                                     * 00095300
*                                                                     * 00095400
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00095500
*        global macro variable.  Any value other than 'NO' will       * 00095600
*        result in the macro expansion being printed.  The default is * 00095700
*        'YES'.  The following examples illustrate how the ZPRINT     * 00095800
*        variable should be set.                                      * 00095900
*                                                                     * 00096000
*                    GBLC &ZPRINT                                     * 00096100
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00096200
*                                                                     * 00096300
*                                                                     * 00096400
*    2.  When using the NOCHECK option in conjunction with the Modify * 00096500
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00096600
*        Modify   or  Execute  form  invocation  which  specifies  or * 00096700
*        defaults  to  the  COMPLETE  option.   This insures that the * 00096800
*        parameter  list  is  initialized completely.   The parameter * 00096900
*        list  field which identifies the version number of the macro * 00097000
*        is only set when the Standard form or the Complete option of * 00097100
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00097200
*        explicitly  specified.  Be sure that the resulting parameter * 00097300
*        list version number covers all the keys that you use.        * 00097400
*                                                                     * 00097500
*                                                                     * 00097600
*    3.  All keys currently contained in the IWM4QIN macro correspond * 00097700
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 00097800
*        MAX.                                                         * 00097900
*                                                                     * 00098000
*                                                                     * 00098100
*                                                                     * 00098200
*                                                                     * 00098300
*01* CHANGE ACTIVITY:                                                 * 00098400
*                                                                     * 00098500
*   Flag LineItem  FMID    Date   ID    Comment                       * 00098600
*                                                                     * 00098700
*    $L0=WLMP64W  HBB7709 030315 3241NN:  WLM 64-bit support copied   * 00098800
*                                         from IWMQINS  with flag L9  * 00098900
*    $L1=WLMPDRE  HBB7709 030520 3241UH:  Dependent Work Requests     * 00099000
*                                         Support                     * 00099100
*    $P1=PJK1267  HBB7709 040107 3241UH:  Add new reason code         * 00099200
*                                         description                 * 00099300
****** END OF SPECIFICATIONS *****************************************/ 00099400
*/********************************************************************* 00099500
         MACRO                                                          00099600
&XLABEL  IWM4QIN &CONNTKN=,&ETOKEN=,&USERDATA=,&APPLENV=,&DYNAMIC=,    *00099700
               &DEPENDENT=,&SECUSER=,&USERID=,&WLMWUTKN=,              *00099800
               &SERVER_TOKEN=,&REGION_TOKEN=,&RETCODE=,&RSNCODE=,      *00099900
               &PLISTVER=,&MF=                                          00100000
.*                                                                      00100100
*                  MACDATE -04/28/07-<0>                                00100200
.*                                                                      00100300
.*******************************************************************    00100400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00100500
.*******************************************************************    00100600
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00100700
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00100800
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00100900
.*                                                                      00101000
                  GBLC  &ZIWM4QIN   YES=MACRO USED AT LEAST ONCE        00101100
.*******************************************************************    00101200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00101300
.*******************************************************************    00101400
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00101500
                  LCLC  &ZCNDX      SYSNDX CHARACTERS                   00101600
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00101700
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00101800
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00101900
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00102000
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00102100
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00102200
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00102300
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00102400
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00102500
                  LCLC  &ZMAC_G     "G" or null                         00102600
&ZMAC_G           SETC  ''                                              00102700
                  LCLC  &ZMAC_LR                                        00102800
&ZMAC_LR          SETC  'LR'                                            00102900
                  LCLC  &ZMAC_L                                         00103000
&ZMAC_L           SETC  'L'                                             00103100
                  LCLC  &ZMAC_ST                                        00103200
&ZMAC_ST          SETC  'ST'                                            00103300
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00103400
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00103500
.*                                                                      00103600
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00103700
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00103800
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00103900
                  LCLC  &ZENDBASEPL             End of base PL          00104000
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00104100
.*******************************************************************    00104200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00104300
.*******************************************************************    00104400
                  LCLA  &ZI         INDEX FOR ARRAY                     00104500
                  LCLA  &ZJ         INDEX FOR PARMS                     00104600
                  LCLA  &ZK         INDEX FOR PARSE                     00104700
                  LCLA  &ZLO        LOW RANGE VALUE                     00104800
                  LCLA  &ZHI        HIGH RANGE VALUE                    00104900
                  LCLC  &ZW         WORK AREA FOR PARM                  00105000
.********************************************************************   00105100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00105200
.********************************************************************   00105300
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00105400
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00105500
                  GBLA  &SYSALVL    SYSSTATE ARCHLVL                    00105600
                  GBLC  &SYSAM64    SYSSTATE AMODE64                    00105700
.*                                                                      00105800
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00105900
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00106000
                  SPLEVEL  TEST                                         00106100
.ZSYS2            ANOP  ,                                               00106200
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00106300
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00106400
                  SYSSTATE TEST                                         00106500
&ZMAC_G           SETC 'G'                                              00106600
&ZMAC_LR          SETC 'LGR'                                            00106700
&ZMAC_L           SETC 'LG'                                             00106800
&ZMAC_ST          SETC 'STG'                                            00106900
                  AGO   .ZSYS4                                          00107000
.ZSYS3            ANOP  ,                                               00107100
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00107200
.ZSYS4            ANOP  ,                                               00107300
.*******************************************************************    00107400
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00107500
.*******************************************************************    00107600
                  LCLC  &XCONNTKN   ++ NAME                             00107700
                  LCLC  &XETOKEN    ++ NAME                             00107800
                  LCLC  &XUSERDATA  ++ NAME                             00107900
                  LCLC  &XAPPLENV   ++ NAME                             00108000
                  LCLC  &XDYNAMIC   ++ VALUE                            00108100
                  LCLC  &XDEPENDENT             ++ VALUE                00108200
                  LCLC  &XSECUSER   ++ VALUE                            00108300
                  LCLC  &XUSERID    ++ NAME                             00108400
                  LCLC  &XWLMWUTKN  ++ NAME                             00108500
                  LCLC  &XSERVER_TOKEN          ++ NAME                 00108600
                  LCLC  &XREGION_TOKEN          ++ NAME                 00108700
                  LCLC  &XRETCODE   ++ NAME                             00108800
                  LCLC  &XRSNCODE   ++ NAME                             00108900
                  LCLA  &XPLISTVER  ++ VALUE                            00109000
                  LCLC  &XMF        ++ VALUE                            00109100
                  LCLC  &XMFCTRL    ++ NAME                             00109200
                  LCLC  &XMFATTR    ++ VALUE                            00109300
                  LCLC  &XMFSCK     ++ VALUE                            00109400
.*******************************************************************    00109500
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00109600
.*******************************************************************    00109700
                  LCLC  &ZXCONNTKN  ++ INPUT NAME                       00109800
                  LCLC  &ZXETOKEN   ++ INPUT NAME                       00109900
                  LCLC  &ZXUSERDATA             ++ INPUT NAME           00110000
                  LCLC  &ZXAPPLENV  ++ INPUT NAME                       00110100
                  LCLC  &ZXDYNAMIC  ++ INPUT VALUE                      00110200
                  LCLC  &ZXDEPENDENT            ++ INPUT VALUE          00110300
                  LCLC  &ZXSECUSER  ++ INPUT VALUE                      00110400
                  LCLC  &ZXUSERID   ++ INPUT NAME                       00110500
                  LCLC  &ZXWLMWUTKN             ++ OUTPUT NAME          00110600
                  LCLC  &ZXSERVER_TOKEN         ++ INPUT NAME           00110700
                  LCLC  &ZXREGION_TOKEN         ++ INPUT NAME           00110800
                  LCLC  &ZXRETCODE  ++ OUTPUT NAME                      00110900
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00111000
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00111100
                  LCLC  &ZXMF       ++ INPUT VALUE                      00111200
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00111300
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00111400
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00111500
.********************************************************************   00111600
.***AC.PLV01  PROCESS PLISTVER                                      *   00111700
.********************************************************************   00111800
&XPLISTVER      SETA  0                                                 00111900
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00112000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00112100
&XPLISTVER      SETA  0                                                 00112200
.ZPLV0          ANOP  ,                                                 00112300
.*                                                                      00112400
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00112500
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00112600
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00112700
.*-------------------------------------------------------------------   00112800
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00112900
&ZMS            SETC  '"PLISTVER='                                      00113000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00113100
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00113200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00113300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00113400
                AGO   .ZPVCK2                                           00113500
.ZPVCK3         ANOP  ,                                                 00113600
.*-------------------------------------------------------------------   00113700
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00113800
&ZMS            SETC  '"PLISTVER='                                      00113900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00114000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00114100
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00114200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00114300
                AGO   .ZPVCKE                                           00114400
.ZPVCK2         ANOP  ,                                                 00114500
.*-------------------------------------------------------------------   00114600
&ZCVAL          SETC  '&PLISTVER(1)'                                    00114700
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00114800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00114900
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00115000
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00115100
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00115200
.ZPVCK6         ANOP  ,                                                 00115300
&ZMS            SETC  '"PLISTVER='                                      00115400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00115500
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00115600
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00115700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00115800
&XPLISTVER      SETA  0                                                 00115900
                AGO   .ZPVCKE                                           00116000
.*-------------------------------------------------------------------   00116100
.ZPVCK4A        ANOP  ,                                                 00116200
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00116300
&ZMS            SETC  'PLISTVER='                                       00116400
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00116500
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00116600
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00116700
                MNOTE 8,' &ZMS IS REQUIRED.'                            00116800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00116900
                AGO   .ZPVCK5                                           00117000
.ZPVCK4         ANOP  ,                                                 00117100
&XPLISTVER      SETA  &PLISTVER(1)                                      00117200
.ZPVCK5         ANOP  ,                                                 00117300
.ZPVCKE         ANOP  ,                                                 00117400
.********************************************************************   00117500
.***AG.MF01 PROCESS MF MACRO FORMS                                      00117600
.********************************************************************   00117700
                  ACTR  10000                                           00117800
.*------------------------------------------------------------------    00117900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00118000
&XMF              SETC  ''          INITIALIZE XVARIABLE                00118100
.*-------------------------------------------------------------------   00118200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00118300
.ZG51             ANOP  ,                                               00118400
&ZTLC             SETC 'S'                                              00118500
                  AIF   ('&MF(1)' NE '&ZTLC').ZG52                      00118600
&XMF              SETC  'S'         SET KEYWORD                         00118700
&XMFSCK           SETC  'COMPLETE'  SET XMFSCK                          00118800
                  AIF   (N'&MF LE 1).ZG51A      CK NUM                  00118900
&ZMS              SETC  '"MF='                                          00119000
&ZMS              SETC  '&ZMS.&MF"'                                     00119100
&ZMS              SETC  '&ZMS "MF"'                                     00119200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00119300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00119400
.ZG51A            ANOP  ,                                               00119500
.*-------------------------------------------------------------------   00119600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119700
.ZG52             ANOP  ,                                               00119800
&ZTLC             SETC 'L'                                              00119900
                  AIF   ('&MF(1)' NE '&ZTLC').ZG59                      00120000
&XMF              SETC  'L'         SET KEYWORD                         00120100
                  AIF   (N'&MF LE 3).ZG52A      CK NUM                  00120200
&ZMS              SETC  '"MF='                                          00120300
&ZMS              SETC  '&ZMS.&MF"'                                     00120400
&ZMS              SETC  '&ZMS "MF"'                                     00120500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00120600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00120700
.ZG52A            ANOP  ,                                               00120800
.*-------------------------------------------------------------------   00120900
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00121000
                  AIF   (N'&SYSLIST NE 0).ZG52B  POSITIONALS?           00121100
                  AIF   ('&CONNTKN' NE '').ZG52B  KEYS?                 00121200
                  AIF   ('&ETOKEN' NE '').ZG52B  KEYS?                  00121300
                  AIF   ('&USERDATA' NE '').ZG52B  KEYS?                00121400
                  AIF   ('&APPLENV' NE '').ZG52B  KEYS?                 00121500
                  AIF   ('&DYNAMIC' NE '').ZG52B  KEYS?                 00121600
                  AIF   ('&DEPENDENT' NE '').ZG52B  KEYS?               00121700
                  AIF   ('&SECUSER' NE '').ZG52B  KEYS?                 00121800
                  AIF   ('&USERID' NE '').ZG52B  KEYS?                  00121900
                  AIF   ('&WLMWUTKN' NE '').ZG52B  KEYS?                00122000
                  AIF   ('&SERVER_TOKEN' NE '').ZG52B  KEYS?            00122100
                  AIF   ('&REGION_TOKEN' NE '').ZG52B  KEYS?            00122200
                  AIF   ('&RETCODE' NE '').ZG52B  KEYS?                 00122300
                  AIF   ('&RSNCODE' NE '').ZG52B  KEYS?                 00122400
                  AGO    .ZG52C     INVOCATION OKAY                     00122500
.ZG52B            ANOP  ,                                               00122600
&ZMS              SETC  'THE "L" FORM OF "MF"'                          00122700
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00122800
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00122900
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00123000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00123100
.ZG52C            ANOP  ,                                               00123200
.*-------------------------------------------------------------------   00123300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00123400
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00123500
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00123600
                  AIF   (N'&MF(2) GT 1).ZG54B   MULTI PARMS             00123700
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00123800
.ZG54B            AIF   (K'&MF(2) GT 0).ZG54C                           00123900
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00124000
&ZMS              SETC  'WHEN "L" IS SPECIFIED'                         00124100
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00124200
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00124300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00124400
.ZG54C            ANOP  ,                                               00124500
.*-------------------------------------------------------------------   00124600
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00124700
                  AIF   (K'&ZXMFCTRL LE 0).ZG54P  NOT I/O               00124800
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG54P                  00124900
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00125000
&ZMS              SETC  '"MF='                                          00125100
&ZMS              SETC  '&ZMS.&MF"'                                     00125200
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00125300
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00125400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00125500
.ZG54P            ANOP  ,                                               00125600
.*-------------------------------------------------------------------   00125700
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00125800
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00125900
&XMFATTR          SETC  '0D'                                            00126000
                  AIF   (K'&MF(3) LE 0).ZG57B   PARM                    00126100
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00126200
                  AIF   (N'&MF(3) GT 1).ZG57B   MULTI                   00126300
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00126400
.ZG57B            ANOP  ,                                               00126500
.*-------------------------------------------------------------------   00126600
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00126700
                  AIF   (K'&ZXMFATTR LE 0).ZG57P  NOT I/O               00126800
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG57P                  00126900
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00127000
&ZMS              SETC  '"MF='                                          00127100
&ZMS              SETC  '&ZMS.&MF"'                                     00127200
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00127300
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00127400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00127500
.ZG57P            ANOP  ,                                               00127600
.*-------------------------------------------------------------------   00127700
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00127800
                  AIF   (K'&ZXMFATTR LE 0).ZG57S  NOT I/O               00127900
                  AIF   (K'&XMFATTR LE 60).ZG57S  LNG OK                00128000
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00128100
&ZMS              SETC  '"MF='                                          00128200
&ZMS              SETC  '&ZMS.&MF"'                                     00128300
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00128400
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00128500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00128600
.ZG57S            ANOP  ,                                               00128700
.*-------------------------------------------------------------------   00128800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128900
.ZG59             ANOP  ,                                               00129000
&ZTLC             SETC 'M'                                              00129100
                  AIF   ('&MF(1)' NE '&ZTLC').ZG68                      00129200
&XMF              SETC  'M'         SET KEYWORD                         00129300
                  AIF   (N'&MF LE 3).ZG59A      CK NUM                  00129400
&ZMS              SETC  '"MF='                                          00129500
&ZMS              SETC  '&ZMS.&MF"'                                     00129600
&ZMS              SETC  '&ZMS "MF"'                                     00129700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00129800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00129900
.ZG59A            ANOP  ,                                               00130000
.*-------------------------------------------------------------------   00130100
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00130200
                  AIF   ('&WLMWUTKN' NE '').ZG59B  OUTPUT?              00130300
                  AGO    .ZG59C     INVOCATION OKAY                     00130400
.ZG59B            ANOP  ,                                               00130500
&ZMS              SETC  'THE "M" FORM OF "MF" CANNOT'                   00130600
&ZMS              SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'         00130700
&ZMS              SETC  '&ZMS SPECIFIED ON THE INVOCATION:'             00130800
&ZMS              SETC  '&ZMS "WLMWUTKN"'                               00130900
                  MNOTE 8,' &ZMS '                                      00131000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00131100
.ZG59C            ANOP  ,                                               00131200
.*-------------------------------------------------------------------   00131300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00131400
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00131500
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00131600
                  AIF   (N'&MF(2) GT 1).ZG61B   MULTI PARMS             00131700
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00131800
.ZG61B            AIF   (K'&MF(2) GT 0).ZG61C                           00131900
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00132000
&ZMS              SETC  'WHEN "M" IS SPECIFIED'                         00132100
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00132200
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00132300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00132400
.ZG61C            ANOP  ,                                               00132500
.*-------------------------------------------------------------------   00132600
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00132700
                  AIF   (K'&ZXMFCTRL LE 0).ZG61R  NOT I/O               00132800
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG61R                  00132900
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00133000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                    00133100
                  AIF   (K'&ZCGPR GT 2).ZG61Q                           00133200
                  AIF   ('&ZCGPR' EQ '0').ZG61Q                         00133300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00133400
                  AIF   (T'&ZCGPR NE 'N').ZG61Q  INVALID REG NAME       00133500
.ZG61P            ANOP  ,                                               00133600
                  AIF   (T'&ZCGPR NE 'N').ZG61R  NON NUMERIC            00133700
                  AIF   ('&ZCGPR' LT '1').ZG61Q                         00133800
                  AIF   ('&ZCGPR' LE '12').ZG61R                        00133900
.ZG61Q            ANOP  ,                                               00134000
&ZMS              SETC  '"MF='                                          00134100
&ZMS              SETC  '&ZMS.&MF"'                                     00134200
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00134300
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00134400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00134500
.ZG61R            ANOP  ,                                               00134600
.*-------------------------------------------------------------------   00134700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00134800
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00134900
.ZG65A   AIF   ('&MF(3)' NE 'COMPLETE').ZG66A                           00135000
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00135100
.*-------------------------------------------------------------------   00135200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00135300
.ZG66A   AIF   ('&MF(3)' NE 'NOCHECK').ZG67A                            00135400
&XMFSCK           SETC  'NOCHECK'   SET KEYWORD                         00135500
.*-------------------------------------------------------------------   00135600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00135700
.ZG67A            AIF   (K'&XMFSCK GT 0).ZG67C  KEYWORD                 00135800
                  AIF   (K'&MF(3) LE 0).ZG67B                           00135900
&ZMS              SETC  '"MF='                                          00136000
&ZMS              SETC  '&ZMS.&MF"'                                     00136100
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00136200
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00136300
&ZMS              SETC  '&ZMS "COMPLETE"'                               00136400
&ZMS              SETC  '&ZMS OR "NOCHECK".'                            00136500
                  MNOTE 8,' &ZMS '                                      00136600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00136700
.ZG67B            ANOP  ,                                               00136800
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00136900
.ZG67C            ANOP  ,                                               00137000
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00137100
.*-------------------------------------------------------------------   00137200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137300
.ZG68             ANOP  ,                                               00137400
&ZTLC             SETC 'E'                                              00137500
                  AIF   ('&MF(1)' NE '&ZTLC').ZG77                      00137600
&XMF              SETC  'E'         SET KEYWORD                         00137700
                  AIF   (N'&MF LE 3).ZG68A      CK NUM                  00137800
&ZMS              SETC  '"MF='                                          00137900
&ZMS              SETC  '&ZMS.&MF"'                                     00138000
&ZMS              SETC  '&ZMS "MF"'                                     00138100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00138200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00138300
.ZG68A            ANOP  ,                                               00138400
.*-------------------------------------------------------------------   00138500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00138600
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00138700
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00138800
                  AIF   (N'&MF(2) GT 1).ZG70B   MULTI PARMS             00138900
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00139000
.ZG70B            AIF   (K'&MF(2) GT 0).ZG70C                           00139100
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00139200
&ZMS              SETC  'WHEN "E" IS SPECIFIED'                         00139300
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00139400
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00139500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00139600
.ZG70C            ANOP  ,                                               00139700
.*-------------------------------------------------------------------   00139800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00139900
                  AIF   (K'&ZXMFCTRL LE 0).ZG70R  NOT I/O               00140000
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG70R                  00140100
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00140200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG70P                    00140300
                  AIF   (K'&ZCGPR GT 2).ZG70Q                           00140400
                  AIF   ('&ZCGPR' EQ '0').ZG70Q                         00140500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00140600
                  AIF   (T'&ZCGPR NE 'N').ZG70Q  INVALID REG NAME       00140700
.ZG70P            ANOP  ,                                               00140800
                  AIF   (T'&ZCGPR NE 'N').ZG70R  NON NUMERIC            00140900
                  AIF   ('&ZCGPR' LT '1').ZG70Q                         00141000
                  AIF   ('&ZCGPR' LE '12').ZG70R                        00141100
.ZG70Q            ANOP  ,                                               00141200
&ZMS              SETC  '"MF='                                          00141300
&ZMS              SETC  '&ZMS.&MF"'                                     00141400
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00141500
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00141600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00141700
.ZG70R            ANOP  ,                                               00141800
.*-------------------------------------------------------------------   00141900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00142000
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00142100
.ZG74A   AIF   ('&MF(3)' NE 'COMPLETE').ZG75A                           00142200
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00142300
.*-------------------------------------------------------------------   00142400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00142500
.ZG75A   AIF   ('&MF(3)' NE 'NOCHECK').ZG76A                            00142600
&XMFSCK           SETC  'NOCHECK'   SET KEYWORD                         00142700
.*-------------------------------------------------------------------   00142800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00142900
.ZG76A            AIF   (K'&XMFSCK GT 0).ZG76C  KEYWORD                 00143000
                  AIF   (K'&MF(3) LE 0).ZG76B                           00143100
&ZMS              SETC  '"MF='                                          00143200
&ZMS              SETC  '&ZMS.&MF"'                                     00143300
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00143400
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00143500
&ZMS              SETC  '&ZMS "COMPLETE"'                               00143600
&ZMS              SETC  '&ZMS OR "NOCHECK".'                            00143700
                  MNOTE 8,' &ZMS '                                      00143800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00143900
.ZG76B            ANOP  ,                                               00144000
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00144100
.ZG76C            ANOP  ,                                               00144200
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00144300
.*------------------------------------------------------------------    00144400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144500
.ZG77             ANOP  ,                                               00144600
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00144700
                  AIF   (K'&XMF GT 0).ZG77E     VALID ARG               00144800
                  AIF   (T'&MF EQ 'O').ZG77D    OMITTED                 00144900
&ZASYSLNDX        SETA  0                                               00145000
.ZG77A            ANOP  ,           POSITIONAL MACRO KEY                00145100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00145200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG77C                00145300
&ZTLC             SETC 'MF'                                             00145400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG77A       00145500
.ZG77B            ANOP  ,                                               00145600
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00145700
&ZMS              SETC  'THE "MF" KEY'                                  00145800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00145900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00146000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00146100
                  AGO   .ZG77E                                          00146200
.ZG77C            ANOP  ,                                               00146300
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00146400
&ZMS              SETC  '"MF='                                          00146500
&ZMS              SETC  '&ZMS.&MF"'                                     00146600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00146700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00146800
&ZMS              SETC  '&ZMS "S",'                                     00146900
&ZMS              SETC  '&ZMS "L",'                                     00147000
&ZMS              SETC  '&ZMS "M",'                                     00147100
&ZMS              SETC  '&ZMS OR "E".'                                  00147200
                  MNOTE 8,' &ZMS '                                      00147300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00147400
                  AGO   .ZG77E                                          00147500
.ZG77D            ANOP  ,                                               00147600
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00147700
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00147800
.ZG77E            ANOP  ,                                               00147900
.********************************************************************   00148000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00148100
.********************************************************************   00148200
                  ACTR  10000                                           00148300
.*-------------------------------------------------------------------   00148400
.***AG.MF03 MF=(SLME)                                                   00148500
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00148600
                  AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                 00148700
.*----------------------------------------------------------------***   00148800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00148900
                  AIF   (N'&CONNTKN LE 1).ZG2A  CK NUM                  00149000
&ZMS              SETC  '"CONNTKN='                                     00149100
&ZMS              SETC  '&ZMS.&CONNTKN"'                                00149200
&ZMS              SETC  '&ZMS "CONNTKN"'                                00149300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00149400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00149500
.ZG2A             ANOP  ,                                               00149600
.*-------------------------------------------------------------------   00149700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00149800
&ZXCONNTKN        SETC  'INPUT'     SET IN/OUTPUT                       00149900
&XCONNTKN         SETC  '&CONNTKN(1)'           SET XVARIABLE           00150000
                  AIF   (N'&CONNTKN GT 1).ZG2B  MULTI PARMS             00150100
&XCONNTKN         SETC  '&CONNTKN'  SET XVARIABLE                       00150200
.ZG2B             AIF   (K'&CONNTKN(1) GT 0).ZG2C                       00150300
&ZXCONNTKN        SETC  ''          RESET IN/OUTPUT                     00150400
&ZMS              SETC  ' '                                             00150500
&ZMS              SETC  '&ZMS "CONNTKN" KEY AND ITS'                    00150600
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00150700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00150800
.ZG2C             ANOP  ,                                               00150900
.*-------------------------------------------------------------------   00151000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00151100
                  AIF   (K'&ZXCONNTKN LE 0).ZG2R  NOT I/O               00151200
                  AIF   ('&XCONNTKN'(1,1) NE '(').ZG2R                  00151300
&ZCGPR            SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                    00151400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                     00151500
                  AIF   (K'&ZCGPR GT 2).ZG2Q                            00151600
                  AIF   ('&ZCGPR' EQ '0').ZG2Q                          00151700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00151800
                  AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME        00151900
.ZG2P             ANOP  ,                                               00152000
                  AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC             00152100
                  AIF   ('&ZCGPR' LT '2').ZG2Q                          00152200
                  AIF   ('&ZCGPR' LE '12').ZG2R                         00152300
.ZG2Q             ANOP  ,                                               00152400
&ZMS              SETC  '"CONNTKN='                                     00152500
&ZMS              SETC  '&ZMS.&CONNTKN"'                                00152600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00152700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00152800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00152900
.ZG2R             ANOP  ,                                               00153000
.*----------------------------------------------------------------***   00153100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00153200
                  AIF   (N'&ETOKEN LE 1).ZG5A   CK NUM                  00153300
&ZMS              SETC  '"ETOKEN='                                      00153400
&ZMS              SETC  '&ZMS.&ETOKEN"'                                 00153500
&ZMS              SETC  '&ZMS "ETOKEN"'                                 00153600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00153700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00153800
.ZG5A             ANOP  ,                                               00153900
.*-------------------------------------------------------------------   00154000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00154100
&ZXETOKEN         SETC  'INPUT'     SET IN/OUTPUT                       00154200
&XETOKEN          SETC  '&ETOKEN(1)'            SET XVARIABLE           00154300
                  AIF   (N'&ETOKEN GT 1).ZG5B   MULTI PARMS             00154400
&XETOKEN          SETC  '&ETOKEN'   SET XVARIABLE                       00154500
.ZG5B             AIF   (K'&ETOKEN(1) GT 0).ZG5C                        00154600
&ZXETOKEN         SETC  ''          RESET IN/OUTPUT                     00154700
&ZMS              SETC  ' '                                             00154800
&ZMS              SETC  '&ZMS "ETOKEN" KEY AND ITS'                     00154900
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00155000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00155100
.ZG5C             ANOP  ,                                               00155200
.*-------------------------------------------------------------------   00155300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00155400
                  AIF   (K'&ZXETOKEN LE 0).ZG5R  NOT I/O                00155500
                  AIF   ('&XETOKEN'(1,1) NE '(').ZG5R                   00155600
&ZCGPR            SETC  '&XETOKEN'(2,K'&XETOKEN-2)                      00155700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                     00155800
                  AIF   (K'&ZCGPR GT 2).ZG5Q                            00155900
                  AIF   ('&ZCGPR' EQ '0').ZG5Q                          00156000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00156100
                  AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME        00156200
.ZG5P             ANOP  ,                                               00156300
                  AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC             00156400
                  AIF   ('&ZCGPR' LT '2').ZG5Q                          00156500
                  AIF   ('&ZCGPR' LE '12').ZG5R                         00156600
.ZG5Q             ANOP  ,                                               00156700
&ZMS              SETC  '"ETOKEN='                                      00156800
&ZMS              SETC  '&ZMS.&ETOKEN"'                                 00156900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00157000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00157100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00157200
.ZG5R             ANOP  ,                                               00157300
.*----------------------------------------------------------------***   00157400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00157500
                  AIF   (N'&USERDATA LE 1).ZG8A  CK NUM                 00157600
&ZMS              SETC  '"USERDATA='                                    00157700
&ZMS              SETC  '&ZMS.&USERDATA"'                               00157800
&ZMS              SETC  '&ZMS "USERDATA"'                               00157900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00158000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00158100
.ZG8A             ANOP  ,                                               00158200
.*-------------------------------------------------------------------   00158300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00158400
&ZXUSERDATA       SETC  'INPUT'     SET IN/OUTPUT                       00158500
&XUSERDATA        SETC  '&USERDATA(1)'          SET XVARIABLE           00158600
                  AIF   (N'&USERDATA GT 1).ZG8B  MULTI PARMS            00158700
&XUSERDATA        SETC  '&USERDATA'             SET XVARIABLE           00158800
.ZG8B             AIF   (K'&USERDATA(1) GT 0).ZG8C                      00158900
&ZXUSERDATA       SETC  ''          RESET IN/OUTPUT                     00159000
&ZMS              SETC  ' '                                             00159100
&ZMS              SETC  '&ZMS "USERDATA" KEY AND ITS'                   00159200
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00159300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00159400
.ZG8C             ANOP  ,                                               00159500
.*-------------------------------------------------------------------   00159600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00159700
                  AIF   (K'&ZXUSERDATA LE 0).ZG8R  NOT I/O              00159800
                  AIF   ('&XUSERDATA'(1,1) NE '(').ZG8R                 00159900
&ZCGPR            SETC  '&XUSERDATA'(2,K'&XUSERDATA-2)                  00160000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                     00160100
                  AIF   (K'&ZCGPR GT 2).ZG8Q                            00160200
                  AIF   ('&ZCGPR' EQ '0').ZG8Q                          00160300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00160400
                  AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME        00160500
.ZG8P             ANOP  ,                                               00160600
                  AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC             00160700
                  AIF   ('&ZCGPR' LT '2').ZG8Q                          00160800
                  AIF   ('&ZCGPR' LE '12').ZG8R                         00160900
.ZG8Q             ANOP  ,                                               00161000
&ZMS              SETC  '"USERDATA='                                    00161100
&ZMS              SETC  '&ZMS.&USERDATA"'                               00161200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00161300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00161400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00161500
.ZG8R             ANOP  ,                                               00161600
.*----------------------------------------------------------------***   00161700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00161800
                  AIF   (N'&APPLENV LE 1).ZG11A  CK NUM                 00161900
&ZMS              SETC  '"APPLENV='                                     00162000
&ZMS              SETC  '&ZMS.&APPLENV"'                                00162100
&ZMS              SETC  '&ZMS "APPLENV"'                                00162200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00162300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00162400
.ZG11A            ANOP  ,                                               00162500
.*-------------------------------------------------------------------   00162600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00162700
&ZXAPPLENV        SETC  'INPUT'     SET IN/OUTPUT                       00162800
&XAPPLENV         SETC  '&APPLENV(1)'           SET XVARIABLE           00162900
                  AIF   (N'&APPLENV GT 1).ZG11B  MULTI PARMS            00163000
&XAPPLENV         SETC  '&APPLENV'  SET XVARIABLE                       00163100
.ZG11B            AIF   (K'&APPLENV(1) GT 0).ZG11C                      00163200
&ZXAPPLENV        SETC  ''          RESET IN/OUTPUT                     00163300
&ZMS              SETC  ' '                                             00163400
&ZMS              SETC  '&ZMS "APPLENV" KEY AND ITS'                    00163500
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00163600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00163700
.ZG11C            ANOP  ,                                               00163800
.*-------------------------------------------------------------------   00163900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00164000
                  AIF   (K'&ZXAPPLENV LE 0).ZG11R  NOT I/O              00164100
                  AIF   ('&XAPPLENV'(1,1) NE '(').ZG11R                 00164200
&ZCGPR            SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                    00164300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                    00164400
                  AIF   (K'&ZCGPR GT 2).ZG11Q                           00164500
                  AIF   ('&ZCGPR' EQ '0').ZG11Q                         00164600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00164700
                  AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME       00164800
.ZG11P            ANOP  ,                                               00164900
                  AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC            00165000
                  AIF   ('&ZCGPR' LT '2').ZG11Q                         00165100
                  AIF   ('&ZCGPR' LE '12').ZG11R                        00165200
.ZG11Q            ANOP  ,                                               00165300
&ZMS              SETC  '"APPLENV='                                     00165400
&ZMS              SETC  '&ZMS.&APPLENV"'                                00165500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00165600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00165700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00165800
.ZG11R            ANOP  ,                                               00165900
.*------------------------------------------------------------------    00166000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00166100
&XDYNAMIC         SETC  ''          INITIALIZE XVARIABLE                00166200
.*-------------------------------------------------------------------   00166300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00166400
.ZG14             ANOP  ,                                               00166500
                  AIF   (K'&DYNAMIC(1) LE 0).ZG14A                      00166600
&ZTLC             SETC 'NO'                                             00166700
                  AIF   ('&DYNAMIC(1)' NE '&ZTLC').ZG15                 00166800
&XDYNAMIC         SETC  'NO'        SET KEYWORD                         00166900
                  AIF   (N'&DYNAMIC LE 1).ZG14A  CK NUM                 00167000
&ZMS              SETC  '"DYNAMIC='                                     00167100
&ZMS              SETC  '&ZMS.&DYNAMIC"'                                00167200
&ZMS              SETC  '&ZMS "DYNAMIC"'                                00167300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00167400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00167500
.ZG14A            ANOP  ,                                               00167600
.*-------------------------------------------------------------------   00167700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167800
.ZG15             ANOP  ,                                               00167900
&ZTLC             SETC 'YES'                                            00168000
                  AIF   ('&DYNAMIC(1)' NE '&ZTLC').ZG16                 00168100
&XDYNAMIC         SETC  'YES'       SET KEYWORD                         00168200
                  AIF   (N'&DYNAMIC LE 1).ZG15A  CK NUM                 00168300
&ZMS              SETC  '"DYNAMIC='                                     00168400
&ZMS              SETC  '&ZMS.&DYNAMIC"'                                00168500
&ZMS              SETC  '&ZMS "DYNAMIC"'                                00168600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00168700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00168800
.ZG15A            ANOP  ,                                               00168900
.*------------------------------------------------------------------    00169000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169100
.ZG16             ANOP  ,                                               00169200
&ZXDYNAMIC        SETC  'INPUT'     SET IN/OUTPUT                       00169300
                  AIF   (K'&XDYNAMIC GT 0).ZG16E  VALID ARG             00169400
                  AIF   (T'&DYNAMIC EQ 'O').ZG16D  OMITTED              00169500
&ZASYSLNDX        SETA  0                                               00169600
.ZG16A            ANOP  ,           POSITIONAL MACRO KEY                00169700
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00169800
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C                00169900
&ZTLC             SETC 'DYNAMIC'                                        00170000
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG16A       00170100
.ZG16B            ANOP  ,                                               00170200
&ZXDYNAMIC        SETC  ''          RESET IN/OUTPUT                     00170300
&ZMS              SETC  'THE "DYNAMIC" KEY'                             00170400
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00170500
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00170600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00170700
                  AGO   .ZG16E                                          00170800
.ZG16C            ANOP  ,                                               00170900
&ZXDYNAMIC        SETC  ''          RESET IN/OUTPUT                     00171000
&ZMS              SETC  '"DYNAMIC='                                     00171100
&ZMS              SETC  '&ZMS.&DYNAMIC"'                                00171200
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00171300
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00171400
&ZMS              SETC  '&ZMS "NO"'                                     00171500
&ZMS              SETC  '&ZMS OR "YES".'                                00171600
                  MNOTE 8,' &ZMS '                                      00171700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00171800
                  AGO   .ZG16E                                          00171900
.ZG16D            ANOP  ,                                               00172000
&XDYNAMIC         SETC  'NO'        SET DEFAULT KEYWORD                 00172100
.ZG16E            ANOP  ,                                               00172200
.*------------------------------------------------------------------    00172300
.***AG.KKCTL07 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00172400
                  AIF   (K'&APPLENV(1) GT 0).ZG16F  KEY                 00172500
                  AIF   (K'&DYNAMIC(1) LE 0).ZG16F  PARM                00172600
&ZMS              SETC  '"DYNAMIC'                                      00172700
&ZMS              SETC  '&ZMS.=&DYNAMIC"'                               00172800
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00172900
&ZMS              SETC  '&ZMS '                                         00173000
&ZMS              SETC  '&ZMS "APPLENV"'                                00173100
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00173200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00173300
.ZG16F            ANOP  ,                                               00173400
.*------------------------------------------------------------------    00173500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173600
&XDEPENDENT       SETC  ''          INITIALIZE XVARIABLE                00173700
.*-------------------------------------------------------------------   00173800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173900
.ZG20             ANOP  ,                                               00174000
                  AIF   (K'&DEPENDENT(1) LE 0).ZG20A                    00174100
&ZTLC             SETC 'NO'                                             00174200
                  AIF   ('&DEPENDENT(1)' NE '&ZTLC').ZG21               00174300
&XDEPENDENT       SETC  'NO'        SET KEYWORD                         00174400
                  AIF   (N'&DEPENDENT LE 1).ZG20A  CK NUM               00174500
&ZMS              SETC  '"DEPENDENT='                                   00174600
&ZMS              SETC  '&ZMS.&DEPENDENT"'                              00174700
&ZMS              SETC  '&ZMS "DEPENDENT"'                              00174800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00174900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00175000
.ZG20A            ANOP  ,                                               00175100
.*-------------------------------------------------------------------   00175200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00175300
.ZG21             ANOP  ,                                               00175400
&ZTLC             SETC 'YES'                                            00175500
                  AIF   ('&DEPENDENT(1)' NE '&ZTLC').ZG22               00175600
&XDEPENDENT       SETC  'YES'       SET KEYWORD                         00175700
                  AIF   (N'&DEPENDENT LE 1).ZG21A  CK NUM               00175800
&ZMS              SETC  '"DEPENDENT='                                   00175900
&ZMS              SETC  '&ZMS.&DEPENDENT"'                              00176000
&ZMS              SETC  '&ZMS "DEPENDENT"'                              00176100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00176200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00176300
.ZG21A            ANOP  ,                                               00176400
.*------------------------------------------------------------------    00176500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00176600
.ZG22             ANOP  ,                                               00176700
&ZXDEPENDENT      SETC  'INPUT'     SET IN/OUTPUT                       00176800
                  AIF   (K'&XDEPENDENT GT 0).ZG22E  VALID ARG           00176900
                  AIF   (T'&DEPENDENT EQ 'O').ZG22D  OMITTED            00177000
&ZASYSLNDX        SETA  0                                               00177100
.ZG22A            ANOP  ,           POSITIONAL MACRO KEY                00177200
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00177300
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG22C                00177400
&ZTLC             SETC 'DEPENDENT'                                      00177500
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG22A       00177600
.ZG22B            ANOP  ,                                               00177700
&ZXDEPENDENT      SETC  ''          RESET IN/OUTPUT                     00177800
&ZMS              SETC  'THE "DEPENDENT" KEY'                           00177900
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00178000
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00178100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00178200
                  AGO   .ZG22E                                          00178300
.ZG22C            ANOP  ,                                               00178400
&ZXDEPENDENT      SETC  ''          RESET IN/OUTPUT                     00178500
&ZMS              SETC  '"DEPENDENT='                                   00178600
&ZMS              SETC  '&ZMS.&DEPENDENT"'                              00178700
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00178800
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00178900
&ZMS              SETC  '&ZMS "NO"'                                     00179000
&ZMS              SETC  '&ZMS OR "YES".'                                00179100
                  MNOTE 8,' &ZMS '                                      00179200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00179300
                  AGO   .ZG22E                                          00179400
.ZG22D            ANOP  ,                                               00179500
&XDEPENDENT       SETC  'NO'        SET DEFAULT KEYWORD                 00179600
.ZG22E            ANOP  ,                                               00179700
.*------------------------------------------------------------------    00179800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00179900
&XSECUSER         SETC  ''          INITIALIZE XVARIABLE                00180000
.*-------------------------------------------------------------------   00180100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180200
.ZG25             ANOP  ,                                               00180300
                  AIF   (K'&SECUSER(1) LE 0).ZG25A                      00180400
&ZTLC             SETC 'NO'                                             00180500
                  AIF   ('&SECUSER(1)' NE '&ZTLC').ZG26                 00180600
&XSECUSER         SETC  'NO'        SET KEYWORD                         00180700
                  AIF   (N'&SECUSER LE 1).ZG25A  CK NUM                 00180800
&ZMS              SETC  '"SECUSER='                                     00180900
&ZMS              SETC  '&ZMS.&SECUSER"'                                00181000
&ZMS              SETC  '&ZMS "SECUSER"'                                00181100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00181200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00181300
.ZG25A            ANOP  ,                                               00181400
.*------------------------------------------------------------------    00181500
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00181600
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00181700
.ZG25A0           AIF   (K'&USERID LE 0).ZG25A1  OK                     00181800
&ZCVAL            SETC '&ZCVAL USERID'          INCORRECT KEY USED      00181900
.ZG25A1           AIF   (K'&ZCVAL LE 0).ZG25A2  OK                      00182000
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00182100
&ZMS              SETC  '"SECUSER'                                      00182200
&ZMS              SETC  '&ZMS.=&SECUSER"'                               00182300
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00182400
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00182500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00182600
.ZG25A2           ANOP  ,                                               00182700
.*-------------------------------------------------------------------   00182800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00182900
.ZG26             ANOP  ,                                               00183000
&ZTLC             SETC 'YES'                                            00183100
                  AIF   ('&SECUSER(1)' NE '&ZTLC').ZG30                 00183200
&XSECUSER         SETC  'YES'       SET KEYWORD                         00183300
                  AIF   (N'&SECUSER LE 1).ZG26A  CK NUM                 00183400
&ZMS              SETC  '"SECUSER='                                     00183500
&ZMS              SETC  '&ZMS.&SECUSER"'                                00183600
&ZMS              SETC  '&ZMS "SECUSER"'                                00183700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00183800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00183900
.ZG26A            ANOP  ,                                               00184000
.*----------------------------------------------------------------***   00184100
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00184200
                  AIF   (N'&USERID LE 1).ZG28A  CK NUM                  00184300
&ZMS              SETC  '"USERID='                                      00184400
&ZMS              SETC  '&ZMS.&USERID"'                                 00184500
&ZMS              SETC  '&ZMS "USERID"'                                 00184600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00184700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00184800
.ZG28A            ANOP  ,                                               00184900
.*-------------------------------------------------------------------   00185000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00185100
&ZXUSERID         SETC  'INPUT'     SET IN/OUTPUT                       00185200
&XUSERID          SETC  '&USERID(1)'            SET XVARIABLE           00185300
                  AIF   (N'&USERID GT 1).ZG28B  MULTI PARMS             00185400
&XUSERID          SETC  '&USERID'   SET XVARIABLE                       00185500
.ZG28B            AIF   (K'&USERID(1) GT 0).ZG28C                       00185600
&ZXUSERID         SETC  ''          RESET IN/OUTPUT                     00185700
&ZMS              SETC  'WHEN "YES" IS SPECIFIED'                       00185800
&ZMS              SETC  '&ZMS , "USERID" KEY AND ITS'                   00185900
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00186000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00186100
.ZG28C            ANOP  ,                                               00186200
.*-------------------------------------------------------------------   00186300
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00186400
                  AIF   (K'&ZXUSERID LE 0).ZG28R  NOT I/O               00186500
                  AIF   ('&XUSERID'(1,1) NE '(').ZG28R                  00186600
&ZCGPR            SETC  '&XUSERID'(2,K'&XUSERID-2)                      00186700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                    00186800
                  AIF   (K'&ZCGPR GT 2).ZG28Q                           00186900
                  AIF   ('&ZCGPR' EQ '0').ZG28Q                         00187000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00187100
                  AIF   (T'&ZCGPR NE 'N').ZG28Q  INVALID REG NAME       00187200
.ZG28P            ANOP  ,                                               00187300
                  AIF   (T'&ZCGPR NE 'N').ZG28R  NON NUMERIC            00187400
                  AIF   ('&ZCGPR' LT '2').ZG28Q                         00187500
                  AIF   ('&ZCGPR' LE '12').ZG28R                        00187600
.ZG28Q            ANOP  ,                                               00187700
&ZMS              SETC  '"USERID='                                      00187800
&ZMS              SETC  '&ZMS.&USERID"'                                 00187900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00188000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00188100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00188200
.ZG28R            ANOP  ,                                               00188300
.*------------------------------------------------------------------    00188400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00188500
.ZG30             ANOP  ,                                               00188600
&ZXSECUSER        SETC  'INPUT'     SET IN/OUTPUT                       00188700
                  AIF   (K'&XSECUSER GT 0).ZG30E  VALID ARG             00188800
                  AIF   (T'&SECUSER EQ 'O').ZG30D  OMITTED              00188900
&ZASYSLNDX        SETA  0                                               00189000
.ZG30A            ANOP  ,           POSITIONAL MACRO KEY                00189100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00189200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG30C                00189300
&ZTLC             SETC 'SECUSER'                                        00189400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG30A       00189500
.ZG30B            ANOP  ,                                               00189600
&ZXSECUSER        SETC  ''          RESET IN/OUTPUT                     00189700
&ZMS              SETC  'THE "SECUSER" KEY'                             00189800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00189900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00190000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00190100
                  AGO   .ZG30E                                          00190200
.ZG30C            ANOP  ,                                               00190300
&ZXSECUSER        SETC  ''          RESET IN/OUTPUT                     00190400
&ZMS              SETC  '"SECUSER='                                     00190500
&ZMS              SETC  '&ZMS.&SECUSER"'                                00190600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00190700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00190800
&ZMS              SETC  '&ZMS "NO"'                                     00190900
&ZMS              SETC  '&ZMS OR "YES".'                                00191000
                  MNOTE 8,' &ZMS '                                      00191100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00191200
                  AGO   .ZG30E                                          00191300
.ZG30D            ANOP  ,                                               00191400
&XSECUSER         SETC  'NO'        SET DEFAULT KEYWORD                 00191500
.ZG30E            ANOP  ,                                               00191600
.*-------------------------------------------------------------------   00191700
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00191800
                  AIF   ('&XMF' EQ 'M').ZG33    BYPASS IF MF=M          00191900
.*----------------------------------------------------------------***   00192000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00192100
                  AIF   (N'&WLMWUTKN LE 1).ZG32A  CK NUM                00192200
&ZMS              SETC  '"WLMWUTKN='                                    00192300
&ZMS              SETC  '&ZMS.&WLMWUTKN"'                               00192400
&ZMS              SETC  '&ZMS "WLMWUTKN"'                               00192500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00192600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00192700
.ZG32A            ANOP  ,                                               00192800
.*-------------------------------------------------------------------   00192900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00193000
                  AIF   (K'&WLMWUTKN(1) LE 0).ZG32C  NO PARM            00193100
&ZXWLMWUTKN       SETC  'OUTPUT'    SET OUTPUT                          00193200
&XWLMWUTKN        SETC  '&WLMWUTKN(1)'          SET XVARIABLE           00193300
                  AIF   (N'&WLMWUTKN GT 1).ZG32C                        00193400
&XWLMWUTKN        SETC  '&WLMWUTKN'             SET XVARIABLE           00193500
.ZG32C            ANOP  ,                                               00193600
.*-------------------------------------------------------------------   00193700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00193800
                  AIF   (K'&ZXWLMWUTKN LE 0).ZG32R  NOT I/O             00193900
                  AIF   ('&XWLMWUTKN'(1,1) NE '(').ZG32R                00194000
&ZCGPR            SETC  '&XWLMWUTKN'(2,K'&XWLMWUTKN-2)                  00194100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                    00194200
                  AIF   (K'&ZCGPR GT 2).ZG32Q                           00194300
                  AIF   ('&ZCGPR' EQ '0').ZG32Q                         00194400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00194500
                  AIF   (T'&ZCGPR NE 'N').ZG32Q  INVALID REG NAME       00194600
.ZG32P            ANOP  ,                                               00194700
                  AIF   (T'&ZCGPR NE 'N').ZG32R  NON NUMERIC            00194800
                  AIF   ('&ZCGPR' LT '2').ZG32Q                         00194900
                  AIF   ('&ZCGPR' LE '12').ZG32R                        00195000
.ZG32Q            ANOP  ,                                               00195100
&ZMS              SETC  '"WLMWUTKN='                                    00195200
&ZMS              SETC  '&ZMS.&WLMWUTKN"'                               00195300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00195400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00195500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00195600
.ZG32R            ANOP  ,                                               00195700
.*-------------------------------------------------------------------   00195800
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00195900
.ZG33             ANOP  ,           END OF BYPASS CHECK                 00196000
.*----------------------------------------------------------------***   00196100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00196200
                  AIF   (N'&SERVER_TOKEN LE 1).ZG35A  CK NUM            00196300
&ZMS              SETC  '"SERVER_TOKEN='                                00196400
&ZMS              SETC  '&ZMS.&SERVER_TOKEN"'                           00196500
&ZMS              SETC  '&ZMS "SERVER_TOKEN"'                           00196600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00196700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00196800
.ZG35A            ANOP  ,                                               00196900
.*-------------------------------------------------------------------   00197000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00197100
&ZXSERVER_TOKEN   SETC  'INPUT'     SET IN/OUTPUT                       00197200
&XSERVER_TOKEN    SETC  '0'                                             00197300
                  AIF   (K'&SERVER_TOKEN(1) LE 0).ZG35B  PARM           00197400
&XSERVER_TOKEN    SETC  '&SERVER_TOKEN(1)'      SET XVARIABLE           00197500
                  AIF   (N'&SERVER_TOKEN GT 1).ZG35B  MULTI             00197600
&XSERVER_TOKEN    SETC  '&SERVER_TOKEN'         SET XVARIABLE           00197700
.ZG35B            ANOP  ,                                               00197800
.*-------------------------------------------------------------------   00197900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00198000
                  AIF   (K'&ZXSERVER_TOKEN LE 0).ZG35R  NOT I/O         00198100
                  AIF   ('&XSERVER_TOKEN'(1,1) NE '(').ZG35R            00198200
&ZCGPR            SETC  '&XSERVER_TOKEN'(2,K'&XSERVER_TOKEN-2)          00198300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                    00198400
                  AIF   (K'&ZCGPR GT 2).ZG35Q                           00198500
                  AIF   ('&ZCGPR' EQ '0').ZG35Q                         00198600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00198700
                  AIF   (T'&ZCGPR NE 'N').ZG35Q  INVALID REG NAME       00198800
.ZG35P            ANOP  ,                                               00198900
                  AIF   (T'&ZCGPR NE 'N').ZG35R  NON NUMERIC            00199000
                  AIF   ('&ZCGPR' LT '2').ZG35Q                         00199100
                  AIF   ('&ZCGPR' LE '12').ZG35R                        00199200
.ZG35Q            ANOP  ,                                               00199300
&ZMS              SETC  '"SERVER_TOKEN='                                00199400
&ZMS              SETC  '&ZMS.&SERVER_TOKEN"'                           00199500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00199600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00199700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00199800
.ZG35R            ANOP  ,                                               00199900
.*----------------------------------------------------------------***   00200000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00200100
                  AIF   (N'&REGION_TOKEN LE 1).ZG38A  CK NUM            00200200
&ZMS              SETC  '"REGION_TOKEN='                                00200300
&ZMS              SETC  '&ZMS.&REGION_TOKEN"'                           00200400
&ZMS              SETC  '&ZMS "REGION_TOKEN"'                           00200500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00200600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00200700
.ZG38A            ANOP  ,                                               00200800
.*-------------------------------------------------------------------   00200900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00201000
&ZXREGION_TOKEN   SETC  'INPUT'     SET IN/OUTPUT                       00201100
&XREGION_TOKEN    SETC  '0'                                             00201200
                  AIF   (K'&REGION_TOKEN(1) LE 0).ZG38B  PARM           00201300
&XREGION_TOKEN    SETC  '&REGION_TOKEN(1)'      SET XVARIABLE           00201400
                  AIF   (N'&REGION_TOKEN GT 1).ZG38B  MULTI             00201500
&XREGION_TOKEN    SETC  '&REGION_TOKEN'         SET XVARIABLE           00201600
.ZG38B            ANOP  ,                                               00201700
.*-------------------------------------------------------------------   00201800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00201900
                  AIF   (K'&ZXREGION_TOKEN LE 0).ZG38R  NOT I/O         00202000
                  AIF   ('&XREGION_TOKEN'(1,1) NE '(').ZG38R            00202100
&ZCGPR            SETC  '&XREGION_TOKEN'(2,K'&XREGION_TOKEN-2)          00202200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                    00202300
                  AIF   (K'&ZCGPR GT 2).ZG38Q                           00202400
                  AIF   ('&ZCGPR' EQ '0').ZG38Q                         00202500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00202600
                  AIF   (T'&ZCGPR NE 'N').ZG38Q  INVALID REG NAME       00202700
.ZG38P            ANOP  ,                                               00202800
                  AIF   (T'&ZCGPR NE 'N').ZG38R  NON NUMERIC            00202900
                  AIF   ('&ZCGPR' LT '2').ZG38Q                         00203000
                  AIF   ('&ZCGPR' LE '12').ZG38R                        00203100
.ZG38Q            ANOP  ,                                               00203200
&ZMS              SETC  '"REGION_TOKEN='                                00203300
&ZMS              SETC  '&ZMS.&REGION_TOKEN"'                           00203400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00203500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00203600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00203700
.ZG38R            ANOP  ,                                               00203800
.*----------------------------------------------------------------***   00203900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00204000
                  AIF   (N'&RETCODE LE 1).ZG41A  CK NUM                 00204100
&ZMS              SETC  '"RETCODE='                                     00204200
&ZMS              SETC  '&ZMS.&RETCODE"'                                00204300
&ZMS              SETC  '&ZMS "RETCODE"'                                00204400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00204500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00204600
.ZG41A            ANOP  ,                                               00204700
.*-------------------------------------------------------------------   00204800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00204900
                  AIF   (K'&RETCODE(1) LE 0).ZG41C  NO PARM             00205000
&ZXRETCODE        SETC  'OUTPUT'    SET OUTPUT                          00205100
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00205200
                  AIF   (N'&RETCODE GT 1).ZG41C                         00205300
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00205400
.ZG41C            ANOP  ,                                               00205500
.*-------------------------------------------------------------------   00205600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00205700
                  AIF   (K'&ZXRETCODE LE 0).ZG41R  NOT I/O              00205800
                  AIF   ('&XRETCODE'(1,1) NE '(').ZG41R                 00205900
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00206000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG41P                    00206100
                  AIF   (K'&ZCGPR GT 2).ZG41Q                           00206200
                  AIF   ('&ZCGPR' EQ '0').ZG41Q                         00206300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00206400
                  AIF   (T'&ZCGPR NE 'N').ZG41Q  INVALID REG NAME       00206500
.ZG41P            ANOP  ,                                               00206600
                  AIF   (T'&ZCGPR NE 'N').ZG41R  NON NUMERIC            00206700
                  AIF   ('&ZCGPR' LT '2').ZG41Q                         00206800
                  AIF   ('&ZCGPR' LE '12').ZG41R                        00206900
.ZG41Q            ANOP  ,                                               00207000
&ZMS              SETC  '"RETCODE='                                     00207100
&ZMS              SETC  '&ZMS.&RETCODE"'                                00207200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00207300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00207400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00207500
.ZG41R            ANOP  ,                                               00207600
.*----------------------------------------------------------------***   00207700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00207800
                  AIF   (N'&RSNCODE LE 1).ZG44A  CK NUM                 00207900
&ZMS              SETC  '"RSNCODE='                                     00208000
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00208100
&ZMS              SETC  '&ZMS "RSNCODE"'                                00208200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00208300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00208400
.ZG44A            ANOP  ,                                               00208500
.*-------------------------------------------------------------------   00208600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00208700
                  AIF   (K'&RSNCODE(1) LE 0).ZG44C  NO PARM             00208800
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00208900
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00209000
                  AIF   (N'&RSNCODE GT 1).ZG44C                         00209100
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00209200
.ZG44C            ANOP  ,                                               00209300
.*-------------------------------------------------------------------   00209400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00209500
                  AIF   (K'&ZXRSNCODE LE 0).ZG44R  NOT I/O              00209600
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG44R                 00209700
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00209800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                    00209900
                  AIF   (K'&ZCGPR GT 2).ZG44Q                           00210000
                  AIF   ('&ZCGPR' EQ '0').ZG44Q                         00210100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00210200
                  AIF   (T'&ZCGPR NE 'N').ZG44Q  INVALID REG NAME       00210300
.ZG44P            ANOP  ,                                               00210400
                  AIF   (T'&ZCGPR NE 'N').ZG44R  NON NUMERIC            00210500
                  AIF   ('&ZCGPR' LT '2').ZG44Q                         00210600
                  AIF   ('&ZCGPR' LE '12').ZG44R                        00210700
.ZG44Q            ANOP  ,                                               00210800
&ZMS              SETC  '"RSNCODE='                                     00210900
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00211000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00211100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00211200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00211300
.ZG44R            ANOP  ,                                               00211400
.******************************************************************     00211500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00211600
.******************************************************************     00211700
                  ACTR  10000                                           00211800
.*----------------------------------------------------------------***   00211900
.***AH.P02 EXTRA POSITIONALS                                            00212000
                  AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS            00212100
                  AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL            00212200
                  AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL        00212300
                  AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL         00212400
.ZGLISTX1         ANOP  ,                                               00212500
&ZCVAL            SETC  ''          ERROR FIELD                         00212600
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00212700
.ZGLIST2          ANOP  ,                                               00212800
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00212900
                  AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE            00213000
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00213100
                  AGO   .ZGLIST2                                        00213200
.*                                                                      00213300
.ZGLIST3          ANOP  ,                                               00213400
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00213500
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'                       00213600
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00213700
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00213800
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00213900
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00214000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00214100
.ZGLISTX          ANOP  ,                                               00214200
&ZASYSLNDX        SETA  0                                               00214300
.*-------------------------------------------------------------------   00214400
.***AG.MF04 MF=(SLME)                                                   00214500
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00214600
.********************************************************************   00214700
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00214800
.********************************************************************   00214900
                  ACTR  10000                                           00215000
.*-------------------------------------------------------------------   00215100
.***AE.MF01 MF=(SLME)                                                   00215200
                  AIF   ('&XMF' EQ 'L').ZEMFX                           00215300
                  AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                  00215400
.********************************************************************   00215500
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00215600
.********************************************************************   00215700
&XDYNAMIC         SETC  ''          INITIALIZE XVARIABLE                00215800
&XDEPENDENT       SETC  ''          INITIALIZE XVARIABLE                00215900
&XSECUSER         SETC  ''          INITIALIZE XVARIABLE                00216000
.*----------------------------------------------------------------***   00216100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00216200
                  AIF   (N'&CONNTKN LE 1).ZE2A  CK NUM                  00216300
&ZMS              SETC  '"CONNTKN='                                     00216400
&ZMS              SETC  '&ZMS.&CONNTKN"'                                00216500
&ZMS              SETC  '&ZMS "CONNTKN"'                                00216600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00216700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00216800
.ZE2A             ANOP  ,                                               00216900
.*-------------------------------------------------------------------   00217000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00217100
                  AIF   (K'&CONNTKN(1) LE 0).ZE2B NO PRM                00217200
&ZXCONNTKN        SETC  'INPUT'     SET IN/OUTPUT                       00217300
&XCONNTKN         SETC  '&CONNTKN(1)'           SET XVARIABLE           00217400
                  AIF   (N'&CONNTKN GT 1).ZE2B                          00217500
.*                ANOP              MULTIPLE PARMS                      00217600
&XCONNTKN         SETC  '&CONNTKN'  SET XVARIABLE                       00217700
.ZE2B             ANOP  ,                                               00217800
.*-------------------------------------------------------------------   00217900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00218000
                  AIF   (K'&ZXCONNTKN LE 0).ZE2R  NOT I/O               00218100
                  AIF   ('&XCONNTKN'(1,1) NE '(').ZE2R                  00218200
&ZCGPR            SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                    00218300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                     00218400
                  AIF   (K'&ZCGPR GT 2).ZE2Q                            00218500
                  AIF   ('&ZCGPR' EQ '0').ZE2Q                          00218600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00218700
                  AIF   (T'&ZCGPR NE 'N').ZE2Q  INVALID REG NAME        00218800
.ZE2P             ANOP  ,                                               00218900
                  AIF   (T'&ZCGPR NE 'N').ZE2R  NON NUMERIC             00219000
                  AIF   ('&ZCGPR' LT '2').ZE2Q                          00219100
                  AIF   ('&ZCGPR' LE '12').ZE2R                         00219200
.ZE2Q             ANOP  ,                                               00219300
&ZMS              SETC  '"CONNTKN='                                     00219400
&ZMS              SETC  '&ZMS.&CONNTKN"'                                00219500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00219600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00219700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00219800
.ZE2R             ANOP  ,                                               00219900
.*----------------------------------------------------------------***   00220000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00220100
                  AIF   (N'&ETOKEN LE 1).ZE5A   CK NUM                  00220200
&ZMS              SETC  '"ETOKEN='                                      00220300
&ZMS              SETC  '&ZMS.&ETOKEN"'                                 00220400
&ZMS              SETC  '&ZMS "ETOKEN"'                                 00220500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00220600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00220700
.ZE5A             ANOP  ,                                               00220800
.*-------------------------------------------------------------------   00220900
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00221000
                  AIF   (K'&ETOKEN(1) LE 0).ZE5B NO PRM                 00221100
&ZXETOKEN         SETC  'INPUT'     SET IN/OUTPUT                       00221200
&XETOKEN          SETC  '&ETOKEN(1)'            SET XVARIABLE           00221300
                  AIF   (N'&ETOKEN GT 1).ZE5B                           00221400
.*                ANOP              MULTIPLE PARMS                      00221500
&XETOKEN          SETC  '&ETOKEN'   SET XVARIABLE                       00221600
.ZE5B             ANOP  ,                                               00221700
.*-------------------------------------------------------------------   00221800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00221900
                  AIF   (K'&ZXETOKEN LE 0).ZE5R  NOT I/O                00222000
                  AIF   ('&XETOKEN'(1,1) NE '(').ZE5R                   00222100
&ZCGPR            SETC  '&XETOKEN'(2,K'&XETOKEN-2)                      00222200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                     00222300
                  AIF   (K'&ZCGPR GT 2).ZE5Q                            00222400
                  AIF   ('&ZCGPR' EQ '0').ZE5Q                          00222500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00222600
                  AIF   (T'&ZCGPR NE 'N').ZE5Q  INVALID REG NAME        00222700
.ZE5P             ANOP  ,                                               00222800
                  AIF   (T'&ZCGPR NE 'N').ZE5R  NON NUMERIC             00222900
                  AIF   ('&ZCGPR' LT '2').ZE5Q                          00223000
                  AIF   ('&ZCGPR' LE '12').ZE5R                         00223100
.ZE5Q             ANOP  ,                                               00223200
&ZMS              SETC  '"ETOKEN='                                      00223300
&ZMS              SETC  '&ZMS.&ETOKEN"'                                 00223400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00223500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00223600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00223700
.ZE5R             ANOP  ,                                               00223800
.*----------------------------------------------------------------***   00223900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00224000
                  AIF   (N'&USERDATA LE 1).ZE8A  CK NUM                 00224100
&ZMS              SETC  '"USERDATA='                                    00224200
&ZMS              SETC  '&ZMS.&USERDATA"'                               00224300
&ZMS              SETC  '&ZMS "USERDATA"'                               00224400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00224500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00224600
.ZE8A             ANOP  ,                                               00224700
.*-------------------------------------------------------------------   00224800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00224900
                  AIF   (K'&USERDATA(1) LE 0).ZE8B NO PRM               00225000
&ZXUSERDATA       SETC  'INPUT'     SET IN/OUTPUT                       00225100
&XUSERDATA        SETC  '&USERDATA(1)'          SET XVARIABLE           00225200
                  AIF   (N'&USERDATA GT 1).ZE8B                         00225300
.*                ANOP              MULTIPLE PARMS                      00225400
&XUSERDATA        SETC  '&USERDATA'             SET XVARIABLE           00225500
.ZE8B             ANOP  ,                                               00225600
.*-------------------------------------------------------------------   00225700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00225800
                  AIF   (K'&ZXUSERDATA LE 0).ZE8R  NOT I/O              00225900
                  AIF   ('&XUSERDATA'(1,1) NE '(').ZE8R                 00226000
&ZCGPR            SETC  '&XUSERDATA'(2,K'&XUSERDATA-2)                  00226100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE8P                     00226200
                  AIF   (K'&ZCGPR GT 2).ZE8Q                            00226300
                  AIF   ('&ZCGPR' EQ '0').ZE8Q                          00226400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00226500
                  AIF   (T'&ZCGPR NE 'N').ZE8Q  INVALID REG NAME        00226600
.ZE8P             ANOP  ,                                               00226700
                  AIF   (T'&ZCGPR NE 'N').ZE8R  NON NUMERIC             00226800
                  AIF   ('&ZCGPR' LT '2').ZE8Q                          00226900
                  AIF   ('&ZCGPR' LE '12').ZE8R                         00227000
.ZE8Q             ANOP  ,                                               00227100
&ZMS              SETC  '"USERDATA='                                    00227200
&ZMS              SETC  '&ZMS.&USERDATA"'                               00227300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00227400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00227500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00227600
.ZE8R             ANOP  ,                                               00227700
.*----------------------------------------------------------------***   00227800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00227900
                  AIF   (N'&APPLENV LE 1).ZE11A  CK NUM                 00228000
&ZMS              SETC  '"APPLENV='                                     00228100
&ZMS              SETC  '&ZMS.&APPLENV"'                                00228200
&ZMS              SETC  '&ZMS "APPLENV"'                                00228300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00228400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00228500
.ZE11A            ANOP  ,                                               00228600
.*-------------------------------------------------------------------   00228700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00228800
                  AIF   (K'&APPLENV(1) LE 0).ZE11B NO PRM               00228900
&ZXAPPLENV        SETC  'INPUT'     SET IN/OUTPUT                       00229000
&XAPPLENV         SETC  '&APPLENV(1)'           SET XVARIABLE           00229100
                  AIF   (N'&APPLENV GT 1).ZE11B                         00229200
.*                ANOP              MULTIPLE PARMS                      00229300
&XAPPLENV         SETC  '&APPLENV'  SET XVARIABLE                       00229400
.ZE11B            ANOP  ,                                               00229500
.*-------------------------------------------------------------------   00229600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00229700
                  AIF   (K'&ZXAPPLENV LE 0).ZE11R  NOT I/O              00229800
                  AIF   ('&XAPPLENV'(1,1) NE '(').ZE11R                 00229900
&ZCGPR            SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                    00230000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE11P                    00230100
                  AIF   (K'&ZCGPR GT 2).ZE11Q                           00230200
                  AIF   ('&ZCGPR' EQ '0').ZE11Q                         00230300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00230400
                  AIF   (T'&ZCGPR NE 'N').ZE11Q  INVALID REG NAME       00230500
.ZE11P            ANOP  ,                                               00230600
                  AIF   (T'&ZCGPR NE 'N').ZE11R  NON NUMERIC            00230700
                  AIF   ('&ZCGPR' LT '2').ZE11Q                         00230800
                  AIF   ('&ZCGPR' LE '12').ZE11R                        00230900
.ZE11Q            ANOP  ,                                               00231000
&ZMS              SETC  '"APPLENV='                                     00231100
&ZMS              SETC  '&ZMS.&APPLENV"'                                00231200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00231300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00231400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00231500
.ZE11R            ANOP  ,                                               00231600
.*-------------------------------------------------------------------   00231700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00231800
&ZTLC             SETC 'NO'                                             00231900
                  AIF   ('&DYNAMIC(1)' NE '&ZTLC').ZE14A                00232000
&XDYNAMIC         SETC  'NO'        SET KEYWORD                         00232100
                  AIF   (N'&DYNAMIC LE 1).ZE14A  CK NUM                 00232200
&ZMS              SETC  '"DYNAMIC='                                     00232300
&ZMS              SETC  '&ZMS.&DYNAMIC"'                                00232400
&ZMS              SETC  '&ZMS "DYNAMIC"'                                00232500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00232600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00232700
.ZE14A            ANOP  ,                                               00232800
.*-------------------------------------------------------------------   00232900
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00233000
&ZTLC             SETC 'YES'                                            00233100
                  AIF   ('&DYNAMIC(1)' NE '&ZTLC').ZE15A                00233200
&XDYNAMIC         SETC  'YES'       SET KEYWORD                         00233300
                  AIF   (N'&DYNAMIC LE 1).ZE15A  CK NUM                 00233400
&ZMS              SETC  '"DYNAMIC='                                     00233500
&ZMS              SETC  '&ZMS.&DYNAMIC"'                                00233600
&ZMS              SETC  '&ZMS "DYNAMIC"'                                00233700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00233800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00233900
.ZE15A            ANOP  ,                                               00234000
.*------------------------------------------------------------------    00234100
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00234200
.ZE16             AIF   (K'&XDYNAMIC GT 0).ZE16A                        00234300
                  AIF   (K'&DYNAMIC(1) LE 0).ZE16B                      00234400
&ZMS              SETC  '"DYNAMIC='                                     00234500
&ZMS              SETC  '&ZMS.&DYNAMIC"'                                00234600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00234700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00234800
&ZMS              SETC  '&ZMS "NO"'                                     00234900
&ZMS              SETC  '&ZMS OR "YES".'                                00235000
                  MNOTE 8,' &ZMS '                                      00235100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00235200
                  AGO   .ZE16B                                          00235300
.*                                                                      00235400
.ZE16A            ANOP  ,                                               00235500
&ZXDYNAMIC        SETC  'INPUT'     SET IN/OUTPUT                       00235600
.ZE16B            ANOP  ,                                               00235700
.*-------------------------------------------------------------------   00235800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00235900
&ZTLC             SETC 'NO'                                             00236000
                  AIF   ('&DEPENDENT(1)' NE '&ZTLC').ZE20A              00236100
&XDEPENDENT       SETC  'NO'        SET KEYWORD                         00236200
                  AIF   (N'&DEPENDENT LE 1).ZE20A  CK NUM               00236300
&ZMS              SETC  '"DEPENDENT='                                   00236400
&ZMS              SETC  '&ZMS.&DEPENDENT"'                              00236500
&ZMS              SETC  '&ZMS "DEPENDENT"'                              00236600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00236700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00236800
.ZE20A            ANOP  ,                                               00236900
.*-------------------------------------------------------------------   00237000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00237100
&ZTLC             SETC 'YES'                                            00237200
                  AIF   ('&DEPENDENT(1)' NE '&ZTLC').ZE21A              00237300
&XDEPENDENT       SETC  'YES'       SET KEYWORD                         00237400
                  AIF   (N'&DEPENDENT LE 1).ZE21A  CK NUM               00237500
&ZMS              SETC  '"DEPENDENT='                                   00237600
&ZMS              SETC  '&ZMS.&DEPENDENT"'                              00237700
&ZMS              SETC  '&ZMS "DEPENDENT"'                              00237800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00237900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00238000
.ZE21A            ANOP  ,                                               00238100
.*------------------------------------------------------------------    00238200
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00238300
.ZE22             AIF   (K'&XDEPENDENT GT 0).ZE22A                      00238400
                  AIF   (K'&DEPENDENT(1) LE 0).ZE22B                    00238500
&ZMS              SETC  '"DEPENDENT='                                   00238600
&ZMS              SETC  '&ZMS.&DEPENDENT"'                              00238700
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00238800
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00238900
&ZMS              SETC  '&ZMS "NO"'                                     00239000
&ZMS              SETC  '&ZMS OR "YES".'                                00239100
                  MNOTE 8,' &ZMS '                                      00239200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00239300
                  AGO   .ZE22B                                          00239400
.*                                                                      00239500
.ZE22A            ANOP  ,                                               00239600
&ZXDEPENDENT      SETC  'INPUT'     SET IN/OUTPUT                       00239700
.ZE22B            ANOP  ,                                               00239800
.*-------------------------------------------------------------------   00239900
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00240000
&ZTLC             SETC 'NO'                                             00240100
                  AIF   ('&SECUSER(1)' NE '&ZTLC').ZE25A                00240200
&XSECUSER         SETC  'NO'        SET KEYWORD                         00240300
                  AIF   (N'&SECUSER LE 1).ZE25A  CK NUM                 00240400
&ZMS              SETC  '"SECUSER='                                     00240500
&ZMS              SETC  '&ZMS.&SECUSER"'                                00240600
&ZMS              SETC  '&ZMS "SECUSER"'                                00240700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00240800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00240900
.ZE25A            ANOP  ,                                               00241000
.*-------------------------------------------------------------------   00241100
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00241200
&ZTLC             SETC 'YES'                                            00241300
                  AIF   ('&SECUSER(1)' NE '&ZTLC').ZE26A                00241400
&XSECUSER         SETC  'YES'       SET KEYWORD                         00241500
                  AIF   (N'&SECUSER LE 1).ZE26A  CK NUM                 00241600
&ZMS              SETC  '"SECUSER='                                     00241700
&ZMS              SETC  '&ZMS.&SECUSER"'                                00241800
&ZMS              SETC  '&ZMS "SECUSER"'                                00241900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00242000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00242100
.ZE26A            ANOP  ,                                               00242200
.*----------------------------------------------------------------***   00242300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00242400
                  AIF   (N'&USERID LE 1).ZE28A  CK NUM                  00242500
&ZMS              SETC  '"USERID='                                      00242600
&ZMS              SETC  '&ZMS.&USERID"'                                 00242700
&ZMS              SETC  '&ZMS "USERID"'                                 00242800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00242900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00243000
.ZE28A            ANOP  ,                                               00243100
.*-------------------------------------------------------------------   00243200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00243300
                  AIF   (K'&USERID(1) LE 0).ZE28B NO PRM                00243400
&ZXUSERID         SETC  'INPUT'     SET IN/OUTPUT                       00243500
&XUSERID          SETC  '&USERID(1)'            SET XVARIABLE           00243600
                  AIF   (N'&USERID GT 1).ZE28B                          00243700
.*                ANOP              MULTIPLE PARMS                      00243800
&XUSERID          SETC  '&USERID'   SET XVARIABLE                       00243900
.ZE28B            ANOP  ,                                               00244000
.*-------------------------------------------------------------------   00244100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00244200
                  AIF   (K'&ZXUSERID LE 0).ZE28R  NOT I/O               00244300
                  AIF   ('&XUSERID'(1,1) NE '(').ZE28R                  00244400
&ZCGPR            SETC  '&XUSERID'(2,K'&XUSERID-2)                      00244500
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE28P                    00244600
                  AIF   (K'&ZCGPR GT 2).ZE28Q                           00244700
                  AIF   ('&ZCGPR' EQ '0').ZE28Q                         00244800
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00244900
                  AIF   (T'&ZCGPR NE 'N').ZE28Q  INVALID REG NAME       00245000
.ZE28P            ANOP  ,                                               00245100
                  AIF   (T'&ZCGPR NE 'N').ZE28R  NON NUMERIC            00245200
                  AIF   ('&ZCGPR' LT '2').ZE28Q                         00245300
                  AIF   ('&ZCGPR' LE '12').ZE28R                        00245400
.ZE28Q            ANOP  ,                                               00245500
&ZMS              SETC  '"USERID='                                      00245600
&ZMS              SETC  '&ZMS.&USERID"'                                 00245700
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00245800
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00245900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00246000
.ZE28R            ANOP  ,                                               00246100
.*------------------------------------------------------------------    00246200
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00246300
.ZE30             AIF   (K'&XSECUSER GT 0).ZE30A                        00246400
                  AIF   (K'&SECUSER(1) LE 0).ZE30B                      00246500
&ZMS              SETC  '"SECUSER='                                     00246600
&ZMS              SETC  '&ZMS.&SECUSER"'                                00246700
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00246800
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00246900
&ZMS              SETC  '&ZMS "NO"'                                     00247000
&ZMS              SETC  '&ZMS OR "YES".'                                00247100
                  MNOTE 8,' &ZMS '                                      00247200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00247300
                  AGO   .ZE30B                                          00247400
.*                                                                      00247500
.ZE30A            ANOP  ,                                               00247600
&ZXSECUSER        SETC  'INPUT'     SET IN/OUTPUT                       00247700
.ZE30B            ANOP  ,                                               00247800
.*----------------------------------------------------------------***   00247900
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00248000
                  AIF   (N'&WLMWUTKN LE 1).ZE32A  CK NUM                00248100
&ZMS              SETC  '"WLMWUTKN='                                    00248200
&ZMS              SETC  '&ZMS.&WLMWUTKN"'                               00248300
&ZMS              SETC  '&ZMS "WLMWUTKN"'                               00248400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00248500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00248600
.ZE32A            ANOP  ,                                               00248700
.*-------------------------------------------------------------------   00248800
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00248900
                  AIF   (K'&WLMWUTKN(1) LE 0).ZE32B NO PRM              00249000
&ZXWLMWUTKN       SETC  'OUTPUT'    SET IN/OUTPUT                       00249100
&XWLMWUTKN        SETC  '&WLMWUTKN(1)'          SET XVARIABLE           00249200
                  AIF   (N'&WLMWUTKN GT 1).ZE32B                        00249300
.*                ANOP              MULTIPLE PARMS                      00249400
&XWLMWUTKN        SETC  '&WLMWUTKN'             SET XVARIABLE           00249500
.ZE32B            ANOP  ,                                               00249600
.*-------------------------------------------------------------------   00249700
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00249800
                  AIF   (K'&ZXWLMWUTKN LE 0).ZE32R  NOT I/O             00249900
                  AIF   ('&XWLMWUTKN'(1,1) NE '(').ZE32R                00250000
&ZCGPR            SETC  '&XWLMWUTKN'(2,K'&XWLMWUTKN-2)                  00250100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE32P                    00250200
                  AIF   (K'&ZCGPR GT 2).ZE32Q                           00250300
                  AIF   ('&ZCGPR' EQ '0').ZE32Q                         00250400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00250500
                  AIF   (T'&ZCGPR NE 'N').ZE32Q  INVALID REG NAME       00250600
.ZE32P            ANOP  ,                                               00250700
                  AIF   (T'&ZCGPR NE 'N').ZE32R  NON NUMERIC            00250800
                  AIF   ('&ZCGPR' LT '2').ZE32Q                         00250900
                  AIF   ('&ZCGPR' LE '12').ZE32R                        00251000
.ZE32Q            ANOP  ,                                               00251100
&ZMS              SETC  '"WLMWUTKN='                                    00251200
&ZMS              SETC  '&ZMS.&WLMWUTKN"'                               00251300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00251400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00251500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00251600
.ZE32R            ANOP  ,                                               00251700
.*----------------------------------------------------------------***   00251800
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00251900
                  AIF   (N'&SERVER_TOKEN LE 1).ZE35A  CK NUM            00252000
&ZMS              SETC  '"SERVER_TOKEN='                                00252100
&ZMS              SETC  '&ZMS.&SERVER_TOKEN"'                           00252200
&ZMS              SETC  '&ZMS "SERVER_TOKEN"'                           00252300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00252400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00252500
.ZE35A            ANOP  ,                                               00252600
.*-------------------------------------------------------------------   00252700
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00252800
                  AIF   (K'&SERVER_TOKEN(1) LE 0).ZE35B NO PRM          00252900
&ZXSERVER_TOKEN   SETC  'INPUT'     SET IN/OUTPUT                       00253000
&XSERVER_TOKEN    SETC  '&SERVER_TOKEN(1)'      SET XVARIABLE           00253100
                  AIF   (N'&SERVER_TOKEN GT 1).ZE35B                    00253200
.*                ANOP              MULTIPLE PARMS                      00253300
&XSERVER_TOKEN    SETC  '&SERVER_TOKEN'         SET XVARIABLE           00253400
.ZE35B            ANOP  ,                                               00253500
.*-------------------------------------------------------------------   00253600
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00253700
                  AIF   (K'&ZXSERVER_TOKEN LE 0).ZE35R  NOT I/O         00253800
                  AIF   ('&XSERVER_TOKEN'(1,1) NE '(').ZE35R            00253900
&ZCGPR            SETC  '&XSERVER_TOKEN'(2,K'&XSERVER_TOKEN-2)          00254000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE35P                    00254100
                  AIF   (K'&ZCGPR GT 2).ZE35Q                           00254200
                  AIF   ('&ZCGPR' EQ '0').ZE35Q                         00254300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00254400
                  AIF   (T'&ZCGPR NE 'N').ZE35Q  INVALID REG NAME       00254500
.ZE35P            ANOP  ,                                               00254600
                  AIF   (T'&ZCGPR NE 'N').ZE35R  NON NUMERIC            00254700
                  AIF   ('&ZCGPR' LT '2').ZE35Q                         00254800
                  AIF   ('&ZCGPR' LE '12').ZE35R                        00254900
.ZE35Q            ANOP  ,                                               00255000
&ZMS              SETC  '"SERVER_TOKEN='                                00255100
&ZMS              SETC  '&ZMS.&SERVER_TOKEN"'                           00255200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00255300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00255400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00255500
.ZE35R            ANOP  ,                                               00255600
.*----------------------------------------------------------------***   00255700
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00255800
                  AIF   (N'&REGION_TOKEN LE 1).ZE38A  CK NUM            00255900
&ZMS              SETC  '"REGION_TOKEN='                                00256000
&ZMS              SETC  '&ZMS.&REGION_TOKEN"'                           00256100
&ZMS              SETC  '&ZMS "REGION_TOKEN"'                           00256200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00256300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00256400
.ZE38A            ANOP  ,                                               00256500
.*-------------------------------------------------------------------   00256600
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00256700
                  AIF   (K'&REGION_TOKEN(1) LE 0).ZE38B NO PRM          00256800
&ZXREGION_TOKEN   SETC  'INPUT'     SET IN/OUTPUT                       00256900
&XREGION_TOKEN    SETC  '&REGION_TOKEN(1)'      SET XVARIABLE           00257000
                  AIF   (N'&REGION_TOKEN GT 1).ZE38B                    00257100
.*                ANOP              MULTIPLE PARMS                      00257200
&XREGION_TOKEN    SETC  '&REGION_TOKEN'         SET XVARIABLE           00257300
.ZE38B            ANOP  ,                                               00257400
.*-------------------------------------------------------------------   00257500
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00257600
                  AIF   (K'&ZXREGION_TOKEN LE 0).ZE38R  NOT I/O         00257700
                  AIF   ('&XREGION_TOKEN'(1,1) NE '(').ZE38R            00257800
&ZCGPR            SETC  '&XREGION_TOKEN'(2,K'&XREGION_TOKEN-2)          00257900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE38P                    00258000
                  AIF   (K'&ZCGPR GT 2).ZE38Q                           00258100
                  AIF   ('&ZCGPR' EQ '0').ZE38Q                         00258200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00258300
                  AIF   (T'&ZCGPR NE 'N').ZE38Q  INVALID REG NAME       00258400
.ZE38P            ANOP  ,                                               00258500
                  AIF   (T'&ZCGPR NE 'N').ZE38R  NON NUMERIC            00258600
                  AIF   ('&ZCGPR' LT '2').ZE38Q                         00258700
                  AIF   ('&ZCGPR' LE '12').ZE38R                        00258800
.ZE38Q            ANOP  ,                                               00258900
&ZMS              SETC  '"REGION_TOKEN='                                00259000
&ZMS              SETC  '&ZMS.&REGION_TOKEN"'                           00259100
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00259200
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00259300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00259400
.ZE38R            ANOP  ,                                               00259500
.*----------------------------------------------------------------***   00259600
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00259700
                  AIF   (N'&RETCODE LE 1).ZE41A  CK NUM                 00259800
&ZMS              SETC  '"RETCODE='                                     00259900
&ZMS              SETC  '&ZMS.&RETCODE"'                                00260000
&ZMS              SETC  '&ZMS "RETCODE"'                                00260100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00260200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00260300
.ZE41A            ANOP  ,                                               00260400
.*-------------------------------------------------------------------   00260500
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00260600
                  AIF   (K'&RETCODE(1) LE 0).ZE41B NO PRM               00260700
&ZXRETCODE        SETC  'OUTPUT'    SET IN/OUTPUT                       00260800
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00260900
                  AIF   (N'&RETCODE GT 1).ZE41B                         00261000
.*                ANOP              MULTIPLE PARMS                      00261100
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00261200
.ZE41B            ANOP  ,                                               00261300
.*-------------------------------------------------------------------   00261400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00261500
                  AIF   (K'&ZXRETCODE LE 0).ZE41R  NOT I/O              00261600
                  AIF   ('&XRETCODE'(1,1) NE '(').ZE41R                 00261700
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00261800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE41P                    00261900
                  AIF   (K'&ZCGPR GT 2).ZE41Q                           00262000
                  AIF   ('&ZCGPR' EQ '0').ZE41Q                         00262100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00262200
                  AIF   (T'&ZCGPR NE 'N').ZE41Q  INVALID REG NAME       00262300
.ZE41P            ANOP  ,                                               00262400
                  AIF   (T'&ZCGPR NE 'N').ZE41R  NON NUMERIC            00262500
                  AIF   ('&ZCGPR' LT '2').ZE41Q                         00262600
                  AIF   ('&ZCGPR' LE '12').ZE41R                        00262700
.ZE41Q            ANOP  ,                                               00262800
&ZMS              SETC  '"RETCODE='                                     00262900
&ZMS              SETC  '&ZMS.&RETCODE"'                                00263000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00263100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00263200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00263300
.ZE41R            ANOP  ,                                               00263400
.*----------------------------------------------------------------***   00263500
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00263600
                  AIF   (N'&RSNCODE LE 1).ZE44A  CK NUM                 00263700
&ZMS              SETC  '"RSNCODE='                                     00263800
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00263900
&ZMS              SETC  '&ZMS "RSNCODE"'                                00264000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00264100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00264200
.ZE44A            ANOP  ,                                               00264300
.*-------------------------------------------------------------------   00264400
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00264500
                  AIF   (K'&RSNCODE(1) LE 0).ZE44B NO PRM               00264600
&ZXRSNCODE        SETC  'OUTPUT'    SET IN/OUTPUT                       00264700
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00264800
                  AIF   (N'&RSNCODE GT 1).ZE44B                         00264900
.*                ANOP              MULTIPLE PARMS                      00265000
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00265100
.ZE44B            ANOP  ,                                               00265200
.*-------------------------------------------------------------------   00265300
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00265400
                  AIF   (K'&ZXRSNCODE LE 0).ZE44R  NOT I/O              00265500
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZE44R                 00265600
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00265700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZE44P                    00265800
                  AIF   (K'&ZCGPR GT 2).ZE44Q                           00265900
                  AIF   ('&ZCGPR' EQ '0').ZE44Q                         00266000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00266100
                  AIF   (T'&ZCGPR NE 'N').ZE44Q  INVALID REG NAME       00266200
.ZE44P            ANOP  ,                                               00266300
                  AIF   (T'&ZCGPR NE 'N').ZE44R  NON NUMERIC            00266400
                  AIF   ('&ZCGPR' LT '2').ZE44Q                         00266500
                  AIF   ('&ZCGPR' LE '12').ZE44R                        00266600
.ZE44Q            ANOP  ,                                               00266700
&ZMS              SETC  '"RSNCODE='                                     00266800
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00266900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00267000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00267100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00267200
.ZE44R            ANOP  ,                                               00267300
.******************************************************************     00267400
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00267500
.******************************************************************     00267600
                  ACTR  10000                                           00267700
.*----------------------------------------------------------------***   00267800
.***AF.P02 EXTRA POSITIONALS                                            00267900
                  AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS            00268000
&ZCVAL            SETC  ''          ERROR FIELD                         00268100
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00268200
.ZELIST2          ANOP  ,                                               00268300
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00268400
                  AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE            00268500
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00268600
                  AGO   .ZELIST2                                        00268700
.*                                                                      00268800
.ZELIST3          ANOP  ,                                               00268900
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00269000
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'                       00269100
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00269200
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00269300
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00269400
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00269500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00269600
.ZELISTX          ANOP  ,                                               00269700
&ZASYSLNDX        SETA  0                                               00269800
.*-------------------------------------------------------------------   00269900
.***AE.MF02 MF=(SLME)                                                   00270000
.ZEMFX            ANOP  ,           END OF PARTIAL SYNTAX CHECK         00270100
.*******************************************************************    00270200
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00270300
.*******************************************************************    00270400
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00270500
.*******************************************************************    00270600
.***AE.01  START OF IWM4QIN MACRO CODE                                  00270700
.*******************************************************************    00270800
                  LCLC  &M0M0001                 NAME                   00270900
&M0M0001          SETC  '&XLABEL'                SET NAME               00271000
                  AIF   (K'&XLABEL NE 0).XLAB2                          00271100
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00271200
.*                                                                      00271300
.XLAB2            ANOP  ,                                               00271400
                  AIF   ('&XMF' EQ 'L').XLAB3                           00271500
&M0M0001 DS    0H                             IWM4QIN-0                 00271600
.XLAB3            ANOP  ,                                               00271700
.*******************************************************************    00271800
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00271900
.*******************************************************************    00272000
              PUSH  PRINT                                               00272100
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00272200
                  PRINT OFF         ++ PR01                             00272300
                  AGO   .ZPRNTXX                                        00272400
.ZPRINTX          PRINT ON                                              00272500
.ZPRNTXX          ANOP  ,                                               00272600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00272700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00272800
.********************************************************************   00272900
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00273000
.********************************************************************   00273100
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00273200
                      LCLA  &ZOPN1         INVOCATION INDEX             00273300
                      LCLC  &ZOPL(4095)    LABEL                        00273400
                      LCLC  &ZOPO(4095)    OPERATION                    00273500
                      LCLC  &ZOPV(4095)    VALUE                        00273600
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00273700
.*                                                                      00273800
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00273900
.******************************************************************     00274000
.***AL.L10 IWM4QIN FMT=LIST MF=S!L PARAMETERS                           00274100
.******************************************************************     00274200
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00274300
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00274400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00274500
&XMFATTR              SETC  '0D'                                        00274600
.*                                                                      00274700
&ZOPN                 SETA  &ZOPN+1                                     00274800
&ZOPL(&ZOPN)          SETC  ' '                                         00274900
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00275000
&ZOPV(&ZOPN)          SETC  '4,8'                                       00275100
&ZOPN                 SETA  &ZOPN+1                                     00275200
&ZOPL(&ZOPN)          SETC  ' '                                         00275300
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00275400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00275500
&ZOPD(&ZOPN)          SETC  '++ IWM4QIN ARG PARMS'                      00275600
.*                                                                      00275700
&ZOPN                 SETA  &ZOPN+1                                     00275800
&ZOPL(&ZOPN)          SETC  ' '                                         00275900
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00276000
&ZOPV(&ZOPN)          SETC  '1'                                         00276100
&ZOPD(&ZOPN)          SETC  ' '                                         00276200
.*                                                                      00276300
.ZLMFSL2              ANOP  ,                                           00276400
.*-------------------------------------------------------------------   00276500
.***AM.L00  IWM4QIN FMT=LIST name                                       00276600
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00276700
&ZOPN                 SETA &ZOPN+1                                      00276800
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00276900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00277000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00277100
&ZOPD(&ZOPN)          SETC '++ IWM4QIN NAME'                            00277200
.ZLMFSL2M             ANOP  ,                                           00277300
.*-------------------------------------------------------------------   00277400
.***AM.L01  IWM4QIN FMT=LIST PARAMETERS                                 00277500
&ZOPN                 SETA &ZOPN+1                                      00277600
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00277700
&ZOPO(&ZOPN)          SETC 'DS'                                         00277800
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00277900
&ZOPD(&ZOPN)          SETC '++ IWM4QIN PARM LIST'                       00278000
.*-------------------------------------------------------------------   00278100
.***AM.L02 XVERSION XL1                                                 00278200
&ZOPN                 SETA &ZOPN+1                                      00278300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00278400
&ZOPO(&ZOPN)          SETC 'DS'                                         00278500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00278600
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00278700
.*-------------------------------------------------------------------   00278800
.***AM.L03 XOPTIONS BL.8                                                00278900
&ZOPN                 SETA &ZOPN+1                                      00279000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPTIONS'                         00279100
&ZOPO(&ZOPN)          SETC 'DS'                                         00279200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00279300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00279400
.*                                                                      00279500
&ZOPN                 SETA  &ZOPN+1                                     00279600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._IWM4QIN'                         00279700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00279800
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00279900
&ZOPD(&ZOPN)          SETC  '++ MACUSED.'                               00280000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IWM4QIN'                      00280100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00280200
.*-------------------------------------------------------------------   00280300
.***AM.L09  XPLISTLEN XL2                                               00280400
&ZOPN                 SETA &ZOPN+1                                      00280500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00280600
&ZOPO(&ZOPN)          SETC 'DS'                                         00280700
&ZOPV(&ZOPN)          SETC 'XL2'                                        00280800
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00280900
.*-------------------------------------------------------------------   00281000
.***AM.L09  XCONNTKN BL.32                                              00281100
&ZOPN                 SETA &ZOPN+1                                      00281200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         00281300
&ZOPO(&ZOPN)          SETC 'DS'                                         00281400
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00281500
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN '                             00281600
.*-------------------------------------------------------------------   00281700
.***AM.L09  XETOKEN CL8                                                 00281800
&ZOPN                 SETA &ZOPN+1                                      00281900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XETOKEN'                          00282000
&ZOPO(&ZOPN)          SETC 'DS'                                         00282100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00282200
&ZOPD(&ZOPN)          SETC '++ &ZXETOKEN '                              00282300
.*-------------------------------------------------------------------   00282400
.***AM.L09  XUSERDATA CL16                                              00282500
&ZOPN                 SETA &ZOPN+1                                      00282600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERDATA'                        00282700
&ZOPO(&ZOPN)          SETC 'DS'                                         00282800
&ZOPV(&ZOPN)          SETC 'CL16'                                       00282900
&ZOPD(&ZOPN)          SETC '++ &ZXUSERDATA '                            00283000
.*-------------------------------------------------------------------   00283100
.***AM.L09  XRSV0020 CL4                                                00283200
&ZOPN                 SETA &ZOPN+1                                      00283300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0020'                         00283400
&ZOPO(&ZOPN)          SETC 'DS'                                         00283500
&ZOPV(&ZOPN)          SETC 'CL4'                                        00283600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00283700
.*-------------------------------------------------------------------   00283800
.***AM.L03 XSECUSER_OPTIONS BL.8                                        00283900
&ZOPN                 SETA &ZOPN+1                                      00284000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSECUSER_OPTIONS'                 00284100
&ZOPO(&ZOPN)          SETC 'DS'                                         00284200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00284300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00284400
.*                                                                      00284500
&ZOPN                 SETA  &ZOPN+1                                     00284600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSECUSER_YES'                    00284700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00284800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00284900
&ZOPD(&ZOPN)          SETC  '++ XSECUSER.'                              00285000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00285100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00285200
.*                                                                      00285300
&ZOPN                 SETA  &ZOPN+1                                     00285400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDYNAMIC_YES'                    00285500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00285600
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00285700
&ZOPD(&ZOPN)          SETC  '++ XDYNAMIC.'                              00285800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00285900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00286000
.*                                                                      00286100
&ZOPN                 SETA  &ZOPN+1                                     00286200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDEPENDENT_YES'                  00286300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00286400
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00286500
&ZOPD(&ZOPN)          SETC  '++ XDEPENDENT.'                            00286600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00286700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00286800
.*-------------------------------------------------------------------   00286900
.***AM.L09  XRSV0025 CL3                                                00287000
&ZOPN                 SETA &ZOPN+1                                      00287100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0025'                         00287200
&ZOPO(&ZOPN)          SETC 'DS'                                         00287300
&ZOPV(&ZOPN)          SETC 'CL3'                                        00287400
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00287500
.*-------------------------------------------------------------------   00287600
.***AM.L09  XUSERID CL8                                                 00287700
&ZOPN                 SETA &ZOPN+1                                      00287800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERID'                          00287900
&ZOPO(&ZOPN)          SETC 'DS'                                         00288000
&ZOPV(&ZOPN)          SETC 'CL8'                                        00288100
&ZOPD(&ZOPN)          SETC '++ &ZXUSERID '                              00288200
.*-------------------------------------------------------------------   00288300
.***AM.L09  XWLMWUTKN CL16                                              00288400
&ZOPN                 SETA &ZOPN+1                                      00288500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWLMWUTKN'                        00288600
&ZOPO(&ZOPN)          SETC 'DS'                                         00288700
&ZOPV(&ZOPN)          SETC 'CL16'                                       00288800
&ZOPD(&ZOPN)          SETC '++ &ZXWLMWUTKN '                            00288900
.*-------------------------------------------------------------------   00289000
.***AM.L09  XSERVER_TOKEN CL32                                          00289100
&ZOPN                 SETA &ZOPN+1                                      00289200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSERVER_TOKEN'                    00289300
&ZOPO(&ZOPN)          SETC 'DS'                                         00289400
&ZOPV(&ZOPN)          SETC 'CL32'                                       00289500
&ZOPD(&ZOPN)          SETC '++ &ZXSERVER_TOKEN '                        00289600
.*-------------------------------------------------------------------   00289700
.***AM.L09  XREGION_TOKEN CL16                                          00289800
&ZOPN                 SETA &ZOPN+1                                      00289900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREGION_TOKEN'                    00290000
&ZOPO(&ZOPN)          SETC 'DS'                                         00290100
&ZOPV(&ZOPN)          SETC 'CL16'                                       00290200
&ZOPD(&ZOPN)          SETC '++ &ZXREGION_TOKEN '                        00290300
.*-------------------------------------------------------------------   00290400
.***AM.L09 ADDR64 XAPPLENV AD                                           00290500
&ZOPN                 SETA &ZOPN+1                                      00290600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAPPLENV_ADDR64'                  00290700
&ZOPO(&ZOPN)          SETC 'DS'                                         00290800
&ZOPV(&ZOPN)          SETC 'AD'                                         00290900
&ZOPD(&ZOPN)          SETC '++ &ZXAPPLENV ADDR64'                       00291000
.*-------------------------------------------------------------------   00291100
.***AM.L10 END OF IWM4QIN LIST PARAMETERS                               00291200
&ZOPN                 SETA &ZOPN+1                                      00291300
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00291400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00291500
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00291600
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00291700
.*                                                                      00291800
&ZOPN                 SETA &ZOPN+1                                      00291900
&ZOPL(&ZOPN)          SETC ' '                                          00292000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00292100
&ZOPV(&ZOPN)          SETC '1'                                          00292200
&ZOPD(&ZOPN)          SETC ' '                                          00292300
.*-------------------------------------------------------------------   00292400
.***AL.L12 IWM4QIN FMT=LIST MF=S!L PARAMETERS                           00292500
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00292600
.*                                                                      00292700
&ZOPN                 SETA  &ZOPN+1                                     00292800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00292900
&ZOPO(&ZOPN)          SETC  'DC'                                        00293000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00293100
&ZOPD(&ZOPN)          SETC  '++ IWM4QIN ARG PARMS'                      00293200
.*                                                                      00293300
.ZLMFSLX              ANOP  ,                                           00293400
.*-------------------------------------------------------------------   00293500
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00293600
&ZPLLEN               SETA 120                                          00293700
.*                                                                      00293800
.******************************************************************     00293900
.***AI.L01 IWM4QIN FMT=LIST FILL IN PARAMETER AREA                      00294000
.******************************************************************     00294100
                      ACTR  10000                                       00294200
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00294300
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00294400
&ZCVAL                SETC  'LAE'          XAX MODE                     00294500
.ZIMFXA               ANOP ,                                            00294600
.*                                                                      00294700
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00294800
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00294900
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00295000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00295100
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00295200
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00295300
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00295400
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00295500
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00295600
&ZOPN                 SETA  &ZOPN+1                                     00295700
&ZOPL(&ZOPN)          SETC  ' '                                         00295800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00295900
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00296000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00296100
                      AGO   .ZIMFNX                                     00296200
.*                                                                      00296300
.ZIMFN2               ANOP ,                                            00296400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00296500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00296600
&ZOPN                 SETA  &ZOPN+1                                     00296700
&ZOPL(&ZOPN)          SETC  ' '                                         00296800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00296900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00297000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00297100
                      AGO   .ZIMFNX                                     00297200
.ZIMFNX1              ANOP ,                                            00297300
&ZOPN                 SETA  &ZOPN+1                                     00297400
&ZOPL(&ZOPN)          SETC  ' '                                         00297500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00297600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00297700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00297800
.ZIMFNX               ANOP ,                                            00297900
.********************************************************************   00298000
.***AI.L02 IWM4QIN FMT=LIST INITIALIZE PARAMETER AREA                   00298100
.********************************************************************   00298200
.***AI.L03 MF=(SLME)                                                    00298300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00298400
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00298500
.*                                                                      00298600
&ZOPN                 SETA  &ZOPN+1                                     00298700
&ZOPL(&ZOPN)          SETC  ' '                                         00298800
&ZOPO(&ZOPN)          SETC  'XC'                                        00298900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00299000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00299100
.ZIMFLX               ANOP  ,                                           00299200
.*-------------------------------------------------------------------   00299300
.***AI.L05 XOPTIONS BL1                                                 00299400
&ZW                   SETC  ''                                          00299500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00299600
&ZMS                  SETC  ''                                          00299700
&ZC                   SETC  ''                                          00299800
.*-------------------------------------------------------------------   00299900
.***AI.L08 XOPTIONS "IWM4QIN"                                           00300000
.***      BL1'XXXXXXX1'                                                 00300100
&ZW                   SETC  '&ZW.00000001'                              00300200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00300300
&ZMS                  SETC  '&ZMS.11111111'                             00300400
.*-------------------------------------------------------------------   00300500
.***AI.L11 XOPTIONS BL1                                                 00300600
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI3D               00300700
                      AIF   ('&ZC' NE 'YES').ZI3D                       00300800
&ZOPN                 SETA  &ZOPN+1                                     00300900
&ZOPL(&ZOPN)          SETC  ' '                                         00301000
&ZOPO(&ZOPN)          SETC  'NI'                                        00301100
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            00301200
&ZOPD(&ZOPN)          SETC  '++ 77 BL1'                                 00301300
.ZI3D                 ANOP  ,                                           00301400
                      AIF   ('&ZCLNG' NE 'YES').ZI3E  ALL ZERO BITS     00301500
&ZOPN                 SETA  &ZOPN+1                                     00301600
&ZOPL(&ZOPN)          SETC  ' '                                         00301700
&ZOPO(&ZOPN)          SETC  'OI'                                        00301800
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00301900
&ZOPD(&ZOPN)          SETC  '++ 77 BL1'                                 00302000
.ZI3E                 ANOP  ,                                           00302100
.*-------------------------------------------------------------------   00302200
.***AI.L04 XPLISTLEN XL2                                                00302300
&ZOPN                 SETA  &ZOPN+1                                     00302400
&ZOPL(&ZOPN)          SETC  ' '                                         00302500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00302600
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      00302700
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00302800
.*-------------------------------------------------------------------   00302900
.***AI.L25  XCONNTKN XL4                                                00303000
                      AIF   ('&ZXCONNTKN' EQ '').ZI5E                   00303100
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI5E             00303200
&ZCGPR                SETC  '&XCONNTKN'                                 00303300
.*                                                                      00303400
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI5B              00303500
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    00303600
                      AGO   .ZI5D                                       00303700
.ZI5B                 ANOP  ,                                           00303800
.*                                                                      00303900
&ZC                   SETC  '&XCONNTKN'(1,1)                            00304000
                      AIF   (T'&ZC NE 'N').ZI5D                         00304100
&ZC                   SETC  '&XCONNTKN'                                 00304200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                00304300
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         00304400
.*                                                                      00304500
.ZI5D                 ANOP  ,                                           00304600
.*                                                                      00304700
&ZOPN                 SETA  &ZOPN+1                                     00304800
&ZOPL(&ZOPN)          SETC  ' '                                         00304900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00305000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00305100
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    00305200
.*                                                                      00305300
.ZI5E                 ANOP  ,                                           00305400
.*-------------------------------------------------------------------   00305500
.***AI.L25  XETOKEN CL8                                                 00305600
                      AIF   ('&ZXETOKEN' EQ '').ZI6E                    00305700
                      AIF   ('&ZXETOKEN' EQ 'OUTPUT').ZI6E              00305800
&ZCGPR                SETC  '&XETOKEN'                                  00305900
.*                                                                      00306000
                      AIF   ('&XETOKEN'(1,1) NE '(').ZI6B               00306100
&ZCGPR   SETC  '0('.'&XETOKEN'(2,K'&XETOKEN-2).')'                      00306200
.ZI6B                 ANOP  ,                                           00306300
.*                                                                      00306400
&ZOPN                 SETA  &ZOPN+1                                     00306500
&ZOPL(&ZOPN)          SETC  ' '                                         00306600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00306700
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00306800
&ZOPD(&ZOPN)          SETC  '++ &ZXETOKEN XETOKEN'                      00306900
.*                                                                      00307000
.ZI6E                 ANOP  ,                                           00307100
.*-------------------------------------------------------------------   00307200
.***AI.L25  XUSERDATA CL16                                              00307300
                      AIF   ('&ZXUSERDATA' EQ '').ZI7E                  00307400
                      AIF   ('&ZXUSERDATA' EQ 'OUTPUT').ZI7E            00307500
&ZCGPR                SETC  '&XUSERDATA'                                00307600
.*                                                                      00307700
                      AIF   ('&XUSERDATA'(1,1) NE '(').ZI7B             00307800
&ZCGPR   SETC  '0('.'&XUSERDATA'(2,K'&XUSERDATA-2).')'                  00307900
.ZI7B                 ANOP  ,                                           00308000
.*                                                                      00308100
&ZOPN                 SETA  &ZOPN+1                                     00308200
&ZOPL(&ZOPN)          SETC  ' '                                         00308300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00308400
&ZOPV(&ZOPN)          SETC  '16(16,1),&ZCGPR'                           00308500
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERDATA XUSERDATA'                  00308600
.*                                                                      00308700
.ZI7E                 ANOP  ,                                           00308800
.*-------------------------------------------------------------------   00308900
.***AI.L05 XSECUSER_OPTIONS BL1                                         00309000
&ZW                   SETC  ''                                          00309100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00309200
&ZMS                  SETC  ''                                          00309300
&ZC                   SETC  ''                                          00309400
.*-------------------------------------------------------------------   00309500
.***AI.L08 XSECUSER_OPTIONS "YES"                                       00309600
.***      BL1'1XXXXXXX'                                                 00309700
         AIF   ('&XSECUSER' NE 'YES').ZI10A                             00309800
&ZW                   SETC  '&ZW.1'                                     00309900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00310000
&ZMS                  SETC  '&ZMS.1'                                    00310100
                      AGO   .ZI10C                                      00310200
.*                                                                      00310300
.ZI10A                ANOP  ,                                           00310400
&ZW                   SETC  '&ZW.0'                                     00310500
         AIF   ('&ZXSECUSER' EQ '').ZI10B                               00310600
&ZMS                  SETC  '&ZMS.0'                                    00310700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00310800
                      AGO   .ZI10C                                      00310900
.*                                                                      00311000
.ZI10B                ANOP  ,                                           00311100
&ZMS                  SETC  '&ZMS.1'                                    00311200
.ZI10C                ANOP  ,                                           00311300
.*-------------------------------------------------------------------   00311400
.***AI.L08 XSECUSER_OPTIONS "YES"                                       00311500
.***      BL1'X1XXXXXX'                                                 00311600
         AIF   ('&XDYNAMIC' NE 'YES').ZI11A                             00311700
&ZW                   SETC  '&ZW.1'                                     00311800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00311900
&ZMS                  SETC  '&ZMS.1'                                    00312000
                      AGO   .ZI11C                                      00312100
.*                                                                      00312200
.ZI11A                ANOP  ,                                           00312300
&ZW                   SETC  '&ZW.0'                                     00312400
         AIF   ('&ZXDYNAMIC' EQ '').ZI11B                               00312500
&ZMS                  SETC  '&ZMS.0'                                    00312600
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00312700
                      AGO   .ZI11C                                      00312800
.*                                                                      00312900
.ZI11B                ANOP  ,                                           00313000
&ZMS                  SETC  '&ZMS.1'                                    00313100
.ZI11C                ANOP  ,                                           00313200
.*-------------------------------------------------------------------   00313300
.***AI.L08 XSECUSER_OPTIONS "YES"                                       00313400
.***      BL1'XX1XXXXX'                                                 00313500
         AIF   ('&XDEPENDENT' NE 'YES').ZI12A                           00313600
&ZW                   SETC  '&ZW.100000'                                00313700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00313800
&ZMS                  SETC  '&ZMS.111111'                               00313900
                      AGO   .ZI12C                                      00314000
.*                                                                      00314100
.ZI12A                ANOP  ,                                           00314200
&ZW                   SETC  '&ZW.000000'                                00314300
         AIF   ('&ZXDEPENDENT' EQ '').ZI12B                             00314400
&ZMS                  SETC  '&ZMS.011111'                               00314500
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00314600
                      AGO   .ZI12C                                      00314700
.*                                                                      00314800
.ZI12B                ANOP  ,                                           00314900
&ZMS                  SETC  '&ZMS.111111'                               00315000
.ZI12C                ANOP  ,                                           00315100
.*-------------------------------------------------------------------   00315200
.***AI.L11 XSECUSER_OPTIONS BL1                                         00315300
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI12D              00315400
                      AIF   ('&ZC' NE 'YES').ZI12D                      00315500
&ZOPN                 SETA  &ZOPN+1                                     00315600
&ZOPL(&ZOPN)          SETC  ' '                                         00315700
&ZOPO(&ZOPN)          SETC  'NI'                                        00315800
&ZOPV(&ZOPN)          SETC  '36(1),B''&ZMS'''                           00315900
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00316000
.ZI12D                ANOP  ,                                           00316100
                      AIF   ('&ZCLNG' NE 'YES').ZI12E  ALL ZERO BITS    00316200
&ZOPN                 SETA  &ZOPN+1                                     00316300
&ZOPL(&ZOPN)          SETC  ' '                                         00316400
&ZOPO(&ZOPN)          SETC  'OI'                                        00316500
&ZOPV(&ZOPN)          SETC  '36(1),B''&ZW'''                            00316600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00316700
.ZI12E                ANOP  ,                                           00316800
.*-------------------------------------------------------------------   00316900
.***AI.L25  XUSERID CL8                                                 00317000
                      AIF   ('&ZXUSERID' EQ '').ZI14E                   00317100
                      AIF   ('&ZXUSERID' EQ 'OUTPUT').ZI14E             00317200
&ZCGPR                SETC  '&XUSERID'                                  00317300
.*                                                                      00317400
                      AIF   ('&XUSERID'(1,1) NE '(').ZI14B              00317500
&ZCGPR   SETC  '0('.'&XUSERID'(2,K'&XUSERID-2).')'                      00317600
.ZI14B                ANOP  ,                                           00317700
.*                                                                      00317800
&ZOPN                 SETA  &ZOPN+1                                     00317900
&ZOPL(&ZOPN)          SETC  ' '                                         00318000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00318100
&ZOPV(&ZOPN)          SETC  '40(8,1),&ZCGPR'                            00318200
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERID XUSERID'                      00318300
.*                                                                      00318400
.ZI14E                ANOP  ,                                           00318500
.*-------------------------------------------------------------------   00318600
.***AI.L25  XSERVER_TOKEN CL32                                          00318700
                      AIF   ('&ZXSERVER_TOKEN' EQ '').ZI16E             00318800
                      AIF   ('&ZXSERVER_TOKEN' EQ 'OUTPUT').ZI16E       00318900
&ZCGPR                SETC  '&XSERVER_TOKEN'                            00319000
         AIF   ('&XSERVER_TOKEN' NE '0').ZI16A                          00319100
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI16E                          00319200
.*                                                                      00319300
&ZCGPR                SETC  '=XL32''00'''                               00319400
.ZI16A                ANOP  ,                                           00319500
.*                                                                      00319600
                      AIF   ('&XSERVER_TOKEN'(1,1) NE '(').ZI16B        00319700
&ZCGPR   SETC  '0('.'&XSERVER_TOKEN'(2,K'&XSERVER_TOKEN-2).')'          00319800
                      AGO   .ZI16D                                      00319900
.ZI16B                ANOP  ,                                           00320000
.*                                                                      00320100
                      AIF   ('&SERVER_TOKEN(1)' EQ '').ZI16I            00320200
&ZC                   SETC  '0'                                         00320300
                      AIF   ('&XSERVER_TOKEN' NE '&ZC').ZI16C           00320400
.ZI16I                ANOP  ,                                           00320500
&ZCGPR                SETC  '=CL32''&XSERVER_TOKEN'''                   00320600
.ZI16C                ANOP  ,                                           00320700
.*                                                                      00320800
.ZI16D                ANOP  ,                                           00320900
.*                                                                      00321000
&ZOPN                 SETA  &ZOPN+1                                     00321100
&ZOPL(&ZOPN)          SETC  ' '                                         00321200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00321300
&ZOPV(&ZOPN)          SETC  '64(32,1),&ZCGPR'                           00321400
&ZOPD(&ZOPN)          SETC  '++ &ZXSERVER_TOKEN XSERVER_TOKEN'          00321500
.*                                                                      00321600
.ZI16E                ANOP  ,                                           00321700
.*-------------------------------------------------------------------   00321800
.***AI.L25  XREGION_TOKEN CL16                                          00321900
                      AIF   ('&ZXREGION_TOKEN' EQ '').ZI17E             00322000
                      AIF   ('&ZXREGION_TOKEN' EQ 'OUTPUT').ZI17E       00322100
&ZCGPR                SETC  '&XREGION_TOKEN'                            00322200
         AIF   ('&XREGION_TOKEN' NE '0').ZI17A                          00322300
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI17E                          00322400
.*                                                                      00322500
&ZCGPR                SETC  '=XL16''00'''                               00322600
.ZI17A                ANOP  ,                                           00322700
.*                                                                      00322800
                      AIF   ('&XREGION_TOKEN'(1,1) NE '(').ZI17B        00322900
&ZCGPR   SETC  '0('.'&XREGION_TOKEN'(2,K'&XREGION_TOKEN-2).')'          00323000
                      AGO   .ZI17D                                      00323100
.ZI17B                ANOP  ,                                           00323200
.*                                                                      00323300
                      AIF   ('&REGION_TOKEN(1)' EQ '').ZI17I            00323400
&ZC                   SETC  '0'                                         00323500
                      AIF   ('&XREGION_TOKEN' NE '&ZC').ZI17C           00323600
.ZI17I                ANOP  ,                                           00323700
&ZCGPR                SETC  '=CL16''&XREGION_TOKEN'''                   00323800
.ZI17C                ANOP  ,                                           00323900
.*                                                                      00324000
.ZI17D                ANOP  ,                                           00324100
.*                                                                      00324200
&ZOPN                 SETA  &ZOPN+1                                     00324300
&ZOPL(&ZOPN)          SETC  ' '                                         00324400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00324500
&ZOPV(&ZOPN)          SETC  '96(16,1),&ZCGPR'                           00324600
&ZOPD(&ZOPN)          SETC  '++ &ZXREGION_TOKEN XREGION_TOKEN'          00324700
.*                                                                      00324800
.ZI17E                ANOP  ,                                           00324900
.*-------------------------------------------------------------------   00325000
.***AI.L19 ADDR64 XAPPLENV AD                                           00325100
                      AIF   ('&ZXAPPLENV' EQ '').ZI18H                  00325200
&ZCLNG                SETC  '&XAPPLENV'                                 00325300
&ZCGPR                SETC  '14'                                        00325400
         AIF   ('&XAPPLENV'(1,1) EQ '(').ZI18F  IN GPR                  00325500
.*                                                                      00325600
&ZOPN                 SETA  &ZOPN+1                                     00325700
&ZOPL(&ZOPN)          SETC  ' '                                         00325800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00325900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00326000
&ZOPD(&ZOPN)          SETC  '++ &ZXAPPLENV XAPPLENV'                    00326100
.*                                                                      00326200
                      AGO   .ZI18G                                      00326300
.*                                                                      00326400
.ZI18F                ANOP  ,                                           00326500
&ZCGPR   SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                             00326600
.*                                                                      00326700
.ZI18G                ANOP  ,                                           00326800
                      AIF   ('&SYSAM64' EQ 'YES').ZI18H1A               00326900
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI18C2             00327000
.*                                                                      00327100
&ZOPN                 SETA  &ZOPN+1                                     00327200
&ZOPL(&ZOPN)          SETC  ' '                                         00327300
&ZOPO(&ZOPN)          SETC  'XC'                                        00327400
&ZOPV(&ZOPN)          SETC  '112(4,1),112(1)'                           00327500
.ZI18C2               ANOP  ,                                           00327600
.*                                                                      00327700
&ZOPN                 SETA  &ZOPN+1                                     00327800
&ZOPL(&ZOPN)          SETC  ' '                                         00327900
&ZOPO(&ZOPN)          SETC  'ST'                                        00328000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+112(,1)'                          00328100
&ZOPD(&ZOPN)          SETC  '++ &ZXAPPLENV XAPPLENV'                    00328200
.*                                                                      00328300
                      AGO   .ZI18H                                      00328400
.ZI18H1A              ANOP  ,                                           00328500
.*                                                                      00328600
&ZOPN                 SETA  &ZOPN+1                                     00328700
&ZOPL(&ZOPN)          SETC  ' '                                         00328800
&ZOPO(&ZOPN)          SETC  'STG'                                       00328900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,112(,1)'                            00329000
&ZOPD(&ZOPN)          SETC  '++ &ZXAPPLENV XAPPLENV'                    00329100
.*                                                                      00329200
.ZI18H                ANOP  ,                                           00329300
.*-------------------------------------------------------------------   00329400
&ZOPN1                SETA &ZOPN                                        00329500
.*-------------------------------------------------------------------   00329600
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00329700
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00329800
.*******************************************************************    00329900
.***  PROCESS IWM4QIN OUTPUT PARAMETERS                                 00330000
.*******************************************************************    00330100
                      ACTR  10000                                       00330200
.*------------------------------------------------------------------    00330300
.***AO.L02 XWLMWUTKN CL16                                               00330400
         AIF   ('&ZXWLMWUTKN' EQ 'OUTPUT').ZO15A  OUTPUT                00330500
         AIF   ('&ZXWLMWUTKN' NE 'INOUT').ZO15C  INOUT                  00330600
.ZO15A    AIF   ('&XWLMWUTKN'(1,1) NE '(').ZO15B  ADDR IN GPR           00330700
&ZCGPR   SETC  '&XWLMWUTKN'(2,K'&XWLMWUTKN-2)                           00330800
&ZOPN                 SETA  &ZOPN+1                                     00330900
&ZOPL(&ZOPN)          SETC  ' '                                         00331000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00331100
&ZOPV(&ZOPN)          SETC  '0(16,&ZCGPR),48(1)'                        00331200
&ZOPD(&ZOPN)          SETC  '++ XWLMWUTKN CL16'                         00331300
                      AGO   .ZO15C                                      00331400
.*                                                                      00331500
.ZO15B                ANOP  ,                                           00331600
&ZAWRK   SETA  K'&XWLMWUTKN                                             00331700
         AIF   ('&XWLMWUTKN'(&ZAWRK,1) NE ')').ZO15G                    00331800
&ZN      SETA  2                                                        00331900
.ZO15H    ANOP                                                          00332000
         AIF   (&ZN GE &ZAWRK).ZO15G                                    00332100
         AIF   ('&XWLMWUTKN'(&ZN,1) NE '(').ZO15I                       00332200
&ZC      SETC  '&XWLMWUTKN'(1,&ZN).'16'.','                             00332300
&ZC      SETC  '&ZC'.'&XWLMWUTKN'(&ZN+1,&ZAWRK-&ZN).',48(1)'            00332400
         AGO   .ZO15J                                                   00332500
.ZO15I    ANOP                                                          00332600
&ZN      SETA  &ZN+1                                                    00332700
         AGO   .ZO15H                                                   00332800
.ZO15G    ANOP                                                          00332900
&ZC      SETC  '&XWLMWUTKN.(16),48(1)'                                  00333000
.ZO15J    ANOP                                                          00333100
&ZOPN                 SETA  &ZOPN+1                                     00333200
&ZOPL(&ZOPN)          SETC  ' '                                         00333300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00333400
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00333500
&ZOPD(&ZOPN)          SETC  '++ XWLMWUTKN CL16'                         00333600
.ZO15C                ANOP  ,                                           00333700
.*******************************************************************    00333800
.***AO.X02  RETURN CODE PROCESSING                                      00333900
.*******************************************************************    00334000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00334100
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00334200
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00334300
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00334400
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00334500
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00334600
&ZOPN                 SETA  &ZOPN+1                                     00334700
&ZOPL(&ZOPN)          SETC  ' '                                         00334800
&ZOPO(&ZOPN)          SETC  'ST'                                        00334900
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00335000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00335100
                      AGO   .ZMRETX                                     00335200
.*                                                                      00335300
.ZMRET2               ANOP  ,                                           00335400
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00335500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00335600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00335700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00335800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00335900
&ZOPN                 SETA  &ZOPN+1                                     00336000
&ZOPL(&ZOPN)          SETC  ' '                                         00336100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00336200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00336300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00336400
.ZMRETX               ANOP  ,                                           00336500
.*******************************************************************    00336600
.***AO.X03  REASON CODE PROCESSING                                      00336700
.*******************************************************************    00336800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00336900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00337000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00337100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00337200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00337300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00337400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00337500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00337600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00337700
&ZOPN                 SETA  &ZOPN+1                                     00337800
&ZOPL(&ZOPN)          SETC  ' '                                         00337900
&ZOPO(&ZOPN)          SETC  'ST'                                        00338000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00338100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00338200
                      AGO   .ZMRSNX                                     00338300
.*                                                                      00338400
.ZMRSN2               ANOP  ,                                           00338500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00338600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00338700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00338800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00338900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00339000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00339100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00339200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00339300
&ZOPN                 SETA  &ZOPN+1                                     00339400
&ZOPL(&ZOPN)          SETC  ' '                                         00339500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00339600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00339700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00339800
.ZMRSNX               ANOP  ,                                           00339900
.*******************************************************************    00340000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00340100
.*******************************************************************    00340200
.ZMFLX                ANOP  ,              MF=L PROCESSING              00340300
.*******************************************************************    00340400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00340500
.*******************************************************************    00340600
                      ACTR  10000                                       00340700
.*                                                                      00340800
                      LCLA  &ZLC           COLUMN POSITION              00340900
                      LCLA  &ZOPX          LIST TABLE INDEX             00341000
                      LCLC  &ZLL           LABEL                        00341100
                      LCLC  &ZLOP          OPERATION                    00341200
                      LCLC  &ZLV           VALUE                        00341300
                      LCLC  &ZLD           DESCRIPTION                  00341400
.*                                                                      00341500
&ZOPX                 SETA  1                                           00341600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00341700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00341800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00341900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00342000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00342100
                      AIF   (K'&ZLD LE 0).ZL5                           00342200
&ZLC                  SETA  35             COMMENT COLUMN               00342300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00342400
&ZLC                  SETA  33             COMMMENT COLUMN              00342500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00342600
&ZLV                  SETC  '&ZLV'.' '                                  00342700
                      AGO   .ZL3                                        00342800
.*                                                                      00342900
.ZL4                  ANOP  ,                                           00343000
&ZLV                  SETC  '&ZLV'.' '                                  00343100
.ZL5                  ANOP  ,                                           00343200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00343300
.*                                                                      00343400
&ZLL     &ZLOP &ZLV                                                     00343500
.*                                                                      00343600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00343700
                      AGO   .ZL2           CONTINUE LOOPING             00343800
.*                                                                      00343900
.ZLX                  ANOP  ,                                           00344000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00344100
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00344200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00344300
         AIF   ('&SYSAM64' NE 'YES').AMODE31                            00344400
         LLGTR 14,14                   CLEAR HIGH HALF IN 64BIT MODE    00344500
.AMODE31 L     14,16(0,0)              GET CVT ADDRESS                  00344600
.*-------------------------------------------------------------------   00344700
         TM    CVTOSLV3-CVT(14),CVTH7709  test for HBB7709 presence     00344800
         BNZ   VEROK&SYSNDX               running on HBB7709            00344900
         LA    0,IWMRSNCODEBADVERSION     HBB7709 is required           00345000
         LA    15,IWMRETCODEINVOCERROR    set return code               00345100
         B     END&SYSNDX                 skip service invocation       00345200
VEROK&SYSNDX DS    0H                     version check successful      00345300
.*-------------------------------------------------------------------   00345400
     L     14,772(14,0)            GET SFT ADDRESS                      00345500
     L     14,380(14,0)            GET LX FOR SERVICE ROUTINE           00345600
     LA    15,38                   GET EX FOR SERVICE ROUTINE           00345700
     OR    14,15                   GET PC NUMBER                        00345800
     PC    0(14)                                                        00345900
END&SYSNDX DS    0H                END LABEL                            00346000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00346100
.ZLINKX               ANOP  ,                                           00346200
.*******************************************************************    00346300
.***AP.X01  FORMAT GENERATED CODE                                       00346400
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00346500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00346600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00346700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00346800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00346900
                      AIF   (K'&ZLD LE 0).ZL51                          00347000
&ZLC                  SETA  35             COMMENT COLUMN               00347100
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00347200
&ZLC                  SETA  33             COMMENT COLUMN               00347300
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00347400
&ZLV                  SETC  '&ZLV'.' '                                  00347500
                      AGO   .ZL31                                       00347600
.*                                                                      00347700
.ZL41                 ANOP  ,                                           00347800
&ZLV                  SETC  '&ZLV'.' '                                  00347900
.ZL51                 ANOP  ,                                           00348000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00348100
.*                                                                      00348200
&ZLL     &ZLOP &ZLV                                                     00348300
.*                                                                      00348400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00348500
                      AGO   .ZL21          CONTINUE LOOPING             00348600
.*                                                                      00348700
.ZLX1                 ANOP  ,                                           00348800
.*******************************************************************    00348900
.***AP.X02  END OF IWM4QIN MACRO                                        00349000
&ZIWM4QIN             SETC  'YES'          SET IWM4QIN USED             00349100
         POP   PRINT                                                    00349200
*                                            IWM4QIN-0                  00349300
         SPACE 1                                                        00349400
.ZLX2                 ANOP  ,                                           00349500
         MEND                                                           00349600
**********************************************************************/ 00349700
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00349800
*%IWM4QIN: MACRO KEYS(CONNTKN,ETOKEN,USERDATA,APPLENV,DYNAMIC,          00349900
*                 DEPENDENT,SECUSER,USERID,WLMWUTKN,SERVER_TOKEN,       00350000
*                 REGION_TOKEN,RETCODE,RSNCODE,PLISTVER,MF);            00350100
*  ANS('?'!!MACLABEL!!' '!!'IWM4QINP '!!MACLIST!!                       00350200
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00350300
*%END IWM4QIN;                                                          00350400

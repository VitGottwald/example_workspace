*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  HISMT                                 -01/04/17-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  HIS Multi-Threading (MT) Service              * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2015                               * 00001200
*                                                                     * 00001300
* STATUS= HBB77A0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      HISMT provides an interface to retrieve MT metrics at          * 00002000
*      different granularity levels between the caller's current and  * 00002100
*      previous HISMT invocations.                                    * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:                                         * 00002400
*                                                                     * 00002500
*02* PI:   BASE                                                       * 00002600
*                                                                     * 00002700
*02* NONE: FIELDS                                                     * 00002800
*          CBFCLASS                                                   * 00002900
*          CBFAN                                                      * 00003000
*          MAXCAPAN                                                   * 00003100
*          SAVEHISTDATA                                               * 00003200
*                                                                     * 00003300
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003400
*                                                                     * 00003500
*01* ENVIRONMENT:                                                     * 00003600
*                                                                     * 00003700
*                                                                     * 00003800
*      Minimum authorization: Supervisor state.  Zero PSW key.        * 00003900
*                                                                     * 00004000
*      Dispatchable unit mode: Task or SRB mode.                      * 00004100
*                                                                     * 00004200
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00004300
*                                                                     * 00004400
*      AMODE:            31-bit.                                      * 00004500
*                                                                     * 00004600
*      ASC mode:         Primary.                                     * 00004700
*                                                                     * 00004800
*      Interrupt status: Enabled or disabled for I/O and external     * 00004900
*                        interrupts.                                  * 00005000
*                                                                     * 00005100
*      Locks:            Locks may be held.                           * 00005200
*                                                                     * 00005300
*      Control parameters:     Control parameters and the save area   * 00005400
*                        must be addressable from the primary address * 00005500
*                        space and must be in DREF/fixed storage.     * 00005600
*                                                                     * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*01* PROGRAMMING REQUIREMENTS:                                        * 00006000
*                                                                     * 00006100
*    There must be at least 1 second between HISMT invocations for    * 00006200
*    the same interval area.                                          * 00006300
*                                                                     * 00006400
*    The service can be invoked in any Multi-Threading (MT) Mode      * 00006500
*    including an MT Mode of 1. The MT mode of a processor class is   * 00006600
*    the number of active threads per core for a processor class. The * 00006700
*    MT Mode for each processor class can be set via the IEAOPTxx     * 00006800
*    parmlib member.                                                  * 00006900
*                                                                     * 00007000
*    The caller must include the HISYMT macro to get a mapping of the * 00007100
*    the interval area (INTVAREA) and constants for the return and    * 00007200
*    reason codes.                                                    * 00007300
*                                                                     * 00007400
*    HISMT exploiters may register as a listener for ENF 20 (System   * 00007500
*    Information) and if a primary or secondary CPU speeds have       * 00007600
*    changed, invoke HISMT to end the HISMT interval.  The current    * 00007700
*    CPU speeds are available in SI22V1PrimaryCPUSpeed and            * 00007800
*    SI22V1SecondaryCPUSpeed fields of the STSI (see macro CSRSIIDF). * 00007900
*    When the core speed changes during the HISMT interval, HISMT     * 00008000
*    will return a warning reason code HisMT_kRsnWarn_ConfigChanged   * 00008100
*    to inform users of questionable HISMT metrics due to core state  * 00008200
*    changing during the interval. See field HisMT_Hdr_Flags in the   * 00008300
*    interval area header for what has changed.                       * 00008400
*                                                                     * 00008500
*    The MT metrics requested through the HISMT service must be the   * 00008600
*    same on each call for the same interval area (INTVAREA).  The    * 00008700
*    size of the interval area (INTVAREALEN) depends on the MT        * 00008800
*    metrics requested, machine, and configuration.  To allocate a    * 00008900
*    sufficiently large interval area, the following protocol must be * 00009000
*    followed:                                                        * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*    1.  Obtaining sufficient storage                                 * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*        a.  As part of initialization, invoke the HISMT service with * 00009700
*            the requested metrics and pass an interval area that is  * 00009800
*            the minimum interval area length, HisMT_Hdr_kLength.     * 00009900
*            (See INTVAREA parameter for requirements on the first    * 00010000
*            call for a new interval area)                            * 00010100
*                                                                     * 00010200
*        b.  The service will likely complete with a return code      * 00010300
*            HisMT_kRetWarn and reason code                           * 00010400
*            HisMT_kRsnWarn_IntvAreaSmall.                            * 00010500
*                                                                     * 00010600
*        c.  Using the HisMT_Hdr_LengthRequired field in the interval * 00010700
*            area returned by the HISMT service, allocate a new       * 00010800
*            interval area that is at least HisMT_Hdr_LengthRequired  * 00010900
*            bytes long.                                              * 00011000
*                                                                     * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*    2.  Making the first HISMT call with the new interval area       * 00011400
*                                                                     * 00011500
*                                                                     * 00011600
*        a.  Invoke the HISMT service with the same requested MT      * 00011700
*            metrics passing the newly allocated interval area that   * 00011800
*            is at least HisMT_Hdr_LengthRequired bytes long. (See    * 00011900
*            INTVAREA parameter for requirements on the first call    * 00012000
*            for a new interval area)                                 * 00012100
*                                                                     * 00012200
*        b.  The service will likely complete with a return code      * 00012300
*            HisMT_kRetOk.  The first HISMT invocation for a new      * 00012400
*            interval area marks the start of the first HISMT         * 00012500
*            interval.  The requested HISMT metrics will not be       * 00012600
*            returned in the new interval area for the first call.    * 00012700
*            Each metric will contain HisMT_Entry_kNoData since the   * 00012800
*            system is unable to calculate the metrics on the very    * 00012900
*            first call. (See Step 3 of the protocol below for        * 00013000
*            instructions on getting the requested HISMT metrics in   * 00013100
*            the interval area)                                       * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*    3.  Making a subsequent HISMT call with the previous interval    * 00013600
*        area                                                         * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*        a.  Invoke the HISMT service with the same requested MT      * 00014000
*            metrics passing the interval area from the previous      * 00014100
*            invocation, unchanged.                                   * 00014200
*                                                                     * 00014300
*        b.  The service will likely complete with a return code      * 00014400
*            HisMT_kRetOk.  This invocation marks the end of the      * 00014500
*            current HISMT interval and the start of the next HISMT   * 00014600
*            interval.  The requested HISMT metrics will be returned  * 00014700
*            in the interval area for the current interval (the time  * 00014800
*            between the previous HISMT invocation and this HISMT     * 00014900
*            invocation).  The HISMT interval area has descriptors    * 00015000
*            for each requested metric that contain information on    * 00015100
*            how to locate and process each array of metric values.   * 00015200
*            For all requested metrics, these descriptors contain the * 00015300
*            offset to the first element in the array of metric       * 00015400
*            values, the number of elements in the array, and the     * 00015500
*            size each value in the metric array.  See macro HISYMT   * 00015600
*            for more information.                                    * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*        For example, with MT to calculate how much single thread     * 00016000
*        capacity an MT=2 core of a particular processor class can    * 00016100
*        deliver for the current workload over an interval for this   * 00016200
*        workload, calculate <interval> * <Procclass Max Capacity     * 00016300
*        Factor> / <HisMT_Entry_kMetricFactor> (assembler programs    * 00016400
*        can shift right by HisMT_Entry_kMetricShift bits for the     * 00016500
*        divide)                                                      * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*01* INPUT REGISTER INFORMATION:                                      * 00017000
*                                                                     * 00017100
*    Before issuing the HISMT macro, the caller must ensure that the  * 00017200
*    following general purpose registers (GPRs) contain the specified * 00017300
*    information.                                                     * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*    REGISTER  CONTENTS                                               * 00017700
*                                                                     * 00017800
*    13        The address of a 144-byte F4SA format save area in the * 00017900
*              primary address space                                  * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*    The caller does not have to place any information into any other * 00018400
*    general purpose register (GPR) unless using it in register       * 00018500
*    notation for a particular parameter, or using it as a base       * 00018600
*    register.                                                        * 00018700
*                                                                     * 00018800
*    The caller does not have to place any information into any       * 00018900
*    access register (AR).                                            * 00019000
*                                                                     * 00019100
*01* OUTPUT REGISTER INFORMATION:                                     * 00019200
*                                                                     * 00019300
*    When control returns to the caller, the GPRs contain:            * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*    REGISTER    CONTENTS                                             * 00019700
*                                                                     * 00019800
*    0           Reason code if GPR15 is not 0                        * 00019900
*                                                                     * 00020000
*    1           Used as work register by the system                  * 00020100
*                                                                     * 00020200
*    2-13        Unchanged                                            * 00020300
*                                                                     * 00020400
*    14          Used as a work register by the system                * 00020500
*                                                                     * 00020600
*    15          Return code                                          * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*    When control returns to the caller, the ARs contain:             * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*    REGISTER    CONTENTS                                             * 00021400
*                                                                     * 00021500
*    0-1         Used as work registers by the system                 * 00021600
*                                                                     * 00021700
*    2-14        Unchanged                                            * 00021800
*                                                                     * 00021900
*    15          Used as a work register by the system                * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*    Some callers depend on register contents remaining the same      * 00022400
*    before and after issuing a service.  If the system changes the   * 00022500
*    contents of registers on which the caller depends, the caller    * 00022600
*    must save them before issuing the service, and restore them      * 00022700
*    after the system returns control.                                * 00022800
*                                                                     * 00022900
*01* PERFORMANCE IMPLICATIONS:                                        * 00023000
*    None.                                                            * 00023100
*                                                                     * 00023200
*01* SYNTAX:                                                          * 00023300
*                                                                     * 00023400
*Ýxlabel¨  HISMT     INTVAREA=xintvarea                               * 00023500
*                   ,INTVAREALEN=xintvarealen                         * 00023600
*                 ÐÝ,PRODCLASS=NO¨                                    * 00023700
*                 ¿Ý,PRODCLASS=YES¨                                   * 00023800
*                 ÐÝ,PRODCORE=NO¨                                     * 00023900
*                 ¿Ý,PRODCORE=YES¨                                    * 00024000
*                 ÐÝ,CAPCLASS=NO¨                                     * 00024100
*                 ¿Ý,CAPCLASS=YES¨                                    * 00024200
*                 ÐÝ,MAXCAPCLASS=NO¨                                  * 00024300
*                 ¿Ý,MAXCAPCLASS=YES                                  * 00024400
*                     ÐÝ,MAXCAPAN=NO¨                                 * 00024500
*                     ¿Ý,MAXCAPAN=YES¨¨                               * 00024600
*                 ÐÝ,CBFCLASS=NO¨                                     * 00024700
*                 ¿Ý,CBFCLASS=YES¨                                    * 00024800
*                 ÐÝ,CBFAN=NO¨                                        * 00024900
*                 ¿Ý,CBFAN=YES¨                                       * 00025000
*                 ÐÝ,SAVEHISTDATA=NO¨                                 * 00025100
*                 ¿Ý,SAVEHISTDATA=YES¨                                * 00025200
*                 ÐÝ,COREBUSYTIME=NO¨                                 * 00025300
*                 ¿Ý,COREBUSYTIME=YES¨                                * 00025400
*                 ÐÝ,AVGTDCLASS=NO¨                                   * 00025500
*                 ¿Ý,AVGTDCLASS=YES¨                                  * 00025600
*                  Ý,RETCODE=xretcode¨                                * 00025700
*                  Ý,RSNCODE=xrsncode¨                                * 00025800
*                  Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨            * 00025900
*                 ÐÝ,MF=S¨                                            * 00026000
*                 ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                     * 00026100
*                 ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                       * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*      Where:                                                         * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*      Ýxlabel¨                                                       * 00026800
*          is an optional symbol, starting in column 1, that is the   * 00026900
*          name on the HISMT macro invocation.  The name must conform * 00027000
*          to the rules for an ordinary assembler language symbol.    * 00027100
*          DEFAULT: No name.                                          * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*      INTVAREA=xintvarea                                             * 00027700
*          is the name (RS-type), or address in register (2)-(12), of * 00027800
*          a required character input/output that contains the        * 00027900
*          interval area. It must be in DREF or fixed storage.  Note  * 00028000
*          that the interval area must start and end on a double word * 00028100
*          boundary.  The size of the interval area depends on the MT * 00028200
*          metrics requested, machine, and configuration.  If this is * 00028300
*          the first HISMT request for a new interval area, the first * 00028400
*          byte of the interval area must contain binary zeroes. If   * 00028500
*          this is a subsequent HISMT request, pass the interval area * 00028600
*          that was returned by the previous HISMT invocation,        * 00028700
*          unchanged.  Macro HISYMT contains the mapping of the       * 00028800
*          interval area.  The minimum amount of storage required for * 00028900
*          the request is HisMT_Hdr_kLength.  See Programming         * 00029000
*          Requirements for the protocol for passing an interval area * 00029100
*          that is long enough to accommodate the request.            * 00029200
*                                                                     * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*      INTVAREALEN=xintvarealen                                       * 00029700
*          is the name (RS-type), or address in register (2)-(12), of * 00029800
*          a required fullword input which contains the length of the * 00029900
*          provided interval area. The minimum INTVAREALEN required   * 00030000
*          for the request is HisMT_Hdr_kLength.  Note that the       * 00030100
*          interval area length must be a multiple of 8 bytes.        * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*      ÝPRODCLASS=»NO!YESº¨                                           * 00030700
*          is an optional keyword input which indicates that MT       * 00030800
*          productivity metrics must be returned by processor class   * 00030900
*          granularity and can be located using                       * 00031000
*          HisMT_Hdr_ProdClass_Desc. Each metric is calculated for    * 00031100
*          the current MT mode while the cores are dispatched to      * 00031200
*          physical hardware.  If the system cannot calculate this    * 00031300
*          metric, the metric will contain HisMT_Entry_kNoData.  For  * 00031400
*          example, the PRODCLASS metric will contain                 * 00031500
*          HisMt_Entry_kNoData when there are no cores defined in a   * 00031600
*          processor class.                                           * 00031700
*                                                                     * 00031800
*          MT productivity is a metric that represents a ratio of how * 00031900
*          much work was accomplished to the maximum amount of work   * 00032000
*          that could have been accomplished. For an MT mode of 1, a  * 00032100
*          processor class will achieve a productivity ratio of 1.0   * 00032200
*          (100%) because whenever cores are dispatched to physical   * 00032300
*          hardware, they are executing as much work as possible.  If * 00032400
*          the MT mode is greater than 1 and the productivity ratio   * 00032500
*          is 0.93 (93%), it means the active threads on all cores    * 00032600
*          accomplished 93% of the work that could have been          * 00032700
*          accomplished while dispatched to physical hardware.        * 00032800
*          Typically when the MT productivity is less than 1.0        * 00032900
*          (<100%), it is because there were times when the cores     * 00033000
*          were dispatched to physical hardware and 1 or more threads * 00033100
*          on those cores were in a wait because they had no work to  * 00033200
*          run.                                                       * 00033300
*          DEFAULT: NO                                                * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*          ÝPRODCLASS=NO¨                                             * 00033700
*              MT Productivity metric is not needed for any processor * 00033800
*              class.                                                 * 00033900
*                                                                     * 00034000
*          ÝPRODCLASS=YES¨                                            * 00034100
*              MT Productivity metric is needed for each processor    * 00034200
*              class.                                                 * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*      ÝPRODCORE=»NO!YESº¨                                            * 00035000
*          is an optional keyword input which indicates that MT       * 00035100
*          productivity metrics must be returned by core granularity  * 00035200
*          and can be located using HisMT_Hdr_ProdCore_Desc. Each     * 00035300
*          metric is calculated for the current MT mode while the     * 00035400
*          cores are dispatched to physical hardware.  If the system  * 00035500
*          cannot calculate this metric, the metric will contain      * 00035600
*          HisMT_Entry_kNoData.  For example, the PRODCORE metric     * 00035700
*          will contain HisMt_Entry_kNoData for an undefined or       * 00035800
*          offline core.                                              * 00035900
*                                                                     * 00036000
*          See PRODCLASS keyword for information on MT Productivity.  * 00036100
*          DEFAULT: NO                                                * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*          ÝPRODCORE=NO¨                                              * 00036500
*              MT Productivity metric is not needed for any core.     * 00036600
*                                                                     * 00036700
*          ÝPRODCORE=YES¨                                             * 00036800
*              MT Productivity metric is needed for each core.        * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*      ÝCAPCLASS=»NO!YESº¨                                            * 00037600
*          is an optional keyword input which indicates that MT       * 00037700
*          capacity factor metrics must be returned by processor      * 00037800
*          class granularity and can be located using                 * 00037900
*          HisMT_Hdr_CapClass_Desc. Each metric is calculated for the * 00038000
*          current MT mode while the cores are dispatched to physical * 00038100
*          hardware.  If the system cannot calculate this metric, the * 00038200
*          metric will contain HisMT_Entry_kNoData.  For example, the * 00038300
*          CAPCLASS metric will contain HisMt_Entry_kNoData when      * 00038400
*          there are no cores defined in a processor class.           * 00038500
*                                                                     * 00038600
*          MT Capacity Factor is a metric that represents a ratio of  * 00038700
*          how much work was accomplished at the current MT mode to   * 00038800
*          the amount of work (for the same workload) that could have * 00038900
*          been accomplished while running MT mode of 1.  For an MT   * 00039000
*          mode of 1, a processor class will achieve a Capacity       * 00039100
*          Factor ratio of 1.0 (100%) because whenever cores are      * 00039200
*          dispatched to physical hardware, they are executing as     * 00039300
*          much work as possible. For example, if the MT mode was     * 00039400
*          greater than 1 (100%) and the MT capacity factor was 1.3   * 00039500
*          (130%), it means for the workload running, the cores were  * 00039600
*          able to accomplish 1.3x (or 130%) the work than the        * 00039700
*          processor class running with an MT mode of 1 would have    * 00039800
*          accomplished for the same workload.                        * 00039900
*          DEFAULT: NO                                                * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*          ÝCAPCLASS=NO¨                                              * 00040300
*              MT Capacity factor metric is not needed for any        * 00040400
*              processor class.                                       * 00040500
*                                                                     * 00040600
*          ÝCAPCLASS=YES¨                                             * 00040700
*              MT Capacity factor metric is needed for each processor * 00040800
*              class.                                                 * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*                                                                     * 00041500
*      ÝMAXCAPCLASS=»NO!YESº                                          * 00041600
*          is an optional keyword input which indicates that MT       * 00041700
*          maximum capacity factor metrics must be returned by        * 00041800
*          processor class granularity and can be located using       * 00041900
*          HisMT_Hdr_MaxCapClass_Desc. Each metric is calculated for  * 00042000
*          the the current MT mode while the cores are dispatched to  * 00042100
*          physical hardware.  If the system cannot calculate this    * 00042200
*          metric, the metric will contain HisMT_Entry_kNoData.  For  * 00042300
*          example, the MAXCAPCLASS metric will contain               * 00042400
*          HisMt_Entry_kNoData when there are no cores defined in a   * 00042500
*          processor class.                                           * 00042600
*                                                                     * 00042700
*          MT Max Capacity Factor is a metric that represents a ratio * 00042800
*          of the maximum amount of work that can be accomplished     * 00042900
*          using all active threads at the current MT mode to the     * 00043000
*          amount of work (for the same workload) that would have     * 00043100
*          been accomplished while running MT mode of 1.  For an MT   * 00043200
*          mode of 1, a processor class will achieve a Max Capacity   * 00043300
*          Factor ratio of 1.0 (100%) because whenever cores are      * 00043400
*          dispatched to physical hardware, they are executing the    * 00043500
*          maximum amount of work as possible. For example, if the MT * 00043600
*          Mode is greater than 1 and the MT max capacity factor was  * 00043700
*          1.4 (140%), it means that if the processor class was able  * 00043800
*          to achieve a productivity ratio of 1.0, then the workload  * 00043900
*          running would be able to accomplish 1.4x (140%) the work a * 00044000
*          processor class running with an MT mode of 1 would have    * 00044100
*          accomplished for the same workload.                        * 00044200
*          DEFAULT: NO                                                * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*          ÝMAXCAPCLASS=NO¨                                           * 00044600
*              MT Max capacity factor metric is not needed for any    * 00044700
*              proccesor class.                                       * 00044800
*                                                                     * 00044900
*          ÝMAXCAPCLASS=YES                                           * 00045000
*              MT Max capacity factor metric is needed for each       * 00045100
*              processor class.                                       * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*              ÝMAXCAPAN=»NO!YESº¨¨                                   * 00045500
*                  is an optional keyword input that is not a part of * 00045600
*                  the intended interface. It is restricted to IBM    * 00045700
*                  use only.                                          * 00045800
*                  DEFAULT: NO                                        * 00045900
*                                                                     * 00046000
*                                                                     * 00046100
*                  ÝMAXCAPAN=NO¨                                      * 00046200
*                      IBM use only                                   * 00046300
*                                                                     * 00046400
*                  ÝMAXCAPAN=YES¨¨                                    * 00046500
*                      IBM use only                                   * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*                                                                     * 00047200
*                                                                     * 00047300
*                                                                     * 00047400
*                                                                     * 00047500
*                                                                     * 00047600
*      ÝCBFCLASS=»NO!YESº¨                                            * 00047700
*          is an optional keyword input that is not a part of the     * 00047800
*          intended interface. It is restricted to IBM use only.      * 00047900
*          DEFAULT: NO                                                * 00048000
*                                                                     * 00048100
*                                                                     * 00048200
*          ÝCBFCLASS=NO¨                                              * 00048300
*              MT CBF metric is not needed for any processor class.   * 00048400
*                                                                     * 00048500
*          ÝCBFCLASS=YES¨                                             * 00048600
*              MT CBF metric is needed for each processor class.      * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*                                                                     * 00049300
*      ÝCBFAN=»NO!YESº¨                                               * 00049400
*          is an optional keyword input that is not a part of the     * 00049500
*          intended interface. It is restricted to IBM use only.      * 00049600
*          DEFAULT: NO                                                * 00049700
*                                                                     * 00049800
*                                                                     * 00049900
*          ÝCBFAN=NO¨                                                 * 00050000
*              MT CBF metric is not needed for any ANs.               * 00050100
*                                                                     * 00050200
*          ÝCBFAN=YES¨                                                * 00050300
*              MT CBF metric is needed for each AN.                   * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*                                                                     * 00050900
*                                                                     * 00051000
*      ÝSAVEHISTDATA=»NO!YESº¨                                        * 00051100
*          is an optional keyword input that is not a part of the     * 00051200
*          intended interface. It is restricted to IBM use only.      * 00051300
*          DEFAULT: NO                                                * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*          ÝSAVEHISTDATA=NO¨                                          * 00051700
*              Indicates this HISMT call does not require saving      * 00051800
*              historical MT metrics.                                 * 00051900
*                                                                     * 00052000
*          ÝSAVEHISTDATA=YES¨                                         * 00052100
*              Indicates this HISMT call requires saving historical   * 00052200
*              MT metrics.                                            * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*                                                                     * 00052700
*                                                                     * 00052800
*                                                                     * 00052900
*      ÝCOREBUSYTIME=»NO!YESº¨                                        * 00053000
*          is an optional keyword input which indicates that Core     * 00053100
*          Busy Time must be returned by core granularity and can be  * 00053200
*          located using HisMT_Hdr_CoreBusyTime_Desc. Core Busy Time  * 00053300
*          is the amount of time (in milliseconds) a logical core was * 00053400
*          dispatched to a physical core over some interval.  If the  * 00053500
*          system cannot calculate this value, the value will contain * 00053600
*          HisMT_Entry_kNoData.  For example, the COREBUSYTIME will   * 00053700
*          contain HisMt_Entry_kNoData for an undefined core.         * 00053800
*          DEFAULT: NO                                                * 00053900
*                                                                     * 00054000
*                                                                     * 00054100
*          ÝCOREBUSYTIME=NO¨                                          * 00054200
*              Core Busy Time is not needed for any core.             * 00054300
*                                                                     * 00054400
*          ÝCOREBUSYTIME=YES¨                                         * 00054500
*              Core Busy Time is needed for each core.                * 00054600
*                                                                     * 00054700
*                                                                     * 00054800
*                                                                     * 00054900
*                                                                     * 00055000
*                                                                     * 00055100
*                                                                     * 00055200
*      ÝAVGTDCLASS=»NO!YESº¨                                          * 00055300
*          is an optional keyword input which indicates that Average  * 00055400
*          Thread Density must be returned by processor class         * 00055500
*          granularity and can be located using                       * 00055600
*          HisMT_Hdr_AvgTDClass_Desc. Average Thread Density is the   * 00055700
*          average number of active threads for active cores          * 00055800
*          (dispatched to physical hardware) within a processor       * 00055900
*          class.  If the system cannot calculate this value, the     * 00056000
*          value will contain HisMT_Entry_kNoData.  For example, the  * 00056100
*          AVGTDCLASS will contain HisMt_Entry_kNoData when there are * 00056200
*          no cores defined in a processor class, when all cores are  * 00056300
*          offline in a processor class, when all cores in a          * 00056400
*          processor class change ONLINE/OFFLINE status during an     * 00056500
*          HISMT interval or when no cores in a processor class were  * 00056600
*          dispatched to physical hardware.                           * 00056700
*          DEFAULT: NO                                                * 00056800
*                                                                     * 00056900
*                                                                     * 00057000
*          ÝAVGTDCLASS=NO¨                                            * 00057100
*              Average thread density is not needed for any processor * 00057200
*              class.                                                 * 00057300
*                                                                     * 00057400
*          ÝAVGTDCLASS=YES¨                                           * 00057500
*              Average thread density is needed for each processor    * 00057600
*              class.                                                 * 00057700
*                                                                     * 00057800
*                                                                     * 00057900
*                                                                     * 00058000
*                                                                     * 00058100
*                                                                     * 00058200
*                                                                     * 00058300
*      ÝRETCODE=xretcode¨                                             * 00058400
*          is the name (RS-type) of an optional fullword output       * 00058500
*          variable, or register (2)-(12) or (15), into which the     * 00058600
*          return code is to be copied from GPR 15.  If you specify   * 00058700
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00058800
*          the value will be left in GPR 15.                          * 00058900
*                                                                     * 00059000
*                                                                     * 00059100
*                                                                     * 00059200
*                                                                     * 00059300
*      ÝRSNCODE=xrsncode¨                                             * 00059400
*          is the name (RS-type) of an optional fullword output       * 00059500
*          variable into which the reason code is to be copied from   * 00059600
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00059700
*          R0 (within or without parentheses), the value will be left * 00059800
*          in GPR 0.                                                  * 00059900
*                                                                     * 00060000
*                                                                     * 00060100
*                                                                     * 00060200
*                                                                     * 00060300
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00060400
*          is an optional byte input decimal value in the "0-0" range * 00060500
*          that specifies the macro version.  PLISTVER is the only    * 00060600
*          key allowed on the list form of MF and determines which    * 00060700
*          parameter list is generated.  Note that MAX may be         * 00060800
*          specified instead of a number, and the parameter list will * 00060900
*          be of the largest size currently supported. This size may  * 00061000
*          grow from release to release (thus possibly affecting the  * 00061100
*          amount of storage needed by your program).  If your        * 00061200
*          program can tolerate this, IBM recommends that you always  * 00061300
*          specify MAX when creating the list form parameter list as  * 00061400
*          that will ensure that the list form parameter list is      * 00061500
*          always long enough to hold whatever parameters might be    * 00061600
*          specified on the execute form.                             * 00061700
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00061800
*          default is the lowest version which allows all of the      * 00061900
*          parameters specified on the invocation to be processed.    * 00062000
*                                                                     * 00062100
*                                                                     * 00062200
*                                                                     * 00062300
*                                                                     * 00062400
*      ÝMF=»S!L!Eº¨                                                   * 00062500
*          is an optional keyword input which specifies the macro     * 00062600
*          form.                                                      * 00062700
*          DEFAULT: S                                                 * 00062800
*                                                                     * 00062900
*                                                                     * 00063000
*          ÝMF=S¨                                                     * 00063100
*              specifies the standard form of the macro.  The "S"     * 00063200
*              form generates code to put the parameters into an      * 00063300
*              in-line parameter list and invoke the desired service. * 00063400
*              Full checking for required macro keys is done along    * 00063500
*              with supplying defaults for omitted optional           * 00063600
*              parameters.                                            * 00063700
*                                                                     * 00063800
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00063900
*              specifies the list form of the macro.  The "L" form    * 00064000
*              defines an area to be used for the parameter list.     * 00064100
*              Only the PLISTVER key may be specified on the          * 00064200
*              invocation.  All other macro parameters are flagged as * 00064300
*              errors.  If PLISTVER is not specified, the original    * 00064400
*              parameter list definition is used.                     * 00064500
*                                                                     * 00064600
*            ,xmfctrl                                                 * 00064700
*              is a required input.  It is the name of a storage area * 00064800
*              for the parameter list.                                * 00064900
*                                                                     * 00065000
*            »,xmfattr!0Dº                                            * 00065100
*              is an optional 60 character input string that varies   * 00065200
*              from 1 to 60 characters. Use it to force boundary      * 00065300
*              alignment of the parameter list. Use only 0F or 0D.    * 00065400
*              DEFAULT: 0D which forces the parameter list to a       * 00065500
*              doubleword boundary.                                   * 00065600
*                                                                     * 00065700
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00065800
*              specifies the execute form of the macro.  The "E" form * 00065900
*              generates code to put the parameters into the          * 00066000
*              parameter list specified by xmfctrl and provides full  * 00066100
*              syntax checking with default setting.                  * 00066200
*                                                                     * 00066300
*            ,xmfctrl                                                 * 00066400
*              is a required input.  It is the name (RS-type), or     * 00066500
*              address in register (1)-(12), of a storage area for    * 00066600
*              the parameter list.                                    * 00066700
*                                                                     * 00066800
*            »,COMPLETEº                                              * 00066900
*              is an optional keyword input which specifies the       * 00067000
*              degree of macro parameter syntax checking.             * 00067100
*              DEFAULT: COMPLETE                                      * 00067200
*                                                                     * 00067300
*                                                                     * 00067400
*              COMPLETE                                               * 00067500
*                  Checking for required macro keys is done and       * 00067600
*                  defaults are supplied for omitted optional         * 00067700
*                  parameters.                                        * 00067800
*                                                                     * 00067900
*                                                                     * 00068000
*                                                                     * 00068100
*                                                                     * 00068200
*                                                                     * 00068300
*                                                                     * 00068400
*                                                                     * 00068500
*01* ABEND CODES:  None.                                              * 00068600
*                                                                     * 00068700
*01* RETURN CODES:                                                    * 00068800
*                                                                     * 00068900
*                                                                     * 00069000
*                 Macro HISYMT provides constants for the return and  * 00069100
*                 reason codes.  Note carefully that bits 0-15 of the * 00069200
*                 reason code may contain component-diagnostic data   * 00069300
*                 and must not be assumed to be 0.                    * 00069400
*                                                                     * 00069500
*       0         Name: HisMT_kRetOk                                  * 00069600
*                                                                     * 00069700
*                 Meaning:  HISMT request completed successfully.     * 00069800
*                                                                     * 00069900
*                 Action:  None required.                             * 00070000
*                                                                     * 00070100
*                                                                     * 00070200
*       4         Name: HisMT_kRetWarn                                * 00070300
*                                                                     * 00070400
*                 Meaning: Warning                                    * 00070500
*                                                                     * 00070600
*                 Action:  HISMT request completed with a warning.    * 00070700
*                                                                     * 00070800
*                                                                     * 00070900
*                 HEX REASON  MEANING/ACTION                          * 00071000
*                 CODE                                                * 00071100
*                                                                     * 00071200
*                 xxxx0401    Name: HisMT_kRsnWarn_IntvAreaSmall      * 00071300
*                                                                     * 00071400
*                             Meaning: The interval area provided was * 00071500
*                             large enough to hold the minimum amount * 00071600
*                             of data required for the request, but   * 00071700
*                             not large enough to hold all of the     * 00071800
*                             data requested.                         * 00071900
*                                                                     * 00072000
*                             Action: Obtain a larger interval area   * 00072100
*                             using the HisMT_Hdr_LengthRequired      * 00072200
*                             field returned in the request's         * 00072300
*                             INTVAREA.  Then call the service with   * 00072400
*                             the newly allocated interval area.      * 00072500
*                             (See Programming Requirements for the   * 00072600
*                             protocol for passing a new interval     * 00072700
*                             area that is at least                   * 00072800
*                             HisMT_Hdr_LengthRequired bytes long)    * 00072900
*                                                                     * 00073000
*                 xxxx0402    Name: HisMT_kRsnWarn_ConfigChanged      * 00073100
*                                                                     * 00073200
*                             Meaning: The system configuration was   * 00073300
*                             changed during the interval between the * 00073400
*                             last HISMT call and the current HISMT   * 00073500
*                             call.  The metric values returned in    * 00073600
*                             the interval area is questionable since * 00073700
*                             the config was not consistent during    * 00073800
*                             the interval.  See field                * 00073900
*                             HisMT_Hdr_Flags in the interval area    * 00074000
*                             header for what has changed.            * 00074100
*                                                                     * 00074200
*                             Action: The metric values returned from * 00074300
*                             this call can be ignored.               * 00074400
*                                                                     * 00074500
*                                                                     * 00074600
*                                                                     * 00074700
*                                                                     * 00074800
*       8         Name: HisMT_kRetUser                                * 00074900
*                                                                     * 00075000
*                 Meaning: HISMT request failed due to a user error.  * 00075100
*                                                                     * 00075200
*                 Action: Refer to the action provided with the       * 00075300
*                 specific reason code.                               * 00075400
*                                                                     * 00075500
*                                                                     * 00075600
*                 HEX REASON  MEANING/ACTION                          * 00075700
*                 CODE                                                * 00075800
*                                                                     * 00075900
*                 xxxx0801    Name: HisMT_kRsnUser_InvVersion         * 00076000
*                                                                     * 00076100
*                             Meaning: The version for the parameter  * 00076200
*                             list specified is not valid.            * 00076300
*                                                                     * 00076400
*                             Action: Check for possible storage      * 00076500
*                             overlay.                                * 00076600
*                                                                     * 00076700
*                 xxxx0802    Name:                                   * 00076800
*                             HisMT_kRsnUser_InconsistentIntvArea     * 00076900
*                                                                     * 00077000
*                             Meaning: The HISMT call for this        * 00077100
*                             interval does not match the previous    * 00077200
*                             HISMT call for the provided interval    * 00077300
*                             area.                                   * 00077400
*                                                                     * 00077500
*                             Action: If this is the first invocation * 00077600
*                             for this interval area, follow the      * 00077700
*                             protocol described in the Programming   * 00077800
*                             Requirements section to provide an      * 00077900
*                             interval area. If this is a subsequent  * 00078000
*                             call to HISMT for the interval area,    * 00078100
*                             make sure all subsequent calls to HISMT * 00078200
*                             with that interval area request the     * 00078300
*                             same MT metrics.                        * 00078400
*                                                                     * 00078500
*                 xxxx0803    Name: HisMT_kRsnUser_IntvLenTooSmall    * 00078600
*                                                                     * 00078700
*                             Meaning: The interval area is less than * 00078800
*                             HisMT_Hdr_kLength bytes.                * 00078900
*                                                                     * 00079000
*                             Action: Ensure the interval area length * 00079100
*                             and the storage provided for the        * 00079200
*                             interval area is at least               * 00079300
*                             HisMT_Hdr_kLength bytes long.  (See     * 00079400
*                             Programming Requirements for the        * 00079500
*                             protocol for obtaining big enough       * 00079600
*                             storage to contain the requested MT     * 00079700
*                             metrics)                                * 00079800
*                                                                     * 00079900
*                 xxxx0804    Name:                                   * 00080000
*                             HisMT_kRsnUser_UnknownDataInIntvArea    * 00080100
*                                                                     * 00080200
*                             Meaning: The interval area for this     * 00080300
*                             HISMT call contains some unexpected     * 00080400
*                             data. A storage overlay may have        * 00080500
*                             occured.                                * 00080600
*                                                                     * 00080700
*                             Action: Issue HISMT request with a new  * 00080800
*                             interval area.                          * 00080900
*                                                                     * 00081000
*                 xxxx0805    Name: HisMT_kRsnUser_IntvAreaNotAligned * 00081100
*                                                                     * 00081200
*                             Meaning: The interval area provided for * 00081300
*                             this HISMT call is not on a doubleword  * 00081400
*                             boundary.                               * 00081500
*                                                                     * 00081600
*                             Action: Make sure that the interval     * 00081700
*                             area is on a doubleword boundary.       * 00081800
*                                                                     * 00081900
*                 xxxx0806    Name:                                   * 00082000
*                             HisMT_kRsnUser_IntvLenNot8ByteMultiple  * 00082100
*                                                                     * 00082200
*                             Meaning: The interval area length       * 00082300
*                             provided for this HISMT call is not a   * 00082400
*                             multiple of 8-bytes.                    * 00082500
*                                                                     * 00082600
*                             Action: Provide an interval area whose  * 00082700
*                             length is an 8-byte multiple.           * 00082800
*                                                                     * 00082900
*                 xxxx0807    Name: HisMT_kRsnUser_UnknownEyeCatcher  * 00083000
*                                                                     * 00083100
*                             Meaning: The eye catcher in the         * 00083200
*                             interval area for this HISMT call is    * 00083300
*                             unexpected. A storage overlay may have  * 00083400
*                             occured.                                * 00083500
*                                                                     * 00083600
*                             Action: Issue a HISMT request with a    * 00083700
*                             new interval area. The first byte must  * 00083800
*                             contain binary zeroes.                  * 00083900
*                                                                     * 00084000
*                                                                     * 00084100
*                                                                     * 00084200
*                                                                     * 00084300
*       10        Name: HisMT_kRetUnknown                             * 00084400
*                                                                     * 00084500
*                 Meaning: Unexpected failure.                        * 00084600
*                                                                     * 00084700
*                 Action: Refer to the action provided with the       * 00084800
*                 specific reason code.                               * 00084900
*                                                                     * 00085000
*                                                                     * 00085100
*                 HEX REASON  MEANING/ACTION                          * 00085200
*                 CODE                                                * 00085300
*                                                                     * 00085400
*                 xxxx1001    Name: HisMT_kRsnUnknown_Unknown         * 00085500
*                                                                     * 00085600
*                             Meaning: Unexpected failure. The state  * 00085700
*                             of the request is unpredictable.        * 00085800
*                                                                     * 00085900
*                             Action: Contact your system programmer. * 00086000
*                                                                     * 00086100
*                                                                     * 00086200
*                                                                     * 00086300
*                                                                     * 00086400
*                                                                     * 00086500
*01* REASON CODES:                                                    * 00086600
*                                                                     * 00086700
*       Reason codes, as appropriate, are defined under their         * 00086800
*       corresponding return code.                                    * 00086900
*                                                                     * 00087000
*01* MODULE TYPE:  ASSEM MACRO                                        * 00087100
*                                                                     * 00087200
*02*   PROCESSOR:  ASSEM                                              * 00087300
*                                                                     * 00087400
*01* COMPONENT:  SCHIS                                                * 00087500
*                                                                     * 00087600
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00087700
*                                                                     * 00087800
*01* EXAMPLES:                                                        * 00087900
*                                                                     * 00088000
*01* MACRO USAGE NOTES:                                               * 00088100
*                                                                     * 00088200
*                                                                     * 00088300
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00088400
*        global macro variable.  Any value other than 'NO' will       * 00088500
*        result in the macro expansion being printed.  The default is * 00088600
*        'YES'.  The following examples illustrate how the ZPRINT     * 00088700
*        variable should be set.                                      * 00088800
*                                                                     * 00088900
*                    GBLC &ZPRINT                                     * 00089000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00089100
*                                                                     * 00089200
*                                                                     * 00089300
*    2.  All  keys  currently contained in the HISMT macro correspond * 00089400
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 00089500
*        MAX.                                                         * 00089600
*                                                                     * 00089700
*                                                                     * 00089800
*                                                                     * 00089900
*                                                                     * 00090000
*01* CHANGE ACTIVITY:                                                 * 00090100
*                                                                     * 00090200
*   Flag LineItem  FMID    Date   ID    Comment                       * 00090300
*                                                                     * 00090400
*    $L0=HISMT    HBB77A0 121016 PD0AAA:  HISMT  Service              * 00090500
*    $01=OA48571  HBB77A0 151130 PD00NJ:  HFTS MAXCAPAN               * 00090600
****** END OF SPECIFICATIONS *****************************************/ 00090700
*/********************************************************************* 00090800
         MACRO                                                          00090900
&XLABEL  HISMT &INTVAREA=,&INTVAREALEN=,&PRODCLASS=,&PRODCORE=,        *00091000
               &CAPCLASS=,&MAXCAPCLASS=,&MAXCAPAN=,&CBFCLASS=,&CBFAN=, *00091100
               &SAVEHISTDATA=,&COREBUSYTIME=,&AVGTDCLASS=,&RETCODE=,   *00091200
               &RSNCODE=,&PLISTVER=,&MF=                                00091300
.*                                                                      00091400
*                  MACDATE -01/04/17-<0>                                00091500
.*                                                                      00091600
.*******************************************************************    00091700
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00091800
.*******************************************************************    00091900
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00092000
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00092100
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00092200
.*                                                                      00092300
                  GBLC  &ZHISMT     YES=MACRO USED AT LEAST ONCE        00092400
.*******************************************************************    00092500
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00092600
.*******************************************************************    00092700
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00092800
                  LCLC  &ZCNDX      SYSNDX CHARACTERS                   00092900
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00093000
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00093100
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00093200
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00093300
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00093400
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00093500
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00093600
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00093700
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00093800
                  LCLC  &ZMAC_G     "G" or null                         00093900
&ZMAC_G           SETC  ''                                              00094000
                  LCLC  &ZMAC_LR                                        00094100
&ZMAC_LR          SETC  'LR'                                            00094200
                  LCLC  &ZMAC_L                                         00094300
&ZMAC_L           SETC  'L'                                             00094400
                  LCLC  &ZMAC_ST                                        00094500
&ZMAC_ST          SETC  'ST'                                            00094600
                  LCLC  &ZMAC_LLGT                                      00094700
&ZMAC_LLGT        SETC  'L'                                             00094800
                  LCLC  &ZMAC_LGR                                       00094900
&ZMAC_LGR         SETC  'LR'                                            00095000
                  LCLC  &ZMAC_LG                                        00095100
&ZMAC_LG          SETC  'L'                                             00095200
                  LCLC  &ZMAC_STG                                       00095300
&ZMAC_STG         SETC  'ST'                                            00095400
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00095500
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00095600
.*                                                                      00095700
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00095800
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00095900
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00096000
                  LCLC  &ZENDBASEPL             End of base PL          00096100
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00096200
.*******************************************************************    00096300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00096400
.*******************************************************************    00096500
                  LCLA  &ZI         INDEX FOR ARRAY                     00096600
                  LCLA  &ZJ         INDEX FOR PARMS                     00096700
                  LCLA  &ZK         INDEX FOR PARSE                     00096800
                  LCLA  &ZLO        LOW RANGE VALUE                     00096900
                  LCLA  &ZHI        HIGH RANGE VALUE                    00097000
                  LCLC  &ZW         WORK AREA FOR PARM                  00097100
.********************************************************************   00097200
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00097300
.********************************************************************   00097400
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00097500
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00097600
                  GBLA  &SYSALVL    SYSSTATE ARCHLVL                    00097700
                  GBLC  &SYSAM64    SYSSTATE AMODE64                    00097800
.*                                                                      00097900
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00098000
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00098100
                  SPLEVEL  TEST                                         00098200
.ZSYS2            ANOP  ,                                               00098300
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00098400
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00098500
                  SYSSTATE TEST                                         00098600
                  AGO   .ZSYS4                                          00098700
.ZSYS3            ANOP  ,                                               00098800
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00098900
.ZSYS4            ANOP  ,                                               00099000
                  AIF   ('&SYSAM64' NE 'YES').ZSYSN64                   00099100
&ZMAC_LLGT        SETC 'LLGT'                                           00099200
&ZMAC_LGR         SETC 'LGR'                                            00099300
&ZMAC_LG          SETC 'LG'                                             00099400
&ZMAC_STG         SETC 'STG'                                            00099500
.ZSYSN64          ANOP  ,                                               00099600
&ZMAC_G           SETC 'G'                                              00099700
&ZMAC_LR          SETC 'LGR'                                            00099800
&ZMAC_L           SETC 'LG'                                             00099900
&ZMAC_ST          SETC 'STG'                                            00100000
.*******************************************************************    00100100
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00100200
.*******************************************************************    00100300
                  LCLC  &XINTVAREA  ++ NAME                             00100400
                  LCLC  &XINTVAREALEN           ++ NAME                 00100500
                  LCLC  &XPRODCLASS             ++ VALUE                00100600
                  LCLC  &XPRODCORE  ++ VALUE                            00100700
                  LCLC  &XCAPCLASS  ++ VALUE                            00100800
                  LCLC  &XMAXCAPCLASS           ++ VALUE                00100900
                  LCLC  &XMAXCAPAN  ++ VALUE                            00101000
                  LCLC  &XCBFCLASS  ++ VALUE                            00101100
                  LCLC  &XCBFAN     ++ VALUE                            00101200
                  LCLC  &XSAVEHISTDATA          ++ VALUE                00101300
                  LCLC  &XCOREBUSYTIME          ++ VALUE                00101400
                  LCLC  &XAVGTDCLASS            ++ VALUE                00101500
                  LCLC  &XRETCODE   ++ NAME                             00101600
                  LCLC  &XRSNCODE   ++ NAME                             00101700
                  LCLA  &XPLISTVER  ++ VALUE                            00101800
                  LCLC  &XMF        ++ VALUE                            00101900
                  LCLC  &XMFCTRL    ++ NAME                             00102000
                  LCLC  &XMFATTR    ++ VALUE                            00102100
                  LCLC  &XMFSCK     ++ VALUE                            00102200
.*******************************************************************    00102300
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00102400
.*******************************************************************    00102500
                  LCLC  &ZXINTVAREA             ++ INOUT NAME           00102600
                  LCLC  &ZXINTVAREALEN          ++ INPUT NAME           00102700
                  LCLC  &ZXPRODCLASS            ++ INPUT VALUE          00102800
                  LCLC  &ZXPRODCORE             ++ INPUT VALUE          00102900
                  LCLC  &ZXCAPCLASS             ++ INPUT VALUE          00103000
                  LCLC  &ZXMAXCAPCLASS          ++ INPUT VALUE          00103100
                  LCLC  &ZXMAXCAPAN             ++ INPUT VALUE          00103200
                  LCLC  &ZXCBFCLASS             ++ INPUT VALUE          00103300
                  LCLC  &ZXCBFAN    ++ INPUT VALUE                      00103400
                  LCLC  &ZXSAVEHISTDATA         ++ INPUT VALUE          00103500
                  LCLC  &ZXCOREBUSYTIME         ++ INPUT VALUE          00103600
                  LCLC  &ZXAVGTDCLASS           ++ INPUT VALUE          00103700
                  LCLC  &ZXRETCODE  ++ OUTPUT NAME                      00103800
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00103900
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00104000
                  LCLC  &ZXMF       ++ INPUT VALUE                      00104100
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00104200
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00104300
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00104400
.********************************************************************   00104500
.***AC.PLV01  PROCESS PLISTVER                                      *   00104600
.********************************************************************   00104700
&XPLISTVER      SETA  0                                                 00104800
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00104900
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00105000
&XPLISTVER      SETA  0                                                 00105100
.ZPLV0          ANOP  ,                                                 00105200
.*                                                                      00105300
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00105400
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00105500
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00105600
.*-------------------------------------------------------------------   00105700
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00105800
&ZMS            SETC  '"PLISTVER='                                      00105900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00106000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00106100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00106200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00106300
                AGO   .ZPVCK2                                           00106400
.ZPVCK3         ANOP  ,                                                 00106500
.*-------------------------------------------------------------------   00106600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00106700
&ZMS            SETC  '"PLISTVER='                                      00106800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00106900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00107000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00107100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00107200
                AGO   .ZPVCKE                                           00107300
.ZPVCK2         ANOP  ,                                                 00107400
.*-------------------------------------------------------------------   00107500
&ZCVAL          SETC  '&PLISTVER(1)'                                    00107600
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00107700
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00107800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00107900
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00108000
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00108100
.ZPVCK6         ANOP  ,                                                 00108200
&ZMS            SETC  '"PLISTVER='                                      00108300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00108400
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00108500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00108600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00108700
&XPLISTVER      SETA  0                                                 00108800
                AGO   .ZPVCKE                                           00108900
.*-------------------------------------------------------------------   00109000
.ZPVCK4A        ANOP  ,                                                 00109100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00109200
&ZMS            SETC  'PLISTVER='                                       00109300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00109400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00109500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00109600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00109700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00109800
                AGO   .ZPVCK5                                           00109900
.ZPVCK4         ANOP  ,                                                 00110000
&XPLISTVER      SETA  &PLISTVER(1)                                      00110100
.ZPVCK5         ANOP  ,                                                 00110200
.ZPVCKE         ANOP  ,                                                 00110300
.********************************************************************   00110400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00110500
.********************************************************************   00110600
                  ACTR  10000                                           00110700
.*------------------------------------------------------------------    00110800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110900
&XMF              SETC  ''          INITIALIZE XVARIABLE                00111000
.*-------------------------------------------------------------------   00111100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00111200
.ZG68             ANOP  ,                                               00111300
&ZTLC             SETC 'S'                                              00111400
                  AIF   ('&MF(1)' NE '&ZTLC').ZG69                      00111500
&XMF              SETC  'S'         SET KEYWORD                         00111600
                  AIF   (N'&MF LE 1).ZG68A      CK NUM                  00111700
&ZMS              SETC  '"MF='                                          00111800
&ZMS              SETC  '&ZMS.&MF"'                                     00111900
&ZMS              SETC  '&ZMS "MF"'                                     00112000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00112100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00112200
.ZG68A            ANOP  ,                                               00112300
.*-------------------------------------------------------------------   00112400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112500
.ZG69             ANOP  ,                                               00112600
&ZTLC             SETC 'L'                                              00112700
                  AIF   ('&MF(1)' NE '&ZTLC').ZG76                      00112800
&XMF              SETC  'L'         SET KEYWORD                         00112900
                  AIF   (N'&MF LE 3).ZG69A      CK NUM                  00113000
&ZMS              SETC  '"MF='                                          00113100
&ZMS              SETC  '&ZMS.&MF"'                                     00113200
&ZMS              SETC  '&ZMS "MF"'                                     00113300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00113400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00113500
.ZG69A            ANOP  ,                                               00113600
.*-------------------------------------------------------------------   00113700
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00113800
                  AIF   (N'&SYSLIST NE 0).ZG69B  POSITIONALS?           00113900
                  AIF   ('&INTVAREA' NE '').ZG69B  KEYS?                00114000
                  AIF   ('&INTVAREALEN' NE '').ZG69B  KEYS?             00114100
                  AIF   ('&PRODCLASS' NE '').ZG69B  KEYS?               00114200
                  AIF   ('&PRODCORE' NE '').ZG69B  KEYS?                00114300
                  AIF   ('&CAPCLASS' NE '').ZG69B  KEYS?                00114400
                  AIF   ('&MAXCAPCLASS' NE '').ZG69B  KEYS?             00114500
                  AIF   ('&MAXCAPAN' NE '').ZG69B  KEYS?                00114600
                  AIF   ('&CBFCLASS' NE '').ZG69B  KEYS?                00114700
                  AIF   ('&CBFAN' NE '').ZG69B  KEYS?                   00114800
                  AIF   ('&SAVEHISTDATA' NE '').ZG69B  KEYS?            00114900
                  AIF   ('&COREBUSYTIME' NE '').ZG69B  KEYS?            00115000
                  AIF   ('&AVGTDCLASS' NE '').ZG69B  KEYS?              00115100
                  AIF   ('&RETCODE' NE '').ZG69B  KEYS?                 00115200
                  AIF   ('&RSNCODE' NE '').ZG69B  KEYS?                 00115300
                  AGO    .ZG69C     INVOCATION OKAY                     00115400
.ZG69B            ANOP  ,                                               00115500
&ZMS              SETC  'THE "L" FORM OF "MF"'                          00115600
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00115700
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00115800
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00115900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00116000
.ZG69C            ANOP  ,                                               00116100
.*-------------------------------------------------------------------   00116200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00116300
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00116400
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00116500
                  AIF   (N'&MF(2) GT 1).ZG71B   MULTI                   00116600
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00116700
.ZG71B            AIF   (K'&MF(2) GT 0).ZG71C                           00116800
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00116900
&ZMS              SETC  'WHEN "L" IS SPECIFIED'                         00117000
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00117100
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00117200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00117300
.ZG71C            ANOP  ,                                               00117400
.*-------------------------------------------------------------------   00117500
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00117600
                  AIF   (K'&ZXMFCTRL LE 0).ZG71P  NOT I/O               00117700
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG71P                  00117800
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00117900
&ZMS              SETC  '"MF='                                          00118000
&ZMS              SETC  '&ZMS.&MF"'                                     00118100
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00118200
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00118300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00118400
.ZG71P            ANOP  ,                                               00118500
.*-------------------------------------------------------------------   00118600
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00118700
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00118800
&XMFATTR          SETC  '0D'                                            00118900
                  AIF   (K'&MF(3) LE 0).ZG74B   PARM                    00119000
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00119100
                  AIF   (N'&MF(3) GT 1).ZG74B   MULTI                   00119200
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00119300
.ZG74B            ANOP  ,                                               00119400
.*-------------------------------------------------------------------   00119500
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00119600
                  AIF   (K'&ZXMFATTR LE 0).ZG74P  NOT I/O               00119700
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG74P                  00119800
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00119900
&ZMS              SETC  '"MF='                                          00120000
&ZMS              SETC  '&ZMS.&MF"'                                     00120100
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00120200
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00120300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00120400
.ZG74P            ANOP  ,                                               00120500
.*-------------------------------------------------------------------   00120600
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00120700
                  AIF   (K'&ZXMFATTR LE 0).ZG74S  NOT I/O               00120800
                  AIF   (K'&XMFATTR LE 60).ZG74S  LNG OK                00120900
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00121000
&ZMS              SETC  '"MF='                                          00121100
&ZMS              SETC  '&ZMS.&MF"'                                     00121200
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00121300
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00121400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00121500
.ZG74S            ANOP  ,                                               00121600
.*-------------------------------------------------------------------   00121700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121800
.ZG76             ANOP  ,                                               00121900
&ZTLC             SETC 'E'                                              00122000
                  AIF   ('&MF(1)' NE '&ZTLC').ZG84                      00122100
&XMF              SETC  'E'         SET KEYWORD                         00122200
                  AIF   (N'&MF LE 3).ZG76A      CK NUM                  00122300
&ZMS              SETC  '"MF='                                          00122400
&ZMS              SETC  '&ZMS.&MF"'                                     00122500
&ZMS              SETC  '&ZMS "MF"'                                     00122600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00122700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00122800
.ZG76A            ANOP  ,                                               00122900
.*-------------------------------------------------------------------   00123000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00123100
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00123200
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00123300
                  AIF   (N'&MF(2) GT 1).ZG78B   MULTI                   00123400
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00123500
.ZG78B            AIF   (K'&MF(2) GT 0).ZG78C                           00123600
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00123700
&ZMS              SETC  'WHEN "E" IS SPECIFIED'                         00123800
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00123900
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00124000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00124100
.ZG78C            ANOP  ,                                               00124200
.*-------------------------------------------------------------------   00124300
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00124400
                  AIF   (K'&ZXMFCTRL LE 0).ZG78R  NOT I/O               00124500
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG78R                  00124600
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00124700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG78P                    00124800
                  AIF   (K'&ZCGPR GT 2).ZG78Q                           00124900
                  AIF   ('&ZCGPR' EQ '0').ZG78Q                         00125000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00125100
                  AIF   (T'&ZCGPR NE 'N').ZG78Q  INVALID REG NAME       00125200
.ZG78P            ANOP  ,                                               00125300
                  AIF   (T'&ZCGPR NE 'N').ZG78R  NON NUMERIC            00125400
                  AIF   ('&ZCGPR' LT '1').ZG78Q                         00125500
                  AIF   ('&ZCGPR' LE '12').ZG78R                        00125600
.ZG78Q            ANOP  ,                                               00125700
&ZMS              SETC  '"MF='                                          00125800
&ZMS              SETC  '&ZMS.&MF"'                                     00125900
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00126000
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00126100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00126200
.ZG78R            ANOP  ,                                               00126300
.*-------------------------------------------------------------------   00126400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00126500
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00126600
.ZG82A   AIF   ('&MF(3)' NE 'COMPLETE').ZG83A                           00126700
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00126800
.*-------------------------------------------------------------------   00126900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00127000
.ZG83A            AIF   (K'&XMFSCK GT 0).ZG83C  KEYWORD                 00127100
                  AIF   (K'&MF(3) LE 0).ZG83B                           00127200
&ZMS              SETC  '"MF='                                          00127300
&ZMS              SETC  '&ZMS.&MF"'                                     00127400
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00127500
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00127600
&ZMS              SETC  '&ZMS "COMPLETE".'                              00127700
                  MNOTE 8,' &ZMS '                                      00127800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00127900
.ZG83B            ANOP  ,                                               00128000
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00128100
.ZG83C            ANOP  ,                                               00128200
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00128300
.*------------------------------------------------------------------    00128400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128500
.ZG84             ANOP  ,                                               00128600
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00128700
                  AIF   (K'&XMF GT 0).ZG84E     VALID ARG               00128800
                  AIF   (T'&MF EQ 'O').ZG84D    OMITTED                 00128900
&ZASYSLNDX        SETA  0                                               00129000
.ZG84A            ANOP  ,           POSITIONAL MACRO KEY                00129100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00129200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG84C                00129300
&ZTLC             SETC 'MF'                                             00129400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG84A       00129500
.ZG84B            ANOP  ,                                               00129600
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00129700
&ZMS              SETC  'THE "MF" KEY'                                  00129800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00129900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00130000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00130100
                  AGO   .ZG84E                                          00130200
.ZG84C            ANOP  ,                                               00130300
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00130400
&ZMS              SETC  '"MF='                                          00130500
&ZMS              SETC  '&ZMS.&MF"'                                     00130600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00130700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00130800
&ZMS              SETC  '&ZMS "S",'                                     00130900
&ZMS              SETC  '&ZMS "L",'                                     00131000
&ZMS              SETC  '&ZMS OR "E".'                                  00131100
                  MNOTE 8,' &ZMS '                                      00131200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00131300
                  AGO   .ZG84E                                          00131400
.ZG84D            ANOP  ,                                               00131500
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00131600
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00131700
.ZG84E            ANOP  ,                                               00131800
.********************************************************************   00131900
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00132000
.********************************************************************   00132100
                  ACTR  10000                                           00132200
.*-------------------------------------------------------------------   00132300
.***AG.MF03 MF=(SLE)                                                    00132400
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00132500
.*----------------------------------------------------------------***   00132600
.***AG.KXVAR05 NAME, RQD INOUT, KEYS -XVARIABLE KEY                     00132700
                  AIF   (N'&INTVAREA LE 1).ZG2A  CK NUM                 00132800
&ZMS              SETC  '"INTVAREA='                                    00132900
&ZMS              SETC  '&ZMS.&INTVAREA"'                               00133000
&ZMS              SETC  '&ZMS "INTVAREA"'                               00133100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00133200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00133300
.ZG2A             ANOP  ,                                               00133400
.*-------------------------------------------------------------------   00133500
.***AG.KXVAR06 NAME, RQD INOUT, KEYS -XVARIABLE                         00133600
&ZXINTVAREA       SETC  'INOUT'     SET IN/OUTPUT                       00133700
&XINTVAREA        SETC  '&INTVAREA(1)'          SET XVARIABLE           00133800
                  AIF   (N'&INTVAREA GT 1).ZG2B  MULTI                  00133900
&XINTVAREA        SETC  '&INTVAREA'             SET XVARIABLE           00134000
.ZG2B             AIF   (K'&INTVAREA(1) GT 0).ZG2C                      00134100
&ZXINTVAREA       SETC  ''          RESET IN/OUTPUT                     00134200
&ZMS              SETC  ' '                                             00134300
&ZMS              SETC  '&ZMS "INTVAREA" KEY AND ITS'                   00134400
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00134500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00134600
.ZG2C             ANOP  ,                                               00134700
.*-------------------------------------------------------------------   00134800
.***AG.KCK02 NAME, RQD INOUT, KEYS -GPR OUT OF RANGE                    00134900
                  AIF   (K'&ZXINTVAREA LE 0).ZG2R  NOT I/O              00135000
                  AIF   ('&XINTVAREA'(1,1) NE '(').ZG2R                 00135100
&ZCGPR            SETC  '&XINTVAREA'(2,K'&XINTVAREA-2)                  00135200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                     00135300
                  AIF   (K'&ZCGPR GT 2).ZG2Q                            00135400
                  AIF   ('&ZCGPR' EQ '0').ZG2Q                          00135500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00135600
                  AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME        00135700
.ZG2P             ANOP  ,                                               00135800
                  AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC             00135900
                  AIF   ('&ZCGPR' LT '2').ZG2Q                          00136000
                  AIF   ('&ZCGPR' LE '12').ZG2R                         00136100
.ZG2Q             ANOP  ,                                               00136200
&ZMS              SETC  '"INTVAREA='                                    00136300
&ZMS              SETC  '&ZMS.&INTVAREA"'                               00136400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00136500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00136600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00136700
.ZG2R             ANOP  ,                                               00136800
.*----------------------------------------------------------------***   00136900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00137000
                  AIF   (N'&INTVAREALEN LE 1).ZG5A  CK NUM              00137100
&ZMS              SETC  '"INTVAREALEN='                                 00137200
&ZMS              SETC  '&ZMS.&INTVAREALEN"'                            00137300
&ZMS              SETC  '&ZMS "INTVAREALEN"'                            00137400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00137500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00137600
.ZG5A             ANOP  ,                                               00137700
.*-------------------------------------------------------------------   00137800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00137900
&ZXINTVAREALEN    SETC  'INPUT'     SET IN/OUTPUT                       00138000
&XINTVAREALEN     SETC  '&INTVAREALEN(1)'       SET XVARIABLE           00138100
                  AIF   (N'&INTVAREALEN GT 1).ZG5B  MULTI               00138200
&XINTVAREALEN     SETC  '&INTVAREALEN'          SET XVARIABLE           00138300
.ZG5B             AIF   (K'&INTVAREALEN(1) GT 0).ZG5C                   00138400
&ZXINTVAREALEN    SETC  ''          RESET IN/OUTPUT                     00138500
&ZMS              SETC  ' '                                             00138600
&ZMS              SETC  '&ZMS "INTVAREALEN" KEY AND ITS'                00138700
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00138800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00138900
.ZG5C             ANOP  ,                                               00139000
.*-------------------------------------------------------------------   00139100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00139200
                  AIF   (K'&ZXINTVAREALEN LE 0).ZG5R  NOT I/O           00139300
                  AIF   ('&XINTVAREALEN'(1,1) NE '(').ZG5R              00139400
&ZCGPR            SETC  '&XINTVAREALEN'(2,K'&XINTVAREALEN-2)            00139500
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                     00139600
                  AIF   (K'&ZCGPR GT 2).ZG5Q                            00139700
                  AIF   ('&ZCGPR' EQ '0').ZG5Q                          00139800
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00139900
                  AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME        00140000
.ZG5P             ANOP  ,                                               00140100
                  AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC             00140200
                  AIF   ('&ZCGPR' LT '2').ZG5Q                          00140300
                  AIF   ('&ZCGPR' LE '12').ZG5R                         00140400
.ZG5Q             ANOP  ,                                               00140500
&ZMS              SETC  '"INTVAREALEN='                                 00140600
&ZMS              SETC  '&ZMS.&INTVAREALEN"'                            00140700
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00140800
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00140900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00141000
.ZG5R             ANOP  ,                                               00141100
.*------------------------------------------------------------------    00141200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141300
&XPRODCLASS       SETC  ''          INITIALIZE XVARIABLE                00141400
.*-------------------------------------------------------------------   00141500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141600
.ZG9              ANOP  ,                                               00141700
                  AIF   (K'&PRODCLASS(1) LE 0).ZG9A                     00141800
&ZTLC             SETC 'NO'                                             00141900
                  AIF   ('&PRODCLASS(1)' NE '&ZTLC').ZG10               00142000
&XPRODCLASS       SETC  'NO'        SET KEYWORD                         00142100
                  AIF   (N'&PRODCLASS LE 1).ZG9A  CK NUM                00142200
&ZMS              SETC  '"PRODCLASS='                                   00142300
&ZMS              SETC  '&ZMS.&PRODCLASS"'                              00142400
&ZMS              SETC  '&ZMS "PRODCLASS"'                              00142500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00142600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00142700
.ZG9A             ANOP  ,                                               00142800
.*-------------------------------------------------------------------   00142900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00143000
.ZG10             ANOP  ,                                               00143100
&ZTLC             SETC 'YES'                                            00143200
                  AIF   ('&PRODCLASS(1)' NE '&ZTLC').ZG11               00143300
&XPRODCLASS       SETC  'YES'       SET KEYWORD                         00143400
                  AIF   (N'&PRODCLASS LE 1).ZG10A  CK NUM               00143500
&ZMS              SETC  '"PRODCLASS='                                   00143600
&ZMS              SETC  '&ZMS.&PRODCLASS"'                              00143700
&ZMS              SETC  '&ZMS "PRODCLASS"'                              00143800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00143900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00144000
.ZG10A            ANOP  ,                                               00144100
.*------------------------------------------------------------------    00144200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144300
.ZG11             ANOP  ,                                               00144400
&ZXPRODCLASS      SETC  'INPUT'     SET IN/OUTPUT                       00144500
                  AIF   (K'&XPRODCLASS GT 0).ZG11E  VALID ARG           00144600
                  AIF   (T'&PRODCLASS EQ 'O').ZG11D  OMITTED            00144700
&ZASYSLNDX        SETA  0                                               00144800
.ZG11A            ANOP  ,           POSITIONAL MACRO KEY                00144900
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00145000
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG11C                00145100
&ZTLC             SETC 'PRODCLASS'                                      00145200
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG11A       00145300
.ZG11B            ANOP  ,                                               00145400
&ZXPRODCLASS      SETC  ''          RESET IN/OUTPUT                     00145500
&ZMS              SETC  'THE "PRODCLASS" KEY'                           00145600
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00145700
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00145800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00145900
                  AGO   .ZG11E                                          00146000
.ZG11C            ANOP  ,                                               00146100
&ZXPRODCLASS      SETC  ''          RESET IN/OUTPUT                     00146200
&ZMS              SETC  '"PRODCLASS='                                   00146300
&ZMS              SETC  '&ZMS.&PRODCLASS"'                              00146400
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00146500
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00146600
&ZMS              SETC  '&ZMS "NO"'                                     00146700
&ZMS              SETC  '&ZMS OR "YES".'                                00146800
                  MNOTE 8,' &ZMS '                                      00146900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00147000
                  AGO   .ZG11E                                          00147100
.ZG11D            ANOP  ,                                               00147200
&XPRODCLASS       SETC  'NO'        SET DEFAULT KEYWORD                 00147300
.ZG11E            ANOP  ,                                               00147400
.*------------------------------------------------------------------    00147500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147600
&XPRODCORE        SETC  ''          INITIALIZE XVARIABLE                00147700
.*-------------------------------------------------------------------   00147800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147900
.ZG14             ANOP  ,                                               00148000
                  AIF   (K'&PRODCORE(1) LE 0).ZG14A                     00148100
&ZTLC             SETC 'NO'                                             00148200
                  AIF   ('&PRODCORE(1)' NE '&ZTLC').ZG15                00148300
&XPRODCORE        SETC  'NO'        SET KEYWORD                         00148400
                  AIF   (N'&PRODCORE LE 1).ZG14A  CK NUM                00148500
&ZMS              SETC  '"PRODCORE='                                    00148600
&ZMS              SETC  '&ZMS.&PRODCORE"'                               00148700
&ZMS              SETC  '&ZMS "PRODCORE"'                               00148800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00148900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00149000
.ZG14A            ANOP  ,                                               00149100
.*-------------------------------------------------------------------   00149200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149300
.ZG15             ANOP  ,                                               00149400
&ZTLC             SETC 'YES'                                            00149500
                  AIF   ('&PRODCORE(1)' NE '&ZTLC').ZG16                00149600
&XPRODCORE        SETC  'YES'       SET KEYWORD                         00149700
                  AIF   (N'&PRODCORE LE 1).ZG15A  CK NUM                00149800
&ZMS              SETC  '"PRODCORE='                                    00149900
&ZMS              SETC  '&ZMS.&PRODCORE"'                               00150000
&ZMS              SETC  '&ZMS "PRODCORE"'                               00150100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00150200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00150300
.ZG15A            ANOP  ,                                               00150400
.*------------------------------------------------------------------    00150500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150600
.ZG16             ANOP  ,                                               00150700
&ZXPRODCORE       SETC  'INPUT'     SET IN/OUTPUT                       00150800
                  AIF   (K'&XPRODCORE GT 0).ZG16E  VALID ARG            00150900
                  AIF   (T'&PRODCORE EQ 'O').ZG16D  OMITTED             00151000
&ZASYSLNDX        SETA  0                                               00151100
.ZG16A            ANOP  ,           POSITIONAL MACRO KEY                00151200
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00151300
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C                00151400
&ZTLC             SETC 'PRODCORE'                                       00151500
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG16A       00151600
.ZG16B            ANOP  ,                                               00151700
&ZXPRODCORE       SETC  ''          RESET IN/OUTPUT                     00151800
&ZMS              SETC  'THE "PRODCORE" KEY'                            00151900
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00152000
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00152100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00152200
                  AGO   .ZG16E                                          00152300
.ZG16C            ANOP  ,                                               00152400
&ZXPRODCORE       SETC  ''          RESET IN/OUTPUT                     00152500
&ZMS              SETC  '"PRODCORE='                                    00152600
&ZMS              SETC  '&ZMS.&PRODCORE"'                               00152700
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00152800
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00152900
&ZMS              SETC  '&ZMS "NO"'                                     00153000
&ZMS              SETC  '&ZMS OR "YES".'                                00153100
                  MNOTE 8,' &ZMS '                                      00153200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00153300
                  AGO   .ZG16E                                          00153400
.ZG16D            ANOP  ,                                               00153500
&XPRODCORE        SETC  'NO'        SET DEFAULT KEYWORD                 00153600
.ZG16E            ANOP  ,                                               00153700
.*------------------------------------------------------------------    00153800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00153900
&XCAPCLASS        SETC  ''          INITIALIZE XVARIABLE                00154000
.*-------------------------------------------------------------------   00154100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00154200
.ZG19             ANOP  ,                                               00154300
                  AIF   (K'&CAPCLASS(1) LE 0).ZG19A                     00154400
&ZTLC             SETC 'NO'                                             00154500
                  AIF   ('&CAPCLASS(1)' NE '&ZTLC').ZG20                00154600
&XCAPCLASS        SETC  'NO'        SET KEYWORD                         00154700
                  AIF   (N'&CAPCLASS LE 1).ZG19A  CK NUM                00154800
&ZMS              SETC  '"CAPCLASS='                                    00154900
&ZMS              SETC  '&ZMS.&CAPCLASS"'                               00155000
&ZMS              SETC  '&ZMS "CAPCLASS"'                               00155100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00155200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00155300
.ZG19A            ANOP  ,                                               00155400
.*-------------------------------------------------------------------   00155500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155600
.ZG20             ANOP  ,                                               00155700
&ZTLC             SETC 'YES'                                            00155800
                  AIF   ('&CAPCLASS(1)' NE '&ZTLC').ZG21                00155900
&XCAPCLASS        SETC  'YES'       SET KEYWORD                         00156000
                  AIF   (N'&CAPCLASS LE 1).ZG20A  CK NUM                00156100
&ZMS              SETC  '"CAPCLASS='                                    00156200
&ZMS              SETC  '&ZMS.&CAPCLASS"'                               00156300
&ZMS              SETC  '&ZMS "CAPCLASS"'                               00156400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00156500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00156600
.ZG20A            ANOP  ,                                               00156700
.*------------------------------------------------------------------    00156800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156900
.ZG21             ANOP  ,                                               00157000
&ZXCAPCLASS       SETC  'INPUT'     SET IN/OUTPUT                       00157100
                  AIF   (K'&XCAPCLASS GT 0).ZG21E  VALID ARG            00157200
                  AIF   (T'&CAPCLASS EQ 'O').ZG21D  OMITTED             00157300
&ZASYSLNDX        SETA  0                                               00157400
.ZG21A            ANOP  ,           POSITIONAL MACRO KEY                00157500
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00157600
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG21C                00157700
&ZTLC             SETC 'CAPCLASS'                                       00157800
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG21A       00157900
.ZG21B            ANOP  ,                                               00158000
&ZXCAPCLASS       SETC  ''          RESET IN/OUTPUT                     00158100
&ZMS              SETC  'THE "CAPCLASS" KEY'                            00158200
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00158300
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00158400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00158500
                  AGO   .ZG21E                                          00158600
.ZG21C            ANOP  ,                                               00158700
&ZXCAPCLASS       SETC  ''          RESET IN/OUTPUT                     00158800
&ZMS              SETC  '"CAPCLASS='                                    00158900
&ZMS              SETC  '&ZMS.&CAPCLASS"'                               00159000
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00159100
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00159200
&ZMS              SETC  '&ZMS "NO"'                                     00159300
&ZMS              SETC  '&ZMS OR "YES".'                                00159400
                  MNOTE 8,' &ZMS '                                      00159500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00159600
                  AGO   .ZG21E                                          00159700
.ZG21D            ANOP  ,                                               00159800
&XCAPCLASS        SETC  'NO'        SET DEFAULT KEYWORD                 00159900
.ZG21E            ANOP  ,                                               00160000
.*------------------------------------------------------------------    00160100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160200
&XMAXCAPCLASS     SETC  ''          INITIALIZE XVARIABLE                00160300
.*-------------------------------------------------------------------   00160400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160500
.ZG24             ANOP  ,                                               00160600
                  AIF   (K'&MAXCAPCLASS(1) LE 0).ZG24A                  00160700
&ZTLC             SETC 'NO'                                             00160800
                  AIF   ('&MAXCAPCLASS(1)' NE '&ZTLC').ZG25             00160900
&XMAXCAPCLASS     SETC  'NO'        SET KEYWORD                         00161000
                  AIF   (N'&MAXCAPCLASS LE 1).ZG24A  CK NUM             00161100
&ZMS              SETC  '"MAXCAPCLASS='                                 00161200
&ZMS              SETC  '&ZMS.&MAXCAPCLASS"'                            00161300
&ZMS              SETC  '&ZMS "MAXCAPCLASS"'                            00161400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00161500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00161600
.ZG24A            ANOP  ,                                               00161700
.*------------------------------------------------------------------    00161800
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00161900
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00162000
.ZG24A0           AIF   (K'&MAXCAPAN LE 0).ZG24A1  OK                   00162100
&ZCVAL            SETC '&ZCVAL MAXCAPAN'        INCORRECT KEY USED      00162200
.ZG24A1           AIF   (K'&ZCVAL LE 0).ZG24A2  OK                      00162300
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00162400
&ZMS              SETC  '"MAXCAPCLASS'                                  00162500
&ZMS              SETC  '&ZMS.=&MAXCAPCLASS"'                           00162600
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00162700
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00162800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00162900
.ZG24A2           ANOP  ,                                               00163000
.*-------------------------------------------------------------------   00163100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00163200
.ZG25             ANOP  ,                                               00163300
&ZTLC             SETC 'YES'                                            00163400
                  AIF   ('&MAXCAPCLASS(1)' NE '&ZTLC').ZG31             00163500
&XMAXCAPCLASS     SETC  'YES'       SET KEYWORD                         00163600
                  AIF   (N'&MAXCAPCLASS LE 1).ZG25A  CK NUM             00163700
&ZMS              SETC  '"MAXCAPCLASS='                                 00163800
&ZMS              SETC  '&ZMS.&MAXCAPCLASS"'                            00163900
&ZMS              SETC  '&ZMS "MAXCAPCLASS"'                            00164000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00164100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00164200
.ZG25A            ANOP  ,                                               00164300
.*------------------------------------------------------------------    00164400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00164500
&XMAXCAPAN        SETC  ''          INITIALIZE XVARIABLE                00164600
.*-------------------------------------------------------------------   00164700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00164800
.ZG28             ANOP  ,                                               00164900
                  AIF   (K'&MAXCAPAN(1) LE 0).ZG28A                     00165000
&ZTLC             SETC 'NO'                                             00165100
                  AIF   ('&MAXCAPAN(1)' NE '&ZTLC').ZG29                00165200
&XMAXCAPAN        SETC  'NO'        SET KEYWORD                         00165300
                  AIF   (N'&MAXCAPAN LE 1).ZG28A  CK NUM                00165400
&ZMS              SETC  '"MAXCAPAN='                                    00165500
&ZMS              SETC  '&ZMS.&MAXCAPAN"'                               00165600
&ZMS              SETC  '&ZMS "MAXCAPAN"'                               00165700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00165800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00165900
.ZG28A            ANOP  ,                                               00166000
.*-------------------------------------------------------------------   00166100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00166200
.ZG29             ANOP  ,                                               00166300
&ZTLC             SETC 'YES'                                            00166400
                  AIF   ('&MAXCAPAN(1)' NE '&ZTLC').ZG30                00166500
&XMAXCAPAN        SETC  'YES'       SET KEYWORD                         00166600
                  AIF   (N'&MAXCAPAN LE 1).ZG29A  CK NUM                00166700
&ZMS              SETC  '"MAXCAPAN='                                    00166800
&ZMS              SETC  '&ZMS.&MAXCAPAN"'                               00166900
&ZMS              SETC  '&ZMS "MAXCAPAN"'                               00167000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00167100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00167200
.ZG29A            ANOP  ,                                               00167300
.*------------------------------------------------------------------    00167400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167500
.ZG30             ANOP  ,                                               00167600
&ZXMAXCAPAN       SETC  'INPUT'     SET IN/OUTPUT                       00167700
                  AIF   (K'&XMAXCAPAN GT 0).ZG30E  VALID ARG            00167800
                  AIF   (T'&MAXCAPAN EQ 'O').ZG30D  OMITTED             00167900
&ZASYSLNDX        SETA  0                                               00168000
.ZG30A            ANOP  ,           POSITIONAL MACRO KEY                00168100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00168200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG30C                00168300
&ZTLC             SETC 'MAXCAPAN'                                       00168400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG30A       00168500
.ZG30B            ANOP  ,                                               00168600
&ZXMAXCAPAN       SETC  ''          RESET IN/OUTPUT                     00168700
&ZMS              SETC  'THE "MAXCAPAN" KEY'                            00168800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00168900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00169000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00169100
                  AGO   .ZG30E                                          00169200
.ZG30C            ANOP  ,                                               00169300
&ZXMAXCAPAN       SETC  ''          RESET IN/OUTPUT                     00169400
&ZMS              SETC  '"MAXCAPAN='                                    00169500
&ZMS              SETC  '&ZMS.&MAXCAPAN"'                               00169600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00169700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00169800
&ZMS              SETC  '&ZMS "NO"'                                     00169900
&ZMS              SETC  '&ZMS OR "YES".'                                00170000
                  MNOTE 8,' &ZMS '                                      00170100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00170200
                  AGO   .ZG30E                                          00170300
.ZG30D            ANOP  ,                                               00170400
&XMAXCAPAN        SETC  'NO'        SET DEFAULT KEYWORD                 00170500
.ZG30E            ANOP  ,                                               00170600
.*------------------------------------------------------------------    00170700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170800
.ZG31             ANOP  ,                                               00170900
&ZXMAXCAPCLASS    SETC  'INPUT'     SET IN/OUTPUT                       00171000
                  AIF   (K'&XMAXCAPCLASS GT 0).ZG31E  VALID ARG         00171100
                  AIF   (T'&MAXCAPCLASS EQ 'O').ZG31D  OMITTED          00171200
&ZASYSLNDX        SETA  0                                               00171300
.ZG31A            ANOP  ,           POSITIONAL MACRO KEY                00171400
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00171500
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG31C                00171600
&ZTLC             SETC 'MAXCAPCLASS'                                    00171700
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG31A       00171800
.ZG31B            ANOP  ,                                               00171900
&ZXMAXCAPCLASS    SETC  ''          RESET IN/OUTPUT                     00172000
&ZMS              SETC  'THE "MAXCAPCLASS" KEY'                         00172100
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00172200
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00172300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00172400
                  AGO   .ZG31E                                          00172500
.ZG31C            ANOP  ,                                               00172600
&ZXMAXCAPCLASS    SETC  ''          RESET IN/OUTPUT                     00172700
&ZMS              SETC  '"MAXCAPCLASS='                                 00172800
&ZMS              SETC  '&ZMS.&MAXCAPCLASS"'                            00172900
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00173000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00173100
&ZMS              SETC  '&ZMS "NO"'                                     00173200
&ZMS              SETC  '&ZMS OR "YES".'                                00173300
                  MNOTE 8,' &ZMS '                                      00173400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00173500
                  AGO   .ZG31E                                          00173600
.ZG31D            ANOP  ,                                               00173700
&XMAXCAPCLASS     SETC  'NO'        SET DEFAULT KEYWORD                 00173800
.ZG31E            ANOP  ,                                               00173900
.*------------------------------------------------------------------    00174000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174100
&XCBFCLASS        SETC  ''          INITIALIZE XVARIABLE                00174200
.*-------------------------------------------------------------------   00174300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174400
.ZG34             ANOP  ,                                               00174500
                  AIF   (K'&CBFCLASS(1) LE 0).ZG34A                     00174600
&ZTLC             SETC 'NO'                                             00174700
                  AIF   ('&CBFCLASS(1)' NE '&ZTLC').ZG35                00174800
&XCBFCLASS        SETC  'NO'        SET KEYWORD                         00174900
                  AIF   (N'&CBFCLASS LE 1).ZG34A  CK NUM                00175000
&ZMS              SETC  '"CBFCLASS='                                    00175100
&ZMS              SETC  '&ZMS.&CBFCLASS"'                               00175200
&ZMS              SETC  '&ZMS "CBFCLASS"'                               00175300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00175400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00175500
.ZG34A            ANOP  ,                                               00175600
.*-------------------------------------------------------------------   00175700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00175800
.ZG35             ANOP  ,                                               00175900
&ZTLC             SETC 'YES'                                            00176000
                  AIF   ('&CBFCLASS(1)' NE '&ZTLC').ZG36                00176100
&XCBFCLASS        SETC  'YES'       SET KEYWORD                         00176200
                  AIF   (N'&CBFCLASS LE 1).ZG35A  CK NUM                00176300
&ZMS              SETC  '"CBFCLASS='                                    00176400
&ZMS              SETC  '&ZMS.&CBFCLASS"'                               00176500
&ZMS              SETC  '&ZMS "CBFCLASS"'                               00176600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00176700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00176800
.ZG35A            ANOP  ,                                               00176900
.*------------------------------------------------------------------    00177000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177100
.ZG36             ANOP  ,                                               00177200
&ZXCBFCLASS       SETC  'INPUT'     SET IN/OUTPUT                       00177300
                  AIF   (K'&XCBFCLASS GT 0).ZG36E  VALID ARG            00177400
                  AIF   (T'&CBFCLASS EQ 'O').ZG36D  OMITTED             00177500
&ZASYSLNDX        SETA  0                                               00177600
.ZG36A            ANOP  ,           POSITIONAL MACRO KEY                00177700
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00177800
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG36C                00177900
&ZTLC             SETC 'CBFCLASS'                                       00178000
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG36A       00178100
.ZG36B            ANOP  ,                                               00178200
&ZXCBFCLASS       SETC  ''          RESET IN/OUTPUT                     00178300
&ZMS              SETC  'THE "CBFCLASS" KEY'                            00178400
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00178500
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00178600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00178700
                  AGO   .ZG36E                                          00178800
.ZG36C            ANOP  ,                                               00178900
&ZXCBFCLASS       SETC  ''          RESET IN/OUTPUT                     00179000
&ZMS              SETC  '"CBFCLASS='                                    00179100
&ZMS              SETC  '&ZMS.&CBFCLASS"'                               00179200
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00179300
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00179400
&ZMS              SETC  '&ZMS "NO"'                                     00179500
&ZMS              SETC  '&ZMS OR "YES".'                                00179600
                  MNOTE 8,' &ZMS '                                      00179700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00179800
                  AGO   .ZG36E                                          00179900
.ZG36D            ANOP  ,                                               00180000
&XCBFCLASS        SETC  'NO'        SET DEFAULT KEYWORD                 00180100
.ZG36E            ANOP  ,                                               00180200
.*------------------------------------------------------------------    00180300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180400
&XCBFAN           SETC  ''          INITIALIZE XVARIABLE                00180500
.*-------------------------------------------------------------------   00180600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180700
.ZG39             ANOP  ,                                               00180800
                  AIF   (K'&CBFAN(1) LE 0).ZG39A                        00180900
&ZTLC             SETC 'NO'                                             00181000
                  AIF   ('&CBFAN(1)' NE '&ZTLC').ZG40                   00181100
&XCBFAN           SETC  'NO'        SET KEYWORD                         00181200
                  AIF   (N'&CBFAN LE 1).ZG39A   CK NUM                  00181300
&ZMS              SETC  '"CBFAN='                                       00181400
&ZMS              SETC  '&ZMS.&CBFAN"'                                  00181500
&ZMS              SETC  '&ZMS "CBFAN"'                                  00181600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00181700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00181800
.ZG39A            ANOP  ,                                               00181900
.*-------------------------------------------------------------------   00182000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00182100
.ZG40             ANOP  ,                                               00182200
&ZTLC             SETC 'YES'                                            00182300
                  AIF   ('&CBFAN(1)' NE '&ZTLC').ZG41                   00182400
&XCBFAN           SETC  'YES'       SET KEYWORD                         00182500
                  AIF   (N'&CBFAN LE 1).ZG40A   CK NUM                  00182600
&ZMS              SETC  '"CBFAN='                                       00182700
&ZMS              SETC  '&ZMS.&CBFAN"'                                  00182800
&ZMS              SETC  '&ZMS "CBFAN"'                                  00182900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00183000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00183100
.ZG40A            ANOP  ,                                               00183200
.*------------------------------------------------------------------    00183300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183400
.ZG41             ANOP  ,                                               00183500
&ZXCBFAN          SETC  'INPUT'     SET IN/OUTPUT                       00183600
                  AIF   (K'&XCBFAN GT 0).ZG41E  VALID ARG               00183700
                  AIF   (T'&CBFAN EQ 'O').ZG41D  OMITTED                00183800
&ZASYSLNDX        SETA  0                                               00183900
.ZG41A            ANOP  ,           POSITIONAL MACRO KEY                00184000
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00184100
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG41C                00184200
&ZTLC             SETC 'CBFAN'                                          00184300
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG41A       00184400
.ZG41B            ANOP  ,                                               00184500
&ZXCBFAN          SETC  ''          RESET IN/OUTPUT                     00184600
&ZMS              SETC  'THE "CBFAN" KEY'                               00184700
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00184800
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00184900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00185000
                  AGO   .ZG41E                                          00185100
.ZG41C            ANOP  ,                                               00185200
&ZXCBFAN          SETC  ''          RESET IN/OUTPUT                     00185300
&ZMS              SETC  '"CBFAN='                                       00185400
&ZMS              SETC  '&ZMS.&CBFAN"'                                  00185500
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00185600
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00185700
&ZMS              SETC  '&ZMS "NO"'                                     00185800
&ZMS              SETC  '&ZMS OR "YES".'                                00185900
                  MNOTE 8,' &ZMS '                                      00186000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00186100
                  AGO   .ZG41E                                          00186200
.ZG41D            ANOP  ,                                               00186300
&XCBFAN           SETC  'NO'        SET DEFAULT KEYWORD                 00186400
.ZG41E            ANOP  ,                                               00186500
.*------------------------------------------------------------------    00186600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00186700
&XSAVEHISTDATA    SETC  ''          INITIALIZE XVARIABLE                00186800
.*-------------------------------------------------------------------   00186900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00187000
.ZG44             ANOP  ,                                               00187100
                  AIF   (K'&SAVEHISTDATA(1) LE 0).ZG44A                 00187200
&ZTLC             SETC 'NO'                                             00187300
                  AIF   ('&SAVEHISTDATA(1)' NE '&ZTLC').ZG45            00187400
&XSAVEHISTDATA    SETC  'NO'        SET KEYWORD                         00187500
                  AIF   (N'&SAVEHISTDATA LE 1).ZG44A  CK NUM            00187600
&ZMS              SETC  '"SAVEHISTDATA='                                00187700
&ZMS              SETC  '&ZMS.&SAVEHISTDATA"'                           00187800
&ZMS              SETC  '&ZMS "SAVEHISTDATA"'                           00187900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00188000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00188100
.ZG44A            ANOP  ,                                               00188200
.*-------------------------------------------------------------------   00188300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00188400
.ZG45             ANOP  ,                                               00188500
&ZTLC             SETC 'YES'                                            00188600
                  AIF   ('&SAVEHISTDATA(1)' NE '&ZTLC').ZG46            00188700
&XSAVEHISTDATA    SETC  'YES'       SET KEYWORD                         00188800
                  AIF   (N'&SAVEHISTDATA LE 1).ZG45A  CK NUM            00188900
&ZMS              SETC  '"SAVEHISTDATA='                                00189000
&ZMS              SETC  '&ZMS.&SAVEHISTDATA"'                           00189100
&ZMS              SETC  '&ZMS "SAVEHISTDATA"'                           00189200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00189300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00189400
.ZG45A            ANOP  ,                                               00189500
.*------------------------------------------------------------------    00189600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00189700
.ZG46             ANOP  ,                                               00189800
&ZXSAVEHISTDATA   SETC  'INPUT'     SET IN/OUTPUT                       00189900
                  AIF   (K'&XSAVEHISTDATA GT 0).ZG46E  VALID ARG        00190000
                  AIF   (T'&SAVEHISTDATA EQ 'O').ZG46D  OMITTED         00190100
&ZASYSLNDX        SETA  0                                               00190200
.ZG46A            ANOP  ,           POSITIONAL MACRO KEY                00190300
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00190400
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG46C                00190500
&ZTLC             SETC 'SAVEHISTDATA'                                   00190600
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG46A       00190700
.ZG46B            ANOP  ,                                               00190800
&ZXSAVEHISTDATA   SETC  ''          RESET IN/OUTPUT                     00190900
&ZMS              SETC  'THE "SAVEHISTDATA" KEY'                        00191000
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00191100
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00191200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00191300
                  AGO   .ZG46E                                          00191400
.ZG46C            ANOP  ,                                               00191500
&ZXSAVEHISTDATA   SETC  ''          RESET IN/OUTPUT                     00191600
&ZMS              SETC  '"SAVEHISTDATA='                                00191700
&ZMS              SETC  '&ZMS.&SAVEHISTDATA"'                           00191800
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00191900
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00192000
&ZMS              SETC  '&ZMS "NO"'                                     00192100
&ZMS              SETC  '&ZMS OR "YES".'                                00192200
                  MNOTE 8,' &ZMS '                                      00192300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00192400
                  AGO   .ZG46E                                          00192500
.ZG46D            ANOP  ,                                               00192600
&XSAVEHISTDATA    SETC  'NO'        SET DEFAULT KEYWORD                 00192700
.ZG46E            ANOP  ,                                               00192800
.*------------------------------------------------------------------    00192900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00193000
&XCOREBUSYTIME    SETC  ''          INITIALIZE XVARIABLE                00193100
.*-------------------------------------------------------------------   00193200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00193300
.ZG49             ANOP  ,                                               00193400
                  AIF   (K'&COREBUSYTIME(1) LE 0).ZG49A                 00193500
&ZTLC             SETC 'NO'                                             00193600
                  AIF   ('&COREBUSYTIME(1)' NE '&ZTLC').ZG50            00193700
&XCOREBUSYTIME    SETC  'NO'        SET KEYWORD                         00193800
                  AIF   (N'&COREBUSYTIME LE 1).ZG49A  CK NUM            00193900
&ZMS              SETC  '"COREBUSYTIME='                                00194000
&ZMS              SETC  '&ZMS.&COREBUSYTIME"'                           00194100
&ZMS              SETC  '&ZMS "COREBUSYTIME"'                           00194200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00194300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00194400
.ZG49A            ANOP  ,                                               00194500
.*-------------------------------------------------------------------   00194600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00194700
.ZG50             ANOP  ,                                               00194800
&ZTLC             SETC 'YES'                                            00194900
                  AIF   ('&COREBUSYTIME(1)' NE '&ZTLC').ZG51            00195000
&XCOREBUSYTIME    SETC  'YES'       SET KEYWORD                         00195100
                  AIF   (N'&COREBUSYTIME LE 1).ZG50A  CK NUM            00195200
&ZMS              SETC  '"COREBUSYTIME='                                00195300
&ZMS              SETC  '&ZMS.&COREBUSYTIME"'                           00195400
&ZMS              SETC  '&ZMS "COREBUSYTIME"'                           00195500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00195600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00195700
.ZG50A            ANOP  ,                                               00195800
.*------------------------------------------------------------------    00195900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00196000
.ZG51             ANOP  ,                                               00196100
&ZXCOREBUSYTIME   SETC  'INPUT'     SET IN/OUTPUT                       00196200
                  AIF   (K'&XCOREBUSYTIME GT 0).ZG51E  VALID ARG        00196300
                  AIF   (T'&COREBUSYTIME EQ 'O').ZG51D  OMITTED         00196400
&ZASYSLNDX        SETA  0                                               00196500
.ZG51A            ANOP  ,           POSITIONAL MACRO KEY                00196600
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00196700
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG51C                00196800
&ZTLC             SETC 'COREBUSYTIME'                                   00196900
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG51A       00197000
.ZG51B            ANOP  ,                                               00197100
&ZXCOREBUSYTIME   SETC  ''          RESET IN/OUTPUT                     00197200
&ZMS              SETC  'THE "COREBUSYTIME" KEY'                        00197300
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00197400
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00197500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00197600
                  AGO   .ZG51E                                          00197700
.ZG51C            ANOP  ,                                               00197800
&ZXCOREBUSYTIME   SETC  ''          RESET IN/OUTPUT                     00197900
&ZMS              SETC  '"COREBUSYTIME='                                00198000
&ZMS              SETC  '&ZMS.&COREBUSYTIME"'                           00198100
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00198200
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00198300
&ZMS              SETC  '&ZMS "NO"'                                     00198400
&ZMS              SETC  '&ZMS OR "YES".'                                00198500
                  MNOTE 8,' &ZMS '                                      00198600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00198700
                  AGO   .ZG51E                                          00198800
.ZG51D            ANOP  ,                                               00198900
&XCOREBUSYTIME    SETC  'NO'        SET DEFAULT KEYWORD                 00199000
.ZG51E            ANOP  ,                                               00199100
.*------------------------------------------------------------------    00199200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00199300
&XAVGTDCLASS      SETC  ''          INITIALIZE XVARIABLE                00199400
.*-------------------------------------------------------------------   00199500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00199600
.ZG54             ANOP  ,                                               00199700
                  AIF   (K'&AVGTDCLASS(1) LE 0).ZG54A                   00199800
&ZTLC             SETC 'NO'                                             00199900
                  AIF   ('&AVGTDCLASS(1)' NE '&ZTLC').ZG55              00200000
&XAVGTDCLASS      SETC  'NO'        SET KEYWORD                         00200100
                  AIF   (N'&AVGTDCLASS LE 1).ZG54A  CK NUM              00200200
&ZMS              SETC  '"AVGTDCLASS='                                  00200300
&ZMS              SETC  '&ZMS.&AVGTDCLASS"'                             00200400
&ZMS              SETC  '&ZMS "AVGTDCLASS"'                             00200500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00200600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00200700
.ZG54A            ANOP  ,                                               00200800
.*-------------------------------------------------------------------   00200900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00201000
.ZG55             ANOP  ,                                               00201100
&ZTLC             SETC 'YES'                                            00201200
                  AIF   ('&AVGTDCLASS(1)' NE '&ZTLC').ZG56              00201300
&XAVGTDCLASS      SETC  'YES'       SET KEYWORD                         00201400
                  AIF   (N'&AVGTDCLASS LE 1).ZG55A  CK NUM              00201500
&ZMS              SETC  '"AVGTDCLASS='                                  00201600
&ZMS              SETC  '&ZMS.&AVGTDCLASS"'                             00201700
&ZMS              SETC  '&ZMS "AVGTDCLASS"'                             00201800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00201900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00202000
.ZG55A            ANOP  ,                                               00202100
.*------------------------------------------------------------------    00202200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00202300
.ZG56             ANOP  ,                                               00202400
&ZXAVGTDCLASS     SETC  'INPUT'     SET IN/OUTPUT                       00202500
                  AIF   (K'&XAVGTDCLASS GT 0).ZG56E  VALID ARG          00202600
                  AIF   (T'&AVGTDCLASS EQ 'O').ZG56D  OMITTED           00202700
&ZASYSLNDX        SETA  0                                               00202800
.ZG56A            ANOP  ,           POSITIONAL MACRO KEY                00202900
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00203000
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG56C                00203100
&ZTLC             SETC 'AVGTDCLASS'                                     00203200
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG56A       00203300
.ZG56B            ANOP  ,                                               00203400
&ZXAVGTDCLASS     SETC  ''          RESET IN/OUTPUT                     00203500
&ZMS              SETC  'THE "AVGTDCLASS" KEY'                          00203600
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00203700
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00203800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00203900
                  AGO   .ZG56E                                          00204000
.ZG56C            ANOP  ,                                               00204100
&ZXAVGTDCLASS     SETC  ''          RESET IN/OUTPUT                     00204200
&ZMS              SETC  '"AVGTDCLASS='                                  00204300
&ZMS              SETC  '&ZMS.&AVGTDCLASS"'                             00204400
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00204500
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00204600
&ZMS              SETC  '&ZMS "NO"'                                     00204700
&ZMS              SETC  '&ZMS OR "YES".'                                00204800
                  MNOTE 8,' &ZMS '                                      00204900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00205000
                  AGO   .ZG56E                                          00205100
.ZG56D            ANOP  ,                                               00205200
&XAVGTDCLASS      SETC  'NO'        SET DEFAULT KEYWORD                 00205300
.ZG56E            ANOP  ,                                               00205400
.*----------------------------------------------------------------***   00205500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00205600
                  AIF   (N'&RETCODE LE 1).ZG58A  CK NUM                 00205700
&ZMS              SETC  '"RETCODE='                                     00205800
&ZMS              SETC  '&ZMS.&RETCODE"'                                00205900
&ZMS              SETC  '&ZMS "RETCODE"'                                00206000
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00206100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00206200
.ZG58A            ANOP  ,                                               00206300
.*-------------------------------------------------------------------   00206400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00206500
                  AIF   (K'&RETCODE(1) LE 0).ZG58C  NO PARM             00206600
&ZXRETCODE        SETC  'OUTPUT'    SET OUTPUT                          00206700
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00206800
                  AIF   (N'&RETCODE GT 1).ZG58C                         00206900
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00207000
.ZG58C            ANOP  ,                                               00207100
.*-------------------------------------------------------------------   00207200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00207300
                  AIF   (K'&ZXRETCODE LE 0).ZG58R  NOT I/O              00207400
                  AIF   ('&XRETCODE'(1,1) NE '(').ZG58R                 00207500
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00207600
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG58P                    00207700
                  AIF   (K'&ZCGPR GT 2).ZG58Q                           00207800
                  AIF   ('&ZCGPR' EQ '0').ZG58Q                         00207900
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00208000
                  AIF   (T'&ZCGPR NE 'N').ZG58Q  INVALID REG NAME       00208100
.ZG58P            ANOP  ,                                               00208200
                  AIF   (T'&ZCGPR NE 'N').ZG58R  NON NUMERIC            00208300
                  AIF   ('&ZCGPR' EQ '15').ZG58R                        00208400
                  AIF   ('&ZCGPR' LT '2').ZG58Q                         00208500
                  AIF   ('&ZCGPR' LE '12').ZG58R                        00208600
.ZG58Q            ANOP  ,                                               00208700
&ZMS              SETC  '"RETCODE='                                     00208800
&ZMS              SETC  '&ZMS.&RETCODE"'                                00208900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00209000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'        00209100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00209200
.ZG58R            ANOP  ,                                               00209300
.*----------------------------------------------------------------***   00209400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00209500
                  AIF   (N'&RSNCODE LE 1).ZG61A  CK NUM                 00209600
&ZMS              SETC  '"RSNCODE='                                     00209700
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00209800
&ZMS              SETC  '&ZMS "RSNCODE"'                                00209900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00210000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00210100
.ZG61A            ANOP  ,                                               00210200
.*-------------------------------------------------------------------   00210300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00210400
                  AIF   (K'&RSNCODE(1) LE 0).ZG61C  NO PARM             00210500
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00210600
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00210700
                  AIF   (N'&RSNCODE GT 1).ZG61C                         00210800
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00210900
.ZG61C            ANOP  ,                                               00211000
.*-------------------------------------------------------------------   00211100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00211200
                  AIF   (K'&ZXRSNCODE LE 0).ZG61R  NOT I/O              00211300
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG61R                 00211400
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00211500
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                    00211600
                  AIF   (K'&ZCGPR GT 2).ZG61Q                           00211700
                  AIF   ('&ZCGPR' EQ '0').ZG61R                         00211800
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00211900
                  AIF   (T'&ZCGPR NE 'N').ZG61Q  INVALID REG NAME       00212000
.ZG61P            ANOP  ,                                               00212100
                  AIF   (T'&ZCGPR NE 'N').ZG61R  NON NUMERIC            00212200
                  AIF   ('&ZCGPR' EQ '0').ZG61R                         00212300
                  AIF   ('&ZCGPR' LT '2').ZG61Q                         00212400
                  AIF   ('&ZCGPR' LE '12').ZG61R                        00212500
.ZG61Q            ANOP  ,                                               00212600
&ZMS              SETC  '"RSNCODE='                                     00212700
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00212800
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00212900
                  MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'         00213000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00213100
.ZG61R            ANOP  ,                                               00213200
.******************************************************************     00213300
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00213400
.******************************************************************     00213500
                  ACTR  10000                                           00213600
.*----------------------------------------------------------------***   00213700
.***AH.P02 EXTRA POSITIONALS                                            00213800
                  AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS            00213900
                  AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL            00214000
                  AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL        00214100
                  AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL         00214200
.ZGLISTX1         ANOP  ,                                               00214300
&ZCVAL            SETC  ''          ERROR FIELD                         00214400
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00214500
.ZGLIST2          ANOP  ,                                               00214600
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00214700
                  AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE            00214800
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00214900
                  AGO   .ZGLIST2                                        00215000
.*                                                                      00215100
.ZGLIST3          ANOP  ,                                               00215200
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00215300
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'                       00215400
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00215500
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00215600
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00215700
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00215800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00215900
.ZGLISTX          ANOP  ,                                               00216000
&ZASYSLNDX        SETA  0                                               00216100
.*-------------------------------------------------------------------   00216200
.***AG.MF04 MF=(SLE)                                                    00216300
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00216400
.*******************************************************************    00216500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00216600
.*******************************************************************    00216700
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00216800
.*******************************************************************    00216900
.***AE.01  START OF HISMT MACRO CODE                                    00217000
.*******************************************************************    00217100
                  LCLC  &M0M0001                 NAME                   00217200
&M0M0001          SETC  '&XLABEL'                SET NAME               00217300
                  AIF   (K'&XLABEL NE 0).XLAB2                          00217400
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00217500
.*                                                                      00217600
.XLAB2            ANOP  ,                                               00217700
                  AIF   ('&XMF' EQ 'L').XLAB3                           00217800
&M0M0001 DS    0H                             HISMT-0                   00217900
.XLAB3            ANOP  ,                                               00218000
.*******************************************************************    00218100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00218200
.*******************************************************************    00218300
              PUSH  PRINT                                               00218400
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00218500
                  PRINT OFF         ++ PR01                             00218600
                  AGO   .ZPRNTXX                                        00218700
.ZPRINTX          PRINT ON                                              00218800
.ZPRNTXX          ANOP  ,                                               00218900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00219000
         AIF   ('&CBFCLASS' EQ '').REQUESTOK                            00219100
&ZMS     SETC  'CBFCLASS MAY NOT BE SPECIFIED'                          00219200
         MNOTE 8,'&ZMS'                                                 00219300
         POP   PRINT                                                    00219400
         MEXIT                                                          00219500
.REQUESTOK ANOP                                                         00219600
         AIF   ('&CBFAN' EQ '').REQUEST2OK                              00219700
&ZMS     SETC  'CBFAN MAY NOT BE SPECIFIED'                             00219800
         MNOTE 8,'&ZMS'                                                 00219900
         POP   PRINT                                                    00220000
         MEXIT                                                          00220100
.REQUEST2OK ANOP                                                        00220200
         AIF   ('&SAVEHISTDATA' EQ '').REQUEST3OK                       00220300
&ZMS     SETC  'SAVEHISTDATA MAY NOT BE SPECIFIED'                      00220400
         MNOTE 8,'&ZMS'                                                 00220500
         POP   PRINT                                                    00220600
         MEXIT                                                          00220700
.REQUEST3OK ANOP                                                        00220800
.* Begin @01A                                                           00220900
         AIF   ('&MAXCAPAN' EQ '').REQUEST4OK                           00221000
&ZMS     SETC  'MAXCAPAN MAY NOT BE SPECIFIED'                          00221100
         MNOTE 8,'&ZMS'                                                 00221200
         POP   PRINT                                                    00221300
         MEXIT                                                          00221400
.REQUEST4OK ANOP                                                        00221500
.* End @01A                                                             00221600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00221700
.********************************************************************   00221800
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00221900
.********************************************************************   00222000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00222100
                      LCLA  &ZOPN1         INVOCATION INDEX             00222200
                      LCLC  &ZOPL(4095)    LABEL                        00222300
                      LCLC  &ZOPO(4095)    OPERATION                    00222400
                      LCLC  &ZOPV(4095)    VALUE                        00222500
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00222600
.*                                                                      00222700
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00222800
.******************************************************************     00222900
.***AL.L10 HISMT FMT=LIST MF=S!L PARAMETERS                             00223000
.******************************************************************     00223100
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00223200
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00223300
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00223400
&XMFATTR              SETC  '0D'                                        00223500
.*                                                                      00223600
&ZOPN                 SETA  &ZOPN+1                                     00223700
&ZOPL(&ZOPN)          SETC  ' '                                         00223800
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00223900
&ZOPV(&ZOPN)          SETC  '4,8'                                       00224000
&ZOPN                 SETA  &ZOPN+1                                     00224100
&ZOPL(&ZOPN)          SETC  ' '                                         00224200
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00224300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00224400
&ZOPD(&ZOPN)          SETC  '++ HISMT ARG PARMS'                        00224500
.*                                                                      00224600
&ZOPN                 SETA  &ZOPN+1                                     00224700
&ZOPL(&ZOPN)          SETC  ' '                                         00224800
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00224900
&ZOPV(&ZOPN)          SETC  '1'                                         00225000
&ZOPD(&ZOPN)          SETC  ' '                                         00225100
.*                                                                      00225200
.ZLMFSL2              ANOP  ,                                           00225300
.*-------------------------------------------------------------------   00225400
.***AM.L00  HISMT FMT=LIST name                                         00225500
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00225600
&ZOPN                 SETA &ZOPN+1                                      00225700
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00225800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00225900
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00226000
&ZOPD(&ZOPN)          SETC '++ HISMT NAME'                              00226100
.ZLMFSL2M             ANOP  ,                                           00226200
.*-------------------------------------------------------------------   00226300
.***AM.L01  HISMT FMT=LIST PARAMETERS                                   00226400
&ZOPN                 SETA &ZOPN+1                                      00226500
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00226600
&ZOPO(&ZOPN)          SETC 'DS'                                         00226700
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00226800
&ZOPD(&ZOPN)          SETC '++ HISMT PARM LIST'                         00226900
.*-------------------------------------------------------------------   00227000
.***AM.L09  XEYE CL8                                                    00227100
&ZOPN                 SETA &ZOPN+1                                      00227200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEYE'                             00227300
&ZOPO(&ZOPN)          SETC 'DS'                                         00227400
&ZOPV(&ZOPN)          SETC 'CL8'                                        00227500
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00227600
.*-------------------------------------------------------------------   00227700
.***AM.L02 XVERSION XL1                                                 00227800
&ZOPN                 SETA &ZOPN+1                                      00227900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00228000
&ZOPO(&ZOPN)          SETC 'DS'                                         00228100
&ZOPV(&ZOPN)          SETC 'XL1'                                        00228200
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00228300
.*-------------------------------------------------------------------   00228400
.***AM.L09  XPLISTLEN XL2                                               00228500
&ZOPN                 SETA &ZOPN+1                                      00228600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00228700
&ZOPO(&ZOPN)          SETC 'DS'                                         00228800
&ZOPV(&ZOPN)          SETC 'XL2'                                        00228900
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00229000
.*-------------------------------------------------------------------   00229100
.***AM.L09  XRSV0012 CL5                                                00229200
&ZOPN                 SETA &ZOPN+1                                      00229300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0012'                         00229400
&ZOPO(&ZOPN)          SETC 'DS'                                         00229500
&ZOPV(&ZOPN)          SETC 'CL5'                                        00229600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00229700
.*-------------------------------------------------------------------   00229800
.***AM.L09  XINTVAREALEN F                                              00229900
&ZOPN                 SETA &ZOPN+1                                      00230000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINTVAREALEN'                     00230100
&ZOPO(&ZOPN)          SETC 'DS'                                         00230200
&ZOPV(&ZOPN)          SETC 'F'                                          00230300
&ZOPD(&ZOPN)          SETC '++ &ZXINTVAREALEN '                         00230400
.*-------------------------------------------------------------------   00230500
.***AM.L09 ADDR XINTVAREA A                                             00230600
&ZOPN                 SETA &ZOPN+1                                      00230700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINTVAREA_ADDR'                   00230800
&ZOPO(&ZOPN)          SETC 'DS'                                         00230900
&ZOPV(&ZOPN)          SETC 'A'                                          00231000
&ZOPD(&ZOPN)          SETC '++ &ZXINTVAREA ADDR'                        00231100
.*-------------------------------------------------------------------   00231200
.***AM.L03 XREQUESTS BL.16                                              00231300
&ZOPN                 SETA &ZOPN+1                                      00231400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUESTS'                        00231500
&ZOPO(&ZOPN)          SETC 'DS'                                         00231600
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00231700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00231800
.*                                                                      00231900
&ZOPN                 SETA  &ZOPN+1                                     00232000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XPRODCLASS_YES'                  00232100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00232200
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00232300
&ZOPD(&ZOPN)          SETC  '++ XPRODCLASS.'                            00232400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00232500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00232600
.*                                                                      00232700
&ZOPN                 SETA  &ZOPN+1                                     00232800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XPRODCORE_YES'                   00232900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00233000
&ZOPV(&ZOPN)          SETC  'B''0100000000000000'''                     00233100
&ZOPD(&ZOPN)          SETC  '++ XPRODCORE.'                             00233200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00233300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00233400
.*                                                                      00233500
&ZOPN                 SETA  &ZOPN+1                                     00233600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCAPCLASS_YES'                   00233700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00233800
&ZOPV(&ZOPN)          SETC  'B''0010000000000000'''                     00233900
&ZOPD(&ZOPN)          SETC  '++ XCAPCLASS.'                             00234000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00234100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00234200
.*                                                                      00234300
&ZOPN                 SETA  &ZOPN+1                                     00234400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMAXCAPCLASS_YES'                00234500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00234600
&ZOPV(&ZOPN)          SETC  'B''0001000000000000'''                     00234700
&ZOPD(&ZOPN)          SETC  '++ XMAXCAPCLASS.'                          00234800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00234900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00235000
.*                                                                      00235100
&ZOPN                 SETA  &ZOPN+1                                     00235200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCBFCLASS_YES'                   00235300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00235400
&ZOPV(&ZOPN)          SETC  'B''0000100000000000'''                     00235500
&ZOPD(&ZOPN)          SETC  '++ XCBFCLASS.'                             00235600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00235700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00235800
.*                                                                      00235900
&ZOPN                 SETA  &ZOPN+1                                     00236000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCBFAN_YES'                      00236100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00236200
&ZOPV(&ZOPN)          SETC  'B''0000010000000000'''                     00236300
&ZOPD(&ZOPN)          SETC  '++ XCBFAN.'                                00236400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00236500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00236600
.*                                                                      00236700
&ZOPN                 SETA  &ZOPN+1                                     00236800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSAVEHISTDATA_YES'               00236900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00237000
&ZOPV(&ZOPN)          SETC  'B''0000001000000000'''                     00237100
&ZOPD(&ZOPN)          SETC  '++ XSAVEHISTDATA.'                         00237200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00237300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00237400
.*                                                                      00237500
&ZOPN                 SETA  &ZOPN+1                                     00237600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCOREBUSYTIME_YES'               00237700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00237800
&ZOPV(&ZOPN)          SETC  'B''0000000100000000'''                     00237900
&ZOPD(&ZOPN)          SETC  '++ XCOREBUSYTIME.'                         00238000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00238100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00238200
.*                                                                      00238300
&ZOPN                 SETA  &ZOPN+1                                     00238400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XAVGTDCLASS_YES'                 00238500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00238600
&ZOPV(&ZOPN)          SETC  'B''0000000010000000'''                     00238700
&ZOPD(&ZOPN)          SETC  '++ XAVGTDCLASS.'                           00238800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00238900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00239000
.*                                                                      00239100
&ZOPN                 SETA  &ZOPN+1                                     00239200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMAXCAPAN_YES'                   00239300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00239400
&ZOPV(&ZOPN)          SETC  'B''0000000001000000'''                     00239500
&ZOPD(&ZOPN)          SETC  '++ XMAXCAPAN.'                             00239600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00239700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00239800
.*-------------------------------------------------------------------   00239900
.***AM.L09  XRSVNNNN CL10                                               00240000
&ZOPN                 SETA &ZOPN+1                                      00240100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVNNNN'                         00240200
&ZOPO(&ZOPN)          SETC 'DS'                                         00240300
&ZOPV(&ZOPN)          SETC 'CL10'                                       00240400
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00240500
.*-------------------------------------------------------------------   00240600
.***AM.L10 END OF HISMT LIST PARAMETERS                                 00240700
&ZOPN                 SETA &ZOPN+1                                      00240800
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00240900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00241000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00241100
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00241200
.*                                                                      00241300
&ZOPN                 SETA &ZOPN+1                                      00241400
&ZOPL(&ZOPN)          SETC ' '                                          00241500
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00241600
&ZOPV(&ZOPN)          SETC '1'                                          00241700
&ZOPD(&ZOPN)          SETC ' '                                          00241800
.*-------------------------------------------------------------------   00241900
.***AL.L12 HISMT FMT=LIST MF=S!L PARAMETERS                             00242000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00242100
.*                                                                      00242200
&ZOPN                 SETA  &ZOPN+1                                     00242300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00242400
&ZOPO(&ZOPN)          SETC  'DC'                                        00242500
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00242600
&ZOPD(&ZOPN)          SETC  '++ HISMT ARG PARMS'                        00242700
.*                                                                      00242800
.ZLMFSLX              ANOP  ,                                           00242900
.*-------------------------------------------------------------------   00243000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00243100
&ZPLLEN               SETA 36                                           00243200
.*                                                                      00243300
.******************************************************************     00243400
.***AI.L01 HISMT FMT=LIST FILL IN PARAMETER AREA                        00243500
.******************************************************************     00243600
                      ACTR  10000                                       00243700
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00243800
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00243900
&ZCVAL                SETC  'LAE'          XAX MODE                     00244000
.ZIMFXA               ANOP ,                                            00244100
.*                                                                      00244200
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00244300
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00244400
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00244500
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00244600
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00244700
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00244800
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00244900
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00245000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00245100
&ZOPN                 SETA  &ZOPN+1                                     00245200
&ZOPL(&ZOPN)          SETC  ' '                                         00245300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00245400
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00245500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00245600
                      AGO   .ZIMFNX                                     00245700
.*                                                                      00245800
.ZIMFN2               ANOP ,                                            00245900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00246000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00246100
&ZOPN                 SETA  &ZOPN+1                                     00246200
&ZOPL(&ZOPN)          SETC  ' '                                         00246300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00246400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00246500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00246600
                      AGO   .ZIMFNX                                     00246700
.ZIMFNX1              ANOP ,                                            00246800
&ZOPN                 SETA  &ZOPN+1                                     00246900
&ZOPL(&ZOPN)          SETC  ' '                                         00247000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00247100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00247200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00247300
.ZIMFNX               ANOP ,                                            00247400
.********************************************************************   00247500
.***AI.L02 HISMT FMT=LIST INITIALIZE PARAMETER AREA                     00247600
.********************************************************************   00247700
.***AI.L03 MF=(SLE)                                                     00247800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00247900
.*                                                                      00248000
&ZOPN                 SETA  &ZOPN+1                                     00248100
&ZOPL(&ZOPN)          SETC  ' '                                         00248200
&ZOPO(&ZOPN)          SETC  'XC'                                        00248300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00248400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00248500
.ZIMFLX               ANOP  ,                                           00248600
.*-------------------------------------------------------------------   00248700
.***AI.L60 XEYE CL8                                                     00248800
&ZOPN                 SETA  &ZOPN+1                                     00248900
&ZOPL(&ZOPN)          SETC  ' '                                         00249000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00249100
&ZOPV(&ZOPN)          SETC  '0(8,1),=CL8''HISMT_PL'''                   00249200
&ZOPD(&ZOPN)          SETC  '++ CL8 CONSTANT'                           00249300
.*-------------------------------------------------------------------   00249400
.***AI.L04 XPLISTLEN XL2                                                00249500
&ZOPN                 SETA  &ZOPN+1                                     00249600
&ZOPL(&ZOPN)          SETC  ' '                                         00249700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00249800
&ZOPV(&ZOPN)          SETC  '9(2,1),=AL2(&ZPLLEN)'                      00249900
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00250000
.*-------------------------------------------------------------------   00250100
.***AI.L25  XINTVAREALEN F                                              00250200
                      AIF   ('&ZXINTVAREALEN' EQ '').ZI5E               00250300
                      AIF   ('&ZXINTVAREALEN' EQ 'OUTPUT').ZI5E         00250400
&ZCGPR                SETC  '&XINTVAREALEN'                             00250500
.*                                                                      00250600
                      AIF   ('&XINTVAREALEN'(1,1) NE '(').ZI5B          00250700
&ZCGPR   SETC  '0('.'&XINTVAREALEN'(2,K'&XINTVAREALEN-2).')'            00250800
                      AGO   .ZI5D                                       00250900
.ZI5B                 ANOP  ,                                           00251000
.*                                                                      00251100
&ZC                   SETC  '&XINTVAREALEN'(1,1)                        00251200
                      AIF   (T'&ZC NE 'N').ZI5D                         00251300
&ZC                   SETC  '&XINTVAREALEN'                             00251400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                00251500
&ZCGPR                SETC  '=FL4''&XINTVAREALEN'''                     00251600
.*                                                                      00251700
.ZI5D                 ANOP  ,                                           00251800
.*                                                                      00251900
&ZOPN                 SETA  &ZOPN+1                                     00252000
&ZOPL(&ZOPN)          SETC  ' '                                         00252100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00252200
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00252300
&ZOPD(&ZOPN)          SETC  '++ &ZXINTVAREALEN XINTVAREALEN'            00252400
.*                                                                      00252500
.ZI5E                 ANOP  ,                                           00252600
.*-------------------------------------------------------------------   00252700
.***AI.L19 ADDR XINTVAREA A                                             00252800
                      AIF   ('&ZXINTVAREA' EQ '').ZI6H                  00252900
&ZCLNG                SETC  '&XINTVAREA'                                00253000
&ZCGPR                SETC  '14'                                        00253100
         AIF   ('&XINTVAREA'(1,1) EQ '(').ZI6F  IN GPR                  00253200
.*                                                                      00253300
&ZOPN                 SETA  &ZOPN+1                                     00253400
&ZOPL(&ZOPN)          SETC  ' '                                         00253500
&ZOPO(&ZOPN)          SETC  'LA'                                        00253600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00253700
&ZOPD(&ZOPN)          SETC  '++ &ZXINTVAREA XINTVAREA'                  00253800
.*                                                                      00253900
                      AGO   .ZI6G                                       00254000
.*                                                                      00254100
.ZI6F                 ANOP  ,                                           00254200
&ZCGPR   SETC  '&XINTVAREA'(2,K'&XINTVAREA-2)                           00254300
.*                                                                      00254400
.ZI6G                 ANOP  ,                                           00254500
.*                                                                      00254600
&ZOPN                 SETA  &ZOPN+1                                     00254700
&ZOPL(&ZOPN)          SETC  ' '                                         00254800
&ZOPO(&ZOPN)          SETC  'ST'                                        00254900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,20(,1)'                             00255000
&ZOPD(&ZOPN)          SETC  '++ &ZXINTVAREA XINTVAREA'                  00255100
.*                                                                      00255200
.ZI6H                 ANOP  ,                                           00255300
.*-------------------------------------------------------------------   00255400
.***AI.L05 XREQUESTS BL2                                                00255500
&ZW                   SETC  ''                                          00255600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00255700
.*-------------------------------------------------------------------   00255800
.***AI.L08 XREQUESTS "YES"                                              00255900
.***      BL2'1XXXXXXXXXXXXXXX'                                         00256000
         AIF   ('&XPRODCLASS' NE 'YES').ZI8A                            00256100
&ZW                   SETC  '&ZW.1'                                     00256200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00256300
                      AGO   .ZI8C                                       00256400
.*                                                                      00256500
.ZI8A                 ANOP  ,                                           00256600
&ZW                   SETC  '&ZW.0'                                     00256700
.ZI8C                 ANOP  ,                                           00256800
.*-------------------------------------------------------------------   00256900
.***AI.L08 XREQUESTS "YES"                                              00257000
.***      BL2'X1XXXXXXXXXXXXXX'                                         00257100
         AIF   ('&XPRODCORE' NE 'YES').ZI9A                             00257200
&ZW                   SETC  '&ZW.1'                                     00257300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00257400
                      AGO   .ZI9C                                       00257500
.*                                                                      00257600
.ZI9A                 ANOP  ,                                           00257700
&ZW                   SETC  '&ZW.0'                                     00257800
.ZI9C                 ANOP  ,                                           00257900
.*-------------------------------------------------------------------   00258000
.***AI.L08 XREQUESTS "YES"                                              00258100
.***      BL2'XX1XXXXXXXXXXXXX'                                         00258200
         AIF   ('&XCAPCLASS' NE 'YES').ZI10A                            00258300
&ZW                   SETC  '&ZW.1'                                     00258400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00258500
                      AGO   .ZI10C                                      00258600
.*                                                                      00258700
.ZI10A                ANOP  ,                                           00258800
&ZW                   SETC  '&ZW.0'                                     00258900
.ZI10C                ANOP  ,                                           00259000
.*-------------------------------------------------------------------   00259100
.***AI.L08 XREQUESTS "YES"                                              00259200
.***      BL2'XXX1XXXXXXXXXXXX'                                         00259300
         AIF   ('&XMAXCAPCLASS' NE 'YES').ZI11A                         00259400
&ZW                   SETC  '&ZW.1'                                     00259500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00259600
                      AGO   .ZI11C                                      00259700
.*                                                                      00259800
.ZI11A                ANOP  ,                                           00259900
&ZW                   SETC  '&ZW.0'                                     00260000
.ZI11C                ANOP  ,                                           00260100
.*-------------------------------------------------------------------   00260200
.***AI.L08 XREQUESTS "YES"                                              00260300
.***      BL2'XXXX1XXXXXXXXXXX'                                         00260400
         AIF   ('&XCBFCLASS' NE 'YES').ZI12A                            00260500
&ZW                   SETC  '&ZW.1'                                     00260600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00260700
                      AGO   .ZI12C                                      00260800
.*                                                                      00260900
.ZI12A                ANOP  ,                                           00261000
&ZW                   SETC  '&ZW.0'                                     00261100
.ZI12C                ANOP  ,                                           00261200
.*-------------------------------------------------------------------   00261300
.***AI.L08 XREQUESTS "YES"                                              00261400
.***      BL2'XXXXX1XXXXXXXXXX'                                         00261500
         AIF   ('&XCBFAN' NE 'YES').ZI13A                               00261600
&ZW                   SETC  '&ZW.1'                                     00261700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00261800
                      AGO   .ZI13C                                      00261900
.*                                                                      00262000
.ZI13A                ANOP  ,                                           00262100
&ZW                   SETC  '&ZW.0'                                     00262200
.ZI13C                ANOP  ,                                           00262300
.*-------------------------------------------------------------------   00262400
.***AI.L08 XREQUESTS "YES"                                              00262500
.***      BL2'XXXXXX1XXXXXXXXX'                                         00262600
         AIF   ('&XSAVEHISTDATA' NE 'YES').ZI14A                        00262700
&ZW                   SETC  '&ZW.1'                                     00262800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00262900
                      AGO   .ZI14C                                      00263000
.*                                                                      00263100
.ZI14A                ANOP  ,                                           00263200
&ZW                   SETC  '&ZW.0'                                     00263300
.ZI14C                ANOP  ,                                           00263400
.*-------------------------------------------------------------------   00263500
.***AI.L08 XREQUESTS "YES"                                              00263600
.***      BL2'XXXXXXX1XXXXXXXX'                                         00263700
         AIF   ('&XCOREBUSYTIME' NE 'YES').ZI15A                        00263800
&ZW                   SETC  '&ZW.1'                                     00263900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00264000
                      AGO   .ZI15C                                      00264100
.*                                                                      00264200
.ZI15A                ANOP  ,                                           00264300
&ZW                   SETC  '&ZW.0'                                     00264400
.ZI15C                ANOP  ,                                           00264500
.*-------------------------------------------------------------------   00264600
.***AI.L08 XREQUESTS "YES"                                              00264700
.***      BL2'XXXXXXXX1XXXXXXX'                                         00264800
         AIF   ('&XAVGTDCLASS' NE 'YES').ZI16A                          00264900
&ZW                   SETC  '&ZW.1'                                     00265000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00265100
                      AGO   .ZI16C                                      00265200
.*                                                                      00265300
.ZI16A                ANOP  ,                                           00265400
&ZW                   SETC  '&ZW.0'                                     00265500
.ZI16C                ANOP  ,                                           00265600
.*-------------------------------------------------------------------   00265700
.***AI.L08 XREQUESTS "YES"                                              00265800
.***      BL2'XXXXXXXXX1XXXXXX'                                         00265900
         AIF   ('&XMAXCAPAN' NE 'YES').ZI17A                            00266000
&ZW                   SETC  '&ZW.1000000'                               00266100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00266200
                      AGO   .ZI17C                                      00266300
.*                                                                      00266400
.ZI17A                ANOP  ,                                           00266500
&ZW                   SETC  '&ZW.0000000'                               00266600
.ZI17C                ANOP  ,                                           00266700
.*-------------------------------------------------------------------   00266800
.***AI.L10 XREQUESTS BL2                                                00266900
                      AIF   ('&ZCLNG' NE 'YES').ZI17E  ALL ZERO BITS    00267000
&ZOPN                 SETA  &ZOPN+1                                     00267100
&ZOPL(&ZOPN)          SETC  ' '                                         00267200
&ZOPO(&ZOPN)          SETC  'OC'                                        00267300
&ZOPV(&ZOPN)          SETC  '24(2,1),=BL2''&ZW'''                       00267400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00267500
.ZI17E                ANOP  ,                                           00267600
.*-------------------------------------------------------------------   00267700
&ZOPN1                SETA &ZOPN                                        00267800
.*******************************************************************    00267900
.***  PROCESS HISMT OUTPUT PARAMETERS                                   00268000
.*******************************************************************    00268100
                      ACTR  10000                                       00268200
.*******************************************************************    00268300
.***AO.X02  RETURN CODE PROCESSING                                      00268400
.*******************************************************************    00268500
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00268600
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00268700
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00268800
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00268900
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00269000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00269100
&ZOPN                 SETA  &ZOPN+1                                     00269200
&ZOPL(&ZOPN)          SETC  ' '                                         00269300
&ZOPO(&ZOPN)          SETC  'ST'                                        00269400
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00269500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00269600
                      AGO   .ZMRETX                                     00269700
.*                                                                      00269800
.ZMRET2               ANOP  ,                                           00269900
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00270000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00270100
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00270200
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00270300
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00270400
&ZOPN                 SETA  &ZOPN+1                                     00270500
&ZOPL(&ZOPN)          SETC  ' '                                         00270600
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00270700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00270800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00270900
.ZMRETX               ANOP  ,                                           00271000
.*******************************************************************    00271100
.***AO.X03  REASON CODE PROCESSING                                      00271200
.*******************************************************************    00271300
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00271400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00271500
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00271600
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00271700
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00271800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00271900
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00272000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00272100
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00272200
&ZOPN                 SETA  &ZOPN+1                                     00272300
&ZOPL(&ZOPN)          SETC  ' '                                         00272400
&ZOPO(&ZOPN)          SETC  'ST'                                        00272500
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00272600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00272700
                      AGO   .ZMRSNX                                     00272800
.*                                                                      00272900
.ZMRSN2               ANOP  ,                                           00273000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00273100
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00273200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00273300
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00273400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00273500
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00273600
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00273700
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00273800
&ZOPN                 SETA  &ZOPN+1                                     00273900
&ZOPL(&ZOPN)          SETC  ' '                                         00274000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00274100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00274200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00274300
.ZMRSNX               ANOP  ,                                           00274400
.*******************************************************************    00274500
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00274600
.*******************************************************************    00274700
.ZMFLX                ANOP  ,              MF=L PROCESSING              00274800
.*******************************************************************    00274900
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00275000
.*******************************************************************    00275100
                      ACTR  10000                                       00275200
.*                                                                      00275300
                      LCLA  &ZLC           COLUMN POSITION              00275400
                      LCLA  &ZOPX          LIST TABLE INDEX             00275500
                      LCLC  &ZLL           LABEL                        00275600
                      LCLC  &ZLOP          OPERATION                    00275700
                      LCLC  &ZLV           VALUE                        00275800
                      LCLC  &ZLD           DESCRIPTION                  00275900
.*                                                                      00276000
&ZOPX                 SETA  1                                           00276100
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00276200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00276300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00276400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00276500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00276600
                      AIF   (K'&ZLD LE 0).ZL5                           00276700
&ZLC                  SETA  35             COMMENT COLUMN               00276800
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00276900
&ZLC                  SETA  33             COMMMENT COLUMN              00277000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00277100
&ZLV                  SETC  '&ZLV'.' '                                  00277200
                      AGO   .ZL3                                        00277300
.*                                                                      00277400
.ZL4                  ANOP  ,                                           00277500
&ZLV                  SETC  '&ZLV'.' '                                  00277600
.ZL5                  ANOP  ,                                           00277700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00277800
.*                                                                      00277900
&ZLL     &ZLOP &ZLV                                                     00278000
.*                                                                      00278100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00278200
                      AGO   .ZL2           CONTINUE LOOPING             00278300
.*                                                                      00278400
.ZLX                  ANOP  ,                                           00278500
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00278600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00278700
         L     15,16(0,0)               GET CVT ADDRESS                 00278800
         L     15,140(15,0)             GET ECVT address                00278900
         L     15,180(15,0)             GET HISNMT address              00279000
         BASR  14,15                    CALL HISNMT service             00279100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00279200
.ZLINKX               ANOP  ,                                           00279300
.*******************************************************************    00279400
.***AP.X01  FORMAT GENERATED CODE                                       00279500
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00279600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00279700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00279800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00279900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00280000
                      AIF   (K'&ZLD LE 0).ZL51                          00280100
&ZLC                  SETA  35             COMMENT COLUMN               00280200
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00280300
&ZLC                  SETA  33             COMMENT COLUMN               00280400
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00280500
&ZLV                  SETC  '&ZLV'.' '                                  00280600
                      AGO   .ZL31                                       00280700
.*                                                                      00280800
.ZL41                 ANOP  ,                                           00280900
&ZLV                  SETC  '&ZLV'.' '                                  00281000
.ZL51                 ANOP  ,                                           00281100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00281200
.*                                                                      00281300
&ZLL     &ZLOP &ZLV                                                     00281400
.*                                                                      00281500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00281600
                      AGO   .ZL21          CONTINUE LOOPING             00281700
.*                                                                      00281800
.ZLX1                 ANOP  ,                                           00281900
.*******************************************************************    00282000
.***AP.X02  END OF HISMT MACRO                                          00282100
&ZHISMT               SETC  'YES'          SET HISMT USED               00282200
         POP   PRINT                                                    00282300
*                                            HISMT-0                    00282400
         SPACE 1                                                        00282500
.ZLX2                 ANOP  ,                                           00282600
         MEND                                                           00282700
**********************************************************************/ 00282800
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00282900
*%HISMT: MACRO KEYS(INTVAREA,INTVAREALEN,PRODCLASS,PRODCORE,CAPCLASS,   00283000
*                 MAXCAPCLASS,MAXCAPAN,CBFCLASS,CBFAN,SAVEHISTDATA,     00283100
*                 COREBUSYTIME,AVGTDCLASS,RETCODE,RSNCODE,PLISTVER,MF); 00283200
*  ANS('?'!!MACLABEL!!' '!!'HISMTP '!!MACLIST!!                         00283300
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00283400
*%END HISMT;                                                            00283500

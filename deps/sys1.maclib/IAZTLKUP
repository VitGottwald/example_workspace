*        %GOTO TLKUPPLX;          /* Bilingual Mapping Macro            00010000
         MACRO -- IAZTLKUP JES Text Table Lookup Macro           @Z22AM 00020000
&LABEL   IAZTLKUP &TABLEID=,       3 char text table ID                C00030000
               &LEVEL=,            Level of text to return             C00040000
               &SSOB=,             Ptr to SSI request                  C00050000
               &DATASTR=,          SSI data section                    C00060000
               &OUTAREA=,          Area for storing results            C00070000
               &OUTLEN=,           Length of output to store           C00080000
               &MOREFLG=,          More flag bit indicators      @Z22AMC00085000
               &MF=,                                                   C00090000
               &DSECT=                                           @Z22AM 00100000
         AGO   .SKIPPREF                                                00110000
*          */                                                           00120000
*  %TLKUPPLX: ;                                                   /* */ 00130000
*/**** START OF SPECIFICATIONS *******************************          00140000
.SKIPPREF ANOP                                                          00150000
.* **PROPRIETARY STATEMENT************************************          00160000
.*                                                           *          00170000
.*   LICENSED MATERIALS-PROPERTY OF IBM                      *          00180000
.*   5650-ZOS Copyright IBM Corp. 2013, 2021                 *          00190000
.*                                                           *          00200000
.*   STATUS = HBB77D0                                        *   @Z22AM 00210000
.*                                                           *          00220000
.*01* EXTERNAL CLASSIFICATION:  PSPI                         *          00230000
.*01* END OF EXTERNAL CLASSIFICATION:                        *          00240000
.*                                                           *          00250000
.* **END-OF-PROPRIETARY-STATEMENT*****************************          00260000
.*                                                           *          00270000
.*01* FUNCTION:                                              *          00280000
.*                                                           *          00290000
.*       The IAZTLKUP macro sets up the parameters necessary *          00300000
.*       to invoke the JES Text Table Lookup function. The   *   @Z22AM 00310000
.*       macro provides the expansion of the parameter list  *          00320000
.*       DSECT TLKUP and the code used to fill in the        *          00330000
.*       parameter list.                                     *          00340000
.*                                                           *          00350000
.*01* PARAMETERS:                                            *          00360000
.*                                                           *          00370000
.*       TABLEID=         3 character table id of the text   *          00380000
.*                        table to be used for mapping.      *          00390000
.*                        Valid values are:                  *          00400000
.*                          PHZ - job phase text table       *          00410000
.*                          DLY - job delay text table       *          00420000
.*                        This is a required parameter.      *   @Z22AM 00422000
.*                                                           *          00430000
.*       LEVEL=           The level of text to return for    *          00440000
.*                        the code or flag residing in the   *          00450000
.*                        SSI output area DATASTR. The first *          00460000
.*                        two levels contain the following   *          00470000
.*                        text types for any table built     *          00480000
.*                        using the IAZTABL macro:           *          00490000
.*                          1 - JES specific description     *          00500000
.*                          2 - Generalized description      *          00510000
.*                                                           *          00520000
.*                        Level 3 and beyond are text table  *          00530000
.*                        specific. Look where those tables  *          00540000
.*                        are generated in the appropriate   *          00550000
.*                        JES code to determine what the     *          00560000
.*                        additional levels supply. For      *          00570000
.*                        example, in JES2 the job phase     *   @Z22AM 00580000
.*                        text table TPHZTABL is built by    *   @Z22AM 00585000
.*                        HASPIRMA at JES2 initialiation     *   @Z22AM 00590000
.*                        (WARM/COLD start). Level 3 text    *   @Z22AM 00600000
.*                        exists and contains the text that  *   @Z22AM 00610000
.*                        SDSF uses to define a job phase    *   @Z22AM 00620000
.*                        code. In JES3 the job phase text   *   @Z22AM 00630000
.*                        table TPHZTABL is built by IATINSV *   @Z22AM 00631000
.*                        at JES3 initialization, and it     *   @Z22AM 00632000
.*                        also contains Level 3 text for     *   @Z22AM 00633000
.*                        SDSF reporting of job phase codes. *   @Z22AM 00634000
.*                        This is a required parameter.      *   @Z22AM 00635000
.*                                                           *          00640000
.*       SSOB=            Subsystem Options Block (SSOB)     *          00650000
.*                        used for the SSI request to a      *   @Z22AM 00660000
.*                        JES subsystem that produced the    *          00670000
.*                        data in the DATASTR area. Used to  *          00680000
.*                        validate the request is supported  *          00690000
.*                        by IAZTLKUP.                       *          00700000
.*                        This is a required parameter.      *   @Z22AM 00705000
.*                                                           *          00710000
.*       DATASTR=         Data structure returned by an SSI  *          00720000
.*                        supported by IAZTLKUP. The output  *          00730000
.*                        section type and modifier will be  *          00740000
.*                        used to determine if the request   *          00750000
.*                        is supported and what code or flag *          00760000
.*                        should be interpreted.             *          00770000
.*                        This is a required parameter.      *   @Z22AM 00775000
.*                                                           *          00780000
.*       OUTAREA=         Output area where the text lookup  *          00790000
.*                        results should be stored. If the   *   @Z22AM 00800000
.*                        size of OUTAREA is smaller than    *   @Z22AM 00801000
.*                        the length of text for the level   *   @Z22AM 00802000
.*                        of text requested, the text will   *   @Z22AM 00803000
.*                        be truncated. If OUTAREA is larger *   @Z22AM 00804000
.*                        than the level of text requested   *   @Z22AM 00805000
.*                        then the remaining bytes of        *   @Z22AM 00806000
.*                        OUTAREA will be set to blanks.     *   @Z22AM 00807000
.*                        This is a required parameter.      *   @Z22AM 00808000
.*                                                           *          00810000
.*       OUTLEN=          Length of the area represented by  *          00820000
.*                        the OUTAREA parameter.             *          00830000
.*                        This is an optional parameter. If  *   @Z22AM 00830100
.*                        it is not specified it will be     *   @Z22AM 00830400
.*                        defaulted to the length of the     *   @Z22AM 00830700
.*                        OUTAREA parameter field.           *   @Z22AM 00830800
.*                                                           *   @Z22AM 00831000
.*       MOREFLG=         Indicates the location to store    *   @Z22AM 00831300
.*                        the 4 bytes containing the         *   @Z22AM 00831400
.*                        remaining bits that indicate       *   @Z22AM 00831600
.*                        further flag bits that could be    *   @Z22AM 00831900
.*                        converted to text.                 *   @Z22AM 00832000
.*                        This is an optional parameter. If  *   @Z22AM 00832200
.*                        MOREFLG is not specified the       *   @Z22AM 00832500
.*                        service will always report text    *   @Z22AM 00832600
.*                        only for the first flag bit found. *   @Z22AM 00832800
.*                        If MOREFLG is specified, it can be *   @Z22AM 00833100
.*                        used to extract text for all flag  *   @Z22AM 00833200
.*                        bits. Set MOREFLG to 0 on the      *   @Z22AM 00833400
.*                        first call to get the first bit's  *   @Z22AM 00833700
.*                        text, if any. A return code of     *   @Z22AM 00833800
.*                        4 indicates text for a flag bit    *   @Z22AM 00834000
.*                        was returned and more flag bits    *   @Z22AM 00834300
.*                        exist. MOREFLG will be updated with*   @Z22AM 00834400
.*                        the remaining bits that represent  *   @Z22AM 00834600
.*                        other flag bits to interpret.      *   @Z22AM 00834900
.*                        A return code of 0 indicates       *   @Z22AM 00835000
.*                        that the text for the last flag    *   @Z22AM 00835200
.*                        bit, if any, has been returned.    *   @Z22AM 00835500
.*                        If there were no flag bits set the *   @Z22AM 00835600
.*                        return code will be 0 and blanks   *   @Z22AM 00835800
.*                        will be returned in the output     *   @Z22AM 00836100
.*                        area.                              *   @Z22AM 00836200
.*                                                           *   @Z22AM 00836400
.*       RETCODE=         PL/X-only keyword indicating where *   @Z22AM 00836700
.*                        to place the return code.          *   @Z22AM 00836800
.*                        This is an optional parameter.     *   @Z22AM 00837000
.*                                                           *          00840000
.*       MF=              Indicator for macro execution:     *          00850000
.*                          L - allocate storage for TLKUP   *          00860000
.*                              and an additional 256 bytes  *          00861000
.*                              for the service work area    *          00864000
.*                          E - generate call to IAZTLUP     *          00870000
.*                                                           *          00880000
.*       DSECT=           Indicate if the TLKUP DSECT        *          00890000
.*                        should be generated. Valid values  *          00900000
.*                        are:                               *          00910000
.*                          YES - generate the DSECT         *          00920000
.*                          No  - do not generate the DSECT  *          00930000
.*                                                           *          00940000
.*                        Default is NO.                     *          00950000
.*                                                           *   @Z22AM 00950100
.*01* SYNTAX:                                                *   @Z22AM 00950400
.*                                                           *   @Z22AM 00950700
.*02*  ASM:                                                  *   @Z22AM 00951000
.*                                                           *   @Z22AM 00951300
.*         IAZTLKUP DSECT=YES                                *   @Z22AM 00951600
.*                                                           *   @Z22AM 00951900
.*XXXXXXXX IAZTLKUP MF=L                                     *   @Z22AM 00952200
.*                                                           *   @Z22AM 00952500
.*         IAZTLKUP TABLEID=,                                *   @Z22AM 00952800
.*               LEVEL=,                                     *   @Z22AM 00953100
.*               SSOB=,                                      *   @Z22AM 00953400
.*               DATASTR=,                                   *   @Z22AM 00953700
.*               OUTAREA=,                                   *   @Z22AM 00954000
.*               OUTLEN=,                                    *   @Z22AM 00954300
.*               MOREFLG=,                                   *   @Z22AM 00954600
.*               MF=(E,xxxxxxxx)                             *   @Z22AM 00954900
.*                                                           *   @Z22AM 00955200
.*        Invocation return code is in register 15.          *   @Z22AM 00955500
.*                                                           *   @Z22AM 00955800
.*02*  PL/X:                                                 *   @Z22AM 00956100
.*                                                           *   @Z22AM 00956400
.*      %INCLUDE SYSLIB(IAZTLKDF);                           *   @Z22AM 00956700
.*      %INCLUDE SYSLIB(CVT);                                *   @Z22AM 00957000
.*      %INCLUDE SYSLIB(JESCT);                              *   @Z22AM 00957300
.*      %INCLUDE SYSLIB(IAZFSIB);                            *   @Z22AM 00957500
.*                                                           *   @Z22AM 00957700
.*      ?IAZTLKUP MF(L,xxxxxxxx);                            *   @Z22AM 00957900
.*                                                           *   @Z22AM 00958100
.*      ?IAZTLKUP TABLEID()                                  *   @Z22AM 00958300
.*                LEVEL())                                   *   @Z22AM 00958500
.*                SSOB()                                     *   @Z22AM 00958700
.*                DATASTR()                                  *   @Z22AM 00958900
.*                OUTAREA()                                  *   @Z22AM 00959100
.*                OUTLEN()                                   *   @Z22AM 00959300
.*                MOREFLG()                                  *   @Z22AM 00959500
.*                RETCODE()                                  *   @Z22AM 00959700
.*                MF(E,xxxxxxxx);                            *   @Z22AM 00959900
.*                                                           *   @Z22AM 00960100
.*                                                           *   @Z22AM 00960300
.*        Note the required includes.                        *   @Z22AM 00960500
.*        Invocation return code is in register 15, and in   *   @Z22AM 00960700
.*          parameter RETCODE, if supplied.                  *   @Z22AM 00960900
.*                                                           *   @Z22AM 00961100
.*                                                           *   @Z22AM 00961300
.*                                                           *   @Z22AM 00961500
.*                                                           *   @Z22AM 00961700
.*01*  REGISTER USAGE (ENTRY/EXIT):                          *          00961900
.*                                                           *          00962100
.*     REG       VALUE ON ENTRY       VALUE ON EXIT          *          00962400
.*               TO MACRO             FROM MACRO             *          00963000
.*                                                           *          00963600
.*     R0        MOREFLG, if defined  destroyed              *   @Z22AM 00964200
.*    AR0        n/a                  destroyed              *   @Z22AM 00964800
.*     R1        n/a                  destroyed              *   @Z22AM 00966600
.*    AR1        n/a                  destroyed              *   @Z22AM 00966900
.*     R2-R12    n/a                  unchanged              *   @Z22AM 00967200
.*     R13       Save area address    unchanged              *   @Z22AM 00967400
.*                (F4SA format, 144 bytes)                   *   @Z22AM 00967600
.*     R14       n/a                  destroyed              *          00967800
.*     R15       n/a                  return code            *          00968400
.*    AR15       n/a                  destroyed              *   @Z22AM 00968700
.*                                                           *          00969000
.*                                                           *          00970000
.*01*  RETURN CODES (R15 ON EXIT):                           *          00980000
.*                                                           *          00985000
.*        0  -  Processing completed successfully            *   @Z22AM 00990000
.*              (No errors). For a flag table, no more       *   @Z22AM 00995000
.*              flag values exist.                           *   @Z22AM 01000000
.*        4  -  Processing successful for a flag value,      *   @Z22AM 01005000
.*                and more flag values exist                 *   @Z22AM 01010000
.*        8  -  No value returned. Check parameter list      *          01012000
.*              field TLKRETCD for further information on    *          01014000
.*              the error encountered.                       *          01016000
.*                                                           *          01030000
.*01*  ENVIRONMENT:                                          *          01040000
.*                                                           *          01050000
.*       User environment. No serialization provided.        *          01060000
.*                                                           *   @Z22AM 01060500
.*       IAZTLKUP service should be called in primary access *   @Z22AM 01061000
.*       mode, in 31 or 64 bit addressing mode               *   @Z22AM 01061500
.*                                                           *   @Z22AM 01062000
.*       Minimum authorization:                              *   @Z22AM 01062500
.*                 Problem or Supervisor state. Any PSW key. *   @Z22AM 01063000
.*                                                           *   @Z22AM 01063500
.*       Dispatchable unit mode:                             *   @Z22AM 01064000
.*                 Task mode                                 *   @Z22AM 01064500
.*                                                           *   @Z22AM 01065000
.*       Cross Memory Mode: PASN=HASN=SASN.                  *   @Z22AM 01065500
.*                                                           *   @Z22AM 01066000
.*       AMODE:    31 or 64 bit.                             *   @Z22AM 01066500
.*                                                           *   @Z22AM 01067000
.*       ASC mode: Primary.                                  *   @Z22AM 01067500
.*                                                           *   @Z22AM 01068000
.*       Locks:    No locks held.                            *   @Z22AM 01068500
.*                                                           *   @Z22AM 01069000
.*                                                           *          01070000
.*                                                           *          01080000
.*01*  NOTE:                                                 *          01090000
.*                                                           *          01100000
.*       NONE                                                *          01110000
.*                                                           *          01240000
.************************************************************           01250000
.*                                                                      01260000
.********************************************************************** 01270000
.* CHANGE ACTIVITY:                                                   * 01280000
.*                                                                    * 01290000
.* $BTALJMO=JOBMOD   HBB7790 130227 BWT:  Job Phase/Delay text part 2 * 01295000
.*                                                                    * 01296000
.* $Z22LEVT=EVENTLOG HBB77A0 140128 BWT:  EVENTLOG data set support   * 01297000
.*                                                                    * 01298000
.*                                                                    * 01300000
.* A000000-999999    Created for JES2 z/OS Release 2.1         @Z21LJMO 01310000
.********************************************************************** 01320000
.*                                                                      01330000
.*-----------------------------------------------------------*          01340000
.*       Generate DSECT if &DSECT=YES                        *          01350000
.*-----------------------------------------------------------*          01360000
         AIF   ('&DSECT' EQ 'YES').DSECT                                01370000
         AIF   ('&DSECT' EQ 'NO' OR '&DSECT' EQ '').NODSECT      @Z22AM 01380000
         MNOTE 8,'IAZTLKUP - DSECT=&DSECT is invalid, must be YES or NOC01390000
               '                                                        01400000
.DSECT   ANOP                                                           01410000
****** START OF SPECIFICATIONS *******************************          01420000
.****PROPRIETARY-STATEMENT************************************          01430000
.*01* PROPRIETARY STATEMENT:                                 *          01440000
.*                                                           *          01450000
.*    LICENSED MATERIALS-PROPERTY OF IBM                     *          01460000
.*    5650-ZOS COPYRIGHT IBM CORP 2013                       *   @Z22AM 01470000
.*                                                           *          01480000
.*    STATUS = HBB7790                                       *   @Z22AM 01490000
.*                                                           *          01500000
.****END-OF-PROPRIETARY-STATEMENT*****************************          01510000
*                                                            *          01520000
*01* DESCRIPTIVE NAME:  IAZTLKUP                             *          01530000
*02*  ACRONYM:  IAZTLKUP                                     *          01540000
*                                                            *          01550000
*01* MACRO NAME:  IAZTLKUP                                   *          01560000
*                                                            *          01570000
*01* DSECT NAME:  TLKUP                                      *          01580000
*01* LABEL PREFIX:  TLK                                      *          01590000
*                                                            *          01600000
*01* COMPONENT ID:  JES Common (SC141)                       *   @Z22AM 01610000
*                                                            *          01620000
*01* EXTERNAL CLASSIFICATION:  GUPI                          *   @Z22AM 01630000
*01* END OF EXTERNAL CLASSIFICATION:                         *          01640000
*                                                            *          01650000
*01* EYE-CATCHER:  None                                      *          01660000
*02*  OFFSET:      N/A                                       *          01670000
*02*  LENGTH:      N/A                                       *          01680000
*                                                            *          01690000
*01* STORAGE ATTRIBUTES:                                     *          01700000
*02*  SUBPOOL:    caller defined                             *   @Z22AM 01710000
*02*  KEY:        caller defined                             *   @Z22AM 01720000
*02*  RESIDENCY:  caller defined                             *   @Z22AM 01730000
*                                                            *          01740000
*01* SIZE:                                                   *          01750000
*                                                            *          01760000
*     See TLKLEN                                             *          01770000
*                                                            *          01780000
*01* CREATED BY:                                             *          01790000
*                                                            *          01800000
*     IAZTLKUP macro invocation by caller                    *          01810000
*                                                            *          01820000
*01* POINTED TO BY:                                          *          01830000
*                                                            *          01840000
*     N/A                                                    *          01850000
*                                                            *          01860000
*01* SERIALIZATION:                                          *          01870000
*                                                            *          01880000
*     None required                                          *          01890000
*                                                            *          01900000
*01* FUNCTION:                                               *          01910000
*                                                            *          01920000
*     Defines the parameters for issuing an JES Text Table   *          01930000
*     request. The storage includes the input parameters to  *          01940000
*     the JES service.                                       *   @Z22AM 01950000
*                                                            *          01960000
*01* METHOD OF ACCESS:                                       *          01970000
*                                                            *          01980000
*02*  ASM:                                                   *          01990000
*      IAZTLKUP DSECT=YES                                    *   @Z22AM 02000000
*      A USING must be done on field TLKUP                   *   @Z22AM 02020000
*                                                            *          02040000
*02*  PL/X:                                                  *          02050000
*      This mapping is not available for compilations.       *          02060000
*                                                            *          02070000
*01* USED BY:                                                *          02080000
*                                                            *          02090000
*     IAZTLUP text lookup service module.                    *   @Z22AM 02100000
*                                                            *          02120000
*01* DELETED BY:                                             *          02130000
*                                                            *          02140000
*     Caller.                                                *          02150000
*                                                            *          02160000
*01* FREQUENCY:                                              *          02170000
*                                                            *          02180000
*     One per IAZTLKUP macro invocation.                     *          02190000
*                                                            *          02200000
*01* RESTRICTIONS:                                           *          02210000
*                                                            *          02220000
*     None                                                   *          02230000
*                                                            *          02240000
****** END OF SPECIFICATIONS *********************************          02250000
         SPACE 1                                                        02260000
TLKUP    DSECT ,                   Text Table Lookup Request            02270000
         AGO   .TLKDATA                                          @Z22AM 02271000
.NODSECT ANOP                                                    @Z22AM 02272000
         AIF   ('&DSECT' EQ '').NOTMFEQD                         @Z22AM 02273000
TLKUP    DS    0D                  Text Table Lookup Request     @Z22AM 02274000
.TLKDATA ANOP                                                    @Z22AM 02275000
TLKEYE   DS    CL5'TLKUP'          Eyecatcher                    @Z22AM 02280000
         DS    XL1                 Reserved                             02290000
TLKLEN   DS    H                   Length of parameter list             02300000
TLKTBLID DS    CL3                 Text table ID                        02310000
TLKLEVEL DS    AL1                 Level of text to extract             02320000
TLKMFLG  DS    XL4                 Remaining flag reasons        @Z22AM 02330000
TLKSSOBP DS    AD(*-*)             SSOB address                         02340000
TLKSSOB4 EQU   TLKSSOBP+4,4,C'A'     31-bit part of address      @Z22AM 02345000
TLKDATAP DS    AD(*-*)             Address of SSI output data    @Z22AMC02350000
                                     where code or flag to             C02360000
                                     map is located                     02370000
TLKDATA4 EQU   TLKDATAP+4,4,C'A'     31-bit part of address      @Z22AM 02375000
TLKOUTP  DS    AD(*-*)             Addr to output area where     @Z22AMC02380000
                                     mapping results are stored         02390000
TLKOUT4  EQU   TLKOUTP+4,4,C'A'      31-bit part of address      @Z22AM 02395000
TLKOUTL  DS    F                   Output area length                   02400000
TLKRETCD DS    F                   Overall return code                  02410000
TLKRSUCC EQU   X'00'               Successful completion. For    @Z22AMC02420000
                                     flag lookup, no more text   @Z22AMC02425000
                                     is available                @Z22AM 02430000
TLKRMFLG EQU   X'04'               Successful completion. For    @Z22AMC02440000
                                     flag lookup, more text is   @Z22AMC02450000
                                     available                   @Z22AM 02455000
TLKRNOTF EQU   X'08'               Code/Flag setting not found          02460000
TLKRNTBL EQU   X'0C'               No text table pointer in SSI        C02470000
                                     output data                        02480000
TLKRBADS EQU   X'10'               Bad SSOB ptr, SSI function,         C02490000
                                     or SSI parm list                   02500000
TLKRBADT EQU   X'14'               Bad text table ID                    02510000
TLKRNOUT EQU   X'18'               Output data area pointer or         C02520000
                                     length is zeroes                   02530000
TLKRBADE EQU   X'1C'               Bad text table eyecatcher            02540000
TLKRBADL EQU   X'20'               Bad text table level requested       02550000
TLKRBADY EQU   X'24'               Bad text table type for request      02560000
TLKUPLN  EQU   *-TLKUP             Length of TLKUP DSECT                02570000
         SPACE 1                                                        02570500
**************************************************************   @Z22AM 02571000
*                                                            *   @Z22AM 02571500
*        Level text lengths for Job Phase and Job Delay      *   @Z22AM 02572000
*        text lookup tables (TPHZTABL and TDLYTABL)          *   @Z22AM 02572500
*                                                            *   @Z22AM 02573000
**************************************************************   @Z22AM 02573500
         SPACE 1                                                        02574000
TPHZLEN1 EQU   64                  Job Phase text table          @Z22AMC02574500
                                     Level 1 text length         @Z22AM 02575000
TPHZLEN2 EQU   64                  Job Phase text table          @Z22AMC02575500
                                     Level 2 text length         @Z22AM 02576000
TPHZLEN3 EQU   20                  Job Phase text table          @Z22AMC02576500
                                     Level 3 text length         @Z22AM 02577000
TDLYLEN1 EQU   20                  Job Delay text table          @Z22AMC02577500
                                     Level 1 text length         @Z22AM 02578000
TDLYLEN2 EQU   64                  Job Delay text table          @Z22AMC02578500
                                     Level 2 text length         @Z22AM 02579000
.*                                                                      02580000
         AGO   .ENDOFMF                                                 02590000
.NOTMFEQD ANOP                                                          02600000
.*                                                                      02610000
.*----------------------------------------------------------*    @Z22AM 02611000
.*       Define global environment variables and set them   *    @Z22AM 02612000
.*----------------------------------------------------------*    @Z22AM 02613000
         GBLC  &SYSASCE,&SYSAM64                                 @Z22AM 02614000
         SYSSTATE TEST                                           @Z22AM 02615000
.*                                                               @Z22AM 02616000
.*----------------------------------------------------------*           02620000
.*       Generate storage declaration if MF=L               *           02630000
.*----------------------------------------------------------*           02640000
.MFNOTEQD ANOP                                                          02650000
         LCLC  &STOR                                                    02660000
         AIF   ('&MF(1)' NE 'L').MFNOTEQL                               02670000
&STOR    SETC  '&MF(2)'                                                 02680000
&LABEL   DS    0D                                                       02690000
&STOR    DS    CL(TLKUPLN+256)                                   @Z22AM 02700000
         AGO   .ENDOFMF                                                 02720000
.*----------------------------------------------------------*           02730000
.*       Generate calling sequence if MF=E                  *           02740000
.*                                                          *   @Z22AM  02742000
.*       Note that we cannot assume register equates are    *   @Z22AM  02744000
.*       defined so use BCP register notation (15 vs R15).  *   @Z22AM  02746000
.*----------------------------------------------------------*           02750000
.MFNOTEQL ANOP                                                          02760000
         AIF   ('&MF(1)' NE 'E').MFNOTEQE                               02770000
.*                                                                      02780000
         PUSH  USING                                                    02790000
         USING TLKUP,1             Est TLKUP addressability      @Z22AM 02800000
         SPACE 1                                                        02810000
         AIF   ('&SYSASCE' NE 'AR').PLISTP                       @Z22AM 02811000
&LABEL   LAE   1,&MF(2)            Load parm list address        @Z22AM 02812000
         AGO   .PLISTOK                                          @Z22AM 02813000
.*                                                               @Z22AM 02814000
.PLISTP  ANOP                                                    @Z22AM 02815000
&LABEL   LA    1,&MF(2)            Load parm list address        @Z22AM 02816000
.PLISTOK ANOP                                                    @Z22AM 02817000
         XC    TLKUP(TLKUPLN),TLKUP  Clear parameter list        @Z22AM 02820000
         MVC   TLKEYE,=C'TLKUP'    Set eyecatcher                       02840000
         LHI   15,TLKUPLN          Load par list length          @Z22AM 02850000
         STH   15,TLKLEN             and store in the plist      @Z22AM 02860000
         AIF   ('&TABLEID' NE '').TBLIDOK                               02870000
         MNOTE 8,'ERROR: Keyword TABLEID must be specified'             02880000
         AGO   .ENDMAC                                                  02890000
.TBLIDOK ANOP                                                           02900000
         MVC   TLKTBLID,=C'&TABLEID'  Set text table ID                 02910000
.*                                                                      02930000
.*----------------------------------------------------------*    @Z22AM 02932000
.*       Process LEVEL parameter                            *    @Z22AM 02934000
.*----------------------------------------------------------*    @Z22AM 02936000
.*                                                                      02940000
         AIF   ('&LEVEL' NE '').TBLLVOK                                 02960000
         MNOTE 8,'ERROR: Keyword LEVEL must be specified'               02970000
         AGO   .ENDMAC                                                  02980000
.TBLLVOK ANOP                                                           02990000
         AIF   ('&LEVEL' GT '0' AND '&LEVEL' LT '5').TBLLVRG            03000000
         MNOTE 8,'ERROR: Keyword LEVEL must be >=1 and <=4'             03010000
         AGO   .ENDMAC                                                  03020000
.TBLLVRG ANOP                                                           03030000
         MVI   TLKLEVEL,&LEVEL     Set level of text to map             03040000
.*                                                                      03060000
.*----------------------------------------------------------*    @Z22AM 03062000
.*       Process SSOB parameter                             *    @Z22AM 03070000
.*----------------------------------------------------------*    @Z22AM 03075000
         AIF   ('&SSOB' NE '').TBLSBOK                                  03080000
         MNOTE 8,'ERROR: Keyword SSOB must be specified'                03090000
         AGO   .ENDMAC                                                  03100000
.TBLSBOK ANOP                                                           03110000
         AIF   ('&SSOB'(1,1) EQ '(').SSOBRG                             03120000
         LA    15,&SSOB            Load SSOB pointer             @Z22AM 03130000
         AIF   ('&SYSAM64' NE 'YES').SB32                        @Z22AM 03135000
         STG   15,TLKSSOBP           and store in plist          @Z22AM 03140000
         AGO   .SSOBDN                                                  03150000
.SB32    ST    15,TLKSSOB4           and store in plist          @Z22AM 03153000
         AGO   .SSOBDN                                           @Z22AM 03156000
.*                                                                      03160000
.SSOBRG ANOP                                                            03170000
         AIF   ('&SYSAM64' NE 'YES').SBR32                       @Z22AM 03175000
         STG   &SSOB(1),TLKSSOBP   Store SSOB address            @Z22AM 03180000
         AGO   .SSOBDN                                           @Z22AM 03183000
.SBR32   ST    &SSOB(1),TLKSSOB4   Store SSOB address            @Z22AM 03186000
.SSOBDN ANOP                                                            03190000
.*                                                                      03210000
.*----------------------------------------------------------*    @Z22AM 03212000
.*       Process DATASTR parameter                          *    @Z22AM 03220000
.*----------------------------------------------------------*    @Z22AM 03225000
         AIF   ('&DATASTR' NE '').TBLDPOK                               03230000
         MNOTE 8,'ERROR: Keyword DATASTR must be specified'             03240000
         AGO   .ENDMAC                                                  03250000
.TBLDPOK ANOP                                                           03260000
         AIF   ('&DATASTR'(1,1) EQ '(').DATARG                          03270000
         LA    15,&DATASTR         Load data address             @Z22AM 03290000
         AIF   ('&SYSAM64' NE 'YES').DS32                        @Z22AM 03295000
         STG   15,TLKDATAP           and store in plist          @Z22AM 03300000
         AGO   .DATADN                                                  03310000
.DS32    ST    15,TLKDATA4           and store in plist          @Z22AM 03312000
         AGO   .DATADN                                           @Z22AM 03315000
.*                                                                      03320000
.DATARG ANOP                                                            03330000
         AIF   ('&SYSAM64' NE 'YES').DSR32                       @Z22AM 03335000
         STG   &DATASTR(1),TLKDATAP  Store data address          @Z22AM 03340000
         AGO   .DATADN                                           @Z22AM 03342000
.DSR32   ST    &DATASTR(1),TLKDATA4  Store data address          @Z22AM 03345000
.DATADN ANOP                                                            03350000
.*                                                                      03370000
.*----------------------------------------------------------*    @Z22AM 03372000
.*       Process OUTAREA parameter                          *    @Z22AM 03374000
.*----------------------------------------------------------*    @Z22AM 03380000
         AIF   ('&OUTAREA' NE '').TBLOPOK                               03390000
         MNOTE 8,'ERROR: Keyword OUTAREA must be specified'             03400000
         AGO   .ENDMAC                                                  03410000
.TBLOPOK ANOP                                                           03420000
         AIF   ('&OUTAREA'(1,1) EQ '(').OUTPRG                          03430000
         LA    15,&OUTAREA         Load output area address      @Z22AM 03450000
         AIF   ('&SYSAM64' NE 'YES').OA32                        @Z22AM 03455000
         STG   15,TLKOUTP            and store in plist          @Z22AM 03460000
         AGO   .OUTPDN                                                  03470000
.OA32    ST    15,TLKOUT4            and store in plist          @Z22AM 03471000
         AGO   .OUTPDN                                           @Z22AM 03474000
.*                                                                      03480000
.OUTPRG ANOP                                                            03490000
         AIF   ('&SYSAM64' NE 'YES').OAR32                       @Z22AM 03495000
         STG   &OUTAREA(1),TLKOUTP  Store output area address           03500000
         AGO   .OUTPDN                                           @Z22AM 03501000
.OAR32   ST    &OUTAREA(1),TLKOUT4  Store output area addr       @Z22AM 03504000
.OUTPDN ANOP                                                            03510000
.*                                                               @Z22AM 03510500
.*----------------------------------------------------------*    @Z22AM 03511000
.*       Process OUTLEN parameter                           *    @Z22AM 03511500
.*----------------------------------------------------------*    @Z22AM 03512000
         XGR   15,15               Clear full register           @Z22AM 03512500
         AIF   ('&OUTLEN' NE '').TBLOLOK                         @Z22AM 03513000
         LHI   15,L'&OUTAREA       Load output area length       @Z22AM 03513500
         ST    15,TLKOUTL          Set output area length        @Z22AM 03514000
         AGO   .OUTLDN                                           @Z22AM 03514500
.TBLOLOK ANOP                                                    @Z22AM 03515000
         AIF   ('&OUTLEN'(1,1) EQ '(').OUTLRG                    @Z22AM 03515500
         LHI   15,&OUTLEN          Load output area length       @Z22AM 03516000
         ST    15,TLKOUTL          Set output area length        @Z22AM 03516500
         AGO   .OUTLDN                                           @Z22AM 03517000
.*                                                               @Z22AM 03517500
.OUTLRG ANOP                                                     @Z22AM 03518000
         ST    &OUTLEN(1),TLKOUTL  Store output area length      @Z22AM 03520000
.OUTLDN ANOP                                                     @Z22AM 03520200
.*                                                               @Z22AM 03521000
.*----------------------------------------------------------*    @Z22AM 03521200
.*       Process MOREFLG parameter                          *    @Z22AM 03522000
.*----------------------------------------------------------*    @Z22AM 03522200
         AIF   ('&MOREFLG' NE '').MFLGCK                         @Z22AM 03523000
         XGR   0,0                 Clear flag bit register       @Z22AM 03523200
         ST    0,TLKMFLG             and parm list value         @Z22AM 03524000
         AGO   .MFLGDN                                           @Z22AM 03524200
.*                                                               @Z22AM 03525000
.MFLGCK  AIF   ('&MOREFLG'(1,1) EQ '(').MFLGRG                   @Z22AM 03525200
         L     0,&MOREFLG          Load R0 with flag bits        @Z22AM 03526000
         ST    0,TLKMFLG             and store in parm list      @Z22AM 03526200
         AGO   .MFLGDN                                           @Z22AM 03526400
.*                                                               @Z22AM 03526600
.MFLGRG ANOP                                                     @Z22AM 03526800
         LR    0,&MOREFLG(1)       Load R0 with flag bits        @Z22AM 03527400
         ST    0,TLKMFLG             and store in parm list      @Z22AM 03528000
.MFLGDN ANOP                                                     @Z22AM 03528600
.*                                                                      03530000
.*----------------------------------------------------------*    @Z22AM 03540000
.*       Set up branch to IAZTLUP service. Locate its       *    @Z22AM 03543000
.*       address going from the CVT to the JESCT, to the    *    @Z22AM 03546000
.*       FSIB and pull the entry point address from field   *    @Z22AM 03550000
.*       FSIBTABL.                                          *    @Z22AM 03555000
.*----------------------------------------------------------*    @Z22AM 03560000
         SPACE 1                                                        03570000
         AIF   ('&SYSAM64' NE 'YES').SETU32                      @Z22AM 03575000
         XGR   15,15               Clear full R15                @Z22AM 03580000
         LLGT  15,16(15)           Get CVT address               @Z22AM 03590000
         LLGT  15,296(15)          Get JESCT address             @Z22AM 03600000
         LLGT  15,100(15)          Get JESCT extension addr      @Z22AM 03610000
         LLGT  15,100(15)          Get IAZBASE cb addr (FSIB)    @Z22AM 03620000
         LLGT  15,20(15)           Get IAZTLUP addr from FSIB    @Z22AM 03630000
         AGO   .DOBASR                                                  03630600
.SETU32  ANOP                                                           03631500
         XR    15,15               Clear full R15                @Z22AM 03632400
         L     15,16(,0)           Get CVT address               @Z22AM 03633300
         L     15,296(15)          Get JESCT address             @Z22AM 03634200
         L     15,100(15)          Get JESCT extension addr      @Z22AM 03635100
         L     15,100(15)          Get IAZBASE cb addr (FSIB)    @Z22AM 03636000
         L     15,20(15)           Get IAZTLUP addr from FSIB    @Z22AM 03636900
.*                                                                      03637800
.DOBASR  ANOP                                                           03638700
         BASR  14,15               Call Text Table Lookup rtn    @Z22AM 03640000
         SPACE 1                                                        03660000
.*                                                               @Z22AM 03660300
.*----------------------------------------------------------*    @Z22AM 03661000
.*       Place remaining flag bits in MOREFLG if it was     *    @Z22AM 03661700
.*       supplied.                                          *    @Z22AM 03662400
.*----------------------------------------------------------*    @Z22AM 03663100
         AIF   ('&MOREFLG' EQ '').TBLMFOK                        @Z22AM 03663800
         L     0,TLKMFLG           Load remaining flag bits             03664500
         ST    0,&MOREFLG(1)         and store in user field     @Z22AM 03666600
.*                                                               @Z22AM 03667300
.TBLMFOK ANOP                                                    @Z22AM 03668000
         POP   USING                                                    03670000
         AGO   .ENDMAC                                                  03680000
.*--------------------------------------------------------------------* 03690000
.*       Generate an error message when MF is not L or E              * 03700000
.*--------------------------------------------------------------------* 03710000
.MFNOTEQE ANOP                                                          03720000
         MNOTE 8,'ERROR: Keyword MF must be L or E'                     03730000
.ENDOFMF ANOP                                                           03740000
.ENDMAC  ANOP                                                           03750000
         MEND                                                           03760000
.*                                                                      03770000
**/                                                                     03780000
* %IAZTLKUP: /* PL/S VERSION OF IAZTLKUP MACRO                       */ 03790000
*/********************************************************************/ 03800000
*  MACRO                                                                03810000
*    KEYS(TABLEID,                 /* Text table ID to access        */ 03820000
*        LEVEL,                    /* Level of text to return        */ 03830000
*        SSOB,                     /* SSOB pointer                   */ 03840000
*        DATASTR,                  /* SSI data section to map        */ 03850000
*        OUTAREA,                  /* Output area for text           */ 03860000
*        OUTLEN,                   /* Length of output area for text */ 03870000
*        MOREFLG,                  /* More flag bit ind        @Z22AM*/ 03873000
*        RETCODE,                  /* Return code              @Z22AM*/ 03876000
*        MF);                      /* Macro mapping function         */ 03880000
*        ANS('?'!!MACLABEL!!'IAZTLKPP '!!MACLIST!!MACKEYS!!';');        03890000
* @Logic;                                                               03900000
* #PRAGMA TOOL=PADI.                                                    03910000
* #ASMLINE.  IAZTLKUP DSECT=YES                                         03920000
* #PADIDELETE.TLKUP                                                     03930000
* #PADIDELETE.TLKEYE                                                    03940000
* #PADIDELETE.TLKLEN                                                    03950000
* #PADIDELETE.TLKTBLID                                                  03960000
* #PADIDELETE.TLKLEVEL                                                  03970000
* #PADIDELETE.TLKMFLG                                                   03980000
* #PADIDELETE.TLKSSOBP                                                  03990000
* #PADIDELETE.TLKSSOB4                                                  04000000
* #PADIDELETE.TLKDATAP                                                  04010000
* #PADIDELETE.TLKDATA4                                                  04020000
* #PADIDELETE.TLKOUTP                                                   04030000
* #PADIDELETE.TLKOUT4                                                   04040000
* #PADIDELETE.TLKOUTL                                                   04050000
* #PADIDELETE.TLKRETCD                                                  04060000
* #PADIDELETE.TLKRSUCC                                                  04070000
* #PADIDELETE.TLKRMFLG                                                  04080000
* #PADIDELETE.TLKRNOTF                                                  04090000
* #PADIDELETE.TLKRNTBL                                                  04100000
* #PADIDELETE.TLKRBADS                                                  04110000
* #PADIDELETE.TLKRBADT                                                  04120000
* #PADIDELETE.TLKRNOUT                                                  04130000
* #PADIDELETE.TLKRBADE                                                  04140000
* #PADIDELETE.TLKRBADL                                                  04150000
* #PADIDELETE.TLKRBADY                                                  04160000
* #PADIDELETE.TLKUPLN                                                   04170000
* #PADIDELETE.TPHZLEN1                                                  04180000
* #PADIDELETE.TPHZLEN2                                                  04190000
* #PADIDELETE.TPHZLEN3                                                  04200000
* #PADIDELETE.TDLYLEN1                                                  04210000
* #PADIDELETE.TDLYLEN2                                                  04220000
*#EPRAGMA                                                               04230000
*@ENDLOGIC;                                                             04240000
*% END;                                                                 99999999

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  ITTWRITE                              -02/08/11-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Component Trace Write Macro                   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 2011                               * 00001200
*                                                                     * 00001300
* STATUS= HBB7780                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      The ITTWRITE macro provides the interface to the Component     * 00002000
*      Trace Writer service routine. This macro is an enhancement to  * 00002100
*      the CTRACEWR macro to support buffers anywhere in the 64-bit   * 00002200
*      address space.                                                 * 00002300
*                                                                     * 00002400
*02*   OPERATION:                                                     * 00002500
*                                                                     * 00002600
*                                                                     * 00002700
*        The CTRACEWR macro performs syntax checking to validate the  * 00002800
*        user specified request. If an error is detected, macro phase * 00002900
*        error messages are issued and a macro phase return code of 8 * 00003000
*        is set.                                                      * 00003100
*                                                                     * 00003200
*        The parameter list is defined.                               * 00003300
*                                                                     * 00003400
*        The parameter list is initialized and the linkage code is    * 00003500
*        generated to perform a non-space switch PC to the service    * 00003600
*        routine for the Ctrace external writer.                      * 00003700
*                                                                     * 00003800
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00003900
*                                                                     * 00004000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004100
*                                                                     * 00004200
*01* ENVIRONMENT:                                                     * 00004300
*                                                                     * 00004400
*                                                                     * 00004500
*      Minimum authorization: Supervisor state or  System PSW key.    * 00004600
*                                                                     * 00004700
*      Dispatchable unit mode: Task mode.                             * 00004800
*                                                                     * 00004900
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00005000
*                                                                     * 00005100
*      AMODE:            64-bit.                                      * 00005200
*                                                                     * 00005300
*      ASC mode:         Primary or Access Register.                  * 00005400
*                                                                     * 00005500
*      Interrupt status: Enabled or disabled for I/O and external     * 00005600
*                        interrupts.                                  * 00005700
*                                                                     * 00005800
*      Locks:            No locks held.                               * 00005900
*                                                                     * 00006000
*      Control parameters: Control parameters must be in the primary  * 00006100
*                        address space.                               * 00006200
*                                                                     * 00006300
*                                                                     * 00006400
*                                                                     * 00006500
*01* PROGRAMMING REQUIREMENTS:                                        * 00006600
*                                                                     * 00006700
*    None other than the interface requirements above.                * 00006800
*                                                                     * 00006900
*01* RESTRICTIONS:                                                    * 00007000
*                                                                     * 00007100
*    If either the BUFFALET or the TBWCALET identifies the secondary  * 00007200
*    or home address space, then both must identify the same address  * 00007300
*    space (that is both the trace buffer and the trace buffer writer * 00007400
*    control area must be in the same address space).                 * 00007500
*                                                                     * 00007600
*01* INPUT REGISTER INFORMATION:                                      * 00007700
*                                                                     * 00007800
*    Before issuing the ITTWRITE macro, the caller does not have to   * 00007900
*    place any information into any register unless using it in       * 00008000
*    register notation for a particular parameter, or using it as a   * 00008100
*    base register.                                                   * 00008200
*                                                                     * 00008300
*    Before issuing the ITTWRITE macro, the caller does not have to   * 00008400
*    place any information into any AR unless using it in register    * 00008500
*    notation for a particular parameter, or using it as a base       * 00008600
*    register.                                                        * 00008700
*                                                                     * 00008800
*01* OUTPUT REGISTER INFORMATION:                                     * 00008900
*                                                                     * 00009000
*    When control returns to the caller, the GPRs contain:            * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*    REGISTER  CONTENTS                                               * 00009400
*                                                                     * 00009500
*    0         If GPR 15 contains 0 or 4, GPR 0 is used as a work     * 00009600
*              register by the system; otherwise, GPR 0 contains a    * 00009700
*              reason code.                                           * 00009800
*                                                                     * 00009900
*    1         Used as work registers by the system.                  * 00010000
*                                                                     * 00010100
*    2-13      Unchanged                                              * 00010200
*                                                                     * 00010300
*    14        Used as work registers by the system.                  * 00010400
*                                                                     * 00010500
*    15        Return code                                            * 00010600
*                                                                     * 00010700
*                                                                     * 00010800
*                                                                     * 00010900
*    When control returns to the caller, the ARs contain:             * 00011000
*                                                                     * 00011100
*                                                                     * 00011200
*    REGISTER  CONTENTS                                               * 00011300
*                                                                     * 00011400
*    0-1       Used as work registers by the system                   * 00011500
*                                                                     * 00011600
*    2-13      Unchanged                                              * 00011700
*                                                                     * 00011800
*    14-15     Used as work registers by the system.                  * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*    Some callers depend on register contents remaining the same      * 00012300
*    before and after issuing a service.  If the system changes the   * 00012400
*    contents of registers on which the caller depends, the caller    * 00012500
*    must save them before issuing the service, and restore them      * 00012600
*    after the system returns control.                                * 00012700
*                                                                     * 00012800
*01* PERFORMANCE IMPLICATIONS:                                        * 00012900
*                                                                     * 00013000
*    None.                                                            * 00013100
*                                                                     * 00013200
*01* SYNTAX:                                                          * 00013300
*                                                                     * 00013400
*Ýxlabel¨  ITTWRITE     BUFFADDR=xbuffaddr                            * 00013500
*                         Ý,BUFFALET=»xbuffalet!NOBUFFALETº¨          * 00013600
*                         Ý,BUFFSTOKEN=»xbuffstoken!BY_BUFFALETº¨     * 00013700
*                      ,BUFFLEN=xbufflen                              * 00013800
*                      ,TOKEN=xtoken                                  * 00013900
*                    Ð ,TBWCADDR=xtbwcaddr                            * 00014000
*                    ¿ ,TBWCADDR64=xtbwcaddr64                        * 00014100
*                     Ý,TBWCALET=»xtbwcalet!NOTBWCALETº¨              * 00014200
*                     Ý,SYNCH=»NO!YESº¨                               * 00014300
*                     Ý,RC=xrc¨                                       * 00014400
*                     Ý,RSNCODE=xrsncode¨                             * 00014500
*                     Ý,COM=»xcom!NULLº¨                              * 00014600
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00014700
*                    ÐÝ,MF=S¨                                         * 00014800
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00014900
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*      Where:                                                         * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*      Ýxlabel¨                                                       * 00015600
*          is an optional symbol, starting in column 1, that is the   * 00015700
*          name on the ITTWRITE macro invocation.  The name must      * 00015800
*          conform to the rules for an ordinary assembler language    * 00015900
*          symbol.                                                    * 00016000
*          DEFAULT: No name.                                          * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*      BUFFADDR=xbuffaddr                                             * 00016600
*          is the name (RS-type) of a required 8 byte input that      * 00016700
*          contains the address of the buffer to be written           * 00016800
*          externally.                                                * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*          ÝBUFFALET=»xbuffalet!NOBUFFALETº¨                          * 00017200
*              is the name (RS-type), or address in register          * 00017300
*              (2)-(12), of an optional 4 character input variable    * 00017400
*              that contains the ALET on the PASN access list that    * 00017500
*              identifies the address/data space where the buffer     * 00017600
*              resides.  This keyword is only appropriate when the    * 00017700
*              buffer to be written externally resides in either a    * 00017800
*              data space or an address space that is different from  * 00017900
*              the current primary address space.  NOTE: the space    * 00018000
*              identified by BUFFALET and the space identified by     * 00018100
*              TBWCALET must both be addressable from the same        * 00018200
*              address space; that is, they both must be addressable  * 00018300
*              from the HOME address space (if a HOME ALET is         * 00018400
*              specified) or from the SECONDARY address space (if a   * 00018500
*              SECONDARY ALET is specified) or from the PRIMARY       * 00018600
*              address space (if a PRIMARY ALET or data space ALET on * 00018700
*              the PASN access list or no ALET is specified, and      * 00018800
*              buffSTOKEN is not specified), or from the address      * 00018900
*              space identified by the buffSTOKEN parameter.          * 00019000
*              DEFAULT: NOBUFFALET                                    * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*          ÝBUFFSTOKEN=»xbuffstoken!BY_BUFFALETº¨                     * 00019600
*              is the name (RS-type), or address in register          * 00019700
*              (2)-(12), of an optional 8 character input variable    * 00019800
*              that contains the STOKEN for the address space that    * 00019900
*              owns the buffer which is identified by the buffaddr    * 00020000
*              and buffalet parameters.  The value is ignored if      * 00020100
*              BUFFALET specifies a value of 1 (the secondary address * 00020200
*              space) or a value of 2 (the home address space).       * 00020300
*              DEFAULT: BY_BUFFALET which indicates that the owning   * 00020400
*              space is determined by the value of the buffalet       * 00020500
*              parameter.                                             * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*      BUFFLEN=xbufflen                                               * 00021300
*          is the name (RS-type), or address in register (2)-(12), of * 00021400
*          a required doubleword input variable that provides the     * 00021500
*          length (in number of bytes) of the buffer that is to be    * 00021600
*          written externally.  For better processing time, and more  * 00021700
*          efficient use of space, it is preferable to pass large     * 00021800
*          buffers to Ctrace for writing.  For this reason, it is     * 00021900
*          recommended that the buffer size be at LEAST 4K bytes.     * 00022000
*          Ctrace will split buffers that are too large to fit into a * 00022100
*          single block, so there is no upper limit on the buffer     * 00022200
*          length, aside from needing to fit into a fixed(31) field   * 00022300
*          and Ctrace being able to obtain sufficient storage to      * 00022400
*          process the request.                                       * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*      TOKEN=xtoken                                                   * 00023000
*          is the name (RS-type), or address in register (2)-(12), of * 00023100
*          a required 8 character input variable that contains the    * 00023200
*          token that was passed to the component start/stop exit     * 00023300
*          when it was requested to start tracing externally.         * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*      The following is a set of mutually exclusive keys.  This set   * 00023900
*      is required; only one key must be specified.                   * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*      TBWCADDR=xtbwcaddr                                             * 00024300
*          belongs to a set of mutually exclusive keys. It is the     * 00024400
*          name (RS-type), or address in register (2)-(12), of a 4    * 00024500
*          byte input that contains the address of storage that is    * 00024600
*          obtained by the component and mapped by ITTTBWC.  This     * 00024700
*          storage is used to provide communication between the       * 00024800
*          component tracing routine and the CTRACE code that is      * 00024900
*          capturing the trace buffer asynchronously.  The CTRACECS   * 00025000
*          macro should be used to manipulate control information     * 00025100
*          that is mapped by ITTTBWC.                                 * 00025200
*                                                                     * 00025300
*      TBWCADDR64=xtbwcaddr64                                         * 00025400
*          belongs to a set of mutually exclusive keys. It is the     * 00025500
*          name (RS-type), or address in register (2)-(12), of an 8   * 00025600
*          byte input that contains the address of the TBWC.  This is * 00025700
*          the 64 bit version of the TBWCADDR key.                    * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*      End of a set of mutually exclusive required keys.              * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*      ÝTBWCALET=»xtbwcalet!NOTBWCALETº¨                              * 00026600
*          is the name (RS-type), or address in register (2)-(12), of * 00026700
*          an optional 4 character input variable that contains the   * 00026800
*          ALET on the PASN access list that identifies the           * 00026900
*          address/data space where the control area (storage mapped  * 00027000
*          by ITTTBWC) resides.  This keyword is only appropriate     * 00027100
*          when the control area resides in either a data space or an * 00027200
*          address space that is different from the current primary   * 00027300
*          address space.  NOTE: the space identified by BUFFALET and * 00027400
*          the space identified by TBWCALET must both be addressable  * 00027500
*          from the same address space; that is, they both must be    * 00027600
*          addressable from the HOME address space (if a HOME ALET is * 00027700
*          specified) or from the SECONDARY address space (if a       * 00027800
*          SECONDARY ALET is specified) or from the PRIMARY address   * 00027900
*          space (if a PRIMARY ALET or data space ALET on the PASN    * 00028000
*          access list or no ALET is specified, and buffSTOKEN is not * 00028100
*          specified), or from the address space identified by the    * 00028200
*          buffSTOKEN parameter.                                      * 00028300
*          DEFAULT: NOTBWCALET                                        * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*      ÝSYNCH=»NO!YESº¨                                               * 00028900
*          is an optional keyword input is an optional keyword input  * 00029000
*          used to indicate whether the ITTWRITE function should be   * 00029100
*          completed asynchronously or synchronously.                 * 00029200
*          DEFAULT: NO                                                * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*          SYNCH=NO                                                   * 00029600
*              specifies that the ITTWRITE function should be         * 00029700
*              executed asynchronously.                               * 00029800
*                                                                     * 00029900
*          SYNCH=YES                                                  * 00030000
*              specifies that the ITTWRITE function should be         * 00030100
*              executed synchronously.                                * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*      ÝRC=xrc¨                                                       * 00030900
*          is the name (RS-type) of an optional fullword output       * 00031000
*          variable, or register (2)-(12) or (15), into which the     * 00031100
*          return code is to be copied from GPR 15.  If you specify   * 00031200
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00031300
*          the value will be left in GPR 15.                          * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*      ÝRSNCODE=xrsncode¨                                             * 00031900
*          is the name (RS-type) of an optional fullword output       * 00032000
*          variable into which the reason code is to be copied from   * 00032100
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00032200
*          R0 (within or without parentheses), the value will be left * 00032300
*          in GPR 0.                                                  * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*      ÝCOM=»xcom!NULLº¨                                              * 00032900
*          is an optional character input  that will appear in the    * 00033000
*          block comment before the macro invocation echo. It can be  * 00033100
*          used to comment the macro invocation.  The comment string  * 00033200
*          must be enclosed in quotes if it contains any lower case   * 00033300
*          characters.                                                * 00033400
*          DEFAULT: NULL                                              * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00034000
*          is an optional byte input decimal value in the "0-0" range * 00034100
*          that specifies the macro version.  PLISTVER is the only    * 00034200
*          key allowed on the list form of MF and determines which    * 00034300
*          parameter list is generated.  Note that MAX may be         * 00034400
*          specified instead of a number, and the parameter list will * 00034500
*          be of the largest size currently supported. This size may  * 00034600
*          grow from release to release (thus possibly affecting the  * 00034700
*          amount of storage needed by your program).  If your        * 00034800
*          program can tolerate this, IBM recommends that you always  * 00034900
*          specify MAX when creating the list form parameter list as  * 00035000
*          that will ensure that the list form parameter list is      * 00035100
*          always long enough to hold whatever parameters might be    * 00035200
*          specified on the execute form.                             * 00035300
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00035400
*          default is the lowest version which allows all of the      * 00035500
*          parameters specified on the invocation to be processed.    * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*      ÝMF=»S!L!Eº¨                                                   * 00036100
*          is an optional keyword input which specifies the macro     * 00036200
*          form.                                                      * 00036300
*          DEFAULT: S                                                 * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*          ÝMF=S¨                                                     * 00036700
*              specifies the standard form of the macro.  The "S"     * 00036800
*              form generates code to put the parameters into an      * 00036900
*              in-line parameter list and invoke the desired service. * 00037000
*              Full checking for required macro keys is done along    * 00037100
*              with supplying defaults for omitted optional           * 00037200
*              parameters.                                            * 00037300
*                                                                     * 00037400
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00037500
*              specifies the list form of the macro.  The "L" form    * 00037600
*              defines an area to be used for the parameter list.     * 00037700
*              Only the PLISTVER key may be specified on the          * 00037800
*              invocation.  All other macro parameters are flagged as * 00037900
*              errors.  If PLISTVER is not specified, the original    * 00038000
*              parameter list definition is used.                     * 00038100
*                                                                     * 00038200
*            ,xmfctrl                                                 * 00038300
*              is a required input.  It is the name of a storage area * 00038400
*              for the parameter list.                                * 00038500
*                                                                     * 00038600
*            »,xmfattr!0Dº                                            * 00038700
*              is an optional 60 character input string that varies   * 00038800
*              from 1 to 60 characters. Use it to force boundary      * 00038900
*              alignment of the parameter list. Use only 0F or 0D.    * 00039000
*              DEFAULT: 0D which forces the parameter list to a       * 00039100
*              doubleword boundary.                                   * 00039200
*                                                                     * 00039300
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00039400
*              specifies the execute form of the macro.  The "E" form * 00039500
*              generates code to put the parameters into the          * 00039600
*              parameter list specified by xmfctrl and provides full  * 00039700
*              syntax checking with default setting.                  * 00039800
*                                                                     * 00039900
*            ,xmfctrl                                                 * 00040000
*              is a required input.  It is the name (RS-type), or     * 00040100
*              address in register (1)-(12), of a storage area for    * 00040200
*              the parameter list.                                    * 00040300
*                                                                     * 00040400
*            »,COMPLETEº                                              * 00040500
*              is an optional keyword input which specifies the       * 00040600
*              degree of macro parameter syntax checking.             * 00040700
*              DEFAULT: COMPLETE                                      * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*              COMPLETE                                               * 00041100
*                  Checking for required macro keys is done and       * 00041200
*                  defaults are supplied for omitted optional         * 00041300
*                  parameters.                                        * 00041400
*                                                                     * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*01* RETURN CODES:                                                    * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*       0         Meaning:  Successful - CTRACE has initiated the     * 00042500
*                 process of capturing the trace data.                * 00042600
*                                                                     * 00042700
*       4         Meaning:  Unsuccessful - No data was captured since * 00042800
*                 the trace is not connected to an active writer.     * 00042900
*                                                                     * 00043000
*       8         Meaning:  Unsuccessful due to environmental         * 00043100
*                 circumstances, reason code in register zero.        * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                 HEX REASON  MEANING                                 * 00043500
*                 CODE                                                * 00043600
*                                                                     * 00043700
*                 xxxx01xx    Meaning:  Storage required to perform   * 00043800
*                             the CTRACE Write operation could not be * 00043900
*                             obtained.                               * 00044000
*                                                                     * 00044100
*                 xxxx02xx    Meaning:  Unable to schedule an SRB to  * 00044200
*                             process this request.                   * 00044300
*                                                                     * 00044400
*                 xxxx03xx    Meaning:  The control information       * 00044500
*                             (TBWC) has already been reused by the   * 00044600
*                             component.                              * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*       12        Meaning:  Unsuccessful due to invalid input, reason * 00045100
*                 code in register zero.                              * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*                 HEX REASON MEANING                                  * 00045500
*                 CODE                                                * 00045600
*                                                                     * 00045700
*                 xxxx01xx  Meaning:  Could not process request since * 00045800
*                           caller is holding locks which require     * 00045900
*                           CTRACE to process.                        * 00046000
*                                                                     * 00046100
*                 xxxx02xx  Meaning:  Invalid input token.            * 00046200
*                                                                     * 00046300
*                 xxxx03xx  Meaning:  Input TBWC is invalid for one   * 00046400
*                           of the following reasons:                 * 00046500
*                                                                     * 00046600
*                                                                     * 00046700
*                           o   sequence number is same as previous   * 00046800
*                               write request                         * 00046900
*                                                                     * 00047000
*                           o   CTRACEWR issuer is disabled and TBWC  * 00047100
*                               is not in central storage             * 00047200
*                                                                     * 00047300
*                           o   BUFFALET is not the same as TBWCALET  * 00047400
*                                                                     * 00047500
*                                                                     * 00047600
*                                                                     * 00047700
*                                                                     * 00047800
*                                                                     * 00047900
*                                                                     * 00048000
*                                                                     * 00048100
*01* REASON CODES:                                                    * 00048200
*                                                                     * 00048300
*       Reason codes, as appropriate, are defined under their         * 00048400
*       corresponding return code.                                    * 00048500
*                                                                     * 00048600
*01* ABEND CODES:                                                     * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*       00D       Component Trace service request failed.             * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*                                                                     * 00049300
*01* ABEND REASON CODES:                                              * 00049400
*                                                                     * 00049500
*       REASON    ABEND                                               * 00049600
*       CODE      CODE      DESCRIPTION                               * 00049700
*       ××××××××  ××××××××  ×××××××××××                               * 00049800
*                                                                     * 00049900
*                                                                     * 00050000
*       xx0101xx  00D       Incompatible level of the ITTWRITE        * 00050100
*                           parameter list used with the service      * 00050200
*                           routine.                                  * 00050300
*                                                                     * 00050400
*       xx0102xx  00D       Non zero values in the reserved fields or * 00050500
*                           fields unused for the requested service   * 00050600
*                           in the ITTWRITE parameter list.           * 00050700
*                                                                     * 00050800
*       xx0103xx  00D       The buffer length passed was zero or      * 00050900
*                           less.                                     * 00051000
*                                                                     * 00051100
*       xx0104xx  00D       The buffer length is unusually large and  * 00051200
*                           is not supported by CTRACE.               * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00051700
*                                                                     * 00051800
*02*   PROCESSOR:  ASSEM                                              * 00051900
*                                                                     * 00052000
*01* COMPONENT:  SCTRC                                                * 00052100
*                                                                     * 00052200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00052300
*                                                                     * 00052400
*01* EXAMPLES:                                                        * 00052500
*                                                                     * 00052600
*01* MACRO USAGE NOTES:                                               * 00052700
*                                                                     * 00052800
*                                                                     * 00052900
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00053000
*        global macro variable.  Any value other than 'NO' will       * 00053100
*        result in the macro expansion being printed.  The default is * 00053200
*        'YES'.  The following examples illustrate how the ZPRINT     * 00053300
*        variable should be set.                                      * 00053400
*                                                                     * 00053500
*                    GBLC &ZPRINT                                     * 00053600
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*    2.  All   keys   currently   contained  in  the  ITTWRITE  macro * 00054000
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00054100
*        value of 0 or MAX.                                           * 00054200
*                                                                     * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*01* CHANGE ACTIVITY:                                                 * 00054700
*                                                                     * 00054800
*   Flag LineItem  FMID    Date   ID    Comment                       * 00054900
*                                                                     * 00055000
*    $L0=H9VAMG   HBB7730 050831 IIGA:  Support for buffers above the * 00055100
*                                         bar                         * 00055200
*    $L1=ME20228  HBB7780 110201 RSTLAK:  Support for TBWCADDR64      * 00055300
****** END OF SPECIFICATIONS *****************************************/ 00055400
*/********************************************************************* 00055500
         MACRO                                                          00055600
&XLABEL  ITTWRITE &BUFFADDR=,&BUFFALET=,&BUFFSTOKEN=,&BUFFLEN=,&TOKEN=,*00055700
               &TBWCADDR=,&TBWCADDR64=,&TBWCALET=,&SYNCH=,&RC=,        *00055800
               &RSNCODE=,&COM=,&PLISTVER=,&MF=                          00055900
.*                                                                      00056000
*                MACDATE -02/08/11-<0>                                  00056100
.*                                                                      00056200
.*******************************************************************    00056300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00056400
.*******************************************************************    00056500
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00056600
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00056700
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00056800
.*                                                                      00056900
                GBLC  &ZITTWRITE  YES=MACRO USED AT LEAST ONCE          00057000
.*******************************************************************    00057100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00057200
.*******************************************************************    00057300
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00057400
                LCLC  &ZCNDX      SYSNDX CHARACTERS                     00057500
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00057600
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00057700
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00057800
                LCLA  &ZAWRK      USED AS A WORK AREA                   00057900
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00058000
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00058100
                LCLC  &ZC         CHARACTER WORK VARIABLE               00058200
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00058300
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00058400
                LCLC  &ZMAC_G     "G" or null                           00058500
&ZMAC_G         SETC  ''                                                00058600
                LCLC  &ZMAC_LR                                          00058700
&ZMAC_LR        SETC  'LR'                                              00058800
                LCLC  &ZMAC_L                                           00058900
&ZMAC_L         SETC  'L'                                               00059000
                LCLC  &ZMAC_ST                                          00059100
&ZMAC_ST        SETC  'ST'                                              00059200
                LCLA  &ZMACRET    MACRO RETURN CODE                     00059300
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00059400
.*                                                                      00059500
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00059600
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00059700
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00059800
                LCLC  &ZENDBASEPL               End of base PL          00059900
                LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                 00060000
.*******************************************************************    00060100
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00060200
.*******************************************************************    00060300
                LCLA  &ZI         INDEX FOR ARRAY                       00060400
                LCLA  &ZJ         INDEX FOR PARMS                       00060500
                LCLA  &ZK         INDEX FOR PARSE                       00060600
                LCLA  &ZLO        LOW RANGE VALUE                       00060700
                LCLA  &ZHI        HIGH RANGE VALUE                      00060800
                LCLC  &ZW         WORK AREA FOR PARM                    00060900
.********************************************************************   00061000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00061100
.********************************************************************   00061200
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00061300
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00061400
                GBLA  &SYSALVL    SYSSTATE ARCHLVL                      00061500
                GBLC  &SYSAM64    SYSSTATE AMODE64                      00061600
.*                                                                      00061700
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00061800
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00061900
                SPLEVEL  TEST                                           00062000
.ZSYS2          ANOP  ,                                                 00062100
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00062200
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00062300
                SYSSTATE TEST                                           00062400
                AGO   .ZSYS4                                            00062500
.ZSYS3          ANOP  ,                                                 00062600
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00062700
.ZSYS4          ANOP  ,                                                 00062800
.*******************************************************************    00062900
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00063000
.*******************************************************************    00063100
                LCLC  &XBUFFADDR  ++ NAME                               00063200
                LCLC  &XBUFFALET  ++ NAME                               00063300
                LCLC  &XBUFFSTOKEN              ++ NAME                 00063400
                LCLC  &XBUFFLEN   ++ NAME                               00063500
                LCLC  &XTOKEN     ++ NAME                               00063600
                LCLC  &XDUMMY1    ++ NAME                               00063700
                LCLC  &XTBWCADDR  ++ NAME                               00063800
                LCLC  &XTBWCADDR64              ++ NAME                 00063900
                LCLC  &XTBWCALET  ++ NAME                               00064000
                LCLC  &XSYNCH     ++ VALUE                              00064100
                LCLC  &XRC        ++ NAME                               00064200
                LCLC  &XRSNCODE   ++ NAME                               00064300
                LCLC  &XCOM       ++ VALUE                              00064400
                LCLA  &XPLISTVER  ++ VALUE                              00064500
                LCLC  &XMF        ++ VALUE                              00064600
                LCLC  &XMFCTRL    ++ NAME                               00064700
                LCLC  &XMFATTR    ++ VALUE                              00064800
                LCLC  &XMFSCK     ++ VALUE                              00064900
.*******************************************************************    00065000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00065100
.*******************************************************************    00065200
                LCLC  &ZXBUFFADDR               ++ INPUT NAME           00065300
                LCLC  &ZXBUFFALET               ++ INPUT NAME           00065400
                LCLC  &ZXBUFFSTOKEN             ++ INPUT NAME           00065500
                LCLC  &ZXBUFFLEN  ++ INPUT NAME                         00065600
                LCLC  &ZXTOKEN    ++ INPUT NAME                         00065700
                LCLC  &ZXDUMMY1   ++ INPUT NAME                         00065800
                LCLC  &ZXTBWCADDR               ++ INPUT NAME           00065900
                LCLC  &ZXTBWCADDR64             ++ INPUT NAME           00066000
                LCLC  &ZXTBWCALET               ++ INPUT NAME           00066100
                LCLC  &ZXSYNCH    ++ INPUT VALUE                        00066200
                LCLC  &ZXRC       ++ OUTPUT NAME                        00066300
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00066400
                LCLC  &ZXCOM      ++ INPUT VALUE                        00066500
                LCLC  &ZXPLISTVER               ++ INPUT VALUE          00066600
                LCLC  &ZXMF       ++ INPUT VALUE                        00066700
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00066800
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00066900
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00067000
.********************************************************************   00067100
.***AC.PLV01  PROCESS PLISTVER                                      *   00067200
.********************************************************************   00067300
&XPLISTVER      SETA  0                                                 00067400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00067500
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00067600
&XPLISTVER      SETA  0                                                 00067700
.ZPLV0          ANOP  ,                                                 00067800
.*                                                                      00067900
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00068000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00068100
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00068200
.*-------------------------------------------------------------------   00068300
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00068400
&ZMS            SETC  '"PLISTVER='                                      00068500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00068600
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00068700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00068800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00068900
                AGO   .ZPVCK2                                           00069000
.ZPVCK3         ANOP  ,                                                 00069100
.*-------------------------------------------------------------------   00069200
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00069300
&ZMS            SETC  '"PLISTVER='                                      00069400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00069500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00069600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00069700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00069800
                AGO   .ZPVCKE                                           00069900
.ZPVCK2         ANOP  ,                                                 00070000
.*-------------------------------------------------------------------   00070100
&ZCVAL          SETC  '&PLISTVER(1)'                                    00070200
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00070300
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00070400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00070500
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00070600
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00070700
.ZPVCK6         ANOP  ,                                                 00070800
&ZMS            SETC  '"PLISTVER='                                      00070900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00071000
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00071100
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00071200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00071300
&XPLISTVER      SETA  0                                                 00071400
                AGO   .ZPVCKE                                           00071500
.*-------------------------------------------------------------------   00071600
.ZPVCK4A        ANOP  ,                                                 00071700
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00071800
&ZMS            SETC  'PLISTVER='                                       00071900
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00072000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00072100
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00072200
                MNOTE 8,' &ZMS IS REQUIRED.'                            00072300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00072400
                AGO   .ZPVCK5                                           00072500
.ZPVCK4         ANOP  ,                                                 00072600
&XPLISTVER      SETA  &PLISTVER(1)                                      00072700
.ZPVCK5         ANOP  ,                                                 00072800
.ZPVCKE         ANOP  ,                                                 00072900
.********************************************************************   00073000
.***AG.MF01 PROCESS MF MACRO FORMS                                      00073100
.********************************************************************   00073200
                ACTR  10000                                             00073300
.*------------------------------------------------------------------    00073400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00073500
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00073600
.*-------------------------------------------------------------------   00073700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00073800
.ZG42           ANOP  ,                                                 00073900
&ZTLC           SETC 'S'                                                00074000
                AIF   ('&MF(1)' NE '&ZTLC').ZG43                        00074100
&XMF            SETC  'S'         SET KEYWORD                           00074200
                AIF   (N'&MF LE 1).ZG42A        CK NUM                  00074300
&ZMS            SETC  '"MF='                                            00074400
&ZMS            SETC  '&ZMS.&MF"'                                       00074500
&ZMS            SETC  '&ZMS "MF"'                                       00074600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00074700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00074800
.ZG42A          ANOP  ,                                                 00074900
.*-------------------------------------------------------------------   00075000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075100
.ZG43           ANOP  ,                                                 00075200
&ZTLC           SETC 'L'                                                00075300
                AIF   ('&MF(1)' NE '&ZTLC').ZG50                        00075400
&XMF            SETC  'L'         SET KEYWORD                           00075500
                AIF   (N'&MF LE 3).ZG43A        CK NUM                  00075600
&ZMS            SETC  '"MF='                                            00075700
&ZMS            SETC  '&ZMS.&MF"'                                       00075800
&ZMS            SETC  '&ZMS "MF"'                                       00075900
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00076000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00076100
.ZG43A          ANOP  ,                                                 00076200
.*-------------------------------------------------------------------   00076300
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00076400
                AIF   (N'&SYSLIST NE 0).ZG43B   POSITIONALS?            00076500
                AIF   ('&BUFFADDR' NE '').ZG43B  KEYS?                  00076600
                AIF   ('&BUFFALET' NE '').ZG43B  KEYS?                  00076700
                AIF   ('&BUFFSTOKEN' NE '').ZG43B  KEYS?                00076800
                AIF   ('&BUFFLEN' NE '').ZG43B  KEYS?                   00076900
                AIF   ('&TOKEN' NE '').ZG43B    KEYS?                   00077000
                AIF   ('&TBWCADDR' NE '').ZG43B  KEYS?                  00077100
                AIF   ('&TBWCADDR64' NE '').ZG43B  KEYS?                00077200
                AIF   ('&TBWCALET' NE '').ZG43B  KEYS?                  00077300
                AIF   ('&SYNCH' NE '').ZG43B    KEYS?                   00077400
                AIF   ('&RC' NE '').ZG43B       KEYS?                   00077500
                AIF   ('&RSNCODE' NE '').ZG43B  KEYS?                   00077600
                AIF   ('&COM' NE '').ZG43B      KEYS?                   00077700
                AGO    .ZG43C     INVOCATION OKAY                       00077800
.ZG43B          ANOP  ,                                                 00077900
&ZMS            SETC  'THE "L" FORM OF "MF"'                            00078000
&ZMS            SETC  '&ZMS CAN ONLY HAVE'                              00078100
&ZMS            SETC  '&ZMS THE "PLISTVER" KEY'                         00078200
                MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'            00078300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00078400
.ZG43C          ANOP  ,                                                 00078500
.*-------------------------------------------------------------------   00078600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00078700
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00078800
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00078900
                AIF   (N'&MF(2) GT 1).ZG45B     MULTI PARMS             00079000
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00079100
.ZG45B          AIF   (K'&MF(2) GT 0).ZG45C                             00079200
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00079300
&ZMS            SETC  'WHEN "L" IS SPECIFIED'                           00079400
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00079500
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00079600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00079700
.ZG45C          ANOP  ,                                                 00079800
.*-------------------------------------------------------------------   00079900
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00080000
                AIF   (K'&ZXMFCTRL LE 0).ZG45P  NOT I/O                 00080100
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG45P                    00080200
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00080300
&ZMS            SETC  '"MF='                                            00080400
&ZMS            SETC  '&ZMS.&MF"'                                       00080500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00080600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00080700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00080800
.ZG45P          ANOP  ,                                                 00080900
.*-------------------------------------------------------------------   00081000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00081100
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00081200
&XMFATTR        SETC  '0D'                                              00081300
                AIF   (K'&MF(3) LE 0).ZG48B     PARM                    00081400
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00081500
                AIF   (N'&MF(3) GT 1).ZG48B     MULTI                   00081600
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00081700
.ZG48B          ANOP  ,                                                 00081800
.*-------------------------------------------------------------------   00081900
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00082000
                AIF   (K'&ZXMFATTR LE 0).ZG48P  NOT I/O                 00082100
                AIF   ('&XMFATTR'(1,1) NE '(').ZG48P                    00082200
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00082300
&ZMS            SETC  '"MF='                                            00082400
&ZMS            SETC  '&ZMS.&MF"'                                       00082500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00082600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00082700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00082800
.ZG48P          ANOP  ,                                                 00082900
.*-------------------------------------------------------------------   00083000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00083100
                AIF   (K'&ZXMFATTR LE 0).ZG48S  NOT I/O                 00083200
                AIF   (K'&XMFATTR LE 60).ZG48S  LNG OK                  00083300
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00083400
&ZMS            SETC  '"MF='                                            00083500
&ZMS            SETC  '&ZMS.&MF"'                                       00083600
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00083700
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00083800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00083900
.ZG48S          ANOP  ,                                                 00084000
.*-------------------------------------------------------------------   00084100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084200
.ZG50           ANOP  ,                                                 00084300
&ZTLC           SETC 'E'                                                00084400
                AIF   ('&MF(1)' NE '&ZTLC').ZG58                        00084500
&XMF            SETC  'E'         SET KEYWORD                           00084600
                AIF   (N'&MF LE 3).ZG50A        CK NUM                  00084700
&ZMS            SETC  '"MF='                                            00084800
&ZMS            SETC  '&ZMS.&MF"'                                       00084900
&ZMS            SETC  '&ZMS "MF"'                                       00085000
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00085100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00085200
.ZG50A          ANOP  ,                                                 00085300
.*-------------------------------------------------------------------   00085400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00085500
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00085600
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00085700
                AIF   (N'&MF(2) GT 1).ZG52B     MULTI PARMS             00085800
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00085900
.ZG52B          AIF   (K'&MF(2) GT 0).ZG52C                             00086000
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00086100
&ZMS            SETC  'WHEN "E" IS SPECIFIED'                           00086200
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00086300
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00086400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00086500
.ZG52C          ANOP  ,                                                 00086600
.*-------------------------------------------------------------------   00086700
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00086800
                AIF   (K'&ZXMFCTRL LE 0).ZG52R  NOT I/O                 00086900
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG52R                    00087000
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00087100
                AIF   ('&ZCGPR'(1,1) NE '0').ZG52P                      00087200
                AIF   (K'&ZCGPR GT 2).ZG52Q                             00087300
                AIF   ('&ZCGPR' EQ '0').ZG52Q                           00087400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00087500
                AIF   (T'&ZCGPR NE 'N').ZG52Q   INVALID REG NAME        00087600
.ZG52P          ANOP  ,                                                 00087700
                AIF   (T'&ZCGPR NE 'N').ZG52R   NON NUMERIC             00087800
                AIF   ('&ZCGPR' LT '1').ZG52Q                           00087900
                AIF   ('&ZCGPR' LE '12').ZG52R                          00088000
.ZG52Q          ANOP  ,                                                 00088100
&ZMS            SETC  '"MF='                                            00088200
&ZMS            SETC  '&ZMS.&MF"'                                       00088300
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00088400
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00088500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00088600
.ZG52R          ANOP  ,                                                 00088700
.*-------------------------------------------------------------------   00088800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00088900
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00089000
.ZG56A   AIF   ('&MF(3)' NE 'COMPLETE').ZG57A                           00089100
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00089200
.*-------------------------------------------------------------------   00089300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00089400
.ZG57A          AIF   (K'&XMFSCK GT 0).ZG57C    KEYWORD                 00089500
                AIF   (K'&MF(3) LE 0).ZG57B                             00089600
&ZMS            SETC  '"MF='                                            00089700
&ZMS            SETC  '&ZMS.&MF"'                                       00089800
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00089900
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00090000
&ZMS            SETC  '&ZMS "COMPLETE".'                                00090100
                MNOTE 8,' &ZMS '                                        00090200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00090300
.ZG57B          ANOP  ,                                                 00090400
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00090500
.ZG57C          ANOP  ,                                                 00090600
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00090700
.*------------------------------------------------------------------    00090800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090900
.ZG58           ANOP  ,                                                 00091000
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00091100
                AIF   (K'&XMF GT 0).ZG58E       VALID ARG               00091200
                AIF   (T'&MF EQ 'O').ZG58D      OMITTED                 00091300
&ZASYSLNDX      SETA  0                                                 00091400
.ZG58A          ANOP  ,           POSITIONAL MACRO KEY                  00091500
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00091600
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG58C                  00091700
&ZTLC           SETC 'MF'                                               00091800
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG58A         00091900
.ZG58B          ANOP  ,                                                 00092000
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00092100
&ZMS            SETC  'THE "MF" KEY'                                    00092200
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00092300
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00092400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00092500
                AGO   .ZG58E                                            00092600
.ZG58C          ANOP  ,                                                 00092700
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00092800
&ZMS            SETC  '"MF='                                            00092900
&ZMS            SETC  '&ZMS.&MF"'                                       00093000
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00093100
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00093200
&ZMS            SETC  '&ZMS "S",'                                       00093300
&ZMS            SETC  '&ZMS "L",'                                       00093400
&ZMS            SETC  '&ZMS OR "E".'                                    00093500
                MNOTE 8,' &ZMS '                                        00093600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00093700
                AGO   .ZG58E                                            00093800
.ZG58D          ANOP  ,                                                 00093900
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00094000
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00094100
.ZG58E          ANOP  ,                                                 00094200
.********************************************************************   00094300
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00094400
.********************************************************************   00094500
                ACTR  10000                                             00094600
.*-------------------------------------------------------------------   00094700
.***AG.MF03 MF=(SLE)                                                    00094800
                AIF   ('&XMF' EQ 'L').ZGMFX                             00094900
.*----------------------------------------------------------------***   00095000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00095100
                AIF   (N'&BUFFADDR LE 1).ZG2A   CK NUM                  00095200
&ZMS            SETC  '"BUFFADDR='                                      00095300
&ZMS            SETC  '&ZMS.&BUFFADDR"'                                 00095400
&ZMS            SETC  '&ZMS "BUFFADDR"'                                 00095500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00095600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00095700
.ZG2A           ANOP  ,                                                 00095800
.*-------------------------------------------------------------------   00095900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00096000
&ZXBUFFADDR     SETC  'INPUT'     SET IN/OUTPUT                         00096100
&XBUFFADDR      SETC  '&BUFFADDR(1)'            SET XVARIABLE           00096200
                AIF   (N'&BUFFADDR GT 1).ZG2B   MULTI PARMS             00096300
&XBUFFADDR      SETC  '&BUFFADDR'               SET XVARIABLE           00096400
.ZG2B           AIF   (K'&BUFFADDR(1) GT 0).ZG2C                        00096500
&ZXBUFFADDR     SETC  ''          RESET IN/OUTPUT                       00096600
&ZMS            SETC  ' '                                               00096700
&ZMS            SETC  '&ZMS "BUFFADDR" KEY AND ITS'                     00096800
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00096900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00097000
.ZG2C           ANOP  ,                                                 00097100
.*-------------------------------------------------------------------   00097200
.***AG.KCK01 NAME, RQD INPUT, KEYS -GPR NOT ALLOWED                     00097300
                AIF   (K'&ZXBUFFADDR LE 0).ZG2P  NOT I/O                00097400
                AIF   ('&XBUFFADDR'(1,1) NE '(').ZG2P                   00097500
&ZXBUFFADDR     SETC  ''          RESET IN/OUTPUT                       00097600
&ZMS            SETC  '"BUFFADDR='                                      00097700
&ZMS            SETC  '&ZMS.&BUFFADDR"'                                 00097800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00097900
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00098000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00098100
.ZG2P           ANOP  ,                                                 00098200
.*----------------------------------------------------------------***   00098300
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00098400
                AIF   (N'&BUFFALET LE 1).ZG4A   CK NUM                  00098500
&ZMS            SETC  '"BUFFALET='                                      00098600
&ZMS            SETC  '&ZMS.&BUFFALET"'                                 00098700
&ZMS            SETC  '&ZMS "BUFFALET"'                                 00098800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00098900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00099000
.ZG4A           ANOP  ,                                                 00099100
.*-------------------------------------------------------------------   00099200
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00099300
&XBUFFALET      SETC  'NOBUFFALET'              SET DEFAULT             00099400
                AIF   (K'&BUFFALET(1) LE 0).ZG4C  PARM                  00099500
&XBUFFALET      SETC  '&BUFFALET(1)'            SET XVARIABLE           00099600
                AIF   (N'&BUFFALET GT 1).ZG4B   MULTI PARMS             00099700
&XBUFFALET      SETC  '&BUFFALET'               SET XVARIABLE           00099800
.ZG4B           AIF   (K'&BUFFADDR(1) GT 0).ZG4C  KEY                   00099900
&ZMS            SETC  '"BUFFALET'                                       00100000
&ZMS            SETC  '&ZMS.=&BUFFALET"'                                00100100
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00100200
&ZMS            SETC  '&ZMS '                                           00100300
&ZMS            SETC  '&ZMS "BUFFADDR"'                                 00100400
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00100500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00100600
.ZG4C           ANOP  ,                                                 00100700
&ZXBUFFALET     SETC  'INPUT'     SET IN/OUTPUT                         00100800
.*-------------------------------------------------------------------   00100900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00101000
                AIF   (K'&ZXBUFFALET LE 0).ZG4R  NOT I/O                00101100
         AIF   ('&XBUFFALET' EQ 'NOBUFFALET').ZG4R                      00101200
                AIF   ('&XBUFFALET'(1,1) NE '(').ZG4R                   00101300
&ZCGPR          SETC  '&XBUFFALET'(2,K'&XBUFFALET-2)                    00101400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                       00101500
                AIF   (K'&ZCGPR GT 2).ZG4Q                              00101600
                AIF   ('&ZCGPR' EQ '0').ZG4Q                            00101700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00101800
                AIF   (T'&ZCGPR NE 'N').ZG4Q    INVALID REG NAME        00101900
.ZG4P           ANOP  ,                                                 00102000
                AIF   (T'&ZCGPR NE 'N').ZG4R    NON NUMERIC             00102100
                AIF   ('&ZCGPR' LT '2').ZG4Q                            00102200
                AIF   ('&ZCGPR' LE '12').ZG4R                           00102300
.ZG4Q           ANOP  ,                                                 00102400
&ZMS            SETC  '"BUFFALET='                                      00102500
&ZMS            SETC  '&ZMS.&BUFFALET"'                                 00102600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00102700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00102800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00102900
.ZG4R           ANOP  ,                                                 00103000
.*----------------------------------------------------------------***   00103100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00103200
                AIF   (N'&BUFFSTOKEN LE 1).ZG7A  CK NUM                 00103300
&ZMS            SETC  '"BUFFSTOKEN='                                    00103400
&ZMS            SETC  '&ZMS.&BUFFSTOKEN"'                               00103500
&ZMS            SETC  '&ZMS "BUFFSTOKEN"'                               00103600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00103700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00103800
.ZG7A           ANOP  ,                                                 00103900
.*-------------------------------------------------------------------   00104000
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00104100
&XBUFFSTOKEN    SETC  'BY_BUFFALET'             SET DEFAULT             00104200
                AIF   (K'&BUFFSTOKEN(1) LE 0).ZG7C  PARM                00104300
&XBUFFSTOKEN    SETC  '&BUFFSTOKEN(1)'          SET XVARIABLE           00104400
                AIF   (N'&BUFFSTOKEN GT 1).ZG7B  MULTI PARMS            00104500
&XBUFFSTOKEN    SETC  '&BUFFSTOKEN'             SET XVARIABLE           00104600
.ZG7B           AIF   (K'&BUFFADDR(1) GT 0).ZG7C  KEY                   00104700
&ZMS            SETC  '"BUFFSTOKEN'                                     00104800
&ZMS            SETC  '&ZMS.=&BUFFSTOKEN"'                              00104900
&ZMS            SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                   00105000
&ZMS            SETC  '&ZMS '                                           00105100
&ZMS            SETC  '&ZMS "BUFFADDR"'                                 00105200
                MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                      00105300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00105400
.ZG7C           ANOP  ,                                                 00105500
&ZXBUFFSTOKEN   SETC  'INPUT'     SET IN/OUTPUT                         00105600
.*-------------------------------------------------------------------   00105700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00105800
                AIF   (K'&ZXBUFFSTOKEN LE 0).ZG7R  NOT I/O              00105900
         AIF   ('&XBUFFSTOKEN' EQ 'BY_BUFFALET').ZG7R                   00106000
                AIF   ('&XBUFFSTOKEN'(1,1) NE '(').ZG7R                 00106100
&ZCGPR          SETC  '&XBUFFSTOKEN'(2,K'&XBUFFSTOKEN-2)                00106200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                       00106300
                AIF   (K'&ZCGPR GT 2).ZG7Q                              00106400
                AIF   ('&ZCGPR' EQ '0').ZG7Q                            00106500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00106600
                AIF   (T'&ZCGPR NE 'N').ZG7Q    INVALID REG NAME        00106700
.ZG7P           ANOP  ,                                                 00106800
                AIF   (T'&ZCGPR NE 'N').ZG7R    NON NUMERIC             00106900
                AIF   ('&ZCGPR' LT '2').ZG7Q                            00107000
                AIF   ('&ZCGPR' LE '12').ZG7R                           00107100
.ZG7Q           ANOP  ,                                                 00107200
&ZMS            SETC  '"BUFFSTOKEN='                                    00107300
&ZMS            SETC  '&ZMS.&BUFFSTOKEN"'                               00107400
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00107500
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00107600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00107700
.ZG7R           ANOP  ,                                                 00107800
.*----------------------------------------------------------------***   00107900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00108000
                AIF   (N'&BUFFLEN LE 1).ZG11A   CK NUM                  00108100
&ZMS            SETC  '"BUFFLEN='                                       00108200
&ZMS            SETC  '&ZMS.&BUFFLEN"'                                  00108300
&ZMS            SETC  '&ZMS "BUFFLEN"'                                  00108400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00108500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00108600
.ZG11A          ANOP  ,                                                 00108700
.*-------------------------------------------------------------------   00108800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00108900
&ZXBUFFLEN      SETC  'INPUT'     SET IN/OUTPUT                         00109000
&XBUFFLEN       SETC  '&BUFFLEN(1)'             SET XVARIABLE           00109100
                AIF   (N'&BUFFLEN GT 1).ZG11B   MULTI PARMS             00109200
&XBUFFLEN       SETC  '&BUFFLEN'  SET XVARIABLE                         00109300
.ZG11B          AIF   (K'&BUFFLEN(1) GT 0).ZG11C                        00109400
&ZXBUFFLEN      SETC  ''          RESET IN/OUTPUT                       00109500
&ZMS            SETC  ' '                                               00109600
&ZMS            SETC  '&ZMS "BUFFLEN" KEY AND ITS'                      00109700
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00109800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00109900
.ZG11C          ANOP  ,                                                 00110000
.*-------------------------------------------------------------------   00110100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00110200
                AIF   (K'&ZXBUFFLEN LE 0).ZG11R  NOT I/O                00110300
                AIF   ('&XBUFFLEN'(1,1) NE '(').ZG11R                   00110400
&ZCGPR          SETC  '&XBUFFLEN'(2,K'&XBUFFLEN-2)                      00110500
                AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                      00110600
                AIF   (K'&ZCGPR GT 2).ZG11Q                             00110700
                AIF   ('&ZCGPR' EQ '0').ZG11Q                           00110800
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00110900
                AIF   (T'&ZCGPR NE 'N').ZG11Q   INVALID REG NAME        00111000
.ZG11P          ANOP  ,                                                 00111100
                AIF   (T'&ZCGPR NE 'N').ZG11R   NON NUMERIC             00111200
                AIF   ('&ZCGPR' LT '2').ZG11Q                           00111300
                AIF   ('&ZCGPR' LE '12').ZG11R                          00111400
.ZG11Q          ANOP  ,                                                 00111500
&ZMS            SETC  '"BUFFLEN='                                       00111600
&ZMS            SETC  '&ZMS.&BUFFLEN"'                                  00111700
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00111800
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00111900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00112000
.ZG11R          ANOP  ,                                                 00112100
.*----------------------------------------------------------------***   00112200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00112300
                AIF   (N'&TOKEN LE 1).ZG14A     CK NUM                  00112400
&ZMS            SETC  '"TOKEN='                                         00112500
&ZMS            SETC  '&ZMS.&TOKEN"'                                    00112600
&ZMS            SETC  '&ZMS "TOKEN"'                                    00112700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00112800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00112900
.ZG14A          ANOP  ,                                                 00113000
.*-------------------------------------------------------------------   00113100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00113200
&ZXTOKEN        SETC  'INPUT'     SET IN/OUTPUT                         00113300
&XTOKEN         SETC  '&TOKEN(1)'               SET XVARIABLE           00113400
                AIF   (N'&TOKEN GT 1).ZG14B     MULTI PARMS             00113500
&XTOKEN         SETC  '&TOKEN'    SET XVARIABLE                         00113600
.ZG14B          AIF   (K'&TOKEN(1) GT 0).ZG14C                          00113700
&ZXTOKEN        SETC  ''          RESET IN/OUTPUT                       00113800
&ZMS            SETC  ' '                                               00113900
&ZMS            SETC  '&ZMS "TOKEN" KEY AND ITS'                        00114000
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00114100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00114200
.ZG14C          ANOP  ,                                                 00114300
.*-------------------------------------------------------------------   00114400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00114500
                AIF   (K'&ZXTOKEN LE 0).ZG14R   NOT I/O                 00114600
                AIF   ('&XTOKEN'(1,1) NE '(').ZG14R                     00114700
&ZCGPR          SETC  '&XTOKEN'(2,K'&XTOKEN-2)                          00114800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                      00114900
                AIF   (K'&ZCGPR GT 2).ZG14Q                             00115000
                AIF   ('&ZCGPR' EQ '0').ZG14Q                           00115100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00115200
                AIF   (T'&ZCGPR NE 'N').ZG14Q   INVALID REG NAME        00115300
.ZG14P          ANOP  ,                                                 00115400
                AIF   (T'&ZCGPR NE 'N').ZG14R   NON NUMERIC             00115500
                AIF   ('&ZCGPR' LT '2').ZG14Q                           00115600
                AIF   ('&ZCGPR' LE '12').ZG14R                          00115700
.ZG14Q          ANOP  ,                                                 00115800
&ZMS            SETC  '"TOKEN='                                         00115900
&ZMS            SETC  '&ZMS.&TOKEN"'                                    00116000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00116100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00116200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00116300
.ZG14R          ANOP  ,                                                 00116400
.*----------------------------------------------------------------***   00116500
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00116600
&XDUMMY1        SETC  ''          INITIALIZE XVARIABLE                  00116700
                AIF   (K'&TBWCADDR LE 0).ZG17C                          00116800
&ZXDUMMY1       SETC  'INPUT'     SET IN/OUTPUT                         00116900
&XDUMMY1        SETC  'TBWCADDR'  SET XVARIABLE                         00117000
&ZXTBWCADDR     SETC  'INPUT'     SET IN/OUTPUT                         00117100
&XTBWCADDR      SETC  '&TBWCADDR(1)'            SET XVARIABLE PARM      00117200
                AIF   (N'&TBWCADDR GT 1).ZG17A                          00117300
&XTBWCADDR      SETC  '&TBWCADDR'               SET XVARIABLE PARM      00117400
.ZG17A          AIF   (N'&TBWCADDR LE 1).ZG17B  CK NUM                  00117500
&ZMS            SETC  '"TBWCADDR='                                      00117600
&ZMS            SETC  '&ZMS.&TBWCADDR"'                                 00117700
&ZMS            SETC  '&ZMS "TBWCADDR"'                                 00117800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00117900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00118000
.ZG17B          AIF   (K'&XTBWCADDR GT 0).ZG17C  ONE PARM               00118100
&ZXDUMMY1       SETC  ''          RESET IN/OUTPUT                       00118200
&ZXTBWCADDR     SETC  ''          RESET IN/OUTPUT                       00118300
&ZMS            SETC  ' '                                               00118400
&ZMS            SETC  '&ZMS "TBWCADDR" KEY AND ITS'                     00118500
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00118600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00118700
.ZG17C          ANOP  ,                                                 00118800
.*----------------------------------------------------------------***   00118900
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00119000
                AIF   (K'&TBWCADDR64 LE 0).ZG18D  NO ME KEY             00119100
                AIF   (N'&TBWCADDR64 LE 1).ZG18A  CK NUM                00119200
&ZMS            SETC  '"TBWCADDR64='                                    00119300
&ZMS            SETC  '&ZMS.&TBWCADDR64"'                               00119400
&ZMS            SETC  '&ZMS "TBWCADDR64"'                               00119500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00119600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00119700
.ZG18A          AIF   (K'&XDUMMY1 LE 0).ZG18B                           00119800
&ZMS            SETC  '"TBWCADDR64'                                     00119900
&ZMS            SETC  '&ZMS.=&TBWCADDR64"'                              00120000
&ZMS            SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'             00120100
&ZMS            SETC  '&ZMS "&XDUMMY1"'                                 00120200
                MNOTE 8,' &ZMS KEY.'                                    00120300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00120400
                AGO   .ZG18D                                            00120500
.*                                                                      00120600
.ZG18B          ANOP  ,                                                 00120700
&ZXDUMMY1       SETC  'INPUT'     SET IN/OUTPUT                         00120800
&XDUMMY1        SETC  'TBWCADDR64'              SET XVARIABLE           00120900
&ZXTBWCADDR64   SETC  'INPUT'     SET IN/OUTPUT                         00121000
&XTBWCADDR64    SETC  '&TBWCADDR64(1)'          SET XVARIABLE PARM      00121100
                AIF   (N'&TBWCADDR64 GT 1).ZG18C                        00121200
&XTBWCADDR64    SETC  '&TBWCADDR64'             SET XVARIABLE PARM      00121300
.ZG18C          AIF   (K'&XTBWCADDR64 GT 0).ZG18D  ONE PARM             00121400
&ZXDUMMY1       SETC  ''          RESET IN/OUTPUT                       00121500
&ZXTBWCADDR64   SETC  ''          RESET IN/OUTPUT                       00121600
&ZMS            SETC  ' '                                               00121700
&ZMS            SETC  '&ZMS "TBWCADDR64" KEY AND ITS'                   00121800
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00121900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00122000
.ZG18D          ANOP  ,                                                 00122100
.*------------------------------------------------------------------    00122200
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00122300
                AIF   (K'&XDUMMY1 GT 0).ZG19B                           00122400
&ZXDUMMY1       SETC  ''          RESET IN/OUTPUT                       00122500
&ZXTBWCADDR     SETC  ''          RESET IN/OUTPUT                       00122600
&XDUMMY1        SETC  ''          ENSURE NULL                           00122700
&XTBWCADDR      SETC  ''          ENSURE NULL                           00122800
&ZMS            SETC  'ONE OF THE FOLLOWING'                            00122900
&ZMS            SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'               00123000
&ZMS            SETC  '&ZMS REQUIRED:'                                  00123100
&ZMS            SETC  '&ZMS "TBWCADDR"'         VALID ME KEY            00123200
&ZMS            SETC  '&ZMS OR "TBWCADDR64".'   VALID ME KEY            00123300
                MNOTE 8,' &ZMS '                                        00123400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00123500
.ZG19B          ANOP  ,                                                 00123600
.*-------------------------------------------------------------------   00123700
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00123800
.ZG17ZY  AIF    ('&XDUMMY1' NE 'TBWCADDR').ZG18ZY                       00123900
.*-------------------------------------------------------------------   00124000
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00124100
                AIF   (K'&ZXTBWCADDR LE 0).ZG17R  NOT I/O               00124200
                AIF   ('&XTBWCADDR'(1,1) NE '(').ZG17R                  00124300
&ZCGPR          SETC  '&XTBWCADDR'(2,K'&XTBWCADDR-2)                    00124400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                      00124500
                AIF   (K'&ZCGPR GT 2).ZG17Q                             00124600
                AIF   ('&ZCGPR' EQ '0').ZG17Q                           00124700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00124800
                AIF   (T'&ZCGPR NE 'N').ZG17Q   INVALID REG NAME        00124900
.ZG17P          ANOP  ,                                                 00125000
                AIF   (T'&ZCGPR NE 'N').ZG17R   NON NUMERIC             00125100
                AIF   ('&ZCGPR' LT '2').ZG17Q                           00125200
                AIF   ('&ZCGPR' LE '12').ZG17R                          00125300
.ZG17Q          ANOP  ,                                                 00125400
&ZMS            SETC  '"TBWCADDR='                                      00125500
&ZMS            SETC  '&ZMS.&TBWCADDR"'                                 00125600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00125700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00125800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00125900
.ZG17R          ANOP  ,                                                 00126000
.*-------------------------------------------------------------------   00126100
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00126200
.ZG18ZY  AIF    ('&XDUMMY1' NE 'TBWCADDR64').ZG19ZY                     00126300
.*-------------------------------------------------------------------   00126400
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00126500
                AIF   (K'&ZXTBWCADDR64 LE 0).ZG18R  NOT I/O             00126600
                AIF   ('&XTBWCADDR64'(1,1) NE '(').ZG18R                00126700
&ZCGPR          SETC  '&XTBWCADDR64'(2,K'&XTBWCADDR64-2)                00126800
                AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                      00126900
                AIF   (K'&ZCGPR GT 2).ZG18Q                             00127000
                AIF   ('&ZCGPR' EQ '0').ZG18Q                           00127100
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00127200
                AIF   (T'&ZCGPR NE 'N').ZG18Q   INVALID REG NAME        00127300
.ZG18P          ANOP  ,                                                 00127400
                AIF   (T'&ZCGPR NE 'N').ZG18R   NON NUMERIC             00127500
                AIF   ('&ZCGPR' LT '2').ZG18Q                           00127600
                AIF   ('&ZCGPR' LE '12').ZG18R                          00127700
.ZG18Q          ANOP  ,                                                 00127800
&ZMS            SETC  '"TBWCADDR64='                                    00127900
&ZMS            SETC  '&ZMS.&TBWCADDR64"'                               00128000
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00128100
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00128200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00128300
.ZG18R          ANOP  ,                                                 00128400
.*-------------------------------------------------------------------   00128500
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00128600
.ZG19ZY         ANOP ,            END MUTUALLY EXCLUSIVE KEYS           00128700
.*----------------------------------------------------------------***   00128800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00128900
                AIF   (N'&TBWCALET LE 1).ZG21A  CK NUM                  00129000
&ZMS            SETC  '"TBWCALET='                                      00129100
&ZMS            SETC  '&ZMS.&TBWCALET"'                                 00129200
&ZMS            SETC  '&ZMS "TBWCALET"'                                 00129300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00129400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00129500
.ZG21A          ANOP  ,                                                 00129600
.*-------------------------------------------------------------------   00129700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00129800
&ZXTBWCALET     SETC  'INPUT'     SET IN/OUTPUT                         00129900
&XTBWCALET      SETC  'NOTBWCALET'                                      00130000
                AIF   (K'&TBWCALET(1) LE 0).ZG21B  PARM                 00130100
&XTBWCALET      SETC  '&TBWCALET(1)'            SET XVARIABLE           00130200
                AIF   (N'&TBWCALET GT 1).ZG21B  MULTI                   00130300
&XTBWCALET      SETC  '&TBWCALET'               SET XVARIABLE           00130400
.ZG21B          ANOP  ,                                                 00130500
.*-------------------------------------------------------------------   00130600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00130700
                AIF   (K'&ZXTBWCALET LE 0).ZG21R  NOT I/O               00130800
         AIF   ('&XTBWCALET' EQ 'NOTBWCALET').ZG21R                     00130900
                AIF   ('&XTBWCALET'(1,1) NE '(').ZG21R                  00131000
&ZCGPR          SETC  '&XTBWCALET'(2,K'&XTBWCALET-2)                    00131100
                AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                      00131200
                AIF   (K'&ZCGPR GT 2).ZG21Q                             00131300
                AIF   ('&ZCGPR' EQ '0').ZG21Q                           00131400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00131500
                AIF   (T'&ZCGPR NE 'N').ZG21Q   INVALID REG NAME        00131600
.ZG21P          ANOP  ,                                                 00131700
                AIF   (T'&ZCGPR NE 'N').ZG21R   NON NUMERIC             00131800
                AIF   ('&ZCGPR' LT '2').ZG21Q                           00131900
                AIF   ('&ZCGPR' LE '12').ZG21R                          00132000
.ZG21Q          ANOP  ,                                                 00132100
&ZMS            SETC  '"TBWCALET='                                      00132200
&ZMS            SETC  '&ZMS.&TBWCALET"'                                 00132300
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00132400
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00132500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00132600
.ZG21R          ANOP  ,                                                 00132700
.*----------------------------------------------------------------***   00132800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00132900
                AIF   (N'&SYNCH LE 1).ZG24A     CK NUM                  00133000
&ZMS            SETC  '"SYNCH='                                         00133100
&ZMS            SETC  '&ZMS.&SYNCH"'                                    00133200
&ZMS            SETC  '&ZMS "SYNCH"'                                    00133300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00133400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00133500
.ZG24A          ANOP  ,                                                 00133600
.*-------------------------------------------------------------------   00133700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00133800
&XSYNCH         SETC  ''          INITIALIZE XVARIABLE                  00133900
.ZG25A   AIF   ('&SYNCH(1)' NE 'NO').ZG26A                              00134000
&XSYNCH         SETC  'NO'        SET KEYWORD                           00134100
.*-------------------------------------------------------------------   00134200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00134300
.ZG26A   AIF   ('&SYNCH(1)' NE 'YES').ZG27A                             00134400
&XSYNCH         SETC  'YES'       SET KEYWORD                           00134500
.*-------------------------------------------------------------------   00134600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00134700
.ZG27A          AIF   (K'&XSYNCH GT 0).ZG27C    KEYWORD                 00134800
                AIF   (K'&SYNCH(1) LE 0).ZG27B                          00134900
&ZMS            SETC  '"SYNCH='                                         00135000
&ZMS            SETC  '&ZMS.&SYNCH"'                                    00135100
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00135200
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00135300
&ZMS            SETC  '&ZMS "NO"'                                       00135400
&ZMS            SETC  '&ZMS OR "YES".'                                  00135500
                MNOTE 8,' &ZMS '                                        00135600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00135700
.ZG27B          ANOP  ,                                                 00135800
&XSYNCH         SETC  'NO'        SET DEFAULT KEYWORD                   00135900
.ZG27C          ANOP  ,                                                 00136000
&ZXSYNCH        SETC  'INPUT'     SET IN/OUTPUT                         00136100
.*----------------------------------------------------------------***   00136200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00136300
                AIF   (N'&RC LE 1).ZG29A        CK NUM                  00136400
&ZMS            SETC  '"RC='                                            00136500
&ZMS            SETC  '&ZMS.&RC"'                                       00136600
&ZMS            SETC  '&ZMS "RC"'                                       00136700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00136800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00136900
.ZG29A          ANOP  ,                                                 00137000
.*-------------------------------------------------------------------   00137100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00137200
                AIF   (K'&RC(1) LE 0).ZG29C     NO PARM                 00137300
&ZXRC           SETC  'OUTPUT'    SET OUTPUT                            00137400
&XRC            SETC  '&RC(1)'    SET XVARIABLE                         00137500
                AIF   (N'&RC GT 1).ZG29C                                00137600
&XRC            SETC  '&RC'       SET XVARIABLE                         00137700
.ZG29C          ANOP  ,                                                 00137800
.*-------------------------------------------------------------------   00137900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00138000
                AIF   (K'&ZXRC LE 0).ZG29R      NOT I/O                 00138100
                AIF   ('&XRC'(1,1) NE '(').ZG29R                        00138200
&ZCGPR          SETC  '&XRC'(2,K'&XRC-2)                                00138300
                AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                      00138400
                AIF   (K'&ZCGPR GT 2).ZG29Q                             00138500
                AIF   ('&ZCGPR' EQ '0').ZG29Q                           00138600
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00138700
                AIF   (T'&ZCGPR NE 'N').ZG29Q   INVALID REG NAME        00138800
.ZG29P          ANOP  ,                                                 00138900
                AIF   (T'&ZCGPR NE 'N').ZG29R   NON NUMERIC             00139000
                AIF   ('&ZCGPR' EQ '15').ZG29R                          00139100
                AIF   ('&ZCGPR' LT '2').ZG29Q                           00139200
                AIF   ('&ZCGPR' LE '12').ZG29R                          00139300
.ZG29Q          ANOP  ,                                                 00139400
&ZMS            SETC  '"RC='                                            00139500
&ZMS            SETC  '&ZMS.&RC"'                                       00139600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00139700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'          00139800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00139900
.ZG29R          ANOP  ,                                                 00140000
.*----------------------------------------------------------------***   00140100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00140200
                AIF   (N'&RSNCODE LE 1).ZG32A   CK NUM                  00140300
&ZMS            SETC  '"RSNCODE='                                       00140400
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00140500
&ZMS            SETC  '&ZMS "RSNCODE"'                                  00140600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00140700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00140800
.ZG32A          ANOP  ,                                                 00140900
.*-------------------------------------------------------------------   00141000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00141100
                AIF   (K'&RSNCODE(1) LE 0).ZG32C  NO PARM               00141200
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            00141300
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           00141400
                AIF   (N'&RSNCODE GT 1).ZG32C                           00141500
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         00141600
.ZG32C          ANOP  ,                                                 00141700
.*-------------------------------------------------------------------   00141800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00141900
                AIF   (K'&ZXRSNCODE LE 0).ZG32R  NOT I/O                00142000
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG32R                   00142100
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      00142200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                      00142300
                AIF   (K'&ZCGPR GT 2).ZG32Q                             00142400
                AIF   ('&ZCGPR' EQ '0').ZG32R                           00142500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00142600
                AIF   (T'&ZCGPR NE 'N').ZG32Q   INVALID REG NAME        00142700
.ZG32P          ANOP  ,                                                 00142800
                AIF   (T'&ZCGPR NE 'N').ZG32R   NON NUMERIC             00142900
                AIF   ('&ZCGPR' EQ '0').ZG32R                           00143000
                AIF   ('&ZCGPR' LT '2').ZG32Q                           00143100
                AIF   ('&ZCGPR' LE '12').ZG32R                          00143200
.ZG32Q          ANOP  ,                                                 00143300
&ZMS            SETC  '"RSNCODE='                                       00143400
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00143500
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00143600
                MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'           00143700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00143800
.ZG32R          ANOP  ,                                                 00143900
.*----------------------------------------------------------------***   00144000
.***AG.KXVAR05 VALUE, OPT INPUT, KEYS -XVARIABLE KEY                    00144100
                AIF   (N'&COM LE 1).ZG35A       CK NUM                  00144200
&ZMS            SETC  '"COM='                                           00144300
&ZMS            SETC  '&ZMS.&COM"'                                      00144400
&ZMS            SETC  '&ZMS "COM"'                                      00144500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00144600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00144700
.ZG35A          ANOP  ,                                                 00144800
.*-------------------------------------------------------------------   00144900
.***AG.KXVAR13 VALUE, OPT INPUT, KEYS -XVARIABLE                        00145000
&ZXCOM          SETC  'INPUT'     SET IN/OUTPUT                         00145100
&XCOM           SETC  'NULL'                                            00145200
                AIF   (K'&COM(1) LE 0).ZG35B    PARM                    00145300
&XCOM           SETC  '&COM(1)'   SET XVARIABLE                         00145400
                AIF   (N'&COM GT 1).ZG35B       MULTI                   00145500
&XCOM           SETC  '&COM'      SET XVARIABLE                         00145600
.ZG35B          ANOP  ,                                                 00145700
.*-------------------------------------------------------------------   00145800
.***AG.KCK01 VALUE, OPT INPUT, KEYS -GPR NOT ALLOWED                    00145900
                AIF   (K'&ZXCOM LE 0).ZG35P     NOT I/O                 00146000
                AIF   ('&XCOM' EQ 'NULL').ZG35P                         00146100
                AIF   ('&XCOM'(1,1) NE '(').ZG35P                       00146200
&ZXCOM          SETC  ''          RESET IN/OUTPUT                       00146300
&ZMS            SETC  '"COM='                                           00146400
&ZMS            SETC  '&ZMS.&COM"'                                      00146500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00146600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00146700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00146800
.ZG35P          ANOP  ,                                                 00146900
.*-------------------------------------------------------------------   00147000
.***AG.KCK03 VALUE, OPT INPUT, KEYS -CHARACTER LENGTH                   00147100
                AIF   (K'&ZXCOM LE 0).ZG35S     NOT I/O                 00147200
                AIF   ('&XCOM' EQ 'NULL').ZG35S                         00147300
                AIF   (K'&XCOM LE 256).ZG35S    LNG OK                  00147400
&ZXCOM          SETC  ''          RESET IN/OUTPUT                       00147500
&ZMS            SETC  '"COM='                                           00147600
&ZMS            SETC  '&ZMS.&COM"'                                      00147700
&ZMS            SETC  '&ZMS ARGUMENT 1 EXCEEDS THE MAXIMUM'             00147800
                MNOTE 8,' &ZMS LENGTH OF 256 CHARACTERS.'               00147900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00148000
.ZG35S          ANOP  ,                                                 00148100
.******************************************************************     00148200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00148300
.******************************************************************     00148400
                ACTR  10000                                             00148500
.*----------------------------------------------------------------***   00148600
.***AH.P02 EXTRA POSITIONALS                                            00148700
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00148800
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00148900
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00149000
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00149100
.ZGLISTX1       ANOP  ,                                                 00149200
&ZCVAL          SETC  ''          ERROR FIELD                           00149300
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00149400
.ZGLIST2        ANOP  ,                                                 00149500
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00149600
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00149700
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00149800
                AGO   .ZGLIST2                                          00149900
.*                                                                      00150000
.ZGLIST3        ANOP  ,                                                 00150100
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00150200
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'                         00150300
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00150400
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00150500
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00150600
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00150700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00150800
.ZGLISTX        ANOP  ,                                                 00150900
&ZASYSLNDX      SETA  0                                                 00151000
.*-------------------------------------------------------------------   00151100
.***AG.MF04 MF=(SLE)                                                    00151200
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00151300
.*******************************************************************    00151400
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00151500
.*******************************************************************    00151600
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00151700
.*******************************************************************    00151800
.***AE.01  START OF ITTWRITE MACRO CODE                                 00151900
.*******************************************************************    00152000
                LCLC  &M0M0001                 NAME                     00152100
&M0M0001        SETC  '&XLABEL'                SET NAME                 00152200
                AIF   (K'&XLABEL NE 0).XLAB2                            00152300
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00152400
.*                                                                      00152500
.XLAB2          ANOP  ,                                                 00152600
                AIF   ('&XMF' EQ 'L').XLAB3                             00152700
&M0M0001 DS    0H                             ITTWRITE-0                00152800
.XLAB3          ANOP  ,                                                 00152900
.*******************************************************************    00153000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00153100
.*******************************************************************    00153200
              PUSH  PRINT                                               00153300
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00153400
                PRINT OFF         ++ PR01                               00153500
                AGO   .ZPRNTXX                                          00153600
.ZPRINTX        PRINT ON                                                00153700
.ZPRNTXX        ANOP  ,                                                 00153800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00153900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00154000
.********************************************************************   00154100
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00154200
.********************************************************************   00154300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00154400
                      LCLA  &ZOPN1         INVOCATION INDEX             00154500
                      LCLC  &ZOPL(4095)    LABEL                        00154600
                      LCLC  &ZOPO(4095)    OPERATION                    00154700
                      LCLC  &ZOPV(4095)    VALUE                        00154800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00154900
.*                                                                      00155000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00155100
.******************************************************************     00155200
.***AL.L10 ITTWRITE FMT=LIST MF=S!L PARAMETERS                          00155300
.******************************************************************     00155400
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00155500
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00155600
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00155700
&XMFATTR              SETC  '0D'                                        00155800
.*                                                                      00155900
&ZOPN                 SETA  &ZOPN+1                                     00156000
&ZOPL(&ZOPN)          SETC  ' '                                         00156100
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00156200
&ZOPO(&ZOPN)          SETC  'B'                                         00156300
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00156400
                      AGO   .ZALVL6B                                    00156500
.ZALVL6A              ANOP                                              00156600
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00156700
&ZOPV(&ZOPN)          SETC  '4,8'                                       00156800
&ZOPN                 SETA  &ZOPN+1                                     00156900
&ZOPL(&ZOPN)          SETC  ' '                                         00157000
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00157100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00157200
.ZALVL6B              ANOP                                              00157300
&ZOPD(&ZOPN)          SETC  '++ ITTWRITE ARG PARMS'                     00157400
.*                                                                      00157500
&ZOPN                 SETA  &ZOPN+1                                     00157600
&ZOPL(&ZOPN)          SETC  ' '                                         00157700
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00157800
&ZOPV(&ZOPN)          SETC  '1'                                         00157900
&ZOPD(&ZOPN)          SETC  ' '                                         00158000
.*                                                                      00158100
.ZLMFSL2              ANOP  ,                                           00158200
.*-------------------------------------------------------------------   00158300
.***AM.L00  ITTWRITE FMT=LIST name                                      00158400
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00158500
&ZOPN                 SETA &ZOPN+1                                      00158600
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00158700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00158800
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00158900
&ZOPD(&ZOPN)          SETC '++ ITTWRITE NAME'                           00159000
.ZLMFSL2M             ANOP  ,                                           00159100
.*-------------------------------------------------------------------   00159200
.***AM.L01  ITTWRITE FMT=LIST PARAMETERS                                00159300
&ZOPN                 SETA &ZOPN+1                                      00159400
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00159500
&ZOPO(&ZOPN)          SETC 'DS'                                         00159600
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00159700
&ZOPD(&ZOPN)          SETC '++ ITTWRITE PARM LIST'                      00159800
.*-------------------------------------------------------------------   00159900
.***AM.L02 XVERSION XL1                                                 00160000
&ZOPN                 SETA &ZOPN+1                                      00160100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00160200
&ZOPO(&ZOPN)          SETC 'DS'                                         00160300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00160400
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00160500
.*-------------------------------------------------------------------   00160600
.***AM.L03 XFLAGS BL.8                                                  00160700
&ZOPN                 SETA &ZOPN+1                                      00160800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00160900
&ZOPO(&ZOPN)          SETC 'DS'                                         00161000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00161100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00161200
.*                                                                      00161300
&ZOPN                 SETA  &ZOPN+1                                     00161400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSYNCH_YES'                      00161500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00161600
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00161700
&ZOPD(&ZOPN)          SETC  '++ XSYNCH.'                                00161800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00161900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00162000
.*                                                                      00162100
&ZOPN                 SETA  &ZOPN+1                                     00162200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_BUFFSTOKEN'              00162300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00162400
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00162500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00162600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).BUFFSTOKEN'                   00162700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00162800
.*-------------------------------------------------------------------   00162900
.***AM.L09  XRSV0000 CL2                                                00163000
&ZOPN                 SETA &ZOPN+1                                      00163100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0000'                         00163200
&ZOPO(&ZOPN)          SETC 'DS'                                         00163300
&ZOPV(&ZOPN)          SETC 'CL2'                                        00163400
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00163500
.*-------------------------------------------------------------------   00163600
.***AM.L09  XBUFFALET CL4                                               00163700
&ZOPN                 SETA &ZOPN+1                                      00163800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFALET'                        00163900
&ZOPO(&ZOPN)          SETC 'DS'                                         00164000
&ZOPV(&ZOPN)          SETC 'CL4'                                        00164100
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFALET '                            00164200
.*-------------------------------------------------------------------   00164300
.***AM.L09  XBUFFADDR AD                                                00164400
&ZOPN                 SETA &ZOPN+1                                      00164500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFADDR'                        00164600
&ZOPO(&ZOPN)          SETC 'DS'                                         00164700
&ZOPV(&ZOPN)          SETC 'AD'                                         00164800
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFADDR '                            00164900
.*-------------------------------------------------------------------   00165000
.***AM.L09  XBUFFLEN D                                                  00165100
&ZOPN                 SETA &ZOPN+1                                      00165200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFLEN'                         00165300
&ZOPO(&ZOPN)          SETC 'DS'                                         00165400
&ZOPV(&ZOPN)          SETC 'D'                                          00165500
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFLEN '                             00165600
.*-------------------------------------------------------------------   00165700
.***AM.L09  XTOKEN CL8                                                  00165800
&ZOPN                 SETA &ZOPN+1                                      00165900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTOKEN'                           00166000
&ZOPO(&ZOPN)          SETC 'DS'                                         00166100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00166200
&ZOPD(&ZOPN)          SETC '++ &ZXTOKEN '                               00166300
.*-------------------------------------------------------------------   00166400
.***AM.L09  XTBWCADDR A                                                 00166500
&ZOPN                 SETA &ZOPN+1                                      00166600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTBWCADDR'                        00166700
&ZOPO(&ZOPN)          SETC 'DS'                                         00166800
&ZOPV(&ZOPN)          SETC 'A'                                          00166900
&ZOPD(&ZOPN)          SETC '++ &ZXTBWCADDR '                            00167000
.*-------------------------------------------------------------------   00167100
.***AM.L09  XTBWCALET CL4                                               00167200
&ZOPN                 SETA &ZOPN+1                                      00167300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTBWCALET'                        00167400
&ZOPO(&ZOPN)          SETC 'DS'                                         00167500
&ZOPV(&ZOPN)          SETC 'CL4'                                        00167600
&ZOPD(&ZOPN)          SETC '++ &ZXTBWCALET '                            00167700
.*-------------------------------------------------------------------   00167800
.***AM.L09  XBUFFSTOKEN CL8                                             00167900
&ZOPN                 SETA &ZOPN+1                                      00168000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFSTOKEN'                      00168100
&ZOPO(&ZOPN)          SETC 'DS'                                         00168200
&ZOPV(&ZOPN)          SETC 'CL8'                                        00168300
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFSTOKEN '                          00168400
.*-------------------------------------------------------------------   00168500
.***AM.L09  XTBWCADDR64 AD                                              00168600
&ZOPN                 SETA &ZOPN+1                                      00168700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTBWCADDR64'                      00168800
&ZOPO(&ZOPN)          SETC 'DS'                                         00168900
&ZOPV(&ZOPN)          SETC 'AD'                                         00169000
&ZOPD(&ZOPN)          SETC '++ &ZXTBWCADDR64 '                          00169100
.*-------------------------------------------------------------------   00169200
.***AM.L10 END OF ITTWRITE LIST PARAMETERS                              00169300
&ZOPN                 SETA &ZOPN+1                                      00169400
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00169500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00169600
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00169700
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00169800
.*                                                                      00169900
&ZOPN                 SETA &ZOPN+1                                      00170000
&ZOPL(&ZOPN)          SETC ' '                                          00170100
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00170200
&ZOPV(&ZOPN)          SETC '1'                                          00170300
&ZOPD(&ZOPN)          SETC ' '                                          00170400
.*-------------------------------------------------------------------   00170500
.***AL.L12 ITTWRITE FMT=LIST MF=S!L PARAMETERS                          00170600
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00170700
.*                                                                      00170800
&ZOPN                 SETA  &ZOPN+1                                     00170900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00171000
&ZOPO(&ZOPN)          SETC  'DC'                                        00171100
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00171200
&ZOPD(&ZOPN)          SETC  '++ ITTWRITE ARG PARMS'                     00171300
.*                                                                      00171400
.ZLMFSLX              ANOP  ,                                           00171500
.*-------------------------------------------------------------------   00171600
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00171700
&ZPLLEN               SETA 56                                           00171800
.*                                                                      00171900
.******************************************************************     00172000
.***AI.L01 ITTWRITE FMT=LIST FILL IN PARAMETER AREA                     00172100
.******************************************************************     00172200
                      ACTR  10000                                       00172300
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00172400
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00172500
&ZCVAL                SETC  'LAE'          XAX MODE                     00172600
.ZIMFXA               ANOP ,                                            00172700
.*                                                                      00172800
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00172900
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00173000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00173100
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00173200
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00173300
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00173400
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00173500
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00173600
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00173700
&ZOPN                 SETA  &ZOPN+1                                     00173800
&ZOPL(&ZOPN)          SETC  ' '                                         00173900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00174000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00174100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00174200
                      AGO   .ZIMFNX                                     00174300
.*                                                                      00174400
.ZIMFN2               ANOP ,                                            00174500
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00174600
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00174700
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00174800
&ZOPN                 SETA  &ZOPN+1                                     00174900
&ZOPL(&ZOPN)          SETC  ' '                                         00175000
&ZOPO(&ZOPN)          SETC  'LAE'                                       00175100
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00175200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00175300
                      AGO   .ZIMFNX                                     00175400
.ZIMFNX1              ANOP ,                                            00175500
&ZOPN                 SETA  &ZOPN+1                                     00175600
&ZOPL(&ZOPN)          SETC  ' '                                         00175700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00175800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00175900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00176000
.ZIMFNX               ANOP ,                                            00176100
.********************************************************************   00176200
.***AI.L02 ITTWRITE FMT=LIST INITIALIZE PARAMETER AREA                  00176300
.********************************************************************   00176400
.***AI.L03 MF=(SLE)                                                     00176500
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00176600
.*                                                                      00176700
&ZOPN                 SETA  &ZOPN+1                                     00176800
&ZOPL(&ZOPN)          SETC  ' '                                         00176900
&ZOPO(&ZOPN)          SETC  'XC'                                        00177000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00177100
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00177200
.ZIMFLX               ANOP  ,                                           00177300
.*-------------------------------------------------------------------   00177400
.***AI.L05 XFLAGS BL1                                                   00177500
&ZW                   SETC  ''                                          00177600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00177700
.*-------------------------------------------------------------------   00177800
.***AI.L08 XFLAGS "YES"                                                 00177900
.***      BL1'1XXXXXXX'                                                 00178000
         AIF   ('&XSYNCH' NE 'YES').ZI3A                                00178100
&ZW                   SETC  '&ZW.1'                                     00178200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00178300
                      AGO   .ZI3C                                       00178400
.*                                                                      00178500
.ZI3A                 ANOP  ,                                           00178600
&ZW                   SETC  '&ZW.0'                                     00178700
.ZI3C                 ANOP  ,                                           00178800
.*-------------------------------------------------------------------   00178900
.***AI.L08 XFLAGS "BUFFSTOKEN"                                          00179000
.***      BL1'X1XXXXXX'                                                 00179100
         AIF   ('&BUFFSTOKEN' EQ '').ZI4A                               00179200
&ZW                   SETC  '&ZW.1000000'                               00179300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00179400
                      AGO   .ZI4C                                       00179500
.*                                                                      00179600
.ZI4A                 ANOP  ,                                           00179700
&ZW                   SETC  '&ZW.0000000'                               00179800
.ZI4C                 ANOP  ,                                           00179900
.*-------------------------------------------------------------------   00180000
.***AI.L11 XFLAGS BL1                                                   00180100
                      AIF   ('&ZCLNG' NE 'YES').ZI4E  ALL ZERO BITS     00180200
&ZOPN                 SETA  &ZOPN+1                                     00180300
&ZOPL(&ZOPN)          SETC  ' '                                         00180400
&ZOPO(&ZOPN)          SETC  'OI'                                        00180500
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00180600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00180700
.ZI4E                 ANOP  ,                                           00180800
.*-------------------------------------------------------------------   00180900
.***AI.L18  XBUFFALET CL4                                               00181000
         AIF   ('&XBUFFALET' NE 'NOBUFFALET').ZI6                       00181100
&ZXBUFFALET           SETC  ''             RESET INPUT/OUTPUT           00181200
.ZI6                  ANOP  ,                                           00181300
.*-------------------------------------------------------------------   00181400
.***AI.L25  XBUFFALET CL4                                               00181500
                      AIF   ('&ZXBUFFALET' EQ '').ZI6E                  00181600
                      AIF   ('&ZXBUFFALET' EQ 'OUTPUT').ZI6E            00181700
&ZCGPR                SETC  '&XBUFFALET'                                00181800
.*                                                                      00181900
                      AIF   ('&XBUFFALET'(1,1) NE '(').ZI6B             00182000
&ZCGPR   SETC  '0('.'&XBUFFALET'(2,K'&XBUFFALET-2).')'                  00182100
.ZI6B                 ANOP  ,                                           00182200
.*                                                                      00182300
&ZOPN                 SETA  &ZOPN+1                                     00182400
&ZOPL(&ZOPN)          SETC  ' '                                         00182500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00182600
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00182700
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFALET XBUFFALET'                  00182800
.*                                                                      00182900
.ZI6E                 ANOP  ,                                           00183000
.*-------------------------------------------------------------------   00183100
.***AI.L25  XBUFFADDR AL8                                               00183200
                      AIF   ('&ZXBUFFADDR' EQ '').ZI7E                  00183300
                      AIF   ('&ZXBUFFADDR' EQ 'OUTPUT').ZI7E            00183400
&ZCGPR                SETC  '&XBUFFADDR'                                00183500
.*                                                                      00183600
&ZC                   SETC  '&XBUFFADDR'(1,1)                           00183700
                      AIF   (T'&ZC NE 'N').ZI7D                         00183800
&ZC                   SETC  '&XBUFFADDR'                                00183900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00184000
&ZCGPR                SETC  '=AD(&XBUFFADDR)'                           00184100
.*                                                                      00184200
.ZI7D                 ANOP  ,                                           00184300
.*                                                                      00184400
&ZOPN                 SETA  &ZOPN+1                                     00184500
&ZOPL(&ZOPN)          SETC  ' '                                         00184600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00184700
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00184800
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFADDR XBUFFADDR'                  00184900
.*                                                                      00185000
.ZI7E                 ANOP  ,                                           00185100
.*-------------------------------------------------------------------   00185200
.***AI.L25  XBUFFLEN CL8                                                00185300
                      AIF   ('&ZXBUFFLEN' EQ '').ZI8E                   00185400
                      AIF   ('&ZXBUFFLEN' EQ 'OUTPUT').ZI8E             00185500
&ZCGPR                SETC  '&XBUFFLEN'                                 00185600
.*                                                                      00185700
                      AIF   ('&XBUFFLEN'(1,1) NE '(').ZI8B              00185800
&ZCGPR   SETC  '0('.'&XBUFFLEN'(2,K'&XBUFFLEN-2).')'                    00185900
                      AGO   .ZI8D                                       00186000
.ZI8B                 ANOP  ,                                           00186100
.*                                                                      00186200
&ZC                   SETC  '&XBUFFLEN'(1,1)                            00186300
                      AIF   (T'&ZC NE 'N').ZI8D                         00186400
&ZC                   SETC  '&XBUFFLEN'                                 00186500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00186600
&ZCGPR                SETC  '=AD(&XBUFFLEN)'                            00186700
.*                                                                      00186800
.ZI8D                 ANOP  ,                                           00186900
.*                                                                      00187000
&ZOPN                 SETA  &ZOPN+1                                     00187100
&ZOPL(&ZOPN)          SETC  ' '                                         00187200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00187300
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00187400
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFLEN XBUFFLEN'                    00187500
.*                                                                      00187600
.ZI8E                 ANOP  ,                                           00187700
.*-------------------------------------------------------------------   00187800
.***AI.L25  XTOKEN CL8                                                  00187900
                      AIF   ('&ZXTOKEN' EQ '').ZI9E                     00188000
                      AIF   ('&ZXTOKEN' EQ 'OUTPUT').ZI9E               00188100
&ZCGPR                SETC  '&XTOKEN'                                   00188200
.*                                                                      00188300
                      AIF   ('&XTOKEN'(1,1) NE '(').ZI9B                00188400
&ZCGPR   SETC  '0('.'&XTOKEN'(2,K'&XTOKEN-2).')'                        00188500
.ZI9B                 ANOP  ,                                           00188600
.*                                                                      00188700
&ZOPN                 SETA  &ZOPN+1                                     00188800
&ZOPL(&ZOPN)          SETC  ' '                                         00188900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00189000
&ZOPV(&ZOPN)          SETC  '24(8,1),&ZCGPR'                            00189100
&ZOPD(&ZOPN)          SETC  '++ &ZXTOKEN XTOKEN'                        00189200
.*                                                                      00189300
.ZI9E                 ANOP  ,                                           00189400
.*-------------------------------------------------------------------   00189500
.***AI.L25  XTBWCADDR AL4                                               00189600
                      AIF   ('&ZXTBWCADDR' EQ '').ZI10E                 00189700
                      AIF   ('&ZXTBWCADDR' EQ 'OUTPUT').ZI10E           00189800
&ZCGPR                SETC  '&XTBWCADDR'                                00189900
.*                                                                      00190000
                      AIF   ('&XTBWCADDR'(1,1) NE '(').ZI10B            00190100
&ZCGPR   SETC  '0('.'&XTBWCADDR'(2,K'&XTBWCADDR-2).')'                  00190200
                      AGO   .ZI10D                                      00190300
.ZI10B                ANOP  ,                                           00190400
.*                                                                      00190500
&ZC                   SETC  '&XTBWCADDR'(1,1)                           00190600
                      AIF   (T'&ZC NE 'N').ZI10D                        00190700
&ZC                   SETC  '&XTBWCADDR'                                00190800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00190900
&ZCGPR                SETC  '=AL4(&XTBWCADDR)'                          00191000
.*                                                                      00191100
.ZI10D                ANOP  ,                                           00191200
.*                                                                      00191300
&ZOPN                 SETA  &ZOPN+1                                     00191400
&ZOPL(&ZOPN)          SETC  ' '                                         00191500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00191600
&ZOPV(&ZOPN)          SETC  '32(4,1),&ZCGPR'                            00191700
&ZOPD(&ZOPN)          SETC  '++ &ZXTBWCADDR XTBWCADDR'                  00191800
.*                                                                      00191900
.ZI10E                ANOP  ,                                           00192000
.*-------------------------------------------------------------------   00192100
.***AI.L18  XTBWCALET CL4                                               00192200
         AIF   ('&XTBWCALET' NE 'NOTBWCALET').ZI11                      00192300
&ZXTBWCALET           SETC  ''             RESET INPUT/OUTPUT           00192400
.ZI11                 ANOP  ,                                           00192500
.*-------------------------------------------------------------------   00192600
.***AI.L25  XTBWCALET CL4                                               00192700
                      AIF   ('&ZXTBWCALET' EQ '').ZI11E                 00192800
                      AIF   ('&ZXTBWCALET' EQ 'OUTPUT').ZI11E           00192900
&ZCGPR                SETC  '&XTBWCALET'                                00193000
.*                                                                      00193100
                      AIF   ('&XTBWCALET'(1,1) NE '(').ZI11B            00193200
&ZCGPR   SETC  '0('.'&XTBWCALET'(2,K'&XTBWCALET-2).')'                  00193300
.ZI11B                ANOP  ,                                           00193400
.*                                                                      00193500
&ZOPN                 SETA  &ZOPN+1                                     00193600
&ZOPL(&ZOPN)          SETC  ' '                                         00193700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00193800
&ZOPV(&ZOPN)          SETC  '36(4,1),&ZCGPR'                            00193900
&ZOPD(&ZOPN)          SETC  '++ &ZXTBWCALET XTBWCALET'                  00194000
.*                                                                      00194100
.ZI11E                ANOP  ,                                           00194200
.*-------------------------------------------------------------------   00194300
.***AI.L18  XBUFFSTOKEN CL8                                             00194400
         AIF   ('&XBUFFSTOKEN' NE 'BY_BUFFALET').ZI12                   00194500
&ZXBUFFSTOKEN         SETC  ''             RESET INPUT/OUTPUT           00194600
.ZI12                 ANOP  ,                                           00194700
.*-------------------------------------------------------------------   00194800
.***AI.L25  XBUFFSTOKEN CL8                                             00194900
                      AIF   ('&ZXBUFFSTOKEN' EQ '').ZI12E               00195000
                      AIF   ('&ZXBUFFSTOKEN' EQ 'OUTPUT').ZI12E         00195100
&ZCGPR                SETC  '&XBUFFSTOKEN'                              00195200
.*                                                                      00195300
                      AIF   ('&XBUFFSTOKEN'(1,1) NE '(').ZI12B          00195400
&ZCGPR   SETC  '0('.'&XBUFFSTOKEN'(2,K'&XBUFFSTOKEN-2).')'              00195500
.ZI12B                ANOP  ,                                           00195600
.*                                                                      00195700
&ZOPN                 SETA  &ZOPN+1                                     00195800
&ZOPL(&ZOPN)          SETC  ' '                                         00195900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00196000
&ZOPV(&ZOPN)          SETC  '40(8,1),&ZCGPR'                            00196100
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFSTOKEN XBUFFSTOKEN'              00196200
.*                                                                      00196300
.ZI12E                ANOP  ,                                           00196400
.*-------------------------------------------------------------------   00196500
.***AI.L25  XTBWCADDR64 AL8                                             00196600
                      AIF   ('&ZXTBWCADDR64' EQ '').ZI13E               00196700
                      AIF   ('&ZXTBWCADDR64' EQ 'OUTPUT').ZI13E         00196800
&ZCGPR                SETC  '&XTBWCADDR64'                              00196900
.*                                                                      00197000
                      AIF   ('&XTBWCADDR64'(1,1) NE '(').ZI13B          00197100
&ZCGPR   SETC  '0('.'&XTBWCADDR64'(2,K'&XTBWCADDR64-2).')'              00197200
                      AGO   .ZI13D                                      00197300
.ZI13B                ANOP  ,                                           00197400
.*                                                                      00197500
&ZC                   SETC  '&XTBWCADDR64'(1,1)                         00197600
                      AIF   (T'&ZC NE 'N').ZI13D                        00197700
&ZC                   SETC  '&XTBWCADDR64'                              00197800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               00197900
&ZCGPR                SETC  '=AD(&XTBWCADDR64)'                         00198000
.*                                                                      00198100
.ZI13D                ANOP  ,                                           00198200
.*                                                                      00198300
&ZOPN                 SETA  &ZOPN+1                                     00198400
&ZOPL(&ZOPN)          SETC  ' '                                         00198500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00198600
&ZOPV(&ZOPN)          SETC  '48(8,1),&ZCGPR'                            00198700
&ZOPD(&ZOPN)          SETC  '++ &ZXTBWCADDR64 XTBWCADDR64'              00198800
.*                                                                      00198900
.ZI13E                ANOP  ,                                           00199000
.*-------------------------------------------------------------------   00199100
&ZOPN1                SETA &ZOPN                                        00199200
.*******************************************************************    00199300
.***  PROCESS ITTWRITE OUTPUT PARAMETERS                                00199400
.*******************************************************************    00199500
                      ACTR  10000                                       00199600
.*******************************************************************    00199700
.***AO.X02  RETURN CODE PROCESSING                                      00199800
.*******************************************************************    00199900
                      AIF   (N'&RC LE 0).ZMRETX                         00200000
                      AIF   ('&XRC'(1,1) EQ '(').ZMRET2                 00200100
                      AIF   ('&XRC' EQ 'GPR15').ZMRETX                  00200200
                      AIF   ('&XRC' EQ 'REG15').ZMRETX                  00200300
                      AIF   ('&XRC' EQ 'R15').ZMRETX                    00200400
                      AIF   ('&XRC' EQ '15').ZMRETX                     00200500
&ZOPN                 SETA  &ZOPN+1                                     00200600
&ZOPL(&ZOPN)          SETC  ' '                                         00200700
&ZOPO(&ZOPN)          SETC  'ST'                                        00200800
&ZOPV(&ZOPN)          SETC  '15,&XRC'                                   00200900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00201000
                      AGO   .ZMRETX                                     00201100
.*                                                                      00201200
.ZMRET2               ANOP  ,                                           00201300
&ZCGPR                SETC  '&XRC'(2,K'&XRC-2)                          00201400
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00201500
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00201600
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00201700
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00201800
&ZOPN                 SETA  &ZOPN+1                                     00201900
&ZOPL(&ZOPN)          SETC  ' '                                         00202000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00202100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00202200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00202300
.ZMRETX               ANOP  ,                                           00202400
.*******************************************************************    00202500
.***AO.X03  REASON CODE PROCESSING                                      00202600
.*******************************************************************    00202700
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00202800
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00202900
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00203000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00203100
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00203200
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00203300
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00203400
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00203500
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00203600
&ZOPN                 SETA  &ZOPN+1                                     00203700
&ZOPL(&ZOPN)          SETC  ' '                                         00203800
&ZOPO(&ZOPN)          SETC  'ST'                                        00203900
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00204000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00204100
                      AGO   .ZMRSNX                                     00204200
.*                                                                      00204300
.ZMRSN2               ANOP  ,                                           00204400
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00204500
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00204600
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00204700
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00204800
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00204900
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00205000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00205100
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00205200
&ZOPN                 SETA  &ZOPN+1                                     00205300
&ZOPL(&ZOPN)          SETC  ' '                                         00205400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00205500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00205600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00205700
.ZMRSNX               ANOP  ,                                           00205800
.*******************************************************************    00205900
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00206000
.*******************************************************************    00206100
.ZMFLX                ANOP  ,              MF=L PROCESSING              00206200
.*******************************************************************    00206300
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00206400
.*******************************************************************    00206500
                      ACTR  10000                                       00206600
.*                                                                      00206700
                      LCLA  &ZLC           COLUMN POSITION              00206800
                      LCLA  &ZOPX          LIST TABLE INDEX             00206900
                      LCLC  &ZLL           LABEL                        00207000
                      LCLC  &ZLOP          OPERATION                    00207100
                      LCLC  &ZLV           VALUE                        00207200
                      LCLC  &ZLD           DESCRIPTION                  00207300
.*                                                                      00207400
&ZOPX                 SETA  1                                           00207500
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00207600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00207700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00207800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00207900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00208000
                      AIF   (K'&ZLD LE 0).ZL5                           00208100
&ZLC                  SETA  35             COMMENT COLUMN               00208200
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00208300
&ZLC                  SETA  33             COMMMENT COLUMN              00208400
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00208500
&ZLV                  SETC  '&ZLV'.' '                                  00208600
                      AGO   .ZL3                                        00208700
.*                                                                      00208800
.ZL4                  ANOP  ,                                           00208900
&ZLV                  SETC  '&ZLV'.' '                                  00209000
.ZL5                  ANOP  ,                                           00209100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00209200
.*                                                                      00209300
&ZLL     &ZLOP &ZLV                                                     00209400
.*                                                                      00209500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00209600
                      AGO   .ZL2           CONTINUE LOOPING             00209700
.*                                                                      00209800
.ZLX                  ANOP  ,                                           00209900
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00210000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00210100
              L    14,16(0,0)            GET CVT ADDRESS                00210200
              L    14,772(14,0)          GET SFT ADDRESS                00210300
              L    14,576(14,0)          GET LX/EX (PC NUMBER)          00210400
              PC   0(14)                 PC TO CTRACE WRITER SERVICE    00210500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00210600
.ZLINKX               ANOP  ,                                           00210700
.*******************************************************************    00210800
.***AP.X01  FORMAT GENERATED CODE                                       00210900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00211000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00211100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00211200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00211300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00211400
                      AIF   (K'&ZLD LE 0).ZL51                          00211500
&ZLC                  SETA  35             COMMENT COLUMN               00211600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00211700
&ZLC                  SETA  33             COMMENT COLUMN               00211800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00211900
&ZLV                  SETC  '&ZLV'.' '                                  00212000
                      AGO   .ZL31                                       00212100
.*                                                                      00212200
.ZL41                 ANOP  ,                                           00212300
&ZLV                  SETC  '&ZLV'.' '                                  00212400
.ZL51                 ANOP  ,                                           00212500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00212600
.*                                                                      00212700
&ZLL     &ZLOP &ZLV                                                     00212800
.*                                                                      00212900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00213000
                      AGO   .ZL21          CONTINUE LOOPING             00213100
.*                                                                      00213200
.ZLX1                 ANOP  ,                                           00213300
.*******************************************************************    00213400
.***AP.X02  END OF ITTWRITE MACRO                                       00213500
&ZITTWRITE            SETC  'YES'          SET ITTWRITE USED            00213600
         POP   PRINT                                                    00213700
*                                            ITTWRITE-0                 00213800
         SPACE 1                                                        00213900
.ZLX2                 ANOP  ,                                           00214000
         MEND                                                           00214100
**********************************************************************/ 00214200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00214300
*%ITTWRITE: MACRO KEYS(BUFFADDR,BUFFALET,BUFFSTOKEN,BUFFLEN,TOKEN,      00214400
*                 TBWCADDR,TBWCADDR64,TBWCALET,SYNCH,RC,RSNCODE,COM,    00214500
*                 PLISTVER,MF);                                         00214600
*  ANS('?'!!MACLABEL!!' '!!'ITTWRITP '!!MACLIST!!                       00214700
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00214800
*%END ITTWRITE;                                                         00214900

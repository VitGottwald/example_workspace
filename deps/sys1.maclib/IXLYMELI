*                                                                       00001000
* %DCL IXLYMELI_INCLUDED CHAR EXT;                                      00002000
* %DEACTIVATE IXLYMELI_INCLUDED;                                        00003000
* %IF IXLYMELI_INCLUDED = '' %THEN                                      00004000
* %DO;                                                                  00005000
*/* Macro made bi-lingual on 18014. CBGEN compile date 15295         */ 00006000
*% /*                                                                   00007000
         MACRO                                                          00008000
         IXLYMELI &DSECT=YES,&LIST=YES,&TITLE=YES,&MELI1=YES,          *00009000
               &MELI2=COND,&MELI3=COND                                  00010000
         GBLC  &IXLYMELI_INCLUDED                                       00011000
         GBLC  &ZCBPRINT                                                00012000
&IXLYMELI_INCLUDED SETC 'YES'                                           00013000
         AIF   ('&LIST' EQ 'NONE').P0                                   00014000
         AIF   ('&TITLE' EQ 'NO').P5                                    00015000
 TITLE   'IXLYMELI  - Move EntryList Input                           '  00016000
.P5      ANOP                                                           00017000
**/ IXLYMELI_1:;                                                        00018000
*/* START OF SPECIFICATIONS ******************************************* 00019000
*                                                                       00020000
*01* PROPRIETARY STATEMENT =                                            00021000
*                                                                       00022000
*    Licensed Materials - Property of IBM                               00023000
*    5647-A01                                                           00024000
*    COPYRIGHT IBM CORP. 2000                                           00025000
*                                                                       00026000
*    US Government Users Restricted Rights - Use, duplication or        00027000
*    disclosure restricted by GSA ADP Schedule Contract with            00028000
*    IBM Corp.                                                          00029000
*                                                                       00030000
*01* STATUS = JBB6609                                                   00031000
*                                                                       00032000
*01* END OF PROPRIETARY STATEMENT                                       00033000
*                                                                       00034000
*01* DESCRIPTIVE NAME:  Move EntryList Input                            00035000
*                                                                       00036000
*02* ACRONYM:  MELI                                                     00037000
*                                                                       00038000
*01* MACRO NAME:  IXLYMELI                                              00039000
*                                                                       00040000
*01* DSECT NAME:  MELI                                                  00041000
*                                                                       00042000
*01* COMPONENT:  Cross System Extended Services (SCIXL)                 00043000
*                                                                       00044000
*01* EYE-CATCHER:  NONE                                                 00045000
*                                                                       00046000
*01* STORAGE ATTRIBUTES:                                                00047000
*02*  SUBPOOL:  User specified                                          00048000
*02*  KEY:  User specified                                              00049000
*02*  RESIDENCY:  User specified                                        00050000
*                                                                       00051000
*01* SIZE:                                                              00052000
*            MELI1 -- X'0020' bytes                                     00053000
*            MELI2 -- X'0040' bytes                                     00054000
*            MELI3 -- X'0060' bytes                                     00055000
*                                                                       00056000
*01* CREATED BY: Storage area created by IXLLSTM invoker.               00057000
*                                                                       00058000
*                                                                       00059000
*01* POINTED TO BY:                                                     00060000
*     BUFFER or BUFLIST                                                 00061000
*                                                                       00062000
*01* SERIALIZATION: See BUFFER/BUFLIST parameter requirements on the    00063000
*                   IXLLSTM interface description.                      00064000
*                                                                       00065000
*01* FUNCTION: Maps the information needed to identify an individual    00066000
*              list entry to be moved and/or updated via the            00067000
*              IXLLSTM REQUEST=MOVE_ENTRYLIST service.                  00068000
*                                                                       00069000
*              The storage area(s) indicated by BUFFER or BUFLIST on    00070000
*              an IXLLSTM REQUEST=MOVE_ENTRYLIST contain an input       00071000
*              array of elements. Each element may be mapped by MELI1,  00072000
*              MELI2, or MELI3, and contains the information needed     00073000
*              to request moving of a list entry.                       00074000
*                                                                       00075000
*              The format (and size) of each element is determined by   00076000
*              the structure characteristics, and the options           00077000
*              specified on the IXLLSTM REQUEST=MOVE_ENTRYLIST.         00078000
*                                                                       00079000
*              Each element in the array is mapped MELI1 when:          00080000
*              1. The structure does not support keyed entries          00081000
*                 and VERSIONCOMPARE=NO  or VERSIONCOMPARE=YES  is      00082000
*                 specified.                                            00083000
*              2. The structure does support keyed entries and          00084000
*                 MOVETOKEY=UNCHANGED, MOVETOSKEY=UNCHANGED with        00085000
*                 VERSIONCOMPARE=NO or VERSIONCOMPARE=YES specified.    00086000
*              3. The structure does support keyed entries and          00087000
*                 MOVETOKEY=LISTKEY, MOVETOSKEY=UNCHANGED with          00088000
*                 VERSIONCOMPARE=NO or VERSIONCOMPARE=YES specified.    00089000
*                                                                       00090000
*              Each element in the array is mapped MELI2 when:          00091000
*              1. VERSIONCOMPARE=BYENTRY or MOVETOKEY=TARGETKEY         00092000
*                 is specified with MOVETOSKEY=UNCHANGED.               00093000
*                                                                       00094000
*              Each element in the array is mapped MELI3 when:          00095000
*              1. MOVETOSKEY=TARGETKEY is specified.                    00096000
*                                                                       00097000
*01* EXTERNAL CLASSIFICATION: GUPI                                      00098000
*01* END OF EXTERNAL CLASSIFICATION:                                    00099000
*                                                                       00100000
*01* METHOD OF ACCESS:                                                  00101000
*02*  ASM:    USING on MELI1, MELI2, or MELI3                           00102000
*                                                                       00103000
*02*  PL/X:   %DCL MELI_DCL_ATTR CHAR                                   00104000
*             %MELI_DCL_ATTR = 'based/defined/via attributes'           00105000
*             %INCLUDE SYSLIB(IXLYMELI)                                 00106000
*                                                                       00107000
*             If MELI_DCL_ATTR is not set the MELI1, MELI2, and MELI3   00108000
*             will be declared as BASED.                                00109000
*                                                                       00110000
*01* DELETED BY: Invoker of IXLLSTM REQUEST=MOVE_ENTRYLIST service      00111000
*                                                                       00112000
*01* FREQUENCY: One for each list entry being moved                     00113000
*                                                                       00114000
*01* DEPENDENCIES: See BUFFER/BUFLIST parameter requirements on the     00115000
*                  IXLLSTM interface description.                       00116000
*                                                                       00117000
*01* DISTRIBUTION LIBRARY: AMACLIB                                      00118000
*                                                                       00119000
*01* CHANGE ACTIVITY:                                                   00120000
*     $L0=MQ       JBB6609 980902 PD00S7: MQSeries support              00121000
*     $D1=DWY0001  JBB6609 990329 PD002F: Add KeyPosition and           00122000
*                                         SKeyPosition                  00123000
*     $P1=PWY0381  JBB6609 990510 PD00DT: Update KeyPosition=Keep       00124000
*     $D2=DWY0010  JBB6609 990630 PD00DT: ListLimit=Enforce or Ignore   00125000
*                                                                       00126000
* NOTES: This control block must start on a double word boundary.       00127000
*                                                                       00128000
*END OF SPECIFICATIONS ***********************************************/ 00129000
*% /*                                                                   00130000
.P0      ANOP                                                           00131000
         AIF   ('&ZCBPRINT' EQ 'NO').P1                                 00132000
         AIF   ('&LIST' EQ 'YES').P2                                    00133000
.P1      ANOP                                                           00134000
         PUSH  PRINT                                                    00135000
         PRINT OFF                                                      00136000
.P2      ANOP                                                           00137000
         AIF   ('&MELI1' EQ 'NO').L0002                                 00138000
         AIF   ('&DSECT' EQ 'YES').L0003                                00139000
         AIF   ('&MELI1' NE 'YES').L0002                                00140000
MELI1    DS    0D        Move EntryList Input                           00141000
         AGO   .L0004                                                   00142000
.L0003   ANOP                                                           00143000
MELI1    DSECT           Move EntryList Input                           00144000
.L0004   ANOP                                                           00145000
MELI1_LIST_ENTRYNAME DS 0CL16 List Entry Name - designates the list    *00146000
                         entry to be moved when ListType=NameList is   *00147000
                         specified                                      00148000
MELI1_LIST_ENTRYID DS CL12 List Entry Id - designates the list entry   *00149000
                         to be moved when ListType=IdList is specified  00150000
         ORG   MELI1_LIST_ENTRYNAME+16                                  00151000
MELI1_TARGET_LISTNUMBER DS F Target List Number - designates the list  *00152000
                         number the designated list entry will be      *00153000
                         moved to                                       00154000
MELI1_FLAGS DS 0B        Flags0                                         00155000
MELI1_TARGET_DIRECTION EQU X'80' Target direction - partially          *00156000
                         designates the target position on the list    *00157000
                         specified by Meli1_Target_ListNumber 0 -      *00158000
                         HeadToTail 1 - TailToHead                      00159000
MELI1_SKEY_TARGET_DIRECTION EQU X'40' Secondary target direction -     *00160000
                         partially designates the target position on   *00161000
                         the sublist specified by                      *00162000
                         Meli1_Target_ListNumber and the secondary key *00163000
                         of the list entry 0 - HeadToTail 1 -          *00164000
                         TailToHead                                     00165000
MELI1_KEY_POSITION EQU X'20' Key Position - indicates whether the list *00166000
                         entry should be moved or should keep its      *00167000
                         current position on the sublist based on      *00168000
                         entry key ordering. 0 - Update position,      *00169000
                         specifies that the list entry should be moved *00170000
                         from its current position on the sublist as   *00171000
                         specified by Meli1_Target_Direction. 1 - Keep *00172000
                         position, specifies that the list entry       *00173000
                         should not be moved but keep its current      *00174000
                         position based on entry key ordering on the    00175000
*                        sublist if and only if the list number        *00176000
                         specified by Meli1_Target_ListNumber matches  *00177000
                         the current list number that contains the     *00178000
                         list entry, and the list entry key is not     *00179000
                         changed by the move operation when            *00180000
                         MOVETOKEY=UNCHANGED                            00181000
MELI1_SKEY_POSITION EQU X'10' SKey Position - indicates whether the    *00182000
                         list entry should be moved or should keep its *00183000
                         current position on the secondary sublist. 0  *00184000
                         - Update position, specifies that the list    *00185000
                         entry should be moved from its current        *00186000
                         position to a position on the subsidiary      *00187000
                         sublist as specified by Meli1_SKey_Target_    *00188000
                         Direction. 1 - Keep position, specifies that  *00189000
                         the list entry should not be moved but keep   *00190000
                         its current position based on secondary key    00191000
*                        ordering on the sublist if and only if the    *00192000
                         list number specified by                      *00193000
                         Meli1_Target_ListNumber matches the current   *00194000
                         list number that contains the list entry.      00195000
         ORG   MELI1_FLAGS+1                                            00196000
MELI1_FLAGS1 DS 0B       Flags1                                         00197000
MELI1_TARGET_LISTLIMIT EQU X'40' Target ListLimit - indicates whether  *00198000
                         the listlimit set for the target list should  *00199000
                         be enforced or ignored. 0 - Enforce target    *00200000
                         list limits, specifies that the move request  *00201000
                         will be failed if the list limit              *00202000
                         (list-element count limit or list- entry      *00203000
                         count limit) are exceeded as a result of      *00204000
                         moving this entry 1 - Ignore target list      *00205000
                         limit, specifies that processing of this      *00206000
                         entry will proceed even if the current         00207000
*                        listlimit will be exceeded as a result of     *00208000
                         moving this entry                              00209000
         ORG   MELI1_FLAGS1+1                                           00210000
         DS    CL10      Reserved                                       00211000
MELI1_END DS   0C        End of MELI type 1                             00212000
MELI1_LEN EQU  *-MELI1                                                  00213000
.L0002   ANOP                                                           00214000
         AIF   ('&MELI2' EQ 'NO').L0005                                 00215000
         AIF   ('&DSECT' EQ 'YES').L0006                                00216000
         AIF   ('&MELI2' NE 'YES').L0005                                00217000
MELI2    DS    0D        Move EntryList Input                           00218000
         AGO   .L0007                                                   00219000
.L0006   ANOP                                                           00220000
MELI2    DSECT           Move EntryList Input                           00221000
.L0007   ANOP                                                           00222000
MELI2_LIST_ENTRYNAME DS 0CL16 List Entry Name - designates the list    *00223000
                         entry to be moved when ListType=NameList is   *00224000
                         specified                                      00225000
MELI2_LIST_ENTRYID DS CL12 List Entry Id - designates the list entry   *00226000
                         to be moved when ListType=IdList is specified  00227000
         ORG   MELI2_LIST_ENTRYNAME+16                                  00228000
MELI2_TARGET_LISTNUMBER DS F Target List Number - designates the list  *00229000
                         number the designated list entry will be      *00230000
                         moved to                                       00231000
MELI2_FLAGS DS 0B        Flags                                          00232000
MELI2_TARGET_DIRECTION EQU X'80' Target direction - partially          *00233000
                         designates the target position on the list    *00234000
                         specified by Meli2_Target_ListNumber 0 -      *00235000
                         HeadToTail 1 - TailToHead                      00236000
MELI2_SKEY_TARGET_DIRECTION EQU X'40' Secondary target direction -     *00237000
                         partially designates the target position on   *00238000
                         the sublist specified by                      *00239000
                         Meli2_Target_ListNumber and the secondary key *00240000
                         of the list entry 0 - HeadToTail 1 -          *00241000
                         TailToHead                                     00242000
MELI2_KEY_POSITION EQU X'20' Key Position - indicates whether the list *00243000
                         entry should be moved or should keep its      *00244000
                         current position on the sublist based on      *00245000
                         entry key ordering. 0 - Update position,      *00246000
                         specifies that the list entry should be moved *00247000
                         from its current position on the sublist as   *00248000
                         specified by Meli2_Target_Key and             *00249000
                         Meli2_Target_Direction. 1 - Keep position,    *00250000
                         specifies that the list entry should not be   *00251000
                         moved but keep its current position based on   00252000
*                        entry key ordering on the sublist if and only *00253000
                         if the list number specified by               *00254000
                         Meli2_Target_ListNumber matches the current   *00255000
                         list number that contains the list entry, and *00256000
                         the list entry key is not changed by the move *00257000
                         operation when MOVETOKEY=UNCHANGED             00258000
MELI2_SKEY_POSITION EQU X'10' SKey Position - indicates whether the    *00259000
                         list entry should be moved or should keep its *00260000
                         current position on the secondary sublist. 0  *00261000
                         - Update position, specifies that the list    *00262000
                         entry should be moved from its current        *00263000
                         position to a position on the subsidiary      *00264000
                         sublist as specified by Meli2_SKey_Target_    *00265000
                         Direction. 1 - Keep position, specifies that  *00266000
                         the list entry should not be moved but keep   *00267000
                         its current position based on secondary key    00268000
*                        ordering on the sublist if and only if the    *00269000
                         list number specified by                      *00270000
                         Meli2_Target_ListNumber matches the current   *00271000
                         list number that contains the list entry.      00272000
MELI2_VERSCOMPTYPE EQU X'0C' Version comparison type Designates how    *00273000
                         the list entry version number is to be        *00274000
                         compared when VERSIONCOMPARE=BYENTRY is       *00275000
                         specified on IXLLSTM. 00 - No comparison 01 - *00276000
                         The version numbers in the list entry must be *00277000
                         equal to the version number in                *00278000
                         Meli2_VersComp. 10 - The version number in    *00279000
                         the list entry must be greater than or equal  *00280000
                         to the version number specifed in             *00281000
                         Meli2_VersComp. 11 - The version number in     00282000
*                        the list entry must be less than or equal to  *00283000
                         the version number specifed in                *00284000
                         Meli2_VersComp.                                00285000
MELI2_VERSUPDATE EQU X'03' Version update - specifies if the entry     *00286000
                         version number of the moved list entry will   *00287000
                         be updated. 00 - No update 01 - Decrement     *00288000
                         version 10 - Increment version 11 - Update    *00289000
                         version number with Meli2_NewVersion           00290000
         ORG   MELI2_FLAGS+1                                            00291000
MELI2_FLAGS1 DS 0B       Flags1                                         00292000
MELI2_TARGET_LISTLIMIT EQU X'40' Target ListLimit - indicates whether  *00293000
                         the listlimit set for the target list should  *00294000
                         be enforced or ignored. 0 - Enforce target    *00295000
                         list limits, specifies that the move request  *00296000
                         will be failed if the list limit              *00297000
                         (list-element count limit or list- entry      *00298000
                         count limit) are exceeded as a result of      *00299000
                         moving this entry 1 - Ignore target list      *00300000
                         limit, specifies that processing of this      *00301000
                         entry will proceed even if the current         00302000
*                        listlimit will be exceeded as a result of     *00303000
                         moving this entry                              00304000
         ORG   MELI2_FLAGS1+1                                           00305000
         DS    CL10      Reserved                                       00306000
MELI2_VERSCOMP DS CL8    Comparative version number specifies the      *00307000
                         value to be compared to the version number of *00308000
                         the designated entry when Meli2_VersCompType  *00309000
                         is not NONE.                                   00310000
MELI2_NEWVERSION DS CL8  New version number to be assigned to the list *00311000
                         entry when it has been moved to the target    *00312000
                         list when Meli2_VersUpdate is SET              00313000
MELI2_TARGET_KEY DS CL16 Target List Entry Key - specifies the entry   *00314000
                         key to be assigned to the list entry when it  *00315000
                         is moved to the target list. Only valid when  *00316000
                         MOVETOKEY=TARGETKEY was specified on IXLLSTM.  00317000
MELI2_END DS   0C        End of MELI type 2                             00318000
MELI2_LEN EQU  *-MELI2                                                  00319000
.L0005   ANOP                                                           00320000
         AIF   ('&MELI3' EQ 'NO').L0008                                 00321000
         AIF   ('&DSECT' EQ 'YES').L0009                                00322000
         AIF   ('&MELI3' NE 'YES').L0008                                00323000
MELI3    DS    0D        Move EntryList Input                           00324000
         AGO   .L000A                                                   00325000
.L0009   ANOP                                                           00326000
MELI3    DSECT           Move EntryList Input                           00327000
.L000A   ANOP                                                           00328000
MELI3_LIST_ENTRYID DS CL12 List Entry Id - designates the list entry   *00329000
                         to be moved when ListType=IdList is specified  00330000
         DS    CL4       Reserved                                       00331000
MELI3_TARGET_LISTNUMBER DS F Target List Number - designates the list  *00332000
                         number the designated list entry will be      *00333000
                         moved to                                       00334000
MELI3_FLAGS DS 0B        Flags                                          00335000
MELI3_TARGET_DIRECTION EQU X'80' Target direction - partially          *00336000
                         designates the target position on the list    *00337000
                         specified by Meli3_Target_ListNumber 0 -      *00338000
                         HeadToTail 1 - TailToHead                      00339000
MELI3_SKEY_TARGET_DIRECTION EQU X'40' Secondary key target direction - *00340000
                         partially designates the target position on   *00341000
                         the sublist specified by                      *00342000
                         Meli3_Target_ListNumber and the secondary key *00343000
                         of the list entry 0 - HeadToTail 1 -          *00344000
                         TailToHead                                     00345000
MELI3_KEY_POSITION EQU X'20' Key Position - indicates whether the list *00346000
                         entry should be moved or should keep its      *00347000
                         current position on the sublist based on      *00348000
                         entry key ordering. 0 - Update position,      *00349000
                         specifies that the list entry should be moved *00350000
                         from its current position on the sublist as   *00351000
                         specified by Meli3_Target_Key and             *00352000
                         Meli3_Target_Direction. 1 - Keep position,    *00353000
                         specifies that the list entry should not be   *00354000
                         moved but keep its current position based on   00355000
*                        entry key ordering on the sublist if and only *00356000
                         if the list number specified by               *00357000
                         Meli3_Target_ListNumber matches the current   *00358000
                         list number that contains the list entry, and *00359000
                         the list entry key is not changed by the move *00360000
                         operation when MOVETOKEY=UNCHANGED             00361000
MELI3_VERSCOMPTYPE EQU X'0C' Version comparison type Designates how    *00362000
                         the list entry version number is to be        *00363000
                         compared when VERSIONCOMPARE=BYENTRY is       *00364000
                         specified on IXLLSTM. 00 - No comparison 01 - *00365000
                         The version numbers in the list entry must be *00366000
                         equal to the version number in                *00367000
                         Meli3_VersComp. 10 - The version number in    *00368000
                         the list entry must be greater than or equal  *00369000
                         to the version number specifed in             *00370000
                         Meli3_VersComp. 11 - The version number in     00371000
*                        the list entry must be less than or equal to  *00372000
                         the version number specifed in                *00373000
                         Meli3_VersComp.                                00374000
MELI3_VERSUPDATE EQU X'03' Version update - specifies if the entry     *00375000
                         version number of the moved list entry will   *00376000
                         be updated. 00 - No update 01 - Decrement     *00377000
                         version 10 - Increment version 11 - Update    *00378000
                         version number with Meli3_NewVersion           00379000
         ORG   MELI3_FLAGS+1                                            00380000
MELI3_FLAGS1 DS 0B       Flags1                                         00381000
MELI3_TARGET_LISTLIMIT EQU X'40' Target ListLimit - indicates whether  *00382000
                         the listlimit set for the target list should  *00383000
                         be enforced or ignored. 0 - Enforce target    *00384000
                         list limits, specifies that the move request  *00385000
                         will be failed if the list limit              *00386000
                         (list-element count limit or list- entry      *00387000
                         count limit) are exceeded as a result of      *00388000
                         moving this entry 1 - Ignore target list      *00389000
                         limit, specifies that processing of this      *00390000
                         entry will proceed even if the current         00391000
*                        listlimit will be exceeded as a result of     *00392000
                         moving this entry                              00393000
         ORG   MELI3_FLAGS1+1                                           00394000
         DS    CL10      Reserved                                       00395000
MELI3_VERSCOMP DS CL8    Comparative version number specifies the      *00396000
                         value to be compared to the version number of *00397000
                         the designated entry when Meli3_VersCompType  *00398000
                         is not NONE.                                   00399000
MELI3_NEWVERSION DS CL8  New version number to be assigned to the list *00400000
                         entry when it has been moved to the target    *00401000
                         list when Meli3_VersUpdate is SET              00402000
MELI3_TARGET_KEY DS CL16 Target List Entry Key - specifies the entry   *00403000
                         key to be assigned to the list entry when it  *00404000
                         is moved to the target list. Only valid when  *00405000
                         MOVETOKEY=TARGETKEY was specified on IXLLSTM.  00406000
MELI3_TARGET_SKEY DS CL32 Secondary Target List Entry Key - specifies  *00407000
                         the secondary list key to be assigned to the  *00408000
                         list entry when it is moved to the target     *00409000
                         list. Only valid when MOVETOSKEY=TARGETKEY    *00410000
                         was specified on IXLLSTM.                      00411000
MELI3_END DS   0C        End of MELI type 3                             00412000
MELI_DIRECTION_HEADTOTAIL EQU B'00000000'                               00413000
MELI_DIRECTION_TAILTOHEAD EQU B'10000000'                               00414000
MELI_SKEYDIRECTION_HEADTOTAIL EQU B'00000000'                           00415000
MELI_SKEYDIRECTION_TAILTOHEAD EQU B'01000000'                           00416000
MELI_KEYPOSITION_UPDATE EQU B'00000000'                                 00417000
MELI_KEYPOSITION_KEEP EQU B'00100000'                                   00418000
MELI_SKEYPOSITION_UPDATE EQU B'00000000'                                00419000
MELI_SKEYPOSITION_KEEP EQU B'00010000'                                  00420000
MELI_VERSCOMPTYPE_NONE EQU B'00000000'                                  00421000
MELI_VERSCOMPTYPE_EQUAL EQU B'00000100'                                 00422000
MELI_VERSCOMPTYPE_LESSOREQUAL EQU B'00001100'                           00423000
MELI_VERSUPDATE_NONE EQU B'00000000'                                    00424000
MELI_VERSUPDATE_DECREMENT EQU B'00000001'                               00425000
MELI_VERSUPDATE_INCREMENT EQU B'00000010'                               00426000
MELI_VERSUPDATE_SET EQU B'00000011'                                     00427000
MELI_LISTLIMIT_ENFORCE EQU B'00000000'                                  00428000
MELI_LISTLIMIT_IGNORE EQU B'01000000'                                   00429000
MELI3_LEN EQU  *-MELI3                                                  00430000
.L0008   ANOP                                                           00431000
         AIF   ('&ZCBPRINT' EQ 'NO').P3                                 00432000
         AIF   ('&LIST' EQ 'YES').P4                                    00433000
.P3      ANOP                                                           00434000
         POP   PRINT                                                    00435000
.P4      ANOP                                                           00436000
.P_EXIT  ANOP                                                           00437000
         MEND                                                           00438000
**/ IXLYMELI_2:;                                                        00439000
* %IXLYMELI_INCLUDED = 'YES';                                           00440000
* %DCL ZCBPRINT CHAR EXT;                                               00441000
* %DEACTIVATE ZCBPRINT;                                                 00442000
* %DCL IXLYMELI_LIST CHAR EXT;                                          00443000
* %DEACTIVATE IXLYMELI_LIST;                                            00444000
* %IF IXLYMELI_LIST ^= 'NO' &                                           00445000
*    ZCBPRINT ^= 'NO' %THEN                                             00446000
*   %GOTO IXLYMELI_3;                                                   00447000
*   @LIST PUSH NOECHO;                                                  00448000
*   @LIST NOASSEMBLE NOECHO;                                            00449000
*   @LIST OFF C NOECHO;                                                 00450000
* %IXLYMELI_3:;                                                         00451000
*/* Start of PL/X Source                                             */ 00452000
*                                                                       00453000
* %If MELI_Dcl_Attr = '' %Then                                          00454000
*   %MELI_Dcl_Attr = 'Based';                                           00455000
*                                                                       00456000
*                                                                       00457000
* DCL 1 Meli1 Meli_Dcl_Attr Bdy(DWord), /* Move EntryList Input      */ 00458000
*         5 Meli1_List_EntryName    CHAR(16),/* List Entry Name -       00459000
*                                               designates the list     00460000
*                                               entry to be moved when  00461000
*                                               ListType=NameList is    00462000
*                                               specified            */ 00463000
*           7 Meli1_List_EntryId    CHAR(12),/* List Entry Id -         00464000
*                                               designates the list     00465000
*                                               entry to be moved when  00466000
*                                               ListType=IdList is      00467000
*                                               specified            */ 00468000
*         5 Meli1_Target_ListNumber FIXED(32),/* Target List Number -   00469000
*                                               designates the list     00470000
*                                               number the designated   00471000
*                                               list entry will be      00472000
*                                               moved to             */ 00473000
*         5 Meli1_Flags             BIT(8),  /* Flags0               */ 00474000
*           7 Meli1_Target_Direction BIT(1), /* Target direction -      00475000
*                                               partially designates    00476000
*                                               the target position on  00477000
*                                               the list specified by   00478000
*                                               Meli1_Target_ListNumber 00479000
*                                               0 - HeadToTail          00480000
*                                               1 - TailToHead       */ 00481000
*           7 Meli1_SKey_Target_Direction                               00482000
*                                   BIT(1),  /* Secondary target        00483000
*                                               direction - partially   00484000
*                                               designates the target   00485000
*                                               position on the sublist 00486000
*                                               specified by            00487000
*                                               Meli1_Target_ListNumber 00488000
*                                               and the secondary key   00489000
*                                               of the list entry       00490000
*                                               0 - HeadToTail          00491000
*                                               1 - TailToHead       */ 00492000
*           7 Meli1_Key_Position    BIT(1),  /* Key Position -          00493000
*                                               indicates whether the   00494000
*                                               list entry should be    00495000
*                                               moved or should keep    00496000
*                                               its current position on 00497000
*                                               the sublist based on    00498000
*                                               entry key ordering.     00499000
*                                               0 - Update position,    00500000
*                                               specifies that the list 00501000
*                                               entry should be moved   00502000
*                                               from its current        00503000
*                                               position on the sublist 00504000
*                                               as specified by         00505000
*                                               Meli1_Target_Direction. 00506000
*                                               1 - Keep position,      00507000
*                                               specifies that the list 00508000
*                                               entry should not be     00509000
*                                               moved but keep its      00510000
*                                               current  position based 00511000
*                                               on entry key ordering   00512000
*                                               on the sublist if and   00513000
*                                               only if the list number 00514000
*                                               specified by            00515000
*                                               Meli1_Target_ListNumber 00516000
*                                               matches the current     00517000
*                                               list number that        00518000
*                                               contains the list       00519000
*                                               entry, and the list     00520000
*                                               entry key is not        00521000
*                                               changed by the move     00522000
*                                               operation when          00523000
*                                               MOVETOKEY=UNCHANGED     00524000
*                                                                @P1C*/ 00525000
*           7 Meli1_SKey_Position   BIT(1),  /* SKey Position -         00526000
*                                               indicates whether the   00527000
*                                               list entry should be    00528000
*                                               moved or should keep    00529000
*                                               its current position on 00530000
*                                               the secondary sublist.  00531000
*                                               0 - Update position,    00532000
*                                               specifies that the list 00533000
*                                               entry should be moved   00534000
*                                               from its current        00535000
*                                               position to a position  00536000
*                                               on the subsidiary       00537000
*                                               sublist as specified by 00538000
*                                               Meli1_SKey_Target_      00539000
*                                               Direction.              00540000
*                                               1 - Keep position,      00541000
*                                               specifies that the list 00542000
*                                               entry should not be     00543000
*                                               moved but keep its      00544000
*                                               current  position based 00545000
*                                               on secondary key        00546000
*                                               ordering on the         00547000
*                                               sublist if and only     00548000
*                                               if the list number      00549000
*                                               specified by            00550000
*                                               Meli1_Target_ListNumber 00551000
*                                               matches the current     00552000
*                                               list number that        00553000
*                                               contains the list       00554000
*                                               entry.           @D1A*/ 00555000
*           7 *                     BIT(4),  /* Reserved         @D1C*/ 00556000
*         5 Meli1_Flags1            BIT(8),  /* Flags1           @D2A*/ 00557000
*           7 *                      BIT(1), /* Reserved             */ 00558000
*           7 Meli1_Target_ListLimit BIT(1), /* Target ListLimit -      00559000
*                                               indicates whether the   00560000
*                                               listlimit set for the   00561000
*                                               target list should be   00562000
*                                               enforced or ignored.    00563000
*                                               0 - Enforce target list 00564000
*                                               limits, specifies that  00565000
*                                               the move request will   00566000
*                                               be failed if the list   00567000
*                                               limit (list-element     00568000
*                                               count limit or list-    00569000
*                                               entry count limit)      00570000
*                                               are exceeded as a       00571000
*                                               result of moving this   00572000
*                                               entry                   00573000
*                                               1 - Ignore target list  00574000
*                                               limit, specifies that   00575000
*                                               processing of this      00576000
*                                               entry will proceed      00577000
*                                               even if the current     00578000
*                                               listlimit will be       00579000
*                                               exceeded as a result of 00580000
*                                               moving this entry       00581000
*                                                                @D2A*/ 00582000
*         5 *                       CHAR(10),/* Reserved         @D2C*/ 00583000
*         5 Meli1_End               CHAR(0); /* End of MELI type 1   */ 00584000
*                                                                       00585000
*                                                                       00586000
* DCL 1 Meli2 Meli_Dcl_Attr Bdy(DWord), /* Move EntryList Input      */ 00587000
*         5 Meli2_List_EntryName    CHAR(16),/* List Entry Name -       00588000
*                                               designates the list     00589000
*                                               entry to be moved when  00590000
*                                               ListType=NameList is    00591000
*                                               specified            */ 00592000
*           7 Meli2_List_EntryId    CHAR(12),/* List Entry Id -         00593000
*                                               designates the list     00594000
*                                               entry to be moved when  00595000
*                                               ListType=IdList is      00596000
*                                               specified            */ 00597000
*         5 Meli2_Target_ListNumber FIXED(32),/* Target List Number -   00598000
*                                               designates the list     00599000
*                                               number the designated   00600000
*                                               list entry will be      00601000
*                                               moved to             */ 00602000
*         5 Meli2_Flags             BIT(8),  /* Flags                */ 00603000
*           7 Meli2_Target_Direction BIT(1), /* Target direction -      00604000
*                                               partially designates    00605000
*                                               the target position on  00606000
*                                               the list specified by   00607000
*                                               Meli2_Target_ListNumber 00608000
*                                               0 - HeadToTail          00609000
*                                               1 - TailToHead       */ 00610000
*           7 Meli2_SKey_Target_Direction                               00611000
*                                   BIT(1),  /* Secondary target        00612000
*                                               direction - partially   00613000
*                                               designates the target   00614000
*                                               position on the sublist 00615000
*                                               specified by            00616000
*                                               Meli2_Target_ListNumber 00617000
*                                               and the secondary key   00618000
*                                               of the list entry       00619000
*                                               0 - HeadToTail          00620000
*                                               1 - TailToHead       */ 00621000
*           7 Meli2_Key_Position    BIT(1),  /* Key Position -          00622000
*                                               indicates whether the   00623000
*                                               list entry should be    00624000
*                                               moved or should keep    00625000
*                                               its current position on 00626000
*                                               the sublist based on    00627000
*                                               entry key ordering.     00628000
*                                               0 - Update position,    00629000
*                                               specifies that the list 00630000
*                                               entry should be moved   00631000
*                                               from its current        00632000
*                                               position on the sublist 00633000
*                                               as specified by         00634000
*                                               Meli2_Target_Key and    00635000
*                                               Meli2_Target_Direction. 00636000
*                                               1 - Keep position,      00637000
*                                               specifies that the list 00638000
*                                               entry should not be     00639000
*                                               moved but keep its      00640000
*                                               current  position based 00641000
*                                               on entry key ordering   00642000
*                                               on the sublist if and   00643000
*                                               only if the list number 00644000
*                                               specified by            00645000
*                                               Meli2_Target_ListNumber 00646000
*                                               matches the current     00647000
*                                               list number that        00648000
*                                               contains the list       00649000
*                                               entry, and the list     00650000
*                                               entry key is not        00651000
*                                               changed by the move     00652000
*                                               operation when          00653000
*                                               MOVETOKEY=UNCHANGED     00654000
*                                                                @P1C*/ 00655000
*           7 Meli2_SKey_Position   BIT(1),  /* SKey Position -         00656000
*                                               indicates whether the   00657000
*                                               list entry should be    00658000
*                                               moved or should keep    00659000
*                                               its current position on 00660000
*                                               the secondary sublist.  00661000
*                                               0 - Update position,    00662000
*                                               specifies that the list 00663000
*                                               entry should be moved   00664000
*                                               from its current        00665000
*                                               position to a position  00666000
*                                               on the subsidiary       00667000
*                                               sublist as specified by 00668000
*                                               Meli2_SKey_Target_      00669000
*                                               Direction.              00670000
*                                               1 - Keep position,      00671000
*                                               specifies that the list 00672000
*                                               entry should not be     00673000
*                                               moved but keep its      00674000
*                                               current  position based 00675000
*                                               on secondary key        00676000
*                                               ordering on the         00677000
*                                               sublist if and only     00678000
*                                               if the list number      00679000
*                                               specified by            00680000
*                                               Meli2_Target_ListNumber 00681000
*                                               matches the current     00682000
*                                               list number that        00683000
*                                               contains the list       00684000
*                                               entry.          @D1A*/  00685000
*           7 Meli2_VersCompType    BIT(2),  /* Version comparison type 00686000
*                                               Designates how the list 00687000
*                                               entry version number is 00688000
*                                               to be compared when     00689000
*                                               VERSIONCOMPARE=BYENTRY  00690000
*                                               is specified on         00691000
*                                               IXLLSTM.                00692000
*                                               00 - No comparison      00693000
*                                               01 - The version        00694000
*                                               numbers in the list     00695000
*                                               entry must be equal to  00696000
*                                               the version number in   00697000
*                                               Meli2_VersComp.         00698000
*                                               10 - The version        00699000
*                                               number in the           00700000
*                                               list entry              00701000
*                                               must be greater than or 00702000
*                                               equal to the version    00703000
*                                               number specifed in      00704000
*                                               Meli2_VersComp.         00705000
*                                               11 - The version        00706000
*                                               number in the           00707000
*                                               list entry              00708000
*                                               must be less than or    00709000
*                                               equal to the version    00710000
*                                               number specifed in      00711000
*                                               Meli2_VersComp.      */ 00712000
*           7 Meli2_VersUpdate      BIT(2),  /* Version update -        00713000
*                                               specifies if the entry  00714000
*                                               version number of the   00715000
*                                               moved list entry will   00716000
*                                               be updated.             00717000
*                                               00 - No update          00718000
*                                               01 - Decrement version  00719000
*                                               10 - Increment version  00720000
*                                               11 - Update version     00721000
*                                               number with             00722000
*                                               Meli2_NewVersion     */ 00723000
*         5 Meli2_Flags1            BIT(8),  /* Flags1           @D2A*/ 00724000
*           7 *                      BIT(1), /* Reserved             */ 00725000
*           7 Meli2_Target_ListLimit BIT(1), /* Target ListLimit -      00726000
*                                               indicates whether the   00727000
*                                               listlimit set for the   00728000
*                                               target list should be   00729000
*                                               enforced or ignored.    00730000
*                                               0 - Enforce target list 00731000
*                                               limits, specifies that  00732000
*                                               the move request will   00733000
*                                               be failed if the list   00734000
*                                               limit (list-element     00735000
*                                               count limit or list-    00736000
*                                               entry count limit)      00737000
*                                               are exceeded as a       00738000
*                                               result of moving this   00739000
*                                               entry                   00740000
*                                               1 - Ignore target list  00741000
*                                               limit, specifies that   00742000
*                                               processing of this      00743000
*                                               entry will proceed      00744000
*                                               even if the current     00745000
*                                               listlimit will be       00746000
*                                               exceeded as a result of 00747000
*                                               moving this entry       00748000
*                                                                @D2A*/ 00749000
*           7 *                      BIT(6), /* Reserved         @D2A*/ 00750000
*         5 *                       CHAR(10),/* Reserved         @D2C*/ 00751000
*         5 Meli2_VersComp          CHAR(8), /* Comparative version     00752000
*                                               number specifies the    00753000
*                                               value to be compared    00754000
*                                               to the version number   00755000
*                                               of the designated entry 00756000
*                                               when Meli2_VersCompType 00757000
*                                               is not NONE.         */ 00758000
*         5 Meli2_NewVersion        CHAR(8), /* New version number to   00759000
*                                               be assigned to the list 00760000
*                                               entry when it has been  00761000
*                                               moved to the target     00762000
*                                               list when               00763000
*                                               Meli2_VersUpdate is     00764000
*                                               SET                  */ 00765000
*         5 Meli2_Target_Key       CHAR(16), /* Target List Entry Key - 00766000
*                                               specifies the entry key 00767000
*                                               to be assigned to the   00768000
*                                               list entry when it is   00769000
*                                               moved to the target     00770000
*                                               list.  Only valid when  00771000
*                                               MOVETOKEY=TARGETKEY     00772000
*                                               was specified on        00773000
*                                               IXLLSTM.             */ 00774000
*         5 Meli2_End              CHAR(0);  /* End of MELI type 2   */ 00775000
*                                                                       00776000
*                                                                       00777000
* DCL 1 Meli3 Meli_Dcl_Attr Bdy(DWord), /* Move EntryList Input      */ 00778000
*         5 Meli3_List_EntryId      CHAR(12),/* List Entry Id -         00779000
*                                               designates the list     00780000
*                                               entry to be moved when  00781000
*                                               ListType=IdList is      00782000
*                                               specified            */ 00783000
*         5 *                       CHAR(4), /* Reserved             */ 00784000
*         5 Meli3_Target_ListNumber FIXED(32),/* Target List Number -   00785000
*                                               designates the list     00786000
*                                               number the designated   00787000
*                                               list entry will be      00788000
*                                               moved to             */ 00789000
*         5 Meli3_Flags             BIT(8),  /* Flags                */ 00790000
*           7 Meli3_Target_Direction BIT(1), /* Target direction -      00791000
*                                               partially designates    00792000
*                                               the target position on  00793000
*                                               the list specified by   00794000
*                                               Meli3_Target_ListNumber 00795000
*                                               0 - HeadToTail          00796000
*                                               1 - TailToHead       */ 00797000
*           7 Meli3_SKey_Target_Direction                               00798000
*                                   BIT(1),  /* Secondary key target    00799000
*                                               direction - partially   00800000
*                                               designates the target   00801000
*                                               position on the sublist 00802000
*                                               specified by            00803000
*                                               Meli3_Target_ListNumber 00804000
*                                               and the secondary key   00805000
*                                               of the list entry       00806000
*                                               0 - HeadToTail          00807000
*                                               1 - TailToHead       */ 00808000
*           7 Meli3_Key_Position    BIT(1),  /* Key Position -          00809000
*                                               indicates whether the   00810000
*                                               list entry should be    00811000
*                                               moved or should keep    00812000
*                                               its current position on 00813000
*                                               the sublist based on    00814000
*                                               entry key ordering.     00815000
*                                               0 - Update position,    00816000
*                                               specifies that the list 00817000
*                                               entry should be moved   00818000
*                                               from its current        00819000
*                                               position on the sublist 00820000
*                                               as specified by         00821000
*                                               Meli3_Target_Key and    00822000
*                                               Meli3_Target_Direction. 00823000
*                                               1 - Keep position,      00824000
*                                               specifies that the list 00825000
*                                               entry should not be     00826000
*                                               moved but keep its      00827000
*                                               current  position based 00828000
*                                               on entry key ordering   00829000
*                                               on the sublist if and   00830000
*                                               only if the list number 00831000
*                                               specified by            00832000
*                                               Meli3_Target_ListNumber 00833000
*                                               matches the current     00834000
*                                               list number that        00835000
*                                               contains the list       00836000
*                                               entry, and the list     00837000
*                                               entry key is not        00838000
*                                               changed by the move     00839000
*                                               operation when          00840000
*                                               MOVETOKEY=UNCHANGED     00841000
*                                                                @P1C*/ 00842000
*           7 *    BIT(1),                   /* reserved         @P1D*/ 00843000
*           7 Meli3_VersCompType    BIT(2),  /* Version comparison type 00844000
*                                               Designates how the list 00845000
*                                               entry version number is 00846000
*                                               to be compared when     00847000
*                                               VERSIONCOMPARE=BYENTRY  00848000
*                                               is specified on         00849000
*                                               IXLLSTM.                00850000
*                                               00 - No comparison      00851000
*                                               01 - The version        00852000
*                                               numbers in the list     00853000
*                                               entry must be equal to  00854000
*                                               the version number in   00855000
*                                               Meli3_VersComp.         00856000
*                                               10 - The version        00857000
*                                               number in the           00858000
*                                               list entry              00859000
*                                               must be greater than or 00860000
*                                               equal to the version    00861000
*                                               number specifed in      00862000
*                                               Meli3_VersComp.         00863000
*                                               11 - The version        00864000
*                                               number in the           00865000
*                                               list entry              00866000
*                                               must be less than or    00867000
*                                               equal to the version    00868000
*                                               number specifed in      00869000
*                                               Meli3_VersComp.      */ 00870000
*           7 Meli3_VersUpdate      BIT(2),  /* Version update -        00871000
*                                               specifies if the entry  00872000
*                                               version number of the   00873000
*                                               moved list entry will   00874000
*                                               be updated.             00875000
*                                               00 - No update          00876000
*                                               01 - Decrement version  00877000
*                                               10 - Increment version  00878000
*                                               11 - Update version     00879000
*                                               number with             00880000
*                                               Meli3_NewVersion     */ 00881000
*         5 Meli3_Flags1            BIT(8),  /* Flags1           @D2A*/ 00882000
*           7 *                      BIT(1), /* Reserved             */ 00883000
*           7 Meli3_Target_ListLimit BIT(1), /* Target ListLimit -      00884000
*                                               indicates whether the   00885000
*                                               listlimit set for the   00886000
*                                               target list should be   00887000
*                                               enforced or ignored.    00888000
*                                               0 - Enforce target list 00889000
*                                               limits, specifies that  00890000
*                                               the move request will   00891000
*                                               be failed if the list   00892000
*                                               limit (list-element     00893000
*                                               count limit or list-    00894000
*                                               entry count limit)      00895000
*                                               are exceeded as a       00896000
*                                               result of moving this   00897000
*                                               entry                   00898000
*                                               1 - Ignore target list  00899000
*                                               limit, specifies that   00900000
*                                               processing of this      00901000
*                                               entry will proceed      00902000
*                                               even if the current     00903000
*                                               listlimit will be       00904000
*                                               exceeded as a result of 00905000
*                                               moving this entry       00906000
*                                                                @D2A*/ 00907000
*           7 *                      BIT(6), /* Reserved         @D2A*/ 00908000
*         5 *                       CHAR(10),/* Reserved         @D2C*/ 00909000
*         5 Meli3_VersComp          CHAR(8), /* Comparative version     00910000
*                                               number specifies the    00911000
*                                               value to be compared    00912000
*                                               to the version number   00913000
*                                               of the designated entry 00914000
*                                               when Meli3_VersCompType 00915000
*                                               is not NONE.         */ 00916000
*         5 Meli3_NewVersion        CHAR(8), /* New version number to   00917000
*                                               be assigned to the list 00918000
*                                               entry when it has been  00919000
*                                               moved to the target     00920000
*                                               list when               00921000
*                                               Meli3_VersUpdate is     00922000
*                                               SET                  */ 00923000
*         5 Meli3_Target_Key       CHAR(16), /* Target List Entry Key - 00924000
*                                               specifies the entry key 00925000
*                                               to be assigned to the   00926000
*                                               list entry when it is   00927000
*                                               moved to the target     00928000
*                                               list.  Only valid when  00929000
*                                               MOVETOKEY=TARGETKEY     00930000
*                                               was specified on        00931000
*                                               IXLLSTM.             */ 00932000
*         5 Meli3_Target_SKey      CHAR(32), /* Secondary Target        00933000
*                                               List Entry Key -        00934000
*                                               specifies the           00935000
*                                               secondary list key      00936000
*                                               to be assigned to the   00937000
*                                               list entry when it is   00938000
*                                               moved to the target     00939000
*                                               list.  Only valid when  00940000
*                                               MOVETOSKEY=TARGETKEY    00941000
*                                               was specified on        00942000
*                                               IXLLSTM.             */ 00943000
*         5 Meli3_End              CHAR(0);  /* End of MELI type 3   */ 00944000
*                                                                       00945000
*  DCL                                                                  00946000
*    Meli_Direction_HeadToTail       BIT(8) CONSTANT('00000000'B),      00947000
*    Meli_Direction_TailToHead       BIT(8) CONSTANT('10000000'B),      00948000
*    Meli_SkeyDirection_HeadToTail   BIT(8) CONSTANT('00000000'B),      00949000
*    Meli_SkeyDirection_TailToHead   BIT(8) CONSTANT('01000000'B),      00950000
*    Meli_KeyPosition_Update         BIT(8) CONSTANT('00000000'B),      00951000
*    Meli_KeyPosition_Keep           BIT(8) CONSTANT('00100000'B),      00952000
*    Meli_SkeyPosition_Update        BIT(8) CONSTANT('00000000'B),      00953000
*    Meli_SkeyPosition_Keep          BIT(8) CONSTANT('00010000'B),      00954000
*    Meli_VersCompType_None          BIT(8) CONSTANT('00000000'B),      00955000
*    Meli_VersCompType_Equal         BIT(8) CONSTANT('00000100'B),      00956000
*    Meli_VersCompType_LessOrEqual   BIT(8) CONSTANT('00001100'B),      00957000
*    Meli_VersUpdate_None            BIT(8) CONSTANT('00000000'B),      00958000
*    Meli_VersUpdate_Decrement       BIT(8) CONSTANT('00000001'B),      00959000
*    Meli_VersUpdate_Increment       BIT(8) CONSTANT('00000010'B),      00960000
*    Meli_VersUpdate_Set             BIT(8) CONSTANT('00000011'B),      00961000
*    Meli_ListLimit_Enforce          BIT(8) CONSTANT('00000000'B),      00962000
*                                                             /* @D2A*/ 00963000
*    Meli_ListLimit_Ignore           BIT(8) CONSTANT('01000000'B);      00964000
*                                                             /* @D2A*/ 00965000
*                                                                       00966000
* %Deactivate MELI_Dcl_Attr;                                            00967000
*                                                                       00968000
*/* End of PL/X Source                                               */ 00969000
* %IF IXLYMELI_LIST ^= 'NO' &                                           00970000
*    ZCBPRINT ^= 'NO' %THEN                                             00971000
*   %GOTO IXLYMELI_4;                                                   00972000
*   @LIST POP NOECHO;                                                   00973000
* %IXLYMELI_4:;                                                         00974000
* %END;                                                                 00975000

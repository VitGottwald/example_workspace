*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IOSVRYSW                              -10/16/06-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Vary Switch API                               * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 (C) COPYRIGHT IBM CORP. 2006                           * 00001200
*                                                                     * 00001300
* STATUS= HBB7707                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      IOSVRYSW provides an interface to the VARY SWITCH process to   * 00002000
*      change the Dynamic Channel Path Management (DCM) state for     * 00002100
*      ports.                                                         * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00002400
*                                                                     * 00002500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002600
*                                                                     * 00002700
*01* ENVIRONMENT:                                                     * 00002800
*                                                                     * 00002900
*                                                                     * 00003000
*      Minimum authorization: Supervisor state or Key 0-7 or          * 00003100
*                        APF-authorized                               * 00003200
*                                                                     * 00003300
*      Dispatchable unit mode: Task mode.                             * 00003400
*                                                                     * 00003500
*      Cross Memory Mode: PASN=HASN=SASN.                             * 00003600
*                                                                     * 00003700
*      AMODE:            31-bit.                                      * 00003800
*                                                                     * 00003900
*      ASC mode:         Primary.                                     * 00004000
*                                                                     * 00004100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004200
*                                                                     * 00004300
*      Locks:            No locks held.                               * 00004400
*                                                                     * 00004500
*      Control parameters: Control parameters must be in the primary  * 00004600
*                        address space.                               * 00004700
*                                                                     * 00004800
*                                                                     * 00004900
*                                                                     * 00005000
*01* PROGRAMMING REQUIREMENTS:                                        * 00005100
*                                                                     * 00005200
*    Programs invoking this macro must include mapping macro IOSDVSAP * 00005300
*    within their macro libraries.                                    * 00005400
*                                                                     * 00005500
*01* RESTRICTIONS:                                                    * 00005600
*    None                                                             * 00005700
*                                                                     * 00005800
*01* INPUT REGISTERS:  GR0         Undefined                          * 00005900
*                      GR1         Used by service                    * 00006000
*                      GR2-GR13    Undefined                          * 00006100
*                      GR14-GR15   Used by service                    * 00006200
*                                                                     * 00006300
*01* OUTPUT REGISTERS: GR0         Reason code                        * 00006400
*                      GR1         Unpredictable                      * 00006500
*                      GR2-GR13    Unchanged                          * 00006600
*                      GR14        Unpredictable                      * 00006700
*                      GR15        Return code                        * 00006800
*                                                                     * 00006900
*01* PERFORMANCE IMPLICATIONS:                                        * 00007000
*    None                                                             * 00007100
*                                                                     * 00007200
*01* SYNTAX:                                                          * 00007300
*                                                                     * 00007400
*Ýxlabel¨  IOSVRYSW  Ð  TYPE=INVOKE                                   * 00007500
*                    !     ,DATAADDR=xdataaddr                        * 00007600
*                    !     ,DATANUM=xdatanum                          * 00007700
*                    ¿ ,TYPE=BUILD                                    * 00007800
*                        ÐÝ,REQUEST=ONLINE¨                           * 00007900
*                        ¿Ý,REQUEST=OFFLINE                           * 00008000
*                            ÐÝ,OPTION=NONE¨                          * 00008100
*                            ¿Ý,OPTION=UNCOND¨¨                       * 00008200
*                          ,SWITCHDEV=xswitchdev                      * 00008300
*                          ,PORTADDR=xportaddr                        * 00008400
*                     Ý,RETCODE=xretcode¨                             * 00008500
*                     Ý,RSNCODE=xrsncode¨                             * 00008600
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00008700
*                    ÐÝ,MF=S¨                                         * 00008800
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00008900
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*      Where:                                                         * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*      Ýxlabel¨                                                       * 00009600
*          is an optional symbol, starting in column 1, that is the   * 00009700
*          name on the IOSVRYSW macro invocation.  The name must      * 00009800
*          conform to the rules for an ordinary assembler language    * 00009900
*          symbol.                                                    * 00010000
*          DEFAULT: No name.                                          * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*                                                                     * 00010500
*      TYPE=»INVOKE!BUILDº                                            * 00010600
*          is a required keyword input which indicates whether the    * 00010700
*          macro is being invoked to construct vary switch parameters * 00010800
*          or to perform the requested functions.                     * 00010900
*                                                                     * 00011000
*          Note: RETCODE and RSNCODE keywords can only be specified   * 00011100
*          with an INVOKE type request.                               * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*          TYPE=INVOKE                                                * 00011500
*              Performs the requested Vary Switch functions.          * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*              DATAADDR=xdataaddr                                     * 00011900
*                  is the name (RS-type), or address in register      * 00012000
*                  (2)-(12), of a required 4 byte input that contains * 00012100
*                  the address to the array of resource elements to   * 00012200
*                  be processed.  Each element is created by IOSVRYSW * 00012300
*                  TYPE BUILD invocation and is mapped by mapping     * 00012400
*                  macro IOSDVSAP.  All of the elements are           * 00012500
*                  contiguous.                                        * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*              DATANUM=xdatanum                                       * 00013100
*                  is the name (RS-type), or address in register      * 00013200
*                  (2)-(12), of a required fullword input that        * 00013300
*                  contains the number of elements in the array of    * 00013400
*                  resource elements to be processed.                 * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*          TYPE=BUILD                                                 * 00013900
*              Constructs the Vary Switch API parameter list.  This   * 00014000
*              is a single element in the array of resource elements  * 00014100
*              to be processed.                                       * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*              ÝREQUEST=»ONLINE!OFFLINEº                              * 00014500
*                  is an optional keyword input which indicates the   * 00014600
*                  type of request to process.                        * 00014700
*                  DEFAULT: ONLINE                                    * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*                  ÝREQUEST=ONLINE¨                                   * 00015100
*                      The request is to make the port online to      * 00015200
*                      dynamic channel path management.               * 00015300
*                                                                     * 00015400
*                  ÝREQUEST=OFFLINE                                   * 00015500
*                      The request is to make the port offline to     * 00015600
*                      dynamic channel path management.               * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*                      ÝOPTION=»NONE!UNCONDº¨¨                        * 00016000
*                          is an optional keyword input which         * 00016100
*                          indicates an additional option to be       * 00016200
*                          processed along with an OFFLINE request.   * 00016300
*                          DEFAULT: NONE                              * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*                          ÝOPTION=NONE¨                              * 00016700
*                              there is no further specification on   * 00016800
*                              the offline request.                   * 00016900
*                                                                     * 00017000
*                          ÝOPTION=UNCOND¨¨                           * 00017100
*                              This option is used to specify an      * 00017200
*                              UNCOND request on the VARY PATH        * 00017300
*                              commands invoked as a result of this   * 00017400
*                              VARY SWITCH request.  Adding UNCOND    * 00017500
*                              keyword to a VARY PATH,OFFLINE command * 00017600
*                              results in system taking offline last  * 00017700
*                              path to devices that are online but    * 00017800
*                              unallocated.                           * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*              SWITCHDEV=xswitchdev                                   * 00019000
*                  is the name (RS-type), or address in register      * 00019100
*                  (2)-(12), of a required halfword input which       * 00019200
*                  indicates the switch to be affected.               * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*              PORTADDR=xportaddr                                     * 00019800
*                  is the name (RS-type), or address in register      * 00019900
*                  (2)-(12), of a required byte input which indicates * 00020000
*                  the port address to be affected.                   * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*      ÝRETCODE=xretcode¨                                             * 00021000
*          is the name (RS-type) of an optional fullword output       * 00021100
*          variable, or register (2)-(12), into which the return code * 00021200
*          is to be copied from GPR 15.                               * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*      ÝRSNCODE=xrsncode¨                                             * 00021800
*          is the name (RS-type) of an optional fullword output       * 00021900
*          variable, or register (2)-(12), into which the reason code * 00022000
*          is to be copied from GPR 0.                                * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00022600
*          is an optional byte input decimal value in the "1-1" range * 00022700
*          that specifies the macro version.  PLISTVER is the only    * 00022800
*          key allowed on the list form of MF and determines which    * 00022900
*          parameter list is generated.  Note that MAX may be         * 00023000
*          specified instead of a number, and the parameter list will * 00023100
*          be of the largest size currently supported. This size may  * 00023200
*          grow from release to release (thus possibly affecting the  * 00023300
*          amount of storage needed by your program).  If your        * 00023400
*          program can tolerate this, IBM recommends that you always  * 00023500
*          specify MAX when creating the list form parameter list as  * 00023600
*          that will ensure that the list form parameter list is      * 00023700
*          always long enough to hold whatever parameters might be    * 00023800
*          specified on the execute form.                             * 00023900
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00024000
*          default is the lowest version which allows all of the      * 00024100
*          parameters specified on the invocation to be processed.    * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*      ÝMF=»S!L!Eº¨                                                   * 00024700
*          is an optional keyword input which specifies the macro     * 00024800
*          form.                                                      * 00024900
*          DEFAULT: S                                                 * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*          ÝMF=S¨                                                     * 00025300
*              specifies the standard form of the macro.  The "S"     * 00025400
*              form generates code to put the parameters into an      * 00025500
*              in-line parameter list and invoke the desired service. * 00025600
*              Full checking for required macro keys is done along    * 00025700
*              with supplying defaults for omitted optional           * 00025800
*              parameters.                                            * 00025900
*                                                                     * 00026000
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00026100
*              specifies the list form of the macro.  The "L" form    * 00026200
*              defines an area to be used for the parameter list.     * 00026300
*              Only the PLISTVER key may be specified on the          * 00026400
*              invocation.  All other macro parameters are flagged as * 00026500
*              errors.  If PLISTVER is not specified, the original    * 00026600
*              parameter list definition is used.                     * 00026700
*                                                                     * 00026800
*            ,xmfctrl                                                 * 00026900
*              is a required input.  It is the name of a storage area * 00027000
*              for the parameter list.                                * 00027100
*                                                                     * 00027200
*            »,xmfattr!0Dº                                            * 00027300
*              is an optional 60 character input string that varies   * 00027400
*              from 1 to 60 characters. Use it to force boundary      * 00027500
*              alignment of the parameter list. Use only 0F or 0D.    * 00027600
*              DEFAULT: 0D which forces the parameter list to a       * 00027700
*              doubleword boundary.                                   * 00027800
*                                                                     * 00027900
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00028000
*              specifies the execute form of the macro.  The "E" form * 00028100
*              generates code to put the parameters into the          * 00028200
*              parameter list specified by xmfctrl and provides full  * 00028300
*              syntax checking with default setting.                  * 00028400
*                                                                     * 00028500
*            ,xmfctrl                                                 * 00028600
*              is a required input.  It is the name (RS-type), or     * 00028700
*              address in register (1)-(12), of a storage area for    * 00028800
*              the parameter list.                                    * 00028900
*                                                                     * 00029000
*            »,COMPLETEº                                              * 00029100
*              is an optional keyword input which specifies the       * 00029200
*              degree of macro parameter syntax checking.             * 00029300
*              DEFAULT: COMPLETE                                      * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*              COMPLETE                                               * 00029700
*                  Checking for required macro keys is done and       * 00029800
*                  defaults are supplied for omitted optional         * 00029900
*                  parameters.                                        * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*01* RETURN CODES:                                                    * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*            0    Meaning: Successful completion.                     * 00031100
*                                                                     * 00031200
*                 Action: None required.                              * 00031300
*                                                                     * 00031400
*            10   Meaning: IOSDVSAP_VSWITCH_UNEXPECTED_ERROR - An     * 00031500
*                 unexpected error occurred further in the vary       * 00031600
*                 switch processing.                                  * 00031700
*                                                                     * 00031800
*                 Action: Verify the configuration in effect and      * 00031900
*                 re-submit the request.  If the request fails again  * 00032000
*                 for the same reason, contact IBM support center.    * 00032100
*                                                                     * 00032200
*            FF04 Meaning: IOSDVSAP_ABEND_ACCESSING_STORAGE - Storage * 00032300
*                 passed on the DATAADDR was not accessible by the    * 00032400
*                 service.                                            * 00032500
*                                                                     * 00032600
*                 Action: Verify that accessible storage is being     * 00032700
*                 passed.                                             * 00032800
*                                                                     * 00032900
*            FF08 Meaning: IOSDVSAP_ASIM_FAILURE - The attempt to     * 00033000
*                 queue a work element to the IOS address space       * 00033100
*                 failed.  Request is currently not able to be        * 00033200
*                 performed.                                          * 00033300
*                                                                     * 00033400
*                 Action: Contact IBM support center.                 * 00033500
*                                                                     * 00033600
*            FF0C Meaning: IOSDVSAP_BAD_DATA - VSAP data is readable  * 00033700
*                 but not valid.                                      * 00033800
*                                                                     * 00033900
*                 Action: Verify that the correct data is being       * 00034000
*                 passed.                                             * 00034100
*                                                                     * 00034200
*            FF10 Meaning: IOSDVSAP_ENVIRONMENTAL_ERROR - Caller is   * 00034300
*                 not in a valid environment to invoke the IOSVRYSW   * 00034400
*                 API.                                                * 00034500
*                                                                     * 00034600
*                 Action: Insure that caller is running in correct    * 00034700
*                 environment.                                        * 00034800
*                                                                     * 00034900
*            FF14 Meaning: IOSDVSAP_SYSTEM_ERROR - The processing     * 00035000
*                 suffered a catastrophic error.  Function could not  * 00035100
*                 be processed.                                       * 00035200
*                                                                     * 00035300
*                 Action: Contact IBM support center.                 * 00035400
*                                                                     * 00035500
*            FF18 Meaning: IOSDVSAP_ESTAE_ERROR - IOSVRYSW processing * 00035600
*                 module IOSVVSWF could not establish a recovery      * 00035700
*                 environment.                                        * 00035800
*                                                                     * 00035900
*                 Action: Re-submit the request.  If the request      * 00036000
*                 fails again for the same reason, contact IBM        * 00036100
*                 support center.                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*01* REASON CODES:                                                    * 00036600
*       None                                                          * 00036700
*                                                                     * 00036800
*01* ABEND CODES:  None.                                              * 00036900
*                                                                     * 00037000
*01* ABEND REASON CODES:  None.                                       * 00037100
*                                                                     * 00037200
*01* MODULE TYPE:  ASSEM MACRO                                        * 00037300
*                                                                     * 00037400
*02*   PROCESSOR:  ASSEM                                              * 00037500
*                                                                     * 00037600
*01* COMPONENT:  SC1C3                                                * 00037700
*                                                                     * 00037800
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00037900
*                                                                     * 00038000
*01* MACRO USAGE NOTES:                                               * 00038100
*                                                                     * 00038200
*                                                                     * 00038300
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00038400
*        global macro variable.  Any value other than 'NO' will       * 00038500
*        result in the macro expansion being printed.  The default is * 00038600
*        'YES'.  The following examples illustrate how the ZPRINT     * 00038700
*        variable should be set.                                      * 00038800
*                                                                     * 00038900
*                    GBLC &ZPRINT                                     * 00039000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*    2.  All   keys   currently   contained  in  the  IOSVRYSW  macro * 00039400
*        correspond  to  version  1.   If you specify PLISTVER, use a * 00039500
*        value of 1 or MAX.                                           * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*    3.  The  program  invoking  this  function  must include mapping * 00039900
*        macro    IOSDVSAP    in    its    macro    libraries    when * 00040000
*        assembling/compiling.    IOSDVSAP  maps  each element of the * 00040100
*        array of resource elements that is passed to the VARY SWITCH * 00040200
*        API.  All of the elements are contiguous.                    * 00040300
*                                                                     * 00040400
*        Each  element  is  created by a separate IOSVRYSW TYPE BUILD * 00040500
*        invocation.                                                  * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*01* CHANGE ACTIVITY:                                                 * 00041000
*                                                                     * 00041100
*   Flag LineItem  FMID    Date   ID    Comment                       * 00041200
*                                                                     * 00041300
*    $L0=OW56222  HBB7707 060616 PDUU:  Support for VARY SWITCH API   * 00041400
****** END OF SPECIFICATIONS *****************************************/ 00041500
*/********************************************************************* 00041600
         MACRO                                                          00041700
&XLABEL  IOSVRYSW &TYPE=,&DATAADDR=,&DATANUM=,&REQUEST=,&OPTION=,      *00041800
               &SWITCHDEV=,&PORTADDR=,&RETCODE=,&RSNCODE=,&PLISTVER=,  *00041900
               &MF=                                                     00042000
.*                                                                      00042100
*               MACDATE -10/16/06-<1>                                   00042200
.*                                                                      00042300
.*******************************************************************    00042400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00042500
.*******************************************************************    00042600
               GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                  00042700
               GBLC  &ZTEST      YES=TEST NO=NO TEST                    00042800
               GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX            00042900
.*                                                                      00043000
               GBLC  &ZIOSVRYSW  YES=MACRO USED AT LEAST ONCE           00043100
.*******************************************************************    00043200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00043300
.*******************************************************************    00043400
               LCLC  &ZMS        ERROR MESSAGE WORK AREA                00043500
               LCLC  &ZCNDX      SYSNDX CHARACTERS                      00043600
               LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED             00043700
               LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR            00043800
               LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE            00043900
               LCLA  &ZAWRK      USED AS A WORK AREA                    00044000
               LCLA  &ZASIZ      USED FOR SIZE OF VALUE                 00044100
               LCLA  &ZN         NUMERIC WORK VARIABLE                  00044200
               LCLC  &ZC         CHARACTER WORK VARIABLE                00044300
               LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE            00044400
               LCLA  &ZTLA       VALUE TOO LONG VARIABLE                00044500
               LCLC  &ZMAC_G     "G" or null                            00044600
&ZMAC_G        SETC  ''                                                 00044700
               LCLC  &ZMAC_LR                                           00044800
&ZMAC_LR       SETC  'LR'                                               00044900
               LCLC  &ZMAC_L                                            00045000
&ZMAC_L        SETC  'L'                                                00045100
               LCLC  &ZMAC_ST                                           00045200
&ZMAC_ST       SETC  'ST'                                               00045300
               LCLA  &ZMACRET    MACRO RETURN CODE                      00045400
&ZMACRET       SETA  0           ASSUME NO ERRORS                       00045500
.*                                                                      00045600
               LCLC  &ZCSYSLIST(255)            NONXKEY, POS ARRAY      00045700
               LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()             00045800
               LCLA  &ZPLLEN     PARAMETER LIST LENGTH                  00045900
               LCLC  &ZENDBASEPL                End of base PL          00046000
               LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                  00046100
.*******************************************************************    00046200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00046300
.*******************************************************************    00046400
               LCLA  &ZI         INDEX FOR ARRAY                        00046500
               LCLA  &ZJ         INDEX FOR PARMS                        00046600
               LCLA  &ZK         INDEX FOR PARSE                        00046700
               LCLA  &ZLO        LOW RANGE VALUE                        00046800
               LCLA  &ZHI        HIGH RANGE VALUE                       00046900
               LCLC  &ZW         WORK AREA FOR PARM                     00047000
.********************************************************************   00047100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00047200
.********************************************************************   00047300
               GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                00047400
               GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE         00047500
               GBLA  &SYSALVL    SYSSTATE ARCHLVL                       00047600
               GBLC  &SYSAM64    SYSSTATE AMODE64                       00047700
.*                                                                      00047800
               AIF   (K'&SYSASCE GT 0).ZSYS4    SYS STATE DEFINED       00047900
               AIF   (K'&SYSSPLV GT 0).ZSYS2    SP LEVEL DEFINED        00048000
               SPLEVEL  TEST                                            00048100
.ZSYS2         ANOP  ,                                                  00048200
               AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1              00048300
               AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1              00048400
               SYSSTATE TEST                                            00048500
               AGO   .ZSYS4                                             00048600
.ZSYS3         ANOP  ,                                                  00048700
&SYSASCE       SETC  'P'         ASSUME SYSSTATE PRIMARY                00048800
.ZSYS4         ANOP  ,                                                  00048900
.*******************************************************************    00049000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00049100
.*******************************************************************    00049200
               LCLC  &XTYPE      ++ VALUE                               00049300
               LCLC  &XDATAADDR  ++ NAME                                00049400
               LCLC  &XDATANUM   ++ NAME                                00049500
               LCLC  &XREQUEST   ++ VALUE                               00049600
               LCLC  &XOPTION    ++ VALUE                               00049700
               LCLC  &XSWITCHDEV                ++ NAME                 00049800
               LCLC  &XPORTADDR  ++ NAME                                00049900
               LCLC  &XRETCODE   ++ NAME                                00050000
               LCLC  &XRSNCODE   ++ NAME                                00050100
               LCLA  &XPLISTVER  ++ VALUE                               00050200
               LCLC  &XMF        ++ VALUE                               00050300
               LCLC  &XMFCTRL    ++ NAME                                00050400
               LCLC  &XMFATTR    ++ VALUE                               00050500
               LCLC  &XMFSCK     ++ VALUE                               00050600
.*******************************************************************    00050700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00050800
.*******************************************************************    00050900
               LCLC  &ZXTYPE     ++ INPUT VALUE                         00051000
               LCLC  &ZXDATAADDR                ++ INPUT NAME           00051100
               LCLC  &ZXDATANUM  ++ INPUT NAME                          00051200
               LCLC  &ZXREQUEST  ++ INPUT VALUE                         00051300
               LCLC  &ZXOPTION   ++ INPUT VALUE                         00051400
               LCLC  &ZXSWITCHDEV               ++ INPUT NAME           00051500
               LCLC  &ZXPORTADDR                ++ INPUT NAME           00051600
               LCLC  &ZXRETCODE  ++ OUTPUT NAME                         00051700
               LCLC  &ZXRSNCODE  ++ OUTPUT NAME                         00051800
               LCLC  &ZXPLISTVER                ++ INPUT VALUE          00051900
               LCLC  &ZXMF       ++ INPUT VALUE                         00052000
               LCLC  &ZXMFCTRL   ++ INPUT NAME                          00052100
               LCLC  &ZXMFATTR   ++ INPUT VALUE                         00052200
               LCLC  &ZXMFSCK    ++ INPUT VALUE                         00052300
.********************************************************************   00052400
.***AC.PLV01  PROCESS PLISTVER                                      *   00052500
.********************************************************************   00052600
&XPLISTVER      SETA  1                                                 00052700
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00052800
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00052900
&XPLISTVER      SETA  1                                                 00053000
.ZPLV0          ANOP  ,                                                 00053100
.*                                                                      00053200
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00053300
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00053400
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00053500
.*-------------------------------------------------------------------   00053600
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00053700
&ZMS            SETC  '"PLISTVER='                                      00053800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00053900
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00054000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00054100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00054200
                AGO   .ZPVCK2                                           00054300
.ZPVCK3         ANOP  ,                                                 00054400
.*-------------------------------------------------------------------   00054500
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00054600
&ZMS            SETC  '"PLISTVER='                                      00054700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00054800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00054900
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00055000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00055100
                AGO   .ZPVCKE                                           00055200
.ZPVCK2         ANOP  ,                                                 00055300
.*-------------------------------------------------------------------   00055400
&ZCVAL          SETC  '&PLISTVER(1)'                                    00055500
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00055600
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00055700
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00055800
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00055900
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00056000
.ZPVCK6         ANOP  ,                                                 00056100
&ZMS            SETC  '"PLISTVER='                                      00056200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00056300
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00056400
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00056500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00056600
&XPLISTVER      SETA  1                                                 00056700
                AGO   .ZPVCKE                                           00056800
.*-------------------------------------------------------------------   00056900
.ZPVCK4A        ANOP  ,                                                 00057000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00057100
&ZMS            SETC  'PLISTVER='                                       00057200
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00057300
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00057400
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00057500
                MNOTE 8,' &ZMS IS REQUIRED.'                            00057600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00057700
                AGO   .ZPVCK5                                           00057800
.ZPVCK4         ANOP  ,                                                 00057900
&XPLISTVER      SETA  &PLISTVER(1)                                      00058000
.ZPVCK5         ANOP  ,                                                 00058100
.ZPVCKE         ANOP  ,                                                 00058200
.********************************************************************   00058300
.***AG.MF01 PROCESS MF MACRO FORMS                                      00058400
.********************************************************************   00058500
               ACTR  10000                                              00058600
.*------------------------------------------------------------------    00058700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00058800
&XMF           SETC  ''          INITIALIZE XVARIABLE                   00058900
.*-------------------------------------------------------------------   00059000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00059100
.ZG39          ANOP  ,                                                  00059200
&ZTLC          SETC 'S'                                                 00059300
               AIF   ('&MF(1)' NE '&ZTLC').ZG40                         00059400
&XMF           SETC  'S'         SET KEYWORD                            00059500
               AIF   (N'&MF LE 1).ZG39A         CK NUM                  00059600
&ZMS           SETC  '"MF='                                             00059700
&ZMS           SETC  '&ZMS.&MF"'                                        00059800
&ZMS           SETC  '&ZMS "MF"'                                        00059900
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00060000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00060100
.ZG39A         ANOP  ,                                                  00060200
.*-------------------------------------------------------------------   00060300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00060400
.ZG40          ANOP  ,                                                  00060500
&ZTLC          SETC 'L'                                                 00060600
               AIF   ('&MF(1)' NE '&ZTLC').ZG47                         00060700
&XMF           SETC  'L'         SET KEYWORD                            00060800
               AIF   (N'&MF LE 3).ZG40A         CK NUM                  00060900
&ZMS           SETC  '"MF='                                             00061000
&ZMS           SETC  '&ZMS.&MF"'                                        00061100
&ZMS           SETC  '&ZMS "MF"'                                        00061200
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               00061300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00061400
.ZG40A         ANOP  ,                                                  00061500
.*-------------------------------------------------------------------   00061600
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00061700
               AIF   (N'&SYSLIST NE 0).ZG40B    POSITIONALS?            00061800
               AIF   ('&TYPE' NE '').ZG40B      KEYS?                   00061900
               AIF   ('&DATAADDR' NE '').ZG40B  KEYS?                   00062000
               AIF   ('&DATANUM' NE '').ZG40B   KEYS?                   00062100
               AIF   ('&REQUEST' NE '').ZG40B   KEYS?                   00062200
               AIF   ('&OPTION' NE '').ZG40B    KEYS?                   00062300
               AIF   ('&SWITCHDEV' NE '').ZG40B  KEYS?                  00062400
               AIF   ('&PORTADDR' NE '').ZG40B  KEYS?                   00062500
               AIF   ('&RETCODE' NE '').ZG40B   KEYS?                   00062600
               AIF   ('&RSNCODE' NE '').ZG40B   KEYS?                   00062700
               AGO    .ZG40C     INVOCATION OKAY                        00062800
.ZG40B         ANOP  ,                                                  00062900
&ZMS           SETC  'THE "L" FORM OF "MF"'                             00063000
&ZMS           SETC  '&ZMS CAN ONLY HAVE'                               00063100
&ZMS           SETC  '&ZMS THE "PLISTVER" KEY'                          00063200
               MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'             00063300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00063400
.ZG40C         ANOP  ,                                                  00063500
.*-------------------------------------------------------------------   00063600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00063700
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          00063800
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          00063900
               AIF   (N'&MF(2) GT 1).ZG42B      MULTI PARMS             00064000
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          00064100
.ZG42B         AIF   (K'&MF(2) GT 0).ZG42C                              00064200
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00064300
&ZMS           SETC  'WHEN "L" IS SPECIFIED'                            00064400
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                00064500
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       00064600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00064700
.ZG42C         ANOP  ,                                                  00064800
.*-------------------------------------------------------------------   00064900
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00065000
               AIF   (K'&ZXMFCTRL LE 0).ZG42P   NOT I/O                 00065100
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG42P                     00065200
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00065300
&ZMS           SETC  '"MF='                                             00065400
&ZMS           SETC  '&ZMS.&MF"'                                        00065500
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          00065600
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                  00065700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00065800
.ZG42P         ANOP  ,                                                  00065900
.*-------------------------------------------------------------------   00066000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00066100
&ZXMFATTR      SETC  'INPUT'     SET IN/OUTPUT                          00066200
&XMFATTR       SETC  '0D'                                               00066300
               AIF   (K'&MF(3) LE 0).ZG45B      PARM                    00066400
&XMFATTR       SETC  '&MF(3,1)'  SET XVARIABLE                          00066500
               AIF   (N'&MF(3) GT 1).ZG45B      MULTI                   00066600
&XMFATTR       SETC  '&MF(3)'    SET XVARIABLE                          00066700
.ZG45B         ANOP  ,                                                  00066800
.*-------------------------------------------------------------------   00066900
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00067000
               AIF   (K'&ZXMFATTR LE 0).ZG45P   NOT I/O                 00067100
               AIF   ('&XMFATTR'(1,1) NE '(').ZG45P                     00067200
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        00067300
&ZMS           SETC  '"MF='                                             00067400
&ZMS           SETC  '&ZMS.&MF"'                                        00067500
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          00067600
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                  00067700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00067800
.ZG45P         ANOP  ,                                                  00067900
.*-------------------------------------------------------------------   00068000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00068100
               AIF   (K'&ZXMFATTR LE 0).ZG45S   NOT I/O                 00068200
               AIF   (K'&XMFATTR LE 60).ZG45S   LNG OK                  00068300
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        00068400
&ZMS           SETC  '"MF='                                             00068500
&ZMS           SETC  '&ZMS.&MF"'                                        00068600
&ZMS           SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'              00068700
               MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                 00068800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00068900
.ZG45S         ANOP  ,                                                  00069000
.*-------------------------------------------------------------------   00069100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00069200
.ZG47          ANOP  ,                                                  00069300
&ZTLC          SETC 'E'                                                 00069400
               AIF   ('&MF(1)' NE '&ZTLC').ZG55                         00069500
&XMF           SETC  'E'         SET KEYWORD                            00069600
               AIF   (N'&MF LE 3).ZG47A         CK NUM                  00069700
&ZMS           SETC  '"MF='                                             00069800
&ZMS           SETC  '&ZMS.&MF"'                                        00069900
&ZMS           SETC  '&ZMS "MF"'                                        00070000
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               00070100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00070200
.ZG47A         ANOP  ,                                                  00070300
.*-------------------------------------------------------------------   00070400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00070500
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          00070600
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          00070700
               AIF   (N'&MF(2) GT 1).ZG49B      MULTI PARMS             00070800
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          00070900
.ZG49B         AIF   (K'&MF(2) GT 0).ZG49C                              00071000
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00071100
&ZMS           SETC  'WHEN "E" IS SPECIFIED'                            00071200
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                00071300
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       00071400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00071500
.ZG49C         ANOP  ,                                                  00071600
.*-------------------------------------------------------------------   00071700
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00071800
               AIF   (K'&ZXMFCTRL LE 0).ZG49R   NOT I/O                 00071900
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG49R                     00072000
&ZCGPR         SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                         00072100
               AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                       00072200
               AIF   (K'&ZCGPR GT 2).ZG49Q                              00072300
               AIF   ('&ZCGPR' EQ '0').ZG49Q                            00072400
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00072500
               AIF   (T'&ZCGPR NE 'N').ZG49Q    INVALID REG NAME        00072600
.ZG49P         ANOP  ,                                                  00072700
               AIF   (T'&ZCGPR NE 'N').ZG49R    NON NUMERIC             00072800
               AIF   ('&ZCGPR' LT '1').ZG49Q                            00072900
               AIF   ('&ZCGPR' LE '12').ZG49R                           00073000
.ZG49Q         ANOP  ,                                                  00073100
&ZMS           SETC  '"MF='                                             00073200
&ZMS           SETC  '&ZMS.&MF"'                                        00073300
&ZMS           SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'          00073400
               MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                   00073500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00073600
.ZG49R         ANOP  ,                                                  00073700
.*-------------------------------------------------------------------   00073800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00073900
&XMFSCK        SETC  ''          INITIALIZE XVARIABLE                   00074000
.ZG53A   AIF   ('&MF(3)' NE 'COMPLETE').ZG54A                           00074100
&XMFSCK        SETC  'COMPLETE'  SET KEYWORD                            00074200
.*-------------------------------------------------------------------   00074300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00074400
.ZG54A         AIF   (K'&XMFSCK GT 0).ZG54C     KEYWORD                 00074500
               AIF   (K'&MF(3) LE 0).ZG54B                              00074600
&ZMS           SETC  '"MF='                                             00074700
&ZMS           SETC  '&ZMS.&MF"'                                        00074800
&ZMS           SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '          00074900
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00075000
&ZMS           SETC  '&ZMS "COMPLETE".'                                 00075100
               MNOTE 8,' &ZMS '                                         00075200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00075300
.ZG54B         ANOP  ,                                                  00075400
&XMFSCK        SETC  'COMPLETE'  SET DEFAULT KEYWORD                    00075500
.ZG54C         ANOP  ,                                                  00075600
&ZXMFSCK       SETC  'INPUT'     SET IN/OUTPUT                          00075700
.*------------------------------------------------------------------    00075800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075900
.ZG55          ANOP  ,                                                  00076000
&ZXMF          SETC  'INPUT'     SET IN/OUTPUT                          00076100
               AIF   (K'&XMF GT 0).ZG55E        VALID ARG               00076200
               AIF   (T'&MF EQ 'O').ZG55D       OMITTED                 00076300
&ZASYSLNDX     SETA  0                                                  00076400
.ZG55A         ANOP  ,           POSITIONAL MACRO KEY                   00076500
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       00076600
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG55C                   00076700
&ZTLC          SETC 'MF'                                                00076800
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG55A          00076900
.ZG55B         ANOP  ,                                                  00077000
&ZXMF          SETC  ''          RESET IN/OUTPUT                        00077100
&ZMS           SETC  'THE "MF" KEY'                                     00077200
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            00077300
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   00077400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00077500
               AGO   .ZG55E                                             00077600
.ZG55C         ANOP  ,                                                  00077700
&ZXMF          SETC  ''          RESET IN/OUTPUT                        00077800
&ZMS           SETC  '"MF='                                             00077900
&ZMS           SETC  '&ZMS.&MF"'                                        00078000
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          00078100
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00078200
&ZMS           SETC  '&ZMS "S",'                                        00078300
&ZMS           SETC  '&ZMS "L",'                                        00078400
&ZMS           SETC  '&ZMS OR "E".'                                     00078500
               MNOTE 8,' &ZMS '                                         00078600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00078700
               AGO   .ZG55E                                             00078800
.ZG55D         ANOP  ,                                                  00078900
&XMF           SETC  'S'         SET DEFAULT KEYWORD                    00079000
&XMFSCK        SETC  'COMPLETE'  COMPLETE CHECKING                      00079100
.ZG55E         ANOP  ,                                                  00079200
.********************************************************************   00079300
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00079400
.********************************************************************   00079500
               ACTR  10000                                              00079600
.*-------------------------------------------------------------------   00079700
.***AG.MF03 MF=(SLE)                                                    00079800
               AIF   ('&XMF' EQ 'L').ZGMFX                              00079900
.*------------------------------------------------------------------    00080000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00080100
&XTYPE         SETC  ''          INITIALIZE XVARIABLE                   00080200
.*-------------------------------------------------------------------   00080300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00080400
.ZG3           ANOP  ,                                                  00080500
               AIF   (K'&TYPE(1) LE 0).ZG3A                             00080600
&ZTLC          SETC 'INVOKE'                                            00080700
               AIF   ('&TYPE(1)' NE '&ZTLC').ZG10                       00080800
&XTYPE         SETC  'INVOKE'    SET KEYWORD                            00080900
               AIF   (N'&TYPE LE 1).ZG3A        CK NUM                  00081000
&ZMS           SETC  '"TYPE='                                           00081100
&ZMS           SETC  '&ZMS.&TYPE"'                                      00081200
&ZMS           SETC  '&ZMS "TYPE"'                                      00081300
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00081400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00081500
.ZG3A          ANOP  ,                                                  00081600
.*------------------------------------------------------------------    00081700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00081800
&ZCVAL         SETC ''           CLEAR ERROR KEY ACCUMULATOR            00081900
.ZG3A0         AIF   (K'&REQUEST LE 0).ZG3A1    OK                      00082000
&ZCVAL         SETC '&ZCVAL REQUEST'            INCORRECT KEY USED      00082100
.ZG3A1         AIF   (K'&OPTION LE 0).ZG3A2     OK                      00082200
&ZCVAL         SETC '&ZCVAL OPTION'             INCORRECT KEY USED      00082300
.ZG3A2         AIF   (K'&SWITCHDEV LE 0).ZG3A3  OK                      00082400
&ZCVAL         SETC '&ZCVAL SWITCHDEV'          INCORRECT KEY USED      00082500
.ZG3A3         AIF   (K'&PORTADDR LE 0).ZG3A4   OK                      00082600
&ZCVAL         SETC '&ZCVAL PORTADDR'           INCORRECT KEY USED      00082700
.ZG3A4         AIF   (K'&ZCVAL LE 0).ZG3A5      OK                      00082800
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              00082900
&ZMS           SETC  '"TYPE'                                            00083000
&ZMS           SETC  '&ZMS.=&TYPE"'                                     00083100
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               00083200
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               00083300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00083400
.ZG3A5         ANOP  ,                                                  00083500
.*----------------------------------------------------------------***   00083600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00083700
               AIF   (N'&DATAADDR LE 1).ZG5A    CK NUM                  00083800
&ZMS           SETC  '"DATAADDR='                                       00083900
&ZMS           SETC  '&ZMS.&DATAADDR"'                                  00084000
&ZMS           SETC  '&ZMS "DATAADDR"'                                  00084100
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00084200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00084300
.ZG5A          ANOP  ,                                                  00084400
.*-------------------------------------------------------------------   00084500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00084600
&ZXDATAADDR    SETC  'INPUT'     SET IN/OUTPUT                          00084700
&XDATAADDR     SETC  '&DATAADDR(1)'             SET XVARIABLE           00084800
               AIF   (N'&DATAADDR GT 1).ZG5B    MULTI PARMS             00084900
&XDATAADDR     SETC  '&DATAADDR'                SET XVARIABLE           00085000
.ZG5B          AIF   (K'&DATAADDR(1) GT 0).ZG5C                         00085100
&ZXDATAADDR    SETC  ''          RESET IN/OUTPUT                        00085200
&ZMS           SETC  ' '                                                00085300
&ZMS           SETC  '&ZMS "DATAADDR" KEY AND ITS'                      00085400
               MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                   00085500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00085600
.ZG5C          ANOP  ,                                                  00085700
.*-------------------------------------------------------------------   00085800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00085900
               AIF   (K'&ZXDATAADDR LE 0).ZG5R  NOT I/O                 00086000
               AIF   ('&XDATAADDR'(1,1) NE '(').ZG5R                    00086100
&ZCGPR         SETC  '&XDATAADDR'(2,K'&XDATAADDR-2)                     00086200
               AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                        00086300
               AIF   (K'&ZCGPR GT 2).ZG5Q                               00086400
               AIF   ('&ZCGPR' EQ '0').ZG5Q                             00086500
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00086600
               AIF   (T'&ZCGPR NE 'N').ZG5Q     INVALID REG NAME        00086700
.ZG5P          ANOP  ,                                                  00086800
               AIF   (T'&ZCGPR NE 'N').ZG5R     NON NUMERIC             00086900
               AIF   ('&ZCGPR' LT '2').ZG5Q                             00087000
               AIF   ('&ZCGPR' LE '12').ZG5R                            00087100
.ZG5Q          ANOP  ,                                                  00087200
&ZMS           SETC  '"DATAADDR='                                       00087300
&ZMS           SETC  '&ZMS.&DATAADDR"'                                  00087400
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00087500
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00087600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00087700
.ZG5R          ANOP  ,                                                  00087800
.*----------------------------------------------------------------***   00087900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00088000
               AIF   (N'&DATANUM LE 1).ZG8A     CK NUM                  00088100
&ZMS           SETC  '"DATANUM='                                        00088200
&ZMS           SETC  '&ZMS.&DATANUM"'                                   00088300
&ZMS           SETC  '&ZMS "DATANUM"'                                   00088400
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00088500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00088600
.ZG8A          ANOP  ,                                                  00088700
.*-------------------------------------------------------------------   00088800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00088900
&ZXDATANUM     SETC  'INPUT'     SET IN/OUTPUT                          00089000
&XDATANUM      SETC  '&DATANUM(1)'              SET XVARIABLE           00089100
               AIF   (N'&DATANUM GT 1).ZG8B     MULTI PARMS             00089200
&XDATANUM      SETC  '&DATANUM'  SET XVARIABLE                          00089300
.ZG8B          AIF   (K'&DATANUM(1) GT 0).ZG8C                          00089400
&ZXDATANUM     SETC  ''          RESET IN/OUTPUT                        00089500
&ZMS           SETC  ' '                                                00089600
&ZMS           SETC  '&ZMS "DATANUM" KEY AND ITS'                       00089700
               MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                   00089800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00089900
.ZG8C          ANOP  ,                                                  00090000
.*-------------------------------------------------------------------   00090100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00090200
               AIF   (K'&ZXDATANUM LE 0).ZG8R   NOT I/O                 00090300
               AIF   ('&XDATANUM'(1,1) NE '(').ZG8R                     00090400
&ZCGPR         SETC  '&XDATANUM'(2,K'&XDATANUM-2)                       00090500
               AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                        00090600
               AIF   (K'&ZCGPR GT 2).ZG8Q                               00090700
               AIF   ('&ZCGPR' EQ '0').ZG8Q                             00090800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00090900
               AIF   (T'&ZCGPR NE 'N').ZG8Q     INVALID REG NAME        00091000
.ZG8P          ANOP  ,                                                  00091100
               AIF   (T'&ZCGPR NE 'N').ZG8R     NON NUMERIC             00091200
               AIF   ('&ZCGPR' LT '2').ZG8Q                             00091300
               AIF   ('&ZCGPR' LE '12').ZG8R                            00091400
.ZG8Q          ANOP  ,                                                  00091500
&ZMS           SETC  '"DATANUM='                                        00091600
&ZMS           SETC  '&ZMS.&DATANUM"'                                   00091700
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00091800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00091900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00092000
.ZG8R          ANOP  ,                                                  00092100
.*-------------------------------------------------------------------   00092200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092300
.ZG10          ANOP  ,                                                  00092400
&ZTLC          SETC 'BUILD'                                             00092500
               AIF   ('&TYPE(1)' NE '&ZTLC').ZG27                       00092600
&XTYPE         SETC  'BUILD'     SET KEYWORD                            00092700
               AIF   (N'&TYPE LE 1).ZG10A       CK NUM                  00092800
&ZMS           SETC  '"TYPE='                                           00092900
&ZMS           SETC  '&ZMS.&TYPE"'                                      00093000
&ZMS           SETC  '&ZMS "TYPE"'                                      00093100
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00093200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00093300
.ZG10A         ANOP  ,                                                  00093400
.*------------------------------------------------------------------    00093500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093600
&ZCVAL         SETC ''           CLEAR ERROR KEY ACCUMULATOR            00093700
.ZG10A0        AIF   (K'&DATAADDR LE 0).ZG10A1  OK                      00093800
&ZCVAL         SETC '&ZCVAL DATAADDR'           INCORRECT KEY USED      00093900
.ZG10A1        AIF   (K'&DATANUM LE 0).ZG10A2   OK                      00094000
&ZCVAL         SETC '&ZCVAL DATANUM'            INCORRECT KEY USED      00094100
.ZG10A2        AIF   (K'&ZCVAL LE 0).ZG10A3     OK                      00094200
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              00094300
&ZMS           SETC  '"TYPE'                                            00094400
&ZMS           SETC  '&ZMS.=&TYPE"'                                     00094500
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               00094600
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               00094700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00094800
.ZG10A3        ANOP  ,                                                  00094900
.*------------------------------------------------------------------    00095000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095100
&XREQUEST      SETC  ''          INITIALIZE XVARIABLE                   00095200
.*-------------------------------------------------------------------   00095300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095400
.ZG13          ANOP  ,                                                  00095500
               AIF   (K'&REQUEST(1) LE 0).ZG13A                         00095600
&ZTLC          SETC 'ONLINE'                                            00095700
               AIF   ('&REQUEST(1)' NE '&ZTLC').ZG14                    00095800
&XREQUEST      SETC  'ONLINE'    SET KEYWORD                            00095900
               AIF   (N'&REQUEST LE 1).ZG13A    CK NUM                  00096000
&ZMS           SETC  '"REQUEST='                                        00096100
&ZMS           SETC  '&ZMS.&REQUEST"'                                   00096200
&ZMS           SETC  '&ZMS "REQUEST"'                                   00096300
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00096400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00096500
.ZG13A         ANOP  ,                                                  00096600
.*------------------------------------------------------------------    00096700
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00096800
&ZCVAL         SETC ''           CLEAR ERROR KEY ACCUMULATOR            00096900
.ZG13A0        AIF   (K'&OPTION LE 0).ZG13A1    OK                      00097000
&ZCVAL         SETC '&ZCVAL OPTION'             INCORRECT KEY USED      00097100
.ZG13A1        AIF   (K'&ZCVAL LE 0).ZG13A2     OK                      00097200
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)                              00097300
&ZMS           SETC  '"REQUEST'                                         00097400
&ZMS           SETC  '&ZMS.=&REQUEST"'                                  00097500
&ZMS           SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'               00097600
               MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'               00097700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00097800
.ZG13A2        ANOP  ,                                                  00097900
.*-------------------------------------------------------------------   00098000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098100
.ZG14          ANOP  ,                                                  00098200
&ZTLC          SETC 'OFFLINE'                                           00098300
               AIF   ('&REQUEST(1)' NE '&ZTLC').ZG20                    00098400
&XREQUEST      SETC  'OFFLINE'   SET KEYWORD                            00098500
               AIF   (N'&REQUEST LE 1).ZG14A    CK NUM                  00098600
&ZMS           SETC  '"REQUEST='                                        00098700
&ZMS           SETC  '&ZMS.&REQUEST"'                                   00098800
&ZMS           SETC  '&ZMS "REQUEST"'                                   00098900
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00099000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00099100
.ZG14A         ANOP  ,                                                  00099200
.*------------------------------------------------------------------    00099300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099400
&XOPTION       SETC  ''          INITIALIZE XVARIABLE                   00099500
.*-------------------------------------------------------------------   00099600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099700
.ZG17          ANOP  ,                                                  00099800
               AIF   (K'&OPTION(1) LE 0).ZG17A                          00099900
&ZTLC          SETC 'NONE'                                              00100000
               AIF   ('&OPTION(1)' NE '&ZTLC').ZG18                     00100100
&XOPTION       SETC  'NONE'      SET KEYWORD                            00100200
               AIF   (N'&OPTION LE 1).ZG17A     CK NUM                  00100300
&ZMS           SETC  '"OPTION='                                         00100400
&ZMS           SETC  '&ZMS.&OPTION"'                                    00100500
&ZMS           SETC  '&ZMS "OPTION"'                                    00100600
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00100700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00100800
.ZG17A         ANOP  ,                                                  00100900
.*-------------------------------------------------------------------   00101000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00101100
.ZG18          ANOP  ,                                                  00101200
&ZTLC          SETC 'UNCOND'                                            00101300
               AIF   ('&OPTION(1)' NE '&ZTLC').ZG19                     00101400
&XOPTION       SETC  'UNCOND'    SET KEYWORD                            00101500
               AIF   (N'&OPTION LE 1).ZG18A     CK NUM                  00101600
&ZMS           SETC  '"OPTION='                                         00101700
&ZMS           SETC  '&ZMS.&OPTION"'                                    00101800
&ZMS           SETC  '&ZMS "OPTION"'                                    00101900
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00102000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00102100
.ZG18A         ANOP  ,                                                  00102200
.*------------------------------------------------------------------    00102300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102400
.ZG19          ANOP  ,                                                  00102500
&ZXOPTION      SETC  'INPUT'     SET IN/OUTPUT                          00102600
               AIF   (K'&XOPTION GT 0).ZG19E    VALID ARG               00102700
               AIF   (T'&OPTION EQ 'O').ZG19D   OMITTED                 00102800
&ZASYSLNDX     SETA  0                                                  00102900
.ZG19A         ANOP  ,           POSITIONAL MACRO KEY                   00103000
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       00103100
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG19C                   00103200
&ZTLC          SETC 'OPTION'                                            00103300
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG19A          00103400
.ZG19B         ANOP  ,                                                  00103500
&ZXOPTION      SETC  ''          RESET IN/OUTPUT                        00103600
&ZMS           SETC  'THE "OPTION" KEY'                                 00103700
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            00103800
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   00103900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00104000
               AGO   .ZG19E                                             00104100
.ZG19C         ANOP  ,                                                  00104200
&ZXOPTION      SETC  ''          RESET IN/OUTPUT                        00104300
&ZMS           SETC  '"OPTION='                                         00104400
&ZMS           SETC  '&ZMS.&OPTION"'                                    00104500
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          00104600
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00104700
&ZMS           SETC  '&ZMS "NONE"'                                      00104800
&ZMS           SETC  '&ZMS OR "UNCOND".'                                00104900
               MNOTE 8,' &ZMS '                                         00105000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00105100
               AGO   .ZG19E                                             00105200
.ZG19D         ANOP  ,                                                  00105300
&XOPTION       SETC  'NONE'      SET DEFAULT KEYWORD                    00105400
.ZG19E         ANOP  ,                                                  00105500
.*------------------------------------------------------------------    00105600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105700
.ZG20          ANOP  ,                                                  00105800
&ZXREQUEST     SETC  'INPUT'     SET IN/OUTPUT                          00105900
               AIF   (K'&XREQUEST GT 0).ZG20E   VALID ARG               00106000
               AIF   (T'&REQUEST EQ 'O').ZG20D  OMITTED                 00106100
&ZASYSLNDX     SETA  0                                                  00106200
.ZG20A         ANOP  ,           POSITIONAL MACRO KEY                   00106300
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       00106400
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG20C                   00106500
&ZTLC          SETC 'REQUEST'                                           00106600
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG20A          00106700
.ZG20B         ANOP  ,                                                  00106800
&ZXREQUEST     SETC  ''          RESET IN/OUTPUT                        00106900
&ZMS           SETC  'THE "REQUEST" KEY'                                00107000
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            00107100
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   00107200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00107300
               AGO   .ZG20E                                             00107400
.ZG20C         ANOP  ,                                                  00107500
&ZXREQUEST     SETC  ''          RESET IN/OUTPUT                        00107600
&ZMS           SETC  '"REQUEST='                                        00107700
&ZMS           SETC  '&ZMS.&REQUEST"'                                   00107800
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          00107900
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00108000
&ZMS           SETC  '&ZMS "ONLINE"'                                    00108100
&ZMS           SETC  '&ZMS OR "OFFLINE".'                               00108200
               MNOTE 8,' &ZMS '                                         00108300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00108400
               AGO   .ZG20E                                             00108500
.ZG20D         ANOP  ,                                                  00108600
&XREQUEST      SETC  'ONLINE'    SET DEFAULT KEYWORD                    00108700
.ZG20E         ANOP  ,                                                  00108800
.*----------------------------------------------------------------***   00108900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00109000
               AIF   (N'&SWITCHDEV LE 1).ZG22A  CK NUM                  00109100
&ZMS           SETC  '"SWITCHDEV='                                      00109200
&ZMS           SETC  '&ZMS.&SWITCHDEV"'                                 00109300
&ZMS           SETC  '&ZMS "SWITCHDEV"'                                 00109400
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00109500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00109600
.ZG22A         ANOP  ,                                                  00109700
.*-------------------------------------------------------------------   00109800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00109900
&ZXSWITCHDEV   SETC  'INPUT'     SET IN/OUTPUT                          00110000
&XSWITCHDEV    SETC  '&SWITCHDEV(1)'            SET XVARIABLE           00110100
               AIF   (N'&SWITCHDEV GT 1).ZG22B  MULTI PARMS             00110200
&XSWITCHDEV    SETC  '&SWITCHDEV'               SET XVARIABLE           00110300
.ZG22B         AIF   (K'&SWITCHDEV(1) GT 0).ZG22C                       00110400
&ZXSWITCHDEV   SETC  ''          RESET IN/OUTPUT                        00110500
&ZMS           SETC  ' '                                                00110600
&ZMS           SETC  '&ZMS "SWITCHDEV" KEY AND ITS'                     00110700
               MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                   00110800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00110900
.ZG22C         ANOP  ,                                                  00111000
.*-------------------------------------------------------------------   00111100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00111200
               AIF   (K'&ZXSWITCHDEV LE 0).ZG22R  NOT I/O               00111300
               AIF   ('&XSWITCHDEV'(1,1) NE '(').ZG22R                  00111400
&ZCGPR         SETC  '&XSWITCHDEV'(2,K'&XSWITCHDEV-2)                   00111500
               AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                       00111600
               AIF   (K'&ZCGPR GT 2).ZG22Q                              00111700
               AIF   ('&ZCGPR' EQ '0').ZG22Q                            00111800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00111900
               AIF   (T'&ZCGPR NE 'N').ZG22Q    INVALID REG NAME        00112000
.ZG22P         ANOP  ,                                                  00112100
               AIF   (T'&ZCGPR NE 'N').ZG22R    NON NUMERIC             00112200
               AIF   ('&ZCGPR' LT '2').ZG22Q                            00112300
               AIF   ('&ZCGPR' LE '12').ZG22R                           00112400
.ZG22Q         ANOP  ,                                                  00112500
&ZMS           SETC  '"SWITCHDEV='                                      00112600
&ZMS           SETC  '&ZMS.&SWITCHDEV"'                                 00112700
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00112800
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00112900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00113000
.ZG22R         ANOP  ,                                                  00113100
.*----------------------------------------------------------------***   00113200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00113300
               AIF   (N'&PORTADDR LE 1).ZG25A   CK NUM                  00113400
&ZMS           SETC  '"PORTADDR='                                       00113500
&ZMS           SETC  '&ZMS.&PORTADDR"'                                  00113600
&ZMS           SETC  '&ZMS "PORTADDR"'                                  00113700
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00113800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00113900
.ZG25A         ANOP  ,                                                  00114000
.*-------------------------------------------------------------------   00114100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00114200
&ZXPORTADDR    SETC  'INPUT'     SET IN/OUTPUT                          00114300
&XPORTADDR     SETC  '&PORTADDR(1)'             SET XVARIABLE           00114400
               AIF   (N'&PORTADDR GT 1).ZG25B   MULTI PARMS             00114500
&XPORTADDR     SETC  '&PORTADDR'                SET XVARIABLE           00114600
.ZG25B         AIF   (K'&PORTADDR(1) GT 0).ZG25C                        00114700
&ZXPORTADDR    SETC  ''          RESET IN/OUTPUT                        00114800
&ZMS           SETC  ' '                                                00114900
&ZMS           SETC  '&ZMS "PORTADDR" KEY AND ITS'                      00115000
               MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                   00115100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00115200
.ZG25C         ANOP  ,                                                  00115300
.*-------------------------------------------------------------------   00115400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00115500
               AIF   (K'&ZXPORTADDR LE 0).ZG25R  NOT I/O                00115600
               AIF   ('&XPORTADDR'(1,1) NE '(').ZG25R                   00115700
&ZCGPR         SETC  '&XPORTADDR'(2,K'&XPORTADDR-2)                     00115800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                       00115900
               AIF   (K'&ZCGPR GT 2).ZG25Q                              00116000
               AIF   ('&ZCGPR' EQ '0').ZG25Q                            00116100
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00116200
               AIF   (T'&ZCGPR NE 'N').ZG25Q    INVALID REG NAME        00116300
.ZG25P         ANOP  ,                                                  00116400
               AIF   (T'&ZCGPR NE 'N').ZG25R    NON NUMERIC             00116500
               AIF   ('&ZCGPR' LT '2').ZG25Q                            00116600
               AIF   ('&ZCGPR' LE '12').ZG25R                           00116700
.ZG25Q         ANOP  ,                                                  00116800
&ZMS           SETC  '"PORTADDR='                                       00116900
&ZMS           SETC  '&ZMS.&PORTADDR"'                                  00117000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00117100
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00117200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00117300
.ZG25R         ANOP  ,                                                  00117400
.*------------------------------------------------------------------    00117500
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117600
.ZG27          ANOP  ,                                                  00117700
&ZXTYPE        SETC  'INPUT'     SET IN/OUTPUT                          00117800
               AIF   (K'&XTYPE GT 0).ZG27E      VALID ARG               00117900
               AIF   (T'&TYPE EQ 'O').ZG27D     OMITTED                 00118000
&ZASYSLNDX     SETA  0                                                  00118100
.ZG27A         ANOP  ,           POSITIONAL MACRO KEY                   00118200
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       00118300
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG27C                   00118400
&ZTLC          SETC 'TYPE'                                              00118500
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG27A          00118600
.ZG27B         ANOP  ,                                                  00118700
&ZXTYPE        SETC  ''          RESET IN/OUTPUT                        00118800
&ZMS           SETC  'THE "TYPE" KEY'                                   00118900
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            00119000
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   00119100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00119200
               AGO   .ZG27E                                             00119300
.ZG27C         ANOP  ,                                                  00119400
&ZXTYPE        SETC  ''          RESET IN/OUTPUT                        00119500
&ZMS           SETC  '"TYPE='                                           00119600
&ZMS           SETC  '&ZMS.&TYPE"'                                      00119700
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          00119800
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00119900
&ZMS           SETC  '&ZMS "INVOKE"'                                    00120000
&ZMS           SETC  '&ZMS OR "BUILD".'                                 00120100
               MNOTE 8,' &ZMS '                                         00120200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00120300
               AGO   .ZG27E                                             00120400
.ZG27D         ANOP  ,                                                  00120500
&XTYPE         SETC  'INVOKE'    SET DEFAULT KEYWORD                    00120600
.ZG27E         ANOP  ,                                                  00120700
.*------------------------------------------------------------------    00120800
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00120900
               AIF   (K'&TYPE(1) GT 0).ZG27F    PARM                    00121000
&XTYPE         SETC  ''          ENSURE NULL KEYWORD                    00121100
&ZXTYPE        SETC  ''          RESET IN/OUTPUT                        00121200
&ZMS           SETC  'THE'                                              00121300
&ZMS           SETC  '&ZMS "TYPE" KEY AND ITS'                          00121400
&ZMS           SETC  '&ZMS ARGUMENT ARE REQUIRED.'                      00121500
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00121600
&ZMS           SETC  '&ZMS "INVOKE"'                                    00121700
&ZMS           SETC  '&ZMS OR "BUILD".'                                 00121800
               MNOTE 8,' &ZMS '                                         00121900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00122000
.ZG27F         ANOP  ,                                                  00122100
.*----------------------------------------------------------------***   00122200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00122300
               AIF   (N'&RETCODE LE 1).ZG29A    CK NUM                  00122400
&ZMS           SETC  '"RETCODE='                                        00122500
&ZMS           SETC  '&ZMS.&RETCODE"'                                   00122600
&ZMS           SETC  '&ZMS "RETCODE"'                                   00122700
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00122800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00122900
.ZG29A         ANOP  ,                                                  00123000
.*-------------------------------------------------------------------   00123100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00123200
               AIF   (K'&RETCODE(1) LE 0).ZG29C  NO PARM                00123300
&ZXRETCODE     SETC  'OUTPUT'    SET OUTPUT                             00123400
&XRETCODE      SETC  '&RETCODE(1)'              SET XVARIABLE           00123500
               AIF   (N'&RETCODE GT 1).ZG29C                            00123600
&XRETCODE      SETC  '&RETCODE'  SET XVARIABLE                          00123700
.ZG29C         ANOP  ,                                                  00123800
.*-------------------------------------------------------------------   00123900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00124000
               AIF   (K'&ZXRETCODE LE 0).ZG29R  NOT I/O                 00124100
               AIF   ('&XRETCODE'(1,1) NE '(').ZG29R                    00124200
&ZCGPR         SETC  '&XRETCODE'(2,K'&XRETCODE-2)                       00124300
               AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                       00124400
               AIF   (K'&ZCGPR GT 2).ZG29Q                              00124500
               AIF   ('&ZCGPR' EQ '0').ZG29Q                            00124600
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00124700
               AIF   (T'&ZCGPR NE 'N').ZG29Q    INVALID REG NAME        00124800
.ZG29P         ANOP  ,                                                  00124900
               AIF   (T'&ZCGPR NE 'N').ZG29R    NON NUMERIC             00125000
               AIF   ('&ZCGPR' LT '2').ZG29Q                            00125100
               AIF   ('&ZCGPR' LE '12').ZG29R                           00125200
.ZG29Q         ANOP  ,                                                  00125300
&ZMS           SETC  '"RETCODE='                                        00125400
&ZMS           SETC  '&ZMS.&RETCODE"'                                   00125500
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00125600
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00125700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00125800
.ZG29R         ANOP  ,                                                  00125900
.*----------------------------------------------------------------***   00126000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00126100
               AIF   (N'&RSNCODE LE 1).ZG32A    CK NUM                  00126200
&ZMS           SETC  '"RSNCODE='                                        00126300
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   00126400
&ZMS           SETC  '&ZMS "RSNCODE"'                                   00126500
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00126600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00126700
.ZG32A         ANOP  ,                                                  00126800
.*-------------------------------------------------------------------   00126900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00127000
               AIF   (K'&RSNCODE(1) LE 0).ZG32C  NO PARM                00127100
&ZXRSNCODE     SETC  'OUTPUT'    SET OUTPUT                             00127200
&XRSNCODE      SETC  '&RSNCODE(1)'              SET XVARIABLE           00127300
               AIF   (N'&RSNCODE GT 1).ZG32C                            00127400
&XRSNCODE      SETC  '&RSNCODE'  SET XVARIABLE                          00127500
.ZG32C         ANOP  ,                                                  00127600
.*-------------------------------------------------------------------   00127700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00127800
               AIF   (K'&ZXRSNCODE LE 0).ZG32R  NOT I/O                 00127900
               AIF   ('&XRSNCODE'(1,1) NE '(').ZG32R                    00128000
&ZCGPR         SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                       00128100
               AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                       00128200
               AIF   (K'&ZCGPR GT 2).ZG32Q                              00128300
               AIF   ('&ZCGPR' EQ '0').ZG32Q                            00128400
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00128500
               AIF   (T'&ZCGPR NE 'N').ZG32Q    INVALID REG NAME        00128600
.ZG32P         ANOP  ,                                                  00128700
               AIF   (T'&ZCGPR NE 'N').ZG32R    NON NUMERIC             00128800
               AIF   ('&ZCGPR' LT '2').ZG32Q                            00128900
               AIF   ('&ZCGPR' LE '12').ZG32R                           00129000
.ZG32Q         ANOP  ,                                                  00129100
&ZMS           SETC  '"RSNCODE='                                        00129200
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   00129300
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00129400
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00129500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00129600
.ZG32R         ANOP  ,                                                  00129700
.******************************************************************     00129800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00129900
.******************************************************************     00130000
               ACTR  10000                                              00130100
.*----------------------------------------------------------------***   00130200
.***AH.P02 EXTRA POSITIONALS                                            00130300
               AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS               00130400
               AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL               00130500
               AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL           00130600
               AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL            00130700
.ZGLISTX1      ANOP  ,                                                  00130800
&ZCVAL         SETC  ''          ERROR FIELD                            00130900
&ZAWRK         SETA  0           POSITIONAL NUMBER                      00131000
.ZGLIST2       ANOP  ,                                                  00131100
&ZAWRK         SETA  &ZAWRK+1    NEXT POSITIONAL                        00131200
               AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE               00131300
&ZCVAL         SETC '&ZCVAL,&SYSLIST(&ZAWRK)'   EXTRA                   00131400
               AGO   .ZGLIST2                                           00131500
.*                                                                      00131600
.ZGLIST3       ANOP  ,                                                  00131700
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)      STRIP COMMA             00131800
&ZMS           SETC  'POSITIONAL ARGUMENT(S),'                          00131900
&ZMS           SETC  '&ZMS "&ZCVAL"'                                    00132000
&ZMS           SETC  '&ZMS CANNOT BE USED.'                             00132100
&ZMS           SETC  '&ZMS NO POSITIONAL ARGUMENTS'                     00132200
               MNOTE 8,' &ZMS ARE ALLOWED.'                             00132300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00132400
.ZGLISTX       ANOP  ,                                                  00132500
&ZASYSLNDX     SETA  0                                                  00132600
.*-------------------------------------------------------------------   00132700
.***AG.MF04 MF=(SLE)                                                    00132800
.ZGMFX         ANOP  ,           END OF FULL SYNTAX CHECK               00132900
.*******************************************************************    00133000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00133100
.*******************************************************************    00133200
               AIF   (&ZMACRET NE 0).ZLX2       ERROR DETECTED          00133300
.*******************************************************************    00133400
.***AE.01  START OF IOSVRYSW MACRO CODE                                 00133500
.*******************************************************************    00133600
               LCLC  &M0M0001                 NAME                      00133700
&M0M0001       SETC  '&XLABEL'                SET NAME                  00133800
               AIF   (K'&XLABEL NE 0).XLAB2                             00133900
&M0M0001       SETC  'M00M&SYSNDX'            DEFAULT NAME              00134000
.*                                                                      00134100
.XLAB2         ANOP  ,                                                  00134200
               AIF   ('&XMF' EQ 'L').XLAB3                              00134300
&M0M0001 DS    0H                             IOSVRYSW-1                00134400
.XLAB3         ANOP  ,                                                  00134500
.*******************************************************************    00134600
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00134700
.*******************************************************************    00134800
              PUSH  PRINT                                               00134900
               AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON         00135000
               PRINT OFF         ++ PR01                                00135100
               AGO   .ZPRNTXX                                           00135200
.ZPRINTX       PRINT ON                                                 00135300
.ZPRNTXX       ANOP  ,                                                  00135400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00135500
.********************************************************************   00135600
.*   IF THIS IS NOT A BUILD REQUEST, BRANCH TO THE CODE THAT LINKS  *   00135700
.*   TO THE NEW MODULE.                                             *   00135800
.*                                                                  *   00135900
.*   IF THIS IS A BUILD REQUEST, MAKE SURE THAT NO CONFLICTING      *   00136000
.*   MACRO KEYWORDS ARE PRESENT, AND THEN BUILD THE VSAP ELEMENT.   *   00136100
.********************************************************************   00136200
.CHKBUILD ANOP                                                          00136300
          AIF   ('&TYPE' NE 'BUILD').NOTBUILD                           00136400
.BUILDREQ ANOP                                                          00136500
          AIF   ('&MF' NE '').BLDERR1                                   00136600
          AIF   ('&RETCODE' NE '').BLDERR2                              00136700
          AIF   ('&RSNCODE' NE '').BLDERR3                              00136800
.BLDRCFP  ANOP                                                          00136900
.********************************************************************   00137000
.*   FILL IN THOSE FIELDS THAT ARE COMMON TO ALL REQUESTS.          *   00137100
.********************************************************************   00137200
          XC    VSAP_RESOURCE(VSAPSIZE),VSAP_RESOURCE                   00137300
          MVC   VSAP_ID,=CL4'VSAP'                                      00137400
          MVI   VSAP_VER,VSAPVRSN                                       00137500
              AIF   ('&REQUEST' EQ 'ONLINE').REQON                      00137600
          OI    VSAP_FLAGS,VSAP_OFFLINE                                 00137700
              AIF   ('&OPTION' NE 'UNCOND').DOSWITCH                    00137800
          OI    VSAP_FLAGS,VSAP_UNCOND                                  00137900
              AGO   .DOSWITCH                                           00138000
.REQON    ANOP                                                          00138100
          OI    VSAP_FLAGS,VSAP_ONLINE                                  00138200
.DOSWITCH     ANOP                                                      00138300
              AIF   ('&SWITCHDEV' EQ '').SWTDONE IF SWITCH NOT SPCFD,   00138400
              AIF   ('&SWITCHDEV' EQ 'OUTPUT').SWTDONE                  00138500
&ZCGPR        SETC  '&XSWITCHDEV'            TAKE THE ENTIRE KEY VALUE  00138600
.*                                                                      00138700
              AIF   ('&XSWITCHDEV'(1,1) NE '(').GETDIGIT IF NOT (reg)   00138800
&ZCGPR   SETC  '0('.'&XSWITCHDEV'(2,K'&XSWITCHDEV-2).')'    SET 0(reg)  00138900
              AGO   .SETCDONE                                           00139000
.GETDIGIT     ANOP  ,                                                   00139100
.*                                                                      00139200
&ZC           SETC  '&XSWITCHDEV'(1,1)          TAKE FIRST DIGIT        00139300
              AIF   (T'&ZC NE 'N').SETCDONE  IF NOT SELF-DEFINING,      00139400
&ZC           SETC  '&XSWITCHDEV'            TAKE THE CONSTANT          00139500
              AIF   ('&ZC'(K'&ZC,1) EQ ')').SETCDONE  IF RIGHT PAREN,   00139600
&ZCGPR        SETC  '=AL2(&XSWITCHDEV)'              LITERAL CONSTANT   00139700
.*                                                                      00139800
.SETCDONE     ANOP  ,                                                   00139900
.*                                                                      00140000
          MVC   VSAP_SWITCHDEV,&ZCGPR                                   00140100
.*                                                                      00140200
.SWTDONE      ANOP  ,                                                   00140300
.*                                                                      00140400
.DOPORT       ANOP                                                      00140500
              AIF   ('&PORTADDR' EQ '').PRTDONE IF PORT NOT SPCFD,      00140600
              AIF   ('&PORTADDR' EQ 'OUTPUT').PRTDONE                   00140700
&ZCXPR        SETC  '&XPORTADDR'             TAKE THE ENTIRE KEY VALUE  00140800
.*                                                                      00140900
              AIF   ('&XPORTADDR'(1,1) NE '(').GETDIGIT2 IF NOT (reg)   00141000
&ZCXPR   SETC  '0('.'&XPORTADDR'(2,K'&XPORTADDR-2).')'      SET 0(reg)  00141100
              AGO   .SETCDON2                                           00141200
.GETDIGIT2    ANOP  ,                                                   00141300
.*                                                                      00141400
&ZC           SETC  '&XPORTADDR'(1,1)           TAKE FIRST DIGIT        00141500
              AIF   (T'&ZC NE 'N').SETCDON2  IF NOT SELF-DEFINING,      00141600
&ZC           SETC  '&XPORTADDR'             TAKE THE CONSTANT          00141700
              AIF   ('&ZC'(K'&ZC,1) EQ ')').SETCDON2  IF RIGHT PAREN,   00141800
&ZCXPR        SETC  '=AL1(&XPORTADDR)'               LITERAL CONSTANT   00141900
.*                                                                      00142000
.SETCDON2     ANOP  ,                                                   00142100
.*                                                                      00142200
          MVC   VSAP_PORTADDR,&ZCXPR                                    00142300
.*                                                                      00142400
.PRTDONE      ANOP  ,                                                   00142500
.*-----------------------------------------------------------------     00142600
          AGO   .BLDDONE                                                00142700
.********************************************************************   00142800
.*   MNOTES ASSOCIATED WITH TYPE=BUILD (WITH CONFLICTING KEYWORDS)  *   00142900
.********************************************************************   00143000
.BLDERR1  ANOP                                                          00143100
          MNOTE 8,'MF MAY NOT BE SPECIFIED WITH TYPE=BUILD'             00143200
          MEXIT                                                         00143300
.BLDERR2  ANOP                                                          00143400
          MNOTE 8,'RETCODE MAY NOT BE SPECIFIED WITH TYPE=BUILD'        00143500
          MEXIT                                                         00143600
.BLDERR3  ANOP                                                          00143700
          MNOTE 8,'RSNCODE MAY NOT BE SPECIFIED WITH TYPE=BUILD'        00143800
          MEXIT                                                         00143900
.BLDDONE  ANOP                                                          00144000
          POP   PRINT                                                   00144100
          MEXIT                                                         00144200
.NOTBUILD ANOP                                                          00144300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00144400
.********************************************************************   00144500
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00144600
.********************************************************************   00144700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00144800
                      LCLA  &ZOPN1         INVOCATION INDEX             00144900
                      LCLC  &ZOPL(4095)    LABEL                        00145000
                      LCLC  &ZOPO(4095)    OPERATION                    00145100
                      LCLC  &ZOPV(4095)    VALUE                        00145200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00145300
.*                                                                      00145400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00145500
.******************************************************************     00145600
.***AL.L10 IOSVRYSW FMT=LIST MF=S!L PARAMETERS                          00145700
.******************************************************************     00145800
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00145900
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00146000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00146100
&XMFATTR              SETC  '0D'                                        00146200
.*                                                                      00146300
&ZOPN                 SETA  &ZOPN+1                                     00146400
&ZOPL(&ZOPN)          SETC  ' '                                         00146500
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00146600
&ZOPO(&ZOPN)          SETC  'B'                                         00146700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00146800
                      AGO   .ZALVL6B                                    00146900
.ZALVL6A              ANOP                                              00147000
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00147100
&ZOPV(&ZOPN)          SETC  '4,8'                                       00147200
&ZOPN                 SETA  &ZOPN+1                                     00147300
&ZOPL(&ZOPN)          SETC  ' '                                         00147400
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00147500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00147600
.ZALVL6B              ANOP                                              00147700
&ZOPD(&ZOPN)          SETC  '++ IOSVRYSW ARG PARMS'                     00147800
.*                                                                      00147900
&ZOPN                 SETA  &ZOPN+1                                     00148000
&ZOPL(&ZOPN)          SETC  ' '                                         00148100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00148200
&ZOPV(&ZOPN)          SETC  '1'                                         00148300
&ZOPD(&ZOPN)          SETC  ' '                                         00148400
.*                                                                      00148500
.ZLMFSL2              ANOP  ,                                           00148600
.*-------------------------------------------------------------------   00148700
.***AM.L00  IOSVRYSW FMT=LIST name                                      00148800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00148900
&ZOPN                 SETA &ZOPN+1                                      00149000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00149100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00149200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00149300
&ZOPD(&ZOPN)          SETC '++ IOSVRYSW NAME'                           00149400
.ZLMFSL2M             ANOP  ,                                           00149500
.*-------------------------------------------------------------------   00149600
.***AM.L01  IOSVRYSW FMT=LIST PARAMETERS                                00149700
&ZOPN                 SETA &ZOPN+1                                      00149800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00149900
&ZOPO(&ZOPN)          SETC 'DS'                                         00150000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00150100
&ZOPD(&ZOPN)          SETC '++ IOSVRYSW PARM LIST'                      00150200
.*-------------------------------------------------------------------   00150300
.***AM.L09  XID CL5                                                     00150400
&ZOPN                 SETA &ZOPN+1                                      00150500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XID'                              00150600
&ZOPO(&ZOPN)          SETC 'DS'                                         00150700
&ZOPV(&ZOPN)          SETC 'CL5'                                        00150800
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00150900
.*-------------------------------------------------------------------   00151000
.***AM.L02 XVERSION XL1                                                 00151100
&ZOPN                 SETA &ZOPN+1                                      00151200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00151300
&ZOPO(&ZOPN)          SETC 'DS'                                         00151400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00151500
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00151600
.*-------------------------------------------------------------------   00151700
.***AM.L09  XRSV001 CL2                                                 00151800
&ZOPN                 SETA &ZOPN+1                                      00151900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV001'                          00152000
&ZOPO(&ZOPN)          SETC 'DS'                                         00152100
&ZOPV(&ZOPN)          SETC 'CL2'                                        00152200
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00152300
.*-------------------------------------------------------------------   00152400
.***AM.L09  XDATANUM F                                                  00152500
&ZOPN                 SETA &ZOPN+1                                      00152600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATANUM'                         00152700
&ZOPO(&ZOPN)          SETC 'DS'                                         00152800
&ZOPV(&ZOPN)          SETC 'F'                                          00152900
&ZOPD(&ZOPN)          SETC '++ &ZXDATANUM '                             00153000
.*-------------------------------------------------------------------   00153100
.***AM.L09  XDATAADDR A                                                 00153200
&ZOPN                 SETA &ZOPN+1                                      00153300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATAADDR'                        00153400
&ZOPO(&ZOPN)          SETC 'DS'                                         00153500
&ZOPV(&ZOPN)          SETC 'A'                                          00153600
&ZOPD(&ZOPN)          SETC '++ &ZXDATAADDR '                            00153700
.*-------------------------------------------------------------------   00153800
.***AM.L10 END OF IOSVRYSW LIST PARAMETERS                              00153900
&ZOPN                 SETA &ZOPN+1                                      00154000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00154100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00154200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00154300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00154400
.*                                                                      00154500
&ZOPN                 SETA &ZOPN+1                                      00154600
&ZOPL(&ZOPN)          SETC ' '                                          00154700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00154800
&ZOPV(&ZOPN)          SETC '1'                                          00154900
&ZOPD(&ZOPN)          SETC ' '                                          00155000
.*-------------------------------------------------------------------   00155100
.***AL.L12 IOSVRYSW FMT=LIST MF=S!L PARAMETERS                          00155200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00155300
.*                                                                      00155400
&ZOPN                 SETA  &ZOPN+1                                     00155500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00155600
&ZOPO(&ZOPN)          SETC  'DC'                                        00155700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00155800
&ZOPD(&ZOPN)          SETC  '++ IOSVRYSW ARG PARMS'                     00155900
.*                                                                      00156000
.ZLMFSLX              ANOP  ,                                           00156100
.*-------------------------------------------------------------------   00156200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00156300
&ZPLLEN               SETA 16                                           00156400
.*                                                                      00156500
.******************************************************************     00156600
.***AI.L01 IOSVRYSW FMT=LIST FILL IN PARAMETER AREA                     00156700
.******************************************************************     00156800
                      ACTR  10000                                       00156900
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00157000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00157100
&ZCVAL                SETC  'LAE'          XAX MODE                     00157200
.ZIMFXA               ANOP ,                                            00157300
.*                                                                      00157400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00157500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00157600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00157700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00157800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00157900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00158000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00158100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00158200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00158300
&ZOPN                 SETA  &ZOPN+1                                     00158400
&ZOPL(&ZOPN)          SETC  ' '                                         00158500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00158600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00158700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00158800
                      AGO   .ZIMFNX                                     00158900
.*                                                                      00159000
.ZIMFN2               ANOP ,                                            00159100
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00159200
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00159300
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00159400
&ZOPN                 SETA  &ZOPN+1                                     00159500
&ZOPL(&ZOPN)          SETC  ' '                                         00159600
&ZOPO(&ZOPN)          SETC  'LAE'                                       00159700
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00159800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00159900
                      AGO   .ZIMFNX                                     00160000
.ZIMFNX1              ANOP ,                                            00160100
&ZOPN                 SETA  &ZOPN+1                                     00160200
&ZOPL(&ZOPN)          SETC  ' '                                         00160300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00160400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00160500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00160600
.ZIMFNX               ANOP ,                                            00160700
.********************************************************************   00160800
.***AI.L02 IOSVRYSW FMT=LIST INITIALIZE PARAMETER AREA                  00160900
.********************************************************************   00161000
.***AI.L03 MF=(SLE)                                                     00161100
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00161200
.*                                                                      00161300
&ZOPN                 SETA  &ZOPN+1                                     00161400
&ZOPL(&ZOPN)          SETC  ' '                                         00161500
&ZOPO(&ZOPN)          SETC  'XC'                                        00161600
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00161700
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00161800
.ZIMFLX               ANOP  ,                                           00161900
.*-------------------------------------------------------------------   00162000
.***AI.L60 XID CL5                                                      00162100
&ZOPN                 SETA  &ZOPN+1                                     00162200
&ZOPL(&ZOPN)          SETC  ' '                                         00162300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00162400
&ZOPV(&ZOPN)          SETC  '0(5,1),=CL5''VSAPI'''                      00162500
&ZOPD(&ZOPN)          SETC  '++ CL5 CONSTANT'                           00162600
.*-------------------------------------------------------------------   00162700
.***AI.L04B XVERSION XL1                                                00162800
                      AIF   (&XPLISTVER EQ 0).ZIMFVZ                    00162900
&ZOPN                 SETA  &ZOPN+1                                     00163000
&ZOPL(&ZOPN)          SETC  ' '                                         00163100
&ZOPO(&ZOPN)          SETC  'MVI'                                       00163200
&ZOPV(&ZOPN)          SETC  '5(1),&XPLISTVER'                           00163300
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00163400
.ZIMFVZ               ANOP  ,                                           00163500
.*-------------------------------------------------------------------   00163600
.***AI.L25  XDATANUM F                                                  00163700
                      AIF   ('&ZXDATANUM' EQ '').ZI4E                   00163800
                      AIF   ('&ZXDATANUM' EQ 'OUTPUT').ZI4E             00163900
&ZCGPR                SETC  '&XDATANUM'                                 00164000
.*                                                                      00164100
                      AIF   ('&XDATANUM'(1,1) NE '(').ZI4B              00164200
&ZCGPR   SETC  '0('.'&XDATANUM'(2,K'&XDATANUM-2).')'                    00164300
                      AGO   .ZI4D                                       00164400
.ZI4B                 ANOP  ,                                           00164500
.*                                                                      00164600
&ZC                   SETC  '&XDATANUM'(1,1)                            00164700
                      AIF   (T'&ZC NE 'N').ZI4D                         00164800
&ZC                   SETC  '&XDATANUM'                                 00164900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI4D                00165000
&ZCGPR                SETC  '=FL4''&XDATANUM'''                         00165100
.*                                                                      00165200
.ZI4D                 ANOP  ,                                           00165300
.*                                                                      00165400
&ZOPN                 SETA  &ZOPN+1                                     00165500
&ZOPL(&ZOPN)          SETC  ' '                                         00165600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00165700
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00165800
&ZOPD(&ZOPN)          SETC  '++ &ZXDATANUM XDATANUM'                    00165900
.*                                                                      00166000
.ZI4E                 ANOP  ,                                           00166100
.*-------------------------------------------------------------------   00166200
.***AI.L25  XDATAADDR AL4                                               00166300
                      AIF   ('&ZXDATAADDR' EQ '').ZI5E                  00166400
                      AIF   ('&ZXDATAADDR' EQ 'OUTPUT').ZI5E            00166500
&ZCGPR                SETC  '&XDATAADDR'                                00166600
.*                                                                      00166700
                      AIF   ('&XDATAADDR'(1,1) NE '(').ZI5B             00166800
&ZCGPR   SETC  '0('.'&XDATAADDR'(2,K'&XDATAADDR-2).')'                  00166900
                      AGO   .ZI5D                                       00167000
.ZI5B                 ANOP  ,                                           00167100
.*                                                                      00167200
&ZC                   SETC  '&XDATAADDR'(1,1)                           00167300
                      AIF   (T'&ZC NE 'N').ZI5D                         00167400
&ZC                   SETC  '&XDATAADDR'                                00167500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                00167600
&ZCGPR                SETC  '=AL4(&XDATAADDR)'                          00167700
.*                                                                      00167800
.ZI5D                 ANOP  ,                                           00167900
.*                                                                      00168000
&ZOPN                 SETA  &ZOPN+1                                     00168100
&ZOPL(&ZOPN)          SETC  ' '                                         00168200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00168300
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00168400
&ZOPD(&ZOPN)          SETC  '++ &ZXDATAADDR XDATAADDR'                  00168500
.*                                                                      00168600
.ZI5E                 ANOP  ,                                           00168700
.*-------------------------------------------------------------------   00168800
&ZOPN1                SETA &ZOPN                                        00168900
.*******************************************************************    00169000
.***  PROCESS IOSVRYSW OUTPUT PARAMETERS                                00169100
.*******************************************************************    00169200
                      ACTR  10000                                       00169300
.*******************************************************************    00169400
.***AO.X02  RETURN CODE PROCESSING                                      00169500
.*******************************************************************    00169600
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00169700
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00169800
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00169900
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00170000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00170100
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00170200
&ZOPN                 SETA  &ZOPN+1                                     00170300
&ZOPL(&ZOPN)          SETC  ' '                                         00170400
&ZOPO(&ZOPN)          SETC  'ST'                                        00170500
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00170600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00170700
                      AGO   .ZMRETX                                     00170800
.*                                                                      00170900
.ZMRET2               ANOP  ,                                           00171000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00171100
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00171200
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00171300
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00171400
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00171500
&ZOPN                 SETA  &ZOPN+1                                     00171600
&ZOPL(&ZOPN)          SETC  ' '                                         00171700
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00171800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00171900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00172000
.ZMRETX               ANOP  ,                                           00172100
.*******************************************************************    00172200
.***AO.X03  REASON CODE PROCESSING                                      00172300
.*******************************************************************    00172400
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00172500
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00172600
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00172700
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00172800
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00172900
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00173000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00173100
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00173200
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00173300
&ZOPN                 SETA  &ZOPN+1                                     00173400
&ZOPL(&ZOPN)          SETC  ' '                                         00173500
&ZOPO(&ZOPN)          SETC  'ST'                                        00173600
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00173700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00173800
                      AGO   .ZMRSNX                                     00173900
.*                                                                      00174000
.ZMRSN2               ANOP  ,                                           00174100
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00174200
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00174300
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00174400
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00174500
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00174600
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00174700
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00174800
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00174900
&ZOPN                 SETA  &ZOPN+1                                     00175000
&ZOPL(&ZOPN)          SETC  ' '                                         00175100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00175200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00175300
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00175400
.ZMRSNX               ANOP  ,                                           00175500
.*******************************************************************    00175600
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00175700
.*******************************************************************    00175800
.ZMFLX                ANOP  ,              MF=L PROCESSING              00175900
.*******************************************************************    00176000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00176100
.*******************************************************************    00176200
                      ACTR  10000                                       00176300
.*                                                                      00176400
                      LCLA  &ZLC           COLUMN POSITION              00176500
                      LCLA  &ZOPX          LIST TABLE INDEX             00176600
                      LCLC  &ZLL           LABEL                        00176700
                      LCLC  &ZLOP          OPERATION                    00176800
                      LCLC  &ZLV           VALUE                        00176900
                      LCLC  &ZLD           DESCRIPTION                  00177000
.*                                                                      00177100
&ZOPX                 SETA  1                                           00177200
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00177300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00177400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00177500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00177600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00177700
                      AIF   (K'&ZLD LE 0).ZL5                           00177800
&ZLC                  SETA  35             COMMENT COLUMN               00177900
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00178000
&ZLC                  SETA  33             COMMMENT COLUMN              00178100
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00178200
&ZLV                  SETC  '&ZLV'.' '                                  00178300
                      AGO   .ZL3                                        00178400
.*                                                                      00178500
.ZL4                  ANOP  ,                                           00178600
&ZLV                  SETC  '&ZLV'.' '                                  00178700
.ZL5                  ANOP  ,                                           00178800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00178900
.*                                                                      00179000
&ZLL     &ZLOP &ZLV                                                     00179100
.*                                                                      00179200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00179300
                      AGO   .ZL2           CONTINUE LOOPING             00179400
.*                                                                      00179500
.ZLX                  ANOP  ,                                           00179600
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00179700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00179800
.********************************************************************   00179900
.*   LINK TO THE PROCESSING MODULE IOSVVSWF FOR AN INVOKE REQUEST.  *   00180000
.********************************************************************   00180100
.INVREQ   ANOP                                                          00180200
          LINK  EP=IOSVVSWF            Link to the module               00180300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00180400
.ZLINKX               ANOP  ,                                           00180500
.*******************************************************************    00180600
.***AP.X01  FORMAT GENERATED CODE                                       00180700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00180800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00180900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00181000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00181100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00181200
                      AIF   (K'&ZLD LE 0).ZL51                          00181300
&ZLC                  SETA  35             COMMENT COLUMN               00181400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00181500
&ZLC                  SETA  33             COMMENT COLUMN               00181600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00181700
&ZLV                  SETC  '&ZLV'.' '                                  00181800
                      AGO   .ZL31                                       00181900
.*                                                                      00182000
.ZL41                 ANOP  ,                                           00182100
&ZLV                  SETC  '&ZLV'.' '                                  00182200
.ZL51                 ANOP  ,                                           00182300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00182400
.*                                                                      00182500
&ZLL     &ZLOP &ZLV                                                     00182600
.*                                                                      00182700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00182800
                      AGO   .ZL21          CONTINUE LOOPING             00182900
.*                                                                      00183000
.ZLX1                 ANOP  ,                                           00183100
.*******************************************************************    00183200
.***AP.X02  END OF IOSVRYSW MACRO                                       00183300
&ZIOSVRYSW            SETC  'YES'          SET IOSVRYSW USED            00183400
         POP   PRINT                                                    00183500
*                                            IOSVRYSW-1                 00183600
         SPACE 1                                                        00183700
.ZLX2                 ANOP  ,                                           00183800
         MEND                                                           00183900
**********************************************************************/ 00184000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00184100
*%IOSVRYSW: MACRO KEYS(TYPE,DATAADDR,DATANUM,REQUEST,OPTION,SWITCHDEV,  00184200
*                 PORTADDR,RETCODE,RSNCODE,PLISTVER,MF);                00184300
*  ANS('?'!!MACLABEL!!' '!!'IOSVRYSP '!!MACLIST!!                       00184400
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00184500
*%END IOSVRYSW;                                                         00184600

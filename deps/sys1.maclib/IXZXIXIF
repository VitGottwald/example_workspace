*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXZXIXIF                              -11/12/03-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Obtain JES member information                 * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 (C) COPYRIGHT IBM CORP. 1996, 2004                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7709                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      Purpose:  The IXZXIXIF service obtains information about the   * 00002100
*      members in a JES XCF group. Information returned includes name * 00002200
*      and member status for each member of the group.                * 00002300
*                                                                     * 00002400
*      The IXZXIXIF service provides two methods of returning the     * 00002500
*      information to the caller.                                     * 00002600
*                                                                     * 00002700
*                                                                     * 00002800
*      1.  Synchronously - To obtain the information synchronously    * 00002900
*          the issuer must provide a buffer into which the data will  * 00003000
*          be placed. If the buffer is not large enough to hold the   * 00003100
*          data requested, a return code and reason code (rc=4 rsn=4) * 00003200
*          will indicate this and the ANSLEN parameter will be        * 00003300
*          updated with the needed length.                            * 00003400
*                                                                     * 00003500
*          DATA RETURNED: The content of the buffer returned is an    * 00003600
*          array of member elements, each member element is mapped by * 00003700
*          the IXZYIXIF data mapping. Each IXZYIXIF has a run time    * 00003800
*          length and an offset to the next element. You know when    * 00003900
*          all IXZYIXIF elements have been processed when the offset  * 00004000
*          to the next element is zero.                               * 00004100
*                                                                     * 00004200
*      2.  Asynchronously - This will cause the information to be     * 00004300
*          sent to a mailbox (specified by the REQMBOX parameter). A  * 00004400
*          token (REQTOKEN) will be returned to the issuer of the     * 00004500
*          information service, this token can be used to determine   * 00004600
*          which message envelope contains the response to the        * 00004700
*          request.                                                   * 00004800
*                                                                     * 00004900
*          DATA RETURNED: The data is placed in the mailbox specified * 00005000
*          as a solicated system event. The message contains an array * 00005100
*          of member elements, each member element is mapped by the   * 00005200
*          IXZYIXIF data mapping. Each IXZYIXIF has a run time length * 00005300
*          and an offset to the next element. You know when all       * 00005400
*          IXZYIXIF elements have been processed wen the offset to    * 00005500
*          the next element is zero.                                  * 00005600
*                                                                     * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*      CDPI Implications:                                             * 00006000
*                                                                     * 00006100
*      This macro is a General Use Programming Interface.             * 00006200
*                                                                     * 00006300
*      The GROUPTOKEN, REQMBOX, and REQTOKEN parameters are intended  * 00006400
*      to be used by JES exits and JES3 dynamic support programs.     * 00006500
*                                                                     * 00006600
*      EEC Implications:  This macro is not an EEC interface.         * 00006700
*                                                                     * 00006800
*      Related Macros:  When the REQMBOX parameter is used, the       * 00006900
*      following macros are used with this macro to manage the        * 00007000
*      transport of data and monitoring of system events:             * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*      o   IXZXIXMB - Build a mailbox                                 * 00007400
*                                                                     * 00007500
*      o   IXZXIXMC - Clear a mailbox                                 * 00007600
*                                                                     * 00007700
*      o   IXZXIXMD - Delete XCF Mailbox                              * 00007800
*                                                                     * 00007900
*      o   IXZXIXRM - Receive a message from a mailbox                * 00008000
*                                                                     * 00008100
*      o   IXZXIXSM - Send a message                                  * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*      Requirements                                                   * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*      o   Authorization:  Supervisor state, system key               * 00008900
*                                                                     * 00009000
*      o   Dispatchable unit mode: Task                               * 00009100
*                                                                     * 00009200
*      o   Cross memory mode: PASN = HASN = SASN                      * 00009300
*                                                                     * 00009400
*      o   AMODE: 31                                                  * 00009500
*                                                                     * 00009600
*      o   ASC mode: Primary                                          * 00009700
*                                                                     * 00009800
*      o   Serialization: Enabled for interrupts                      * 00009900
*                                                                     * 00010000
*      o   Locks:  This service obtains no locks nor assumes any      * 00010100
*          locks are held by the user.                                * 00010200
*                                                                     * 00010300
*      o   Control Parameters:  None                                  * 00010400
*                                                                     * 00010500
*      o   JES Environments:                                          * 00010600
*                                                                     * 00010700
*                                                                     * 00010800
*          -   JES2 Main Task                                         * 00010900
*                                                                     * 00011000
*          -   JES3 Main Task                                         * 00011100
*                                                                     * 00011200
*          -   JES2 Subtask                                           * 00011300
*                                                                     * 00011400
*          -   JES3 Subtask                                           * 00011500
*                                                                     * 00011600
*          -   JES3 FSS                                               * 00011700
*                                                                     * 00011800
*                                                                     * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*      Register Information                                           * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*      o   Input registers                                            * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*          -   R0 - R15 Undefined                                     * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*      o   Output registers                                           * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*          -   R0 - Reason code                                       * 00013600
*                                                                     * 00013700
*          -   R1 - Unpredictable                                     * 00013800
*                                                                     * 00013900
*          -   R2-R13 - Unchanged                                     * 00014000
*                                                                     * 00014100
*          -   R14 - Unpredictable                                    * 00014200
*                                                                     * 00014300
*          -   R15 - Return code                                      * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*      Programming Notes/Requirements:  None                          * 00015000
*                                                                     * 00015100
*      Restrictions                                                   * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*      o   If the GROUPTOKEN or the REQMBOX parameter is used, this   * 00015500
*          macro cannot be issued until JES initialization has        * 00015600
*          attached and initializes the JES Common XCF Task.          * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*      Performance Implications:  This macro has minimal performance  * 00016100
*      impact, the service routine causes a subtasked function to be  * 00016200
*      performed.                                                     * 00016300
*                                                                     * 00016400
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00016500
*                                                                     * 00016600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00016700
*                                                                     * 00016800
*01* SYNTAX:                                                          * 00016900
*                                                                     * 00017000
*Ýxlabel¨  IXZXIXIF  Ð  GROUPTOKEN=xgrouptoken                        * 00017100
*                    ¿ ,GROUPNAME=xgroupname                          * 00017200
*                     Ý,INFOLVL=»GROUP!MEMBERº¨                       * 00017300
*                     Ý,STATE=»ANY!ACTIVEº¨                           * 00017400
*                     Ý,SYSTEM=»ANY!CURRENTº¨                         * 00017500
*                     Ý,POLYJES=»YES!NOº¨                             * 00017600
*                     Ý,FUNCTION=NA!ARM¨                              * 00017700
*                    Ð ,REQMBOX=xreqmbox                              * 00017800
*                    !     ,REQTOKEN=xreqtoken                        * 00017900
*                    ¿ ,ANSAREA=xansarea                              * 00018000
*                          ,ANSLEN=xanslen                            * 00018100
*                     Ý,RTNCODE=xrtncode¨                             * 00018200
*                     Ý,RSNCODE=xrsncode¨                             * 00018300
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00018400
*                    ÐÝ,MF=S¨                                         * 00018500
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00018600
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*      Where:                                                         * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*      Ýxlabel¨                                                       * 00019300
*          is an optional symbol, starting in column 1, that is the   * 00019400
*          name on the IXZXIXIF macro invocation.  The name must      * 00019500
*          conform to the rules for an ordinary assembler language    * 00019600
*          symbol.                                                    * 00019700
*          DEFAULT: No name.                                          * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*      The following is a set of mutually exclusive keys.  This set   * 00020300
*      is required; only one key must be specified.                   * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*      GROUPTOKEN=xgrouptoken                                         * 00020700
*          belongs to a set of mutually exclusive keys. It is the     * 00020800
*          name (RS-type), or address in register (2)-(12), of a      * 00020900
*          fullword input that contains the JES XCF group token.      * 00021000
*          This parameter is required when the REQMBOX parameter is   * 00021100
*          specified.                                                 * 00021200
*                                                                     * 00021300
*      GROUPNAME=xgroupname                                           * 00021400
*          belongs to a set of mutually exclusive keys. It is the     * 00021500
*          name (RS-type), or address in register (2)-(12), of an 8   * 00021600
*          character input that contains the JES XCF group name.      * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*      End of a set of mutually exclusive required keys.              * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*      ÝINFOLVL=»GROUP!MEMBERº¨                                       * 00022500
*          is an optional keyword input that describes the type of    * 00022600
*          information requested.                                     * 00022700
*          DEFAULT: GROUP                                             * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*          INFOLVL=GROUP                                              * 00023100
*              Provide information about the entire group.            * 00023200
*                                                                     * 00023300
*          INFOLVL=MEMBER                                             * 00023400
*              Provide information about the member that issues the   * 00023500
*              information request.  This option is supported only    * 00023600
*              when the GROUPTOKEN parameter is specified.            * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*      ÝSTATE=»ANY!ACTIVEº¨                                           * 00024400
*          is an optional keyword input that filters the response     * 00024500
*          based on member state.                                     * 00024600
*          DEFAULT: ANY                                               * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*          STATE=ANY                                                  * 00025000
*              Provide information about members in any state.        * 00025100
*                                                                     * 00025200
*          STATE=ACTIVE                                               * 00025300
*              Provide information about members in the active state  * 00025400
*              only.                                                  * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*      ÝSYSTEM=»ANY!CURRENTº¨                                         * 00026200
*          is an optional keyword input that filters the response     * 00026300
*          based on MVS system.                                       * 00026400
*          DEFAULT: ANY                                               * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*          SYSTEM=ANY                                                 * 00026800
*              Provide information about members regardless of which  * 00026900
*              MVS systems they are on.                               * 00027000
*                                                                     * 00027100
*          SYSTEM=CURRENT                                             * 00027200
*              Provide information about members on the current MVS   * 00027300
*              system.                                                * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*      ÝPOLYJES=»YES!NOº¨                                             * 00028100
*          is an optional keyword input that specifies whether        * 00028200
*          information about multiple members on one MVS system       * 00028300
*          should be returned.                                        * 00028400
*          DEFAULT: YES                                               * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*          POLYJES=YES                                                * 00028800
*              Provide information about all members.                 * 00028900
*                                                                     * 00029000
*          POLYJES=NO                                                 * 00029100
*              Provide information about a single member per MVS      * 00029200
*              system.                                                * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*      ÝFUNCTION=NA!ARM¨                                              * 00030000
*          is an optional group of keyword input(s) that limits the   * 00030100
*          response to members that support specific functions.       * 00030200
*          DEFAULT: NA                                                * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*          FUNCTION=NA                                                * 00030600
*              Not applicable.  Do not limit the response based on    * 00030700
*              function.                                              * 00030800
*                                                                     * 00030900
*          FUNCTION=ARM                                               * 00031000
*              Provide information about members that support the     * 00031100
*              Automatic Restart Manager.                             * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*      The following is a set of mutually exclusive keys.  This set   * 00031900
*      is required; only one key must be specified.                   * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*      REQMBOX=xreqmbox                                               * 00032300
*          belongs to a set of mutually exclusive keys. It is the     * 00032400
*          name (RS-type), or address in register (2)-(12), of a 16   * 00032500
*          character input that specifies the name of a mailbox that  * 00032600
*          a solicited system event message will be placed. The       * 00032700
*          mailbox is associated with the member whose group token is * 00032800
*          specified by the GROUPTOKEN= keyword.                      * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*          REQTOKEN=xreqtoken                                         * 00033200
*              is the name (RS-type), or address in register          * 00033300
*              (2)-(12), of a required 8 character output into which  * 00033400
*              will be placed a token that can be used to match the   * 00033500
*              issuance of the information service macro with the     * 00033600
*              response returned to the mailbox specified by the      * 00033700
*              REQMBOX keyword.                                       * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*      ANSAREA=xansarea                                               * 00034200
*          belongs to a set of mutually exclusive keys. It is the     * 00034300
*          name (RS-type), or address in register (2)-(12), of a 4    * 00034400
*          byte input that contains the address that the IXZXIXIF     * 00034500
*          service is to place the JESXCF information array into.  If * 00034600
*          the area passed is to small, RC = 4 and RSN = 4 will be    * 00034700
*          returned and the ANSLEN keyword will be updated with the   * 00034800
*          required length.                                           * 00034900
*                                                                     * 00035000
*                                                                     * 00035100
*          ANSLEN=xanslen                                             * 00035200
*              is the name (RS-type), or address in register          * 00035300
*              (2)-(12), of a required fullword input/output that     * 00035400
*              specifies the length of the ANSAREA buffer passed to   * 00035500
*              the service routine. If the buffer is not large        * 00035600
*              enough, the ANSLEN value will be updated with the      * 00035700
*              length required and a return code of 4 and reason code * 00035800
*              of 4 will be returned to the caller. The caller may    * 00035900
*              then obtain storage of the specified size and try to   * 00036000
*              obtain the information again.                          * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*      End of a set of mutually exclusive required keys.              * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*      ÝRTNCODE=xrtncode¨                                             * 00037100
*          is the name (RS-type) of an optional fullword output       * 00037200
*          variable, or register (2)-(12), into which the return code * 00037300
*          is to be copied from GPR 15.                               * 00037400
*                                                                     * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*      ÝRSNCODE=xrsncode¨                                             * 00037900
*          is the name (RS-type) of an optional fullword output       * 00038000
*          variable, or register (2)-(12), into which the reason code * 00038100
*          is to be copied from GPR 0.                                * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00038700
*          is an optional byte input decimal value in the "2-2" range * 00038800
*          that specifies the macro version.  PLISTVER is the only    * 00038900
*          key allowed on the list form of MF and determines which    * 00039000
*          parameter list is generated.  Note that MAX may be         * 00039100
*          specified instead of a number, and the parameter list will * 00039200
*          be of the largest size currently supported. This size may  * 00039300
*          grow from release to release (thus possibly affecting the  * 00039400
*          amount of storage needed by your program).  If your        * 00039500
*          program can tolerate this, IBM recommends that you always  * 00039600
*          specify MAX when creating the list form parameter list as  * 00039700
*          that will ensure that the list form parameter list is      * 00039800
*          always long enough to hold whatever parameters might be    * 00039900
*          specified on the execute form.                             * 00040000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00040100
*          default is the lowest version which allows all of the      * 00040200
*          parameters specified on the invocation to be processed.    * 00040300
*                                                                     * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*      ÝMF=»S!L!Eº¨                                                   * 00040800
*          is an optional keyword input which specifies the macro     * 00040900
*          form.                                                      * 00041000
*          DEFAULT: S                                                 * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*          ÝMF=S¨                                                     * 00041400
*              specifies the standard form of the macro.  The "S"     * 00041500
*              form generates code to put the parameters into an      * 00041600
*              in-line parameter list and invoke the desired service. * 00041700
*              Full checking for required macro keys is done along    * 00041800
*              with supplying defaults for omitted optional           * 00041900
*              parameters.                                            * 00042000
*                                                                     * 00042100
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00042200
*              specifies the list form of the macro.  The "L" form    * 00042300
*              defines an area to be used for the parameter list.     * 00042400
*              Only the PLISTVER key may be specified on the          * 00042500
*              invocation.  All other macro parameters are flagged as * 00042600
*              errors.  If PLISTVER is not specified, the original    * 00042700
*              parameter list definition is used.                     * 00042800
*                                                                     * 00042900
*            ,xmfctrl                                                 * 00043000
*              is a required input.  It is the name of a storage area * 00043100
*              for the parameter list.                                * 00043200
*                                                                     * 00043300
*            »,xmfattr!0Dº                                            * 00043400
*              is an optional 60 character input string that varies   * 00043500
*              from 1 to 60 characters. Use it to force boundary      * 00043600
*              alignment of the parameter list. Use only 0F or 0D.    * 00043700
*              DEFAULT: 0D which forces the parameter list to a       * 00043800
*              doubleword boundary.                                   * 00043900
*                                                                     * 00044000
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00044100
*              specifies the execute form of the macro.  The "E" form * 00044200
*              generates code to put the parameters into the          * 00044300
*              parameter list specified by xmfctrl and provides full  * 00044400
*              syntax checking with default setting.                  * 00044500
*                                                                     * 00044600
*            ,xmfctrl                                                 * 00044700
*              is a required input.  It is the name (RS-type), or     * 00044800
*              address in register (1)-(12), of a storage area for    * 00044900
*              the parameter list.                                    * 00045000
*                                                                     * 00045100
*            »,COMPLETEº                                              * 00045200
*              is an optional keyword input which specifies the       * 00045300
*              degree of macro parameter syntax checking.             * 00045400
*              DEFAULT: COMPLETE                                      * 00045500
*                                                                     * 00045600
*                                                                     * 00045700
*              COMPLETE                                               * 00045800
*                  Checking for required macro keys is done and       * 00045900
*                  defaults are supplied for omitted optional         * 00046000
*                  parameters.                                        * 00046100
*                                                                     * 00046200
*                                                                     * 00046300
*                                                                     * 00046400
*                                                                     * 00046500
*                                                                     * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*01* RETURN CODES:                                                    * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*            0    Query for system data sucessful.                    * 00047200
*                                                                     * 00047300
*            4    Query for system data failed due to user error.     * 00047400
*                                                                     * 00047500
*            8    Query for system data failed due to system error.   * 00047600
*                                                                     * 00047700
*            C    Query for system data failed due to a system abend. * 00047800
*                                                                     * 00047900
*                                                                     * 00048000
*                                                                     * 00048100
*01* REASON CODES:                                                    * 00048200
*                                                                     * 00048300
*       REASON    RETURN                                              * 00048400
*       CODE      CODE      DESCRIPTION                               * 00048500
*       ××××××××  ××××××××  ×××××××××××                               * 00048600
*                                                                     * 00048700
*                                                                     * 00048800
*              0  0         Processing  was successful.   Information * 00048900
*                           about   the   requested   member(s)   was * 00049000
*                           returned.                                 * 00049100
*                                                                     * 00049200
*              4  0         Processing   was   successful,   but  the * 00049300
*                           filters  applied  eliminated all IXZYIXIF * 00049400
*                           record. No data was returned.             * 00049500
*                                                                     * 00049600
*              0  4         Processing  was  sucessful.    No members * 00049700
*                           meet   the   specified  criteria  (STATE, * 00049800
*                           SYSTEM, FUNCTION).                        * 00049900
*                                                                     * 00050000
*              4  4         Processing  failed  because,  the ANSAREA * 00050100
*                           provided   is   too  small  to  hold  the * 00050200
*                           requested   information.     ANSLEN    is * 00050300
*                           updated to indicate the length necessary. * 00050400
*                           Obtain  a  new  buffer of this length and * 00050500
*                           try again.                                * 00050600
*                                                                     * 00050700
*             40  4         Processing  failed  because the parameter * 00050800
*                           list   passed  to  the  IXZXIXIF  service * 00050900
*                           routine does not have a valid eyecatcher. * 00051000
*                                                                     * 00051100
*             44  4         Processing  failed because, the parameter * 00051200
*                           list   passed  to  the  IXZXIXIF  service * 00051300
*                           routine had an invalid version indicator. * 00051400
*                           The caller may need to be recompiled.     * 00051500
*                                                                     * 00051600
*             48  4         Processing   failed  because,the  IXZIXIF * 00051700
*                           service  routine  was  called on a member * 00051800
*                           that is detaching.                        * 00051900
*                                                                     * 00052000
*             4C  4         Processing   failed   because,  a  JESXCF * 00052100
*                           buffer  was  not available to process the * 00052200
*                           request.                                  * 00052300
*                                                                     * 00052400
*             50  8         Processing  failed  because,  JESXCF  was * 00052500
*                           unable  to  obtain storage to process the * 00052600
*                           request.                                  * 00052700
*                                                                     * 00052800
*             54  4         Processing  failed because, the parameter * 00052900
*                           list   passed  to  the  IXZXIXIF  service * 00053000
*                           routine  had  an  invalid  REQMBOX  name. * 00053100
*                           Only A-Z, 0-9 and $ @ # are valid.        * 00053200
*                                                                     * 00053300
*              0  C         Processing  failed  because,  the IXZIXIF * 00053400
*                           service routine abended.                  * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00053900
*                                                                     * 00054000
*02*   PROCESSOR:  ASSEM                                              * 00054100
*                                                                     * 00054200
*01* COMPONENT:  SCJSC                                                * 00054300
*                                                                     * 00054400
*01* MACRO USAGE NOTES:                                               * 00054500
*                                                                     * 00054600
*                                                                     * 00054700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00054800
*        global macro variable.  Any value other than 'NO' will       * 00054900
*        result in the macro expansion being printed.  The default is * 00055000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00055100
*        variable should be set.                                      * 00055200
*                                                                     * 00055300
*                    GBLC &ZPRINT                                     * 00055400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00055500
*                                                                     * 00055600
*                                                                     * 00055700
*    2.  All   keys   currently   contained  in  the  IXZXIXIF  macro * 00055800
*        correspond  to  version  2.   If you specify PLISTVER, use a * 00055900
*        value of 2 or MAX.                                           * 00056000
*                                                                     * 00056100
*                                                                     * 00056200
*                                                                     * 00056300
*                                                                     * 00056400
*01* CHANGE ACTIVITY:                                                 * 00056500
*                                                                     * 00056600
*   Flag LineItem  FMID    Date   ID    Comment                       * 00056700
*                                                                     * 00056800
*    $SP=JESXCF   HBB7709 031105 PD0RF:                               * 00056900
****** END OF SPECIFICATIONS *****************************************/ 00057000
*/* TLINE 1 *********************************************************** 00057100
         MACRO                                                          00057200
&XLABEL  IXZXIXIF &GROUPTOKEN=,&GROUPNAME=,&INFOLVL=,&STATE=,&SYSTEM=, *00057300
               &POLYJES=,&FUNCTION=,&REQMBOX=,&REQTOKEN=,&ANSAREA=,    *00057400
               &ANSLEN=,&RTNCODE=,&RSNCODE=,&PLISTVER=,&MF=             00057500
.*                                                                      00057600
*                MACDATE -11/12/03-<2>                                  00057700
.*                                                                      00057800
.*******************************************************************    00057900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00058000
.*******************************************************************    00058100
                GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                 00058200
                GBLC  &ZTEST      YES=TEST NO=NO TEST                   00058300
                GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX           00058400
.*                                                                      00058500
                GBLC  &ZIXZXIXIF  YES=MACRO USED AT LEAST ONCE          00058600
.*******************************************************************    00058700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00058800
.*******************************************************************    00058900
                LCLC  &ZMS        ERROR MESSAGE WORK AREA               00059000
                LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS          00059100
                LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED            00059200
                LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR           00059300
                LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE           00059400
                LCLA  &ZAWRK      USED AS A WORK AREA                   00059500
                LCLA  &ZASIZ      USED FOR SIZE OF VALUE                00059600
                LCLA  &ZN         NUMERIC WORK VARIABLE                 00059700
                LCLC  &ZC         CHARACTER WORK VARIABLE               00059800
                LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE           00059900
                LCLA  &ZTLA       VALUE TOO LONG VARIABLE               00060000
                LCLC  &ZMAC_G     "G" or null                           00060100
&ZMAC_G         SETC  ''                                                00060200
                LCLC  &ZMAC_LR                                          00060300
&ZMAC_LR        SETC  'LR'                                              00060400
                LCLC  &ZMAC_L                                           00060500
&ZMAC_L         SETC  'L'                                               00060600
                LCLC  &ZMAC_ST                                          00060700
&ZMAC_ST        SETC  'ST'                                              00060800
                LCLA  &ZMACRET    MACRO RETURN CODE                     00060900
&ZMACRET        SETA  0           ASSUME NO ERRORS                      00061000
.*                                                                      00061100
                LCLC  &ZCSYSLIST(255)           NONXKEY, POS ARRAY      00061200
                LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()            00061300
                LCLA  &ZPLLEN     PARAMETER LIST LENGTH                 00061400
                LCLC  &ZENDBASEPL               End of base PL          00061500
                LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                 00061600
.*******************************************************************    00061700
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00061800
.*******************************************************************    00061900
                LCLA  &ZI         INDEX FOR ARRAY                       00062000
                LCLA  &ZJ         INDEX FOR PARMS                       00062100
                LCLA  &ZK         INDEX FOR PARSE                       00062200
                LCLA  &ZLO        LOW RANGE VALUE                       00062300
                LCLA  &ZHI        HIGH RANGE VALUE                      00062400
                LCLC  &ZW         WORK AREA FOR PARM                    00062500
.********************************************************************   00062600
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00062700
.********************************************************************   00062800
                GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL               00062900
                GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE        00063000
                GBLA  &SYSALVL    SYSSTATE ARCHLVL                      00063100
                GBLC  &SYSAM64    SYSSTATE AMODE64                      00063200
.*                                                                      00063300
                AIF   (K'&SYSASCE GT 0).ZSYS4   SYS STATE DEFINED       00063400
                AIF   (K'&SYSSPLV GT 0).ZSYS2   SP LEVEL DEFINED        00063500
                SPLEVEL  TEST                                           00063600
.ZSYS2          ANOP  ,                                                 00063700
                AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1             00063800
                AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1             00063900
                SYSSTATE TEST                                           00064000
                AGO   .ZSYS4                                            00064100
.ZSYS3          ANOP  ,                                                 00064200
&SYSASCE        SETC  'P'         ASSUME SYSSTATE PRIMARY               00064300
.ZSYS4          ANOP  ,                                                 00064400
.*******************************************************************    00064500
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00064600
.*******************************************************************    00064700
                LCLC  &XGROUPPARM               ++ NAME                 00064800
                LCLC  &XGROUPTOKEN              ++ NAME                 00064900
                LCLC  &XGROUPNAME               ++ NAME                 00065000
                LCLC  &XINFOLVL   ++ VALUE                              00065100
                LCLC  &XSTATE     ++ VALUE                              00065200
                LCLC  &XSYSTEM    ++ VALUE                              00065300
                LCLC  &XPOLYJES   ++ VALUE                              00065400
                LCLC  &XFUNCTION(257)           ++ VALUE                00065500
                LCLC  &XRTNAREA   ++ NAME                               00065600
                LCLC  &XREQMBOX   ++ NAME                               00065700
                LCLC  &XREQTOKEN  ++ NAME                               00065800
                LCLC  &XANSAREA   ++ NAME                               00065900
                LCLC  &XANSLEN    ++ NAME                               00066000
                LCLC  &XRTNCODE   ++ NAME                               00066100
                LCLC  &XRSNCODE   ++ NAME                               00066200
                LCLA  &XPLISTVER  ++ VALUE                              00066300
                LCLC  &XMF        ++ VALUE                              00066400
                LCLC  &XMFCTRL    ++ NAME                               00066500
                LCLC  &XMFATTR    ++ VALUE                              00066600
                LCLC  &XMFSCK     ++ VALUE                              00066700
.*******************************************************************    00066800
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00066900
.*******************************************************************    00067000
                LCLC  &ZXGROUPPARM              ++ INPUT NAME           00067100
                LCLC  &ZXGROUPTOKEN             ++ INPUT NAME           00067200
                LCLC  &ZXGROUPNAME              ++ INPUT NAME           00067300
                LCLC  &ZXINFOLVL  ++ INPUT VALUE                        00067400
                LCLC  &ZXSTATE    ++ INPUT VALUE                        00067500
                LCLC  &ZXSYSTEM   ++ INPUT VALUE                        00067600
                LCLC  &ZXPOLYJES  ++ INPUT VALUE                        00067700
                LCLC  &ZXFUNCTION               ++ INPUT VALUE          00067800
                LCLC  &ZXRTNAREA  ++ INPUT NAME                         00067900
                LCLC  &ZXREQMBOX  ++ INPUT NAME                         00068000
                LCLC  &ZXREQTOKEN               ++ OUTPUT NAME          00068100
                LCLC  &ZXANSAREA  ++ INPUT NAME                         00068200
                LCLC  &ZXANSLEN   ++ INOUT NAME                         00068300
                LCLC  &ZXRTNCODE  ++ OUTPUT NAME                        00068400
                LCLC  &ZXRSNCODE  ++ OUTPUT NAME                        00068500
                LCLC  &ZXPLISTVER               ++ INPUT VALUE          00068600
                LCLC  &ZXMF       ++ INPUT VALUE                        00068700
                LCLC  &ZXMFCTRL   ++ INPUT NAME                         00068800
                LCLC  &ZXMFATTR   ++ INPUT VALUE                        00068900
                LCLC  &ZXMFSCK    ++ INPUT VALUE                        00069000
.********************************************************************   00069100
.***AC.PLV01  PROCESS PLISTVER                                      *   00069200
.********************************************************************   00069300
&XPLISTVER      SETA  2                                                 00069400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00069500
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00069600
&XPLISTVER      SETA  2                                                 00069700
.ZPLV0          ANOP  ,                                                 00069800
.*                                                                      00069900
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00070000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00070100
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00070200
.*-------------------------------------------------------------------   00070300
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00070400
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00070500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00070600
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00070700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00070800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00070900
                AGO   .ZPVCK2                                           00071000
.ZPVCK3         ANOP  ,                                                 00071100
.*-------------------------------------------------------------------   00071200
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00071300
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00071400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00071500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00071600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00071700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00071800
                AGO   .ZPVCKE                                           00071900
.ZPVCK2         ANOP  ,                                                 00072000
.*-------------------------------------------------------------------   00072100
&ZCVAL          SETC  '&PLISTVER(1)'                                    00072200
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00072300
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00072400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00072500
                AIF   (&ZN LT 2).ZPVCK6    TOO LOW                      00072600
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00072700
.ZPVCK6         ANOP  ,                                                 00072800
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00072900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00073000
&ZMS            SETC  '&ZMS THE RANGE IS "2-2"'                         00073100
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00073200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00073300
&XPLISTVER      SETA  2                                                 00073400
                AGO   .ZPVCKE                                           00073500
.*-------------------------------------------------------------------   00073600
.ZPVCK4A        ANOP  ,                                                 00073700
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00073800
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00073900
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00074000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00074100
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00074200
                MNOTE 8,' &ZMS IS REQUIRED.'                            00074300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00074400
                AGO   .ZPVCK5                                           00074500
.ZPVCK4         ANOP  ,                                                 00074600
&XPLISTVER      SETA  &PLISTVER(1)                                      00074700
.ZPVCK5         ANOP  ,                                                 00074800
.ZPVCKE         ANOP  ,                                                 00074900
.********************************************************************   00075000
.***AG.MF01 PROCESS MF MACRO FORMS                                      00075100
.********************************************************************   00075200
                ACTR  10000                                             00075300
.*------------------------------------------------------------------    00075400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075500
&XMF            SETC  ''          INITIALIZE XVARIABLE                  00075600
.*-------------------------------------------------------------------   00075700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075800
.ZG51           ANOP  ,                                                 00075900
&ZTLC           SETC 'S'                                                00076000
                AIF   ('&MF(1)' NE '&ZTLC').ZG52                        00076100
&XMF            SETC  'S'         SET KEYWORD                           00076200
                AIF   (N'&MF LE 1).ZG51A        CK NUM                  00076300
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00076400
&ZMS            SETC  '&ZMS.&MF"'                                       00076500
&ZMS            SETC  '&ZMS "MF"'                                       00076600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00076700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00076800
.ZG51A          ANOP  ,                                                 00076900
.*-------------------------------------------------------------------   00077000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00077100
.ZG52           ANOP  ,                                                 00077200
&ZTLC           SETC 'L'                                                00077300
                AIF   ('&MF(1)' NE '&ZTLC').ZG59                        00077400
&XMF            SETC  'L'         SET KEYWORD                           00077500
                AIF   (N'&MF LE 3).ZG52A        CK NUM                  00077600
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00077700
&ZMS            SETC  '&ZMS.&MF"'                                       00077800
&ZMS            SETC  '&ZMS "MF"'                                       00077900
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00078000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00078100
.ZG52A          ANOP  ,                                                 00078200
.*-------------------------------------------------------------------   00078300
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00078400
                AIF   (N'&SYSLIST NE 0).ZG52B   POSITIONALS?            00078500
                AIF   ('&GROUPTOKEN' NE '').ZG52B  KEYS?                00078600
                AIF   ('&GROUPNAME' NE '').ZG52B  KEYS?                 00078700
                AIF   ('&INFOLVL' NE '').ZG52B  KEYS?                   00078800
                AIF   ('&STATE' NE '').ZG52B    KEYS?                   00078900
                AIF   ('&SYSTEM' NE '').ZG52B   KEYS?                   00079000
                AIF   ('&POLYJES' NE '').ZG52B  KEYS?                   00079100
                AIF   ('&FUNCTION' NE '').ZG52B  KEYS?                  00079200
                AIF   ('&REQMBOX' NE '').ZG52B  KEYS?                   00079300
                AIF   ('&REQTOKEN' NE '').ZG52B  KEYS?                  00079400
                AIF   ('&ANSAREA' NE '').ZG52B  KEYS?                   00079500
                AIF   ('&ANSLEN' NE '').ZG52B   KEYS?                   00079600
                AIF   ('&RTNCODE' NE '').ZG52B  KEYS?                   00079700
                AIF   ('&RSNCODE' NE '').ZG52B  KEYS?                   00079800
                AGO    .ZG52C     INVOCATION OKAY                       00079900
.ZG52B          ANOP  ,                                                 00080000
&ZMS            SETC  'THE "L" FORM OF "MF"'    *MFLA* MNOTE            00080100
&ZMS            SETC  '&ZMS CAN ONLY HAVE'                              00080200
&ZMS            SETC  '&ZMS THE "PLISTVER" KEY'                         00080300
                MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'            00080400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00080500
.ZG52C          ANOP  ,                                                 00080600
.*-------------------------------------------------------------------   00080700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00080800
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00080900
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00081000
                AIF   (N'&MF(2) GT 1).ZG54B     MULTI PARMS             00081100
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00081200
.ZG54B          AIF   (K'&MF(2) GT 0).ZG54C                             00081300
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00081400
&ZMS            SETC  'WHEN "L" IS SPECIFIED'   *KRQDA*                 00081500
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00081600
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00081700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00081800
.ZG54C          ANOP  ,                                                 00081900
.*-------------------------------------------------------------------   00082000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00082100
                AIF   (K'&ZXMFCTRL LE 0).ZG54P  NOT I/O                 00082200
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG54P                    00082300
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00082400
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00082500
&ZMS            SETC  '&ZMS.&MF"'                                       00082600
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00082700
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                 00082800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00082900
.ZG54P          ANOP  ,                                                 00083000
.*-------------------------------------------------------------------   00083100
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00083200
&ZXMFATTR       SETC  'INPUT'     SET IN/OUTPUT                         00083300
&XMFATTR        SETC  '0D'                                              00083400
                AIF   (K'&MF(3) LE 0).ZG57B     PARM                    00083500
&XMFATTR        SETC  '&MF(3,1)'  SET XVARIABLE                         00083600
                AIF   (N'&MF(3) GT 1).ZG57B     MULTI PARMS             00083700
&XMFATTR        SETC  '&MF(3)'    SET XVARIABLE                         00083800
.ZG57B          ANOP  ,                                                 00083900
.*-------------------------------------------------------------------   00084000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00084100
                AIF   (K'&ZXMFATTR LE 0).ZG57P  NOT I/O                 00084200
                AIF   ('&XMFATTR'(1,1) NE '(').ZG57P                    00084300
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00084400
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00084500
&ZMS            SETC  '&ZMS.&MF"'                                       00084600
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00084700
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                 00084800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00084900
.ZG57P          ANOP  ,                                                 00085000
.*-------------------------------------------------------------------   00085100
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00085200
                AIF   (K'&ZXMFATTR LE 0).ZG57S  NOT I/O                 00085300
                AIF   (K'&XMFATTR LE 60).ZG57S  LNG OK                  00085400
&ZXMFATTR       SETC  ''          RESET IN/OUTPUT                       00085500
&ZMS            SETC  '"MF='      *KLNGA* MNOTE                         00085600
&ZMS            SETC  '&ZMS.&MF"'                                       00085700
&ZMS            SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'             00085800
                MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                00085900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00086000
.ZG57S          ANOP  ,                                                 00086100
.*-------------------------------------------------------------------   00086200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00086300
.ZG59           ANOP  ,                                                 00086400
&ZTLC           SETC 'E'                                                00086500
                AIF   ('&MF(1)' NE '&ZTLC').ZG67                        00086600
&XMF            SETC  'E'         SET KEYWORD                           00086700
                AIF   (N'&MF LE 3).ZG59A        CK NUM                  00086800
&ZMS            SETC  '"MF='      *KPOSA* MNOTE                         00086900
&ZMS            SETC  '&ZMS.&MF"'                                       00087000
&ZMS            SETC  '&ZMS "MF"'                                       00087100
                MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'              00087200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00087300
.ZG59A          ANOP  ,                                                 00087400
.*-------------------------------------------------------------------   00087500
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00087600
&ZXMFCTRL       SETC  'INPUT'     SET IN/OUTPUT                         00087700
&XMFCTRL        SETC  '&MF(2,1)'  SET XVARIABLE                         00087800
                AIF   (N'&MF(2) GT 1).ZG61B     MULTI PARMS             00087900
&XMFCTRL        SETC  '&MF(2)'    SET XVARIABLE                         00088000
.ZG61B          AIF   (K'&MF(2) GT 0).ZG61C                             00088100
&ZXMFCTRL       SETC  ''          RESET IN/OUTPUT                       00088200
&ZMS            SETC  'WHEN "E" IS SPECIFIED'   *KRQDA*                 00088300
&ZMS            SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'               00088400
                MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                      00088500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00088600
.ZG61C          ANOP  ,                                                 00088700
.*-------------------------------------------------------------------   00088800
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00088900
                AIF   (K'&ZXMFCTRL LE 0).ZG61R  NOT I/O                 00089000
                AIF   ('&XMFCTRL'(1,1) NE '(').ZG61R                    00089100
&ZCGPR          SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                        00089200
                AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                      00089300
                AIF   (K'&ZCGPR GT 2).ZG61Q                             00089400
                AIF   ('&ZCGPR' EQ '0').ZG61Q                           00089500
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00089600
                AIF   (T'&ZCGPR NE 'N').ZG61Q   INVALID REG NAME        00089700
.ZG61P          ANOP  ,                                                 00089800
                AIF   (T'&ZCGPR NE 'N').ZG61R   NON NUMERIC             00089900
                AIF   ('&ZCGPR' LT '1').ZG61Q                           00090000
                AIF   ('&ZCGPR' LE '12').ZG61R                          00090100
.ZG61Q          ANOP  ,                                                 00090200
&ZMS            SETC  '"MF='      *KGPRA* MNOTE                         00090300
&ZMS            SETC  '&ZMS.&MF"'                                       00090400
&ZMS            SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'         00090500
                MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                  00090600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00090700
.ZG61R          ANOP  ,                                                 00090800
.*-------------------------------------------------------------------   00090900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00091000
&XMFSCK         SETC  ''          INITIALIZE XVARIABLE                  00091100
.ZG65A   AIF   ('&MF(3)' NE 'COMPLETE').ZG66A                           00091200
&XMFSCK         SETC  'COMPLETE'  SET KEYWORD                           00091300
.*-------------------------------------------------------------------   00091400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00091500
.ZG66A          AIF   (K'&XMFSCK GT 0).ZG66C    KEYWORD                 00091600
                AIF   (K'&MF(3) LE 0).ZG66B                             00091700
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00091800
&ZMS            SETC  '&ZMS.&MF"'                                       00091900
&ZMS            SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '         00092000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00092100
&ZMS            SETC  '&ZMS "COMPLETE".'                                00092200
                MNOTE 8,' &ZMS '                                        00092300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00092400
.ZG66B          ANOP  ,                                                 00092500
&XMFSCK         SETC  'COMPLETE'  SET DEFAULT KEYWORD                   00092600
.ZG66C          ANOP  ,                                                 00092700
&ZXMFSCK        SETC  'INPUT'     SET IN/OUTPUT                         00092800
.*------------------------------------------------------------------    00092900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093000
.ZG67           ANOP  ,                                                 00093100
&ZXMF           SETC  'INPUT'     SET IN/OUTPUT                         00093200
                AIF   (K'&XMF GT 0).ZG67E       VALID ARG               00093300
                AIF   (T'&MF EQ 'O').ZG67D      OMITTED                 00093400
&ZASYSLNDX      SETA  0                                                 00093500
.ZG67A          ANOP  ,           POSITIONAL MACRO KEY                  00093600
&ZASYSLNDX      SETA  &ZASYSLNDX+1                                      00093700
                AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG67C                  00093800
&ZTLC           SETC 'MF'                                               00093900
                AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG67A         00094000
.ZG67B          ANOP  ,                                                 00094100
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00094200
&ZMS            SETC  'THE "MF" KEY'            *KOPTA* MNOTE           00094300
&ZMS            SETC  '&ZMS MUST CONTAIN ONE'                           00094400
                MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                  00094500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00094600
                AGO   .ZG67E                                            00094700
.ZG67C          ANOP  ,                                                 00094800
&ZXMF           SETC  ''          RESET IN/OUTPUT                       00094900
&ZMS            SETC  '"MF='      *KUKWA* MNOTE                         00095000
&ZMS            SETC  '&ZMS.&MF"'                                       00095100
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00095200
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00095300
&ZMS            SETC  '&ZMS "S",'                                       00095400
&ZMS            SETC  '&ZMS "L",'                                       00095500
&ZMS            SETC  '&ZMS OR "E".'                                    00095600
                MNOTE 8,' &ZMS '                                        00095700
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00095800
                AGO   .ZG67E                                            00095900
.ZG67D          ANOP  ,                                                 00096000
&XMF            SETC  'S'         SET DEFAULT KEYWORD                   00096100
&XMFSCK         SETC  'COMPLETE'  COMPLETE CHECKING                     00096200
.ZG67E          ANOP  ,                                                 00096300
.********************************************************************   00096400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00096500
.********************************************************************   00096600
                ACTR  10000                                             00096700
.*-------------------------------------------------------------------   00096800
.***AG.MF03 MF=(SLE)                                                    00096900
                AIF   ('&XMF' EQ 'L').ZGMFX                             00097000
.*----------------------------------------------------------------***   00097100
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00097200
&XGROUPPARM     SETC  ''          INITIALIZE XVARIABLE                  00097300
                AIF   (K'&GROUPTOKEN LE 0).ZG2C                         00097400
&ZXGROUPPARM    SETC  'INPUT'     SET IN/OUTPUT                         00097500
&XGROUPPARM     SETC  'GROUPTOKEN'              SET XVARIABLE           00097600
&ZXGROUPTOKEN   SETC  'INPUT'     SET IN/OUTPUT                         00097700
&XGROUPTOKEN    SETC  '&GROUPTOKEN(1)'          SET XVARIABLE PARM      00097800
                AIF   (N'&GROUPTOKEN GT 1).ZG2A                         00097900
&XGROUPTOKEN    SETC  '&GROUPTOKEN'             SET XVARIABLE PARM      00098000
.ZG2A           AIF   (N'&GROUPTOKEN LE 1).ZG2B  CK NUM                 00098100
&ZMS            SETC  '"GROUPTOKEN='            *KPOSA* MNOTE           00098200
&ZMS            SETC  '&ZMS.&GROUPTOKEN"'                               00098300
&ZMS            SETC  '&ZMS "GROUPTOKEN"'                               00098400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00098500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00098600
.ZG2B           AIF   (K'&XGROUPTOKEN GT 0).ZG2C  ONE PARM              00098700
&ZXGROUPPARM    SETC  ''          RESET IN/OUTPUT                       00098800
&ZXGROUPTOKEN   SETC  ''          RESET IN/OUTPUT                       00098900
&ZMS            SETC  ' '         *KRQDA*                               00099000
&ZMS            SETC  '&ZMS "GROUPTOKEN" KEY AND ITS'                   00099100
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00099200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00099300
.ZG2C           ANOP  ,                                                 00099400
.*----------------------------------------------------------------***   00099500
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00099600
                AIF   (K'&GROUPNAME LE 0).ZG3D  NO ME KEY               00099700
                AIF   (N'&GROUPNAME LE 1).ZG3A  CK NUM                  00099800
&ZMS            SETC  '"GROUPNAME='             *KPOSA* MNOTE           00099900
&ZMS            SETC  '&ZMS.&GROUPNAME"'                                00100000
&ZMS            SETC  '&ZMS "GROUPNAME"'                                00100100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00100200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00100300
.ZG3A           AIF   (K'&XGROUPPARM LE 0).ZG3B                         00100400
&ZMS            SETC  '"GROUPNAME'              *KMEKA* MNOTE           00100500
&ZMS            SETC  '&ZMS.=&GROUPNAME"'                               00100600
&ZMS            SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'             00100700
&ZMS            SETC  '&ZMS "&XGROUPPARM"'                              00100800
                MNOTE 8,' &ZMS KEY.'                                    00100900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00101000
                AGO   .ZG3D                                             00101100
.*                                                                      00101200
.ZG3B           ANOP  ,                                                 00101300
&ZXGROUPPARM    SETC  'INPUT'     SET IN/OUTPUT                         00101400
&XGROUPPARM     SETC  'GROUPNAME'               SET XVARIABLE           00101500
&ZXGROUPNAME    SETC  'INPUT'     SET IN/OUTPUT                         00101600
&XGROUPNAME     SETC  '&GROUPNAME(1)'           SET XVARIABLE PARM      00101700
                AIF   (N'&GROUPNAME GT 1).ZG3C                          00101800
&XGROUPNAME     SETC  '&GROUPNAME'              SET XVARIABLE PARM      00101900
.ZG3C           AIF   (K'&XGROUPNAME GT 0).ZG3D  ONE PARM               00102000
&ZXGROUPPARM    SETC  ''          RESET IN/OUTPUT                       00102100
&ZXGROUPNAME    SETC  ''          RESET IN/OUTPUT                       00102200
&ZMS            SETC  ' '         *KRQDA*                               00102300
&ZMS            SETC  '&ZMS "GROUPNAME" KEY AND ITS'                    00102400
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00102500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00102600
.ZG3D           ANOP  ,                                                 00102700
.*------------------------------------------------------------------    00102800
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00102900
                AIF   (K'&XGROUPPARM GT 0).ZG4B                         00103000
&ZXGROUPPARM    SETC  ''          RESET IN/OUTPUT                       00103100
&ZXGROUPTOKEN   SETC  ''          RESET IN/OUTPUT                       00103200
&XGROUPPARM     SETC  ''          ENSURE NULL                           00103300
&XGROUPTOKEN    SETC  ''          ENSURE NULL                           00103400
&ZMS            SETC  'ONE OF THE FOLLOWING'    *KMERA* MNOTE           00103500
&ZMS            SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'               00103600
&ZMS            SETC  '&ZMS REQUIRED:'                                  00103700
&ZMS            SETC  '&ZMS "GROUPTOKEN"'       VALID ME KEY            00103800
&ZMS            SETC  '&ZMS OR "GROUPNAME".'    VALID ME KEY            00103900
                MNOTE 8,' &ZMS '                                        00104000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00104100
.ZG4B           ANOP  ,                                                 00104200
.*-------------------------------------------------------------------   00104300
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00104400
.ZG2            AIF   ('&XGROUPPARM' NE 'GROUPTOKEN').ZG3               00104500
.*-------------------------------------------------------------------   00104600
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00104700
                AIF   (K'&ZXGROUPTOKEN LE 0).ZG2R  NOT I/O              00104800
                AIF   ('&XGROUPTOKEN'(1,1) NE '(').ZG2R                 00104900
&ZCGPR          SETC  '&XGROUPTOKEN'(2,K'&XGROUPTOKEN-2)                00105000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                       00105100
                AIF   (K'&ZCGPR GT 2).ZG2Q                              00105200
                AIF   ('&ZCGPR' EQ '0').ZG2Q                            00105300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00105400
                AIF   (T'&ZCGPR NE 'N').ZG2Q    INVALID REG NAME        00105500
.ZG2P           ANOP  ,                                                 00105600
                AIF   (T'&ZCGPR NE 'N').ZG2R    NON NUMERIC             00105700
                AIF   ('&ZCGPR' LT '2').ZG2Q                            00105800
                AIF   ('&ZCGPR' LE '12').ZG2R                           00105900
.ZG2Q           ANOP  ,                                                 00106000
&ZMS            SETC  '"GROUPTOKEN='            *KGPRA* MNOTE           00106100
&ZMS            SETC  '&ZMS.&GROUPTOKEN"'                               00106200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00106300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00106400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00106500
.ZG2R           ANOP  ,                                                 00106600
.*-------------------------------------------------------------------   00106700
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00106800
.ZG3            AIF   ('&XGROUPPARM' NE 'GROUPNAME').ZG4                00106900
.*-------------------------------------------------------------------   00107000
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00107100
                AIF   (K'&ZXGROUPNAME LE 0).ZG3R  NOT I/O               00107200
                AIF   ('&XGROUPNAME'(1,1) NE '(').ZG3R                  00107300
&ZCGPR          SETC  '&XGROUPNAME'(2,K'&XGROUPNAME-2)                  00107400
                AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                       00107500
                AIF   (K'&ZCGPR GT 2).ZG3Q                              00107600
                AIF   ('&ZCGPR' EQ '0').ZG3Q                            00107700
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00107800
                AIF   (T'&ZCGPR NE 'N').ZG3Q    INVALID REG NAME        00107900
.ZG3P           ANOP  ,                                                 00108000
                AIF   (T'&ZCGPR NE 'N').ZG3R    NON NUMERIC             00108100
                AIF   ('&ZCGPR' LT '2').ZG3Q                            00108200
                AIF   ('&ZCGPR' LE '12').ZG3R                           00108300
.ZG3Q           ANOP  ,                                                 00108400
&ZMS            SETC  '"GROUPNAME='             *KGPRA* MNOTE           00108500
&ZMS            SETC  '&ZMS.&GROUPNAME"'                                00108600
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00108700
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00108800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00108900
.ZG3R           ANOP  ,                                                 00109000
.*-------------------------------------------------------------------   00109100
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00109200
.ZG4            ANOP  ,           END MUTUALLY EXCLUSIVE KEYS           00109300
.*----------------------------------------------------------------***   00109400
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00109500
                AIF   (N'&INFOLVL LE 1).ZG6A    CK NUM                  00109600
&ZMS            SETC  '"INFOLVL='               *KPOSA* MNOTE           00109700
&ZMS            SETC  '&ZMS.&INFOLVL"'                                  00109800
&ZMS            SETC  '&ZMS "INFOLVL"'                                  00109900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00110000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00110100
.ZG6A           ANOP  ,                                                 00110200
.*-------------------------------------------------------------------   00110300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00110400
&XINFOLVL       SETC  ''          INITIALIZE XVARIABLE                  00110500
.ZG7A   AIF   ('&INFOLVL(1)' NE 'GROUP').ZG8A                           00110600
&XINFOLVL       SETC  'GROUP'     SET KEYWORD                           00110700
.*-------------------------------------------------------------------   00110800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00110900
.ZG8A   AIF   ('&INFOLVL(1)' NE 'MEMBER').ZG9A                          00111000
&XINFOLVL       SETC  'MEMBER'    SET KEYWORD                           00111100
.*-------------------------------------------------------------------   00111200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00111300
.ZG9A           AIF   (K'&XINFOLVL GT 0).ZG9C   KEYWORD                 00111400
                AIF   (K'&INFOLVL(1) LE 0).ZG9B                         00111500
&ZMS            SETC  '"INFOLVL='               *KUKWA* MNOTE           00111600
&ZMS            SETC  '&ZMS.&INFOLVL"'                                  00111700
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00111800
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00111900
&ZMS            SETC  '&ZMS "GROUP"'                                    00112000
&ZMS            SETC  '&ZMS OR "MEMBER".'                               00112100
                MNOTE 8,' &ZMS '                                        00112200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00112300
.ZG9B           ANOP  ,                                                 00112400
&XINFOLVL       SETC  'GROUP'     SET DEFAULT KEYWORD                   00112500
.ZG9C           ANOP  ,                                                 00112600
&ZXINFOLVL      SETC  'INPUT'     SET IN/OUTPUT                         00112700
.*----------------------------------------------------------------***   00112800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00112900
                AIF   (N'&STATE LE 1).ZG11A     CK NUM                  00113000
&ZMS            SETC  '"STATE='   *KPOSA* MNOTE                         00113100
&ZMS            SETC  '&ZMS.&STATE"'                                    00113200
&ZMS            SETC  '&ZMS "STATE"'                                    00113300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00113400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00113500
.ZG11A          ANOP  ,                                                 00113600
.*-------------------------------------------------------------------   00113700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00113800
&XSTATE         SETC  ''          INITIALIZE XVARIABLE                  00113900
.ZG12A   AIF   ('&STATE(1)' NE 'ANY').ZG13A                             00114000
&XSTATE         SETC  'ANY'       SET KEYWORD                           00114100
.*-------------------------------------------------------------------   00114200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00114300
.ZG13A   AIF   ('&STATE(1)' NE 'ACTIVE').ZG14A                          00114400
&XSTATE         SETC  'ACTIVE'    SET KEYWORD                           00114500
.*-------------------------------------------------------------------   00114600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00114700
.ZG14A          AIF   (K'&XSTATE GT 0).ZG14C    KEYWORD                 00114800
                AIF   (K'&STATE(1) LE 0).ZG14B                          00114900
&ZMS            SETC  '"STATE='   *KUKWA* MNOTE                         00115000
&ZMS            SETC  '&ZMS.&STATE"'                                    00115100
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00115200
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00115300
&ZMS            SETC  '&ZMS "ANY"'                                      00115400
&ZMS            SETC  '&ZMS OR "ACTIVE".'                               00115500
                MNOTE 8,' &ZMS '                                        00115600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00115700
.ZG14B          ANOP  ,                                                 00115800
&XSTATE         SETC  'ANY'       SET DEFAULT KEYWORD                   00115900
.ZG14C          ANOP  ,                                                 00116000
&ZXSTATE        SETC  'INPUT'     SET IN/OUTPUT                         00116100
.*----------------------------------------------------------------***   00116200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00116300
                AIF   (N'&SYSTEM LE 1).ZG16A    CK NUM                  00116400
&ZMS            SETC  '"SYSTEM='  *KPOSA* MNOTE                         00116500
&ZMS            SETC  '&ZMS.&SYSTEM"'                                   00116600
&ZMS            SETC  '&ZMS "SYSTEM"'                                   00116700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00116800
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00116900
.ZG16A          ANOP  ,                                                 00117000
.*-------------------------------------------------------------------   00117100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00117200
&XSYSTEM        SETC  ''          INITIALIZE XVARIABLE                  00117300
.ZG17A   AIF   ('&SYSTEM(1)' NE 'ANY').ZG18A                            00117400
&XSYSTEM        SETC  'ANY'       SET KEYWORD                           00117500
.*-------------------------------------------------------------------   00117600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00117700
.ZG18A   AIF   ('&SYSTEM(1)' NE 'CURRENT').ZG19A                        00117800
&XSYSTEM        SETC  'CURRENT'   SET KEYWORD                           00117900
.*-------------------------------------------------------------------   00118000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00118100
.ZG19A          AIF   (K'&XSYSTEM GT 0).ZG19C   KEYWORD                 00118200
                AIF   (K'&SYSTEM(1) LE 0).ZG19B                         00118300
&ZMS            SETC  '"SYSTEM='  *KUKWA* MNOTE                         00118400
&ZMS            SETC  '&ZMS.&SYSTEM"'                                   00118500
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00118600
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00118700
&ZMS            SETC  '&ZMS "ANY"'                                      00118800
&ZMS            SETC  '&ZMS OR "CURRENT".'                              00118900
                MNOTE 8,' &ZMS '                                        00119000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00119100
.ZG19B          ANOP  ,                                                 00119200
&XSYSTEM        SETC  'ANY'       SET DEFAULT KEYWORD                   00119300
.ZG19C          ANOP  ,                                                 00119400
&ZXSYSTEM       SETC  'INPUT'     SET IN/OUTPUT                         00119500
.*----------------------------------------------------------------***   00119600
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00119700
                AIF   (N'&POLYJES LE 1).ZG21A   CK NUM                  00119800
&ZMS            SETC  '"POLYJES='               *KPOSA* MNOTE           00119900
&ZMS            SETC  '&ZMS.&POLYJES"'                                  00120000
&ZMS            SETC  '&ZMS "POLYJES"'                                  00120100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00120200
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00120300
.ZG21A          ANOP  ,                                                 00120400
.*-------------------------------------------------------------------   00120500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120600
&XPOLYJES       SETC  ''          INITIALIZE XVARIABLE                  00120700
.ZG22A   AIF   ('&POLYJES(1)' NE 'YES').ZG23A                           00120800
&XPOLYJES       SETC  'YES'       SET KEYWORD                           00120900
.*-------------------------------------------------------------------   00121000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121100
.ZG23A   AIF   ('&POLYJES(1)' NE 'NO').ZG24A                            00121200
&XPOLYJES       SETC  'NO'        SET KEYWORD                           00121300
.*-------------------------------------------------------------------   00121400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00121500
.ZG24A          AIF   (K'&XPOLYJES GT 0).ZG24C  KEYWORD                 00121600
                AIF   (K'&POLYJES(1) LE 0).ZG24B                        00121700
&ZMS            SETC  '"POLYJES='               *KUKWA* MNOTE           00121800
&ZMS            SETC  '&ZMS.&POLYJES"'                                  00121900
&ZMS            SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '         00122000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00122100
&ZMS            SETC  '&ZMS "YES"'                                      00122200
&ZMS            SETC  '&ZMS OR "NO".'                                   00122300
                MNOTE 8,' &ZMS '                                        00122400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00122500
.ZG24B          ANOP  ,                                                 00122600
&XPOLYJES       SETC  'YES'       SET DEFAULT KEYWORD                   00122700
.ZG24C          ANOP  ,                                                 00122800
&ZXPOLYJES      SETC  'INPUT'     SET IN/OUTPUT                         00122900
.*-------------------------------------------------------------------   00123000
.***AG.KKWRD07 VALUE, OPT INPUT, ME KEYWORD -MULTIPLE KEYWORDS          00123100
&ZI             SETA  0           XVARIABLE ARRAY INDEX                 00123200
&ZJ             SETA  0           SUBLIST INDEX                         00123300
.ZG26A          ANOP  ,                                                 00123400
&ZJ             SETA  &ZJ+1       NEXT SUBLIST                          00123500
                AIF   (&ZJ GT N'&FUNCTION).ZG26C  DONE                  00123600
                AIF   (K'&FUNCTION(&ZJ) LE 0).ZG26A  NULL               00123700
&ZI             SETA  &ZI+1       NEXT ARRAY ENTRY                      00123800
&XFUNCTION(&ZI)   SETC  ''        NULL ENTRY                            00123900
&XFUNCTION(&ZI+1) SETC  ''        NULL AT ARRAY END                     00124000
.ZG27B  AIF   ('&FUNCTION(&ZJ)' NE 'NA').ZG28B                          00124100
&XFUNCTION(&ZI)   SETC  'NA'      SET KEYWORD                           00124200
.ZG28B  AIF   ('&FUNCTION(&ZJ)' NE 'ARM').ZG29B                         00124300
&XFUNCTION(&ZI)   SETC  'ARM'     SET KEYWORD                           00124400
.ZG29B          AIF   ('&XFUNCTION(&ZI)' NE '').ZG26A                   00124500
&ZI             SETA  &ZI-1       BACKUP ARRAY                          00124600
&ZMS            SETC  '"FUNCTION='              *KVKWA* MNOTE           00124700
&ZMS            SETC  '&ZMS.&FUNCTION"'                                 00124800
&ZMS            SETC  '&ZMS ARGUMENT &ZJ'                               00124900
&ZMS            SETC  '&ZMS IS AN UNKNOWN KEYWORD. '                    00125000
&ZMS            SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'               00125100
&ZMS            SETC  '&ZMS "NA"'                                       00125200
&ZMS            SETC  '&ZMS OR "ARM".'                                  00125300
                MNOTE 8,' &ZMS '                                        00125400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00125500
                AGO   .ZG26A                                            00125600
.*-------------------------------------------------------------------   00125700
.***AG.KKWRD08 VALUE, OPT INPUT, ME KEYWORD -MULTIPLE KEYWORDS          00125800
.ZG26C          ANOP  ,                                                 00125900
&ZXFUNCTION     SETC  'INPUT'     SET IN/OUTPUT                         00126000
                AIF   (&ZI GT 0).ZG26D          VALID KEYWORD           00126100
&XFUNCTION(1)  SETC  'NA'         SET DEFAULT KEYWORD                   00126200
&XFUNCTION(2)  SETC  ''           NULL AT ARRAY END                     00126300
.ZG26D          ANOP  ,                                                 00126400
.*----------------------------------------------------------------***   00126500
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00126600
&XRTNAREA       SETC  ''          INITIALIZE XVARIABLE                  00126700
                AIF   (K'&REQMBOX LE 0).ZG31C                           00126800
&ZXRTNAREA      SETC  'INPUT'     SET IN/OUTPUT                         00126900
&XRTNAREA       SETC  'REQMBOX'   SET XVARIABLE                         00127000
&ZXREQMBOX      SETC  'INPUT'     SET IN/OUTPUT                         00127100
&XREQMBOX       SETC  '&REQMBOX(1)'             SET XVARIABLE PARM      00127200
                AIF   (N'&REQMBOX GT 1).ZG31A                           00127300
&XREQMBOX       SETC  '&REQMBOX'  SET XVARIABLE PARM                    00127400
.ZG31A          AIF   (N'&REQMBOX LE 1).ZG31B   CK NUM                  00127500
&ZMS            SETC  '"REQMBOX='               *KPOSA* MNOTE           00127600
&ZMS            SETC  '&ZMS.&REQMBOX"'                                  00127700
&ZMS            SETC  '&ZMS "REQMBOX"'                                  00127800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00127900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00128000
.ZG31B          AIF   (K'&XREQMBOX GT 0).ZG31C  ONE PARM                00128100
&ZXRTNAREA      SETC  ''          RESET IN/OUTPUT                       00128200
&ZXREQMBOX      SETC  ''          RESET IN/OUTPUT                       00128300
&ZMS            SETC  ' '         *KRQDA*                               00128400
&ZMS            SETC  '&ZMS "REQMBOX" KEY AND ITS'                      00128500
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00128600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00128700
.ZG31C          ANOP  ,                                                 00128800
.*----------------------------------------------------------------***   00128900
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00129000
                AIF   (K'&ANSAREA LE 0).ZG35D   NO ME KEY               00129100
                AIF   (N'&ANSAREA LE 1).ZG35A   CK NUM                  00129200
&ZMS            SETC  '"ANSAREA='               *KPOSA* MNOTE           00129300
&ZMS            SETC  '&ZMS.&ANSAREA"'                                  00129400
&ZMS            SETC  '&ZMS "ANSAREA"'                                  00129500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00129600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00129700
.ZG35A          AIF   (K'&XRTNAREA LE 0).ZG35B                          00129800
&ZMS            SETC  '"ANSAREA'  *KMEKA* MNOTE                         00129900
&ZMS            SETC  '&ZMS.=&ANSAREA"'                                 00130000
&ZMS            SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'             00130100
&ZMS            SETC  '&ZMS "&XRTNAREA"'                                00130200
                MNOTE 8,' &ZMS KEY.'                                    00130300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00130400
                AGO   .ZG35D                                            00130500
.*                                                                      00130600
.ZG35B          ANOP  ,                                                 00130700
&ZXRTNAREA      SETC  'INPUT'     SET IN/OUTPUT                         00130800
&XRTNAREA       SETC  'ANSAREA'   SET XVARIABLE                         00130900
&ZXANSAREA      SETC  'INPUT'     SET IN/OUTPUT                         00131000
&XANSAREA       SETC  '&ANSAREA(1)'             SET XVARIABLE PARM      00131100
                AIF   (N'&ANSAREA GT 1).ZG35C                           00131200
&XANSAREA       SETC  '&ANSAREA'  SET XVARIABLE PARM                    00131300
.ZG35C          AIF   (K'&XANSAREA GT 0).ZG35D  ONE PARM                00131400
&ZXRTNAREA      SETC  ''          RESET IN/OUTPUT                       00131500
&ZXANSAREA      SETC  ''          RESET IN/OUTPUT                       00131600
&ZMS            SETC  ' '         *KRQDA*                               00131700
&ZMS            SETC  '&ZMS "ANSAREA" KEY AND ITS'                      00131800
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00131900
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00132000
.ZG35D          ANOP  ,                                                 00132100
.*------------------------------------------------------------------    00132200
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00132300
                AIF   (K'&XRTNAREA GT 0).ZG39B                          00132400
&ZXRTNAREA      SETC  ''          RESET IN/OUTPUT                       00132500
&ZXREQMBOX      SETC  ''          RESET IN/OUTPUT                       00132600
&XRTNAREA       SETC  ''          ENSURE NULL                           00132700
&XREQMBOX       SETC  ''          ENSURE NULL                           00132800
&ZMS            SETC  'ONE OF THE FOLLOWING'    *KMERA* MNOTE           00132900
&ZMS            SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'               00133000
&ZMS            SETC  '&ZMS REQUIRED:'                                  00133100
&ZMS            SETC  '&ZMS "REQMBOX"'          VALID ME KEY            00133200
&ZMS            SETC  '&ZMS OR "ANSAREA".'      VALID ME KEY            00133300
                MNOTE 8,' &ZMS '                                        00133400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00133500
.ZG39B          ANOP  ,                                                 00133600
.*-------------------------------------------------------------------   00133700
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00133800
.ZG31           AIF   ('&XRTNAREA' NE 'REQMBOX').ZG35                   00133900
.*-------------------------------------------------------------------   00134000
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00134100
&ZCVAL          SETC ''           ERROR KEY FIELD                       00134200
.ZG31I0         AIF   (K'&ANSLEN LE 0).ZG31I1                           00134300
&ZCVAL          SETC '&ZCVAL ANSLEN'            DISALLOWED KEY          00134400
.ZG31I1         AIF   (K'&ZCVAL LE 0).ZG31J     KEY                     00134500
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00134600
&ZMS            SETC  '"REQMBOX'  *KMEIA* MNOTE                         00134700
&ZMS            SETC  '&ZMS.=&REQMBOX"'                                 00134800
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00134900
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00135000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00135100
.ZG31J          ANOP  ,                                                 00135200
.*-------------------------------------------------------------------   00135300
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00135400
                AIF   (K'&ZXREQMBOX LE 0).ZG31R  NOT I/O                00135500
                AIF   ('&XREQMBOX'(1,1) NE '(').ZG31R                   00135600
&ZCGPR          SETC  '&XREQMBOX'(2,K'&XREQMBOX-2)                      00135700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                      00135800
                AIF   (K'&ZCGPR GT 2).ZG31Q                             00135900
                AIF   ('&ZCGPR' EQ '0').ZG31Q                           00136000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00136100
                AIF   (T'&ZCGPR NE 'N').ZG31Q   INVALID REG NAME        00136200
.ZG31P          ANOP  ,                                                 00136300
                AIF   (T'&ZCGPR NE 'N').ZG31R   NON NUMERIC             00136400
                AIF   ('&ZCGPR' LT '2').ZG31Q                           00136500
                AIF   ('&ZCGPR' LE '12').ZG31R                          00136600
.ZG31Q          ANOP  ,                                                 00136700
&ZMS            SETC  '"REQMBOX='               *KGPRA* MNOTE           00136800
&ZMS            SETC  '&ZMS.&REQMBOX"'                                  00136900
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00137000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00137100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00137200
.ZG31R          ANOP  ,                                                 00137300
.*----------------------------------------------------------------***   00137400
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00137500
                AIF   (N'&REQTOKEN LE 1).ZG33A  CK NUM                  00137600
&ZMS            SETC  '"REQTOKEN='              *KPOSA* MNOTE           00137700
&ZMS            SETC  '&ZMS.&REQTOKEN"'                                 00137800
&ZMS            SETC  '&ZMS "REQTOKEN"'                                 00137900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00138000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00138100
.ZG33A          ANOP  ,                                                 00138200
.*-------------------------------------------------------------------   00138300
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00138400
&ZXREQTOKEN     SETC  'OUTPUT'    SET IN/OUTPUT                         00138500
&XREQTOKEN      SETC  '&REQTOKEN(1)'            SET XVARIABLE           00138600
                AIF   (N'&REQTOKEN GT 1).ZG33B  MULTI PARMS             00138700
&XREQTOKEN      SETC  '&REQTOKEN'               SET XVARIABLE           00138800
.ZG33B          AIF   (K'&REQTOKEN(1) GT 0).ZG33C                       00138900
&ZXREQTOKEN     SETC  ''          RESET IN/OUTPUT                       00139000
&ZMS            SETC  ' '         *KRQDA*                               00139100
&ZMS            SETC  '&ZMS "REQTOKEN" KEY AND ITS'                     00139200
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00139300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00139400
.ZG33C          ANOP  ,                                                 00139500
.*-------------------------------------------------------------------   00139600
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00139700
                AIF   (K'&ZXREQTOKEN LE 0).ZG33R  NOT I/O               00139800
                AIF   ('&XREQTOKEN'(1,1) NE '(').ZG33R                  00139900
&ZCGPR          SETC  '&XREQTOKEN'(2,K'&XREQTOKEN-2)                    00140000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                      00140100
                AIF   (K'&ZCGPR GT 2).ZG33Q                             00140200
                AIF   ('&ZCGPR' EQ '0').ZG33Q                           00140300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00140400
                AIF   (T'&ZCGPR NE 'N').ZG33Q   INVALID REG NAME        00140500
.ZG33P          ANOP  ,                                                 00140600
                AIF   (T'&ZCGPR NE 'N').ZG33R   NON NUMERIC             00140700
                AIF   ('&ZCGPR' LT '2').ZG33Q                           00140800
                AIF   ('&ZCGPR' LE '12').ZG33R                          00140900
.ZG33Q          ANOP  ,                                                 00141000
&ZMS            SETC  '"REQTOKEN='              *KGPRA* MNOTE           00141100
&ZMS            SETC  '&ZMS.&REQTOKEN"'                                 00141200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00141300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00141400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00141500
.ZG33R          ANOP  ,                                                 00141600
.*-------------------------------------------------------------------   00141700
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00141800
.ZG35           AIF   ('&XRTNAREA' NE 'ANSAREA').ZG39                   00141900
.*-------------------------------------------------------------------   00142000
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00142100
&ZCVAL          SETC ''           ERROR KEY FIELD                       00142200
.ZG35I0         AIF   (K'&REQTOKEN LE 0).ZG35I1                         00142300
&ZCVAL          SETC '&ZCVAL REQTOKEN'          DISALLOWED KEY          00142400
.ZG35I1         AIF   (K'&ZCVAL LE 0).ZG35J     KEY                     00142500
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)                             00142600
&ZMS            SETC  '"ANSAREA'  *KMEIA* MNOTE                         00142700
&ZMS            SETC  '&ZMS.=&ANSAREA"'                                 00142800
&ZMS            SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'              00142900
                MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'              00143000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00143100
.ZG35J          ANOP  ,                                                 00143200
.*-------------------------------------------------------------------   00143300
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00143400
                AIF   (K'&ZXANSAREA LE 0).ZG35R  NOT I/O                00143500
                AIF   ('&XANSAREA'(1,1) NE '(').ZG35R                   00143600
&ZCGPR          SETC  '&XANSAREA'(2,K'&XANSAREA-2)                      00143700
                AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                      00143800
                AIF   (K'&ZCGPR GT 2).ZG35Q                             00143900
                AIF   ('&ZCGPR' EQ '0').ZG35Q                           00144000
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00144100
                AIF   (T'&ZCGPR NE 'N').ZG35Q   INVALID REG NAME        00144200
.ZG35P          ANOP  ,                                                 00144300
                AIF   (T'&ZCGPR NE 'N').ZG35R   NON NUMERIC             00144400
                AIF   ('&ZCGPR' LT '2').ZG35Q                           00144500
                AIF   ('&ZCGPR' LE '12').ZG35R                          00144600
.ZG35Q          ANOP  ,                                                 00144700
&ZMS            SETC  '"ANSAREA='               *KGPRA* MNOTE           00144800
&ZMS            SETC  '&ZMS.&ANSAREA"'                                  00144900
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00145000
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00145100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00145200
.ZG35R          ANOP  ,                                                 00145300
.*----------------------------------------------------------------***   00145400
.***AG.KXVAR05 NAME, RQD INOUT, KEYS -XVARIABLE KEY                     00145500
                AIF   (N'&ANSLEN LE 1).ZG37A    CK NUM                  00145600
&ZMS            SETC  '"ANSLEN='  *KPOSA* MNOTE                         00145700
&ZMS            SETC  '&ZMS.&ANSLEN"'                                   00145800
&ZMS            SETC  '&ZMS "ANSLEN"'                                   00145900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00146000
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00146100
.ZG37A          ANOP  ,                                                 00146200
.*-------------------------------------------------------------------   00146300
.***AG.KXVAR06 NAME, RQD INOUT, KEYS -XVARIABLE                         00146400
&ZXANSLEN       SETC  'INOUT'     SET IN/OUTPUT                         00146500
&XANSLEN        SETC  '&ANSLEN(1)'              SET XVARIABLE           00146600
                AIF   (N'&ANSLEN GT 1).ZG37B    MULTI PARMS             00146700
&XANSLEN        SETC  '&ANSLEN'   SET XVARIABLE                         00146800
.ZG37B          AIF   (K'&ANSLEN(1) GT 0).ZG37C                         00146900
&ZXANSLEN       SETC  ''          RESET IN/OUTPUT                       00147000
&ZMS            SETC  ' '         *KRQDA*                               00147100
&ZMS            SETC  '&ZMS "ANSLEN" KEY AND ITS'                       00147200
                MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                  00147300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00147400
.ZG37C          ANOP  ,                                                 00147500
.*-------------------------------------------------------------------   00147600
.***AG.KCK02 NAME, RQD INOUT, KEYS -GPR OUT OF RANGE                    00147700
                AIF   (K'&ZXANSLEN LE 0).ZG37R  NOT I/O                 00147800
                AIF   ('&XANSLEN'(1,1) NE '(').ZG37R                    00147900
&ZCGPR          SETC  '&XANSLEN'(2,K'&XANSLEN-2)                        00148000
                AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                      00148100
                AIF   (K'&ZCGPR GT 2).ZG37Q                             00148200
                AIF   ('&ZCGPR' EQ '0').ZG37Q                           00148300
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00148400
                AIF   (T'&ZCGPR NE 'N').ZG37Q   INVALID REG NAME        00148500
.ZG37P          ANOP  ,                                                 00148600
                AIF   (T'&ZCGPR NE 'N').ZG37R   NON NUMERIC             00148700
                AIF   ('&ZCGPR' LT '2').ZG37Q                           00148800
                AIF   ('&ZCGPR' LE '12').ZG37R                          00148900
.ZG37Q          ANOP  ,                                                 00149000
&ZMS            SETC  '"ANSLEN='  *KGPRA* MNOTE                         00149100
&ZMS            SETC  '&ZMS.&ANSLEN"'                                   00149200
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00149300
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00149400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00149500
.ZG37R          ANOP  ,                                                 00149600
.*-------------------------------------------------------------------   00149700
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00149800
.ZG39           ANOP  ,           END MUTUALLY EXCLUSIVE KEYS           00149900
.*----------------------------------------------------------------***   00150000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00150100
                AIF   (N'&RTNCODE LE 1).ZG41A   CK NUM                  00150200
&ZMS            SETC  '"RTNCODE='               *KPOSA* MNOTE           00150300
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00150400
&ZMS            SETC  '&ZMS "RTNCODE"'                                  00150500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00150600
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00150700
.ZG41A          ANOP  ,                                                 00150800
.*-------------------------------------------------------------------   00150900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00151000
                AIF   (K'&RTNCODE(1) LE 0).ZG41C  NO PARM               00151100
&ZXRTNCODE      SETC  'OUTPUT'    SET OUTPUT                            00151200
&XRTNCODE       SETC  '&RTNCODE(1)'             SET XVARIABLE           00151300
                AIF   (N'&RTNCODE GT 1).ZG41C                           00151400
&XRTNCODE       SETC  '&RTNCODE'  SET XVARIABLE                         00151500
.ZG41C          ANOP  ,                                                 00151600
.*-------------------------------------------------------------------   00151700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00151800
                AIF   (K'&ZXRTNCODE LE 0).ZG41R  NOT I/O                00151900
                AIF   ('&XRTNCODE'(1,1) NE '(').ZG41R                   00152000
&ZCGPR          SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                      00152100
                AIF   ('&ZCGPR'(1,1) NE '0').ZG41P                      00152200
                AIF   (K'&ZCGPR GT 2).ZG41Q                             00152300
                AIF   ('&ZCGPR' EQ '0').ZG41Q                           00152400
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00152500
                AIF   (T'&ZCGPR NE 'N').ZG41Q   INVALID REG NAME        00152600
.ZG41P          ANOP  ,                                                 00152700
                AIF   (T'&ZCGPR NE 'N').ZG41R   NON NUMERIC             00152800
                AIF   ('&ZCGPR' LT '2').ZG41Q                           00152900
                AIF   ('&ZCGPR' LE '12').ZG41R                          00153000
.ZG41Q          ANOP  ,                                                 00153100
&ZMS            SETC  '"RTNCODE='               *KGPRA* MNOTE           00153200
&ZMS            SETC  '&ZMS.&RTNCODE"'                                  00153300
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00153400
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00153500
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00153600
.ZG41R          ANOP  ,                                                 00153700
.*----------------------------------------------------------------***   00153800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00153900
                AIF   (N'&RSNCODE LE 1).ZG44A   CK NUM                  00154000
&ZMS            SETC  '"RSNCODE='               *KPOSA* MNOTE           00154100
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00154200
&ZMS            SETC  '&ZMS "RSNCODE"'                                  00154300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00154400
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00154500
.ZG44A          ANOP  ,                                                 00154600
.*-------------------------------------------------------------------   00154700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00154800
                AIF   (K'&RSNCODE(1) LE 0).ZG44C  NO PARM               00154900
&ZXRSNCODE      SETC  'OUTPUT'    SET OUTPUT                            00155000
&XRSNCODE       SETC  '&RSNCODE(1)'             SET XVARIABLE           00155100
                AIF   (N'&RSNCODE GT 1).ZG44C                           00155200
&XRSNCODE       SETC  '&RSNCODE'  SET XVARIABLE                         00155300
.ZG44C          ANOP  ,                                                 00155400
.*-------------------------------------------------------------------   00155500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00155600
                AIF   (K'&ZXRSNCODE LE 0).ZG44R  NOT I/O                00155700
                AIF   ('&XRSNCODE'(1,1) NE '(').ZG44R                   00155800
&ZCGPR          SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                      00155900
                AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                      00156000
                AIF   (K'&ZCGPR GT 2).ZG44Q                             00156100
                AIF   ('&ZCGPR' EQ '0').ZG44Q                           00156200
&ZCGPR          SETC  '&ZCGPR'(2,1)                                     00156300
                AIF   (T'&ZCGPR NE 'N').ZG44Q   INVALID REG NAME        00156400
.ZG44P          ANOP  ,                                                 00156500
                AIF   (T'&ZCGPR NE 'N').ZG44R   NON NUMERIC             00156600
                AIF   ('&ZCGPR' LT '2').ZG44Q                           00156700
                AIF   ('&ZCGPR' LE '12').ZG44R                          00156800
.ZG44Q          ANOP  ,                                                 00156900
&ZMS            SETC  '"RSNCODE='               *KGPRA* MNOTE           00157000
&ZMS            SETC  '&ZMS.&RSNCODE"'                                  00157100
&ZMS            SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'         00157200
                MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                  00157300
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00157400
.ZG44R          ANOP  ,                                                 00157500
.******************************************************************     00157600
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00157700
.******************************************************************     00157800
                ACTR  10000                                             00157900
.*----------------------------------------------------------------***   00158000
.***AH.P02 EXTRA POSITIONALS                                            00158100
                AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS              00158200
                AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL              00158300
                AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL          00158400
                AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL           00158500
.ZGLISTX1       ANOP  ,                                                 00158600
&ZCVAL          SETC  ''          ERROR FIELD                           00158700
&ZAWRK          SETA  0           POSITIONAL NUMBER                     00158800
.ZGLIST2        ANOP  ,                                                 00158900
&ZAWRK          SETA  &ZAWRK+1    NEXT POSITIONAL                       00159000
                AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE              00159100
&ZCVAL          SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                   00159200
                AGO   .ZGLIST2                                          00159300
.*                                                                      00159400
.ZGLIST3        ANOP  ,                                                 00159500
&ZCVAL          SETC '&ZCVAL'(2,K'&ZCVAL-1)     STRIP COMMA             00159600
&ZMS            SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE          00159700
&ZMS            SETC  '&ZMS "&ZCVAL"'                                   00159800
&ZMS            SETC  '&ZMS CANNOT BE USED.'                            00159900
&ZMS            SETC  '&ZMS NO POSITIONAL ARGUMENTS'                    00160000
                MNOTE 8,' &ZMS ARE ALLOWED.'                            00160100
&ZMACRET        SETA  8           SET MACRO ERROR RETURN CODE           00160200
.ZGLISTX        ANOP  ,                                                 00160300
&ZASYSLNDX      SETA  0                                                 00160400
.*-------------------------------------------------------------------   00160500
.***AG.MF04 MF=(SLE)                                                    00160600
.ZGMFX          ANOP  ,           END OF FULL SYNTAX CHECK              00160700
.*******************************************************************    00160800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00160900
.*******************************************************************    00161000
                AIF   (&ZMACRET NE 0).ZLX2      ERROR DETECTED          00161100
.*******************************************************************    00161200
.***AE.01  START OF IXZXIXIF MACRO CODE                                 00161300
.*******************************************************************    00161400
                LCLC  &M0M0001                 NAME                     00161500
&M0M0001        SETC  '&XLABEL'                SET NAME                 00161600
                AIF   (K'&XLABEL NE 0).XLAB2                            00161700
&M0M0001        SETC  'M00M&SYSNDX'            DEFAULT NAME             00161800
.*                                                                      00161900
.XLAB2          ANOP  ,                                                 00162000
                AIF   ('&XMF' EQ 'L').XLAB3                             00162100
&M0M0001 DS    0H                             IXZXIXIF-2                00162200
.XLAB3          ANOP  ,                                                 00162300
.*******************************************************************    00162400
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00162500
.*******************************************************************    00162600
              PUSH  PRINT                                               00162700
                AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON        00162800
                PRINT OFF         ++ PR01                               00162900
                AGO   .ZPRNTXX                                          00163000
.ZPRINTX        PRINT ON                                                00163100
.ZPRNTXX        ANOP  ,                                                 00163200
.********************************************************************   00163300
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00163400
.********************************************************************   00163500
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00163600
                      LCLA  &ZOPN1         INVOCATION INDEX             00163700
                      LCLC  &ZOPL(4095)    LABEL                        00163800
                      LCLC  &ZOPO(4095)    OPERATION                    00163900
                      LCLC  &ZOPV(4095)    VALUE                        00164000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00164100
.*                                                                      00164200
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00164300
.******************************************************************     00164400
.***AL.L10 IXZXIXIF FMT=LIST MF=S!L PARAMETERS                          00164500
.******************************************************************     00164600
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00164700
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00164800
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00164900
&XMFATTR              SETC  '0D'                                        00165000
.*                                                                      00165100
&ZOPN                 SETA  &ZOPN+1                                     00165200
&ZOPL(&ZOPN)          SETC  ' '                                         00165300
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00165400
&ZOPO(&ZOPN)          SETC  'B'                                         00165500
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00165600
                      AGO   .ZALVL6B                                    00165700
.ZALVL6A              ANOP                                              00165800
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00165900
&ZOPV(&ZOPN)          SETC  '4,8'                                       00166000
&ZOPN                 SETA  &ZOPN+1                                     00166100
&ZOPL(&ZOPN)          SETC  ' '                                         00166200
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00166300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00166400
.ZALVL6B              ANOP                                              00166500
&ZOPD(&ZOPN)          SETC  '++ IXZXIXIF ARG PARMS'                     00166600
.*                                                                      00166700
&ZOPN                 SETA  &ZOPN+1                                     00166800
&ZOPL(&ZOPN)          SETC  ' '                                         00166900
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00167000
&ZOPV(&ZOPN)          SETC  '1'                                         00167100
&ZOPD(&ZOPN)          SETC  ' '                                         00167200
.*                                                                      00167300
.ZLMFSL2              ANOP  ,                                           00167400
.*-------------------------------------------------------------------   00167500
.***AM.L00  IXZXIXIF FMT=LIST name                                      00167600
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00167700
&ZOPN                 SETA &ZOPN+1                                      00167800
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00167900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00168000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00168100
&ZOPD(&ZOPN)          SETC '++ IXZXIXIF NAME'                           00168200
.ZLMFSL2M             ANOP  ,                                           00168300
.*-------------------------------------------------------------------   00168400
.***AM.L01  IXZXIXIF FMT=LIST PARAMETERS                                00168500
&ZOPN                 SETA &ZOPN+1                                      00168600
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00168700
&ZOPO(&ZOPN)          SETC 'DS'                                         00168800
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00168900
&ZOPD(&ZOPN)          SETC '++ IXZXIXIF PARM LIST'                      00169000
.*-------------------------------------------------------------------   00169100
.***AM.L02 XVERSION XL1                                                 00169200
&ZOPN                 SETA &ZOPN+1                                      00169300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00169400
&ZOPO(&ZOPN)          SETC 'DS'                                         00169500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00169600
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00169700
.*-------------------------------------------------------------------   00169800
.***AM.L09  XEYECATCH CL6                                               00169900
&ZOPN                 SETA &ZOPN+1                                      00170000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEYECATCH'                        00170100
&ZOPO(&ZOPN)          SETC 'DS'                                         00170200
&ZOPV(&ZOPN)          SETC 'CL6'                                        00170300
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XEYECATCH'                     00170400
.*-------------------------------------------------------------------   00170500
.***AM.L09  XRSV0001 CL1                                                00170600
&ZOPN                 SETA &ZOPN+1                                      00170700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00170800
&ZOPO(&ZOPN)          SETC 'DS'                                         00170900
&ZOPV(&ZOPN)          SETC 'CL1'                                        00171000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00171100
.*-------------------------------------------------------------------   00171200
.***AM.L09  XGROUPTOKEN F                                               00171300
&ZOPN                 SETA &ZOPN+1                                      00171400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGROUPTOKEN'                      00171500
&ZOPO(&ZOPN)          SETC 'DS'                                         00171600
&ZOPV(&ZOPN)          SETC 'F'                                          00171700
&ZOPD(&ZOPN)          SETC '++ &ZXGROUPTOKEN  XGROUPTOKEN'              00171800
.*-------------------------------------------------------------------   00171900
.***AM.L09  XREQMBOX CL16                                               00172000
&ZOPN                 SETA &ZOPN+1                                      00172100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQMBOX'                         00172200
&ZOPO(&ZOPN)          SETC 'DS'                                         00172300
&ZOPV(&ZOPN)          SETC 'CL16'                                       00172400
&ZOPD(&ZOPN)          SETC '++ &ZXREQMBOX  XREQMBOX'                    00172500
.*-------------------------------------------------------------------   00172600
.***AM.L09  XREQTOKEN CL8                                               00172700
&ZOPN                 SETA &ZOPN+1                                      00172800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQTOKEN'                        00172900
&ZOPO(&ZOPN)          SETC 'DS'                                         00173000
&ZOPV(&ZOPN)          SETC 'CL8'                                        00173100
&ZOPD(&ZOPN)          SETC '++ &ZXREQTOKEN  XREQTOKEN'                  00173200
.*-------------------------------------------------------------------   00173300
.***AM.L09  XANSAREA A                                                  00173400
&ZOPN                 SETA &ZOPN+1                                      00173500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA'                         00173600
&ZOPO(&ZOPN)          SETC 'DS'                                         00173700
&ZOPV(&ZOPN)          SETC 'A'                                          00173800
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA  XANSAREA'                    00173900
.*-------------------------------------------------------------------   00174000
.***AM.L09  XANSLEN F                                                   00174100
&ZOPN                 SETA &ZOPN+1                                      00174200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00174300
&ZOPO(&ZOPN)          SETC 'DS'                                         00174400
&ZOPV(&ZOPN)          SETC 'F'                                          00174500
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN  XANSLEN'                      00174600
.*-------------------------------------------------------------------   00174700
.***AM.L03 XINFOLVL BL.8                                                00174800
&ZOPN                 SETA &ZOPN+1                                      00174900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINFOLVL'                         00175000
&ZOPO(&ZOPN)          SETC 'DS'                                         00175100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00175200
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00175300
.*                                                                      00175400
&ZOPN                 SETA  &ZOPN+1                                     00175500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XINFOLVL_GROUP'                  00175600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00175700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00175800
&ZOPD(&ZOPN)          SETC  '++ XINFOLVL.'                              00175900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GROUP'                        00176000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00176100
.*                                                                      00176200
&ZOPN                 SETA  &ZOPN+1                                     00176300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XINFOLVL_MEMBER'                 00176400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00176500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00176600
&ZOPD(&ZOPN)          SETC  '++ XINFOLVL.'                              00176700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MEMBER'                       00176800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00176900
.*-------------------------------------------------------------------   00177000
.***AM.L03 XKEYS BL.8                                                   00177100
&ZOPN                 SETA &ZOPN+1                                      00177200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XKEYS'                            00177300
&ZOPO(&ZOPN)          SETC 'DS'                                         00177400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00177500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00177600
.*                                                                      00177700
&ZOPN                 SETA  &ZOPN+1                                     00177800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_REQMBOX'                 00177900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00178000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00178100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00178200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REQMBOX'                      00178300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00178400
.*                                                                      00178500
&ZOPN                 SETA  &ZOPN+1                                     00178600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ANSAREA'                 00178700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00178800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00178900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00179000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ANSAREA'                      00179100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00179200
.*                                                                      00179300
&ZOPN                 SETA  &ZOPN+1                                     00179400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_GROUPTOKEN'              00179500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00179600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00179700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00179800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GROUPTOKEN'                   00179900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00180000
.*                                                                      00180100
&ZOPN                 SETA  &ZOPN+1                                     00180200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_GROUPNAME'               00180300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00180400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00180500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00180600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GROUPNAME'                    00180700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00180800
.*-------------------------------------------------------------------   00180900
.***AM.L03 XSTATE BL.8                                                  00181000
&ZOPN                 SETA &ZOPN+1                                      00181100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTATE'                           00181200
&ZOPO(&ZOPN)          SETC 'DS'                                         00181300
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00181400
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00181500
.*                                                                      00181600
&ZOPN                 SETA  &ZOPN+1                                     00181700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATE_ANY'                      00181800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00181900
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00182000
&ZOPD(&ZOPN)          SETC  '++ XSTATE.'                                00182100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ANY'                          00182200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00182300
.*                                                                      00182400
&ZOPN                 SETA  &ZOPN+1                                     00182500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATE_ACTIVE'                   00182600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00182700
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00182800
&ZOPD(&ZOPN)          SETC  '++ XSTATE.'                                00182900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ACTIVE'                       00183000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00183100
.*-------------------------------------------------------------------   00183200
.***AM.L03 XSYSTEM BL.8                                                 00183300
&ZOPN                 SETA &ZOPN+1                                      00183400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSTEM'                          00183500
&ZOPO(&ZOPN)          SETC 'DS'                                         00183600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00183700
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00183800
.*                                                                      00183900
&ZOPN                 SETA  &ZOPN+1                                     00184000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSYSTEM_ANY'                     00184100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00184200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00184300
&ZOPD(&ZOPN)          SETC  '++ XSYSTEM.'                               00184400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ANY'                          00184500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00184600
.*                                                                      00184700
&ZOPN                 SETA  &ZOPN+1                                     00184800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSYSTEM_CURRENT'                 00184900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00185000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00185100
&ZOPD(&ZOPN)          SETC  '++ XSYSTEM.'                               00185200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CURRENT'                      00185300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00185400
.*-------------------------------------------------------------------   00185500
.***AM.L03 XPOLYJES BL.8                                                00185600
&ZOPN                 SETA &ZOPN+1                                      00185700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPOLYJES'                         00185800
&ZOPO(&ZOPN)          SETC 'DS'                                         00185900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00186000
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00186100
.*                                                                      00186200
&ZOPN                 SETA  &ZOPN+1                                     00186300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XPOLYJES_YES'                    00186400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00186500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00186600
&ZOPD(&ZOPN)          SETC  '++ XPOLYJES.'                              00186700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00186800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00186900
.*                                                                      00187000
&ZOPN                 SETA  &ZOPN+1                                     00187100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XPOLYJES_NO'                     00187200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00187300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00187400
&ZOPD(&ZOPN)          SETC  '++ XPOLYJES.'                              00187500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           00187600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00187700
.*-------------------------------------------------------------------   00187800
.***AM.L03 XFUNCTION BL.16                                              00187900
&ZOPN                 SETA &ZOPN+1                                      00188000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNCTION'                        00188100
&ZOPO(&ZOPN)          SETC 'DS'                                         00188200
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00188300
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00188400
.*                                                                      00188500
&ZOPN                 SETA  &ZOPN+1                                     00188600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNCTION_ARM'                   00188700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00188800
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00188900
&ZOPD(&ZOPN)          SETC  '++ XFUNCTION.'                             00189000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ARM'                          00189100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00189200
.*-------------------------------------------------------------------   00189300
.***AM.L09  XGROUPNAME CL8                                              00189400
&ZOPN                 SETA &ZOPN+1                                      00189500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGROUPNAME'                       00189600
&ZOPO(&ZOPN)          SETC 'DS'                                         00189700
&ZOPV(&ZOPN)          SETC 'CL8'                                        00189800
&ZOPD(&ZOPN)          SETC '++ &ZXGROUPNAME  XGROUPNAME'                00189900
.*-------------------------------------------------------------------   00190000
.***AM.L10 END OF IXZXIXIF LIST PARAMETERS                              00190100
&ZOPN                 SETA &ZOPN+1                                      00190200
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00190300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00190400
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00190500
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00190600
.*                                                                      00190700
&ZOPN                 SETA &ZOPN+1                                      00190800
&ZOPL(&ZOPN)          SETC ' '                                          00190900
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00191000
&ZOPV(&ZOPN)          SETC '1'                                          00191100
&ZOPD(&ZOPN)          SETC ' '                                          00191200
.*-------------------------------------------------------------------   00191300
.***AL.L12 IXZXIXIF FMT=LIST MF=S!L PARAMETERS                          00191400
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00191500
.*                                                                      00191600
&ZOPN                 SETA  &ZOPN+1                                     00191700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00191800
&ZOPO(&ZOPN)          SETC  'DC'                                        00191900
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00192000
&ZOPD(&ZOPN)          SETC  '++ IXZXIXIF ARG PARMS'                     00192100
.*                                                                      00192200
.ZLMFSLX              ANOP  ,                                           00192300
.*-------------------------------------------------------------------   00192400
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00192500
&ZPLLEN               SETA 59                                           00192600
.*                                                                      00192700
.******************************************************************     00192800
.***AI.L01 IXZXIXIF FMT=LIST FILL IN PARAMETER AREA                     00192900
.******************************************************************     00193000
                      ACTR  10000                                       00193100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00193200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00193300
&ZCVAL                SETC  'LAE'          XAX MODE                     00193400
.ZIMFXA               ANOP ,                                            00193500
.*                                                                      00193600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00193700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00193800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00193900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00194000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00194100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00194200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00194300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00194400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00194500
&ZOPN                 SETA  &ZOPN+1                                     00194600
&ZOPL(&ZOPN)          SETC  ' '                                         00194700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00194800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00194900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00195000
                      AGO   .ZIMFNX                                     00195100
.*                                                                      00195200
.ZIMFN2               ANOP ,                                            00195300
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00195400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00195500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00195600
&ZOPN                 SETA  &ZOPN+1                                     00195700
&ZOPL(&ZOPN)          SETC  ' '                                         00195800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00195900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00196000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00196100
                      AGO   .ZIMFNX                                     00196200
.ZIMFNX1              ANOP ,                                            00196300
&ZOPN                 SETA  &ZOPN+1                                     00196400
&ZOPL(&ZOPN)          SETC  ' '                                         00196500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00196600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00196700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00196800
.ZIMFNX               ANOP ,                                            00196900
.********************************************************************   00197000
.***AI.L02 IXZXIXIF FMT=LIST INITIALIZE PARAMETER AREA                  00197100
.********************************************************************   00197200
.***AI.L03 MF=(SLE)                                                     00197300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00197400
.*                                                                      00197500
&ZOPN                 SETA  &ZOPN+1                                     00197600
&ZOPL(&ZOPN)          SETC  ' '                                         00197700
&ZOPO(&ZOPN)          SETC  'XC'                                        00197800
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00197900
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00198000
.ZIMFLX               ANOP  ,                                           00198100
.*-------------------------------------------------------------------   00198200
.***AI.L04B XVERSION XL1                                                00198300
                      AIF   (&XPLISTVER EQ 0).ZIMFVZ                    00198400
&ZOPN                 SETA  &ZOPN+1                                     00198500
&ZOPL(&ZOPN)          SETC  ' '                                         00198600
&ZOPO(&ZOPN)          SETC  'MVI'                                       00198700
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00198800
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00198900
.ZIMFVZ               ANOP  ,                                           00199000
.*-------------------------------------------------------------------   00199100
.***AI.L60 XEYECATCH CL6                                                00199200
&ZOPN                 SETA  &ZOPN+1                                     00199300
&ZOPL(&ZOPN)          SETC  ' '                                         00199400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00199500
&ZOPV(&ZOPN)          SETC  '1(6,1),=CL6''YIXIF '''                     00199600
&ZOPD(&ZOPN)          SETC  '++ CL6 CONSTANT'                           00199700
.*-------------------------------------------------------------------   00199800
.***AI.L25  XGROUPTOKEN F                                               00199900
                      AIF   ('&ZXGROUPTOKEN' EQ '').ZI4E                00200000
                      AIF   ('&ZXGROUPTOKEN' EQ 'OUTPUT').ZI4E          00200100
&ZCGPR                SETC  '&XGROUPTOKEN'                              00200200
.*                                                                      00200300
                      AIF   ('&XGROUPTOKEN'(1,1) NE '(').ZI4B           00200400
&ZCGPR   SETC  '0('.'&XGROUPTOKEN'(2,K'&XGROUPTOKEN-2).')'              00200500
                      AGO   .ZI4D                                       00200600
.ZI4B                 ANOP  ,                                           00200700
.*                                                                      00200800
&ZC                   SETC  '&XGROUPTOKEN'(1,1)                         00200900
                      AIF   (T'&ZC NE 'N').ZI4D                         00201000
&ZC                   SETC  '&XGROUPTOKEN'                              00201100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI4D                00201200
&ZCGPR                SETC  '=FL4''&XGROUPTOKEN'''                      00201300
.*                                                                      00201400
.ZI4D                 ANOP  ,                                           00201500
.*                                                                      00201600
&ZOPN                 SETA  &ZOPN+1                                     00201700
&ZOPL(&ZOPN)          SETC  ' '                                         00201800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00201900
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00202000
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPTOKEN XGROUPTOKEN'              00202100
.*                                                                      00202200
.ZI4E                 ANOP  ,                                           00202300
.*-------------------------------------------------------------------   00202400
.***AI.L25  XREQMBOX CL16                                               00202500
                      AIF   ('&ZXREQMBOX' EQ '').ZI5E                   00202600
                      AIF   ('&ZXREQMBOX' EQ 'OUTPUT').ZI5E             00202700
&ZCGPR                SETC  '&XREQMBOX'                                 00202800
.*                                                                      00202900
                      AIF   ('&XREQMBOX'(1,1) NE '(').ZI5B              00203000
&ZCGPR   SETC  '0('.'&XREQMBOX'(2,K'&XREQMBOX-2).')'                    00203100
.ZI5B                 ANOP  ,                                           00203200
.*                                                                      00203300
&ZOPN                 SETA  &ZOPN+1                                     00203400
&ZOPL(&ZOPN)          SETC  ' '                                         00203500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00203600
&ZOPV(&ZOPN)          SETC  '12(16,1),&ZCGPR'                           00203700
&ZOPD(&ZOPN)          SETC  '++ &ZXREQMBOX XREQMBOX'                    00203800
.*                                                                      00203900
.ZI5E                 ANOP  ,                                           00204000
.*-------------------------------------------------------------------   00204100
.***AI.L25  XANSAREA AL4                                                00204200
                      AIF   ('&ZXANSAREA' EQ '').ZI7E                   00204300
                      AIF   ('&ZXANSAREA' EQ 'OUTPUT').ZI7E             00204400
&ZCGPR                SETC  '&XANSAREA'                                 00204500
.*                                                                      00204600
                      AIF   ('&XANSAREA'(1,1) NE '(').ZI7B              00204700
&ZCGPR   SETC  '0('.'&XANSAREA'(2,K'&XANSAREA-2).')'                    00204800
.ZI7B                 ANOP  ,                                           00204900
.*                                                                      00205000
&ZC                   SETC  '&XANSAREA'(1,1)                            00205100
                      AIF   (T'&ZC NE 'N').ZI7D                         00205200
&ZC                   SETC  '&XANSAREA'                                 00205300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00205400
&ZCGPR                SETC  '=AL4(&XANSAREA)'                           00205500
.*                                                                      00205600
.ZI7D                 ANOP  ,                                           00205700
.*                                                                      00205800
&ZOPN                 SETA  &ZOPN+1                                     00205900
&ZOPL(&ZOPN)          SETC  ' '                                         00206000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00206100
&ZOPV(&ZOPN)          SETC  '36(4,1),&ZCGPR'                            00206200
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00206300
.*                                                                      00206400
.ZI7E                 ANOP  ,                                           00206500
.*-------------------------------------------------------------------   00206600
.***AI.L25  XANSLEN F                                                   00206700
                      AIF   ('&ZXANSLEN' EQ '').ZI8E                    00206800
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI8E              00206900
&ZCGPR                SETC  '&XANSLEN'                                  00207000
.*                                                                      00207100
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI8B               00207200
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00207300
                      AGO   .ZI8D                                       00207400
.ZI8B                 ANOP  ,                                           00207500
.*                                                                      00207600
&ZC                   SETC  '&XANSLEN'(1,1)                             00207700
                      AIF   (T'&ZC NE 'N').ZI8D                         00207800
&ZC                   SETC  '&XANSLEN'                                  00207900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00208000
&ZCGPR                SETC  '=FL4''&XANSLEN'''                          00208100
.*                                                                      00208200
.ZI8D                 ANOP  ,                                           00208300
.*                                                                      00208400
&ZOPN                 SETA  &ZOPN+1                                     00208500
&ZOPL(&ZOPN)          SETC  ' '                                         00208600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00208700
&ZOPV(&ZOPN)          SETC  '40(4,1),&ZCGPR'                            00208800
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00208900
.*                                                                      00209000
.ZI8E                 ANOP  ,                                           00209100
.*-------------------------------------------------------------------   00209200
.***AI.L05 XINFOLVL BL1                                                 00209300
&ZW                   SETC  ''                                          00209400
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00209500
.*-------------------------------------------------------------------   00209600
.***AI.L08 XINFOLVL "GROUP"                                             00209700
.***      BL1'1XXXXXXX'                                                 00209800
         AIF   ('&XINFOLVL' NE 'GROUP').ZI10A                           00209900
&ZW                   SETC  '&ZW.1'                                     00210000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00210100
                      AGO   .ZI10C                                      00210200
.*                                                                      00210300
.ZI10A                ANOP  ,                                           00210400
&ZW                   SETC  '&ZW.0'                                     00210500
.ZI10C                ANOP  ,                                           00210600
.*-------------------------------------------------------------------   00210700
.***AI.L08 XINFOLVL "MEMBER"                                            00210800
.***      BL1'X1XXXXXX'                                                 00210900
         AIF   ('&XINFOLVL' NE 'MEMBER').ZI11A                          00211000
&ZW                   SETC  '&ZW.1000000'                               00211100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00211200
                      AGO   .ZI11C                                      00211300
.*                                                                      00211400
.ZI11A                ANOP  ,                                           00211500
&ZW                   SETC  '&ZW.0000000'                               00211600
.ZI11C                ANOP  ,                                           00211700
.*-------------------------------------------------------------------   00211800
.***AI.L11 XINFOLVL BL1                                                 00211900
                      AIF   ('&ZCLNG' NE 'YES').ZI11E  ALL ZERO BITS    00212000
&ZOPN                 SETA  &ZOPN+1                                     00212100
&ZOPL(&ZOPN)          SETC  ' '                                         00212200
&ZOPO(&ZOPN)          SETC  'OI'                                        00212300
&ZOPV(&ZOPN)          SETC  '44(1),B''&ZW'''                            00212400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00212500
.ZI11E                ANOP  ,                                           00212600
.*-------------------------------------------------------------------   00212700
.***AI.L05 XKEYS BL1                                                    00212800
&ZW                   SETC  ''                                          00212900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00213000
.*-------------------------------------------------------------------   00213100
.***AI.L08 XKEYS "REQMBOX"                                              00213200
.***      BL1'1XXXXXXX'                                                 00213300
         AIF   ('&REQMBOX' EQ '').ZI13A                                 00213400
&ZW                   SETC  '&ZW.1'                                     00213500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00213600
                      AGO   .ZI13C                                      00213700
.*                                                                      00213800
.ZI13A                ANOP  ,                                           00213900
&ZW                   SETC  '&ZW.0'                                     00214000
.ZI13C                ANOP  ,                                           00214100
.*-------------------------------------------------------------------   00214200
.***AI.L08 XKEYS "ANSAREA"                                              00214300
.***      BL1'X1XXXXXX'                                                 00214400
         AIF   ('&ANSAREA' EQ '').ZI14A                                 00214500
&ZW                   SETC  '&ZW.1'                                     00214600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00214700
                      AGO   .ZI14C                                      00214800
.*                                                                      00214900
.ZI14A                ANOP  ,                                           00215000
&ZW                   SETC  '&ZW.0'                                     00215100
.ZI14C                ANOP  ,                                           00215200
.*-------------------------------------------------------------------   00215300
.***AI.L08 XKEYS "GROUPTOKEN"                                           00215400
.***      BL1'XX1XXXXX'                                                 00215500
         AIF   ('&GROUPTOKEN' EQ '').ZI15A                              00215600
&ZW                   SETC  '&ZW.1'                                     00215700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00215800
                      AGO   .ZI15C                                      00215900
.*                                                                      00216000
.ZI15A                ANOP  ,                                           00216100
&ZW                   SETC  '&ZW.0'                                     00216200
.ZI15C                ANOP  ,                                           00216300
.*-------------------------------------------------------------------   00216400
.***AI.L08 XKEYS "GROUPNAME"                                            00216500
.***      BL1'XXX1XXXX'                                                 00216600
         AIF   ('&GROUPNAME' EQ '').ZI16A                               00216700
&ZW                   SETC  '&ZW.10000'                                 00216800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00216900
                      AGO   .ZI16C                                      00217000
.*                                                                      00217100
.ZI16A                ANOP  ,                                           00217200
&ZW                   SETC  '&ZW.00000'                                 00217300
.ZI16C                ANOP  ,                                           00217400
.*-------------------------------------------------------------------   00217500
.***AI.L11 XKEYS BL1                                                    00217600
                      AIF   ('&ZCLNG' NE 'YES').ZI16E  ALL ZERO BITS    00217700
&ZOPN                 SETA  &ZOPN+1                                     00217800
&ZOPL(&ZOPN)          SETC  ' '                                         00217900
&ZOPO(&ZOPN)          SETC  'OI'                                        00218000
&ZOPV(&ZOPN)          SETC  '45(1),B''&ZW'''                            00218100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00218200
.ZI16E                ANOP  ,                                           00218300
.*-------------------------------------------------------------------   00218400
.***AI.L05 XSTATE BL1                                                   00218500
&ZW                   SETC  ''                                          00218600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00218700
.*-------------------------------------------------------------------   00218800
.***AI.L08 XSTATE "ANY"                                                 00218900
.***      BL1'1XXXXXXX'                                                 00219000
         AIF   ('&XSTATE' NE 'ANY').ZI18A                               00219100
&ZW                   SETC  '&ZW.1'                                     00219200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00219300
                      AGO   .ZI18C                                      00219400
.*                                                                      00219500
.ZI18A                ANOP  ,                                           00219600
&ZW                   SETC  '&ZW.0'                                     00219700
.ZI18C                ANOP  ,                                           00219800
.*-------------------------------------------------------------------   00219900
.***AI.L08 XSTATE "ACTIVE"                                              00220000
.***      BL1'X1XXXXXX'                                                 00220100
         AIF   ('&XSTATE' NE 'ACTIVE').ZI19A                            00220200
&ZW                   SETC  '&ZW.1000000'                               00220300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00220400
                      AGO   .ZI19C                                      00220500
.*                                                                      00220600
.ZI19A                ANOP  ,                                           00220700
&ZW                   SETC  '&ZW.0000000'                               00220800
.ZI19C                ANOP  ,                                           00220900
.*-------------------------------------------------------------------   00221000
.***AI.L11 XSTATE BL1                                                   00221100
                      AIF   ('&ZCLNG' NE 'YES').ZI19E  ALL ZERO BITS    00221200
&ZOPN                 SETA  &ZOPN+1                                     00221300
&ZOPL(&ZOPN)          SETC  ' '                                         00221400
&ZOPO(&ZOPN)          SETC  'OI'                                        00221500
&ZOPV(&ZOPN)          SETC  '46(1),B''&ZW'''                            00221600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00221700
.ZI19E                ANOP  ,                                           00221800
.*-------------------------------------------------------------------   00221900
.***AI.L05 XSYSTEM BL1                                                  00222000
&ZW                   SETC  ''                                          00222100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00222200
.*-------------------------------------------------------------------   00222300
.***AI.L08 XSYSTEM "ANY"                                                00222400
.***      BL1'1XXXXXXX'                                                 00222500
         AIF   ('&XSYSTEM' NE 'ANY').ZI21A                              00222600
&ZW                   SETC  '&ZW.1'                                     00222700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00222800
                      AGO   .ZI21C                                      00222900
.*                                                                      00223000
.ZI21A                ANOP  ,                                           00223100
&ZW                   SETC  '&ZW.0'                                     00223200
.ZI21C                ANOP  ,                                           00223300
.*-------------------------------------------------------------------   00223400
.***AI.L08 XSYSTEM "CURRENT"                                            00223500
.***      BL1'X1XXXXXX'                                                 00223600
         AIF   ('&XSYSTEM' NE 'CURRENT').ZI22A                          00223700
&ZW                   SETC  '&ZW.1000000'                               00223800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00223900
                      AGO   .ZI22C                                      00224000
.*                                                                      00224100
.ZI22A                ANOP  ,                                           00224200
&ZW                   SETC  '&ZW.0000000'                               00224300
.ZI22C                ANOP  ,                                           00224400
.*-------------------------------------------------------------------   00224500
.***AI.L11 XSYSTEM BL1                                                  00224600
                      AIF   ('&ZCLNG' NE 'YES').ZI22E  ALL ZERO BITS    00224700
&ZOPN                 SETA  &ZOPN+1                                     00224800
&ZOPL(&ZOPN)          SETC  ' '                                         00224900
&ZOPO(&ZOPN)          SETC  'OI'                                        00225000
&ZOPV(&ZOPN)          SETC  '47(1),B''&ZW'''                            00225100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00225200
.ZI22E                ANOP  ,                                           00225300
.*-------------------------------------------------------------------   00225400
.***AI.L05 XPOLYJES BL1                                                 00225500
&ZW                   SETC  ''                                          00225600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00225700
.*-------------------------------------------------------------------   00225800
.***AI.L08 XPOLYJES "YES"                                               00225900
.***      BL1'1XXXXXXX'                                                 00226000
         AIF   ('&XPOLYJES' NE 'YES').ZI24A                             00226100
&ZW                   SETC  '&ZW.1'                                     00226200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00226300
                      AGO   .ZI24C                                      00226400
.*                                                                      00226500
.ZI24A                ANOP  ,                                           00226600
&ZW                   SETC  '&ZW.0'                                     00226700
.ZI24C                ANOP  ,                                           00226800
.*-------------------------------------------------------------------   00226900
.***AI.L08 XPOLYJES "NO"                                                00227000
.***      BL1'X1XXXXXX'                                                 00227100
         AIF   ('&XPOLYJES' NE 'NO').ZI25A                              00227200
&ZW                   SETC  '&ZW.1000000'                               00227300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00227400
                      AGO   .ZI25C                                      00227500
.*                                                                      00227600
.ZI25A                ANOP  ,                                           00227700
&ZW                   SETC  '&ZW.0000000'                               00227800
.ZI25C                ANOP  ,                                           00227900
.*-------------------------------------------------------------------   00228000
.***AI.L11 XPOLYJES BL1                                                 00228100
                      AIF   ('&ZCLNG' NE 'YES').ZI25E  ALL ZERO BITS    00228200
&ZOPN                 SETA  &ZOPN+1                                     00228300
&ZOPL(&ZOPN)          SETC  ' '                                         00228400
&ZOPO(&ZOPN)          SETC  'OI'                                        00228500
&ZOPV(&ZOPN)          SETC  '48(1),B''&ZW'''                            00228600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00228700
.ZI25E                ANOP  ,                                           00228800
.*-------------------------------------------------------------------   00228900
.***AI.L05 XFUNCTION BL2                                                00229000
&ZW                   SETC  ''                                          00229100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00229200
.*-------------------------------------------------------------------   00229300
.***AI.L09 XFUNCTION "ARM"                                              00229400
.***      BL2'1XXXXXXXXXXXXXXX'                                         00229500
&ZI                   SETA  0              RESET ARRAY INDEX            00229600
.ZI27A                ANOP  ,                                           00229700
&ZI                   SETA  &ZI+1          NEXT ARRAY ENTRY             00229800
                      AIF   (K'&XFUNCTION(&ZI) LE 0).ZI27B              00229900
         AIF   ('&XFUNCTION(&ZI)' NE 'ARM').ZI27A                       00230000
&ZW                   SETC  '&ZW.1000000000000000'                      00230100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00230200
                      AGO   .ZI27C                                      00230300
.*                                                                      00230400
.ZI27B                ANOP  ,                                           00230500
&ZW                   SETC  '&ZW.0000000000000000'                      00230600
.ZI27C                ANOP  ,                                           00230700
.*-------------------------------------------------------------------   00230800
.***AI.L10 XFUNCTION BL2                                                00230900
                      AIF   ('&ZCLNG' NE 'YES').ZI27E  ALL ZERO BITS    00231000
&ZOPN                 SETA  &ZOPN+1                                     00231100
&ZOPL(&ZOPN)          SETC  ' '                                         00231200
&ZOPO(&ZOPN)          SETC  'OC'                                        00231300
&ZOPV(&ZOPN)          SETC  '49(2,1),=BL2''&ZW'''                       00231400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00231500
.ZI27E                ANOP  ,                                           00231600
.*-------------------------------------------------------------------   00231700
.***AI.L25  XGROUPNAME CL8                                              00231800
                      AIF   ('&ZXGROUPNAME' EQ '').ZI28E                00231900
                      AIF   ('&ZXGROUPNAME' EQ 'OUTPUT').ZI28E          00232000
&ZCGPR                SETC  '&XGROUPNAME'                               00232100
.*                                                                      00232200
                      AIF   ('&XGROUPNAME'(1,1) NE '(').ZI28B           00232300
&ZCGPR   SETC  '0('.'&XGROUPNAME'(2,K'&XGROUPNAME-2).')'                00232400
.ZI28B                ANOP  ,                                           00232500
.*                                                                      00232600
&ZOPN                 SETA  &ZOPN+1                                     00232700
&ZOPL(&ZOPN)          SETC  ' '                                         00232800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00232900
&ZOPV(&ZOPN)          SETC  '51(8,1),&ZCGPR'                            00233000
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPNAME XGROUPNAME'                00233100
.*                                                                      00233200
.ZI28E                ANOP  ,                                           00233300
.*-------------------------------------------------------------------   00233400
&ZOPN1                SETA &ZOPN                                        00233500
.*******************************************************************    00233600
.***  PROCESS IXZXIXIF OUTPUT PARAMETERS                                00233700
.*******************************************************************    00233800
                      ACTR  10000                                       00233900
.*------------------------------------------------------------------    00234000
.***AO.L02 XREQTOKEN CL8                                                00234100
         AIF   ('&ZXREQTOKEN' EQ 'OUTPUT').ZO6A  OUTPUT                 00234200
         AIF   ('&ZXREQTOKEN' NE 'INOUT').ZO6C  INOUT                   00234300
.ZO6A    AIF   ('&XREQTOKEN'(1,1) NE '(').ZO6B  ADDR IN GPR             00234400
&ZCGPR   SETC  '&XREQTOKEN'(2,K'&XREQTOKEN-2)                           00234500
&ZOPN                 SETA  &ZOPN+1                                     00234600
&ZOPL(&ZOPN)          SETC  ' '                                         00234700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00234800
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),28(1)'                         00234900
&ZOPD(&ZOPN)          SETC  '++ XREQTOKEN CL8'                          00235000
                      AGO   .ZO6C                                       00235100
.*                                                                      00235200
.ZO6B                 ANOP  ,                                           00235300
&ZAWRK   SETA  K'&XREQTOKEN                                             00235400
         AIF   ('&XREQTOKEN'(&ZAWRK,1) NE ')').ZO6G                     00235500
&ZN      SETA  2                                                        00235600
.ZO6H    ANOP                                                           00235700
         AIF   (&ZN GE &ZAWRK).ZO6G                                     00235800
         AIF   ('&XREQTOKEN'(&ZN,1) NE '(').ZO6I                        00235900
&ZC      SETC  '&XREQTOKEN'(1,&ZN).'8'.','                              00236000
&ZC      SETC  '&ZC'.'&XREQTOKEN'(&ZN+1,&ZAWRK-&ZN).',28(1)'            00236100
         AGO   .ZO6J                                                    00236200
.ZO6I    ANOP                                                           00236300
&ZN      SETA  &ZN+1                                                    00236400
         AGO   .ZO6H                                                    00236500
.ZO6G    ANOP                                                           00236600
&ZC      SETC  '&XREQTOKEN.(8),28(1)'                                   00236700
.ZO6J    ANOP                                                           00236800
&ZOPN                 SETA  &ZOPN+1                                     00236900
&ZOPL(&ZOPN)          SETC  ' '                                         00237000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00237100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00237200
&ZOPD(&ZOPN)          SETC  '++ XREQTOKEN CL8'                          00237300
.ZO6C                 ANOP  ,                                           00237400
.*------------------------------------------------------------------    00237500
.***AO.L02 XANSLEN F                                                    00237600
         AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZO8A  OUTPUT                   00237700
         AIF   ('&ZXANSLEN' NE 'INOUT').ZO8C  INOUT                     00237800
.ZO8A    AIF   ('&XANSLEN'(1,1) NE '(').ZO8B  ADDR IN GPR               00237900
&ZCGPR   SETC  '&XANSLEN'(2,K'&XANSLEN-2)                               00238000
&ZOPN                 SETA  &ZOPN+1                                     00238100
&ZOPL(&ZOPN)          SETC  ' '                                         00238200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00238300
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),40(1)'                         00238400
&ZOPD(&ZOPN)          SETC  '++ XANSLEN F'                              00238500
                      AGO   .ZO8C                                       00238600
.*                                                                      00238700
.ZO8B                 ANOP  ,                                           00238800
&ZAWRK   SETA  K'&XANSLEN                                               00238900
         AIF   ('&XANSLEN'(&ZAWRK,1) NE ')').ZO8G                       00239000
&ZN      SETA  2                                                        00239100
.ZO8H    ANOP                                                           00239200
         AIF   (&ZN GE &ZAWRK).ZO8G                                     00239300
         AIF   ('&XANSLEN'(&ZN,1) NE '(').ZO8I                          00239400
&ZC      SETC  '&XANSLEN'(1,&ZN).'4'.','                                00239500
&ZC      SETC  '&ZC'.'&XANSLEN'(&ZN+1,&ZAWRK-&ZN).',40(1)'              00239600
         AGO   .ZO8J                                                    00239700
.ZO8I    ANOP                                                           00239800
&ZN      SETA  &ZN+1                                                    00239900
         AGO   .ZO8H                                                    00240000
.ZO8G    ANOP                                                           00240100
&ZC      SETC  '&XANSLEN.(4),40(1)'                                     00240200
.ZO8J    ANOP                                                           00240300
&ZOPN                 SETA  &ZOPN+1                                     00240400
&ZOPL(&ZOPN)          SETC  ' '                                         00240500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00240600
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00240700
&ZOPD(&ZOPN)          SETC  '++ XANSLEN F'                              00240800
.ZO8C                 ANOP  ,                                           00240900
.*******************************************************************    00241000
.***AO.X01  LABEL TO BYPASS INVOCATION                                  00241100
.*******************************************************************    00241200
&ZOPN                 SETA  &ZOPN+1                                     00241300
&ZOPL(&ZOPN)          SETC  'AMGE&SYSNDX'                               00241400
&ZOPO(&ZOPN)          SETC  'DS'                                        00241500
&ZOPV(&ZOPN)          SETC  '0H'                                        00241600
&ZOPD(&ZOPN)          SETC  '++ BYPASS INVOCATION'                      00241700
.*******************************************************************    00241800
.***AO.X02  RETURN CODE PROCESSING                                      00241900
.*******************************************************************    00242000
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00242100
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00242200
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00242300
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00242400
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00242500
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00242600
&ZOPN                 SETA  &ZOPN+1                                     00242700
&ZOPL(&ZOPN)          SETC  ' '                                         00242800
&ZOPO(&ZOPN)          SETC  'ST'                                        00242900
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00243000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00243100
                      AGO   .ZMRETX                                     00243200
.*                                                                      00243300
.ZMRET2               ANOP  ,                                           00243400
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00243500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00243600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00243700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00243800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00243900
&ZOPN                 SETA  &ZOPN+1                                     00244000
&ZOPL(&ZOPN)          SETC  ' '                                         00244100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00244200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00244300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00244400
.ZMRETX               ANOP  ,                                           00244500
.*******************************************************************    00244600
.***AO.X03  REASON CODE PROCESSING                                      00244700
.*******************************************************************    00244800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00244900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00245000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00245100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00245200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00245300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00245400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00245500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00245600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00245700
&ZOPN                 SETA  &ZOPN+1                                     00245800
&ZOPL(&ZOPN)          SETC  ' '                                         00245900
&ZOPO(&ZOPN)          SETC  'ST'                                        00246000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00246100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00246200
                      AGO   .ZMRSNX                                     00246300
.*                                                                      00246400
.ZMRSN2               ANOP  ,                                           00246500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00246600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00246700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00246800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00246900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00247000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00247100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00247200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00247300
&ZOPN                 SETA  &ZOPN+1                                     00247400
&ZOPL(&ZOPN)          SETC  ' '                                         00247500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00247600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00247700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00247800
.ZMRSNX               ANOP  ,                                           00247900
.*******************************************************************    00248000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00248100
.*******************************************************************    00248200
.ZMFLX                ANOP  ,              MF=L PROCESSING              00248300
.*******************************************************************    00248400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00248500
.*******************************************************************    00248600
                      ACTR  10000                                       00248700
.*                                                                      00248800
                      LCLA  &ZLC           COLUMN POSITION              00248900
                      LCLA  &ZOPX          LIST TABLE INDEX             00249000
                      LCLC  &ZLL           LABEL                        00249100
                      LCLC  &ZLOP          OPERATION                    00249200
                      LCLC  &ZLV           VALUE                        00249300
                      LCLC  &ZLD           DESCRIPTION                  00249400
.*                                                                      00249500
&ZOPX                 SETA  1                                           00249600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00249700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00249800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00249900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00250000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00250100
                      AIF   (K'&ZLD LE 0).ZL5                           00250200
&ZLC                  SETA  35             COMMENT COLUMN               00250300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00250400
&ZLC                  SETA  33             COMMMENT COLUMN              00250500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00250600
&ZLV                  SETC  '&ZLV'.' '                                  00250700
                      AGO   .ZL3                                        00250800
.*                                                                      00250900
.ZL4                  ANOP  ,                                           00251000
&ZLV                  SETC  '&ZLV'.' '                                  00251100
.ZL5                  ANOP  ,                                           00251200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00251300
.*                                                                      00251400
&ZLL     &ZLOP &ZLV                                                     00251500
.*                                                                      00251600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00251700
                      AGO   .ZL2           CONTINUE LOOPING             00251800
.*                                                                      00251900
.ZLX                  ANOP  ,                                           00252000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00252100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00252200
         GBLC  &ANVIRON           JES2 environment variable             00252300
         GBLB  &J3MN              JES3 Main Task environment            00252400
         GBLB  &J3ST              JES3 Subtask environment              00252500
         GBLB  &J3FSS             JES3 FSS environment                  00252600
         GBLB  &J3USR             JES3 User environment                 00252700
         GBLB  &JSXCF             JESXCF environment                    00252800
         AIF   ('&ANVIRON' EQ 'JES2').IXIF050  Are we running under     00252900
.*                                JES2 Main task                        00253000
         AIF   ('&ANVIRON' EQ 'SUBTASK').IXIF050 Are we running under   00253100
.*                                JES2 Subtask                          00253200
         AIF   ('&ANVIRON' EQ 'FSS').IXIF050 Are we running under       00253300
.*                                JES2 Subtask                          00253400
         AIF   ('&ANVIRON' EQ 'USER').IXIF050 Are we running under      00253500
.*                                JES2 Subtask                          00253600
         AIF   (&J3MN).IXIF050    Are we running under JES3 Main task   00253700
         AIF   (&J3ST).IXIF050    Are we running under JES3 Sub task    00253800
         AIF   (&J3FSS).IXIF050   Are we running under JES3 FSS         00253900
         AIF   (&JSXCF).IXIF050   Are we running under JESXCF           00254000
         MNOTE 8,'IXZ0001 Running in an invalid environment'            00254100
.IXIF050 ANOP                                                           00254200
         AIF   ('&GROUPNAME' NE '').IXIF160                             00254300
         AIF   ('&GROUPTOKEN'(1,1) NE '(').IXIF100                      00254400
         LR    14,&GROUPTOKEN     Load the address of the group token   00254500
         L     14,0(14)           Load the group token                  00254600
         AGO   .IXIF150                                                 00254700
.IXIF100 ANOP                                                           00254800
         L     14,&GROUPTOKEN     Load the group token                  00254900
.IXIF150 ANOP                                                           00255000
         L     14,64(14)          Load the PC number of the             00255100
*                                 routine to be called                  00255200
         AGO   .IXIF190                                                 00255300
.IXIF160 ANOP                                                           00255400
         L     14,16(0,0)         Get address of CVT                    00255500
         L     14,140(0,14)       Get address of ECVT                   00255600
         L     14,284(0,14)       Get address of JCCT                   00255700
         L     14,12(0,14)        Get the PC number of the routine to   00255800
*                                  be called                            00255900
.IXIF190 ANOP                                                           00256000
         PC    0(14)              Call the JESXCF Information routine   00256100
         AIF   ('&XMFCTRL'(1,1) NE '(').IXIF200                         00256200
         LR    1,&XMFCTRL         Restore the parameter list address    00256300
         AGO   .IXIF250                                                 00256400
.IXIF200 ANOP                                                           00256500
         LA    1,&XMFCTRL         Restore the parameter list address    00256600
.IXIF250 ANOP                                                           00256700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00256800
.ZLINKX               ANOP  ,                                           00256900
.*******************************************************************    00257000
.***AP.X01  FORMAT GENERATED CODE                                       00257100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00257200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00257300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00257400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00257500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00257600
                      AIF   (K'&ZLD LE 0).ZL51                          00257700
&ZLC                  SETA  35             COMMENT COLUMN               00257800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00257900
&ZLC                  SETA  33             COMMENT COLUMN               00258000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00258100
&ZLV                  SETC  '&ZLV'.' '                                  00258200
                      AGO   .ZL31                                       00258300
.*                                                                      00258400
.ZL41                 ANOP  ,                                           00258500
&ZLV                  SETC  '&ZLV'.' '                                  00258600
.ZL51                 ANOP  ,                                           00258700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00258800
.*                                                                      00258900
&ZLL     &ZLOP &ZLV                                                     00259000
.*                                                                      00259100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00259200
                      AGO   .ZL21          CONTINUE LOOPING             00259300
.*                                                                      00259400
.ZLX1                 ANOP  ,                                           00259500
.*******************************************************************    00259600
.***AP.X02  END OF IXZXIXIF MACRO                                       00259700
&ZIXZXIXIF            SETC  'YES'          SET IXZXIXIF USED            00259800
         POP   PRINT                                                    00259900
*                                            IXZXIXIF-2                 00260000
         SPACE 1                                                        00260100
.ZLX2                 ANOP  ,                                           00260200
         MEND                                                           00260300
**********************************************************************/ 00260400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00260500
*%IXZXIXIF: MACRO KEYS(GROUPTOKEN,GROUPNAME,INFOLVL,STATE,SYSTEM,       00260600
*                 POLYJES,FUNCTION,REQMBOX,REQTOKEN,ANSAREA,ANSLEN,     00260700
*                 RTNCODE,RSNCODE,PLISTVER,MF);                         00260800
*  ANS('?'!!MACLABEL!!' '!!'IXZPIXIF '!!MACLIST!!                       00260900
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00261000
*%END IXZXIXIF;                                                         00261100

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMMCHST                              -12/18/03-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Change State of Work Request                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 (C) COPYRIGHT IBM CORP. 1993, 2002                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7707                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The purpose of this service is to reflect in a monitoring      * 00002100
*      environment what the current state of a work request is with   * 00002200
*      respect to delays.                                             * 00002300
*                                                                     * 00002400
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00002500
*                                                                     * 00002600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002700
*                                                                     * 00002800
*01* ENVIRONMENT:                                                     * 00002900
*                                                                     * 00003000
*                                                                     * 00003100
*      Dispatchable unit mode: Task or SRB mode.                      * 00003200
*                                                                     * 00003300
*      Minimum authorization: Problem or Supervisor state.  PSW key   * 00003400
*                        must either be 0 or match the value supplied * 00003500
*                        on IWMMCREA.                                 * 00003600
*                                                                     * 00003700
*      AMODE:            31-bit.                                      * 00003800
*                                                                     * 00003900
*      ASC mode:         Primary.                                     * 00004000
*                                                                     * 00004100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004200
*                                                                     * 00004300
*      Locks:            Suspend locks are allowed.                   * 00004400
*                                                                     * 00004500
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00004600
*                                                                     * 00004700
*      Control parameters: Control parameters must be in the primary  * 00004800
*                        address space.                               * 00004900
*                                                                     * 00005000
*                                                                     * 00005100
*                                                                     * 00005200
*01* PROGRAMMING REQUIREMENTS:                                        * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*    1.  The macro IWMYCON must be included to use this macro.        * 00005600
*                                                                     * 00005700
*    2.  The macro IWMPB must be in the library concatenation, since  * 00005800
*        it is included by IWMYCON.                                   * 00005900
*                                                                     * 00006000
*    3.  Note that the high order halfword of register 0, and the     * 00006100
*        reason code variable when specified, may be non-zero and     * 00006200
*        represents diagnostic data which is NOT part of the external * 00006300
*        interface.  The high order halfword should thus be excluded  * 00006400
*        from comparison with the reason code values described above. * 00006500
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00006600
*        be used for this purpose.                                    * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*01* RESTRICTIONS:                                                    * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*    1.  This macro may not be used prior to the completion of WLM    * 00007400
*        address space initialization                                 * 00007500
*                                                                     * 00007600
*    2.  Programs which invoke this macro may only execute on MVS/ESA * 00007700
*        (version 5 or higher).                                       * 00007800
*                                                                     * 00007900
*    3.  Caller is responsible for error recovery                     * 00008000
*                                                                     * 00008100
*    4.  Only limited checking is done against the input monitoring   * 00008200
*        token.                                                       * 00008300
*                                                                     * 00008400
*    5.  If the key specified on IWMMCREA was a user key (8-F), then  * 00008500
*        the primary addressability must exist to the performance     * 00008600
*        block IWMMCREA obtained.  This condition is satisfied by     * 00008700
*        ensuring that current primary matches primary at the time    * 00008800
*        that IWMMCREA was invoked.  If this service is invoked in a  * 00008900
*        subspace, the condition may be satisfied by ensuring that    * 00009000
*        the performance block is shared with the base space.         * 00009100
*                                                                     * 00009200
*    6.  The caller must serialize to prevent any delay monitoring    * 00009300
*        services from being invoked concurrently for the environment * 00009400
*        represented by the monitoring token.                         * 00009500
*                                                                     * 00009600
*    7.  This macro may only be used on z/OS R2 or higher levels for  * 00009700
*        the following state/resources                                * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*        o   STATE(ACTIVE_APPL)                                       * 00010100
*                                                                     * 00010200
*        o   RESOURCE(SSL_THREAD)                                     * 00010300
*                                                                     * 00010400
*        o   RESOURCE(REG_THREAD)                                     * 00010500
*                                                                     * 00010600
*        o   RESOURCE(REG_TO_WRKTB)                                   * 00010700
*                                                                     * 00010800
*        o   RESOURCE(TYPE1)                                          * 00010900
*                                                                     * 00011000
*        o   RESOURCE(TYPE2)                                          * 00011100
*                                                                     * 00011200
*        o   RESOURCE(TYPE3)                                          * 00011300
*                                                                     * 00011400
*        o   RESOURCE(TYPE4)                                          * 00011500
*                                                                     * 00011600
*        o   RESOURCE(TYPE5)                                          * 00011700
*                                                                     * 00011800
*                                                                     * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*01* INPUT REGISTER INFORMATION:                                      * 00012300
*                                                                     * 00012400
*    Before issuing the IWMMCHST macro, the caller does not have to   * 00012500
*    place any information into any register unless using it in       * 00012600
*    register notation for a particular parameter, or using it as a   * 00012700
*    base register.                                                   * 00012800
*                                                                     * 00012900
*01* OUTPUT REGISTER INFORMATION:                                     * 00013000
*                                                                     * 00013100
*    When control returns to the caller, the GPRs contain:            * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*    REGISTER  CONTENTS                                               * 00013500
*                                                                     * 00013600
*    0         Reason code if GR15 return code is non-zero            * 00013700
*                                                                     * 00013800
*    1         Used as work registers by the system                   * 00013900
*                                                                     * 00014000
*    2-13      Unchanged                                              * 00014100
*                                                                     * 00014200
*    14        Used as work registers by the system                   * 00014300
*                                                                     * 00014400
*    15        Return code                                            * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*    When control returns to the caller, the ARs contain:             * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*    REGISTER  CONTENTS                                               * 00015200
*                                                                     * 00015300
*    0-1       Used as work registers by the system                   * 00015400
*                                                                     * 00015500
*    2-13      Unchanged                                              * 00015600
*                                                                     * 00015700
*    14-15     Used as work registers by the system                   * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*                                                                     * 00016100
*    Some callers depend on register contents remaining the same      * 00016200
*    before and after issuing a service.  If the system changes the   * 00016300
*    contents of registers on which the caller depends, the caller    * 00016400
*    must save them before issuing the service, and restore them      * 00016500
*    after the system returns control.                                * 00016600
*                                                                     * 00016700
*01* PERFORMANCE IMPLICATIONS:                                        * 00016800
*                                                                     * 00016900
*    None                                                             * 00017000
*                                                                     * 00017100
*01* SYNTAX:                                                          * 00017200
*                                                                     * 00017300
*Ýxlabel¨  IWMMCHST  Ð  STATE=FREE                                    * 00017400
*                    Ô ,STATE=ACTIVE                                  * 00017500
*                    Ô ,STATE=ACTIVE_APPL                             * 00017600
*                    Ô ,STATE=READY                                   * 00017700
*                    Ô ,STATE=IDLE                                    * 00017800
*                    ¿ ,STATE=WAITING                                 * 00017900
*                        Ð ,RESOURCE=LATCH                            * 00018000
*                        Ô ,RESOURCE=LOCK                             * 00018100
*                        Ô ,RESOURCE=IO                               * 00018200
*                        Ô ,RESOURCE=CONV                             * 00018300
*                        Ô ,RESOURCE=DISTRIB                          * 00018400
*                        Ô ,RESOURCE=SESS_LOCALMVS                    * 00018500
*                        Ô ,RESOURCE=SESS_NETWORK                     * 00018600
*                        Ô ,RESOURCE=SESS_SYSPLEX                     * 00018700
*                        Ô ,RESOURCE=TIMER                            * 00018800
*                        Ô ,RESOURCE=OTHER_PRODUCT                    * 00018900
*                        Ô ,RESOURCE=MISC                             * 00019000
*                        Ô ,RESOURCE=SSL_THREAD                       * 00019100
*                        Ô ,RESOURCE=REG_THREAD                       * 00019200
*                        Ô ,RESOURCE=REG_TO_WRKTB                     * 00019300
*                        Ô ,RESOURCE=TYPE1                            * 00019400
*                        Ô ,RESOURCE=TYPE2                            * 00019500
*                        Ô ,RESOURCE=TYPE3                            * 00019600
*                        Ô ,RESOURCE=TYPE4                            * 00019700
*                        ¿ ,RESOURCE=TYPE5                            * 00019800
*                      ,MONTKN=xmontkn                                * 00019900
*                    ÐÝ,RUNTIME_VER=SHORT_FORM¨                       * 00020000
*                    ¿Ý,RUNTIME_VER=MINIMAL¨                          * 00020100
*                    ÐÝ,COMPCODE=YES¨                                 * 00020200
*                    ¿Ý,COMPCODE=NO¨                                  * 00020300
*                     Ý,RETCODE=xretcode¨                             * 00020400
*                     Ý,RSNCODE=xrsncode¨                             * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*      Where:                                                         * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*      Ýxlabel¨                                                       * 00021100
*          is an optional symbol, starting in column 1, that is the   * 00021200
*          name on the IWMMCHST macro invocation.  The name must      * 00021300
*          conform to the rules for an ordinary assembler language    * 00021400
*          symbol.                                                    * 00021500
*          DEFAULT: No name.                                          * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*      STATE=»FREE!ACTIVE!ACTIVE_APPL!READY!IDLE!WAITINGº             * 00022100
*          is a required keyword input which indicates the current    * 00022200
*          state for the work request.                                * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*          STATE=FREE                                                 * 00022600
*              indicates that the work manager has no work request    * 00022700
*              associated with the monitoring environment.            * 00022800
*                                                                     * 00022900
*          STATE=ACTIVE                                               * 00023000
*              indicates that there is a program executing on behalf  * 00023100
*              of the work request described by the monitoring        * 00023200
*              environment.  This is an indication from the           * 00023300
*              perspective of the work manager using this service,    * 00023400
*              who should not try to factor in MVS decisions in       * 00023500
*              preempting work, etc.                                  * 00023600
*                                                                     * 00023700
*          STATE=ACTIVE_APPL                                          * 00023800
*              indicates that there is a application program          * 00023900
*              executing on behalf of the work request described by   * 00024000
*              the monitoring environment.  This is an indication     * 00024100
*              from the perspective of the work manager using this    * 00024200
*              service, who should not try to factor in MVS decisions * 00024300
*              in preempting work, etc.  This state represents the    * 00024400
*              application activity in contrast to the active         * 00024500
*              (subsystem) state.                                     * 00024600
*                                                                     * 00024700
*          STATE=READY                                                * 00024800
*              indicates that there is a program ready to execute on  * 00024900
*              behalf of the work request described by the monitoring * 00025000
*              environment, but the work manager has given priority   * 00025100
*              to another work request.                               * 00025200
*                                                                     * 00025300
*          STATE=IDLE                                                 * 00025400
*              indicates that the work manager has no work requests   * 00025500
*              that it is allowed to service within the monitoring    * 00025600
*              environment.  This represents a delay that is not      * 00025700
*              under the control of the work manager itself and which * 00025800
*              it cannot eliminate.  This may be caused by limits     * 00025900
*              imposed by the installation or by the nature of the    * 00026000
*              work request itself.                                   * 00026100
*                                                                     * 00026200
*          STATE=WAITING                                              * 00026300
*              indicates that the work manager is waiting for a       * 00026400
*              resource on behalf of the work request described by    * 00026500
*              the the monitoring environment.                        * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*              RESOURCE=»LATCH!LOCK!IO!CONV!DISTRIB!SESS_LOCALMVS!SES * 00026900
*                  S_NETWORK!SESS_SYSPLEX!TIMER!OTHER_PRODUCT!MISC!SS * 00027000
*                  L_THREAD!REG_THREAD!REG_TO_WRKTB!TYPE1!TYPE2!TYPE3 * 00027100
*                  !TYPE4!TYPE5º                                      * 00027200
*                  is a required keyword input which indicates the    * 00027300
*                  resource that the work manager is waiting for on   * 00027400
*                  behalf of the work request described by the        * 00027500
*                  monitoring environment.                            * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*                  RESOURCE=LATCH                                     * 00027900
*                      indicates that the work manager is waiting on  * 00028000
*                      a latch.                                       * 00028100
*                                                                     * 00028200
*                  RESOURCE=LOCK                                      * 00028300
*                      indicates that the work manager is waiting on  * 00028400
*                      a lock.                                        * 00028500
*                                                                     * 00028600
*                  RESOURCE=IO                                        * 00028700
*                      indicates that the work manager is waiting on  * 00028800
*                      an activity related to an I/O request. This    * 00028900
*                      may either be an actual I/O operation or some  * 00029000
*                      function associated with an IO request that    * 00029100
*                      cannot be more precisely determined by the     * 00029200
*                      work manager (e.g. locks, buffers, etc.).      * 00029300
*                                                                     * 00029400
*                  RESOURCE=CONV                                      * 00029500
*                      indicates that the work manager is waiting on  * 00029600
*                      a conversation.  This may be used in           * 00029700
*                      conjunction with IWMMSWCH to identify where    * 00029800
*                      the target is located.                         * 00029900
*                                                                     * 00030000
*                  RESOURCE=DISTRIB                                   * 00030100
*                      indicates that the work manager is waiting on  * 00030200
*                      a distributed request.  This says at a high    * 00030300
*                      level that some function or data must be       * 00030400
*                      routed prior to resumption of the work         * 00030500
*                      request.  This is to be contrasted with        * 00030600
*                      Waiting on Conversation, which is a low level  * 00030700
*                      view of the precise resource that is needed. A * 00030800
*                      distributed request could involve waiting on a * 00030900
*                      conversation as part of its processing.        * 00031000
*                                                                     * 00031100
*                  RESOURCE=SESS_LOCALMVS                             * 00031200
*                      indicates that the work manager is waiting to  * 00031300
*                      establish a session somewhere in the current   * 00031400
*                      MVS image.                                     * 00031500
*                                                                     * 00031600
*                  RESOURCE=SESS_NETWORK                              * 00031700
*                      indicates that the work manager is waiting to  * 00031800
*                      establish a session somewhere in the network.  * 00031900
*                                                                     * 00032000
*                  RESOURCE=SESS_SYSPLEX                              * 00032100
*                      indicates that the work manager is waiting to  * 00032200
*                      establish a session somewhere in the sysplex.  * 00032300
*                                                                     * 00032400
*                  RESOURCE=TIMER                                     * 00032500
*                      indicates that the work request is waiting on  * 00032600
*                      a timer.                                       * 00032700
*                                                                     * 00032800
*                  RESOURCE=OTHER_PRODUCT                             * 00032900
*                      indicates that the work manager is waiting on  * 00033000
*                      another product to complete its function.      * 00033100
*                                                                     * 00033200
*                  RESOURCE=MISC                                      * 00033300
*                      indicates that the work manager is waiting on  * 00033400
*                      some unidentified resource, possibly among the * 00033500
*                      previous categories.                           * 00033600
*                                                                     * 00033700
*                  RESOURCE=SSL_THREAD                                * 00033800
*                      indicates that the work manager is waiting on  * 00033900
*                      a SSL thread.                                  * 00034000
*                                                                     * 00034100
*                  RESOURCE=REG_THREAD                                * 00034200
*                      indicates that the work manager is waiting on  * 00034300
*                      a regular processing thread.                   * 00034400
*                                                                     * 00034500
*                  RESOURCE=REG_TO_WRKTB                              * 00034600
*                      indicates that the work manager is waiting for * 00034700
*                      the registration to a worktable.               * 00034800
*                                                                     * 00034900
*                  RESOURCE=TYPE1                                     * 00035000
*                      indicates that the work manager is waiting for * 00035100
*                      resource type 1.                               * 00035200
*                                                                     * 00035300
*                  RESOURCE=TYPE2                                     * 00035400
*                      indicates that the work manager is waiting for * 00035500
*                      resource type 2.                               * 00035600
*                                                                     * 00035700
*                  RESOURCE=TYPE3                                     * 00035800
*                      indicates that the work manager is waiting for * 00035900
*                      resource type 3.                               * 00036000
*                                                                     * 00036100
*                  RESOURCE=TYPE4                                     * 00036200
*                      indicates that the work manager is waiting for * 00036300
*                      resource type 4.                               * 00036400
*                                                                     * 00036500
*                  RESOURCE=TYPE5                                     * 00036600
*                      indicates that the work manager is waiting for * 00036700
*                      resource type 5.                               * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*                                                                     * 00037500
*                                                                     * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*      MONTKN=xmontkn                                                 * 00037900
*          is the name (RS-type), or address in register (2)-(12), of * 00038000
*          a required 32 bit input which contains the delay           * 00038100
*          monitoring token                                           * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*      ÝRUNTIME_VER=»SHORT_FORM!MINIMALº¨                             * 00038700
*          is an optional keyword input which indicates what level of * 00038800
*          runtime verification will be performed.                    * 00038900
*          DEFAULT: SHORT_FORM                                        * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*          ÝRUNTIME_VER=SHORT_FORM¨                                   * 00039300
*              indicates that checking should verify that a           * 00039400
*              monitoring environment is established and passes a     * 00039500
*              short form of verification prior to being used.        * 00039600
*                                                                     * 00039700
*          ÝRUNTIME_VER=MINIMAL¨                                      * 00039800
*              indicates that checking will only be done to verify    * 00039900
*              that a monitoring environment may be established,      * 00040000
*              assuming that it would be valid and useable if         * 00040100
*              established.                                           * 00040200
*              DEFAULT: SHORT_FORM indicates that short form checking * 00040300
*              is desired.                                            * 00040400
*                                                                     * 00040500
*                                                                     * 00040600
*                                                                     * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*      ÝCOMPCODE=»YES!NOº¨                                            * 00041100
*          is an optional keyword input which indicates whether       * 00041200
*          completion status for this service is needed.              * 00041300
*          DEFAULT: YES                                               * 00041400
*                                                                     * 00041500
*                                                                     * 00041600
*          ÝCOMPCODE=YES¨                                             * 00041700
*              indicates that completion status is needed.            * 00041800
*                                                                     * 00041900
*          ÝCOMPCODE=NO¨                                              * 00042000
*              indicates that completion status is not needed.        * 00042100
*              Registers 0, 15 cannot be used as reason code and      * 00042200
*              return code registers upon completion of the macro     * 00042300
*              expansion. For this reason neither RETCODE NOR RSNCODE * 00042400
*              may be specified when COMPCODE(NO) is specified.       * 00042500
*              DEFAULT: YES indicates that completion status is       * 00042600
*              needed.                                                * 00042700
*                                                                     * 00042800
*                                                                     * 00042900
*                                                                     * 00043000
*                                                                     * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*      ÝRETCODE=xretcode¨                                             * 00043400
*          is the name (RS-type) of an optional fullword output       * 00043500
*          variable, or register (2)-(12), into which the return code * 00043600
*          is to be copied from GPR 15.                               * 00043700
*                                                                     * 00043800
*                                                                     * 00043900
*                                                                     * 00044000
*                                                                     * 00044100
*      ÝRSNCODE=xrsncode¨                                             * 00044200
*          is the name (RS-type) of an optional fullword output       * 00044300
*          variable, or register (2)-(12), into which the reason code * 00044400
*          is to be copied from GPR 0.                                * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*01* ABEND CODES:  None.                                              * 00044900
*                                                                     * 00045000
*01* RETURN CODES:                                                    * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*            0    Name: IwmRetCodeOk                                  * 00045400
*                                                                     * 00045500
*                 Meaning: Successful completion.                     * 00045600
*                                                                     * 00045700
*                 Action: None required.                              * 00045800
*                                                                     * 00045900
*            4    Name: IwmRetCodeWarning                             * 00046000
*                                                                     * 00046100
*                 Meaning: Successful completion, unusual conditions  * 00046200
*                 noted.                                              * 00046300
*                                                                     * 00046400
*                                                                     * 00046500
*                 HEX REASON  MEANING/ACTION                          * 00046600
*                 CODE                                                * 00046700
*                                                                     * 00046800
*                 xxxx0402    Name: IwmRsnCodeNoMonEnv                * 00046900
*                                                                     * 00047000
*                             Meaning:  Input monitoring token        * 00047100
*                             indicates no monitoring environment was * 00047200
*                             established.                            * 00047300
*                                                                     * 00047400
*                             Action: None required.                  * 00047500
*                                                                     * 00047600
*                                                                     * 00047700
*                                                                     * 00047800
*            8    Name: IwmRetCodeInvocError                          * 00047900
*                                                                     * 00048000
*                 Meaning: Invalid invocation environment or          * 00048100
*                 parameters.                                         * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                 HEX REASON  MEANING/ACTION                          * 00048500
*                 CODE                                                * 00048600
*                                                                     * 00048700
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00048800
*                                                                     * 00048900
*                             Meaning:  Monitoring environment does   * 00049000
*                             not pass short form verification.       * 00049100
*                                                                     * 00049200
*                             Action: Check for possible storage      * 00049300
*                             overlay.                                * 00049400
*                                                                     * 00049500
*                                                                     * 00049600
*                                                                     * 00049700
*                                                                     * 00049800
*                                                                     * 00049900
*01* REASON CODES:                                                    * 00050000
*                                                                     * 00050100
*       A unique reason code will be returned whenever the return     * 00050200
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00050300
*       under their corresponding return code.  Reason code and       * 00050400
*       return code constants are defined within IWMYCON.  Note that  * 00050500
*       the high order halfword of register 0, and the reason code    * 00050600
*       variable when specified, may be non-zero and represents       * 00050700
*       diagnostic data which is NOT part of the external interface.  * 00050800
*       The high order halfword should thus be excluded from          * 00050900
*       comparison with the reason code values described above.  The  * 00051000
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00051100
*       used for this purpose.                                        * 00051200
*                                                                     * 00051300
*01* MODULE TYPE:  ASSEM MACRO                                        * 00051400
*                                                                     * 00051500
*02*   PROCESSOR:  ASSEM                                              * 00051600
*                                                                     * 00051700
*01* COMPONENT:  SCWLM                                                * 00051800
*                                                                     * 00051900
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00052000
*                                                                     * 00052100
*01* EXAMPLES:                                                        * 00052200
*                                                                     * 00052300
*01* MACRO USAGE NOTES:                                               * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00052700
*        global macro variable.  Any value other than 'NO' will       * 00052800
*        result in the macro expansion being printed.  The default is * 00052900
*        'YES'.  The following examples illustrate how the ZPRINT     * 00053000
*        variable should be set.                                      * 00053100
*                                                                     * 00053200
*                    GBLC &ZPRINT                                     * 00053300
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*01* CHANGE ACTIVITY:                                                 * 00053800
*                                                                     * 00053900
*   Flag LineItem  FMID    Date   ID    Comment                       * 00054000
*                                                                     * 00054100
*    $L0=WLMI     HBB5510 920309 PD16:  Workload Manager I            * 00054200
*    $P1=PIG7010  HBB5510 921029 PD16:  Remove check for RSNCODE for  * 00054300
*                                         GPR00F declare              * 00054400
*    $L1=WLMP     HBB6603 950213 PD16:  Dynamic Buffer Pool           * 00054500
*                                         Management                  * 00054600
*    $L2=WLMPAPC  HBB7705 001010 3241PB:  New PB states for CB        * 00054700
*    $L3=WLMPPBS  HBB7707 011111 3241AB:  Armin Buechler              * 00054800
*                                         New PB states for WAS       * 00054900
*    $L4=OW54806  HBB7707 020606 3241AB:  Armin Buechler              * 00055000
*                                         Fix too long state names    * 00055100
****** END OF SPECIFICATIONS *****************************************/ 00055200
*/* TLINE 1 *********************************************************** 00055300
         MACRO                                                          00055400
&XLABEL  IWMMCHST &STATE=,&RESOURCE=,&MONTKN=,&RUNTIME_VER=,&COMPCODE=,*00055500
               &RETCODE=,&RSNCODE=                                      00055600
.*                                                                      00055700
*                   MACDATE -12/18/03-<0>                               00055800
.*                                                                      00055900
.*******************************************************************    00056000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00056100
.*******************************************************************    00056200
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00056300
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00056400
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00056500
.*                                                                      00056600
                   GBLC  &ZIWMMCHST  YES=MACRO USED AT LEAST ONCE       00056700
.*******************************************************************    00056800
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00056900
.*******************************************************************    00057000
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00057100
                   LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS       00057200
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00057300
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00057400
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00057500
                   LCLA  &ZAWRK      USED AS A WORK AREA                00057600
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00057700
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00057800
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00057900
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00058000
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00058100
                   LCLC  &ZMAC_G     "G" or null                        00058200
&ZMAC_G            SETC  ''                                             00058300
                   LCLC  &ZMAC_LR                                       00058400
&ZMAC_LR           SETC  'LR'                                           00058500
                   LCLC  &ZMAC_L                                        00058600
&ZMAC_L            SETC  'L'                                            00058700
                   LCLC  &ZMAC_ST                                       00058800
&ZMAC_ST           SETC  'ST'                                           00058900
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00059000
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00059100
.*                                                                      00059200
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00059300
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00059400
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00059500
                   LCLC  &ZENDBASEPL            End of base PL          00059600
.*******************************************************************    00059700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00059800
.*******************************************************************    00059900
                   LCLC  &XSTATE     ++ VALUE                           00060000
                   LCLC  &XRESOURCE  ++ VALUE                           00060100
                   LCLC  &XMONTKN    ++ NAME                            00060200
                   LCLC  &XRUNTIME_VER          ++ VALUE                00060300
                   LCLC  &XCOMPCODE  ++ VALUE                           00060400
                   LCLC  &XRETCODE   ++ NAME                            00060500
                   LCLC  &XRSNCODE   ++ NAME                            00060600
.*******************************************************************    00060700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00060800
.*******************************************************************    00060900
                   LCLC  &ZXSTATE    ++ INPUT VALUE                     00061000
                   LCLC  &ZXRESOURCE            ++ INPUT VALUE          00061100
                   LCLC  &ZXMONTKN   ++ INPUT NAME                      00061200
                   LCLC  &ZXRUNTIME_VER         ++ INPUT VALUE          00061300
                   LCLC  &ZXCOMPCODE            ++ INPUT VALUE          00061400
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00061500
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00061600
.********************************************************************   00061700
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00061800
.********************************************************************   00061900
                   ACTR  10000                                          00062000
.*------------------------------------------------------------------    00062100
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00062200
&XSTATE            SETC  ''          INITIALIZE XVARIABLE               00062300
.*-------------------------------------------------------------------   00062400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00062500
.ZG3               ANOP  ,                                              00062600
                   AIF   (K'&STATE(1) LE 0).ZG3A                        00062700
&ZTLC              SETC 'FREE'                                          00062800
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG4                   00062900
&XSTATE            SETC  'FREE'      SET KEYWORD                        00063000
                   AIF   (N'&STATE LE 1).ZG3A   CK NUM                  00063100
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00063200
&ZMS               SETC  '&ZMS.&STATE"'                                 00063300
&ZMS               SETC  '&ZMS "STATE"'                                 00063400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00063500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00063600
.ZG3A              ANOP  ,                                              00063700
.*------------------------------------------------------------------    00063800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00063900
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00064000
.ZG3A0             AIF   (K'&RESOURCE LE 0).ZG3A1  OK                   00064100
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00064200
.ZG3A1             AIF   (K'&ZCVAL LE 0).ZG3A2  OK                      00064300
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00064400
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00064500
&ZMS               SETC  '&ZMS.=&STATE"'                                00064600
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00064700
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00064800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00064900
.ZG3A2             ANOP  ,                                              00065000
.*-------------------------------------------------------------------   00065100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00065200
.ZG4               ANOP  ,                                              00065300
&ZTLC              SETC 'ACTIVE'                                        00065400
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG5                   00065500
&XSTATE            SETC  'ACTIVE'    SET KEYWORD                        00065600
                   AIF   (N'&STATE LE 1).ZG4A   CK NUM                  00065700
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00065800
&ZMS               SETC  '&ZMS.&STATE"'                                 00065900
&ZMS               SETC  '&ZMS "STATE"'                                 00066000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00066100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00066200
.ZG4A              ANOP  ,                                              00066300
.*------------------------------------------------------------------    00066400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00066500
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00066600
.ZG4A0             AIF   (K'&RESOURCE LE 0).ZG4A1  OK                   00066700
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00066800
.ZG4A1             AIF   (K'&ZCVAL LE 0).ZG4A2  OK                      00066900
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00067000
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00067100
&ZMS               SETC  '&ZMS.=&STATE"'                                00067200
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00067300
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00067400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00067500
.ZG4A2             ANOP  ,                                              00067600
.*-------------------------------------------------------------------   00067700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067800
.ZG5               ANOP  ,                                              00067900
&ZTLC              SETC 'ACTIVE_APPL'                                   00068000
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG6                   00068100
&XSTATE            SETC  'ACTIVE_APPL'          SET KEYWORD             00068200
                   AIF   (N'&STATE LE 1).ZG5A   CK NUM                  00068300
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00068400
&ZMS               SETC  '&ZMS.&STATE"'                                 00068500
&ZMS               SETC  '&ZMS "STATE"'                                 00068600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00068700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00068800
.ZG5A              ANOP  ,                                              00068900
.*------------------------------------------------------------------    00069000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00069100
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00069200
.ZG5A0             AIF   (K'&RESOURCE LE 0).ZG5A1  OK                   00069300
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00069400
.ZG5A1             AIF   (K'&ZCVAL LE 0).ZG5A2  OK                      00069500
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00069600
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00069700
&ZMS               SETC  '&ZMS.=&STATE"'                                00069800
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00069900
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00070000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00070100
.ZG5A2             ANOP  ,                                              00070200
.*-------------------------------------------------------------------   00070300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00070400
.ZG6               ANOP  ,                                              00070500
&ZTLC              SETC 'READY'                                         00070600
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG7                   00070700
&XSTATE            SETC  'READY'     SET KEYWORD                        00070800
                   AIF   (N'&STATE LE 1).ZG6A   CK NUM                  00070900
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00071000
&ZMS               SETC  '&ZMS.&STATE"'                                 00071100
&ZMS               SETC  '&ZMS "STATE"'                                 00071200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00071300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00071400
.ZG6A              ANOP  ,                                              00071500
.*------------------------------------------------------------------    00071600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00071700
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00071800
.ZG6A0             AIF   (K'&RESOURCE LE 0).ZG6A1  OK                   00071900
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00072000
.ZG6A1             AIF   (K'&ZCVAL LE 0).ZG6A2  OK                      00072100
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00072200
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00072300
&ZMS               SETC  '&ZMS.=&STATE"'                                00072400
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00072500
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00072600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00072700
.ZG6A2             ANOP  ,                                              00072800
.*-------------------------------------------------------------------   00072900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00073000
.ZG7               ANOP  ,                                              00073100
&ZTLC              SETC 'IDLE'                                          00073200
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG8                   00073300
&XSTATE            SETC  'IDLE'      SET KEYWORD                        00073400
                   AIF   (N'&STATE LE 1).ZG7A   CK NUM                  00073500
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00073600
&ZMS               SETC  '&ZMS.&STATE"'                                 00073700
&ZMS               SETC  '&ZMS "STATE"'                                 00073800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00073900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00074000
.ZG7A              ANOP  ,                                              00074100
.*------------------------------------------------------------------    00074200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00074300
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00074400
.ZG7A0             AIF   (K'&RESOURCE LE 0).ZG7A1  OK                   00074500
&ZCVAL             SETC '&ZCVAL RESOURCE'       INCORRECT KEY USED      00074600
.ZG7A1             AIF   (K'&ZCVAL LE 0).ZG7A2  OK                      00074700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00074800
&ZMS               SETC  '"STATE'    *KMEIA* MNOTE                      00074900
&ZMS               SETC  '&ZMS.=&STATE"'                                00075000
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00075100
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00075200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00075300
.ZG7A2             ANOP  ,                                              00075400
.*-------------------------------------------------------------------   00075500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075600
.ZG8               ANOP  ,                                              00075700
&ZTLC              SETC 'WAITING'                                       00075800
                   AIF   ('&STATE(1)' NE '&ZTLC').ZG31                  00075900
&XSTATE            SETC  'WAITING'   SET KEYWORD                        00076000
                   AIF   (N'&STATE LE 1).ZG8A   CK NUM                  00076100
&ZMS               SETC  '"STATE='   *KPOSA* MNOTE                      00076200
&ZMS               SETC  '&ZMS.&STATE"'                                 00076300
&ZMS               SETC  '&ZMS "STATE"'                                 00076400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00076500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00076600
.ZG8A              ANOP  ,                                              00076700
.*------------------------------------------------------------------    00076800
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076900
&XRESOURCE         SETC  ''          INITIALIZE XVARIABLE               00077000
.*-------------------------------------------------------------------   00077100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00077200
.ZG11              ANOP  ,                                              00077300
                   AIF   (K'&RESOURCE(1) LE 0).ZG11A                    00077400
&ZTLC              SETC 'LATCH'                                         00077500
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG12               00077600
&XRESOURCE         SETC  'LATCH'     SET KEYWORD                        00077700
                   AIF   (N'&RESOURCE LE 1).ZG11A  CK NUM               00077800
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00077900
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00078000
&ZMS               SETC  '&ZMS "RESOURCE"'                              00078100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00078200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00078300
.ZG11A             ANOP  ,                                              00078400
.*-------------------------------------------------------------------   00078500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00078600
.ZG12              ANOP  ,                                              00078700
&ZTLC              SETC 'LOCK'                                          00078800
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG13               00078900
&XRESOURCE         SETC  'LOCK'      SET KEYWORD                        00079000
                   AIF   (N'&RESOURCE LE 1).ZG12A  CK NUM               00079100
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00079200
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00079300
&ZMS               SETC  '&ZMS "RESOURCE"'                              00079400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00079500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00079600
.ZG12A             ANOP  ,                                              00079700
.*-------------------------------------------------------------------   00079800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00079900
.ZG13              ANOP  ,                                              00080000
&ZTLC              SETC 'IO'                                            00080100
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG14               00080200
&XRESOURCE         SETC  'IO'        SET KEYWORD                        00080300
                   AIF   (N'&RESOURCE LE 1).ZG13A  CK NUM               00080400
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00080500
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00080600
&ZMS               SETC  '&ZMS "RESOURCE"'                              00080700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00080800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00080900
.ZG13A             ANOP  ,                                              00081000
.*-------------------------------------------------------------------   00081100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00081200
.ZG14              ANOP  ,                                              00081300
&ZTLC              SETC 'CONV'                                          00081400
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG15               00081500
&XRESOURCE         SETC  'CONV'      SET KEYWORD                        00081600
                   AIF   (N'&RESOURCE LE 1).ZG14A  CK NUM               00081700
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00081800
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00081900
&ZMS               SETC  '&ZMS "RESOURCE"'                              00082000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00082100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00082200
.ZG14A             ANOP  ,                                              00082300
.*-------------------------------------------------------------------   00082400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00082500
.ZG15              ANOP  ,                                              00082600
&ZTLC              SETC 'DISTRIB'                                       00082700
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG16               00082800
&XRESOURCE         SETC  'DISTRIB'   SET KEYWORD                        00082900
                   AIF   (N'&RESOURCE LE 1).ZG15A  CK NUM               00083000
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00083100
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00083200
&ZMS               SETC  '&ZMS "RESOURCE"'                              00083300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00083400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00083500
.ZG15A             ANOP  ,                                              00083600
.*-------------------------------------------------------------------   00083700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00083800
.ZG16              ANOP  ,                                              00083900
&ZTLC              SETC 'SESS_LOCALMVS'                                 00084000
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG17               00084100
&XRESOURCE         SETC  'SESS_LOCALMVS'        SET KEYWORD             00084200
                   AIF   (N'&RESOURCE LE 1).ZG16A  CK NUM               00084300
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00084400
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00084500
&ZMS               SETC  '&ZMS "RESOURCE"'                              00084600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00084700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00084800
.ZG16A             ANOP  ,                                              00084900
.*-------------------------------------------------------------------   00085000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00085100
.ZG17              ANOP  ,                                              00085200
&ZTLC              SETC 'SESS_NETWORK'                                  00085300
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG18               00085400
&XRESOURCE         SETC  'SESS_NETWORK'         SET KEYWORD             00085500
                   AIF   (N'&RESOURCE LE 1).ZG17A  CK NUM               00085600
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00085700
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00085800
&ZMS               SETC  '&ZMS "RESOURCE"'                              00085900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00086000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00086100
.ZG17A             ANOP  ,                                              00086200
.*-------------------------------------------------------------------   00086300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00086400
.ZG18              ANOP  ,                                              00086500
&ZTLC              SETC 'SESS_SYSPLEX'                                  00086600
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG19               00086700
&XRESOURCE         SETC  'SESS_SYSPLEX'         SET KEYWORD             00086800
                   AIF   (N'&RESOURCE LE 1).ZG18A  CK NUM               00086900
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00087000
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00087100
&ZMS               SETC  '&ZMS "RESOURCE"'                              00087200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00087300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00087400
.ZG18A             ANOP  ,                                              00087500
.*-------------------------------------------------------------------   00087600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087700
.ZG19              ANOP  ,                                              00087800
&ZTLC              SETC 'TIMER'                                         00087900
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG20               00088000
&XRESOURCE         SETC  'TIMER'     SET KEYWORD                        00088100
                   AIF   (N'&RESOURCE LE 1).ZG19A  CK NUM               00088200
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00088300
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00088400
&ZMS               SETC  '&ZMS "RESOURCE"'                              00088500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00088600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00088700
.ZG19A             ANOP  ,                                              00088800
.*-------------------------------------------------------------------   00088900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089000
.ZG20              ANOP  ,                                              00089100
&ZTLC              SETC 'OTHER_PRODUCT'                                 00089200
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG21               00089300
&XRESOURCE         SETC  'OTHER_PRODUCT'        SET KEYWORD             00089400
                   AIF   (N'&RESOURCE LE 1).ZG20A  CK NUM               00089500
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00089600
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00089700
&ZMS               SETC  '&ZMS "RESOURCE"'                              00089800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00089900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00090000
.ZG20A             ANOP  ,                                              00090100
.*-------------------------------------------------------------------   00090200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090300
.ZG21              ANOP  ,                                              00090400
&ZTLC              SETC 'MISC'                                          00090500
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG22               00090600
&XRESOURCE         SETC  'MISC'      SET KEYWORD                        00090700
                   AIF   (N'&RESOURCE LE 1).ZG21A  CK NUM               00090800
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00090900
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00091000
&ZMS               SETC  '&ZMS "RESOURCE"'                              00091100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00091200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00091300
.ZG21A             ANOP  ,                                              00091400
.*-------------------------------------------------------------------   00091500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00091600
.ZG22              ANOP  ,                                              00091700
&ZTLC              SETC 'SSL_THREAD'                                    00091800
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG23               00091900
&XRESOURCE         SETC  'SSL_THREAD'           SET KEYWORD             00092000
                   AIF   (N'&RESOURCE LE 1).ZG22A  CK NUM               00092100
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00092200
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00092300
&ZMS               SETC  '&ZMS "RESOURCE"'                              00092400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00092500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00092600
.ZG22A             ANOP  ,                                              00092700
.*-------------------------------------------------------------------   00092800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092900
.ZG23              ANOP  ,                                              00093000
&ZTLC              SETC 'REG_THREAD'                                    00093100
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG24               00093200
&XRESOURCE         SETC  'REG_THREAD'           SET KEYWORD             00093300
                   AIF   (N'&RESOURCE LE 1).ZG23A  CK NUM               00093400
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00093500
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00093600
&ZMS               SETC  '&ZMS "RESOURCE"'                              00093700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00093800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00093900
.ZG23A             ANOP  ,                                              00094000
.*-------------------------------------------------------------------   00094100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00094200
.ZG24              ANOP  ,                                              00094300
&ZTLC              SETC 'REG_TO_WRKTB'                                  00094400
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG25               00094500
&XRESOURCE         SETC  'REG_TO_WRKTB'         SET KEYWORD             00094600
                   AIF   (N'&RESOURCE LE 1).ZG24A  CK NUM               00094700
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00094800
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00094900
&ZMS               SETC  '&ZMS "RESOURCE"'                              00095000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00095100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00095200
.ZG24A             ANOP  ,                                              00095300
.*-------------------------------------------------------------------   00095400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095500
.ZG25              ANOP  ,                                              00095600
&ZTLC              SETC 'TYPE1'                                         00095700
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG26               00095800
&XRESOURCE         SETC  'TYPE1'     SET KEYWORD                        00095900
                   AIF   (N'&RESOURCE LE 1).ZG25A  CK NUM               00096000
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00096100
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00096200
&ZMS               SETC  '&ZMS "RESOURCE"'                              00096300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00096400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00096500
.ZG25A             ANOP  ,                                              00096600
.*-------------------------------------------------------------------   00096700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00096800
.ZG26              ANOP  ,                                              00096900
&ZTLC              SETC 'TYPE2'                                         00097000
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG27               00097100
&XRESOURCE         SETC  'TYPE2'     SET KEYWORD                        00097200
                   AIF   (N'&RESOURCE LE 1).ZG26A  CK NUM               00097300
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00097400
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00097500
&ZMS               SETC  '&ZMS "RESOURCE"'                              00097600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00097700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00097800
.ZG26A             ANOP  ,                                              00097900
.*-------------------------------------------------------------------   00098000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098100
.ZG27              ANOP  ,                                              00098200
&ZTLC              SETC 'TYPE3'                                         00098300
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG28               00098400
&XRESOURCE         SETC  'TYPE3'     SET KEYWORD                        00098500
                   AIF   (N'&RESOURCE LE 1).ZG27A  CK NUM               00098600
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00098700
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00098800
&ZMS               SETC  '&ZMS "RESOURCE"'                              00098900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00099000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00099100
.ZG27A             ANOP  ,                                              00099200
.*-------------------------------------------------------------------   00099300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099400
.ZG28              ANOP  ,                                              00099500
&ZTLC              SETC 'TYPE4'                                         00099600
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG29               00099700
&XRESOURCE         SETC  'TYPE4'     SET KEYWORD                        00099800
                   AIF   (N'&RESOURCE LE 1).ZG28A  CK NUM               00099900
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00100000
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00100100
&ZMS               SETC  '&ZMS "RESOURCE"'                              00100200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00100300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00100400
.ZG28A             ANOP  ,                                              00100500
.*-------------------------------------------------------------------   00100600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00100700
.ZG29              ANOP  ,                                              00100800
&ZTLC              SETC 'TYPE5'                                         00100900
                   AIF   ('&RESOURCE(1)' NE '&ZTLC').ZG30               00101000
&XRESOURCE         SETC  'TYPE5'     SET KEYWORD                        00101100
                   AIF   (N'&RESOURCE LE 1).ZG29A  CK NUM               00101200
&ZMS               SETC  '"RESOURCE='           *KPOSA* MNOTE           00101300
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00101400
&ZMS               SETC  '&ZMS "RESOURCE"'                              00101500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00101600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00101700
.ZG29A             ANOP  ,                                              00101800
.*------------------------------------------------------------------    00101900
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102000
.ZG30              ANOP  ,                                              00102100
&ZXRESOURCE        SETC  'INPUT'     SET IN/OUTPUT                      00102200
                   AIF   (K'&XRESOURCE GT 0).ZG30E  VALID ARG           00102300
                   AIF   (T'&RESOURCE EQ 'O').ZG30D  OMITTED            00102400
&ZASYSLNDX         SETA  0                                              00102500
.ZG30A             ANOP  ,           POSITIONAL MACRO KEY               00102600
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00102700
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG30C               00102800
&ZTLC              SETC 'RESOURCE'                                      00102900
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG30A      00103000
.ZG30B             ANOP  ,                                              00103100
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    00103200
&ZMS               SETC  'THE "RESOURCE" KEY'   *KOPTA* MNOTE           00103300
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00103400
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00103500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00103600
                   AGO   .ZG30E                                         00103700
.ZG30C             ANOP  ,                                              00103800
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    00103900
&ZMS               SETC  '"RESOURCE='           *KUKWA* MNOTE           00104000
&ZMS               SETC  '&ZMS.&RESOURCE"'                              00104100
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00104200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00104300
&ZMS               SETC  '&ZMS "LATCH",'                                00104400
&ZMS               SETC  '&ZMS "LOCK",'                                 00104500
&ZMS               SETC  '&ZMS "IO",'                                   00104600
&ZMS               SETC  '&ZMS "CONV",'                                 00104700
&ZMS               SETC  '&ZMS "DISTRIB",'                              00104800
&ZMS               SETC  '&ZMS "SESS_LOCALMVS",'                        00104900
&ZMS               SETC  '&ZMS "SESS_NETWORK",'                         00105000
&ZMS               SETC  '&ZMS "SESS_SYSPLEX",'                         00105100
&ZMS               SETC  '&ZMS "TIMER",'                                00105200
&ZMS               SETC  '&ZMS "OTHER_PRODUCT",'                        00105300
&ZMS               SETC  '&ZMS "MISC",'                                 00105400
&ZMS               SETC  '&ZMS "SSL_THREAD",'                           00105500
                   MNOTE 8,' &ZMS '                                     00105600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00105700
&ZMS               SETC  '(CONTINUED) '                                 00105800
&ZMS               SETC  '&ZMS "REG_THREAD",'                           00105900
&ZMS               SETC  '&ZMS "REG_TO_WRKTB",'                         00106000
&ZMS               SETC  '&ZMS "TYPE1",'                                00106100
&ZMS               SETC  '&ZMS "TYPE2",'                                00106200
&ZMS               SETC  '&ZMS "TYPE3",'                                00106300
&ZMS               SETC  '&ZMS "TYPE4",'                                00106400
&ZMS               SETC  '&ZMS OR "TYPE5".'                             00106500
                   MNOTE 8,' &ZMS '                                     00106600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00106700
                   AGO   .ZG30E                                         00106800
.ZG30D             ANOP  ,                                              00106900
&XRESOURCE         SETC  'LATCH'     SET DEFAULT KEYWORD                00107000
.ZG30E             ANOP  ,                                              00107100
.*------------------------------------------------------------------    00107200
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107300
                   AIF   (K'&RESOURCE(1) GT 0).ZG30F  PARM              00107400
&XRESOURCE         SETC  ''          ENSURE NULL KEYWORD                00107500
&ZXRESOURCE        SETC  ''          RESET IN/OUTPUT                    00107600
&ZMS               SETC  'THE'                                          00107700
&ZMS               SETC  '&ZMS "RESOURCE" KEY AND ITS'                  00107800
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00107900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00108000
&ZMS               SETC  '&ZMS "LATCH",'                                00108100
&ZMS               SETC  '&ZMS "LOCK",'                                 00108200
&ZMS               SETC  '&ZMS "IO",'                                   00108300
&ZMS               SETC  '&ZMS "CONV",'                                 00108400
&ZMS               SETC  '&ZMS "DISTRIB",'                              00108500
&ZMS               SETC  '&ZMS "SESS_LOCALMVS",'                        00108600
&ZMS               SETC  '&ZMS "SESS_NETWORK",'                         00108700
&ZMS               SETC  '&ZMS "SESS_SYSPLEX",'                         00108800
&ZMS               SETC  '&ZMS "TIMER",'                                00108900
&ZMS               SETC  '&ZMS "OTHER_PRODUCT",'                        00109000
&ZMS               SETC  '&ZMS "MISC",'                                 00109100
                   MNOTE 8,' &ZMS '                                     00109200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00109300
&ZMS               SETC  '(CONTINUED) '                                 00109400
&ZMS               SETC  '&ZMS "SSL_THREAD",'                           00109500
&ZMS               SETC  '&ZMS "REG_THREAD",'                           00109600
&ZMS               SETC  '&ZMS "REG_TO_WRKTB",'                         00109700
&ZMS               SETC  '&ZMS "TYPE1",'                                00109800
&ZMS               SETC  '&ZMS "TYPE2",'                                00109900
&ZMS               SETC  '&ZMS "TYPE3",'                                00110000
&ZMS               SETC  '&ZMS "TYPE4",'                                00110100
&ZMS               SETC  '&ZMS OR "TYPE5".'                             00110200
                   MNOTE 8,' &ZMS '                                     00110300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00110400
.ZG30F             ANOP  ,                                              00110500
.*------------------------------------------------------------------    00110600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110700
.ZG31              ANOP  ,                                              00110800
&ZXSTATE           SETC  'INPUT'     SET IN/OUTPUT                      00110900
                   AIF   (K'&XSTATE GT 0).ZG31E  VALID ARG              00111000
                   AIF   (T'&STATE EQ 'O').ZG31D  OMITTED               00111100
&ZASYSLNDX         SETA  0                                              00111200
.ZG31A             ANOP  ,           POSITIONAL MACRO KEY               00111300
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00111400
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG31C               00111500
&ZTLC              SETC 'STATE'                                         00111600
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG31A      00111700
.ZG31B             ANOP  ,                                              00111800
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    00111900
&ZMS               SETC  'THE "STATE" KEY'      *KOPTA* MNOTE           00112000
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00112100
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00112200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00112300
                   AGO   .ZG31E                                         00112400
.ZG31C             ANOP  ,                                              00112500
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    00112600
&ZMS               SETC  '"STATE='   *KUKWA* MNOTE                      00112700
&ZMS               SETC  '&ZMS.&STATE"'                                 00112800
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00112900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00113000
&ZMS               SETC  '&ZMS "FREE",'                                 00113100
&ZMS               SETC  '&ZMS "ACTIVE",'                               00113200
&ZMS               SETC  '&ZMS "ACTIVE_APPL",'                          00113300
&ZMS               SETC  '&ZMS "READY",'                                00113400
&ZMS               SETC  '&ZMS "IDLE",'                                 00113500
&ZMS               SETC  '&ZMS OR "WAITING".'                           00113600
                   MNOTE 8,' &ZMS '                                     00113700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00113800
                   AGO   .ZG31E                                         00113900
.ZG31D             ANOP  ,                                              00114000
&XSTATE            SETC  'FREE'      SET DEFAULT KEYWORD                00114100
.ZG31E             ANOP  ,                                              00114200
.*------------------------------------------------------------------    00114300
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114400
                   AIF   (K'&STATE(1) GT 0).ZG31F  PARM                 00114500
&XSTATE            SETC  ''          ENSURE NULL KEYWORD                00114600
&ZXSTATE           SETC  ''          RESET IN/OUTPUT                    00114700
&ZMS               SETC  'THE'                                          00114800
&ZMS               SETC  '&ZMS "STATE" KEY AND ITS'                     00114900
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00115000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00115100
&ZMS               SETC  '&ZMS "FREE",'                                 00115200
&ZMS               SETC  '&ZMS "ACTIVE",'                               00115300
&ZMS               SETC  '&ZMS "ACTIVE_APPL",'                          00115400
&ZMS               SETC  '&ZMS "READY",'                                00115500
&ZMS               SETC  '&ZMS "IDLE",'                                 00115600
&ZMS               SETC  '&ZMS OR "WAITING".'                           00115700
                   MNOTE 8,' &ZMS '                                     00115800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00115900
.ZG31F             ANOP  ,                                              00116000
.*----------------------------------------------------------------***   00116100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00116200
                   AIF   (N'&MONTKN LE 1).ZG33A  CK NUM                 00116300
&ZMS               SETC  '"MONTKN='  *KPOSA* MNOTE                      00116400
&ZMS               SETC  '&ZMS.&MONTKN"'                                00116500
&ZMS               SETC  '&ZMS "MONTKN"'                                00116600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00116700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00116800
.ZG33A             ANOP  ,                                              00116900
.*-------------------------------------------------------------------   00117000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00117100
&ZXMONTKN          SETC  'INPUT'     SET IN/OUTPUT                      00117200
&XMONTKN           SETC  '&MONTKN(1)'           SET XVARIABLE           00117300
                   AIF   (N'&MONTKN GT 1).ZG33B  MULTI PARMS            00117400
&XMONTKN           SETC  '&MONTKN'   SET XVARIABLE                      00117500
.ZG33B             AIF   (K'&MONTKN(1) GT 0).ZG33C                      00117600
&ZXMONTKN          SETC  ''          RESET IN/OUTPUT                    00117700
&ZMS               SETC  ' '         *KRQDA*                            00117800
&ZMS               SETC  '&ZMS "MONTKN" KEY AND ITS'                    00117900
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00118000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00118100
.ZG33C             ANOP  ,                                              00118200
.*-------------------------------------------------------------------   00118300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00118400
                   AIF   (K'&ZXMONTKN LE 0).ZG33R  NOT I/O              00118500
                   AIF   ('&XMONTKN'(1,1) NE '(').ZG33R                 00118600
&ZCGPR             SETC  '&XMONTKN'(2,K'&XMONTKN-2)                     00118700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                   00118800
                   AIF   (K'&ZCGPR GT 2).ZG33Q                          00118900
                   AIF   ('&ZCGPR' EQ '0').ZG33Q                        00119000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00119100
                   AIF   (T'&ZCGPR NE 'N').ZG33Q  INVALID REG NAME      00119200
.ZG33P             ANOP  ,                                              00119300
                   AIF   (T'&ZCGPR NE 'N').ZG33R  NON NUMERIC           00119400
                   AIF   ('&ZCGPR' LT '2').ZG33Q                        00119500
                   AIF   ('&ZCGPR' LE '12').ZG33R                       00119600
.ZG33Q             ANOP  ,                                              00119700
&ZMS               SETC  '"MONTKN='  *KGPRA* MNOTE                      00119800
&ZMS               SETC  '&ZMS.&MONTKN"'                                00119900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00120000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00120100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00120200
.ZG33R             ANOP  ,                                              00120300
.*------------------------------------------------------------------    00120400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00120500
&XRUNTIME_VER      SETC  ''          INITIALIZE XVARIABLE               00120600
.*-------------------------------------------------------------------   00120700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00120800
.ZG37              ANOP  ,                                              00120900
                   AIF   (K'&RUNTIME_VER(1) LE 0).ZG37A                 00121000
&ZTLC              SETC 'SHORT_FORM'                                    00121100
                   AIF   ('&RUNTIME_VER(1)' NE '&ZTLC').ZG38            00121200
&XRUNTIME_VER      SETC  'SHORT_FORM'           SET KEYWORD             00121300
                   AIF   (N'&RUNTIME_VER LE 1).ZG37A  CK NUM            00121400
&ZMS               SETC  '"RUNTIME_VER='        *KPOSA* MNOTE           00121500
&ZMS               SETC  '&ZMS.&RUNTIME_VER"'                           00121600
&ZMS               SETC  '&ZMS "RUNTIME_VER"'                           00121700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00121800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00121900
.ZG37A             ANOP  ,                                              00122000
.*-------------------------------------------------------------------   00122100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00122200
.ZG38              ANOP  ,                                              00122300
&ZTLC              SETC 'MINIMAL'                                       00122400
                   AIF   ('&RUNTIME_VER(1)' NE '&ZTLC').ZG39            00122500
&XRUNTIME_VER      SETC  'MINIMAL'   SET KEYWORD                        00122600
                   AIF   (N'&RUNTIME_VER LE 1).ZG38A  CK NUM            00122700
&ZMS               SETC  '"RUNTIME_VER='        *KPOSA* MNOTE           00122800
&ZMS               SETC  '&ZMS.&RUNTIME_VER"'                           00122900
&ZMS               SETC  '&ZMS "RUNTIME_VER"'                           00123000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00123100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00123200
.ZG38A             ANOP  ,                                              00123300
.*------------------------------------------------------------------    00123400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123500
.ZG39              ANOP  ,                                              00123600
&ZXRUNTIME_VER     SETC  'INPUT'     SET IN/OUTPUT                      00123700
                   AIF   (K'&XRUNTIME_VER GT 0).ZG39E  VALID ARG        00123800
                   AIF   (T'&RUNTIME_VER EQ 'O').ZG39D  OMITTED         00123900
&ZASYSLNDX         SETA  0                                              00124000
.ZG39A             ANOP  ,           POSITIONAL MACRO KEY               00124100
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00124200
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG39C               00124300
&ZTLC              SETC 'RUNTIME_VER'                                   00124400
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG39A      00124500
.ZG39B             ANOP  ,                                              00124600
&ZXRUNTIME_VER     SETC  ''          RESET IN/OUTPUT                    00124700
&ZMS               SETC  'THE "RUNTIME_VER" KEY'  *KOPTA* MNOTE         00124800
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00124900
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00125000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00125100
                   AGO   .ZG39E                                         00125200
.ZG39C             ANOP  ,                                              00125300
&ZXRUNTIME_VER     SETC  ''          RESET IN/OUTPUT                    00125400
&ZMS               SETC  '"RUNTIME_VER='        *KUKWA* MNOTE           00125500
&ZMS               SETC  '&ZMS.&RUNTIME_VER"'                           00125600
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00125700
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00125800
&ZMS               SETC  '&ZMS "SHORT_FORM"'                            00125900
&ZMS               SETC  '&ZMS OR "MINIMAL".'                           00126000
                   MNOTE 8,' &ZMS '                                     00126100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00126200
                   AGO   .ZG39E                                         00126300
.ZG39D             ANOP  ,                                              00126400
&XRUNTIME_VER      SETC  'SHORT_FORM'           SET DEFAULT KEYWORD     00126500
.ZG39E             ANOP  ,                                              00126600
.*------------------------------------------------------------------    00126700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126800
&XCOMPCODE         SETC  ''          INITIALIZE XVARIABLE               00126900
.*-------------------------------------------------------------------   00127000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127100
.ZG42              ANOP  ,                                              00127200
                   AIF   (K'&COMPCODE(1) LE 0).ZG42A                    00127300
&ZTLC              SETC 'YES'                                           00127400
                   AIF   ('&COMPCODE(1)' NE '&ZTLC').ZG43               00127500
&XCOMPCODE         SETC  'YES'       SET KEYWORD                        00127600
                   AIF   (N'&COMPCODE LE 1).ZG42A  CK NUM               00127700
&ZMS               SETC  '"COMPCODE='           *KPOSA* MNOTE           00127800
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00127900
&ZMS               SETC  '&ZMS "COMPCODE"'                              00128000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00128100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00128200
.ZG42A             ANOP  ,                                              00128300
.*-------------------------------------------------------------------   00128400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128500
.ZG43              ANOP  ,                                              00128600
&ZTLC              SETC 'NO'                                            00128700
                   AIF   ('&COMPCODE(1)' NE '&ZTLC').ZG44               00128800
&XCOMPCODE         SETC  'NO'        SET KEYWORD                        00128900
                   AIF   (N'&COMPCODE LE 1).ZG43A  CK NUM               00129000
&ZMS               SETC  '"COMPCODE='           *KPOSA* MNOTE           00129100
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00129200
&ZMS               SETC  '&ZMS "COMPCODE"'                              00129300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00129400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00129500
.ZG43A             ANOP  ,                                              00129600
.*------------------------------------------------------------------    00129700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129800
.ZG44              ANOP  ,                                              00129900
&ZXCOMPCODE        SETC  'INPUT'     SET IN/OUTPUT                      00130000
                   AIF   (K'&XCOMPCODE GT 0).ZG44E  VALID ARG           00130100
                   AIF   (T'&COMPCODE EQ 'O').ZG44D  OMITTED            00130200
&ZASYSLNDX         SETA  0                                              00130300
.ZG44A             ANOP  ,           POSITIONAL MACRO KEY               00130400
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00130500
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG44C               00130600
&ZTLC              SETC 'COMPCODE'                                      00130700
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG44A      00130800
.ZG44B             ANOP  ,                                              00130900
&ZXCOMPCODE        SETC  ''          RESET IN/OUTPUT                    00131000
&ZMS               SETC  'THE "COMPCODE" KEY'   *KOPTA* MNOTE           00131100
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00131200
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00131300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00131400
                   AGO   .ZG44E                                         00131500
.ZG44C             ANOP  ,                                              00131600
&ZXCOMPCODE        SETC  ''          RESET IN/OUTPUT                    00131700
&ZMS               SETC  '"COMPCODE='           *KUKWA* MNOTE           00131800
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00131900
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00132000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00132100
&ZMS               SETC  '&ZMS "YES"'                                   00132200
&ZMS               SETC  '&ZMS OR "NO".'                                00132300
                   MNOTE 8,' &ZMS '                                     00132400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00132500
                   AGO   .ZG44E                                         00132600
.ZG44D             ANOP  ,                                              00132700
&XCOMPCODE         SETC  'YES'       SET DEFAULT KEYWORD                00132800
.ZG44E             ANOP  ,                                              00132900
.*----------------------------------------------------------------***   00133000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00133100
                   AIF   (N'&RETCODE LE 1).ZG46A  CK NUM                00133200
&ZMS               SETC  '"RETCODE='            *KPOSA* MNOTE           00133300
&ZMS               SETC  '&ZMS.&RETCODE"'                               00133400
&ZMS               SETC  '&ZMS "RETCODE"'                               00133500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00133600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00133700
.ZG46A             ANOP  ,                                              00133800
.*-------------------------------------------------------------------   00133900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00134000
                   AIF   (K'&RETCODE(1) LE 0).ZG46C  NO PARM            00134100
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00134200
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00134300
                   AIF   (N'&RETCODE GT 1).ZG46C                        00134400
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00134500
.ZG46C             ANOP  ,                                              00134600
.*-------------------------------------------------------------------   00134700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00134800
                   AIF   (K'&ZXRETCODE LE 0).ZG46R  NOT I/O             00134900
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG46R                00135000
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00135100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                   00135200
                   AIF   (K'&ZCGPR GT 2).ZG46Q                          00135300
                   AIF   ('&ZCGPR' EQ '0').ZG46Q                        00135400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00135500
                   AIF   (T'&ZCGPR NE 'N').ZG46Q  INVALID REG NAME      00135600
.ZG46P             ANOP  ,                                              00135700
                   AIF   (T'&ZCGPR NE 'N').ZG46R  NON NUMERIC           00135800
                   AIF   ('&ZCGPR' LT '2').ZG46Q                        00135900
                   AIF   ('&ZCGPR' LE '12').ZG46R                       00136000
.ZG46Q             ANOP  ,                                              00136100
&ZMS               SETC  '"RETCODE='            *KGPRA* MNOTE           00136200
&ZMS               SETC  '&ZMS.&RETCODE"'                               00136300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00136400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00136500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00136600
.ZG46R             ANOP  ,                                              00136700
.*----------------------------------------------------------------***   00136800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00136900
                   AIF   (N'&RSNCODE LE 1).ZG49A  CK NUM                00137000
&ZMS               SETC  '"RSNCODE='            *KPOSA* MNOTE           00137100
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00137200
&ZMS               SETC  '&ZMS "RSNCODE"'                               00137300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00137400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00137500
.ZG49A             ANOP  ,                                              00137600
.*-------------------------------------------------------------------   00137700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00137800
                   AIF   (K'&RSNCODE(1) LE 0).ZG49C  NO PARM            00137900
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00138000
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00138100
                   AIF   (N'&RSNCODE GT 1).ZG49C                        00138200
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00138300
.ZG49C             ANOP  ,                                              00138400
.*-------------------------------------------------------------------   00138500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00138600
                   AIF   (K'&ZXRSNCODE LE 0).ZG49R  NOT I/O             00138700
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG49R                00138800
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00138900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                   00139000
                   AIF   (K'&ZCGPR GT 2).ZG49Q                          00139100
                   AIF   ('&ZCGPR' EQ '0').ZG49Q                        00139200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00139300
                   AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME      00139400
.ZG49P             ANOP  ,                                              00139500
                   AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC           00139600
                   AIF   ('&ZCGPR' LT '2').ZG49Q                        00139700
                   AIF   ('&ZCGPR' LE '12').ZG49R                       00139800
.ZG49Q             ANOP  ,                                              00139900
&ZMS               SETC  '"RSNCODE='            *KGPRA* MNOTE           00140000
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00140100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00140200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00140300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00140400
.ZG49R             ANOP  ,                                              00140500
.******************************************************************     00140600
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00140700
.******************************************************************     00140800
                   ACTR  10000                                          00140900
.*----------------------------------------------------------------***   00141000
.***AH.P02 EXTRA POSITIONALS                                            00141100
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00141200
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00141300
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00141400
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00141500
.ZGLISTX1          ANOP  ,                                              00141600
&ZCVAL             SETC  ''          ERROR FIELD                        00141700
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00141800
.ZGLIST2           ANOP  ,                                              00141900
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00142000
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00142100
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00142200
                   AGO   .ZGLIST2                                       00142300
.*                                                                      00142400
.ZGLIST3           ANOP  ,                                              00142500
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00142600
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE       00142700
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00142800
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00142900
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00143000
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00143100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00143200
.ZGLISTX           ANOP  ,                                              00143300
&ZASYSLNDX         SETA  0                                              00143400
.*******************************************************************    00143500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00143600
.*******************************************************************    00143700
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00143800
.*******************************************************************    00143900
.***AE.01  START OF IWMMCHST MACRO CODE                                 00144000
.*******************************************************************    00144100
                   LCLC  &M0M0001                 NAME                  00144200
&M0M0001           SETC  '&XLABEL'                SET NAME              00144300
                   AIF   (K'&XLABEL NE 0).XLAB2                         00144400
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00144500
.*                                                                      00144600
.XLAB2             ANOP  ,                                              00144700
&M0M0001 DS    0H                             IWMMCHST-0                00144800
.*******************************************************************    00144900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00145000
.*******************************************************************    00145100
              PUSH  PRINT                                               00145200
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00145300
                   PRINT OFF         ++ PR01                            00145400
                   AGO   .ZPRNTXX                                       00145500
.ZPRINTX           PRINT ON                                             00145600
.ZPRNTXX           ANOP  ,                                              00145700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00145800
         LCLC  &T1,&T2                                                  00145900
         AIF   ('&XCOMPCODE' EQ 'YES').INLINE                           00146000
         AIF   ('&XRETCODE' EQ '').RSNCODECHK                           00146100
&T1      SETC  'RETCODE, RSNCODE MAY NOT BE USED WITH COMPCODE(NO)'     00146200
         MNOTE 8,'&T1'                                                  00146300
         MEXIT                                                          00146400
.RSNCODECHK ANOP                                                        00146500
         AIF   ('&XRSNCODE' EQ '').INLINE                               00146600
&T1      SETC  'RETCODE, RSNCODE MAY NOT BE USED WITH COMPCODE(NO)'     00146700
         MNOTE 8,'&T1'                                                  00146800
         MEXIT                                                          00146900
.*                                                                      00147000
.INLINE  ANOP                                                           00147100
&T1      SETC  '&MONTKN'                                                00147200
         AIF   ('&MONTKN'(1,1) NE '(').MONTKNRS                         00147300
&T1      SETC  '&MONTKN'(2,K'&MONTKN-2)                                 00147400
&T1      SETC  '0(&T1.)'                                                00147500
.MONTKNRS  ANOP                                                         00147600
.* &T1 IS NOW A VALID BASE-DISPLACEMENT EXPRESSION                      00147700
         ICM   14,15,&T1               FETCH MONITORING TOKEN           00147800
.* GENERATE CODE WHICH DEPENDS ON HOW COMPCODE WAS SPECIFIED            00147900
         AIF   ('&XCOMPCODE' NE 'YES').NOCOMPCODE1                      00148000
         BNZ   MONENV&SYSNDX           BRANCH WHEN MON ENV IS PRESENT   00148100
         LA    0,IWMRSNCODENOMONENV    SET REASON CODE = NO MON ENV     00148200
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00148300
         B     END&SYSNDX              BRANCH TO END LABEL              00148400
MONENV&SYSNDX DS    0H                 BRANCH LABEL FOR MON ENV PRESENT 00148500
         AIF   ('&XRUNTIME_VER' EQ 'MINIMAL').ENDCOMPCODE1              00148600
         CLC   PB_ID-PB(4,14),=CL4'PB  '                                00148700
         BE    MONENVOK&SYSNDX         BRANCH WHEN MON ENV PASSES       00148800
         LA    0,IWMRSNCODEBADMONENV   SET REASON CODE = BAD MON ENV    00148900
         LA    15,IWMRETCODEINVOCERROR SET INVOCATION ERROR RETURN CODE 00149000
         B     END&SYSNDX              BRANCH TO END LABEL              00149100
MONENVOK&SYSNDX DS    0H               BRANCH LABEL FOR MON ENV OK      00149200
                AGO .ENDCOMPCODE1                                       00149300
.* NOW GENERATE CODE WHEN COMPCODE(NO) WAS SPECIFIED                    00149400
.NOCOMPCODE1    ANOP                                                    00149500
         BZ    END&SYSNDX              BRANCH TO END LABEL              00149600
         AIF   ('&XRUNTIME_VER' EQ 'MINIMAL').ENDCOMPCODE1              00149700
         CLC   PB_ID-PB(4,14),=CL4'PB  '                                00149800
         BNE   END&SYSNDX              BRANCH TO END LABEL              00149900
.ENDCOMPCODE1    ANOP                                                   00150000
         USING PB,14                                                    00150100
         AIF   ('&XSTATE' EQ 'WAITING').WAITING                         00150200
         MVI   PB_STATE,PB_STATE_&XSTATE                                00150300
         AGO  .ENDSTATE                                                 00150400
.WAITING       ANOP                                                     00150500
         MVI   PB_STATE,PB_STATE_WAITING_&XRESOURCE                     00150600
.ENDSTATE      ANOP                                                     00150700
         AIF   ('&XCOMPCODE' NE 'YES').NOCOMPCODE2                      00150800
         LA    15,IWMRETCODEOK           SET RETURN CODE = OK           00150900
.NOCOMPCODE2    ANOP                                                    00151000
*                                                                       00151100
         DROP  14                                                       00151200
END&SYSNDX DS    0H                    END LABEL                        00151300
.*******************************************************************    00151400
.***        RETURN CODE PROCESSING                                      00151500
.*******************************************************************    00151600
         AIF   (N'&RETCODE LE 0).IWMMCHST_ENDRC_EXP                     00151700
         AIF   ('&XRETCODE'(1,1) EQ '(').IWMMCHST_RC_REG                00151800
         AIF   ('&XRETCODE' EQ 'GPR15').IWMMCHST_ENDRC_EXP              00151900
         AIF   ('&XRETCODE' EQ 'REG15').IWMMCHST_ENDRC_EXP              00152000
         AIF   ('&XRETCODE' EQ 'R15').IWMMCHST_ENDRC_EXP                00152100
         AIF   ('&XRETCODE' EQ '15').IWMMCHST_ENDRC_EXP                 00152200
         ST    15,&XRETCODE                                             00152300
            AGO  .IWMMCHST_ENDRC_EXP                                    00152400
.*                                                                      00152500
.IWMMCHST_RC_REG      ANOP  ,                                           00152600
&T1      SETC  '&XRETCODE'(2,K'&XRETCODE-2)                             00152700
         AIF   ('&T1' EQ 'GPR15').IWMMCHST_ENDRC_EXP                    00152800
         AIF   ('&T1' EQ 'REG15').IWMMCHST_ENDRC_EXP                    00152900
         AIF   ('&T1' EQ 'R15').IWMMCHST_ENDRC_EXP                      00153000
         AIF   ('&T1' EQ '15').IWMMCHST_ENDRC_EXP                       00153100
         LR    &T1,15                                                   00153200
.IWMMCHST_ENDRC_EXP   ANOP  ,                                           00153300
.*******************************************************************    00153400
.***        REASON CODE PROCESSING                                      00153500
.*******************************************************************    00153600
         AIF   (N'&RSNCODE LE 0).IWMMCHST_ENDRSN_EXP                    00153700
         AIF   ('&XRSNCODE'(1,1) EQ '(').IWMMCHST_RSN_REG               00153800
         AIF   ('&XRSNCODE' EQ 'GPR0').IWMMCHST_ENDRSN_EXP              00153900
         AIF   ('&XRSNCODE' EQ 'GPR00').IWMMCHST_ENDRSN_EXP             00154000
         AIF   ('&XRSNCODE' EQ 'REG0').IWMMCHST_ENDRSN_EXP              00154100
         AIF   ('&XRSNCODE' EQ 'REG00').IWMMCHST_ENDRSN_EXP             00154200
         AIF   ('&XRSNCODE' EQ 'R0').IWMMCHST_ENDRSN_EXP                00154300
         AIF   ('&XRSNCODE' EQ '0').IWMMCHST_ENDRSN_EXP                 00154400
         AIF   ('&XRSNCODE' EQ '00').IWMMCHST_ENDRSN_EXP                00154500
         ST    0,&XRSNCODE                                              00154600
         AGO   .IWMMCHST_ENDRSN_EXP                                     00154700
.*                                                                      00154800
.IWMMCHST_RSN_REG     ANOP  ,                                           00154900
&T1      SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                             00155000
         AIF   ('&ZCGPR' EQ 'GPR0').IWMMCHST_ENDRSN_EXP                 00155100
         AIF   ('&ZCGPR' EQ 'GPR00').IWMMCHST_ENDRSN_EXP                00155200
         AIF   ('&ZCGPR' EQ 'REG0').IWMMCHST_ENDRSN_EXP                 00155300
         AIF   ('&ZCGPR' EQ 'REG00').IWMMCHST_ENDRSN_EXP                00155400
         AIF   ('&ZCGPR' EQ 'R0').IWMMCHST_ENDRSN_EXP                   00155500
         AIF   ('&ZCGPR' EQ '0').IWMMCHST_ENDRSN_EXP                    00155600
         AIF   ('&ZCGPR' EQ '00').IWMMCHST_ENDRSN_EXP                   00155700
         LR    &T1,0                                                    00155800
.IWMMCHST_ENDRSN_EXP  ANOP  ,                                           00155900
.*******************************************************************    00156000
&ZIWMMCHST            SETC  'YES'          SET IWMMCHST USED            00156100
         POP   PRINT                                                    00156200
*                                            IWMMCHST END               00156300
         SPACE 1                                                        00156400
         MEXIT                                                          00156500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00156600
.********************************************************************   00156700
.***AL.A01  INTERNAL ARRAY TO PRODUCE FORMATTED CODE                    00156800
.********************************************************************   00156900
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00157000
                      LCLA  &ZOPN1         INVOCATION INDEX             00157100
                      LCLC  &ZOPL(4095)    LABEL                        00157200
                      LCLC  &ZOPO(4095)    OPERATION                    00157300
                      LCLC  &ZOPV(4095)    VALUE                        00157400
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00157500
.*                                                                      00157600
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00157700
.*******************************************************************    00157800
.***AO.X02  RETURN CODE PROCESSING                                      00157900
.*******************************************************************    00158000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00158100
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00158200
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00158300
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00158400
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00158500
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00158600
&ZOPN                 SETA  &ZOPN+1                                     00158700
&ZOPL(&ZOPN)          SETC  ' '                                         00158800
&ZOPO(&ZOPN)          SETC  'ST'                                        00158900
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00159000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00159100
                      AGO   .ZMRETX                                     00159200
.*                                                                      00159300
.ZMRET2               ANOP  ,                                           00159400
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00159500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00159600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00159700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00159800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00159900
&ZOPN                 SETA  &ZOPN+1                                     00160000
&ZOPL(&ZOPN)          SETC  ' '                                         00160100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00160200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00160300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00160400
.ZMRETX               ANOP  ,                                           00160500
.*******************************************************************    00160600
.***AO.X03  REASON CODE PROCESSING                                      00160700
.*******************************************************************    00160800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00160900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00161000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00161100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00161200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00161300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00161400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00161500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00161600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00161700
&ZOPN                 SETA  &ZOPN+1                                     00161800
&ZOPL(&ZOPN)          SETC  ' '                                         00161900
&ZOPO(&ZOPN)          SETC  'ST'                                        00162000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00162100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00162200
                      AGO   .ZMRSNX                                     00162300
.*                                                                      00162400
.ZMRSN2               ANOP  ,                                           00162500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00162600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00162700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00162800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00162900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00163000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00163100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00163200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00163300
&ZOPN                 SETA  &ZOPN+1                                     00163400
&ZOPL(&ZOPN)          SETC  ' '                                         00163500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00163600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00163700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00163800
.ZMRSNX               ANOP  ,                                           00163900
.*******************************************************************    00164000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00164100
.*******************************************************************    00164200
                      ACTR  10000                                       00164300
.*                                                                      00164400
                      LCLA  &ZLC           COLUMN POSITION              00164500
                      LCLA  &ZOPX          LIST TABLE INDEX             00164600
                      LCLC  &ZLL           LABEL                        00164700
                      LCLC  &ZLOP          OPERATION                    00164800
                      LCLC  &ZLV           VALUE                        00164900
                      LCLC  &ZLD           DESCRIPTION                  00165000
.*                                                                      00165100
&ZOPX                 SETA  1                                           00165200
.*******************************************************************    00165300
.***AP.X01  FORMAT GENERATED CODE                                       00165400
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00165500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00165600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00165700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00165800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00165900
                      AIF   (K'&ZLD LE 0).ZL51                          00166000
&ZLC                  SETA  35             COMMENT COLUMN               00166100
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00166200
&ZLC                  SETA  33             COMMENT COLUMN               00166300
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00166400
&ZLV                  SETC  '&ZLV'.' '                                  00166500
                      AGO   .ZL31                                       00166600
.*                                                                      00166700
.ZL41                 ANOP  ,                                           00166800
&ZLV                  SETC  '&ZLV'.' '                                  00166900
.ZL51                 ANOP  ,                                           00167000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00167100
.*                                                                      00167200
&ZLL     &ZLOP &ZLV                                                     00167300
.*                                                                      00167400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00167500
                      AGO   .ZL21          CONTINUE LOOPING             00167600
.*                                                                      00167700
.ZLX1                 ANOP  ,                                           00167800
.*******************************************************************    00167900
.***AP.X02  END OF IWMMCHST MACRO                                       00168000
&ZIWMMCHST            SETC  'YES'          SET IWMMCHST USED            00168100
         POP   PRINT                                                    00168200
*                                            IWMMCHST-0                 00168300
         SPACE 1                                                        00168400
.ZLX2                 ANOP  ,                                           00168500
         MEND                                                           00168600
**********************************************************************/ 00168700
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00168800
*%IWMMCHST: MACRO KEYS(STATE,RESOURCE,MONTKN,RUNTIME_VER,COMPCODE,      00168900
*                 RETCODE,RSNCODE);                                     00169000
*  ANS('?'!!MACLABEL!!' '!!'IWMMCHSP '!!MACLIST!!                       00169100
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00169200
*%END IWMMCHST;                                                         00169300

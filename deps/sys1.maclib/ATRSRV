*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  ATRSRV                              -2007/11/28-<5> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Manipulate Units of Recovery                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 1997, 2008                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7750                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      DESCRIPTION                                                    * 00002100
*                                                                     * 00002200
*      The ATRSRV macro allows authorized callers to:                 * 00002300
*                                                                     * 00002400
*                                                                     * 00002500
*      o   Remove a resource manager's interests in a UR.             * 00002600
*                                                                     * 00002700
*      o   Resolve a UR state from IN-DOUBT to IN-COMMIT.             * 00002800
*                                                                     * 00002900
*      o   Resolve a UR state from IN-DOUBT to IN-BACKOUT.            * 00003000
*                                                                     * 00003100
*      o   Perform Forget processing on a UR whose IN-DOUBT condition * 00003200
*          has been resolved.                                         * 00003300
*                                                                     * 00003400
*      o   Remove a resource manager's identity.                      * 00003500
*                                                                     * 00003600
*      o   Unregister a resource manager's involvement with RRS.      * 00003700
*                                                                     * 00003800
*                                                                     * 00003900
*                                                                     * 00004000
*      URs on other systems in a SYSPLEX and/or in other RRS logging  * 00004100
*      groups can be processed.                                       * 00004200
*                                                                     * 00004300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00004400
*                                                                     * 00004500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004600
*                                                                     * 00004700
*01* ENVIRONMENT:                                                     * 00004800
*                                                                     * 00004900
*                                                                     * 00005000
*      Dispatchable unit mode: Task mode.                             * 00005100
*                                                                     * 00005200
*      Minimum authorization: Supervisor state.  System PSW key.      * 00005300
*                                                                     * 00005400
*                        If your installation uses the RACF component * 00005500
*                        of the OS/390 Security Server to control     * 00005600
*                        access to RRS/MVS information, ATRSRV        * 00005700
*                        requires ALTER access to the                 * 00005800
*                        MVSADMIN.RRS.COMMANDS resource in the        * 00005900
*                        FACILITY class.  To process URs on other     * 00006000
*                        systems, the ATRSRV requires ALTER access to * 00006100
*                        the MVSADMIN.RRS.COMMANDS.gname.sysname on   * 00006200
*                        the originating system, where gname is the   * 00006300
*                        target RRS logging group name and sysname is * 00006400
*                        the target system name.                      * 00006500
*                                                                     * 00006600
*      AMODE:            31-bit.                                      * 00006700
*                                                                     * 00006800
*      ASC mode:         Primary.                                     * 00006900
*                                                                     * 00007000
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00007100
*                                                                     * 00007200
*      Interrupt status: Enabled for I/O and external interrupts.     * 00007300
*                                                                     * 00007400
*      Locks:            No locks held.                               * 00007500
*                                                                     * 00007600
*      Control parameters: Control parameters must be in the primary  * 00007700
*                        address space.                               * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*                                                                     * 00008100
*01* PROGRAMMING REQUIREMENTS:                                        * 00008200
*                                                                     * 00008300
*    ATRSRV callers must include the following mapping macros:        * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*    o   ATRFZSRV                                                     * 00008700
*                                                                     * 00008800
*    o   CVT                                                          * 00008900
*                                                                     * 00009000
*    o   IHAECVT                                                      * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*01* RESTRICTIONS:                                                    * 00009500
*    None.                                                            * 00009600
*                                                                     * 00009700
*01* INPUT REGISTER INFORMATION:                                      * 00009800
*                                                                     * 00009900
*    Before issuing the ATRSRV macro, the caller does not have to     * 00010000
*    place any information into any register unless using it in       * 00010100
*    register notation for a particular parameter, or using it as a   * 00010200
*    base register.                                                   * 00010300
*                                                                     * 00010400
*01* OUTPUT REGISTER INFORMATION:                                     * 00010500
*                                                                     * 00010600
*    When control returns to the caller, the GPRs contain:            * 00010700
*                                                                     * 00010800
*                                                                     * 00010900
*    REGISTER  CONTENTS                                               * 00011000
*                                                                     * 00011100
*    0         Contains the reason code                               * 00011200
*                                                                     * 00011300
*    1-13      Unchanged                                              * 00011400
*                                                                     * 00011500
*    14        Used as a work register by the system.                 * 00011600
*                                                                     * 00011700
*    15        Contains the return code                               * 00011800
*                                                                     * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*    Some callers depend on register contents remaining the same      * 00012200
*    before and after issuing a service.  If the system changes the   * 00012300
*    contents of registers on which the caller depends, the caller    * 00012400
*    must save them before issuing the service, and restore them      * 00012500
*    after the system returns control.                                * 00012600
*                                                                     * 00012700
*01* PERFORMANCE IMPLICATIONS:                                        * 00012800
*                                                                     * 00012900
*    None.                                                            * 00013000
*                                                                     * 00013100
*01* SYNTAX:                                                          * 00013200
*                                                                     * 00013300
*Ýxlabel¨  ATRSRV  Ð  REQUEST=REMOVINT                                * 00013400
*                  !    Ý,RMNAME=»xrmname!0º¨                         * 00013500
*                  !    Ý,URID=»xurid!0º¨                             * 00013600
*                  Ô ,REQUEST=COMMIT                                  * 00013700
*                  !     ,URID=xurid                                  * 00013800
*                  Ô ,REQUEST=BACKOUT                                 * 00013900
*                  !     ,URID=xurid                                  * 00014000
*                  Ô ,REQUEST=REMOVRM                                 * 00014100
*                  !     ,RMNAME=xrmname                              * 00014200
*                  Ô ,REQUEST=UNREGRM                                 * 00014300
*                  !     ,RMNAME=xrmname                              * 00014400
*                  ¿ ,REQUEST=FORGET                                  * 00014500
*                        ,URID=xurid                                  * 00014600
*                   Ý,GNAME=»xgname!CURRENT_GNAMEº¨                   * 00014700
*                   Ý,SYSNAME=»xsysname!CURRENT_SYSNAMEº¨             * 00014800
*                   Ý,RCTABLE=»xrctable!0º                            * 00014900
*                        ,RCNUM=xrcnum¨                               * 00015000
*                   Ý,RETCODE=xretcode¨                               * 00015100
*                   Ý,RSNCODE=xrsncode¨                               * 00015200
*                   Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨           * 00015300
*                  ÐÝ,MF=S¨                                           * 00015400
*                  ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                    * 00015500
*                  ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨              * 00015600
*                  ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨              * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*      Where:                                                         * 00016000
*                                                                     * 00016100
*                                                                     * 00016200
*      Ýxlabel¨                                                       * 00016300
*          is an optional symbol, starting in column 1, that is the   * 00016400
*          name on the ATRSRV macro invocation.  The name must        * 00016500
*          conform to the rules for an ordinary assembler language    * 00016600
*          symbol.                                                    * 00016700
*          DEFAULT: No name.                                          * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*      REQUEST=»REMOVINT!COMMIT!BACKOUT!REMOVRM!UNREGRM!FORGETº       * 00017300
*          is a required keyword input that specifies the requested   * 00017400
*          function.                                                  * 00017500
*                                                                     * 00017600
*                                                                     * 00017700
*          REQUEST=REMOVINT                                           * 00017800
*              Remove a resource manager's interests in a UR.         * 00017900
*                                                                     * 00018000
*              NOTE:  The resource manager must not be currently      * 00018100
*              active with RRS.  That is, the resource manager cannot * 00018200
*              have exits set with RRS.                               * 00018300
*                                                                     * 00018400
*              You can provide:                                       * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*              o   Only the resource manager name                     * 00018800
*                                                                     * 00018900
*                  In this case, the resource manager's interests     * 00019000
*                  will be removed from all URs that the resource     * 00019100
*                  manager has expressed interest in.                 * 00019200
*                                                                     * 00019300
*              o   Only the UR identifier                             * 00019400
*                                                                     * 00019500
*                  In this case, all resource manager interests will  * 00019600
*                  be removed from the specified UR.                  * 00019700
*                                                                     * 00019800
*              o   Both the resource manager name and the UR          * 00019900
*                  identifier                                         * 00020000
*                                                                     * 00020100
*                  In this case, the resource manager's interests     * 00020200
*                  will be removed from the specified UR.             * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*              ÝRMNAME=»xrmname!0º¨                                   * 00020800
*                  is the name (RS-type), or address in register      * 00020900
*                  (2)-(12), of an optional 32 character input that   * 00021000
*                  contains the resource manager name.                * 00021100
*                                                                     * 00021200
*                  If the resource manager name you provide is a      * 00021300
*                  distributed sync-point resource manager (DSRM),    * 00021400
*                  you cannot remove an interest from any UR with a   * 00021500
*                  state of IN-DOUBT, unless you remove all resource  * 00021600
*                  manager interests from the UR (specify only the UR * 00021700
*                  identifier).                                       * 00021800
*                  DEFAULT: 0                                         * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*              ÝURID=»xurid!0º¨                                       * 00022400
*                  is the name (RS-type), or address in register      * 00022500
*                  (2)-(12), of an optional 16 character input that   * 00022600
*                  contains the UR identifier                         * 00022700
*                  DEFAULT: 0                                         * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*                                                                     * 00023100
*          REQUEST=COMMIT                                             * 00023200
*              Resolve an IN-DOUBT UR to IN-COMMIT.                   * 00023300
*                                                                     * 00023400
*                                                                     * 00023500
*              URID=xurid                                             * 00023600
*                  is the name (RS-type), or address in register      * 00023700
*                  (2)-(12), of a required 16 character input that    * 00023800
*                  contains the UR identifier                         * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*          REQUEST=BACKOUT                                            * 00024300
*              Resolve an IN-DOUBT UR to IN-BACKOUT.                  * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*              URID=xurid                                             * 00024700
*                  is the name (RS-type), or address in register      * 00024800
*                  (2)-(12), of a required 16 character input that    * 00024900
*                  contains the UR identifier                         * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*          REQUEST=REMOVRM                                            * 00025400
*              Remove a resource manager's identity.                  * 00025500
*                                                                     * 00025600
*              NOTE:  The resource manager must not be currently      * 00025700
*              active with RRS or have an interest in any URs.        * 00025800
*                                                                     * 00025900
*              You must provide:                                      * 00026000
*                                                                     * 00026100
*                                                                     * 00026200
*              o   The resource manager name. In this case, the       * 00026300
*                  resource manager's identity will be deleted from   * 00026400
*                  all RRS systems in the logging group and the RRS   * 00026500
*                  Resource Manager logs.                             * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*              To affect units of recovery on other systems in a      * 00027000
*              sysplex, you may also provide a logging group name     * 00027100
*              with the GNAME keyword.  A system name using the       * 00027200
*              SYSNAME keyword is not required but if specified, the  * 00027300
*              SYSNAME keyword is not validated and is ignored.       * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*              RMNAME=xrmname                                         * 00027700
*                  is the name (RS-type), or address in register      * 00027800
*                  (2)-(12), of a required 32 character input that    * 00027900
*                  contains the resource manager name.                * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*          REQUEST=UNREGRM                                            * 00028500
*              Unregister RM - is used to clean up the resource       * 00028600
*              manager's involvement with RRS. Only resource          * 00028700
*              manager's that have been unregistered with             * 00028800
*              Registration Services but still set with RRS can be    * 00028900
*              processed. RRS Resource Manager Unregister processing  * 00029000
*              will be invoked to clean up the resource manager's     * 00029100
*              involvement with RRS.                                  * 00029200
*                                                                     * 00029300
*              You must provide:                                      * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*              o   The resource manager name. In this case, the       * 00029700
*                  resource manager to be unregistered with RRS.      * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*              Optionally you may provide:                            * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*              o   The GNAME and SYSNAME keywords.  To affect         * 00030500
*                  resource managers on other systems in a sysplex,   * 00030600
*                  you may also provide a logging group name and a    * 00030700
*                  system name with the GNAME and SYSNAME keywords.   * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*              RMNAME=xrmname                                         * 00031300
*                  is the name (RS-type), or address in register      * 00031400
*                  (2)-(12), of a required 32 character input that    * 00031500
*                  contains the resource manager name.                * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*          REQUEST=FORGET                                             * 00032100
*              Perform Forget processing for a unit of recovery whose * 00032200
*              IN-DOUBT condition was previously resolved to          * 00032300
*              IN-COMMIT or IN-BACKOUT.                               * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*              URID=xurid                                             * 00032700
*                  is the name (RS-type), or address in register      * 00032800
*                  (2)-(12), of a required 16 character input that    * 00032900
*                  contains the UR identifier.                        * 00033000
*                  The Forget request requires the URID of the UR     * 00033100
*                  that contains the SDSRM interest (top-level UR).   * 00033200
*                  Specifying a URID of a child or subordinate UR is  * 00033300
*                  not valid for this request and will result in a    * 00033400
*                  reason code of ATRSRV_URID_NOT_FOUND (8).          * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*      ÝGNAME=»xgname!CURRENT_GNAMEº¨                                 * 00034400
*          is the name (RS-type), or address in register (2)-(12), of * 00034500
*          an optional 8 character input that contains the name of    * 00034600
*          the target RRS logging group containing the specified      * 00034700
*          resource manager or URID.  If you specify GNAME, you must  * 00034800
*          also specify SYSNAME.  However, if REQUEST = REMOVRM, the  * 00034900
*          SYSNAME parameter is not required.                         * 00035000
*          DEFAULT: CURRENT_GNAME Current RRS logging group           * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*      ÝSYSNAME=»xsysname!CURRENT_SYSNAMEº¨                           * 00035600
*          is the name (RS-type), or address in register (2)-(12), of * 00035700
*          an optional 8 character input that contains the name of    * 00035800
*          the target system containing the specified resource        * 00035900
*          manager or URID.  If you specify SYSNAME, you must also    * 00036000
*          specify GNAME.  However, if REQUEST = REMOVRM, the SYSNAME * 00036100
*          parameter is not required and if specified, the value is   * 00036200
*          not validated and is ignored.                              * 00036300
*          DEFAULT: CURRENT_SYSNAME Current system's system name      * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*      ÝRCTABLE=»xrctable!0º                                          * 00036900
*          is the name (RS-type), or address in register (2)-(12), of * 00037000
*          an optional 4 byte input that contains the address of a    * 00037100
*          return/reason area. The area for:                          * 00037200
*                                                                     * 00037300
*                                                                     * 00037400
*          o   REQUEST = REMOVRM processing - is a char(2304) area to * 00037500
*              contain the return/reason code from each System in the * 00037600
*              Logging Group processing the REMOVRM request.  The     * 00037700
*              area consists of up to 64 36-byte entries.             * 00037800
*                                                                     * 00037900
*          o   All other processing - is a char(36) area to contain   * 00038000
*              the return/reason code from the System and Logging     * 00038100
*              Group processing the request.  The area consists of up * 00038200
*              to 1 36-byte entry.                                    * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*          In both cases, the entry is mapped by ATRFZRCA in the      * 00038700
*          ATRFZQRY mapping macro.  The number of entries will be     * 00038800
*          returned in the RCNUM parameter.  The table will only      * 00038900
*          contain valid information if the reason code returned to   * 00039000
*          you is ATRSRV_REMOTE_WARNING or ATRSRV_REMOTE_ERROR.       * 00039100
*          DEFAULT: 0 No return code table is desired.                * 00039200
*                                                                     * 00039300
*                                                                     * 00039400
*          RCNUM=xrcnum¨                                              * 00039500
*              is the name (RS-type), or address in register          * 00039600
*              (2)-(12), of a required fullword output that will      * 00039700
*              contain the number of entries in the RCTABLE area.     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*      ÝRETCODE=xretcode¨                                             * 00040500
*          is the name (RS-type) of an optional fullword output       * 00040600
*          variable, or register (2)-(12) or (15), into which the     * 00040700
*          return code is to be copied from GPR 15.  If you specify   * 00040800
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00040900
*          the value will be left in GPR 15.                          * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*      ÝRSNCODE=xrsncode¨                                             * 00041500
*          is the name (RS-type) of an optional fullword output       * 00041600
*          variable into which the reason code is to be copied from   * 00041700
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00041800
*          R0 (within or without parentheses), the value will be left * 00041900
*          in GPR 0.                                                  * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00042500
*          is an optional byte input decimal value in the "1-5" range * 00042600
*          that specifies the macro version.  PLISTVER is the only    * 00042700
*          key allowed on the list form of MF and determines which    * 00042800
*          parameter list is generated.  The macro keys associated    * 00042900
*          with each supported version of the macro are listed in     * 00043000
*          MACRO USAGE NOTE 3.  Note that MAX may be specified        * 00043100
*          instead of a number, and the parameter list will be of the * 00043200
*          largest size currently supported. This size may grow from  * 00043300
*          release to release (thus possibly affecting the amount of  * 00043400
*          storage needed by your program).  If your program can      * 00043500
*          tolerate this, IBM recommends that you always specify MAX  * 00043600
*          when creating the list form parameter list as that will    * 00043700
*          ensure that the list form parameter list is always long    * 00043800
*          enough to hold whatever parameters might be specified on   * 00043900
*          the execute form.                                          * 00044000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00044100
*          default is the lowest version which allows all of the      * 00044200
*          parameters specified on the invocation to be processed.    * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*      ÝMF=»S!L!M!Eº¨                                                 * 00044800
*          is an optional keyword input which specifies the macro     * 00044900
*          form.                                                      * 00045000
*          DEFAULT: S                                                 * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*          ÝMF=S¨                                                     * 00045400
*              specifies the standard form of the macro.  The "S"     * 00045500
*              form generates code to put the parameters into an      * 00045600
*              in-line parameter list and invoke the desired service. * 00045700
*              Full checking for required macro keys is done along    * 00045800
*              with supplying defaults for omitted optional           * 00045900
*              parameters.                                            * 00046000
*                                                                     * 00046100
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00046200
*              specifies the list form of the macro.  The "L" form    * 00046300
*              defines an area to be used for the parameter list.     * 00046400
*              Only the PLISTVER key may be specified on the          * 00046500
*              invocation.  All other macro parameters are flagged as * 00046600
*              errors.  If PLISTVER is not specified, the original    * 00046700
*              parameter list definition is used.                     * 00046800
*                                                                     * 00046900
*            ,xmfctrl                                                 * 00047000
*              is a required input.  It is the name of a storage area * 00047100
*              for the parameter list.                                * 00047200
*                                                                     * 00047300
*            »,xmfattr!0Dº                                            * 00047400
*              is an optional 60 character input string that varies   * 00047500
*              from 1 to 60 characters. Use it to force boundary      * 00047600
*              alignment of the parameter list. Use only 0F or 0D.    * 00047700
*              DEFAULT: 0D which forces the parameter list to a       * 00047800
*              doubleword boundary.                                   * 00047900
*                                                                     * 00048000
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00048100
*              specifies the modify form of the macro.  The "M" form  * 00048200
*              generates code to put the parameters into the          * 00048300
*              parameter list specified by xmfctrl.                   * 00048400
*                                                                     * 00048500
*            ,xmfctrl                                                 * 00048600
*              is a required input.  It is the name (RS-type), or     * 00048700
*              address in register (1)-(12), of a storage area for    * 00048800
*              the parameter list.                                    * 00048900
*                                                                     * 00049000
*            »,COMPLETE!NOCHECKº¨                                     * 00049100
*              is an optional keyword input which specifies the       * 00049200
*              degree of macro parameter syntax checking.             * 00049300
*              DEFAULT: COMPLETE                                      * 00049400
*                                                                     * 00049500
*                                                                     * 00049600
*              COMPLETE                                               * 00049700
*                  Checking for required macro keys is done and       * 00049800
*                  defaults are supplied for omitted optional         * 00049900
*                  parameters.  (See Macro Usage Note 2).             * 00050000
*                                                                     * 00050100
*              NOCHECK                                                * 00050200
*                  Checking for required macro keys is not done nor   * 00050300
*                  are defaults supplied for omitted optional         * 00050400
*                  parameters.                                        * 00050500
*                                                                     * 00050600
*                                                                     * 00050700
*                                                                     * 00050800
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00050900
*              specifies the execute form of the macro.  The "E" form * 00051000
*              generates code to put the parameters into the          * 00051100
*              parameter list specified by xmfctrl and invoke the     * 00051200
*              desired service.                                       * 00051300
*                                                                     * 00051400
*            ,xmfctrl                                                 * 00051500
*              is a required input.  It is the name (RS-type), or     * 00051600
*              address in register (1)-(12), of a storage area for    * 00051700
*              the parameter list.                                    * 00051800
*                                                                     * 00051900
*            »,COMPLETE!NOCHECKº                                      * 00052000
*              is an optional keyword input which specifies the       * 00052100
*              degree of macro parameter syntax checking.             * 00052200
*              DEFAULT: COMPLETE                                      * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*              COMPLETE                                               * 00052600
*                  Checking for required macro keys is done and       * 00052700
*                  defaults are supplied for omitted optional         * 00052800
*                  parameters.  (See Macro Usage Note 2).             * 00052900
*                                                                     * 00053000
*              NOCHECK                                                * 00053100
*                  Checking for required macro keys is not done nor   * 00053200
*                  are defaults supplied for omitted optional         * 00053300
*                  parameters.                                        * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*                                                                     * 00054000
*                                                                     * 00054100
*01* ABEND CODES:  None.                                              * 00054200
*                                                                     * 00054300
*01* RETURN CODES:                                                    * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*            0    ATRSRV_SUCCESS - Request completed successfully.    * 00054700
*                                                                     * 00054800
*            4    ATRSRV_WARNING - Request completed with a warning   * 00054900
*                 condition.                                          * 00055000
*                                                                     * 00055100
*            8    ATRSRV_FAILURE - Request failed.                    * 00055200
*                                                                     * 00055300
*                                                                     * 00055400
*                                                                     * 00055500
*01* REASON CODES:                                                    * 00055600
*                                                                     * 00055700
*       REASON    RETURN                                              * 00055800
*       CODE      CODE      DESCRIPTION                               * 00055900
*       ××××××××  ××××××××  ×××××××××××                               * 00056000
*                                                                     * 00056100
*                                                                     * 00056200
*              1  8         EQUATE SYMBOL: ATRSRV_UR_NOT_IN_DOUBT     * 00056300
*                                                                     * 00056400
*                           MEANING: The UR state is not IN-DOUBT.    * 00056500
*                                                                     * 00056600
*                           ACTION: Specify the correct UR and retry  * 00056700
*                           the request.                              * 00056800
*                                                                     * 00056900
*              2  8         EQUATE SYMBOL: ATRSRV_RM_IS_ACTIVE        * 00057000
*                                                                     * 00057100
*                           MEANING: You specified REMOVINT or        * 00057200
*                           REMOVRM but named a resource manager that * 00057300
*                           is currently active with RRS.             * 00057400
*                                                                     * 00057500
*                           ACTION: Verify that you specified the     * 00057600
*                           correct resource manager.  You might need * 00057700
*                           to stop the resource manager, or make it  * 00057800
*                           inactive with RRS/MVS.  When the resource * 00057900
*                           manager is inactive, retry the request.   * 00058000
*                                                                     * 00058100
*              3  8         EQUATE SYMBOL: ATRSRV_RRS_NOT_ACTIVE      * 00058200
*                                                                     * 00058300
*                           MEANING: The ATRSRV service is not        * 00058400
*                           available. RRS/MVS is not active on this  * 00058500
*                           system.                                   * 00058600
*                                                                     * 00058700
*                           ACTION: Retry the request when RRS/MVS is * 00058800
*                           active.                                   * 00058900
*                                                                     * 00059000
*              4  8         EQUATE SYMBOL: ATRSRV_UR_HAS_DSRM         * 00059100
*                                                                     * 00059200
*                           MEANING: You specified REMOVINT and named * 00059300
*                           a distributed sync-point resource manager * 00059400
*                           (DSRM), but the state of the UR you       * 00059500
*                           specified is IN-DOUBT.                    * 00059600
*                                                                     * 00059700
*                           ACTION: Before you can remove the         * 00059800
*                           interest for the DSRM, the UR state must  * 00059900
*                           be resolved or you must remove all        * 00060000
*                           resource manager interests for the        * 00060100
*                           IN-DOUBT UR.                              * 00060200
*                                                                     * 00060300
*              5  8         EQUATE SYMBOL: ATRSRV_BAD_REMOVINT_PARM   * 00060400
*                                                                     * 00060500
*                           MEANING: You specified REMOVINT but did   * 00060600
*                           not specify either RMNAME or URID.        * 00060700
*                                                                     * 00060800
*                           ACTION: Specify one or both of the        * 00060900
*                           missing keywords and retry the request.   * 00061000
*                                                                     * 00061100
*              6  8         EQUATE SYMBOL: ATRSRV_URID_NOT_VALID      * 00061200
*                                                                     * 00061300
*                           MEANING: You specified a UR identifier    * 00061400
*                           that is either not valid or the           * 00061500
*                           associated UR no longer exists.           * 00061600
*                                                                     * 00061700
*                           ACTION: Verify that you specified the     * 00061800
*                           correct UR identifer.  If you did not     * 00061900
*                           specify the correct UR identifier, do so  * 00062000
*                           and retry the request.  If you did        * 00062100
*                           specify the correct UR identifier, the UR * 00062200
*                           has completed.  Do not retry the request. * 00062300
*                                                                     * 00062400
*              7  8         EQUATE SYMBOL: ATRSRV_RID_NOT_SUPPORTED   * 00062500
*                                                                     * 00062600
*                           MEANING: You specified the UR identifier  * 00062700
*                           for an In-Doubt UR that the system cannot * 00062800
*                           resolve to In-Commit or In-Backout.       * 00062900
*                                                                     * 00063000
*                           ACTION: You must wait for the DSRM to     * 00063100
*                           resolve the In-Doubt condition.           * 00063200
*                                                                     * 00063300
*              8  8         EQUATE SYMBOL: ATRSRV_URID_NOT_FOUND      * 00063400
*                                                                     * 00063500
*                           MEANING: You specified a UR identifier    * 00063600
*                           that the system is unable to find.  The   * 00063700
*                           UR may still exist but RRS is unable to   * 00063800
*                           find the UR.                              * 00063900
*                           This reason code may also be issued when  * 00064000
*                           the request requires a top level URID and * 00064100
*                           a child or subordinate URID was           * 00064200
*                           specified.                                * 00064300
*                                                                     * 00064400
*                           ACTION: Verify that you specified the     * 00064500
*                           correct UR identifer.  If you did not     * 00064600
*                           specify the correct UR identifier, do so  * 00064700
*                           and retry the request.  If you did        * 00064800
*                           specify the correct UR identifier, retry  * 00064900
*                           the request later.                        * 00065000
*                                                                     * 00065100
*              9  8         EQUATE SYMBOL: ATRSRV_NO_UR_FOR_RM        * 00065200
*                                                                     * 00065300
*                           MEANING: You specified URINFO and named a * 00065400
*                           resource manager that does not have any   * 00065500
*                           interests in any URs.                     * 00065600
*                                                                     * 00065700
*                           ACTION: Verify that you provided the      * 00065800
*                           correct resource manager.  If you did not * 00065900
*                           specify the correct resource manager, do  * 00066000
*                           so and retry the request.  If you         * 00066100
*                           expected URs to be returned, you need to  * 00066200
*                           determine why the named resource manager  * 00066300
*                           has no interests in any URs.  Otherwise,  * 00066400
*                           do nothing.                               * 00066500
*                                                                     * 00066600
*             10  8         EQUATE SYMBOL: ATRSRV_NOT_AUTH            * 00066700
*                                                                     * 00066800
*                           MEANING: You are not supervisor state,    * 00066900
*                           system key and the RACF component of the  * 00067000
*                           OS/390 Security Server is not active.     * 00067100
*                                                                     * 00067200
*                           ACTION: Either request activation of the  * 00067300
*                           RACF component of the OS/390 Security     * 00067400
*                           Server and obtain ALTER access to         * 00067500
*                           MVSADMIN.RRS.COMMANDS.gname.sysname or    * 00067600
*                           recode your application to run supervisor * 00067700
*                           state, system key.                        * 00067800
*                                                                     * 00067900
*             11  8         EQUATE SYMBOL: ATRSRV_NOT_SAF_AUTH        * 00068000
*                                                                     * 00068100
*                           MEANING: You do not have ALTER access to  * 00068200
*                           the proper resource for the target system * 00068300
*                           and RRS logging group name.               * 00068400
*                                                                     * 00068500
*                           ACTION: Obtain ALTER access to            * 00068600
*                           MVSADMIN.RRS.COMMANDS.gname.sysname       * 00068700
*                                                                     * 00068800
*             12  8         EQUATE SYMBOL: ATRSRV_RRS_DOWNLEVEL       * 00068900
*                                                                     * 00069000
*                           MEANING: The unit of recovery that was    * 00069100
*                           specified to process contains information * 00069200
*                           that is not understood by this level of   * 00069300
*                           RRS.  This level of RRS is downlevel.     * 00069400
*                                                                     * 00069500
*                           This reason code may also be issued when  * 00069600
*                           an ATRSRV request was processed on a      * 00069700
*                           downlevel version of RRS that does not    * 00069800
*                           understand the request.                   * 00069900
*                                                                     * 00070000
*                           ACTION: The attempt to process this unit  * 00070100
*                           of recovery must be made from a version   * 00070200
*                           of RRS that can process this unit of      * 00070300
*                           recovery.                                 * 00070400
*                                                                     * 00070500
*                           Route the ATRSRV request to a RRS system  * 00070600
*                           that does support the request.            * 00070700
*                                                                     * 00070800
*             15  8         EQUATE SYMBOL: ATRSRV_GNAME_INVALID       * 00070900
*                                                                     * 00071000
*                           MEANING: The value specified for the      * 00071100
*                           GNAME parameter is not valid.             * 00071200
*                                                                     * 00071300
*                           ACTION: Correct the GNAME value and retry * 00071400
*                           the request.                              * 00071500
*                                                                     * 00071600
*             16  8         EQUATE SYMBOL: ATRSRV_SYSNAME_INVALID     * 00071700
*                                                                     * 00071800
*                           MEANING: The value specified for the      * 00071900
*                           SYSNAME parameter is not valid.           * 00072000
*                                                                     * 00072100
*                           ACTION: Correct the SYSNAME value and     * 00072200
*                           retry the request.                        * 00072300
*                                                                     * 00072400
*             22  8         EQUATE SYMBOL: ATRSRV_INSTANCE_FAILURE    * 00072500
*                                                                     * 00072600
*                           MEANING: An error occurred processing a   * 00072700
*                           remote request. Your RCTABLE will contain * 00072800
*                           the failing service identifer, return     * 00072900
*                           code and reason code.                     * 00073000
*                                                                     * 00073100
*                           Service identifers:                       * 00073200
*                                                                     * 00073300
*                                                                     * 00073400
*                           o   1 - IXCMSGO macro interface           * 00073500
*                                                                     * 00073600
*                           o   2 - IXCMSGI macro interface           * 00073700
*                                                                     * 00073800
*                                                                     * 00073900
*                           Any other value is an internal error and  * 00074000
*                           should be reported to the IBM Support     * 00074100
*                           center.                                   * 00074200
*                                                                     * 00074300
*                           ACTION: Fix the error(s) noted in the     * 00074400
*                           RCTABLE and retry the request.            * 00074500
*                                                                     * 00074600
*             23  4         EQUATE SYMBOL: ATRSRV_REMOTE_WARNING      * 00074700
*                                                                     * 00074800
*                           MEANING: An error occurred while          * 00074900
*                           processing a remote request that did not  * 00075000
*                           effect the processing of the request.     * 00075100
*                           Your RCTABLE, if one was provided, will   * 00075200
*                           contain detailed error information.       * 00075300
*                                                                     * 00075400
*                           ACTION: Fix the error(s) noted in the     * 00075500
*                           RCTABLE and retry the request.            * 00075600
*                                                                     * 00075700
*             24  8         EQUATE SYMBOL: ATRSRV_REMOTE_ERROR        * 00075800
*                                                                     * 00075900
*                           MEANING: An error occurred while          * 00076000
*                           processing a remote request.  The request * 00076100
*                           was not performed.  Your RCTABLE, if one  * 00076200
*                           was provided, will contain detailed error * 00076300
*                           information.                              * 00076400
*                                                                     * 00076500
*                           ACTION: Fix the error(s) noted in the     * 00076600
*                           RCTABLE and retry the request.            * 00076700
*                                                                     * 00076800
*             25  8         EQUATE SYMBOL: ATRSRV_RESP_NOT_RECEIVED   * 00076900
*                                                                     * 00077000
*                           MEANING: Response not received from the   * 00077100
*                           remote system.  No information was        * 00077200
*                           returned.                                 * 00077300
*                                                                     * 00077400
*                           ACTION: Retry the request.                * 00077500
*                                                                     * 00077600
*             26  8         EQUATE SYMBOL: ATRSRV_REMOTE_NOT_ACTIVE   * 00077700
*                                                                     * 00077800
*                           MEANING: The remote system is not active. * 00077900
*                           No information was returned.              * 00078000
*                                                                     * 00078100
*                           ACTION: Retry the request once the remote * 00078200
*                           system is available.                      * 00078300
*                                                                     * 00078400
*             27  8         EQUATE SYMBOL: ATRSRV_UR_HAS_NO_INT       * 00078500
*                                                                     * 00078600
*                           MEANING: The target UR for a remove       * 00078700
*                           interest request has no interests. The    * 00078800
*                           request is rejected.                      * 00078900
*                                                                     * 00079000
*                           ACTION: Specify the correct UR and retry  * 00079100
*                           the request.                              * 00079200
*                                                                     * 00079300
*             28  8         EQUATE SYMBOL: ATRSRV_UR_NOT_TOP          * 00079400
*                                                                     * 00079500
*                           MEANING: The requested action can only be * 00079600
*                           performed on a top-level UR, but you      * 00079700
*                           specified a cascaded UR. The request is   * 00079800
*                           rejected.                                 * 00079900
*                                                                     * 00080000
*                           ACTION: Specify the top-level UR          * 00080100
*                           associated with the cascaded UR and and   * 00080200
*                           retry the request.                        * 00080300
*                                                                     * 00080400
*             29  8         EQUATE SYMBOL: ATRSRV_RIN_NOT_SUPPORTED   * 00080500
*                                                                     * 00080600
*                           MEANING: RRS is unable to process your    * 00080700
*                           remove interest request because the       * 00080800
*                           coordinator system cannot be found. The   * 00080900
*                           request is rejected.                      * 00081000
*                                                                     * 00081100
*                           ACTION: If the URID is in the restart     * 00081200
*                           log, retry the remove interest request.   * 00081300
*                                                                     * 00081400
*             30  8         EQUATE SYMBOL: ATRSRV_RMStillHasInterests * 00081500
*                                                                     * 00081600
*                           MEANING: The specified Resource Manager   * 00081700
*                           cannot be deleted since it has            * 00081800
*                           outstanding interest in one or more URs.  * 00081900
*                                                                     * 00082000
*                           ACTION: If the Resource Manager must be   * 00082100
*                           deleted, the interests in all URs must be * 00082200
*                           removed prior to deleting the Resource    * 00082300
*                           Manager.                                  * 00082400
*                                                                     * 00082500
*             31  8         EQUATE SYMBOL: ATRSRV_RMIsNotKnownToRRS   * 00082600
*                                                                     * 00082700
*                           MEANING: The specified Resource Manager   * 00082800
*                           could not be found in the Resource        * 00082900
*                           Manager Data log or on any system in the  * 00083000
*                           RRS logging group.  Either the Resource   * 00083100
*                           Manager has already been deleted or the   * 00083200
*                           name was entered incorrectly.             * 00083300
*                                                                     * 00083400
*                           ACTION: Make sure the Resource Manager's  * 00083500
*                           name is spelled correctly. Otherwise the  * 00083600
*                           Resource Manager is deleted.              * 00083700
*                                                                     * 00083800
*             32  4         EQUATE SYMBOL:                            * 00083900
*                           ATRSRV_DeleteRMObjectNotSupported         * 00084000
*                                                                     * 00084100
*                           MEANING: The specified Resource Manager   * 00084200
*                           was deleted from the Resource Manager     * 00084300
*                           logs but one or more systems in the RRS   * 00084400
*                           logging group do not support the Delete   * 00084500
*                           RM (REMOVRM) function. If the Resource    * 00084600
*                           Manager is on those systems, that         * 00084700
*                           Resource Manager will persist.            * 00084800
*                                                                     * 00084900
*                           ACTION: None, the Resource Manager cannot * 00085000
*                           be delete from systems that do not        * 00085100
*                           support Delete RM (REMOVRM) process.      * 00085200
*                                                                     * 00085300
*             33  8         EQUATE SYMBOL:                            * 00085400
*                           ATRSRV_ErrorDeleteingRMLogEntry           * 00085500
*                                                                     * 00085600
*                           MEANING: The specified Resource Manager   * 00085700
*                           was not deleted due to errors deleting    * 00085800
*                           the Resource Manager from the Resource    * 00085900
*                           Manager logs.                             * 00086000
*                                                                     * 00086100
*                           ACTION: Correct the problem and retry the * 00086200
*                           Delete RM (REMOVRM) request.              * 00086300
*                                                                     * 00086400
*             34  8         EQUATE SYMBOL:                            * 00086500
*                           ATRSRV_DeleteRMNotSupported               * 00086600
*                                                                     * 00086700
*                           MEANING: The specified Resource Manager   * 00086800
*                           is on a system that does not support the  * 00086900
*                           Delete RM (REMOVRM) function.             * 00087000
*                                                                     * 00087100
*                           ACTION: None, the Resource Manager cannot * 00087200
*                           be delete.                                * 00087300
*                                                                     * 00087400
*             35  8         EQUATE SYMBOL: ATRSRV_RM_NOT_FOUND        * 00087500
*                                                                     * 00087600
*                           MEANING: The requested Resource Manager   * 00087700
*                           could not be found on the specified       * 00087800
*                           system in the RRS logging group.  Either  * 00087900
*                           the Resource Manager is not currently     * 00088000
*                           defined on the specified system or it was * 00088100
*                           entered incorrectly.                      * 00088200
*                                                                     * 00088300
*                           ACTION: Make sure the Resource Manager's  * 00088400
*                           name is spelled correctly.  Otherwise,    * 00088500
*                           determine where the Resource Manager is   * 00088600
*                           currently defined and perform the RM      * 00088700
*                           Unregister request on that system.        * 00088800
*                                                                     * 00088900
*             36  8         EQUATE SYMBOL: ATRSRV_RM_STILL_REGISTERED * 00089000
*                                                                     * 00089100
*                           MEANING: The requested Resource Manager   * 00089200
*                           is still registered with Registration     * 00089300
*                           Services. To unregister a Resource        * 00089400
*                           Manager with RRS, it must be unregistered * 00089500
*                           with Registration Services.               * 00089600
*                                                                     * 00089700
*                           ACTION: Issue the request again after the * 00089800
*                           resource manager has become unregistered  * 00089900
*                           with Registration Services.               * 00090000
*                                                                     * 00090100
*             37  8         EQUATE SYMBOL:                            * 00090200
*                           ATRSRV_RM_UNREGISTERED_NOT_ALLOWED        * 00090300
*                                                                     * 00090400
*                           MEANING: A Resource Manager in the Reset  * 00090500
*                           or Unset state is already considered      * 00090600
*                           unregistered with RRS so it cannot be     * 00090700
*                           unregistered again.                       * 00090800
*                                                                     * 00090900
*                           ACTION: None, the Resource Manager is     * 00091000
*                           already considered unregistered.          * 00091100
*                                                                     * 00091200
*             38  8         EQUATE SYMBOL: ATRSRV_UR_Not_In_Forget    * 00091300
*                                                                     * 00091400
*                           MEANING: The UR state is not IN-FORGET.   * 00091500
*                                                                     * 00091600
*                           ACTION: Specify the correct UR and retry  * 00091700
*                           the request.                              * 00091800
*                                                                     * 00091900
*             39  8         EQUATE SYMBOL: ATRSRV_Not_Server_DSRM     * 00092000
*                                                                     * 00092100
*                           MEANING: The resource manager does not    * 00092200
*                           have the server distributed syncpoint     * 00092300
*                           resource manager role for the unit of     * 00092400
*                           recovery. The system rejects this service * 00092500
*                           request.                                  * 00092600
*                                                                     * 00092700
*                           ACTION: Check the calling program for a   * 00092800
*                           probable coding error.                    * 00092900
*                                                                     * 00093000
*           4095  8         EQUATE SYMBOL: ATRSRV_UNEXPECTED_ERROR    * 00093100
*                                                                     * 00093200
*                           MEANING: An unexpected error occurred     * 00093300
*                           while processing the request.             * 00093400
*                                                                     * 00093500
*                           ACTION: Contact your system support.      * 00093600
*                                                                     * 00093700
*                                                                     * 00093800
*                                                                     * 00093900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00094000
*                                                                     * 00094100
*02*   PROCESSOR:  ASSEM                                              * 00094200
*                                                                     * 00094300
*01* COMPONENT:  SCRRS                                                * 00094400
*                                                                     * 00094500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00094600
*                                                                     * 00094700
*01* EXAMPLES:                                                        * 00094800
*    EXAMPLE 1                                                        * 00094900
*                                                                     * 00095000
*    OPERATION: Commit an In-Doubt UR                                 * 00095100
*                                                                     * 00095200
*               ATRSRV   REQUEST=COMMIT,URID=MYURID                   * 00095300
*      *                                                              * 00095400
*      * INPUT VALUES                                                 * 00095500
*      *                                                              * 00095600
*      MYURID   DC     XL16'123456789ABCDEF123456789ABCDEF' UR IDENTI * 00095700
*      FIER                                                           * 00095800
*      *                                                              * 00095900
*      * REQUIRED MAPPINGS                                            * 00096000
*      *                                                              * 00096100
*               CVT DSECT=YES                                         * 00096200
*               IHAECVT                                               * 00096300
*               ATRFZSRV                                              * 00096400
*                                                                     * 00096500
*    EXAMPLE 2                                                        * 00096600
*                                                                     * 00096700
*    OPERATION: Backout an In-Doubt UR                                * 00096800
*                                                                     * 00096900
*               ATRSRV   REQUEST=COMMIT,URID=MYURID                   * 00097000
*      *                                                              * 00097100
*      * INPUT VALUES                                                 * 00097200
*      *                                                              * 00097300
*      MYURID   DC     XL16'123456789ABCDEF123456789ABCDEF' UR IDENTI * 00097400
*      FIER                                                           * 00097500
*      *                                                              * 00097600
*      * REQUIRED MAPPINGS                                            * 00097700
*      *                                                              * 00097800
*               CVT DSECT=YES                                         * 00097900
*               IHAECVT                                               * 00098000
*               ATRFZSRV                                              * 00098100
*                                                                     * 00098200
*    EXAMPLE 3                                                        * 00098300
*                                                                     * 00098400
*    OPERATION: Remove all resource manager interests in a UR         * 00098500
*                                                                     * 00098600
*               ATRSRV   REQUEST=REMOVINT,URID=MYURID                 * 00098700
*      *                                                              * 00098800
*      * INPUT VALUES                                                 * 00098900
*      *                                                              * 00099000
*      MYURID   DC     XL16'123456789ABCDEF123456789ABCDEF' UR IDENTI * 00099100
*      FIER                                                           * 00099200
*      *                                                              * 00099300
*      * REQUIRED MAPPINGS                                            * 00099400
*      *                                                              * 00099500
*               CVT DSECT=YES                                         * 00099600
*               IHAECVT                                               * 00099700
*               ATRFZSRV                                              * 00099800
*                                                                     * 00099900
*    EXAMPLE 4                                                        * 00100000
*                                                                     * 00100100
*    OPERATION: Remove resource manager UTRICK interests in a UR      * 00100200
*                                                                     * 00100300
*               ATRSRV   REQUEST=REMOVINT,URID=MYURID,RMNAME=MYRM     * 00100400
*      *                                                              * 00100500
*      * INPUT VALUES                                                 * 00100600
*      *                                                              * 00100700
*      MYRM     DC     CL32'UTRICK'             RESOURCE MANAGER NAME * 00100800
*      MYURID   DC     XL16'123456789ABCDEF123456789ABCDEF' UR IDENTI * 00100900
*      FIER                                                           * 00101000
*      *                                                              * 00101100
*      * REQUIRED MAPPINGS                                            * 00101200
*      *                                                              * 00101300
*               CVT DSECT=YES                                         * 00101400
*               IHAECVT                                               * 00101500
*               ATRFZSRV                                              * 00101600
*                                                                     * 00101700
*    EXAMPLE 5                                                        * 00101800
*                                                                     * 00101900
*    OPERATION: Remove resource manager UTRICK interests in all URs   * 00102000
*                                                                     * 00102100
*               ATRSRV   REQUEST=REMOVINT,RMNAME=MYRM                 * 00102200
*      *                                                              * 00102300
*      * INPUT VALUES                                                 * 00102400
*      *                                                              * 00102500
*      MYRM     DC     CL32'UTRICK'                 RESOURCE MANAGER  * 00102600
*      NAME                                                           * 00102700
*      *                                                              * 00102800
*      * REQUIRED MAPPINGS                                            * 00102900
*      *                                                              * 00103000
*               CVT DSECT=YES                                         * 00103100
*               IHAECVT                                               * 00103200
*               ATRFZSRV                                              * 00103300
*                                                                     * 00103400
*                                                                     * 00103500
*01* MACRO USAGE NOTES:                                               * 00103600
*                                                                     * 00103700
*                                                                     * 00103800
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00103900
*        global macro variable.  Any value other than 'NO' will       * 00104000
*        result in the macro expansion being printed.  The default is * 00104100
*        'YES'.  The following examples illustrate how the ZPRINT     * 00104200
*        variable should be set.                                      * 00104300
*                                                                     * 00104400
*                    GBLC &ZPRINT                                     * 00104500
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00104600
*                                                                     * 00104700
*                                                                     * 00104800
*    2.  When using the NOCHECK option in conjunction with the Modify * 00104900
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00105000
*        Modify   or  Execute  form  invocation  which  specifies  or * 00105100
*        defaults  to  the  COMPLETE  option.   This insures that the * 00105200
*        parameter  list  is  initialized completely.   The parameter * 00105300
*        list  field which identifies the version number of the macro * 00105400
*        is only set when the Standard form or the Complete option of * 00105500
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00105600
*        explicitly  specified.  Be sure that the resulting parameter * 00105700
*        list version number covers all the keys that you use.        * 00105800
*                                                                     * 00105900
*                                                                     * 00106000
*    3.  The  ATRSRV  macro supports multiple versions. The macro key * 00106100
*        list  below  contains the version level in which the key was * 00106200
*        first  introduced.  Positionals  are  identified by the word * 00106300
*        'Positional'  followed by the numeric value of its position. * 00106400
*        Nested  positionals  are  preceded  by their outer key.  The * 00106500
*        lowest value represents the original version and the highest * 00106600
*        value  represents  the  most  recent  version  of the ATRSRV * 00106700
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00106800
*        least  as high as the highest version number of all the keys * 00106900
*        being used.                                                  * 00107000
*                                                                     * 00107100
*        VERSION   KEY                                                * 00107200
*                                                                     * 00107300
*              1      REQUEST                                         * 00107400
*                     RMNAME                                          * 00107500
*                     URID                                            * 00107600
*              2      GNAME                                           * 00107700
*                     RCNUM                                           * 00107800
*                     RCTABLE                                         * 00107900
*                     SYSNAME                                         * 00108000
*                                                                     * 00108100
*                                                                     * 00108200
*                                                                     * 00108300
*01* CHANGE ACTIVITY:                                                 * 00108400
*                                                                     * 00108500
*   Flag LineItem  FMID    Date   ID    Comment                       * 00108600
*                                                                     * 00108700
*    $L0=RRSCS    HBB6603 960229 PD00EV:  RRS Initial Release         * 00108800
*    $P1=PQC2896  HBB6603 961118 PD00EV:  Fix ASM interface and       * 00108900
*                                         update documentation        * 00109000
*    $L1=RRSSM    HBB6608 981001 PDEV:  RRS Sysplex Systems           * 00109100
*                                         Management                  * 00109200
*    $L2=RRSSM    HBB6608 981101 PDEV:  RRS Sysplex Systems           * 00109300
*                                         Management                  * 00109400
*    $L3=RRSSM    HBB6608 981120 PDEV:  RRS Sysplex Systems           * 00109500
*                                         Management                  * 00109600
*    $P2=PWK0869  HBB6608 990326 PDEV:  Fix reason code documentation * 00109700
*    $L4=RRSDRM   HBB7730 041004 B7HGBL:  Delete old RMs              * 00109800
*    $P3=ME04430  HBB7730 060410 B7HGBL:  Process Meta Data GAP error * 00109900
*                                         - TRSQ OA16244              * 00110000
*    $01=OA16904  HBB7730 060614 B7HGBL:  Added more details to       * 00110100
*                                         ATRSRV_RRS_DOWNLEVEL        * 00110200
*                                         description                 * 00110300
*    $L5=RRSRMU   HBB7740 060619 B7HGBL:  RM UnRegister Support       * 00110400
*    $L6=RRSFGT   HBB7750 071128 B7HGBL:  ATRSRV Forget support       * 00110500
****** END OF SPECIFICATIONS *****************************************/ 00110600
*/********************************************************************* 00110700
         MACRO                                                          00110800
&XLABEL  ATRSRV &REQUEST=,&RMNAME=,&URID=,&GNAME=,&SYSNAME=,&RCTABLE=, *00110900
               &RCNUM=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=              00111000
.*                                                                      00111100
*              MACDATE -2007/11/28-<5>                                  00111200
.*                                                                      00111300
.*******************************************************************    00111400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00111500
.*******************************************************************    00111600
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00111700
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00111800
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00111900
.*                                                                      00112000
              GBLC  &ZATRSRV    YES=MACRO USED AT LEAST ONCE            00112100
.*******************************************************************    00112200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00112300
.*******************************************************************    00112400
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00112500
              LCLC  &ZCNDX      SYSNDX CHARACTERS                       00112600
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00112700
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00112800
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00112900
              LCLA  &ZAWRK      USED AS A WORK AREA                     00113000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00113100
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00113200
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00113300
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00113400
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00113500
              LCLC  &ZMAC_G     "G" or null                             00113600
&ZMAC_G       SETC  ''                                                  00113700
              LCLC  &ZMAC_LR                                            00113800
&ZMAC_LR      SETC  'LR'                                                00113900
              LCLC  &ZMAC_L                                             00114000
&ZMAC_L       SETC  'L'                                                 00114100
              LCLC  &ZMAC_ST                                            00114200
&ZMAC_ST      SETC  'ST'                                                00114300
              LCLA  &ZMACRET    MACRO RETURN CODE                       00114400
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00114500
.*                                                                      00114600
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00114700
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00114800
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00114900
              LCLC  &ZENDBASEPL                 End of base PL          00115000
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00115100
.*******************************************************************    00115200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00115300
.*******************************************************************    00115400
              LCLA  &ZI         INDEX FOR ARRAY                         00115500
              LCLA  &ZJ         INDEX FOR PARMS                         00115600
              LCLA  &ZK         INDEX FOR PARSE                         00115700
              LCLA  &ZLO        LOW RANGE VALUE                         00115800
              LCLA  &ZHI        HIGH RANGE VALUE                        00115900
              LCLC  &ZW         WORK AREA FOR PARM                      00116000
.********************************************************************   00116100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00116200
.********************************************************************   00116300
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00116400
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00116500
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00116600
              GBLC  &SYSAM64    SYSSTATE AMODE64                        00116700
.*                                                                      00116800
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00116900
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00117000
              SPLEVEL  TEST                                             00117100
.ZSYS2        ANOP  ,                                                   00117200
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00117300
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00117400
              SYSSTATE TEST                                             00117500
              AGO   .ZSYS4                                              00117600
.ZSYS3        ANOP  ,                                                   00117700
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00117800
.ZSYS4        ANOP  ,                                                   00117900
.*******************************************************************    00118000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00118100
.*******************************************************************    00118200
              LCLC  &XREQUEST   ++ VALUE                                00118300
              LCLC  &XRMNAME    ++ NAME                                 00118400
              LCLC  &XURID      ++ NAME                                 00118500
              LCLC  &XGNAME     ++ NAME                                 00118600
              LCLC  &XSYSNAME   ++ NAME                                 00118700
              LCLC  &XRCTABLE   ++ NAME                                 00118800
              LCLC  &XRCNUM     ++ NAME                                 00118900
              LCLC  &XRETCODE   ++ NAME                                 00119000
              LCLC  &XRSNCODE   ++ NAME                                 00119100
              LCLA  &XPLISTVER  ++ VALUE                                00119200
              LCLC  &XMF        ++ VALUE                                00119300
              LCLC  &XMFCTRL    ++ NAME                                 00119400
              LCLC  &XMFATTR    ++ VALUE                                00119500
              LCLC  &XMFSCK     ++ VALUE                                00119600
.*******************************************************************    00119700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00119800
.*******************************************************************    00119900
              LCLC  &ZXREQUEST  ++ INPUT VALUE                          00120000
              LCLC  &ZXRMNAME   ++ INPUT NAME                           00120100
              LCLC  &ZXURID     ++ INPUT NAME                           00120200
              LCLC  &ZXGNAME    ++ INPUT NAME                           00120300
              LCLC  &ZXSYSNAME  ++ INPUT NAME                           00120400
              LCLC  &ZXRCTABLE  ++ INPUT NAME                           00120500
              LCLC  &ZXRCNUM    ++ OUTPUT NAME                          00120600
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00120700
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00120800
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00120900
              LCLC  &ZXMF       ++ INPUT VALUE                          00121000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00121100
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00121200
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00121300
.********************************************************************   00121400
.***AC.PLV01  PROCESS PLISTVER                                      *   00121500
.********************************************************************   00121600
&XPLISTVER      SETA  1                                                 00121700
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00121800
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00121900
&XPLISTVER      SETA  5                                                 00122000
.ZPLV0          ANOP  ,                                                 00122100
.*                                                                      00122200
                AIF   ('&GNAME' EQ '').ZPLV1E                           00122300
                AIF   (&XPLISTVER GE 2).ZPLV1E                          00122400
&XPLISTVER      SETA  2                                                 00122500
.ZPLV1E         ANOP  ,                                                 00122600
.*                                                                      00122700
                AIF   ('&SYSNAME' EQ '').ZPLV2E                         00122800
                AIF   (&XPLISTVER GE 2).ZPLV2E                          00122900
&XPLISTVER      SETA  2                                                 00123000
.ZPLV2E         ANOP  ,                                                 00123100
.*                                                                      00123200
                AIF   ('&RCTABLE' EQ '').ZPLV3E                         00123300
                AIF   (&XPLISTVER GE 2).ZPLV3E                          00123400
&XPLISTVER      SETA  2                                                 00123500
.ZPLV3E         ANOP  ,                                                 00123600
.*                                                                      00123700
                AIF   ('&RCNUM' EQ '').ZPLV4E                           00123800
                AIF   (&XPLISTVER GE 2).ZPLV4E                          00123900
&XPLISTVER      SETA  2                                                 00124000
.ZPLV4E         ANOP  ,                                                 00124100
.*                                                                      00124200
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00124300
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00124400
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00124500
.*-------------------------------------------------------------------   00124600
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00124700
&ZMS            SETC  '"PLISTVER='                                      00124800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00124900
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00125000
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00125100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00125200
                AGO   .ZPVCK2                                           00125300
.ZPVCK3         ANOP  ,                                                 00125400
.*-------------------------------------------------------------------   00125500
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00125600
&ZMS            SETC  '"PLISTVER='                                      00125700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00125800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00125900
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00126000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00126100
                AGO   .ZPVCKE                                           00126200
.ZPVCK2         ANOP  ,                                                 00126300
.*-------------------------------------------------------------------   00126400
&ZCVAL          SETC  '&PLISTVER(1)'                                    00126500
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00126600
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00126700
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00126800
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00126900
                AIF   (&ZN LE 5).ZPVCK4A   NOT HIGH                     00127000
.ZPVCK6         ANOP  ,                                                 00127100
&ZMS            SETC  '"PLISTVER='                                      00127200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00127300
&ZMS            SETC  '&ZMS THE RANGE IS "1-5"'                         00127400
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00127500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00127600
&XPLISTVER      SETA  5                                                 00127700
                AGO   .ZPVCKE                                           00127800
.*-------------------------------------------------------------------   00127900
.ZPVCK4A        ANOP  ,                                                 00128000
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00128100
&ZMS            SETC  'PLISTVER='                                       00128200
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00128300
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00128400
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00128500
                MNOTE 8,' &ZMS IS REQUIRED.'                            00128600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00128700
                AGO   .ZPVCK5                                           00128800
.ZPVCK4         ANOP  ,                                                 00128900
&XPLISTVER      SETA  &PLISTVER(1)                                      00129000
.ZPVCK5         ANOP  ,                                                 00129100
.ZPVCKE         ANOP  ,                                                 00129200
.********************************************************************   00129300
.***AG.MF01 PROCESS MF MACRO FORMS                                      00129400
.********************************************************************   00129500
              ACTR  10000                                               00129600
.*------------------------------------------------------------------    00129700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129800
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00129900
.*-------------------------------------------------------------------   00130000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130100
.ZG54         ANOP  ,                                                   00130200
&ZTLC         SETC 'S'                                                  00130300
              AIF   ('&MF(1)' NE '&ZTLC').ZG55                          00130400
&XMF          SETC  'S'         SET KEYWORD                             00130500
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00130600
              AIF   (N'&MF LE 1).ZG54A          CK NUM                  00130700
&ZMS          SETC  '"MF='                                              00130800
&ZMS          SETC  '&ZMS.&MF"'                                         00130900
&ZMS          SETC  '&ZMS "MF"'                                         00131000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00131100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131200
.ZG54A        ANOP  ,                                                   00131300
.*-------------------------------------------------------------------   00131400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00131500
.ZG55         ANOP  ,                                                   00131600
&ZTLC         SETC 'L'                                                  00131700
              AIF   ('&MF(1)' NE '&ZTLC').ZG62                          00131800
&XMF          SETC  'L'         SET KEYWORD                             00131900
              AIF   (N'&MF LE 3).ZG55A          CK NUM                  00132000
&ZMS          SETC  '"MF='                                              00132100
&ZMS          SETC  '&ZMS.&MF"'                                         00132200
&ZMS          SETC  '&ZMS "MF"'                                         00132300
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00132400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00132500
.ZG55A        ANOP  ,                                                   00132600
.*-------------------------------------------------------------------   00132700
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00132800
              AIF   (N'&SYSLIST NE 0).ZG55B     POSITIONALS?            00132900
              AIF   ('&REQUEST' NE '').ZG55B    KEYS?                   00133000
              AIF   ('&RMNAME' NE '').ZG55B     KEYS?                   00133100
              AIF   ('&URID' NE '').ZG55B       KEYS?                   00133200
              AIF   ('&GNAME' NE '').ZG55B      KEYS?                   00133300
              AIF   ('&SYSNAME' NE '').ZG55B    KEYS?                   00133400
              AIF   ('&RCTABLE' NE '').ZG55B    KEYS?                   00133500
              AIF   ('&RCNUM' NE '').ZG55B      KEYS?                   00133600
              AIF   ('&RETCODE' NE '').ZG55B    KEYS?                   00133700
              AIF   ('&RSNCODE' NE '').ZG55B    KEYS?                   00133800
              AGO    .ZG55C     INVOCATION OKAY                         00133900
.ZG55B        ANOP  ,                                                   00134000
&ZMS          SETC  'THE "L" FORM OF "MF"'                              00134100
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00134200
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00134300
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00134400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00134500
.ZG55C        ANOP  ,                                                   00134600
.*-------------------------------------------------------------------   00134700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00134800
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00134900
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00135000
              AIF   (N'&MF(2) GT 1).ZG57B       MULTI PARMS             00135100
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00135200
.ZG57B        AIF   (K'&MF(2) GT 0).ZG57C                               00135300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00135400
&ZMS          SETC  'WHEN "L" IS SPECIFIED'                             00135500
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00135600
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00135700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00135800
.ZG57C        ANOP  ,                                                   00135900
.*-------------------------------------------------------------------   00136000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00136100
              AIF   (K'&ZXMFCTRL LE 0).ZG57P    NOT I/O                 00136200
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG57P                      00136300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00136400
&ZMS          SETC  '"MF='                                              00136500
&ZMS          SETC  '&ZMS.&MF"'                                         00136600
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00136700
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00136800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00136900
.ZG57P        ANOP  ,                                                   00137000
.*-------------------------------------------------------------------   00137100
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00137200
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00137300
&XMFATTR      SETC  '0D'                                                00137400
              AIF   (K'&MF(3) LE 0).ZG60B       PARM                    00137500
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00137600
              AIF   (N'&MF(3) GT 1).ZG60B       MULTI                   00137700
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00137800
.ZG60B        ANOP  ,                                                   00137900
.*-------------------------------------------------------------------   00138000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00138100
              AIF   (K'&ZXMFATTR LE 0).ZG60P    NOT I/O                 00138200
              AIF   ('&XMFATTR'(1,1) NE '(').ZG60P                      00138300
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00138400
&ZMS          SETC  '"MF='                                              00138500
&ZMS          SETC  '&ZMS.&MF"'                                         00138600
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00138700
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00138800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00138900
.ZG60P        ANOP  ,                                                   00139000
.*-------------------------------------------------------------------   00139100
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00139200
              AIF   (K'&ZXMFATTR LE 0).ZG60S    NOT I/O                 00139300
              AIF   (K'&XMFATTR LE 60).ZG60S    LNG OK                  00139400
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00139500
&ZMS          SETC  '"MF='                                              00139600
&ZMS          SETC  '&ZMS.&MF"'                                         00139700
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00139800
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00139900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00140000
.ZG60S        ANOP  ,                                                   00140100
.*-------------------------------------------------------------------   00140200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140300
.ZG62         ANOP  ,                                                   00140400
&ZTLC         SETC 'M'                                                  00140500
              AIF   ('&MF(1)' NE '&ZTLC').ZG71                          00140600
&XMF          SETC  'M'         SET KEYWORD                             00140700
              AIF   (N'&MF LE 3).ZG62A          CK NUM                  00140800
&ZMS          SETC  '"MF='                                              00140900
&ZMS          SETC  '&ZMS.&MF"'                                         00141000
&ZMS          SETC  '&ZMS "MF"'                                         00141100
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00141200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141300
.ZG62A        ANOP  ,                                                   00141400
.*-------------------------------------------------------------------   00141500
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00141600
              AIF   ('&RCNUM' NE '').ZG62B      OUTPUT?                 00141700
              AGO    .ZG62C     INVOCATION OKAY                         00141800
.ZG62B        ANOP  ,                                                   00141900
&ZMS          SETC  'THE "M" FORM OF "MF" CANNOT'                       00142000
&ZMS          SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'             00142100
&ZMS          SETC  '&ZMS SPECIFIED ON THE INVOCATION:'                 00142200
&ZMS          SETC  '&ZMS "RCNUM"'                                      00142300
              MNOTE 8,' &ZMS '                                          00142400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00142500
.ZG62C        ANOP  ,                                                   00142600
.*-------------------------------------------------------------------   00142700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00142800
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00142900
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00143000
              AIF   (N'&MF(2) GT 1).ZG64B       MULTI PARMS             00143100
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00143200
.ZG64B        AIF   (K'&MF(2) GT 0).ZG64C                               00143300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00143400
&ZMS          SETC  'WHEN "M" IS SPECIFIED'                             00143500
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00143600
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00143700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00143800
.ZG64C        ANOP  ,                                                   00143900
.*-------------------------------------------------------------------   00144000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00144100
              AIF   (K'&ZXMFCTRL LE 0).ZG64R    NOT I/O                 00144200
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG64R                      00144300
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00144400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG64P                        00144500
              AIF   (K'&ZCGPR GT 2).ZG64Q                               00144600
              AIF   ('&ZCGPR' EQ '0').ZG64Q                             00144700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00144800
              AIF   (T'&ZCGPR NE 'N').ZG64Q     INVALID REG NAME        00144900
.ZG64P        ANOP  ,                                                   00145000
              AIF   (T'&ZCGPR NE 'N').ZG64R     NON NUMERIC             00145100
              AIF   ('&ZCGPR' LT '1').ZG64Q                             00145200
              AIF   ('&ZCGPR' LE '12').ZG64R                            00145300
.ZG64Q        ANOP  ,                                                   00145400
&ZMS          SETC  '"MF='                                              00145500
&ZMS          SETC  '&ZMS.&MF"'                                         00145600
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00145700
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00145800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145900
.ZG64R        ANOP  ,                                                   00146000
.*-------------------------------------------------------------------   00146100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146200
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00146300
.ZG68A   AIF   ('&MF(3)' NE 'COMPLETE').ZG69A                           00146400
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00146500
.*-------------------------------------------------------------------   00146600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146700
.ZG69A   AIF   ('&MF(3)' NE 'NOCHECK').ZG70A                            00146800
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00146900
.*-------------------------------------------------------------------   00147000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00147100
.ZG70A        AIF   (K'&XMFSCK GT 0).ZG70C      KEYWORD                 00147200
              AIF   (K'&MF(3) LE 0).ZG70B                               00147300
&ZMS          SETC  '"MF='                                              00147400
&ZMS          SETC  '&ZMS.&MF"'                                         00147500
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00147600
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00147700
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00147800
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00147900
              MNOTE 8,' &ZMS '                                          00148000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148100
.ZG70B        ANOP  ,                                                   00148200
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00148300
.ZG70C        ANOP  ,                                                   00148400
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00148500
.*-------------------------------------------------------------------   00148600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148700
.ZG71         ANOP  ,                                                   00148800
&ZTLC         SETC 'E'                                                  00148900
              AIF   ('&MF(1)' NE '&ZTLC').ZG80                          00149000
&XMF          SETC  'E'         SET KEYWORD                             00149100
              AIF   (N'&MF LE 3).ZG71A          CK NUM                  00149200
&ZMS          SETC  '"MF='                                              00149300
&ZMS          SETC  '&ZMS.&MF"'                                         00149400
&ZMS          SETC  '&ZMS "MF"'                                         00149500
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00149600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149700
.ZG71A        ANOP  ,                                                   00149800
.*-------------------------------------------------------------------   00149900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00150000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00150100
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00150200
              AIF   (N'&MF(2) GT 1).ZG73B       MULTI PARMS             00150300
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00150400
.ZG73B        AIF   (K'&MF(2) GT 0).ZG73C                               00150500
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00150600
&ZMS          SETC  'WHEN "E" IS SPECIFIED'                             00150700
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00150800
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00150900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151000
.ZG73C        ANOP  ,                                                   00151100
.*-------------------------------------------------------------------   00151200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00151300
              AIF   (K'&ZXMFCTRL LE 0).ZG73R    NOT I/O                 00151400
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG73R                      00151500
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00151600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG73P                        00151700
              AIF   (K'&ZCGPR GT 2).ZG73Q                               00151800
              AIF   ('&ZCGPR' EQ '0').ZG73Q                             00151900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00152000
              AIF   (T'&ZCGPR NE 'N').ZG73Q     INVALID REG NAME        00152100
.ZG73P        ANOP  ,                                                   00152200
              AIF   (T'&ZCGPR NE 'N').ZG73R     NON NUMERIC             00152300
              AIF   ('&ZCGPR' LT '1').ZG73Q                             00152400
              AIF   ('&ZCGPR' LE '12').ZG73R                            00152500
.ZG73Q        ANOP  ,                                                   00152600
&ZMS          SETC  '"MF='                                              00152700
&ZMS          SETC  '&ZMS.&MF"'                                         00152800
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00152900
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00153000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00153100
.ZG73R        ANOP  ,                                                   00153200
.*-------------------------------------------------------------------   00153300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00153400
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00153500
.ZG77A   AIF   ('&MF(3)' NE 'COMPLETE').ZG78A                           00153600
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00153700
.*-------------------------------------------------------------------   00153800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00153900
.ZG78A   AIF   ('&MF(3)' NE 'NOCHECK').ZG79A                            00154000
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00154100
.*-------------------------------------------------------------------   00154200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00154300
.ZG79A        AIF   (K'&XMFSCK GT 0).ZG79C      KEYWORD                 00154400
              AIF   (K'&MF(3) LE 0).ZG79B                               00154500
&ZMS          SETC  '"MF='                                              00154600
&ZMS          SETC  '&ZMS.&MF"'                                         00154700
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00154800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00154900
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00155000
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00155100
              MNOTE 8,' &ZMS '                                          00155200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00155300
.ZG79B        ANOP  ,                                                   00155400
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00155500
.ZG79C        ANOP  ,                                                   00155600
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00155700
.*------------------------------------------------------------------    00155800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155900
.ZG80         ANOP  ,                                                   00156000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00156100
              AIF   (K'&XMF GT 0).ZG80E         VALID ARG               00156200
              AIF   (T'&MF EQ 'O').ZG80D        OMITTED                 00156300
&ZASYSLNDX    SETA  0                                                   00156400
.ZG80A        ANOP  ,           POSITIONAL MACRO KEY                    00156500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00156600
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG80C                    00156700
&ZTLC         SETC 'MF'                                                 00156800
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG80A           00156900
.ZG80B        ANOP  ,                                                   00157000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00157100
&ZMS          SETC  'THE "MF" KEY'                                      00157200
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00157300
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00157400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157500
              AGO   .ZG80E                                              00157600
.ZG80C        ANOP  ,                                                   00157700
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00157800
&ZMS          SETC  '"MF='                                              00157900
&ZMS          SETC  '&ZMS.&MF"'                                         00158000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00158100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00158200
&ZMS          SETC  '&ZMS "S",'                                         00158300
&ZMS          SETC  '&ZMS "L",'                                         00158400
&ZMS          SETC  '&ZMS "M",'                                         00158500
&ZMS          SETC  '&ZMS OR "E".'                                      00158600
              MNOTE 8,' &ZMS '                                          00158700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00158800
              AGO   .ZG80E                                              00158900
.ZG80D        ANOP  ,                                                   00159000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00159100
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00159200
.ZG80E        ANOP  ,                                                   00159300
.********************************************************************   00159400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00159500
.********************************************************************   00159600
              ACTR  10000                                               00159700
.*-------------------------------------------------------------------   00159800
.***AG.MF03 MF=(SLME)                                                   00159900
              AIF   ('&XMF' EQ 'L').ZGMFX                               00160000
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00160100
.*------------------------------------------------------------------    00160200
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160300
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00160400
.*-------------------------------------------------------------------   00160500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160600
.ZG3          ANOP  ,                                                   00160700
              AIF   (K'&REQUEST(1) LE 0).ZG3A                           00160800
&ZTLC         SETC 'REMOVINT'                                           00160900
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG10                     00161000
&XREQUEST     SETC  'REMOVINT'  SET KEYWORD                             00161100
              AIF   (N'&REQUEST LE 1).ZG3A      CK NUM                  00161200
&ZMS          SETC  '"REQUEST='                                         00161300
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00161400
&ZMS          SETC  '&ZMS "REQUEST"'                                    00161500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00161600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00161700
.ZG3A         ANOP  ,                                                   00161800
.*----------------------------------------------------------------***   00161900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00162000
              AIF   (N'&RMNAME LE 1).ZG5A       CK NUM                  00162100
&ZMS          SETC  '"RMNAME='                                          00162200
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00162300
&ZMS          SETC  '&ZMS "RMNAME"'                                     00162400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00162500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162600
.ZG5A         ANOP  ,                                                   00162700
.*-------------------------------------------------------------------   00162800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00162900
&ZXRMNAME     SETC  'INPUT'     SET IN/OUTPUT                           00163000
&XRMNAME      SETC  '0'                                                 00163100
              AIF   (K'&RMNAME(1) LE 0).ZG5B    PARM                    00163200
&XRMNAME      SETC  '&RMNAME(1)'                SET XVARIABLE           00163300
              AIF   (N'&RMNAME GT 1).ZG5B       MULTI                   00163400
&XRMNAME      SETC  '&RMNAME'   SET XVARIABLE                           00163500
.ZG5B         ANOP  ,                                                   00163600
.*-------------------------------------------------------------------   00163700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00163800
              AIF   (K'&ZXRMNAME LE 0).ZG5R     NOT I/O                 00163900
              AIF   ('&XRMNAME'(1,1) NE '(').ZG5R                       00164000
&ZCGPR        SETC  '&XRMNAME'(2,K'&XRMNAME-2)                          00164100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         00164200
              AIF   (K'&ZCGPR GT 2).ZG5Q                                00164300
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              00164400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00164500
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        00164600
.ZG5P         ANOP  ,                                                   00164700
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             00164800
              AIF   ('&ZCGPR' LT '2').ZG5Q                              00164900
              AIF   ('&ZCGPR' LE '12').ZG5R                             00165000
.ZG5Q         ANOP  ,                                                   00165100
&ZMS          SETC  '"RMNAME='                                          00165200
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00165300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00165400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00165500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00165600
.ZG5R         ANOP  ,                                                   00165700
.*----------------------------------------------------------------***   00165800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00165900
              AIF   (N'&URID LE 1).ZG8A         CK NUM                  00166000
&ZMS          SETC  '"URID='                                            00166100
&ZMS          SETC  '&ZMS.&URID"'                                       00166200
&ZMS          SETC  '&ZMS "URID"'                                       00166300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00166400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00166500
.ZG8A         ANOP  ,                                                   00166600
.*-------------------------------------------------------------------   00166700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00166800
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00166900
&XURID        SETC  '0'                                                 00167000
              AIF   (K'&URID(1) LE 0).ZG8B      PARM                    00167100
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00167200
              AIF   (N'&URID GT 1).ZG8B         MULTI                   00167300
&XURID        SETC  '&URID'     SET XVARIABLE                           00167400
.ZG8B         ANOP  ,                                                   00167500
.*-------------------------------------------------------------------   00167600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00167700
              AIF   (K'&ZXURID LE 0).ZG8R       NOT I/O                 00167800
              AIF   ('&XURID'(1,1) NE '(').ZG8R                         00167900
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00168000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         00168100
              AIF   (K'&ZCGPR GT 2).ZG8Q                                00168200
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              00168300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00168400
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        00168500
.ZG8P         ANOP  ,                                                   00168600
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             00168700
              AIF   ('&ZCGPR' LT '2').ZG8Q                              00168800
              AIF   ('&ZCGPR' LE '12').ZG8R                             00168900
.ZG8Q         ANOP  ,                                                   00169000
&ZMS          SETC  '"URID='                                            00169100
&ZMS          SETC  '&ZMS.&URID"'                                       00169200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00169300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00169400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00169500
.ZG8R         ANOP  ,                                                   00169600
.*-------------------------------------------------------------------   00169700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169800
.ZG10         ANOP  ,                                                   00169900
&ZTLC         SETC 'COMMIT'                                             00170000
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG14                     00170100
&XREQUEST     SETC  'COMMIT'    SET KEYWORD                             00170200
              AIF   (N'&REQUEST LE 1).ZG10A     CK NUM                  00170300
&ZMS          SETC  '"REQUEST='                                         00170400
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00170500
&ZMS          SETC  '&ZMS "REQUEST"'                                    00170600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00170700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00170800
.ZG10A        ANOP  ,                                                   00170900
.*------------------------------------------------------------------    00171000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171100
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00171200
.ZG10A0       AIF   (K'&RMNAME LE 0).ZG10A1     OK                      00171300
&ZCVAL        SETC '&ZCVAL RMNAME'              INCORRECT KEY USED      00171400
.ZG10A1       AIF   (K'&ZCVAL LE 0).ZG10A2      OK                      00171500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00171600
&ZMS          SETC  '"REQUEST'                                          00171700
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00171800
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00171900
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00172000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00172100
.ZG10A2       ANOP  ,                                                   00172200
.*----------------------------------------------------------------***   00172300
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00172400
              AIF   (N'&URID LE 1).ZG12A        CK NUM                  00172500
&ZMS          SETC  '"URID='                                            00172600
&ZMS          SETC  '&ZMS.&URID"'                                       00172700
&ZMS          SETC  '&ZMS "URID"'                                       00172800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00172900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00173000
.ZG12A        ANOP  ,                                                   00173100
.*-------------------------------------------------------------------   00173200
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00173300
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00173400
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00173500
              AIF   (N'&URID GT 1).ZG12B        MULTI PARMS             00173600
&XURID        SETC  '&URID'     SET XVARIABLE                           00173700
.ZG12B        AIF   (K'&URID(1) GT 0).ZG12C                             00173800
&ZXURID       SETC  ''          RESET IN/OUTPUT                         00173900
&ZMS          SETC  ' '                                                 00174000
&ZMS          SETC  '&ZMS "URID" KEY AND ITS'                           00174100
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00174200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00174300
.ZG12C        ANOP  ,                                                   00174400
.*-------------------------------------------------------------------   00174500
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00174600
              AIF   (K'&ZXURID LE 0).ZG12R      NOT I/O                 00174700
              AIF   ('&XURID'(1,1) NE '(').ZG12R                        00174800
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00174900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                        00175000
              AIF   (K'&ZCGPR GT 2).ZG12Q                               00175100
              AIF   ('&ZCGPR' EQ '0').ZG12Q                             00175200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00175300
              AIF   (T'&ZCGPR NE 'N').ZG12Q     INVALID REG NAME        00175400
.ZG12P        ANOP  ,                                                   00175500
              AIF   (T'&ZCGPR NE 'N').ZG12R     NON NUMERIC             00175600
              AIF   ('&ZCGPR' LT '2').ZG12Q                             00175700
              AIF   ('&ZCGPR' LE '12').ZG12R                            00175800
.ZG12Q        ANOP  ,                                                   00175900
&ZMS          SETC  '"URID='                                            00176000
&ZMS          SETC  '&ZMS.&URID"'                                       00176100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00176200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00176300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00176400
.ZG12R        ANOP  ,                                                   00176500
.*-------------------------------------------------------------------   00176600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00176700
.ZG14         ANOP  ,                                                   00176800
&ZTLC         SETC 'BACKOUT'                                            00176900
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG18                     00177000
&XREQUEST     SETC  'BACKOUT'   SET KEYWORD                             00177100
              AIF   (N'&REQUEST LE 1).ZG14A     CK NUM                  00177200
&ZMS          SETC  '"REQUEST='                                         00177300
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00177400
&ZMS          SETC  '&ZMS "REQUEST"'                                    00177500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00177600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00177700
.ZG14A        ANOP  ,                                                   00177800
.*------------------------------------------------------------------    00177900
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00178000
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00178100
.ZG14A0       AIF   (K'&RMNAME LE 0).ZG14A1     OK                      00178200
&ZCVAL        SETC '&ZCVAL RMNAME'              INCORRECT KEY USED      00178300
.ZG14A1       AIF   (K'&ZCVAL LE 0).ZG14A2      OK                      00178400
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00178500
&ZMS          SETC  '"REQUEST'                                          00178600
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00178700
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00178800
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00178900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00179000
.ZG14A2       ANOP  ,                                                   00179100
.*----------------------------------------------------------------***   00179200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00179300
              AIF   (N'&URID LE 1).ZG16A        CK NUM                  00179400
&ZMS          SETC  '"URID='                                            00179500
&ZMS          SETC  '&ZMS.&URID"'                                       00179600
&ZMS          SETC  '&ZMS "URID"'                                       00179700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00179800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00179900
.ZG16A        ANOP  ,                                                   00180000
.*-------------------------------------------------------------------   00180100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00180200
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00180300
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00180400
              AIF   (N'&URID GT 1).ZG16B        MULTI PARMS             00180500
&XURID        SETC  '&URID'     SET XVARIABLE                           00180600
.ZG16B        AIF   (K'&URID(1) GT 0).ZG16C                             00180700
&ZXURID       SETC  ''          RESET IN/OUTPUT                         00180800
&ZMS          SETC  ' '                                                 00180900
&ZMS          SETC  '&ZMS "URID" KEY AND ITS'                           00181000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00181100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00181200
.ZG16C        ANOP  ,                                                   00181300
.*-------------------------------------------------------------------   00181400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00181500
              AIF   (K'&ZXURID LE 0).ZG16R      NOT I/O                 00181600
              AIF   ('&XURID'(1,1) NE '(').ZG16R                        00181700
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00181800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG16P                        00181900
              AIF   (K'&ZCGPR GT 2).ZG16Q                               00182000
              AIF   ('&ZCGPR' EQ '0').ZG16Q                             00182100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00182200
              AIF   (T'&ZCGPR NE 'N').ZG16Q     INVALID REG NAME        00182300
.ZG16P        ANOP  ,                                                   00182400
              AIF   (T'&ZCGPR NE 'N').ZG16R     NON NUMERIC             00182500
              AIF   ('&ZCGPR' LT '2').ZG16Q                             00182600
              AIF   ('&ZCGPR' LE '12').ZG16R                            00182700
.ZG16Q        ANOP  ,                                                   00182800
&ZMS          SETC  '"URID='                                            00182900
&ZMS          SETC  '&ZMS.&URID"'                                       00183000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00183100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00183200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00183300
.ZG16R        ANOP  ,                                                   00183400
.*-------------------------------------------------------------------   00183500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183600
.ZG18         ANOP  ,                                                   00183700
&ZTLC         SETC 'REMOVRM'                                            00183800
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG22                     00183900
&XREQUEST     SETC  'REMOVRM'   SET KEYWORD                             00184000
              AIF   (N'&REQUEST LE 1).ZG18A     CK NUM                  00184100
&ZMS          SETC  '"REQUEST='                                         00184200
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00184300
&ZMS          SETC  '&ZMS "REQUEST"'                                    00184400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00184500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00184600
.ZG18A        ANOP  ,                                                   00184700
.*------------------------------------------------------------------    00184800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00184900
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00185000
.ZG18A0       AIF   (K'&URID LE 0).ZG18A1       OK                      00185100
&ZCVAL        SETC '&ZCVAL URID'                INCORRECT KEY USED      00185200
.ZG18A1       AIF   (K'&ZCVAL LE 0).ZG18A2      OK                      00185300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00185400
&ZMS          SETC  '"REQUEST'                                          00185500
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00185600
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00185700
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00185800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00185900
.ZG18A2       ANOP  ,                                                   00186000
.*----------------------------------------------------------------***   00186100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00186200
              AIF   (N'&RMNAME LE 1).ZG20A      CK NUM                  00186300
&ZMS          SETC  '"RMNAME='                                          00186400
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00186500
&ZMS          SETC  '&ZMS "RMNAME"'                                     00186600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00186700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00186800
.ZG20A        ANOP  ,                                                   00186900
.*-------------------------------------------------------------------   00187000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00187100
&ZXRMNAME     SETC  'INPUT'     SET IN/OUTPUT                           00187200
&XRMNAME      SETC  '&RMNAME(1)'                SET XVARIABLE           00187300
              AIF   (N'&RMNAME GT 1).ZG20B      MULTI PARMS             00187400
&XRMNAME      SETC  '&RMNAME'   SET XVARIABLE                           00187500
.ZG20B        AIF   (K'&RMNAME(1) GT 0).ZG20C                           00187600
&ZXRMNAME     SETC  ''          RESET IN/OUTPUT                         00187700
&ZMS          SETC  ' '                                                 00187800
&ZMS          SETC  '&ZMS "RMNAME" KEY AND ITS'                         00187900
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00188000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00188100
.ZG20C        ANOP  ,                                                   00188200
.*-------------------------------------------------------------------   00188300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00188400
              AIF   (K'&ZXRMNAME LE 0).ZG20R    NOT I/O                 00188500
              AIF   ('&XRMNAME'(1,1) NE '(').ZG20R                      00188600
&ZCGPR        SETC  '&XRMNAME'(2,K'&XRMNAME-2)                          00188700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                        00188800
              AIF   (K'&ZCGPR GT 2).ZG20Q                               00188900
              AIF   ('&ZCGPR' EQ '0').ZG20Q                             00189000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00189100
              AIF   (T'&ZCGPR NE 'N').ZG20Q     INVALID REG NAME        00189200
.ZG20P        ANOP  ,                                                   00189300
              AIF   (T'&ZCGPR NE 'N').ZG20R     NON NUMERIC             00189400
              AIF   ('&ZCGPR' LT '2').ZG20Q                             00189500
              AIF   ('&ZCGPR' LE '12').ZG20R                            00189600
.ZG20Q        ANOP  ,                                                   00189700
&ZMS          SETC  '"RMNAME='                                          00189800
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00189900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00190000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00190100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00190200
.ZG20R        ANOP  ,                                                   00190300
.*-------------------------------------------------------------------   00190400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00190500
.ZG22         ANOP  ,                                                   00190600
&ZTLC         SETC 'UNREGRM'                                            00190700
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG26                     00190800
&XREQUEST     SETC  'UNREGRM'   SET KEYWORD                             00190900
              AIF   (N'&REQUEST LE 1).ZG22A     CK NUM                  00191000
&ZMS          SETC  '"REQUEST='                                         00191100
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00191200
&ZMS          SETC  '&ZMS "REQUEST"'                                    00191300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00191400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00191500
.ZG22A        ANOP  ,                                                   00191600
.*------------------------------------------------------------------    00191700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00191800
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00191900
.ZG22A0       AIF   (K'&URID LE 0).ZG22A1       OK                      00192000
&ZCVAL        SETC '&ZCVAL URID'                INCORRECT KEY USED      00192100
.ZG22A1       AIF   (K'&ZCVAL LE 0).ZG22A2      OK                      00192200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00192300
&ZMS          SETC  '"REQUEST'                                          00192400
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00192500
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00192600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00192700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00192800
.ZG22A2       ANOP  ,                                                   00192900
.*----------------------------------------------------------------***   00193000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00193100
              AIF   (N'&RMNAME LE 1).ZG24A      CK NUM                  00193200
&ZMS          SETC  '"RMNAME='                                          00193300
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00193400
&ZMS          SETC  '&ZMS "RMNAME"'                                     00193500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00193600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00193700
.ZG24A        ANOP  ,                                                   00193800
.*-------------------------------------------------------------------   00193900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00194000
&ZXRMNAME     SETC  'INPUT'     SET IN/OUTPUT                           00194100
&XRMNAME      SETC  '&RMNAME(1)'                SET XVARIABLE           00194200
              AIF   (N'&RMNAME GT 1).ZG24B      MULTI PARMS             00194300
&XRMNAME      SETC  '&RMNAME'   SET XVARIABLE                           00194400
.ZG24B        AIF   (K'&RMNAME(1) GT 0).ZG24C                           00194500
&ZXRMNAME     SETC  ''          RESET IN/OUTPUT                         00194600
&ZMS          SETC  ' '                                                 00194700
&ZMS          SETC  '&ZMS "RMNAME" KEY AND ITS'                         00194800
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00194900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00195000
.ZG24C        ANOP  ,                                                   00195100
.*-------------------------------------------------------------------   00195200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00195300
              AIF   (K'&ZXRMNAME LE 0).ZG24R    NOT I/O                 00195400
              AIF   ('&XRMNAME'(1,1) NE '(').ZG24R                      00195500
&ZCGPR        SETC  '&XRMNAME'(2,K'&XRMNAME-2)                          00195600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                        00195700
              AIF   (K'&ZCGPR GT 2).ZG24Q                               00195800
              AIF   ('&ZCGPR' EQ '0').ZG24Q                             00195900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00196000
              AIF   (T'&ZCGPR NE 'N').ZG24Q     INVALID REG NAME        00196100
.ZG24P        ANOP  ,                                                   00196200
              AIF   (T'&ZCGPR NE 'N').ZG24R     NON NUMERIC             00196300
              AIF   ('&ZCGPR' LT '2').ZG24Q                             00196400
              AIF   ('&ZCGPR' LE '12').ZG24R                            00196500
.ZG24Q        ANOP  ,                                                   00196600
&ZMS          SETC  '"RMNAME='                                          00196700
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00196800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00196900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00197000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00197100
.ZG24R        ANOP  ,                                                   00197200
.*-------------------------------------------------------------------   00197300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00197400
.ZG26         ANOP  ,                                                   00197500
&ZTLC         SETC 'FORGET'                                             00197600
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG30                     00197700
&XREQUEST     SETC  'FORGET'    SET KEYWORD                             00197800
              AIF   (N'&REQUEST LE 1).ZG26A     CK NUM                  00197900
&ZMS          SETC  '"REQUEST='                                         00198000
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00198100
&ZMS          SETC  '&ZMS "REQUEST"'                                    00198200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00198300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00198400
.ZG26A        ANOP  ,                                                   00198500
.*------------------------------------------------------------------    00198600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00198700
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00198800
.ZG26A0       AIF   (K'&RMNAME LE 0).ZG26A1     OK                      00198900
&ZCVAL        SETC '&ZCVAL RMNAME'              INCORRECT KEY USED      00199000
.ZG26A1       AIF   (K'&ZCVAL LE 0).ZG26A2      OK                      00199100
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00199200
&ZMS          SETC  '"REQUEST'                                          00199300
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00199400
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00199500
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00199600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00199700
.ZG26A2       ANOP  ,                                                   00199800
.*----------------------------------------------------------------***   00199900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00200000
              AIF   (N'&URID LE 1).ZG28A        CK NUM                  00200100
&ZMS          SETC  '"URID='                                            00200200
&ZMS          SETC  '&ZMS.&URID"'                                       00200300
&ZMS          SETC  '&ZMS "URID"'                                       00200400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00200500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00200600
.ZG28A        ANOP  ,                                                   00200700
.*-------------------------------------------------------------------   00200800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00200900
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00201000
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00201100
              AIF   (N'&URID GT 1).ZG28B        MULTI PARMS             00201200
&XURID        SETC  '&URID'     SET XVARIABLE                           00201300
.ZG28B        AIF   (K'&URID(1) GT 0).ZG28C                             00201400
&ZXURID       SETC  ''          RESET IN/OUTPUT                         00201500
&ZMS          SETC  ' '                                                 00201600
&ZMS          SETC  '&ZMS "URID" KEY AND ITS'                           00201700
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00201800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00201900
.ZG28C        ANOP  ,                                                   00202000
.*-------------------------------------------------------------------   00202100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00202200
              AIF   (K'&ZXURID LE 0).ZG28R      NOT I/O                 00202300
              AIF   ('&XURID'(1,1) NE '(').ZG28R                        00202400
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00202500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                        00202600
              AIF   (K'&ZCGPR GT 2).ZG28Q                               00202700
              AIF   ('&ZCGPR' EQ '0').ZG28Q                             00202800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00202900
              AIF   (T'&ZCGPR NE 'N').ZG28Q     INVALID REG NAME        00203000
.ZG28P        ANOP  ,                                                   00203100
              AIF   (T'&ZCGPR NE 'N').ZG28R     NON NUMERIC             00203200
              AIF   ('&ZCGPR' LT '2').ZG28Q                             00203300
              AIF   ('&ZCGPR' LE '12').ZG28R                            00203400
.ZG28Q        ANOP  ,                                                   00203500
&ZMS          SETC  '"URID='                                            00203600
&ZMS          SETC  '&ZMS.&URID"'                                       00203700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00203800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00203900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00204000
.ZG28R        ANOP  ,                                                   00204100
.*------------------------------------------------------------------    00204200
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00204300
.ZG30         ANOP  ,                                                   00204400
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00204500
              AIF   (K'&XREQUEST GT 0).ZG30E    VALID ARG               00204600
              AIF   (T'&REQUEST EQ 'O').ZG30D   OMITTED                 00204700
&ZASYSLNDX    SETA  0                                                   00204800
.ZG30A        ANOP  ,           POSITIONAL MACRO KEY                    00204900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00205000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG30C                    00205100
&ZTLC         SETC 'REQUEST'                                            00205200
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG30A           00205300
.ZG30B        ANOP  ,                                                   00205400
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00205500
&ZMS          SETC  'THE "REQUEST" KEY'                                 00205600
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00205700
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00205800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00205900
              AGO   .ZG30E                                              00206000
.ZG30C        ANOP  ,                                                   00206100
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00206200
&ZMS          SETC  '"REQUEST='                                         00206300
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00206400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00206500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00206600
&ZMS          SETC  '&ZMS "REMOVINT",'                                  00206700
&ZMS          SETC  '&ZMS "COMMIT",'                                    00206800
&ZMS          SETC  '&ZMS "BACKOUT",'                                   00206900
&ZMS          SETC  '&ZMS "REMOVRM",'                                   00207000
&ZMS          SETC  '&ZMS "UNREGRM",'                                   00207100
&ZMS          SETC  '&ZMS OR "FORGET".'                                 00207200
              MNOTE 8,' &ZMS '                                          00207300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00207400
              AGO   .ZG30E                                              00207500
.ZG30D        ANOP  ,                                                   00207600
&XREQUEST     SETC  'REMOVINT'  SET DEFAULT KEYWORD                     00207700
.ZG30E        ANOP  ,                                                   00207800
.*------------------------------------------------------------------    00207900
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00208000
              AIF   (K'&REQUEST(1) GT 0).ZG30F  PARM                    00208100
&XREQUEST     SETC  ''          ENSURE NULL KEYWORD                     00208200
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00208300
&ZMS          SETC  'THE'                                               00208400
&ZMS          SETC  '&ZMS "REQUEST" KEY AND ITS'                        00208500
&ZMS          SETC  '&ZMS ARGUMENT ARE REQUIRED.'                       00208600
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00208700
&ZMS          SETC  '&ZMS "REMOVINT",'                                  00208800
&ZMS          SETC  '&ZMS "COMMIT",'                                    00208900
&ZMS          SETC  '&ZMS "BACKOUT",'                                   00209000
&ZMS          SETC  '&ZMS "REMOVRM",'                                   00209100
&ZMS          SETC  '&ZMS "UNREGRM",'                                   00209200
&ZMS          SETC  '&ZMS OR "FORGET".'                                 00209300
              MNOTE 8,' &ZMS '                                          00209400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00209500
.ZG30F        ANOP  ,                                                   00209600
.*----------------------------------------------------------------***   00209700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00209800
              AIF   (N'&GNAME LE 1).ZG32A       CK NUM                  00209900
&ZMS          SETC  '"GNAME='                                           00210000
&ZMS          SETC  '&ZMS.&GNAME"'                                      00210100
&ZMS          SETC  '&ZMS "GNAME"'                                      00210200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00210300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00210400
.ZG32A        ANOP  ,                                                   00210500
.*-------------------------------------------------------------------   00210600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00210700
&ZXGNAME      SETC  'INPUT'     SET IN/OUTPUT                           00210800
&XGNAME       SETC  'CURRENT_GNAME'                                     00210900
              AIF   (K'&GNAME(1) LE 0).ZG32B    PARM                    00211000
&XGNAME       SETC  '&GNAME(1)'                 SET XVARIABLE           00211100
              AIF   (N'&GNAME GT 1).ZG32B       MULTI                   00211200
&XGNAME       SETC  '&GNAME'    SET XVARIABLE                           00211300
.ZG32B        ANOP  ,                                                   00211400
.*-------------------------------------------------------------------   00211500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00211600
              AIF   (K'&ZXGNAME LE 0).ZG32R     NOT I/O                 00211700
         AIF   ('&XGNAME' EQ 'CURRENT_GNAME').ZG32R                     00211800
              AIF   ('&XGNAME'(1,1) NE '(').ZG32R                       00211900
&ZCGPR        SETC  '&XGNAME'(2,K'&XGNAME-2)                            00212000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                        00212100
              AIF   (K'&ZCGPR GT 2).ZG32Q                               00212200
              AIF   ('&ZCGPR' EQ '0').ZG32Q                             00212300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00212400
              AIF   (T'&ZCGPR NE 'N').ZG32Q     INVALID REG NAME        00212500
.ZG32P        ANOP  ,                                                   00212600
              AIF   (T'&ZCGPR NE 'N').ZG32R     NON NUMERIC             00212700
              AIF   ('&ZCGPR' LT '2').ZG32Q                             00212800
              AIF   ('&ZCGPR' LE '12').ZG32R                            00212900
.ZG32Q        ANOP  ,                                                   00213000
&ZMS          SETC  '"GNAME='                                           00213100
&ZMS          SETC  '&ZMS.&GNAME"'                                      00213200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00213300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00213400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00213500
.ZG32R        ANOP  ,                                                   00213600
.*----------------------------------------------------------------***   00213700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00213800
              AIF   (N'&SYSNAME LE 1).ZG35A     CK NUM                  00213900
&ZMS          SETC  '"SYSNAME='                                         00214000
&ZMS          SETC  '&ZMS.&SYSNAME"'                                    00214100
&ZMS          SETC  '&ZMS "SYSNAME"'                                    00214200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00214300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00214400
.ZG35A        ANOP  ,                                                   00214500
.*-------------------------------------------------------------------   00214600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00214700
&ZXSYSNAME    SETC  'INPUT'     SET IN/OUTPUT                           00214800
&XSYSNAME     SETC  'CURRENT_SYSNAME'                                   00214900
              AIF   (K'&SYSNAME(1) LE 0).ZG35B  PARM                    00215000
&XSYSNAME     SETC  '&SYSNAME(1)'               SET XVARIABLE           00215100
              AIF   (N'&SYSNAME GT 1).ZG35B     MULTI                   00215200
&XSYSNAME     SETC  '&SYSNAME'  SET XVARIABLE                           00215300
.ZG35B        ANOP  ,                                                   00215400
.*-------------------------------------------------------------------   00215500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00215600
              AIF   (K'&ZXSYSNAME LE 0).ZG35R   NOT I/O                 00215700
         AIF   ('&XSYSNAME' EQ 'CURRENT_SYSNAME').ZG35R                 00215800
              AIF   ('&XSYSNAME'(1,1) NE '(').ZG35R                     00215900
&ZCGPR        SETC  '&XSYSNAME'(2,K'&XSYSNAME-2)                        00216000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                        00216100
              AIF   (K'&ZCGPR GT 2).ZG35Q                               00216200
              AIF   ('&ZCGPR' EQ '0').ZG35Q                             00216300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00216400
              AIF   (T'&ZCGPR NE 'N').ZG35Q     INVALID REG NAME        00216500
.ZG35P        ANOP  ,                                                   00216600
              AIF   (T'&ZCGPR NE 'N').ZG35R     NON NUMERIC             00216700
              AIF   ('&ZCGPR' LT '2').ZG35Q                             00216800
              AIF   ('&ZCGPR' LE '12').ZG35R                            00216900
.ZG35Q        ANOP  ,                                                   00217000
&ZMS          SETC  '"SYSNAME='                                         00217100
&ZMS          SETC  '&ZMS.&SYSNAME"'                                    00217200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00217300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00217400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00217500
.ZG35R        ANOP  ,                                                   00217600
.*----------------------------------------------------------------***   00217700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00217800
              AIF   (N'&RCTABLE LE 1).ZG38A     CK NUM                  00217900
&ZMS          SETC  '"RCTABLE='                                         00218000
&ZMS          SETC  '&ZMS.&RCTABLE"'                                    00218100
&ZMS          SETC  '&ZMS "RCTABLE"'                                    00218200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00218300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00218400
.ZG38A        ANOP  ,                                                   00218500
.*-------------------------------------------------------------------   00218600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00218700
&ZXRCTABLE    SETC  'INPUT'     SET IN/OUTPUT                           00218800
&XRCTABLE     SETC  '0'                                                 00218900
              AIF   (K'&RCTABLE(1) LE 0).ZG38B  PARM                    00219000
&XRCTABLE     SETC  '&RCTABLE(1)'               SET XVARIABLE           00219100
              AIF   (N'&RCTABLE GT 1).ZG38B     MULTI                   00219200
&XRCTABLE     SETC  '&RCTABLE'  SET XVARIABLE                           00219300
.ZG38B        ANOP  ,                                                   00219400
.*-------------------------------------------------------------------   00219500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00219600
              AIF   (K'&ZXRCTABLE LE 0).ZG38R   NOT I/O                 00219700
              AIF   ('&XRCTABLE'(1,1) NE '(').ZG38R                     00219800
&ZCGPR        SETC  '&XRCTABLE'(2,K'&XRCTABLE-2)                        00219900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                        00220000
              AIF   (K'&ZCGPR GT 2).ZG38Q                               00220100
              AIF   ('&ZCGPR' EQ '0').ZG38Q                             00220200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00220300
              AIF   (T'&ZCGPR NE 'N').ZG38Q     INVALID REG NAME        00220400
.ZG38P        ANOP  ,                                                   00220500
              AIF   (T'&ZCGPR NE 'N').ZG38R     NON NUMERIC             00220600
              AIF   ('&ZCGPR' LT '2').ZG38Q                             00220700
              AIF   ('&ZCGPR' LE '12').ZG38R                            00220800
.ZG38Q        ANOP  ,                                                   00220900
&ZMS          SETC  '"RCTABLE='                                         00221000
&ZMS          SETC  '&ZMS.&RCTABLE"'                                    00221100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00221200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00221300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00221400
.ZG38R        ANOP  ,                                                   00221500
.*-------------------------------------------------------------------   00221600
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00221700
              AIF   ('&XMF' EQ 'M').ZG41        BYPASS IF MF=M          00221800
.*----------------------------------------------------------------***   00221900
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00222000
              AIF   (N'&RCNUM LE 1).ZG40A       CK NUM                  00222100
&ZMS          SETC  '"RCNUM='                                           00222200
&ZMS          SETC  '&ZMS.&RCNUM"'                                      00222300
&ZMS          SETC  '&ZMS "RCNUM"'                                      00222400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00222500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00222600
.ZG40A        ANOP  ,                                                   00222700
.*-------------------------------------------------------------------   00222800
.***AG.KXVAR10 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00222900
              AIF   (K'&RCTABLE(1) GT 0).ZG40B  KEY                     00223000
              AIF   (K'&RCNUM(1) LE 0).ZG40D    NO PRM                  00223100
&ZMS          SETC  '"RCNUM'                                            00223200
&ZMS          SETC  '&ZMS.=&RCNUM"'                                     00223300
&ZMS          SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                     00223400
&ZMS          SETC  '&ZMS '                                             00223500
&ZMS          SETC  '&ZMS "RCTABLE"'                                    00223600
              MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                        00223700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00223800
              AGO   .ZG40D                                              00223900
.*                                                                      00224000
.ZG40B        ANOP  ,                                                   00224100
              AIF   (K'&RCNUM(1) LE 0).ZG40C    NO PRM                  00224200
&ZXRCNUM      SETC  'OUTPUT'    SET OUTPUT                              00224300
&XRCNUM       SETC  '&RCNUM(1))'                SET XVARIABLE           00224400
              AIF   (N'&RCNUM GT 1).ZG40C                               00224500
&XRCNUM       SETC  '&RCNUM'    SET XVARIABLE                           00224600
              AGO   .ZG40D                                              00224700
.ZG40C        ANOP  ,                                                   00224800
&ZMS          SETC  'WHEN "RCTABLE" IS SPECIFIED'                       00224900
&ZMS          SETC  '&ZMS , "RCNUM" KEY AND ITS'                        00225000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00225100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00225200
.ZG40D        ANOP  ,                                                   00225300
.*-------------------------------------------------------------------   00225400
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00225500
              AIF   (K'&ZXRCNUM LE 0).ZG40R     NOT I/O                 00225600
              AIF   ('&XRCNUM'(1,1) NE '(').ZG40R                       00225700
&ZCGPR        SETC  '&XRCNUM'(2,K'&XRCNUM-2)                            00225800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                        00225900
              AIF   (K'&ZCGPR GT 2).ZG40Q                               00226000
              AIF   ('&ZCGPR' EQ '0').ZG40Q                             00226100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00226200
              AIF   (T'&ZCGPR NE 'N').ZG40Q     INVALID REG NAME        00226300
.ZG40P        ANOP  ,                                                   00226400
              AIF   (T'&ZCGPR NE 'N').ZG40R     NON NUMERIC             00226500
              AIF   ('&ZCGPR' LT '2').ZG40Q                             00226600
              AIF   ('&ZCGPR' LE '12').ZG40R                            00226700
.ZG40Q        ANOP  ,                                                   00226800
&ZMS          SETC  '"RCNUM='                                           00226900
&ZMS          SETC  '&ZMS.&RCNUM"'                                      00227000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00227100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00227200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00227300
.ZG40R        ANOP  ,                                                   00227400
.*-------------------------------------------------------------------   00227500
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00227600
.ZG41         ANOP  ,           END OF BYPASS CHECK                     00227700
.*----------------------------------------------------------------***   00227800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00227900
              AIF   (N'&RETCODE LE 1).ZG44A     CK NUM                  00228000
&ZMS          SETC  '"RETCODE='                                         00228100
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00228200
&ZMS          SETC  '&ZMS "RETCODE"'                                    00228300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00228400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00228500
.ZG44A        ANOP  ,                                                   00228600
.*-------------------------------------------------------------------   00228700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00228800
              AIF   (K'&RETCODE(1) LE 0).ZG44C  NO PARM                 00228900
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00229000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00229100
              AIF   (N'&RETCODE GT 1).ZG44C                             00229200
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00229300
.ZG44C        ANOP  ,                                                   00229400
.*-------------------------------------------------------------------   00229500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00229600
              AIF   (K'&ZXRETCODE LE 0).ZG44R   NOT I/O                 00229700
              AIF   ('&XRETCODE'(1,1) NE '(').ZG44R                     00229800
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00229900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                        00230000
              AIF   (K'&ZCGPR GT 2).ZG44Q                               00230100
              AIF   ('&ZCGPR' EQ '0').ZG44Q                             00230200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00230300
              AIF   (T'&ZCGPR NE 'N').ZG44Q     INVALID REG NAME        00230400
.ZG44P        ANOP  ,                                                   00230500
              AIF   (T'&ZCGPR NE 'N').ZG44R     NON NUMERIC             00230600
              AIF   ('&ZCGPR' EQ '15').ZG44R                            00230700
              AIF   ('&ZCGPR' LT '2').ZG44Q                             00230800
              AIF   ('&ZCGPR' LE '12').ZG44R                            00230900
.ZG44Q        ANOP  ,                                                   00231000
&ZMS          SETC  '"RETCODE='                                         00231100
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00231200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00231300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'            00231400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00231500
.ZG44R        ANOP  ,                                                   00231600
.*----------------------------------------------------------------***   00231700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00231800
              AIF   (N'&RSNCODE LE 1).ZG47A     CK NUM                  00231900
&ZMS          SETC  '"RSNCODE='                                         00232000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00232100
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00232200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00232300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00232400
.ZG47A        ANOP  ,                                                   00232500
.*-------------------------------------------------------------------   00232600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00232700
              AIF   (K'&RSNCODE(1) LE 0).ZG47C  NO PARM                 00232800
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00232900
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00233000
              AIF   (N'&RSNCODE GT 1).ZG47C                             00233100
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00233200
.ZG47C        ANOP  ,                                                   00233300
.*-------------------------------------------------------------------   00233400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00233500
              AIF   (K'&ZXRSNCODE LE 0).ZG47R   NOT I/O                 00233600
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG47R                     00233700
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00233800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                        00233900
              AIF   (K'&ZCGPR GT 2).ZG47Q                               00234000
              AIF   ('&ZCGPR' EQ '0').ZG47R                             00234100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00234200
              AIF   (T'&ZCGPR NE 'N').ZG47Q     INVALID REG NAME        00234300
.ZG47P        ANOP  ,                                                   00234400
              AIF   (T'&ZCGPR NE 'N').ZG47R     NON NUMERIC             00234500
              AIF   ('&ZCGPR' EQ '0').ZG47R                             00234600
              AIF   ('&ZCGPR' LT '2').ZG47Q                             00234700
              AIF   ('&ZCGPR' LE '12').ZG47R                            00234800
.ZG47Q        ANOP  ,                                                   00234900
&ZMS          SETC  '"RSNCODE='                                         00235000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00235100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00235200
              MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'             00235300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00235400
.ZG47R        ANOP  ,                                                   00235500
.******************************************************************     00235600
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00235700
.******************************************************************     00235800
              ACTR  10000                                               00235900
.*----------------------------------------------------------------***   00236000
.***AH.P02 EXTRA POSITIONALS                                            00236100
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00236200
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00236300
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00236400
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00236500
.ZGLISTX1     ANOP  ,                                                   00236600
&ZCVAL        SETC  ''          ERROR FIELD                             00236700
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00236800
.ZGLIST2      ANOP  ,                                                   00236900
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00237000
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00237100
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00237200
              AGO   .ZGLIST2                                            00237300
.*                                                                      00237400
.ZGLIST3      ANOP  ,                                                   00237500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00237600
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00237700
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00237800
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00237900
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00238000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00238100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00238200
.ZGLISTX      ANOP  ,                                                   00238300
&ZASYSLNDX    SETA  0                                                   00238400
.*-------------------------------------------------------------------   00238500
.***AG.MF04 MF=(SLME)                                                   00238600
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00238700
.********************************************************************   00238800
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00238900
.********************************************************************   00239000
              ACTR  10000                                               00239100
.*-------------------------------------------------------------------   00239200
.***AE.MF01 MF=(SLME)                                                   00239300
              AIF   ('&XMF' EQ 'L').ZEMFX                               00239400
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00239500
.********************************************************************   00239600
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00239700
.********************************************************************   00239800
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00239900
.*-------------------------------------------------------------------   00240000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00240100
&ZTLC         SETC 'REMOVINT'                                           00240200
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE3A                     00240300
&XREQUEST     SETC  'REMOVINT'  SET KEYWORD                             00240400
              AIF   (N'&REQUEST LE 1).ZE3A      CK NUM                  00240500
&ZMS          SETC  '"REQUEST='                                         00240600
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00240700
&ZMS          SETC  '&ZMS "REQUEST"'                                    00240800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00240900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00241000
.ZE3A         ANOP  ,                                                   00241100
.*----------------------------------------------------------------***   00241200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00241300
              AIF   (N'&RMNAME LE 1).ZE5A       CK NUM                  00241400
&ZMS          SETC  '"RMNAME='                                          00241500
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00241600
&ZMS          SETC  '&ZMS "RMNAME"'                                     00241700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00241800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00241900
.ZE5A         ANOP  ,                                                   00242000
.*-------------------------------------------------------------------   00242100
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00242200
              AIF   (K'&RMNAME(1) LE 0).ZE5B    NO PRM                  00242300
&ZXRMNAME     SETC  'INPUT'     SET IN/OUTPUT                           00242400
&XRMNAME      SETC  '&RMNAME(1)'                SET XVARIABLE           00242500
              AIF   (N'&RMNAME GT 1).ZE5B                               00242600
.*            ANOP              MULTIPLE PARMS                          00242700
&XRMNAME      SETC  '&RMNAME'   SET XVARIABLE                           00242800
.ZE5B         ANOP  ,                                                   00242900
.*-------------------------------------------------------------------   00243000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00243100
              AIF   (K'&ZXRMNAME LE 0).ZE5R     NOT I/O                 00243200
              AIF   ('&XRMNAME'(1,1) NE '(').ZE5R                       00243300
&ZCGPR        SETC  '&XRMNAME'(2,K'&XRMNAME-2)                          00243400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                         00243500
              AIF   (K'&ZCGPR GT 2).ZE5Q                                00243600
              AIF   ('&ZCGPR' EQ '0').ZE5Q                              00243700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00243800
              AIF   (T'&ZCGPR NE 'N').ZE5Q      INVALID REG NAME        00243900
.ZE5P         ANOP  ,                                                   00244000
              AIF   (T'&ZCGPR NE 'N').ZE5R      NON NUMERIC             00244100
              AIF   ('&ZCGPR' LT '2').ZE5Q                              00244200
              AIF   ('&ZCGPR' LE '12').ZE5R                             00244300
.ZE5Q         ANOP  ,                                                   00244400
&ZMS          SETC  '"RMNAME='                                          00244500
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00244600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00244700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00244800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00244900
.ZE5R         ANOP  ,                                                   00245000
.*----------------------------------------------------------------***   00245100
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00245200
              AIF   (N'&URID LE 1).ZE8A         CK NUM                  00245300
&ZMS          SETC  '"URID='                                            00245400
&ZMS          SETC  '&ZMS.&URID"'                                       00245500
&ZMS          SETC  '&ZMS "URID"'                                       00245600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00245700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00245800
.ZE8A         ANOP  ,                                                   00245900
.*-------------------------------------------------------------------   00246000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00246100
              AIF   (K'&URID(1) LE 0).ZE8B      NO PRM                  00246200
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00246300
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00246400
              AIF   (N'&URID GT 1).ZE8B                                 00246500
.*            ANOP              MULTIPLE PARMS                          00246600
&XURID        SETC  '&URID'     SET XVARIABLE                           00246700
.ZE8B         ANOP  ,                                                   00246800
.*-------------------------------------------------------------------   00246900
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00247000
              AIF   (K'&ZXURID LE 0).ZE8R       NOT I/O                 00247100
              AIF   ('&XURID'(1,1) NE '(').ZE8R                         00247200
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00247300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE8P                         00247400
              AIF   (K'&ZCGPR GT 2).ZE8Q                                00247500
              AIF   ('&ZCGPR' EQ '0').ZE8Q                              00247600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00247700
              AIF   (T'&ZCGPR NE 'N').ZE8Q      INVALID REG NAME        00247800
.ZE8P         ANOP  ,                                                   00247900
              AIF   (T'&ZCGPR NE 'N').ZE8R      NON NUMERIC             00248000
              AIF   ('&ZCGPR' LT '2').ZE8Q                              00248100
              AIF   ('&ZCGPR' LE '12').ZE8R                             00248200
.ZE8Q         ANOP  ,                                                   00248300
&ZMS          SETC  '"URID='                                            00248400
&ZMS          SETC  '&ZMS.&URID"'                                       00248500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00248600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00248700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00248800
.ZE8R         ANOP  ,                                                   00248900
.*-------------------------------------------------------------------   00249000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00249100
&ZTLC         SETC 'COMMIT'                                             00249200
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE10A                    00249300
&XREQUEST     SETC  'COMMIT'    SET KEYWORD                             00249400
              AIF   (N'&REQUEST LE 1).ZE10A     CK NUM                  00249500
&ZMS          SETC  '"REQUEST='                                         00249600
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00249700
&ZMS          SETC  '&ZMS "REQUEST"'                                    00249800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00249900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00250000
.ZE10A        ANOP  ,                                                   00250100
.*----------------------------------------------------------------***   00250200
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00250300
              AIF   (N'&URID LE 1).ZE12A        CK NUM                  00250400
&ZMS          SETC  '"URID='                                            00250500
&ZMS          SETC  '&ZMS.&URID"'                                       00250600
&ZMS          SETC  '&ZMS "URID"'                                       00250700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00250800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00250900
.ZE12A        ANOP  ,                                                   00251000
.*-------------------------------------------------------------------   00251100
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00251200
              AIF   (K'&URID(1) LE 0).ZE12B     NO PRM                  00251300
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00251400
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00251500
              AIF   (N'&URID GT 1).ZE12B                                00251600
.*            ANOP              MULTIPLE PARMS                          00251700
&XURID        SETC  '&URID'     SET XVARIABLE                           00251800
.ZE12B        ANOP  ,                                                   00251900
.*-------------------------------------------------------------------   00252000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00252100
              AIF   (K'&ZXURID LE 0).ZE12R      NOT I/O                 00252200
              AIF   ('&XURID'(1,1) NE '(').ZE12R                        00252300
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00252400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE12P                        00252500
              AIF   (K'&ZCGPR GT 2).ZE12Q                               00252600
              AIF   ('&ZCGPR' EQ '0').ZE12Q                             00252700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00252800
              AIF   (T'&ZCGPR NE 'N').ZE12Q     INVALID REG NAME        00252900
.ZE12P        ANOP  ,                                                   00253000
              AIF   (T'&ZCGPR NE 'N').ZE12R     NON NUMERIC             00253100
              AIF   ('&ZCGPR' LT '2').ZE12Q                             00253200
              AIF   ('&ZCGPR' LE '12').ZE12R                            00253300
.ZE12Q        ANOP  ,                                                   00253400
&ZMS          SETC  '"URID='                                            00253500
&ZMS          SETC  '&ZMS.&URID"'                                       00253600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00253700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00253800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00253900
.ZE12R        ANOP  ,                                                   00254000
.*-------------------------------------------------------------------   00254100
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00254200
&ZTLC         SETC 'BACKOUT'                                            00254300
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE14A                    00254400
&XREQUEST     SETC  'BACKOUT'   SET KEYWORD                             00254500
              AIF   (N'&REQUEST LE 1).ZE14A     CK NUM                  00254600
&ZMS          SETC  '"REQUEST='                                         00254700
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00254800
&ZMS          SETC  '&ZMS "REQUEST"'                                    00254900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00255000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00255100
.ZE14A        ANOP  ,                                                   00255200
.*----------------------------------------------------------------***   00255300
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00255400
              AIF   (N'&URID LE 1).ZE16A        CK NUM                  00255500
&ZMS          SETC  '"URID='                                            00255600
&ZMS          SETC  '&ZMS.&URID"'                                       00255700
&ZMS          SETC  '&ZMS "URID"'                                       00255800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00255900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00256000
.ZE16A        ANOP  ,                                                   00256100
.*-------------------------------------------------------------------   00256200
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00256300
              AIF   (K'&URID(1) LE 0).ZE16B     NO PRM                  00256400
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00256500
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00256600
              AIF   (N'&URID GT 1).ZE16B                                00256700
.*            ANOP              MULTIPLE PARMS                          00256800
&XURID        SETC  '&URID'     SET XVARIABLE                           00256900
.ZE16B        ANOP  ,                                                   00257000
.*-------------------------------------------------------------------   00257100
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00257200
              AIF   (K'&ZXURID LE 0).ZE16R      NOT I/O                 00257300
              AIF   ('&XURID'(1,1) NE '(').ZE16R                        00257400
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00257500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE16P                        00257600
              AIF   (K'&ZCGPR GT 2).ZE16Q                               00257700
              AIF   ('&ZCGPR' EQ '0').ZE16Q                             00257800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00257900
              AIF   (T'&ZCGPR NE 'N').ZE16Q     INVALID REG NAME        00258000
.ZE16P        ANOP  ,                                                   00258100
              AIF   (T'&ZCGPR NE 'N').ZE16R     NON NUMERIC             00258200
              AIF   ('&ZCGPR' LT '2').ZE16Q                             00258300
              AIF   ('&ZCGPR' LE '12').ZE16R                            00258400
.ZE16Q        ANOP  ,                                                   00258500
&ZMS          SETC  '"URID='                                            00258600
&ZMS          SETC  '&ZMS.&URID"'                                       00258700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00258800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00258900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00259000
.ZE16R        ANOP  ,                                                   00259100
.*-------------------------------------------------------------------   00259200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00259300
&ZTLC         SETC 'REMOVRM'                                            00259400
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE18A                    00259500
&XREQUEST     SETC  'REMOVRM'   SET KEYWORD                             00259600
              AIF   (N'&REQUEST LE 1).ZE18A     CK NUM                  00259700
&ZMS          SETC  '"REQUEST='                                         00259800
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00259900
&ZMS          SETC  '&ZMS "REQUEST"'                                    00260000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00260100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00260200
.ZE18A        ANOP  ,                                                   00260300
.*----------------------------------------------------------------***   00260400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00260500
              AIF   (N'&RMNAME LE 1).ZE20A      CK NUM                  00260600
&ZMS          SETC  '"RMNAME='                                          00260700
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00260800
&ZMS          SETC  '&ZMS "RMNAME"'                                     00260900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00261000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00261100
.ZE20A        ANOP  ,                                                   00261200
.*-------------------------------------------------------------------   00261300
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00261400
              AIF   (K'&RMNAME(1) LE 0).ZE20B   NO PRM                  00261500
&ZXRMNAME     SETC  'INPUT'     SET IN/OUTPUT                           00261600
&XRMNAME      SETC  '&RMNAME(1)'                SET XVARIABLE           00261700
              AIF   (N'&RMNAME GT 1).ZE20B                              00261800
.*            ANOP              MULTIPLE PARMS                          00261900
&XRMNAME      SETC  '&RMNAME'   SET XVARIABLE                           00262000
.ZE20B        ANOP  ,                                                   00262100
.*-------------------------------------------------------------------   00262200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00262300
              AIF   (K'&ZXRMNAME LE 0).ZE20R    NOT I/O                 00262400
              AIF   ('&XRMNAME'(1,1) NE '(').ZE20R                      00262500
&ZCGPR        SETC  '&XRMNAME'(2,K'&XRMNAME-2)                          00262600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE20P                        00262700
              AIF   (K'&ZCGPR GT 2).ZE20Q                               00262800
              AIF   ('&ZCGPR' EQ '0').ZE20Q                             00262900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00263000
              AIF   (T'&ZCGPR NE 'N').ZE20Q     INVALID REG NAME        00263100
.ZE20P        ANOP  ,                                                   00263200
              AIF   (T'&ZCGPR NE 'N').ZE20R     NON NUMERIC             00263300
              AIF   ('&ZCGPR' LT '2').ZE20Q                             00263400
              AIF   ('&ZCGPR' LE '12').ZE20R                            00263500
.ZE20Q        ANOP  ,                                                   00263600
&ZMS          SETC  '"RMNAME='                                          00263700
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00263800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00263900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00264000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00264100
.ZE20R        ANOP  ,                                                   00264200
.*-------------------------------------------------------------------   00264300
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00264400
&ZTLC         SETC 'UNREGRM'                                            00264500
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE22A                    00264600
&XREQUEST     SETC  'UNREGRM'   SET KEYWORD                             00264700
              AIF   (N'&REQUEST LE 1).ZE22A     CK NUM                  00264800
&ZMS          SETC  '"REQUEST='                                         00264900
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00265000
&ZMS          SETC  '&ZMS "REQUEST"'                                    00265100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00265200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00265300
.ZE22A        ANOP  ,                                                   00265400
.*----------------------------------------------------------------***   00265500
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00265600
              AIF   (N'&RMNAME LE 1).ZE24A      CK NUM                  00265700
&ZMS          SETC  '"RMNAME='                                          00265800
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00265900
&ZMS          SETC  '&ZMS "RMNAME"'                                     00266000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00266100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00266200
.ZE24A        ANOP  ,                                                   00266300
.*-------------------------------------------------------------------   00266400
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00266500
              AIF   (K'&RMNAME(1) LE 0).ZE24B   NO PRM                  00266600
&ZXRMNAME     SETC  'INPUT'     SET IN/OUTPUT                           00266700
&XRMNAME      SETC  '&RMNAME(1)'                SET XVARIABLE           00266800
              AIF   (N'&RMNAME GT 1).ZE24B                              00266900
.*            ANOP              MULTIPLE PARMS                          00267000
&XRMNAME      SETC  '&RMNAME'   SET XVARIABLE                           00267100
.ZE24B        ANOP  ,                                                   00267200
.*-------------------------------------------------------------------   00267300
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00267400
              AIF   (K'&ZXRMNAME LE 0).ZE24R    NOT I/O                 00267500
              AIF   ('&XRMNAME'(1,1) NE '(').ZE24R                      00267600
&ZCGPR        SETC  '&XRMNAME'(2,K'&XRMNAME-2)                          00267700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE24P                        00267800
              AIF   (K'&ZCGPR GT 2).ZE24Q                               00267900
              AIF   ('&ZCGPR' EQ '0').ZE24Q                             00268000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00268100
              AIF   (T'&ZCGPR NE 'N').ZE24Q     INVALID REG NAME        00268200
.ZE24P        ANOP  ,                                                   00268300
              AIF   (T'&ZCGPR NE 'N').ZE24R     NON NUMERIC             00268400
              AIF   ('&ZCGPR' LT '2').ZE24Q                             00268500
              AIF   ('&ZCGPR' LE '12').ZE24R                            00268600
.ZE24Q        ANOP  ,                                                   00268700
&ZMS          SETC  '"RMNAME='                                          00268800
&ZMS          SETC  '&ZMS.&RMNAME"'                                     00268900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00269000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00269100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00269200
.ZE24R        ANOP  ,                                                   00269300
.*-------------------------------------------------------------------   00269400
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00269500
&ZTLC         SETC 'FORGET'                                             00269600
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE26A                    00269700
&XREQUEST     SETC  'FORGET'    SET KEYWORD                             00269800
              AIF   (N'&REQUEST LE 1).ZE26A     CK NUM                  00269900
&ZMS          SETC  '"REQUEST='                                         00270000
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00270100
&ZMS          SETC  '&ZMS "REQUEST"'                                    00270200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00270300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00270400
.ZE26A        ANOP  ,                                                   00270500
.*----------------------------------------------------------------***   00270600
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00270700
              AIF   (N'&URID LE 1).ZE28A        CK NUM                  00270800
&ZMS          SETC  '"URID='                                            00270900
&ZMS          SETC  '&ZMS.&URID"'                                       00271000
&ZMS          SETC  '&ZMS "URID"'                                       00271100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00271200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00271300
.ZE28A        ANOP  ,                                                   00271400
.*-------------------------------------------------------------------   00271500
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00271600
              AIF   (K'&URID(1) LE 0).ZE28B     NO PRM                  00271700
&ZXURID       SETC  'INPUT'     SET IN/OUTPUT                           00271800
&XURID        SETC  '&URID(1)'  SET XVARIABLE                           00271900
              AIF   (N'&URID GT 1).ZE28B                                00272000
.*            ANOP              MULTIPLE PARMS                          00272100
&XURID        SETC  '&URID'     SET XVARIABLE                           00272200
.ZE28B        ANOP  ,                                                   00272300
.*-------------------------------------------------------------------   00272400
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00272500
              AIF   (K'&ZXURID LE 0).ZE28R      NOT I/O                 00272600
              AIF   ('&XURID'(1,1) NE '(').ZE28R                        00272700
&ZCGPR        SETC  '&XURID'(2,K'&XURID-2)                              00272800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE28P                        00272900
              AIF   (K'&ZCGPR GT 2).ZE28Q                               00273000
              AIF   ('&ZCGPR' EQ '0').ZE28Q                             00273100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00273200
              AIF   (T'&ZCGPR NE 'N').ZE28Q     INVALID REG NAME        00273300
.ZE28P        ANOP  ,                                                   00273400
              AIF   (T'&ZCGPR NE 'N').ZE28R     NON NUMERIC             00273500
              AIF   ('&ZCGPR' LT '2').ZE28Q                             00273600
              AIF   ('&ZCGPR' LE '12').ZE28R                            00273700
.ZE28Q        ANOP  ,                                                   00273800
&ZMS          SETC  '"URID='                                            00273900
&ZMS          SETC  '&ZMS.&URID"'                                       00274000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00274100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00274200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00274300
.ZE28R        ANOP  ,                                                   00274400
.*------------------------------------------------------------------    00274500
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00274600
.ZE30         AIF   (K'&XREQUEST GT 0).ZE30A                            00274700
              AIF   (K'&REQUEST(1) LE 0).ZE30B                          00274800
&ZMS          SETC  '"REQUEST='                                         00274900
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00275000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00275100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00275200
&ZMS          SETC  '&ZMS "REMOVINT",'                                  00275300
&ZMS          SETC  '&ZMS "COMMIT",'                                    00275400
&ZMS          SETC  '&ZMS "BACKOUT",'                                   00275500
&ZMS          SETC  '&ZMS "REMOVRM",'                                   00275600
&ZMS          SETC  '&ZMS "UNREGRM",'                                   00275700
&ZMS          SETC  '&ZMS OR "FORGET".'                                 00275800
              MNOTE 8,' &ZMS '                                          00275900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00276000
              AGO   .ZE30B                                              00276100
.*                                                                      00276200
.ZE30A        ANOP  ,                                                   00276300
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00276400
.ZE30B        ANOP  ,                                                   00276500
.*----------------------------------------------------------------***   00276600
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00276700
              AIF   (N'&GNAME LE 1).ZE32A       CK NUM                  00276800
&ZMS          SETC  '"GNAME='                                           00276900
&ZMS          SETC  '&ZMS.&GNAME"'                                      00277000
&ZMS          SETC  '&ZMS "GNAME"'                                      00277100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00277200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00277300
.ZE32A        ANOP  ,                                                   00277400
.*-------------------------------------------------------------------   00277500
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00277600
              AIF   (K'&GNAME(1) LE 0).ZE32B    NO PRM                  00277700
&ZXGNAME      SETC  'INPUT'     SET IN/OUTPUT                           00277800
&XGNAME       SETC  '&GNAME(1)'                 SET XVARIABLE           00277900
              AIF   (N'&GNAME GT 1).ZE32B                               00278000
.*            ANOP              MULTIPLE PARMS                          00278100
&XGNAME       SETC  '&GNAME'    SET XVARIABLE                           00278200
.ZE32B        ANOP  ,                                                   00278300
.*-------------------------------------------------------------------   00278400
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00278500
              AIF   (K'&ZXGNAME LE 0).ZE32R     NOT I/O                 00278600
              AIF   ('&XGNAME'(1,1) NE '(').ZE32R                       00278700
&ZCGPR        SETC  '&XGNAME'(2,K'&XGNAME-2)                            00278800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE32P                        00278900
              AIF   (K'&ZCGPR GT 2).ZE32Q                               00279000
              AIF   ('&ZCGPR' EQ '0').ZE32Q                             00279100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00279200
              AIF   (T'&ZCGPR NE 'N').ZE32Q     INVALID REG NAME        00279300
.ZE32P        ANOP  ,                                                   00279400
              AIF   (T'&ZCGPR NE 'N').ZE32R     NON NUMERIC             00279500
              AIF   ('&ZCGPR' LT '2').ZE32Q                             00279600
              AIF   ('&ZCGPR' LE '12').ZE32R                            00279700
.ZE32Q        ANOP  ,                                                   00279800
&ZMS          SETC  '"GNAME='                                           00279900
&ZMS          SETC  '&ZMS.&GNAME"'                                      00280000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00280100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00280200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00280300
.ZE32R        ANOP  ,                                                   00280400
.*----------------------------------------------------------------***   00280500
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00280600
              AIF   (N'&SYSNAME LE 1).ZE35A     CK NUM                  00280700
&ZMS          SETC  '"SYSNAME='                                         00280800
&ZMS          SETC  '&ZMS.&SYSNAME"'                                    00280900
&ZMS          SETC  '&ZMS "SYSNAME"'                                    00281000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00281100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00281200
.ZE35A        ANOP  ,                                                   00281300
.*-------------------------------------------------------------------   00281400
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00281500
              AIF   (K'&SYSNAME(1) LE 0).ZE35B  NO PRM                  00281600
&ZXSYSNAME    SETC  'INPUT'     SET IN/OUTPUT                           00281700
&XSYSNAME     SETC  '&SYSNAME(1)'               SET XVARIABLE           00281800
              AIF   (N'&SYSNAME GT 1).ZE35B                             00281900
.*            ANOP              MULTIPLE PARMS                          00282000
&XSYSNAME     SETC  '&SYSNAME'  SET XVARIABLE                           00282100
.ZE35B        ANOP  ,                                                   00282200
.*-------------------------------------------------------------------   00282300
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00282400
              AIF   (K'&ZXSYSNAME LE 0).ZE35R   NOT I/O                 00282500
              AIF   ('&XSYSNAME'(1,1) NE '(').ZE35R                     00282600
&ZCGPR        SETC  '&XSYSNAME'(2,K'&XSYSNAME-2)                        00282700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE35P                        00282800
              AIF   (K'&ZCGPR GT 2).ZE35Q                               00282900
              AIF   ('&ZCGPR' EQ '0').ZE35Q                             00283000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00283100
              AIF   (T'&ZCGPR NE 'N').ZE35Q     INVALID REG NAME        00283200
.ZE35P        ANOP  ,                                                   00283300
              AIF   (T'&ZCGPR NE 'N').ZE35R     NON NUMERIC             00283400
              AIF   ('&ZCGPR' LT '2').ZE35Q                             00283500
              AIF   ('&ZCGPR' LE '12').ZE35R                            00283600
.ZE35Q        ANOP  ,                                                   00283700
&ZMS          SETC  '"SYSNAME='                                         00283800
&ZMS          SETC  '&ZMS.&SYSNAME"'                                    00283900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00284000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00284100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00284200
.ZE35R        ANOP  ,                                                   00284300
.*----------------------------------------------------------------***   00284400
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00284500
              AIF   (N'&RCTABLE LE 1).ZE38A     CK NUM                  00284600
&ZMS          SETC  '"RCTABLE='                                         00284700
&ZMS          SETC  '&ZMS.&RCTABLE"'                                    00284800
&ZMS          SETC  '&ZMS "RCTABLE"'                                    00284900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00285000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00285100
.ZE38A        ANOP  ,                                                   00285200
.*-------------------------------------------------------------------   00285300
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00285400
              AIF   (K'&RCTABLE(1) LE 0).ZE38B  NO PRM                  00285500
&ZXRCTABLE    SETC  'INPUT'     SET IN/OUTPUT                           00285600
&XRCTABLE     SETC  '&RCTABLE(1)'               SET XVARIABLE           00285700
              AIF   (N'&RCTABLE GT 1).ZE38B                             00285800
.*            ANOP              MULTIPLE PARMS                          00285900
&XRCTABLE     SETC  '&RCTABLE'  SET XVARIABLE                           00286000
.ZE38B        ANOP  ,                                                   00286100
.*-------------------------------------------------------------------   00286200
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00286300
              AIF   (K'&ZXRCTABLE LE 0).ZE38R   NOT I/O                 00286400
              AIF   ('&XRCTABLE'(1,1) NE '(').ZE38R                     00286500
&ZCGPR        SETC  '&XRCTABLE'(2,K'&XRCTABLE-2)                        00286600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE38P                        00286700
              AIF   (K'&ZCGPR GT 2).ZE38Q                               00286800
              AIF   ('&ZCGPR' EQ '0').ZE38Q                             00286900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00287000
              AIF   (T'&ZCGPR NE 'N').ZE38Q     INVALID REG NAME        00287100
.ZE38P        ANOP  ,                                                   00287200
              AIF   (T'&ZCGPR NE 'N').ZE38R     NON NUMERIC             00287300
              AIF   ('&ZCGPR' LT '2').ZE38Q                             00287400
              AIF   ('&ZCGPR' LE '12').ZE38R                            00287500
.ZE38Q        ANOP  ,                                                   00287600
&ZMS          SETC  '"RCTABLE='                                         00287700
&ZMS          SETC  '&ZMS.&RCTABLE"'                                    00287800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00287900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00288000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00288100
.ZE38R        ANOP  ,                                                   00288200
.*----------------------------------------------------------------***   00288300
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         00288400
              AIF   (N'&RCNUM LE 1).ZE40A       CK NUM                  00288500
&ZMS          SETC  '"RCNUM='                                           00288600
&ZMS          SETC  '&ZMS.&RCNUM"'                                      00288700
&ZMS          SETC  '&ZMS "RCNUM"'                                      00288800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00288900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00289000
.ZE40A        ANOP  ,                                                   00289100
.*-------------------------------------------------------------------   00289200
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    00289300
              AIF   (K'&RCNUM(1) LE 0).ZE40B    NO PRM                  00289400
&ZXRCNUM      SETC  'OUTPUT'    SET IN/OUTPUT                           00289500
&XRCNUM       SETC  '&RCNUM(1)'                 SET XVARIABLE           00289600
              AIF   (N'&RCNUM GT 1).ZE40B                               00289700
.*            ANOP              MULTIPLE PARMS                          00289800
&XRCNUM       SETC  '&RCNUM'    SET XVARIABLE                           00289900
.ZE40B        ANOP  ,                                                   00290000
.*-------------------------------------------------------------------   00290100
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00290200
              AIF   (K'&ZXRCNUM LE 0).ZE40R     NOT I/O                 00290300
              AIF   ('&XRCNUM'(1,1) NE '(').ZE40R                       00290400
&ZCGPR        SETC  '&XRCNUM'(2,K'&XRCNUM-2)                            00290500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE40P                        00290600
              AIF   (K'&ZCGPR GT 2).ZE40Q                               00290700
              AIF   ('&ZCGPR' EQ '0').ZE40Q                             00290800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00290900
              AIF   (T'&ZCGPR NE 'N').ZE40Q     INVALID REG NAME        00291000
.ZE40P        ANOP  ,                                                   00291100
              AIF   (T'&ZCGPR NE 'N').ZE40R     NON NUMERIC             00291200
              AIF   ('&ZCGPR' LT '2').ZE40Q                             00291300
              AIF   ('&ZCGPR' LE '12').ZE40R                            00291400
.ZE40Q        ANOP  ,                                                   00291500
&ZMS          SETC  '"RCNUM='                                           00291600
&ZMS          SETC  '&ZMS.&RCNUM"'                                      00291700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00291800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00291900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00292000
.ZE40R        ANOP  ,                                                   00292100
.*----------------------------------------------------------------***   00292200
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00292300
              AIF   (N'&RETCODE LE 1).ZE44A     CK NUM                  00292400
&ZMS          SETC  '"RETCODE='                                         00292500
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00292600
&ZMS          SETC  '&ZMS "RETCODE"'                                    00292700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00292800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00292900
.ZE44A        ANOP  ,                                                   00293000
.*-------------------------------------------------------------------   00293100
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00293200
              AIF   (K'&RETCODE(1) LE 0).ZE44B  NO PRM                  00293300
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00293400
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00293500
              AIF   (N'&RETCODE GT 1).ZE44B                             00293600
.*            ANOP              MULTIPLE PARMS                          00293700
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00293800
.ZE44B        ANOP  ,                                                   00293900
.*-------------------------------------------------------------------   00294000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00294100
              AIF   (K'&ZXRETCODE LE 0).ZE44R   NOT I/O                 00294200
              AIF   ('&XRETCODE'(1,1) NE '(').ZE44R                     00294300
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00294400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE44P                        00294500
              AIF   (K'&ZCGPR GT 2).ZE44Q                               00294600
              AIF   ('&ZCGPR' EQ '0').ZE44Q                             00294700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00294800
              AIF   (T'&ZCGPR NE 'N').ZE44Q     INVALID REG NAME        00294900
.ZE44P        ANOP  ,                                                   00295000
              AIF   (T'&ZCGPR NE 'N').ZE44R     NON NUMERIC             00295100
              AIF   ('&ZCGPR' LT '2').ZE44Q                             00295200
              AIF   ('&ZCGPR' LE '12').ZE44R                            00295300
.ZE44Q        ANOP  ,                                                   00295400
&ZMS          SETC  '"RETCODE='                                         00295500
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00295600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00295700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00295800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00295900
.ZE44R        ANOP  ,                                                   00296000
.*----------------------------------------------------------------***   00296100
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00296200
              AIF   (N'&RSNCODE LE 1).ZE47A     CK NUM                  00296300
&ZMS          SETC  '"RSNCODE='                                         00296400
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00296500
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00296600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00296700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00296800
.ZE47A        ANOP  ,                                                   00296900
.*-------------------------------------------------------------------   00297000
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00297100
              AIF   (K'&RSNCODE(1) LE 0).ZE47B  NO PRM                  00297200
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00297300
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00297400
              AIF   (N'&RSNCODE GT 1).ZE47B                             00297500
.*            ANOP              MULTIPLE PARMS                          00297600
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00297700
.ZE47B        ANOP  ,                                                   00297800
.*-------------------------------------------------------------------   00297900
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00298000
              AIF   (K'&ZXRSNCODE LE 0).ZE47R   NOT I/O                 00298100
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE47R                     00298200
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00298300
              AIF   ('&ZCGPR'(1,1) NE '0').ZE47P                        00298400
              AIF   (K'&ZCGPR GT 2).ZE47Q                               00298500
              AIF   ('&ZCGPR' EQ '0').ZE47Q                             00298600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00298700
              AIF   (T'&ZCGPR NE 'N').ZE47Q     INVALID REG NAME        00298800
.ZE47P        ANOP  ,                                                   00298900
              AIF   (T'&ZCGPR NE 'N').ZE47R     NON NUMERIC             00299000
              AIF   ('&ZCGPR' LT '2').ZE47Q                             00299100
              AIF   ('&ZCGPR' LE '12').ZE47R                            00299200
.ZE47Q        ANOP  ,                                                   00299300
&ZMS          SETC  '"RSNCODE='                                         00299400
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00299500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00299600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00299700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00299800
.ZE47R        ANOP  ,                                                   00299900
.******************************************************************     00300000
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00300100
.******************************************************************     00300200
              ACTR  10000                                               00300300
.*----------------------------------------------------------------***   00300400
.***AF.P02 EXTRA POSITIONALS                                            00300500
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00300600
&ZCVAL        SETC  ''          ERROR FIELD                             00300700
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00300800
.ZELIST2      ANOP  ,                                                   00300900
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00301000
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00301100
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00301200
              AGO   .ZELIST2                                            00301300
.*                                                                      00301400
.ZELIST3      ANOP  ,                                                   00301500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00301600
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00301700
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00301800
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00301900
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00302000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00302100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00302200
.ZELISTX      ANOP  ,                                                   00302300
&ZASYSLNDX    SETA  0                                                   00302400
.*-------------------------------------------------------------------   00302500
.***AE.MF02 MF=(SLME)                                                   00302600
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00302700
.*******************************************************************    00302800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00302900
.*******************************************************************    00303000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00303100
.*******************************************************************    00303200
.***AE.01  START OF ATRSRV MACRO CODE                                   00303300
.*******************************************************************    00303400
              LCLC  &M0M0001                 NAME                       00303500
&M0M0001      SETC  '&XLABEL'                SET NAME                   00303600
              AIF   (K'&XLABEL NE 0).XLAB2                              00303700
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00303800
.*                                                                      00303900
.XLAB2        ANOP  ,                                                   00304000
              AIF   ('&XMF' EQ 'L').XLAB3                               00304100
&M0M0001 DS    0H                             ATRSRV-5                  00304200
.XLAB3        ANOP  ,                                                   00304300
.*******************************************************************    00304400
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00304500
.*******************************************************************    00304600
              PUSH  PRINT                                               00304700
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00304800
              PRINT OFF         ++ PR01                                 00304900
              AGO   .ZPRNTXX                                            00305000
.ZPRINTX      PRINT ON                                                  00305100
.ZPRNTXX      ANOP  ,                                                   00305200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00305300
              AIF   ('&REQUEST' EQ 'REMOVRM').SRVD                      00305400
              AIF   ('&GNAME' NE '' AND '&SYSNAME' EQ '').SRVA          00305500
              AGO    .SRVB INVOCATION OKAY                              00305600
.SRVA         ANOP  ,                                                   00305700
&ZMS          SETC  'THE "SYSNAME" KEY'                                 00305800
&ZMS          SETC  '&ZMS MUST BE SPECIFIED'                            00305900
              MNOTE 8,'&ZMS IF THE "GNAME" KEY IS SPECIFIED'            00306000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00306100
.SRVB         ANOP  ,                                                   00306200
              AIF   ('&SYSNAME' NE '' AND '&GNAME' EQ '').SRVC          00306300
              AGO    .SRVD INVOCATION OKAY                              00306400
.SRVC         ANOP  ,                                                   00306500
&ZMS          SETC  'THE "GNAME" KEY'                                   00306600
&ZMS          SETC  '&ZMS MUST BE SPECIFIED'                            00306700
              MNOTE 8,'&ZMS IF THE "SYSNAME" KEY IS SPECIFIED'          00306800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00306900
.SRVD         ANOP  ,                                                   00307000
.* Correct the Version for REMOVRM                                      00307100
              AIF   ('&REQUEST' NE 'REMOVRM').SRVE                      00307200
              AIF   (&XPLISTVER NE 2).SRVE                              00307300
&XPLISTVER    SETA  3                                                   00307400
.SRVE         ANOP  ,                                                   00307500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00307600
.********************************************************************   00307700
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00307800
.********************************************************************   00307900
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00308000
                      LCLA  &ZOPN1         INVOCATION INDEX             00308100
                      LCLC  &ZOPL(4095)    LABEL                        00308200
                      LCLC  &ZOPO(4095)    OPERATION                    00308300
                      LCLC  &ZOPV(4095)    VALUE                        00308400
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00308500
.*                                                                      00308600
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00308700
.******************************************************************     00308800
.***AL.L10 ATRSRV FMT=LIST MF=S!L PARAMETERS                            00308900
.******************************************************************     00309000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00309100
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00309200
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00309300
&XMFATTR              SETC  '0D'                                        00309400
.*                                                                      00309500
&ZOPN                 SETA  &ZOPN+1                                     00309600
&ZOPL(&ZOPN)          SETC  ' '                                         00309700
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00309800
&ZOPO(&ZOPN)          SETC  'B'                                         00309900
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00310000
                      AGO   .ZALVL6B                                    00310100
.ZALVL6A              ANOP                                              00310200
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00310300
&ZOPV(&ZOPN)          SETC  '4,8'                                       00310400
&ZOPN                 SETA  &ZOPN+1                                     00310500
&ZOPL(&ZOPN)          SETC  ' '                                         00310600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00310700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00310800
.ZALVL6B              ANOP                                              00310900
&ZOPD(&ZOPN)          SETC  '++ ATRSRV ARG PARMS'                       00311000
.*                                                                      00311100
&ZOPN                 SETA  &ZOPN+1                                     00311200
&ZOPL(&ZOPN)          SETC  ' '                                         00311300
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00311400
&ZOPV(&ZOPN)          SETC  '1'                                         00311500
&ZOPD(&ZOPN)          SETC  ' '                                         00311600
.*                                                                      00311700
.ZLMFSL2              ANOP  ,                                           00311800
.*-------------------------------------------------------------------   00311900
.***AM.L00  ATRSRV FMT=LIST name                                        00312000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00312100
&ZOPN                 SETA &ZOPN+1                                      00312200
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00312300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00312400
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00312500
&ZOPD(&ZOPN)          SETC '++ ATRSRV NAME'                             00312600
.ZLMFSL2M             ANOP  ,                                           00312700
.*-------------------------------------------------------------------   00312800
.***AM.L01  ATRSRV FMT=LIST PARAMETERS                                  00312900
&ZOPN                 SETA &ZOPN+1                                      00313000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00313100
&ZOPO(&ZOPN)          SETC 'DS'                                         00313200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00313300
&ZOPD(&ZOPN)          SETC '++ ATRSRV PARM LIST'                        00313400
.*-------------------------------------------------------------------   00313500
.***AM.L09  XID CL8                                                     00313600
&ZOPN                 SETA &ZOPN+1                                      00313700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XID'                              00313800
&ZOPO(&ZOPN)          SETC 'DS'                                         00313900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00314000
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00314100
.*-------------------------------------------------------------------   00314200
.***AM.L02 XVERSION XL1                                                 00314300
&ZOPN                 SETA &ZOPN+1                                      00314400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00314500
&ZOPO(&ZOPN)          SETC 'DS'                                         00314600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00314700
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00314800
.*-------------------------------------------------------------------   00314900
.***AM.L03 XFLAGS BL.16                                                 00315000
&ZOPN                 SETA &ZOPN+1                                      00315100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00315200
&ZOPO(&ZOPN)          SETC 'DS'                                         00315300
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00315400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00315500
.*                                                                      00315600
&ZOPN                 SETA  &ZOPN+1                                     00315700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_COMMIT'                 00315800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00315900
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00316000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00316100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).COMMIT'                       00316200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00316300
.*                                                                      00316400
&ZOPN                 SETA  &ZOPN+1                                     00316500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_BACKOUT'                00316600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00316700
&ZOPV(&ZOPN)          SETC  'B''0100000000000000'''                     00316800
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00316900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).BACKOUT'                      00317000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00317100
.*                                                                      00317200
&ZOPN                 SETA  &ZOPN+1                                     00317300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_REMOVINT'               00317400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00317500
&ZOPV(&ZOPN)          SETC  'B''0010000000000000'''                     00317600
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00317700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REMOVINT'                     00317800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00317900
.*                                                                      00318000
&ZOPN                 SETA  &ZOPN+1                                     00318100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_URID'                    00318200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00318300
&ZOPV(&ZOPN)          SETC  'B''0001000000000000'''                     00318400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00318500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).URID'                         00318600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00318700
.*                                                                      00318800
&ZOPN                 SETA  &ZOPN+1                                     00318900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_RMNAME'                  00319000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00319100
&ZOPV(&ZOPN)          SETC  'B''0000100000000000'''                     00319200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00319300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RMNAME'                       00319400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00319500
.*                                                                      00319600
&ZOPN                 SETA  &ZOPN+1                                     00319700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_GNAME'                   00319800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00319900
&ZOPV(&ZOPN)          SETC  'B''0000010000000000'''                     00320000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00320100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GNAME'                        00320200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00320300
.*                                                                      00320400
&ZOPN                 SETA  &ZOPN+1                                     00320500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SYSNAME'                 00320600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00320700
&ZOPV(&ZOPN)          SETC  'B''0000001000000000'''                     00320800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00320900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SYSNAME'                      00321000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00321100
.*                                                                      00321200
&ZOPN                 SETA  &ZOPN+1                                     00321300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_REMOVRM'                00321400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00321500
&ZOPV(&ZOPN)          SETC  'B''0000000100000000'''                     00321600
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00321700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).REMOVRM'                      00321800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00321900
.*                                                                      00322000
&ZOPN                 SETA  &ZOPN+1                                     00322100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_UNREGRM'                00322200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00322300
&ZOPV(&ZOPN)          SETC  'B''0000000010000000'''                     00322400
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00322500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UNREGRM'                      00322600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00322700
.*                                                                      00322800
&ZOPN                 SETA  &ZOPN+1                                     00322900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_FORGET'                 00323000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00323100
&ZOPV(&ZOPN)          SETC  'B''0000000001000000'''                     00323200
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00323300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).FORGET'                       00323400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00323500
.*-------------------------------------------------------------------   00323600
.***AM.L09  XRSV00002 CL1                                               00323700
&ZOPN                 SETA &ZOPN+1                                      00323800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV00002'                        00323900
&ZOPO(&ZOPN)          SETC 'DS'                                         00324000
&ZOPV(&ZOPN)          SETC 'CL1'                                        00324100
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00324200
.*-------------------------------------------------------------------   00324300
.***AM.L09  XURID CL16                                                  00324400
&ZOPN                 SETA &ZOPN+1                                      00324500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XURID'                            00324600
&ZOPO(&ZOPN)          SETC 'DS'                                         00324700
&ZOPV(&ZOPN)          SETC 'CL16'                                       00324800
&ZOPD(&ZOPN)          SETC '++ &ZXURID '                                00324900
.*-------------------------------------------------------------------   00325000
.***AM.L09  XRMNAME CL32                                                00325100
&ZOPN                 SETA &ZOPN+1                                      00325200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRMNAME'                          00325300
&ZOPO(&ZOPN)          SETC 'DS'                                         00325400
&ZOPV(&ZOPN)          SETC 'CL32'                                       00325500
&ZOPD(&ZOPN)          SETC '++ &ZXRMNAME '                              00325600
.*-------------------------------------------------------------------   00325700
.***AM.MLM2 SAVED LOCATION COUNTER                                      00325800
                      AIF  (&XPLISTVER GE 2).ZL17LA                     00325900
                      AIF  ('&ZENDBASEPL' NE '').ZL17LA                 00326000
&ZENDBASEPL           SETC 'YES'                                        00326100
&ZOPN                 SETA &ZOPN+1                                      00326200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00326300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00326400
&ZOPV(&ZOPN)          SETC '*'                                          00326500
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00326600
.ZL17LA               ANOP  ,                                           00326700
.*-------------------------------------------------------------------   00326800
.***AM.LVER1                                                            00326900
                      AIF  (&XPLISTVER LT 2).ZL17L                      00327000
.*-------------------------------------------------------------------   00327100
.*-------------------------------------------------------------------   00327200
.***AM.L09  XGNAME CL8                                                  00327300
&ZOPN                 SETA &ZOPN+1                                      00327400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGNAME'                           00327500
&ZOPO(&ZOPN)          SETC 'DS'                                         00327600
&ZOPV(&ZOPN)          SETC 'CL8'                                        00327700
&ZOPD(&ZOPN)          SETC '++ &ZXGNAME '                               00327800
.*-------------------------------------------------------------------   00327900
.***AM.LVER2                                                            00328000
.ZL17L                ANOP  ,                                           00328100
.*-------------------------------------------------------------------   00328200
.*-------------------------------------------------------------------   00328300
.***AM.LVER1                                                            00328400
                      AIF  (&XPLISTVER LT 2).ZL18L                      00328500
.*-------------------------------------------------------------------   00328600
.*-------------------------------------------------------------------   00328700
.***AM.L09  XSYSNAME CL8                                                00328800
&ZOPN                 SETA &ZOPN+1                                      00328900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSNAME'                         00329000
&ZOPO(&ZOPN)          SETC 'DS'                                         00329100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00329200
&ZOPD(&ZOPN)          SETC '++ &ZXSYSNAME '                             00329300
.*-------------------------------------------------------------------   00329400
.***AM.LVER2                                                            00329500
.ZL18L                ANOP  ,                                           00329600
.*-------------------------------------------------------------------   00329700
.*-------------------------------------------------------------------   00329800
.***AM.LVER1                                                            00329900
                      AIF  (&XPLISTVER LT 2).ZL19L                      00330000
.*-------------------------------------------------------------------   00330100
.*-------------------------------------------------------------------   00330200
.***AM.L09  XRCTABLE A                                                  00330300
&ZOPN                 SETA &ZOPN+1                                      00330400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRCTABLE'                         00330500
&ZOPO(&ZOPN)          SETC 'DS'                                         00330600
&ZOPV(&ZOPN)          SETC 'A'                                          00330700
&ZOPD(&ZOPN)          SETC '++ &ZXRCTABLE '                             00330800
.*-------------------------------------------------------------------   00330900
.***AM.LVER2                                                            00331000
.ZL19L                ANOP  ,                                           00331100
.*-------------------------------------------------------------------   00331200
.*-------------------------------------------------------------------   00331300
.***AM.LVER1                                                            00331400
                      AIF  (&XPLISTVER LT 2).ZL20L                      00331500
.*-------------------------------------------------------------------   00331600
.*-------------------------------------------------------------------   00331700
.***AM.L09  XRCNUM F                                                    00331800
&ZOPN                 SETA &ZOPN+1                                      00331900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRCNUM'                           00332000
&ZOPO(&ZOPN)          SETC 'DS'                                         00332100
&ZOPV(&ZOPN)          SETC 'F'                                          00332200
&ZOPD(&ZOPN)          SETC '++ &ZXRCNUM '                               00332300
.*-------------------------------------------------------------------   00332400
.***AM.LVER2                                                            00332500
.ZL20L                ANOP  ,                                           00332600
.*-------------------------------------------------------------------   00332700
.*-------------------------------------------------------------------   00332800
.***AM.MLM2 SAVED LOCATION COUNTER                                      00332900
                      AIF  (&XPLISTVER GE 3).ZL21LA                     00333000
                      AIF  ('&ZENDBASEPL' NE '').ZL21LA                 00333100
&ZENDBASEPL           SETC 'YES'                                        00333200
&ZOPN                 SETA &ZOPN+1                                      00333300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00333400
&ZOPO(&ZOPN)          SETC 'EQU'                                        00333500
&ZOPV(&ZOPN)          SETC '*'                                          00333600
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00333700
.ZL21LA               ANOP  ,                                           00333800
.*-------------------------------------------------------------------   00333900
.***AM.LVER1                                                            00334000
                      AIF  (&XPLISTVER LT 3).ZL21L                      00334100
.*-------------------------------------------------------------------   00334200
.*-------------------------------------------------------------------   00334300
.***AM.L09  XPLISTLEN XL2                                               00334400
&ZOPN                 SETA &ZOPN+1                                      00334500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00334600
&ZOPO(&ZOPN)          SETC 'DS'                                         00334700
&ZOPV(&ZOPN)          SETC 'XL2'                                        00334800
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00334900
.*-------------------------------------------------------------------   00335000
.***AM.LVER2                                                            00335100
.ZL21L                ANOP  ,                                           00335200
.*-------------------------------------------------------------------   00335300
.*-------------------------------------------------------------------   00335400
.***AM.LVER1                                                            00335500
                      AIF  (&XPLISTVER LT 3).ZL22L                      00335600
.*-------------------------------------------------------------------   00335700
.*-------------------------------------------------------------------   00335800
.***AM.L09  XRSVDELETERMAREA CL4                                        00335900
&ZOPN                 SETA &ZOPN+1                                      00336000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVDELETERMAREA'                 00336100
&ZOPO(&ZOPN)          SETC 'DS'                                         00336200
&ZOPV(&ZOPN)          SETC 'CL4'                                        00336300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00336400
.*-------------------------------------------------------------------   00336500
.***AM.LVER2                                                            00336600
.ZL22L                ANOP  ,                                           00336700
.*-------------------------------------------------------------------   00336800
.*-------------------------------------------------------------------   00336900
.***AM.L10 END OF ATRSRV LIST PARAMETERS                                00337000
&ZOPN                 SETA &ZOPN+1                                      00337100
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00337200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00337300
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00337400
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00337500
.*                                                                      00337600
&ZOPN                 SETA &ZOPN+1                                      00337700
&ZOPL(&ZOPN)          SETC ' '                                          00337800
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00337900
&ZOPV(&ZOPN)          SETC '1'                                          00338000
&ZOPD(&ZOPN)          SETC ' '                                          00338100
.*-------------------------------------------------------------------   00338200
.***AL.L12 ATRSRV FMT=LIST MF=S!L PARAMETERS                            00338300
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00338400
.*                                                                      00338500
&ZOPN                 SETA  &ZOPN+1                                     00338600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00338700
&ZOPO(&ZOPN)          SETC  'DC'                                        00338800
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00338900
&ZOPD(&ZOPN)          SETC  '++ ATRSRV ARG PARMS'                       00339000
.*                                                                      00339100
.ZLMFSLX              ANOP  ,                                           00339200
.*-------------------------------------------------------------------   00339300
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00339400
&ZPLLEN               SETA 60                                           00339500
.*                                                                      00339600
                      AIF  (&XPLISTVER LT 2).ZLLEN2Z                    00339700
&ZPLLEN               SETA 84                                           00339800
.ZLLEN2Z              ANOP  ,                                           00339900
.*                                                                      00340000
                      AIF  (&XPLISTVER LT 3).ZLLEN3Z                    00340100
&ZPLLEN               SETA 90                                           00340200
.ZLLEN3Z              ANOP  ,                                           00340300
.*                                                                      00340400
.******************************************************************     00340500
.***AI.L01 ATRSRV FMT=LIST FILL IN PARAMETER AREA                       00340600
.******************************************************************     00340700
                      ACTR  10000                                       00340800
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00340900
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00341000
&ZCVAL                SETC  'LAE'          XAX MODE                     00341100
.ZIMFXA               ANOP ,                                            00341200
.*                                                                      00341300
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00341400
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00341500
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00341600
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00341700
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00341800
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00341900
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00342000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00342100
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00342200
&ZOPN                 SETA  &ZOPN+1                                     00342300
&ZOPL(&ZOPN)          SETC  ' '                                         00342400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00342500
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00342600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00342700
                      AGO   .ZIMFNX                                     00342800
.*                                                                      00342900
.ZIMFN2               ANOP ,                                            00343000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00343100
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00343200
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00343300
&ZOPN                 SETA  &ZOPN+1                                     00343400
&ZOPL(&ZOPN)          SETC  ' '                                         00343500
&ZOPO(&ZOPN)          SETC  'LAE'                                       00343600
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00343700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00343800
                      AGO   .ZIMFNX                                     00343900
.ZIMFNX1              ANOP ,                                            00344000
&ZOPN                 SETA  &ZOPN+1                                     00344100
&ZOPL(&ZOPN)          SETC  ' '                                         00344200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00344300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00344400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00344500
.ZIMFNX               ANOP ,                                            00344600
.********************************************************************   00344700
.***AI.L02 ATRSRV FMT=LIST INITIALIZE PARAMETER AREA                    00344800
.********************************************************************   00344900
.***AI.L03 MF=(SLME)                                                    00345000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00345100
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00345200
.*                                                                      00345300
&ZOPN                 SETA  &ZOPN+1                                     00345400
&ZOPL(&ZOPN)          SETC  ' '                                         00345500
&ZOPO(&ZOPN)          SETC  'XC'                                        00345600
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00345700
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00345800
.ZIMFLX               ANOP  ,                                           00345900
.*-------------------------------------------------------------------   00346000
.***AI.L60 XID CL8                                                      00346100
&ZOPN                 SETA  &ZOPN+1                                     00346200
&ZOPL(&ZOPN)          SETC  ' '                                         00346300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00346400
&ZOPV(&ZOPN)          SETC  '0(8,1),=CL8''ATRSRV  '''                   00346500
&ZOPD(&ZOPN)          SETC  '++ CL8 CONSTANT'                           00346600
.*-------------------------------------------------------------------   00346700
.***AI.L04B XVERSION XL1                                                00346800
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00346900
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVY            00347000
.ZIMFVX               ANOP  ,                                           00347100
                      AIF   ('&PLISTVER' EQ '').ZIMFVZ                  00347200
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVZ            00347300
.ZIMFVY               ANOP  ,                                           00347400
&ZOPN                 SETA  &ZOPN+1                                     00347500
&ZOPL(&ZOPN)          SETC  ' '                                         00347600
&ZOPO(&ZOPN)          SETC  'MVI'                                       00347700
&ZOPV(&ZOPN)          SETC  '8(1),&XPLISTVER'                           00347800
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00347900
.ZIMFVZ               ANOP  ,                                           00348000
.*-------------------------------------------------------------------   00348100
.***AI.L05 XFLAGS BL2                                                   00348200
&ZW                   SETC  ''                                          00348300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00348400
&ZMS                  SETC  ''                                          00348500
&ZC                   SETC  ''                                          00348600
.*-------------------------------------------------------------------   00348700
.***AI.L08 XFLAGS "COMMIT"                                              00348800
.***      BL2'1XXXXXXXXXXXXXXX'                                         00348900
         AIF   ('&XREQUEST' NE 'COMMIT').ZI4A                           00349000
&ZW                   SETC  '&ZW.1'                                     00349100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00349200
&ZMS                  SETC  '&ZMS.1'                                    00349300
                      AGO   .ZI4C                                       00349400
.*                                                                      00349500
.ZI4A                 ANOP  ,                                           00349600
&ZW                   SETC  '&ZW.0'                                     00349700
         AIF   ('&ZXREQUEST' EQ '').ZI4B                                00349800
&ZMS                  SETC  '&ZMS.0'                                    00349900
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00350000
                      AGO   .ZI4C                                       00350100
.*                                                                      00350200
.ZI4B                 ANOP  ,                                           00350300
&ZMS                  SETC  '&ZMS.1'                                    00350400
.ZI4C                 ANOP  ,                                           00350500
.*-------------------------------------------------------------------   00350600
.***AI.L08 XFLAGS "BACKOUT"                                             00350700
.***      BL2'X1XXXXXXXXXXXXXX'                                         00350800
         AIF   ('&XREQUEST' NE 'BACKOUT').ZI5A                          00350900
&ZW                   SETC  '&ZW.1'                                     00351000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00351100
&ZMS                  SETC  '&ZMS.1'                                    00351200
                      AGO   .ZI5C                                       00351300
.*                                                                      00351400
.ZI5A                 ANOP  ,                                           00351500
&ZW                   SETC  '&ZW.0'                                     00351600
         AIF   ('&ZXREQUEST' EQ '').ZI5B                                00351700
&ZMS                  SETC  '&ZMS.0'                                    00351800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00351900
                      AGO   .ZI5C                                       00352000
.*                                                                      00352100
.ZI5B                 ANOP  ,                                           00352200
&ZMS                  SETC  '&ZMS.1'                                    00352300
.ZI5C                 ANOP  ,                                           00352400
.*-------------------------------------------------------------------   00352500
.***AI.L08 XFLAGS "REMOVINT"                                            00352600
.***      BL2'XX1XXXXXXXXXXXXX'                                         00352700
         AIF   ('&XREQUEST' NE 'REMOVINT').ZI6A                         00352800
&ZW                   SETC  '&ZW.1'                                     00352900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00353000
&ZMS                  SETC  '&ZMS.1'                                    00353100
                      AGO   .ZI6C                                       00353200
.*                                                                      00353300
.ZI6A                 ANOP  ,                                           00353400
&ZW                   SETC  '&ZW.0'                                     00353500
         AIF   ('&ZXREQUEST' EQ '').ZI6B                                00353600
&ZMS                  SETC  '&ZMS.0'                                    00353700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00353800
                      AGO   .ZI6C                                       00353900
.*                                                                      00354000
.ZI6B                 ANOP  ,                                           00354100
&ZMS                  SETC  '&ZMS.1'                                    00354200
.ZI6C                 ANOP  ,                                           00354300
.*-------------------------------------------------------------------   00354400
.***AI.L08 XFLAGS "URID"                                                00354500
.***      BL2'XXX1XXXXXXXXXXXX'                                         00354600
         AIF   ('&URID' EQ '').ZI7A                                     00354700
&ZW                   SETC  '&ZW.1'                                     00354800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00354900
&ZMS                  SETC  '&ZMS.0'                                    00355000
                      AGO   .ZI7C                                       00355100
.*                                                                      00355200
.ZI7A                 ANOP  ,                                           00355300
&ZW                   SETC  '&ZW.0'                                     00355400
&ZMS                  SETC  '&ZMS.1'                                    00355500
.ZI7C                 ANOP  ,                                           00355600
.*-------------------------------------------------------------------   00355700
.***AI.L08 XFLAGS "RMNAME"                                              00355800
.***      BL2'XXXX1XXXXXXXXXXX'                                         00355900
         AIF   ('&RMNAME' EQ '').ZI8A                                   00356000
&ZW                   SETC  '&ZW.1'                                     00356100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00356200
&ZMS                  SETC  '&ZMS.0'                                    00356300
                      AGO   .ZI8C                                       00356400
.*                                                                      00356500
.ZI8A                 ANOP  ,                                           00356600
&ZW                   SETC  '&ZW.0'                                     00356700
&ZMS                  SETC  '&ZMS.1'                                    00356800
.ZI8C                 ANOP  ,                                           00356900
.*-------------------------------------------------------------------   00357000
.***AI.L08 XFLAGS "GNAME"                                               00357100
.***      BL2'XXXXX1XXXXXXXXXX'                                         00357200
         AIF   ('&GNAME' EQ '').ZI9A                                    00357300
&ZW                   SETC  '&ZW.1'                                     00357400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00357500
&ZMS                  SETC  '&ZMS.0'                                    00357600
                      AGO   .ZI9C                                       00357700
.*                                                                      00357800
.ZI9A                 ANOP  ,                                           00357900
&ZW                   SETC  '&ZW.0'                                     00358000
&ZMS                  SETC  '&ZMS.1'                                    00358100
.ZI9C                 ANOP  ,                                           00358200
.*-------------------------------------------------------------------   00358300
.***AI.L08 XFLAGS "SYSNAME"                                             00358400
.***      BL2'XXXXXX1XXXXXXXXX'                                         00358500
         AIF   ('&SYSNAME' EQ '').ZI10A                                 00358600
&ZW                   SETC  '&ZW.1'                                     00358700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00358800
&ZMS                  SETC  '&ZMS.0'                                    00358900
                      AGO   .ZI10C                                      00359000
.*                                                                      00359100
.ZI10A                ANOP  ,                                           00359200
&ZW                   SETC  '&ZW.0'                                     00359300
&ZMS                  SETC  '&ZMS.1'                                    00359400
.ZI10C                ANOP  ,                                           00359500
.*-------------------------------------------------------------------   00359600
.***AI.L08 XFLAGS "REMOVRM"                                             00359700
.***      BL2'XXXXXXX1XXXXXXXX'                                         00359800
         AIF   ('&XREQUEST' NE 'REMOVRM').ZI11A                         00359900
&ZW                   SETC  '&ZW.1'                                     00360000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00360100
&ZMS                  SETC  '&ZMS.1'                                    00360200
                      AGO   .ZI11C                                      00360300
.*                                                                      00360400
.ZI11A                ANOP  ,                                           00360500
&ZW                   SETC  '&ZW.0'                                     00360600
         AIF   ('&ZXREQUEST' EQ '').ZI11B                               00360700
&ZMS                  SETC  '&ZMS.0'                                    00360800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00360900
                      AGO   .ZI11C                                      00361000
.*                                                                      00361100
.ZI11B                ANOP  ,                                           00361200
&ZMS                  SETC  '&ZMS.1'                                    00361300
.ZI11C                ANOP  ,                                           00361400
.*-------------------------------------------------------------------   00361500
.***AI.L08 XFLAGS "UNREGRM"                                             00361600
.***      BL2'XXXXXXXX1XXXXXXX'                                         00361700
         AIF   ('&XREQUEST' NE 'UNREGRM').ZI12A                         00361800
&ZW                   SETC  '&ZW.1'                                     00361900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00362000
&ZMS                  SETC  '&ZMS.1'                                    00362100
                      AGO   .ZI12C                                      00362200
.*                                                                      00362300
.ZI12A                ANOP  ,                                           00362400
&ZW                   SETC  '&ZW.0'                                     00362500
         AIF   ('&ZXREQUEST' EQ '').ZI12B                               00362600
&ZMS                  SETC  '&ZMS.0'                                    00362700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00362800
                      AGO   .ZI12C                                      00362900
.*                                                                      00363000
.ZI12B                ANOP  ,                                           00363100
&ZMS                  SETC  '&ZMS.1'                                    00363200
.ZI12C                ANOP  ,                                           00363300
.*-------------------------------------------------------------------   00363400
.***AI.L08 XFLAGS "FORGET"                                              00363500
.***      BL2'XXXXXXXXX1XXXXXX'                                         00363600
         AIF   ('&XREQUEST' NE 'FORGET').ZI13A                          00363700
&ZW                   SETC  '&ZW.1000000'                               00363800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00363900
&ZMS                  SETC  '&ZMS.1111111'                              00364000
                      AGO   .ZI13C                                      00364100
.*                                                                      00364200
.ZI13A                ANOP  ,                                           00364300
&ZW                   SETC  '&ZW.0000000'                               00364400
         AIF   ('&ZXREQUEST' EQ '').ZI13B                               00364500
&ZMS                  SETC  '&ZMS.0111111'                              00364600
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00364700
                      AGO   .ZI13C                                      00364800
.*                                                                      00364900
.ZI13B                ANOP  ,                                           00365000
&ZMS                  SETC  '&ZMS.1111111'                              00365100
.ZI13C                ANOP  ,                                           00365200
.*-------------------------------------------------------------------   00365300
.***AI.L10 XFLAGS BL2                                                   00365400
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI13D              00365500
                      AIF   ('&ZC' NE 'YES').ZI13D                      00365600
&ZOPN                 SETA  &ZOPN+1                                     00365700
&ZOPL(&ZOPN)          SETC  ' '                                         00365800
&ZOPO(&ZOPN)          SETC  'NC'                                        00365900
&ZOPV(&ZOPN)          SETC  '9(2,1),=BL2''&ZMS'''                       00366000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00366100
.ZI13D                ANOP  ,                                           00366200
                      AIF   ('&ZCLNG' NE 'YES').ZI13E  ALL ZERO BITS    00366300
&ZOPN                 SETA  &ZOPN+1                                     00366400
&ZOPL(&ZOPN)          SETC  ' '                                         00366500
&ZOPO(&ZOPN)          SETC  'OC'                                        00366600
&ZOPV(&ZOPN)          SETC  '9(2,1),=BL2''&ZW'''                        00366700
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00366800
.ZI13E                ANOP  ,                                           00366900
.*-------------------------------------------------------------------   00367000
.***AI.L25  XURID CL16                                                  00367100
                      AIF   ('&ZXURID' EQ '').ZI15E                     00367200
                      AIF   ('&ZXURID' EQ 'OUTPUT').ZI15E               00367300
&ZCGPR                SETC  '&XURID'                                    00367400
         AIF   ('&XURID' NE '0').ZI15A                                  00367500
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI15E                          00367600
.*                                                                      00367700
&ZCGPR                SETC  '=XL16''00'''                               00367800
.ZI15A                ANOP  ,                                           00367900
.*                                                                      00368000
                      AIF   ('&XURID'(1,1) NE '(').ZI15B                00368100
&ZCGPR   SETC  '0('.'&XURID'(2,K'&XURID-2).')'                          00368200
                      AGO   .ZI15D                                      00368300
.ZI15B                ANOP  ,                                           00368400
.*                                                                      00368500
                      AIF   ('&URID(1)' EQ '').ZI15I                    00368600
&ZC                   SETC  '0'                                         00368700
                      AIF   ('&XURID' NE '&ZC').ZI15C                   00368800
.ZI15I                ANOP  ,                                           00368900
&ZCGPR                SETC  '=CL16''&XURID'''                           00369000
.ZI15C                ANOP  ,                                           00369100
.*                                                                      00369200
.ZI15D                ANOP  ,                                           00369300
.*                                                                      00369400
&ZOPN                 SETA  &ZOPN+1                                     00369500
&ZOPL(&ZOPN)          SETC  ' '                                         00369600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00369700
&ZOPV(&ZOPN)          SETC  '12(16,1),&ZCGPR'                           00369800
&ZOPD(&ZOPN)          SETC  '++ &ZXURID XURID'                          00369900
.*                                                                      00370000
.ZI15E                ANOP  ,                                           00370100
.*-------------------------------------------------------------------   00370200
.***AI.L25  XRMNAME CL32                                                00370300
                      AIF   ('&ZXRMNAME' EQ '').ZI16E                   00370400
                      AIF   ('&ZXRMNAME' EQ 'OUTPUT').ZI16E             00370500
&ZCGPR                SETC  '&XRMNAME'                                  00370600
         AIF   ('&XRMNAME' NE '0').ZI16A                                00370700
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI16E                          00370800
.*                                                                      00370900
&ZCGPR                SETC  '=XL32''00'''                               00371000
.ZI16A                ANOP  ,                                           00371100
.*                                                                      00371200
                      AIF   ('&XRMNAME'(1,1) NE '(').ZI16B              00371300
&ZCGPR   SETC  '0('.'&XRMNAME'(2,K'&XRMNAME-2).')'                      00371400
                      AGO   .ZI16D                                      00371500
.ZI16B                ANOP  ,                                           00371600
.*                                                                      00371700
                      AIF   ('&RMNAME(1)' EQ '').ZI16I                  00371800
&ZC                   SETC  '0'                                         00371900
                      AIF   ('&XRMNAME' NE '&ZC').ZI16C                 00372000
.ZI16I                ANOP  ,                                           00372100
&ZCGPR                SETC  '=CL32''&XRMNAME'''                         00372200
.ZI16C                ANOP  ,                                           00372300
.*                                                                      00372400
.ZI16D                ANOP  ,                                           00372500
.*                                                                      00372600
&ZOPN                 SETA  &ZOPN+1                                     00372700
&ZOPL(&ZOPN)          SETC  ' '                                         00372800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00372900
&ZOPV(&ZOPN)          SETC  '28(32,1),&ZCGPR'                           00373000
&ZOPD(&ZOPN)          SETC  '++ &ZXRMNAME XRMNAME'                      00373100
.*                                                                      00373200
.ZI16E                ANOP  ,                                           00373300
.*-------------------------------------------------------------------   00373400
.***AI.LVER01                                                           00373500
                      AIF  (&XPLISTVER LT 2).ZI17Z                      00373600
.*-------------------------------------------------------------------   00373700
.***AI.L18  XGNAME CL8                                                  00373800
         AIF   ('&XGNAME' NE 'CURRENT_GNAME').ZI17                      00373900
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI17  CK *        00374000
&ZXGNAME              SETC  ''             RESET INPUT/OUTPUT           00374100
.ZI17                 ANOP  ,                                           00374200
.*-------------------------------------------------------------------   00374300
.***AI.L25  XGNAME CL8                                                  00374400
                      AIF   ('&ZXGNAME' EQ '').ZI17E                    00374500
                      AIF   ('&ZXGNAME' EQ 'OUTPUT').ZI17E              00374600
&ZCGPR                SETC  '&XGNAME'                                   00374700
         AIF   ('&XGNAME' NE 'CURRENT_GNAME').ZI17A                     00374800
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI17E                          00374900
.*                                                                      00375000
&ZCGPR                SETC  '=XL8''00'''                                00375100
.ZI17A                ANOP  ,                                           00375200
.*                                                                      00375300
                      AIF   ('&XGNAME'(1,1) NE '(').ZI17B               00375400
&ZCGPR   SETC  '0('.'&XGNAME'(2,K'&XGNAME-2).')'                        00375500
.ZI17B                ANOP  ,                                           00375600
.*                                                                      00375700
&ZOPN                 SETA  &ZOPN+1                                     00375800
&ZOPL(&ZOPN)          SETC  ' '                                         00375900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00376000
&ZOPV(&ZOPN)          SETC  '60(8,1),&ZCGPR'                            00376100
&ZOPD(&ZOPN)          SETC  '++ &ZXGNAME XGNAME'                        00376200
.*                                                                      00376300
.ZI17E                ANOP  ,                                           00376400
.*-------------------------------------------------------------------   00376500
.***AI.LVER02                                                           00376600
.ZI17Z                ANOP  ,                                           00376700
.*-------------------------------------------------------------------   00376800
.***AI.LVER01                                                           00376900
                      AIF  (&XPLISTVER LT 2).ZI18Z                      00377000
.*-------------------------------------------------------------------   00377100
.***AI.L18  XSYSNAME CL8                                                00377200
         AIF   ('&XSYSNAME' NE 'CURRENT_SYSNAME').ZI18                  00377300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI18  CK *        00377400
&ZXSYSNAME            SETC  ''             RESET INPUT/OUTPUT           00377500
.ZI18                 ANOP  ,                                           00377600
.*-------------------------------------------------------------------   00377700
.***AI.L25  XSYSNAME CL8                                                00377800
                      AIF   ('&ZXSYSNAME' EQ '').ZI18E                  00377900
                      AIF   ('&ZXSYSNAME' EQ 'OUTPUT').ZI18E            00378000
&ZCGPR                SETC  '&XSYSNAME'                                 00378100
         AIF   ('&XSYSNAME' NE 'CURRENT_SYSNAME').ZI18A                 00378200
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI18E                          00378300
.*                                                                      00378400
&ZCGPR                SETC  '=XL8''00'''                                00378500
.ZI18A                ANOP  ,                                           00378600
.*                                                                      00378700
                      AIF   ('&XSYSNAME'(1,1) NE '(').ZI18B             00378800
&ZCGPR   SETC  '0('.'&XSYSNAME'(2,K'&XSYSNAME-2).')'                    00378900
.ZI18B                ANOP  ,                                           00379000
.*                                                                      00379100
&ZOPN                 SETA  &ZOPN+1                                     00379200
&ZOPL(&ZOPN)          SETC  ' '                                         00379300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00379400
&ZOPV(&ZOPN)          SETC  '68(8,1),&ZCGPR'                            00379500
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSNAME XSYSNAME'                    00379600
.*                                                                      00379700
.ZI18E                ANOP  ,                                           00379800
.*-------------------------------------------------------------------   00379900
.***AI.LVER02                                                           00380000
.ZI18Z                ANOP  ,                                           00380100
.*-------------------------------------------------------------------   00380200
.***AI.LVER01                                                           00380300
                      AIF  (&XPLISTVER LT 2).ZI19Z                      00380400
.*-------------------------------------------------------------------   00380500
.***AI.L25  XRCTABLE AL4                                                00380600
                      AIF   ('&ZXRCTABLE' EQ '').ZI19E                  00380700
                      AIF   ('&ZXRCTABLE' EQ 'OUTPUT').ZI19E            00380800
&ZCGPR                SETC  '&XRCTABLE'                                 00380900
         AIF   ('&XRCTABLE' NE '0').ZI19A                               00381000
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI19E                          00381100
.*                                                                      00381200
&ZCGPR                SETC  '=XL4''00'''                                00381300
.ZI19A                ANOP  ,                                           00381400
.*                                                                      00381500
                      AIF   ('&XRCTABLE'(1,1) NE '(').ZI19B             00381600
&ZCGPR   SETC  '0('.'&XRCTABLE'(2,K'&XRCTABLE-2).')'                    00381700
                      AGO   .ZI19D                                      00381800
.ZI19B                ANOP  ,                                           00381900
.*                                                                      00382000
&ZC                   SETC  '&XRCTABLE'(1,1)                            00382100
                      AIF   (T'&ZC NE 'N').ZI19D                        00382200
&ZC                   SETC  '&XRCTABLE'                                 00382300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               00382400
&ZCGPR                SETC  '=AL4(&XRCTABLE)'                           00382500
.*                                                                      00382600
.ZI19D                ANOP  ,                                           00382700
.*                                                                      00382800
&ZOPN                 SETA  &ZOPN+1                                     00382900
&ZOPL(&ZOPN)          SETC  ' '                                         00383000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00383100
&ZOPV(&ZOPN)          SETC  '76(4,1),&ZCGPR'                            00383200
&ZOPD(&ZOPN)          SETC  '++ &ZXRCTABLE XRCTABLE'                    00383300
.*                                                                      00383400
.ZI19E                ANOP  ,                                           00383500
.*-------------------------------------------------------------------   00383600
.***AI.LVER02                                                           00383700
.ZI19Z                ANOP  ,                                           00383800
.*-------------------------------------------------------------------   00383900
.***AI.LVER01                                                           00384000
                      AIF  (&XPLISTVER LT 3).ZI21Z                      00384100
.*-------------------------------------------------------------------   00384200
.***AI.L04 XPLISTLEN XL2                                                00384300
&ZOPN                 SETA  &ZOPN+1                                     00384400
&ZOPL(&ZOPN)          SETC  ' '                                         00384500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00384600
&ZOPV(&ZOPN)          SETC  '84(2,1),=AL2(&ZPLLEN)'                     00384700
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00384800
.*-------------------------------------------------------------------   00384900
.***AI.LVER02                                                           00385000
.ZI21Z                ANOP  ,                                           00385100
.*-------------------------------------------------------------------   00385200
.***AI.LVER01                                                           00385300
                      AIF  (&XPLISTVER LT 3).ZI22Z                      00385400
.*-------------------------------------------------------------------   00385500
.***AI.LVER02                                                           00385600
.ZI22Z                ANOP  ,                                           00385700
.*-------------------------------------------------------------------   00385800
&ZOPN1                SETA &ZOPN                                        00385900
.*-------------------------------------------------------------------   00386000
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00386100
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00386200
.*******************************************************************    00386300
.***  PROCESS ATRSRV OUTPUT PARAMETERS                                  00386400
.*******************************************************************    00386500
                      ACTR  10000                                       00386600
.*------------------------------------------------------------------    00386700
.***AO.LVER01                                                           00386800
                      AIF  (&XPLISTVER LT 2).ZO20Z  PLVER               00386900
.*------------------------------------------------------------------    00387000
.***AO.L02 XRCNUM F                                                     00387100
         AIF   ('&ZXRCNUM' EQ 'OUTPUT').ZO20A  OUTPUT                   00387200
         AIF   ('&ZXRCNUM' NE 'INOUT').ZO20C  INOUT                     00387300
.ZO20A    AIF   ('&XRCNUM'(1,1) NE '(').ZO20B  ADDR IN GPR              00387400
&ZCGPR   SETC  '&XRCNUM'(2,K'&XRCNUM-2)                                 00387500
&ZOPN                 SETA  &ZOPN+1                                     00387600
&ZOPL(&ZOPN)          SETC  ' '                                         00387700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00387800
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),80(1)'                         00387900
&ZOPD(&ZOPN)          SETC  '++ XRCNUM F'                               00388000
                      AGO   .ZO20C                                      00388100
.*                                                                      00388200
.ZO20B                ANOP  ,                                           00388300
&ZAWRK   SETA  K'&XRCNUM                                                00388400
         AIF   ('&XRCNUM'(&ZAWRK,1) NE ')').ZO20G                       00388500
&ZN      SETA  2                                                        00388600
.ZO20H    ANOP                                                          00388700
         AIF   (&ZN GE &ZAWRK).ZO20G                                    00388800
         AIF   ('&XRCNUM'(&ZN,1) NE '(').ZO20I                          00388900
&ZC      SETC  '&XRCNUM'(1,&ZN).'4'.','                                 00389000
&ZC      SETC  '&ZC'.'&XRCNUM'(&ZN+1,&ZAWRK-&ZN).',80(1)'               00389100
         AGO   .ZO20J                                                   00389200
.ZO20I    ANOP                                                          00389300
&ZN      SETA  &ZN+1                                                    00389400
         AGO   .ZO20H                                                   00389500
.ZO20G    ANOP                                                          00389600
&ZC      SETC  '&XRCNUM.(4),80(1)'                                      00389700
.ZO20J    ANOP                                                          00389800
&ZOPN                 SETA  &ZOPN+1                                     00389900
&ZOPL(&ZOPN)          SETC  ' '                                         00390000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00390100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00390200
&ZOPD(&ZOPN)          SETC  '++ XRCNUM F'                               00390300
.ZO20C                ANOP  ,                                           00390400
.*------------------------------------------------------------------    00390500
.***AO.LVER02                                                           00390600
.ZO20Z                ANOP  ,                                           00390700
.*******************************************************************    00390800
.***AO.X01  LABEL TO BYPASS INVOCATION                                  00390900
.*******************************************************************    00391000
&ZOPN                 SETA  &ZOPN+1                                     00391100
&ZOPL(&ZOPN)          SETC  'AMGE&SYSNDX'                               00391200
&ZOPO(&ZOPN)          SETC  'DS'                                        00391300
&ZOPV(&ZOPN)          SETC  '0H'                                        00391400
&ZOPD(&ZOPN)          SETC  '++ BYPASS INVOCATION'                      00391500
.*******************************************************************    00391600
.***AO.X02  RETURN CODE PROCESSING                                      00391700
.*******************************************************************    00391800
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00391900
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00392000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00392100
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00392200
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00392300
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00392400
&ZOPN                 SETA  &ZOPN+1                                     00392500
&ZOPL(&ZOPN)          SETC  ' '                                         00392600
&ZOPO(&ZOPN)          SETC  'ST'                                        00392700
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00392800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00392900
                      AGO   .ZMRETX                                     00393000
.*                                                                      00393100
.ZMRET2               ANOP  ,                                           00393200
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00393300
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00393400
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00393500
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00393600
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00393700
&ZOPN                 SETA  &ZOPN+1                                     00393800
&ZOPL(&ZOPN)          SETC  ' '                                         00393900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00394000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00394100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00394200
.ZMRETX               ANOP  ,                                           00394300
.*******************************************************************    00394400
.***AO.X03  REASON CODE PROCESSING                                      00394500
.*******************************************************************    00394600
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00394700
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00394800
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00394900
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00395000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00395100
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00395200
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00395300
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00395400
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00395500
&ZOPN                 SETA  &ZOPN+1                                     00395600
&ZOPL(&ZOPN)          SETC  ' '                                         00395700
&ZOPO(&ZOPN)          SETC  'ST'                                        00395800
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00395900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00396000
                      AGO   .ZMRSNX                                     00396100
.*                                                                      00396200
.ZMRSN2               ANOP  ,                                           00396300
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00396400
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00396500
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00396600
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00396700
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00396800
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00396900
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00397000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00397100
&ZOPN                 SETA  &ZOPN+1                                     00397200
&ZOPL(&ZOPN)          SETC  ' '                                         00397300
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00397400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00397500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00397600
.ZMRSNX               ANOP  ,                                           00397700
.*******************************************************************    00397800
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00397900
.*******************************************************************    00398000
.ZMFLX                ANOP  ,              MF=L PROCESSING              00398100
.*******************************************************************    00398200
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00398300
.*******************************************************************    00398400
                      ACTR  10000                                       00398500
.*                                                                      00398600
                      LCLA  &ZLC           COLUMN POSITION              00398700
                      LCLA  &ZOPX          LIST TABLE INDEX             00398800
                      LCLC  &ZLL           LABEL                        00398900
                      LCLC  &ZLOP          OPERATION                    00399000
                      LCLC  &ZLV           VALUE                        00399100
                      LCLC  &ZLD           DESCRIPTION                  00399200
.*                                                                      00399300
&ZOPX                 SETA  1                                           00399400
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00399500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00399600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00399700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00399800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00399900
                      AIF   (K'&ZLD LE 0).ZL5                           00400000
&ZLC                  SETA  35             COMMENT COLUMN               00400100
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00400200
&ZLC                  SETA  33             COMMMENT COLUMN              00400300
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00400400
&ZLV                  SETC  '&ZLV'.' '                                  00400500
                      AGO   .ZL3                                        00400600
.*                                                                      00400700
.ZL4                  ANOP  ,                                           00400800
&ZLV                  SETC  '&ZLV'.' '                                  00400900
.ZL5                  ANOP  ,                                           00401000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00401100
.*                                                                      00401200
&ZLL     &ZLOP &ZLV                                                     00401300
.*                                                                      00401400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00401500
                      AGO   .ZL2           CONTINUE LOOPING             00401600
.*                                                                      00401700
.ZLX                  ANOP  ,                                           00401800
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00401900
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00402000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00402100
         L     14,16(0,0)                                               00402200
         L     14,CVTECVT-CVTMAP(14)                                    00402300
         TM    ECVTRRSW-ECVT(14),B'10000000'                            00402400
         BNZ   NSRV&SYSNDX                                              00402500
         L     14,ECVTRRSW-ECVT(14)                                     00402600
         L     14,280(14)                                               00402700
         PC    0(14)                                                    00402800
         B     DONE&SYSNDX                                              00402900
NSRV&SYSNDX EQU *                                                       00403000
         LA    15,ATRSRV_FAILURE                                        00403100
         LA    0,ATRSRV_RRS_NOT_ACTIVE                                  00403200
DONE&SYSNDX EQU *                                                       00403300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00403400
.ZLINKX               ANOP  ,                                           00403500
.*******************************************************************    00403600
.***AP.X01  FORMAT GENERATED CODE                                       00403700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00403800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00403900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00404000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00404100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00404200
                      AIF   (K'&ZLD LE 0).ZL51                          00404300
&ZLC                  SETA  35             COMMENT COLUMN               00404400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00404500
&ZLC                  SETA  33             COMMENT COLUMN               00404600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00404700
&ZLV                  SETC  '&ZLV'.' '                                  00404800
                      AGO   .ZL31                                       00404900
.*                                                                      00405000
.ZL41                 ANOP  ,                                           00405100
&ZLV                  SETC  '&ZLV'.' '                                  00405200
.ZL51                 ANOP  ,                                           00405300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00405400
.*                                                                      00405500
&ZLL     &ZLOP &ZLV                                                     00405600
.*                                                                      00405700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00405800
                      AGO   .ZL21          CONTINUE LOOPING             00405900
.*                                                                      00406000
.ZLX1                 ANOP  ,                                           00406100
.*******************************************************************    00406200
.***AP.X02  END OF ATRSRV MACRO                                         00406300
&ZATRSRV              SETC  'YES'          SET ATRSRV USED              00406400
         POP   PRINT                                                    00406500
*                                            ATRSRV-5                   00406600
         SPACE 1                                                        00406700
.ZLX2                 ANOP  ,                                           00406800
         MEND                                                           00406900
**********************************************************************/ 00407000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00407100
*%ATRSRV: MACRO KEYS(REQUEST,RMNAME,URID,GNAME,SYSNAME,RCTABLE,RCNUM,   00407200
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00407300
*  ANS('?'!!MACLABEL!!' '!!'ATRSRVP '!!MACLIST!!                        00407400
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00407500
*%END ATRSRV;                                                           00407600

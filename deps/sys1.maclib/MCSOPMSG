*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  MCSOPMSG                              -05/04/15-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  MCS Operator Message Service                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 1990, 2006                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7730                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      The MCSOPMSG macro is used to retrieve the address and alet of * 00002000
*      a message when posted by Comm Task.  The message delivered via * 00002100
*      the GETMSG service can be qualified by search criteria such as * 00002200
*      CONSID, NAME (console name), CART, and MASK, if so desired.    * 00002300
*      The RESUME service allows queuing to this operator to be       * 00002400
*      resumed, if the queuing was previously disabled.               * 00002500
*                                                                     * 00002600
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00002700
*                                                                     * 00002800
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002900
*                                                                     * 00003000
*01* ENVIRONMENT:                                                     * 00003100
*                                                                     * 00003200
*                                                                     * 00003300
*      Dispatchable unit mode: Task mode.                             * 00003400
*                                                                     * 00003500
*      Minimum authorization: Supervisor state.  Any PSW key.         * 00003600
*                                                                     * 00003700
*      AMODE:            31-bit.                                      * 00003800
*                                                                     * 00003900
*      ASC mode:         Access Register .                            * 00004000
*                                                                     * 00004100
*      Serialization:    None.                                        * 00004200
*                                                                     * 00004300
*      Restrictions:     None.                                        * 00004400
*                                                                     * 00004500
*                                                                     * 00004600
*                                                                     * 00004700
*01* SYNTAX:                                                          * 00004800
*                                                                     * 00004900
*Ýxlabel¨  MCSOPMSG  Ð  REQUEST=RESUME                                * 00005000
*                    ¿ ,REQUEST=GETMSG                                * 00005100
*                        ÐÝ,CMDRESP=NO¨                               * 00005200
*                        ¿Ý,CMDRESP=YES                               * 00005300
*                             Ý,CART=»xcart!NULLº                     * 00005400
*                                 Ý,MASK=»xmask!NULLº¨¨¨              * 00005500
*                    Ð ,CONSID=xconsid                                * 00005600
*                    ¿ ,NAME=xname                                    * 00005700
*                     Ý,RTNCODE=xrtncode¨                             * 00005800
*                     Ý,RSNCODE=xrsncode¨                             * 00005900
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00006000
*                    ÐÝ,MF=S¨                                         * 00006100
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00006200
*                    ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00006300
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00006400
*                                                                     * 00006500
*                                                                     * 00006600
*      Where:                                                         * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*      Ýxlabel¨                                                       * 00007000
*          is an optional symbol, starting in column 1, that is the   * 00007100
*          name on the MCSOPMSG macro invocation.  The name must      * 00007200
*          conform to the rules for an ordinary assembler language    * 00007300
*          symbol.                                                    * 00007400
*          DEFAULT: No name.                                          * 00007500
*                                                                     * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*      REQUEST=»RESUME!GETMSGº                                        * 00008000
*          is a required keyword input that indicates the type of     * 00008100
*          request being made.                                        * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*          REQUEST=RESUME                                             * 00008500
*              Indicates that queuing will resume.                    * 00008600
*                                                                     * 00008700
*          REQUEST=GETMSG                                             * 00008800
*              Indicates that a message is requested.                 * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*              ÝCMDRESP=»NO!YESº¨                                     * 00009200
*                  is an optional keyword input that indicates the    * 00009300
*                  type of message search being requested.            * 00009400
*                  DEFAULT: NO                                        * 00009500
*                                                                     * 00009600
*                                                                     * 00009700
*                  ÝCMDRESP=NO¨                                       * 00009800
*                      Indicates that the first message will be       * 00009900
*                      obtained.                                      * 00010000
*                                                                     * 00010100
*                  ÝCMDRESP=YES                                       * 00010200
*                      Indicates a search will occur.                 * 00010300
*                                                                     * 00010400
*                                                                     * 00010500
*                      ÝCART=»xcart!NULLº                             * 00010600
*                          is the name (RS-type), or address in       * 00010700
*                          register (2)-(12), of an optional 8        * 00010800
*                          character input that indicates the CART to * 00010900
*                          use to search for the next message.        * 00011000
*                          DEFAULT: NULL                              * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*                          ÝMASK=»xmask!NULLº¨¨¨                      * 00011400
*                              is the name (RS-type), or address in   * 00011500
*                              register (2)-(12), of an optional 8    * 00011600
*                              character input that indicates the     * 00011700
*                              mask to be ANDed with the CART.        * 00011800
*                              DEFAULT: NULL                          * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*                                                                     * 00013300
*      The following is a set of mutually exclusive keys.  This set   * 00013400
*      is required; only one key must be specified.                   * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*      CONSID=xconsid                                                 * 00013800
*          belongs to a set of mutually exclusive keys. It is the     * 00013900
*          name (RS-type), or address in register (2)-(12), of a      * 00014000
*          fullword input that specifies the 4 byte console ID.       * 00014100
*                                                                     * 00014200
*      NAME=xname                                                     * 00014300
*          belongs to a set of mutually exclusive keys. It is the     * 00014400
*          name (RS-type), or address in register (2)-(12), of an 8   * 00014500
*          character input that specifies the name of the console.    * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*      End of a set of mutually exclusive required keys.              * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*      ÝRTNCODE=xrtncode¨                                             * 00015400
*          is the name (RS-type) of an optional fullword output       * 00015500
*          variable, or register (2)-(12), into which the return code * 00015600
*          is to be copied from GPR 15.                               * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*                                                                     * 00016100
*      ÝRSNCODE=xrsncode¨                                             * 00016200
*          is the name (RS-type) of an optional fullword output       * 00016300
*          variable, or register (2)-(12), into which the reason code * 00016400
*          is to be copied from GPR 0.                                * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00017000
*          is an optional byte input decimal value in the "1-2" range * 00017100
*          that specifies the macro version.  PLISTVER is the only    * 00017200
*          key allowed on the list form of MF and determines which    * 00017300
*          parameter list is generated.  The macro keys associated    * 00017400
*          with each supported version of the macro are listed in     * 00017500
*          MACRO USAGE NOTE 3.  Note that MAX may be specified        * 00017600
*          instead of a number, and the parameter list will be of the * 00017700
*          largest size currently supported. This size may grow from  * 00017800
*          release to release (thus possibly affecting the amount of  * 00017900
*          storage needed by your program).  If your program can      * 00018000
*          tolerate this, IBM recommends that you always specify MAX  * 00018100
*          when creating the list form parameter list as that will    * 00018200
*          ensure that the list form parameter list is always long    * 00018300
*          enough to hold whatever parameters might be specified on   * 00018400
*          the execute form.                                          * 00018500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00018600
*          default is the lowest version which allows all of the      * 00018700
*          parameters specified on the invocation to be processed.    * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*      ÝMF=»S!L!M!Eº¨                                                 * 00019300
*          is an optional keyword input which specifies the macro     * 00019400
*          form.                                                      * 00019500
*          DEFAULT: S                                                 * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*          ÝMF=S¨                                                     * 00019900
*              specifies the standard form of the macro.  The "S"     * 00020000
*              form generates code to put the parameters into an      * 00020100
*              in-line parameter list and invoke the desired service. * 00020200
*              Full checking for required macro keys is done along    * 00020300
*              with supplying defaults for omitted optional           * 00020400
*              parameters.                                            * 00020500
*                                                                     * 00020600
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00020700
*              specifies the list form of the macro.  The "L" form    * 00020800
*              defines an area to be used for the parameter list.     * 00020900
*              Only the PLISTVER key may be specified on the          * 00021000
*              invocation.  All other macro parameters are flagged as * 00021100
*              errors.  If PLISTVER is not specified, the original    * 00021200
*              parameter list definition is used.                     * 00021300
*                                                                     * 00021400
*            ,xmfctrl                                                 * 00021500
*              is a required input.  It is the name of a storage area * 00021600
*              for the parameter list.                                * 00021700
*                                                                     * 00021800
*            »,xmfattr!0Dº                                            * 00021900
*              is an optional 60 character input string that varies   * 00022000
*              from 1 to 60 characters. Use it to force boundary      * 00022100
*              alignment of the parameter list. Use only 0F or 0D.    * 00022200
*              DEFAULT: 0D which forces the parameter list to a       * 00022300
*              doubleword boundary.                                   * 00022400
*                                                                     * 00022500
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00022600
*              specifies the modify form of the macro.  The "M" form  * 00022700
*              generates code to put the parameters into the          * 00022800
*              parameter list specified by xmfctrl.                   * 00022900
*                                                                     * 00023000
*            ,xmfctrl                                                 * 00023100
*              is a required input.  It is the name (RS-type), or     * 00023200
*              address in register (1)-(12), of a storage area for    * 00023300
*              the parameter list.                                    * 00023400
*                                                                     * 00023500
*            »,COMPLETE!NOCHECKº¨                                     * 00023600
*              is an optional keyword input which specifies the       * 00023700
*              degree of macro parameter syntax checking.             * 00023800
*              DEFAULT: COMPLETE                                      * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*              COMPLETE                                               * 00024200
*                  Checking for required macro keys is done and       * 00024300
*                  defaults are supplied for omitted optional         * 00024400
*                  parameters.  (See Macro Usage Note 2).             * 00024500
*                                                                     * 00024600
*              NOCHECK                                                * 00024700
*                  Checking for required macro keys is not done nor   * 00024800
*                  are defaults supplied for omitted optional         * 00024900
*                  parameters.                                        * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*                                                                     * 00025300
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00025400
*              specifies the execute form of the macro.  The "E" form * 00025500
*              generates code to put the parameters into the          * 00025600
*              parameter list specified by xmfctrl and invoke the     * 00025700
*              desired service.                                       * 00025800
*                                                                     * 00025900
*            ,xmfctrl                                                 * 00026000
*              is a required input.  It is the name (RS-type), or     * 00026100
*              address in register (1)-(12), of a storage area for    * 00026200
*              the parameter list.                                    * 00026300
*                                                                     * 00026400
*            »,COMPLETE!NOCHECKº                                      * 00026500
*              is an optional keyword input which specifies the       * 00026600
*              degree of macro parameter syntax checking.             * 00026700
*              DEFAULT: COMPLETE                                      * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*              COMPLETE                                               * 00027100
*                  Checking for required macro keys is done and       * 00027200
*                  defaults are supplied for omitted optional         * 00027300
*                  parameters.  (See Macro Usage Note 2).             * 00027400
*                                                                     * 00027500
*              NOCHECK                                                * 00027600
*                  Checking for required macro keys is not done nor   * 00027700
*                  are defaults supplied for omitted optional         * 00027800
*                  parameters.                                        * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*01* RETURN CODES:                                                    * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*            0    Successful completion.                              * 00029000
*                                                                     * 00029100
*            4    Successful processing, but message queuing is       * 00029200
*                 disabled.  Or successful processing, but message    * 00029300
*                 queuing was already enabled.                        * 00029400
*                                                                     * 00029500
*            8    No messages available for specified search          * 00029600
*                 criteria.                                           * 00029700
*                                                                     * 00029800
*            12   No messages available for specified search          * 00029900
*                 criteria, and message queuing was disabled.         * 00030000
*                                                                     * 00030100
*            16   Invalid console ID or console name.                 * 00030200
*                                                                     * 00030300
*            20   Improper MCSOPMSG call.                             * 00030400
*                                                                     * 00030500
*            24   Internal Abend.                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*01* REASON CODES:                                                    * 00031000
*                                                                     * 00031100
*       REASON    RETURN                                              * 00031200
*       CODE      CODE      DESCRIPTION                               * 00031300
*       ××××××××  ××××××××  ×××××××××××                               * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*              1  8         Queue is being fixed                      * 00031700
*                                                                     * 00031800
*              1  16        Console is not active                     * 00031900
*                                                                     * 00032000
*              2  16        Console was not activated by this address * 00032100
*                           space                                     * 00032200
*                                                                     * 00032300
*              1  20        Invalid parameter list                    * 00032400
*                                                                     * 00032500
*              2  20        Caller not in AR mode                     * 00032600
*                                                                     * 00032700
*              3  20        Another  MCSOPMSG  request is in progress * 00032800
*                           for this console.                         * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*01* MODULE TYPE:  ASSEM MACRO                                        * 00033300
*                                                                     * 00033400
*02*   PROCESSOR:  ASSEM                                              * 00033500
*                                                                     * 00033600
*01* COMPONENT:  SC1CK                                                * 00033700
*                                                                     * 00033800
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00033900
*                                                                     * 00034000
*01* MACRO USAGE NOTES:                                               * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00034400
*        global macro variable.  Any value other than 'NO' will       * 00034500
*        result in the macro expansion being printed.  The default is * 00034600
*        'YES'.  The following examples illustrate how the ZPRINT     * 00034700
*        variable should be set.                                      * 00034800
*                                                                     * 00034900
*                    GBLC &ZPRINT                                     * 00035000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*    2.  When using the NOCHECK option in conjunction with the Modify * 00035400
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00035500
*        Modify   or  Execute  form  invocation  which  specifies  or * 00035600
*        defaults  to  the  COMPLETE  option.   This insures that the * 00035700
*        parameter  list  is  initialized completely.   The parameter * 00035800
*        list  field which identifies the version number of the macro * 00035900
*        is only set when the Standard form or the Complete option of * 00036000
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00036100
*        explicitly  specified.  Be sure that the resulting parameter * 00036200
*        list version number covers all the keys that you use.        * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*    3.  The MCSOPMSG macro supports multiple versions. The macro key * 00036600
*        list  below  contains the version level in which the key was * 00036700
*        first  introduced.  Positionals  are  identified by the word * 00036800
*        'Positional'  followed by the numeric value of its position. * 00036900
*        Nested  positionals  are  preceded  by their outer key.  The * 00037000
*        lowest value represents the original version and the highest * 00037100
*        value  represents  the  most  recent version of the MCSOPMSG * 00037200
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00037300
*        least  as high as the highest version number of all the keys * 00037400
*        being used.                                                  * 00037500
*                                                                     * 00037600
*        VERSION   KEY                                                * 00037700
*                                                                     * 00037800
*              1      CART                                            * 00037900
*                     CMDRESP                                         * 00038000
*                     CONSID                                          * 00038100
*                     MASK                                            * 00038200
*                     REQUEST                                         * 00038300
*                     RTNCODE                                         * 00038400
*              2      NAME                                            * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*01* CHANGE ACTIVITY:                                                 * 00038900
*                                                                     * 00039000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00039100
*                                                                     * 00039200
*    $L0=CNSL2ADQ HBB4420 900122 PDDQ:  CONSOLE ENHANCEMENTS 2        * 00039300
*    $P1=ME01997  HBB7720 041005 PDSS:  Support for console name      * 00039400
*    $P2=ME03348  HBB7730 050415 PDOH:  Add external classification   * 00039500
****** END OF SPECIFICATIONS *****************************************/ 00039600
*/********************************************************************* 00039700
         MACRO                                                          00039800
&XLABEL  MCSOPMSG &REQUEST=,&CMDRESP=,&CART=,&MASK=,&CONSID=,&NAME=,   *00039900
               &RTNCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00040000
.*                                                                      00040100
*              MACDATE -05/04/15-<2>                                    00040200
.*                                                                      00040300
.*******************************************************************    00040400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00040500
.*******************************************************************    00040600
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00040700
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00040800
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00040900
.*                                                                      00041000
              GBLC  &ZMCSOPMSG  YES=MACRO USED AT LEAST ONCE            00041100
.*******************************************************************    00041200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00041300
.*******************************************************************    00041400
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00041500
              LCLC  &ZCNDX      SYSNDX CHARACTERS                       00041600
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00041700
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00041800
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00041900
              LCLA  &ZAWRK      USED AS A WORK AREA                     00042000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00042100
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00042200
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00042300
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00042400
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00042500
              LCLC  &ZMAC_G     "G" or null                             00042600
&ZMAC_G       SETC  ''                                                  00042700
              LCLC  &ZMAC_LR                                            00042800
&ZMAC_LR      SETC  'LR'                                                00042900
              LCLC  &ZMAC_L                                             00043000
&ZMAC_L       SETC  'L'                                                 00043100
              LCLC  &ZMAC_ST                                            00043200
&ZMAC_ST      SETC  'ST'                                                00043300
              LCLA  &ZMACRET    MACRO RETURN CODE                       00043400
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00043500
.*                                                                      00043600
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00043700
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00043800
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00043900
              LCLC  &ZENDBASEPL                 End of base PL          00044000
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00044100
.*******************************************************************    00044200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00044300
.*******************************************************************    00044400
              LCLA  &ZI         INDEX FOR ARRAY                         00044500
              LCLA  &ZJ         INDEX FOR PARMS                         00044600
              LCLA  &ZK         INDEX FOR PARSE                         00044700
              LCLA  &ZLO        LOW RANGE VALUE                         00044800
              LCLA  &ZHI        HIGH RANGE VALUE                        00044900
              LCLC  &ZW         WORK AREA FOR PARM                      00045000
.********************************************************************   00045100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00045200
.********************************************************************   00045300
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00045400
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00045500
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00045600
              GBLC  &SYSAM64    SYSSTATE AMODE64                        00045700
.*                                                                      00045800
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00045900
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00046000
              SPLEVEL  TEST                                             00046100
.ZSYS2        ANOP  ,                                                   00046200
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00046300
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00046400
              SYSSTATE TEST                                             00046500
              AGO   .ZSYS4                                              00046600
.ZSYS3        ANOP  ,                                                   00046700
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00046800
.ZSYS4        ANOP  ,                                                   00046900
.*******************************************************************    00047000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00047100
.*******************************************************************    00047200
              LCLC  &XREQUEST   ++ VALUE                                00047300
              LCLC  &XCMDRESP   ++ VALUE                                00047400
              LCLC  &XCART      ++ NAME                                 00047500
              LCLC  &XMASK      ++ NAME                                 00047600
              LCLC  &XNAME1     ++ NAME                                 00047700
              LCLC  &XCONSID    ++ NAME                                 00047800
              LCLC  &XNAME      ++ NAME                                 00047900
              LCLC  &XRTNCODE   ++ NAME                                 00048000
              LCLC  &XRSNCODE   ++ NAME                                 00048100
              LCLA  &XPLISTVER  ++ VALUE                                00048200
              LCLC  &XMF        ++ VALUE                                00048300
              LCLC  &XMFCTRL    ++ NAME                                 00048400
              LCLC  &XMFATTR    ++ VALUE                                00048500
              LCLC  &XMFSCK     ++ VALUE                                00048600
.*******************************************************************    00048700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00048800
.*******************************************************************    00048900
              LCLC  &ZXREQUEST  ++ INPUT VALUE                          00049000
              LCLC  &ZXCMDRESP  ++ INPUT VALUE                          00049100
              LCLC  &ZXCART     ++ INPUT NAME                           00049200
              LCLC  &ZXMASK     ++ INPUT NAME                           00049300
              LCLC  &ZXNAME1    ++ INPUT NAME                           00049400
              LCLC  &ZXCONSID   ++ INPUT NAME                           00049500
              LCLC  &ZXNAME     ++ INPUT NAME                           00049600
              LCLC  &ZXRTNCODE  ++ OUTPUT NAME                          00049700
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00049800
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00049900
              LCLC  &ZXMF       ++ INPUT VALUE                          00050000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00050100
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00050200
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00050300
.********************************************************************   00050400
.***AC.PLV01  PROCESS PLISTVER                                      *   00050500
.********************************************************************   00050600
&XPLISTVER      SETA  1                                                 00050700
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00050800
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00050900
&XPLISTVER      SETA  2                                                 00051000
.ZPLV0          ANOP  ,                                                 00051100
.*                                                                      00051200
                AIF   ('&NAME' EQ '').ZPLV1E                            00051300
                AIF   (&XPLISTVER GE 2).ZPLV1E                          00051400
&XPLISTVER      SETA  2                                                 00051500
.ZPLV1E         ANOP  ,                                                 00051600
.*                                                                      00051700
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00051800
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00051900
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00052000
.*-------------------------------------------------------------------   00052100
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00052200
&ZMS            SETC  '"PLISTVER='                                      00052300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00052400
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00052500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00052600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00052700
                AGO   .ZPVCK2                                           00052800
.ZPVCK3         ANOP  ,                                                 00052900
.*-------------------------------------------------------------------   00053000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00053100
&ZMS            SETC  '"PLISTVER='                                      00053200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00053300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00053400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00053500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00053600
                AGO   .ZPVCKE                                           00053700
.ZPVCK2         ANOP  ,                                                 00053800
.*-------------------------------------------------------------------   00053900
&ZCVAL          SETC  '&PLISTVER(1)'                                    00054000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00054100
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00054200
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00054300
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00054400
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00054500
.ZPVCK6         ANOP  ,                                                 00054600
&ZMS            SETC  '"PLISTVER='                                      00054700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00054800
&ZMS            SETC  '&ZMS THE RANGE IS "1-2"'                         00054900
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00055000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00055100
&XPLISTVER      SETA  2                                                 00055200
                AGO   .ZPVCKE                                           00055300
.*-------------------------------------------------------------------   00055400
.ZPVCK4A        ANOP  ,                                                 00055500
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00055600
&ZMS            SETC  'PLISTVER='                                       00055700
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00055800
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00055900
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00056000
                MNOTE 8,' &ZMS IS REQUIRED.'                            00056100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00056200
                AGO   .ZPVCK5                                           00056300
.ZPVCK4         ANOP  ,                                                 00056400
&XPLISTVER      SETA  &PLISTVER(1)                                      00056500
.ZPVCK5         ANOP  ,                                                 00056600
.ZPVCKE         ANOP  ,                                                 00056700
.********************************************************************   00056800
.***AG.MF01 PROCESS MF MACRO FORMS                                      00056900
.********************************************************************   00057000
              ACTR  10000                                               00057100
.*------------------------------------------------------------------    00057200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00057300
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00057400
.*-------------------------------------------------------------------   00057500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00057600
.ZG32         ANOP  ,                                                   00057700
&ZTLC         SETC 'S'                                                  00057800
              AIF   ('&MF(1)' NE '&ZTLC').ZG33                          00057900
&XMF          SETC  'S'         SET KEYWORD                             00058000
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00058100
              AIF   (N'&MF LE 1).ZG32A          CK NUM                  00058200
&ZMS          SETC  '"MF='                                              00058300
&ZMS          SETC  '&ZMS.&MF"'                                         00058400
&ZMS          SETC  '&ZMS "MF"'                                         00058500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00058600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00058700
.ZG32A        ANOP  ,                                                   00058800
.*-------------------------------------------------------------------   00058900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00059000
.ZG33         ANOP  ,                                                   00059100
&ZTLC         SETC 'L'                                                  00059200
              AIF   ('&MF(1)' NE '&ZTLC').ZG40                          00059300
&XMF          SETC  'L'         SET KEYWORD                             00059400
              AIF   (N'&MF LE 3).ZG33A          CK NUM                  00059500
&ZMS          SETC  '"MF='                                              00059600
&ZMS          SETC  '&ZMS.&MF"'                                         00059700
&ZMS          SETC  '&ZMS "MF"'                                         00059800
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00059900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00060000
.ZG33A        ANOP  ,                                                   00060100
.*-------------------------------------------------------------------   00060200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00060300
              AIF   (N'&SYSLIST NE 0).ZG33B     POSITIONALS?            00060400
              AIF   ('&REQUEST' NE '').ZG33B    KEYS?                   00060500
              AIF   ('&CMDRESP' NE '').ZG33B    KEYS?                   00060600
              AIF   ('&CART' NE '').ZG33B       KEYS?                   00060700
              AIF   ('&MASK' NE '').ZG33B       KEYS?                   00060800
              AIF   ('&CONSID' NE '').ZG33B     KEYS?                   00060900
              AIF   ('&NAME' NE '').ZG33B       KEYS?                   00061000
              AIF   ('&RTNCODE' NE '').ZG33B    KEYS?                   00061100
              AIF   ('&RSNCODE' NE '').ZG33B    KEYS?                   00061200
              AGO    .ZG33C     INVOCATION OKAY                         00061300
.ZG33B        ANOP  ,                                                   00061400
&ZMS          SETC  'THE "L" FORM OF "MF"'                              00061500
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00061600
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00061700
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00061800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00061900
.ZG33C        ANOP  ,                                                   00062000
.*-------------------------------------------------------------------   00062100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00062200
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00062300
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00062400
              AIF   (N'&MF(2) GT 1).ZG35B       MULTI PARMS             00062500
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00062600
.ZG35B        AIF   (K'&MF(2) GT 0).ZG35C                               00062700
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00062800
&ZMS          SETC  'WHEN "L" IS SPECIFIED'                             00062900
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00063000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00063100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00063200
.ZG35C        ANOP  ,                                                   00063300
.*-------------------------------------------------------------------   00063400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00063500
              AIF   (K'&ZXMFCTRL LE 0).ZG35P    NOT I/O                 00063600
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG35P                      00063700
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00063800
&ZMS          SETC  '"MF='                                              00063900
&ZMS          SETC  '&ZMS.&MF"'                                         00064000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00064100
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00064200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00064300
.ZG35P        ANOP  ,                                                   00064400
.*-------------------------------------------------------------------   00064500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00064600
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00064700
&XMFATTR      SETC  '0D'                                                00064800
              AIF   (K'&MF(3) LE 0).ZG38B       PARM                    00064900
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00065000
              AIF   (N'&MF(3) GT 1).ZG38B       MULTI                   00065100
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00065200
.ZG38B        ANOP  ,                                                   00065300
.*-------------------------------------------------------------------   00065400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00065500
              AIF   (K'&ZXMFATTR LE 0).ZG38P    NOT I/O                 00065600
              AIF   ('&XMFATTR'(1,1) NE '(').ZG38P                      00065700
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00065800
&ZMS          SETC  '"MF='                                              00065900
&ZMS          SETC  '&ZMS.&MF"'                                         00066000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00066100
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00066200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00066300
.ZG38P        ANOP  ,                                                   00066400
.*-------------------------------------------------------------------   00066500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00066600
              AIF   (K'&ZXMFATTR LE 0).ZG38S    NOT I/O                 00066700
              AIF   (K'&XMFATTR LE 60).ZG38S    LNG OK                  00066800
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00066900
&ZMS          SETC  '"MF='                                              00067000
&ZMS          SETC  '&ZMS.&MF"'                                         00067100
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00067200
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00067300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00067400
.ZG38S        ANOP  ,                                                   00067500
.*-------------------------------------------------------------------   00067600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067700
.ZG40         ANOP  ,                                                   00067800
&ZTLC         SETC 'M'                                                  00067900
              AIF   ('&MF(1)' NE '&ZTLC').ZG49                          00068000
&XMF          SETC  'M'         SET KEYWORD                             00068100
              AIF   (N'&MF LE 3).ZG40A          CK NUM                  00068200
&ZMS          SETC  '"MF='                                              00068300
&ZMS          SETC  '&ZMS.&MF"'                                         00068400
&ZMS          SETC  '&ZMS "MF"'                                         00068500
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00068600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00068700
.ZG40A        ANOP  ,                                                   00068800
.*-------------------------------------------------------------------   00068900
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00069000
              AIF   ('&RTNCODE' NE '').ZG40B    OUTPUT?                 00069100
              AGO    .ZG40C     INVOCATION OKAY                         00069200
.ZG40B        ANOP  ,                                                   00069300
&ZMS          SETC  'THE "M" FORM OF "MF" CANNOT'                       00069400
&ZMS          SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'             00069500
&ZMS          SETC  '&ZMS SPECIFIED ON THE INVOCATION:'                 00069600
&ZMS          SETC  '&ZMS "RTNCODE"'                                    00069700
              MNOTE 8,' &ZMS '                                          00069800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00069900
.ZG40C        ANOP  ,                                                   00070000
.*-------------------------------------------------------------------   00070100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00070200
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00070300
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00070400
              AIF   (N'&MF(2) GT 1).ZG42B       MULTI PARMS             00070500
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00070600
.ZG42B        AIF   (K'&MF(2) GT 0).ZG42C                               00070700
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00070800
&ZMS          SETC  'WHEN "M" IS SPECIFIED'                             00070900
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00071000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00071100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00071200
.ZG42C        ANOP  ,                                                   00071300
.*-------------------------------------------------------------------   00071400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00071500
              AIF   (K'&ZXMFCTRL LE 0).ZG42R    NOT I/O                 00071600
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG42R                      00071700
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00071800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG42P                        00071900
              AIF   (K'&ZCGPR GT 2).ZG42Q                               00072000
              AIF   ('&ZCGPR' EQ '0').ZG42Q                             00072100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00072200
              AIF   (T'&ZCGPR NE 'N').ZG42Q     INVALID REG NAME        00072300
.ZG42P        ANOP  ,                                                   00072400
              AIF   (T'&ZCGPR NE 'N').ZG42R     NON NUMERIC             00072500
              AIF   ('&ZCGPR' LT '1').ZG42Q                             00072600
              AIF   ('&ZCGPR' LE '12').ZG42R                            00072700
.ZG42Q        ANOP  ,                                                   00072800
&ZMS          SETC  '"MF='                                              00072900
&ZMS          SETC  '&ZMS.&MF"'                                         00073000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00073100
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00073200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00073300
.ZG42R        ANOP  ,                                                   00073400
.*-------------------------------------------------------------------   00073500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00073600
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00073700
.ZG46A   AIF   ('&MF(3)' NE 'COMPLETE').ZG47A                           00073800
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00073900
.*-------------------------------------------------------------------   00074000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00074100
.ZG47A   AIF   ('&MF(3)' NE 'NOCHECK').ZG48A                            00074200
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00074300
.*-------------------------------------------------------------------   00074400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00074500
.ZG48A        AIF   (K'&XMFSCK GT 0).ZG48C      KEYWORD                 00074600
              AIF   (K'&MF(3) LE 0).ZG48B                               00074700
&ZMS          SETC  '"MF='                                              00074800
&ZMS          SETC  '&ZMS.&MF"'                                         00074900
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00075000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00075100
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00075200
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00075300
              MNOTE 8,' &ZMS '                                          00075400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00075500
.ZG48B        ANOP  ,                                                   00075600
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00075700
.ZG48C        ANOP  ,                                                   00075800
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00075900
.*-------------------------------------------------------------------   00076000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076100
.ZG49         ANOP  ,                                                   00076200
&ZTLC         SETC 'E'                                                  00076300
              AIF   ('&MF(1)' NE '&ZTLC').ZG58                          00076400
&XMF          SETC  'E'         SET KEYWORD                             00076500
              AIF   (N'&MF LE 3).ZG49A          CK NUM                  00076600
&ZMS          SETC  '"MF='                                              00076700
&ZMS          SETC  '&ZMS.&MF"'                                         00076800
&ZMS          SETC  '&ZMS "MF"'                                         00076900
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00077000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00077100
.ZG49A        ANOP  ,                                                   00077200
.*-------------------------------------------------------------------   00077300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00077400
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00077500
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00077600
              AIF   (N'&MF(2) GT 1).ZG51B       MULTI PARMS             00077700
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00077800
.ZG51B        AIF   (K'&MF(2) GT 0).ZG51C                               00077900
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00078000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'                             00078100
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00078200
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00078300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00078400
.ZG51C        ANOP  ,                                                   00078500
.*-------------------------------------------------------------------   00078600
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00078700
              AIF   (K'&ZXMFCTRL LE 0).ZG51R    NOT I/O                 00078800
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG51R                      00078900
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00079000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG51P                        00079100
              AIF   (K'&ZCGPR GT 2).ZG51Q                               00079200
              AIF   ('&ZCGPR' EQ '0').ZG51Q                             00079300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00079400
              AIF   (T'&ZCGPR NE 'N').ZG51Q     INVALID REG NAME        00079500
.ZG51P        ANOP  ,                                                   00079600
              AIF   (T'&ZCGPR NE 'N').ZG51R     NON NUMERIC             00079700
              AIF   ('&ZCGPR' LT '1').ZG51Q                             00079800
              AIF   ('&ZCGPR' LE '12').ZG51R                            00079900
.ZG51Q        ANOP  ,                                                   00080000
&ZMS          SETC  '"MF='                                              00080100
&ZMS          SETC  '&ZMS.&MF"'                                         00080200
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00080300
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00080400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00080500
.ZG51R        ANOP  ,                                                   00080600
.*-------------------------------------------------------------------   00080700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00080800
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00080900
.ZG55A   AIF   ('&MF(3)' NE 'COMPLETE').ZG56A                           00081000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00081100
.*-------------------------------------------------------------------   00081200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00081300
.ZG56A   AIF   ('&MF(3)' NE 'NOCHECK').ZG57A                            00081400
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00081500
.*-------------------------------------------------------------------   00081600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00081700
.ZG57A        AIF   (K'&XMFSCK GT 0).ZG57C      KEYWORD                 00081800
              AIF   (K'&MF(3) LE 0).ZG57B                               00081900
&ZMS          SETC  '"MF='                                              00082000
&ZMS          SETC  '&ZMS.&MF"'                                         00082100
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00082200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00082300
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00082400
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00082500
              MNOTE 8,' &ZMS '                                          00082600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00082700
.ZG57B        ANOP  ,                                                   00082800
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00082900
.ZG57C        ANOP  ,                                                   00083000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00083100
.*------------------------------------------------------------------    00083200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00083300
.ZG58         ANOP  ,                                                   00083400
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00083500
              AIF   (K'&XMF GT 0).ZG58E         VALID ARG               00083600
              AIF   (T'&MF EQ 'O').ZG58D        OMITTED                 00083700
&ZASYSLNDX    SETA  0                                                   00083800
.ZG58A        ANOP  ,           POSITIONAL MACRO KEY                    00083900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00084000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG58C                    00084100
&ZTLC         SETC 'MF'                                                 00084200
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG58A           00084300
.ZG58B        ANOP  ,                                                   00084400
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00084500
&ZMS          SETC  'THE "MF" KEY'                                      00084600
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00084700
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00084800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00084900
              AGO   .ZG58E                                              00085000
.ZG58C        ANOP  ,                                                   00085100
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00085200
&ZMS          SETC  '"MF='                                              00085300
&ZMS          SETC  '&ZMS.&MF"'                                         00085400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00085500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00085600
&ZMS          SETC  '&ZMS "S",'                                         00085700
&ZMS          SETC  '&ZMS "L",'                                         00085800
&ZMS          SETC  '&ZMS "M",'                                         00085900
&ZMS          SETC  '&ZMS OR "E".'                                      00086000
              MNOTE 8,' &ZMS '                                          00086100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00086200
              AGO   .ZG58E                                              00086300
.ZG58D        ANOP  ,                                                   00086400
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00086500
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00086600
.ZG58E        ANOP  ,                                                   00086700
.********************************************************************   00086800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00086900
.********************************************************************   00087000
              ACTR  10000                                               00087100
.*-------------------------------------------------------------------   00087200
.***AG.MF03 MF=(SLME)                                                   00087300
              AIF   ('&XMF' EQ 'L').ZGMFX                               00087400
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00087500
.*------------------------------------------------------------------    00087600
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087700
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00087800
.*-------------------------------------------------------------------   00087900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00088000
.ZG3          ANOP  ,                                                   00088100
              AIF   (K'&REQUEST(1) LE 0).ZG3A                           00088200
&ZTLC         SETC 'RESUME'                                             00088300
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG4                      00088400
&XREQUEST     SETC  'RESUME'    SET KEYWORD                             00088500
              AIF   (N'&REQUEST LE 1).ZG3A      CK NUM                  00088600
&ZMS          SETC  '"REQUEST='                                         00088700
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00088800
&ZMS          SETC  '&ZMS "REQUEST"'                                    00088900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00089000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00089100
.ZG3A         ANOP  ,                                                   00089200
.*------------------------------------------------------------------    00089300
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089400
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00089500
.ZG3A0        AIF   (K'&CMDRESP LE 0).ZG3A1     OK                      00089600
&ZCVAL        SETC '&ZCVAL CMDRESP'             INCORRECT KEY USED      00089700
.ZG3A1        AIF   (K'&CART LE 0).ZG3A2        OK                      00089800
&ZCVAL        SETC '&ZCVAL CART'                INCORRECT KEY USED      00089900
.ZG3A2        AIF   (K'&MASK LE 0).ZG3A3        OK                      00090000
&ZCVAL        SETC '&ZCVAL MASK'                INCORRECT KEY USED      00090100
.ZG3A3        AIF   (K'&ZCVAL LE 0).ZG3A4       OK                      00090200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00090300
&ZMS          SETC  '"REQUEST'                                          00090400
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   00090500
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00090600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00090700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090800
.ZG3A4        ANOP  ,                                                   00090900
.*-------------------------------------------------------------------   00091000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00091100
.ZG4          ANOP  ,                                                   00091200
&ZTLC         SETC 'GETMSG'                                             00091300
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZG16                     00091400
&XREQUEST     SETC  'GETMSG'    SET KEYWORD                             00091500
              AIF   (N'&REQUEST LE 1).ZG4A      CK NUM                  00091600
&ZMS          SETC  '"REQUEST='                                         00091700
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00091800
&ZMS          SETC  '&ZMS "REQUEST"'                                    00091900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00092000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00092100
.ZG4A         ANOP  ,                                                   00092200
.*------------------------------------------------------------------    00092300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092400
&XCMDRESP     SETC  ''          INITIALIZE XVARIABLE                    00092500
.*-------------------------------------------------------------------   00092600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092700
.ZG7          ANOP  ,                                                   00092800
              AIF   (K'&CMDRESP(1) LE 0).ZG7A                           00092900
&ZTLC         SETC 'NO'                                                 00093000
              AIF   ('&CMDRESP(1)' NE '&ZTLC').ZG8                      00093100
&XCMDRESP     SETC  'NO'        SET KEYWORD                             00093200
              AIF   (N'&CMDRESP LE 1).ZG7A      CK NUM                  00093300
&ZMS          SETC  '"CMDRESP='                                         00093400
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00093500
&ZMS          SETC  '&ZMS "CMDRESP"'                                    00093600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00093700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093800
.ZG7A         ANOP  ,                                                   00093900
.*------------------------------------------------------------------    00094000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00094100
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00094200
.ZG7A0        AIF   (K'&CART LE 0).ZG7A1        OK                      00094300
&ZCVAL        SETC '&ZCVAL CART'                INCORRECT KEY USED      00094400
.ZG7A1        AIF   (K'&MASK LE 0).ZG7A2        OK                      00094500
&ZCVAL        SETC '&ZCVAL MASK'                INCORRECT KEY USED      00094600
.ZG7A2        AIF   (K'&ZCVAL LE 0).ZG7A3       OK                      00094700
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00094800
&ZMS          SETC  '"CMDRESP'                                          00094900
&ZMS          SETC  '&ZMS.=&CMDRESP"'                                   00095000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00095100
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00095200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00095300
.ZG7A3        ANOP  ,                                                   00095400
.*-------------------------------------------------------------------   00095500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095600
.ZG8          ANOP  ,                                                   00095700
&ZTLC         SETC 'YES'                                                00095800
              AIF   ('&CMDRESP(1)' NE '&ZTLC').ZG15                     00095900
&XCMDRESP     SETC  'YES'       SET KEYWORD                             00096000
              AIF   (N'&CMDRESP LE 1).ZG8A      CK NUM                  00096100
&ZMS          SETC  '"CMDRESP='                                         00096200
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00096300
&ZMS          SETC  '&ZMS "CMDRESP"'                                    00096400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00096500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00096600
.ZG8A         ANOP  ,                                                   00096700
.*----------------------------------------------------------------***   00096800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00096900
              AIF   (N'&CART LE 1).ZG10A        CK NUM                  00097000
&ZMS          SETC  '"CART='                                            00097100
&ZMS          SETC  '&ZMS.&CART"'                                       00097200
&ZMS          SETC  '&ZMS "CART"'                                       00097300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00097400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00097500
.ZG10A        ANOP  ,                                                   00097600
.*-------------------------------------------------------------------   00097700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00097800
&ZXCART       SETC  'INPUT'     SET IN/OUTPUT                           00097900
&XCART        SETC  'NULL'                                              00098000
              AIF   (K'&CART(1) LE 0).ZG10B     PARM                    00098100
&XCART        SETC  '&CART(1)'  SET XVARIABLE                           00098200
              AIF   (N'&CART GT 1).ZG10B        MULTI                   00098300
&XCART        SETC  '&CART'     SET XVARIABLE                           00098400
.ZG10B        ANOP  ,                                                   00098500
.*-------------------------------------------------------------------   00098600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00098700
              AIF   (K'&ZXCART LE 0).ZG10R      NOT I/O                 00098800
         AIF   ('&XCART' EQ 'NULL').ZG10R                               00098900
              AIF   ('&XCART'(1,1) NE '(').ZG10R                        00099000
&ZCGPR        SETC  '&XCART'(2,K'&XCART-2)                              00099100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        00099200
              AIF   (K'&ZCGPR GT 2).ZG10Q                               00099300
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             00099400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00099500
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        00099600
.ZG10P        ANOP  ,                                                   00099700
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             00099800
              AIF   ('&ZCGPR' LT '2').ZG10Q                             00099900
              AIF   ('&ZCGPR' LE '12').ZG10R                            00100000
.ZG10Q        ANOP  ,                                                   00100100
&ZMS          SETC  '"CART='                                            00100200
&ZMS          SETC  '&ZMS.&CART"'                                       00100300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00100400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00100500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00100600
.ZG10R        ANOP  ,                                                   00100700
.*----------------------------------------------------------------***   00100800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00100900
              AIF   (N'&MASK LE 1).ZG12A        CK NUM                  00101000
&ZMS          SETC  '"MASK='                                            00101100
&ZMS          SETC  '&ZMS.&MASK"'                                       00101200
&ZMS          SETC  '&ZMS "MASK"'                                       00101300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00101400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101500
.ZG12A        ANOP  ,                                                   00101600
.*-------------------------------------------------------------------   00101700
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00101800
&XMASK        SETC  'NULL'      SET DEFAULT                             00101900
              AIF   (K'&MASK(1) LE 0).ZG12C     PARM                    00102000
&XMASK        SETC  '&MASK(1)'  SET XVARIABLE                           00102100
              AIF   (N'&MASK GT 1).ZG12B        MULTI PARMS             00102200
&XMASK        SETC  '&MASK'     SET XVARIABLE                           00102300
.ZG12B        AIF   (K'&CART(1) GT 0).ZG12C     KEY                     00102400
&ZMS          SETC  '"MASK'                                             00102500
&ZMS          SETC  '&ZMS.=&MASK"'                                      00102600
&ZMS          SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                     00102700
&ZMS          SETC  '&ZMS '                                             00102800
&ZMS          SETC  '&ZMS "CART"'                                       00102900
              MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                        00103000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00103100
.ZG12C        ANOP  ,                                                   00103200
&ZXMASK       SETC  'INPUT'     SET IN/OUTPUT                           00103300
.*-------------------------------------------------------------------   00103400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00103500
              AIF   (K'&ZXMASK LE 0).ZG12R      NOT I/O                 00103600
         AIF   ('&XMASK' EQ 'NULL').ZG12R                               00103700
              AIF   ('&XMASK'(1,1) NE '(').ZG12R                        00103800
&ZCGPR        SETC  '&XMASK'(2,K'&XMASK-2)                              00103900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                        00104000
              AIF   (K'&ZCGPR GT 2).ZG12Q                               00104100
              AIF   ('&ZCGPR' EQ '0').ZG12Q                             00104200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00104300
              AIF   (T'&ZCGPR NE 'N').ZG12Q     INVALID REG NAME        00104400
.ZG12P        ANOP  ,                                                   00104500
              AIF   (T'&ZCGPR NE 'N').ZG12R     NON NUMERIC             00104600
              AIF   ('&ZCGPR' LT '2').ZG12Q                             00104700
              AIF   ('&ZCGPR' LE '12').ZG12R                            00104800
.ZG12Q        ANOP  ,                                                   00104900
&ZMS          SETC  '"MASK='                                            00105000
&ZMS          SETC  '&ZMS.&MASK"'                                       00105100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00105200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00105300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00105400
.ZG12R        ANOP  ,                                                   00105500
.*------------------------------------------------------------------    00105600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105700
.ZG15         ANOP  ,                                                   00105800
&ZXCMDRESP    SETC  'INPUT'     SET IN/OUTPUT                           00105900
              AIF   (K'&XCMDRESP GT 0).ZG15E    VALID ARG               00106000
              AIF   (T'&CMDRESP EQ 'O').ZG15D   OMITTED                 00106100
&ZASYSLNDX    SETA  0                                                   00106200
.ZG15A        ANOP  ,           POSITIONAL MACRO KEY                    00106300
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00106400
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG15C                    00106500
&ZTLC         SETC 'CMDRESP'                                            00106600
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG15A           00106700
.ZG15B        ANOP  ,                                                   00106800
&ZXCMDRESP    SETC  ''          RESET IN/OUTPUT                         00106900
&ZMS          SETC  'THE "CMDRESP" KEY'                                 00107000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00107100
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00107200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107300
              AGO   .ZG15E                                              00107400
.ZG15C        ANOP  ,                                                   00107500
&ZXCMDRESP    SETC  ''          RESET IN/OUTPUT                         00107600
&ZMS          SETC  '"CMDRESP='                                         00107700
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00107800
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00107900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00108000
&ZMS          SETC  '&ZMS "NO"'                                         00108100
&ZMS          SETC  '&ZMS OR "YES".'                                    00108200
              MNOTE 8,' &ZMS '                                          00108300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00108400
              AGO   .ZG15E                                              00108500
.ZG15D        ANOP  ,                                                   00108600
&XCMDRESP     SETC  'NO'        SET DEFAULT KEYWORD                     00108700
.ZG15E        ANOP  ,                                                   00108800
.*------------------------------------------------------------------    00108900
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109000
.ZG16         ANOP  ,                                                   00109100
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00109200
              AIF   (K'&XREQUEST GT 0).ZG16E    VALID ARG               00109300
              AIF   (T'&REQUEST EQ 'O').ZG16D   OMITTED                 00109400
&ZASYSLNDX    SETA  0                                                   00109500
.ZG16A        ANOP  ,           POSITIONAL MACRO KEY                    00109600
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00109700
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C                    00109800
&ZTLC         SETC 'REQUEST'                                            00109900
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG16A           00110000
.ZG16B        ANOP  ,                                                   00110100
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00110200
&ZMS          SETC  'THE "REQUEST" KEY'                                 00110300
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00110400
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00110500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00110600
              AGO   .ZG16E                                              00110700
.ZG16C        ANOP  ,                                                   00110800
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00110900
&ZMS          SETC  '"REQUEST='                                         00111000
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00111100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00111200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00111300
&ZMS          SETC  '&ZMS "RESUME"'                                     00111400
&ZMS          SETC  '&ZMS OR "GETMSG".'                                 00111500
              MNOTE 8,' &ZMS '                                          00111600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00111700
              AGO   .ZG16E                                              00111800
.ZG16D        ANOP  ,                                                   00111900
&XREQUEST     SETC  'RESUME'    SET DEFAULT KEYWORD                     00112000
.ZG16E        ANOP  ,                                                   00112100
.*------------------------------------------------------------------    00112200
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112300
              AIF   (K'&REQUEST(1) GT 0).ZG16F  PARM                    00112400
&XREQUEST     SETC  ''          ENSURE NULL KEYWORD                     00112500
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         00112600
&ZMS          SETC  'THE'                                               00112700
&ZMS          SETC  '&ZMS "REQUEST" KEY AND ITS'                        00112800
&ZMS          SETC  '&ZMS ARGUMENT ARE REQUIRED.'                       00112900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00113000
&ZMS          SETC  '&ZMS "RESUME"'                                     00113100
&ZMS          SETC  '&ZMS OR "GETMSG".'                                 00113200
              MNOTE 8,' &ZMS '                                          00113300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00113400
.ZG16F        ANOP  ,                                                   00113500
.*----------------------------------------------------------------***   00113600
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00113700
&XNAME1       SETC  ''          INITIALIZE XVARIABLE                    00113800
              AIF   (K'&CONSID LE 0).ZG18C                              00113900
&ZXNAME1      SETC  'INPUT'     SET IN/OUTPUT                           00114000
&XNAME1       SETC  'CONSID'    SET XVARIABLE                           00114100
&ZXCONSID     SETC  'INPUT'     SET IN/OUTPUT                           00114200
&XCONSID      SETC  '&CONSID(1)'                SET XVARIABLE PARM      00114300
              AIF   (N'&CONSID GT 1).ZG18A                              00114400
&XCONSID      SETC  '&CONSID'   SET XVARIABLE PARM                      00114500
.ZG18A        AIF   (N'&CONSID LE 1).ZG18B      CK NUM                  00114600
&ZMS          SETC  '"CONSID='                                          00114700
&ZMS          SETC  '&ZMS.&CONSID"'                                     00114800
&ZMS          SETC  '&ZMS "CONSID"'                                     00114900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00115000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00115100
.ZG18B        AIF   (K'&XCONSID GT 0).ZG18C     ONE PARM                00115200
&ZXNAME1      SETC  ''          RESET IN/OUTPUT                         00115300
&ZXCONSID     SETC  ''          RESET IN/OUTPUT                         00115400
&ZMS          SETC  ' '                                                 00115500
&ZMS          SETC  '&ZMS "CONSID" KEY AND ITS'                         00115600
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00115700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00115800
.ZG18C        ANOP  ,                                                   00115900
.*----------------------------------------------------------------***   00116000
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00116100
              AIF   (K'&NAME LE 0).ZG19D        NO ME KEY               00116200
              AIF   (N'&NAME LE 1).ZG19A        CK NUM                  00116300
&ZMS          SETC  '"NAME='                                            00116400
&ZMS          SETC  '&ZMS.&NAME"'                                       00116500
&ZMS          SETC  '&ZMS "NAME"'                                       00116600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00116700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00116800
.ZG19A        AIF   (K'&XNAME1 LE 0).ZG19B                              00116900
&ZMS          SETC  '"NAME'                                             00117000
&ZMS          SETC  '&ZMS.=&NAME"'                                      00117100
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00117200
&ZMS          SETC  '&ZMS "&XNAME1"'                                    00117300
              MNOTE 8,' &ZMS KEY.'                                      00117400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00117500
              AGO   .ZG19D                                              00117600
.*                                                                      00117700
.ZG19B        ANOP  ,                                                   00117800
&ZXNAME1      SETC  'INPUT'     SET IN/OUTPUT                           00117900
&XNAME1       SETC  'NAME'      SET XVARIABLE                           00118000
&ZXNAME       SETC  'INPUT'     SET IN/OUTPUT                           00118100
&XNAME        SETC  '&NAME(1)'  SET XVARIABLE PARM                      00118200
              AIF   (N'&NAME GT 1).ZG19C                                00118300
&XNAME        SETC  '&NAME'     SET XVARIABLE PARM                      00118400
.ZG19C        AIF   (K'&XNAME GT 0).ZG19D       ONE PARM                00118500
&ZXNAME1      SETC  ''          RESET IN/OUTPUT                         00118600
&ZXNAME       SETC  ''          RESET IN/OUTPUT                         00118700
&ZMS          SETC  ' '                                                 00118800
&ZMS          SETC  '&ZMS "NAME" KEY AND ITS'                           00118900
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00119000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119100
.ZG19D        ANOP  ,                                                   00119200
.*------------------------------------------------------------------    00119300
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00119400
              AIF   (K'&XNAME1 GT 0).ZG20B                              00119500
&ZXNAME1      SETC  ''          RESET IN/OUTPUT                         00119600
&ZXCONSID     SETC  ''          RESET IN/OUTPUT                         00119700
&XNAME1       SETC  ''          ENSURE NULL                             00119800
&XCONSID      SETC  ''          ENSURE NULL                             00119900
&ZMS          SETC  'ONE OF THE FOLLOWING'                              00120000
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 00120100
&ZMS          SETC  '&ZMS REQUIRED:'                                    00120200
&ZMS          SETC  '&ZMS "CONSID"'             VALID ME KEY            00120300
&ZMS          SETC  '&ZMS OR "NAME".'           VALID ME KEY            00120400
              MNOTE 8,' &ZMS '                                          00120500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00120600
.ZG20B        ANOP  ,                                                   00120700
.*-------------------------------------------------------------------   00120800
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00120900
.ZG18ZY  AIF    ('&XNAME1' NE 'CONSID').ZG19ZY                          00121000
.*-------------------------------------------------------------------   00121100
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00121200
              AIF   (K'&ZXCONSID LE 0).ZG18R    NOT I/O                 00121300
              AIF   ('&XCONSID'(1,1) NE '(').ZG18R                      00121400
&ZCGPR        SETC  '&XCONSID'(2,K'&XCONSID-2)                          00121500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                        00121600
              AIF   (K'&ZCGPR GT 2).ZG18Q                               00121700
              AIF   ('&ZCGPR' EQ '0').ZG18Q                             00121800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00121900
              AIF   (T'&ZCGPR NE 'N').ZG18Q     INVALID REG NAME        00122000
.ZG18P        ANOP  ,                                                   00122100
              AIF   (T'&ZCGPR NE 'N').ZG18R     NON NUMERIC             00122200
              AIF   ('&ZCGPR' LT '2').ZG18Q                             00122300
              AIF   ('&ZCGPR' LE '12').ZG18R                            00122400
.ZG18Q        ANOP  ,                                                   00122500
&ZMS          SETC  '"CONSID='                                          00122600
&ZMS          SETC  '&ZMS.&CONSID"'                                     00122700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00122800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00122900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00123000
.ZG18R        ANOP  ,                                                   00123100
.*-------------------------------------------------------------------   00123200
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00123300
.ZG19ZY  AIF    ('&XNAME1' NE 'NAME').ZG20ZY                            00123400
.*-------------------------------------------------------------------   00123500
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00123600
              AIF   (K'&ZXNAME LE 0).ZG19R      NOT I/O                 00123700
              AIF   ('&XNAME'(1,1) NE '(').ZG19R                        00123800
&ZCGPR        SETC  '&XNAME'(2,K'&XNAME-2)                              00123900
              AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                        00124000
              AIF   (K'&ZCGPR GT 2).ZG19Q                               00124100
              AIF   ('&ZCGPR' EQ '0').ZG19Q                             00124200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00124300
              AIF   (T'&ZCGPR NE 'N').ZG19Q     INVALID REG NAME        00124400
.ZG19P        ANOP  ,                                                   00124500
              AIF   (T'&ZCGPR NE 'N').ZG19R     NON NUMERIC             00124600
              AIF   ('&ZCGPR' LT '2').ZG19Q                             00124700
              AIF   ('&ZCGPR' LE '12').ZG19R                            00124800
.ZG19Q        ANOP  ,                                                   00124900
&ZMS          SETC  '"NAME='                                            00125000
&ZMS          SETC  '&ZMS.&NAME"'                                       00125100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00125200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00125300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00125400
.ZG19R        ANOP  ,                                                   00125500
.*-------------------------------------------------------------------   00125600
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00125700
.ZG20ZY       ANOP ,            END MUTUALLY EXCLUSIVE KEYS             00125800
.*-------------------------------------------------------------------   00125900
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00126000
              AIF   ('&XMF' EQ 'M').ZG23        BYPASS IF MF=M          00126100
.*----------------------------------------------------------------***   00126200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00126300
              AIF   (N'&RTNCODE LE 1).ZG22A     CK NUM                  00126400
&ZMS          SETC  '"RTNCODE='                                         00126500
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00126600
&ZMS          SETC  '&ZMS "RTNCODE"'                                    00126700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00126800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126900
.ZG22A        ANOP  ,                                                   00127000
.*-------------------------------------------------------------------   00127100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00127200
              AIF   (K'&RTNCODE(1) LE 0).ZG22C  NO PARM                 00127300
&ZXRTNCODE    SETC  'OUTPUT'    SET OUTPUT                              00127400
&XRTNCODE     SETC  '&RTNCODE(1)'               SET XVARIABLE           00127500
              AIF   (N'&RTNCODE GT 1).ZG22C                             00127600
&XRTNCODE     SETC  '&RTNCODE'  SET XVARIABLE                           00127700
.ZG22C        ANOP  ,                                                   00127800
.*-------------------------------------------------------------------   00127900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00128000
              AIF   (K'&ZXRTNCODE LE 0).ZG22R   NOT I/O                 00128100
              AIF   ('&XRTNCODE'(1,1) NE '(').ZG22R                     00128200
&ZCGPR        SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                        00128300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                        00128400
              AIF   (K'&ZCGPR GT 2).ZG22Q                               00128500
              AIF   ('&ZCGPR' EQ '0').ZG22Q                             00128600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00128700
              AIF   (T'&ZCGPR NE 'N').ZG22Q     INVALID REG NAME        00128800
.ZG22P        ANOP  ,                                                   00128900
              AIF   (T'&ZCGPR NE 'N').ZG22R     NON NUMERIC             00129000
              AIF   ('&ZCGPR' LT '2').ZG22Q                             00129100
              AIF   ('&ZCGPR' LE '12').ZG22R                            00129200
.ZG22Q        ANOP  ,                                                   00129300
&ZMS          SETC  '"RTNCODE='                                         00129400
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00129500
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00129600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00129700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00129800
.ZG22R        ANOP  ,                                                   00129900
.*-------------------------------------------------------------------   00130000
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00130100
.ZG23         ANOP  ,           END OF BYPASS CHECK                     00130200
.*----------------------------------------------------------------***   00130300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00130400
              AIF   (N'&RSNCODE LE 1).ZG25A     CK NUM                  00130500
&ZMS          SETC  '"RSNCODE='                                         00130600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00130700
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00130800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00130900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131000
.ZG25A        ANOP  ,                                                   00131100
.*-------------------------------------------------------------------   00131200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00131300
              AIF   (K'&RSNCODE(1) LE 0).ZG25C  NO PARM                 00131400
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00131500
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00131600
              AIF   (N'&RSNCODE GT 1).ZG25C                             00131700
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00131800
.ZG25C        ANOP  ,                                                   00131900
.*-------------------------------------------------------------------   00132000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00132100
              AIF   (K'&ZXRSNCODE LE 0).ZG25R   NOT I/O                 00132200
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG25R                     00132300
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00132400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                        00132500
              AIF   (K'&ZCGPR GT 2).ZG25Q                               00132600
              AIF   ('&ZCGPR' EQ '0').ZG25Q                             00132700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00132800
              AIF   (T'&ZCGPR NE 'N').ZG25Q     INVALID REG NAME        00132900
.ZG25P        ANOP  ,                                                   00133000
              AIF   (T'&ZCGPR NE 'N').ZG25R     NON NUMERIC             00133100
              AIF   ('&ZCGPR' LT '2').ZG25Q                             00133200
              AIF   ('&ZCGPR' LE '12').ZG25R                            00133300
.ZG25Q        ANOP  ,                                                   00133400
&ZMS          SETC  '"RSNCODE='                                         00133500
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00133600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00133700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00133800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00133900
.ZG25R        ANOP  ,                                                   00134000
.******************************************************************     00134100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00134200
.******************************************************************     00134300
              ACTR  10000                                               00134400
.*----------------------------------------------------------------***   00134500
.***AH.P02 EXTRA POSITIONALS                                            00134600
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00134700
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00134800
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00134900
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00135000
.ZGLISTX1     ANOP  ,                                                   00135100
&ZCVAL        SETC  ''          ERROR FIELD                             00135200
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00135300
.ZGLIST2      ANOP  ,                                                   00135400
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00135500
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00135600
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00135700
              AGO   .ZGLIST2                                            00135800
.*                                                                      00135900
.ZGLIST3      ANOP  ,                                                   00136000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00136100
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00136200
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00136300
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00136400
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00136500
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00136600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00136700
.ZGLISTX      ANOP  ,                                                   00136800
&ZASYSLNDX    SETA  0                                                   00136900
.*-------------------------------------------------------------------   00137000
.***AG.MF04 MF=(SLME)                                                   00137100
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00137200
.********************************************************************   00137300
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00137400
.********************************************************************   00137500
              ACTR  10000                                               00137600
.*-------------------------------------------------------------------   00137700
.***AE.MF01 MF=(SLME)                                                   00137800
              AIF   ('&XMF' EQ 'L').ZEMFX                               00137900
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00138000
.********************************************************************   00138100
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00138200
.********************************************************************   00138300
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    00138400
&XCMDRESP     SETC  ''          INITIALIZE XVARIABLE                    00138500
.*-------------------------------------------------------------------   00138600
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138700
&ZTLC         SETC 'RESUME'                                             00138800
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE3A                     00138900
&XREQUEST     SETC  'RESUME'    SET KEYWORD                             00139000
              AIF   (N'&REQUEST LE 1).ZE3A      CK NUM                  00139100
&ZMS          SETC  '"REQUEST='                                         00139200
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00139300
&ZMS          SETC  '&ZMS "REQUEST"'                                    00139400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00139500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00139600
.ZE3A         ANOP  ,                                                   00139700
.*-------------------------------------------------------------------   00139800
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00139900
&ZTLC         SETC 'GETMSG'                                             00140000
              AIF   ('&REQUEST(1)' NE '&ZTLC').ZE4A                     00140100
&XREQUEST     SETC  'GETMSG'    SET KEYWORD                             00140200
              AIF   (N'&REQUEST LE 1).ZE4A      CK NUM                  00140300
&ZMS          SETC  '"REQUEST='                                         00140400
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00140500
&ZMS          SETC  '&ZMS "REQUEST"'                                    00140600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00140700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00140800
.ZE4A         ANOP  ,                                                   00140900
.*-------------------------------------------------------------------   00141000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141100
&ZTLC         SETC 'NO'                                                 00141200
              AIF   ('&CMDRESP(1)' NE '&ZTLC').ZE7A                     00141300
&XCMDRESP     SETC  'NO'        SET KEYWORD                             00141400
              AIF   (N'&CMDRESP LE 1).ZE7A      CK NUM                  00141500
&ZMS          SETC  '"CMDRESP='                                         00141600
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00141700
&ZMS          SETC  '&ZMS "CMDRESP"'                                    00141800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00141900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00142000
.ZE7A         ANOP  ,                                                   00142100
.*-------------------------------------------------------------------   00142200
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142300
&ZTLC         SETC 'YES'                                                00142400
              AIF   ('&CMDRESP(1)' NE '&ZTLC').ZE8A                     00142500
&XCMDRESP     SETC  'YES'       SET KEYWORD                             00142600
              AIF   (N'&CMDRESP LE 1).ZE8A      CK NUM                  00142700
&ZMS          SETC  '"CMDRESP='                                         00142800
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00142900
&ZMS          SETC  '&ZMS "CMDRESP"'                                    00143000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00143100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00143200
.ZE8A         ANOP  ,                                                   00143300
.*----------------------------------------------------------------***   00143400
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00143500
              AIF   (N'&CART LE 1).ZE10A        CK NUM                  00143600
&ZMS          SETC  '"CART='                                            00143700
&ZMS          SETC  '&ZMS.&CART"'                                       00143800
&ZMS          SETC  '&ZMS "CART"'                                       00143900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00144000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00144100
.ZE10A        ANOP  ,                                                   00144200
.*-------------------------------------------------------------------   00144300
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00144400
              AIF   (K'&CART(1) LE 0).ZE10B     NO PRM                  00144500
&ZXCART       SETC  'INPUT'     SET IN/OUTPUT                           00144600
&XCART        SETC  '&CART(1)'  SET XVARIABLE                           00144700
              AIF   (N'&CART GT 1).ZE10B                                00144800
.*            ANOP              MULTIPLE PARMS                          00144900
&XCART        SETC  '&CART'     SET XVARIABLE                           00145000
.ZE10B        ANOP  ,                                                   00145100
.*-------------------------------------------------------------------   00145200
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00145300
              AIF   (K'&ZXCART LE 0).ZE10R      NOT I/O                 00145400
              AIF   ('&XCART'(1,1) NE '(').ZE10R                        00145500
&ZCGPR        SETC  '&XCART'(2,K'&XCART-2)                              00145600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        00145700
              AIF   (K'&ZCGPR GT 2).ZE10Q                               00145800
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             00145900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00146000
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        00146100
.ZE10P        ANOP  ,                                                   00146200
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             00146300
              AIF   ('&ZCGPR' LT '2').ZE10Q                             00146400
              AIF   ('&ZCGPR' LE '12').ZE10R                            00146500
.ZE10Q        ANOP  ,                                                   00146600
&ZMS          SETC  '"CART='                                            00146700
&ZMS          SETC  '&ZMS.&CART"'                                       00146800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00146900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00147000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00147100
.ZE10R        ANOP  ,                                                   00147200
.*----------------------------------------------------------------***   00147300
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00147400
              AIF   (N'&MASK LE 1).ZE12A        CK NUM                  00147500
&ZMS          SETC  '"MASK='                                            00147600
&ZMS          SETC  '&ZMS.&MASK"'                                       00147700
&ZMS          SETC  '&ZMS "MASK"'                                       00147800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00147900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148000
.ZE12A        ANOP  ,                                                   00148100
.*-------------------------------------------------------------------   00148200
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00148300
              AIF   (K'&MASK(1) LE 0).ZE12B     NO PRM                  00148400
&ZXMASK       SETC  'INPUT'     SET IN/OUTPUT                           00148500
&XMASK        SETC  '&MASK(1)'  SET XVARIABLE                           00148600
              AIF   (N'&MASK GT 1).ZE12B                                00148700
.*            ANOP              MULTIPLE PARMS                          00148800
&XMASK        SETC  '&MASK'     SET XVARIABLE                           00148900
.ZE12B        ANOP  ,                                                   00149000
.*-------------------------------------------------------------------   00149100
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00149200
              AIF   (K'&ZXMASK LE 0).ZE12R      NOT I/O                 00149300
              AIF   ('&XMASK'(1,1) NE '(').ZE12R                        00149400
&ZCGPR        SETC  '&XMASK'(2,K'&XMASK-2)                              00149500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE12P                        00149600
              AIF   (K'&ZCGPR GT 2).ZE12Q                               00149700
              AIF   ('&ZCGPR' EQ '0').ZE12Q                             00149800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00149900
              AIF   (T'&ZCGPR NE 'N').ZE12Q     INVALID REG NAME        00150000
.ZE12P        ANOP  ,                                                   00150100
              AIF   (T'&ZCGPR NE 'N').ZE12R     NON NUMERIC             00150200
              AIF   ('&ZCGPR' LT '2').ZE12Q                             00150300
              AIF   ('&ZCGPR' LE '12').ZE12R                            00150400
.ZE12Q        ANOP  ,                                                   00150500
&ZMS          SETC  '"MASK='                                            00150600
&ZMS          SETC  '&ZMS.&MASK"'                                       00150700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00150800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00150900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151000
.ZE12R        ANOP  ,                                                   00151100
.*------------------------------------------------------------------    00151200
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00151300
.ZE15         AIF   (K'&XCMDRESP GT 0).ZE15A                            00151400
              AIF   (K'&CMDRESP(1) LE 0).ZE15B                          00151500
&ZMS          SETC  '"CMDRESP='                                         00151600
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    00151700
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00151800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00151900
&ZMS          SETC  '&ZMS "NO"'                                         00152000
&ZMS          SETC  '&ZMS OR "YES".'                                    00152100
              MNOTE 8,' &ZMS '                                          00152200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00152300
              AGO   .ZE15B                                              00152400
.*                                                                      00152500
.ZE15A        ANOP  ,                                                   00152600
&ZXCMDRESP    SETC  'INPUT'     SET IN/OUTPUT                           00152700
.ZE15B        ANOP  ,                                                   00152800
.*------------------------------------------------------------------    00152900
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00153000
.ZE16         AIF   (K'&XREQUEST GT 0).ZE16A                            00153100
              AIF   (K'&REQUEST(1) LE 0).ZE16B                          00153200
&ZMS          SETC  '"REQUEST='                                         00153300
&ZMS          SETC  '&ZMS.&REQUEST"'                                    00153400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00153500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00153600
&ZMS          SETC  '&ZMS "RESUME"'                                     00153700
&ZMS          SETC  '&ZMS OR "GETMSG".'                                 00153800
              MNOTE 8,' &ZMS '                                          00153900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00154000
              AGO   .ZE16B                                              00154100
.*                                                                      00154200
.ZE16A        ANOP  ,                                                   00154300
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           00154400
.ZE16B        ANOP  ,                                                   00154500
.*----------------------------------------------------------------***   00154600
.***AE.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00154700
&XNAME1       SETC  ''          INITIALIZE XVARIABLE                    00154800
              AIF   (K'&CONSID LE 0).ZE18C                              00154900
&ZXNAME1      SETC  'INPUT'     SET IN/OUTPUT                           00155000
&XNAME1       SETC  'CONSID'    SET XVARIABLE                           00155100
&ZXCONSID     SETC  'INPUT'     SET IN/OUTPUT                           00155200
&XCONSID      SETC  '&CONSID(1)'                SET XVARIABLE PARM      00155300
              AIF   (N'&CONSID GT 1).ZE18A      MULTIPLE PARMS          00155400
&XCONSID      SETC  '&CONSID'   SET XVARIABLE PARM                      00155500
.ZE18A        AIF   (N'&CONSID LE 1).ZE18B      CK NUM                  00155600
&ZMS          SETC  '"CONSID='                                          00155700
&ZMS          SETC  '&ZMS.&CONSID"'                                     00155800
&ZMS          SETC  '&ZMS "CONSID"'                                     00155900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00156000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00156100
.ZE18B        AIF   (K'&XCONSID GT 0).ZE18C     ONE PARM                00156200
&ZXNAME1      SETC  ''          RESET IN/OUTPUT                         00156300
&ZXCONSID     SETC  ''          RESET IN/OUTPUT                         00156400
.ZE18C        ANOP  ,                                                   00156500
.*----------------------------------------------------------------***   00156600
.***AE.KMEKY02 NAME, RQD INPUT, ME KEYS -NON-XVAR KEY                   00156700
              AIF   (K'&NAME LE 0).ZE19D        NO ME KEY               00156800
              AIF   (N'&NAME LE 1).ZE19A        CK NUM                  00156900
&ZMS          SETC  '"NAME='                                            00157000
&ZMS          SETC  '&ZMS.&NAME"'                                       00157100
&ZMS          SETC  '&ZMS "NAME"'                                       00157200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00157300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157400
.ZE19A        AIF   (K'&XNAME1 LE 0).ZE19B                              00157500
&ZMS          SETC  '"NAME'                                             00157600
&ZMS          SETC  '&ZMS.=&NAME"'                                      00157700
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               00157800
&ZMS          SETC  '&ZMS "&XNAME1"'                                    00157900
              MNOTE 8,' &ZMS KEY.'                                      00158000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00158100
              AGO   .ZE19D                                              00158200
.*                                                                      00158300
.ZE19B        ANOP  ,                                                   00158400
&ZXNAME1      SETC  'INPUT'     SET IN/OUTPUT                           00158500
&XNAME1       SETC  'NAME'      SET XVARIABLE                           00158600
&ZXNAME       SETC  'INPUT'     SET IN/OUTPUT                           00158700
&XNAME        SETC  '&NAME(1)'  SET PARM                                00158800
              AIF   (N'&NAME GT 1).ZE19C        MULTIPLE PARMS          00158900
&XNAME        SETC  '&NAME'     SET PARM                                00159000
.ZE19C        AIF   (K'&XNAME GT 0).ZE19D       ONE PARM                00159100
&ZXNAME1      SETC  ''          RESET IN/OUTPUT                         00159200
&ZXNAME       SETC  ''          RESET IN/OUTPUT                         00159300
.ZE19D        ANOP  ,                                                   00159400
.*------------------------------------------------------------------    00159500
.***AE.KMEKY07 NAME, RQD INPUT, ME KEYS -CHECK IF ENTERED               00159600
              AIF   (K'&XNAME1 GT 0).ZE20B                              00159700
&ZXNAME1      SETC  ''          RESET IN/OUTPUT                         00159800
&XNAME1       SETC  ''          SET NULL                                00159900
&ZXCONSID     SETC  ''          RESET OUTPUT                            00160000
&XCONSID      SETC  ''          SET NULL PARM                           00160100
.ZE20B        ANOP  ,                                                   00160200
.*-------------------------------------------------------------------   00160300
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00160400
.ZE18     AIF   ('&XNAME1' NE 'CONSID').ZE19                            00160500
.*-------------------------------------------------------------------   00160600
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00160700
              AIF   (K'&ZXCONSID LE 0).ZE18R    NOT I/O                 00160800
              AIF   ('&XCONSID'(1,1) NE '(').ZE18R                      00160900
&ZCGPR        SETC  '&XCONSID'(2,K'&XCONSID-2)                          00161000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE18P                        00161100
              AIF   (K'&ZCGPR GT 2).ZE18Q                               00161200
              AIF   ('&ZCGPR' EQ '0').ZE18Q                             00161300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00161400
              AIF   (T'&ZCGPR NE 'N').ZE18Q     INVALID REG NAME        00161500
.ZE18P        ANOP  ,                                                   00161600
              AIF   (T'&ZCGPR NE 'N').ZE18R     NON NUMERIC             00161700
              AIF   ('&ZCGPR' LT '2').ZE18Q                             00161800
              AIF   ('&ZCGPR' LE '12').ZE18R                            00161900
.ZE18Q        ANOP  ,                                                   00162000
&ZMS          SETC  '"CONSID='                                          00162100
&ZMS          SETC  '&ZMS.&CONSID"'                                     00162200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00162300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00162400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162500
.ZE18R        ANOP  ,                                                   00162600
.*-------------------------------------------------------------------   00162700
.***AE.KMEKY08 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00162800
.ZE19     AIF   ('&XNAME1' NE 'NAME').ZE20                              00162900
.*-------------------------------------------------------------------   00163000
.***AE.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00163100
              AIF   (K'&ZXNAME LE 0).ZE19R      NOT I/O                 00163200
              AIF   ('&XNAME'(1,1) NE '(').ZE19R                        00163300
&ZCGPR        SETC  '&XNAME'(2,K'&XNAME-2)                              00163400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE19P                        00163500
              AIF   (K'&ZCGPR GT 2).ZE19Q                               00163600
              AIF   ('&ZCGPR' EQ '0').ZE19Q                             00163700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00163800
              AIF   (T'&ZCGPR NE 'N').ZE19Q     INVALID REG NAME        00163900
.ZE19P        ANOP  ,                                                   00164000
              AIF   (T'&ZCGPR NE 'N').ZE19R     NON NUMERIC             00164100
              AIF   ('&ZCGPR' LT '2').ZE19Q                             00164200
              AIF   ('&ZCGPR' LE '12').ZE19R                            00164300
.ZE19Q        ANOP  ,                                                   00164400
&ZMS          SETC  '"NAME='                                            00164500
&ZMS          SETC  '&ZMS.&NAME"'                                       00164600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00164700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00164800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00164900
.ZE19R        ANOP  ,                                                   00165000
.*-------------------------------------------------------------------   00165100
.***AE.KMEKY09 NAME, RQD INPUT, ME KEYS -END                            00165200
.ZE20         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             00165300
.*----------------------------------------------------------------***   00165400
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00165500
              AIF   (N'&RTNCODE LE 1).ZE22A     CK NUM                  00165600
&ZMS          SETC  '"RTNCODE='                                         00165700
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00165800
&ZMS          SETC  '&ZMS "RTNCODE"'                                    00165900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00166000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00166100
.ZE22A        ANOP  ,                                                   00166200
.*-------------------------------------------------------------------   00166300
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00166400
              AIF   (K'&RTNCODE(1) LE 0).ZE22B  NO PRM                  00166500
&ZXRTNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00166600
&XRTNCODE     SETC  '&RTNCODE(1)'               SET XVARIABLE           00166700
              AIF   (N'&RTNCODE GT 1).ZE22B                             00166800
.*            ANOP              MULTIPLE PARMS                          00166900
&XRTNCODE     SETC  '&RTNCODE'  SET XVARIABLE                           00167000
.ZE22B        ANOP  ,                                                   00167100
.*-------------------------------------------------------------------   00167200
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00167300
              AIF   (K'&ZXRTNCODE LE 0).ZE22R   NOT I/O                 00167400
              AIF   ('&XRTNCODE'(1,1) NE '(').ZE22R                     00167500
&ZCGPR        SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                        00167600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE22P                        00167700
              AIF   (K'&ZCGPR GT 2).ZE22Q                               00167800
              AIF   ('&ZCGPR' EQ '0').ZE22Q                             00167900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00168000
              AIF   (T'&ZCGPR NE 'N').ZE22Q     INVALID REG NAME        00168100
.ZE22P        ANOP  ,                                                   00168200
              AIF   (T'&ZCGPR NE 'N').ZE22R     NON NUMERIC             00168300
              AIF   ('&ZCGPR' LT '2').ZE22Q                             00168400
              AIF   ('&ZCGPR' LE '12').ZE22R                            00168500
.ZE22Q        ANOP  ,                                                   00168600
&ZMS          SETC  '"RTNCODE='                                         00168700
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00168800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00168900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00169000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00169100
.ZE22R        ANOP  ,                                                   00169200
.*----------------------------------------------------------------***   00169300
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00169400
              AIF   (N'&RSNCODE LE 1).ZE25A     CK NUM                  00169500
&ZMS          SETC  '"RSNCODE='                                         00169600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00169700
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00169800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00169900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00170000
.ZE25A        ANOP  ,                                                   00170100
.*-------------------------------------------------------------------   00170200
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00170300
              AIF   (K'&RSNCODE(1) LE 0).ZE25B  NO PRM                  00170400
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00170500
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00170600
              AIF   (N'&RSNCODE GT 1).ZE25B                             00170700
.*            ANOP              MULTIPLE PARMS                          00170800
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00170900
.ZE25B        ANOP  ,                                                   00171000
.*-------------------------------------------------------------------   00171100
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00171200
              AIF   (K'&ZXRSNCODE LE 0).ZE25R   NOT I/O                 00171300
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE25R                     00171400
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00171500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE25P                        00171600
              AIF   (K'&ZCGPR GT 2).ZE25Q                               00171700
              AIF   ('&ZCGPR' EQ '0').ZE25Q                             00171800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00171900
              AIF   (T'&ZCGPR NE 'N').ZE25Q     INVALID REG NAME        00172000
.ZE25P        ANOP  ,                                                   00172100
              AIF   (T'&ZCGPR NE 'N').ZE25R     NON NUMERIC             00172200
              AIF   ('&ZCGPR' LT '2').ZE25Q                             00172300
              AIF   ('&ZCGPR' LE '12').ZE25R                            00172400
.ZE25Q        ANOP  ,                                                   00172500
&ZMS          SETC  '"RSNCODE='                                         00172600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00172700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00172800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00172900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00173000
.ZE25R        ANOP  ,                                                   00173100
.******************************************************************     00173200
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00173300
.******************************************************************     00173400
              ACTR  10000                                               00173500
.*----------------------------------------------------------------***   00173600
.***AF.P02 EXTRA POSITIONALS                                            00173700
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00173800
&ZCVAL        SETC  ''          ERROR FIELD                             00173900
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00174000
.ZELIST2      ANOP  ,                                                   00174100
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00174200
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00174300
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00174400
              AGO   .ZELIST2                                            00174500
.*                                                                      00174600
.ZELIST3      ANOP  ,                                                   00174700
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00174800
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00174900
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00175000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00175100
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00175200
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00175300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175400
.ZELISTX      ANOP  ,                                                   00175500
&ZASYSLNDX    SETA  0                                                   00175600
.*-------------------------------------------------------------------   00175700
.***AE.MF02 MF=(SLME)                                                   00175800
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00175900
.*******************************************************************    00176000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00176100
.*******************************************************************    00176200
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00176300
.*******************************************************************    00176400
.***AE.01  START OF MCSOPMSG MACRO CODE                                 00176500
.*******************************************************************    00176600
              LCLC  &M0M0001                 NAME                       00176700
&M0M0001      SETC  '&XLABEL'                SET NAME                   00176800
              AIF   (K'&XLABEL NE 0).XLAB2                              00176900
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00177000
.*                                                                      00177100
.XLAB2        ANOP  ,                                                   00177200
              AIF   ('&XMF' EQ 'L').XLAB3                               00177300
&M0M0001 DS    0H                             MCSOPMSG-2                00177400
.XLAB3        ANOP  ,                                                   00177500
.*******************************************************************    00177600
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00177700
.*******************************************************************    00177800
              PUSH  PRINT                                               00177900
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00178000
              PRINT OFF         ++ PR01                                 00178100
              AGO   .ZPRNTXX                                            00178200
.ZPRINTX      PRINT ON                                                  00178300
.ZPRNTXX      ANOP  ,                                                   00178400
.********************************************************************   00178500
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00178600
.********************************************************************   00178700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00178800
                      LCLA  &ZOPN1         INVOCATION INDEX             00178900
                      LCLC  &ZOPL(4095)    LABEL                        00179000
                      LCLC  &ZOPO(4095)    OPERATION                    00179100
                      LCLC  &ZOPV(4095)    VALUE                        00179200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00179300
.*                                                                      00179400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00179500
.******************************************************************     00179600
.***AL.L10 MCSOPMSG FMT=LIST MF=S!L PARAMETERS                          00179700
.******************************************************************     00179800
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00179900
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00180000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00180100
&XMFATTR              SETC  '0D'                                        00180200
.*                                                                      00180300
&ZOPN                 SETA  &ZOPN+1                                     00180400
&ZOPL(&ZOPN)          SETC  ' '                                         00180500
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00180600
&ZOPO(&ZOPN)          SETC  'B'                                         00180700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00180800
                      AGO   .ZALVL6B                                    00180900
.ZALVL6A              ANOP                                              00181000
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00181100
&ZOPV(&ZOPN)          SETC  '4,8'                                       00181200
&ZOPN                 SETA  &ZOPN+1                                     00181300
&ZOPL(&ZOPN)          SETC  ' '                                         00181400
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00181500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00181600
.ZALVL6B              ANOP                                              00181700
&ZOPD(&ZOPN)          SETC  '++ MCSOPMSG ARG PARMS'                     00181800
.*                                                                      00181900
&ZOPN                 SETA  &ZOPN+1                                     00182000
&ZOPL(&ZOPN)          SETC  ' '                                         00182100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00182200
&ZOPV(&ZOPN)          SETC  '1'                                         00182300
&ZOPD(&ZOPN)          SETC  ' '                                         00182400
.*                                                                      00182500
.ZLMFSL2              ANOP  ,                                           00182600
.*-------------------------------------------------------------------   00182700
.***AM.L00  MCSOPMSG FMT=LIST name                                      00182800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00182900
&ZOPN                 SETA &ZOPN+1                                      00183000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00183100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00183200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00183300
&ZOPD(&ZOPN)          SETC '++ MCSOPMSG NAME'                           00183400
.ZLMFSL2M             ANOP  ,                                           00183500
.*-------------------------------------------------------------------   00183600
.***AM.L01  MCSOPMSG FMT=LIST PARAMETERS                                00183700
&ZOPN                 SETA &ZOPN+1                                      00183800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00183900
&ZOPO(&ZOPN)          SETC 'DS'                                         00184000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00184100
&ZOPD(&ZOPN)          SETC '++ MCSOPMSG PARM LIST'                      00184200
.*-------------------------------------------------------------------   00184300
.***AM.L09  XACRO CL4                                                   00184400
&ZOPN                 SETA &ZOPN+1                                      00184500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACRO'                            00184600
&ZOPO(&ZOPN)          SETC 'DS'                                         00184700
&ZOPV(&ZOPN)          SETC 'CL4'                                        00184800
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00184900
.*-------------------------------------------------------------------   00185000
.***AM.L02 XVERSION XL1                                                 00185100
&ZOPN                 SETA &ZOPN+1                                      00185200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00185300
&ZOPO(&ZOPN)          SETC 'DS'                                         00185400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00185500
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00185600
.*-------------------------------------------------------------------   00185700
.***AM.L05 XREQUEST XL1                                                 00185800
&ZOPN                 SETA &ZOPN+1                                      00185900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00186000
&ZOPO(&ZOPN)          SETC 'DS'                                         00186100
&ZOPV(&ZOPN)          SETC 'XL1'                                        00186200
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00186300
.*                                                                      00186400
&ZOPN                 SETA  &ZOPN+1                                     00186500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._GETMSG'                          00186600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00186700
&ZOPV(&ZOPN)          SETC  '1'                                         00186800
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00186900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GETMSG'                       00187000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00187100
.*                                                                      00187200
&ZOPN                 SETA  &ZOPN+1                                     00187300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._RESUME'                          00187400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00187500
&ZOPV(&ZOPN)          SETC  '2'                                         00187600
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00187700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RESUME'                       00187800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00187900
.*-------------------------------------------------------------------   00188000
.***AM.L03 XCMDRESP BL.8                                                00188100
&ZOPN                 SETA &ZOPN+1                                      00188200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCMDRESP'                         00188300
&ZOPO(&ZOPN)          SETC 'DS'                                         00188400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00188500
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00188600
.*                                                                      00188700
&ZOPN                 SETA  &ZOPN+1                                     00188800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCMDRESP_YES'                    00188900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00189000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00189100
&ZOPD(&ZOPN)          SETC  '++ XCMDRESP.'                              00189200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00189300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00189400
.*                                                                      00189500
&ZOPN                 SETA  &ZOPN+1                                     00189600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCMDRESP_NO'                     00189700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00189800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00189900
&ZOPD(&ZOPN)          SETC  '++ XCMDRESP.'                              00190000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           00190100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00190200
.*                                                                      00190300
&ZOPN                 SETA  &ZOPN+1                                     00190400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CMDRESP'                 00190500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00190600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00190700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00190800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CMDRESP'                      00190900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00191000
.*                                                                      00191100
&ZOPN                 SETA  &ZOPN+1                                     00191200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CART'                    00191300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00191400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00191500
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00191600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CART'                         00191700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00191800
.*                                                                      00191900
&ZOPN                 SETA  &ZOPN+1                                     00192000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MASK'                    00192100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00192200
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00192300
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00192400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MASK'                         00192500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00192600
.*                                                                      00192700
&ZOPN                 SETA  &ZOPN+1                                     00192800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_NAME'                    00192900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00193000
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00193100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00193200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NAME'                         00193300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00193400
.*-------------------------------------------------------------------   00193500
.***AM.L09  XRSV0001 CL01                                               00193600
&ZOPN                 SETA &ZOPN+1                                      00193700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00193800
&ZOPO(&ZOPN)          SETC 'DS'                                         00193900
&ZOPV(&ZOPN)          SETC 'CL01'                                       00194000
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00194100
.*-------------------------------------------------------------------   00194200
.***AM.L09  XCART CL8                                                   00194300
&ZOPN                 SETA &ZOPN+1                                      00194400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCART'                            00194500
&ZOPO(&ZOPN)          SETC 'DS'                                         00194600
&ZOPV(&ZOPN)          SETC 'CL8'                                        00194700
&ZOPD(&ZOPN)          SETC '++ &ZXCART '                                00194800
.*-------------------------------------------------------------------   00194900
.***AM.L09  XMASK CL8                                                   00195000
&ZOPN                 SETA &ZOPN+1                                      00195100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMASK'                            00195200
&ZOPO(&ZOPN)          SETC 'DS'                                         00195300
&ZOPV(&ZOPN)          SETC 'CL8'                                        00195400
&ZOPD(&ZOPN)          SETC '++ &ZXMASK '                                00195500
.*-------------------------------------------------------------------   00195600
.***AM.L09  XCONSID F                                                   00195700
&ZOPN                 SETA &ZOPN+1                                      00195800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONSID'                          00195900
&ZOPO(&ZOPN)          SETC 'DS'                                         00196000
&ZOPV(&ZOPN)          SETC 'F'                                          00196100
&ZOPD(&ZOPN)          SETC '++ &ZXCONSID '                              00196200
.*-------------------------------------------------------------------   00196300
.***AM.L09  XRSV0002 CL04                                               00196400
&ZOPN                 SETA &ZOPN+1                                      00196500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00196600
&ZOPO(&ZOPN)          SETC 'DS'                                         00196700
&ZOPV(&ZOPN)          SETC 'CL04'                                       00196800
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00196900
.*-------------------------------------------------------------------   00197000
.***AM.MLM2 SAVED LOCATION COUNTER                                      00197100
                      AIF  (&XPLISTVER GE 2).ZL18LA                     00197200
                      AIF  ('&ZENDBASEPL' NE '').ZL18LA                 00197300
&ZENDBASEPL           SETC 'YES'                                        00197400
&ZOPN                 SETA &ZOPN+1                                      00197500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00197600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00197700
&ZOPV(&ZOPN)          SETC '*'                                          00197800
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00197900
.ZL18LA               ANOP  ,                                           00198000
.*-------------------------------------------------------------------   00198100
.***AM.LVER1                                                            00198200
                      AIF  (&XPLISTVER LT 2).ZL18L                      00198300
.*-------------------------------------------------------------------   00198400
.*-------------------------------------------------------------------   00198500
.***AM.L09  XNAME CL8                                                   00198600
&ZOPN                 SETA &ZOPN+1                                      00198700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNAME'                            00198800
&ZOPO(&ZOPN)          SETC 'DS'                                         00198900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00199000
&ZOPD(&ZOPN)          SETC '++ &ZXNAME '                                00199100
.*-------------------------------------------------------------------   00199200
.***AM.LVER2                                                            00199300
.ZL18L                ANOP  ,                                           00199400
.*-------------------------------------------------------------------   00199500
.*-------------------------------------------------------------------   00199600
.***AM.L10 END OF MCSOPMSG LIST PARAMETERS                              00199700
&ZOPN                 SETA &ZOPN+1                                      00199800
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00199900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00200000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00200100
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00200200
.*                                                                      00200300
&ZOPN                 SETA &ZOPN+1                                      00200400
&ZOPL(&ZOPN)          SETC ' '                                          00200500
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00200600
&ZOPV(&ZOPN)          SETC '1'                                          00200700
&ZOPD(&ZOPN)          SETC ' '                                          00200800
.*-------------------------------------------------------------------   00200900
.***AL.L12 MCSOPMSG FMT=LIST MF=S!L PARAMETERS                          00201000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00201100
.*                                                                      00201200
&ZOPN                 SETA  &ZOPN+1                                     00201300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00201400
&ZOPO(&ZOPN)          SETC  'DC'                                        00201500
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00201600
&ZOPD(&ZOPN)          SETC  '++ MCSOPMSG ARG PARMS'                     00201700
.*                                                                      00201800
.ZLMFSLX              ANOP  ,                                           00201900
.*-------------------------------------------------------------------   00202000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00202100
&ZPLLEN               SETA 32                                           00202200
.*                                                                      00202300
                      AIF  (&XPLISTVER LT 2).ZLLEN2Z                    00202400
&ZPLLEN               SETA 40                                           00202500
.ZLLEN2Z              ANOP  ,                                           00202600
.*                                                                      00202700
.******************************************************************     00202800
.***AI.L01 MCSOPMSG FMT=LIST FILL IN PARAMETER AREA                     00202900
.******************************************************************     00203000
                      ACTR  10000                                       00203100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00203200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00203300
&ZCVAL                SETC  'LAE'          XAX MODE                     00203400
.ZIMFXA               ANOP ,                                            00203500
.*                                                                      00203600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00203700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00203800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00203900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00204000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00204100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00204200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00204300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00204400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00204500
&ZOPN                 SETA  &ZOPN+1                                     00204600
&ZOPL(&ZOPN)          SETC  ' '                                         00204700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00204800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00204900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00205000
                      AGO   .ZIMFNX                                     00205100
.*                                                                      00205200
.ZIMFN2               ANOP ,                                            00205300
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00205400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00205500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00205600
&ZOPN                 SETA  &ZOPN+1                                     00205700
&ZOPL(&ZOPN)          SETC  ' '                                         00205800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00205900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00206000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00206100
                      AGO   .ZIMFNX                                     00206200
.ZIMFNX1              ANOP ,                                            00206300
&ZOPN                 SETA  &ZOPN+1                                     00206400
&ZOPL(&ZOPN)          SETC  ' '                                         00206500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00206600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00206700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00206800
.ZIMFNX               ANOP ,                                            00206900
.********************************************************************   00207000
.***AI.L02 MCSOPMSG FMT=LIST INITIALIZE PARAMETER AREA                  00207100
.********************************************************************   00207200
.***AI.L03 MF=(SLME)                                                    00207300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00207400
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00207500
.*                                                                      00207600
&ZOPN                 SETA  &ZOPN+1                                     00207700
&ZOPL(&ZOPN)          SETC  ' '                                         00207800
&ZOPO(&ZOPN)          SETC  'XC'                                        00207900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00208000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00208100
.ZIMFLX               ANOP  ,                                           00208200
.*-------------------------------------------------------------------   00208300
.***AI.L60 XACRO CL4                                                    00208400
&ZOPN                 SETA  &ZOPN+1                                     00208500
&ZOPL(&ZOPN)          SETC  ' '                                         00208600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00208700
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''MDR '''                       00208800
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           00208900
.*-------------------------------------------------------------------   00209000
.***AI.L04B XVERSION XL1                                                00209100
                      AIF   (&XPLISTVER EQ 0).ZIMFVX                    00209200
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVY            00209300
.ZIMFVX               ANOP  ,                                           00209400
                      AIF   ('&PLISTVER' EQ '').ZIMFVZ                  00209500
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZIMFVZ            00209600
.ZIMFVY               ANOP  ,                                           00209700
&ZOPN                 SETA  &ZOPN+1                                     00209800
&ZOPL(&ZOPN)          SETC  ' '                                         00209900
&ZOPO(&ZOPN)          SETC  'MVI'                                       00210000
&ZOPV(&ZOPN)          SETC  '4(1),&XPLISTVER'                           00210100
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00210200
.ZIMFVZ               ANOP  ,                                           00210300
.*-------------------------------------------------------------------   00210400
.***AI.L07 XREQUEST AL1                                                 00210500
&ZW                   SETC  ''                                          00210600
.*-------------------------------------------------------------------   00210700
.***AI.L15 XREQUEST "GETMSG" AL1                                        00210800
         AIF   ('&XREQUEST' NE 'GETMSG').ZI4A                           00210900
&ZW                   SETC  '1'                                         00211000
.ZI4A                 ANOP  ,                                           00211100
.*-------------------------------------------------------------------   00211200
.***AI.L15 XREQUEST "RESUME" AL1                                        00211300
         AIF   ('&XREQUEST' NE 'RESUME').ZI5A                           00211400
&ZW                   SETC  '2'                                         00211500
.ZI5A                 ANOP  ,                                           00211600
.*-------------------------------------------------------------------   00211700
.***AI.L17 XREQUEST AL1                                                 00211800
                      AIF   ('&ZW' NE '0').ZI5C                         00211900
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI5B              00212000
.ZI5C                 ANOP  ,                                           00212100
                      AIF   ('&ZW' EQ '').ZI5B                          00212200
.*                                                                      00212300
&ZOPN                 SETA  &ZOPN+1                                     00212400
&ZOPL(&ZOPN)          SETC  ' '                                         00212500
&ZOPO(&ZOPN)          SETC  'MVI'                                       00212600
&ZOPV(&ZOPN)          SETC  '5(1),&ZW'                                  00212700
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00212800
.ZI5B                 ANOP  ,                                           00212900
.*-------------------------------------------------------------------   00213000
.***AI.L05 XCMDRESP BL1                                                 00213100
&ZW                   SETC  ''                                          00213200
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00213300
&ZMS                  SETC  ''                                          00213400
&ZC                   SETC  ''                                          00213500
.*-------------------------------------------------------------------   00213600
.***AI.L08 XCMDRESP "YES"                                               00213700
.***      BL1'1XXXXXXX'                                                 00213800
         AIF   ('&XCMDRESP' NE 'YES').ZI7A                              00213900
&ZW                   SETC  '&ZW.1'                                     00214000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00214100
&ZMS                  SETC  '&ZMS.1'                                    00214200
                      AGO   .ZI7C                                       00214300
.*                                                                      00214400
.ZI7A                 ANOP  ,                                           00214500
&ZW                   SETC  '&ZW.0'                                     00214600
         AIF   ('&ZXCMDRESP' EQ '').ZI7B                                00214700
&ZMS                  SETC  '&ZMS.0'                                    00214800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00214900
                      AGO   .ZI7C                                       00215000
.*                                                                      00215100
.ZI7B                 ANOP  ,                                           00215200
&ZMS                  SETC  '&ZMS.1'                                    00215300
.ZI7C                 ANOP  ,                                           00215400
.*-------------------------------------------------------------------   00215500
.***AI.L08 XCMDRESP "NO"                                                00215600
.***      BL1'X1XXXXXX'                                                 00215700
         AIF   ('&XCMDRESP' NE 'NO').ZI8A                               00215800
&ZW                   SETC  '&ZW.1'                                     00215900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00216000
&ZMS                  SETC  '&ZMS.1'                                    00216100
                      AGO   .ZI8C                                       00216200
.*                                                                      00216300
.ZI8A                 ANOP  ,                                           00216400
&ZW                   SETC  '&ZW.0'                                     00216500
         AIF   ('&ZXCMDRESP' EQ '').ZI8B                                00216600
&ZMS                  SETC  '&ZMS.0'                                    00216700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00216800
                      AGO   .ZI8C                                       00216900
.*                                                                      00217000
.ZI8B                 ANOP  ,                                           00217100
&ZMS                  SETC  '&ZMS.1'                                    00217200
.ZI8C                 ANOP  ,                                           00217300
.*-------------------------------------------------------------------   00217400
.***AI.L08 XCMDRESP "CMDRESP"                                           00217500
.***      BL1'XX1XXXXX'                                                 00217600
         AIF   ('&CMDRESP' EQ '').ZI9A                                  00217700
&ZW                   SETC  '&ZW.1'                                     00217800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00217900
&ZMS                  SETC  '&ZMS.0'                                    00218000
                      AGO   .ZI9C                                       00218100
.*                                                                      00218200
.ZI9A                 ANOP  ,                                           00218300
&ZW                   SETC  '&ZW.0'                                     00218400
&ZMS                  SETC  '&ZMS.1'                                    00218500
.ZI9C                 ANOP  ,                                           00218600
.*-------------------------------------------------------------------   00218700
.***AI.L08 XCMDRESP "CART"                                              00218800
.***      BL1'XXX1XXXX'                                                 00218900
         AIF   ('&CART' EQ '').ZI10A                                    00219000
&ZW                   SETC  '&ZW.1'                                     00219100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00219200
&ZMS                  SETC  '&ZMS.0'                                    00219300
                      AGO   .ZI10C                                      00219400
.*                                                                      00219500
.ZI10A                ANOP  ,                                           00219600
&ZW                   SETC  '&ZW.0'                                     00219700
&ZMS                  SETC  '&ZMS.1'                                    00219800
.ZI10C                ANOP  ,                                           00219900
.*-------------------------------------------------------------------   00220000
.***AI.L08 XCMDRESP "MASK"                                              00220100
.***      BL1'XXXX1XXX'                                                 00220200
         AIF   ('&MASK' EQ '').ZI11A                                    00220300
&ZW                   SETC  '&ZW.1'                                     00220400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00220500
&ZMS                  SETC  '&ZMS.0'                                    00220600
                      AGO   .ZI11C                                      00220700
.*                                                                      00220800
.ZI11A                ANOP  ,                                           00220900
&ZW                   SETC  '&ZW.0'                                     00221000
&ZMS                  SETC  '&ZMS.1'                                    00221100
.ZI11C                ANOP  ,                                           00221200
.*-------------------------------------------------------------------   00221300
.***AI.L08 XCMDRESP "NAME"                                              00221400
.***      BL1'XXXXX1XX'                                                 00221500
         AIF   ('&NAME' EQ '').ZI12A                                    00221600
&ZW                   SETC  '&ZW.100'                                   00221700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00221800
&ZMS                  SETC  '&ZMS.011'                                  00221900
                      AGO   .ZI12C                                      00222000
.*                                                                      00222100
.ZI12A                ANOP  ,                                           00222200
&ZW                   SETC  '&ZW.000'                                   00222300
&ZMS                  SETC  '&ZMS.111'                                  00222400
.ZI12C                ANOP  ,                                           00222500
.*-------------------------------------------------------------------   00222600
.***AI.L11 XCMDRESP BL1                                                 00222700
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI12D              00222800
                      AIF   ('&ZC' NE 'YES').ZI12D                      00222900
&ZOPN                 SETA  &ZOPN+1                                     00223000
&ZOPL(&ZOPN)          SETC  ' '                                         00223100
&ZOPO(&ZOPN)          SETC  'NI'                                        00223200
&ZOPV(&ZOPN)          SETC  '6(1),B''&ZMS'''                            00223300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00223400
.ZI12D                ANOP  ,                                           00223500
                      AIF   ('&ZCLNG' NE 'YES').ZI12E  ALL ZERO BITS    00223600
&ZOPN                 SETA  &ZOPN+1                                     00223700
&ZOPL(&ZOPN)          SETC  ' '                                         00223800
&ZOPO(&ZOPN)          SETC  'OI'                                        00223900
&ZOPV(&ZOPN)          SETC  '6(1),B''&ZW'''                             00224000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00224100
.ZI12E                ANOP  ,                                           00224200
.*-------------------------------------------------------------------   00224300
.***AI.L18  XCART CL8                                                   00224400
         AIF   ('&XCART' NE 'NULL').ZI14                                00224500
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI14  CK *        00224600
&ZXCART               SETC  ''             RESET INPUT/OUTPUT           00224700
.ZI14                 ANOP  ,                                           00224800
.*-------------------------------------------------------------------   00224900
.***AI.L25  XCART CL8                                                   00225000
                      AIF   ('&ZXCART' EQ '').ZI14E                     00225100
                      AIF   ('&ZXCART' EQ 'OUTPUT').ZI14E               00225200
&ZCGPR                SETC  '&XCART'                                    00225300
         AIF   ('&XCART' NE 'NULL').ZI14A                               00225400
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI14E                          00225500
.*                                                                      00225600
&ZCGPR                SETC  '=XL8''00'''                                00225700
.ZI14A                ANOP  ,                                           00225800
.*                                                                      00225900
                      AIF   ('&XCART'(1,1) NE '(').ZI14B                00226000
&ZCGPR   SETC  '0('.'&XCART'(2,K'&XCART-2).')'                          00226100
.ZI14B                ANOP  ,                                           00226200
.*                                                                      00226300
&ZOPN                 SETA  &ZOPN+1                                     00226400
&ZOPL(&ZOPN)          SETC  ' '                                         00226500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00226600
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00226700
&ZOPD(&ZOPN)          SETC  '++ &ZXCART XCART'                          00226800
.*                                                                      00226900
.ZI14E                ANOP  ,                                           00227000
.*-------------------------------------------------------------------   00227100
.***AI.L18  XMASK CL8                                                   00227200
         AIF   ('&XMASK' NE 'NULL').ZI15                                00227300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI15  CK *        00227400
&ZXMASK               SETC  ''             RESET INPUT/OUTPUT           00227500
.ZI15                 ANOP  ,                                           00227600
.*-------------------------------------------------------------------   00227700
.***AI.L25  XMASK CL8                                                   00227800
                      AIF   ('&ZXMASK' EQ '').ZI15E                     00227900
                      AIF   ('&ZXMASK' EQ 'OUTPUT').ZI15E               00228000
&ZCGPR                SETC  '&XMASK'                                    00228100
         AIF   ('&XMASK' NE 'NULL').ZI15A                               00228200
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI15E                          00228300
.*                                                                      00228400
&ZCGPR                SETC  '=XL8''00'''                                00228500
.ZI15A                ANOP  ,                                           00228600
.*                                                                      00228700
                      AIF   ('&XMASK'(1,1) NE '(').ZI15B                00228800
&ZCGPR   SETC  '0('.'&XMASK'(2,K'&XMASK-2).')'                          00228900
.ZI15B                ANOP  ,                                           00229000
.*                                                                      00229100
&ZOPN                 SETA  &ZOPN+1                                     00229200
&ZOPL(&ZOPN)          SETC  ' '                                         00229300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00229400
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00229500
&ZOPD(&ZOPN)          SETC  '++ &ZXMASK XMASK'                          00229600
.*                                                                      00229700
.ZI15E                ANOP  ,                                           00229800
.*-------------------------------------------------------------------   00229900
.***AI.L25  XCONSID F                                                   00230000
                      AIF   ('&ZXCONSID' EQ '').ZI16E                   00230100
                      AIF   ('&ZXCONSID' EQ 'OUTPUT').ZI16E             00230200
&ZCGPR                SETC  '&XCONSID'                                  00230300
.*                                                                      00230400
                      AIF   ('&XCONSID'(1,1) NE '(').ZI16B              00230500
&ZCGPR   SETC  '0('.'&XCONSID'(2,K'&XCONSID-2).')'                      00230600
                      AGO   .ZI16D                                      00230700
.ZI16B                ANOP  ,                                           00230800
.*                                                                      00230900
&ZC                   SETC  '&XCONSID'(1,1)                             00231000
                      AIF   (T'&ZC NE 'N').ZI16D                        00231100
&ZC                   SETC  '&XCONSID'                                  00231200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               00231300
&ZCGPR                SETC  '=AL4(&XCONSID)'                            00231400
.*                                                                      00231500
.ZI16D                ANOP  ,                                           00231600
.*                                                                      00231700
&ZOPN                 SETA  &ZOPN+1                                     00231800
&ZOPL(&ZOPN)          SETC  ' '                                         00231900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00232000
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00232100
&ZOPD(&ZOPN)          SETC  '++ &ZXCONSID XCONSID'                      00232200
.*                                                                      00232300
.ZI16E                ANOP  ,                                           00232400
.*-------------------------------------------------------------------   00232500
.***AI.LVER01                                                           00232600
                      AIF  (&XPLISTVER LT 2).ZI18Z                      00232700
.*-------------------------------------------------------------------   00232800
.***AI.L25  XNAME CL8                                                   00232900
                      AIF   ('&ZXNAME' EQ '').ZI18E                     00233000
                      AIF   ('&ZXNAME' EQ 'OUTPUT').ZI18E               00233100
&ZCGPR                SETC  '&XNAME'                                    00233200
.*                                                                      00233300
                      AIF   ('&XNAME'(1,1) NE '(').ZI18B                00233400
&ZCGPR   SETC  '0('.'&XNAME'(2,K'&XNAME-2).')'                          00233500
.ZI18B                ANOP  ,                                           00233600
.*                                                                      00233700
&ZOPN                 SETA  &ZOPN+1                                     00233800
&ZOPL(&ZOPN)          SETC  ' '                                         00233900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00234000
&ZOPV(&ZOPN)          SETC  '32(8,1),&ZCGPR'                            00234100
&ZOPD(&ZOPN)          SETC  '++ &ZXNAME XNAME'                          00234200
.*                                                                      00234300
.ZI18E                ANOP  ,                                           00234400
.*-------------------------------------------------------------------   00234500
.***AI.LVER02                                                           00234600
.ZI18Z                ANOP  ,                                           00234700
.*-------------------------------------------------------------------   00234800
&ZOPN1                SETA &ZOPN                                        00234900
.*-------------------------------------------------------------------   00235000
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00235100
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00235200
.*******************************************************************    00235300
.***  PROCESS MCSOPMSG OUTPUT PARAMETERS                                00235400
.*******************************************************************    00235500
                      ACTR  10000                                       00235600
.*******************************************************************    00235700
.***AO.X02  RETURN CODE PROCESSING                                      00235800
.*******************************************************************    00235900
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00236000
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00236100
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00236200
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00236300
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00236400
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00236500
&ZOPN                 SETA  &ZOPN+1                                     00236600
&ZOPL(&ZOPN)          SETC  ' '                                         00236700
&ZOPO(&ZOPN)          SETC  'ST'                                        00236800
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00236900
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00237000
                      AGO   .ZMRETX                                     00237100
.*                                                                      00237200
.ZMRET2               ANOP  ,                                           00237300
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00237400
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00237500
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00237600
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00237700
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00237800
&ZOPN                 SETA  &ZOPN+1                                     00237900
&ZOPL(&ZOPN)          SETC  ' '                                         00238000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00238100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00238200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00238300
.ZMRETX               ANOP  ,                                           00238400
.*******************************************************************    00238500
.***AO.X03  REASON CODE PROCESSING                                      00238600
.*******************************************************************    00238700
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00238800
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00238900
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00239000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00239100
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00239200
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00239300
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00239400
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00239500
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00239600
&ZOPN                 SETA  &ZOPN+1                                     00239700
&ZOPL(&ZOPN)          SETC  ' '                                         00239800
&ZOPO(&ZOPN)          SETC  'ST'                                        00239900
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00240000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00240100
                      AGO   .ZMRSNX                                     00240200
.*                                                                      00240300
.ZMRSN2               ANOP  ,                                           00240400
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00240500
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00240600
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00240700
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00240800
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00240900
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00241000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00241100
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00241200
&ZOPN                 SETA  &ZOPN+1                                     00241300
&ZOPL(&ZOPN)          SETC  ' '                                         00241400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00241500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00241600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00241700
.ZMRSNX               ANOP  ,                                           00241800
.*******************************************************************    00241900
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00242000
.*******************************************************************    00242100
.ZMFLX                ANOP  ,              MF=L PROCESSING              00242200
.*******************************************************************    00242300
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00242400
.*******************************************************************    00242500
                      ACTR  10000                                       00242600
.*                                                                      00242700
                      LCLA  &ZLC           COLUMN POSITION              00242800
                      LCLA  &ZOPX          LIST TABLE INDEX             00242900
                      LCLC  &ZLL           LABEL                        00243000
                      LCLC  &ZLOP          OPERATION                    00243100
                      LCLC  &ZLV           VALUE                        00243200
                      LCLC  &ZLD           DESCRIPTION                  00243300
.*                                                                      00243400
&ZOPX                 SETA  1                                           00243500
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00243600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00243700
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00243800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00243900
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00244000
                      AIF   (K'&ZLD LE 0).ZL5                           00244100
&ZLC                  SETA  35             COMMENT COLUMN               00244200
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00244300
&ZLC                  SETA  33             COMMMENT COLUMN              00244400
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00244500
&ZLV                  SETC  '&ZLV'.' '                                  00244600
                      AGO   .ZL3                                        00244700
.*                                                                      00244800
.ZL4                  ANOP  ,                                           00244900
&ZLV                  SETC  '&ZLV'.' '                                  00245000
.ZL5                  ANOP  ,                                           00245100
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00245200
.*                                                                      00245300
&ZLL     &ZLOP &ZLV                                                     00245400
.*                                                                      00245500
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00245600
                      AGO   .ZL2           CONTINUE LOOPING             00245700
.*                                                                      00245800
.ZLX                  ANOP  ,                                           00245900
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00246000
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00246100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00246200
         L     15,16(0,0)         GET ADDRESS OF CVT FROM PSA           00246300
         L     15,772(15)         GET ADDRESS OF SFT FROM CVT           00246400
         LA    14,6               GET MCSOPMSG INDEX INTO LINKAGE TABLE 00246500
         AL    14,100(15)         POINT REG14 TO MCSOPMSG ETD ENTRY     00246600
         PC    0(14)              PC TO MCSOPMSG SERVICE                00246700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00246800
.ZLINKX               ANOP  ,                                           00246900
.*******************************************************************    00247000
.***AP.X01  FORMAT GENERATED CODE                                       00247100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00247200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00247300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00247400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00247500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00247600
                      AIF   (K'&ZLD LE 0).ZL51                          00247700
&ZLC                  SETA  35             COMMENT COLUMN               00247800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00247900
&ZLC                  SETA  33             COMMENT COLUMN               00248000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00248100
&ZLV                  SETC  '&ZLV'.' '                                  00248200
                      AGO   .ZL31                                       00248300
.*                                                                      00248400
.ZL41                 ANOP  ,                                           00248500
&ZLV                  SETC  '&ZLV'.' '                                  00248600
.ZL51                 ANOP  ,                                           00248700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00248800
.*                                                                      00248900
&ZLL     &ZLOP &ZLV                                                     00249000
.*                                                                      00249100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00249200
                      AGO   .ZL21          CONTINUE LOOPING             00249300
.*                                                                      00249400
.ZLX1                 ANOP  ,                                           00249500
.*******************************************************************    00249600
.***AP.X02  END OF MCSOPMSG MACRO                                       00249700
&ZMCSOPMSG            SETC  'YES'          SET MCSOPMSG USED            00249800
         POP   PRINT                                                    00249900
*                                            MCSOPMSG-2                 00250000
         SPACE 1                                                        00250100
.ZLX2                 ANOP  ,                                           00250200
         MEND                                                           00250300
**********************************************************************/ 00250400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00250500
*%MCSOPMSG: MACRO KEYS(REQUEST,CMDRESP,CART,MASK,CONSID,NAME,RTNCODE,   00250600
*                 RSNCODE,PLISTVER,MF);                                 00250700
*  ANS('?'!!MACLABEL!!' '!!'MCSOPMSP '!!MACLIST!!                       00250800
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00250900
*%END MCSOPMSG;                                                         00251000

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  ISGADMIN                              -02/27/08-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Global Resource Serialization Administration  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 2006, 2008                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7750                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      Interface for Global Resource Serialization Administration     * 00002100
*                                                                     * 00002200
*      The GRS Administration service routine is given control from   * 00002300
*      the ISGADMIN macro to:                                         * 00002400
*                                                                     * 00002500
*                                                                     * 00002600
*      o   Change maximum ENQ limits for a specific address space.    * 00002700
*                                                                     * 00002800
*      o   Move an ENQ waiter to a different position in the request  * 00002900
*          queue and to optionally change its control type from       * 00003000
*          exclusive to shared.                                       * 00003100
*                                                                     * 00003200
*                                                                     * 00003300
*                                                                     * 00003400
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00003500
*                                                                     * 00003600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003700
*                                                                     * 00003800
*01* ENVIRONMENT:                                                     * 00003900
*                                                                     * 00004000
*                                                                     * 00004100
*      Minimum authorization:                                         * 00004200
*                                                                     * 00004300
*                        The caller must be authorized, although any  * 00004400
*                        one of the following attributes is           * 00004500
*                        sufficient:                                  * 00004600
*                                                                     * 00004700
*                                                                     * 00004800
*                        o   Supervisor State                         * 00004900
*                                                                     * 00005000
*                        o   Key 0-7                                  * 00005100
*                                                                     * 00005200
*                        o   APF-authorized                           * 00005300
*                                                                     * 00005400
*                                                                     * 00005500
*                                                                     * 00005600
*      Dispatchable unit mode: Task mode.                             * 00005700
*                                                                     * 00005800
*      Cross Memory Mode: Any PASN, any HASN, any SASN.  Note: The    * 00005900
*                        updated ENQ limit is updated for the home    * 00006000
*                        address space.                               * 00006100
*                                                                     * 00006200
*      AMODE:            31- or 64-bit.                               * 00006300
*                                                                     * 00006400
*                        If in AMODE 64, specify SYSSTATE AMODE64=YES * 00006500
*                        before invoking this macro.                  * 00006600
*                                                                     * 00006700
*      ASC mode:         Primary or Access Register.                  * 00006800
*                                                                     * 00006900
*                        If in Access Register ASC mode, specify      * 00007000
*                        SYSSTATE ASCENV=AR before invoking this      * 00007100
*                        macro.                                       * 00007200
*                                                                     * 00007300
*      Interrupt status: Enabled for I/O and external interrupts.     * 00007400
*                                                                     * 00007500
*      Locks:            The caller must not be locked.               * 00007600
*                                                                     * 00007700
*      Control parameters: Control parameters must be in the primary  * 00007800
*                        address space or, for AR-mode callers, must  * 00007900
*                        be in an address/data space that is          * 00008000
*                        addressable through a public entry on the    * 00008100
*                        caller's dispatchable unit access list       * 00008200
*                        (DU-AL).                                     * 00008300
*                                                                     * 00008400
*                        The control parameters must be in the same   * 00008500
*                        key as the caller.                           * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*                                                                     * 00008900
*01* PROGRAMMING REQUIREMENTS:                                        * 00009000
*                                                                     * 00009100
*    The caller must include the ISGYCON macro to get the return and  * 00009200
*    reason codes.                                                    * 00009300
*                                                                     * 00009400
*01* RESTRICTIONS:                                                    * 00009500
*                                                                     * 00009600
*    The caller must not have functional recovery routines (FRRs)     * 00009700
*    established.                                                     * 00009800
*                                                                     * 00009900
*01* INPUT REGISTER INFORMATION:                                      * 00010000
*                                                                     * 00010100
*    Before issuing the ISGADMIN macro, the caller does not have to   * 00010200
*    place any information into any general purpose register (GPR) or * 00010300
*    access register (AR) unless using it in register notation for a  * 00010400
*    particular parameter, or using it as a base register.            * 00010500
*                                                                     * 00010600
*01* OUTPUT REGISTER INFORMATION:                                     * 00010700
*                                                                     * 00010800
*    When control returns to the caller, the GPRs contain:            * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*    REGISTER    CONTENTS                                             * 00011200
*                                                                     * 00011300
*    0           Reason code if GPR15 is not 0                        * 00011400
*                                                                     * 00011500
*    1           Used as a work register by the system                * 00011600
*                                                                     * 00011700
*    2-13        Unchanged                                            * 00011800
*                                                                     * 00011900
*    14          Used as a work register by the system                * 00012000
*                                                                     * 00012100
*    15          Return code                                          * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*    When control returns to the caller, the ARs contain:             * 00012600
*                                                                     * 00012700
*                                                                     * 00012800
*    REGISTER    CONTENTS                                             * 00012900
*                                                                     * 00013000
*    0-1         Used as work registers by the system                 * 00013100
*                                                                     * 00013200
*    2-13        Unchanged                                            * 00013300
*                                                                     * 00013400
*    14-15       Used as work registers by the system                 * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*    Some callers depend on register contents remaining the same      * 00013900
*    before and after issuing a service.  If the system changes the   * 00014000
*    contents of registers on which the caller depends, the caller    * 00014100
*    must save them before issuing the service, and restore them      * 00014200
*    after the system returns control.                                * 00014300
*                                                                     * 00014400
*01* PERFORMANCE IMPLICATIONS:                                        * 00014500
*    None.                                                            * 00014600
*                                                                     * 00014700
*01* SYNTAX:                                                          * 00014800
*                                                                     * 00014900
*Ýxlabel¨  ISGADMIN  Ð  REQUEST=SETENQMAX                             * 00015000
*                    !   Ð ,MAXTYPE=AUTHORIZED                        * 00015100
*                    !   ¿ ,MAXTYPE=UNAUTHORIZED                      * 00015200
*                    !     ,MAXVALUE=xmaxvalue                        * 00015300
*                    Ô ,REQUEST=RESETENQMAX                           * 00015400
*                    !   Ð ,MAXTYPE=AUTHORIZED                        * 00015500
*                    !   ¿ ,MAXTYPE=UNAUTHORIZED                      * 00015600
*                    ¿ ,REQUEST=MOVEWAITER                            * 00015700
*                          ,MOVINGWAITER=xmovingwaiter                * 00015800
*                        ÐÝ,NEWCONTROL=EXCLUSIVE¨                     * 00015900
*                        ¿Ý,NEWCONTROL=SHARED¨                        * 00016000
*                        ÐÝ,TOTHEEND=NO                               * 00016100
*                        !     ,BEFOREREQUESTER                       * 00016200
*                        !                      =xbeforerequester¨    * 00016300
*                        ¿Ý,TOTHEEND=YES¨                             * 00016400
*                     Ý,RETCODE=xretcode¨                             * 00016500
*                     Ý,RSNCODE=xrsncode¨                             * 00016600
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00016700
*                    ÐÝ,MF=S¨                                         * 00016800
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00016900
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*      Where:                                                         * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*      Ýxlabel¨                                                       * 00017600
*          is an optional symbol, starting in column 1, that is the   * 00017700
*          name on the ISGADMIN macro invocation.  The name must      * 00017800
*          conform to the rules for an ordinary assembler language    * 00017900
*          symbol.                                                    * 00018000
*          DEFAULT: No name.                                          * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*                                                                     * 00018500
*      REQUEST=»SETENQMAX!RESETENQMAX!MOVEWAITERº                     * 00018600
*          is a required keyword input that indicates the type of     * 00018700
*          ISGADMIN request.                                          * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*          REQUEST=SETENQMAX                                          * 00019100
*              Indicates a request to change the ENQ maximum for the  * 00019200
*              home address space.                                    * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*              MAXTYPE=»AUTHORIZED!UNAUTHORIZEDº                      * 00019600
*                  is a required keyword input                        * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*                  MAXTYPE=AUTHORIZED                                 * 00020000
*                      Indicates a request to update the maximum ENQ  * 00020100
*                      limit for authorized requesters.               * 00020200
*                                                                     * 00020300
*                  MAXTYPE=UNAUTHORIZED                               * 00020400
*                      Indicates a request to update the maximum ENQ  * 00020500
*                      limit for unauthorized requesters.             * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*              MAXVALUE=xmaxvalue                                     * 00021300
*                  is the name (RS-type), or address in register      * 00021400
*                  (2)-(12), of a required fullword input that is the * 00021500
*                  requested value of the new maximum ENQ limit.  The * 00021600
*                  specified value must be greater than or equal to   * 00021700
*                  the absolute minimum described in ISGYCON, and up  * 00021800
*                  to 2¢31-1 (2147483647).                            * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*          REQUEST=RESETENQMAX                                        * 00022300
*              Indicates a request to reset the ENQ maximum for the   * 00022400
*              home address space back to the system default.         * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*              MAXTYPE=»AUTHORIZED!UNAUTHORIZEDº                      * 00022800
*                  is a required keyword input                        * 00022900
*                                                                     * 00023000
*                                                                     * 00023100
*                  MAXTYPE=AUTHORIZED                                 * 00023200
*                      Indicates a request to reset the maximum ENQ   * 00023300
*                      limit for authorized requesters.               * 00023400
*                                                                     * 00023500
*                  MAXTYPE=UNAUTHORIZED                               * 00023600
*                      Indicates a request to reset the maximum ENQ   * 00023700
*                      limit for unauthorized requesters.             * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*          REQUEST=MOVEWAITER                                         * 00024400
*              Indicates a request to move an ENQ waiter to a         * 00024500
*              different position in the request queue and to         * 00024600
*              optionally change its control type through the         * 00024700
*              NEWCONTROL keyword.                                    * 00024800
*                                                                     * 00024900
*              This request requires a version 2 parameter list.      * 00025000
*                                                                     * 00025100
*              Note: This function is intended to only be used by     * 00025200
*              third party serialization products.  Its misuse can    * 00025300
*              result in deadlocks, incorrect serialization or loss   * 00025400
*              of data integrity.  The MOVEWAITER, TOTHEEND, and      * 00025500
*              BEFOREREQUESTER keywords specify which requester       * 00025600
*              should be moved and where to move it.  The waiter will * 00025700
*              only be moved under the following conditions:          * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*              o   The MOVINGWAITER:                                  * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
*                  -   Has a requested disposition of Exclusive       * 00026400
*                                                                     * 00026500
*                  -   Is not currently an owner of the resource      * 00026600
*                                                                     * 00026700
*                  -   Cannot result in any new owners as a result of * 00026800
*                      the move                                       * 00026900
*                                                                     * 00027000
*                  -   Must be waiting for the same resource as the   * 00027100
*                      BEFOREREQUESTER (if specified)                 * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*              o   The resource is NOT global or STEP in scope.  Note * 00027600
*                  that in GRS=NONE mode, the final scope can be      * 00027700
*                  SYSTEMS or SYSTEM.  When in other GRS modes the    * 00027800
*                  scope must be SYSTEM.                              * 00027900
*                                                                     * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*              MOVINGWAITER=xmovingwaiter                             * 00028400
*                  is the name (RS-type), or address in register      * 00028500
*                  (2)-(12), of a required 32 character input that is * 00028600
*                  an ENQToken identifying the ENQ waiter.            * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*              ÝNEWCONTROL=»EXCLUSIVE!SHAREDº¨                        * 00029200
*                  is an optional keyword input                       * 00029300
*                  DEFAULT: EXCLUSIVE                                 * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*                  ÝNEWCONTROL=EXCLUSIVE¨                             * 00029700
*                      Indicates that the requester represented by    * 00029800
*                      the MovingWaiter ENQToken should have its      * 00029900
*                      control remain Exclusive.                      * 00030000
*                                                                     * 00030100
*                  ÝNEWCONTROL=SHARED¨                                * 00030200
*                      Indicates that the request represented by the  * 00030300
*                      MovingWaiter ENQToken should have its control  * 00030400
*                      become Shared.                                 * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*              ÝTOTHEEND=»NO!YESº¨                                    * 00031200
*                  is an optional keyword input                       * 00031300
*                  DEFAULT: NO                                        * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*                  ÝTOTHEEND=NO                                       * 00031700
*                      Indicates that the requester represented by    * 00031800
*                      the MovingWaiter ENQToken should be moved to a * 00031900
*                      position specified through the BEFOREREQUESTER * 00032000
*                      keyword.                                       * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                      BEFOREREQUESTER=xbeforerequester¨              * 00032400
*                          is the name (RS-type), or address in       * 00032500
*                          register (2)-(12), of a required 32        * 00032600
*                          character input that is an ENQToken        * 00032700
*                          identifying the ENQ request that the       * 00032800
*                          MovingWaiter request precedes.             * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*                                                                     * 00033200
*                  ÝTOTHEEND=YES¨                                     * 00033300
*                      Indicates that the request represented by the  * 00033400
*                      MovingWaiter ENQToken should be moved to the   * 00033500
*                      end of the request queue.                      * 00033600
*                                                                     * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*      ÝRETCODE=xretcode¨                                             * 00034700
*          is the name (RS-type) of an optional fullword output       * 00034800
*          variable, or register (2)-(12) or (15), into which the     * 00034900
*          return code is to be copied from GPR 15.  If you specify   * 00035000
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00035100
*          the value will be left in GPR 15.                          * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*      ÝRSNCODE=xrsncode¨                                             * 00035700
*          is the name (RS-type) of an optional fullword output       * 00035800
*          variable into which the reason code is to be copied from   * 00035900
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00036000
*          R0 (within or without parentheses), the value will be left * 00036100
*          in GPR 0.                                                  * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00036700
*          is an optional byte input decimal value in the "1-2" range * 00036800
*          that specifies the macro version.  PLISTVER is the only    * 00036900
*          key allowed on the list form of MF and determines which    * 00037000
*          parameter list is generated.  The macro keys associated    * 00037100
*          with each supported version of the macro are listed in     * 00037200
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00037300
*          instead of a number, and the parameter list will be of the * 00037400
*          largest size currently supported. This size may grow from  * 00037500
*          release to release (thus possibly affecting the amount of  * 00037600
*          storage needed by your program).  If your program can      * 00037700
*          tolerate this, IBM recommends that you always specify MAX  * 00037800
*          when creating the list form parameter list as that will    * 00037900
*          ensure that the list form parameter list is always long    * 00038000
*          enough to hold whatever parameters might be specified on   * 00038100
*          the execute form.                                          * 00038200
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00038300
*          default is the lowest version which allows all of the      * 00038400
*          parameters specified on the invocation to be processed.    * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*                                                                     * 00038900
*      ÝMF=»S!L!Eº¨                                                   * 00039000
*          is an optional keyword input which specifies the macro     * 00039100
*          form.                                                      * 00039200
*          DEFAULT: S                                                 * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*          ÝMF=S¨                                                     * 00039600
*              specifies the standard form of the macro.  The "S"     * 00039700
*              form generates code to put the parameters into an      * 00039800
*              in-line parameter list and invoke the desired service. * 00039900
*              Full checking for required macro keys is done along    * 00040000
*              with supplying defaults for omitted optional           * 00040100
*              parameters.                                            * 00040200
*                                                                     * 00040300
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00040400
*              specifies the list form of the macro.  The "L" form    * 00040500
*              defines an area to be used for the parameter list.     * 00040600
*              Only the PLISTVER key may be specified on the          * 00040700
*              invocation.  All other macro parameters are flagged as * 00040800
*              errors.  If PLISTVER is not specified, the original    * 00040900
*              parameter list definition is used.                     * 00041000
*                                                                     * 00041100
*            ,xmfctrl                                                 * 00041200
*              is a required input.  It is the name of a storage area * 00041300
*              for the parameter list.                                * 00041400
*                                                                     * 00041500
*            »,xmfattr!0Dº                                            * 00041600
*              is an optional 60 character input string that varies   * 00041700
*              from 1 to 60 characters. Use it to force boundary      * 00041800
*              alignment of the parameter list. Use only 0F or 0D.    * 00041900
*              DEFAULT: 0D which forces the parameter list to a       * 00042000
*              doubleword boundary.                                   * 00042100
*                                                                     * 00042200
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00042300
*              specifies the execute form of the macro.  The "E" form * 00042400
*              generates code to put the parameters into the          * 00042500
*              parameter list specified by xmfctrl and provides full  * 00042600
*              syntax checking with default setting.                  * 00042700
*                                                                     * 00042800
*            ,xmfctrl                                                 * 00042900
*              is a required input.  It is the name (RS-type), or     * 00043000
*              address in register (1)-(12), of a storage area for    * 00043100
*              the parameter list.                                    * 00043200
*                                                                     * 00043300
*            »,COMPLETEº                                              * 00043400
*              is an optional keyword input which specifies the       * 00043500
*              degree of macro parameter syntax checking.             * 00043600
*              DEFAULT: COMPLETE                                      * 00043700
*                                                                     * 00043800
*                                                                     * 00043900
*              COMPLETE                                               * 00044000
*                  Checking for required macro keys is done and       * 00044100
*                  defaults are supplied for omitted optional         * 00044200
*                  parameters.                                        * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*01* RETURN CODES:                                                    * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*                 Macro ISGYCON provides equate symbols for the       * 00045400
*                 return and reason codes.                            * 00045500
*                                                                     * 00045600
*       00        Name: ISGADMINRc_OK                                 * 00045700
*                                                                     * 00045800
*                 Meaning:  ISGADMIN request successful.              * 00045900
*                                                                     * 00046000
*                 Action: None required.                              * 00046100
*                                                                     * 00046200
*                                                                     * 00046300
*       04        Name: ISGADMINRc_Warn                               * 00046400
*                                                                     * 00046500
*                 Meaning: Warning                                    * 00046600
*                                                                     * 00046700
*                 Action: Refer to action under the individual reason * 00046800
*                 code.                                               * 00046900
*                                                                     * 00047000
*                                                                     * 00047100
*                 HEX REASON  MEANING/ACTION                          * 00047200
*                 CODE                                                * 00047300
*                                                                     * 00047400
*                 xxxx0401    Name: ISGADMINRsn_ENQMaxValueLow        * 00047500
*                                                                     * 00047600
*                             Meaning: For REQUEST=SETENQMAX.  The    * 00047700
*                             specified maximum is less than or equal * 00047800
*                             to the current system-wide maximum.     * 00047900
*                             This space-specific maximum has been    * 00048000
*                             set but has no immediate effect.        * 00048100
*                                                                     * 00048200
*                             Action: Ensure the specified MaxValue   * 00048300
*                             is accurate.  If not, reissue the       * 00048400
*                             ISGADMIN service with a higher value.   * 00048500
*                                                                     * 00048600
*                 xxxx0402    Name: ISGADMINRsn_ResetENQMaxIgnored    * 00048700
*                                                                     * 00048800
*                             Meaning: For REQUEST=RESETENQMAX.  The  * 00048900
*                             home address space did not have a       * 00049000
*                             specific maximum for that type of       * 00049100
*                             requester.                              * 00049200
*                                                                     * 00049300
*                             Action: Ensure that the reset was       * 00049400
*                             desired, and issued for the appropriate * 00049500
*                             requester type, authorized or           * 00049600
*                             unauthorized.  Reissue the service with * 00049700
*                             the correct requester type if           * 00049800
*                             appropriate.                            * 00049900
*                                                                     * 00050000
*                                                                     * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*       08        Name: ISGADMINRc_ParmError                          * 00050400
*                                                                     * 00050500
*                 Meaning:  ISGADMIN request specified parameters in  * 00050600
*                 error.                                              * 00050700
*                                                                     * 00050800
*                 Action: Refer to action under the individual reason * 00050900
*                 code.                                               * 00051000
*                                                                     * 00051100
*                                                                     * 00051200
*                 HEX REASON  MEANING/ACTION                          * 00051300
*                 CODE                                                * 00051400
*                                                                     * 00051500
*                 xxxx0801    Name: ISGADMINRsn_BadPlistAddress       * 00051600
*                                                                     * 00051700
*                             Meaning: Unable to access parameter     * 00051800
*                             list.                                   * 00051900
*                                                                     * 00052000
*                             Action: Check that the parameter list   * 00052100
*                             is addressable.  If in AR-mode, check   * 00052200
*                             that the ALET of the parameter list is  * 00052300
*                             correct.  Note that if this macro is    * 00052400
*                             issued in AR-mode, SYSSTATE ASCENV=AR   * 00052500
*                             must be issued before this macro.       * 00052600
*                             Ensure that the storage is in the same  * 00052700
*                             key as the caller.                      * 00052800
*                                                                     * 00052900
*                 xxxx0802    Name: ISGADMINRsn_BadPlistALET          * 00053000
*                                                                     * 00053100
*                             Meaning: Bad parameter list ALET.  The  * 00053200
*                             ALET is neither zero nor is it          * 00053300
*                             associated with a valid public entry on * 00053400
*                             the caller's Dispatchable Unit Access   * 00053500
*                             List (DU-AL), nor a valid entry for a   * 00053600
*                             common area data space.                 * 00053700
*                                                                     * 00053800
*                             Action: Make sure that the ALET of the  * 00053900
*                             parameter list is valid.  Its access    * 00054000
*                             register may not have been set up       * 00054100
*                             properly.                               * 00054200
*                                                                     * 00054300
*                 xxxx0803    Name: ISGADMINRsn_BadPlistVersion       * 00054400
*                                                                     * 00054500
*                             Meaning: Bad parameter list version     * 00054600
*                             number.  The ISGADMIN parameter list    * 00054700
*                             version is greater than the version     * 00054800
*                             supported by GRS on the current system  * 00054900
*                             or the ISGADMIN parameter list version  * 00055000
*                             is lower than the minimum required for  * 00055100
*                             parameters that were specified.         * 00055200
*                                                                     * 00055300
*                             Action: Check for possible storage      * 00055400
*                             overlay of the parameter list.  Retry   * 00055500
*                             the request with the correct version    * 00055600
*                             number.  Verify that your program was   * 00055700
*                             assembled with the correct macro        * 00055800
*                             library for the release of MVS on which * 00055900
*                             your program is running.                * 00056000
*                                                                     * 00056100
*                 xxxx0804    Name: ISGADMINRsn_ReservedFieldNotNull  * 00056200
*                                                                     * 00056300
*                             Meaning: A reserved field in the        * 00056400
*                             parameter list is non-zero.             * 00056500
*                                                                     * 00056600
*                             Action: Check for possible storage      * 00056700
*                             overlay of the parameter list.          * 00056800
*                                                                     * 00056900
*                 xxxx0805    Name: ISGADMINRsn_BadRequest            * 00057000
*                                                                     * 00057100
*                             Meaning: Bad REQUEST parameter.         * 00057200
*                                                                     * 00057300
*                             Action:  IBM suggests that the ISGADMIN * 00057400
*                             macro is used when invoking the         * 00057500
*                             ISGADMIN service.                       * 00057600
*                                                                     * 00057700
*                 xxxx0806    Name: ISGADMINRsn_ENQMaxValueTooLow     * 00057800
*                                                                     * 00057900
*                             Meaning: For REQUEST=SETENQMAX.  The    * 00058000
*                             specified maximum is less than the      * 00058100
*                             smallest allowable maximum.             * 00058200
*                                                                     * 00058300
*                             Action: Check the smallest allowable    * 00058400
*                             maximum in macro ISGYCON.  Reissue the  * 00058500
*                             ISGADMIN service with a higher value.   * 00058600
*                                                                     * 00058700
*                 xxxx0807    Name:                                   * 00058800
*                             ISGADMINRsn_BadMovingWaiterAddress      * 00058900
*                                                                     * 00059000
*                             Meaning: For REQUEST=MOVEWAITER.        * 00059100
*                             Unable to access the MovingWaiter       * 00059200
*                             ENQToken.                               * 00059300
*                                                                     * 00059400
*                             Action: Make sure that the MovingWaiter * 00059500
*                             ENQToken is addressable.  If in         * 00059600
*                             AR-mode, this field is accessed through * 00059700
*                             its address and ALET, check that both   * 00059800
*                             these values are correct.  Ensure that  * 00059900
*                             the storage is in the same key as the   * 00060000
*                             caller.                                 * 00060100
*                                                                     * 00060200
*                 xxxx0808    Name: ISGADMINRsn_BadMovingWaiterAlet   * 00060300
*                                                                     * 00060400
*                             Meaning: For REQUEST=MOVEWAITER.  Bad   * 00060500
*                             MovingWaiter ENQToken ALET.  The ALET   * 00060600
*                             is neither zero nor is it associated    * 00060700
*                             with a valid public entry on the        * 00060800
*                             caller's Dispatchable Unit Access List  * 00060900
*                             (DU-AL), nor a valid entry for a common * 00061000
*                             area data space.                        * 00061100
*                                                                     * 00061200
*                             Action: Make sure that the ALET of the  * 00061300
*                             MovingWaiter ENQToken is valid.  Its    * 00061400
*                             access register may not have been set   * 00061500
*                             up properly.                            * 00061600
*                                                                     * 00061700
*                 xxxx0809    Name: ISGADMINRsn_BadMovingWaiter       * 00061800
*                                                                     * 00061900
*                             Meaning: For REQUEST=MOVEWAITER.  The   * 00062000
*                             specified MovingWaiter ENQToken does    * 00062100
*                             not represent an ENQ on the current     * 00062200
*                             system.                                 * 00062300
*                                                                     * 00062400
*                             Action: Make sure that the specified    * 00062500
*                             MovingWaiter ENQToken is from a         * 00062600
*                             previous request that has not been      * 00062700
*                             subsequently released.                  * 00062800
*                                                                     * 00062900
*                 xxxx080A    Name:                                   * 00063000
*                             ISGADMINRsn_BadBeforeRequesterAddress   * 00063100
*                                                                     * 00063200
*                             Meaning: For REQUEST=MOVEWAITER.        * 00063300
*                             Unable to access the BeforeRequester    * 00063400
*                             ENQToken.                               * 00063500
*                                                                     * 00063600
*                             Action: Make sure that the              * 00063700
*                             BeforeRequester ENQToken is             * 00063800
*                             addressable.  If in AR-mode, this field * 00063900
*                             is accessed through its address and     * 00064000
*                             ALET, check that both these values are  * 00064100
*                             correct.  Ensure that the storage is in * 00064200
*                             the same key as the caller.             * 00064300
*                                                                     * 00064400
*                 xxxx080B    Name:                                   * 00064500
*                             ISGADMINRsn_BadBeforeRequesterAlet      * 00064600
*                                                                     * 00064700
*                             Meaning: For REQUEST=MOVEWAITER.  Bad   * 00064800
*                             BeforeRequester ENQToken The ALET is    * 00064900
*                             neither zero nor is it associated with  * 00065000
*                             a valid public entry on the caller's    * 00065100
*                             Dispatchable Unit Access List (DU-AL),  * 00065200
*                             nor a valid entry for a common area     * 00065300
*                             data space.                             * 00065400
*                                                                     * 00065500
*                             Action: Make sure that the ALET of the  * 00065600
*                             BeforeRequester ENQToken is valid.  Its * 00065700
*                             access register may not have been set   * 00065800
*                             up properly.                            * 00065900
*                                                                     * 00066000
*                 xxxx080C    Name: ISGADMINRsn_BadBeforeRequester    * 00066100
*                                                                     * 00066200
*                             Meaning: For REQUEST=MOVEWAITER.  The   * 00066300
*                             specified BeforeRequester ENQToken does * 00066400
*                             not represent an ENQ on the current     * 00066500
*                             system.                                 * 00066600
*                                                                     * 00066700
*                             Action: Make sure that the specified    * 00066800
*                             BeforeRequester ENQToken is from a      * 00066900
*                             previous request that has not been      * 00067000
*                             subsequently released.                  * 00067100
*                                                                     * 00067200
*                 xxxx080D    Name: ISGADMINRsn_SameRequester         * 00067300
*                                                                     * 00067400
*                             Meaning: For REQUEST=MOVEWAITER.  The   * 00067500
*                             same ENQToken was specified for both    * 00067600
*                             MovingWaiter and BeforeRequester.       * 00067700
*                                                                     * 00067800
*                             Action: Make sure that the ENQTokens    * 00067900
*                             are distinct.                           * 00068000
*                                                                     * 00068100
*                 xxxx080E    Name: ISGADMINRsn_InconsistentResource  * 00068200
*                                                                     * 00068300
*                             Meaning: For REQUEST=MOVEWAITER.  The   * 00068400
*                             specified MovingWaiter and              * 00068500
*                             BeforeRequester ENQTokens do not        * 00068600
*                             represent ENQ requests for the same     * 00068700
*                             resource.                               * 00068800
*                                                                     * 00068900
*                             Action: Make sure that the ENQTokens    * 00069000
*                             specified are against the same          * 00069100
*                             resource.                               * 00069200
*                                                                     * 00069300
*                 xxxx080F    Name: ISGADMINRsn_BadScope              * 00069400
*                                                                     * 00069500
*                             Meaning: For REQUEST=MOVEWAITER.  The   * 00069600
*                             resource associated with the specified  * 00069700
*                             MovingWaiter and BeforeRequester        * 00069800
*                             ENQTokens is not a valid local          * 00069900
*                             resource.  The resource cannot be a     * 00070000
*                             global or a STEP resource.  Note that   * 00070100
*                             in GRS=NONE mode, an acceptable local   * 00070200
*                             resource can have a final scope of      * 00070300
*                             SYSTEMS or SYSTEM.  When in other GRS   * 00070400
*                             modes, the final scope can only be      * 00070500
*                             SYSTEM.                                 * 00070600
*                                                                     * 00070700
*                             Action: Make sure that the ENQTokens    * 00070800
*                             specified are against a valid local     * 00070900
*                             resource.                               * 00071000
*                                                                     * 00071100
*                 xxxx0810    Name: ISGADMINRsn_BadControl            * 00071200
*                                                                     * 00071300
*                             Meaning: For REQUEST=MOVEWAITER.  The   * 00071400
*                             specified MovingWaiter ENQToken         * 00071500
*                             represents a requester of shared        * 00071600
*                             control.                                * 00071700
*                                                                     * 00071800
*                             Action: Make sure that the MovingWaiter * 00071900
*                             ENQToken represents a requester of      * 00072000
*                             exclusive control.                      * 00072100
*                                                                     * 00072200
*                 xxxx0811    Name: ISGADMINRsn_CannotMoveOwner       * 00072300
*                                                                     * 00072400
*                             Meaning: For REQUEST=MOVEWAITER.  The   * 00072500
*                             specified MovingWaiter ENQToken         * 00072600
*                             represents a requester that owns the    * 00072700
*                             resource.                               * 00072800
*                                                                     * 00072900
*                             Action: Make sure that the MovingWaiter * 00073000
*                             ENQToken specified is for a waiting     * 00073100
*                             requester.                              * 00073200
*                                                                     * 00073300
*                 xxxx0812    Name:                                   * 00073400
*                             ISGADMINRsn_AlreadyBeforeRequester      * 00073500
*                                                                     * 00073600
*                             Meaning: For REQUEST=MOVEWAITER,        * 00073700
*                             TOTHEEND=NO, BEFOREREQUESTER=.  The     * 00073800
*                             specified MovingWaiter ENQToken         * 00073900
*                             represents a requester that is already  * 00074000
*                             queued just before the requester        * 00074100
*                             represented by the BeforeRequester      * 00074200
*                             ENQToken.  The control was not changed. * 00074300
*                                                                     * 00074400
*                             Action: Make sure that the MovingWaiter * 00074500
*                             and BeforeRequester ENQTokens represent * 00074600
*                             the correct requesters and that the     * 00074700
*                             queue is as expected.                   * 00074800
*                                                                     * 00074900
*                 xxxx0813    Name: ISGADMINRsn_CannotMoveBeforeOwner * 00075000
*                                                                     * 00075100
*                             Meaning: For REQUEST=MOVEWAITER.  If    * 00075200
*                             granted, the requester represented by   * 00075300
*                             the MovingWaiter ENQToken would have    * 00075400
*                             become the owner of the resource        * 00075500
*                             because it would precede an owner.      * 00075600
*                                                                     * 00075700
*                             Action: Make sure that the              * 00075800
*                             BeforeRequester ENQToken represents a   * 00075900
*                             waiting requester.                      * 00076000
*                                                                     * 00076100
*                 xxxx0814    Name:                                   * 00076200
*                             ISGADMINRsn_CannotMoveAfterSharedOwner  * 00076300
*                                                                     * 00076400
*                             Meaning: For REQUEST=MOVEWAITER,        * 00076500
*                             NEWCONTROL=SHARED.  If granted, the     * 00076600
*                             requester represented by the            * 00076700
*                             MovingWaiter ENQToken would have become * 00076800
*                             the owner of the resource because it    * 00076900
*                             would immediately follow a shared       * 00077000
*                             owner.                                  * 00077100
*                                                                     * 00077200
*                             Action: Make sure that the              * 00077300
*                             BeforeRequester ENQToken represents the * 00077400
*                             requester that the moving waiter should * 00077500
*                             precede.                                * 00077600
*                                                                     * 00077700
*                 xxxx0815    Name:                                   * 00077800
*                             ISGADMINRsn_CannotMakeAnotherOwner      * 00077900
*                                                                     * 00078000
*                             Meaning: For REQUEST=MOVEWAITER.  If    * 00078100
*                             granted, one or more requesters queued  * 00078200
*                             after the one represented by the        * 00078300
*                             MovingWaiter ENQToken would have become * 00078400
*                             the owner of the resource.              * 00078500
*                                                                     * 00078600
*                             Action: Make sure that the MOVEWAITER   * 00078700
*                             request would not make any other        * 00078800
*                             waiting requesters the owner of the     * 00078900
*                             resource.                               * 00079000
*                                                                     * 00079100
*                 xxxx0816    Name: ISGADMINRsn_AlreadyLastRequester  * 00079200
*                                                                     * 00079300
*                             Meaning: For REQUEST=MOVEWAITER,        * 00079400
*                             TOTHEEND=YES.  The requester            * 00079500
*                             represented by the MovingWaiter         * 00079600
*                             ENQToken is already at the end of the   * 00079700
*                             request queue.                          * 00079800
*                                                                     * 00079900
*                             Action: Make sure that the MovingWaiter * 00080000
*                             ENQToken represents a requester at the  * 00080100
*                             correct position and that the request   * 00080200
*                             queue is as expected.                   * 00080300
*                                                                     * 00080400
*                 xxxx0817    Name: ISGADMINRsn_CannotMoveMasidUser   * 00080500
*                                                                     * 00080600
*                             Meaning: For REQUEST=MOVEWAITER.  The   * 00080700
*                             MovingWaiter ENQToken represents a      * 00080800
*                             MASID user.                             * 00080900
*                                                                     * 00081000
*                             Action: Make sure that the MovingWatier * 00081100
*                             ENQToken does not represent a MASID     * 00081200
*                             user.                                   * 00081300
*                                                                     * 00081400
*                 xxxx0818    Name: ISGADMINRsn_MasidControlConflict  * 00081500
*                                                                     * 00081600
*                             Meaning: For REQUEST=MOVEWAITER,        * 00081700
*                             NEWCONTROL=SHARED.  The requester       * 00081800
*                             represented by the MovingWaiter         * 00081900
*                             ENQToken would create a bad MASID       * 00082000
*                             environment since a shared owner of the * 00082100
*                             resource is a convert-to-exclusive      * 00082200
*                             MASID target.                           * 00082300
*                                                                     * 00082400
*                             Action: Make sure that the requester    * 00082500
*                             represented by the MovingWaiter         * 00082600
*                             ENQToken would not need to move in the  * 00082700
*                             midst of a MASID convert-to-exclusive   * 00082800
*                             environment or that the moved requester * 00082900
*                             could maintain a control of Exclusive.  * 00083000
*                                                                     * 00083100
*                                                                     * 00083200
*                                                                     * 00083300
*                                                                     * 00083400
*       0C        Name: ISGADMINRc_EnvError                           * 00083500
*                                                                     * 00083600
*                 Meaning:  ISGADMIN request has an environment       * 00083700
*                 error.                                              * 00083800
*                                                                     * 00083900
*                 Action: Refer to action under the individual reason * 00084000
*                 code.                                               * 00084100
*                                                                     * 00084200
*                                                                     * 00084300
*                 HEX REASON  MEANING/ACTION                          * 00084400
*                 CODE                                                * 00084500
*                                                                     * 00084600
*                 xxxx0C01    Name: ISGADMINRsn_NotAuthorized         * 00084700
*                                                                     * 00084800
*                             Meaning: An unauthorized caller invoked * 00084900
*                             the ISGADMIN service.                   * 00085000
*                                                                     * 00085100
*                             Action: An ISGADMIN caller must be      * 00085200
*                             authorized.                             * 00085300
*                                                                     * 00085400
*                 xxxx0C02    Name: ISGADMINRsn_FRRHeld               * 00085500
*                                                                     * 00085600
*                             Meaning: The caller issued ISGADMIN     * 00085700
*                             when an FRR was established.            * 00085800
*                                                                     * 00085900
*                             Action: Avoid issuing ISGADMIN when     * 00086000
*                             using functional recovery routines.     * 00086100
*                                                                     * 00086200
*                 xxxx0C03    Name: ISGADMINRsn_LockHeld              * 00086300
*                                                                     * 00086400
*                             Meaning: A lock was held upon entry.    * 00086500
*                             No locks may be held when calling       * 00086600
*                             ISGADMIN.                               * 00086700
*                                                                     * 00086800
*                             Action: Avoid using ISGADMIN when locks * 00086900
*                             are held.                               * 00087000
*                                                                     * 00087100
*                 xxxx0C04    Name: ISGADMINRsn_SrbMode               * 00087200
*                                                                     * 00087300
*                             Meaning: SRB mode.                      * 00087400
*                                                                     * 00087500
*                             Action: SRB mode is not supported.      * 00087600
*                                                                     * 00087700
*                 xxxx0C05    Name: ISGADMINRsn_NotEnabled            * 00087800
*                                                                     * 00087900
*                             Meaning: Not Enabled.                   * 00088000
*                                                                     * 00088100
*                             Action: Avoid using ISGADMIN when not   * 00088200
*                             enabled.                                * 00088300
*                                                                     * 00088400
*                 xxxx0C06    Name: ISGADMINRsn_QueueDamage1          * 00088500
*                                                                     * 00088600
*                             Meaning: The GRS resource queue         * 00088700
*                             structure for the target resource is    * 00088800
*                             damaged.  Further processing against    * 00088900
*                             the queue is not allowed.               * 00089000
*                                                                     * 00089100
*                             Action: Prevent any further processing  * 00089200
*                             against the target resource.            * 00089300
*                                                                     * 00089400
*                 xxxx0C07    Name: ISGADMINRsn_QueueDamage2          * 00089500
*                                                                     * 00089600
*                             Meaning: The GRS resource queue         * 00089700
*                             structure for the target resource is    * 00089800
*                             damaged.  Further processing against    * 00089900
*                             the queue is not allowed.               * 00090000
*                                                                     * 00090100
*                             Action: Prevent any further processing  * 00090200
*                             against the target resource.            * 00090300
*                                                                     * 00090400
*                                                                     * 00090500
*                                                                     * 00090600
*                                                                     * 00090700
*       10        Name: ISGADMINRc_CompError                          * 00090800
*                                                                     * 00090900
*                 Meaning: Component Error                            * 00091000
*                                                                     * 00091100
*                 Action: Contact the IBM Support Center.  Provide    * 00091200
*                 the reason code which contains diagnostic data.     * 00091300
*                                                                     * 00091400
*                                                                     * 00091500
*                                                                     * 00091600
*01* REASON CODES:                                                    * 00091700
*                                                                     * 00091800
*       Reason codes, as appropriate, are defined under their         * 00091900
*       corresponding return code.                                    * 00092000
*                                                                     * 00092100
*01* MODULE TYPE:  ASSEM MACRO                                        * 00092200
*                                                                     * 00092300
*02*   PROCESSOR:  ASSEM                                              * 00092400
*                                                                     * 00092500
*01* COMPONENT:  SCSDS                                                * 00092600
*                                                                     * 00092700
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00092800
*                                                                     * 00092900
*01* ABEND CODES:  None.                                              * 00093000
*       None                                                          * 00093100
*                                                                     * 00093200
*01* EXAMPLES:                                                        * 00093300
*                                                                     * 00093400
*01* MACRO USAGE NOTES:                                               * 00093500
*                                                                     * 00093600
*                                                                     * 00093700
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00093800
*        global macro variable.  Any value other than 'NO' will       * 00093900
*        result in the macro expansion being printed.  The default is * 00094000
*        'YES'.  The following examples illustrate how the ZPRINT     * 00094100
*        variable should be set.                                      * 00094200
*                                                                     * 00094300
*                    GBLC &ZPRINT                                     * 00094400
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00094500
*                                                                     * 00094600
*                                                                     * 00094700
*    2.  The ISGADMIN macro supports multiple versions. The macro key * 00094800
*        list  below  contains the version level in which the key was * 00094900
*        first  introduced.  Positionals  are  identified by the word * 00095000
*        'Positional'  followed by the numeric value of its position. * 00095100
*        Nested  positionals  are  preceded  by their outer key.  The * 00095200
*        lowest value represents the original version and the highest * 00095300
*        value  represents  the  most  recent version of the ISGADMIN * 00095400
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00095500
*        least  as high as the highest version number of all the keys * 00095600
*        being used.                                                  * 00095700
*                                                                     * 00095800
*        VERSION   KEY                                                * 00095900
*                                                                     * 00096000
*              1      MAXTYPE                                         * 00096100
*                     MAXVALUE                                        * 00096200
*                     REQUEST                                         * 00096300
*              2      BEFOREREQUESTER                                 * 00096400
*                     MOVINGWAITER                                    * 00096500
*                     NEWCONTROL                                      * 00096600
*                     TOTHEEND                                        * 00096700
*                                                                     * 00096800
*                                                                     * 00096900
*                                                                     * 00097000
*01* CHANGE ACTIVITY:                                                 * 00097100
*                                                                     * 00097200
*   Flag LineItem  FMID    Date   ID    Comment                       * 00097300
*                                                                     * 00097400
*    $L0=ENQAPI   HBB7730 050427 PDBC:  Introduce ISGADMIN service.   * 00097500
*    $P1=ME03722  HBB7730 050610 PDBC:  Remove modify form from       * 00097600
*                                         external usage              * 00097700
*    $P2=ME04246  HBB7730 050823 PDBC:  Add authorization explanation * 00097800
*    $L1=GRSTOR2  HBB7740 060224 PDBC:  Add REQUEST=MOVEWAITER.       * 00097900
*    $P3=ME07482  HBB7740 060809 PDBC:  Retransmit for tool change.   * 00098000
*    $P4=ME07478  HBB7740 060809 PDBC:  Update comment for 0814       * 00098100
*                                         reason.                     * 00098200
*    $P5=ME07703  HBB7740 060915 PDBC:  Update comment for 0803       * 00098300
*                                         reason.                     * 00098400
*    $P6=ME08780  HBB7740 061211 PDBC:  Updated various comments.     * 00098500
*    $P7=ME09364  HBB7740 070220 PDRY:  Retransmit for metadata       * 00098600
*                                         change.                     * 00098700
*    $L2=GRSUDATA HBB7750 070122 PDFY:  Updated reason code           * 00098800
*                                         descriptions.               * 00098900
*    $P8=ME10829  HBB7750 070807 PDCJ:  Reship to pick up AMG updates * 00099000
*                                         for RETCODE/RSNCODE         * 00099100
*                                         handling and associated     * 00099200
*                                         description updates.        * 00099300
*    $L3=GRSUDATA HBB7750 070828 PDCJ:  Updates for AMGTOPUB tool     * 00099400
*    $L4=GRSUDATA HBB7750 080120 PDCJ:  Updates for AMGTOPUB tool -   * 00099500
*                                         use RR tracks               * 00099600
****** END OF SPECIFICATIONS *****************************************/ 00099700
*/********************************************************************* 00099800
         MACRO                                                          00099900
&XLABEL  ISGADMIN &REQUEST=,&MAXTYPE=,&MAXVALUE=,&MOVINGWAITER=,       *00100000
               &NEWCONTROL=,&TOTHEEND=,&BEFOREREQUESTER=,&RETCODE=,    *00100100
               &RSNCODE=,&PLISTVER=,&MF=                                00100200
.*                                                                      00100300
*                     MACDATE -02/27/08-<2>                             00100400
.*                                                                      00100500
.*******************************************************************    00100600
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00100700
.*******************************************************************    00100800
                     GBLC  &ZPRINT     YES=PRINT NO=NO PRINT            00100900
                     GBLC  &ZTEST      YES=TEST NO=NO TEST              00101000
                     GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX      00101100
.*                                                                      00101200
                     GBLC  &ZISGADMIN  YES=MACRO USED AT LEAST ONCE     00101300
.*******************************************************************    00101400
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00101500
.*******************************************************************    00101600
                     LCLC  &ZMS        ERROR MESSAGE WORK AREA          00101700
                     LCLC  &ZCNDX      SYSNDX CHARACTERS                00101800
                     LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED       00101900
                     LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR      00102000
                     LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE      00102100
                     LCLA  &ZAWRK      USED AS A WORK AREA              00102200
                     LCLA  &ZASIZ      USED FOR SIZE OF VALUE           00102300
                     LCLA  &ZN         NUMERIC WORK VARIABLE            00102400
                     LCLC  &ZC         CHARACTER WORK VARIABLE          00102500
                     LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE      00102600
                     LCLA  &ZTLA       VALUE TOO LONG VARIABLE          00102700
                     LCLC  &ZMAC_G     "G" or null                      00102800
&ZMAC_G              SETC  ''                                           00102900
                     LCLC  &ZMAC_LR                                     00103000
&ZMAC_LR             SETC  'LR'                                         00103100
                     LCLC  &ZMAC_L                                      00103200
&ZMAC_L              SETC  'L'                                          00103300
                     LCLC  &ZMAC_ST                                     00103400
&ZMAC_ST             SETC  'ST'                                         00103500
                     LCLA  &ZMACRET    MACRO RETURN CODE                00103600
&ZMACRET             SETA  0           ASSUME NO ERRORS                 00103700
.*                                                                      00103800
                     LCLC  &ZCSYSLIST(255)      NONXKEY, POS ARRAY      00103900
                     LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()       00104000
                     LCLA  &ZPLLEN     PARAMETER LIST LENGTH            00104100
                     LCLC  &ZENDBASEPL          End of base PL          00104200
                     LCLA  &ZPLWORKA   PARAMETER LIST LENGTH            00104300
.*******************************************************************    00104400
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00104500
.*******************************************************************    00104600
                     LCLA  &ZI         INDEX FOR ARRAY                  00104700
                     LCLA  &ZJ         INDEX FOR PARMS                  00104800
                     LCLA  &ZK         INDEX FOR PARSE                  00104900
                     LCLA  &ZLO        LOW RANGE VALUE                  00105000
                     LCLA  &ZHI        HIGH RANGE VALUE                 00105100
                     LCLC  &ZW         WORK AREA FOR PARM               00105200
.********************************************************************   00105300
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00105400
.********************************************************************   00105500
                     GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL          00105600
                     GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE   00105700
                     GBLA  &SYSALVL    SYSSTATE ARCHLVL                 00105800
                     GBLC  &SYSAM64    SYSSTATE AMODE64                 00105900
.*                                                                      00106000
                     AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED   00106100
                     AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED    00106200
                     SPLEVEL  TEST                                      00106300
.ZSYS2               ANOP  ,                                            00106400
                     AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1        00106500
                     AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1        00106600
                     SYSSTATE TEST                                      00106700
                     AIF   (&SYSALVL LE 1).ZSYS4                        00106800
&ZMAC_G              SETC 'G'                                           00106900
&ZMAC_LR             SETC 'LGR'                                         00107000
&ZMAC_L              SETC 'LG'                                          00107100
&ZMAC_ST             SETC 'STG'                                         00107200
                     AGO   .ZSYS4                                       00107300
.ZSYS3               ANOP  ,                                            00107400
&SYSASCE             SETC  'P'         ASSUME SYSSTATE PRIMARY          00107500
.ZSYS4               ANOP  ,                                            00107600
.*******************************************************************    00107700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00107800
.*******************************************************************    00107900
                     LCLC  &XREQUEST   ++ VALUE                         00108000
                     LCLC  &XMAXTYPE   ++ VALUE                         00108100
                     LCLC  &XMAXVALUE  ++ NAME                          00108200
                     LCLC  &XMOVINGWAITER       ++ NAME                 00108300
                     LCLC  &XNEWCONTROL         ++ VALUE                00108400
                     LCLC  &XTOTHEEND  ++ VALUE                         00108500
                     LCLC  &XBEFOREREQUESTER    ++ NAME                 00108600
                     LCLC  &XRETCODE   ++ NAME                          00108700
                     LCLC  &XRSNCODE   ++ NAME                          00108800
                     LCLA  &XPLISTVER  ++ VALUE                         00108900
                     LCLC  &XMF        ++ VALUE                         00109000
                     LCLC  &XMFCTRL    ++ NAME                          00109100
                     LCLC  &XMFATTR    ++ VALUE                         00109200
                     LCLC  &XMFSCK     ++ VALUE                         00109300
.*******************************************************************    00109400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00109500
.*******************************************************************    00109600
                     LCLC  &ZXREQUEST  ++ INPUT VALUE                   00109700
                     LCLC  &ZXMAXTYPE  ++ INPUT VALUE                   00109800
                     LCLC  &ZXMAXVALUE          ++ INPUT NAME           00109900
                     LCLC  &ZXMOVINGWAITER      ++ INPUT NAME           00110000
                     LCLC  &ZXNEWCONTROL        ++ INPUT VALUE          00110100
                     LCLC  &ZXTOTHEEND          ++ INPUT VALUE          00110200
                     LCLC  &ZXBEFOREREQUESTER   ++ INPUT NAME           00110300
                     LCLC  &ZXRETCODE  ++ OUTPUT NAME                   00110400
                     LCLC  &ZXRSNCODE  ++ OUTPUT NAME                   00110500
                     LCLC  &ZXPLISTVER          ++ INPUT VALUE          00110600
                     LCLC  &ZXMF       ++ INPUT VALUE                   00110700
                     LCLC  &ZXMFCTRL   ++ INPUT NAME                    00110800
                     LCLC  &ZXMFATTR   ++ INPUT VALUE                   00110900
                     LCLC  &ZXMFSCK    ++ INPUT VALUE                   00111000
.********************************************************************   00111100
.***AC.PLV01  PROCESS PLISTVER                                      *   00111200
.********************************************************************   00111300
&XPLISTVER      SETA  1                                                 00111400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00111500
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00111600
&XPLISTVER      SETA  2                                                 00111700
.ZPLV0          ANOP  ,                                                 00111800
.*                                                                      00111900
                AIF   ('&MOVINGWAITER' EQ '').ZPLV1E                    00112000
                AIF   (&XPLISTVER GE 2).ZPLV1E                          00112100
&XPLISTVER      SETA  2                                                 00112200
.ZPLV1E         ANOP  ,                                                 00112300
.*                                                                      00112400
                AIF   ('&NEWCONTROL' EQ '').ZPLV2E                      00112500
                AIF   (&XPLISTVER GE 2).ZPLV2E                          00112600
&XPLISTVER      SETA  2                                                 00112700
.ZPLV2E         ANOP  ,                                                 00112800
.*                                                                      00112900
                AIF   ('&TOTHEEND' EQ '').ZPLV3E                        00113000
                AIF   (&XPLISTVER GE 2).ZPLV3E                          00113100
&XPLISTVER      SETA  2                                                 00113200
.ZPLV3E         ANOP  ,                                                 00113300
.*                                                                      00113400
                AIF   ('&BEFOREREQUESTER' EQ '').ZPLV4E                 00113500
                AIF   (&XPLISTVER GE 2).ZPLV4E                          00113600
&XPLISTVER      SETA  2                                                 00113700
.ZPLV4E         ANOP  ,                                                 00113800
.*                                                                      00113900
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00114000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00114100
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00114200
.*-------------------------------------------------------------------   00114300
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00114400
&ZMS            SETC  '"PLISTVER='                                      00114500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00114600
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00114700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00114800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00114900
                AGO   .ZPVCK2                                           00115000
.ZPVCK3         ANOP  ,                                                 00115100
.*-------------------------------------------------------------------   00115200
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00115300
&ZMS            SETC  '"PLISTVER='                                      00115400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00115500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00115600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00115700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00115800
                AGO   .ZPVCKE                                           00115900
.ZPVCK2         ANOP  ,                                                 00116000
.*-------------------------------------------------------------------   00116100
&ZCVAL          SETC  '&PLISTVER(1)'                                    00116200
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00116300
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00116400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00116500
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00116600
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00116700
.ZPVCK6         ANOP  ,                                                 00116800
&ZMS            SETC  '"PLISTVER='                                      00116900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00117000
&ZMS            SETC  '&ZMS THE RANGE IS "1-2"'                         00117100
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00117200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00117300
&XPLISTVER      SETA  2                                                 00117400
                AGO   .ZPVCKE                                           00117500
.*-------------------------------------------------------------------   00117600
.ZPVCK4A        ANOP  ,                                                 00117700
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00117800
&ZMS            SETC  'PLISTVER='                                       00117900
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00118000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00118100
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00118200
                MNOTE 8,' &ZMS IS REQUIRED.'                            00118300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00118400
                AGO   .ZPVCK5                                           00118500
.ZPVCK4         ANOP  ,                                                 00118600
&XPLISTVER      SETA  &PLISTVER(1)                                      00118700
.ZPVCK5         ANOP  ,                                                 00118800
.ZPVCKE         ANOP  ,                                                 00118900
.********************************************************************   00119000
.***AG.MF01 PROCESS MF MACRO FORMS                                      00119100
.********************************************************************   00119200
                     ACTR  10000                                        00119300
.*------------------------------------------------------------------    00119400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119500
&XMF                 SETC  ''          INITIALIZE XVARIABLE             00119600
.*-------------------------------------------------------------------   00119700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00119800
.ZG47                ANOP  ,                                            00119900
&ZTLC                SETC 'S'                                           00120000
                     AIF   ('&MF(1)' NE '&ZTLC').ZG48                   00120100
&XMF                 SETC  'S'         SET KEYWORD                      00120200
                     AIF   (N'&MF LE 1).ZG47A   CK NUM                  00120300
&ZMS                 SETC  '"MF='                                       00120400
&ZMS                 SETC  '&ZMS.&MF"'                                  00120500
&ZMS                 SETC  '&ZMS "MF"'                                  00120600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00120700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00120800
.ZG47A               ANOP  ,                                            00120900
.*-------------------------------------------------------------------   00121000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121100
.ZG48                ANOP  ,                                            00121200
&ZTLC                SETC 'L'                                           00121300
                     AIF   ('&MF(1)' NE '&ZTLC').ZG55                   00121400
&XMF                 SETC  'L'         SET KEYWORD                      00121500
                     AIF   (N'&MF LE 3).ZG48A   CK NUM                  00121600
&ZMS                 SETC  '"MF='                                       00121700
&ZMS                 SETC  '&ZMS.&MF"'                                  00121800
&ZMS                 SETC  '&ZMS "MF"'                                  00121900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00122000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00122100
.ZG48A               ANOP  ,                                            00122200
.*-------------------------------------------------------------------   00122300
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00122400
                     AIF   (N'&SYSLIST NE 0).ZG48B  POSITIONALS?        00122500
                     AIF   ('&REQUEST' NE '').ZG48B  KEYS?              00122600
                     AIF   ('&MAXTYPE' NE '').ZG48B  KEYS?              00122700
                     AIF   ('&MAXVALUE' NE '').ZG48B  KEYS?             00122800
                     AIF   ('&MOVINGWAITER' NE '').ZG48B  KEYS?         00122900
                     AIF   ('&NEWCONTROL' NE '').ZG48B  KEYS?           00123000
                     AIF   ('&TOTHEEND' NE '').ZG48B  KEYS?             00123100
                     AIF   ('&BEFOREREQUESTER' NE '').ZG48B  KEYS?      00123200
                     AIF   ('&RETCODE' NE '').ZG48B  KEYS?              00123300
                     AIF   ('&RSNCODE' NE '').ZG48B  KEYS?              00123400
                     AGO    .ZG48C     INVOCATION OKAY                  00123500
.ZG48B               ANOP  ,                                            00123600
&ZMS                 SETC  'THE "L" FORM OF "MF"'                       00123700
&ZMS                 SETC  '&ZMS CAN ONLY HAVE'                         00123800
&ZMS                 SETC  '&ZMS THE "PLISTVER" KEY'                    00123900
                     MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'       00124000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00124100
.ZG48C               ANOP  ,                                            00124200
.*-------------------------------------------------------------------   00124300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00124400
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00124500
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00124600
                     AIF   (N'&MF(2) GT 1).ZG50B  MULTI PARMS           00124700
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00124800
.ZG50B               AIF   (K'&MF(2) GT 0).ZG50C                        00124900
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00125000
&ZMS                 SETC  'WHEN "L" IS SPECIFIED'                      00125100
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00125200
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00125300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00125400
.ZG50C               ANOP  ,                                            00125500
.*-------------------------------------------------------------------   00125600
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00125700
                     AIF   (K'&ZXMFCTRL LE 0).ZG50P  NOT I/O            00125800
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG50P               00125900
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00126000
&ZMS                 SETC  '"MF='                                       00126100
&ZMS                 SETC  '&ZMS.&MF"'                                  00126200
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00126300
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'            00126400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00126500
.ZG50P               ANOP  ,                                            00126600
.*-------------------------------------------------------------------   00126700
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00126800
&ZXMFATTR            SETC  'INPUT'     SET IN/OUTPUT                    00126900
&XMFATTR             SETC  '0D'                                         00127000
                     AIF   (K'&MF(3) LE 0).ZG53B  PARM                  00127100
&XMFATTR             SETC  '&MF(3,1)'  SET XVARIABLE                    00127200
                     AIF   (N'&MF(3) GT 1).ZG53B  MULTI                 00127300
&XMFATTR             SETC  '&MF(3)'    SET XVARIABLE                    00127400
.ZG53B               ANOP  ,                                            00127500
.*-------------------------------------------------------------------   00127600
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00127700
                     AIF   (K'&ZXMFATTR LE 0).ZG53P  NOT I/O            00127800
                     AIF   ('&XMFATTR'(1,1) NE '(').ZG53P               00127900
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00128000
&ZMS                 SETC  '"MF='                                       00128100
&ZMS                 SETC  '&ZMS.&MF"'                                  00128200
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00128300
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'            00128400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00128500
.ZG53P               ANOP  ,                                            00128600
.*-------------------------------------------------------------------   00128700
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00128800
                     AIF   (K'&ZXMFATTR LE 0).ZG53S  NOT I/O            00128900
                     AIF   (K'&XMFATTR LE 60).ZG53S  LNG OK             00129000
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00129100
&ZMS                 SETC  '"MF='                                       00129200
&ZMS                 SETC  '&ZMS.&MF"'                                  00129300
&ZMS                 SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'        00129400
                     MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'           00129500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00129600
.ZG53S               ANOP  ,                                            00129700
.*-------------------------------------------------------------------   00129800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129900
.ZG55                ANOP  ,                                            00130000
&ZTLC                SETC 'E'                                           00130100
                     AIF   ('&MF(1)' NE '&ZTLC').ZG63                   00130200
&XMF                 SETC  'E'         SET KEYWORD                      00130300
                     AIF   (N'&MF LE 3).ZG55A   CK NUM                  00130400
&ZMS                 SETC  '"MF='                                       00130500
&ZMS                 SETC  '&ZMS.&MF"'                                  00130600
&ZMS                 SETC  '&ZMS "MF"'                                  00130700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00130800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00130900
.ZG55A               ANOP  ,                                            00131000
.*-------------------------------------------------------------------   00131100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00131200
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00131300
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00131400
                     AIF   (N'&MF(2) GT 1).ZG57B  MULTI PARMS           00131500
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00131600
.ZG57B               AIF   (K'&MF(2) GT 0).ZG57C                        00131700
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00131800
&ZMS                 SETC  'WHEN "E" IS SPECIFIED'                      00131900
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00132000
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00132100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00132200
.ZG57C               ANOP  ,                                            00132300
.*-------------------------------------------------------------------   00132400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00132500
                     AIF   (K'&ZXMFCTRL LE 0).ZG57R  NOT I/O            00132600
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG57R               00132700
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00132800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG57P                 00132900
                     AIF   (K'&ZCGPR GT 2).ZG57Q                        00133000
                     AIF   ('&ZCGPR' EQ '0').ZG57Q                      00133100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00133200
                     AIF   (T'&ZCGPR NE 'N').ZG57Q  INVALID REG NAME    00133300
.ZG57P               ANOP  ,                                            00133400
                     AIF   (T'&ZCGPR NE 'N').ZG57R  NON NUMERIC         00133500
                     AIF   ('&ZCGPR' LT '1').ZG57Q                      00133600
                     AIF   ('&ZCGPR' LE '12').ZG57R                     00133700
.ZG57Q               ANOP  ,                                            00133800
&ZMS                 SETC  '"MF='                                       00133900
&ZMS                 SETC  '&ZMS.&MF"'                                  00134000
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00134100
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00134200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00134300
.ZG57R               ANOP  ,                                            00134400
.*-------------------------------------------------------------------   00134500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00134600
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00134700
.ZG61A   AIF   ('&MF(3)' NE 'COMPLETE').ZG62A                           00134800
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00134900
.*-------------------------------------------------------------------   00135000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00135100
.ZG62A               AIF   (K'&XMFSCK GT 0).ZG62C  KEYWORD              00135200
                     AIF   (K'&MF(3) LE 0).ZG62B                        00135300
&ZMS                 SETC  '"MF='                                       00135400
&ZMS                 SETC  '&ZMS.&MF"'                                  00135500
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00135600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00135700
&ZMS                 SETC  '&ZMS "COMPLETE".'                           00135800
                     MNOTE 8,' &ZMS '                                   00135900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00136000
.ZG62B               ANOP  ,                                            00136100
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00136200
.ZG62C               ANOP  ,                                            00136300
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00136400
.*------------------------------------------------------------------    00136500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136600
.ZG63                ANOP  ,                                            00136700
&ZXMF                SETC  'INPUT'     SET IN/OUTPUT                    00136800
                     AIF   (K'&XMF GT 0).ZG63E  VALID ARG               00136900
                     AIF   (T'&MF EQ 'O').ZG63D  OMITTED                00137000
&ZASYSLNDX           SETA  0                                            00137100
.ZG63A               ANOP  ,           POSITIONAL MACRO KEY             00137200
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00137300
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG63C             00137400
&ZTLC                SETC 'MF'                                          00137500
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG63A    00137600
.ZG63B               ANOP  ,                                            00137700
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00137800
&ZMS                 SETC  'THE "MF" KEY'                               00137900
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00138000
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00138100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00138200
                     AGO   .ZG63E                                       00138300
.ZG63C               ANOP  ,                                            00138400
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00138500
&ZMS                 SETC  '"MF='                                       00138600
&ZMS                 SETC  '&ZMS.&MF"'                                  00138700
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00138800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00138900
&ZMS                 SETC  '&ZMS "S",'                                  00139000
&ZMS                 SETC  '&ZMS "L",'                                  00139100
&ZMS                 SETC  '&ZMS OR "E".'                               00139200
                     MNOTE 8,' &ZMS '                                   00139300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00139400
                     AGO   .ZG63E                                       00139500
.ZG63D               ANOP  ,                                            00139600
&XMF                 SETC  'S'         SET DEFAULT KEYWORD              00139700
&XMFSCK              SETC  'COMPLETE'  COMPLETE CHECKING                00139800
.ZG63E               ANOP  ,                                            00139900
.********************************************************************   00140000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00140100
.********************************************************************   00140200
                     ACTR  10000                                        00140300
.*-------------------------------------------------------------------   00140400
.***AG.MF03 MF=(SLE)                                                    00140500
                     AIF   ('&XMF' EQ 'L').ZGMFX                        00140600
.*------------------------------------------------------------------    00140700
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140800
&XREQUEST            SETC  ''          INITIALIZE XVARIABLE             00140900
.*-------------------------------------------------------------------   00141000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141100
.ZG3                 ANOP  ,                                            00141200
                     AIF   (K'&REQUEST(1) LE 0).ZG3A                    00141300
&ZTLC                SETC 'SETENQMAX'                                   00141400
                     AIF   ('&REQUEST(1)' NE '&ZTLC').ZG12              00141500
&XREQUEST            SETC  'SETENQMAX'          SET KEYWORD             00141600
                     AIF   (N'&REQUEST LE 1).ZG3A  CK NUM               00141700
&ZMS                 SETC  '"REQUEST='                                  00141800
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00141900
&ZMS                 SETC  '&ZMS "REQUEST"'                             00142000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00142100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00142200
.ZG3A                ANOP  ,                                            00142300
.*------------------------------------------------------------------    00142400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142500
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00142600
.ZG3A0               AIF   (K'&MOVINGWAITER LE 0).ZG3A1  OK             00142700
&ZCVAL               SETC '&ZCVAL MOVINGWAITER'  INCORRECT KEY USED     00142800
.ZG3A1               AIF   (K'&NEWCONTROL LE 0).ZG3A2  OK               00142900
&ZCVAL               SETC '&ZCVAL NEWCONTROL'   INCORRECT KEY USED      00143000
.ZG3A2               AIF   (K'&TOTHEEND LE 0).ZG3A3  OK                 00143100
&ZCVAL               SETC '&ZCVAL TOTHEEND'     INCORRECT KEY USED      00143200
.ZG3A3               AIF   (K'&BEFOREREQUESTER LE 0).ZG3A4  OK          00143300
&ZCVAL               SETC '&ZCVAL BEFOREREQUESTER'  INCORRECT KEY USED  00143400
.ZG3A4               AIF   (K'&ZCVAL LE 0).ZG3A5  OK                    00143500
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00143600
&ZMS                 SETC  '"REQUEST'                                   00143700
&ZMS                 SETC  '&ZMS.=&REQUEST"'                            00143800
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00143900
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00144000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00144100
.ZG3A5               ANOP  ,                                            00144200
.*------------------------------------------------------------------    00144300
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144400
&XMAXTYPE            SETC  ''          INITIALIZE XVARIABLE             00144500
.*-------------------------------------------------------------------   00144600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144700
.ZG6                 ANOP  ,                                            00144800
                     AIF   (K'&MAXTYPE(1) LE 0).ZG6A                    00144900
&ZTLC                SETC 'AUTHORIZED'                                  00145000
                     AIF   ('&MAXTYPE(1)' NE '&ZTLC').ZG7               00145100
&XMAXTYPE            SETC  'AUTHORIZED'         SET KEYWORD             00145200
                     AIF   (N'&MAXTYPE LE 1).ZG6A  CK NUM               00145300
&ZMS                 SETC  '"MAXTYPE='                                  00145400
&ZMS                 SETC  '&ZMS.&MAXTYPE"'                             00145500
&ZMS                 SETC  '&ZMS "MAXTYPE"'                             00145600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00145700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00145800
.ZG6A                ANOP  ,                                            00145900
.*-------------------------------------------------------------------   00146000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00146100
.ZG7                 ANOP  ,                                            00146200
&ZTLC                SETC 'UNAUTHORIZED'                                00146300
                     AIF   ('&MAXTYPE(1)' NE '&ZTLC').ZG8               00146400
&XMAXTYPE            SETC  'UNAUTHORIZED'       SET KEYWORD             00146500
                     AIF   (N'&MAXTYPE LE 1).ZG7A  CK NUM               00146600
&ZMS                 SETC  '"MAXTYPE='                                  00146700
&ZMS                 SETC  '&ZMS.&MAXTYPE"'                             00146800
&ZMS                 SETC  '&ZMS "MAXTYPE"'                             00146900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00147000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00147100
.ZG7A                ANOP  ,                                            00147200
.*------------------------------------------------------------------    00147300
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147400
.ZG8                 ANOP  ,                                            00147500
&ZXMAXTYPE           SETC  'INPUT'     SET IN/OUTPUT                    00147600
                     AIF   (K'&XMAXTYPE GT 0).ZG8E  VALID ARG           00147700
                     AIF   (T'&MAXTYPE EQ 'O').ZG8D  OMITTED            00147800
&ZASYSLNDX           SETA  0                                            00147900
.ZG8A                ANOP  ,           POSITIONAL MACRO KEY             00148000
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00148100
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG8C              00148200
&ZTLC                SETC 'MAXTYPE'                                     00148300
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG8A     00148400
.ZG8B                ANOP  ,                                            00148500
&ZXMAXTYPE           SETC  ''          RESET IN/OUTPUT                  00148600
&ZMS                 SETC  'THE "MAXTYPE" KEY'                          00148700
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00148800
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00148900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00149000
                     AGO   .ZG8E                                        00149100
.ZG8C                ANOP  ,                                            00149200
&ZXMAXTYPE           SETC  ''          RESET IN/OUTPUT                  00149300
&ZMS                 SETC  '"MAXTYPE='                                  00149400
&ZMS                 SETC  '&ZMS.&MAXTYPE"'                             00149500
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00149600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00149700
&ZMS                 SETC  '&ZMS "AUTHORIZED"'                          00149800
&ZMS                 SETC  '&ZMS OR "UNAUTHORIZED".'                    00149900
                     MNOTE 8,' &ZMS '                                   00150000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00150100
                     AGO   .ZG8E                                        00150200
.ZG8D                ANOP  ,                                            00150300
&XMAXTYPE            SETC  'AUTHORIZED'         SET DEFAULT KEYWORD     00150400
.ZG8E                ANOP  ,                                            00150500
.*------------------------------------------------------------------    00150600
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150700
                     AIF   (K'&MAXTYPE(1) GT 0).ZG8F  PARM              00150800
&XMAXTYPE            SETC  ''          ENSURE NULL KEYWORD              00150900
&ZXMAXTYPE           SETC  ''          RESET IN/OUTPUT                  00151000
&ZMS                 SETC  'THE'                                        00151100
&ZMS                 SETC  '&ZMS "MAXTYPE" KEY AND ITS'                 00151200
&ZMS                 SETC  '&ZMS ARGUMENT ARE REQUIRED.'                00151300
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00151400
&ZMS                 SETC  '&ZMS "AUTHORIZED"'                          00151500
&ZMS                 SETC  '&ZMS OR "UNAUTHORIZED".'                    00151600
                     MNOTE 8,' &ZMS '                                   00151700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00151800
.ZG8F                ANOP  ,                                            00151900
.*----------------------------------------------------------------***   00152000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00152100
                     AIF   (N'&MAXVALUE LE 1).ZG10A  CK NUM             00152200
&ZMS                 SETC  '"MAXVALUE='                                 00152300
&ZMS                 SETC  '&ZMS.&MAXVALUE"'                            00152400
&ZMS                 SETC  '&ZMS "MAXVALUE"'                            00152500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00152600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00152700
.ZG10A               ANOP  ,                                            00152800
.*-------------------------------------------------------------------   00152900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00153000
&ZXMAXVALUE          SETC  'INPUT'     SET IN/OUTPUT                    00153100
&XMAXVALUE           SETC  '&MAXVALUE(1)'       SET XVARIABLE           00153200
                     AIF   (N'&MAXVALUE GT 1).ZG10B  MULTI PARMS        00153300
&XMAXVALUE           SETC  '&MAXVALUE'          SET XVARIABLE           00153400
.ZG10B               AIF   (K'&MAXVALUE(1) GT 0).ZG10C                  00153500
&ZXMAXVALUE          SETC  ''          RESET IN/OUTPUT                  00153600
&ZMS                 SETC  ' '                                          00153700
&ZMS                 SETC  '&ZMS "MAXVALUE" KEY AND ITS'                00153800
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00153900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00154000
.ZG10C               ANOP  ,                                            00154100
.*-------------------------------------------------------------------   00154200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00154300
                     AIF   (K'&ZXMAXVALUE LE 0).ZG10R  NOT I/O          00154400
                     AIF   ('&XMAXVALUE'(1,1) NE '(').ZG10R             00154500
&ZCGPR               SETC  '&XMAXVALUE'(2,K'&XMAXVALUE-2)               00154600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                 00154700
                     AIF   (K'&ZCGPR GT 2).ZG10Q                        00154800
                     AIF   ('&ZCGPR' EQ '0').ZG10Q                      00154900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00155000
                     AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME    00155100
.ZG10P               ANOP  ,                                            00155200
                     AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC         00155300
                     AIF   ('&ZCGPR' LT '2').ZG10Q                      00155400
                     AIF   ('&ZCGPR' LE '12').ZG10R                     00155500
.ZG10Q               ANOP  ,                                            00155600
&ZMS                 SETC  '"MAXVALUE='                                 00155700
&ZMS                 SETC  '&ZMS.&MAXVALUE"'                            00155800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00155900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00156000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00156100
.ZG10R               ANOP  ,                                            00156200
.*-------------------------------------------------------------------   00156300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156400
.ZG12                ANOP  ,                                            00156500
&ZTLC                SETC 'RESETENQMAX'                                 00156600
                     AIF   ('&REQUEST(1)' NE '&ZTLC').ZG18              00156700
&XREQUEST            SETC  'RESETENQMAX'        SET KEYWORD             00156800
                     AIF   (N'&REQUEST LE 1).ZG12A  CK NUM              00156900
&ZMS                 SETC  '"REQUEST='                                  00157000
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00157100
&ZMS                 SETC  '&ZMS "REQUEST"'                             00157200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00157300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00157400
.ZG12A               ANOP  ,                                            00157500
.*------------------------------------------------------------------    00157600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157700
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00157800
.ZG12A0              AIF   (K'&MAXVALUE LE 0).ZG12A1  OK                00157900
&ZCVAL               SETC '&ZCVAL MAXVALUE'     INCORRECT KEY USED      00158000
.ZG12A1              AIF   (K'&MOVINGWAITER LE 0).ZG12A2  OK            00158100
&ZCVAL               SETC '&ZCVAL MOVINGWAITER'  INCORRECT KEY USED     00158200
.ZG12A2              AIF   (K'&NEWCONTROL LE 0).ZG12A3  OK              00158300
&ZCVAL               SETC '&ZCVAL NEWCONTROL'   INCORRECT KEY USED      00158400
.ZG12A3              AIF   (K'&TOTHEEND LE 0).ZG12A4  OK                00158500
&ZCVAL               SETC '&ZCVAL TOTHEEND'     INCORRECT KEY USED      00158600
.ZG12A4              AIF   (K'&BEFOREREQUESTER LE 0).ZG12A5  OK         00158700
&ZCVAL               SETC '&ZCVAL BEFOREREQUESTER'  INCORRECT KEY USED  00158800
.ZG12A5              AIF   (K'&ZCVAL LE 0).ZG12A6  OK                   00158900
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00159000
&ZMS                 SETC  '"REQUEST'                                   00159100
&ZMS                 SETC  '&ZMS.=&REQUEST"'                            00159200
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00159300
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00159400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00159500
.ZG12A6              ANOP  ,                                            00159600
.*------------------------------------------------------------------    00159700
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00159800
&XMAXTYPE            SETC  ''          INITIALIZE XVARIABLE             00159900
.*-------------------------------------------------------------------   00160000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160100
.ZG15                ANOP  ,                                            00160200
                     AIF   (K'&MAXTYPE(1) LE 0).ZG15A                   00160300
&ZTLC                SETC 'AUTHORIZED'                                  00160400
                     AIF   ('&MAXTYPE(1)' NE '&ZTLC').ZG16              00160500
&XMAXTYPE            SETC  'AUTHORIZED'         SET KEYWORD             00160600
                     AIF   (N'&MAXTYPE LE 1).ZG15A  CK NUM              00160700
&ZMS                 SETC  '"MAXTYPE='                                  00160800
&ZMS                 SETC  '&ZMS.&MAXTYPE"'                             00160900
&ZMS                 SETC  '&ZMS "MAXTYPE"'                             00161000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00161100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00161200
.ZG15A               ANOP  ,                                            00161300
.*-------------------------------------------------------------------   00161400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00161500
.ZG16                ANOP  ,                                            00161600
&ZTLC                SETC 'UNAUTHORIZED'                                00161700
                     AIF   ('&MAXTYPE(1)' NE '&ZTLC').ZG17              00161800
&XMAXTYPE            SETC  'UNAUTHORIZED'       SET KEYWORD             00161900
                     AIF   (N'&MAXTYPE LE 1).ZG16A  CK NUM              00162000
&ZMS                 SETC  '"MAXTYPE='                                  00162100
&ZMS                 SETC  '&ZMS.&MAXTYPE"'                             00162200
&ZMS                 SETC  '&ZMS "MAXTYPE"'                             00162300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00162400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00162500
.ZG16A               ANOP  ,                                            00162600
.*------------------------------------------------------------------    00162700
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00162800
.ZG17                ANOP  ,                                            00162900
&ZXMAXTYPE           SETC  'INPUT'     SET IN/OUTPUT                    00163000
                     AIF   (K'&XMAXTYPE GT 0).ZG17E  VALID ARG          00163100
                     AIF   (T'&MAXTYPE EQ 'O').ZG17D  OMITTED           00163200
&ZASYSLNDX           SETA  0                                            00163300
.ZG17A               ANOP  ,           POSITIONAL MACRO KEY             00163400
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00163500
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C             00163600
&ZTLC                SETC 'MAXTYPE'                                     00163700
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG17A    00163800
.ZG17B               ANOP  ,                                            00163900
&ZXMAXTYPE           SETC  ''          RESET IN/OUTPUT                  00164000
&ZMS                 SETC  'THE "MAXTYPE" KEY'                          00164100
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00164200
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00164300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00164400
                     AGO   .ZG17E                                       00164500
.ZG17C               ANOP  ,                                            00164600
&ZXMAXTYPE           SETC  ''          RESET IN/OUTPUT                  00164700
&ZMS                 SETC  '"MAXTYPE='                                  00164800
&ZMS                 SETC  '&ZMS.&MAXTYPE"'                             00164900
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00165000
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00165100
&ZMS                 SETC  '&ZMS "AUTHORIZED"'                          00165200
&ZMS                 SETC  '&ZMS OR "UNAUTHORIZED".'                    00165300
                     MNOTE 8,' &ZMS '                                   00165400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00165500
                     AGO   .ZG17E                                       00165600
.ZG17D               ANOP  ,                                            00165700
&XMAXTYPE            SETC  'AUTHORIZED'         SET DEFAULT KEYWORD     00165800
.ZG17E               ANOP  ,                                            00165900
.*------------------------------------------------------------------    00166000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00166100
                     AIF   (K'&MAXTYPE(1) GT 0).ZG17F  PARM             00166200
&XMAXTYPE            SETC  ''          ENSURE NULL KEYWORD              00166300
&ZXMAXTYPE           SETC  ''          RESET IN/OUTPUT                  00166400
&ZMS                 SETC  'THE'                                        00166500
&ZMS                 SETC  '&ZMS "MAXTYPE" KEY AND ITS'                 00166600
&ZMS                 SETC  '&ZMS ARGUMENT ARE REQUIRED.'                00166700
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00166800
&ZMS                 SETC  '&ZMS "AUTHORIZED"'                          00166900
&ZMS                 SETC  '&ZMS OR "UNAUTHORIZED".'                    00167000
                     MNOTE 8,' &ZMS '                                   00167100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00167200
.ZG17F               ANOP  ,                                            00167300
.*-------------------------------------------------------------------   00167400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167500
.ZG18                ANOP  ,                                            00167600
&ZTLC                SETC 'MOVEWAITER'                                  00167700
                     AIF   ('&REQUEST(1)' NE '&ZTLC').ZG35              00167800
&XREQUEST            SETC  'MOVEWAITER'         SET KEYWORD             00167900
                     AIF   (N'&REQUEST LE 1).ZG18A  CK NUM              00168000
&ZMS                 SETC  '"REQUEST='                                  00168100
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00168200
&ZMS                 SETC  '&ZMS "REQUEST"'                             00168300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00168400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00168500
.ZG18A               ANOP  ,                                            00168600
.*------------------------------------------------------------------    00168700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00168800
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00168900
.ZG18A0              AIF   (K'&MAXTYPE LE 0).ZG18A1  OK                 00169000
&ZCVAL               SETC '&ZCVAL MAXTYPE'      INCORRECT KEY USED      00169100
.ZG18A1              AIF   (K'&MAXVALUE LE 0).ZG18A2  OK                00169200
&ZCVAL               SETC '&ZCVAL MAXVALUE'     INCORRECT KEY USED      00169300
.ZG18A2              AIF   (K'&ZCVAL LE 0).ZG18A3  OK                   00169400
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00169500
&ZMS                 SETC  '"REQUEST'                                   00169600
&ZMS                 SETC  '&ZMS.=&REQUEST"'                            00169700
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00169800
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00169900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00170000
.ZG18A3              ANOP  ,                                            00170100
.*----------------------------------------------------------------***   00170200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00170300
                     AIF   (N'&MOVINGWAITER LE 1).ZG20A  CK NUM         00170400
&ZMS                 SETC  '"MOVINGWAITER='                             00170500
&ZMS                 SETC  '&ZMS.&MOVINGWAITER"'                        00170600
&ZMS                 SETC  '&ZMS "MOVINGWAITER"'                        00170700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00170800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00170900
.ZG20A               ANOP  ,                                            00171000
.*-------------------------------------------------------------------   00171100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00171200
&ZXMOVINGWAITER      SETC  'INPUT'     SET IN/OUTPUT                    00171300
&XMOVINGWAITER       SETC  '&MOVINGWAITER(1)'   SET XVARIABLE           00171400
                     AIF   (N'&MOVINGWAITER GT 1).ZG20B  MULTI PARMS    00171500
&XMOVINGWAITER       SETC  '&MOVINGWAITER'      SET XVARIABLE           00171600
.ZG20B               AIF   (K'&MOVINGWAITER(1) GT 0).ZG20C              00171700
&ZXMOVINGWAITER      SETC  ''          RESET IN/OUTPUT                  00171800
&ZMS                 SETC  ' '                                          00171900
&ZMS                 SETC  '&ZMS "MOVINGWAITER" KEY AND ITS'            00172000
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00172100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00172200
.ZG20C               ANOP  ,                                            00172300
.*-------------------------------------------------------------------   00172400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00172500
                     AIF   (K'&ZXMOVINGWAITER LE 0).ZG20R  NOT I/O      00172600
                     AIF   ('&XMOVINGWAITER'(1,1) NE '(').ZG20R         00172700
&ZCGPR               SETC  '&XMOVINGWAITER'(2,K'&XMOVINGWAITER-2)       00172800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                 00172900
                     AIF   (K'&ZCGPR GT 2).ZG20Q                        00173000
                     AIF   ('&ZCGPR' EQ '0').ZG20Q                      00173100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00173200
                     AIF   (T'&ZCGPR NE 'N').ZG20Q  INVALID REG NAME    00173300
.ZG20P               ANOP  ,                                            00173400
                     AIF   (T'&ZCGPR NE 'N').ZG20R  NON NUMERIC         00173500
                     AIF   ('&ZCGPR' LT '2').ZG20Q                      00173600
                     AIF   ('&ZCGPR' LE '12').ZG20R                     00173700
.ZG20Q               ANOP  ,                                            00173800
&ZMS                 SETC  '"MOVINGWAITER='                             00173900
&ZMS                 SETC  '&ZMS.&MOVINGWAITER"'                        00174000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00174100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00174200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00174300
.ZG20R               ANOP  ,                                            00174400
.*------------------------------------------------------------------    00174500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174600
&XNEWCONTROL         SETC  ''          INITIALIZE XVARIABLE             00174700
.*-------------------------------------------------------------------   00174800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174900
.ZG24                ANOP  ,                                            00175000
                     AIF   (K'&NEWCONTROL(1) LE 0).ZG24A                00175100
&ZTLC                SETC 'EXCLUSIVE'                                   00175200
                     AIF   ('&NEWCONTROL(1)' NE '&ZTLC').ZG25           00175300
&XNEWCONTROL         SETC  'EXCLUSIVE'          SET KEYWORD             00175400
                     AIF   (N'&NEWCONTROL LE 1).ZG24A  CK NUM           00175500
&ZMS                 SETC  '"NEWCONTROL='                               00175600
&ZMS                 SETC  '&ZMS.&NEWCONTROL"'                          00175700
&ZMS                 SETC  '&ZMS "NEWCONTROL"'                          00175800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00175900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00176000
.ZG24A               ANOP  ,                                            00176100
.*-------------------------------------------------------------------   00176200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00176300
.ZG25                ANOP  ,                                            00176400
&ZTLC                SETC 'SHARED'                                      00176500
                     AIF   ('&NEWCONTROL(1)' NE '&ZTLC').ZG26           00176600
&XNEWCONTROL         SETC  'SHARED'    SET KEYWORD                      00176700
                     AIF   (N'&NEWCONTROL LE 1).ZG25A  CK NUM           00176800
&ZMS                 SETC  '"NEWCONTROL='                               00176900
&ZMS                 SETC  '&ZMS.&NEWCONTROL"'                          00177000
&ZMS                 SETC  '&ZMS "NEWCONTROL"'                          00177100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00177200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00177300
.ZG25A               ANOP  ,                                            00177400
.*------------------------------------------------------------------    00177500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177600
.ZG26                ANOP  ,                                            00177700
&ZXNEWCONTROL        SETC  'INPUT'     SET IN/OUTPUT                    00177800
                     AIF   (K'&XNEWCONTROL GT 0).ZG26E  VALID ARG       00177900
                     AIF   (T'&NEWCONTROL EQ 'O').ZG26D  OMITTED        00178000
&ZASYSLNDX           SETA  0                                            00178100
.ZG26A               ANOP  ,           POSITIONAL MACRO KEY             00178200
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00178300
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG26C             00178400
&ZTLC                SETC 'NEWCONTROL'                                  00178500
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG26A    00178600
.ZG26B               ANOP  ,                                            00178700
&ZXNEWCONTROL        SETC  ''          RESET IN/OUTPUT                  00178800
&ZMS                 SETC  'THE "NEWCONTROL" KEY'                       00178900
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00179000
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00179100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00179200
                     AGO   .ZG26E                                       00179300
.ZG26C               ANOP  ,                                            00179400
&ZXNEWCONTROL        SETC  ''          RESET IN/OUTPUT                  00179500
&ZMS                 SETC  '"NEWCONTROL='                               00179600
&ZMS                 SETC  '&ZMS.&NEWCONTROL"'                          00179700
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00179800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00179900
&ZMS                 SETC  '&ZMS "EXCLUSIVE"'                           00180000
&ZMS                 SETC  '&ZMS OR "SHARED".'                          00180100
                     MNOTE 8,' &ZMS '                                   00180200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00180300
                     AGO   .ZG26E                                       00180400
.ZG26D               ANOP  ,                                            00180500
&XNEWCONTROL         SETC  'EXCLUSIVE'          SET DEFAULT KEYWORD     00180600
.ZG26E               ANOP  ,                                            00180700
.*------------------------------------------------------------------    00180800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180900
&XTOTHEEND           SETC  ''          INITIALIZE XVARIABLE             00181000
.*-------------------------------------------------------------------   00181100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00181200
.ZG29                ANOP  ,                                            00181300
                     AIF   (K'&TOTHEEND(1) LE 0).ZG29A                  00181400
&ZTLC                SETC 'NO'                                          00181500
                     AIF   ('&TOTHEEND(1)' NE '&ZTLC').ZG33             00181600
&XTOTHEEND           SETC  'NO'        SET KEYWORD                      00181700
                     AIF   (N'&TOTHEEND LE 1).ZG29A  CK NUM             00181800
&ZMS                 SETC  '"TOTHEEND='                                 00181900
&ZMS                 SETC  '&ZMS.&TOTHEEND"'                            00182000
&ZMS                 SETC  '&ZMS "TOTHEEND"'                            00182100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00182200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00182300
.ZG29A               ANOP  ,                                            00182400
.*----------------------------------------------------------------***   00182500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00182600
                     AIF   (N'&BEFOREREQUESTER LE 1).ZG31A  CK NUM      00182700
&ZMS                 SETC  '"BEFOREREQUESTER='                          00182800
&ZMS                 SETC  '&ZMS.&BEFOREREQUESTER"'                     00182900
&ZMS                 SETC  '&ZMS "BEFOREREQUESTER"'                     00183000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00183100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00183200
.ZG31A               ANOP  ,                                            00183300
.*-------------------------------------------------------------------   00183400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00183500
&ZXBEFOREREQUESTER   SETC  'INPUT'     SET IN/OUTPUT                    00183600
&XBEFOREREQUESTER    SETC  '&BEFOREREQUESTER(1)'  SET XVARIABLE         00183700
                     AIF   (N'&BEFOREREQUESTER GT 1).ZG31B  MULTI PARMS 00183800
&XBEFOREREQUESTER    SETC  '&BEFOREREQUESTER'   SET XVARIABLE           00183900
.ZG31B               AIF   (K'&BEFOREREQUESTER(1) GT 0).ZG31C           00184000
&ZXBEFOREREQUESTER   SETC  ''          RESET IN/OUTPUT                  00184100
&ZMS                 SETC  'WHEN "NO" IS SPECIFIED'                     00184200
&ZMS                 SETC  '&ZMS , "BEFOREREQUESTER" KEY AND ITS'       00184300
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00184400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00184500
.ZG31C               ANOP  ,                                            00184600
.*-------------------------------------------------------------------   00184700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00184800
                     AIF   (K'&ZXBEFOREREQUESTER LE 0).ZG31R  NOT I/O   00184900
                     AIF   ('&XBEFOREREQUESTER'(1,1) NE '(').ZG31R      00185000
&ZCGPR               SETC  '&XBEFOREREQUESTER'(2,K'&XBEFOREREQUESTER-2) 00185100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                 00185200
                     AIF   (K'&ZCGPR GT 2).ZG31Q                        00185300
                     AIF   ('&ZCGPR' EQ '0').ZG31Q                      00185400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00185500
                     AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME    00185600
.ZG31P               ANOP  ,                                            00185700
                     AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC         00185800
                     AIF   ('&ZCGPR' LT '2').ZG31Q                      00185900
                     AIF   ('&ZCGPR' LE '12').ZG31R                     00186000
.ZG31Q               ANOP  ,                                            00186100
&ZMS                 SETC  '"BEFOREREQUESTER='                          00186200
&ZMS                 SETC  '&ZMS.&BEFOREREQUESTER"'                     00186300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00186400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00186500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00186600
.ZG31R               ANOP  ,                                            00186700
.*-------------------------------------------------------------------   00186800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00186900
.ZG33                ANOP  ,                                            00187000
&ZTLC                SETC 'YES'                                         00187100
                     AIF   ('&TOTHEEND(1)' NE '&ZTLC').ZG34             00187200
&XTOTHEEND           SETC  'YES'       SET KEYWORD                      00187300
                     AIF   (N'&TOTHEEND LE 1).ZG33A  CK NUM             00187400
&ZMS                 SETC  '"TOTHEEND='                                 00187500
&ZMS                 SETC  '&ZMS.&TOTHEEND"'                            00187600
&ZMS                 SETC  '&ZMS "TOTHEEND"'                            00187700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00187800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00187900
.ZG33A               ANOP  ,                                            00188000
.*------------------------------------------------------------------    00188100
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00188200
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00188300
.ZG33A0              AIF   (K'&BEFOREREQUESTER LE 0).ZG33A1  OK         00188400
&ZCVAL               SETC '&ZCVAL BEFOREREQUESTER'  INCORRECT KEY USED  00188500
.ZG33A1              AIF   (K'&ZCVAL LE 0).ZG33A2  OK                   00188600
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00188700
&ZMS                 SETC  '"TOTHEEND'                                  00188800
&ZMS                 SETC  '&ZMS.=&TOTHEEND"'                           00188900
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00189000
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00189100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00189200
.ZG33A2              ANOP  ,                                            00189300
.*------------------------------------------------------------------    00189400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00189500
.ZG34                ANOP  ,                                            00189600
&ZXTOTHEEND          SETC  'INPUT'     SET IN/OUTPUT                    00189700
                     AIF   (K'&XTOTHEEND GT 0).ZG34E  VALID ARG         00189800
                     AIF   (T'&TOTHEEND EQ 'O').ZG34D  OMITTED          00189900
&ZASYSLNDX           SETA  0                                            00190000
.ZG34A               ANOP  ,           POSITIONAL MACRO KEY             00190100
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00190200
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG34C             00190300
&ZTLC                SETC 'TOTHEEND'                                    00190400
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG34A    00190500
.ZG34B               ANOP  ,                                            00190600
&ZXTOTHEEND          SETC  ''          RESET IN/OUTPUT                  00190700
&ZMS                 SETC  'THE "TOTHEEND" KEY'                         00190800
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00190900
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00191000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00191100
                     AGO   .ZG34E                                       00191200
.ZG34C               ANOP  ,                                            00191300
&ZXTOTHEEND          SETC  ''          RESET IN/OUTPUT                  00191400
&ZMS                 SETC  '"TOTHEEND='                                 00191500
&ZMS                 SETC  '&ZMS.&TOTHEEND"'                            00191600
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00191700
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00191800
&ZMS                 SETC  '&ZMS "NO"'                                  00191900
&ZMS                 SETC  '&ZMS OR "YES".'                             00192000
                     MNOTE 8,' &ZMS '                                   00192100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00192200
                     AGO   .ZG34E                                       00192300
.ZG34D               ANOP  ,                                            00192400
&XTOTHEEND           SETC  'NO'        SET DEFAULT KEYWORD              00192500
.ZG34E               ANOP  ,                                            00192600
.*------------------------------------------------------------------    00192700
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00192800
.ZG35                ANOP  ,                                            00192900
&ZXREQUEST           SETC  'INPUT'     SET IN/OUTPUT                    00193000
                     AIF   (K'&XREQUEST GT 0).ZG35E  VALID ARG          00193100
                     AIF   (T'&REQUEST EQ 'O').ZG35D  OMITTED           00193200
&ZASYSLNDX           SETA  0                                            00193300
.ZG35A               ANOP  ,           POSITIONAL MACRO KEY             00193400
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00193500
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG35C             00193600
&ZTLC                SETC 'REQUEST'                                     00193700
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG35A    00193800
.ZG35B               ANOP  ,                                            00193900
&ZXREQUEST           SETC  ''          RESET IN/OUTPUT                  00194000
&ZMS                 SETC  'THE "REQUEST" KEY'                          00194100
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00194200
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00194300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00194400
                     AGO   .ZG35E                                       00194500
.ZG35C               ANOP  ,                                            00194600
&ZXREQUEST           SETC  ''          RESET IN/OUTPUT                  00194700
&ZMS                 SETC  '"REQUEST='                                  00194800
&ZMS                 SETC  '&ZMS.&REQUEST"'                             00194900
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00195000
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00195100
&ZMS                 SETC  '&ZMS "SETENQMAX",'                          00195200
&ZMS                 SETC  '&ZMS "RESETENQMAX",'                        00195300
&ZMS                 SETC  '&ZMS OR "MOVEWAITER".'                      00195400
                     MNOTE 8,' &ZMS '                                   00195500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00195600
                     AGO   .ZG35E                                       00195700
.ZG35D               ANOP  ,                                            00195800
&XREQUEST            SETC  'SETENQMAX'          SET DEFAULT KEYWORD     00195900
.ZG35E               ANOP  ,                                            00196000
.*------------------------------------------------------------------    00196100
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00196200
                     AIF   (K'&REQUEST(1) GT 0).ZG35F  PARM             00196300
&XREQUEST            SETC  ''          ENSURE NULL KEYWORD              00196400
&ZXREQUEST           SETC  ''          RESET IN/OUTPUT                  00196500
&ZMS                 SETC  'THE'                                        00196600
&ZMS                 SETC  '&ZMS "REQUEST" KEY AND ITS'                 00196700
&ZMS                 SETC  '&ZMS ARGUMENT ARE REQUIRED.'                00196800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00196900
&ZMS                 SETC  '&ZMS "SETENQMAX",'                          00197000
&ZMS                 SETC  '&ZMS "RESETENQMAX",'                        00197100
&ZMS                 SETC  '&ZMS OR "MOVEWAITER".'                      00197200
                     MNOTE 8,' &ZMS '                                   00197300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00197400
.ZG35F               ANOP  ,                                            00197500
.*----------------------------------------------------------------***   00197600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00197700
                     AIF   (N'&RETCODE LE 1).ZG37A  CK NUM              00197800
&ZMS                 SETC  '"RETCODE='                                  00197900
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00198000
&ZMS                 SETC  '&ZMS "RETCODE"'                             00198100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00198200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00198300
.ZG37A               ANOP  ,                                            00198400
.*-------------------------------------------------------------------   00198500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00198600
                     AIF   (K'&RETCODE(1) LE 0).ZG37C  NO PARM          00198700
&ZXRETCODE           SETC  'OUTPUT'    SET OUTPUT                       00198800
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00198900
                     AIF   (N'&RETCODE GT 1).ZG37C                      00199000
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00199100
.ZG37C               ANOP  ,                                            00199200
.*-------------------------------------------------------------------   00199300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00199400
                     AIF   (K'&ZXRETCODE LE 0).ZG37R  NOT I/O           00199500
                     AIF   ('&XRETCODE'(1,1) NE '(').ZG37R              00199600
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00199700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                 00199800
                     AIF   (K'&ZCGPR GT 2).ZG37Q                        00199900
                     AIF   ('&ZCGPR' EQ '0').ZG37Q                      00200000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00200100
                     AIF   (T'&ZCGPR NE 'N').ZG37Q  INVALID REG NAME    00200200
.ZG37P               ANOP  ,                                            00200300
                     AIF   (T'&ZCGPR NE 'N').ZG37R  NON NUMERIC         00200400
                     AIF   ('&ZCGPR' EQ '15').ZG37R                     00200500
                     AIF   ('&ZCGPR' LT '2').ZG37Q                      00200600
                     AIF   ('&ZCGPR' LE '12').ZG37R                     00200700
.ZG37Q               ANOP  ,                                            00200800
&ZMS                 SETC  '"RETCODE='                                  00200900
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00201000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00201100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'     00201200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00201300
.ZG37R               ANOP  ,                                            00201400
.*----------------------------------------------------------------***   00201500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00201600
                     AIF   (N'&RSNCODE LE 1).ZG40A  CK NUM              00201700
&ZMS                 SETC  '"RSNCODE='                                  00201800
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00201900
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00202000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00202100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00202200
.ZG40A               ANOP  ,                                            00202300
.*-------------------------------------------------------------------   00202400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00202500
                     AIF   (K'&RSNCODE(1) LE 0).ZG40C  NO PARM          00202600
&ZXRSNCODE           SETC  'OUTPUT'    SET OUTPUT                       00202700
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00202800
                     AIF   (N'&RSNCODE GT 1).ZG40C                      00202900
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00203000
.ZG40C               ANOP  ,                                            00203100
.*-------------------------------------------------------------------   00203200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00203300
                     AIF   (K'&ZXRSNCODE LE 0).ZG40R  NOT I/O           00203400
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZG40R              00203500
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00203600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                 00203700
                     AIF   (K'&ZCGPR GT 2).ZG40Q                        00203800
                     AIF   ('&ZCGPR' EQ '0').ZG40R                      00203900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00204000
                     AIF   (T'&ZCGPR NE 'N').ZG40Q  INVALID REG NAME    00204100
.ZG40P               ANOP  ,                                            00204200
                     AIF   (T'&ZCGPR NE 'N').ZG40R  NON NUMERIC         00204300
                     AIF   ('&ZCGPR' EQ '0').ZG40R                      00204400
                     AIF   ('&ZCGPR' LT '2').ZG40Q                      00204500
                     AIF   ('&ZCGPR' LE '12').ZG40R                     00204600
.ZG40Q               ANOP  ,                                            00204700
&ZMS                 SETC  '"RSNCODE='                                  00204800
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00204900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00205000
                     MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'      00205100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00205200
.ZG40R               ANOP  ,                                            00205300
.******************************************************************     00205400
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00205500
.******************************************************************     00205600
                     ACTR  10000                                        00205700
.*----------------------------------------------------------------***   00205800
.***AH.P02 EXTRA POSITIONALS                                            00205900
                     AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS         00206000
                     AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL         00206100
                     AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL     00206200
                     AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL      00206300
.ZGLISTX1            ANOP  ,                                            00206400
&ZCVAL               SETC  ''          ERROR FIELD                      00206500
&ZAWRK               SETA  0           POSITIONAL NUMBER                00206600
.ZGLIST2             ANOP  ,                                            00206700
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00206800
                     AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE         00206900
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00207000
                     AGO   .ZGLIST2                                     00207100
.*                                                                      00207200
.ZGLIST3             ANOP  ,                                            00207300
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00207400
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'                    00207500
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00207600
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00207700
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00207800
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00207900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00208000
.ZGLISTX             ANOP  ,                                            00208100
&ZASYSLNDX           SETA  0                                            00208200
.*-------------------------------------------------------------------   00208300
.***AG.MF04 MF=(SLE)                                                    00208400
.ZGMFX               ANOP  ,           END OF FULL SYNTAX CHECK         00208500
.*******************************************************************    00208600
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00208700
.*******************************************************************    00208800
                     AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED         00208900
.*******************************************************************    00209000
.***AE.01  START OF ISGADMIN MACRO CODE                                 00209100
.*******************************************************************    00209200
                     LCLC  &M0M0001                 NAME                00209300
&M0M0001             SETC  '&XLABEL'                SET NAME            00209400
                     AIF   (K'&XLABEL NE 0).XLAB2                       00209500
&M0M0001             SETC  'M00M&SYSNDX'            DEFAULT NAME        00209600
.*                                                                      00209700
.XLAB2               ANOP  ,                                            00209800
                     AIF   ('&XMF' EQ 'L').XLAB3                        00209900
&M0M0001 DS    0H                             ISGADMIN-2                00210000
.XLAB3               ANOP  ,                                            00210100
.*******************************************************************    00210200
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00210300
.*******************************************************************    00210400
              PUSH  PRINT                                               00210500
                     AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON   00210600
                     PRINT OFF         ++ PR01                          00210700
                     AGO   .ZPRNTXX                                     00210800
.ZPRINTX             PRINT ON                                           00210900
.ZPRNTXX             ANOP  ,                                            00211000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00211100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00211200
.********************************************************************   00211300
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00211400
.********************************************************************   00211500
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00211600
                      LCLA  &ZOPN1         INVOCATION INDEX             00211700
                      LCLC  &ZOPL(4095)    LABEL                        00211800
                      LCLC  &ZOPO(4095)    OPERATION                    00211900
                      LCLC  &ZOPV(4095)    VALUE                        00212000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00212100
.*                                                                      00212200
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00212300
.******************************************************************     00212400
.***AL.L10 ISGADMIN FMT=LIST MF=S!L PARAMETERS                          00212500
.******************************************************************     00212600
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00212700
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00212800
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00212900
&XMFATTR              SETC  '0D'                                        00213000
.*                                                                      00213100
&ZOPN                 SETA  &ZOPN+1                                     00213200
&ZOPL(&ZOPN)          SETC  ' '                                         00213300
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00213400
&ZOPV(&ZOPN)          SETC  '4,8'                                       00213500
&ZOPN                 SETA  &ZOPN+1                                     00213600
&ZOPL(&ZOPN)          SETC  ' '                                         00213700
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00213800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00213900
&ZOPD(&ZOPN)          SETC  '++ ISGADMIN ARG PARMS'                     00214000
.*                                                                      00214100
&ZOPN                 SETA  &ZOPN+1                                     00214200
&ZOPL(&ZOPN)          SETC  ' '                                         00214300
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00214400
&ZOPV(&ZOPN)          SETC  '1'                                         00214500
&ZOPD(&ZOPN)          SETC  ' '                                         00214600
.*                                                                      00214700
.ZLMFSL2              ANOP  ,                                           00214800
.*-------------------------------------------------------------------   00214900
.***AM.L00  ISGADMIN FMT=LIST name                                      00215000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00215100
&ZOPN                 SETA &ZOPN+1                                      00215200
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00215300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00215400
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00215500
&ZOPD(&ZOPN)          SETC '++ ISGADMIN NAME'                           00215600
.ZLMFSL2M             ANOP  ,                                           00215700
.*-------------------------------------------------------------------   00215800
.***AM.L01  ISGADMIN FMT=LIST PARAMETERS                                00215900
&ZOPN                 SETA &ZOPN+1                                      00216000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00216100
&ZOPO(&ZOPN)          SETC 'DS'                                         00216200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00216300
&ZOPD(&ZOPN)          SETC '++ ISGADMIN PARM LIST'                      00216400
.*-------------------------------------------------------------------   00216500
.***AM.L02 XVERSION XL1                                                 00216600
&ZOPN                 SETA &ZOPN+1                                      00216700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00216800
&ZOPO(&ZOPN)          SETC 'DS'                                         00216900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00217000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00217100
.*-------------------------------------------------------------------   00217200
.***AM.L05 XREQUEST XL1                                                 00217300
&ZOPN                 SETA &ZOPN+1                                      00217400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00217500
&ZOPO(&ZOPN)          SETC 'DS'                                         00217600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00217700
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00217800
.*                                                                      00217900
&ZOPN                 SETA  &ZOPN+1                                     00218000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_SETENQMAX'              00218100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00218200
&ZOPV(&ZOPN)          SETC  '1'                                         00218300
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00218400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SETENQMAX'                    00218500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00218600
.*                                                                      00218700
&ZOPN                 SETA  &ZOPN+1                                     00218800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_RESETENQMAX'            00218900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00219000
&ZOPV(&ZOPN)          SETC  '2'                                         00219100
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00219200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RESETENQMAX'                  00219300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00219400
.*                                                                      00219500
&ZOPN                 SETA  &ZOPN+1                                     00219600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_MOVEWAITER'             00219700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00219800
&ZOPV(&ZOPN)          SETC  '3'                                         00219900
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00220000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MOVEWAITER'                   00220100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00220200
.*-------------------------------------------------------------------   00220300
.***AM.L03 XFLAGS1 BL.8                                                 00220400
&ZOPN                 SETA &ZOPN+1                                      00220500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS1'                          00220600
&ZOPO(&ZOPN)          SETC 'DS'                                         00220700
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00220800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00220900
.*                                                                      00221000
&ZOPN                 SETA  &ZOPN+1                                     00221100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMAXTYPE_AUTHORIZED'             00221200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00221300
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00221400
&ZOPD(&ZOPN)          SETC  '++ XMAXTYPE.'                              00221500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).AUTHORIZED'                   00221600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00221700
.*                                                                      00221800
&ZOPN                 SETA  &ZOPN+1                                     00221900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTOTHEEND_YES'                   00222000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00222100
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00222200
&ZOPD(&ZOPN)          SETC  '++ XTOTHEEND.'                             00222300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00222400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00222500
.*                                                                      00222600
&ZOPN                 SETA  &ZOPN+1                                     00222700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XNEWCONTROL_SHARED'              00222800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00222900
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00223000
&ZOPD(&ZOPN)          SETC  '++ XNEWCONTROL.'                           00223100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SHARED'                       00223200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00223300
.*-------------------------------------------------------------------   00223400
.***AM.L09  XRSV0003 CL1                                                00223500
&ZOPN                 SETA &ZOPN+1                                      00223600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00223700
&ZOPO(&ZOPN)          SETC 'DS'                                         00223800
&ZOPV(&ZOPN)          SETC 'CL1'                                        00223900
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00224000
.*-------------------------------------------------------------------   00224100
.***AM.L09  XMAXVALUE F                                                 00224200
&ZOPN                 SETA &ZOPN+1                                      00224300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMAXVALUE'                        00224400
&ZOPO(&ZOPN)          SETC 'DS'                                         00224500
&ZOPV(&ZOPN)          SETC 'F'                                          00224600
&ZOPD(&ZOPN)          SETC '++ &ZXMAXVALUE '                            00224700
.*-------------------------------------------------------------------   00224800
.***AM.L09  XRSVNNNN CL8                                                00224900
&ZOPN                 SETA &ZOPN+1                                      00225000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVNNNN'                         00225100
&ZOPO(&ZOPN)          SETC 'DS'                                         00225200
&ZOPV(&ZOPN)          SETC 'CL8'                                        00225300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00225400
.*-------------------------------------------------------------------   00225500
.***AM.MLM2 SAVED LOCATION COUNTER                                      00225600
                      AIF  (&XPLISTVER GE 2).ZL12LA                     00225700
                      AIF  ('&ZENDBASEPL' NE '').ZL12LA                 00225800
&ZENDBASEPL           SETC 'YES'                                        00225900
&ZOPN                 SETA &ZOPN+1                                      00226000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00226100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00226200
&ZOPV(&ZOPN)          SETC '*'                                          00226300
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00226400
.ZL12LA               ANOP  ,                                           00226500
.*-------------------------------------------------------------------   00226600
.***AM.LVER1                                                            00226700
                      AIF  (&XPLISTVER LT 2).ZL12L                      00226800
.*-------------------------------------------------------------------   00226900
.*-------------------------------------------------------------------   00227000
.***AM.L09 ADDR3164 XMOVINGWAITER AD                                    00227100
&ZOPN                 SETA &ZOPN+1                                      00227200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMOVINGWAITER_ADDR3164'           00227300
&ZOPO(&ZOPN)          SETC 'DS'                                         00227400
&ZOPV(&ZOPN)          SETC 'AD'                                         00227500
&ZOPD(&ZOPN)          SETC '++ &ZXMOVINGWAITER ADDR3164'                00227600
.*-------------------------------------------------------------------   00227700
.***AM.LVER2                                                            00227800
.ZL12L                ANOP  ,                                           00227900
.*-------------------------------------------------------------------   00228000
.*-------------------------------------------------------------------   00228100
.***AM.LVER1                                                            00228200
                      AIF  (&XPLISTVER LT 2).ZL13L                      00228300
.*-------------------------------------------------------------------   00228400
.*-------------------------------------------------------------------   00228500
.***AM.L09 ADDR3164 XBEFOREREQUESTER AD                                 00228600
&ZOPN                 SETA &ZOPN+1                                      00228700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBEFOREREQUESTER_ADDR3164'        00228800
&ZOPO(&ZOPN)          SETC 'DS'                                         00228900
&ZOPV(&ZOPN)          SETC 'AD'                                         00229000
&ZOPD(&ZOPN)          SETC '++ &ZXBEFOREREQUESTER ADDR3164'             00229100
.*-------------------------------------------------------------------   00229200
.***AM.LVER2                                                            00229300
.ZL13L                ANOP  ,                                           00229400
.*-------------------------------------------------------------------   00229500
.*-------------------------------------------------------------------   00229600
.***AM.LVER1                                                            00229700
                      AIF  (&XPLISTVER LT 2).ZL14L                      00229800
.*-------------------------------------------------------------------   00229900
.*-------------------------------------------------------------------   00230000
.***AM.L09 ALET XMOVINGWAITER F                                         00230100
&ZOPN                 SETA &ZOPN+1                                      00230200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMOVINGWAITER_ALET'               00230300
&ZOPO(&ZOPN)          SETC 'DS'                                         00230400
&ZOPV(&ZOPN)          SETC 'F'                                          00230500
&ZOPD(&ZOPN)          SETC '++ &ZXMOVINGWAITER ALET'                    00230600
.*-------------------------------------------------------------------   00230700
.***AM.LVER2                                                            00230800
.ZL14L                ANOP  ,                                           00230900
.*-------------------------------------------------------------------   00231000
.*-------------------------------------------------------------------   00231100
.***AM.LVER1                                                            00231200
                      AIF  (&XPLISTVER LT 2).ZL15L                      00231300
.*-------------------------------------------------------------------   00231400
.*-------------------------------------------------------------------   00231500
.***AM.L09 ALET XBEFOREREQUESTER F                                      00231600
&ZOPN                 SETA &ZOPN+1                                      00231700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBEFOREREQUESTER_ALET'            00231800
&ZOPO(&ZOPN)          SETC 'DS'                                         00231900
&ZOPV(&ZOPN)          SETC 'F'                                          00232000
&ZOPD(&ZOPN)          SETC '++ &ZXBEFOREREQUESTER ALET'                 00232100
.*-------------------------------------------------------------------   00232200
.***AM.LVER2                                                            00232300
.ZL15L                ANOP  ,                                           00232400
.*-------------------------------------------------------------------   00232500
.*-------------------------------------------------------------------   00232600
.***AM.L10 END OF ISGADMIN LIST PARAMETERS                              00232700
&ZOPN                 SETA &ZOPN+1                                      00232800
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00232900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00233000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00233100
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00233200
.*                                                                      00233300
&ZOPN                 SETA &ZOPN+1                                      00233400
&ZOPL(&ZOPN)          SETC ' '                                          00233500
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00233600
&ZOPV(&ZOPN)          SETC '1'                                          00233700
&ZOPD(&ZOPN)          SETC ' '                                          00233800
.*-------------------------------------------------------------------   00233900
.***AL.L12 ISGADMIN FMT=LIST MF=S!L PARAMETERS                          00234000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00234100
.*                                                                      00234200
&ZOPN                 SETA  &ZOPN+1                                     00234300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00234400
&ZOPO(&ZOPN)          SETC  'DC'                                        00234500
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00234600
&ZOPD(&ZOPN)          SETC  '++ ISGADMIN ARG PARMS'                     00234700
.*                                                                      00234800
.ZLMFSLX              ANOP  ,                                           00234900
.*-------------------------------------------------------------------   00235000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00235100
&ZPLLEN               SETA 16                                           00235200
.*                                                                      00235300
                      AIF  (&XPLISTVER LT 2).ZLLEN2Z                    00235400
&ZPLLEN               SETA 40                                           00235500
.ZLLEN2Z              ANOP  ,                                           00235600
.*                                                                      00235700
.******************************************************************     00235800
.***AI.L01 ISGADMIN FMT=LIST FILL IN PARAMETER AREA                     00235900
.******************************************************************     00236000
                      ACTR  10000                                       00236100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00236200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00236300
&ZCVAL                SETC  'LAE'          XAX MODE                     00236400
.ZIMFXA               ANOP ,                                            00236500
.*                                                                      00236600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00236700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00236800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00236900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00237000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00237100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00237200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00237300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00237400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00237500
&ZOPN                 SETA  &ZOPN+1                                     00237600
&ZOPL(&ZOPN)          SETC  ' '                                         00237700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00237800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00237900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00238000
                      AGO   .ZIMFNX                                     00238100
.*                                                                      00238200
.ZIMFN2               ANOP ,                                            00238300
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00238400
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00238500
&ZOPN                 SETA  &ZOPN+1                                     00238600
&ZOPL(&ZOPN)          SETC  ' '                                         00238700
&ZOPO(&ZOPN)          SETC  'LAE'                                       00238800
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00238900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00239000
                      AGO   .ZIMFNX                                     00239100
.ZIMFNX1              ANOP ,                                            00239200
&ZOPN                 SETA  &ZOPN+1                                     00239300
&ZOPL(&ZOPN)          SETC  ' '                                         00239400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00239500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00239600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00239700
.ZIMFNX               ANOP ,                                            00239800
.********************************************************************   00239900
.***AI.L02 ISGADMIN FMT=LIST INITIALIZE PARAMETER AREA                  00240000
.********************************************************************   00240100
.***AI.L03 MF=(SLE)                                                     00240200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00240300
.*                                                                      00240400
&ZOPN                 SETA  &ZOPN+1                                     00240500
&ZOPL(&ZOPN)          SETC  ' '                                         00240600
&ZOPO(&ZOPN)          SETC  'XC'                                        00240700
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00240800
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00240900
.ZIMFLX               ANOP  ,                                           00241000
.*-------------------------------------------------------------------   00241100
.***AI.L04A XVERSION XL1                                                00241200
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00241300
&ZOPN                 SETA  &ZOPN+1                                     00241400
&ZOPL(&ZOPN)          SETC  ' '                                         00241500
&ZOPO(&ZOPN)          SETC  'MVI'                                       00241600
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00241700
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00241800
.ZIMFVW               ANOP  ,                                           00241900
.*-------------------------------------------------------------------   00242000
.***AI.L07 XREQUEST AL1                                                 00242100
&ZW                   SETC  ''                                          00242200
.*-------------------------------------------------------------------   00242300
.***AI.L15 XREQUEST "SETENQMAX" AL1                                     00242400
         AIF   ('&XREQUEST' NE 'SETENQMAX').ZI3A                        00242500
&ZW                   SETC  '1'                                         00242600
.ZI3A                 ANOP  ,                                           00242700
.*-------------------------------------------------------------------   00242800
.***AI.L15 XREQUEST "RESETENQMAX" AL1                                   00242900
         AIF   ('&XREQUEST' NE 'RESETENQMAX').ZI4A                      00243000
&ZW                   SETC  '2'                                         00243100
.ZI4A                 ANOP  ,                                           00243200
.*-------------------------------------------------------------------   00243300
.***AI.L15 XREQUEST "MOVEWAITER" AL1                                    00243400
         AIF   ('&XREQUEST' NE 'MOVEWAITER').ZI5A                       00243500
&ZW                   SETC  '3'                                         00243600
.ZI5A                 ANOP  ,                                           00243700
.*-------------------------------------------------------------------   00243800
.***AI.L17 XREQUEST AL1                                                 00243900
                      AIF   ('&ZW' EQ '0').ZI5B                         00244000
                      AIF   ('&ZW' EQ '').ZI5B                          00244100
.*                                                                      00244200
&ZOPN                 SETA  &ZOPN+1                                     00244300
&ZOPL(&ZOPN)          SETC  ' '                                         00244400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00244500
&ZOPV(&ZOPN)          SETC  '1(1),&ZW'                                  00244600
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00244700
.ZI5B                 ANOP  ,                                           00244800
.*-------------------------------------------------------------------   00244900
.***AI.L05 XFLAGS1 BL1                                                  00245000
&ZW                   SETC  ''                                          00245100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00245200
.*-------------------------------------------------------------------   00245300
.***AI.L08 XFLAGS1 "AUTHORIZED"                                         00245400
.***      BL1'1XXXXXXX'                                                 00245500
         AIF   ('&XMAXTYPE' NE 'AUTHORIZED').ZI7A                       00245600
&ZW                   SETC  '&ZW.1'                                     00245700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00245800
                      AGO   .ZI7C                                       00245900
.*                                                                      00246000
.ZI7A                 ANOP  ,                                           00246100
&ZW                   SETC  '&ZW.0'                                     00246200
.ZI7C                 ANOP  ,                                           00246300
.*-------------------------------------------------------------------   00246400
.***AI.L08 XFLAGS1 "YES"                                                00246500
.***      BL1'X1XXXXXX'                                                 00246600
         AIF   ('&XTOTHEEND' NE 'YES').ZI8A                             00246700
&ZW                   SETC  '&ZW.1'                                     00246800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00246900
                      AGO   .ZI8C                                       00247000
.*                                                                      00247100
.ZI8A                 ANOP  ,                                           00247200
&ZW                   SETC  '&ZW.0'                                     00247300
.ZI8C                 ANOP  ,                                           00247400
.*-------------------------------------------------------------------   00247500
.***AI.L08 XFLAGS1 "SHARED"                                             00247600
.***      BL1'XX1XXXXX'                                                 00247700
         AIF   ('&XNEWCONTROL' NE 'SHARED').ZI9A                        00247800
&ZW                   SETC  '&ZW.100000'                                00247900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00248000
                      AGO   .ZI9C                                       00248100
.*                                                                      00248200
.ZI9A                 ANOP  ,                                           00248300
&ZW                   SETC  '&ZW.000000'                                00248400
.ZI9C                 ANOP  ,                                           00248500
.*-------------------------------------------------------------------   00248600
.***AI.L11 XFLAGS1 BL1                                                  00248700
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00248800
&ZOPN                 SETA  &ZOPN+1                                     00248900
&ZOPL(&ZOPN)          SETC  ' '                                         00249000
&ZOPO(&ZOPN)          SETC  'OI'                                        00249100
&ZOPV(&ZOPN)          SETC  '2(1),B''&ZW'''                             00249200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00249300
.ZI9E                 ANOP  ,                                           00249400
.*-------------------------------------------------------------------   00249500
.***AI.L25  XMAXVALUE F                                                 00249600
                      AIF   ('&ZXMAXVALUE' EQ '').ZI11E                 00249700
                      AIF   ('&ZXMAXVALUE' EQ 'OUTPUT').ZI11E           00249800
&ZCGPR                SETC  '&XMAXVALUE'                                00249900
.*                                                                      00250000
                      AIF   ('&XMAXVALUE'(1,1) NE '(').ZI11B            00250100
&ZCGPR   SETC  '0('.'&XMAXVALUE'(2,K'&XMAXVALUE-2).')'                  00250200
                      AGO   .ZI11D                                      00250300
.ZI11B                ANOP  ,                                           00250400
.*                                                                      00250500
&ZC                   SETC  '&XMAXVALUE'(1,1)                           00250600
                      AIF   (T'&ZC NE 'N').ZI11D                        00250700
&ZC                   SETC  '&XMAXVALUE'                                00250800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00250900
&ZCGPR                SETC  '=FL4''&XMAXVALUE'''                        00251000
.*                                                                      00251100
.ZI11D                ANOP  ,                                           00251200
.*                                                                      00251300
&ZOPN                 SETA  &ZOPN+1                                     00251400
&ZOPL(&ZOPN)          SETC  ' '                                         00251500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00251600
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00251700
&ZOPD(&ZOPN)          SETC  '++ &ZXMAXVALUE XMAXVALUE'                  00251800
.*                                                                      00251900
.ZI11E                ANOP  ,                                           00252000
.*-------------------------------------------------------------------   00252100
.***AI.LVER01                                                           00252200
                      AIF  (&XPLISTVER LT 2).ZI13Z                      00252300
.*-------------------------------------------------------------------   00252400
.***AI.L19 ADDR3164 XMOVINGWAITER AD                                    00252500
                      AIF   ('&ZXMOVINGWAITER' EQ '').ZI13H             00252600
&ZCLNG                SETC  '&XMOVINGWAITER'                            00252700
&ZCGPR                SETC  '14'                                        00252800
         AIF   ('&XMOVINGWAITER'(1,1) EQ '(').ZI13F  IN GPR             00252900
.*                                                                      00253000
&ZOPN                 SETA  &ZOPN+1                                     00253100
&ZOPL(&ZOPN)          SETC  ' '                                         00253200
&ZOPO(&ZOPN)          SETC  'LA'                                        00253300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00253400
&ZOPD(&ZOPN)          SETC  '++ &ZXMOVINGWAITER XMOVINGWAITER'          00253500
.*                                                                      00253600
                      AGO   .ZI13G                                      00253700
.*                                                                      00253800
.ZI13F                ANOP  ,                                           00253900
&ZCGPR   SETC  '&XMOVINGWAITER'(2,K'&XMOVINGWAITER-2)                   00254000
.*                                                                      00254100
.ZI13G                ANOP  ,                                           00254200
                      AIF   ('&SYSAM64' EQ 'YES').ZI13H1A               00254300
.*                                                                      00254400
&ZOPN                 SETA  &ZOPN+1                                     00254500
&ZOPL(&ZOPN)          SETC  ' '                                         00254600
&ZOPO(&ZOPN)          SETC  'ST'                                        00254700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+16(,1)'                           00254800
&ZOPD(&ZOPN)          SETC  '++ &ZXMOVINGWAITER XMOVINGWAITER'          00254900
.*                                                                      00255000
                      AGO   .ZI13H                                      00255100
.ZI13H1A              ANOP  ,                                           00255200
.*                                                                      00255300
&ZOPN                 SETA  &ZOPN+1                                     00255400
&ZOPL(&ZOPN)          SETC  ' '                                         00255500
&ZOPO(&ZOPN)          SETC  'STG'                                       00255600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00255700
&ZOPD(&ZOPN)          SETC  '++ &ZXMOVINGWAITER XMOVINGWAITER'          00255800
.*                                                                      00255900
.ZI13H                ANOP  ,                                           00256000
.*-------------------------------------------------------------------   00256100
.***AI.LVER02                                                           00256200
.ZI13Z                ANOP  ,                                           00256300
.*-------------------------------------------------------------------   00256400
.***AI.LVER01                                                           00256500
                      AIF  (&XPLISTVER LT 2).ZI14Z                      00256600
.*-------------------------------------------------------------------   00256700
.***AI.L19 ADDR3164 XBEFOREREQUESTER AD                                 00256800
                      AIF   ('&ZXBEFOREREQUESTER' EQ '').ZI14H          00256900
&ZCLNG                SETC  '&XBEFOREREQUESTER'                         00257000
&ZCGPR                SETC  '14'                                        00257100
         AIF   ('&XBEFOREREQUESTER'(1,1) EQ '(').ZI14F  IN GPR          00257200
.*                                                                      00257300
&ZOPN                 SETA  &ZOPN+1                                     00257400
&ZOPL(&ZOPN)          SETC  ' '                                         00257500
&ZOPO(&ZOPN)          SETC  'LA'                                        00257600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00257700
&ZOPD(&ZOPN)          SETC  '++ &ZXBEFOREREQUESTER XBEFOREREQUESTER'    00257800
.*                                                                      00257900
                      AGO   .ZI14G                                      00258000
.*                                                                      00258100
.ZI14F                ANOP  ,                                           00258200
&ZCGPR   SETC  '&XBEFOREREQUESTER'(2,K'&XBEFOREREQUESTER-2)             00258300
.*                                                                      00258400
.ZI14G                ANOP  ,                                           00258500
                      AIF   ('&SYSAM64' EQ 'YES').ZI14H1A               00258600
.*                                                                      00258700
&ZOPN                 SETA  &ZOPN+1                                     00258800
&ZOPL(&ZOPN)          SETC  ' '                                         00258900
&ZOPO(&ZOPN)          SETC  'ST'                                        00259000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+24(,1)'                           00259100
&ZOPD(&ZOPN)          SETC  '++ &ZXBEFOREREQUESTER XBEFOREREQUESTER'    00259200
.*                                                                      00259300
                      AGO   .ZI14H                                      00259400
.ZI14H1A              ANOP  ,                                           00259500
.*                                                                      00259600
&ZOPN                 SETA  &ZOPN+1                                     00259700
&ZOPL(&ZOPN)          SETC  ' '                                         00259800
&ZOPO(&ZOPN)          SETC  'STG'                                       00259900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,24(,1)'                             00260000
&ZOPD(&ZOPN)          SETC  '++ &ZXBEFOREREQUESTER XBEFOREREQUESTER'    00260100
.*                                                                      00260200
.ZI14H                ANOP  ,                                           00260300
.*-------------------------------------------------------------------   00260400
.***AI.LVER02                                                           00260500
.ZI14Z                ANOP  ,                                           00260600
.*-------------------------------------------------------------------   00260700
.***AI.LVER01                                                           00260800
                      AIF  (&XPLISTVER LT 2).ZI15Z                      00260900
.*-------------------------------------------------------------------   00261000
.***AI.L23 ALET XMOVINGWAITER F                                         00261100
         AIF   ('&ZXMOVINGWAITER' EQ '').ZI15G                          00261200
         AIF   ('&SYSASCE' EQ 'P').ZI15G   SYSSTATE PRIMARY             00261300
&ZCLNG                SETC  '&XMOVINGWAITER'                            00261400
         AIF   ('&XMOVINGWAITER'(1,1) EQ '(').ZI15E  IN AR              00261500
.*                                                                      00261600
&ZCGPR                SETC  '14'                                        00261700
&ZOPN                 SETA  &ZOPN+1                                     00261800
&ZOPL(&ZOPN)          SETC  ' '                                         00261900
&ZOPO(&ZOPN)          SETC  'LAE'                                       00262000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00262100
&ZOPD(&ZOPN)          SETC  '++ &ZXMOVINGWAITER XMOVINGWAITER'          00262200
                      AGO   .ZI15F                                      00262300
.*                                                                      00262400
.ZI15E                ANOP  ,                                           00262500
&ZCGPR   SETC  '&XMOVINGWAITER'(2,K'&XMOVINGWAITER-2)                   00262600
.*                                                                      00262700
.ZI15F                ANOP  ,                                           00262800
.*                                                                      00262900
&ZOPN                 SETA  &ZOPN+1                                     00263000
&ZOPL(&ZOPN)          SETC  ' '                                         00263100
&ZOPO(&ZOPN)          SETC  'STAM'                                      00263200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,32(1)'                       00263300
&ZOPD(&ZOPN)          SETC  '++ &ZXMOVINGWAITER XMOVINGWAITER'          00263400
.*                                                                      00263500
.ZI15G                ANOP  ,                                           00263600
.*-------------------------------------------------------------------   00263700
.***AI.LVER02                                                           00263800
.ZI15Z                ANOP  ,                                           00263900
.*-------------------------------------------------------------------   00264000
.***AI.LVER01                                                           00264100
                      AIF  (&XPLISTVER LT 2).ZI16Z                      00264200
.*-------------------------------------------------------------------   00264300
.***AI.L23 ALET XBEFOREREQUESTER F                                      00264400
         AIF   ('&ZXBEFOREREQUESTER' EQ '').ZI16G                       00264500
         AIF   ('&SYSASCE' EQ 'P').ZI16G   SYSSTATE PRIMARY             00264600
&ZCLNG                SETC  '&XBEFOREREQUESTER'                         00264700
         AIF   ('&XBEFOREREQUESTER'(1,1) EQ '(').ZI16E  IN AR           00264800
.*                                                                      00264900
&ZCGPR                SETC  '14'                                        00265000
&ZOPN                 SETA  &ZOPN+1                                     00265100
&ZOPL(&ZOPN)          SETC  ' '                                         00265200
&ZOPO(&ZOPN)          SETC  'LAE'                                       00265300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00265400
&ZOPD(&ZOPN)          SETC  '++ &ZXBEFOREREQUESTER XBEFOREREQUESTER'    00265500
                      AGO   .ZI16F                                      00265600
.*                                                                      00265700
.ZI16E                ANOP  ,                                           00265800
&ZCGPR   SETC  '&XBEFOREREQUESTER'(2,K'&XBEFOREREQUESTER-2)             00265900
.*                                                                      00266000
.ZI16F                ANOP  ,                                           00266100
.*                                                                      00266200
&ZOPN                 SETA  &ZOPN+1                                     00266300
&ZOPL(&ZOPN)          SETC  ' '                                         00266400
&ZOPO(&ZOPN)          SETC  'STAM'                                      00266500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,36(1)'                       00266600
&ZOPD(&ZOPN)          SETC  '++ &ZXBEFOREREQUESTER XBEFOREREQUESTER'    00266700
.*                                                                      00266800
.ZI16G                ANOP  ,                                           00266900
.*-------------------------------------------------------------------   00267000
.***AI.LVER02                                                           00267100
.ZI16Z                ANOP  ,                                           00267200
.*-------------------------------------------------------------------   00267300
&ZOPN1                SETA &ZOPN                                        00267400
.*******************************************************************    00267500
.***  PROCESS ISGADMIN OUTPUT PARAMETERS                                00267600
.*******************************************************************    00267700
                      ACTR  10000                                       00267800
.*******************************************************************    00267900
.***AO.X02  RETURN CODE PROCESSING                                      00268000
.*******************************************************************    00268100
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00268200
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00268300
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00268400
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00268500
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00268600
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00268700
&ZOPN                 SETA  &ZOPN+1                                     00268800
&ZOPL(&ZOPN)          SETC  ' '                                         00268900
&ZOPO(&ZOPN)          SETC  'ST'                                        00269000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00269100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00269200
                      AGO   .ZMRETX                                     00269300
.*                                                                      00269400
.ZMRET2               ANOP  ,                                           00269500
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00269600
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00269700
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00269800
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00269900
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00270000
&ZOPN                 SETA  &ZOPN+1                                     00270100
&ZOPL(&ZOPN)          SETC  ' '                                         00270200
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00270300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00270400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00270500
.ZMRETX               ANOP  ,                                           00270600
.*******************************************************************    00270700
.***AO.X03  REASON CODE PROCESSING                                      00270800
.*******************************************************************    00270900
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00271000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00271100
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00271200
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00271300
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00271400
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00271500
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00271600
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00271700
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00271800
&ZOPN                 SETA  &ZOPN+1                                     00271900
&ZOPL(&ZOPN)          SETC  ' '                                         00272000
&ZOPO(&ZOPN)          SETC  'ST'                                        00272100
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00272200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00272300
                      AGO   .ZMRSNX                                     00272400
.*                                                                      00272500
.ZMRSN2               ANOP  ,                                           00272600
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00272700
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00272800
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00272900
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00273000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00273100
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00273200
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00273300
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00273400
&ZOPN                 SETA  &ZOPN+1                                     00273500
&ZOPL(&ZOPN)          SETC  ' '                                         00273600
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00273700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00273800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00273900
.ZMRSNX               ANOP  ,                                           00274000
.*******************************************************************    00274100
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00274200
.*******************************************************************    00274300
.ZMFLX                ANOP  ,              MF=L PROCESSING              00274400
.*******************************************************************    00274500
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00274600
.*******************************************************************    00274700
                      ACTR  10000                                       00274800
.*                                                                      00274900
                      LCLA  &ZLC           COLUMN POSITION              00275000
                      LCLA  &ZOPX          LIST TABLE INDEX             00275100
                      LCLC  &ZLL           LABEL                        00275200
                      LCLC  &ZLOP          OPERATION                    00275300
                      LCLC  &ZLV           VALUE                        00275400
                      LCLC  &ZLD           DESCRIPTION                  00275500
.*                                                                      00275600
&ZOPX                 SETA  1                                           00275700
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00275800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00275900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00276000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00276100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00276200
                      AIF   (K'&ZLD LE 0).ZL5                           00276300
&ZLC                  SETA  35             COMMENT COLUMN               00276400
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00276500
&ZLC                  SETA  33             COMMMENT COLUMN              00276600
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00276700
&ZLV                  SETC  '&ZLV'.' '                                  00276800
                      AGO   .ZL3                                        00276900
.*                                                                      00277000
.ZL4                  ANOP  ,                                           00277100
&ZLV                  SETC  '&ZLV'.' '                                  00277200
.ZL5                  ANOP  ,                                           00277300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00277400
.*                                                                      00277500
&ZLL     &ZLOP &ZLV                                                     00277600
.*                                                                      00277700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00277800
                      AGO   .ZL2           CONTINUE LOOPING             00277900
.*                                                                      00278000
.ZLX                  ANOP  ,                                           00278100
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00278200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00278300
         AIF   ('&SYSAM64' EQ 'YES').ZLOADCVT64                         00278400
         LA    14,X'0000011C'                                           00278500
         AGO .ZENDLOADCVT                                               00278600
.ZLOADCVT64 ANOP ,                                                      00278700
         LA  14,X'000000000000011C'                                     00278800
.ZENDLOADCVT ANOP ,                                                     00278900
         PC    0(14)                                                    00279000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00279100
.ZLINKX               ANOP  ,                                           00279200
.*******************************************************************    00279300
.***AP.X01  FORMAT GENERATED CODE                                       00279400
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00279500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00279600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00279700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00279800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00279900
                      AIF   (K'&ZLD LE 0).ZL51                          00280000
&ZLC                  SETA  35             COMMENT COLUMN               00280100
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00280200
&ZLC                  SETA  33             COMMENT COLUMN               00280300
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00280400
&ZLV                  SETC  '&ZLV'.' '                                  00280500
                      AGO   .ZL31                                       00280600
.*                                                                      00280700
.ZL41                 ANOP  ,                                           00280800
&ZLV                  SETC  '&ZLV'.' '                                  00280900
.ZL51                 ANOP  ,                                           00281000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00281100
.*                                                                      00281200
&ZLL     &ZLOP &ZLV                                                     00281300
.*                                                                      00281400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00281500
                      AGO   .ZL21          CONTINUE LOOPING             00281600
.*                                                                      00281700
.ZLX1                 ANOP  ,                                           00281800
.*******************************************************************    00281900
.***AP.X02  END OF ISGADMIN MACRO                                       00282000
&ZISGADMIN            SETC  'YES'          SET ISGADMIN USED            00282100
         POP   PRINT                                                    00282200
*                                            ISGADMIN-2                 00282300
         SPACE 1                                                        00282400
.ZLX2                 ANOP  ,                                           00282500
         MEND                                                           00282600
**********************************************************************/ 00282700
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00282800
*%ISGADMIN: MACRO KEYS(REQUEST,MAXTYPE,MAXVALUE,MOVINGWAITER,           00282900
*                 NEWCONTROL,TOTHEEND,BEFOREREQUESTER,RETCODE,RSNCODE,  00283000
*                 PLISTVER,MF);                                         00283100
*  ANS('?'!!MACLABEL!!' '!!'ISGADMIP '!!MACLIST!!                       00283200
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00283300
*%END ISGADMIN;                                                         00283400

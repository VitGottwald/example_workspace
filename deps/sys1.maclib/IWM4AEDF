*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWM4AEDF                              -01/31/13-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  WLM Define Dynamic Application Environments   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2005, 2013                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7790                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IWM4AEDF service defines dynamic application environments  * 00002100
*      to WLM. The service can be used by queue manager address       * 00002200
*      spaces to add new application environments after they          * 00002300
*      connected to WLM and to delete the dynamic application         * 00002400
*      environments before they disconnect from WLM.                  * 00002500
*                                                                     * 00002600
*      Furthermore, the service can be used to define the method how  * 00002700
*      server spaces should be resumed for static and dynamic         * 00002800
*      application environments.                                      * 00002900
*                                                                     * 00003000
*      Before using this service, the caller must connect to WLM      * 00003100
*      using the IWM4CON service, specifying Work_Manager=Yes, and    * 00003200
*      Queue_Manager=Yes.                                             * 00003300
*                                                                     * 00003400
*      Refer to z/OS MVS Workload Management Services for more        * 00003500
*      information.                                                   * 00003600
*                                                                     * 00003700
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003800
*                                                                     * 00003900
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004000
*                                                                     * 00004100
*01* ENVIRONMENT:                                                     * 00004200
*                                                                     * 00004300
*                                                                     * 00004400
*      Minimum authorization: Supervisor state or program key mask    * 00004500
*                        (PKM) allowing keys 0-7.                     * 00004600
*                                                                     * 00004700
*      Dispatchable unit mode: Task or SRB mode.                      * 00004800
*                                                                     * 00004900
*      Cross Memory Mode: Any HASN, any SASN.  PASN must be the       * 00005000
*                        address space which connected to WLM (i.e.   * 00005100
*                        the address space that was home when IWM4CON * 00005200
*                        was issued for Queue_Manager=Yes, or         * 00005300
*                        Server_Manager=Yes with Server_Type=Queue).  * 00005400
*                                                                     * 00005500
*      AMODE:            31- or 64-bit.                               * 00005600
*                                                                     * 00005700
*      ASC mode:         Primary.                                     * 00005800
*                                                                     * 00005900
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006000
*                                                                     * 00006100
*      Locks:            No locks held.                               * 00006200
*                                                                     * 00006300
*      Control parameters: Control parameters must be in the primary  * 00006400
*                        address space.                               * 00006500
*                                                                     * 00006600
*                                                                     * 00006700
*                                                                     * 00006800
*01* PROGRAMMING REQUIREMENTS:                                        * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*    1.  The macro CVT must be included to use this macro.            * 00007200
*                                                                     * 00007300
*    2.  The macro IWMYCON must be included to use this macro.        * 00007400
*                                                                     * 00007500
*    3.  The macro IWMPB must be in the library concatenation, since  * 00007600
*        it is included by IWMYCON.                                   * 00007700
*                                                                     * 00007800
*    4.  Note that the high order halfword of register 0, and the     * 00007900
*        reason code variable when specified, may be non-zero and     * 00008000
*        represents diagnostic data which is NOT part of the external * 00008100
*        interface.  The high order halfword should thus be excluded  * 00008200
*        from comparison with the reason code values described above. * 00008300
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00008400
*        be used for this purpose.                                    * 00008500
*                                                                     * 00008600
*    5.  All character data, unless otherwise specified, is assumed   * 00008700
*        to be left justified and padded with blanks on the right, as * 00008800
*        needed, to occupy the specified number of bytes.             * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*01* RESTRICTIONS:                                                    * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*    1.  This macro may not be used prior to the completion of WLM    * 00009600
*        address space initialization.                                * 00009700
*                                                                     * 00009800
*    2.  This macro may only be used on MVS/ESA HBB7705 or higher.    * 00009900
*                                                                     * 00010000
*    3.  FUNC=MODIFY and FUNC=ADD together with DISTRIBUTED_WORK may  * 00010100
*        only be used on MVS/ESA HBB7707 or higher.                   * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*                                                                     * 00010500
*01* INPUT REGISTER INFORMATION:                                      * 00010600
*                                                                     * 00010700
*    Before issuing the IWM4AEDF macro, the caller does not have to   * 00010800
*    place any information into any register unless using it in       * 00010900
*    register notation for a particular parameter, or using it as a   * 00011000
*    base register.                                                   * 00011100
*                                                                     * 00011200
*01* OUTPUT REGISTER INFORMATION:                                     * 00011300
*                                                                     * 00011400
*    When control returns to the caller, the GPRs contain:            * 00011500
*                                                                     * 00011600
*                                                                     * 00011700
*    REGISTER  CONTENTS                                               * 00011800
*                                                                     * 00011900
*    0         Reason code if GR15 return code is non-zero            * 00012000
*                                                                     * 00012100
*    1         Used as work register by the system                    * 00012200
*                                                                     * 00012300
*    2-13      Unchanged                                              * 00012400
*                                                                     * 00012500
*    14        Used as work register by the system                    * 00012600
*                                                                     * 00012700
*    15        Return code                                            * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*    When control returns to the caller, the ARs contain:             * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*    REGISTER  CONTENTS                                               * 00013500
*                                                                     * 00013600
*    0-1       Used as work registers by the system                   * 00013700
*                                                                     * 00013800
*    2-13      Unchanged                                              * 00013900
*                                                                     * 00014000
*    14-15     Used as work registers by the system                   * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*    Some callers depend on register contents remaining the same      * 00014500
*    before and after issuing a service.  If the system changes the   * 00014600
*    contents of registers on which the caller depends, the caller    * 00014700
*    must save them before issuing the service, and restore them      * 00014800
*    after the system returns control.                                * 00014900
*                                                                     * 00015000
*01* PERFORMANCE IMPLICATIONS:                                        * 00015100
*                                                                     * 00015200
*    None                                                             * 00015300
*                                                                     * 00015400
*01* SYNTAX:                                                          * 00015500
*                                                                     * 00015600
*Ýxlabel¨  IWM4AEDF     CONNTKN=xconntkn                              * 00015700
*                    Ð ,FUNC=ADD                                      * 00015800
*                    !     ,APPLENV=xapplenv                          * 00015900
*                    !     ,JCLPROC=xjclproc                          * 00016000
*                    !    Ý,JCLPARMS=»xjclparms!0º¨                   * 00016100
*                    !   ÐÝ,JOBSPACE=NO¨                              * 00016200
*                    !   ¿Ý,JOBSPACE=YES¨                             * 00016300
*                    !   ÐÝ,SINGLE_SERVER=NO¨                         * 00016400
*                    !   ¿Ý,SINGLE_SERVER=YES¨                        * 00016500
*                    !    Ý,SELECT_POLICY=»xselect_policy!0º¨         * 00016600
*                    !   ÐÝ,DISTRIBUTE_WORK=FIRST_AVAILABLE¨          * 00016700
*                    !   ¿Ý,DISTRIBUTE_WORK=ROUND_ROBIN¨              * 00016800
*                    Ô ,FUNC=DELETE                                   * 00016900
*                    !     ,APPLENV=xapplenv                          * 00017000
*                    ¿ ,FUNC=MODIFY                                   * 00017100
*                          ,APPLENV=xapplenv                          * 00017200
*                        ÐÝ,DISTRIBUTE_WORK=FIRST_AVAILABLE¨          * 00017300
*                        ¿Ý,DISTRIBUTE_WORK=ROUND_ROBIN¨              * 00017400
*                        ÐÝ,STATIC=NO¨                                * 00017500
*                        ¿Ý,STATIC=YES¨                               * 00017600
*                     Ý,RETCODE=xretcode¨                             * 00017700
*                     Ý,RSNCODE=xrsncode¨                             * 00017800
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00017900
*                    ÐÝ,MF=S¨                                         * 00018000
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00018100
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      Where:                                                         * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*      Ýxlabel¨                                                       * 00018800
*          is an optional symbol, starting in column 1, that is the   * 00018900
*          name on the IWM4AEDF macro invocation.  The name must      * 00019000
*          conform to the rules for an ordinary assembler language    * 00019100
*          symbol.                                                    * 00019200
*          DEFAULT: No name.                                          * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*      CONNTKN=xconntkn                                               * 00019800
*          is the name (RS-type), or address in register (2)-(12), of * 00019900
*          a required 32 bit input which contains the connect token   * 00020000
*          returned by the IWM4CON macro.                             * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*      FUNC=»ADD!DELETE!MODIFYº                                       * 00020600
*          is a required keyword input indicates how the caller uses  * 00020700
*          the service                                                * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*          FUNC=ADD                                                   * 00021100
*              indicates that the caller wants to add a dynamic       * 00021200
*              application environment to WLM.                        * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*              APPLENV=xapplenv                                       * 00021600
*                  is the name (RS-type), or address in register      * 00021700
*                  (2)-(12), of a required 32 character input which   * 00021800
*                  contains the name of the dynamic application       * 00021900
*                  environment.                                       * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*              JCLPROC=xjclproc                                       * 00022500
*                  is the name (RS-type), or address in register      * 00022600
*                  (2)-(12), of a required 8 character input which    * 00022700
*                  contains the name of the start procedure which is  * 00022800
*                  used by WLM to start server manager address spaces * 00022900
*                  for the application environment.                   * 00023000
*                                                                     * 00023100
*                                                                     * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*              ÝJCLPARMS=»xjclparms!0º¨                               * 00023500
*                  is the name (RS-type), or address in register      * 00023600
*                  (2)-(12), of an optional 115 character input which * 00023700
*                  contains the parameters which are passed to the    * 00023800
*                  start procedure of the server manager address      * 00023900
*                  spaces by WLM.                                     * 00024000
*                  DEFAULT: 0                                         * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*              ÝJOBSPACE=»NO!YESº¨                                    * 00024600
*                  is an optional keyword input which specifies       * 00024700
*                  whether the server address spaces for the          * 00024800
*                  application environment should be started as       * 00024900
*                  'SYSTEM' or 'JOB' address spaces.  System address  * 00025000
*                  spaces are defined in the RACF STARTED class as    * 00025100
*                  jobname.jobname.  Job address spaces are defined   * 00025200
*                  in the RACF STARTED class as procname.jobname.     * 00025300
*                  DEFAULT: NO                                        * 00025400
*                                                                     * 00025500
*                                                                     * 00025600
*                  ÝJOBSPACE=NO¨                                      * 00025700
*                      Server address spaces will be started as       * 00025800
*                      system address spaces. This is the default.    * 00025900
*                                                                     * 00026000
*                  ÝJOBSPACE=YES¨                                     * 00026100
*                      Server address spaces will be started as job   * 00026200
*                      address spaces.                                * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*              ÝSINGLE_SERVER=»NO!YESº¨                               * 00027000
*                  is an optional keyword input indicating whether    * 00027100
*                  one or multiple server spaces should be started    * 00027200
*                  for the application environment                    * 00027300
*                  DEFAULT: NO                                        * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*                  ÝSINGLE_SERVER=NO¨                                 * 00027700
*                      Multiple server spaces should be started for   * 00027800
*                      the application environment (default).         * 00027900
*                                                                     * 00028000
*                  ÝSINGLE_SERVER=YES¨                                * 00028100
*                      Only one server space should be started for    * 00028200
*                      the application environment.                   * 00028300
*                                                                     * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*              ÝSELECT_POLICY=»xselect_policy!0º¨                     * 00029000
*                  is the name (RS-type), or address in register      * 00029100
*                  (2)-(12), of an optional byte input which tells    * 00029200
*                  WLM how to select work if work requests are        * 00029300
*                  directly routed to the server address space. Only  * 00029400
*                  0,1 and 2 are valid select policies. 0 is the      * 00029500
*                  default which is also selected if an invalid       * 00029600
*                  policy is specified.                               * 00029700
*                                                                     * 00029800
*                  The select policy options 0,1 and 2 have the       * 00029900
*                  following meaning:                                 * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                  o    0 Default, the oldest request on either the   * 00030300
*                      service class or server address space queue is * 00030400
*                      selected first.                                * 00030500
*                                                                     * 00030600
*                  o    1 The request on the server address space     * 00030700
*                      queue (if present) is selected first           * 00030800
*                      independently of the times the requests have   * 00030900
*                      been inserted.                                 * 00031000
*                                                                     * 00031100
*                  o    2 The request on the service class queue is   * 00031200
*                      always selected first.                         * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*                  DEFAULT: 0                                         * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*              ÝDISTRIBUTE_WORK=»FIRST_AVAILABLE!ROUND_ROBINº¨        * 00032100
*                  is an optional keyword input controls how workload * 00032200
*                  management resumes bound server spaces that are    * 00032300
*                  waiting for work                                   * 00032400
*                  DEFAULT: FIRST_AVAILABLE                           * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                  ÝDISTRIBUTE_WORK=FIRST_AVAILABLE¨                  * 00032800
*                      Workload management wakes up the server space  * 00032900
*                      that has been suspended first (default).       * 00033000
*                                                                     * 00033100
*                  ÝDISTRIBUTE_WORK=ROUND_ROBIN¨                      * 00033200
*                      Workload management wakes up the server space  * 00033300
*                      that has the smallest number of affinities. If * 00033400
*                      there are several server spaces with the same  * 00033500
*                      number of affinities, workload management will * 00033600
*                      start the server space with the smallest       * 00033700
*                      number of active server tasks.                 * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*          FUNC=DELETE                                                * 00034400
*              indicates that the caller wants to delete its interest * 00034500
*              in the dynamic application environment.                * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*              APPLENV=xapplenv                                       * 00034900
*                  is the name (RS-type), or address in register      * 00035000
*                  (2)-(12), of a required 32 character input which   * 00035100
*                  contains the name of the dynamic application       * 00035200
*                  environment.                                       * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*          FUNC=MODIFY                                                * 00035700
*              indicates that the caller wants to redefine the method * 00035800
*              how server spaces should be resumed for static and     * 00035900
*              dynamic application environments.                      * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*              APPLENV=xapplenv                                       * 00036300
*                  is the name (RS-type), or address in register      * 00036400
*                  (2)-(12), of a required 32 character input which   * 00036500
*                  contains the name of the static or dynamic         * 00036600
*                  application environment.                           * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*              ÝDISTRIBUTE_WORK=»FIRST_AVAILABLE!ROUND_ROBINº¨        * 00037200
*                  is an optional keyword input controls how workload * 00037300
*                  management resumes bound server spaces that are    * 00037400
*                  waiting for work                                   * 00037500
*                  DEFAULT: FIRST_AVAILABLE                           * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*                  ÝDISTRIBUTE_WORK=FIRST_AVAILABLE¨                  * 00037900
*                      Workload management wakes up the server space  * 00038000
*                      that has been suspended first (default).       * 00038100
*                                                                     * 00038200
*                  ÝDISTRIBUTE_WORK=ROUND_ROBIN¨                      * 00038300
*                      Workload management wakes up the server space  * 00038400
*                      that has the smallest number of affinities. If * 00038500
*                      there are several server spaces with the same  * 00038600
*                      number of affinities, workload management will * 00038700
*                      start the server space with the smallest       * 00038800
*                      number of active server tasks.                 * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*              ÝSTATIC=»NO!YESº¨                                      * 00039600
*                  is an optional keyword input controls whether a    * 00039700
*                  static or dynamic application environment should   * 00039800
*                  be updated                                         * 00039900
*                  DEFAULT: NO                                        * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*                  ÝSTATIC=NO¨                                        * 00040300
*                      indicates that the caller wants to modify a    * 00040400
*                      dynamic application environment (default).     * 00040500
*                                                                     * 00040600
*                  ÝSTATIC=YES¨                                       * 00040700
*                      indicates that the caller wants to modify a    * 00040800
*                      static application environment.                * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*                                                                     * 00041500
*                                                                     * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*      ÝRETCODE=xretcode¨                                             * 00042000
*          is the name (RS-type) of an optional fullword output       * 00042100
*          variable, or register (2)-(12) or (15), into which the     * 00042200
*          return code is to be copied from GPR 15.  If you specify   * 00042300
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00042400
*          the value will be left in GPR 15.                          * 00042500
*                                                                     * 00042600
*                                                                     * 00042700
*                                                                     * 00042800
*                                                                     * 00042900
*      ÝRSNCODE=xrsncode¨                                             * 00043000
*          is the name (RS-type) of an optional fullword output       * 00043100
*          variable into which the reason code is to be copied from   * 00043200
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00043300
*          R0 (within or without parentheses), the value will be left * 00043400
*          in GPR 0.                                                  * 00043500
*                                                                     * 00043600
*                                                                     * 00043700
*                                                                     * 00043800
*                                                                     * 00043900
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00044000
*          is an optional byte input decimal value in the "0-0" range * 00044100
*          that specifies the macro version.  PLISTVER is the only    * 00044200
*          key allowed on the list form of MF and determines which    * 00044300
*          parameter list is generated.  Note that MAX may be         * 00044400
*          specified instead of a number, and the parameter list will * 00044500
*          be of the largest size currently supported. This size may  * 00044600
*          grow from release to release (thus possibly affecting the  * 00044700
*          amount of storage needed by your program).  If your        * 00044800
*          program can tolerate this, IBM recommends that you always  * 00044900
*          specify MAX when creating the list form parameter list as  * 00045000
*          that will ensure that the list form parameter list is      * 00045100
*          always long enough to hold whatever parameters might be    * 00045200
*          specified on the execute form.                             * 00045300
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00045400
*          default is the lowest version which allows all of the      * 00045500
*          parameters specified on the invocation to be processed.    * 00045600
*                                                                     * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*      ÝMF=»S!L!Eº¨                                                   * 00046100
*          is an optional keyword input which specifies the macro     * 00046200
*          form.                                                      * 00046300
*          DEFAULT: S                                                 * 00046400
*                                                                     * 00046500
*                                                                     * 00046600
*          ÝMF=S¨                                                     * 00046700
*              specifies the standard form of the macro.  The "S"     * 00046800
*              form generates code to put the parameters into an      * 00046900
*              in-line parameter list and invoke the desired service. * 00047000
*              Full checking for required macro keys is done along    * 00047100
*              with supplying defaults for omitted optional           * 00047200
*              parameters.                                            * 00047300
*                                                                     * 00047400
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00047500
*              specifies the list form of the macro.  The "L" form    * 00047600
*              defines an area to be used for the parameter list.     * 00047700
*              Only the PLISTVER key may be specified on the          * 00047800
*              invocation.  All other macro parameters are flagged as * 00047900
*              errors.  If PLISTVER is not specified, the original    * 00048000
*              parameter list definition is used.                     * 00048100
*                                                                     * 00048200
*            ,xmfctrl                                                 * 00048300
*              is a required input.  It is the name of a storage area * 00048400
*              for the parameter list.                                * 00048500
*                                                                     * 00048600
*            »,xmfattr!0Dº                                            * 00048700
*              is an optional 60 character input string that varies   * 00048800
*              from 1 to 60 characters. Use it to force boundary      * 00048900
*              alignment of the parameter list. Use only 0F or 0D.    * 00049000
*              DEFAULT: 0D which forces the parameter list to a       * 00049100
*              doubleword boundary.                                   * 00049200
*                                                                     * 00049300
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00049400
*              specifies the execute form of the macro.  The "E" form * 00049500
*              generates code to put the parameters into the          * 00049600
*              parameter list specified by xmfctrl and provides full  * 00049700
*              syntax checking with default setting.                  * 00049800
*                                                                     * 00049900
*            ,xmfctrl                                                 * 00050000
*              is a required input.  It is the name (RS-type), or     * 00050100
*              address in register (1)-(12), of a storage area for    * 00050200
*              the parameter list.                                    * 00050300
*                                                                     * 00050400
*            »,COMPLETEº                                              * 00050500
*              is an optional keyword input which specifies the       * 00050600
*              degree of macro parameter syntax checking.             * 00050700
*              DEFAULT: COMPLETE                                      * 00050800
*                                                                     * 00050900
*                                                                     * 00051000
*              COMPLETE                                               * 00051100
*                  Checking for required macro keys is done and       * 00051200
*                  defaults are supplied for omitted optional         * 00051300
*                  parameters.                                        * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*                                                                     * 00051900
*                                                                     * 00052000
*                                                                     * 00052100
*01* ABEND CODES:  None.                                              * 00052200
*                                                                     * 00052300
*01* RETURN CODES:                                                    * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*            0    Name: IwmRetCodeOk                                  * 00052700
*                                                                     * 00052800
*                 Meaning: Successful completion.                     * 00052900
*                                                                     * 00053000
*                 Action: None required.                              * 00053100
*                                                                     * 00053200
*                                                                     * 00053300
*            8    Name: IwmRetCodeInvocError                          * 00053400
*                                                                     * 00053500
*                 Meaning: Invalid invocation environment or          * 00053600
*                 parameters.                                         * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*                 HEX REASON  MEANING/ACTION                          * 00054000
*                 CODE                                                * 00054100
*                                                                     * 00054200
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00054300
*                                                                     * 00054400
*                             Meaning: Caller is disabled.            * 00054500
*                                                                     * 00054600
*                             Action: Avoid requesting this function  * 00054700
*                             while disabled.                         * 00054800
*                                                                     * 00054900
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00055000
*                                                                     * 00055100
*                             Meaning: Caller is locked.              * 00055200
*                                                                     * 00055300
*                             Action: Avoid requesting this function  * 00055400
*                             while locked.                           * 00055500
*                                                                     * 00055600
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00055700
*                                                                     * 00055800
*                             Meaning: Error accessing parameter      * 00055900
*                             list.                                   * 00056000
*                                                                     * 00056100
*                             Action: Check for possible storage      * 00056200
*                             overlay.                                * 00056300
*                                                                     * 00056400
*                 xxxx0821    Name:IwmRsnCodeBadConn                  * 00056500
*                                                                     * 00056600
*                             Meaning: Input connect token does not   * 00056700
*                             pass validity checking.                 * 00056800
*                                                                     * 00056900
*                             Action: Make sure to use the connect    * 00057000
*                             token returned by the IWM4CON service   * 00057100
*                             requesting Queue_Manager=Yes, or        * 00057200
*                             Server_Manager=Yes with                 * 00057300
*                             Server_Type=Queue.                      * 00057400
*                                                                     * 00057500
*                 xxxx0823    Name: IwmRsnCodeDatoff                  * 00057600
*                                                                     * 00057700
*                             Meaning: Caller invoked service while   * 00057800
*                             DATOFF                                  * 00057900
*                                                                     * 00058000
*                             Action: Avoid requesting this function  * 00058100
*                             in this environment.                    * 00058200
*                                                                     * 00058300
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 00058400
*                                                                     * 00058500
*                             Meaning: Caller invoked service but was * 00058600
*                             in 24 bit addressing mode.              * 00058700
*                                                                     * 00058800
*                             Action: Request this function only when * 00058900
*                             you are in 31 bit addressing mode.      * 00059000
*                                                                     * 00059100
*                 xxxx0825    Name: IwmRsnCodeAscModeNotPrimary       * 00059200
*                                                                     * 00059300
*                             Meaning: Caller invoked service but was * 00059400
*                             not in primary ASC mode.                * 00059500
*                                                                     * 00059600
*                             Action: Avoid requesting this function  * 00059700
*                             in this environment.                    * 00059800
*                                                                     * 00059900
*                 xxxx0827    Name: IwmRsnCodeRsvdNot0                * 00060000
*                                                                     * 00060100
*                             Meaning: Reserved field in parameter    * 00060200
*                             list was non-zero.                      * 00060300
*                                                                     * 00060400
*                             Action:  Check for use of keywords that * 00060500
*                             are not supported by the MVS release on * 00060600
*                             which the program is running.           * 00060700
*                                                                     * 00060800
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00060900
*                                                                     * 00061000
*                             Meaning: Version number in parameter    * 00061100
*                             list is not valid.                      * 00061200
*                                                                     * 00061300
*                             Action: Check for possible storage      * 00061400
*                             overlay of the parameter list.          * 00061500
*                                                                     * 00061600
*                 xxxx083F    Name: IwmRsnCodePrimaryNotOwnConn       * 00061700
*                                                                     * 00061800
*                             Meaning: Primary address space does not * 00061900
*                             own the passed connect token.           * 00062000
*                                                                     * 00062100
*                             Action: Ensure that the primary address * 00062200
*                             space has previously connected to WLM   * 00062300
*                             using the IWM4CON macro.  Ensure that   * 00062400
*                             the connect token returned by the       * 00062500
*                             IWM4CON macro is passed to the IWM4AEDF * 00062600
*                             macro.                                  * 00062700
*                                                                     * 00062800
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 00062900
*                                                                     * 00063000
*                             Meaning: Caller's space connection is   * 00063100
*                             not enabled for this service.           * 00063200
*                                                                     * 00063300
*                             Action: Make sure that                  * 00063400
*                             Queue_Manager=Yes, or                   * 00063500
*                             Server_Manager=Yes with                 * 00063600
*                             Server_Type=Queue is specified on the   * 00063700
*                             IWM4CON request to enable this service. * 00063800
*                                                                     * 00063900
*                 xxxx0842    Name: IwmRsnCodeNoWLMConnect            * 00064000
*                                                                     * 00064100
*                             Meaning: Caller's space disconnected    * 00064200
*                             from WLM during processing of the       * 00064300
*                             request.                                * 00064400
*                                                                     * 00064500
*                             Action: None.                           * 00064600
*                                                                     * 00064700
*                 xxxx0890    Name: IwmRsnCodeApplEnvExists           * 00064800
*                                                                     * 00064900
*                             Meaning:  The caller tried to add an    * 00065000
*                             application environment that has        * 00065100
*                             already been defined.  subsystem type.  * 00065200
*                                                                     * 00065300
*                             Action: Check whether the correct       * 00065400
*                             application environment name is being   * 00065500
*                             used.  Make sure that a unique          * 00065600
*                             application environment name is used    * 00065700
*                             when adding application environments.   * 00065800
*                                                                     * 00065900
*                 xxxx0891    Name: IwmRsnCodeApplEnvNotFound         * 00066000
*                                                                     * 00066100
*                             Meaning:  The caller tried to delete or * 00066200
*                             modify an application environment that  * 00066300
*                             does not exist.                         * 00066400
*                                                                     * 00066500
*                             Action: Check whether the correct       * 00066600
*                             application environment name is being   * 00066700
*                             used.                                   * 00066800
*                                                                     * 00066900
*                                                                     * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*            C    Name: IwmRetCodeEnvError                            * 00067300
*                                                                     * 00067400
*                 Meaning: Environmental error.                       * 00067500
*                                                                     * 00067600
*                                                                     * 00067700
*                 HEX REASON  MEANING/ACTION                          * 00067800
*                 CODE                                                * 00067900
*                                                                     * 00068000
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 00068100
*                                                                     * 00068200
*                             Meaning: Storage is not available for   * 00068300
*                             the request.                            * 00068400
*                                                                     * 00068500
*                             Action: Contact your system programmer. * 00068600
*                             There is a common storage shortage.     * 00068700
*                                                                     * 00068800
*                                                                     * 00068900
*                                                                     * 00069000
*                                                                     * 00069100
*            10   Name: IwmRetCodeCompError                           * 00069200
*                                                                     * 00069300
*                 Meaning: Component error.                           * 00069400
*                                                                     * 00069500
*                 Action: Contact your system programmer.             * 00069600
*                                                                     * 00069700
*                                                                     * 00069800
*                                                                     * 00069900
*01* REASON CODES:                                                    * 00070000
*                                                                     * 00070100
*       A unique reason code will be returned whenever the return     * 00070200
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00070300
*       under their corresponding return code.  Reason code and       * 00070400
*       return code constants are defined within IWMYCON.  Note that  * 00070500
*       the high order halfword of register 0, and the reason code    * 00070600
*       variable when specified, may be non-zero and represents       * 00070700
*       diagnostic data which is NOT part of the external interface.  * 00070800
*       The high order halfword should thus be excluded from          * 00070900
*       comparison with the reason code values described above.  The  * 00071000
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00071100
*       used for this purpose.                                        * 00071200
*                                                                     * 00071300
*01* MODULE TYPE:  ASSEM MACRO                                        * 00071400
*                                                                     * 00071500
*02*   PROCESSOR:  ASSEM                                              * 00071600
*                                                                     * 00071700
*01* COMPONENT:  SCWLM                                                * 00071800
*                                                                     * 00071900
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00072000
*                                                                     * 00072100
*01* EXAMPLES:                                                        * 00072200
*                                                                     * 00072300
*    To add a dynamic application environment:                        * 00072400
*                                                                     * 00072500
*               IWM4AEDF CONNTKN=CONNTOKEN,                         X * 00072600
*                        FUNC=ADD,                                  X * 00072700
*                        APPLENV=APPLENV                            X * 00072800
*                        JCLPROC=JCLPROC                            X * 00072900
*                        RETCODE=RC,RSNCODE=RSN                       * 00073000
*      *                                                              * 00073100
*      * Storage areas                                                * 00073200
*      *                                                              * 00073300
*      CONNTOKEN DS   FL4             Contains the connect token      * 00073400
*      *                              associated with the use of WLM  * 00073500
*      *                              Queuing services as returned by * 00073600
*      *                              IWM4CON                         * 00073700
*      APPLENV  DS    CL32            Contains the application        * 00073800
*      *                              environment name                * 00073900
*      JCLPROC  DS    CL8             Contains the name of the        * 00074000
*      *                              start procedure                 * 00074100
*      RC       DS    F               Return code                     * 00074200
*      RSN      DS    F               Reason code                     * 00074300
*                                                                     * 00074400
*                                                                     * 00074500
*01* MACRO USAGE NOTES:                                               * 00074600
*                                                                     * 00074700
*                                                                     * 00074800
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00074900
*        global macro variable.  Any value other than 'NO' will       * 00075000
*        result in the macro expansion being printed.  The default is * 00075100
*        'YES'.  The following examples illustrate how the ZPRINT     * 00075200
*        variable should be set.                                      * 00075300
*                                                                     * 00075400
*                    GBLC &ZPRINT                                     * 00075500
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00075600
*                                                                     * 00075700
*                                                                     * 00075800
*    2.  All   keys   currently   contained  in  the  IWM4AEDF  macro * 00075900
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00076000
*        value of 0 or MAX.                                           * 00076100
*                                                                     * 00076200
*                                                                     * 00076300
*                                                                     * 00076400
*                                                                     * 00076500
*01* CHANGE ACTIVITY:                                                 * 00076600
*                                                                     * 00076700
*   Flag LineItem  FMID    Date   ID    Comment                       * 00076800
*                                                                     * 00076900
*    $L0=ME00696  HBB7720 040530 3241NN:  WLM 64-bit support copied   * 00077000
*                                         from IWMAEDEF with flag L2. * 00077100
*    $P1=LJOBSPA  HBB7790 110203 3241NN:  New JOBSPACE attribute.     * 00077200
****** END OF SPECIFICATIONS *****************************************/ 00077300
*/********************************************************************* 00077400
         MACRO                                                          00077500
&XLABEL  IWM4AEDF &CONNTKN=,&FUNC=,&APPLENV=,&JCLPROC=,&JCLPARMS=,     *00077600
               &JOBSPACE=,&SINGLE_SERVER=,&SELECT_POLICY=,             *00077700
               &DISTRIBUTE_WORK=,&STATIC=,&RETCODE=,&RSNCODE=,         *00077800
               &PLISTVER=,&MF=                                          00077900
.*                                                                      00078000
*                     MACDATE -01/31/13-<0>                             00078100
.*                                                                      00078200
.*******************************************************************    00078300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00078400
.*******************************************************************    00078500
                     GBLC  &ZPRINT     YES=PRINT NO=NO PRINT            00078600
                     GBLC  &ZTEST      YES=TEST NO=NO TEST              00078700
                     GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX      00078800
.*                                                                      00078900
                     GBLC  &ZIWM4AEDF  YES=MACRO USED AT LEAST ONCE     00079000
.*******************************************************************    00079100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00079200
.*******************************************************************    00079300
                     LCLC  &ZMS        ERROR MESSAGE WORK AREA          00079400
                     LCLC  &ZCNDX      SYSNDX CHARACTERS                00079500
                     LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED       00079600
                     LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR      00079700
                     LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE      00079800
                     LCLA  &ZAWRK      USED AS A WORK AREA              00079900
                     LCLA  &ZASIZ      USED FOR SIZE OF VALUE           00080000
                     LCLA  &ZN         NUMERIC WORK VARIABLE            00080100
                     LCLC  &ZC         CHARACTER WORK VARIABLE          00080200
                     LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE      00080300
                     LCLA  &ZTLA       VALUE TOO LONG VARIABLE          00080400
                     LCLC  &ZMAC_G     "G" or null                      00080500
&ZMAC_G              SETC  ''                                           00080600
                     LCLC  &ZMAC_LR                                     00080700
&ZMAC_LR             SETC  'LR'                                         00080800
                     LCLC  &ZMAC_L                                      00080900
&ZMAC_L              SETC  'L'                                          00081000
                     LCLC  &ZMAC_ST                                     00081100
&ZMAC_ST             SETC  'ST'                                         00081200
                     LCLC  &ZMAC_LLGT                                   00081300
&ZMAC_LLGT           SETC  'L'                                          00081400
                     LCLC  &ZMAC_LGR                                    00081500
&ZMAC_LGR            SETC  'LR'                                         00081600
                     LCLC  &ZMAC_LG                                     00081700
&ZMAC_LG             SETC  'L'                                          00081800
                     LCLC  &ZMAC_STG                                    00081900
&ZMAC_STG            SETC  'ST'                                         00082000
                     LCLA  &ZMACRET    MACRO RETURN CODE                00082100
&ZMACRET             SETA  0           ASSUME NO ERRORS                 00082200
.*                                                                      00082300
                     LCLC  &ZCSYSLIST(255)      NONXKEY, POS ARRAY      00082400
                     LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()       00082500
                     LCLA  &ZPLLEN     PARAMETER LIST LENGTH            00082600
                     LCLC  &ZENDBASEPL          End of base PL          00082700
                     LCLA  &ZPLWORKA   PARAMETER LIST LENGTH            00082800
.*******************************************************************    00082900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00083000
.*******************************************************************    00083100
                     LCLA  &ZI         INDEX FOR ARRAY                  00083200
                     LCLA  &ZJ         INDEX FOR PARMS                  00083300
                     LCLA  &ZK         INDEX FOR PARSE                  00083400
                     LCLA  &ZLO        LOW RANGE VALUE                  00083500
                     LCLA  &ZHI        HIGH RANGE VALUE                 00083600
                     LCLC  &ZW         WORK AREA FOR PARM               00083700
.********************************************************************   00083800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00083900
.********************************************************************   00084000
                     GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL          00084100
                     GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE   00084200
                     GBLA  &SYSALVL    SYSSTATE ARCHLVL                 00084300
                     GBLC  &SYSAM64    SYSSTATE AMODE64                 00084400
.*                                                                      00084500
                     AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED   00084600
                     AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED    00084700
                     SPLEVEL  TEST                                      00084800
.ZSYS2               ANOP  ,                                            00084900
                     AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1        00085000
                     AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1        00085100
                     SYSSTATE TEST                                      00085200
                     AGO   .ZSYS4                                       00085300
.ZSYS3               ANOP  ,                                            00085400
&SYSASCE             SETC  'P'         ASSUME SYSSTATE PRIMARY          00085500
.ZSYS4               ANOP  ,                                            00085600
                     AIF   ('&SYSAM64' NE 'YES').ZSYSN64                00085700
&ZMAC_LLGT           SETC 'LLGT'                                        00085800
&ZMAC_LGR            SETC 'LGR'                                         00085900
&ZMAC_LG             SETC 'LG'                                          00086000
&ZMAC_STG            SETC 'STG'                                         00086100
.ZSYSN64             ANOP  ,                                            00086200
&ZMAC_G              SETC 'G'                                           00086300
&ZMAC_LR             SETC 'LGR'                                         00086400
&ZMAC_L              SETC 'LG'                                          00086500
&ZMAC_ST             SETC 'STG'                                         00086600
.*******************************************************************    00086700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00086800
.*******************************************************************    00086900
                     LCLC  &XCONNTKN   ++ NAME                          00087000
                     LCLC  &XFUNC      ++ VALUE                         00087100
                     LCLC  &XAPPLENV   ++ NAME                          00087200
                     LCLC  &XJCLPROC   ++ NAME                          00087300
                     LCLC  &XJCLPARMS  ++ NAME                          00087400
                     LCLC  &XJOBSPACE  ++ VALUE                         00087500
                     LCLC  &XSINGLE_SERVER      ++ VALUE                00087600
                     LCLC  &XSELECT_POLICY      ++ NAME                 00087700
                     LCLC  &XDISTRIBUTE_WORK    ++ VALUE                00087800
                     LCLC  &XSTATIC    ++ VALUE                         00087900
                     LCLC  &XRETCODE   ++ NAME                          00088000
                     LCLC  &XRSNCODE   ++ NAME                          00088100
                     LCLA  &XPLISTVER  ++ VALUE                         00088200
                     LCLC  &XMF        ++ VALUE                         00088300
                     LCLC  &XMFCTRL    ++ NAME                          00088400
                     LCLC  &XMFATTR    ++ VALUE                         00088500
                     LCLC  &XMFSCK     ++ VALUE                         00088600
.*******************************************************************    00088700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00088800
.*******************************************************************    00088900
                     LCLC  &ZXCONNTKN  ++ INPUT NAME                    00089000
                     LCLC  &ZXFUNC     ++ INPUT VALUE                   00089100
                     LCLC  &ZXAPPLENV  ++ INPUT NAME                    00089200
                     LCLC  &ZXJCLPROC  ++ INPUT NAME                    00089300
                     LCLC  &ZXJCLPARMS          ++ INPUT NAME           00089400
                     LCLC  &ZXJOBSPACE          ++ INPUT VALUE          00089500
                     LCLC  &ZXSINGLE_SERVER     ++ INPUT VALUE          00089600
                     LCLC  &ZXSELECT_POLICY     ++ INPUT NAME           00089700
                     LCLC  &ZXDISTRIBUTE_WORK   ++ INPUT VALUE          00089800
                     LCLC  &ZXSTATIC   ++ INPUT VALUE                   00089900
                     LCLC  &ZXRETCODE  ++ OUTPUT NAME                   00090000
                     LCLC  &ZXRSNCODE  ++ OUTPUT NAME                   00090100
                     LCLC  &ZXPLISTVER          ++ INPUT VALUE          00090200
                     LCLC  &ZXMF       ++ INPUT VALUE                   00090300
                     LCLC  &ZXMFCTRL   ++ INPUT NAME                    00090400
                     LCLC  &ZXMFATTR   ++ INPUT VALUE                   00090500
                     LCLC  &ZXMFSCK    ++ INPUT VALUE                   00090600
.********************************************************************   00090700
.***AC.PLV01  PROCESS PLISTVER                                      *   00090800
.********************************************************************   00090900
&XPLISTVER      SETA  0                                                 00091000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00091100
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00091200
&XPLISTVER      SETA  0                                                 00091300
.ZPLV0          ANOP  ,                                                 00091400
.*                                                                      00091500
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00091600
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00091700
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00091800
.*-------------------------------------------------------------------   00091900
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00092000
&ZMS            SETC  '"PLISTVER='                                      00092100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00092200
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00092300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00092400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00092500
                AGO   .ZPVCK2                                           00092600
.ZPVCK3         ANOP  ,                                                 00092700
.*-------------------------------------------------------------------   00092800
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00092900
&ZMS            SETC  '"PLISTVER='                                      00093000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00093100
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00093200
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00093300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00093400
                AGO   .ZPVCKE                                           00093500
.ZPVCK2         ANOP  ,                                                 00093600
.*-------------------------------------------------------------------   00093700
&ZCVAL          SETC  '&PLISTVER(1)'                                    00093800
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00093900
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00094000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00094100
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00094200
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00094300
.ZPVCK6         ANOP  ,                                                 00094400
&ZMS            SETC  '"PLISTVER='                                      00094500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00094600
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00094700
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00094800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00094900
&XPLISTVER      SETA  0                                                 00095000
                AGO   .ZPVCKE                                           00095100
.*-------------------------------------------------------------------   00095200
.ZPVCK4A        ANOP  ,                                                 00095300
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00095400
&ZMS            SETC  'PLISTVER='                                       00095500
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00095600
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00095700
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00095800
                MNOTE 8,' &ZMS IS REQUIRED.'                            00095900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00096000
                AGO   .ZPVCK5                                           00096100
.ZPVCK4         ANOP  ,                                                 00096200
&XPLISTVER      SETA  &PLISTVER(1)                                      00096300
.ZPVCK5         ANOP  ,                                                 00096400
.ZPVCKE         ANOP  ,                                                 00096500
.********************************************************************   00096600
.***AG.MF01 PROCESS MF MACRO FORMS                                      00096700
.********************************************************************   00096800
                     ACTR  10000                                        00096900
.*------------------------------------------------------------------    00097000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00097100
&XMF                 SETC  ''          INITIALIZE XVARIABLE             00097200
.*-------------------------------------------------------------------   00097300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00097400
.ZG64                ANOP  ,                                            00097500
&ZTLC                SETC 'S'                                           00097600
                     AIF   ('&MF(1)' NE '&ZTLC').ZG65                   00097700
&XMF                 SETC  'S'         SET KEYWORD                      00097800
                     AIF   (N'&MF LE 1).ZG64A   CK NUM                  00097900
&ZMS                 SETC  '"MF='                                       00098000
&ZMS                 SETC  '&ZMS.&MF"'                                  00098100
&ZMS                 SETC  '&ZMS "MF"'                                  00098200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00098300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00098400
.ZG64A               ANOP  ,                                            00098500
.*-------------------------------------------------------------------   00098600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098700
.ZG65                ANOP  ,                                            00098800
&ZTLC                SETC 'L'                                           00098900
                     AIF   ('&MF(1)' NE '&ZTLC').ZG72                   00099000
&XMF                 SETC  'L'         SET KEYWORD                      00099100
                     AIF   (N'&MF LE 3).ZG65A   CK NUM                  00099200
&ZMS                 SETC  '"MF='                                       00099300
&ZMS                 SETC  '&ZMS.&MF"'                                  00099400
&ZMS                 SETC  '&ZMS "MF"'                                  00099500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00099600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00099700
.ZG65A               ANOP  ,                                            00099800
.*-------------------------------------------------------------------   00099900
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00100000
                     AIF   (N'&SYSLIST NE 0).ZG65B  POSITIONALS?        00100100
                     AIF   ('&CONNTKN' NE '').ZG65B  KEYS?              00100200
                     AIF   ('&FUNC' NE '').ZG65B  KEYS?                 00100300
                     AIF   ('&APPLENV' NE '').ZG65B  KEYS?              00100400
                     AIF   ('&JCLPROC' NE '').ZG65B  KEYS?              00100500
                     AIF   ('&JCLPARMS' NE '').ZG65B  KEYS?             00100600
                     AIF   ('&JOBSPACE' NE '').ZG65B  KEYS?             00100700
                     AIF   ('&SINGLE_SERVER' NE '').ZG65B  KEYS?        00100800
                     AIF   ('&SELECT_POLICY' NE '').ZG65B  KEYS?        00100900
                     AIF   ('&DISTRIBUTE_WORK' NE '').ZG65B  KEYS?      00101000
                     AIF   ('&STATIC' NE '').ZG65B  KEYS?               00101100
                     AIF   ('&RETCODE' NE '').ZG65B  KEYS?              00101200
                     AIF   ('&RSNCODE' NE '').ZG65B  KEYS?              00101300
                     AGO    .ZG65C     INVOCATION OKAY                  00101400
.ZG65B               ANOP  ,                                            00101500
&ZMS                 SETC  'THE "L" FORM OF "MF"'                       00101600
&ZMS                 SETC  '&ZMS CAN ONLY HAVE'                         00101700
&ZMS                 SETC  '&ZMS THE "PLISTVER" KEY'                    00101800
                     MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'       00101900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00102000
.ZG65C               ANOP  ,                                            00102100
.*-------------------------------------------------------------------   00102200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00102300
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00102400
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00102500
                     AIF   (N'&MF(2) GT 1).ZG67B  MULTI PARMS           00102600
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00102700
.ZG67B               AIF   (K'&MF(2) GT 0).ZG67C                        00102800
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00102900
&ZMS                 SETC  'WHEN "L" IS SPECIFIED'                      00103000
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00103100
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00103200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00103300
.ZG67C               ANOP  ,                                            00103400
.*-------------------------------------------------------------------   00103500
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00103600
                     AIF   (K'&ZXMFCTRL LE 0).ZG67P  NOT I/O            00103700
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG67P               00103800
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00103900
&ZMS                 SETC  '"MF='                                       00104000
&ZMS                 SETC  '&ZMS.&MF"'                                  00104100
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00104200
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'            00104300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00104400
.ZG67P               ANOP  ,                                            00104500
.*-------------------------------------------------------------------   00104600
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00104700
&ZXMFATTR            SETC  'INPUT'     SET IN/OUTPUT                    00104800
&XMFATTR             SETC  '0D'                                         00104900
                     AIF   (K'&MF(3) LE 0).ZG70B  PARM                  00105000
&XMFATTR             SETC  '&MF(3,1)'  SET XVARIABLE                    00105100
                     AIF   (N'&MF(3) GT 1).ZG70B  MULTI                 00105200
&XMFATTR             SETC  '&MF(3)'    SET XVARIABLE                    00105300
.ZG70B               ANOP  ,                                            00105400
.*-------------------------------------------------------------------   00105500
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00105600
                     AIF   (K'&ZXMFATTR LE 0).ZG70P  NOT I/O            00105700
                     AIF   ('&XMFATTR'(1,1) NE '(').ZG70P               00105800
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00105900
&ZMS                 SETC  '"MF='                                       00106000
&ZMS                 SETC  '&ZMS.&MF"'                                  00106100
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00106200
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'            00106300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00106400
.ZG70P               ANOP  ,                                            00106500
.*-------------------------------------------------------------------   00106600
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00106700
                     AIF   (K'&ZXMFATTR LE 0).ZG70S  NOT I/O            00106800
                     AIF   (K'&XMFATTR LE 60).ZG70S  LNG OK             00106900
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00107000
&ZMS                 SETC  '"MF='                                       00107100
&ZMS                 SETC  '&ZMS.&MF"'                                  00107200
&ZMS                 SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'        00107300
                     MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'           00107400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00107500
.ZG70S               ANOP  ,                                            00107600
.*-------------------------------------------------------------------   00107700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107800
.ZG72                ANOP  ,                                            00107900
&ZTLC                SETC 'E'                                           00108000
                     AIF   ('&MF(1)' NE '&ZTLC').ZG80                   00108100
&XMF                 SETC  'E'         SET KEYWORD                      00108200
                     AIF   (N'&MF LE 3).ZG72A   CK NUM                  00108300
&ZMS                 SETC  '"MF='                                       00108400
&ZMS                 SETC  '&ZMS.&MF"'                                  00108500
&ZMS                 SETC  '&ZMS "MF"'                                  00108600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00108700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00108800
.ZG72A               ANOP  ,                                            00108900
.*-------------------------------------------------------------------   00109000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00109100
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00109200
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00109300
                     AIF   (N'&MF(2) GT 1).ZG74B  MULTI PARMS           00109400
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00109500
.ZG74B               AIF   (K'&MF(2) GT 0).ZG74C                        00109600
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00109700
&ZMS                 SETC  'WHEN "E" IS SPECIFIED'                      00109800
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00109900
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00110000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00110100
.ZG74C               ANOP  ,                                            00110200
.*-------------------------------------------------------------------   00110300
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00110400
                     AIF   (K'&ZXMFCTRL LE 0).ZG74R  NOT I/O            00110500
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG74R               00110600
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00110700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG74P                 00110800
                     AIF   (K'&ZCGPR GT 2).ZG74Q                        00110900
                     AIF   ('&ZCGPR' EQ '0').ZG74Q                      00111000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00111100
                     AIF   (T'&ZCGPR NE 'N').ZG74Q  INVALID REG NAME    00111200
.ZG74P               ANOP  ,                                            00111300
                     AIF   (T'&ZCGPR NE 'N').ZG74R  NON NUMERIC         00111400
                     AIF   ('&ZCGPR' LT '1').ZG74Q                      00111500
                     AIF   ('&ZCGPR' LE '12').ZG74R                     00111600
.ZG74Q               ANOP  ,                                            00111700
&ZMS                 SETC  '"MF='                                       00111800
&ZMS                 SETC  '&ZMS.&MF"'                                  00111900
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00112000
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00112100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00112200
.ZG74R               ANOP  ,                                            00112300
.*-------------------------------------------------------------------   00112400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00112500
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00112600
.ZG78A   AIF   ('&MF(3)' NE 'COMPLETE').ZG79A                           00112700
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00112800
.*-------------------------------------------------------------------   00112900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00113000
.ZG79A               AIF   (K'&XMFSCK GT 0).ZG79C  KEYWORD              00113100
                     AIF   (K'&MF(3) LE 0).ZG79B                        00113200
&ZMS                 SETC  '"MF='                                       00113300
&ZMS                 SETC  '&ZMS.&MF"'                                  00113400
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00113500
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00113600
&ZMS                 SETC  '&ZMS "COMPLETE".'                           00113700
                     MNOTE 8,' &ZMS '                                   00113800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00113900
.ZG79B               ANOP  ,                                            00114000
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00114100
.ZG79C               ANOP  ,                                            00114200
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00114300
.*------------------------------------------------------------------    00114400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114500
.ZG80                ANOP  ,                                            00114600
&ZXMF                SETC  'INPUT'     SET IN/OUTPUT                    00114700
                     AIF   (K'&XMF GT 0).ZG80E  VALID ARG               00114800
                     AIF   (T'&MF EQ 'O').ZG80D  OMITTED                00114900
&ZASYSLNDX           SETA  0                                            00115000
.ZG80A               ANOP  ,           POSITIONAL MACRO KEY             00115100
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00115200
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG80C             00115300
&ZTLC                SETC 'MF'                                          00115400
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG80A    00115500
.ZG80B               ANOP  ,                                            00115600
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00115700
&ZMS                 SETC  'THE "MF" KEY'                               00115800
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00115900
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00116000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00116100
                     AGO   .ZG80E                                       00116200
.ZG80C               ANOP  ,                                            00116300
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00116400
&ZMS                 SETC  '"MF='                                       00116500
&ZMS                 SETC  '&ZMS.&MF"'                                  00116600
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00116700
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00116800
&ZMS                 SETC  '&ZMS "S",'                                  00116900
&ZMS                 SETC  '&ZMS "L",'                                  00117000
&ZMS                 SETC  '&ZMS OR "E".'                               00117100
                     MNOTE 8,' &ZMS '                                   00117200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00117300
                     AGO   .ZG80E                                       00117400
.ZG80D               ANOP  ,                                            00117500
&XMF                 SETC  'S'         SET DEFAULT KEYWORD              00117600
&XMFSCK              SETC  'COMPLETE'  COMPLETE CHECKING                00117700
.ZG80E               ANOP  ,                                            00117800
.********************************************************************   00117900
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00118000
.********************************************************************   00118100
                     ACTR  10000                                        00118200
.*-------------------------------------------------------------------   00118300
.***AG.MF03 MF=(SLE)                                                    00118400
                     AIF   ('&XMF' EQ 'L').ZGMFX                        00118500
.*----------------------------------------------------------------***   00118600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00118700
                     AIF   (N'&CONNTKN LE 1).ZG2A  CK NUM               00118800
&ZMS                 SETC  '"CONNTKN='                                  00118900
&ZMS                 SETC  '&ZMS.&CONNTKN"'                             00119000
&ZMS                 SETC  '&ZMS "CONNTKN"'                             00119100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00119200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00119300
.ZG2A                ANOP  ,                                            00119400
.*-------------------------------------------------------------------   00119500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00119600
&ZXCONNTKN           SETC  'INPUT'     SET IN/OUTPUT                    00119700
&XCONNTKN            SETC  '&CONNTKN(1)'        SET XVARIABLE           00119800
                     AIF   (N'&CONNTKN GT 1).ZG2B  MULTI PARMS          00119900
&XCONNTKN            SETC  '&CONNTKN'  SET XVARIABLE                    00120000
.ZG2B                AIF   (K'&CONNTKN(1) GT 0).ZG2C                    00120100
&ZXCONNTKN           SETC  ''          RESET IN/OUTPUT                  00120200
&ZMS                 SETC  ' '                                          00120300
&ZMS                 SETC  '&ZMS "CONNTKN" KEY AND ITS'                 00120400
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00120500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00120600
.ZG2C                ANOP  ,                                            00120700
.*-------------------------------------------------------------------   00120800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00120900
                     AIF   (K'&ZXCONNTKN LE 0).ZG2R  NOT I/O            00121000
                     AIF   ('&XCONNTKN'(1,1) NE '(').ZG2R               00121100
&ZCGPR               SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                 00121200
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                  00121300
                     AIF   (K'&ZCGPR GT 2).ZG2Q                         00121400
                     AIF   ('&ZCGPR' EQ '0').ZG2Q                       00121500
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00121600
                     AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME     00121700
.ZG2P                ANOP  ,                                            00121800
                     AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC          00121900
                     AIF   ('&ZCGPR' LT '2').ZG2Q                       00122000
                     AIF   ('&ZCGPR' LE '12').ZG2R                      00122100
.ZG2Q                ANOP  ,                                            00122200
&ZMS                 SETC  '"CONNTKN='                                  00122300
&ZMS                 SETC  '&ZMS.&CONNTKN"'                             00122400
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00122500
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00122600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00122700
.ZG2R                ANOP  ,                                            00122800
.*------------------------------------------------------------------    00122900
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123000
&XFUNC               SETC  ''          INITIALIZE XVARIABLE             00123100
.*-------------------------------------------------------------------   00123200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123300
.ZG6                 ANOP  ,                                            00123400
                     AIF   (K'&FUNC(1) LE 0).ZG6A                       00123500
&ZTLC                SETC 'ADD'                                         00123600
                     AIF   ('&FUNC(1)' NE '&ZTLC').ZG34                 00123700
&XFUNC               SETC  'ADD'       SET KEYWORD                      00123800
                     AIF   (N'&FUNC LE 1).ZG6A  CK NUM                  00123900
&ZMS                 SETC  '"FUNC='                                     00124000
&ZMS                 SETC  '&ZMS.&FUNC"'                                00124100
&ZMS                 SETC  '&ZMS "FUNC"'                                00124200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00124300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00124400
.ZG6A                ANOP  ,                                            00124500
.*------------------------------------------------------------------    00124600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00124700
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00124800
.ZG6A0               AIF   (K'&STATIC LE 0).ZG6A1  OK                   00124900
&ZCVAL               SETC '&ZCVAL STATIC'       INCORRECT KEY USED      00125000
.ZG6A1               AIF   (K'&ZCVAL LE 0).ZG6A2  OK                    00125100
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00125200
&ZMS                 SETC  '"FUNC'                                      00125300
&ZMS                 SETC  '&ZMS.=&FUNC"'                               00125400
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00125500
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00125600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00125700
.ZG6A2               ANOP  ,                                            00125800
.*----------------------------------------------------------------***   00125900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00126000
                     AIF   (N'&APPLENV LE 1).ZG8A  CK NUM               00126100
&ZMS                 SETC  '"APPLENV='                                  00126200
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00126300
&ZMS                 SETC  '&ZMS "APPLENV"'                             00126400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00126500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00126600
.ZG8A                ANOP  ,                                            00126700
.*-------------------------------------------------------------------   00126800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00126900
&ZXAPPLENV           SETC  'INPUT'     SET IN/OUTPUT                    00127000
&XAPPLENV            SETC  '&APPLENV(1)'        SET XVARIABLE           00127100
                     AIF   (N'&APPLENV GT 1).ZG8B  MULTI PARMS          00127200
&XAPPLENV            SETC  '&APPLENV'  SET XVARIABLE                    00127300
.ZG8B                AIF   (K'&APPLENV(1) GT 0).ZG8C                    00127400
&ZXAPPLENV           SETC  ''          RESET IN/OUTPUT                  00127500
&ZMS                 SETC  ' '                                          00127600
&ZMS                 SETC  '&ZMS "APPLENV" KEY AND ITS'                 00127700
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00127800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00127900
.ZG8C                ANOP  ,                                            00128000
.*-------------------------------------------------------------------   00128100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00128200
                     AIF   (K'&ZXAPPLENV LE 0).ZG8R  NOT I/O            00128300
                     AIF   ('&XAPPLENV'(1,1) NE '(').ZG8R               00128400
&ZCGPR               SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                 00128500
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                  00128600
                     AIF   (K'&ZCGPR GT 2).ZG8Q                         00128700
                     AIF   ('&ZCGPR' EQ '0').ZG8Q                       00128800
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00128900
                     AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME     00129000
.ZG8P                ANOP  ,                                            00129100
                     AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC          00129200
                     AIF   ('&ZCGPR' LT '2').ZG8Q                       00129300
                     AIF   ('&ZCGPR' LE '12').ZG8R                      00129400
.ZG8Q                ANOP  ,                                            00129500
&ZMS                 SETC  '"APPLENV='                                  00129600
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00129700
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00129800
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00129900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00130000
.ZG8R                ANOP  ,                                            00130100
.*----------------------------------------------------------------***   00130200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00130300
                     AIF   (N'&JCLPROC LE 1).ZG11A  CK NUM              00130400
&ZMS                 SETC  '"JCLPROC='                                  00130500
&ZMS                 SETC  '&ZMS.&JCLPROC"'                             00130600
&ZMS                 SETC  '&ZMS "JCLPROC"'                             00130700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00130800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00130900
.ZG11A               ANOP  ,                                            00131000
.*-------------------------------------------------------------------   00131100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00131200
&ZXJCLPROC           SETC  'INPUT'     SET IN/OUTPUT                    00131300
&XJCLPROC            SETC  '&JCLPROC(1)'        SET XVARIABLE           00131400
                     AIF   (N'&JCLPROC GT 1).ZG11B  MULTI PARMS         00131500
&XJCLPROC            SETC  '&JCLPROC'  SET XVARIABLE                    00131600
.ZG11B               AIF   (K'&JCLPROC(1) GT 0).ZG11C                   00131700
&ZXJCLPROC           SETC  ''          RESET IN/OUTPUT                  00131800
&ZMS                 SETC  ' '                                          00131900
&ZMS                 SETC  '&ZMS "JCLPROC" KEY AND ITS'                 00132000
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00132100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00132200
.ZG11C               ANOP  ,                                            00132300
.*-------------------------------------------------------------------   00132400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00132500
                     AIF   (K'&ZXJCLPROC LE 0).ZG11R  NOT I/O           00132600
                     AIF   ('&XJCLPROC'(1,1) NE '(').ZG11R              00132700
&ZCGPR               SETC  '&XJCLPROC'(2,K'&XJCLPROC-2)                 00132800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                 00132900
                     AIF   (K'&ZCGPR GT 2).ZG11Q                        00133000
                     AIF   ('&ZCGPR' EQ '0').ZG11Q                      00133100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00133200
                     AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME    00133300
.ZG11P               ANOP  ,                                            00133400
                     AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC         00133500
                     AIF   ('&ZCGPR' LT '2').ZG11Q                      00133600
                     AIF   ('&ZCGPR' LE '12').ZG11R                     00133700
.ZG11Q               ANOP  ,                                            00133800
&ZMS                 SETC  '"JCLPROC='                                  00133900
&ZMS                 SETC  '&ZMS.&JCLPROC"'                             00134000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00134100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00134200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00134300
.ZG11R               ANOP  ,                                            00134400
.*----------------------------------------------------------------***   00134500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00134600
                     AIF   (N'&JCLPARMS LE 1).ZG14A  CK NUM             00134700
&ZMS                 SETC  '"JCLPARMS='                                 00134800
&ZMS                 SETC  '&ZMS.&JCLPARMS"'                            00134900
&ZMS                 SETC  '&ZMS "JCLPARMS"'                            00135000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00135100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00135200
.ZG14A               ANOP  ,                                            00135300
.*-------------------------------------------------------------------   00135400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00135500
&ZXJCLPARMS          SETC  'INPUT'     SET IN/OUTPUT                    00135600
&XJCLPARMS           SETC  '0'                                          00135700
                     AIF   (K'&JCLPARMS(1) LE 0).ZG14B  PARM            00135800
&XJCLPARMS           SETC  '&JCLPARMS(1)'       SET XVARIABLE           00135900
                     AIF   (N'&JCLPARMS GT 1).ZG14B  MULTI              00136000
&XJCLPARMS           SETC  '&JCLPARMS'          SET XVARIABLE           00136100
.ZG14B               ANOP  ,                                            00136200
.*-------------------------------------------------------------------   00136300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00136400
                     AIF   (K'&ZXJCLPARMS LE 0).ZG14R  NOT I/O          00136500
                     AIF   ('&XJCLPARMS'(1,1) NE '(').ZG14R             00136600
&ZCGPR               SETC  '&XJCLPARMS'(2,K'&XJCLPARMS-2)               00136700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                 00136800
                     AIF   (K'&ZCGPR GT 2).ZG14Q                        00136900
                     AIF   ('&ZCGPR' EQ '0').ZG14Q                      00137000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00137100
                     AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME    00137200
.ZG14P               ANOP  ,                                            00137300
                     AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC         00137400
                     AIF   ('&ZCGPR' LT '2').ZG14Q                      00137500
                     AIF   ('&ZCGPR' LE '12').ZG14R                     00137600
.ZG14Q               ANOP  ,                                            00137700
&ZMS                 SETC  '"JCLPARMS='                                 00137800
&ZMS                 SETC  '&ZMS.&JCLPARMS"'                            00137900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00138000
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00138100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00138200
.ZG14R               ANOP  ,                                            00138300
.*------------------------------------------------------------------    00138400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138500
&XJOBSPACE           SETC  ''          INITIALIZE XVARIABLE             00138600
.*-------------------------------------------------------------------   00138700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138800
.ZG18                ANOP  ,                                            00138900
                     AIF   (K'&JOBSPACE(1) LE 0).ZG18A                  00139000
&ZTLC                SETC 'NO'                                          00139100
                     AIF   ('&JOBSPACE(1)' NE '&ZTLC').ZG19             00139200
&XJOBSPACE           SETC  'NO'        SET KEYWORD                      00139300
                     AIF   (N'&JOBSPACE LE 1).ZG18A  CK NUM             00139400
&ZMS                 SETC  '"JOBSPACE='                                 00139500
&ZMS                 SETC  '&ZMS.&JOBSPACE"'                            00139600
&ZMS                 SETC  '&ZMS "JOBSPACE"'                            00139700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00139800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00139900
.ZG18A               ANOP  ,                                            00140000
.*-------------------------------------------------------------------   00140100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140200
.ZG19                ANOP  ,                                            00140300
&ZTLC                SETC 'YES'                                         00140400
                     AIF   ('&JOBSPACE(1)' NE '&ZTLC').ZG20             00140500
&XJOBSPACE           SETC  'YES'       SET KEYWORD                      00140600
                     AIF   (N'&JOBSPACE LE 1).ZG19A  CK NUM             00140700
&ZMS                 SETC  '"JOBSPACE='                                 00140800
&ZMS                 SETC  '&ZMS.&JOBSPACE"'                            00140900
&ZMS                 SETC  '&ZMS "JOBSPACE"'                            00141000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00141100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00141200
.ZG19A               ANOP  ,                                            00141300
.*------------------------------------------------------------------    00141400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141500
.ZG20                ANOP  ,                                            00141600
&ZXJOBSPACE          SETC  'INPUT'     SET IN/OUTPUT                    00141700
                     AIF   (K'&XJOBSPACE GT 0).ZG20E  VALID ARG         00141800
                     AIF   (T'&JOBSPACE EQ 'O').ZG20D  OMITTED          00141900
&ZASYSLNDX           SETA  0                                            00142000
.ZG20A               ANOP  ,           POSITIONAL MACRO KEY             00142100
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00142200
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG20C             00142300
&ZTLC                SETC 'JOBSPACE'                                    00142400
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG20A    00142500
.ZG20B               ANOP  ,                                            00142600
&ZXJOBSPACE          SETC  ''          RESET IN/OUTPUT                  00142700
&ZMS                 SETC  'THE "JOBSPACE" KEY'                         00142800
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00142900
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00143000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00143100
                     AGO   .ZG20E                                       00143200
.ZG20C               ANOP  ,                                            00143300
&ZXJOBSPACE          SETC  ''          RESET IN/OUTPUT                  00143400
&ZMS                 SETC  '"JOBSPACE='                                 00143500
&ZMS                 SETC  '&ZMS.&JOBSPACE"'                            00143600
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00143700
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00143800
&ZMS                 SETC  '&ZMS "NO"'                                  00143900
&ZMS                 SETC  '&ZMS OR "YES".'                             00144000
                     MNOTE 8,' &ZMS '                                   00144100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00144200
                     AGO   .ZG20E                                       00144300
.ZG20D               ANOP  ,                                            00144400
&XJOBSPACE           SETC  'NO'        SET DEFAULT KEYWORD              00144500
.ZG20E               ANOP  ,                                            00144600
.*------------------------------------------------------------------    00144700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144800
&XSINGLE_SERVER      SETC  ''          INITIALIZE XVARIABLE             00144900
.*-------------------------------------------------------------------   00145000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145100
.ZG23                ANOP  ,                                            00145200
                     AIF   (K'&SINGLE_SERVER(1) LE 0).ZG23A             00145300
&ZTLC                SETC 'NO'                                          00145400
                     AIF   ('&SINGLE_SERVER(1)' NE '&ZTLC').ZG24        00145500
&XSINGLE_SERVER      SETC  'NO'        SET KEYWORD                      00145600
                     AIF   (N'&SINGLE_SERVER LE 1).ZG23A  CK NUM        00145700
&ZMS                 SETC  '"SINGLE_SERVER='                            00145800
&ZMS                 SETC  '&ZMS.&SINGLE_SERVER"'                       00145900
&ZMS                 SETC  '&ZMS "SINGLE_SERVER"'                       00146000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00146100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00146200
.ZG23A               ANOP  ,                                            00146300
.*-------------------------------------------------------------------   00146400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00146500
.ZG24                ANOP  ,                                            00146600
&ZTLC                SETC 'YES'                                         00146700
                     AIF   ('&SINGLE_SERVER(1)' NE '&ZTLC').ZG25        00146800
&XSINGLE_SERVER      SETC  'YES'       SET KEYWORD                      00146900
                     AIF   (N'&SINGLE_SERVER LE 1).ZG24A  CK NUM        00147000
&ZMS                 SETC  '"SINGLE_SERVER='                            00147100
&ZMS                 SETC  '&ZMS.&SINGLE_SERVER"'                       00147200
&ZMS                 SETC  '&ZMS "SINGLE_SERVER"'                       00147300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00147400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00147500
.ZG24A               ANOP  ,                                            00147600
.*------------------------------------------------------------------    00147700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00147800
.ZG25                ANOP  ,                                            00147900
&ZXSINGLE_SERVER     SETC  'INPUT'     SET IN/OUTPUT                    00148000
                     AIF   (K'&XSINGLE_SERVER GT 0).ZG25E  VALID ARG    00148100
                     AIF   (T'&SINGLE_SERVER EQ 'O').ZG25D  OMITTED     00148200
&ZASYSLNDX           SETA  0                                            00148300
.ZG25A               ANOP  ,           POSITIONAL MACRO KEY             00148400
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00148500
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C             00148600
&ZTLC                SETC 'SINGLE_SERVER'                               00148700
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG25A    00148800
.ZG25B               ANOP  ,                                            00148900
&ZXSINGLE_SERVER     SETC  ''          RESET IN/OUTPUT                  00149000
&ZMS                 SETC  'THE "SINGLE_SERVER" KEY'                    00149100
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00149200
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00149300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00149400
                     AGO   .ZG25E                                       00149500
.ZG25C               ANOP  ,                                            00149600
&ZXSINGLE_SERVER     SETC  ''          RESET IN/OUTPUT                  00149700
&ZMS                 SETC  '"SINGLE_SERVER='                            00149800
&ZMS                 SETC  '&ZMS.&SINGLE_SERVER"'                       00149900
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00150000
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00150100
&ZMS                 SETC  '&ZMS "NO"'                                  00150200
&ZMS                 SETC  '&ZMS OR "YES".'                             00150300
                     MNOTE 8,' &ZMS '                                   00150400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00150500
                     AGO   .ZG25E                                       00150600
.ZG25D               ANOP  ,                                            00150700
&XSINGLE_SERVER      SETC  'NO'        SET DEFAULT KEYWORD              00150800
.ZG25E               ANOP  ,                                            00150900
.*----------------------------------------------------------------***   00151000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00151100
                     AIF   (N'&SELECT_POLICY LE 1).ZG27A  CK NUM        00151200
&ZMS                 SETC  '"SELECT_POLICY='                            00151300
&ZMS                 SETC  '&ZMS.&SELECT_POLICY"'                       00151400
&ZMS                 SETC  '&ZMS "SELECT_POLICY"'                       00151500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00151600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00151700
.ZG27A               ANOP  ,                                            00151800
.*-------------------------------------------------------------------   00151900
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00152000
&ZXSELECT_POLICY     SETC  'INPUT'     SET IN/OUTPUT                    00152100
&XSELECT_POLICY      SETC  '0'                                          00152200
                     AIF   (K'&SELECT_POLICY(1) LE 0).ZG27B  PARM       00152300
&XSELECT_POLICY      SETC  '&SELECT_POLICY(1)'  SET XVARIABLE           00152400
                     AIF   (N'&SELECT_POLICY GT 1).ZG27B  MULTI         00152500
&XSELECT_POLICY      SETC  '&SELECT_POLICY'     SET XVARIABLE           00152600
.ZG27B               ANOP  ,                                            00152700
.*-------------------------------------------------------------------   00152800
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00152900
                     AIF   (K'&ZXSELECT_POLICY LE 0).ZG27R  NOT I/O     00153000
                     AIF   ('&XSELECT_POLICY'(1,1) NE '(').ZG27R        00153100
&ZCGPR               SETC  '&XSELECT_POLICY'(2,K'&XSELECT_POLICY-2)     00153200
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                 00153300
                     AIF   (K'&ZCGPR GT 2).ZG27Q                        00153400
                     AIF   ('&ZCGPR' EQ '0').ZG27Q                      00153500
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00153600
                     AIF   (T'&ZCGPR NE 'N').ZG27Q  INVALID REG NAME    00153700
.ZG27P               ANOP  ,                                            00153800
                     AIF   (T'&ZCGPR NE 'N').ZG27R  NON NUMERIC         00153900
                     AIF   ('&ZCGPR' LT '2').ZG27Q                      00154000
                     AIF   ('&ZCGPR' LE '12').ZG27R                     00154100
.ZG27Q               ANOP  ,                                            00154200
&ZMS                 SETC  '"SELECT_POLICY='                            00154300
&ZMS                 SETC  '&ZMS.&SELECT_POLICY"'                       00154400
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00154500
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00154600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00154700
.ZG27R               ANOP  ,                                            00154800
.*------------------------------------------------------------------    00154900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155000
&XDISTRIBUTE_WORK    SETC  ''          INITIALIZE XVARIABLE             00155100
.*-------------------------------------------------------------------   00155200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155300
.ZG31                ANOP  ,                                            00155400
                     AIF   (K'&DISTRIBUTE_WORK(1) LE 0).ZG31A           00155500
&ZTLC                SETC 'FIRST_AVAILABLE'                             00155600
                     AIF   ('&DISTRIBUTE_WORK(1)' NE '&ZTLC').ZG32      00155700
&XDISTRIBUTE_WORK    SETC  'FIRST_AVAILABLE'    SET KEYWORD             00155800
                     AIF   (N'&DISTRIBUTE_WORK LE 1).ZG31A  CK NUM      00155900
&ZMS                 SETC  '"DISTRIBUTE_WORK='                          00156000
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00156100
&ZMS                 SETC  '&ZMS "DISTRIBUTE_WORK"'                     00156200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00156300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00156400
.ZG31A               ANOP  ,                                            00156500
.*-------------------------------------------------------------------   00156600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00156700
.ZG32                ANOP  ,                                            00156800
&ZTLC                SETC 'ROUND_ROBIN'                                 00156900
                     AIF   ('&DISTRIBUTE_WORK(1)' NE '&ZTLC').ZG33      00157000
&XDISTRIBUTE_WORK    SETC  'ROUND_ROBIN'        SET KEYWORD             00157100
                     AIF   (N'&DISTRIBUTE_WORK LE 1).ZG32A  CK NUM      00157200
&ZMS                 SETC  '"DISTRIBUTE_WORK='                          00157300
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00157400
&ZMS                 SETC  '&ZMS "DISTRIBUTE_WORK"'                     00157500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00157600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00157700
.ZG32A               ANOP  ,                                            00157800
.*------------------------------------------------------------------    00157900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158000
.ZG33                ANOP  ,                                            00158100
&ZXDISTRIBUTE_WORK   SETC  'INPUT'     SET IN/OUTPUT                    00158200
                     AIF   (K'&XDISTRIBUTE_WORK GT 0).ZG33E  VALID ARG  00158300
                     AIF   (T'&DISTRIBUTE_WORK EQ 'O').ZG33D  OMITTED   00158400
&ZASYSLNDX           SETA  0                                            00158500
.ZG33A               ANOP  ,           POSITIONAL MACRO KEY             00158600
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00158700
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG33C             00158800
&ZTLC                SETC 'DISTRIBUTE_WORK'                             00158900
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG33A    00159000
.ZG33B               ANOP  ,                                            00159100
&ZXDISTRIBUTE_WORK   SETC  ''          RESET IN/OUTPUT                  00159200
&ZMS                 SETC  'THE "DISTRIBUTE_WORK" KEY'                  00159300
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00159400
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00159500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00159600
                     AGO   .ZG33E                                       00159700
.ZG33C               ANOP  ,                                            00159800
&ZXDISTRIBUTE_WORK   SETC  ''          RESET IN/OUTPUT                  00159900
&ZMS                 SETC  '"DISTRIBUTE_WORK='                          00160000
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00160100
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00160200
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00160300
&ZMS                 SETC  '&ZMS "FIRST_AVAILABLE"'                     00160400
&ZMS                 SETC  '&ZMS OR "ROUND_ROBIN".'                     00160500
                     MNOTE 8,' &ZMS '                                   00160600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00160700
                     AGO   .ZG33E                                       00160800
.ZG33D               ANOP  ,                                            00160900
&XDISTRIBUTE_WORK    SETC  'FIRST_AVAILABLE'    SET DEFAULT KEYWORD     00161000
.ZG33E               ANOP  ,                                            00161100
.*-------------------------------------------------------------------   00161200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00161300
.ZG34                ANOP  ,                                            00161400
&ZTLC                SETC 'DELETE'                                      00161500
                     AIF   ('&FUNC(1)' NE '&ZTLC').ZG38                 00161600
&XFUNC               SETC  'DELETE'    SET KEYWORD                      00161700
                     AIF   (N'&FUNC LE 1).ZG34A  CK NUM                 00161800
&ZMS                 SETC  '"FUNC='                                     00161900
&ZMS                 SETC  '&ZMS.&FUNC"'                                00162000
&ZMS                 SETC  '&ZMS "FUNC"'                                00162100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00162200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00162300
.ZG34A               ANOP  ,                                            00162400
.*------------------------------------------------------------------    00162500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00162600
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00162700
.ZG34A0              AIF   (K'&JCLPROC LE 0).ZG34A1  OK                 00162800
&ZCVAL               SETC '&ZCVAL JCLPROC'      INCORRECT KEY USED      00162900
.ZG34A1              AIF   (K'&JCLPARMS LE 0).ZG34A2  OK                00163000
&ZCVAL               SETC '&ZCVAL JCLPARMS'     INCORRECT KEY USED      00163100
.ZG34A2              AIF   (K'&JOBSPACE LE 0).ZG34A3  OK                00163200
&ZCVAL               SETC '&ZCVAL JOBSPACE'     INCORRECT KEY USED      00163300
.ZG34A3              AIF   (K'&SINGLE_SERVER LE 0).ZG34A4  OK           00163400
&ZCVAL               SETC '&ZCVAL SINGLE_SERVER'  INCORRECT KEY USED    00163500
.ZG34A4              AIF   (K'&SELECT_POLICY LE 0).ZG34A5  OK           00163600
&ZCVAL               SETC '&ZCVAL SELECT_POLICY'  INCORRECT KEY USED    00163700
.ZG34A5              AIF   (K'&DISTRIBUTE_WORK LE 0).ZG34A6  OK         00163800
&ZCVAL               SETC '&ZCVAL DISTRIBUTE_WORK'  INCORRECT KEY USED  00163900
.ZG34A6              AIF   (K'&STATIC LE 0).ZG34A7  OK                  00164000
&ZCVAL               SETC '&ZCVAL STATIC'       INCORRECT KEY USED      00164100
.ZG34A7              AIF   (K'&ZCVAL LE 0).ZG34A8  OK                   00164200
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00164300
&ZMS                 SETC  '"FUNC'                                      00164400
&ZMS                 SETC  '&ZMS.=&FUNC"'                               00164500
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00164600
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00164700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00164800
.ZG34A8              ANOP  ,                                            00164900
.*----------------------------------------------------------------***   00165000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00165100
                     AIF   (N'&APPLENV LE 1).ZG36A  CK NUM              00165200
&ZMS                 SETC  '"APPLENV='                                  00165300
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00165400
&ZMS                 SETC  '&ZMS "APPLENV"'                             00165500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00165600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00165700
.ZG36A               ANOP  ,                                            00165800
.*-------------------------------------------------------------------   00165900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00166000
&ZXAPPLENV           SETC  'INPUT'     SET IN/OUTPUT                    00166100
&XAPPLENV            SETC  '&APPLENV(1)'        SET XVARIABLE           00166200
                     AIF   (N'&APPLENV GT 1).ZG36B  MULTI PARMS         00166300
&XAPPLENV            SETC  '&APPLENV'  SET XVARIABLE                    00166400
.ZG36B               AIF   (K'&APPLENV(1) GT 0).ZG36C                   00166500
&ZXAPPLENV           SETC  ''          RESET IN/OUTPUT                  00166600
&ZMS                 SETC  ' '                                          00166700
&ZMS                 SETC  '&ZMS "APPLENV" KEY AND ITS'                 00166800
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00166900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00167000
.ZG36C               ANOP  ,                                            00167100
.*-------------------------------------------------------------------   00167200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00167300
                     AIF   (K'&ZXAPPLENV LE 0).ZG36R  NOT I/O           00167400
                     AIF   ('&XAPPLENV'(1,1) NE '(').ZG36R              00167500
&ZCGPR               SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                 00167600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG36P                 00167700
                     AIF   (K'&ZCGPR GT 2).ZG36Q                        00167800
                     AIF   ('&ZCGPR' EQ '0').ZG36Q                      00167900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00168000
                     AIF   (T'&ZCGPR NE 'N').ZG36Q  INVALID REG NAME    00168100
.ZG36P               ANOP  ,                                            00168200
                     AIF   (T'&ZCGPR NE 'N').ZG36R  NON NUMERIC         00168300
                     AIF   ('&ZCGPR' LT '2').ZG36Q                      00168400
                     AIF   ('&ZCGPR' LE '12').ZG36R                     00168500
.ZG36Q               ANOP  ,                                            00168600
&ZMS                 SETC  '"APPLENV='                                  00168700
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00168800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00168900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00169000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00169100
.ZG36R               ANOP  ,                                            00169200
.*-------------------------------------------------------------------   00169300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169400
.ZG38                ANOP  ,                                            00169500
&ZTLC                SETC 'MODIFY'                                      00169600
                     AIF   ('&FUNC(1)' NE '&ZTLC').ZG52                 00169700
&XFUNC               SETC  'MODIFY'    SET KEYWORD                      00169800
                     AIF   (N'&FUNC LE 1).ZG38A  CK NUM                 00169900
&ZMS                 SETC  '"FUNC='                                     00170000
&ZMS                 SETC  '&ZMS.&FUNC"'                                00170100
&ZMS                 SETC  '&ZMS "FUNC"'                                00170200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00170300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00170400
.ZG38A               ANOP  ,                                            00170500
.*------------------------------------------------------------------    00170600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170700
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00170800
.ZG38A0              AIF   (K'&JCLPROC LE 0).ZG38A1  OK                 00170900
&ZCVAL               SETC '&ZCVAL JCLPROC'      INCORRECT KEY USED      00171000
.ZG38A1              AIF   (K'&JCLPARMS LE 0).ZG38A2  OK                00171100
&ZCVAL               SETC '&ZCVAL JCLPARMS'     INCORRECT KEY USED      00171200
.ZG38A2              AIF   (K'&JOBSPACE LE 0).ZG38A3  OK                00171300
&ZCVAL               SETC '&ZCVAL JOBSPACE'     INCORRECT KEY USED      00171400
.ZG38A3              AIF   (K'&SINGLE_SERVER LE 0).ZG38A4  OK           00171500
&ZCVAL               SETC '&ZCVAL SINGLE_SERVER'  INCORRECT KEY USED    00171600
.ZG38A4              AIF   (K'&SELECT_POLICY LE 0).ZG38A5  OK           00171700
&ZCVAL               SETC '&ZCVAL SELECT_POLICY'  INCORRECT KEY USED    00171800
.ZG38A5              AIF   (K'&ZCVAL LE 0).ZG38A6  OK                   00171900
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00172000
&ZMS                 SETC  '"FUNC'                                      00172100
&ZMS                 SETC  '&ZMS.=&FUNC"'                               00172200
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00172300
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00172400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00172500
.ZG38A6              ANOP  ,                                            00172600
.*----------------------------------------------------------------***   00172700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00172800
                     AIF   (N'&APPLENV LE 1).ZG40A  CK NUM              00172900
&ZMS                 SETC  '"APPLENV='                                  00173000
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00173100
&ZMS                 SETC  '&ZMS "APPLENV"'                             00173200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00173300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00173400
.ZG40A               ANOP  ,                                            00173500
.*-------------------------------------------------------------------   00173600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00173700
&ZXAPPLENV           SETC  'INPUT'     SET IN/OUTPUT                    00173800
&XAPPLENV            SETC  '&APPLENV(1)'        SET XVARIABLE           00173900
                     AIF   (N'&APPLENV GT 1).ZG40B  MULTI PARMS         00174000
&XAPPLENV            SETC  '&APPLENV'  SET XVARIABLE                    00174100
.ZG40B               AIF   (K'&APPLENV(1) GT 0).ZG40C                   00174200
&ZXAPPLENV           SETC  ''          RESET IN/OUTPUT                  00174300
&ZMS                 SETC  ' '                                          00174400
&ZMS                 SETC  '&ZMS "APPLENV" KEY AND ITS'                 00174500
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00174600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00174700
.ZG40C               ANOP  ,                                            00174800
.*-------------------------------------------------------------------   00174900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00175000
                     AIF   (K'&ZXAPPLENV LE 0).ZG40R  NOT I/O           00175100
                     AIF   ('&XAPPLENV'(1,1) NE '(').ZG40R              00175200
&ZCGPR               SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                 00175300
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                 00175400
                     AIF   (K'&ZCGPR GT 2).ZG40Q                        00175500
                     AIF   ('&ZCGPR' EQ '0').ZG40Q                      00175600
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00175700
                     AIF   (T'&ZCGPR NE 'N').ZG40Q  INVALID REG NAME    00175800
.ZG40P               ANOP  ,                                            00175900
                     AIF   (T'&ZCGPR NE 'N').ZG40R  NON NUMERIC         00176000
                     AIF   ('&ZCGPR' LT '2').ZG40Q                      00176100
                     AIF   ('&ZCGPR' LE '12').ZG40R                     00176200
.ZG40Q               ANOP  ,                                            00176300
&ZMS                 SETC  '"APPLENV='                                  00176400
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00176500
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00176600
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00176700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00176800
.ZG40R               ANOP  ,                                            00176900
.*------------------------------------------------------------------    00177000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177100
&XDISTRIBUTE_WORK    SETC  ''          INITIALIZE XVARIABLE             00177200
.*-------------------------------------------------------------------   00177300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177400
.ZG44                ANOP  ,                                            00177500
                     AIF   (K'&DISTRIBUTE_WORK(1) LE 0).ZG44A           00177600
&ZTLC                SETC 'FIRST_AVAILABLE'                             00177700
                     AIF   ('&DISTRIBUTE_WORK(1)' NE '&ZTLC').ZG45      00177800
&XDISTRIBUTE_WORK    SETC  'FIRST_AVAILABLE'    SET KEYWORD             00177900
                     AIF   (N'&DISTRIBUTE_WORK LE 1).ZG44A  CK NUM      00178000
&ZMS                 SETC  '"DISTRIBUTE_WORK='                          00178100
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00178200
&ZMS                 SETC  '&ZMS "DISTRIBUTE_WORK"'                     00178300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00178400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00178500
.ZG44A               ANOP  ,                                            00178600
.*-------------------------------------------------------------------   00178700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00178800
.ZG45                ANOP  ,                                            00178900
&ZTLC                SETC 'ROUND_ROBIN'                                 00179000
                     AIF   ('&DISTRIBUTE_WORK(1)' NE '&ZTLC').ZG46      00179100
&XDISTRIBUTE_WORK    SETC  'ROUND_ROBIN'        SET KEYWORD             00179200
                     AIF   (N'&DISTRIBUTE_WORK LE 1).ZG45A  CK NUM      00179300
&ZMS                 SETC  '"DISTRIBUTE_WORK='                          00179400
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00179500
&ZMS                 SETC  '&ZMS "DISTRIBUTE_WORK"'                     00179600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00179700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00179800
.ZG45A               ANOP  ,                                            00179900
.*------------------------------------------------------------------    00180000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180100
.ZG46                ANOP  ,                                            00180200
&ZXDISTRIBUTE_WORK   SETC  'INPUT'     SET IN/OUTPUT                    00180300
                     AIF   (K'&XDISTRIBUTE_WORK GT 0).ZG46E  VALID ARG  00180400
                     AIF   (T'&DISTRIBUTE_WORK EQ 'O').ZG46D  OMITTED   00180500
&ZASYSLNDX           SETA  0                                            00180600
.ZG46A               ANOP  ,           POSITIONAL MACRO KEY             00180700
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00180800
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG46C             00180900
&ZTLC                SETC 'DISTRIBUTE_WORK'                             00181000
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG46A    00181100
.ZG46B               ANOP  ,                                            00181200
&ZXDISTRIBUTE_WORK   SETC  ''          RESET IN/OUTPUT                  00181300
&ZMS                 SETC  'THE "DISTRIBUTE_WORK" KEY'                  00181400
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00181500
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00181600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00181700
                     AGO   .ZG46E                                       00181800
.ZG46C               ANOP  ,                                            00181900
&ZXDISTRIBUTE_WORK   SETC  ''          RESET IN/OUTPUT                  00182000
&ZMS                 SETC  '"DISTRIBUTE_WORK='                          00182100
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00182200
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00182300
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00182400
&ZMS                 SETC  '&ZMS "FIRST_AVAILABLE"'                     00182500
&ZMS                 SETC  '&ZMS OR "ROUND_ROBIN".'                     00182600
                     MNOTE 8,' &ZMS '                                   00182700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00182800
                     AGO   .ZG46E                                       00182900
.ZG46D               ANOP  ,                                            00183000
&XDISTRIBUTE_WORK    SETC  'FIRST_AVAILABLE'    SET DEFAULT KEYWORD     00183100
.ZG46E               ANOP  ,                                            00183200
.*------------------------------------------------------------------    00183300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183400
&XSTATIC             SETC  ''          INITIALIZE XVARIABLE             00183500
.*-------------------------------------------------------------------   00183600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183700
.ZG49                ANOP  ,                                            00183800
                     AIF   (K'&STATIC(1) LE 0).ZG49A                    00183900
&ZTLC                SETC 'NO'                                          00184000
                     AIF   ('&STATIC(1)' NE '&ZTLC').ZG50               00184100
&XSTATIC             SETC  'NO'        SET KEYWORD                      00184200
                     AIF   (N'&STATIC LE 1).ZG49A  CK NUM               00184300
&ZMS                 SETC  '"STATIC='                                   00184400
&ZMS                 SETC  '&ZMS.&STATIC"'                              00184500
&ZMS                 SETC  '&ZMS "STATIC"'                              00184600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00184700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00184800
.ZG49A               ANOP  ,                                            00184900
.*-------------------------------------------------------------------   00185000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00185100
.ZG50                ANOP  ,                                            00185200
&ZTLC                SETC 'YES'                                         00185300
                     AIF   ('&STATIC(1)' NE '&ZTLC').ZG51               00185400
&XSTATIC             SETC  'YES'       SET KEYWORD                      00185500
                     AIF   (N'&STATIC LE 1).ZG50A  CK NUM               00185600
&ZMS                 SETC  '"STATIC='                                   00185700
&ZMS                 SETC  '&ZMS.&STATIC"'                              00185800
&ZMS                 SETC  '&ZMS "STATIC"'                              00185900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00186000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00186100
.ZG50A               ANOP  ,                                            00186200
.*------------------------------------------------------------------    00186300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00186400
.ZG51                ANOP  ,                                            00186500
&ZXSTATIC            SETC  'INPUT'     SET IN/OUTPUT                    00186600
                     AIF   (K'&XSTATIC GT 0).ZG51E  VALID ARG           00186700
                     AIF   (T'&STATIC EQ 'O').ZG51D  OMITTED            00186800
&ZASYSLNDX           SETA  0                                            00186900
.ZG51A               ANOP  ,           POSITIONAL MACRO KEY             00187000
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00187100
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG51C             00187200
&ZTLC                SETC 'STATIC'                                      00187300
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG51A    00187400
.ZG51B               ANOP  ,                                            00187500
&ZXSTATIC            SETC  ''          RESET IN/OUTPUT                  00187600
&ZMS                 SETC  'THE "STATIC" KEY'                           00187700
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00187800
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00187900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00188000
                     AGO   .ZG51E                                       00188100
.ZG51C               ANOP  ,                                            00188200
&ZXSTATIC            SETC  ''          RESET IN/OUTPUT                  00188300
&ZMS                 SETC  '"STATIC='                                   00188400
&ZMS                 SETC  '&ZMS.&STATIC"'                              00188500
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00188600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00188700
&ZMS                 SETC  '&ZMS "NO"'                                  00188800
&ZMS                 SETC  '&ZMS OR "YES".'                             00188900
                     MNOTE 8,' &ZMS '                                   00189000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00189100
                     AGO   .ZG51E                                       00189200
.ZG51D               ANOP  ,                                            00189300
&XSTATIC             SETC  'NO'        SET DEFAULT KEYWORD              00189400
.ZG51E               ANOP  ,                                            00189500
.*------------------------------------------------------------------    00189600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00189700
.ZG52                ANOP  ,                                            00189800
&ZXFUNC              SETC  'INPUT'     SET IN/OUTPUT                    00189900
                     AIF   (K'&XFUNC GT 0).ZG52E  VALID ARG             00190000
                     AIF   (T'&FUNC EQ 'O').ZG52D  OMITTED              00190100
&ZASYSLNDX           SETA  0                                            00190200
.ZG52A               ANOP  ,           POSITIONAL MACRO KEY             00190300
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00190400
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG52C             00190500
&ZTLC                SETC 'FUNC'                                        00190600
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG52A    00190700
.ZG52B               ANOP  ,                                            00190800
&ZXFUNC              SETC  ''          RESET IN/OUTPUT                  00190900
&ZMS                 SETC  'THE "FUNC" KEY'                             00191000
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00191100
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00191200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00191300
                     AGO   .ZG52E                                       00191400
.ZG52C               ANOP  ,                                            00191500
&ZXFUNC              SETC  ''          RESET IN/OUTPUT                  00191600
&ZMS                 SETC  '"FUNC='                                     00191700
&ZMS                 SETC  '&ZMS.&FUNC"'                                00191800
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00191900
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00192000
&ZMS                 SETC  '&ZMS "ADD",'                                00192100
&ZMS                 SETC  '&ZMS "DELETE",'                             00192200
&ZMS                 SETC  '&ZMS OR "MODIFY".'                          00192300
                     MNOTE 8,' &ZMS '                                   00192400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00192500
                     AGO   .ZG52E                                       00192600
.ZG52D               ANOP  ,                                            00192700
&XFUNC               SETC  'ADD'       SET DEFAULT KEYWORD              00192800
.ZG52E               ANOP  ,                                            00192900
.*------------------------------------------------------------------    00193000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00193100
                     AIF   (K'&FUNC(1) GT 0).ZG52F  PARM                00193200
&XFUNC               SETC  ''          ENSURE NULL KEYWORD              00193300
&ZXFUNC              SETC  ''          RESET IN/OUTPUT                  00193400
&ZMS                 SETC  'THE'                                        00193500
&ZMS                 SETC  '&ZMS "FUNC" KEY AND ITS'                    00193600
&ZMS                 SETC  '&ZMS ARGUMENT ARE REQUIRED.'                00193700
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00193800
&ZMS                 SETC  '&ZMS "ADD",'                                00193900
&ZMS                 SETC  '&ZMS "DELETE",'                             00194000
&ZMS                 SETC  '&ZMS OR "MODIFY".'                          00194100
                     MNOTE 8,' &ZMS '                                   00194200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00194300
.ZG52F               ANOP  ,                                            00194400
.*----------------------------------------------------------------***   00194500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00194600
                     AIF   (N'&RETCODE LE 1).ZG54A  CK NUM              00194700
&ZMS                 SETC  '"RETCODE='                                  00194800
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00194900
&ZMS                 SETC  '&ZMS "RETCODE"'                             00195000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00195100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00195200
.ZG54A               ANOP  ,                                            00195300
.*-------------------------------------------------------------------   00195400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00195500
                     AIF   (K'&RETCODE(1) LE 0).ZG54C  NO PARM          00195600
&ZXRETCODE           SETC  'OUTPUT'    SET OUTPUT                       00195700
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00195800
                     AIF   (N'&RETCODE GT 1).ZG54C                      00195900
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00196000
.ZG54C               ANOP  ,                                            00196100
.*-------------------------------------------------------------------   00196200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00196300
                     AIF   (K'&ZXRETCODE LE 0).ZG54R  NOT I/O           00196400
                     AIF   ('&XRETCODE'(1,1) NE '(').ZG54R              00196500
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00196600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG54P                 00196700
                     AIF   (K'&ZCGPR GT 2).ZG54Q                        00196800
                     AIF   ('&ZCGPR' EQ '0').ZG54Q                      00196900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00197000
                     AIF   (T'&ZCGPR NE 'N').ZG54Q  INVALID REG NAME    00197100
.ZG54P               ANOP  ,                                            00197200
                     AIF   (T'&ZCGPR NE 'N').ZG54R  NON NUMERIC         00197300
                     AIF   ('&ZCGPR' EQ '15').ZG54R                     00197400
                     AIF   ('&ZCGPR' LT '2').ZG54Q                      00197500
                     AIF   ('&ZCGPR' LE '12').ZG54R                     00197600
.ZG54Q               ANOP  ,                                            00197700
&ZMS                 SETC  '"RETCODE='                                  00197800
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00197900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00198000
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'     00198100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00198200
.ZG54R               ANOP  ,                                            00198300
.*----------------------------------------------------------------***   00198400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00198500
                     AIF   (N'&RSNCODE LE 1).ZG57A  CK NUM              00198600
&ZMS                 SETC  '"RSNCODE='                                  00198700
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00198800
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00198900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00199000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00199100
.ZG57A               ANOP  ,                                            00199200
.*-------------------------------------------------------------------   00199300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00199400
                     AIF   (K'&RSNCODE(1) LE 0).ZG57C  NO PARM          00199500
&ZXRSNCODE           SETC  'OUTPUT'    SET OUTPUT                       00199600
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00199700
                     AIF   (N'&RSNCODE GT 1).ZG57C                      00199800
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00199900
.ZG57C               ANOP  ,                                            00200000
.*-------------------------------------------------------------------   00200100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00200200
                     AIF   (K'&ZXRSNCODE LE 0).ZG57R  NOT I/O           00200300
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZG57R              00200400
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00200500
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG57P                 00200600
                     AIF   (K'&ZCGPR GT 2).ZG57Q                        00200700
                     AIF   ('&ZCGPR' EQ '0').ZG57R                      00200800
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00200900
                     AIF   (T'&ZCGPR NE 'N').ZG57Q  INVALID REG NAME    00201000
.ZG57P               ANOP  ,                                            00201100
                     AIF   (T'&ZCGPR NE 'N').ZG57R  NON NUMERIC         00201200
                     AIF   ('&ZCGPR' EQ '0').ZG57R                      00201300
                     AIF   ('&ZCGPR' LT '2').ZG57Q                      00201400
                     AIF   ('&ZCGPR' LE '12').ZG57R                     00201500
.ZG57Q               ANOP  ,                                            00201600
&ZMS                 SETC  '"RSNCODE='                                  00201700
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00201800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00201900
                     MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'      00202000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00202100
.ZG57R               ANOP  ,                                            00202200
.******************************************************************     00202300
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00202400
.******************************************************************     00202500
                     ACTR  10000                                        00202600
.*----------------------------------------------------------------***   00202700
.***AH.P02 EXTRA POSITIONALS                                            00202800
                     AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS         00202900
                     AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL         00203000
                     AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL     00203100
                     AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL      00203200
.ZGLISTX1            ANOP  ,                                            00203300
&ZCVAL               SETC  ''          ERROR FIELD                      00203400
&ZAWRK               SETA  0           POSITIONAL NUMBER                00203500
.ZGLIST2             ANOP  ,                                            00203600
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00203700
                     AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE         00203800
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00203900
                     AGO   .ZGLIST2                                     00204000
.*                                                                      00204100
.ZGLIST3             ANOP  ,                                            00204200
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00204300
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'                    00204400
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00204500
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00204600
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00204700
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00204800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00204900
.ZGLISTX             ANOP  ,                                            00205000
&ZASYSLNDX           SETA  0                                            00205100
.*-------------------------------------------------------------------   00205200
.***AG.MF04 MF=(SLE)                                                    00205300
.ZGMFX               ANOP  ,           END OF FULL SYNTAX CHECK         00205400
.*******************************************************************    00205500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00205600
.*******************************************************************    00205700
                     AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED         00205800
.*******************************************************************    00205900
.***AE.01  START OF IWM4AEDF MACRO CODE                                 00206000
.*******************************************************************    00206100
                     LCLC  &M0M0001                 NAME                00206200
&M0M0001             SETC  '&XLABEL'                SET NAME            00206300
                     AIF   (K'&XLABEL NE 0).XLAB2                       00206400
&M0M0001             SETC  'M00M&SYSNDX'            DEFAULT NAME        00206500
.*                                                                      00206600
.XLAB2               ANOP  ,                                            00206700
                     AIF   ('&XMF' EQ 'L').XLAB3                        00206800
&M0M0001 DS    0H                             IWM4AEDF-0                00206900
.XLAB3               ANOP  ,                                            00207000
.*******************************************************************    00207100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00207200
.*******************************************************************    00207300
              PUSH  PRINT                                               00207400
                     AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON   00207500
                     PRINT OFF         ++ PR01                          00207600
                     AGO   .ZPRNTXX                                     00207700
.ZPRINTX             PRINT ON                                           00207800
.ZPRNTXX             ANOP  ,                                            00207900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00208000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00208100
.********************************************************************   00208200
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00208300
.********************************************************************   00208400
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00208500
                      LCLA  &ZOPN1         INVOCATION INDEX             00208600
                      LCLC  &ZOPL(4095)    LABEL                        00208700
                      LCLC  &ZOPO(4095)    OPERATION                    00208800
                      LCLC  &ZOPV(4095)    VALUE                        00208900
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00209000
.*                                                                      00209100
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00209200
.******************************************************************     00209300
.***AL.L10 IWM4AEDF FMT=LIST MF=S!L PARAMETERS                          00209400
.******************************************************************     00209500
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00209600
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00209700
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00209800
&XMFATTR              SETC  '0D'                                        00209900
.*                                                                      00210000
&ZOPN                 SETA  &ZOPN+1                                     00210100
&ZOPL(&ZOPN)          SETC  ' '                                         00210200
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00210300
&ZOPV(&ZOPN)          SETC  '4,8'                                       00210400
&ZOPN                 SETA  &ZOPN+1                                     00210500
&ZOPL(&ZOPN)          SETC  ' '                                         00210600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00210700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00210800
&ZOPD(&ZOPN)          SETC  '++ IWM4AEDF ARG PARMS'                     00210900
.*                                                                      00211000
&ZOPN                 SETA  &ZOPN+1                                     00211100
&ZOPL(&ZOPN)          SETC  ' '                                         00211200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00211300
&ZOPV(&ZOPN)          SETC  '1'                                         00211400
&ZOPD(&ZOPN)          SETC  ' '                                         00211500
.*                                                                      00211600
.ZLMFSL2              ANOP  ,                                           00211700
.*-------------------------------------------------------------------   00211800
.***AM.L00  IWM4AEDF FMT=LIST name                                      00211900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00212000
&ZOPN                 SETA &ZOPN+1                                      00212100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00212200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00212300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00212400
&ZOPD(&ZOPN)          SETC '++ IWM4AEDF NAME'                           00212500
.ZLMFSL2M             ANOP  ,                                           00212600
.*-------------------------------------------------------------------   00212700
.***AM.L01  IWM4AEDF FMT=LIST PARAMETERS                                00212800
&ZOPN                 SETA &ZOPN+1                                      00212900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00213000
&ZOPO(&ZOPN)          SETC 'DS'                                         00213100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00213200
&ZOPD(&ZOPN)          SETC '++ IWM4AEDF PARM LIST'                      00213300
.*-------------------------------------------------------------------   00213400
.***AM.L02 XVERSION XL1                                                 00213500
&ZOPN                 SETA &ZOPN+1                                      00213600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00213700
&ZOPO(&ZOPN)          SETC 'DS'                                         00213800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00213900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00214000
.*-------------------------------------------------------------------   00214100
.***AM.L03 XOPTIONS BL.8                                                00214200
&ZOPN                 SETA &ZOPN+1                                      00214300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPTIONS'                         00214400
&ZOPO(&ZOPN)          SETC 'DS'                                         00214500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00214600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00214700
.*                                                                      00214800
&ZOPN                 SETA  &ZOPN+1                                     00214900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._IWM4AEDF'                        00215000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00215100
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00215200
&ZOPD(&ZOPN)          SETC  '++ MACUSED.'                               00215300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IWM4AEDF'                     00215400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00215500
.*-------------------------------------------------------------------   00215600
.***AM.L09  XPLISTLEN XL2                                               00215700
&ZOPN                 SETA &ZOPN+1                                      00215800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00215900
&ZOPO(&ZOPN)          SETC 'DS'                                         00216000
&ZOPV(&ZOPN)          SETC 'XL2'                                        00216100
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00216200
.*-------------------------------------------------------------------   00216300
.***AM.L09  XCONNTKN BL.32                                              00216400
&ZOPN                 SETA &ZOPN+1                                      00216500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         00216600
&ZOPO(&ZOPN)          SETC 'DS'                                         00216700
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00216800
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN '                             00216900
.*-------------------------------------------------------------------   00217000
.***AM.L03 XFUNC_OPTIONS BL.8                                           00217100
&ZOPN                 SETA &ZOPN+1                                      00217200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNC_OPTIONS'                    00217300
&ZOPO(&ZOPN)          SETC 'DS'                                         00217400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00217500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00217600
.*                                                                      00217700
&ZOPN                 SETA  &ZOPN+1                                     00217800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_ADD'                       00217900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00218000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00218100
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00218200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ADD'                          00218300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00218400
.*                                                                      00218500
&ZOPN                 SETA  &ZOPN+1                                     00218600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_DELETE'                    00218700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00218800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00218900
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00219000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DELETE'                       00219100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00219200
.*                                                                      00219300
&ZOPN                 SETA  &ZOPN+1                                     00219400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_MODIFY'                    00219500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00219600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00219700
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00219800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MODIFY'                       00219900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00220000
.*-------------------------------------------------------------------   00220100
.***AM.L03 XAPPENV_OPTIONS BL.8                                         00220200
&ZOPN                 SETA &ZOPN+1                                      00220300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAPPENV_OPTIONS'                  00220400
&ZOPO(&ZOPN)          SETC 'DS'                                         00220500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00220600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00220700
.*                                                                      00220800
&ZOPN                 SETA  &ZOPN+1                                     00220900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSINGLE_SERVER_YES'              00221000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00221100
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00221200
&ZOPD(&ZOPN)          SETC  '++ XSINGLE_SERVER.'                        00221300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00221400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00221500
.*                                                                      00221600
&ZOPN                 SETA  &ZOPN+1                                     00221700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDISTRIBUTE_WORK_ROUND_ROBIN'    00221800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00221900
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00222000
&ZOPD(&ZOPN)          SETC  '++ XDISTRIBUTE_WORK.'                      00222100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ROUND_ROBIN'                  00222200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00222300
.*                                                                      00222400
&ZOPN                 SETA  &ZOPN+1                                     00222500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATIC_YES'                     00222600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00222700
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00222800
&ZOPD(&ZOPN)          SETC  '++ XSTATIC.'                               00222900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00223000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00223100
.*                                                                      00223200
&ZOPN                 SETA  &ZOPN+1                                     00223300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XJOBSPACE_YES'                   00223400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00223500
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00223600
&ZOPD(&ZOPN)          SETC  '++ XJOBSPACE.'                             00223700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00223800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00223900
.*-------------------------------------------------------------------   00224000
.***AM.L09  XSELECT_POLICY XL1                                          00224100
&ZOPN                 SETA &ZOPN+1                                      00224200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSELECT_POLICY'                   00224300
&ZOPO(&ZOPN)          SETC 'DS'                                         00224400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00224500
&ZOPD(&ZOPN)          SETC '++ &ZXSELECT_POLICY '                       00224600
.*-------------------------------------------------------------------   00224700
.***AM.L09  XRSV029 CL1                                                 00224800
&ZOPN                 SETA &ZOPN+1                                      00224900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV029'                          00225000
&ZOPO(&ZOPN)          SETC 'DS'                                         00225100
&ZOPV(&ZOPN)          SETC 'CL1'                                        00225200
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00225300
.*-------------------------------------------------------------------   00225400
.***AM.L09  XRSV00C CL4                                                 00225500
&ZOPN                 SETA &ZOPN+1                                      00225600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV00C'                          00225700
&ZOPO(&ZOPN)          SETC 'DS'                                         00225800
&ZOPV(&ZOPN)          SETC 'CL4'                                        00225900
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00226000
.*-------------------------------------------------------------------   00226100
.***AM.L09  XRSV010 CL4                                                 00226200
&ZOPN                 SETA &ZOPN+1                                      00226300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV010'                          00226400
&ZOPO(&ZOPN)          SETC 'DS'                                         00226500
&ZOPV(&ZOPN)          SETC 'CL4'                                        00226600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00226700
.*-------------------------------------------------------------------   00226800
.***AM.L09  XRSV014 CL4                                                 00226900
&ZOPN                 SETA &ZOPN+1                                      00227000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV014'                          00227100
&ZOPO(&ZOPN)          SETC 'DS'                                         00227200
&ZOPV(&ZOPN)          SETC 'CL4'                                        00227300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00227400
.*-------------------------------------------------------------------   00227500
.***AM.L09 ADDR64 XAPPLENV AD                                           00227600
&ZOPN                 SETA &ZOPN+1                                      00227700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAPPLENV_ADDR64'                  00227800
&ZOPO(&ZOPN)          SETC 'DS'                                         00227900
&ZOPV(&ZOPN)          SETC 'AD'                                         00228000
&ZOPD(&ZOPN)          SETC '++ &ZXAPPLENV ADDR64'                       00228100
.*-------------------------------------------------------------------   00228200
.***AM.L09 ADDR64 XJCLPROC AD                                           00228300
&ZOPN                 SETA &ZOPN+1                                      00228400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XJCLPROC_ADDR64'                  00228500
&ZOPO(&ZOPN)          SETC 'DS'                                         00228600
&ZOPV(&ZOPN)          SETC 'AD'                                         00228700
&ZOPD(&ZOPN)          SETC '++ &ZXJCLPROC ADDR64'                       00228800
.*-------------------------------------------------------------------   00228900
.***AM.L09 ADDR64 XJCLPARMS AD                                          00229000
&ZOPN                 SETA &ZOPN+1                                      00229100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XJCLPARMS_ADDR64'                 00229200
&ZOPO(&ZOPN)          SETC 'DS'                                         00229300
&ZOPV(&ZOPN)          SETC 'AD'                                         00229400
&ZOPD(&ZOPN)          SETC '++ &ZXJCLPARMS ADDR64'                      00229500
.*-------------------------------------------------------------------   00229600
.***AM.L10 END OF IWM4AEDF LIST PARAMETERS                              00229700
&ZOPN                 SETA &ZOPN+1                                      00229800
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00229900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00230000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00230100
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00230200
.*                                                                      00230300
&ZOPN                 SETA &ZOPN+1                                      00230400
&ZOPL(&ZOPN)          SETC ' '                                          00230500
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00230600
&ZOPV(&ZOPN)          SETC '1'                                          00230700
&ZOPD(&ZOPN)          SETC ' '                                          00230800
.*-------------------------------------------------------------------   00230900
.***AL.L12 IWM4AEDF FMT=LIST MF=S!L PARAMETERS                          00231000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00231100
.*                                                                      00231200
&ZOPN                 SETA  &ZOPN+1                                     00231300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00231400
&ZOPO(&ZOPN)          SETC  'DC'                                        00231500
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00231600
&ZOPD(&ZOPN)          SETC  '++ IWM4AEDF ARG PARMS'                     00231700
.*                                                                      00231800
.ZLMFSLX              ANOP  ,                                           00231900
.*-------------------------------------------------------------------   00232000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00232100
&ZPLLEN               SETA 48                                           00232200
.*                                                                      00232300
.******************************************************************     00232400
.***AI.L01 IWM4AEDF FMT=LIST FILL IN PARAMETER AREA                     00232500
.******************************************************************     00232600
                      ACTR  10000                                       00232700
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00232800
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00232900
&ZCVAL                SETC  'LAE'          XAX MODE                     00233000
.ZIMFXA               ANOP ,                                            00233100
.*                                                                      00233200
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00233300
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00233400
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00233500
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00233600
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00233700
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00233800
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00233900
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00234000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00234100
&ZOPN                 SETA  &ZOPN+1                                     00234200
&ZOPL(&ZOPN)          SETC  ' '                                         00234300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00234400
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00234500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00234600
                      AGO   .ZIMFNX                                     00234700
.*                                                                      00234800
.ZIMFN2               ANOP ,                                            00234900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00235000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00235100
&ZOPN                 SETA  &ZOPN+1                                     00235200
&ZOPL(&ZOPN)          SETC  ' '                                         00235300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00235400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00235500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00235600
                      AGO   .ZIMFNX                                     00235700
.ZIMFNX1              ANOP ,                                            00235800
&ZOPN                 SETA  &ZOPN+1                                     00235900
&ZOPL(&ZOPN)          SETC  ' '                                         00236000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00236100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00236200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00236300
.ZIMFNX               ANOP ,                                            00236400
.********************************************************************   00236500
.***AI.L02 IWM4AEDF FMT=LIST INITIALIZE PARAMETER AREA                  00236600
.********************************************************************   00236700
.***AI.L03 MF=(SLE)                                                     00236800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00236900
.*                                                                      00237000
&ZOPN                 SETA  &ZOPN+1                                     00237100
&ZOPL(&ZOPN)          SETC  ' '                                         00237200
&ZOPO(&ZOPN)          SETC  'XC'                                        00237300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00237400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00237500
.ZIMFLX               ANOP  ,                                           00237600
.*-------------------------------------------------------------------   00237700
.***AI.L05 XOPTIONS BL1                                                 00237800
&ZW                   SETC  ''                                          00237900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00238000
.*-------------------------------------------------------------------   00238100
.***AI.L08 XOPTIONS "IWM4AEDF"                                          00238200
.***      BL1'XXXXXXX1'                                                 00238300
&ZW                   SETC  '&ZW.00000001'                              00238400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00238500
.*-------------------------------------------------------------------   00238600
.***AI.L11 XOPTIONS BL1                                                 00238700
                      AIF   ('&ZCLNG' NE 'YES').ZI3E  ALL ZERO BITS     00238800
&ZOPN                 SETA  &ZOPN+1                                     00238900
&ZOPL(&ZOPN)          SETC  ' '                                         00239000
&ZOPO(&ZOPN)          SETC  'OI'                                        00239100
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00239200
&ZOPD(&ZOPN)          SETC  '++ 80 BL1'                                 00239300
.ZI3E                 ANOP  ,                                           00239400
.*-------------------------------------------------------------------   00239500
.***AI.L04 XPLISTLEN XL2                                                00239600
&ZOPN                 SETA  &ZOPN+1                                     00239700
&ZOPL(&ZOPN)          SETC  ' '                                         00239800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00239900
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      00240000
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00240100
.*-------------------------------------------------------------------   00240200
.***AI.L25  XCONNTKN XL4                                                00240300
                      AIF   ('&ZXCONNTKN' EQ '').ZI5E                   00240400
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI5E             00240500
&ZCGPR                SETC  '&XCONNTKN'                                 00240600
.*                                                                      00240700
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI5B              00240800
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    00240900
                      AGO   .ZI5D                                       00241000
.ZI5B                 ANOP  ,                                           00241100
.*                                                                      00241200
&ZC                   SETC  '&XCONNTKN'(1,1)                            00241300
                      AIF   (T'&ZC NE 'N').ZI5D                         00241400
&ZC                   SETC  '&XCONNTKN'                                 00241500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                00241600
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         00241700
.*                                                                      00241800
.ZI5D                 ANOP  ,                                           00241900
.*                                                                      00242000
&ZOPN                 SETA  &ZOPN+1                                     00242100
&ZOPL(&ZOPN)          SETC  ' '                                         00242200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00242300
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00242400
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    00242500
.*                                                                      00242600
.ZI5E                 ANOP  ,                                           00242700
.*-------------------------------------------------------------------   00242800
.***AI.L05 XFUNC_OPTIONS BL1                                            00242900
&ZW                   SETC  ''                                          00243000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00243100
.*-------------------------------------------------------------------   00243200
.***AI.L08 XFUNC_OPTIONS "ADD"                                          00243300
.***      BL1'1XXXXXXX'                                                 00243400
         AIF   ('&XFUNC' NE 'ADD').ZI7A                                 00243500
&ZW                   SETC  '&ZW.1'                                     00243600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00243700
                      AGO   .ZI7C                                       00243800
.*                                                                      00243900
.ZI7A                 ANOP  ,                                           00244000
&ZW                   SETC  '&ZW.0'                                     00244100
.ZI7C                 ANOP  ,                                           00244200
.*-------------------------------------------------------------------   00244300
.***AI.L08 XFUNC_OPTIONS "DELETE"                                       00244400
.***      BL1'X1XXXXXX'                                                 00244500
         AIF   ('&XFUNC' NE 'DELETE').ZI8A                              00244600
&ZW                   SETC  '&ZW.1'                                     00244700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00244800
                      AGO   .ZI8C                                       00244900
.*                                                                      00245000
.ZI8A                 ANOP  ,                                           00245100
&ZW                   SETC  '&ZW.0'                                     00245200
.ZI8C                 ANOP  ,                                           00245300
.*-------------------------------------------------------------------   00245400
.***AI.L08 XFUNC_OPTIONS "MODIFY"                                       00245500
.***      BL1'XX1XXXXX'                                                 00245600
         AIF   ('&XFUNC' NE 'MODIFY').ZI9A                              00245700
&ZW                   SETC  '&ZW.100000'                                00245800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00245900
                      AGO   .ZI9C                                       00246000
.*                                                                      00246100
.ZI9A                 ANOP  ,                                           00246200
&ZW                   SETC  '&ZW.000000'                                00246300
.ZI9C                 ANOP  ,                                           00246400
.*-------------------------------------------------------------------   00246500
.***AI.L11 XFUNC_OPTIONS BL1                                            00246600
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00246700
&ZOPN                 SETA  &ZOPN+1                                     00246800
&ZOPL(&ZOPN)          SETC  ' '                                         00246900
&ZOPO(&ZOPN)          SETC  'OI'                                        00247000
&ZOPV(&ZOPN)          SETC  '8(1),B''&ZW'''                             00247100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00247200
.ZI9E                 ANOP  ,                                           00247300
.*-------------------------------------------------------------------   00247400
.***AI.L05 XAPPENV_OPTIONS BL1                                          00247500
&ZW                   SETC  ''                                          00247600
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00247700
.*-------------------------------------------------------------------   00247800
.***AI.L08 XAPPENV_OPTIONS "YES"                                        00247900
.***      BL1'1XXXXXXX'                                                 00248000
         AIF   ('&XSINGLE_SERVER' NE 'YES').ZI11A                       00248100
&ZW                   SETC  '&ZW.1'                                     00248200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00248300
                      AGO   .ZI11C                                      00248400
.*                                                                      00248500
.ZI11A                ANOP  ,                                           00248600
&ZW                   SETC  '&ZW.0'                                     00248700
.ZI11C                ANOP  ,                                           00248800
.*-------------------------------------------------------------------   00248900
.***AI.L08 XAPPENV_OPTIONS "ROUND_ROBIN"                                00249000
.***      BL1'X1XXXXXX'                                                 00249100
         AIF   ('&XDISTRIBUTE_WORK' NE 'ROUND_ROBIN').ZI12A             00249200
&ZW                   SETC  '&ZW.1'                                     00249300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00249400
                      AGO   .ZI12C                                      00249500
.*                                                                      00249600
.ZI12A                ANOP  ,                                           00249700
&ZW                   SETC  '&ZW.0'                                     00249800
.ZI12C                ANOP  ,                                           00249900
.*-------------------------------------------------------------------   00250000
.***AI.L08 XAPPENV_OPTIONS "YES"                                        00250100
.***      BL1'XX1XXXXX'                                                 00250200
         AIF   ('&XSTATIC' NE 'YES').ZI13A                              00250300
&ZW                   SETC  '&ZW.1'                                     00250400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00250500
                      AGO   .ZI13C                                      00250600
.*                                                                      00250700
.ZI13A                ANOP  ,                                           00250800
&ZW                   SETC  '&ZW.0'                                     00250900
.ZI13C                ANOP  ,                                           00251000
.*-------------------------------------------------------------------   00251100
.***AI.L08 XAPPENV_OPTIONS "YES"                                        00251200
.***      BL1'XXX1XXXX'                                                 00251300
         AIF   ('&XJOBSPACE' NE 'YES').ZI14A                            00251400
&ZW                   SETC  '&ZW.10000'                                 00251500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00251600
                      AGO   .ZI14C                                      00251700
.*                                                                      00251800
.ZI14A                ANOP  ,                                           00251900
&ZW                   SETC  '&ZW.00000'                                 00252000
.ZI14C                ANOP  ,                                           00252100
.*-------------------------------------------------------------------   00252200
.***AI.L11 XAPPENV_OPTIONS BL1                                          00252300
                      AIF   ('&ZCLNG' NE 'YES').ZI14E  ALL ZERO BITS    00252400
&ZOPN                 SETA  &ZOPN+1                                     00252500
&ZOPL(&ZOPN)          SETC  ' '                                         00252600
&ZOPO(&ZOPN)          SETC  'OI'                                        00252700
&ZOPV(&ZOPN)          SETC  '9(1),B''&ZW'''                             00252800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00252900
.ZI14E                ANOP  ,                                           00253000
.*-------------------------------------------------------------------   00253100
.***AI.L25  XSELECT_POLICY XL1                                          00253200
                      AIF   ('&ZXSELECT_POLICY' EQ '').ZI15E            00253300
                      AIF   ('&ZXSELECT_POLICY' EQ 'OUTPUT').ZI15E      00253400
&ZCGPR                SETC  '&XSELECT_POLICY'                           00253500
         AIF   ('&XSELECT_POLICY' EQ '0').ZI15E                         00253600
         AIF   ('&XSELECT_POLICY' EQ '0').ZI15E                         00253700
.*                                                                      00253800
                      AIF   ('&XSELECT_POLICY'(1,1) NE '(').ZI15B       00253900
&ZCGPR   SETC  '0('.'&XSELECT_POLICY'(2,K'&XSELECT_POLICY-2).')'        00254000
                      AGO   .ZI15D                                      00254100
.ZI15B                ANOP  ,                                           00254200
.*                                                                      00254300
&ZC                   SETC  '&XSELECT_POLICY'(1,1)                      00254400
                      AIF   (T'&ZC NE 'N').ZI15D                        00254500
&ZC                   SETC  '&XSELECT_POLICY'                           00254600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               00254700
&ZCGPR                SETC  '=AL1(&XSELECT_POLICY)'                     00254800
.*                                                                      00254900
.ZI15D                ANOP  ,                                           00255000
.*                                                                      00255100
&ZOPN                 SETA  &ZOPN+1                                     00255200
&ZOPL(&ZOPN)          SETC  ' '                                         00255300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00255400
&ZOPV(&ZOPN)          SETC  '10(1,1),&ZCGPR'                            00255500
&ZOPD(&ZOPN)          SETC  '++ &ZXSELECT_POLICY XSELECT_POLICY'        00255600
.*                                                                      00255700
.ZI15E                ANOP  ,                                           00255800
.*-------------------------------------------------------------------   00255900
.***AI.L19 ADDR64 XAPPLENV AD                                           00256000
                      AIF   ('&ZXAPPLENV' EQ '').ZI20H                  00256100
&ZCLNG                SETC  '&XAPPLENV'                                 00256200
&ZCGPR                SETC  '14'                                        00256300
         AIF   ('&XAPPLENV'(1,1) EQ '(').ZI20F  IN GPR                  00256400
.*                                                                      00256500
&ZOPN                 SETA  &ZOPN+1                                     00256600
&ZOPL(&ZOPN)          SETC  ' '                                         00256700
&ZOPO(&ZOPN)          SETC  'LA'                                        00256800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00256900
&ZOPD(&ZOPN)          SETC  '++ &ZXAPPLENV XAPPLENV'                    00257000
.*                                                                      00257100
                      AGO   .ZI20G                                      00257200
.*                                                                      00257300
.ZI20F                ANOP  ,                                           00257400
&ZCGPR   SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                             00257500
.*                                                                      00257600
.ZI20G                ANOP  ,                                           00257700
                      AIF   ('&SYSAM64' EQ 'YES').ZI20H1A               00257800
.*                                                                      00257900
&ZOPN                 SETA  &ZOPN+1                                     00258000
&ZOPL(&ZOPN)          SETC  ' '                                         00258100
&ZOPO(&ZOPN)          SETC  'ST'                                        00258200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+24(,1)'                           00258300
&ZOPD(&ZOPN)          SETC  '++ &ZXAPPLENV XAPPLENV'                    00258400
.*                                                                      00258500
                      AGO   .ZI20H                                      00258600
.ZI20H1A              ANOP  ,                                           00258700
.*                                                                      00258800
&ZOPN                 SETA  &ZOPN+1                                     00258900
&ZOPL(&ZOPN)          SETC  ' '                                         00259000
&ZOPO(&ZOPN)          SETC  'STG'                                       00259100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,24(,1)'                             00259200
&ZOPD(&ZOPN)          SETC  '++ &ZXAPPLENV XAPPLENV'                    00259300
.*                                                                      00259400
.ZI20H                ANOP  ,                                           00259500
.*-------------------------------------------------------------------   00259600
.***AI.L19 ADDR64 XJCLPROC AD                                           00259700
                      AIF   ('&ZXJCLPROC' EQ '').ZI21H                  00259800
&ZCLNG                SETC  '&XJCLPROC'                                 00259900
&ZCGPR                SETC  '14'                                        00260000
         AIF   ('&XJCLPROC'(1,1) EQ '(').ZI21F  IN GPR                  00260100
.*                                                                      00260200
&ZOPN                 SETA  &ZOPN+1                                     00260300
&ZOPL(&ZOPN)          SETC  ' '                                         00260400
&ZOPO(&ZOPN)          SETC  'LA'                                        00260500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00260600
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPROC XJCLPROC'                    00260700
.*                                                                      00260800
                      AGO   .ZI21G                                      00260900
.*                                                                      00261000
.ZI21F                ANOP  ,                                           00261100
&ZCGPR   SETC  '&XJCLPROC'(2,K'&XJCLPROC-2)                             00261200
.*                                                                      00261300
.ZI21G                ANOP  ,                                           00261400
                      AIF   ('&SYSAM64' EQ 'YES').ZI21H1A               00261500
.*                                                                      00261600
&ZOPN                 SETA  &ZOPN+1                                     00261700
&ZOPL(&ZOPN)          SETC  ' '                                         00261800
&ZOPO(&ZOPN)          SETC  'ST'                                        00261900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+32(,1)'                           00262000
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPROC XJCLPROC'                    00262100
.*                                                                      00262200
                      AGO   .ZI21H                                      00262300
.ZI21H1A              ANOP  ,                                           00262400
.*                                                                      00262500
&ZOPN                 SETA  &ZOPN+1                                     00262600
&ZOPL(&ZOPN)          SETC  ' '                                         00262700
&ZOPO(&ZOPN)          SETC  'STG'                                       00262800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,32(,1)'                             00262900
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPROC XJCLPROC'                    00263000
.*                                                                      00263100
.ZI21H                ANOP  ,                                           00263200
.*-------------------------------------------------------------------   00263300
.***AI.L19 ADDR64 XJCLPARMS AD                                          00263400
                      AIF   ('&ZXJCLPARMS' EQ '').ZI22H                 00263500
&ZCLNG                SETC  '&XJCLPARMS'                                00263600
&ZCGPR                SETC  '14'                                        00263700
         AIF   ('&XJCLPARMS'(1,1) EQ '(').ZI22F  IN GPR                 00263800
        AIF   ('&XJCLPARMS' EQ '0').ZI22H                               00263900
.*                                                                      00264000
.*                                                                      00264100
&ZOPN                 SETA  &ZOPN+1                                     00264200
&ZOPL(&ZOPN)          SETC  ' '                                         00264300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00264400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00264500
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPARMS XJCLPARMS'                  00264600
.*                                                                      00264700
                      AGO   .ZI22G                                      00264800
.*                                                                      00264900
.ZI22F                ANOP  ,                                           00265000
&ZCGPR   SETC  '&XJCLPARMS'(2,K'&XJCLPARMS-2)                           00265100
.*                                                                      00265200
.ZI22G                ANOP  ,                                           00265300
                      AIF   ('&SYSAM64' EQ 'YES').ZI22H1A               00265400
.*                                                                      00265500
&ZOPN                 SETA  &ZOPN+1                                     00265600
&ZOPL(&ZOPN)          SETC  ' '                                         00265700
&ZOPO(&ZOPN)          SETC  'ST'                                        00265800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+40(,1)'                           00265900
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPARMS XJCLPARMS'                  00266000
.*                                                                      00266100
                      AGO   .ZI22H                                      00266200
.ZI22H1A              ANOP  ,                                           00266300
.*                                                                      00266400
&ZOPN                 SETA  &ZOPN+1                                     00266500
&ZOPL(&ZOPN)          SETC  ' '                                         00266600
&ZOPO(&ZOPN)          SETC  'STG'                                       00266700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,40(,1)'                             00266800
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPARMS XJCLPARMS'                  00266900
.*                                                                      00267000
.ZI22H                ANOP  ,                                           00267100
.*-------------------------------------------------------------------   00267200
&ZOPN1                SETA &ZOPN                                        00267300
.*******************************************************************    00267400
.***  PROCESS IWM4AEDF OUTPUT PARAMETERS                                00267500
.*******************************************************************    00267600
                      ACTR  10000                                       00267700
.*******************************************************************    00267800
.***AO.X02  RETURN CODE PROCESSING                                      00267900
.*******************************************************************    00268000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00268100
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00268200
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00268300
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00268400
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00268500
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00268600
&ZOPN                 SETA  &ZOPN+1                                     00268700
&ZOPL(&ZOPN)          SETC  ' '                                         00268800
&ZOPO(&ZOPN)          SETC  'ST'                                        00268900
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00269000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00269100
                      AGO   .ZMRETX                                     00269200
.*                                                                      00269300
.ZMRET2               ANOP  ,                                           00269400
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00269500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00269600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00269700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00269800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00269900
&ZOPN                 SETA  &ZOPN+1                                     00270000
&ZOPL(&ZOPN)          SETC  ' '                                         00270100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00270200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00270300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00270400
.ZMRETX               ANOP  ,                                           00270500
.*******************************************************************    00270600
.***AO.X03  REASON CODE PROCESSING                                      00270700
.*******************************************************************    00270800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00270900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00271000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00271100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00271200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00271300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00271400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00271500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00271600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00271700
&ZOPN                 SETA  &ZOPN+1                                     00271800
&ZOPL(&ZOPN)          SETC  ' '                                         00271900
&ZOPO(&ZOPN)          SETC  'ST'                                        00272000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00272100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00272200
                      AGO   .ZMRSNX                                     00272300
.*                                                                      00272400
.ZMRSN2               ANOP  ,                                           00272500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00272600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00272700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00272800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00272900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00273000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00273100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00273200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00273300
&ZOPN                 SETA  &ZOPN+1                                     00273400
&ZOPL(&ZOPN)          SETC  ' '                                         00273500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00273600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00273700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00273800
.ZMRSNX               ANOP  ,                                           00273900
.*******************************************************************    00274000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00274100
.*******************************************************************    00274200
.ZMFLX                ANOP  ,              MF=L PROCESSING              00274300
.*******************************************************************    00274400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00274500
.*******************************************************************    00274600
                      ACTR  10000                                       00274700
.*                                                                      00274800
                      LCLA  &ZLC           COLUMN POSITION              00274900
                      LCLA  &ZOPX          LIST TABLE INDEX             00275000
                      LCLC  &ZLL           LABEL                        00275100
                      LCLC  &ZLOP          OPERATION                    00275200
                      LCLC  &ZLV           VALUE                        00275300
                      LCLC  &ZLD           DESCRIPTION                  00275400
.*                                                                      00275500
&ZOPX                 SETA  1                                           00275600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00275700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00275800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00275900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00276000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00276100
                      AIF   (K'&ZLD LE 0).ZL5                           00276200
&ZLC                  SETA  35             COMMENT COLUMN               00276300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00276400
&ZLC                  SETA  33             COMMMENT COLUMN              00276500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00276600
&ZLV                  SETC  '&ZLV'.' '                                  00276700
                      AGO   .ZL3                                        00276800
.*                                                                      00276900
.ZL4                  ANOP  ,                                           00277000
&ZLV                  SETC  '&ZLV'.' '                                  00277100
.ZL5                  ANOP  ,                                           00277200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00277300
.*                                                                      00277400
&ZLL     &ZLOP &ZLV                                                     00277500
.*                                                                      00277600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00277700
                      AGO   .ZL2           CONTINUE LOOPING             00277800
.*                                                                      00277900
.ZLX                  ANOP  ,                                           00278000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00278100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00278200
         AIF   ('&SYSAM64' NE 'YES').AMODE31                            00278300
         LLGTR 14,14                   CLEAR HIGH HALF IN 64BIT MODE    00278400
.AMODE31 L     14,16(0,0)              GET CVT ADDRESS                  00278500
.*-------------------------------------------------------------------   00278600
         TM    CVTOSLV5-CVT(14),CVTH7720  test for HBB7720 presence     00278700
         BNZ   VEROK&SYSNDX               running on HBB7720            00278800
         LA    0,IWMRSNCODEBADVERSION     HBB7720 is required           00278900
         LA    15,IWMRETCODEINVOCERROR    set return code               00279000
         B     END&SYSNDX                 skip service invocation       00279100
VEROK&SYSNDX DS    0H                     version check successful      00279200
.*-------------------------------------------------------------------   00279300
         L     14,772(14,0)            GET SFT ADDRESS                  00279400
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       00279500
         LA    15,108                  GET EX FOR SERVICE ROUTINE       00279600
         OR    14,15                   GET PC NUMBER                    00279700
         PC    0(14)                                                    00279800
END&SYSNDX DS    0H                END LABEL                            00279900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00280000
.ZLINKX               ANOP  ,                                           00280100
.*******************************************************************    00280200
.***AP.X01  FORMAT GENERATED CODE                                       00280300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00280400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00280500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00280600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00280700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00280800
                      AIF   (K'&ZLD LE 0).ZL51                          00280900
&ZLC                  SETA  35             COMMENT COLUMN               00281000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00281100
&ZLC                  SETA  33             COMMENT COLUMN               00281200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00281300
&ZLV                  SETC  '&ZLV'.' '                                  00281400
                      AGO   .ZL31                                       00281500
.*                                                                      00281600
.ZL41                 ANOP  ,                                           00281700
&ZLV                  SETC  '&ZLV'.' '                                  00281800
.ZL51                 ANOP  ,                                           00281900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00282000
.*                                                                      00282100
&ZLL     &ZLOP &ZLV                                                     00282200
.*                                                                      00282300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00282400
                      AGO   .ZL21          CONTINUE LOOPING             00282500
.*                                                                      00282600
.ZLX1                 ANOP  ,                                           00282700
.*******************************************************************    00282800
.***AP.X02  END OF IWM4AEDF MACRO                                       00282900
&ZIWM4AEDF            SETC  'YES'          SET IWM4AEDF USED            00283000
         POP   PRINT                                                    00283100
*                                            IWM4AEDF-0                 00283200
         SPACE 1                                                        00283300
.ZLX2                 ANOP  ,                                           00283400
         MEND                                                           00283500
**********************************************************************/ 00283600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00283700
*%IWM4AEDF: MACRO KEYS(CONNTKN,FUNC,APPLENV,JCLPROC,JCLPARMS,JOBSPACE,  00283800
*                 SINGLE_SERVER,SELECT_POLICY,DISTRIBUTE_WORK,STATIC,   00283900
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00284000
*  ANS('?'!!MACLABEL!!' '!!'IWM4AEDP '!!MACLIST!!                       00284100
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00284200
*%END IWM4AEDF;                                                         00284300

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXLALTER                              -01/13/18-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  XES Alter Service                             * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 1994, 2017                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77B0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IXLALTER service routine is given control from the         * 00002100
*      IXLALTER macro.                                                * 00002200
*                                                                     * 00002300
*      The IXLALTER service allows an authorized program, not         * 00002400
*      necessarily a connected XES user, to request the start or stop * 00002500
*      of structure alter.  Altering a structure is a non-disruptive  * 00002600
*      process to expand or contract the size, to reapportion the     * 00002700
*      entry-to-element ratio of the structure, and dynamically       * 00002800
*      change the percentage of structure storage that is set aside   * 00002900
*      for Event Monitor Controls (EMCs).  All three of these         * 00003000
*      operations can be requested with one IXLALTER invocation.      * 00003100
*                                                                     * 00003200
*      START PROCESSING:                                              * 00003300
*                                                                     * 00003400
*      The structure must be allocated in a coupling facility that    * 00003500
*      supports structure alter, implying that the coupling facility  * 00003600
*      operational level (CFLEVEL) must be greater than or equal to   * 00003700
*      one.                                                           * 00003800
*                                                                     * 00003900
*      All connections to the structure at the time structure alter   * 00004000
*      is initiated must allow the request in order for alter         * 00004100
*      processing to occur.  The structure alter process is not       * 00004200
*      transparent to the connectors to the structure since they must * 00004300
*      indicate at connect time whether structure alter is allowed    * 00004400
*      and optionally indicate whether the changing the               * 00004500
*      entry-to-element and entry/element-to-EMC storage ratio is     * 00004600
*      permitted and/or specify minimum threshold levels for entries, * 00004700
*      elements and event monitor control storage.  The minimum       * 00004800
*      threshold levels indicate the percent of in use entries,       * 00004900
*      elements and EMC storage that must be available when the       * 00005000
*      structure alter completes. This allows for connections to keep * 00005100
*      a buffer of free entries, elements and EMC storage.            * 00005200
*                                                                     * 00005300
*      A structure alter request can be accepted when:                * 00005400
*                                                                     * 00005500
*                                                                     * 00005600
*      o   There are no connections to a persistent structure or all  * 00005700
*          connections (active, failing, or failed-persistent)        * 00005800
*          indicated ALLOWALTER=YES at connect time                   * 00005900
*                                                                     * 00006000
*      o   For reapportionment, all connections indicated RATIO=YES   * 00006100
*          at connect time                                            * 00006200
*                                                                     * 00006300
*      o   The structure is allocated in a coupling facility with     * 00006400
*          CFLEVEL >= 1                                               * 00006500
*                                                                     * 00006600
*      o   The structure is not already in the alter process          * 00006700
*                                                                     * 00006800
*      o   The structure is not already in the rebuild process        * 00006900
*                                                                     * 00007000
*      o   The structure is already in the Duplexing rebuild process, * 00007100
*          in the Duplexing Established rebuild phase and neither     * 00007200
*          instance of the structure is using storage-class memory.   * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*                                                                     * 00007600
*      NOTE:  When structure alter is initiated for a structure with  * 00007700
*      no connections there are no threshold values or ratio          * 00007800
*      permitted to change specifications to govern the extent to     * 00007900
*      which the structure can be altered. Therefore, a request to    * 00008000
*      alter the structure may result in the structure having no      * 00008100
*      available entries/elements/event monitor controls or a         * 00008200
*      different ratio than can be tolerated.                         * 00008300
*                                                                     * 00008400
*      If the alter request is valid, then all active connectors are  * 00008500
*      notified of the alter request via their event exit.            * 00008600
*                                                                     * 00008700
*      XES will use a composite value for the threshold limits set by * 00008800
*      each connection to the structure to limit the structure alter  * 00008900
*      process.  The composite for entry/element/EMC is the highest   * 00009000
*      percentage set by any connection. The change ratio composite   * 00009100
*      will allow the ratio to change if all connections specified    * 00009200
*      RATIO=YES at connect time.  The change ratio composite will    * 00009300
*      prevent changing the ratio if any connection specified         * 00009400
*      RATIO=NO at connect time.  XES uses architected coupling       * 00009500
*      facility services to effect the requested changes to the       * 00009600
*      structure attributes based on the composite for threshold      * 00009700
*      limits and the requested targets for size and/or ratio.        * 00009800
*                                                                     * 00009900
*      When altering a structure which is in user-managed duplexing   * 00010000
*      rebuild processing, the alter is automatically applied to both * 00010100
*      structure instances serially.  The primary (old) structure     * 00010200
*      will be altered first, with corresponding Alter Begin and      * 00010300
*      Alter End events.  After the Alter End of the primary (old)    * 00010400
*      structure, an Alter Begin event for the secondary (new)        * 00010500
*      structure will be delivered followed by an Alter End event     * 00010600
*      when the alter completes for the secondary structure. The      * 00010700
*      Alter Begin and Alter End events will contain an indication of * 00010800
*      which structure instance is being altered.                     * 00010900
*                                                                     * 00011000
*      When altering a structure which is in system-managed duplexing * 00011100
*      rebuild processing, the alter is applied to both structure     * 00011200
*      instances serially, with the primary (old) structure being     * 00011300
*      altered first followed by the alter of the secondary (new)     * 00011400
*      structure.  However, only one set of Alter Begin and Alter End * 00011500
*      events are delivered. The Alter Begin event is delivered at    * 00011600
*      the start of alter processing for the primary structure; the   * 00011700
*      Alter End event is delivered once at the completion of alter   * 00011800
*      processing as a whole which encompasses both instances of the  * 00011900
*      structure.                                                     * 00012000
*                                                                     * 00012100
*      Alter processing continues until the target size and/or ratio  * 00012200
*      are satisfied (completely or to the extent possible based on   * 00012300
*      current coupling facility resource usage) or ended via a stop  * 00012400
*      request or various failure conditions.  When alter processing  * 00012500
*      ends, then all connectors are notified of the alter complete   * 00012600
*      via their event exit.                                          * 00012700
*                                                                     * 00012800
*      STOP PROCESSING:                                               * 00012900
*                                                                     * 00013000
*      Structure alter processing will be stopped as a result of a    * 00013100
*      stop alter request or initiating structure rebuild.  XES uses  * 00013200
*      architected coupling facility services to end changes to the   * 00013300
*      structure attributes.  For structure failure, deallocation of  * 00013400
*      non-persistent structure, and deallocation of "old" structure  * 00013500
*      during rebuild, structure alter processing is implicitly       * 00013600
*      stopped.                                                       * 00013700
*                                                                     * 00013800
*      All active connections to the allocated structure will have    * 00013900
*      the event exit driven with the EeplAlterEnd event.             * 00014000
*                                                                     * 00014100
*      While an alter of a structure in the Duplex Established phase  * 00014200
*      of system-managed duplexing rebuild is in progress, the system * 00014300
*      will reject an attempt to stop the alter with either message   * 00014400
*      IXC531I (for SETXCF) or return code IXLRSNCODEDUPALTER (for    * 00014500
*      IXLALTER).                                                     * 00014600
*                                                                     * 00014700
*      CACHE STRUCTURE CONSIDERATIONS:                                * 00014800
*                                                                     * 00014900
*      When an IXLALTER is processed for a cache structure, all       * 00015000
*      active reclaim vectors associated with all storage classes for * 00015100
*      the structure are deactivated. The system therefore resumes    * 00015200
*      use of the default reclaim algorithm for all storage classes   * 00015300
*      for the structure at the start of the structure alter process. * 00015400
*                                                                     * 00015500
*      Furthermore, while the structure is in the process of being    * 00015600
*      altered, any attempt to activate a reclaim vector will be      * 00015700
*      rejected.  In such a case, the IXLCACHE SET_RECLVCTR command   * 00015800
*      will be failed with return code 4, reason code xxxx0414        * 00015900
*      (IxlRsnCodeRclVctrNotSet).                                     * 00016000
*                                                                     * 00016100
*      When the structure alter process completes for the structure,  * 00016200
*      it once again becomes possible to activate a reclaim vector    * 00016300
*      via IXLCACHE SET_RECLVCTR. However, note that any reclaim      * 00016400
*      vectors which were deactivated at the time the alter process   * 00016500
*      began are NOT reinstated automatically; it is the user's       * 00016600
*      responsibility to activate new reclaim vector(s), if desired,  * 00016700
*      at the time the structure alter process completes. Reclaim     * 00016800
*      vectors activated at this time should take into account the    * 00016900
*      current entry/element counts for the structure.                * 00017000
*                                                                     * 00017100
*      LIST STRUCTURE CONSIDERATIONS:                                 * 00017200
*                                                                     * 00017300
*      When a structure alter is processed for a list structure, the  * 00017400
*      list limit for a list in the structure will be automatically   * 00017500
*      adjusted if and only if the user has never set a list limit    * 00017600
*      for the list via a list services (IXLLIST or IXLLSTC)          * 00017700
*      WRITE_LCONTROLS request.                                       * 00017800
*                                                                     * 00017900
*      As the structure alter process changes the total number of     * 00018000
*      entries or elements in the structure, it also automatically    * 00018100
*      adjusts the list limit for all such lists correspondingly so   * 00018200
*      that this equality is maintained.  When the structure alter    * 00018300
*      process completes, the list limit for a list that the user has * 00018400
*      never set a list limit for will be equal to the total number   * 00018500
*      of entries or elements in the structure.                       * 00018600
*                                                                     * 00018700
*      If the user has explicitly set a list limit for a list, then   * 00018800
*      the structure alter process will NOT automatically adjust that * 00018900
*      list limit. It is the user's responsibility, if desired, to    * 00019000
*      set a new list limit for such list(s) upon completion of the   * 00019100
*      structure alter process. The new list limit should take into   * 00019200
*      account the current entry/element counts for the structure.    * 00019300
*                                                                     * 00019400
*      LOCK STRUCTURE CONSIDERATIONS:                                 * 00019500
*                                                                     * 00019600
*      When a lock structure is allocated, the locks and other        * 00019700
*      controls are allocated; then whatever storage remains is       * 00019800
*      carved up into record data entries.  No data elements are      * 00019900
*      created.                                                       * 00020000
*                                                                     * 00020100
*      On an IXLALTER,  a structure alter to change the ratio of      * 00020200
*      entries to elements in a lock structure is meaningless.  This  * 00020300
*      request will be rejected by the coupling facility with a       * 00020400
*      request exception.                                             * 00020500
*                                                                     * 00020600
*      However, a structure alter to change the size has value.  It   * 00020700
*      will either increase or decrease the number of record data     * 00020800
*      entries in the structure.                                      * 00020900
*                                                                     * 00021000
*      PENDING ENTRY TO ELEMENT RATIO CONSIDERATIONS                  * 00021100
*                                                                     * 00021200
*      On an initial allocate or reapportionment request, the pending * 00021300
*      entry to element ratio is set to the target ratio requested.   * 00021400
*      The target counts are calculated based on this ratio.  If when * 00021500
*      a subsequent request to expand or contract the structure size  * 00021600
*      is received, the ratio of target entry to element counts is    * 00021700
*      different than the ratio of the total entry to element counts, * 00021800
*      a reapportionment is continued in addition to the size change. * 00021900
*      The pending entry to element ratio is used to calculate the    * 00022000
*      new target counts on the expand or contract request.  This     * 00022100
*      allows the size to be changed without violating the target     * 00022200
*      entry to element ratio.                                        * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00022600
*                                                                     * 00022700
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00022800
*                                                                     * 00022900
*01* ENVIRONMENT:                                                     * 00023000
*                                                                     * 00023100
*                                                                     * 00023200
*      Dispatchable unit mode: Task mode.                             * 00023300
*                                                                     * 00023400
*      Minimum authorization: Supervisor State or program key mask    * 00023500
*                        (PKM) allowing keys 0-7.  SAF authorization  * 00023600
*                        may be required by the installation to       * 00023700
*                        process particular structures.               * 00023800
*                                                                     * 00023900
*      AMODE:            31-bit.                                      * 00024000
*                                                                     * 00024100
*      ASC mode:         Primary or Access Register.  Primary address * 00024200
*                        space must be equal to the home address      * 00024300
*                        space; any secondary address space;  any     * 00024400
*                        home address space.                          * 00024500
*                                                                     * 00024600
*      Serialization:    Enabled.  Unlocked. No EUT FRR established.  * 00024700
*                                                                     * 00024800
*      Restrictions:                                                  * 00024900
*                                                                     * 00025000
*                        IXLALTER is not permitted when an EUT FRR is * 00025100
*                        established.                                 * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00025600
*                      GR2-GR13    Undefined                          * 00025700
*                      GR14-GR15   Reserved                           * 00025800
*                      AR0-AR1     Reserved                           * 00025900
*                      AR2-AR13    Undefined                          * 00026000
*                      AR14-AR15   Reserved                           * 00026100
*                                                                     * 00026200
*01* OUTPUT REGISTERS: GR0         Reason code if GR15 return code is * 00026300
*                                  non-zero                           * 00026400
*                      GR1         Unpredictable                      * 00026500
*                      GR2-GR13    Unchanged                          * 00026600
*                      GR14        Unpredictable                      * 00026700
*                      GR15        Return code                        * 00026800
*                      AR0-AR1     Unpredictable                      * 00026900
*                      AR2-AR13    Unchanged                          * 00027000
*                      AR14-AR15   Unpredictable                      * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*01* SYNTAX:                                                          * 00027400
*                                                                     * 00027500
*Ýxlabel¨  IXLALTER     STRNAME=xstrname                              * 00027600
*                    Ð ,REQUEST=START                                 * 00027700
*                    !   Ð ,SIZE                                      * 00027800
*                    !   !     ,STRSIZE=xstrsize                      * 00027900
*                    !   Ô ,RATIO                                     * 00028000
*                    !   !     ,ENTRYRATIO=xentryratio                * 00028100
*                    !   !     ,ELEMENTRATIO=xelementratio            * 00028200
*                    !   ¿ ,EMCSTG                                    * 00028300
*                    !         ,EMCSTGPCT=xemcstgpct                  * 00028400
*                    ¿ ,REQUEST=STOP                                  * 00028500
*                     Ý,RETCODE=xretcode¨                             * 00028600
*                     Ý,RSNCODE=xrsncode¨                             * 00028700
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00028800
*                    ÐÝ,MF=S¨                                         * 00028900
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00029000
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*      Where:                                                         * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*      Ýxlabel¨                                                       * 00029700
*          is an optional symbol, starting in column 1, that is the   * 00029800
*          name on the IXLALTER macro invocation.  The name must      * 00029900
*          conform to the rules for an ordinary assembler language    * 00030000
*          symbol.                                                    * 00030100
*          DEFAULT: No name.                                          * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*      STRNAME=xstrname                                               * 00030700
*          is the name (RS-type), or address in register (2)-(12), of * 00030800
*          a required 16 character input that specifies the name of   * 00030900
*          the structure for which the user wishes to have structure  * 00031000
*          alter processing start or stop.  The logical structure     * 00031100
*          name provides the ability to map the request to a physical * 00031200
*          coupling facility.  The name is defined in the CFRM        * 00031300
*          (Coupling Facility Resource Management) active policy.     * 00031400
*                                                                     * 00031500
*          The structure name must be 16 characters long, padded on   * 00031600
*          the right with blanks if necessary.  It may validly        * 00031700
*          contain numeric characters, uppercase alphabetic           * 00031800
*          characters, national characters ($, @, #), or an           * 00031900
*          underscore (_).  It must begin with an uppercase           * 00032000
*          alphabetic character.  IBM names will begin with SYS, an   * 00032100
*          IBM component prefix, or letters A-I.                      * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*      REQUEST=»START!STOPº                                           * 00032700
*          is a required keyword input which identifies the type of   * 00032800
*          structure alter request.                                   * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*          REQUEST=START                                              * 00033200
*              Start structure alter processing for the specified     * 00033300
*              structure.                                             * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*              The following is a group of keys.  At least one must   * 00033700
*              be specified.                                          * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*              SIZE                                                   * 00034100
*                  Expand or contract the structure.                  * 00034200
*                                                                     * 00034300
*                  NOTE:  At the time of structure allocation, the    * 00034400
*                  maximum structure size (MSS) value is set and      * 00034500
*                  remains constant as long as this instance of the   * 00034600
*                  structure remains allocated.  The structure        * 00034700
*                  allocation algorithm determines the MSS based on   * 00034800
*                  whether the structure is allocated by counts or by * 00034900
*                  size/ratios.  The actual structure size may be     * 00035000
*                  less than or equal to the MSS value.  It may be    * 00035100
*                  less due to INITSIZE from the CFRM active policy,  * 00035200
*                  due to STRSIZE specified on IXLCONN, due to        * 00035300
*                  storage constraints in the coupling facility, or   * 00035400
*                  due to a previous structure alter. The actual      * 00035500
*                  structure size may change with the MSS value being * 00035600
*                  the upper bound.  The minimum structure size       * 00035700
*                  (MINSS) is the minimum control space required to   * 00035800
*                  allocate the structure with the attributes         * 00035900
*                  specified.  The MINSS value is established by the  * 00036000
*                  coupling facility based on the attributes          * 00036100
*                  specified when the structure was allocated.  The   * 00036200
*                  MINSS value can change when the structure is       * 00036300
*                  reapportioned with an entry-to-element ratio that  * 00036400
*                  differs substantially from the previous ratio.     * 00036500
*                  MINSIZE specified in the CFRM active policy will   * 00036600
*                  serve as a minimum bound for the structure size on * 00036700
*                  all structure allocation requests (including       * 00036800
*                  alter, connect, and rebuild connect) except for    * 00036900
*                  new structure allocation during System-managed     * 00037000
*                  rebuild. New structure allocation during           * 00037100
*                  System-managed rebuild may cause the structure to  * 00037200
*                  be allocated with a size smaller than MINSIZE in   * 00037300
*                  the CFRM active policy.  The actual structure size * 00037400
*                  may expand to the MSS value or contract to the     * 00037500
*                  MINSS value or the MINSIZE value specified in the  * 00037600
*                  CFRM policy. When contracting, the larger of the   * 00037700
*                  two values will be used.                           * 00037800
*                                                                     * 00037900
*                  When SIZE is not specified the structure size will * 00038000
*                  not change as a result of the IXLALTER.            * 00038100
*                                                                     * 00038200
*                                                                     * 00038300
*                  STRSIZE=xstrsize                                   * 00038400
*                      is the name (RS-type), or address in register  * 00038500
*                      (2)-(12), of a required fullword input that    * 00038600
*                      specifies the structure size in units of 4K    * 00038700
*                      blocks. This size will be used to alter the    * 00038800
*                      structure size.  If the size is smaller than   * 00038900
*                      the actual structure size then the structure   * 00039000
*                      will be contracted.  If the size is larger     * 00039100
*                      than the actual structure size then the        * 00039200
*                      structure will be expanded.                    * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*              RATIO                                                  * 00039700
*                  Reapportion the entry-to-element ratio of the      * 00039800
*                  structure.                                         * 00039900
*                                                                     * 00040000
*                  NOTE:                                              * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                  o   For a cache structure, if the structure was    * 00040400
*                      originally allocated without data then         * 00040500
*                      structure alter can not be used to create      * 00040600
*                      data.  If the structure was originally         * 00040700
*                      allocated with data then structure alter can   * 00040800
*                      be used to change to a structure without data  * 00040900
*                      and back again, if desired.                    * 00041000
*                                                                     * 00041100
*                  o   For a list structure, if the structure was     * 00041200
*                      originally allocated without data then         * 00041300
*                      structure alter can not be used to create      * 00041400
*                      data.  If the structure was originally         * 00041500
*                      allocated with data then structure alter can   * 00041600
*                      not be used to change to a structure with no   * 00041700
*                      data.                                          * 00041800
*                                                                     * 00041900
*                  o   For a lock structure, the structure is not     * 00042000
*                      allocated with data elements.  Structure alter * 00042100
*                      can not be used to change to a structure with  * 00042200
*                      data elements.                                 * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*                  When RATIO is not specified, it is possible to     * 00042700
*                  have the ratio change as a result of a SIZE        * 00042800
*                  request unless one at least one connection         * 00042900
*                  specified RATIO=NO at connect time.                * 00043000
*                                                                     * 00043100
*                                                                     * 00043200
*                  ENTRYRATIO=xentryratio                             * 00043300
*                      is the name (RS-type), or address in register  * 00043400
*                      (2)-(12), of a required halfword input that    * 00043500
*                      contains the entry part of the                 * 00043600
*                      entry-to-element ratio.                        * 00043700
*                                                                     * 00043800
*                                                                     * 00043900
*                                                                     * 00044000
*                                                                     * 00044100
*                  ELEMENTRATIO=xelementratio                         * 00044200
*                      is the name (RS-type), or address in register  * 00044300
*                      (2)-(12), of a required halfword input that    * 00044400
*                      contains the data element part of the          * 00044500
*                      entry-to-element ratio.                        * 00044600
*                                                                     * 00044700
*                      If the data element portion of the             * 00044800
*                      entry-to-element ratio is zero, then the       * 00044900
*                      structure is altered to be without data        * 00045000
*                      elements.                                      * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*                                                                     * 00045400
*              EMCSTG                                                 * 00045500
*                  Dynamically change the percentage of structure     * 00045600
*                  storage that is to be set aside for Event Monitor  * 00045700
*                  Controls (EMCs).                                   * 00045800
*                                                                     * 00045900
*                  NOTE:                                              * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*                  o   For a list structure allocated with KEY        * 00046300
*                      support, if the structure was originally       * 00046400
*                      allocated without EMCs, structure alter CAN be * 00046500
*                      used to create EMCs.  If the structure was     * 00046600
*                      originally allocated with EMCs then structure  * 00046700
*                      alter can be used to change to a structure     * 00046800
*                      with no EMCs.                                  * 00046900
*                                                                     * 00047000
*                  o   Structure alter can not be used to create EMCs * 00047100
*                      for lock structures, cache structures,         * 00047200
*                      serialized list or list structures without KEY * 00047300
*                      support.                                       * 00047400
*                                                                     * 00047500
*                                                                     * 00047600
*                                                                     * 00047700
*                  When EMCSTG is not specified, it is possible to    * 00047800
*                  have the EMC storage percent change as a result of * 00047900
*                  a SIZE request unless at least one connection      * 00048000
*                  specified RATIO=NO at connect time.                * 00048100
*                                                                     * 00048200
*                                                                     * 00048300
*                  EMCSTGPCT=xemcstgpct                               * 00048400
*                      is the name (RS-type), or address in register  * 00048500
*                      (2)-(12), of a required halfword input that    * 00048600
*                      contains the percentage of available structure * 00048700
*                      storage, over and above the storage amount     * 00048800
*                      included in the marginal structure size,       * 00048900
*                      expressed in hundredths of a percent, that is  * 00049000
*                      to be set aside for Event Monitor Controls     * 00049100
*                      (EMC).  The specified value must be in the     * 00049200
*                      decimal range 0 to 10000, inclusive.  For      * 00049300
*                      example, the value 2500 would indicate that    * 00049400
*                      25.00 percent of the available structure       * 00049500
*                      storage, over and above the storage amount     * 00049600
*                      included in the marginal structure size, would * 00049700
*                      be used for EMCs.                              * 00049800
*                                                                     * 00049900
*                      See description of EMCSTGPCT in macro IXLCONN  * 00050000
*                      for additional considerations.                 * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*              End of group of keys.                                  * 00050700
*                                                                     * 00050800
*                                                                     * 00050900
*          REQUEST=STOP                                               * 00051000
*              Stop alter processing for the specified structure.     * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*                                                                     * 00051600
*                                                                     * 00051700
*      ÝRETCODE=xretcode¨                                             * 00051800
*          is the name (RS-type) of an optional fullword output       * 00051900
*          variable, or register (2)-(12) or (15), into which the     * 00052000
*          return code is to be copied from GPR 15.  If you specify   * 00052100
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00052200
*          the value will be left in GPR 15.                          * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*                                                                     * 00052600
*                                                                     * 00052700
*      ÝRSNCODE=xrsncode¨                                             * 00052800
*          is the name (RS-type) of an optional fullword output       * 00052900
*          variable into which the reason code is to be copied from   * 00053000
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00053100
*          R0 (within or without parentheses), the value will be left * 00053200
*          in GPR 0.                                                  * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00053800
*          is an optional byte input decimal value in the "0-1" range * 00053900
*          that specifies the macro version.  PLISTVER is the only    * 00054000
*          key allowed on the list form of MF and determines which    * 00054100
*          parameter list is generated.  The macro keys associated    * 00054200
*          with each supported version of the macro are listed in     * 00054300
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00054400
*          instead of a number, and the parameter list will be of the * 00054500
*          largest size currently supported. This size may grow from  * 00054600
*          release to release (thus possibly affecting the amount of  * 00054700
*          storage needed by your program).  If your program can      * 00054800
*          tolerate this, IBM recommends that you always specify MAX  * 00054900
*          when creating the list form parameter list as that will    * 00055000
*          ensure that the list form parameter list is always long    * 00055100
*          enough to hold whatever parameters might be specified on   * 00055200
*          the execute form.                                          * 00055300
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00055400
*          default is the lowest version which allows all of the      * 00055500
*          parameters specified on the invocation to be processed.    * 00055600
*                                                                     * 00055700
*                                                                     * 00055800
*                                                                     * 00055900
*                                                                     * 00056000
*      ÝMF=»S!L!Eº¨                                                   * 00056100
*          is an optional keyword input which specifies the macro     * 00056200
*          form.                                                      * 00056300
*          DEFAULT: S                                                 * 00056400
*                                                                     * 00056500
*                                                                     * 00056600
*          ÝMF=S¨                                                     * 00056700
*              specifies the standard form of the macro.  The "S"     * 00056800
*              form generates code to put the parameters into an      * 00056900
*              in-line parameter list and invoke the desired service. * 00057000
*              Full checking for required macro keys is done along    * 00057100
*              with supplying defaults for omitted optional           * 00057200
*              parameters.                                            * 00057300
*                                                                     * 00057400
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00057500
*              specifies the list form of the macro.  The "L" form    * 00057600
*              defines an area to be used for the parameter list.     * 00057700
*              Only the PLISTVER key may be specified on the          * 00057800
*              invocation.  All other macro parameters are flagged as * 00057900
*              errors.  If PLISTVER is not specified, the original    * 00058000
*              parameter list definition is used.                     * 00058100
*                                                                     * 00058200
*            ,xmfctrl                                                 * 00058300
*              is a required input.  It is the name of a storage area * 00058400
*              for the parameter list.                                * 00058500
*                                                                     * 00058600
*            »,xmfattr!0Dº                                            * 00058700
*              is an optional 60 character input string that varies   * 00058800
*              from 1 to 60 characters. Use it to force boundary      * 00058900
*              alignment of the parameter list. Use only 0F or 0D.    * 00059000
*              DEFAULT: 0D which forces the parameter list to a       * 00059100
*              doubleword boundary.                                   * 00059200
*                                                                     * 00059300
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00059400
*              specifies the execute form of the macro.  The "E" form * 00059500
*              generates code to put the parameters into the          * 00059600
*              parameter list specified by xmfctrl and provides full  * 00059700
*              syntax checking with default setting.                  * 00059800
*                                                                     * 00059900
*            ,xmfctrl                                                 * 00060000
*              is a required input.  It is the name (RS-type), or     * 00060100
*              address in register (1)-(12), of a storage area for    * 00060200
*              the parameter list.                                    * 00060300
*                                                                     * 00060400
*            »,COMPLETEº                                              * 00060500
*              is an optional keyword input which specifies the       * 00060600
*              degree of macro parameter syntax checking.             * 00060700
*              DEFAULT: COMPLETE                                      * 00060800
*                                                                     * 00060900
*                                                                     * 00061000
*              COMPLETE                                               * 00061100
*                  Checking for required macro keys is done and       * 00061200
*                  defaults are supplied for omitted optional         * 00061300
*                  parameters.                                        * 00061400
*                                                                     * 00061500
*                                                                     * 00061600
*                                                                     * 00061700
*                                                                     * 00061800
*                                                                     * 00061900
*                                                                     * 00062000
*                                                                     * 00062100
*01* RETURN CODES:                                                    * 00062200
*                                                                     * 00062300
*                                                                     * 00062400
*       0         IXLALTER request accepted.                          * 00062500
*                                                                     * 00062600
*                                                                     * 00062700
*       4         IXLALTER request not accepted.                      * 00062800
*                                                                     * 00062900
*                 HEX REASON   MEANING                                * 00063000
*                 CODE                                                * 00063100
*                                                                     * 00063200
*                                                                     * 00063300
*                 xxxx0427    IxlRsnCodeAlreadyAltering: Request      * 00063400
*                             rejected because alter is in progress   * 00063500
*                             for the structure.  A new alter request * 00063600
*                             will not be accepted until the current  * 00063700
*                             alter completes or is stopped.          * 00063800
*                                                                     * 00063900
*                                                                     * 00064000
*                                                                     * 00064100
*                                                                     * 00064200
*       8         IXLALTER parameter error                            * 00064300
*                                                                     * 00064400
*                 HEX REASON   MEANING                                * 00064500
*                 CODE                                                * 00064600
*                                                                     * 00064700
*                                                                     * 00064800
*                 xxxx0801    IxlRsnCodeBadParmlist:  Parameter list  * 00064900
*                             could not be accessed.                  * 00065000
*                                                                     * 00065100
*                 xxxx0802    IxlRsnCodeBadParmlistAlet:  Parameter   * 00065200
*                             list ALET is either 1, on the PASN      * 00065300
*                             list, or is not valid.                  * 00065400
*                                                                     * 00065500
*                 xxxx0804    IxlRsnCodeBadVersion#:  Version number  * 00065600
*                             in parameter list is not valid.         * 00065700
*                                                                     * 00065800
*                 xxxx0806    IxlRsnCodeSrbMode:  Caller is in SRB    * 00065900
*                             mode.                                   * 00066000
*                                                                     * 00066100
*                 xxxx0807    IxlRsnCodeNotEnabled:  Caller is not    * 00066200
*                             enabled.                                * 00066300
*                                                                     * 00066400
*                 xxxx0809    IxlRsnCodePrimaryNotHome:  Primary      * 00066500
*                             address space does not equal home       * 00066600
*                             address space.                          * 00066700
*                                                                     * 00066800
*                 xxxx0824    IxlRsnCodeWrongStrType:  EMCSTGPCT      * 00066900
*                             cannot be altered on a CACHE or LOCK    * 00067000
*                             structure.                              * 00067100
*                                                                     * 00067200
*                 xxxx084C    IxlRsnCodeNoSafAuth:  User does not     * 00067300
*                             have proper SAF authorization.          * 00067400
*                                                                     * 00067500
*                 xxxx0883    IxlRsnCodeBadEmcStgPct:  Value          * 00067600
*                             specified for EmcStgPct is out of       * 00067700
*                             range.                                  * 00067800
*                                                                     * 00067900
*                                                                     * 00068000
*                                                                     * 00068100
*                                                                     * 00068200
*       C         IXLALTER issued in an invalid environment.          * 00068300
*                                                                     * 00068400
*                 HEX REASON   MEANING                                * 00068500
*                 CODE                                                * 00068600
*                                                                     * 00068700
*                                                                     * 00068800
*                 xxxx0C05    IxlRsnCodeStrNotInPolicy:  The          * 00068900
*                             requested structure is not in the CFRM  * 00069000
*                             active policy.                          * 00069100
*                                                                     * 00069200
*                 xxxx0C0A    IxlRsnCodeStrNotAllocated:  The         * 00069300
*                             requested structure is not allocated.   * 00069400
*                                                                     * 00069500
*                 xxxx0C25    IxlRsnCodeStrFailure:  Structure        * 00069600
*                             failure has occurred.                   * 00069700
*                                                                     * 00069800
*                 xxxx0C29    IxlRsnCodeXesNotActive:  The CFRM       * 00069900
*                             function is not active or not           * 00070000
*                             available.                              * 00070100
*                                                                     * 00070200
*                 xxxx0C36    IxlRsnCodeStopInProgress:  Request      * 00070300
*                             rejected because structure rebuild stop * 00070400
*                             was in progress for the structure.      * 00070500
*                                                                     * 00070600
*                 xxxx0C51    IxlRsnCodeRebuildInProgress:  Request   * 00070700
*                             rejected because structure rebuild was  * 00070800
*                             in progress for the structure.          * 00070900
*                                                                     * 00071000
*                 xxxx0C60    IxlRsnCodeNoAlterCF:  Request rejected  * 00071100
*                             because the structure is allocated in a * 00071200
*                             coupling facility that does not support * 00071300
*                             alter.  CFLEVEL equal zero.             * 00071400
*                                                                     * 00071500
*                 xxxx0C61    IxlRsnCodeAllowAlter:  Request rejected * 00071600
*                             because at least one active, failing,   * 00071700
*                             or failed-persistent connection         * 00071800
*                             specified ALLOWALTER=NO on IXLCONN.     * 00071900
*                                                                     * 00072000
*                 xxxx0C62    IxlRsnCodeAlterRatioChg:  Request       * 00072100
*                             rejected because at least one active,   * 00072200
*                             failing, or failed-persistent           * 00072300
*                             connection specified RATIO=NO on        * 00072400
*                             IXLCONN.                                * 00072500
*                                                                     * 00072600
*                 xxxx0C63    IxlRsnCodeAlterNotinProg:  Request      * 00072700
*                             rejected because structure alter is not * 00072800
*                             in progress for the structure.          * 00072900
*                                                                     * 00073000
*                 xxxx0C66    IxlRsnCodeAlterStopInProg:  Request     * 00073100
*                             rejected because alter stop was         * 00073200
*                             requested and an alter stop is already  * 00073300
*                             in progress.                            * 00073400
*                                                                     * 00073500
*                 xxxx0C6E    IxlRsnCodeAlterNotPermitted:  CF        * 00073600
*                             structure alter is not permitted to     * 00073700
*                             start. This may be because of SETXCF    * 00073800
*                             MODIFY,ALTER=DISABLED command.  A       * 00073900
*                             structure-specific ENF35 will be issued * 00074000
*                             when alter is permitted.                * 00074100
*                                                                     * 00074200
*                 xxxx0C76    IxlRsnCodeDupAlter:  Request rejected   * 00074300
*                             because alter stop was requested and a  * 00074400
*                             stop of an alter for a structure in a   * 00074500
*                             system-managed duplexing rebuild is not * 00074600
*                             allowed.                                * 00074700
*                                                                     * 00074800
*                 xxxx0CA2    IxlRsnCodeStorageClassMemoryInUse:      * 00074900
*                             Request rejected because SCM            * 00075000
*                             (storage-class memory) is in use by the * 00075100
*                             structure (or the primary or secondary  * 00075200
*                             instance of the structure when the      * 00075300
*                             structure is in the Duplexing           * 00075400
*                             Established rebuild phase). Note that   * 00075500
*                             SCM is considered to be in use when the * 00075600
*                             count of SCM resident objects is        * 00075700
*                             non-zero or when augmented space is     * 00075800
*                             still allocated to support objects that * 00075900
*                             were resident in SCM.                   * 00076000
*                                                                     * 00076100
*                 FFFFFFFF    IxlRsnCodeNotAvailable:  XES functions  * 00076200
*                             are not available.  This can be because * 00076300
*                             the hardware necessary to provide XES   * 00076400
*                             functions is not present.               * 00076500
*                                                                     * 00076600
*                                                                     * 00076700
*                                                                     * 00076800
*                                                                     * 00076900
*       10        Failure in XES processing.                          * 00077000
*                                                                     * 00077100
*                                                                     * 00077200
*                                                                     * 00077300
*01* REASON CODES:                                                    * 00077400
*                                                                     * 00077500
*       Reason codes, as appropriate, are defined under their         * 00077600
*       corresponding return code.  Reason code and return code       * 00077700
*       constants are defined within IXLYCON.                         * 00077800
*                                                                     * 00077900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00078000
*                                                                     * 00078100
*02*   PROCESSOR:  ASSEM                                              * 00078200
*                                                                     * 00078300
*01* COMPONENT:  SCIXL                                                * 00078400
*                                                                     * 00078500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00078600
*                                                                     * 00078700
*01* MACRO USAGE NOTES:                                               * 00078800
*                                                                     * 00078900
*                                                                     * 00079000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00079100
*        global macro variable.  Any value other than 'NO' will       * 00079200
*        result in the macro expansion being printed.  The default is * 00079300
*        'YES'.  The following examples illustrate how the ZPRINT     * 00079400
*        variable should be set.                                      * 00079500
*                                                                     * 00079600
*                    GBLC &ZPRINT                                     * 00079700
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00079800
*                                                                     * 00079900
*                                                                     * 00080000
*    2.  The IXLALTER macro supports multiple versions. The macro key * 00080100
*        list  below  contains the version level in which the key was * 00080200
*        first  introduced.  Positionals  are  identified by the word * 00080300
*        'Positional'  followed by the numeric value of its position. * 00080400
*        Nested  positionals  are  preceded  by their outer key.  The * 00080500
*        lowest value represents the original version and the highest * 00080600
*        value  represents  the  most  recent version of the IXLALTER * 00080700
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00080800
*        least  as high as the highest version number of all the keys * 00080900
*        being used.                                                  * 00081000
*                                                                     * 00081100
*        VERSION   KEY                                                * 00081200
*                                                                     * 00081300
*              0      ELEMENTRATIO                                    * 00081400
*                     EMCSTG                                          * 00081500
*                     ENTRYRATIO                                      * 00081600
*                     RATIO                                           * 00081700
*                     REQUEST                                         * 00081800
*                     SIZE                                            * 00081900
*                     STRNAME                                         * 00082000
*                     STRSIZE                                         * 00082100
*              1      EMCSTGPCT                                       * 00082200
*                                                                     * 00082300
*                                                                     * 00082400
*                                                                     * 00082500
*01* CHANGE ACTIVITY:                                                 * 00082600
*                                                                     * 00082700
*   Flag LineItem  FMID    Date   ID    Comment                       * 00082800
*                                                                     * 00082900
*    $L0=DNXESSMG HBB5520 940414 PD00XK:  XES dynamic reconfig        * 00083000
*    $D1=DN70083  HBB5520 940815 PD00EA:  Alter function description  * 00083100
*                                         updates                     * 00083200
*    $P1=PN71765  HBB5520 941111 PD00EA:  Alter function description  * 00083300
*                                         updates                     * 00083400
*    $01=OW20970  HBB5520 960930 PD00EA:  Remove xxxx086D reason code * 00083500
*    $02=OW24532  HBB5520 960716 PD00HV:  Alter EMC support           * 00083600
*    $03=OW24460  HBB6603 970730 PD00HV:  Duplexing rebuild support   * 00083700
*    $P2=PXD0394  HBB7703 990927 PD002F:  AutoAlter support           * 00083800
*    $L1=DUPLX    HBB7705 000331 PD002F:  Alter for CF Duplexing      * 00083900
*                                         support                     * 00084000
*    $04=OA08997  HBB7707 041105 PD00XK:  Alter End gives max size    * 00084100
*                                         (fix comment for MSS)       * 00084200
*    $P3=ME18896  HBB7780 110107 PD002F:  Prolog updates for          * 00084300
*                                         system-managed duplexing    * 00084400
*    $05=OA34579  HBB7750 110110 PD00OF:  SETXCF disable alter        * 00084500
*    $L2=CFFLASH  HBB7790 120515 PD00C9:  New Reason Code xxxx0CA2    * 00084600
*    $L3=LSTNOT   HBB77B0 151109 PD00C9:  Prolog updates for List     * 00084700
*                                         Structure Considerations    * 00084800
****** END OF SPECIFICATIONS *****************************************/ 00084900
*/********************************************************************* 00085000
         MACRO                                                          00085100
&XLABEL  IXLALTER &STRNAME=,&REQUEST=,&STRSIZE=,&ENTRYRATIO=,          *00085200
               &ELEMENTRATIO=,&EMCSTGPCT=,&RETCODE=,&RSNCODE=,         *00085300
               &PLISTVER=,&MF=                                          00085400
.*                                                                      00085500
*                  MACDATE -01/13/18-<1>                                00085600
.*                                                                      00085700
.*******************************************************************    00085800
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00085900
.*******************************************************************    00086000
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00086100
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00086200
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00086300
.*                                                                      00086400
                  GBLC  &ZIXLALTER  YES=MACRO USED AT LEAST ONCE        00086500
.*******************************************************************    00086600
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00086700
.*******************************************************************    00086800
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00086900
                  LCLC  &ZCNDX      SYSNDX CHARACTERS                   00087000
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00087100
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00087200
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00087300
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00087400
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00087500
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00087600
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00087700
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00087800
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00087900
                  LCLC  &ZMAC_G     "G" or null                         00088000
&ZMAC_G           SETC  ''                                              00088100
                  LCLC  &ZMAC_LR                                        00088200
&ZMAC_LR          SETC  'LR'                                            00088300
                  LCLC  &ZMAC_L                                         00088400
&ZMAC_L           SETC  'L'                                             00088500
                  LCLC  &ZMAC_ST                                        00088600
&ZMAC_ST          SETC  'ST'                                            00088700
                  LCLC  &ZMAC_LLGT                                      00088800
&ZMAC_LLGT        SETC  'L'                                             00088900
                  LCLC  &ZMAC_LGR                                       00089000
&ZMAC_LGR         SETC  'LR'                                            00089100
                  LCLC  &ZMAC_LG                                        00089200
&ZMAC_LG          SETC  'L'                                             00089300
                  LCLC  &ZMAC_STG                                       00089400
&ZMAC_STG         SETC  'ST'                                            00089500
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00089600
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00089700
.*                                                                      00089800
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00089900
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00090000
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00090100
                  LCLC  &ZENDBASEPL             End of base PL          00090200
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00090300
.*******************************************************************    00090400
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00090500
.*******************************************************************    00090600
                  LCLA  &ZI         INDEX FOR ARRAY                     00090700
                  LCLA  &ZJ         INDEX FOR PARMS                     00090800
                  LCLA  &ZK         INDEX FOR PARSE                     00090900
                  LCLA  &ZLO        LOW RANGE VALUE                     00091000
                  LCLA  &ZHI        HIGH RANGE VALUE                    00091100
                  LCLC  &ZW         WORK AREA FOR PARM                  00091200
.********************************************************************   00091300
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00091400
.********************************************************************   00091500
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00091600
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00091700
                  GBLA  &SYSALVL    SYSSTATE ARCHLVL                    00091800
                  GBLC  &SYSAM64    SYSSTATE AMODE64                    00091900
.*                                                                      00092000
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00092100
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00092200
                  SPLEVEL  TEST                                         00092300
.ZSYS2            ANOP  ,                                               00092400
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00092500
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00092600
                  SYSSTATE TEST                                         00092700
                  AGO   .ZSYS4                                          00092800
.ZSYS3            ANOP  ,                                               00092900
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00093000
.ZSYS4            ANOP  ,                                               00093100
                  AIF   ('&SYSAM64' NE 'YES').ZSYSN64                   00093200
&ZMAC_LLGT        SETC 'LLGT'                                           00093300
&ZMAC_LGR         SETC 'LGR'                                            00093400
&ZMAC_LG          SETC 'LG'                                             00093500
&ZMAC_STG         SETC 'STG'                                            00093600
.ZSYSN64          ANOP  ,                                               00093700
.*******************************************************************    00093800
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00093900
.*******************************************************************    00094000
                  LCLC  &XSTRNAME   ++ NAME                             00094100
                  LCLC  &XREQUEST   ++ VALUE                            00094200
                  LCLC  &XSIZE      ++ NAME                             00094300
                  LCLC  &XSTRSIZE   ++ NAME                             00094400
                  LCLC  &XRATIO     ++ NAME                             00094500
                  LCLC  &XENTRYRATIO            ++ NAME                 00094600
                  LCLC  &XELEMENTRATIO          ++ NAME                 00094700
                  LCLC  &XEMCSTG    ++ NAME                             00094800
                  LCLC  &XEMCSTGPCT             ++ NAME                 00094900
                  LCLC  &XRETCODE   ++ NAME                             00095000
                  LCLC  &XRSNCODE   ++ NAME                             00095100
                  LCLA  &XPLISTVER  ++ VALUE                            00095200
                  LCLC  &XMF        ++ VALUE                            00095300
                  LCLC  &XMFCTRL    ++ NAME                             00095400
                  LCLC  &XMFATTR    ++ VALUE                            00095500
                  LCLC  &XMFSCK     ++ VALUE                            00095600
.*******************************************************************    00095700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00095800
.*******************************************************************    00095900
                  LCLC  &ZXSTRNAME  ++ INPUT NAME                       00096000
                  LCLC  &ZXREQUEST  ++ INPUT VALUE                      00096100
                  LCLC  &ZXSIZE     ++ INPUT NAME                       00096200
                  LCLC  &ZXSTRSIZE  ++ INPUT NAME                       00096300
                  LCLC  &ZXRATIO    ++ INPUT NAME                       00096400
                  LCLC  &ZXENTRYRATIO           ++ INPUT NAME           00096500
                  LCLC  &ZXELEMENTRATIO         ++ INPUT NAME           00096600
                  LCLC  &ZXEMCSTG   ++ INPUT NAME                       00096700
                  LCLC  &ZXEMCSTGPCT            ++ INPUT NAME           00096800
                  LCLC  &ZXRETCODE  ++ OUTPUT NAME                      00096900
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00097000
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00097100
                  LCLC  &ZXMF       ++ INPUT VALUE                      00097200
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00097300
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00097400
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00097500
.********************************************************************   00097600
.***AC.PLV01  PROCESS PLISTVER                                      *   00097700
.********************************************************************   00097800
&XPLISTVER      SETA  0                                                 00097900
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00098000
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00098100
&XPLISTVER      SETA  1                                                 00098200
.ZPLV0          ANOP  ,                                                 00098300
.*                                                                      00098400
                AIF   ('&EMCSTGPCT' EQ '').ZPLV1E                       00098500
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00098600
&XPLISTVER      SETA  1                                                 00098700
.ZPLV1E         ANOP  ,                                                 00098800
.*                                                                      00098900
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00099000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00099100
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00099200
.*-------------------------------------------------------------------   00099300
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00099400
&ZMS            SETC  '"PLISTVER='                                      00099500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00099600
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00099700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00099800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00099900
                AGO   .ZPVCK2                                           00100000
.ZPVCK3         ANOP  ,                                                 00100100
.*-------------------------------------------------------------------   00100200
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00100300
&ZMS            SETC  '"PLISTVER='                                      00100400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00100500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00100600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00100700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00100800
                AGO   .ZPVCKE                                           00100900
.ZPVCK2         ANOP  ,                                                 00101000
.*-------------------------------------------------------------------   00101100
&ZCVAL          SETC  '&PLISTVER(1)'                                    00101200
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00101300
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00101400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00101500
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00101600
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00101700
.ZPVCK6         ANOP  ,                                                 00101800
&ZMS            SETC  '"PLISTVER='                                      00101900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00102000
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00102100
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00102200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00102300
&XPLISTVER      SETA  1                                                 00102400
                AGO   .ZPVCKE                                           00102500
.*-------------------------------------------------------------------   00102600
.ZPVCK4A        ANOP  ,                                                 00102700
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00102800
&ZMS            SETC  'PLISTVER='                                       00102900
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00103000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00103100
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00103200
                MNOTE 8,' &ZMS IS REQUIRED.'                            00103300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00103400
                AGO   .ZPVCK5                                           00103500
.ZPVCK4         ANOP  ,                                                 00103600
&XPLISTVER      SETA  &PLISTVER(1)                                      00103700
.ZPVCK5         ANOP  ,                                                 00103800
.ZPVCKE         ANOP  ,                                                 00103900
.********************************************************************   00104000
.***AG.MF01 PROCESS MF MACRO FORMS                                      00104100
.********************************************************************   00104200
                  ACTR  10000                                           00104300
.*------------------------------------------------------------------    00104400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104500
&XMF              SETC  ''          INITIALIZE XVARIABLE                00104600
.*-------------------------------------------------------------------   00104700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00104800
.ZG37             ANOP  ,                                               00104900
&ZTLC             SETC 'S'                                              00105000
                  AIF   ('&MF(1)' NE '&ZTLC').ZG38                      00105100
&XMF              SETC  'S'         SET KEYWORD                         00105200
                  AIF   (N'&MF LE 1).ZG37A      CK NUM                  00105300
&ZMS              SETC  '"MF='                                          00105400
&ZMS              SETC  '&ZMS.&MF"'                                     00105500
&ZMS              SETC  '&ZMS "MF"'                                     00105600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00105700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00105800
.ZG37A            ANOP  ,                                               00105900
.*-------------------------------------------------------------------   00106000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00106100
.ZG38             ANOP  ,                                               00106200
&ZTLC             SETC 'L'                                              00106300
                  AIF   ('&MF(1)' NE '&ZTLC').ZG45                      00106400
&XMF              SETC  'L'         SET KEYWORD                         00106500
                  AIF   (N'&MF LE 3).ZG38A      CK NUM                  00106600
&ZMS              SETC  '"MF='                                          00106700
&ZMS              SETC  '&ZMS.&MF"'                                     00106800
&ZMS              SETC  '&ZMS "MF"'                                     00106900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00107000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00107100
.ZG38A            ANOP  ,                                               00107200
.*-------------------------------------------------------------------   00107300
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00107400
                  AIF   (N'&SYSLIST NE 0).ZG38B  POSITIONALS?           00107500
                  AIF   ('&STRNAME' NE '').ZG38B  KEYS?                 00107600
                  AIF   ('&REQUEST' NE '').ZG38B  KEYS?                 00107700
                  AIF   ('&STRSIZE' NE '').ZG38B  KEYS?                 00107800
                  AIF   ('&ENTRYRATIO' NE '').ZG38B  KEYS?              00107900
                  AIF   ('&ELEMENTRATIO' NE '').ZG38B  KEYS?            00108000
                  AIF   ('&EMCSTGPCT' NE '').ZG38B  KEYS?               00108100
                  AIF   ('&RETCODE' NE '').ZG38B  KEYS?                 00108200
                  AIF   ('&RSNCODE' NE '').ZG38B  KEYS?                 00108300
                  AGO    .ZG38C     INVOCATION OKAY                     00108400
.ZG38B            ANOP  ,                                               00108500
&ZMS              SETC  'THE "L" FORM OF "MF"'                          00108600
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00108700
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00108800
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00108900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00109000
.ZG38C            ANOP  ,                                               00109100
.*-------------------------------------------------------------------   00109200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00109300
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00109400
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00109500
                  AIF   (N'&MF(2) GT 1).ZG40B   MULTI                   00109600
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00109700
.ZG40B            AIF   (K'&MF(2) GT 0).ZG40C                           00109800
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00109900
&ZMS              SETC  'WHEN "L" IS SPECIFIED'                         00110000
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00110100
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00110200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00110300
.ZG40C            ANOP  ,                                               00110400
.*-------------------------------------------------------------------   00110500
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00110600
                  AIF   (K'&ZXMFCTRL LE 0).ZG40P  NOT I/O               00110700
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG40P                  00110800
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00110900
&ZMS              SETC  '"MF='                                          00111000
&ZMS              SETC  '&ZMS.&MF"'                                     00111100
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00111200
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00111300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00111400
.ZG40P            ANOP  ,                                               00111500
.*-------------------------------------------------------------------   00111600
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00111700
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00111800
&XMFATTR          SETC  '0D'                                            00111900
                  AIF   (K'&MF(3) LE 0).ZG43B   PARM                    00112000
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00112100
                  AIF   (N'&MF(3) GT 1).ZG43B   MULTI                   00112200
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00112300
.ZG43B            ANOP  ,                                               00112400
.*-------------------------------------------------------------------   00112500
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00112600
                  AIF   (K'&ZXMFATTR LE 0).ZG43P  NOT I/O               00112700
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG43P                  00112800
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00112900
&ZMS              SETC  '"MF='                                          00113000
&ZMS              SETC  '&ZMS.&MF"'                                     00113100
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00113200
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00113300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00113400
.ZG43P            ANOP  ,                                               00113500
.*-------------------------------------------------------------------   00113600
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00113700
                  AIF   (K'&ZXMFATTR LE 0).ZG43S  NOT I/O               00113800
                  AIF   (K'&XMFATTR LE 60).ZG43S  LNG OK                00113900
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00114000
&ZMS              SETC  '"MF='                                          00114100
&ZMS              SETC  '&ZMS.&MF"'                                     00114200
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00114300
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00114400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00114500
.ZG43S            ANOP  ,                                               00114600
.*-------------------------------------------------------------------   00114700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114800
.ZG45             ANOP  ,                                               00114900
&ZTLC             SETC 'E'                                              00115000
                  AIF   ('&MF(1)' NE '&ZTLC').ZG53                      00115100
&XMF              SETC  'E'         SET KEYWORD                         00115200
                  AIF   (N'&MF LE 3).ZG45A      CK NUM                  00115300
&ZMS              SETC  '"MF='                                          00115400
&ZMS              SETC  '&ZMS.&MF"'                                     00115500
&ZMS              SETC  '&ZMS "MF"'                                     00115600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00115700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00115800
.ZG45A            ANOP  ,                                               00115900
.*-------------------------------------------------------------------   00116000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00116100
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00116200
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00116300
                  AIF   (N'&MF(2) GT 1).ZG47B   MULTI                   00116400
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00116500
.ZG47B            AIF   (K'&MF(2) GT 0).ZG47C                           00116600
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00116700
&ZMS              SETC  'WHEN "E" IS SPECIFIED'                         00116800
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00116900
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00117000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00117100
.ZG47C            ANOP  ,                                               00117200
.*-------------------------------------------------------------------   00117300
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00117400
                  AIF   (K'&ZXMFCTRL LE 0).ZG47R  NOT I/O               00117500
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG47R                  00117600
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00117700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                    00117800
                  AIF   (K'&ZCGPR GT 2).ZG47Q                           00117900
                  AIF   ('&ZCGPR' EQ '0').ZG47Q                         00118000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00118100
                  AIF   (T'&ZCGPR NE 'N').ZG47Q  INVALID REG NAME       00118200
.ZG47P            ANOP  ,                                               00118300
                  AIF   (T'&ZCGPR NE 'N').ZG47R  NON NUMERIC            00118400
                  AIF   ('&ZCGPR' LT '1').ZG47Q                         00118500
                  AIF   ('&ZCGPR' LE '12').ZG47R                        00118600
.ZG47Q            ANOP  ,                                               00118700
&ZMS              SETC  '"MF='                                          00118800
&ZMS              SETC  '&ZMS.&MF"'                                     00118900
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00119000
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00119100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00119200
.ZG47R            ANOP  ,                                               00119300
.*-------------------------------------------------------------------   00119400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00119500
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00119600
.ZG51A   AIF   ('&MF(3)' NE 'COMPLETE').ZG52A                           00119700
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00119800
.*-------------------------------------------------------------------   00119900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120000
.ZG52A            AIF   (K'&XMFSCK GT 0).ZG52C  KEYWORD                 00120100
                  AIF   (K'&MF(3) LE 0).ZG52B                           00120200
&ZMS              SETC  '"MF='                                          00120300
&ZMS              SETC  '&ZMS.&MF"'                                     00120400
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00120500
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00120600
&ZMS              SETC  '&ZMS "COMPLETE".'                              00120700
                  MNOTE 8,' &ZMS '                                      00120800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00120900
.ZG52B            ANOP  ,                                               00121000
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00121100
.ZG52C            ANOP  ,                                               00121200
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00121300
.*------------------------------------------------------------------    00121400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121500
.ZG53             ANOP  ,                                               00121600
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00121700
                  AIF   (K'&XMF GT 0).ZG53E     VALID ARG               00121800
                  AIF   (T'&MF EQ 'O').ZG53D    OMITTED                 00121900
&ZASYSLNDX        SETA  0                                               00122000
.ZG53A            ANOP  ,           POSITIONAL MACRO KEY                00122100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00122200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG53C                00122300
&ZTLC             SETC 'MF'                                             00122400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG53A       00122500
.ZG53B            ANOP  ,                                               00122600
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00122700
&ZMS              SETC  'THE "MF" KEY'                                  00122800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00122900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00123000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00123100
                  AGO   .ZG53E                                          00123200
.ZG53C            ANOP  ,                                               00123300
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00123400
&ZMS              SETC  '"MF='                                          00123500
&ZMS              SETC  '&ZMS.&MF"'                                     00123600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00123700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00123800
&ZMS              SETC  '&ZMS "S",'                                     00123900
&ZMS              SETC  '&ZMS "L",'                                     00124000
&ZMS              SETC  '&ZMS OR "E".'                                  00124100
                  MNOTE 8,' &ZMS '                                      00124200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00124300
                  AGO   .ZG53E                                          00124400
.ZG53D            ANOP  ,                                               00124500
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00124600
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00124700
.ZG53E            ANOP  ,                                               00124800
.********************************************************************   00124900
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00125000
.********************************************************************   00125100
                  ACTR  10000                                           00125200
.*-------------------------------------------------------------------   00125300
.***AG.MF03 MF=(SLE)                                                    00125400
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00125500
.*----------------------------------------------------------------***   00125600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00125700
                  AIF   (N'&STRNAME LE 1).ZG2A  CK NUM                  00125800
&ZMS              SETC  '"STRNAME='                                     00125900
&ZMS              SETC  '&ZMS.&STRNAME"'                                00126000
&ZMS              SETC  '&ZMS "STRNAME"'                                00126100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00126200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00126300
.ZG2A             ANOP  ,                                               00126400
.*-------------------------------------------------------------------   00126500
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00126600
&ZXSTRNAME        SETC  'INPUT'     SET IN/OUTPUT                       00126700
&XSTRNAME         SETC  '&STRNAME(1)'           SET XVARIABLE           00126800
                  AIF   (N'&STRNAME GT 1).ZG2B  MULTI                   00126900
&XSTRNAME         SETC  '&STRNAME'  SET XVARIABLE                       00127000
.ZG2B             AIF   (K'&STRNAME(1) GT 0).ZG2C                       00127100
&ZXSTRNAME        SETC  ''          RESET IN/OUTPUT                     00127200
&ZMS              SETC  ' '                                             00127300
&ZMS              SETC  '&ZMS "STRNAME" KEY AND ITS'                    00127400
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00127500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00127600
.ZG2C             ANOP  ,                                               00127700
.*-------------------------------------------------------------------   00127800
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00127900
                  AIF   (K'&ZXSTRNAME LE 0).ZG2R  NOT I/O               00128000
                  AIF   ('&XSTRNAME'(1,1) NE '(').ZG2R                  00128100
&ZCGPR            SETC  '&XSTRNAME'(2,K'&XSTRNAME-2)                    00128200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                     00128300
                  AIF   (K'&ZCGPR GT 2).ZG2Q                            00128400
                  AIF   ('&ZCGPR' EQ '0').ZG2Q                          00128500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00128600
                  AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME        00128700
.ZG2P             ANOP  ,                                               00128800
                  AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC             00128900
                  AIF   ('&ZCGPR' LT '2').ZG2Q                          00129000
                  AIF   ('&ZCGPR' LE '12').ZG2R                         00129100
.ZG2Q             ANOP  ,                                               00129200
&ZMS              SETC  '"STRNAME='                                     00129300
&ZMS              SETC  '&ZMS.&STRNAME"'                                00129400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00129500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00129600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00129700
.ZG2R             ANOP  ,                                               00129800
.*------------------------------------------------------------------    00129900
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130000
&XREQUEST         SETC  ''          INITIALIZE XVARIABLE                00130100
.*-------------------------------------------------------------------   00130200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130300
.ZG6              ANOP  ,                                               00130400
                  AIF   (T'&REQUEST EQ 'O').ZG24  OMITTED               00130500
&ZTLC             SETC 'START'                                          00130600
                  AIF   ('&REQUEST(1)' NE '&ZTLC').ZG24                 00130700
&XREQUEST         SETC  'START'     SET KEYWORD                         00130800
                  AIF   (N'&REQUEST LE 1).ZG6A  CK NUM                  00130900
&ZMS              SETC  '"REQUEST='                                     00131000
&ZMS              SETC  '&ZMS.&REQUEST"'                                00131100
&ZMS              SETC  '&ZMS "REQUEST"'                                00131200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00131300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00131400
.ZG6A             ANOP  ,                                               00131500
.*----------------------------------------------------------------***   00131600
.***AG.KMGRP01  -NO ARGUMENTS                                           00131700
&XSIZE            SETC  ''          RESET XVARIABLE                     00131800
&ZXSIZE           SETC  ''          RESET IN/OUTPUT                     00131900
&XRATIO           SETC  ''          RESET XVARIABLE                     00132000
&ZXRATIO          SETC  ''          RESET IN/OUTPUT                     00132100
&XEMCSTG          SETC  ''          RESET XVARIABLE                     00132200
&ZXEMCSTG         SETC  ''          RESET IN/OUTPUT                     00132300
&ZASYSLNDX        SETA  0                                               00132400
.ZGG8A            ANOP  ,           POSITIONAL MACRO KEY                00132500
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00132600
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGG8X                         00132700
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGG8A            00132800
         AIF   ('&SYSLIST(&ZASYSLNDX)' EQ 'SIZE').ZGG8                  00132900
         AIF   ('&SYSLIST(&ZASYSLNDX)' EQ 'RATIO').ZGG12                00133000
         AIF   ('&SYSLIST(&ZASYSLNDX)' EQ 'EMCSTG').ZGG19               00133100
                  AGO   .ZGG8A                                          00133200
.ZGG8             ANOP  ,                                               00133300
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           POSITIONAL IS MACRO KEY 00133400
&XSIZE            SETC  'SIZE'      MACRO KEY FOUND                     00133500
&ZXSIZE           SETC  'INPUT'     SET IN/OUTPUT                       00133600
                  AGO   .ZGG8A                                          00133700
.ZGG12            ANOP  ,                                               00133800
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           POSITIONAL IS MACRO KEY 00133900
&XRATIO           SETC  'RATIO'     MACRO KEY FOUND                     00134000
&ZXRATIO          SETC  'INPUT'     SET IN/OUTPUT                       00134100
                  AGO   .ZGG8A                                          00134200
.ZGG19            ANOP  ,                                               00134300
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           POSITIONAL IS MACRO KEY 00134400
&XEMCSTG          SETC  'EMCSTG'    MACRO KEY FOUND                     00134500
&ZXEMCSTG         SETC  'INPUT'     SET IN/OUTPUT                       00134600
                  AGO   .ZGG8A                                          00134700
.ZGG8X            ANOP  ,                                               00134800
.*-------------------------------------------------------------------   00134900
.***AG.KXVAR0A NAME, RQD INPUT, KEYS -XVARIABLE                         00135000
                  AIF   (K'&XSIZE GT 0).ZG10B2  KEY                     00135100
                  AIF   (K'&STRSIZE(1) LE 0).ZG10AX  NO PRM             00135200
&ZMS              SETC  '"STRSIZE'                                      00135300
&ZMS              SETC  '&ZMS.=&STRSIZE"'                               00135400
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00135500
&ZMS              SETC  '&ZMS '                                         00135600
&ZMS              SETC  '&ZMS "SIZE"'                                   00135700
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00135800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00135900
                  AGO   .ZG10AX                                         00136000
.ZG10B2           ANOP  ,                                               00136100
.*----------------------------------------------------------------***   00136200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00136300
                  AIF   (N'&STRSIZE LE 1).ZG10A  CK NUM                 00136400
&ZMS              SETC  '"STRSIZE='                                     00136500
&ZMS              SETC  '&ZMS.&STRSIZE"'                                00136600
&ZMS              SETC  '&ZMS "STRSIZE"'                                00136700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00136800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00136900
.ZG10A            ANOP  ,                                               00137000
.*-------------------------------------------------------------------   00137100
.***AG.KXVAR09 NAME, RQD INPUT, KEYS -XVARIABLE                         00137200
&ZXSTRSIZE        SETC  'INPUT'     SET IN/OUTPUT                       00137300
&XSTRSIZE         SETC  '&STRSIZE(1)'           SET XVARIABLE           00137400
                  AIF   (N'&STRSIZE GT 1).ZG10B  MULTI                  00137500
&XSTRSIZE         SETC  '&STRSIZE'  SET XVARIABLE                       00137600
.ZG10B            AIF   (K'&XSIZE GT 0).ZG10C   KEY                     00137700
                  AIF   (K'&STRSIZE(1) LE 0).ZG10D  PARM                00137800
&ZMS              SETC  '"STRSIZE'                                      00137900
&ZMS              SETC  '&ZMS.=&STRSIZE"'                               00138000
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00138100
&ZMS              SETC  '&ZMS '                                         00138200
&ZMS              SETC  '&ZMS "SIZE"'                                   00138300
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00138400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00138500
                  AGO   .ZG10E                                          00138600
.*                                                                      00138700
.ZG10C            AIF   (K'&STRSIZE(1) GT 0).ZG10E  PARM                00138800
                  AIF   (T'&XSIZE EQ 'O').ZG10E  OMITTED                00138900
&ZXSTRSIZE        SETC  ''          RESET IN/OUTPUT                     00139000
&ZMS              SETC  ' '                                             00139100
&ZMS              SETC  '&ZMS "STRSIZE" KEY AND ITS'                    00139200
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00139300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00139400
.ZG10D            ANOP  ,                                               00139500
&XSTRSIZE         SETC  '0'         SET DEFAULT                         00139600
.ZG10E            ANOP  ,                                               00139700
                  AIF   (K'&STRSIZE(1) GT 0).ZG10F  SPECIFIED           00139800
&ZXSTRSIZE        SETC  ''          RESET IN/OUTPUT                     00139900
.ZG10F            ANOP  ,                                               00140000
.ZG10AX           ANOP  ,                                               00140100
.*-------------------------------------------------------------------   00140200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00140300
                  AIF   (K'&ZXSTRSIZE LE 0).ZG10R  NOT I/O              00140400
                  AIF   ('&XSTRSIZE'(1,1) NE '(').ZG10R                 00140500
&ZCGPR            SETC  '&XSTRSIZE'(2,K'&XSTRSIZE-2)                    00140600
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                    00140700
                  AIF   (K'&ZCGPR GT 2).ZG10Q                           00140800
                  AIF   ('&ZCGPR' EQ '0').ZG10Q                         00140900
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00141000
                  AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME       00141100
.ZG10P            ANOP  ,                                               00141200
                  AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC            00141300
                  AIF   ('&ZCGPR' LT '2').ZG10Q                         00141400
                  AIF   ('&ZCGPR' LE '12').ZG10R                        00141500
.ZG10Q            ANOP  ,                                               00141600
&ZMS              SETC  '"STRSIZE='                                     00141700
&ZMS              SETC  '&ZMS.&STRSIZE"'                                00141800
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00141900
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00142000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00142100
.ZG10R            ANOP  ,                                               00142200
.*-------------------------------------------------------------------   00142300
.***AG.KXVAR0A NAME, RQD INPUT, KEYS -XVARIABLE                         00142400
                  AIF   (K'&XRATIO GT 0).ZG14B2  KEY                    00142500
                  AIF   (K'&ENTRYRATIO(1) LE 0).ZG14AX  NO PRM          00142600
&ZMS              SETC  '"ENTRYRATIO'                                   00142700
&ZMS              SETC  '&ZMS.=&ENTRYRATIO"'                            00142800
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00142900
&ZMS              SETC  '&ZMS '                                         00143000
&ZMS              SETC  '&ZMS "RATIO"'                                  00143100
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00143200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00143300
                  AGO   .ZG14AX                                         00143400
.ZG14B2           ANOP  ,                                               00143500
.*----------------------------------------------------------------***   00143600
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00143700
                  AIF   (N'&ENTRYRATIO LE 1).ZG14A  CK NUM              00143800
&ZMS              SETC  '"ENTRYRATIO='                                  00143900
&ZMS              SETC  '&ZMS.&ENTRYRATIO"'                             00144000
&ZMS              SETC  '&ZMS "ENTRYRATIO"'                             00144100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00144200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00144300
.ZG14A            ANOP  ,                                               00144400
.*-------------------------------------------------------------------   00144500
.***AG.KXVAR09 NAME, RQD INPUT, KEYS -XVARIABLE                         00144600
&ZXENTRYRATIO     SETC  'INPUT'     SET IN/OUTPUT                       00144700
&XENTRYRATIO      SETC  '&ENTRYRATIO(1)'        SET XVARIABLE           00144800
                  AIF   (N'&ENTRYRATIO GT 1).ZG14B  MULTI               00144900
&XENTRYRATIO      SETC  '&ENTRYRATIO'           SET XVARIABLE           00145000
.ZG14B            AIF   (K'&XRATIO GT 0).ZG14C  KEY                     00145100
                  AIF   (K'&ENTRYRATIO(1) LE 0).ZG14D  PARM             00145200
&ZMS              SETC  '"ENTRYRATIO'                                   00145300
&ZMS              SETC  '&ZMS.=&ENTRYRATIO"'                            00145400
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00145500
&ZMS              SETC  '&ZMS '                                         00145600
&ZMS              SETC  '&ZMS "RATIO"'                                  00145700
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00145800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00145900
                  AGO   .ZG14E                                          00146000
.*                                                                      00146100
.ZG14C            AIF   (K'&ENTRYRATIO(1) GT 0).ZG14E  PARM             00146200
                  AIF   (T'&XRATIO EQ 'O').ZG14E  OMITTED               00146300
&ZXENTRYRATIO     SETC  ''          RESET IN/OUTPUT                     00146400
&ZMS              SETC  ' '                                             00146500
&ZMS              SETC  '&ZMS "ENTRYRATIO" KEY AND ITS'                 00146600
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00146700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00146800
.ZG14D            ANOP  ,                                               00146900
&XENTRYRATIO      SETC  '0'         SET DEFAULT                         00147000
.ZG14E            ANOP  ,                                               00147100
                  AIF   (K'&ENTRYRATIO(1) GT 0).ZG14F  SPECIFIED        00147200
&ZXENTRYRATIO     SETC  ''          RESET IN/OUTPUT                     00147300
.ZG14F            ANOP  ,                                               00147400
.ZG14AX           ANOP  ,                                               00147500
.*-------------------------------------------------------------------   00147600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00147700
                  AIF   (K'&ZXENTRYRATIO LE 0).ZG14R  NOT I/O           00147800
                  AIF   ('&XENTRYRATIO'(1,1) NE '(').ZG14R              00147900
&ZCGPR            SETC  '&XENTRYRATIO'(2,K'&XENTRYRATIO-2)              00148000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                    00148100
                  AIF   (K'&ZCGPR GT 2).ZG14Q                           00148200
                  AIF   ('&ZCGPR' EQ '0').ZG14Q                         00148300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00148400
                  AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME       00148500
.ZG14P            ANOP  ,                                               00148600
                  AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC            00148700
                  AIF   ('&ZCGPR' LT '2').ZG14Q                         00148800
                  AIF   ('&ZCGPR' LE '12').ZG14R                        00148900
.ZG14Q            ANOP  ,                                               00149000
&ZMS              SETC  '"ENTRYRATIO='                                  00149100
&ZMS              SETC  '&ZMS.&ENTRYRATIO"'                             00149200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00149300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00149400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00149500
.ZG14R            ANOP  ,                                               00149600
.*-------------------------------------------------------------------   00149700
.***AG.KXVAR0A NAME, RQD INPUT, KEYS -XVARIABLE                         00149800
                  AIF   (K'&XRATIO GT 0).ZG17B2  KEY                    00149900
                  AIF   (K'&ELEMENTRATIO(1) LE 0).ZG17AX  NO PRM        00150000
&ZMS              SETC  '"ELEMENTRATIO'                                 00150100
&ZMS              SETC  '&ZMS.=&ELEMENTRATIO"'                          00150200
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00150300
&ZMS              SETC  '&ZMS '                                         00150400
&ZMS              SETC  '&ZMS "RATIO"'                                  00150500
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00150600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00150700
                  AGO   .ZG17AX                                         00150800
.ZG17B2           ANOP  ,                                               00150900
.*----------------------------------------------------------------***   00151000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00151100
                  AIF   (N'&ELEMENTRATIO LE 1).ZG17A  CK NUM            00151200
&ZMS              SETC  '"ELEMENTRATIO='                                00151300
&ZMS              SETC  '&ZMS.&ELEMENTRATIO"'                           00151400
&ZMS              SETC  '&ZMS "ELEMENTRATIO"'                           00151500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00151600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00151700
.ZG17A            ANOP  ,                                               00151800
.*-------------------------------------------------------------------   00151900
.***AG.KXVAR09 NAME, RQD INPUT, KEYS -XVARIABLE                         00152000
&ZXELEMENTRATIO   SETC  'INPUT'     SET IN/OUTPUT                       00152100
&XELEMENTRATIO    SETC  '&ELEMENTRATIO(1)'      SET XVARIABLE           00152200
                  AIF   (N'&ELEMENTRATIO GT 1).ZG17B  MULTI             00152300
&XELEMENTRATIO    SETC  '&ELEMENTRATIO'         SET XVARIABLE           00152400
.ZG17B            AIF   (K'&XRATIO GT 0).ZG17C  KEY                     00152500
                  AIF   (K'&ELEMENTRATIO(1) LE 0).ZG17D  PARM           00152600
&ZMS              SETC  '"ELEMENTRATIO'                                 00152700
&ZMS              SETC  '&ZMS.=&ELEMENTRATIO"'                          00152800
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00152900
&ZMS              SETC  '&ZMS '                                         00153000
&ZMS              SETC  '&ZMS "RATIO"'                                  00153100
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00153200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00153300
                  AGO   .ZG17E                                          00153400
.*                                                                      00153500
.ZG17C            AIF   (K'&ELEMENTRATIO(1) GT 0).ZG17E  PARM           00153600
                  AIF   (T'&XRATIO EQ 'O').ZG17E  OMITTED               00153700
&ZXELEMENTRATIO   SETC  ''          RESET IN/OUTPUT                     00153800
&ZMS              SETC  ' '                                             00153900
&ZMS              SETC  '&ZMS "ELEMENTRATIO" KEY AND ITS'               00154000
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00154100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00154200
.ZG17D            ANOP  ,                                               00154300
&XELEMENTRATIO    SETC  '0'         SET DEFAULT                         00154400
.ZG17E            ANOP  ,                                               00154500
                  AIF   (K'&ELEMENTRATIO(1) GT 0).ZG17F  SPECIFIED      00154600
&ZXELEMENTRATIO   SETC  ''          RESET IN/OUTPUT                     00154700
.ZG17F            ANOP  ,                                               00154800
.ZG17AX           ANOP  ,                                               00154900
.*-------------------------------------------------------------------   00155000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00155100
                  AIF   (K'&ZXELEMENTRATIO LE 0).ZG17R  NOT I/O         00155200
                  AIF   ('&XELEMENTRATIO'(1,1) NE '(').ZG17R            00155300
&ZCGPR            SETC  '&XELEMENTRATIO'(2,K'&XELEMENTRATIO-2)          00155400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                    00155500
                  AIF   (K'&ZCGPR GT 2).ZG17Q                           00155600
                  AIF   ('&ZCGPR' EQ '0').ZG17Q                         00155700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00155800
                  AIF   (T'&ZCGPR NE 'N').ZG17Q  INVALID REG NAME       00155900
.ZG17P            ANOP  ,                                               00156000
                  AIF   (T'&ZCGPR NE 'N').ZG17R  NON NUMERIC            00156100
                  AIF   ('&ZCGPR' LT '2').ZG17Q                         00156200
                  AIF   ('&ZCGPR' LE '12').ZG17R                        00156300
.ZG17Q            ANOP  ,                                               00156400
&ZMS              SETC  '"ELEMENTRATIO='                                00156500
&ZMS              SETC  '&ZMS.&ELEMENTRATIO"'                           00156600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00156700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00156800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00156900
.ZG17R            ANOP  ,                                               00157000
.*-------------------------------------------------------------------   00157100
.***AG.KXVAR0A NAME, RQD INPUT, KEYS -XVARIABLE                         00157200
                  AIF   (K'&XEMCSTG GT 0).ZG21B2  KEY                   00157300
                  AIF   (K'&EMCSTGPCT(1) LE 0).ZG21AX  NO PRM           00157400
&ZMS              SETC  '"EMCSTGPCT'                                    00157500
&ZMS              SETC  '&ZMS.=&EMCSTGPCT"'                             00157600
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00157700
&ZMS              SETC  '&ZMS '                                         00157800
&ZMS              SETC  '&ZMS "EMCSTG"'                                 00157900
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00158000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00158100
                  AGO   .ZG21AX                                         00158200
.ZG21B2           ANOP  ,                                               00158300
.*----------------------------------------------------------------***   00158400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00158500
                  AIF   (N'&EMCSTGPCT LE 1).ZG21A  CK NUM               00158600
&ZMS              SETC  '"EMCSTGPCT='                                   00158700
&ZMS              SETC  '&ZMS.&EMCSTGPCT"'                              00158800
&ZMS              SETC  '&ZMS "EMCSTGPCT"'                              00158900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00159000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00159100
.ZG21A            ANOP  ,                                               00159200
.*-------------------------------------------------------------------   00159300
.***AG.KXVAR09 NAME, RQD INPUT, KEYS -XVARIABLE                         00159400
&ZXEMCSTGPCT      SETC  'INPUT'     SET IN/OUTPUT                       00159500
&XEMCSTGPCT       SETC  '&EMCSTGPCT(1)'         SET XVARIABLE           00159600
                  AIF   (N'&EMCSTGPCT GT 1).ZG21B  MULTI                00159700
&XEMCSTGPCT       SETC  '&EMCSTGPCT'            SET XVARIABLE           00159800
.ZG21B            AIF   (K'&XEMCSTG GT 0).ZG21C  KEY                    00159900
                  AIF   (K'&EMCSTGPCT(1) LE 0).ZG21D  PARM              00160000
&ZMS              SETC  '"EMCSTGPCT'                                    00160100
&ZMS              SETC  '&ZMS.=&EMCSTGPCT"'                             00160200
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00160300
&ZMS              SETC  '&ZMS '                                         00160400
&ZMS              SETC  '&ZMS "EMCSTG"'                                 00160500
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00160600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00160700
                  AGO   .ZG21E                                          00160800
.*                                                                      00160900
.ZG21C            AIF   (K'&EMCSTGPCT(1) GT 0).ZG21E  PARM              00161000
                  AIF   (T'&XEMCSTG EQ 'O').ZG21E  OMITTED              00161100
&ZXEMCSTGPCT      SETC  ''          RESET IN/OUTPUT                     00161200
&ZMS              SETC  ' '                                             00161300
&ZMS              SETC  '&ZMS "EMCSTGPCT" KEY AND ITS'                  00161400
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00161500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00161600
.ZG21D            ANOP  ,                                               00161700
&XEMCSTGPCT       SETC  '0'         SET DEFAULT                         00161800
.ZG21E            ANOP  ,                                               00161900
                  AIF   (K'&EMCSTGPCT(1) GT 0).ZG21F  SPECIFIED         00162000
&ZXEMCSTGPCT      SETC  ''          RESET IN/OUTPUT                     00162100
.ZG21F            ANOP  ,                                               00162200
.ZG21AX           ANOP  ,                                               00162300
.*-------------------------------------------------------------------   00162400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00162500
                  AIF   (K'&ZXEMCSTGPCT LE 0).ZG21R  NOT I/O            00162600
                  AIF   ('&XEMCSTGPCT'(1,1) NE '(').ZG21R               00162700
&ZCGPR            SETC  '&XEMCSTGPCT'(2,K'&XEMCSTGPCT-2)                00162800
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                    00162900
                  AIF   (K'&ZCGPR GT 2).ZG21Q                           00163000
                  AIF   ('&ZCGPR' EQ '0').ZG21Q                         00163100
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00163200
                  AIF   (T'&ZCGPR NE 'N').ZG21Q  INVALID REG NAME       00163300
.ZG21P            ANOP  ,                                               00163400
                  AIF   (T'&ZCGPR NE 'N').ZG21R  NON NUMERIC            00163500
                  AIF   ('&ZCGPR' LT '2').ZG21Q                         00163600
                  AIF   ('&ZCGPR' LE '12').ZG21R                        00163700
.ZG21Q            ANOP  ,                                               00163800
&ZMS              SETC  '"EMCSTGPCT='                                   00163900
&ZMS              SETC  '&ZMS.&EMCSTGPCT"'                              00164000
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00164100
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00164200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00164300
.ZG21R            ANOP  ,                                               00164400
.*-------------------------------------------------------------------   00164500
.***AG.KMGRP11 NAME,  INPUT, ME GROUP -AT LEAST ONE SPECIFIED           00164600
&ZCVAL            SETC ''           ERROR KEY FIELD                     00164700
                  AIF   (K'&XSIZE GT 0).ZG23J                           00164800
&ZCVAL            SETC '&ZCVAL,SIZE'            NOT USED KEY            00164900
                  AIF   (K'&XRATIO GT 0).ZG23J                          00165000
&ZCVAL            SETC '&ZCVAL,RATIO'           NOT USED KEY            00165100
                  AIF   (K'&XEMCSTG GT 0).ZG23J                         00165200
&ZCVAL            SETC '&ZCVAL,EMCSTG'          NOT USED KEY            00165300
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00165400
&ZMS              SETC  'ONE OR MORE OF THE'                            00165500
&ZMS              SETC  '&ZMS FOLLOWING KEY(S) IS REQUIRED: '           00165600
&ZMS              SETC  '&ZMS "SIZE",'                                  00165700
&ZMS              SETC  '&ZMS " RATIO",'                                00165800
                  MNOTE 8,' &ZMS " EMCSTG".'                            00165900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00166000
.ZG23J            ANOP  ,                                               00166100
.ZG23K            ANOP  ,                                               00166200
.*-------------------------------------------------------------------   00166300
.***AG.KCK02 NAME,  INPUT, ME GROUP -GPR OUT OF RANGE                   00166400
                  AIF   (K'&ZXEMCSTGPCT LE 0).ZG23R  NOT I/O            00166500
                  AIF   ('&XEMCSTGPCT'(1,1) NE '(').ZG23R               00166600
&ZCGPR            SETC  '&XEMCSTGPCT'(2,K'&XEMCSTGPCT-2)                00166700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                    00166800
                  AIF   (K'&ZCGPR GT 2).ZG23Q                           00166900
                  AIF   ('&ZCGPR' EQ '0').ZG23Q                         00167000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00167100
                  AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME       00167200
.ZG23P            ANOP  ,                                               00167300
                  AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC            00167400
                  AIF   ('&ZCGPR' LT '2').ZG23Q                         00167500
                  AIF   ('&ZCGPR' LE '12').ZG23R                        00167600
.ZG23Q            ANOP  ,                                               00167700
&ZMS              SETC  '"EMCSTGPCT='                                   00167800
&ZMS              SETC  '&ZMS.&EMCSTGPCT"'                              00167900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00168000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00168100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00168200
.ZG23R            ANOP  ,                                               00168300
.*-------------------------------------------------------------------   00168400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00168500
.ZG24             ANOP  ,                                               00168600
&ZTLC             SETC 'STOP'                                           00168700
                  AIF   ('&REQUEST(1)' NE '&ZTLC').ZG25                 00168800
&XREQUEST         SETC  'STOP'      SET KEYWORD                         00168900
                  AIF   (N'&REQUEST LE 1).ZG24A  CK NUM                 00169000
&ZMS              SETC  '"REQUEST='                                     00169100
&ZMS              SETC  '&ZMS.&REQUEST"'                                00169200
&ZMS              SETC  '&ZMS "REQUEST"'                                00169300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00169400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00169500
.ZG24A            ANOP  ,                                               00169600
.*------------------------------------------------------------------    00169700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169800
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00169900
.ZG24A0           AIF   (K'&XSIZE LE 0).ZG24A1  OK                      00170000
&ZCVAL            SETC '&ZCVAL SIZE'            INCORRECT KEY USED      00170100
.ZG24A1           AIF   (K'&STRSIZE LE 0).ZG24A2  OK                    00170200
&ZCVAL            SETC '&ZCVAL STRSIZE'         INCORRECT KEY USED      00170300
.ZG24A2           AIF   (K'&XRATIO LE 0).ZG24A3  OK                     00170400
&ZCVAL            SETC '&ZCVAL RATIO'           INCORRECT KEY USED      00170500
.ZG24A3           AIF   (K'&ENTRYRATIO LE 0).ZG24A4  OK                 00170600
&ZCVAL            SETC '&ZCVAL ENTRYRATIO'      INCORRECT KEY USED      00170700
.ZG24A4           AIF   (K'&ELEMENTRATIO LE 0).ZG24A5  OK               00170800
&ZCVAL            SETC '&ZCVAL ELEMENTRATIO'    INCORRECT KEY USED      00170900
.ZG24A5           AIF   (K'&XEMCSTG LE 0).ZG24A6  OK                    00171000
&ZCVAL            SETC '&ZCVAL EMCSTG'          INCORRECT KEY USED      00171100
.ZG24A6           AIF   (K'&EMCSTGPCT LE 0).ZG24A7  OK                  00171200
&ZCVAL            SETC '&ZCVAL EMCSTGPCT'       INCORRECT KEY USED      00171300
.ZG24A7           AIF   (K'&ZCVAL LE 0).ZG24A8  OK                      00171400
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00171500
&ZMS              SETC  '"REQUEST'                                      00171600
&ZMS              SETC  '&ZMS.=&REQUEST"'                               00171700
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00171800
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00171900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00172000
.ZG24A8           ANOP  ,                                               00172100
.*------------------------------------------------------------------    00172200
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00172300
.ZG25             ANOP  ,                                               00172400
&ZXREQUEST        SETC  'INPUT'     SET IN/OUTPUT                       00172500
                  AIF   (K'&XREQUEST GT 0).ZG25E  VALID ARG             00172600
                  AIF   (T'&REQUEST EQ 'O').ZG25D  OMITTED              00172700
&ZASYSLNDX        SETA  0                                               00172800
.ZG25A            ANOP  ,           POSITIONAL MACRO KEY                00172900
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00173000
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C                00173100
&ZTLC             SETC 'REQUEST'                                        00173200
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG25A       00173300
.ZG25B            ANOP  ,                                               00173400
&ZXREQUEST        SETC  ''          RESET IN/OUTPUT                     00173500
&ZMS              SETC  'THE "REQUEST" KEY'                             00173600
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00173700
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00173800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00173900
                  AGO   .ZG25E                                          00174000
.ZG25C            ANOP  ,                                               00174100
&ZXREQUEST        SETC  ''          RESET IN/OUTPUT                     00174200
&ZMS              SETC  '"REQUEST='                                     00174300
&ZMS              SETC  '&ZMS.&REQUEST"'                                00174400
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00174500
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00174600
&ZMS              SETC  '&ZMS "START"'                                  00174700
&ZMS              SETC  '&ZMS OR "STOP".'                               00174800
                  MNOTE 8,' &ZMS '                                      00174900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00175000
                  AGO   .ZG25E                                          00175100
.ZG25D            ANOP  ,                                               00175200
&XREQUEST         SETC  'START'     SET DEFAULT KEYWORD                 00175300
.ZG25E            ANOP  ,                                               00175400
.*------------------------------------------------------------------    00175500
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00175600
                  AIF   (K'&REQUEST(1) GT 0).ZG25F  PARM                00175700
&XREQUEST         SETC  ''          ENSURE NULL KEYWORD                 00175800
&ZXREQUEST        SETC  ''          RESET IN/OUTPUT                     00175900
&ZMS              SETC  'THE'                                           00176000
&ZMS              SETC  '&ZMS "REQUEST" KEY AND ITS'                    00176100
&ZMS              SETC  '&ZMS ARGUMENT ARE REQUIRED.'                   00176200
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00176300
&ZMS              SETC  '&ZMS "START"'                                  00176400
&ZMS              SETC  '&ZMS OR "STOP".'                               00176500
                  MNOTE 8,' &ZMS '                                      00176600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00176700
.ZG25F            ANOP  ,                                               00176800
.*----------------------------------------------------------------***   00176900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00177000
                  AIF   (N'&RETCODE LE 1).ZG27A  CK NUM                 00177100
&ZMS              SETC  '"RETCODE='                                     00177200
&ZMS              SETC  '&ZMS.&RETCODE"'                                00177300
&ZMS              SETC  '&ZMS "RETCODE"'                                00177400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00177500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00177600
.ZG27A            ANOP  ,                                               00177700
.*-------------------------------------------------------------------   00177800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00177900
                  AIF   (K'&RETCODE(1) LE 0).ZG27C  NO PARM             00178000
&ZXRETCODE        SETC  'OUTPUT'    SET OUTPUT                          00178100
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00178200
                  AIF   (N'&RETCODE GT 1).ZG27C                         00178300
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00178400
.ZG27C            ANOP  ,                                               00178500
.*-------------------------------------------------------------------   00178600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00178700
                  AIF   (K'&ZXRETCODE LE 0).ZG27R  NOT I/O              00178800
                  AIF   ('&XRETCODE'(1,1) NE '(').ZG27R                 00178900
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00179000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                    00179100
                  AIF   (K'&ZCGPR GT 2).ZG27Q                           00179200
                  AIF   ('&ZCGPR' EQ '0').ZG27Q                         00179300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00179400
                  AIF   (T'&ZCGPR NE 'N').ZG27Q  INVALID REG NAME       00179500
.ZG27P            ANOP  ,                                               00179600
                  AIF   (T'&ZCGPR NE 'N').ZG27R  NON NUMERIC            00179700
                  AIF   ('&ZCGPR' EQ '15').ZG27R                        00179800
                  AIF   ('&ZCGPR' LT '2').ZG27Q                         00179900
                  AIF   ('&ZCGPR' LE '12').ZG27R                        00180000
.ZG27Q            ANOP  ,                                               00180100
&ZMS              SETC  '"RETCODE='                                     00180200
&ZMS              SETC  '&ZMS.&RETCODE"'                                00180300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00180400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'        00180500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00180600
.ZG27R            ANOP  ,                                               00180700
.*----------------------------------------------------------------***   00180800
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00180900
                  AIF   (N'&RSNCODE LE 1).ZG30A  CK NUM                 00181000
&ZMS              SETC  '"RSNCODE='                                     00181100
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00181200
&ZMS              SETC  '&ZMS "RSNCODE"'                                00181300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00181400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00181500
.ZG30A            ANOP  ,                                               00181600
.*-------------------------------------------------------------------   00181700
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00181800
                  AIF   (K'&RSNCODE(1) LE 0).ZG30C  NO PARM             00181900
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00182000
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00182100
                  AIF   (N'&RSNCODE GT 1).ZG30C                         00182200
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00182300
.ZG30C            ANOP  ,                                               00182400
.*-------------------------------------------------------------------   00182500
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00182600
                  AIF   (K'&ZXRSNCODE LE 0).ZG30R  NOT I/O              00182700
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG30R                 00182800
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00182900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG30P                    00183000
                  AIF   (K'&ZCGPR GT 2).ZG30Q                           00183100
                  AIF   ('&ZCGPR' EQ '0').ZG30R                         00183200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00183300
                  AIF   (T'&ZCGPR NE 'N').ZG30Q  INVALID REG NAME       00183400
.ZG30P            ANOP  ,                                               00183500
                  AIF   (T'&ZCGPR NE 'N').ZG30R  NON NUMERIC            00183600
                  AIF   ('&ZCGPR' EQ '0').ZG30R                         00183700
                  AIF   ('&ZCGPR' LT '2').ZG30Q                         00183800
                  AIF   ('&ZCGPR' LE '12').ZG30R                        00183900
.ZG30Q            ANOP  ,                                               00184000
&ZMS              SETC  '"RSNCODE='                                     00184100
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00184200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00184300
                  MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'         00184400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00184500
.ZG30R            ANOP  ,                                               00184600
.******************************************************************     00184700
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00184800
.******************************************************************     00184900
                  ACTR  10000                                           00185000
.*-------------------------------------------------------------------   00185100
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00185200
&ZCVAL            SETC  ''          ERROR FIELD                         00185300
&ZAWRK            SETA  0           POSITIONAL COUNTER                  00185400
&ZASYSLNDX        SETA  0           NON-X KEY COUNTER                   00185500
.ZGLIST2          ANOP  ,                                               00185600
&ZASYSLNDX        SETA  &ZASYSLNDX+1            NEXT NON-X KEY          00185700
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00185800
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00185900
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00186000
                  AIF   (&ZAWRK LE 0).ZGLIST2                           00186100
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA             00186200
                  AGO   .ZGLIST2                                        00186300
.*                                                                      00186400
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00186500
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00186600
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'                       00186700
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00186800
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00186900
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00187000
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00187100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00187200
.ZGLISTX          ANOP  ,                                               00187300
&ZASYSLNDX        SETA  0                                               00187400
.*-------------------------------------------------------------------   00187500
.***AG.MF04 MF=(SLE)                                                    00187600
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00187700
.*******************************************************************    00187800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00187900
.*******************************************************************    00188000
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00188100
.*******************************************************************    00188200
.***AE.01  START OF IXLALTER MACRO CODE                                 00188300
.*******************************************************************    00188400
                  LCLC  &M0M0001                 NAME                   00188500
&M0M0001          SETC  '&XLABEL'                SET NAME               00188600
                  AIF   (K'&XLABEL NE 0).XLAB2                          00188700
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00188800
.*                                                                      00188900
.XLAB2            ANOP  ,                                               00189000
                  AIF   ('&XMF' EQ 'L').XLAB3                           00189100
&M0M0001 DS    0H                             IXLALTER-1                00189200
.XLAB3            ANOP  ,                                               00189300
.*******************************************************************    00189400
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00189500
.*******************************************************************    00189600
              PUSH  PRINT                                               00189700
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00189800
                  PRINT OFF         ++ PR01                             00189900
                  AGO   .ZPRNTXX                                        00190000
.ZPRINTX          PRINT ON                                              00190100
.ZPRNTXX          ANOP  ,                                               00190200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00190300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00190400
.********************************************************************   00190500
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00190600
.********************************************************************   00190700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00190800
                      LCLA  &ZOPN1         INVOCATION INDEX             00190900
                      LCLC  &ZOPL(4095)    LABEL                        00191000
                      LCLC  &ZOPO(4095)    OPERATION                    00191100
                      LCLC  &ZOPV(4095)    VALUE                        00191200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00191300
.*                                                                      00191400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00191500
.******************************************************************     00191600
.***AL.L10 IXLALTER FMT=LIST MF=S!L PARAMETERS                          00191700
.******************************************************************     00191800
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00191900
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00192000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00192100
&XMFATTR              SETC  '0D'                                        00192200
.*                                                                      00192300
&ZOPN                 SETA  &ZOPN+1                                     00192400
&ZOPL(&ZOPN)          SETC  ' '                                         00192500
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00192600
&ZOPO(&ZOPN)          SETC  'B'                                         00192700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00192800
                      AGO   .ZALVL6B                                    00192900
.ZALVL6A              ANOP                                              00193000
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00193100
&ZOPV(&ZOPN)          SETC  '4,8'                                       00193200
&ZOPN                 SETA  &ZOPN+1                                     00193300
&ZOPL(&ZOPN)          SETC  ' '                                         00193400
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00193500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00193600
.ZALVL6B              ANOP                                              00193700
&ZOPD(&ZOPN)          SETC  '++ IXLALTER ARG PARMS'                     00193800
.*                                                                      00193900
&ZOPN                 SETA  &ZOPN+1                                     00194000
&ZOPL(&ZOPN)          SETC  ' '                                         00194100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00194200
&ZOPV(&ZOPN)          SETC  '1'                                         00194300
&ZOPD(&ZOPN)          SETC  ' '                                         00194400
.*                                                                      00194500
.ZLMFSL2              ANOP  ,                                           00194600
.*-------------------------------------------------------------------   00194700
.***AM.L00  IXLALTER FMT=LIST name                                      00194800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00194900
&ZOPN                 SETA &ZOPN+1                                      00195000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00195100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00195200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00195300
&ZOPD(&ZOPN)          SETC '++ IXLALTER NAME'                           00195400
.ZLMFSL2M             ANOP  ,                                           00195500
.*-------------------------------------------------------------------   00195600
.***AM.L01  IXLALTER FMT=LIST PARAMETERS                                00195700
&ZOPN                 SETA &ZOPN+1                                      00195800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00195900
&ZOPO(&ZOPN)          SETC 'DS'                                         00196000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00196100
&ZOPD(&ZOPN)          SETC '++ IXLALTER PARM LIST'                      00196200
.*-------------------------------------------------------------------   00196300
.***AM.L02 XVERSION XL1                                                 00196400
&ZOPN                 SETA &ZOPN+1                                      00196500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00196600
&ZOPO(&ZOPN)          SETC 'DS'                                         00196700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00196800
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00196900
.*-------------------------------------------------------------------   00197000
.***AM.L09  XRSV0001 CL3                                                00197100
&ZOPN                 SETA &ZOPN+1                                      00197200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00197300
&ZOPO(&ZOPN)          SETC 'DS'                                         00197400
&ZOPV(&ZOPN)          SETC 'CL3'                                        00197500
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00197600
.*-------------------------------------------------------------------   00197700
.***AM.L05 XREQUEST XL1                                                 00197800
&ZOPN                 SETA &ZOPN+1                                      00197900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00198000
&ZOPO(&ZOPN)          SETC 'DS'                                         00198100
&ZOPV(&ZOPN)          SETC 'XL1'                                        00198200
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00198300
.*                                                                      00198400
&ZOPN                 SETA  &ZOPN+1                                     00198500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_START'                  00198600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00198700
&ZOPV(&ZOPN)          SETC  '1'                                         00198800
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00198900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).START'                        00199000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00199100
.*                                                                      00199200
&ZOPN                 SETA  &ZOPN+1                                     00199300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_STOP'                   00199400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00199500
&ZOPV(&ZOPN)          SETC  '2'                                         00199600
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00199700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).STOP'                         00199800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00199900
.*-------------------------------------------------------------------   00200000
.***AM.L03 XALTERFLG1 BL.8                                              00200100
&ZOPN                 SETA &ZOPN+1                                      00200200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XALTERFLG1'                       00200300
&ZOPO(&ZOPN)          SETC 'DS'                                         00200400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00200500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00200600
.*                                                                      00200700
&ZOPN                 SETA  &ZOPN+1                                     00200800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SIZE'                    00200900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00201000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00201100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00201200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SIZE'                         00201300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00201400
.*                                                                      00201500
&ZOPN                 SETA  &ZOPN+1                                     00201600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_RATIO'                   00201700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00201800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00201900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00202000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RATIO'                        00202100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00202200
.*                                                                      00202300
&ZOPN                 SETA  &ZOPN+1                                     00202400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_EMCSTG'                  00202500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00202600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00202700
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00202800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EMCSTG'                       00202900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00203000
.*-------------------------------------------------------------------   00203100
.***AM.L09  XRSV002 CL2                                                 00203200
&ZOPN                 SETA &ZOPN+1                                      00203300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV002'                          00203400
&ZOPO(&ZOPN)          SETC 'DS'                                         00203500
&ZOPV(&ZOPN)          SETC 'CL2'                                        00203600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00203700
.*-------------------------------------------------------------------   00203800
.***AM.L09  XSTRNAME CL16                                               00203900
&ZOPN                 SETA &ZOPN+1                                      00204000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTRNAME'                         00204100
&ZOPO(&ZOPN)          SETC 'DS'                                         00204200
&ZOPV(&ZOPN)          SETC 'CL16'                                       00204300
&ZOPD(&ZOPN)          SETC '++ &ZXSTRNAME '                             00204400
.*-------------------------------------------------------------------   00204500
.***AM.L09  XSTRSIZE F                                                  00204600
&ZOPN                 SETA &ZOPN+1                                      00204700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTRSIZE'                         00204800
&ZOPO(&ZOPN)          SETC 'DS'                                         00204900
&ZOPV(&ZOPN)          SETC 'F'                                          00205000
&ZOPD(&ZOPN)          SETC '++ &ZXSTRSIZE '                             00205100
.*-------------------------------------------------------------------   00205200
.***AM.L09  XENTRYRATIO XL2                                             00205300
&ZOPN                 SETA &ZOPN+1                                      00205400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XENTRYRATIO'                      00205500
&ZOPO(&ZOPN)          SETC 'DS'                                         00205600
&ZOPV(&ZOPN)          SETC 'XL2'                                        00205700
&ZOPD(&ZOPN)          SETC '++ &ZXENTRYRATIO '                          00205800
.*-------------------------------------------------------------------   00205900
.***AM.L09  XELEMENTRATIO XL2                                           00206000
&ZOPN                 SETA &ZOPN+1                                      00206100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XELEMENTRATIO'                    00206200
&ZOPO(&ZOPN)          SETC 'DS'                                         00206300
&ZOPV(&ZOPN)          SETC 'XL2'                                        00206400
&ZOPD(&ZOPN)          SETC '++ &ZXELEMENTRATIO '                        00206500
.*-------------------------------------------------------------------   00206600
.***AM.L09  XEMCSTGPCT XL2                                              00206700
&ZOPN                 SETA &ZOPN+1                                      00206800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEMCSTGPCT'                       00206900
&ZOPO(&ZOPN)          SETC 'DS'                                         00207000
&ZOPV(&ZOPN)          SETC 'XL2'                                        00207100
&ZOPD(&ZOPN)          SETC '++ &ZXEMCSTGPCT '                           00207200
.*-------------------------------------------------------------------   00207300
.***AM.L09  XRSV0003 CL14                                               00207400
&ZOPN                 SETA &ZOPN+1                                      00207500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00207600
&ZOPO(&ZOPN)          SETC 'DS'                                         00207700
&ZOPV(&ZOPN)          SETC 'CL14'                                       00207800
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00207900
.*-------------------------------------------------------------------   00208000
.***AM.L10 END OF IXLALTER LIST PARAMETERS                              00208100
&ZOPN                 SETA &ZOPN+1                                      00208200
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00208300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00208400
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00208500
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00208600
.*                                                                      00208700
&ZOPN                 SETA &ZOPN+1                                      00208800
&ZOPL(&ZOPN)          SETC ' '                                          00208900
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00209000
&ZOPV(&ZOPN)          SETC '1'                                          00209100
&ZOPD(&ZOPN)          SETC ' '                                          00209200
.*-------------------------------------------------------------------   00209300
.***AL.L12 IXLALTER FMT=LIST MF=S!L PARAMETERS                          00209400
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00209500
.*                                                                      00209600
&ZOPN                 SETA  &ZOPN+1                                     00209700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00209800
&ZOPO(&ZOPN)          SETC  'DC'                                        00209900
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00210000
&ZOPD(&ZOPN)          SETC  '++ IXLALTER ARG PARMS'                     00210100
.*                                                                      00210200
.ZLMFSLX              ANOP  ,                                           00210300
.*-------------------------------------------------------------------   00210400
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00210500
&ZPLLEN               SETA 48                                           00210600
.*                                                                      00210700
.******************************************************************     00210800
.***AI.L01 IXLALTER FMT=LIST FILL IN PARAMETER AREA                     00210900
.******************************************************************     00211000
                      ACTR  10000                                       00211100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00211200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00211300
&ZCVAL                SETC  'LAE'          XAX MODE                     00211400
.ZIMFXA               ANOP ,                                            00211500
.*                                                                      00211600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00211700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00211800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00211900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00212000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00212100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00212200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00212300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00212400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00212500
&ZOPN                 SETA  &ZOPN+1                                     00212600
&ZOPL(&ZOPN)          SETC  ' '                                         00212700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00212800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00212900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00213000
                      AGO   .ZIMFNX                                     00213100
.*                                                                      00213200
.ZIMFN2               ANOP ,                                            00213300
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00213400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00213500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00213600
&ZOPN                 SETA  &ZOPN+1                                     00213700
&ZOPL(&ZOPN)          SETC  ' '                                         00213800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00213900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00214000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00214100
                      AGO   .ZIMFNX                                     00214200
.ZIMFNX1              ANOP ,                                            00214300
&ZOPN                 SETA  &ZOPN+1                                     00214400
&ZOPL(&ZOPN)          SETC  ' '                                         00214500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00214600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00214700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00214800
.ZIMFNX               ANOP ,                                            00214900
.********************************************************************   00215000
.***AI.L02 IXLALTER FMT=LIST INITIALIZE PARAMETER AREA                  00215100
.********************************************************************   00215200
.***AI.L03 MF=(SLE)                                                     00215300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00215400
.*                                                                      00215500
&ZOPN                 SETA  &ZOPN+1                                     00215600
&ZOPL(&ZOPN)          SETC  ' '                                         00215700
&ZOPO(&ZOPN)          SETC  'XC'                                        00215800
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00215900
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00216000
.ZIMFLX               ANOP  ,                                           00216100
.*-------------------------------------------------------------------   00216200
.***AI.L04A XVERSION XL1                                                00216300
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00216400
&ZOPN                 SETA  &ZOPN+1                                     00216500
&ZOPL(&ZOPN)          SETC  ' '                                         00216600
&ZOPO(&ZOPN)          SETC  'MVI'                                       00216700
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00216800
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00216900
.ZIMFVW               ANOP  ,                                           00217000
.*-------------------------------------------------------------------   00217100
.***AI.L07 XREQUEST AL1                                                 00217200
&ZW                   SETC  ''                                          00217300
.*-------------------------------------------------------------------   00217400
.***AI.L15 XREQUEST "START" AL1                                         00217500
         AIF   ('&XREQUEST' NE 'START').ZI4A                            00217600
&ZW                   SETC  '1'                                         00217700
.ZI4A                 ANOP  ,                                           00217800
.*-------------------------------------------------------------------   00217900
.***AI.L15 XREQUEST "STOP" AL1                                          00218000
         AIF   ('&XREQUEST' NE 'STOP').ZI5A                             00218100
&ZW                   SETC  '2'                                         00218200
.ZI5A                 ANOP  ,                                           00218300
.*-------------------------------------------------------------------   00218400
.***AI.L17 XREQUEST AL1                                                 00218500
                      AIF   ('&ZW' EQ '0').ZI5B                         00218600
                      AIF   ('&ZW' EQ '').ZI5B                          00218700
.*                                                                      00218800
&ZOPN                 SETA  &ZOPN+1                                     00218900
&ZOPL(&ZOPN)          SETC  ' '                                         00219000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00219100
&ZOPV(&ZOPN)          SETC  '4(1),&ZW'                                  00219200
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00219300
.ZI5B                 ANOP  ,                                           00219400
.*-------------------------------------------------------------------   00219500
.***AI.L05 XALTERFLG1 BL1                                               00219600
&ZW                   SETC  ''                                          00219700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00219800
.*-------------------------------------------------------------------   00219900
.***AI.L08 XALTERFLG1 "SIZE"                                            00220000
.***      BL1'1XXXXXXX'                                                 00220100
         AIF   ('&XSIZE' EQ '').ZI7A                                    00220200
&ZW                   SETC  '&ZW.1'                                     00220300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00220400
                      AGO   .ZI7C                                       00220500
.*                                                                      00220600
.ZI7A                 ANOP  ,                                           00220700
&ZW                   SETC  '&ZW.0'                                     00220800
.ZI7C                 ANOP  ,                                           00220900
.*-------------------------------------------------------------------   00221000
.***AI.L08 XALTERFLG1 "RATIO"                                           00221100
.***      BL1'X1XXXXXX'                                                 00221200
         AIF   ('&XRATIO' EQ '').ZI8A                                   00221300
&ZW                   SETC  '&ZW.1'                                     00221400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00221500
                      AGO   .ZI8C                                       00221600
.*                                                                      00221700
.ZI8A                 ANOP  ,                                           00221800
&ZW                   SETC  '&ZW.0'                                     00221900
.ZI8C                 ANOP  ,                                           00222000
.*-------------------------------------------------------------------   00222100
.***AI.L08 XALTERFLG1 "EMCSTG"                                          00222200
.***      BL1'XX1XXXXX'                                                 00222300
         AIF   ('&XEMCSTG' EQ '').ZI9A                                  00222400
&ZW                   SETC  '&ZW.100000'                                00222500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00222600
                      AGO   .ZI9C                                       00222700
.*                                                                      00222800
.ZI9A                 ANOP  ,                                           00222900
&ZW                   SETC  '&ZW.000000'                                00223000
.ZI9C                 ANOP  ,                                           00223100
.*-------------------------------------------------------------------   00223200
.***AI.L11 XALTERFLG1 BL1                                               00223300
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00223400
&ZOPN                 SETA  &ZOPN+1                                     00223500
&ZOPL(&ZOPN)          SETC  ' '                                         00223600
&ZOPO(&ZOPN)          SETC  'OI'                                        00223700
&ZOPV(&ZOPN)          SETC  '5(1),B''&ZW'''                             00223800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00223900
.ZI9E                 ANOP  ,                                           00224000
.*-------------------------------------------------------------------   00224100
.***AI.L25  XSTRNAME CL16                                               00224200
                      AIF   ('&ZXSTRNAME' EQ '').ZI11E                  00224300
                      AIF   ('&ZXSTRNAME' EQ 'OUTPUT').ZI11E            00224400
&ZCGPR                SETC  '&XSTRNAME'                                 00224500
.*                                                                      00224600
                      AIF   ('&XSTRNAME'(1,1) NE '(').ZI11B             00224700
&ZCGPR   SETC  '0('.'&XSTRNAME'(2,K'&XSTRNAME-2).')'                    00224800
.ZI11B                ANOP  ,                                           00224900
.*                                                                      00225000
&ZOPN                 SETA  &ZOPN+1                                     00225100
&ZOPL(&ZOPN)          SETC  ' '                                         00225200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00225300
&ZOPV(&ZOPN)          SETC  '8(16,1),&ZCGPR'                            00225400
&ZOPD(&ZOPN)          SETC  '++ &ZXSTRNAME XSTRNAME'                    00225500
.*                                                                      00225600
.ZI11E                ANOP  ,                                           00225700
.*-------------------------------------------------------------------   00225800
.***AI.L25  XSTRSIZE F                                                  00225900
                      AIF   ('&ZXSTRSIZE' EQ '').ZI12E                  00226000
                      AIF   ('&ZXSTRSIZE' EQ 'OUTPUT').ZI12E            00226100
&ZCGPR                SETC  '&XSTRSIZE'                                 00226200
.*                                                                      00226300
                      AIF   ('&XSTRSIZE'(1,1) NE '(').ZI12B             00226400
&ZCGPR   SETC  '0('.'&XSTRSIZE'(2,K'&XSTRSIZE-2).')'                    00226500
                      AGO   .ZI12D                                      00226600
.ZI12B                ANOP  ,                                           00226700
.*                                                                      00226800
&ZC                   SETC  '&XSTRSIZE'(1,1)                            00226900
                      AIF   (T'&ZC NE 'N').ZI12D                        00227000
&ZC                   SETC  '&XSTRSIZE'                                 00227100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00227200
&ZCGPR                SETC  '=AL4(&XSTRSIZE)'                           00227300
.*                                                                      00227400
.ZI12D                ANOP  ,                                           00227500
.*                                                                      00227600
&ZOPN                 SETA  &ZOPN+1                                     00227700
&ZOPL(&ZOPN)          SETC  ' '                                         00227800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00227900
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00228000
&ZOPD(&ZOPN)          SETC  '++ &ZXSTRSIZE XSTRSIZE'                    00228100
.*                                                                      00228200
.ZI12E                ANOP  ,                                           00228300
.*-------------------------------------------------------------------   00228400
.***AI.L25  XENTRYRATIO XL2                                             00228500
                      AIF   ('&ZXENTRYRATIO' EQ '').ZI13E               00228600
                      AIF   ('&ZXENTRYRATIO' EQ 'OUTPUT').ZI13E         00228700
&ZCGPR                SETC  '&XENTRYRATIO'                              00228800
.*                                                                      00228900
                      AIF   ('&XENTRYRATIO'(1,1) NE '(').ZI13B          00229000
&ZCGPR   SETC  '0('.'&XENTRYRATIO'(2,K'&XENTRYRATIO-2).')'              00229100
                      AGO   .ZI13D                                      00229200
.ZI13B                ANOP  ,                                           00229300
.*                                                                      00229400
&ZC                   SETC  '&XENTRYRATIO'(1,1)                         00229500
                      AIF   (T'&ZC NE 'N').ZI13D                        00229600
&ZC                   SETC  '&XENTRYRATIO'                              00229700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               00229800
&ZCGPR                SETC  '=AL2(&XENTRYRATIO)'                        00229900
.*                                                                      00230000
.ZI13D                ANOP  ,                                           00230100
.*                                                                      00230200
&ZOPN                 SETA  &ZOPN+1                                     00230300
&ZOPL(&ZOPN)          SETC  ' '                                         00230400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00230500
&ZOPV(&ZOPN)          SETC  '28(2,1),&ZCGPR'                            00230600
&ZOPD(&ZOPN)          SETC  '++ &ZXENTRYRATIO XENTRYRATIO'              00230700
.*                                                                      00230800
.ZI13E                ANOP  ,                                           00230900
.*-------------------------------------------------------------------   00231000
.***AI.L25  XELEMENTRATIO XL2                                           00231100
                      AIF   ('&ZXELEMENTRATIO' EQ '').ZI14E             00231200
                      AIF   ('&ZXELEMENTRATIO' EQ 'OUTPUT').ZI14E       00231300
&ZCGPR                SETC  '&XELEMENTRATIO'                            00231400
.*                                                                      00231500
                      AIF   ('&XELEMENTRATIO'(1,1) NE '(').ZI14B        00231600
&ZCGPR   SETC  '0('.'&XELEMENTRATIO'(2,K'&XELEMENTRATIO-2).')'          00231700
                      AGO   .ZI14D                                      00231800
.ZI14B                ANOP  ,                                           00231900
.*                                                                      00232000
&ZC                   SETC  '&XELEMENTRATIO'(1,1)                       00232100
                      AIF   (T'&ZC NE 'N').ZI14D                        00232200
&ZC                   SETC  '&XELEMENTRATIO'                            00232300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI14D               00232400
&ZCGPR                SETC  '=AL2(&XELEMENTRATIO)'                      00232500
.*                                                                      00232600
.ZI14D                ANOP  ,                                           00232700
.*                                                                      00232800
&ZOPN                 SETA  &ZOPN+1                                     00232900
&ZOPL(&ZOPN)          SETC  ' '                                         00233000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00233100
&ZOPV(&ZOPN)          SETC  '30(2,1),&ZCGPR'                            00233200
&ZOPD(&ZOPN)          SETC  '++ &ZXELEMENTRATIO XELEMENTRATIO'          00233300
.*                                                                      00233400
.ZI14E                ANOP  ,                                           00233500
.*-------------------------------------------------------------------   00233600
.***AI.L25  XEMCSTGPCT XL2                                              00233700
                      AIF   ('&ZXEMCSTGPCT' EQ '').ZI15E                00233800
                      AIF   ('&ZXEMCSTGPCT' EQ 'OUTPUT').ZI15E          00233900
&ZCGPR                SETC  '&XEMCSTGPCT'                               00234000
.*                                                                      00234100
                      AIF   ('&XEMCSTGPCT'(1,1) NE '(').ZI15B           00234200
&ZCGPR   SETC  '0('.'&XEMCSTGPCT'(2,K'&XEMCSTGPCT-2).')'                00234300
                      AGO   .ZI15D                                      00234400
.ZI15B                ANOP  ,                                           00234500
.*                                                                      00234600
&ZC                   SETC  '&XEMCSTGPCT'(1,1)                          00234700
                      AIF   (T'&ZC NE 'N').ZI15D                        00234800
&ZC                   SETC  '&XEMCSTGPCT'                               00234900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI15D               00235000
&ZCGPR                SETC  '=AL2(&XEMCSTGPCT)'                         00235100
.*                                                                      00235200
.ZI15D                ANOP  ,                                           00235300
.*                                                                      00235400
&ZOPN                 SETA  &ZOPN+1                                     00235500
&ZOPL(&ZOPN)          SETC  ' '                                         00235600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00235700
&ZOPV(&ZOPN)          SETC  '32(2,1),&ZCGPR'                            00235800
&ZOPD(&ZOPN)          SETC  '++ &ZXEMCSTGPCT XEMCSTGPCT'                00235900
.*                                                                      00236000
.ZI15E                ANOP  ,                                           00236100
.*-------------------------------------------------------------------   00236200
&ZOPN1                SETA &ZOPN                                        00236300
.*******************************************************************    00236400
.***  PROCESS IXLALTER OUTPUT PARAMETERS                                00236500
.*******************************************************************    00236600
                      ACTR  10000                                       00236700
.*******************************************************************    00236800
.***AO.X02  RETURN CODE PROCESSING                                      00236900
.*******************************************************************    00237000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00237100
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00237200
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00237300
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00237400
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00237500
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00237600
&ZOPN                 SETA  &ZOPN+1                                     00237700
&ZOPL(&ZOPN)          SETC  ' '                                         00237800
&ZOPO(&ZOPN)          SETC  'ST'                                        00237900
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00238000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00238100
                      AGO   .ZMRETX                                     00238200
.*                                                                      00238300
.ZMRET2               ANOP  ,                                           00238400
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00238500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00238600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00238700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00238800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00238900
&ZOPN                 SETA  &ZOPN+1                                     00239000
&ZOPL(&ZOPN)          SETC  ' '                                         00239100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00239200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00239300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00239400
.ZMRETX               ANOP  ,                                           00239500
.*******************************************************************    00239600
.***AO.X03  REASON CODE PROCESSING                                      00239700
.*******************************************************************    00239800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00239900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00240000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00240100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00240200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00240300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00240400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00240500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00240600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00240700
&ZOPN                 SETA  &ZOPN+1                                     00240800
&ZOPL(&ZOPN)          SETC  ' '                                         00240900
&ZOPO(&ZOPN)          SETC  'ST'                                        00241000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00241100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00241200
                      AGO   .ZMRSNX                                     00241300
.*                                                                      00241400
.ZMRSN2               ANOP  ,                                           00241500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00241600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00241700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00241800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00241900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00242000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00242100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00242200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00242300
&ZOPN                 SETA  &ZOPN+1                                     00242400
&ZOPL(&ZOPN)          SETC  ' '                                         00242500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00242600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00242700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00242800
.ZMRSNX               ANOP  ,                                           00242900
.*******************************************************************    00243000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00243100
.*******************************************************************    00243200
.ZMFLX                ANOP  ,              MF=L PROCESSING              00243300
.*******************************************************************    00243400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00243500
.*******************************************************************    00243600
                      ACTR  10000                                       00243700
.*                                                                      00243800
                      LCLA  &ZLC           COLUMN POSITION              00243900
                      LCLA  &ZOPX          LIST TABLE INDEX             00244000
                      LCLC  &ZLL           LABEL                        00244100
                      LCLC  &ZLOP          OPERATION                    00244200
                      LCLC  &ZLV           VALUE                        00244300
                      LCLC  &ZLD           DESCRIPTION                  00244400
.*                                                                      00244500
&ZOPX                 SETA  1                                           00244600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00244700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00244800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00244900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00245000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00245100
                      AIF   (K'&ZLD LE 0).ZL5                           00245200
&ZLC                  SETA  35             COMMENT COLUMN               00245300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00245400
&ZLC                  SETA  33             COMMMENT COLUMN              00245500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00245600
&ZLV                  SETC  '&ZLV'.' '                                  00245700
                      AGO   .ZL3                                        00245800
.*                                                                      00245900
.ZL4                  ANOP  ,                                           00246000
&ZLV                  SETC  '&ZLV'.' '                                  00246100
.ZL5                  ANOP  ,                                           00246200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00246300
.*                                                                      00246400
&ZLL     &ZLOP &ZLV                                                     00246500
.*                                                                      00246600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00246700
                      AGO   .ZL2           CONTINUE LOOPING             00246800
.*                                                                      00246900
.ZLX                  ANOP  ,                                           00247000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00247100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00247200
         L     14,16(0,0)              GET CVT ADDRESS                  00247300
         L     14,772(14,0)            GET SFT ADDRESS                  00247400
         L     14,220(14,0)            GET LX FOR SERVICE ROUTINE       00247500
         LA    15,33                   GET EX FOR SERVICE ROUTINE       00247600
         OR    14,15                   GET PC NUMBER                    00247700
         PC    0(14)                                                    00247800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00247900
.ZLINKX               ANOP  ,                                           00248000
.*******************************************************************    00248100
.***AP.X01  FORMAT GENERATED CODE                                       00248200
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00248300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00248400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00248500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00248600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00248700
                      AIF   (K'&ZLD LE 0).ZL51                          00248800
&ZLC                  SETA  35             COMMENT COLUMN               00248900
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00249000
&ZLC                  SETA  33             COMMENT COLUMN               00249100
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00249200
&ZLV                  SETC  '&ZLV'.' '                                  00249300
                      AGO   .ZL31                                       00249400
.*                                                                      00249500
.ZL41                 ANOP  ,                                           00249600
&ZLV                  SETC  '&ZLV'.' '                                  00249700
.ZL51                 ANOP  ,                                           00249800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00249900
.*                                                                      00250000
&ZLL     &ZLOP &ZLV                                                     00250100
.*                                                                      00250200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00250300
                      AGO   .ZL21          CONTINUE LOOPING             00250400
.*                                                                      00250500
.ZLX1                 ANOP  ,                                           00250600
.*******************************************************************    00250700
.***AP.X02  END OF IXLALTER MACRO                                       00250800
&ZIXLALTER            SETC  'YES'          SET IXLALTER USED            00250900
         POP   PRINT                                                    00251000
*                                            IXLALTER-1                 00251100
         SPACE 1                                                        00251200
.ZLX2                 ANOP  ,                                           00251300
         MEND                                                           00251400
**********************************************************************/ 00251500
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00251600
*%IXLALTER: MACRO KEYS(STRNAME,REQUEST,SIZE,STRSIZE,RATIO,ENTRYRATIO,   00251700
*                 ELEMENTRATIO,EMCSTG,EMCSTGPCT,RETCODE,RSNCODE,        00251800
*                 PLISTVER,MF);                                         00251900
*  ANS('?'!!MACLABEL!!' '!!'IXLALTEP '!!MACLIST!!                       00252000
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00252100
*%END IXLALTER;                                                         00252200

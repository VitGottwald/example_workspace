*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXZXTSOI                              -09/04/10-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Multi-system TSO/E interface                  * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 1997, 2010                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7770                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      Purpose:  This service provides the necessary interfaces to    * 00002100
*      allow TSO/E to run as a multi-system component in conjunction  * 00002200
*      with Generic Resources provided by VTAM.                       * 00002300
*                                                                     * 00002400
*      The macro provides the following functions:                    * 00002500
*                                                                     * 00002600
*                                                                     * 00002700
*      1.  Determine which system in the sysplex a TSO user is        * 00002800
*          running on and return this information to the caller.      * 00002900
*                                                                     * 00003000
*      2.  Run a TSO/E exit routine on the system in the sysplex      * 00003100
*          where a TSO user is logged on.                             * 00003200
*                                                                     * 00003300
*      3.  Run a TSO/E exit routine on a specified system in the      * 00003400
*          sysplex, a group of systems in the sysplex, or all active  * 00003500
*          systems in the sysplex.                                    * 00003600
*                                                                     * 00003700
*                                                                     * 00003800
*      When using this service to run a TSO/E exit routine on one or  * 00003900
*      more systems:                                                  * 00004000
*                                                                     * 00004100
*                                                                     * 00004200
*      1.  The caller can pass input data to the exit routine via     * 00004300
*          this service.                                              * 00004400
*                                                                     * 00004500
*      2.  The caller can indicate via this service that output data, * 00004600
*          if generated by the TSO/E exit routine, is to be returned  * 00004700
*          to the caller.                                             * 00004800
*                                                                     * 00004900
*      3.  The TSO/E exit routine will run only on active systems in  * 00005000
*          the sysplex.                                               * 00005100
*                                                                     * 00005200
*      4.  A group of systems can be specified using the name of a    * 00005300
*          token previously built using the service IEANTCR.  The     * 00005400
*          token must be in IEEGSYS format in order for this service  * 00005500
*          to use it.  Or, a special name of *ALL can be specified to * 00005600
*          represent all active systems in the sysplex.               * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*      When using this service to run a TSO/E exit routine on a       * 00006000
*      system where a userid is logged on:                            * 00006100
*                                                                     * 00006200
*                                                                     * 00006300
*      1.  The caller must pass input data to the exit routine via    * 00006400
*          this service.                                              * 00006500
*                                                                     * 00006600
*      2.  The caller can indicate via this service that output data, * 00006700
*          if generated by the TSO/E exit routine, is to be returned  * 00006800
*          to the caller.                                             * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*      When using this service to determine where a userid is logged  * 00007200
*      on:                                                            * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*      1.  No TSO/E exit routine will be called.                      * 00007600
*                                                                     * 00007700
*      2.  The caller must not pass input data via this service.      * 00007800
*                                                                     * 00007900
*      3.  The caller must indicate that output data is to be         * 00008000
*          returned.  The output data, provided by JES, will contain  * 00008100
*          the system name.                                           * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*      EEC Implications:                                              * 00008600
*                                                                     * 00008700
*      This macro is not an EEC interface.                            * 00008800
*                                                                     * 00008900
*      Related Macros:                                                * 00009000
*                                                                     * 00009100
*      None                                                           * 00009200
*                                                                     * 00009300
*      Requirements                                                   * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*      o   JES environment: All JES environments                      * 00009700
*                                                                     * 00009800
*      o   Authorization: Supervisor State                            * 00009900
*                                                                     * 00010000
*      o   Dispatchable unit mode: Task                               * 00010100
*                                                                     * 00010200
*      o   Cross memory mode: PASN = HASN = SASN                      * 00010300
*                                                                     * 00010400
*      o   Callers key: 0-7                                           * 00010500
*                                                                     * 00010600
*      o   AMODE: 31                                                  * 00010700
*                                                                     * 00010800
*      o   ASC mode: Primary                                          * 00010900
*                                                                     * 00011000
*      o   Serialization: Enabled for interrupts                      * 00011100
*                                                                     * 00011200
*      o   Locks: The caller must not hold any locks.                 * 00011300
*                                                                     * 00011400
*      o   Control Parameters:  None                                  * 00011500
*                                                                     * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*      Register Information                                           * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*      o   Input registers                                            * 00012200
*                                                                     * 00012300
*          Before issuing the IXZXTSOI macro, the caller does not     * 00012400
*          have to place any information into any register unless     * 00012500
*          using it in register notation for a particular parameter,  * 00012600
*          or using it as a base register.                            * 00012700
*                                                                     * 00012800
*      o   Output registers                                           * 00012900
*                                                                     * 00013000
*                                                                     * 00013100
*          -   R0 - Reason code                                       * 00013200
*                                                                     * 00013300
*          -   R1 - Unpredictable                                     * 00013400
*                                                                     * 00013500
*          -   R2-R13 - Unchanged                                     * 00013600
*                                                                     * 00013700
*          -   R14 - Unpredictable                                    * 00013800
*                                                                     * 00013900
*          -   R15 - Return code                                      * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*      Programming Notes/Requirements                                 * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*      1.  This macro has implied MVS waits.  Therefore, callers must * 00014900
*          not do anything that prohibits waits (for example, holding * 00015000
*          any locks).                                                * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*      Restrictions                                                   * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*      o   The caller must not hold any locks.                        * 00015800
*                                                                     * 00015900
*      o   The caller must not have an FRR established.               * 00016000
*                                                                     * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*      Performance Implications:                                      * 00016400
*                                                                     * 00016500
*      This macro has no performance impact.                          * 00016600
*                                                                     * 00016700
*01* EXTERNAL CLASSIFICATION:  NONE                                   * 00016800
*                                                                     * 00016900
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00017000
*                                                                     * 00017100
*01* SYNTAX:                                                          * 00017200
*                                                                     * 00017300
*Ýxlabel¨  IXZXTSOI  Ð  USERID=xuserid                                * 00017400
*                    ¿ ,SYSTEM=xsystem                                * 00017500
*                     Ý,INDATA=»xindata!0º                            * 00017600
*                          ,INDATALEN=xindatalen                      * 00017700
*                         Ý,INDATAKEY=»xindatakey!CALLER_KEYº¨¨       * 00017800
*                     Ý,OUTDATA=xoutdata                              * 00017900
*                          ,OUTDATALEN=xoutdatalen                    * 00018000
*                         Ý,OUTDATAKEY=»xoutdatakey!CALLER_KEYº¨¨     * 00018100
*                     Ý,LOGONOPTIONS=»FAIL!USE_FIRSTº¨                * 00018200
*                     Ý,RTNCODE=xrtncode¨                             * 00018300
*                     Ý,RSNCODE=xrsncode¨                             * 00018400
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00018500
*                    ÐÝ,MF=S¨                                         * 00018600
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00018700
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*      Where:                                                         * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*      Ýxlabel¨                                                       * 00019400
*          is an optional symbol, starting in column 1, that is the   * 00019500
*          name on the IXZXTSOI macro invocation.  The name must      * 00019600
*          conform to the rules for an ordinary assembler language    * 00019700
*          symbol.                                                    * 00019800
*          DEFAULT: No name.                                          * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*      The following is a set of mutually exclusive keys.  This set   * 00020400
*      is required; only one key must be specified.                   * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*      USERID=xuserid                                                 * 00020800
*          belongs to a set of mutually exclusive keys. It is the     * 00020900
*          name (RS-type), or address in register (2)-(12), of an 8   * 00021000
*          character input that specifies the userid which the caller * 00021100
*          is trying to locate.  If found, the input data provided by * 00021200
*          the caller (via INDATA= keyword) will be passed to the     * 00021300
*          TSO/E exit routine on the system where the userid is       * 00021400
*          running. If the userid is not active no data will be       * 00021500
*          passed and no exit routine will be called.                 * 00021600
*                                                                     * 00021700
*          If no input data is provided, no exit routine will be      * 00021800
*          called.  The name of the system on which the user is       * 00021900
*          active will be returned via the OUTDATA parameter.         * 00022000
*          OUTDATA must be specified in order to use the function in  * 00022100
*          this way.                                                  * 00022200
*                                                                     * 00022300
*      SYSTEM=xsystem                                                 * 00022400
*          belongs to a set of mutually exclusive keys. It is the     * 00022500
*          name (RS-type), or address in register (2)-(12), of an 8   * 00022600
*          character input that specifies the system where the TSO/E  * 00022700
*          exit routine is to be invoked, or the name of a group of   * 00022800
*          systems on which the TSO/E exit routine is to be invoked.  * 00022900
*          The group must have previously been registered via the     * 00023000
*          name/token service and must be in IEEGSYS format.          * 00023100
*                                                                     * 00023200
*          If *ALL is specified, the data specfied by INDATA will be  * 00023300
*          passed to the TSO/E exit routine on all active systems in  * 00023400
*          the sysplex.                                               * 00023500
*                                                                     * 00023600
*          If a group is specified, the data specfied by INDATA will  * 00023700
*          be passed to the TSO/E exit routine on all active systems  * 00023800
*          in the group.                                              * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*      End of a set of mutually exclusive required keys.              * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*      ÝINDATA=»xindata!0º                                            * 00024700
*          is the name (RS-type), or address in register (2)-(12), of * 00024800
*          an optional 4 byte input that contains the address of a    * 00024900
*          block of data that is passed to the TSO/E exit routine,    * 00025000
*          when using this service to call an exit routine.  The data * 00025100
*          must be read-accessible in the caller's key.               * 00025200
*          DEFAULT: 0 No data is to be passed to the caller.          * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*          INDATALEN=xindatalen                                       * 00025600
*              is the name (RS-type), or address in register          * 00025700
*              (2)-(12), of a required fullword input that contains   * 00025800
*              the length of the data item pointed to by the DATA     * 00025900
*              keyword. This is the amount of data that will be       * 00026000
*              transfered to the target system or systems.  This      * 00026100
*              value must be no greater than 60K bytes.               * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*          ÝINDATAKEY=»xindatakey!CALLER_KEYº¨¨                       * 00026700
*              is the name (RS-type), or address in register          * 00026800
*              (2)-(12), of an optional byte input that specifies the * 00026900
*              key of the input data.                                 * 00027000
*              DEFAULT: CALLER_KEY The key of the caller              * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*      ÝOUTDATA=xoutdata                                              * 00027800
*          is the name (RS-type), or address in register (2)-(12), of * 00027900
*          an optional 4 byte output that will contain the address of * 00028000
*          the output data.                                           * 00028100
*                                                                     * 00028200
*          When using this service to determine which system in the   * 00028300
*          sysplex a user is logged on, OUTDATA is required.  Upon    * 00028400
*          return, the address referenced by OUTDATA contains a       * 00028500
*          pointer to a data area containing the system name.         * 00028600
*          OUTDATALEN contains the length of this data area.          * 00028700
*                                                                     * 00028800
*          When using this service to call a TSO/E exit routine,      * 00028900
*          OUTDATA may be specified to request any output generated   * 00029000
*          by the TSO/E exit routine to be returned to the caller.    * 00029100
*          Upon return, the address referenced by OUTDATA contains a  * 00029200
*          pointer to a data area mapped by the macro IXZYRCRD and    * 00029300
*          this data area contains one or more segments of data, one  * 00029400
*          for each system that invoked the TSO/E exit routine.       * 00029500
*          OUTDATALEN contains the length of the entire data area.    * 00029600
*                                                                     * 00029700
*          If OUTDATA is specified, the caller is responsible for     * 00029800
*          freeing the area.  The subpool in which the storage        * 00029900
*          resides is represented by the constant                     * 00030000
*          RCRD_StorageSubpool, which is defined within IXZYRCRD.     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*          OUTDATALEN=xoutdatalen                                     * 00030400
*              is the name (RS-type), or address in register          * 00030500
*              (2)-(12), of a required fullword output that specifies * 00030600
*              the length of the returned data.  Note: the length of  * 00030700
*              the returned data cannot exceed 60K bytes.             * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*          ÝOUTDATAKEY=»xoutdatakey!CALLER_KEYº¨¨                     * 00031300
*              is the name (RS-type), or address in register          * 00031400
*              (2)-(12), of an optional byte input that specifies the * 00031500
*              key of the returned data.                              * 00031600
*              DEFAULT: CALLER_KEY The key of the caller              * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*      ÝLOGONOPTIONS=»FAIL!USE_FIRSTº¨                                * 00032400
*          is an optional keyword input that specifies how the macro  * 00032500
*          should behave when it detects a user is logged onto        * 00032600
*          multiple systems in a JESPLEX.                             * 00032700
*          DEFAULT: FAIL                                              * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*          LOGONOPTIONS=FAIL                                          * 00033100
*              specifies the macro should return an error when        * 00033200
*              multiple logons are detected.                          * 00033300
*                                                                     * 00033400
*          LOGONOPTIONS=USE_FIRST                                     * 00033500
*              specifies that the macro should succeed and return the * 00033600
*              first logon when multiple logons are detected.  The    * 00033700
*              first logon is determined by the order the logons are  * 00033800
*              returned in an extended status SSI call.               * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*      ÝRTNCODE=xrtncode¨                                             * 00034600
*          is the name (RS-type) of an optional fullword output       * 00034700
*          variable, or register (2)-(12) or (15), into which the     * 00034800
*          return code is to be copied from GPR 15.  If you specify   * 00034900
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00035000
*          the value will be left in GPR 15.                          * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*      ÝRSNCODE=xrsncode¨                                             * 00035600
*          is the name (RS-type) of an optional fullword output       * 00035700
*          variable into which the reason code is to be copied from   * 00035800
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00035900
*          R0 (within or without parentheses), the value will be left * 00036000
*          in GPR 0.                                                  * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*                                                                     * 00036400
*                                                                     * 00036500
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00036600
*          is an optional byte input decimal value in the "1-1" range * 00036700
*          that specifies the macro version.  PLISTVER is the only    * 00036800
*          key allowed on the list form of MF and determines which    * 00036900
*          parameter list is generated.  Note that MAX may be         * 00037000
*          specified instead of a number, and the parameter list will * 00037100
*          be of the largest size currently supported. This size may  * 00037200
*          grow from release to release (thus possibly affecting the  * 00037300
*          amount of storage needed by your program).  If your        * 00037400
*          program can tolerate this, IBM recommends that you always  * 00037500
*          specify MAX when creating the list form parameter list as  * 00037600
*          that will ensure that the list form parameter list is      * 00037700
*          always long enough to hold whatever parameters might be    * 00037800
*          specified on the execute form.                             * 00037900
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00038000
*          default is the lowest version which allows all of the      * 00038100
*          parameters specified on the invocation to be processed.    * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*      ÝMF=»S!L!Eº¨                                                   * 00038700
*          is an optional keyword input which specifies the macro     * 00038800
*          form.                                                      * 00038900
*          DEFAULT: S                                                 * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*          ÝMF=S¨                                                     * 00039300
*              specifies the standard form of the macro.  The "S"     * 00039400
*              form generates code to put the parameters into an      * 00039500
*              in-line parameter list and invoke the desired service. * 00039600
*              Full checking for required macro keys is done along    * 00039700
*              with supplying defaults for omitted optional           * 00039800
*              parameters.                                            * 00039900
*                                                                     * 00040000
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00040100
*              specifies the list form of the macro.  The "L" form    * 00040200
*              defines an area to be used for the parameter list.     * 00040300
*              Only the PLISTVER key may be specified on the          * 00040400
*              invocation.  All other macro parameters are flagged as * 00040500
*              errors.  If PLISTVER is not specified, the original    * 00040600
*              parameter list definition is used.                     * 00040700
*                                                                     * 00040800
*            ,xmfctrl                                                 * 00040900
*              is a required input.  It is the name of a storage area * 00041000
*              for the parameter list.                                * 00041100
*                                                                     * 00041200
*            »,xmfattr!0Dº                                            * 00041300
*              is an optional 60 character input string that varies   * 00041400
*              from 1 to 60 characters. Use it to force boundary      * 00041500
*              alignment of the parameter list. Use only 0F or 0D.    * 00041600
*              DEFAULT: 0D which forces the parameter list to a       * 00041700
*              doubleword boundary.                                   * 00041800
*                                                                     * 00041900
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00042000
*              specifies the execute form of the macro.  The "E" form * 00042100
*              generates code to put the parameters into the          * 00042200
*              parameter list specified by xmfctrl and provides full  * 00042300
*              syntax checking with default setting.                  * 00042400
*                                                                     * 00042500
*            ,xmfctrl                                                 * 00042600
*              is a required input.  It is the name (RS-type), or     * 00042700
*              address in register (1)-(12), of a storage area for    * 00042800
*              the parameter list.                                    * 00042900
*                                                                     * 00043000
*            »,COMPLETEº                                              * 00043100
*              is an optional keyword input which specifies the       * 00043200
*              degree of macro parameter syntax checking.             * 00043300
*              DEFAULT: COMPLETE                                      * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*              COMPLETE                                               * 00043700
*                  Checking for required macro keys is done and       * 00043800
*                  defaults are supplied for omitted optional         * 00043900
*                  parameters.                                        * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*01* RETURN CODES:                                                    * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*                 Return code and Reason code constants are defined   * 00045100
*                 within IXZYTSRC.                                    * 00045200
*                                                                     * 00045300
*       00        Name: TSRC_RC_Successful                            * 00045400
*                                                                     * 00045500
*                 Meaning: Processing successful.                     * 00045600
*                                                                     * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*                 HEX REASON  NAME/MEANING                            * 00046000
*                 CODE                                                * 00046100
*                                                                     * 00046200
*                 00          Name: TSRC_RSN_Successful               * 00046300
*                                                                     * 00046400
*                             Meaning: Processing completed           * 00046500
*                             successfully.                           * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                 04          Name: TSRC_RSN_Output_Not_Returned      * 00046900
*                                                                     * 00047000
*                             Meaning:  Processing completed          * 00047100
*                             successfully.  However, the module      * 00047200
*                             produced output on one or more systems  * 00047300
*                             but the output could not be passed back * 00047400
*                             because OUTDATA= was not specified.     * 00047500
*                                                                     * 00047600
*                                                                     * 00047700
*                                                                     * 00047800
*                                                                     * 00047900
*       04        Name: TSRC_RC_Unsuccessful                          * 00048000
*                                                                     * 00048100
*                 Meaning: Processing unsuccessful.                   * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                                                                     * 00048500
*                 HEX REASON  NAME/MEANING                            * 00048600
*                 CODE                                                * 00048700
*                                                                     * 00048800
*                 04          Name: TSRC_RSN_Userid_Not_Found         * 00048900
*                                                                     * 00049000
*                             Meaning:  The userid specified by       * 00049100
*                             USERID= was not found.                  * 00049200
*                                                                     * 00049300
*                                                                     * 00049400
*                 08          Name: TSRC_RSN_Duplicate_Users          * 00049500
*                                                                     * 00049600
*                             Meaning:  Duplicate users were found.   * 00049700
*                                                                     * 00049800
*                                                                     * 00049900
*                 0C          Name: TSRC_RSN_Input_Length_Too_Large   * 00050000
*                                                                     * 00050100
*                             Meaning:  Input data length exceeded    * 00050200
*                             the maximum.                            * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*                 10          Name: TSRC_RSN_Output_Length_Too_Large  * 00050600
*                                                                     * 00050700
*                             Meaning:  Output data length returned   * 00050800
*                             by the exit(s) exceeded the maximum. No * 00050900
*                             output data is returned in OUTDATA.     * 00051000
*                                                                     * 00051100
*                                                                     * 00051200
*                 14          Name: TSRC_RSN_Exits_Not_All_Successful * 00051300
*                                                                     * 00051400
*                             Meaning:  Not all IXZXTSOI exit         * 00051500
*                             routines ran successfully.              * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*                 18          Name: TSRC_RSN_Exit_Not_Successful      * 00051900
*                                                                     * 00052000
*                             Meaning:  The single IXZXTSOI exit      * 00052100
*                             routine on the target processor did not * 00052200
*                             run successfully.                       * 00052300
*                                                                     * 00052400
*                                                                     * 00052500
*                 1C          Name: TSRC_RSN_Storage_Unavailable      * 00052600
*                                                                     * 00052700
*                             Meaning:  Unable to obtain the required * 00052800
*                             storage to return information provided  * 00052900
*                             by the IXZXTSOI exit routines to the    * 00053000
*                             caller.                                 * 00053100
*                                                                     * 00053200
*                                                                     * 00053300
*                 20          Name: TSRC_RSN_System_Not_Found         * 00053400
*                                                                     * 00053500
*                             Meaning:  The system specified by       * 00053600
*                             SYSTEM= was not found, or is            * 00053700
*                             down-level.                             * 00053800
*                                                                     * 00053900
*                                                                     * 00054000
*                 24          Name: TSRC_RSN_Internal_Error           * 00054100
*                                                                     * 00054200
*                             Meaning:  An internal error occurred.   * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*                 28          Name: TSRC_RSN_JESXCF_Not_Initialized   * 00054600
*                                                                     * 00054700
*                             Meaning:  JESXCF is not initialized.    * 00054800
*                                                                     * 00054900
*                                                                     * 00055000
*                 2C          Name: TSRC_RSN_System_Not_Active        * 00055100
*                                                                     * 00055200
*                             Meaning:  The system name specified by  * 00055300
*                             SYSTEM= was valid but not active.       * 00055400
*                                                                     * 00055500
*                                                                     * 00055600
*                 30          Name:                                   * 00055700
*                             TSRC_RSN_Service_Not_Supported_By_JES   * 00055800
*                                                                     * 00055900
*                             Meaning:  The current version of the    * 00056000
*                             Job Entry Subsystem does not support    * 00056100
*                             this service.                           * 00056200
*                                                                     * 00056300
*                                                                     * 00056400
*                 34          Name: TSRC_RSN_Service_Not_Available    * 00056500
*                                                                     * 00056600
*                             Meaning:  The service is not available  * 00056700
*                             right now.                              * 00056800
*                                                                     * 00056900
*                                                                     * 00057000
*                 38          Name:                                   * 00057100
*                             TSRC_RSN_No_Active_System_In_Group      * 00057200
*                                                                     * 00057300
*                             Meaning:  The group is valid but no     * 00057400
*                             system in the group is active.          * 00057500
*                                                                     * 00057600
*                                                                     * 00057700
*                 40          Name: TSRC_RSN_Incorrect_Eyecatcher     * 00057800
*                                                                     * 00057900
*                             Meaning:  The eyecatcher in the         * 00058000
*                             IXZXTSOI parameter list was not         * 00058100
*                             correct.                                * 00058200
*                                                                     * 00058300
*                                                                     * 00058400
*                 44          Name: TSRC_RSN_Incorrect_Version        * 00058500
*                                                                     * 00058600
*                             Meaning:  The version number in the     * 00058700
*                             IXZXTSOI parameter list was not         * 00058800
*                             correct.                                * 00058900
*                                                                     * 00059000
*                                                                     * 00059100
*                                                                     * 00059200
*                                                                     * 00059300
*       08        Name: TSRC_RC_System_Error                          * 00059400
*                                                                     * 00059500
*                 Meaning: A system error occurred.                   * 00059600
*                                                                     * 00059700
*                                                                     * 00059800
*       0C        Name: TSRC_RC_System_Abend                          * 00059900
*                                                                     * 00060000
*                 Meaning: A system abend occurred.                   * 00060100
*                                                                     * 00060200
*                                                                     * 00060300
*                                                                     * 00060400
*                                                                     * 00060500
*01* REASON CODES:                                                    * 00060600
*                                                                     * 00060700
*       A unique reason code will be returned for any given return    * 00060800
*       code.  Reason code and return code constants are defined      * 00060900
*       within IXZYTSRC.  See the Return Codes section (above) for a  * 00061000
*       complete description of the reason codes.                     * 00061100
*                                                                     * 00061200
*01* MODULE TYPE:  ASSEM MACRO                                        * 00061300
*                                                                     * 00061400
*02*   PROCESSOR:  ASSEM                                              * 00061500
*                                                                     * 00061600
*01* COMPONENT:  SCJSC                                                * 00061700
*                                                                     * 00061800
*01* MACRO USAGE NOTES:                                               * 00061900
*                                                                     * 00062000
*                                                                     * 00062100
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00062200
*        global macro variable.  Any value other than 'NO' will       * 00062300
*        result in the macro expansion being printed.  The default is * 00062400
*        'YES'.  The following examples illustrate how the ZPRINT     * 00062500
*        variable should be set.                                      * 00062600
*                                                                     * 00062700
*                    GBLC &ZPRINT                                     * 00062800
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00062900
*                                                                     * 00063000
*                                                                     * 00063100
*    2.  All   keys   currently   contained  in  the  IXZXTSOI  macro * 00063200
*        correspond  to  version  1.   If you specify PLISTVER, use a * 00063300
*        value of 1 or MAX.                                           * 00063400
*                                                                     * 00063500
*                                                                     * 00063600
*                                                                     * 00063700
*                                                                     * 00063800
*01* CHANGE ACTIVITY:                                                 * 00063900
*                                                                     * 00064000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00064100
*                                                                     * 00064200
*    $R0=TSOGR    HBB6603 960126 PD0RF: TSOGR Support                 * 00064300
*    $T5=JXMLTLOG HBB7770 090410 RD0JU: Multiple logon support        * 00064400
****** END OF SPECIFICATIONS *****************************************/ 00064500
*/********************************************************************* 00064600
         MACRO                                                          00064700
&XLABEL  IXZXTSOI &USERID=,&SYSTEM=,&INDATA=,&INDATALEN=,&INDATAKEY=,  *00064800
               &OUTDATA=,&OUTDATALEN=,&OUTDATAKEY=,&LOGONOPTIONS=,     *00064900
               &RTNCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00065000
.*                                                                      00065100
*                  MACDATE -09/04/10-<1>                                00065200
.*                                                                      00065300
.*******************************************************************    00065400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00065500
.*******************************************************************    00065600
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00065700
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00065800
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00065900
.*                                                                      00066000
                  GBLC  &ZIXZXTSOI  YES=MACRO USED AT LEAST ONCE        00066100
.*******************************************************************    00066200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00066300
.*******************************************************************    00066400
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00066500
                  LCLC  &ZCNDX      SYSNDX CHARACTERS                   00066600
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00066700
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00066800
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00066900
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00067000
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00067100
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00067200
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00067300
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00067400
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00067500
                  LCLC  &ZMAC_G     "G" or null                         00067600
&ZMAC_G           SETC  ''                                              00067700
                  LCLC  &ZMAC_LR                                        00067800
&ZMAC_LR          SETC  'LR'                                            00067900
                  LCLC  &ZMAC_L                                         00068000
&ZMAC_L           SETC  'L'                                             00068100
                  LCLC  &ZMAC_ST                                        00068200
&ZMAC_ST          SETC  'ST'                                            00068300
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00068400
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00068500
.*                                                                      00068600
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00068700
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00068800
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00068900
                  LCLC  &ZENDBASEPL             End of base PL          00069000
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00069100
.*******************************************************************    00069200
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00069300
.*******************************************************************    00069400
                  LCLA  &ZI         INDEX FOR ARRAY                     00069500
                  LCLA  &ZJ         INDEX FOR PARMS                     00069600
                  LCLA  &ZK         INDEX FOR PARSE                     00069700
                  LCLA  &ZLO        LOW RANGE VALUE                     00069800
                  LCLA  &ZHI        HIGH RANGE VALUE                    00069900
                  LCLC  &ZW         WORK AREA FOR PARM                  00070000
.********************************************************************   00070100
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00070200
.********************************************************************   00070300
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00070400
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00070500
                  GBLA  &SYSALVL    SYSSTATE ARCHLVL                    00070600
                  GBLC  &SYSAM64    SYSSTATE AMODE64                    00070700
.*                                                                      00070800
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00070900
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00071000
                  SPLEVEL  TEST                                         00071100
.ZSYS2            ANOP  ,                                               00071200
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00071300
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00071400
                  SYSSTATE TEST                                         00071500
                  AGO   .ZSYS4                                          00071600
.ZSYS3            ANOP  ,                                               00071700
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00071800
.ZSYS4            ANOP  ,                                               00071900
.*******************************************************************    00072000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00072100
.*******************************************************************    00072200
                  LCLC  &XREQTYPE   ++ NAME                             00072300
                  LCLC  &XUSERID    ++ NAME                             00072400
                  LCLC  &XSYSTEM    ++ NAME                             00072500
                  LCLC  &XINDATA    ++ NAME                             00072600
                  LCLC  &XINDATALEN             ++ NAME                 00072700
                  LCLC  &XINDATAKEY             ++ NAME                 00072800
                  LCLC  &XOUTDATA   ++ NAME                             00072900
                  LCLC  &XOUTDATALEN            ++ NAME                 00073000
                  LCLC  &XOUTDATAKEY            ++ NAME                 00073100
                  LCLC  &XLOGONOPTIONS          ++ VALUE                00073200
                  LCLC  &XRTNCODE   ++ NAME                             00073300
                  LCLC  &XRSNCODE   ++ NAME                             00073400
                  LCLA  &XPLISTVER  ++ VALUE                            00073500
                  LCLC  &XMF        ++ VALUE                            00073600
                  LCLC  &XMFCTRL    ++ NAME                             00073700
                  LCLC  &XMFATTR    ++ VALUE                            00073800
                  LCLC  &XMFSCK     ++ VALUE                            00073900
.*******************************************************************    00074000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00074100
.*******************************************************************    00074200
                  LCLC  &ZXREQTYPE  ++ INPUT NAME                       00074300
                  LCLC  &ZXUSERID   ++ INPUT NAME                       00074400
                  LCLC  &ZXSYSTEM   ++ INPUT NAME                       00074500
                  LCLC  &ZXINDATA   ++ INPUT NAME                       00074600
                  LCLC  &ZXINDATALEN            ++ INPUT NAME           00074700
                  LCLC  &ZXINDATAKEY            ++ INPUT NAME           00074800
                  LCLC  &ZXOUTDATA  ++ OUTPUT NAME                      00074900
                  LCLC  &ZXOUTDATALEN           ++ OUTPUT NAME          00075000
                  LCLC  &ZXOUTDATAKEY           ++ INPUT NAME           00075100
                  LCLC  &ZXLOGONOPTIONS         ++ INPUT VALUE          00075200
                  LCLC  &ZXRTNCODE  ++ OUTPUT NAME                      00075300
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00075400
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00075500
                  LCLC  &ZXMF       ++ INPUT VALUE                      00075600
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00075700
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00075800
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00075900
.********************************************************************   00076000
.***AC.PLV01  PROCESS PLISTVER                                      *   00076100
.********************************************************************   00076200
&XPLISTVER      SETA  1                                                 00076300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00076400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00076500
&XPLISTVER      SETA  1                                                 00076600
.ZPLV0          ANOP  ,                                                 00076700
.*                                                                      00076800
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00076900
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00077000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00077100
.*-------------------------------------------------------------------   00077200
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00077300
&ZMS            SETC  '"PLISTVER='                                      00077400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00077500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00077600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00077700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00077800
                AGO   .ZPVCK2                                           00077900
.ZPVCK3         ANOP  ,                                                 00078000
.*-------------------------------------------------------------------   00078100
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00078200
&ZMS            SETC  '"PLISTVER='                                      00078300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00078400
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00078500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00078600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00078700
                AGO   .ZPVCKE                                           00078800
.ZPVCK2         ANOP  ,                                                 00078900
.*-------------------------------------------------------------------   00079000
&ZCVAL          SETC  '&PLISTVER(1)'                                    00079100
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00079200
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00079300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00079400
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00079500
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00079600
.ZPVCK6         ANOP  ,                                                 00079700
&ZMS            SETC  '"PLISTVER='                                      00079800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00079900
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00080000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00080100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00080200
&XPLISTVER      SETA  1                                                 00080300
                AGO   .ZPVCKE                                           00080400
.*-------------------------------------------------------------------   00080500
.ZPVCK4A        ANOP  ,                                                 00080600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00080700
&ZMS            SETC  'PLISTVER='                                       00080800
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00080900
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00081000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00081100
                MNOTE 8,' &ZMS IS REQUIRED.'                            00081200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00081300
                AGO   .ZPVCK5                                           00081400
.ZPVCK4         ANOP  ,                                                 00081500
&XPLISTVER      SETA  &PLISTVER(1)                                      00081600
.ZPVCK5         ANOP  ,                                                 00081700
.ZPVCKE         ANOP  ,                                                 00081800
.********************************************************************   00081900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00082000
.********************************************************************   00082100
                  ACTR  10000                                           00082200
.*------------------------------------------------------------------    00082300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00082400
&XMF              SETC  ''          INITIALIZE XVARIABLE                00082500
.*-------------------------------------------------------------------   00082600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00082700
.ZG39             ANOP  ,                                               00082800
&ZTLC             SETC 'S'                                              00082900
                  AIF   ('&MF(1)' NE '&ZTLC').ZG40                      00083000
&XMF              SETC  'S'         SET KEYWORD                         00083100
                  AIF   (N'&MF LE 1).ZG39A      CK NUM                  00083200
&ZMS              SETC  '"MF='                                          00083300
&ZMS              SETC  '&ZMS.&MF"'                                     00083400
&ZMS              SETC  '&ZMS "MF"'                                     00083500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00083600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00083700
.ZG39A            ANOP  ,                                               00083800
.*-------------------------------------------------------------------   00083900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084000
.ZG40             ANOP  ,                                               00084100
&ZTLC             SETC 'L'                                              00084200
                  AIF   ('&MF(1)' NE '&ZTLC').ZG47                      00084300
&XMF              SETC  'L'         SET KEYWORD                         00084400
                  AIF   (N'&MF LE 3).ZG40A      CK NUM                  00084500
&ZMS              SETC  '"MF='                                          00084600
&ZMS              SETC  '&ZMS.&MF"'                                     00084700
&ZMS              SETC  '&ZMS "MF"'                                     00084800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00084900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00085000
.ZG40A            ANOP  ,                                               00085100
.*-------------------------------------------------------------------   00085200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00085300
                  AIF   (N'&SYSLIST NE 0).ZG40B  POSITIONALS?           00085400
                  AIF   ('&USERID' NE '').ZG40B  KEYS?                  00085500
                  AIF   ('&SYSTEM' NE '').ZG40B  KEYS?                  00085600
                  AIF   ('&INDATA' NE '').ZG40B  KEYS?                  00085700
                  AIF   ('&INDATALEN' NE '').ZG40B  KEYS?               00085800
                  AIF   ('&INDATAKEY' NE '').ZG40B  KEYS?               00085900
                  AIF   ('&OUTDATA' NE '').ZG40B  KEYS?                 00086000
                  AIF   ('&OUTDATALEN' NE '').ZG40B  KEYS?              00086100
                  AIF   ('&OUTDATAKEY' NE '').ZG40B  KEYS?              00086200
                  AIF   ('&LOGONOPTIONS' NE '').ZG40B  KEYS?            00086300
                  AIF   ('&RTNCODE' NE '').ZG40B  KEYS?                 00086400
                  AIF   ('&RSNCODE' NE '').ZG40B  KEYS?                 00086500
                  AGO    .ZG40C     INVOCATION OKAY                     00086600
.ZG40B            ANOP  ,                                               00086700
&ZMS              SETC  'THE "L" FORM OF "MF"'                          00086800
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00086900
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00087000
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00087100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00087200
.ZG40C            ANOP  ,                                               00087300
.*-------------------------------------------------------------------   00087400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00087500
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00087600
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00087700
                  AIF   (N'&MF(2) GT 1).ZG42B   MULTI PARMS             00087800
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00087900
.ZG42B            AIF   (K'&MF(2) GT 0).ZG42C                           00088000
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00088100
&ZMS              SETC  'WHEN "L" IS SPECIFIED'                         00088200
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00088300
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00088400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00088500
.ZG42C            ANOP  ,                                               00088600
.*-------------------------------------------------------------------   00088700
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00088800
                  AIF   (K'&ZXMFCTRL LE 0).ZG42P  NOT I/O               00088900
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG42P                  00089000
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00089100
&ZMS              SETC  '"MF='                                          00089200
&ZMS              SETC  '&ZMS.&MF"'                                     00089300
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00089400
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00089500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00089600
.ZG42P            ANOP  ,                                               00089700
.*-------------------------------------------------------------------   00089800
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00089900
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00090000
&XMFATTR          SETC  '0D'                                            00090100
                  AIF   (K'&MF(3) LE 0).ZG45B   PARM                    00090200
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00090300
                  AIF   (N'&MF(3) GT 1).ZG45B   MULTI                   00090400
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00090500
.ZG45B            ANOP  ,                                               00090600
.*-------------------------------------------------------------------   00090700
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00090800
                  AIF   (K'&ZXMFATTR LE 0).ZG45P  NOT I/O               00090900
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG45P                  00091000
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00091100
&ZMS              SETC  '"MF='                                          00091200
&ZMS              SETC  '&ZMS.&MF"'                                     00091300
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00091400
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00091500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00091600
.ZG45P            ANOP  ,                                               00091700
.*-------------------------------------------------------------------   00091800
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00091900
                  AIF   (K'&ZXMFATTR LE 0).ZG45S  NOT I/O               00092000
                  AIF   (K'&XMFATTR LE 60).ZG45S  LNG OK                00092100
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00092200
&ZMS              SETC  '"MF='                                          00092300
&ZMS              SETC  '&ZMS.&MF"'                                     00092400
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00092500
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00092600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00092700
.ZG45S            ANOP  ,                                               00092800
.*-------------------------------------------------------------------   00092900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093000
.ZG47             ANOP  ,                                               00093100
&ZTLC             SETC 'E'                                              00093200
                  AIF   ('&MF(1)' NE '&ZTLC').ZG55                      00093300
&XMF              SETC  'E'         SET KEYWORD                         00093400
                  AIF   (N'&MF LE 3).ZG47A      CK NUM                  00093500
&ZMS              SETC  '"MF='                                          00093600
&ZMS              SETC  '&ZMS.&MF"'                                     00093700
&ZMS              SETC  '&ZMS "MF"'                                     00093800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00093900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00094000
.ZG47A            ANOP  ,                                               00094100
.*-------------------------------------------------------------------   00094200
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00094300
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00094400
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00094500
                  AIF   (N'&MF(2) GT 1).ZG49B   MULTI PARMS             00094600
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00094700
.ZG49B            AIF   (K'&MF(2) GT 0).ZG49C                           00094800
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00094900
&ZMS              SETC  'WHEN "E" IS SPECIFIED'                         00095000
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00095100
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00095200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00095300
.ZG49C            ANOP  ,                                               00095400
.*-------------------------------------------------------------------   00095500
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00095600
                  AIF   (K'&ZXMFCTRL LE 0).ZG49R  NOT I/O               00095700
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG49R                  00095800
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00095900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                    00096000
                  AIF   (K'&ZCGPR GT 2).ZG49Q                           00096100
                  AIF   ('&ZCGPR' EQ '0').ZG49Q                         00096200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00096300
                  AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME       00096400
.ZG49P            ANOP  ,                                               00096500
                  AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC            00096600
                  AIF   ('&ZCGPR' LT '1').ZG49Q                         00096700
                  AIF   ('&ZCGPR' LE '12').ZG49R                        00096800
.ZG49Q            ANOP  ,                                               00096900
&ZMS              SETC  '"MF='                                          00097000
&ZMS              SETC  '&ZMS.&MF"'                                     00097100
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00097200
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00097300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00097400
.ZG49R            ANOP  ,                                               00097500
.*-------------------------------------------------------------------   00097600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00097700
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00097800
.ZG53A   AIF   ('&MF(3)' NE 'COMPLETE').ZG54A                           00097900
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00098000
.*-------------------------------------------------------------------   00098100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00098200
.ZG54A            AIF   (K'&XMFSCK GT 0).ZG54C  KEYWORD                 00098300
                  AIF   (K'&MF(3) LE 0).ZG54B                           00098400
&ZMS              SETC  '"MF='                                          00098500
&ZMS              SETC  '&ZMS.&MF"'                                     00098600
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00098700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00098800
&ZMS              SETC  '&ZMS "COMPLETE".'                              00098900
                  MNOTE 8,' &ZMS '                                      00099000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00099100
.ZG54B            ANOP  ,                                               00099200
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00099300
.ZG54C            ANOP  ,                                               00099400
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00099500
.*------------------------------------------------------------------    00099600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099700
.ZG55             ANOP  ,                                               00099800
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00099900
                  AIF   (K'&XMF GT 0).ZG55E     VALID ARG               00100000
                  AIF   (T'&MF EQ 'O').ZG55D    OMITTED                 00100100
&ZASYSLNDX        SETA  0                                               00100200
.ZG55A            ANOP  ,           POSITIONAL MACRO KEY                00100300
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00100400
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG55C                00100500
&ZTLC             SETC 'MF'                                             00100600
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG55A       00100700
.ZG55B            ANOP  ,                                               00100800
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00100900
&ZMS              SETC  'THE "MF" KEY'                                  00101000
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00101100
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00101200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00101300
                  AGO   .ZG55E                                          00101400
.ZG55C            ANOP  ,                                               00101500
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00101600
&ZMS              SETC  '"MF='                                          00101700
&ZMS              SETC  '&ZMS.&MF"'                                     00101800
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00101900
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00102000
&ZMS              SETC  '&ZMS "S",'                                     00102100
&ZMS              SETC  '&ZMS "L",'                                     00102200
&ZMS              SETC  '&ZMS OR "E".'                                  00102300
                  MNOTE 8,' &ZMS '                                      00102400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00102500
                  AGO   .ZG55E                                          00102600
.ZG55D            ANOP  ,                                               00102700
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00102800
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00102900
.ZG55E            ANOP  ,                                               00103000
.********************************************************************   00103100
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00103200
.********************************************************************   00103300
                  ACTR  10000                                           00103400
.*-------------------------------------------------------------------   00103500
.***AG.MF03 MF=(SLE)                                                    00103600
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00103700
.*----------------------------------------------------------------***   00103800
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00103900
&XREQTYPE         SETC  ''          INITIALIZE XVARIABLE                00104000
                  AIF   (K'&USERID LE 0).ZG2C                           00104100
&ZXREQTYPE        SETC  'INPUT'     SET IN/OUTPUT                       00104200
&XREQTYPE         SETC  'USERID'    SET XVARIABLE                       00104300
&ZXUSERID         SETC  'INPUT'     SET IN/OUTPUT                       00104400
&XUSERID          SETC  '&USERID(1)'            SET XVARIABLE PARM      00104500
                  AIF   (N'&USERID GT 1).ZG2A                           00104600
&XUSERID          SETC  '&USERID'   SET XVARIABLE PARM                  00104700
.ZG2A             AIF   (N'&USERID LE 1).ZG2B   CK NUM                  00104800
&ZMS              SETC  '"USERID='                                      00104900
&ZMS              SETC  '&ZMS.&USERID"'                                 00105000
&ZMS              SETC  '&ZMS "USERID"'                                 00105100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00105200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00105300
.ZG2B             AIF   (K'&XUSERID GT 0).ZG2C  ONE PARM                00105400
&ZXREQTYPE        SETC  ''          RESET IN/OUTPUT                     00105500
&ZXUSERID         SETC  ''          RESET IN/OUTPUT                     00105600
&ZMS              SETC  ' '                                             00105700
&ZMS              SETC  '&ZMS "USERID" KEY AND ITS'                     00105800
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00105900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00106000
.ZG2C             ANOP  ,                                               00106100
.*----------------------------------------------------------------***   00106200
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00106300
                  AIF   (K'&SYSTEM LE 0).ZG3D   NO ME KEY               00106400
                  AIF   (N'&SYSTEM LE 1).ZG3A   CK NUM                  00106500
&ZMS              SETC  '"SYSTEM='                                      00106600
&ZMS              SETC  '&ZMS.&SYSTEM"'                                 00106700
&ZMS              SETC  '&ZMS "SYSTEM"'                                 00106800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00106900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00107000
.ZG3A             AIF   (K'&XREQTYPE LE 0).ZG3B                         00107100
&ZMS              SETC  '"SYSTEM'                                       00107200
&ZMS              SETC  '&ZMS.=&SYSTEM"'                                00107300
&ZMS              SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'           00107400
&ZMS              SETC  '&ZMS "&XREQTYPE"'                              00107500
                  MNOTE 8,' &ZMS KEY.'                                  00107600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00107700
                  AGO   .ZG3D                                           00107800
.*                                                                      00107900
.ZG3B             ANOP  ,                                               00108000
&ZXREQTYPE        SETC  'INPUT'     SET IN/OUTPUT                       00108100
&XREQTYPE         SETC  'SYSTEM'    SET XVARIABLE                       00108200
&ZXSYSTEM         SETC  'INPUT'     SET IN/OUTPUT                       00108300
&XSYSTEM          SETC  '&SYSTEM(1)'            SET XVARIABLE PARM      00108400
                  AIF   (N'&SYSTEM GT 1).ZG3C                           00108500
&XSYSTEM          SETC  '&SYSTEM'   SET XVARIABLE PARM                  00108600
.ZG3C             AIF   (K'&XSYSTEM GT 0).ZG3D  ONE PARM                00108700
&ZXREQTYPE        SETC  ''          RESET IN/OUTPUT                     00108800
&ZXSYSTEM         SETC  ''          RESET IN/OUTPUT                     00108900
&ZMS              SETC  ' '                                             00109000
&ZMS              SETC  '&ZMS "SYSTEM" KEY AND ITS'                     00109100
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00109200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00109300
.ZG3D             ANOP  ,                                               00109400
.*------------------------------------------------------------------    00109500
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00109600
                  AIF   (K'&XREQTYPE GT 0).ZG4B                         00109700
&ZXREQTYPE        SETC  ''          RESET IN/OUTPUT                     00109800
&ZXUSERID         SETC  ''          RESET IN/OUTPUT                     00109900
&XREQTYPE         SETC  ''          ENSURE NULL                         00110000
&XUSERID          SETC  ''          ENSURE NULL                         00110100
&ZMS              SETC  'ONE OF THE FOLLOWING'                          00110200
&ZMS              SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'             00110300
&ZMS              SETC  '&ZMS REQUIRED:'                                00110400
&ZMS              SETC  '&ZMS "USERID"'         VALID ME KEY            00110500
&ZMS              SETC  '&ZMS OR "SYSTEM".'     VALID ME KEY            00110600
                  MNOTE 8,' &ZMS '                                      00110700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00110800
.ZG4B             ANOP  ,                                               00110900
.*-------------------------------------------------------------------   00111000
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00111100
.ZG2ZY  AIF    ('&XREQTYPE' NE 'USERID').ZG3ZY                          00111200
.*-------------------------------------------------------------------   00111300
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00111400
                  AIF   (K'&ZXUSERID LE 0).ZG2R  NOT I/O                00111500
                  AIF   ('&XUSERID'(1,1) NE '(').ZG2R                   00111600
&ZCGPR            SETC  '&XUSERID'(2,K'&XUSERID-2)                      00111700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                     00111800
                  AIF   (K'&ZCGPR GT 2).ZG2Q                            00111900
                  AIF   ('&ZCGPR' EQ '0').ZG2Q                          00112000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00112100
                  AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME        00112200
.ZG2P             ANOP  ,                                               00112300
                  AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC             00112400
                  AIF   ('&ZCGPR' LT '2').ZG2Q                          00112500
                  AIF   ('&ZCGPR' LE '12').ZG2R                         00112600
.ZG2Q             ANOP  ,                                               00112700
&ZMS              SETC  '"USERID='                                      00112800
&ZMS              SETC  '&ZMS.&USERID"'                                 00112900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00113000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00113100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00113200
.ZG2R             ANOP  ,                                               00113300
.*-------------------------------------------------------------------   00113400
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00113500
.ZG3ZY  AIF    ('&XREQTYPE' NE 'SYSTEM').ZG4ZY                          00113600
.*-------------------------------------------------------------------   00113700
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00113800
                  AIF   (K'&ZXSYSTEM LE 0).ZG3R  NOT I/O                00113900
                  AIF   ('&XSYSTEM'(1,1) NE '(').ZG3R                   00114000
&ZCGPR            SETC  '&XSYSTEM'(2,K'&XSYSTEM-2)                      00114100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG3P                     00114200
                  AIF   (K'&ZCGPR GT 2).ZG3Q                            00114300
                  AIF   ('&ZCGPR' EQ '0').ZG3Q                          00114400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00114500
                  AIF   (T'&ZCGPR NE 'N').ZG3Q  INVALID REG NAME        00114600
.ZG3P             ANOP  ,                                               00114700
                  AIF   (T'&ZCGPR NE 'N').ZG3R  NON NUMERIC             00114800
                  AIF   ('&ZCGPR' LT '2').ZG3Q                          00114900
                  AIF   ('&ZCGPR' LE '12').ZG3R                         00115000
.ZG3Q             ANOP  ,                                               00115100
&ZMS              SETC  '"SYSTEM='                                      00115200
&ZMS              SETC  '&ZMS.&SYSTEM"'                                 00115300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00115400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00115500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00115600
.ZG3R             ANOP  ,                                               00115700
.*-------------------------------------------------------------------   00115800
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00115900
.ZG4ZY            ANOP ,            END MUTUALLY EXCLUSIVE KEYS         00116000
.*----------------------------------------------------------------***   00116100
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00116200
                  AIF   (N'&INDATA LE 1).ZG6A   CK NUM                  00116300
&ZMS              SETC  '"INDATA='                                      00116400
&ZMS              SETC  '&ZMS.&INDATA"'                                 00116500
&ZMS              SETC  '&ZMS "INDATA"'                                 00116600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00116700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00116800
.ZG6A             ANOP  ,                                               00116900
.*-------------------------------------------------------------------   00117000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00117100
&ZXINDATA         SETC  'INPUT'     SET IN/OUTPUT                       00117200
&XINDATA          SETC  '0'                                             00117300
                  AIF   (K'&INDATA(1) LE 0).ZG6B  PARM                  00117400
&XINDATA          SETC  '&INDATA(1)'            SET XVARIABLE           00117500
                  AIF   (N'&INDATA GT 1).ZG6B   MULTI                   00117600
&XINDATA          SETC  '&INDATA'   SET XVARIABLE                       00117700
.ZG6B             ANOP  ,                                               00117800
.*-------------------------------------------------------------------   00117900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00118000
                  AIF   (K'&ZXINDATA LE 0).ZG6R  NOT I/O                00118100
                  AIF   ('&XINDATA'(1,1) NE '(').ZG6R                   00118200
&ZCGPR            SETC  '&XINDATA'(2,K'&XINDATA-2)                      00118300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                     00118400
                  AIF   (K'&ZCGPR GT 2).ZG6Q                            00118500
                  AIF   ('&ZCGPR' EQ '0').ZG6Q                          00118600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00118700
                  AIF   (T'&ZCGPR NE 'N').ZG6Q  INVALID REG NAME        00118800
.ZG6P             ANOP  ,                                               00118900
                  AIF   (T'&ZCGPR NE 'N').ZG6R  NON NUMERIC             00119000
                  AIF   ('&ZCGPR' LT '2').ZG6Q                          00119100
                  AIF   ('&ZCGPR' LE '12').ZG6R                         00119200
.ZG6Q             ANOP  ,                                               00119300
&ZMS              SETC  '"INDATA='                                      00119400
&ZMS              SETC  '&ZMS.&INDATA"'                                 00119500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00119600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00119700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00119800
.ZG6R             ANOP  ,                                               00119900
.*----------------------------------------------------------------***   00120000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00120100
                  AIF   (N'&INDATALEN LE 1).ZG8A  CK NUM                00120200
&ZMS              SETC  '"INDATALEN='                                   00120300
&ZMS              SETC  '&ZMS.&INDATALEN"'                              00120400
&ZMS              SETC  '&ZMS "INDATALEN"'                              00120500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00120600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00120700
.ZG8A             ANOP  ,                                               00120800
.*-------------------------------------------------------------------   00120900
.***AG.KXVAR09 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00121000
&ZXINDATALEN      SETC  'INPUT'     SET IN/OUTPUT                       00121100
&XINDATALEN       SETC  '&INDATALEN(1)'         SET XVARIABLE           00121200
                  AIF   (N'&INDATALEN GT 1).ZG8B  MULTI PARMS           00121300
&XINDATALEN       SETC  '&INDATALEN'            SET XVARIABLE           00121400
.ZG8B             AIF   (K'&INDATA(1) GT 0).ZG8C  KEY                   00121500
                  AIF   (K'&INDATALEN(1) LE 0).ZG8D  PARM               00121600
&ZMS              SETC  '"INDATALEN'                                    00121700
&ZMS              SETC  '&ZMS.=&INDATALEN"'                             00121800
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00121900
&ZMS              SETC  '&ZMS '                                         00122000
&ZMS              SETC  '&ZMS "INDATA"'                                 00122100
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00122200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00122300
                  AGO   .ZG8E                                           00122400
.*                                                                      00122500
.ZG8C             AIF   (K'&INDATALEN(1) GT 0).ZG8E  PARM               00122600
&ZXINDATALEN      SETC  ''          RESET IN/OUTPUT                     00122700
&ZMS              SETC  ' '                                             00122800
&ZMS              SETC  '&ZMS "INDATALEN" KEY AND ITS'                  00122900
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00123000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00123100
.ZG8D             ANOP  ,                                               00123200
&XINDATALEN       SETC  '0'         SET DEFAULT                         00123300
.ZG8E             ANOP  ,                                               00123400
.*-------------------------------------------------------------------   00123500
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00123600
                  AIF   (K'&ZXINDATALEN LE 0).ZG8R  NOT I/O             00123700
                  AIF   ('&XINDATALEN'(1,1) NE '(').ZG8R                00123800
&ZCGPR            SETC  '&XINDATALEN'(2,K'&XINDATALEN-2)                00123900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                     00124000
                  AIF   (K'&ZCGPR GT 2).ZG8Q                            00124100
                  AIF   ('&ZCGPR' EQ '0').ZG8Q                          00124200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00124300
                  AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME        00124400
.ZG8P             ANOP  ,                                               00124500
                  AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC             00124600
                  AIF   ('&ZCGPR' LT '2').ZG8Q                          00124700
                  AIF   ('&ZCGPR' LE '12').ZG8R                         00124800
.ZG8Q             ANOP  ,                                               00124900
&ZMS              SETC  '"INDATALEN='                                   00125000
&ZMS              SETC  '&ZMS.&INDATALEN"'                              00125100
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00125200
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00125300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00125400
.ZG8R             ANOP  ,                                               00125500
.*----------------------------------------------------------------***   00125600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00125700
                  AIF   (N'&INDATAKEY LE 1).ZG11A  CK NUM               00125800
&ZMS              SETC  '"INDATAKEY='                                   00125900
&ZMS              SETC  '&ZMS.&INDATAKEY"'                              00126000
&ZMS              SETC  '&ZMS "INDATAKEY"'                              00126100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00126200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00126300
.ZG11A            ANOP  ,                                               00126400
.*-------------------------------------------------------------------   00126500
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00126600
&XINDATAKEY       SETC  'CALLER_KEY'            SET DEFAULT             00126700
                  AIF   (K'&INDATAKEY(1) LE 0).ZG11C  PARM              00126800
&XINDATAKEY       SETC  '&INDATAKEY(1)'         SET XVARIABLE           00126900
                  AIF   (N'&INDATAKEY GT 1).ZG11B  MULTI PARMS          00127000
&XINDATAKEY       SETC  '&INDATAKEY'            SET XVARIABLE           00127100
.ZG11B            AIF   (K'&INDATA(1) GT 0).ZG11C  KEY                  00127200
&ZMS              SETC  '"INDATAKEY'                                    00127300
&ZMS              SETC  '&ZMS.=&INDATAKEY"'                             00127400
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00127500
&ZMS              SETC  '&ZMS '                                         00127600
&ZMS              SETC  '&ZMS "INDATA"'                                 00127700
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00127800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00127900
.ZG11C            ANOP  ,                                               00128000
&ZXINDATAKEY      SETC  'INPUT'     SET IN/OUTPUT                       00128100
.*-------------------------------------------------------------------   00128200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00128300
                  AIF   (K'&ZXINDATAKEY LE 0).ZG11R  NOT I/O            00128400
         AIF   ('&XINDATAKEY' EQ 'CALLER_KEY').ZG11R                    00128500
                  AIF   ('&XINDATAKEY'(1,1) NE '(').ZG11R               00128600
&ZCGPR            SETC  '&XINDATAKEY'(2,K'&XINDATAKEY-2)                00128700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                    00128800
                  AIF   (K'&ZCGPR GT 2).ZG11Q                           00128900
                  AIF   ('&ZCGPR' EQ '0').ZG11Q                         00129000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00129100
                  AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME       00129200
.ZG11P            ANOP  ,                                               00129300
                  AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC            00129400
                  AIF   ('&ZCGPR' LT '2').ZG11Q                         00129500
                  AIF   ('&ZCGPR' LE '12').ZG11R                        00129600
.ZG11Q            ANOP  ,                                               00129700
&ZMS              SETC  '"INDATAKEY='                                   00129800
&ZMS              SETC  '&ZMS.&INDATAKEY"'                              00129900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00130000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00130100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00130200
.ZG11R            ANOP  ,                                               00130300
.*----------------------------------------------------------------***   00130400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00130500
                  AIF   (N'&OUTDATA LE 1).ZG15A  CK NUM                 00130600
&ZMS              SETC  '"OUTDATA='                                     00130700
&ZMS              SETC  '&ZMS.&OUTDATA"'                                00130800
&ZMS              SETC  '&ZMS "OUTDATA"'                                00130900
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00131000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00131100
.ZG15A            ANOP  ,                                               00131200
.*-------------------------------------------------------------------   00131300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00131400
                  AIF   (K'&OUTDATA(1) LE 0).ZG15C  NO PARM             00131500
&ZXOUTDATA        SETC  'OUTPUT'    SET OUTPUT                          00131600
&XOUTDATA         SETC  '&OUTDATA(1)'           SET XVARIABLE           00131700
                  AIF   (N'&OUTDATA GT 1).ZG15C                         00131800
&XOUTDATA         SETC  '&OUTDATA'  SET XVARIABLE                       00131900
.ZG15C            ANOP  ,                                               00132000
.*-------------------------------------------------------------------   00132100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00132200
                  AIF   (K'&ZXOUTDATA LE 0).ZG15R  NOT I/O              00132300
                  AIF   ('&XOUTDATA'(1,1) NE '(').ZG15R                 00132400
&ZCGPR            SETC  '&XOUTDATA'(2,K'&XOUTDATA-2)                    00132500
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                    00132600
                  AIF   (K'&ZCGPR GT 2).ZG15Q                           00132700
                  AIF   ('&ZCGPR' EQ '0').ZG15Q                         00132800
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00132900
                  AIF   (T'&ZCGPR NE 'N').ZG15Q  INVALID REG NAME       00133000
.ZG15P            ANOP  ,                                               00133100
                  AIF   (T'&ZCGPR NE 'N').ZG15R  NON NUMERIC            00133200
                  AIF   ('&ZCGPR' LT '2').ZG15Q                         00133300
                  AIF   ('&ZCGPR' LE '12').ZG15R                        00133400
.ZG15Q            ANOP  ,                                               00133500
&ZMS              SETC  '"OUTDATA='                                     00133600
&ZMS              SETC  '&ZMS.&OUTDATA"'                                00133700
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00133800
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00133900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00134000
.ZG15R            ANOP  ,                                               00134100
.*----------------------------------------------------------------***   00134200
.***AG.KXVAR05 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE KEY                00134300
                  AIF   (N'&OUTDATALEN LE 1).ZG17A  CK NUM              00134400
&ZMS              SETC  '"OUTDATALEN='                                  00134500
&ZMS              SETC  '&ZMS.&OUTDATALEN"'                             00134600
&ZMS              SETC  '&ZMS "OUTDATALEN"'                             00134700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00134800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00134900
.ZG17A            ANOP  ,                                               00135000
.*-------------------------------------------------------------------   00135100
.***AG.KXVAR10 NAME, OPT RQD OUTPUT, KEYS -XVARIABLE                    00135200
                  AIF   (K'&OUTDATA(1) GT 0).ZG17B  KEY                 00135300
                  AIF   (K'&OUTDATALEN(1) LE 0).ZG17D  NO PRM           00135400
&ZMS              SETC  '"OUTDATALEN'                                   00135500
&ZMS              SETC  '&ZMS.=&OUTDATALEN"'                            00135600
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00135700
&ZMS              SETC  '&ZMS '                                         00135800
&ZMS              SETC  '&ZMS "OUTDATA"'                                00135900
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00136000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00136100
                  AGO   .ZG17D                                          00136200
.*                                                                      00136300
.ZG17B            ANOP  ,                                               00136400
                  AIF   (K'&OUTDATALEN(1) LE 0).ZG17C  NO PRM           00136500
&ZXOUTDATALEN     SETC  'OUTPUT'    SET OUTPUT                          00136600
&XOUTDATALEN      SETC  '&OUTDATALEN(1))'       SET XVARIABLE           00136700
                  AIF   (N'&OUTDATALEN GT 1).ZG17C                      00136800
&XOUTDATALEN      SETC  '&OUTDATALEN'           SET XVARIABLE           00136900
                  AGO   .ZG17D                                          00137000
.ZG17C            ANOP  ,                                               00137100
&ZMS              SETC  'WHEN "OUTDATA" IS SPECIFIED'                   00137200
&ZMS              SETC  '&ZMS , "OUTDATALEN" KEY AND ITS'               00137300
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00137400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00137500
.ZG17D            ANOP  ,                                               00137600
.*-------------------------------------------------------------------   00137700
.***AG.KCK02 NAME, OPT RQD OUTPUT, KEYS -GPR OUT OF RANGE               00137800
                  AIF   (K'&ZXOUTDATALEN LE 0).ZG17R  NOT I/O           00137900
                  AIF   ('&XOUTDATALEN'(1,1) NE '(').ZG17R              00138000
&ZCGPR            SETC  '&XOUTDATALEN'(2,K'&XOUTDATALEN-2)              00138100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                    00138200
                  AIF   (K'&ZCGPR GT 2).ZG17Q                           00138300
                  AIF   ('&ZCGPR' EQ '0').ZG17Q                         00138400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00138500
                  AIF   (T'&ZCGPR NE 'N').ZG17Q  INVALID REG NAME       00138600
.ZG17P            ANOP  ,                                               00138700
                  AIF   (T'&ZCGPR NE 'N').ZG17R  NON NUMERIC            00138800
                  AIF   ('&ZCGPR' LT '2').ZG17Q                         00138900
                  AIF   ('&ZCGPR' LE '12').ZG17R                        00139000
.ZG17Q            ANOP  ,                                               00139100
&ZMS              SETC  '"OUTDATALEN='                                  00139200
&ZMS              SETC  '&ZMS.&OUTDATALEN"'                             00139300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00139400
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00139500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00139600
.ZG17R            ANOP  ,                                               00139700
.*----------------------------------------------------------------***   00139800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00139900
                  AIF   (N'&OUTDATAKEY LE 1).ZG20A  CK NUM              00140000
&ZMS              SETC  '"OUTDATAKEY='                                  00140100
&ZMS              SETC  '&ZMS.&OUTDATAKEY"'                             00140200
&ZMS              SETC  '&ZMS "OUTDATAKEY"'                             00140300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00140400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00140500
.ZG20A            ANOP  ,                                               00140600
.*-------------------------------------------------------------------   00140700
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00140800
&XOUTDATAKEY      SETC  'CALLER_KEY'            SET DEFAULT             00140900
                  AIF   (K'&OUTDATAKEY(1) LE 0).ZG20C  PARM             00141000
&XOUTDATAKEY      SETC  '&OUTDATAKEY(1)'        SET XVARIABLE           00141100
                  AIF   (N'&OUTDATAKEY GT 1).ZG20B  MULTI PARMS         00141200
&XOUTDATAKEY      SETC  '&OUTDATAKEY'           SET XVARIABLE           00141300
.ZG20B            AIF   (K'&OUTDATA(1) GT 0).ZG20C  KEY                 00141400
&ZMS              SETC  '"OUTDATAKEY'                                   00141500
&ZMS              SETC  '&ZMS.=&OUTDATAKEY"'                            00141600
&ZMS              SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                 00141700
&ZMS              SETC  '&ZMS '                                         00141800
&ZMS              SETC  '&ZMS "OUTDATA"'                                00141900
                  MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                    00142000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00142100
.ZG20C            ANOP  ,                                               00142200
&ZXOUTDATAKEY     SETC  'INPUT'     SET IN/OUTPUT                       00142300
.*-------------------------------------------------------------------   00142400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00142500
                  AIF   (K'&ZXOUTDATAKEY LE 0).ZG20R  NOT I/O           00142600
         AIF   ('&XOUTDATAKEY' EQ 'CALLER_KEY').ZG20R                   00142700
                  AIF   ('&XOUTDATAKEY'(1,1) NE '(').ZG20R              00142800
&ZCGPR            SETC  '&XOUTDATAKEY'(2,K'&XOUTDATAKEY-2)              00142900
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                    00143000
                  AIF   (K'&ZCGPR GT 2).ZG20Q                           00143100
                  AIF   ('&ZCGPR' EQ '0').ZG20Q                         00143200
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00143300
                  AIF   (T'&ZCGPR NE 'N').ZG20Q  INVALID REG NAME       00143400
.ZG20P            ANOP  ,                                               00143500
                  AIF   (T'&ZCGPR NE 'N').ZG20R  NON NUMERIC            00143600
                  AIF   ('&ZCGPR' LT '2').ZG20Q                         00143700
                  AIF   ('&ZCGPR' LE '12').ZG20R                        00143800
.ZG20Q            ANOP  ,                                               00143900
&ZMS              SETC  '"OUTDATAKEY='                                  00144000
&ZMS              SETC  '&ZMS.&OUTDATAKEY"'                             00144100
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00144200
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00144300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00144400
.ZG20R            ANOP  ,                                               00144500
.*----------------------------------------------------------------***   00144600
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00144700
                  AIF   (N'&LOGONOPTIONS LE 1).ZG24A  CK NUM            00144800
&ZMS              SETC  '"LOGONOPTIONS='                                00144900
&ZMS              SETC  '&ZMS.&LOGONOPTIONS"'                           00145000
&ZMS              SETC  '&ZMS "LOGONOPTIONS"'                           00145100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00145200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00145300
.ZG24A            ANOP  ,                                               00145400
.*-------------------------------------------------------------------   00145500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00145600
&XLOGONOPTIONS    SETC  ''          INITIALIZE XVARIABLE                00145700
.ZG25A   AIF   ('&LOGONOPTIONS(1)' NE 'FAIL').ZG26A                     00145800
&XLOGONOPTIONS    SETC  'FAIL'      SET KEYWORD                         00145900
.*-------------------------------------------------------------------   00146000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146100
.ZG26A   AIF   ('&LOGONOPTIONS(1)' NE 'USE_FIRST').ZG27A                00146200
&XLOGONOPTIONS    SETC  'USE_FIRST'             SET KEYWORD             00146300
.*-------------------------------------------------------------------   00146400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00146500
.ZG27A            AIF   (K'&XLOGONOPTIONS GT 0).ZG27C  KEYWORD          00146600
                  AIF   (K'&LOGONOPTIONS(1) LE 0).ZG27B                 00146700
&ZMS              SETC  '"LOGONOPTIONS='                                00146800
&ZMS              SETC  '&ZMS.&LOGONOPTIONS"'                           00146900
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00147000
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00147100
&ZMS              SETC  '&ZMS "FAIL"'                                   00147200
&ZMS              SETC  '&ZMS OR "USE_FIRST".'                          00147300
                  MNOTE 8,' &ZMS '                                      00147400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00147500
.ZG27B            ANOP  ,                                               00147600
&XLOGONOPTIONS    SETC  'FAIL'      SET DEFAULT KEYWORD                 00147700
.ZG27C            ANOP  ,                                               00147800
&ZXLOGONOPTIONS   SETC  'INPUT'     SET IN/OUTPUT                       00147900
.*----------------------------------------------------------------***   00148000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00148100
                  AIF   (N'&RTNCODE LE 1).ZG29A  CK NUM                 00148200
&ZMS              SETC  '"RTNCODE='                                     00148300
&ZMS              SETC  '&ZMS.&RTNCODE"'                                00148400
&ZMS              SETC  '&ZMS "RTNCODE"'                                00148500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00148600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00148700
.ZG29A            ANOP  ,                                               00148800
.*-------------------------------------------------------------------   00148900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00149000
                  AIF   (K'&RTNCODE(1) LE 0).ZG29C  NO PARM             00149100
&ZXRTNCODE        SETC  'OUTPUT'    SET OUTPUT                          00149200
&XRTNCODE         SETC  '&RTNCODE(1)'           SET XVARIABLE           00149300
                  AIF   (N'&RTNCODE GT 1).ZG29C                         00149400
&XRTNCODE         SETC  '&RTNCODE'  SET XVARIABLE                       00149500
.ZG29C            ANOP  ,                                               00149600
.*-------------------------------------------------------------------   00149700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00149800
                  AIF   (K'&ZXRTNCODE LE 0).ZG29R  NOT I/O              00149900
                  AIF   ('&XRTNCODE'(1,1) NE '(').ZG29R                 00150000
&ZCGPR            SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                    00150100
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                    00150200
                  AIF   (K'&ZCGPR GT 2).ZG29Q                           00150300
                  AIF   ('&ZCGPR' EQ '0').ZG29Q                         00150400
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00150500
                  AIF   (T'&ZCGPR NE 'N').ZG29Q  INVALID REG NAME       00150600
.ZG29P            ANOP  ,                                               00150700
                  AIF   (T'&ZCGPR NE 'N').ZG29R  NON NUMERIC            00150800
                  AIF   ('&ZCGPR' EQ '15').ZG29R                        00150900
                  AIF   ('&ZCGPR' LT '2').ZG29Q                         00151000
                  AIF   ('&ZCGPR' LE '12').ZG29R                        00151100
.ZG29Q            ANOP  ,                                               00151200
&ZMS              SETC  '"RTNCODE='                                     00151300
&ZMS              SETC  '&ZMS.&RTNCODE"'                                00151400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00151500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'        00151600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00151700
.ZG29R            ANOP  ,                                               00151800
.*----------------------------------------------------------------***   00151900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00152000
                  AIF   (N'&RSNCODE LE 1).ZG32A  CK NUM                 00152100
&ZMS              SETC  '"RSNCODE='                                     00152200
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00152300
&ZMS              SETC  '&ZMS "RSNCODE"'                                00152400
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00152500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00152600
.ZG32A            ANOP  ,                                               00152700
.*-------------------------------------------------------------------   00152800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00152900
                  AIF   (K'&RSNCODE(1) LE 0).ZG32C  NO PARM             00153000
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00153100
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00153200
                  AIF   (N'&RSNCODE GT 1).ZG32C                         00153300
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00153400
.ZG32C            ANOP  ,                                               00153500
.*-------------------------------------------------------------------   00153600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00153700
                  AIF   (K'&ZXRSNCODE LE 0).ZG32R  NOT I/O              00153800
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG32R                 00153900
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00154000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG32P                    00154100
                  AIF   (K'&ZCGPR GT 2).ZG32Q                           00154200
                  AIF   ('&ZCGPR' EQ '0').ZG32R                         00154300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00154400
                  AIF   (T'&ZCGPR NE 'N').ZG32Q  INVALID REG NAME       00154500
.ZG32P            ANOP  ,                                               00154600
                  AIF   (T'&ZCGPR NE 'N').ZG32R  NON NUMERIC            00154700
                  AIF   ('&ZCGPR' EQ '0').ZG32R                         00154800
                  AIF   ('&ZCGPR' LT '2').ZG32Q                         00154900
                  AIF   ('&ZCGPR' LE '12').ZG32R                        00155000
.ZG32Q            ANOP  ,                                               00155100
&ZMS              SETC  '"RSNCODE='                                     00155200
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00155300
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00155400
                  MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'         00155500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00155600
.ZG32R            ANOP  ,                                               00155700
.******************************************************************     00155800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00155900
.******************************************************************     00156000
                  ACTR  10000                                           00156100
.*----------------------------------------------------------------***   00156200
.***AH.P02 EXTRA POSITIONALS                                            00156300
                  AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS            00156400
                  AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL            00156500
                  AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL        00156600
                  AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL         00156700
.ZGLISTX1         ANOP  ,                                               00156800
&ZCVAL            SETC  ''          ERROR FIELD                         00156900
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00157000
.ZGLIST2          ANOP  ,                                               00157100
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00157200
                  AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE            00157300
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00157400
                  AGO   .ZGLIST2                                        00157500
.*                                                                      00157600
.ZGLIST3          ANOP  ,                                               00157700
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00157800
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'                       00157900
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00158000
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00158100
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00158200
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00158300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00158400
.ZGLISTX          ANOP  ,                                               00158500
&ZASYSLNDX        SETA  0                                               00158600
.*-------------------------------------------------------------------   00158700
.***AG.MF04 MF=(SLE)                                                    00158800
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00158900
.*******************************************************************    00159000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00159100
.*******************************************************************    00159200
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00159300
.*******************************************************************    00159400
.***AE.01  START OF IXZXTSOI MACRO CODE                                 00159500
.*******************************************************************    00159600
                  LCLC  &M0M0001                 NAME                   00159700
&M0M0001          SETC  '&XLABEL'                SET NAME               00159800
                  AIF   (K'&XLABEL NE 0).XLAB2                          00159900
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00160000
.*                                                                      00160100
.XLAB2            ANOP  ,                                               00160200
                  AIF   ('&XMF' EQ 'L').XLAB3                           00160300
&M0M0001 DS    0H                             IXZXTSOI-1                00160400
.XLAB3            ANOP  ,                                               00160500
.*******************************************************************    00160600
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00160700
.*******************************************************************    00160800
              PUSH  PRINT                                               00160900
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00161000
                  PRINT OFF         ++ PR01                             00161100
                  AGO   .ZPRNTXX                                        00161200
.ZPRINTX          PRINT ON                                              00161300
.ZPRNTXX          ANOP  ,                                               00161400
.********************************************************************   00161500
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00161600
.********************************************************************   00161700
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00161800
                      LCLA  &ZOPN1         INVOCATION INDEX             00161900
                      LCLC  &ZOPL(4095)    LABEL                        00162000
                      LCLC  &ZOPO(4095)    OPERATION                    00162100
                      LCLC  &ZOPV(4095)    VALUE                        00162200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00162300
.*                                                                      00162400
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00162500
.******************************************************************     00162600
.***AL.L10 IXZXTSOI FMT=LIST MF=S!L PARAMETERS                          00162700
.******************************************************************     00162800
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00162900
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00163000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00163100
&XMFATTR              SETC  '0D'                                        00163200
.*                                                                      00163300
&ZOPN                 SETA  &ZOPN+1                                     00163400
&ZOPL(&ZOPN)          SETC  ' '                                         00163500
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00163600
&ZOPO(&ZOPN)          SETC  'B'                                         00163700
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00163800
                      AGO   .ZALVL6B                                    00163900
.ZALVL6A              ANOP                                              00164000
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00164100
&ZOPV(&ZOPN)          SETC  '4,8'                                       00164200
&ZOPN                 SETA  &ZOPN+1                                     00164300
&ZOPL(&ZOPN)          SETC  ' '                                         00164400
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00164500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00164600
.ZALVL6B              ANOP                                              00164700
&ZOPD(&ZOPN)          SETC  '++ IXZXTSOI ARG PARMS'                     00164800
.*                                                                      00164900
&ZOPN                 SETA  &ZOPN+1                                     00165000
&ZOPL(&ZOPN)          SETC  ' '                                         00165100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00165200
&ZOPV(&ZOPN)          SETC  '1'                                         00165300
&ZOPD(&ZOPN)          SETC  ' '                                         00165400
.*                                                                      00165500
.ZLMFSL2              ANOP  ,                                           00165600
.*-------------------------------------------------------------------   00165700
.***AM.L00  IXZXTSOI FMT=LIST name                                      00165800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00165900
&ZOPN                 SETA &ZOPN+1                                      00166000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00166100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00166200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00166300
&ZOPD(&ZOPN)          SETC '++ IXZXTSOI NAME'                           00166400
.ZLMFSL2M             ANOP  ,                                           00166500
.*-------------------------------------------------------------------   00166600
.***AM.L01  IXZXTSOI FMT=LIST PARAMETERS                                00166700
&ZOPN                 SETA &ZOPN+1                                      00166800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00166900
&ZOPO(&ZOPN)          SETC 'DS'                                         00167000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00167100
&ZOPD(&ZOPN)          SETC '++ IXZXTSOI PARM LIST'                      00167200
.*-------------------------------------------------------------------   00167300
.***AM.L02 XVERSION XL1                                                 00167400
&ZOPN                 SETA &ZOPN+1                                      00167500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00167600
&ZOPO(&ZOPN)          SETC 'DS'                                         00167700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00167800
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00167900
.*-------------------------------------------------------------------   00168000
.***AM.L09  XEYECATCHER CL6                                             00168100
&ZOPN                 SETA &ZOPN+1                                      00168200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEYECATCHER'                      00168300
&ZOPO(&ZOPN)          SETC 'DS'                                         00168400
&ZOPV(&ZOPN)          SETC 'CL6'                                        00168500
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00168600
.*-------------------------------------------------------------------   00168700
.***AM.L03 XMACROOPTIONS BL.8                                           00168800
&ZOPN                 SETA &ZOPN+1                                      00168900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMACROOPTIONS'                    00169000
&ZOPO(&ZOPN)          SETC 'DS'                                         00169100
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00169200
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00169300
.*                                                                      00169400
&ZOPN                 SETA  &ZOPN+1                                     00169500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_USERID'                  00169600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00169700
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00169800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00169900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).USERID'                       00170000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00170100
.*                                                                      00170200
&ZOPN                 SETA  &ZOPN+1                                     00170300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_SYSTEM'                  00170400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00170500
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00170600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00170700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SYSTEM'                       00170800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00170900
.*                                                                      00171000
&ZOPN                 SETA  &ZOPN+1                                     00171100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_INDATAKEY'               00171200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00171300
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00171400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00171500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INDATAKEY'                    00171600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00171700
.*                                                                      00171800
&ZOPN                 SETA  &ZOPN+1                                     00171900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_OUTDATAKEY'              00172000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00172100
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00172200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00172300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).OUTDATAKEY'                   00172400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00172500
.*                                                                      00172600
&ZOPN                 SETA  &ZOPN+1                                     00172700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_INDATA'                  00172800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00172900
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00173000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00173100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INDATA'                       00173200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00173300
.*                                                                      00173400
&ZOPN                 SETA  &ZOPN+1                                     00173500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_OUTDATA'                 00173600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00173700
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00173800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00173900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).OUTDATA'                      00174000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00174100
.*-------------------------------------------------------------------   00174200
.***AM.L09  XINDATAKEY XL1                                              00174300
&ZOPN                 SETA &ZOPN+1                                      00174400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINDATAKEY'                       00174500
&ZOPO(&ZOPN)          SETC 'DS'                                         00174600
&ZOPV(&ZOPN)          SETC 'XL1'                                        00174700
&ZOPD(&ZOPN)          SETC '++ &ZXINDATAKEY '                           00174800
.*-------------------------------------------------------------------   00174900
.***AM.L09  XOUTDATAKEY XL1                                             00175000
&ZOPN                 SETA &ZOPN+1                                      00175100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTDATAKEY'                      00175200
&ZOPO(&ZOPN)          SETC 'DS'                                         00175300
&ZOPV(&ZOPN)          SETC 'XL1'                                        00175400
&ZOPD(&ZOPN)          SETC '++ &ZXOUTDATAKEY '                          00175500
.*-------------------------------------------------------------------   00175600
.***AM.L09  XRSV0001 CL1                                                00175700
&ZOPN                 SETA &ZOPN+1                                      00175800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00175900
&ZOPO(&ZOPN)          SETC 'DS'                                         00176000
&ZOPV(&ZOPN)          SETC 'CL1'                                        00176100
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00176200
.*-------------------------------------------------------------------   00176300
.***AM.L03 XLOGONOPTIONS BL.8                                           00176400
&ZOPN                 SETA &ZOPN+1                                      00176500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XLOGONOPTIONS'                    00176600
&ZOPO(&ZOPN)          SETC 'DS'                                         00176700
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00176800
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   00176900
.*                                                                      00177000
&ZOPN                 SETA  &ZOPN+1                                     00177100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XLOGONOPTIONS_FAIL'              00177200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00177300
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00177400
&ZOPD(&ZOPN)          SETC  '++ XLOGONOPTIONS.'                         00177500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).FAIL'                         00177600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00177700
.*                                                                      00177800
&ZOPN                 SETA  &ZOPN+1                                     00177900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XLOGONOPTIONS_USE_FIRST'         00178000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00178100
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00178200
&ZOPD(&ZOPN)          SETC  '++ XLOGONOPTIONS.'                         00178300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).USE_FIRST'                    00178400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00178500
.*-------------------------------------------------------------------   00178600
.***AM.L09  XUSERID CL8                                                 00178700
&ZOPN                 SETA &ZOPN+1                                      00178800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERID'                          00178900
&ZOPO(&ZOPN)          SETC 'DS'                                         00179000
&ZOPV(&ZOPN)          SETC 'CL8'                                        00179100
&ZOPD(&ZOPN)          SETC '++ &ZXUSERID '                              00179200
.*-------------------------------------------------------------------   00179300
.***AM.L09  XINDATA A                                                   00179400
&ZOPN                 SETA &ZOPN+1                                      00179500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINDATA'                          00179600
&ZOPO(&ZOPN)          SETC 'DS'                                         00179700
&ZOPV(&ZOPN)          SETC 'A'                                          00179800
&ZOPD(&ZOPN)          SETC '++ &ZXINDATA '                              00179900
.*-------------------------------------------------------------------   00180000
.***AM.L09  XINDATALEN F                                                00180100
&ZOPN                 SETA &ZOPN+1                                      00180200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XINDATALEN'                       00180300
&ZOPO(&ZOPN)          SETC 'DS'                                         00180400
&ZOPV(&ZOPN)          SETC 'F'                                          00180500
&ZOPD(&ZOPN)          SETC '++ &ZXINDATALEN '                           00180600
.*-------------------------------------------------------------------   00180700
.***AM.L09  XOUTDATA A                                                  00180800
&ZOPN                 SETA &ZOPN+1                                      00180900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTDATA'                         00181000
&ZOPO(&ZOPN)          SETC 'DS'                                         00181100
&ZOPV(&ZOPN)          SETC 'A'                                          00181200
&ZOPD(&ZOPN)          SETC '++ &ZXOUTDATA '                             00181300
.*-------------------------------------------------------------------   00181400
.***AM.L09  XOUTDATALEN F                                               00181500
&ZOPN                 SETA &ZOPN+1                                      00181600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOUTDATALEN'                      00181700
&ZOPO(&ZOPN)          SETC 'DS'                                         00181800
&ZOPV(&ZOPN)          SETC 'F'                                          00181900
&ZOPD(&ZOPN)          SETC '++ &ZXOUTDATALEN '                          00182000
.*-------------------------------------------------------------------   00182100
.***AM.L09  XRSV0002 CL4                                                00182200
&ZOPN                 SETA &ZOPN+1                                      00182300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00182400
&ZOPO(&ZOPN)          SETC 'DS'                                         00182500
&ZOPV(&ZOPN)          SETC 'CL4'                                        00182600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00182700
.*-------------------------------------------------------------------   00182800
.***AM.L09  XRSV0003 CL16                                               00182900
&ZOPN                 SETA &ZOPN+1                                      00183000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00183100
&ZOPO(&ZOPN)          SETC 'DS'                                         00183200
&ZOPV(&ZOPN)          SETC 'CL16'                                       00183300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00183400
.*-------------------------------------------------------------------   00183500
.***AM.MLM1 SAVED LOCATION COUNTER                                      00183600
                      AIF  ('&ZENDBASEPL' NE '').ZL23LB                 00183700
&ZENDBASEPL           SETC 'YES'                                        00183800
&ZOPN                 SETA &ZOPN+1                                      00183900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00184000
&ZOPO(&ZOPN)          SETC 'EQU'                                        00184100
&ZOPV(&ZOPN)          SETC '*'                                          00184200
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00184300
.ZL23LB               ANOP  ,                                           00184400
.*-------------------------------------------------------------------   00184500
.***AM.PJR1 DEFINED ON XUSERID                                          00184600
&ZOPN                 SETA &ZOPN+1                                      00184700
&ZOPL(&ZOPN)          SETC ' '                                          00184800
&ZOPO(&ZOPN)          SETC 'ORG'                                        00184900
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+12'                               00185000
&ZOPD(&ZOPN)          SETC ' '                                          00185100
.*-------------------------------------------------------------------   00185200
.***AM.L09  XSYSTEM CL8                                                 00185300
&ZOPN                 SETA &ZOPN+1                                      00185400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSYSTEM'                          00185500
&ZOPO(&ZOPN)          SETC 'DS'                                         00185600
&ZOPV(&ZOPN)          SETC 'CL8'                                        00185700
&ZOPD(&ZOPN)          SETC '++ &ZXSYSTEM '                              00185800
&ZOPN                 SETA &ZOPN+1                                      00185900
&ZOPL(&ZOPN)          SETC ' '                                          00186000
&ZOPO(&ZOPN)          SETC 'ORG'                                        00186100
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00186200
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00186300
.*-------------------------------------------------------------------   00186400
.***AM.L10 END OF IXZXTSOI LIST PARAMETERS                              00186500
&ZOPN                 SETA &ZOPN+1                                      00186600
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00186700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00186800
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00186900
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00187000
.*                                                                      00187100
&ZOPN                 SETA &ZOPN+1                                      00187200
&ZOPL(&ZOPN)          SETC ' '                                          00187300
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00187400
&ZOPV(&ZOPN)          SETC '1'                                          00187500
&ZOPD(&ZOPN)          SETC ' '                                          00187600
.*-------------------------------------------------------------------   00187700
.***AL.L12 IXZXTSOI FMT=LIST MF=S!L PARAMETERS                          00187800
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00187900
.*                                                                      00188000
&ZOPN                 SETA  &ZOPN+1                                     00188100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00188200
&ZOPO(&ZOPN)          SETC  'DC'                                        00188300
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00188400
&ZOPD(&ZOPN)          SETC  '++ IXZXTSOI ARG PARMS'                     00188500
.*                                                                      00188600
.ZLMFSLX              ANOP  ,                                           00188700
.*-------------------------------------------------------------------   00188800
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00188900
&ZPLLEN               SETA 56                                           00189000
.*                                                                      00189100
.******************************************************************     00189200
.***AI.L01 IXZXTSOI FMT=LIST FILL IN PARAMETER AREA                     00189300
.******************************************************************     00189400
                      ACTR  10000                                       00189500
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00189600
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00189700
&ZCVAL                SETC  'LAE'          XAX MODE                     00189800
.ZIMFXA               ANOP ,                                            00189900
.*                                                                      00190000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00190100
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00190200
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00190300
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00190400
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00190500
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00190600
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00190700
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00190800
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00190900
&ZOPN                 SETA  &ZOPN+1                                     00191000
&ZOPL(&ZOPN)          SETC  ' '                                         00191100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00191200
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00191300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00191400
                      AGO   .ZIMFNX                                     00191500
.*                                                                      00191600
.ZIMFN2               ANOP ,                                            00191700
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00191800
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00191900
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00192000
&ZOPN                 SETA  &ZOPN+1                                     00192100
&ZOPL(&ZOPN)          SETC  ' '                                         00192200
&ZOPO(&ZOPN)          SETC  'LAE'                                       00192300
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00192400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00192500
                      AGO   .ZIMFNX                                     00192600
.ZIMFNX1              ANOP ,                                            00192700
&ZOPN                 SETA  &ZOPN+1                                     00192800
&ZOPL(&ZOPN)          SETC  ' '                                         00192900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00193000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00193100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00193200
.ZIMFNX               ANOP ,                                            00193300
.********************************************************************   00193400
.***AI.L02 IXZXTSOI FMT=LIST INITIALIZE PARAMETER AREA                  00193500
.********************************************************************   00193600
.***AI.L03 MF=(SLE)                                                     00193700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00193800
.*                                                                      00193900
&ZOPN                 SETA  &ZOPN+1                                     00194000
&ZOPL(&ZOPN)          SETC  ' '                                         00194100
&ZOPO(&ZOPN)          SETC  'XC'                                        00194200
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00194300
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00194400
.ZIMFLX               ANOP  ,                                           00194500
.*-------------------------------------------------------------------   00194600
.***AI.L04B XVERSION XL1                                                00194700
                      AIF   (&XPLISTVER EQ 0).ZIMFVZ                    00194800
&ZOPN                 SETA  &ZOPN+1                                     00194900
&ZOPL(&ZOPN)          SETC  ' '                                         00195000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00195100
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00195200
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00195300
.ZIMFVZ               ANOP  ,                                           00195400
.*-------------------------------------------------------------------   00195500
.***AI.L60 XEYECATCHER CL6                                              00195600
&ZOPN                 SETA  &ZOPN+1                                     00195700
&ZOPL(&ZOPN)          SETC  ' '                                         00195800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00195900
&ZOPV(&ZOPN)          SETC  '1(6,1),=CL6''YTSOGR'''                     00196000
&ZOPD(&ZOPN)          SETC  '++ CL6 CONSTANT'                           00196100
.*-------------------------------------------------------------------   00196200
.***AI.L05 XMACROOPTIONS BL1                                            00196300
&ZW                   SETC  ''                                          00196400
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00196500
.*-------------------------------------------------------------------   00196600
.***AI.L08 XMACROOPTIONS "USERID"                                       00196700
.***      BL1'1XXXXXXX'                                                 00196800
         AIF   ('&USERID' EQ '').ZI4A                                   00196900
&ZW                   SETC  '&ZW.1'                                     00197000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00197100
                      AGO   .ZI4C                                       00197200
.*                                                                      00197300
.ZI4A                 ANOP  ,                                           00197400
&ZW                   SETC  '&ZW.0'                                     00197500
.ZI4C                 ANOP  ,                                           00197600
.*-------------------------------------------------------------------   00197700
.***AI.L08 XMACROOPTIONS "SYSTEM"                                       00197800
.***      BL1'X1XXXXXX'                                                 00197900
         AIF   ('&SYSTEM' EQ '').ZI5A                                   00198000
&ZW                   SETC  '&ZW.1'                                     00198100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00198200
                      AGO   .ZI5C                                       00198300
.*                                                                      00198400
.ZI5A                 ANOP  ,                                           00198500
&ZW                   SETC  '&ZW.0'                                     00198600
.ZI5C                 ANOP  ,                                           00198700
.*-------------------------------------------------------------------   00198800
.***AI.L08 XMACROOPTIONS "INDATAKEY"                                    00198900
.***      BL1'XX1XXXXX'                                                 00199000
         AIF   ('&INDATAKEY' EQ '').ZI6A                                00199100
&ZW                   SETC  '&ZW.1'                                     00199200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00199300
                      AGO   .ZI6C                                       00199400
.*                                                                      00199500
.ZI6A                 ANOP  ,                                           00199600
&ZW                   SETC  '&ZW.0'                                     00199700
.ZI6C                 ANOP  ,                                           00199800
.*-------------------------------------------------------------------   00199900
.***AI.L08 XMACROOPTIONS "OUTDATAKEY"                                   00200000
.***      BL1'XXX1XXXX'                                                 00200100
         AIF   ('&OUTDATAKEY' EQ '').ZI7A                               00200200
&ZW                   SETC  '&ZW.1'                                     00200300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00200400
                      AGO   .ZI7C                                       00200500
.*                                                                      00200600
.ZI7A                 ANOP  ,                                           00200700
&ZW                   SETC  '&ZW.0'                                     00200800
.ZI7C                 ANOP  ,                                           00200900
.*-------------------------------------------------------------------   00201000
.***AI.L08 XMACROOPTIONS "INDATA"                                       00201100
.***      BL1'XXXX1XXX'                                                 00201200
         AIF   ('&INDATA' EQ '').ZI8A                                   00201300
&ZW                   SETC  '&ZW.1'                                     00201400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00201500
                      AGO   .ZI8C                                       00201600
.*                                                                      00201700
.ZI8A                 ANOP  ,                                           00201800
&ZW                   SETC  '&ZW.0'                                     00201900
.ZI8C                 ANOP  ,                                           00202000
.*-------------------------------------------------------------------   00202100
.***AI.L08 XMACROOPTIONS "OUTDATA"                                      00202200
.***      BL1'XXXXX1XX'                                                 00202300
         AIF   ('&OUTDATA' EQ '').ZI9A                                  00202400
&ZW                   SETC  '&ZW.100'                                   00202500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00202600
                      AGO   .ZI9C                                       00202700
.*                                                                      00202800
.ZI9A                 ANOP  ,                                           00202900
&ZW                   SETC  '&ZW.000'                                   00203000
.ZI9C                 ANOP  ,                                           00203100
.*-------------------------------------------------------------------   00203200
.***AI.L11 XMACROOPTIONS BL1                                            00203300
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00203400
&ZOPN                 SETA  &ZOPN+1                                     00203500
&ZOPL(&ZOPN)          SETC  ' '                                         00203600
&ZOPO(&ZOPN)          SETC  'OI'                                        00203700
&ZOPV(&ZOPN)          SETC  '7(1),B''&ZW'''                             00203800
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             00203900
.ZI9E                 ANOP  ,                                           00204000
.*-------------------------------------------------------------------   00204100
.***AI.L18  XINDATAKEY XL1                                              00204200
         AIF   ('&XINDATAKEY' NE 'CALLER_KEY').ZI10                     00204300
&ZXINDATAKEY          SETC  ''             RESET INPUT/OUTPUT           00204400
.ZI10                 ANOP  ,                                           00204500
.*-------------------------------------------------------------------   00204600
.***AI.L25  XINDATAKEY XL1                                              00204700
                      AIF   ('&ZXINDATAKEY' EQ '').ZI10E                00204800
                      AIF   ('&ZXINDATAKEY' EQ 'OUTPUT').ZI10E          00204900
&ZCGPR                SETC  '&XINDATAKEY'                               00205000
.*                                                                      00205100
                      AIF   ('&XINDATAKEY'(1,1) NE '(').ZI10B           00205200
&ZCGPR   SETC  '0('.'&XINDATAKEY'(2,K'&XINDATAKEY-2).')'                00205300
                      AGO   .ZI10D                                      00205400
.ZI10B                ANOP  ,                                           00205500
.*                                                                      00205600
&ZC                   SETC  '&XINDATAKEY'(1,1)                          00205700
                      AIF   (T'&ZC NE 'N').ZI10D                        00205800
&ZC                   SETC  '&XINDATAKEY'                               00205900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00206000
&ZCGPR                SETC  '=AL1(&XINDATAKEY)'                         00206100
.*                                                                      00206200
.ZI10D                ANOP  ,                                           00206300
.*                                                                      00206400
&ZOPN                 SETA  &ZOPN+1                                     00206500
&ZOPL(&ZOPN)          SETC  ' '                                         00206600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00206700
&ZOPV(&ZOPN)          SETC  '8(1,1),&ZCGPR'                             00206800
&ZOPD(&ZOPN)          SETC  '++ &ZXINDATAKEY XINDATAKEY'                00206900
.*                                                                      00207000
.ZI10E                ANOP  ,                                           00207100
.*-------------------------------------------------------------------   00207200
.***AI.L18  XOUTDATAKEY XL1                                             00207300
         AIF   ('&XOUTDATAKEY' NE 'CALLER_KEY').ZI11                    00207400
&ZXOUTDATAKEY         SETC  ''             RESET INPUT/OUTPUT           00207500
.ZI11                 ANOP  ,                                           00207600
.*-------------------------------------------------------------------   00207700
.***AI.L25  XOUTDATAKEY XL1                                             00207800
                      AIF   ('&ZXOUTDATAKEY' EQ '').ZI11E               00207900
                      AIF   ('&ZXOUTDATAKEY' EQ 'OUTPUT').ZI11E         00208000
&ZCGPR                SETC  '&XOUTDATAKEY'                              00208100
.*                                                                      00208200
                      AIF   ('&XOUTDATAKEY'(1,1) NE '(').ZI11B          00208300
&ZCGPR   SETC  '0('.'&XOUTDATAKEY'(2,K'&XOUTDATAKEY-2).')'              00208400
                      AGO   .ZI11D                                      00208500
.ZI11B                ANOP  ,                                           00208600
.*                                                                      00208700
&ZC                   SETC  '&XOUTDATAKEY'(1,1)                         00208800
                      AIF   (T'&ZC NE 'N').ZI11D                        00208900
&ZC                   SETC  '&XOUTDATAKEY'                              00209000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00209100
&ZCGPR                SETC  '=AL1(&XOUTDATAKEY)'                        00209200
.*                                                                      00209300
.ZI11D                ANOP  ,                                           00209400
.*                                                                      00209500
&ZOPN                 SETA  &ZOPN+1                                     00209600
&ZOPL(&ZOPN)          SETC  ' '                                         00209700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00209800
&ZOPV(&ZOPN)          SETC  '9(1,1),&ZCGPR'                             00209900
&ZOPD(&ZOPN)          SETC  '++ &ZXOUTDATAKEY XOUTDATAKEY'              00210000
.*                                                                      00210100
.ZI11E                ANOP  ,                                           00210200
.*-------------------------------------------------------------------   00210300
.***AI.L05 XLOGONOPTIONS BL1                                            00210400
&ZW                   SETC  ''                                          00210500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00210600
.*-------------------------------------------------------------------   00210700
.***AI.L08 XLOGONOPTIONS "FAIL"                                         00210800
.***      BL1'1XXXXXXX'                                                 00210900
         AIF   ('&XLOGONOPTIONS' NE 'FAIL').ZI14A                       00211000
&ZW                   SETC  '&ZW.1'                                     00211100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00211200
                      AGO   .ZI14C                                      00211300
.*                                                                      00211400
.ZI14A                ANOP  ,                                           00211500
&ZW                   SETC  '&ZW.0'                                     00211600
.ZI14C                ANOP  ,                                           00211700
.*-------------------------------------------------------------------   00211800
.***AI.L08 XLOGONOPTIONS "USE_FIRST"                                    00211900
.***      BL1'X1XXXXXX'                                                 00212000
         AIF   ('&XLOGONOPTIONS' NE 'USE_FIRST').ZI15A                  00212100
&ZW                   SETC  '&ZW.1000000'                               00212200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00212300
                      AGO   .ZI15C                                      00212400
.*                                                                      00212500
.ZI15A                ANOP  ,                                           00212600
&ZW                   SETC  '&ZW.0000000'                               00212700
.ZI15C                ANOP  ,                                           00212800
.*-------------------------------------------------------------------   00212900
.***AI.L11 XLOGONOPTIONS BL1                                            00213000
                      AIF   ('&ZCLNG' NE 'YES').ZI15E  ALL ZERO BITS    00213100
&ZOPN                 SETA  &ZOPN+1                                     00213200
&ZOPL(&ZOPN)          SETC  ' '                                         00213300
&ZOPO(&ZOPN)          SETC  'OI'                                        00213400
&ZOPV(&ZOPN)          SETC  '11(1),B''&ZW'''                            00213500
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00213600
.ZI15E                ANOP  ,                                           00213700
.*-------------------------------------------------------------------   00213800
.***AI.L25  XUSERID CL8                                                 00213900
                      AIF   ('&ZXUSERID' EQ '').ZI16E                   00214000
                      AIF   ('&ZXUSERID' EQ 'OUTPUT').ZI16E             00214100
&ZCGPR                SETC  '&XUSERID'                                  00214200
.*                                                                      00214300
                      AIF   ('&XUSERID'(1,1) NE '(').ZI16B              00214400
&ZCGPR   SETC  '0('.'&XUSERID'(2,K'&XUSERID-2).')'                      00214500
.ZI16B                ANOP  ,                                           00214600
.*                                                                      00214700
&ZOPN                 SETA  &ZOPN+1                                     00214800
&ZOPL(&ZOPN)          SETC  ' '                                         00214900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00215000
&ZOPV(&ZOPN)          SETC  '12(8,1),&ZCGPR'                            00215100
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERID XUSERID'                      00215200
.*                                                                      00215300
.ZI16E                ANOP  ,                                           00215400
.*-------------------------------------------------------------------   00215500
.***AI.L25  XINDATA AL4                                                 00215600
                      AIF   ('&ZXINDATA' EQ '').ZI17E                   00215700
                      AIF   ('&ZXINDATA' EQ 'OUTPUT').ZI17E             00215800
&ZCGPR                SETC  '&XINDATA'                                  00215900
         AIF   ('&XINDATA' EQ '0').ZI17E                                00216000
         AIF   ('&XINDATA' EQ '0').ZI17E                                00216100
.*                                                                      00216200
                      AIF   ('&XINDATA'(1,1) NE '(').ZI17B              00216300
&ZCGPR   SETC  '0('.'&XINDATA'(2,K'&XINDATA-2).')'                      00216400
                      AGO   .ZI17D                                      00216500
.ZI17B                ANOP  ,                                           00216600
.*                                                                      00216700
&ZC                   SETC  '&XINDATA'(1,1)                             00216800
                      AIF   (T'&ZC NE 'N').ZI17D                        00216900
&ZC                   SETC  '&XINDATA'                                  00217000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI17D               00217100
&ZCGPR                SETC  '=AL4(&XINDATA)'                            00217200
.*                                                                      00217300
.ZI17D                ANOP  ,                                           00217400
.*                                                                      00217500
&ZOPN                 SETA  &ZOPN+1                                     00217600
&ZOPL(&ZOPN)          SETC  ' '                                         00217700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00217800
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00217900
&ZOPD(&ZOPN)          SETC  '++ &ZXINDATA XINDATA'                      00218000
.*                                                                      00218100
.ZI17E                ANOP  ,                                           00218200
.*-------------------------------------------------------------------   00218300
.***AI.L25  XINDATALEN F                                                00218400
                      AIF   ('&ZXINDATALEN' EQ '').ZI18E                00218500
                      AIF   ('&ZXINDATALEN' EQ 'OUTPUT').ZI18E          00218600
&ZCGPR                SETC  '&XINDATALEN'                               00218700
.*                                                                      00218800
                      AIF   ('&XINDATALEN'(1,1) NE '(').ZI18B           00218900
&ZCGPR   SETC  '0('.'&XINDATALEN'(2,K'&XINDATALEN-2).')'                00219000
                      AGO   .ZI18D                                      00219100
.ZI18B                ANOP  ,                                           00219200
.*                                                                      00219300
&ZC                   SETC  '&XINDATALEN'(1,1)                          00219400
                      AIF   (T'&ZC NE 'N').ZI18D                        00219500
&ZC                   SETC  '&XINDATALEN'                               00219600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               00219700
&ZCGPR                SETC  '=FL4''&XINDATALEN'''                       00219800
.*                                                                      00219900
.ZI18D                ANOP  ,                                           00220000
.*                                                                      00220100
&ZOPN                 SETA  &ZOPN+1                                     00220200
&ZOPL(&ZOPN)          SETC  ' '                                         00220300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00220400
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            00220500
&ZOPD(&ZOPN)          SETC  '++ &ZXINDATALEN XINDATALEN'                00220600
.*                                                                      00220700
.ZI18E                ANOP  ,                                           00220800
.*-------------------------------------------------------------------   00220900
.***AI.L25  XSYSTEM CL8                                                 00221000
                      AIF   ('&ZXSYSTEM' EQ '').ZI24E                   00221100
                      AIF   ('&ZXSYSTEM' EQ 'OUTPUT').ZI24E             00221200
&ZCGPR                SETC  '&XSYSTEM'                                  00221300
.*                                                                      00221400
                      AIF   ('&XSYSTEM'(1,1) NE '(').ZI24B              00221500
&ZCGPR   SETC  '0('.'&XSYSTEM'(2,K'&XSYSTEM-2).')'                      00221600
.ZI24B                ANOP  ,                                           00221700
.*                                                                      00221800
&ZOPN                 SETA  &ZOPN+1                                     00221900
&ZOPL(&ZOPN)          SETC  ' '                                         00222000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00222100
&ZOPV(&ZOPN)          SETC  '12(8,1),&ZCGPR'                            00222200
&ZOPD(&ZOPN)          SETC  '++ &ZXSYSTEM XSYSTEM'                      00222300
.*                                                                      00222400
.ZI24E                ANOP  ,                                           00222500
.*-------------------------------------------------------------------   00222600
&ZOPN1                SETA &ZOPN                                        00222700
.*******************************************************************    00222800
.***  PROCESS IXZXTSOI OUTPUT PARAMETERS                                00222900
.*******************************************************************    00223000
                      ACTR  10000                                       00223100
.*------------------------------------------------------------------    00223200
.***AO.L02 XOUTDATA A                                                   00223300
         AIF   ('&ZXOUTDATA' EQ 'OUTPUT').ZO19A  OUTPUT                 00223400
         AIF   ('&ZXOUTDATA' NE 'INOUT').ZO19C  INOUT                   00223500
.ZO19A    AIF   ('&XOUTDATA'(1,1) NE '(').ZO19B  ADDR IN GPR            00223600
&ZCGPR   SETC  '&XOUTDATA'(2,K'&XOUTDATA-2)                             00223700
&ZOPN                 SETA  &ZOPN+1                                     00223800
&ZOPL(&ZOPN)          SETC  ' '                                         00223900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00224000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),28(1)'                         00224100
&ZOPD(&ZOPN)          SETC  '++ XOUTDATA A'                             00224200
                      AGO   .ZO19C                                      00224300
.*                                                                      00224400
.ZO19B                ANOP  ,                                           00224500
&ZAWRK   SETA  K'&XOUTDATA                                              00224600
         AIF   ('&XOUTDATA'(&ZAWRK,1) NE ')').ZO19G                     00224700
&ZN      SETA  2                                                        00224800
.ZO19H    ANOP                                                          00224900
         AIF   (&ZN GE &ZAWRK).ZO19G                                    00225000
         AIF   ('&XOUTDATA'(&ZN,1) NE '(').ZO19I                        00225100
&ZC      SETC  '&XOUTDATA'(1,&ZN).'4'.','                               00225200
&ZC      SETC  '&ZC'.'&XOUTDATA'(&ZN+1,&ZAWRK-&ZN).',28(1)'             00225300
         AGO   .ZO19J                                                   00225400
.ZO19I    ANOP                                                          00225500
&ZN      SETA  &ZN+1                                                    00225600
         AGO   .ZO19H                                                   00225700
.ZO19G    ANOP                                                          00225800
&ZC      SETC  '&XOUTDATA.(4),28(1)'                                    00225900
.ZO19J    ANOP                                                          00226000
&ZOPN                 SETA  &ZOPN+1                                     00226100
&ZOPL(&ZOPN)          SETC  ' '                                         00226200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00226300
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00226400
&ZOPD(&ZOPN)          SETC  '++ XOUTDATA A'                             00226500
.ZO19C                ANOP  ,                                           00226600
.*------------------------------------------------------------------    00226700
.***AO.L02 XOUTDATALEN F                                                00226800
         AIF   ('&ZXOUTDATALEN' EQ 'OUTPUT').ZO20A  OUTPUT              00226900
         AIF   ('&ZXOUTDATALEN' NE 'INOUT').ZO20C  INOUT                00227000
.ZO20A    AIF   ('&XOUTDATALEN'(1,1) NE '(').ZO20B  ADDR IN GPR         00227100
&ZCGPR   SETC  '&XOUTDATALEN'(2,K'&XOUTDATALEN-2)                       00227200
&ZOPN                 SETA  &ZOPN+1                                     00227300
&ZOPL(&ZOPN)          SETC  ' '                                         00227400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00227500
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),32(1)'                         00227600
&ZOPD(&ZOPN)          SETC  '++ XOUTDATALEN F'                          00227700
                      AGO   .ZO20C                                      00227800
.*                                                                      00227900
.ZO20B                ANOP  ,                                           00228000
&ZAWRK   SETA  K'&XOUTDATALEN                                           00228100
         AIF   ('&XOUTDATALEN'(&ZAWRK,1) NE ')').ZO20G                  00228200
&ZN      SETA  2                                                        00228300
.ZO20H    ANOP                                                          00228400
         AIF   (&ZN GE &ZAWRK).ZO20G                                    00228500
         AIF   ('&XOUTDATALEN'(&ZN,1) NE '(').ZO20I                     00228600
&ZC      SETC  '&XOUTDATALEN'(1,&ZN).'4'.','                            00228700
&ZC      SETC  '&ZC'.'&XOUTDATALEN'(&ZN+1,&ZAWRK-&ZN).',32(1)'          00228800
         AGO   .ZO20J                                                   00228900
.ZO20I    ANOP                                                          00229000
&ZN      SETA  &ZN+1                                                    00229100
         AGO   .ZO20H                                                   00229200
.ZO20G    ANOP                                                          00229300
&ZC      SETC  '&XOUTDATALEN.(4),32(1)'                                 00229400
.ZO20J    ANOP                                                          00229500
&ZOPN                 SETA  &ZOPN+1                                     00229600
&ZOPL(&ZOPN)          SETC  ' '                                         00229700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00229800
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00229900
&ZOPD(&ZOPN)          SETC  '++ XOUTDATALEN F'                          00230000
.ZO20C                ANOP  ,                                           00230100
.*******************************************************************    00230200
.***AO.X02  RETURN CODE PROCESSING                                      00230300
.*******************************************************************    00230400
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00230500
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00230600
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00230700
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00230800
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00230900
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00231000
&ZOPN                 SETA  &ZOPN+1                                     00231100
&ZOPL(&ZOPN)          SETC  ' '                                         00231200
&ZOPO(&ZOPN)          SETC  'ST'                                        00231300
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00231400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00231500
                      AGO   .ZMRETX                                     00231600
.*                                                                      00231700
.ZMRET2               ANOP  ,                                           00231800
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00231900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00232000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00232100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00232200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00232300
&ZOPN                 SETA  &ZOPN+1                                     00232400
&ZOPL(&ZOPN)          SETC  ' '                                         00232500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00232600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00232700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00232800
.ZMRETX               ANOP  ,                                           00232900
.*******************************************************************    00233000
.***AO.X03  REASON CODE PROCESSING                                      00233100
.*******************************************************************    00233200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00233300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00233400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00233500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00233600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00233700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00233800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00233900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00234000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00234100
&ZOPN                 SETA  &ZOPN+1                                     00234200
&ZOPL(&ZOPN)          SETC  ' '                                         00234300
&ZOPO(&ZOPN)          SETC  'ST'                                        00234400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00234500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00234600
                      AGO   .ZMRSNX                                     00234700
.*                                                                      00234800
.ZMRSN2               ANOP  ,                                           00234900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00235000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00235100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00235200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00235300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00235400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00235500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00235600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00235700
&ZOPN                 SETA  &ZOPN+1                                     00235800
&ZOPL(&ZOPN)          SETC  ' '                                         00235900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00236000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00236100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00236200
.ZMRSNX               ANOP  ,                                           00236300
.*******************************************************************    00236400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00236500
.*******************************************************************    00236600
.ZMFLX                ANOP  ,              MF=L PROCESSING              00236700
.*******************************************************************    00236800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00236900
.*******************************************************************    00237000
                      ACTR  10000                                       00237100
.*                                                                      00237200
                      LCLA  &ZLC           COLUMN POSITION              00237300
                      LCLA  &ZOPX          LIST TABLE INDEX             00237400
                      LCLC  &ZLL           LABEL                        00237500
                      LCLC  &ZLOP          OPERATION                    00237600
                      LCLC  &ZLV           VALUE                        00237700
                      LCLC  &ZLD           DESCRIPTION                  00237800
.*                                                                      00237900
&ZOPX                 SETA  1                                           00238000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00238100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00238200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00238300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00238400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00238500
                      AIF   (K'&ZLD LE 0).ZL5                           00238600
&ZLC                  SETA  35             COMMENT COLUMN               00238700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00238800
&ZLC                  SETA  33             COMMMENT COLUMN              00238900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00239000
&ZLV                  SETC  '&ZLV'.' '                                  00239100
                      AGO   .ZL3                                        00239200
.*                                                                      00239300
.ZL4                  ANOP  ,                                           00239400
&ZLV                  SETC  '&ZLV'.' '                                  00239500
.ZL5                  ANOP  ,                                           00239600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00239700
.*                                                                      00239800
&ZLL     &ZLOP &ZLV                                                     00239900
.*                                                                      00240000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00240100
                      AGO   .ZL2           CONTINUE LOOPING             00240200
.*                                                                      00240300
.ZLX                  ANOP  ,                                           00240400
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00240500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00240600
.*                                                                      00240700
.*----------------------------------------------------------------      00240800
.*       Check whether either INDATA or OUTDATA accompanies             00240900
.*       USERID.  One of these must be specified if USERID is           00241000
.*       specified.                                                     00241100
.*----------------------------------------------------------------      00241200
.*                                                                      00241300
         AIF   (('&USERID' NE '')                                      +00241400
                AND ('&INDATA' EQ '') AND ('&OUTDATA' EQ '')).UIOREQ    00241500
         AGO   .EUSRCHK                                                 00241600
.*                                                                      00241700
.UIOREQ  ANOP                                                           00241800
         MNOTE 8,'INDATA OR OUTDATA REQUIRED WHEN USERID IS SPECIFIED'  00241900
         MEXIT                                                          00242000
.*                                                                      00242100
.EUSRCHK ANOP                                                           00242200
.*                                                                      00242300
&JXOKLAB SETC  'JXL&SYSNDX'      Generate a unique label                00242400
&TSOELAB SETC  'TSE&SYSNDX'      Generate a unique label                00242500
         L     14,16(0,0)        Load the CVT address                   00242600
         L     14,140(0,14)      Load the ECVT address                  00242700
         ICM   14,B'1111',284(14)  Get the JCCT address                 00242800
         BNZ   &JXOKLAB          There is one, continue                 00242900
         LA    15,40             Set JESXCF down reason code            00243000
         LA    0,4               Set unsuccessful return code           00243100
         B     &TSOELAB          Skip the PC                            00243200
&JXOKLAB DS    0H                                                       00243300
         L     14,40(0,14)       Load the PC number                     00243400
         PC    0(14)             Call the TSO GR routine                00243500
         AIF   ('&XMFCTRL'(1,1) NE '(').TSOI200                         00243600
         LR    1,&XMFCTRL         Restore the parameter list address    00243700
         AGO   .TSOI250                                                 00243800
.TSOI200 ANOP                                                           00243900
         LA    1,&XMFCTRL         Restore the parameter list address    00244000
.TSOI250 ANOP                                                           00244100
&TSOELAB DS    0H                                                       00244200
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00244300
.ZLINKX               ANOP  ,                                           00244400
.*******************************************************************    00244500
.***AP.X01  FORMAT GENERATED CODE                                       00244600
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00244700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00244800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00244900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00245000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00245100
                      AIF   (K'&ZLD LE 0).ZL51                          00245200
&ZLC                  SETA  35             COMMENT COLUMN               00245300
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00245400
&ZLC                  SETA  33             COMMENT COLUMN               00245500
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00245600
&ZLV                  SETC  '&ZLV'.' '                                  00245700
                      AGO   .ZL31                                       00245800
.*                                                                      00245900
.ZL41                 ANOP  ,                                           00246000
&ZLV                  SETC  '&ZLV'.' '                                  00246100
.ZL51                 ANOP  ,                                           00246200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00246300
.*                                                                      00246400
&ZLL     &ZLOP &ZLV                                                     00246500
.*                                                                      00246600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00246700
                      AGO   .ZL21          CONTINUE LOOPING             00246800
.*                                                                      00246900
.ZLX1                 ANOP  ,                                           00247000
.*******************************************************************    00247100
.***AP.X02  END OF IXZXTSOI MACRO                                       00247200
&ZIXZXTSOI            SETC  'YES'          SET IXZXTSOI USED            00247300
         POP   PRINT                                                    00247400
*                                            IXZXTSOI-1                 00247500
         SPACE 1                                                        00247600
.ZLX2                 ANOP  ,                                           00247700
         MEND                                                           00247800
**********************************************************************/ 00247900
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00248000
*%IXZXTSOI: MACRO KEYS(USERID,SYSTEM,INDATA,INDATALEN,INDATAKEY,        00248100
*                 OUTDATA,OUTDATALEN,OUTDATAKEY,LOGONOPTIONS,RTNCODE,   00248200
*                 RSNCODE,PLISTVER,MF);                                 00248300
*  ANS('?'!!MACLABEL!!' '!!'IXZPTSOI '!!MACLIST!!                       00248400
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00248500
*%END IXZXTSOI;                                                         00248600

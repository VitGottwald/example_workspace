*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXLUSYNC                              -01/13/18-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  XES User Sync Point Service                   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5645-001 COPYRIGHT IBM CORP. 1993, 1996                         * 00001200
*                                                                     * 00001300
* STATUS= JBB6602                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IXLUSYNC service routine is given control from the         * 00002100
*      IXLUSYNC macro. In order to use this service, the requestor    * 00002200
*      must be a connector to a structure and provide its contoken as * 00002300
*      input. The following functions are supported:                  * 00002400
*                                                                     * 00002500
*                                                                     * 00002600
*      o   set a user event,                                          * 00002700
*                                                                     * 00002800
*      o   confirm a user event, or                                   * 00002900
*                                                                     * 00003000
*      o   confirm a user event and set the next user event if no     * 00003100
*          more confirmations are expected.                           * 00003200
*                                                                     * 00003300
*                                                                     * 00003400
*                                                                     * 00003500
*      Setting a user event and the confirmation of a user event by   * 00003600
*      all connections (i.e., a sync point) will be communicated to   * 00003700
*      connectors through the event exit.  The User Sync Point event  * 00003800
*      will be presented to the event exits of each connector in two  * 00003900
*      cases:  when a new user sync point event is set, and when all  * 00004000
*      confirmations are received for a user sync point event, i.e.,  * 00004100
*      a sync point has been reached.                                 * 00004200
*                                                                     * 00004300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00004400
*                                                                     * 00004500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004600
*                                                                     * 00004700
*01* ENVIRONMENT:                                                     * 00004800
*                                                                     * 00004900
*                                                                     * 00005000
*      Dispatchable unit mode: Task mode.                             * 00005100
*                                                                     * 00005200
*      Minimum authorization: Supervisor State or PKM allowing keys   * 00005300
*                        0-7.                                         * 00005400
*                                                                     * 00005500
*      AMODE:            31-bit.                                      * 00005600
*                                                                     * 00005700
*      ASC mode:         Primary or Access Register.                  * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*                        o   If in Access Register ASC mode, specify  * 00006100
*                            SYSSTATE ASCENV=AR before invoking this  * 00006200
*                            macro.                                   * 00006300
*                                                                     * 00006400
*                        o   Primary equal to the requestor's primary * 00006500
*                            at the time of connect.                  * 00006600
*                                                                     * 00006700
*                        o   Primary address space must be equal to   * 00006800
*                            the home address space; any secondary    * 00006900
*                            address space; any home address space.   * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*                                                                     * 00007300
*      Serialization:    Enabled.  Unlocked. No EUT FRR established.  * 00007400
*                                                                     * 00007500
*      Restrictions:                                                  * 00007600
*                                                                     * 00007700
*                        IXLUSYNC is not permitted when an EUT FRR is * 00007800
*                        established.                                 * 00007900
*                                                                     * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00008300
*                      GR2-GR13    Undefined                          * 00008400
*                      GR14-GR15   Reserved                           * 00008500
*                      AR0-AR1     Reserved                           * 00008600
*                      AR2-AR13    Undefined                          * 00008700
*                      AR14-AR15   Reserved                           * 00008800
*                                                                     * 00008900
*01* OUTPUT REGISTERS: GR0         Reason code if GR15 return code is * 00009000
*                                  non-zero                           * 00009100
*                      GR1         Unpredictable                      * 00009200
*                      GR2-GR13    Unchanged                          * 00009300
*                      GR14        Unpredictable                      * 00009400
*                      GR15        Return code                        * 00009500
*                      AR0-AR1     Unpredictable                      * 00009600
*                      AR2-AR13    Unchanged                          * 00009700
*                      AR14-AR15   Unpredictable                      * 00009800
*                                                                     * 00009900
*01* SYNTAX:                                                          * 00010000
*                                                                     * 00010100
*Ýxlabel¨  IXLUSYNC     CONTOKEN=xcontoken                            * 00010200
*                      ,USEREVENT=xuserevent                          * 00010300
*                    Ð ,REQUEST=SET                                   * 00010400
*                    !    Ý,USERSTATE=»xuserstate!ALL_ZEROESº¨        * 00010500
*                    Ô ,REQUEST=CONFIRM                               * 00010600
*                    !    Ý,COMPCODE=»xcompcode!0º¨                   * 00010700
*                    !   ÐÝ,PROXYRESPONSE=NO¨                         * 00010800
*                    !   ¿Ý,PROXYRESPONSE=YES                         * 00010900
*                    !         ,SUBJCONTOKEN                          * 00011000
*                    !                       =xsubjcontoken¨          * 00011100
*                    ¿ ,REQUEST=CONFIRMSET                            * 00011200
*                         Ý,COMPCODE=»xcompcode!0º¨                   * 00011300
*                          ,NEXTUSEREVENT=xnextuserevent              * 00011400
*                         Ý,USERSTATE=»xuserstate!ALL_ZEROESº¨        * 00011500
*                        ÐÝ,PROXYRESPONSE=NO¨                         * 00011600
*                        ¿Ý,PROXYRESPONSE=YES                         * 00011700
*                              ,SUBJCONTOKEN                          * 00011800
*                                            =xsubjcontoken¨          * 00011900
*                     Ý,RETCODE=xretcode¨                             * 00012000
*                     Ý,RSNCODE=xrsncode¨                             * 00012100
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00012200
*                    ÐÝ,MF=S¨                                         * 00012300
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00012400
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*      Where:                                                         * 00012800
*                                                                     * 00012900
*                                                                     * 00013000
*      Ýxlabel¨                                                       * 00013100
*          is an optional symbol, starting in column 1, that is the   * 00013200
*          name on the IXLUSYNC macro invocation.  The name must      * 00013300
*          conform to the rules for an ordinary assembler language    * 00013400
*          symbol.                                                    * 00013500
*          DEFAULT: No name.                                          * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*                                                                     * 00014000
*      CONTOKEN=xcontoken                                             * 00014100
*          is the name (RS-type), or address in register (2)-(12), of * 00014200
*          a required 16 character input field that specifies the     * 00014300
*          connect token of the responding connection.                * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*      USEREVENT=xuserevent                                           * 00014900
*          is the name (RS-type), or address in register (2)-(12), of * 00015000
*          a required fullword input that specifies the user event    * 00015100
*          associated with this request. The user event must be       * 00015200
*          non-zero.                                                  * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*      REQUEST=»SET!CONFIRM!CONFIRMSETº                               * 00015800
*          is a required keyword input which identifies the type of   * 00015900
*          user sync point request.                                   * 00016000
*                                                                     * 00016100
*                                                                     * 00016200
*          REQUEST=SET                                                * 00016300
*              Set the user event. Only one user sync point event can * 00016400
*              be set at a time. When setting an event, a previous    * 00016500
*              event, if there was one, must have been confirmed by   * 00016600
*              all connectors and all connectors must have been told  * 00016700
*              about the completion of the user sync point through    * 00016800
*              their event exit.  If the user event is successfully   * 00016900
*              set, the User Sync Point event will be presented to    * 00017000
*              the event exit of each connector notifying each        * 00017100
*              connector of the user event.  The following data will  * 00017200
*              be presented to each connector in the event exit       * 00017300
*              parameter list:                                        * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*              o   EeplCompletedUserEvent will be zero.               * 00017700
*                                                                     * 00017800
*              o   EeplNextUserEvent will be set to the value         * 00017900
*                  specified by the USEREVENT keyword.                * 00018000
*                                                                     * 00018100
*              o   EeplCompletedUserState will be set to zero.        * 00018200
*                                                                     * 00018300
*              o   EeplNextUserState will be set to the value         * 00018400
*                  specified by the USERSTATE keyword or zero if      * 00018500
*                  USERSTATE is not specified.                        * 00018600
*                                                                     * 00018700
*              o   EeplCompletedUserCompcode will be set to zero.     * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*              ÝUSERSTATE=»xuserstate!ALL_ZEROESº¨                    * 00019300
*                  is the name (RS-type), or address in register      * 00019400
*                  (2)-(12), of an optional 32 character input that   * 00019500
*                  specifies a user defined value to be presented to  * 00019600
*                  the event exit. If this value is not provided,     * 00019700
*                  zeros will be presented.  The user state presented * 00019800
*                  to the event exit is from the connector that       * 00019900
*                  successfully set the user event.                   * 00020000
*                  DEFAULT: ALL_ZEROES                                * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*          REQUEST=CONFIRM                                            * 00020500
*              Confirm the user event specified by the USEREVENT      * 00020600
*              keyword.  When all confirmations have been received,   * 00020700
*              the User Sync Point event will be presented to the     * 00020800
*              event exit of each connector notifying each connector  * 00020900
*              that a sync point has been reached.  The following     * 00021000
*              data will be presented to each connector in the event  * 00021100
*              exit parameter list:                                   * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*              o   EeplCompletedUserEvent will be set to the value    * 00021500
*                  specified by the USEREVENT keyword.                * 00021600
*                                                                     * 00021700
*              o   EeplNextUserEvent will be set to zero.             * 00021800
*                                                                     * 00021900
*              o   EeplCompletedUserState will be set to the value    * 00022000
*                  specified when the event was set.                  * 00022100
*                                                                     * 00022200
*              o   EeplNextUserState will be set to zero.             * 00022300
*                                                                     * 00022400
*              o   EeplCompletedUserCompcode will be set to the       * 00022500
*                  highest user completion code value that was        * 00022600
*                  specified by any confirming connector.  Note that  * 00022700
*                  if a connector fails or disconnects while XES is   * 00022800
*                  expecting a user sync point confirmation to be     * 00022900
*                  provided by that connector,  XES will implicitly   * 00023000
*                  confirm for the failing connector with a           * 00023100
*                  completion code of X'0000FFFF'.                    * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*              ÝCOMPCODE=»xcompcode!0º¨                               * 00023700
*                  is the name (RS-type), or address in register      * 00023800
*                  (2)-(12), of an optional fullword input that       * 00023900
*                  specifies a user defined completion code value.    * 00024000
*                  When the sync point is reached,  the highest       * 00024100
*                  completion code that was set by any confirming     * 00024200
*                  connector will be presented to the event exit.  If * 00024300
*                  this value is not provided,  a default value of    * 00024400
*                  zero will be used for this connector.  Note that   * 00024500
*                  when a connector disconnects or fails at a time    * 00024600
*                  when he owes a user sync point confirmation,  XES  * 00024700
*                  will implicitly confirm the user sync point for    * 00024800
*                  that user with a completion code of X'0000FFFF'.   * 00024900
*                  If a given user completion code is to take         * 00025000
*                  precedence over this completion code,  it must be  * 00025100
*                  higher than X'0000FFFF'.  On the other hand,  if   * 00025200
*                  the implicit completion code is to take precedence * 00025300
*                  over a given user completion code,  it must be     * 00025400
*                  less than X'0000FFFF'.                             * 00025500
*                  DEFAULT: 0                                         * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*              ÝPROXYRESPONSE=»NO!YESº¨                               * 00026100
*                  is an optional keyword input that indicates        * 00026200
*                  whether this response is being provided on behalf  * 00026300
*                  of a failing connector.                            * 00026400
*                  DEFAULT: NO                                        * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                  ÝPROXYRESPONSE=NO¨                                 * 00026800
*                      indicates that this is not a proxy response.   * 00026900
*                      The response is on behalf of the connector     * 00027000
*                      described by the CONTOKEN keyword.             * 00027100
*                                                                     * 00027200
*                  ÝPROXYRESPONSE=YES                                 * 00027300
*                      indicates that this is a proxy response. The   * 00027400
*                      response is being provided on behalf of the    * 00027500
*                      connector described by the SUBJCONTOKEN        * 00027600
*                      keyword.                                       * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*                      SUBJCONTOKEN=xsubjcontoken¨                    * 00028000
*                          is the name (RS-type), or address in       * 00028100
*                          register (2)-(12), of a required 16        * 00028200
*                          character input field that designates the  * 00028300
*                          connector for whom the response is being   * 00028400
*                          provided. The subject connector must be in * 00028500
*                          the failing state. This implies that a     * 00028600
*                          proxy response should not be provided on   * 00028700
*                          behalf of a connector until after the      * 00028800
*                          EEPLDISFAILCONNECTION event for the        * 00028900
*                          subject user has been presented to the     * 00029000
*                          Event exit of the issuing connector.  The  * 00029100
*                          issuing connector may subsequently use the * 00029200
*                          value of the EEPLSUBJCONTOKEN field from   * 00029300
*                          that invocation of the event exit as input * 00029400
*                          for this keyword.  Note, if the subject    * 00029500
*                          connector is not in the failing state, the * 00029600
*                          request will fail with return and reason   * 00029700
*                          codes indicating the error.                * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*          REQUEST=CONFIRMSET                                         * 00030600
*              Confirm the user event specified by the USEREVENT      * 00030700
*              keyword, and if this confirmation is the last, set the * 00030800
*              user event to the value specified by the NEXTUSEREVENT * 00030900
*              keyword.  When all confirmations have been received,   * 00031000
*              the User Sync Point event will be presented to the     * 00031100
*              event exit of each connector notifying each connector  * 00031200
*              that a sync point has been reached.  The next user     * 00031300
*              event will also be presented to the connectors.  The   * 00031400
*              following data will be presented to each connector in  * 00031500
*              the event exit parameter list:                         * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*              o   EeplCompletedUserEvent will be set to the value    * 00031900
*                  specified by the USEREVENT keyword.                * 00032000
*                                                                     * 00032100
*              o   EeplNextUserEvent will be set to the value         * 00032200
*                  specified by NEXTUSEREVENT.                        * 00032300
*                                                                     * 00032400
*              o   EeplCompletedUserState will be set to the user     * 00032500
*                  state specified by the connector that set the      * 00032600
*                  event.                                             * 00032700
*                                                                     * 00032800
*              o   EeplNextUserState will be set to the value         * 00032900
*                  specified by the USERSTATE keyword or zero if      * 00033000
*                  USERSTATE is not specified.                        * 00033100
*                                                                     * 00033200
*              o   EeplCompletedUserCompcode will be set to the       * 00033300
*                  highest user completion code value that was        * 00033400
*                  specified by any confirming connector.  Note that  * 00033500
*                  if a connector fails or disconnects while XES is   * 00033600
*                  expecting a user sync point confirmation to be     * 00033700
*                  provided by that connector,  XES will implicitly   * 00033800
*                  confirm for the failing connector with a           * 00033900
*                  completion code of X'0000FFFF'.                    * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*              ÝCOMPCODE=»xcompcode!0º¨                               * 00034500
*                  is the name (RS-type), or address in register      * 00034600
*                  (2)-(12), of an optional fullword input that       * 00034700
*                  specifies a user defined completion code value.    * 00034800
*                  When the sync point is reached,  the highest       * 00034900
*                  completion code that was set by any confirming     * 00035000
*                  connector will be presented to the event exit.  If * 00035100
*                  this value is not provided,  a default value of    * 00035200
*                  zero will be used for this connector.  Note that   * 00035300
*                  specification of a nonzero user completion code    * 00035400
*                  does not prevent the next user sync point event    * 00035500
*                  from being set by this request.  Note that when a  * 00035600
*                  connector disconnects or fails at a time when he   * 00035700
*                  owes a user sync point confirmation,  XES will     * 00035800
*                  implicitly confirm the user sync point for that    * 00035900
*                  user with a completion code of X'0000FFFF'.  If a  * 00036000
*                  given user completion code is to take precedence   * 00036100
*                  over this completion code,  it must be higher than * 00036200
*                  X'0000FFFF'.  On the other hand,  if the implicit  * 00036300
*                  completion code is to take precedence over a given * 00036400
*                  user completion code,  it must be less than        * 00036500
*                  X'0000FFFF'.                                       * 00036600
*                  DEFAULT: 0                                         * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*              NEXTUSEREVENT=xnextuserevent                           * 00037200
*                  is the name (RS-type), or address in register      * 00037300
*                  (2)-(12), of a required fullword input that        * 00037400
*                  specifies the next user event to be set.  The user * 00037500
*                  event must be non-zero.                            * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*              ÝUSERSTATE=»xuserstate!ALL_ZEROESº¨                    * 00038100
*                  is the name (RS-type), or address in register      * 00038200
*                  (2)-(12), of an optional 32 character input that   * 00038300
*                  specifies a user defined value to be presented to  * 00038400
*                  the event exit. If this value is not provided,     * 00038500
*                  zeros will be presented.  The user state presented * 00038600
*                  to the event exit is from the connector that       * 00038700
*                  successfully set the user event.                   * 00038800
*                  DEFAULT: ALL_ZEROES                                * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*              ÝPROXYRESPONSE=»NO!YESº¨                               * 00039400
*                  is an optional keyword input that indicates        * 00039500
*                  whether this response is being provided on behalf  * 00039600
*                  of a failing connector.                            * 00039700
*                  DEFAULT: NO                                        * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                  ÝPROXYRESPONSE=NO¨                                 * 00040100
*                      indicates that this is not a proxy response.   * 00040200
*                      The response is on behalf of the connector     * 00040300
*                      described by the CONTOKEN keyword.             * 00040400
*                                                                     * 00040500
*                  ÝPROXYRESPONSE=YES                                 * 00040600
*                      indicates that this is a proxy response. The   * 00040700
*                      response is being provided on behalf of the    * 00040800
*                      connector described by the SUBJCONTOKEN        * 00040900
*                      keyword.                                       * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*                      SUBJCONTOKEN=xsubjcontoken¨                    * 00041300
*                          is the name (RS-type), or address in       * 00041400
*                          register (2)-(12), of a required 16        * 00041500
*                          character input field that designates the  * 00041600
*                          connector for whom the response is being   * 00041700
*                          provided. The subject connector must be in * 00041800
*                          the failing state. This implies that a     * 00041900
*                          proxy response should not be provided on   * 00042000
*                          behalf of a connector until after the      * 00042100
*                          EEPLDISFAILCONNECTION event for the        * 00042200
*                          subject user has been presented to the     * 00042300
*                          Event exit of the issuing connector.  The  * 00042400
*                          issuing connector may subsequently use the * 00042500
*                          value of the EEPLSUBJCONTOKEN field from   * 00042600
*                          that invocation of the event exit as input * 00042700
*                          for this keyword.  Note, if the subject    * 00042800
*                          connector is not in the failing state, the * 00042900
*                          request will fail with return and reason   * 00043000
*                          codes indicating the error.                * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*                                                                     * 00043700
*                                                                     * 00043800
*                                                                     * 00043900
*                                                                     * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*      ÝRETCODE=xretcode¨                                             * 00044400
*          is the name (RS-type) of an optional fullword output       * 00044500
*          variable, or register (2)-(12) or (15), into which the     * 00044600
*          return code is to be copied from GPR 15.  If you specify   * 00044700
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00044800
*          the value will be left in GPR 15.                          * 00044900
*                                                                     * 00045000
*                                                                     * 00045100
*                                                                     * 00045200
*                                                                     * 00045300
*      ÝRSNCODE=xrsncode¨                                             * 00045400
*          is the name (RS-type) of an optional fullword output       * 00045500
*          variable into which the reason code is to be copied from   * 00045600
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00045700
*          R0 (within or without parentheses), the value will be left * 00045800
*          in GPR 0.                                                  * 00045900
*                                                                     * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*                                                                     * 00046300
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00046400
*          is an optional byte input decimal value in the "0-2" range * 00046500
*          that specifies the macro version.  PLISTVER is the only    * 00046600
*          key allowed on the list form of MF and determines which    * 00046700
*          parameter list is generated.  The macro keys associated    * 00046800
*          with each supported version of the macro are listed in     * 00046900
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00047000
*          instead of a number, and the parameter list will be of the * 00047100
*          largest size currently supported. This size may grow from  * 00047200
*          release to release (thus possibly affecting the amount of  * 00047300
*          storage needed by your program).  If your program can      * 00047400
*          tolerate this, IBM recommends that you always specify MAX  * 00047500
*          when creating the list form parameter list as that will    * 00047600
*          ensure that the list form parameter list is always long    * 00047700
*          enough to hold whatever parameters might be specified on   * 00047800
*          the execute form.                                          * 00047900
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00048000
*          default is the lowest version which allows all of the      * 00048100
*          parameters specified on the invocation to be processed.    * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*      ÝMF=»S!L!Eº¨                                                   * 00048700
*          is an optional keyword input which specifies the macro     * 00048800
*          form.                                                      * 00048900
*          DEFAULT: S                                                 * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*          ÝMF=S¨                                                     * 00049300
*              specifies the standard form of the macro.  The "S"     * 00049400
*              form generates code to put the parameters into an      * 00049500
*              in-line parameter list and invoke the desired service. * 00049600
*              Full checking for required macro keys is done along    * 00049700
*              with supplying defaults for omitted optional           * 00049800
*              parameters.                                            * 00049900
*                                                                     * 00050000
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00050100
*              specifies the list form of the macro.  The "L" form    * 00050200
*              defines an area to be used for the parameter list.     * 00050300
*              Only the PLISTVER key may be specified on the          * 00050400
*              invocation.  All other macro parameters are flagged as * 00050500
*              errors.  If PLISTVER is not specified, the original    * 00050600
*              parameter list definition is used.                     * 00050700
*                                                                     * 00050800
*            ,xmfctrl                                                 * 00050900
*              is a required input.  It is the name of a storage area * 00051000
*              for the parameter list.                                * 00051100
*                                                                     * 00051200
*            »,xmfattr!0Dº                                            * 00051300
*              is an optional 60 character input string that varies   * 00051400
*              from 1 to 60 characters. Use it to force boundary      * 00051500
*              alignment of the parameter list. Use only 0F or 0D.    * 00051600
*              DEFAULT: 0D which forces the parameter list to a       * 00051700
*              doubleword boundary.                                   * 00051800
*                                                                     * 00051900
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00052000
*              specifies the execute form of the macro.  The "E" form * 00052100
*              generates code to put the parameters into the          * 00052200
*              parameter list specified by xmfctrl and provides full  * 00052300
*              syntax checking with default setting.                  * 00052400
*                                                                     * 00052500
*            ,xmfctrl                                                 * 00052600
*              is a required input.  It is the name (RS-type), or     * 00052700
*              address in register (1)-(12), of a storage area for    * 00052800
*              the parameter list.                                    * 00052900
*                                                                     * 00053000
*            »,COMPLETEº                                              * 00053100
*              is an optional keyword input which specifies the       * 00053200
*              degree of macro parameter syntax checking.             * 00053300
*              DEFAULT: COMPLETE                                      * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*              COMPLETE                                               * 00053700
*                  Checking for required macro keys is done and       * 00053800
*                  defaults are supplied for omitted optional         * 00053900
*                  parameters.                                        * 00054000
*                                                                     * 00054100
*                                                                     * 00054200
*                                                                     * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*                                                                     * 00054700
*01* RETURN CODES:                                                    * 00054800
*                                                                     * 00054900
*                                                                     * 00055000
*       0         IXLUSYNC request successful.                        * 00055100
*                                                                     * 00055200
*       4         IXLUSYNC request processed, but additional          * 00055300
*                 information indicated by the reason code.           * 00055400
*                                                                     * 00055500
*                 HEX REASON   MEANING                                * 00055600
*                 CODE                                                * 00055700
*                                                                     * 00055800
*                                                                     * 00055900
*                 xxxx0417    IxlRsnCodeNotLastConfirmation:  For     * 00056000
*                             REQUEST=CONFIRMSET, the confirmation    * 00056100
*                             was processed, however, the next user   * 00056200
*                             event was not set because not all       * 00056300
*                             confirmations had been received.        * 00056400
*                                                                     * 00056500
*                 xxxx0420    IxlRsnCodeUsyncEventSet:  The user      * 00056600
*                             event specified has already been set by * 00056700
*                             a peer connection.                      * 00056800
*                                                                     * 00056900
*                                                                     * 00057000
*                                                                     * 00057100
*                                                                     * 00057200
*       8         IXLUSYNC parameter error                            * 00057300
*                                                                     * 00057400
*                 HEX REASON   MEANING                                * 00057500
*                 CODE                                                * 00057600
*                                                                     * 00057700
*                                                                     * 00057800
*                 xxxx0801    IxlRsnCodeBadParmlist:  Unable to       * 00057900
*                             access parameter list                   * 00058000
*                                                                     * 00058100
*                 xxxx0802    IxlRsnCodeBadParmlistAlet:  Parameter   * 00058200
*                             list ALET invalid                       * 00058300
*                                                                     * 00058400
*                 xxxx0804    IxlRsnCodeBadVersion#:  Invalid version * 00058500
*                             number in parameter list                * 00058600
*                                                                     * 00058700
*                 xxxx0806    IxlRsnCodeSrbMode:  The requestor is in * 00058800
*                             SRB mode.                               * 00058900
*                                                                     * 00059000
*                 xxxx0807    IxlRsnCodeNotEnabled:  Not enabled      * 00059100
*                                                                     * 00059200
*                 xxxx0809    IxlRsnCodePrimaryNotHome:  Primary ^=   * 00059300
*                             Home                                    * 00059400
*                                                                     * 00059500
*                 xxxx080A    IxlRsnCodeBadContoken:  Invalid         * 00059600
*                             contoken specified.  The contoken is    * 00059700
*                             invalid for one of the following        * 00059800
*                             reasons:  disconnect has occurred, EOT  * 00059900
*                             of the connector's task, input contoken * 00060000
*                             is not the contoken returned from       * 00060100
*                             IXLCONN, or the request was issued      * 00060200
*                             outside the connector's address space.  * 00060300
*                                                                     * 00060400
*                 xxxx0858    IxlRsnCodeBadUserEvent:  The value      * 00060500
*                             provided for the USEREVENT and          * 00060600
*                             NEXTUSEREVENT keywords must be nonzero. * 00060700
*                                                                     * 00060800
*                 xxxx0863    IxlRsnCodeTaskTerm:  Request rejected   * 00060900
*                             because the requesting task is going    * 00061000
*                             through termination. IXLUSYNC cannot be * 00061100
*                             issued from a resource manager.         * 00061200
*                                                                     * 00061300
*                                                                     * 00061400
*                                                                     * 00061500
*                                                                     * 00061600
*       C         IXLUSYNC request issued in an invalid environment.  * 00061700
*                                                                     * 00061800
*                 HEX REASON   MEANING                                * 00061900
*                 CODE                                                * 00062000
*                                                                     * 00062100
*                                                                     * 00062200
*                 xxxx0C37    IxlRsnCodeUserEventMismatch: For        * 00062300
*                             REQUEST=CONFIRM or REQUEST=CONFIRMSET,  * 00062400
*                             the user event specified did not match  * 00062500
*                             the currently defined user event.       * 00062600
*                                                                     * 00062700
*                 xxxx0C38    IxlRsnCodeUserMismatch:  A confirmation * 00062800
*                             was not expected from the responding    * 00062900
*                             connector.                              * 00063000
*                                                                     * 00063100
*                 xxxx0C3F    IxlRsnCodeConnNotDefined:  Requesting   * 00063200
*                             connection not defined.                 * 00063300
*                                                                     * 00063400
*                 xxxx0C40    IxlRsnCodeConnNotActive:  Requesting    * 00063500
*                             connection not active.                  * 00063600
*                                                                     * 00063700
*                 xxxx0C48    IxlRsnCodeSubjConnNotDefined:  Subject  * 00063800
*                             connector is not defined.               * 00063900
*                                                                     * 00064000
*                 xxxx0C4B    IxlRsnCodeUsyncEventNotSet:  For        * 00064100
*                             REQUEST=SET, the new user event was     * 00064200
*                             rejected because another event is still * 00064300
*                             set.  Either all confirmations have not * 00064400
*                             yet been received for the current event * 00064500
*                             or all connectors have not been         * 00064600
*                             notified of the previously completed    * 00064700
*                             event via the event exit.               * 00064800
*                                                                     * 00064900
*                 xxxx0C4F    IxlRsnCodeUsyncNoEventSet:  A request   * 00065000
*                             for CONFIRM or CONFIRMSET was rejected  * 00065100
*                             because no user event is currently set. * 00065200
*                                                                     * 00065300
*                 xxxx0C6D    IxlRsnCodeSubjConnNotFailing:  An       * 00065400
*                             attempt to respond by proxy on behalf   * 00065500
*                             of the connector identified by the      * 00065600
*                             value provided for the SUBJCONTOKEN     * 00065700
*                             keyword failed because the user is not  * 00065800
*                             in the failing state.                   * 00065900
*                                                                     * 00066000
*                 FFFFFFFF    IxlRsnCodeNotAvailable:  XES functions  * 00066100
*                             are not available.  This can be because * 00066200
*                             the hardware necessary to provide XES   * 00066300
*                             functions is not present.               * 00066400
*                                                                     * 00066500
*                                                                     * 00066600
*                                                                     * 00066700
*                                                                     * 00066800
*       10        Failure in XES processing.                          * 00066900
*                                                                     * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*01* REASON CODES:                                                    * 00067300
*                                                                     * 00067400
*       Reason codes, as appropriate, are defined under their         * 00067500
*       corresponding return code.  Reason code and return code       * 00067600
*       constants are defined within IXLYCON.                         * 00067700
*                                                                     * 00067800
*01* MODULE TYPE:  ASSEM MACRO                                        * 00067900
*                                                                     * 00068000
*02*   PROCESSOR:  ASSEM                                              * 00068100
*                                                                     * 00068200
*01* COMPONENT:  SCIXL                                                * 00068300
*                                                                     * 00068400
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00068500
*                                                                     * 00068600
*01* MACRO USAGE NOTES:                                               * 00068700
*                                                                     * 00068800
*                                                                     * 00068900
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00069000
*        global macro variable.  Any value other than 'NO' will       * 00069100
*        result in the macro expansion being printed.  The default is * 00069200
*        'YES'.  The following examples illustrate how the ZPRINT     * 00069300
*        variable should be set.                                      * 00069400
*                                                                     * 00069500
*                    GBLC &ZPRINT                                     * 00069600
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00069700
*                                                                     * 00069800
*                                                                     * 00069900
*    2.  The IXLUSYNC macro supports multiple versions. The macro key * 00070000
*        list  below  contains the version level in which the key was * 00070100
*        first  introduced.  Positionals  are  identified by the word * 00070200
*        'Positional'  followed by the numeric value of its position. * 00070300
*        Nested  positionals  are  preceded  by their outer key.  The * 00070400
*        lowest value represents the original version and the highest * 00070500
*        value  represents  the  most  recent version of the IXLUSYNC * 00070600
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00070700
*        least  as high as the highest version number of all the keys * 00070800
*        being used.                                                  * 00070900
*                                                                     * 00071000
*        VERSION   KEY                                                * 00071100
*                                                                     * 00071200
*              0      CONTOKEN                                        * 00071300
*                     NEXTUSEREVENT                                   * 00071400
*                     REQUEST                                         * 00071500
*                     USEREVENT                                       * 00071600
*                     USERSTATE                                       * 00071700
*              1      PROXYRESPONSE                                   * 00071800
*                     SUBJCONTOKEN                                    * 00071900
*              2      COMPCODE                                        * 00072000
*                                                                     * 00072100
*                                                                     * 00072200
*                                                                     * 00072300
*01* CHANGE ACTIVITY:                                                 * 00072400
*                                                                     * 00072500
*   Flag LineItem  FMID    Date   ID    Comment                       * 00072600
*                                                                     * 00072700
*    $L0=SYSLKSMG HBB5510 910925 PD00BG:  XES support                 * 00072800
*    $P1=PIG0867  HBB5510 930114 PD00BG:  Document EUT FRR            * 00072900
*                                         restriction                 * 00073000
*    $D1=DIG0074  HBB5510 930325 PD00BG:  Additional return codes     * 00073100
*    $P2=PIG5004  HBB5510 940112 PD00CJ:  Added reason code xxxx0804  * 00073200
*    $01=OW21596  HBB5520 960827 PD00HV:  ProxyResponse support       * 00073300
*    $02=OW20824  HBB5520 960606 PD00FR:  Usync/lossconn enhancements * 00073400
****** END OF SPECIFICATIONS *****************************************/ 00073500
*/********************************************************************* 00073600
         MACRO                                                          00073700
&XLABEL  IXLUSYNC &CONTOKEN=,&USEREVENT=,&REQUEST=,&USERSTATE=,        *00073800
               &COMPCODE=,&PROXYRESPONSE=,&SUBJCONTOKEN=,              *00073900
               &NEXTUSEREVENT=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=      00074000
.*                                                                      00074100
*                   MACDATE -01/13/18-<2>                               00074200
.*                                                                      00074300
.*******************************************************************    00074400
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00074500
.*******************************************************************    00074600
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00074700
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00074800
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00074900
.*                                                                      00075000
                   GBLC  &ZIXLUSYNC  YES=MACRO USED AT LEAST ONCE       00075100
.*******************************************************************    00075200
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00075300
.*******************************************************************    00075400
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00075500
                   LCLC  &ZCNDX      SYSNDX CHARACTERS                  00075600
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00075700
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00075800
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00075900
                   LCLA  &ZAWRK      USED AS A WORK AREA                00076000
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00076100
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00076200
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00076300
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00076400
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00076500
                   LCLC  &ZMAC_G     "G" or null                        00076600
&ZMAC_G            SETC  ''                                             00076700
                   LCLC  &ZMAC_LR                                       00076800
&ZMAC_LR           SETC  'LR'                                           00076900
                   LCLC  &ZMAC_L                                        00077000
&ZMAC_L            SETC  'L'                                            00077100
                   LCLC  &ZMAC_ST                                       00077200
&ZMAC_ST           SETC  'ST'                                           00077300
                   LCLC  &ZMAC_LLGT                                     00077400
&ZMAC_LLGT         SETC  'L'                                            00077500
                   LCLC  &ZMAC_LGR                                      00077600
&ZMAC_LGR          SETC  'LR'                                           00077700
                   LCLC  &ZMAC_LG                                       00077800
&ZMAC_LG           SETC  'L'                                            00077900
                   LCLC  &ZMAC_STG                                      00078000
&ZMAC_STG          SETC  'ST'                                           00078100
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00078200
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00078300
.*                                                                      00078400
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00078500
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00078600
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00078700
                   LCLC  &ZENDBASEPL            End of base PL          00078800
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00078900
.*******************************************************************    00079000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00079100
.*******************************************************************    00079200
                   LCLA  &ZI         INDEX FOR ARRAY                    00079300
                   LCLA  &ZJ         INDEX FOR PARMS                    00079400
                   LCLA  &ZK         INDEX FOR PARSE                    00079500
                   LCLA  &ZLO        LOW RANGE VALUE                    00079600
                   LCLA  &ZHI        HIGH RANGE VALUE                   00079700
                   LCLC  &ZW         WORK AREA FOR PARM                 00079800
.********************************************************************   00079900
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00080000
.********************************************************************   00080100
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00080200
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00080300
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00080400
                   GBLC  &SYSAM64    SYSSTATE AMODE64                   00080500
.*                                                                      00080600
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00080700
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00080800
                   SPLEVEL  TEST                                        00080900
.ZSYS2             ANOP  ,                                              00081000
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00081100
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00081200
                   SYSSTATE TEST                                        00081300
                   AGO   .ZSYS4                                         00081400
.ZSYS3             ANOP  ,                                              00081500
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00081600
.ZSYS4             ANOP  ,                                              00081700
                   AIF   ('&SYSAM64' NE 'YES').ZSYSN64                  00081800
&ZMAC_LLGT         SETC 'LLGT'                                          00081900
&ZMAC_LGR          SETC 'LGR'                                           00082000
&ZMAC_LG           SETC 'LG'                                            00082100
&ZMAC_STG          SETC 'STG'                                           00082200
.ZSYSN64           ANOP  ,                                              00082300
.*******************************************************************    00082400
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00082500
.*******************************************************************    00082600
                   LCLC  &XCONTOKEN  ++ NAME                            00082700
                   LCLC  &XUSEREVENT            ++ NAME                 00082800
                   LCLC  &XREQUEST   ++ VALUE                           00082900
                   LCLC  &XUSERSTATE            ++ NAME                 00083000
                   LCLC  &XCOMPCODE  ++ NAME                            00083100
                   LCLC  &XPROXYRESPONSE        ++ VALUE                00083200
                   LCLC  &XSUBJCONTOKEN         ++ NAME                 00083300
                   LCLC  &XNEXTUSEREVENT        ++ NAME                 00083400
                   LCLC  &XRETCODE   ++ NAME                            00083500
                   LCLC  &XRSNCODE   ++ NAME                            00083600
                   LCLA  &XPLISTVER  ++ VALUE                           00083700
                   LCLC  &XMF        ++ VALUE                           00083800
                   LCLC  &XMFCTRL    ++ NAME                            00083900
                   LCLC  &XMFATTR    ++ VALUE                           00084000
                   LCLC  &XMFSCK     ++ VALUE                           00084100
.*******************************************************************    00084200
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00084300
.*******************************************************************    00084400
                   LCLC  &ZXCONTOKEN            ++ INPUT NAME           00084500
                   LCLC  &ZXUSEREVENT           ++ INPUT NAME           00084600
                   LCLC  &ZXREQUEST  ++ INPUT VALUE                     00084700
                   LCLC  &ZXUSERSTATE           ++ INPUT NAME           00084800
                   LCLC  &ZXCOMPCODE            ++ INPUT NAME           00084900
                   LCLC  &ZXPROXYRESPONSE       ++ INPUT VALUE          00085000
                   LCLC  &ZXSUBJCONTOKEN        ++ INPUT NAME           00085100
                   LCLC  &ZXNEXTUSEREVENT       ++ INPUT NAME           00085200
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00085300
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00085400
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00085500
                   LCLC  &ZXMF       ++ INPUT VALUE                     00085600
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00085700
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00085800
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00085900
.********************************************************************   00086000
.***AC.PLV01  PROCESS PLISTVER                                      *   00086100
.********************************************************************   00086200
&XPLISTVER      SETA  0                                                 00086300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00086400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00086500
&XPLISTVER      SETA  2                                                 00086600
.ZPLV0          ANOP  ,                                                 00086700
.*                                                                      00086800
                AIF   ('&COMPCODE' EQ '').ZPLV1E                        00086900
                AIF   (&XPLISTVER GE 2).ZPLV1E                          00087000
&XPLISTVER      SETA  2                                                 00087100
.ZPLV1E         ANOP  ,                                                 00087200
.*                                                                      00087300
                AIF   ('&PROXYRESPONSE' EQ '').ZPLV2E                   00087400
                AIF   (&XPLISTVER GE 1).ZPLV2E                          00087500
&XPLISTVER      SETA  1                                                 00087600
.ZPLV2E         ANOP  ,                                                 00087700
.*                                                                      00087800
                AIF   ('&SUBJCONTOKEN' EQ '').ZPLV3E                    00087900
                AIF   (&XPLISTVER GE 1).ZPLV3E                          00088000
&XPLISTVER      SETA  1                                                 00088100
.ZPLV3E         ANOP  ,                                                 00088200
.*                                                                      00088300
                AIF   ('&COMPCODE' EQ '').ZPLV4E                        00088400
                AIF   (&XPLISTVER GE 2).ZPLV4E                          00088500
&XPLISTVER      SETA  2                                                 00088600
.ZPLV4E         ANOP  ,                                                 00088700
.*                                                                      00088800
                AIF   ('&PROXYRESPONSE' EQ '').ZPLV5E                   00088900
                AIF   (&XPLISTVER GE 1).ZPLV5E                          00089000
&XPLISTVER      SETA  1                                                 00089100
.ZPLV5E         ANOP  ,                                                 00089200
.*                                                                      00089300
                AIF   ('&SUBJCONTOKEN' EQ '').ZPLV6E                    00089400
                AIF   (&XPLISTVER GE 1).ZPLV6E                          00089500
&XPLISTVER      SETA  1                                                 00089600
.ZPLV6E         ANOP  ,                                                 00089700
.*                                                                      00089800
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00089900
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00090000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00090100
.*-------------------------------------------------------------------   00090200
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00090300
&ZMS            SETC  '"PLISTVER='                                      00090400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00090500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00090600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00090700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00090800
                AGO   .ZPVCK2                                           00090900
.ZPVCK3         ANOP  ,                                                 00091000
.*-------------------------------------------------------------------   00091100
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00091200
&ZMS            SETC  '"PLISTVER='                                      00091300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00091400
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00091500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00091600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00091700
                AGO   .ZPVCKE                                           00091800
.ZPVCK2         ANOP  ,                                                 00091900
.*-------------------------------------------------------------------   00092000
&ZCVAL          SETC  '&PLISTVER(1)'                                    00092100
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00092200
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00092300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00092400
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00092500
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00092600
.ZPVCK6         ANOP  ,                                                 00092700
&ZMS            SETC  '"PLISTVER='                                      00092800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00092900
&ZMS            SETC  '&ZMS THE RANGE IS "0-2"'                         00093000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00093100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00093200
&XPLISTVER      SETA  2                                                 00093300
                AGO   .ZPVCKE                                           00093400
.*-------------------------------------------------------------------   00093500
.ZPVCK4A        ANOP  ,                                                 00093600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00093700
&ZMS            SETC  'PLISTVER='                                       00093800
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00093900
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00094000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00094100
                MNOTE 8,' &ZMS IS REQUIRED.'                            00094200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00094300
                AGO   .ZPVCK5                                           00094400
.ZPVCK4         ANOP  ,                                                 00094500
&XPLISTVER      SETA  &PLISTVER(1)                                      00094600
.ZPVCK5         ANOP  ,                                                 00094700
.ZPVCKE         ANOP  ,                                                 00094800
.********************************************************************   00094900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00095000
.********************************************************************   00095100
                   ACTR  10000                                          00095200
.*------------------------------------------------------------------    00095300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095400
&XMF               SETC  ''          INITIALIZE XVARIABLE               00095500
.*-------------------------------------------------------------------   00095600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00095700
.ZG55              ANOP  ,                                              00095800
&ZTLC              SETC 'S'                                             00095900
                   AIF   ('&MF(1)' NE '&ZTLC').ZG56                     00096000
&XMF               SETC  'S'         SET KEYWORD                        00096100
                   AIF   (N'&MF LE 1).ZG55A     CK NUM                  00096200
&ZMS               SETC  '"MF='                                         00096300
&ZMS               SETC  '&ZMS.&MF"'                                    00096400
&ZMS               SETC  '&ZMS "MF"'                                    00096500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00096600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00096700
.ZG55A             ANOP  ,                                              00096800
.*-------------------------------------------------------------------   00096900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00097000
.ZG56              ANOP  ,                                              00097100
&ZTLC              SETC 'L'                                             00097200
                   AIF   ('&MF(1)' NE '&ZTLC').ZG63                     00097300
&XMF               SETC  'L'         SET KEYWORD                        00097400
                   AIF   (N'&MF LE 3).ZG56A     CK NUM                  00097500
&ZMS               SETC  '"MF='                                         00097600
&ZMS               SETC  '&ZMS.&MF"'                                    00097700
&ZMS               SETC  '&ZMS "MF"'                                    00097800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00097900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00098000
.ZG56A             ANOP  ,                                              00098100
.*-------------------------------------------------------------------   00098200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00098300
                   AIF   (N'&SYSLIST NE 0).ZG56B  POSITIONALS?          00098400
                   AIF   ('&CONTOKEN' NE '').ZG56B  KEYS?               00098500
                   AIF   ('&USEREVENT' NE '').ZG56B  KEYS?              00098600
                   AIF   ('&REQUEST' NE '').ZG56B  KEYS?                00098700
                   AIF   ('&USERSTATE' NE '').ZG56B  KEYS?              00098800
                   AIF   ('&COMPCODE' NE '').ZG56B  KEYS?               00098900
                   AIF   ('&PROXYRESPONSE' NE '').ZG56B  KEYS?          00099000
                   AIF   ('&SUBJCONTOKEN' NE '').ZG56B  KEYS?           00099100
                   AIF   ('&NEXTUSEREVENT' NE '').ZG56B  KEYS?          00099200
                   AIF   ('&RETCODE' NE '').ZG56B  KEYS?                00099300
                   AIF   ('&RSNCODE' NE '').ZG56B  KEYS?                00099400
                   AGO    .ZG56C     INVOCATION OKAY                    00099500
.ZG56B             ANOP  ,                                              00099600
&ZMS               SETC  'THE "L" FORM OF "MF"'                         00099700
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00099800
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00099900
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00100000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00100100
.ZG56C             ANOP  ,                                              00100200
.*-------------------------------------------------------------------   00100300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00100400
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00100500
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00100600
                   AIF   (N'&MF(2) GT 1).ZG58B  MULTI                   00100700
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00100800
.ZG58B             AIF   (K'&MF(2) GT 0).ZG58C                          00100900
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00101000
&ZMS               SETC  'WHEN "L" IS SPECIFIED'                        00101100
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00101200
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00101300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00101400
.ZG58C             ANOP  ,                                              00101500
.*-------------------------------------------------------------------   00101600
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00101700
                   AIF   (K'&ZXMFCTRL LE 0).ZG58P  NOT I/O              00101800
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG58P                 00101900
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00102000
&ZMS               SETC  '"MF='                                         00102100
&ZMS               SETC  '&ZMS.&MF"'                                    00102200
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00102300
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00102400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00102500
.ZG58P             ANOP  ,                                              00102600
.*-------------------------------------------------------------------   00102700
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00102800
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00102900
&XMFATTR           SETC  '0D'                                           00103000
                   AIF   (K'&MF(3) LE 0).ZG61B  PARM                    00103100
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00103200
                   AIF   (N'&MF(3) GT 1).ZG61B  MULTI                   00103300
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00103400
.ZG61B             ANOP  ,                                              00103500
.*-------------------------------------------------------------------   00103600
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00103700
                   AIF   (K'&ZXMFATTR LE 0).ZG61P  NOT I/O              00103800
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG61P                 00103900
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00104000
&ZMS               SETC  '"MF='                                         00104100
&ZMS               SETC  '&ZMS.&MF"'                                    00104200
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00104300
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00104400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00104500
.ZG61P             ANOP  ,                                              00104600
.*-------------------------------------------------------------------   00104700
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00104800
                   AIF   (K'&ZXMFATTR LE 0).ZG61S  NOT I/O              00104900
                   AIF   (K'&XMFATTR LE 60).ZG61S  LNG OK               00105000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00105100
&ZMS               SETC  '"MF='                                         00105200
&ZMS               SETC  '&ZMS.&MF"'                                    00105300
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00105400
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00105500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00105600
.ZG61S             ANOP  ,                                              00105700
.*-------------------------------------------------------------------   00105800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00105900
.ZG63              ANOP  ,                                              00106000
&ZTLC              SETC 'E'                                             00106100
                   AIF   ('&MF(1)' NE '&ZTLC').ZG71                     00106200
&XMF               SETC  'E'         SET KEYWORD                        00106300
                   AIF   (N'&MF LE 3).ZG63A     CK NUM                  00106400
&ZMS               SETC  '"MF='                                         00106500
&ZMS               SETC  '&ZMS.&MF"'                                    00106600
&ZMS               SETC  '&ZMS "MF"'                                    00106700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00106800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00106900
.ZG63A             ANOP  ,                                              00107000
.*-------------------------------------------------------------------   00107100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00107200
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00107300
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00107400
                   AIF   (N'&MF(2) GT 1).ZG65B  MULTI                   00107500
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00107600
.ZG65B             AIF   (K'&MF(2) GT 0).ZG65C                          00107700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00107800
&ZMS               SETC  'WHEN "E" IS SPECIFIED'                        00107900
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00108000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00108100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00108200
.ZG65C             ANOP  ,                                              00108300
.*-------------------------------------------------------------------   00108400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00108500
                   AIF   (K'&ZXMFCTRL LE 0).ZG65R  NOT I/O              00108600
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG65R                 00108700
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00108800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG65P                   00108900
                   AIF   (K'&ZCGPR GT 2).ZG65Q                          00109000
                   AIF   ('&ZCGPR' EQ '0').ZG65Q                        00109100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00109200
                   AIF   (T'&ZCGPR NE 'N').ZG65Q  INVALID REG NAME      00109300
.ZG65P             ANOP  ,                                              00109400
                   AIF   (T'&ZCGPR NE 'N').ZG65R  NON NUMERIC           00109500
                   AIF   ('&ZCGPR' LT '1').ZG65Q                        00109600
                   AIF   ('&ZCGPR' LE '12').ZG65R                       00109700
.ZG65Q             ANOP  ,                                              00109800
&ZMS               SETC  '"MF='                                         00109900
&ZMS               SETC  '&ZMS.&MF"'                                    00110000
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00110100
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00110200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00110300
.ZG65R             ANOP  ,                                              00110400
.*-------------------------------------------------------------------   00110500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00110600
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00110700
.ZG69A   AIF   ('&MF(3)' NE 'COMPLETE').ZG70A                           00110800
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00110900
.*-------------------------------------------------------------------   00111000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00111100
.ZG70A             AIF   (K'&XMFSCK GT 0).ZG70C  KEYWORD                00111200
                   AIF   (K'&MF(3) LE 0).ZG70B                          00111300
&ZMS               SETC  '"MF='                                         00111400
&ZMS               SETC  '&ZMS.&MF"'                                    00111500
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00111600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00111700
&ZMS               SETC  '&ZMS "COMPLETE".'                             00111800
                   MNOTE 8,' &ZMS '                                     00111900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00112000
.ZG70B             ANOP  ,                                              00112100
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00112200
.ZG70C             ANOP  ,                                              00112300
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00112400
.*------------------------------------------------------------------    00112500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112600
.ZG71              ANOP  ,                                              00112700
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00112800
                   AIF   (K'&XMF GT 0).ZG71E    VALID ARG               00112900
                   AIF   (T'&MF EQ 'O').ZG71D   OMITTED                 00113000
&ZASYSLNDX         SETA  0                                              00113100
.ZG71A             ANOP  ,           POSITIONAL MACRO KEY               00113200
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00113300
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG71C               00113400
&ZTLC              SETC 'MF'                                            00113500
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG71A      00113600
.ZG71B             ANOP  ,                                              00113700
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00113800
&ZMS               SETC  'THE "MF" KEY'                                 00113900
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00114000
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00114100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00114200
                   AGO   .ZG71E                                         00114300
.ZG71C             ANOP  ,                                              00114400
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00114500
&ZMS               SETC  '"MF='                                         00114600
&ZMS               SETC  '&ZMS.&MF"'                                    00114700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00114800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00114900
&ZMS               SETC  '&ZMS "S",'                                    00115000
&ZMS               SETC  '&ZMS "L",'                                    00115100
&ZMS               SETC  '&ZMS OR "E".'                                 00115200
                   MNOTE 8,' &ZMS '                                     00115300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00115400
                   AGO   .ZG71E                                         00115500
.ZG71D             ANOP  ,                                              00115600
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00115700
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00115800
.ZG71E             ANOP  ,                                              00115900
.********************************************************************   00116000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00116100
.********************************************************************   00116200
                   ACTR  10000                                          00116300
.*-------------------------------------------------------------------   00116400
.***AG.MF03 MF=(SLE)                                                    00116500
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00116600
.*----------------------------------------------------------------***   00116700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00116800
                   AIF   (N'&CONTOKEN LE 1).ZG2A  CK NUM                00116900
&ZMS               SETC  '"CONTOKEN='                                   00117000
&ZMS               SETC  '&ZMS.&CONTOKEN"'                              00117100
&ZMS               SETC  '&ZMS "CONTOKEN"'                              00117200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00117300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00117400
.ZG2A              ANOP  ,                                              00117500
.*-------------------------------------------------------------------   00117600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00117700
&ZXCONTOKEN        SETC  'INPUT'     SET IN/OUTPUT                      00117800
&XCONTOKEN         SETC  '&CONTOKEN(1)'         SET XVARIABLE           00117900
                   AIF   (N'&CONTOKEN GT 1).ZG2B  MULTI                 00118000
&XCONTOKEN         SETC  '&CONTOKEN'            SET XVARIABLE           00118100
.ZG2B              AIF   (K'&CONTOKEN(1) GT 0).ZG2C                     00118200
&ZXCONTOKEN        SETC  ''          RESET IN/OUTPUT                    00118300
&ZMS               SETC  ' '                                            00118400
&ZMS               SETC  '&ZMS "CONTOKEN" KEY AND ITS'                  00118500
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00118600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00118700
.ZG2C              ANOP  ,                                              00118800
.*-------------------------------------------------------------------   00118900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00119000
                   AIF   (K'&ZXCONTOKEN LE 0).ZG2R  NOT I/O             00119100
                   AIF   ('&XCONTOKEN'(1,1) NE '(').ZG2R                00119200
&ZCGPR             SETC  '&XCONTOKEN'(2,K'&XCONTOKEN-2)                 00119300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                    00119400
                   AIF   (K'&ZCGPR GT 2).ZG2Q                           00119500
                   AIF   ('&ZCGPR' EQ '0').ZG2Q                         00119600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00119700
                   AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME       00119800
.ZG2P              ANOP  ,                                              00119900
                   AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC            00120000
                   AIF   ('&ZCGPR' LT '2').ZG2Q                         00120100
                   AIF   ('&ZCGPR' LE '12').ZG2R                        00120200
.ZG2Q              ANOP  ,                                              00120300
&ZMS               SETC  '"CONTOKEN='                                   00120400
&ZMS               SETC  '&ZMS.&CONTOKEN"'                              00120500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00120600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00120700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00120800
.ZG2R              ANOP  ,                                              00120900
.*----------------------------------------------------------------***   00121000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00121100
                   AIF   (N'&USEREVENT LE 1).ZG5A  CK NUM               00121200
&ZMS               SETC  '"USEREVENT='                                  00121300
&ZMS               SETC  '&ZMS.&USEREVENT"'                             00121400
&ZMS               SETC  '&ZMS "USEREVENT"'                             00121500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00121600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00121700
.ZG5A              ANOP  ,                                              00121800
.*-------------------------------------------------------------------   00121900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00122000
&ZXUSEREVENT       SETC  'INPUT'     SET IN/OUTPUT                      00122100
&XUSEREVENT        SETC  '&USEREVENT(1)'        SET XVARIABLE           00122200
                   AIF   (N'&USEREVENT GT 1).ZG5B  MULTI                00122300
&XUSEREVENT        SETC  '&USEREVENT'           SET XVARIABLE           00122400
.ZG5B              AIF   (K'&USEREVENT(1) GT 0).ZG5C                    00122500
&ZXUSEREVENT       SETC  ''          RESET IN/OUTPUT                    00122600
&ZMS               SETC  ' '                                            00122700
&ZMS               SETC  '&ZMS "USEREVENT" KEY AND ITS'                 00122800
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00122900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00123000
.ZG5C              ANOP  ,                                              00123100
.*-------------------------------------------------------------------   00123200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00123300
                   AIF   (K'&ZXUSEREVENT LE 0).ZG5R  NOT I/O            00123400
                   AIF   ('&XUSEREVENT'(1,1) NE '(').ZG5R               00123500
&ZCGPR             SETC  '&XUSEREVENT'(2,K'&XUSEREVENT-2)               00123600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                    00123700
                   AIF   (K'&ZCGPR GT 2).ZG5Q                           00123800
                   AIF   ('&ZCGPR' EQ '0').ZG5Q                         00123900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00124000
                   AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME       00124100
.ZG5P              ANOP  ,                                              00124200
                   AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC            00124300
                   AIF   ('&ZCGPR' LT '2').ZG5Q                         00124400
                   AIF   ('&ZCGPR' LE '12').ZG5R                        00124500
.ZG5Q              ANOP  ,                                              00124600
&ZMS               SETC  '"USEREVENT='                                  00124700
&ZMS               SETC  '&ZMS.&USEREVENT"'                             00124800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00124900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00125000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00125100
.ZG5R              ANOP  ,                                              00125200
.*------------------------------------------------------------------    00125300
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00125400
&XREQUEST          SETC  ''          INITIALIZE XVARIABLE               00125500
.*-------------------------------------------------------------------   00125600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00125700
.ZG9               ANOP  ,                                              00125800
                   AIF   (K'&REQUEST(1) LE 0).ZG9A                      00125900
&ZTLC              SETC 'SET'                                           00126000
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG13                00126100
&XREQUEST          SETC  'SET'       SET KEYWORD                        00126200
                   AIF   (N'&REQUEST LE 1).ZG9A  CK NUM                 00126300
&ZMS               SETC  '"REQUEST='                                    00126400
&ZMS               SETC  '&ZMS.&REQUEST"'                               00126500
&ZMS               SETC  '&ZMS "REQUEST"'                               00126600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00126700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00126800
.ZG9A              ANOP  ,                                              00126900
.*------------------------------------------------------------------    00127000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127100
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00127200
.ZG9A0             AIF   (K'&COMPCODE LE 0).ZG9A1  OK                   00127300
&ZCVAL             SETC '&ZCVAL COMPCODE'       INCORRECT KEY USED      00127400
.ZG9A1             AIF   (K'&PROXYRESPONSE LE 0).ZG9A2  OK              00127500
&ZCVAL             SETC '&ZCVAL PROXYRESPONSE'  INCORRECT KEY USED      00127600
.ZG9A2             AIF   (K'&SUBJCONTOKEN LE 0).ZG9A3  OK               00127700
&ZCVAL             SETC '&ZCVAL SUBJCONTOKEN'   INCORRECT KEY USED      00127800
.ZG9A3             AIF   (K'&NEXTUSEREVENT LE 0).ZG9A4  OK              00127900
&ZCVAL             SETC '&ZCVAL NEXTUSEREVENT'  INCORRECT KEY USED      00128000
.ZG9A4             AIF   (K'&ZCVAL LE 0).ZG9A5  OK                      00128100
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00128200
&ZMS               SETC  '"REQUEST'                                     00128300
&ZMS               SETC  '&ZMS.=&REQUEST"'                              00128400
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00128500
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00128600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00128700
.ZG9A5             ANOP  ,                                              00128800
.*----------------------------------------------------------------***   00128900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00129000
                   AIF   (N'&USERSTATE LE 1).ZG11A  CK NUM              00129100
&ZMS               SETC  '"USERSTATE='                                  00129200
&ZMS               SETC  '&ZMS.&USERSTATE"'                             00129300
&ZMS               SETC  '&ZMS "USERSTATE"'                             00129400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00129500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00129600
.ZG11A             ANOP  ,                                              00129700
.*-------------------------------------------------------------------   00129800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00129900
&ZXUSERSTATE       SETC  'INPUT'     SET IN/OUTPUT                      00130000
&XUSERSTATE        SETC  'ALL_ZEROES'                                   00130100
                   AIF   (K'&USERSTATE(1) LE 0).ZG11B  PARM             00130200
&XUSERSTATE        SETC  '&USERSTATE(1)'        SET XVARIABLE           00130300
                   AIF   (N'&USERSTATE GT 1).ZG11B  MULTI               00130400
&XUSERSTATE        SETC  '&USERSTATE'           SET XVARIABLE           00130500
.ZG11B             ANOP  ,                                              00130600
.*-------------------------------------------------------------------   00130700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00130800
                   AIF   (K'&ZXUSERSTATE LE 0).ZG11R  NOT I/O           00130900
         AIF   ('&XUSERSTATE' EQ 'ALL_ZEROES').ZG11R                    00131000
                   AIF   ('&XUSERSTATE'(1,1) NE '(').ZG11R              00131100
&ZCGPR             SETC  '&XUSERSTATE'(2,K'&XUSERSTATE-2)               00131200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                   00131300
                   AIF   (K'&ZCGPR GT 2).ZG11Q                          00131400
                   AIF   ('&ZCGPR' EQ '0').ZG11Q                        00131500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00131600
                   AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME      00131700
.ZG11P             ANOP  ,                                              00131800
                   AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC           00131900
                   AIF   ('&ZCGPR' LT '2').ZG11Q                        00132000
                   AIF   ('&ZCGPR' LE '12').ZG11R                       00132100
.ZG11Q             ANOP  ,                                              00132200
&ZMS               SETC  '"USERSTATE='                                  00132300
&ZMS               SETC  '&ZMS.&USERSTATE"'                             00132400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00132500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00132600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00132700
.ZG11R             ANOP  ,                                              00132800
.*-------------------------------------------------------------------   00132900
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00133000
.ZG13              ANOP  ,                                              00133100
&ZTLC              SETC 'CONFIRM'                                       00133200
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG25                00133300
&XREQUEST          SETC  'CONFIRM'   SET KEYWORD                        00133400
                   AIF   (N'&REQUEST LE 1).ZG13A  CK NUM                00133500
&ZMS               SETC  '"REQUEST='                                    00133600
&ZMS               SETC  '&ZMS.&REQUEST"'                               00133700
&ZMS               SETC  '&ZMS "REQUEST"'                               00133800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00133900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00134000
.ZG13A             ANOP  ,                                              00134100
.*------------------------------------------------------------------    00134200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00134300
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00134400
.ZG13A0            AIF   (K'&USERSTATE LE 0).ZG13A1  OK                 00134500
&ZCVAL             SETC '&ZCVAL USERSTATE'      INCORRECT KEY USED      00134600
.ZG13A1            AIF   (K'&NEXTUSEREVENT LE 0).ZG13A2  OK             00134700
&ZCVAL             SETC '&ZCVAL NEXTUSEREVENT'  INCORRECT KEY USED      00134800
.ZG13A2            AIF   (K'&ZCVAL LE 0).ZG13A3  OK                     00134900
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00135000
&ZMS               SETC  '"REQUEST'                                     00135100
&ZMS               SETC  '&ZMS.=&REQUEST"'                              00135200
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00135300
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00135400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00135500
.ZG13A3            ANOP  ,                                              00135600
.*----------------------------------------------------------------***   00135700
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00135800
                   AIF   (N'&COMPCODE LE 1).ZG15A  CK NUM               00135900
&ZMS               SETC  '"COMPCODE='                                   00136000
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00136100
&ZMS               SETC  '&ZMS "COMPCODE"'                              00136200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00136300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00136400
.ZG15A             ANOP  ,                                              00136500
.*-------------------------------------------------------------------   00136600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00136700
&ZXCOMPCODE        SETC  'INPUT'     SET IN/OUTPUT                      00136800
&XCOMPCODE         SETC  '0'                                            00136900
                   AIF   (K'&COMPCODE(1) LE 0).ZG15B  PARM              00137000
&XCOMPCODE         SETC  '&COMPCODE(1)'         SET XVARIABLE           00137100
                   AIF   (N'&COMPCODE GT 1).ZG15B  MULTI                00137200
&XCOMPCODE         SETC  '&COMPCODE'            SET XVARIABLE           00137300
.ZG15B             ANOP  ,                                              00137400
.*-------------------------------------------------------------------   00137500
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00137600
                   AIF   (K'&ZXCOMPCODE LE 0).ZG15R  NOT I/O            00137700
         AIF   ('&XCOMPCODE' EQ '0').ZG15R                              00137800
                   AIF   ('&XCOMPCODE'(1,1) NE '(').ZG15R               00137900
&ZCGPR             SETC  '&XCOMPCODE'(2,K'&XCOMPCODE-2)                 00138000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                   00138100
                   AIF   (K'&ZCGPR GT 2).ZG15Q                          00138200
                   AIF   ('&ZCGPR' EQ '0').ZG15Q                        00138300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00138400
                   AIF   (T'&ZCGPR NE 'N').ZG15Q  INVALID REG NAME      00138500
.ZG15P             ANOP  ,                                              00138600
                   AIF   (T'&ZCGPR NE 'N').ZG15R  NON NUMERIC           00138700
                   AIF   ('&ZCGPR' LT '2').ZG15Q                        00138800
                   AIF   ('&ZCGPR' LE '12').ZG15R                       00138900
.ZG15Q             ANOP  ,                                              00139000
&ZMS               SETC  '"COMPCODE='                                   00139100
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00139200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00139300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00139400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00139500
.ZG15R             ANOP  ,                                              00139600
.*------------------------------------------------------------------    00139700
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00139800
&XPROXYRESPONSE    SETC  ''          INITIALIZE XVARIABLE               00139900
.*-------------------------------------------------------------------   00140000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00140100
.ZG19              ANOP  ,                                              00140200
                   AIF   (K'&PROXYRESPONSE(1) LE 0).ZG19A               00140300
&ZTLC              SETC 'NO'                                            00140400
                   AIF   ('&PROXYRESPONSE(1)' NE '&ZTLC').ZG20          00140500
&XPROXYRESPONSE    SETC  'NO'        SET KEYWORD                        00140600
                   AIF   (N'&PROXYRESPONSE LE 1).ZG19A  CK NUM          00140700
&ZMS               SETC  '"PROXYRESPONSE='                              00140800
&ZMS               SETC  '&ZMS.&PROXYRESPONSE"'                         00140900
&ZMS               SETC  '&ZMS "PROXYRESPONSE"'                         00141000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00141100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00141200
.ZG19A             ANOP  ,                                              00141300
.*------------------------------------------------------------------    00141400
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141500
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00141600
.ZG19A0            AIF   (K'&SUBJCONTOKEN LE 0).ZG19A1  OK              00141700
&ZCVAL             SETC '&ZCVAL SUBJCONTOKEN'   INCORRECT KEY USED      00141800
.ZG19A1            AIF   (K'&ZCVAL LE 0).ZG19A2  OK                     00141900
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00142000
&ZMS               SETC  '"PROXYRESPONSE'                               00142100
&ZMS               SETC  '&ZMS.=&PROXYRESPONSE"'                        00142200
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00142300
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00142400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00142500
.ZG19A2            ANOP  ,                                              00142600
.*-------------------------------------------------------------------   00142700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142800
.ZG20              ANOP  ,                                              00142900
&ZTLC              SETC 'YES'                                           00143000
                   AIF   ('&PROXYRESPONSE(1)' NE '&ZTLC').ZG24          00143100
&XPROXYRESPONSE    SETC  'YES'       SET KEYWORD                        00143200
                   AIF   (N'&PROXYRESPONSE LE 1).ZG20A  CK NUM          00143300
&ZMS               SETC  '"PROXYRESPONSE='                              00143400
&ZMS               SETC  '&ZMS.&PROXYRESPONSE"'                         00143500
&ZMS               SETC  '&ZMS "PROXYRESPONSE"'                         00143600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00143700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00143800
.ZG20A             ANOP  ,                                              00143900
.*----------------------------------------------------------------***   00144000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00144100
                   AIF   (N'&SUBJCONTOKEN LE 1).ZG22A  CK NUM           00144200
&ZMS               SETC  '"SUBJCONTOKEN='                               00144300
&ZMS               SETC  '&ZMS.&SUBJCONTOKEN"'                          00144400
&ZMS               SETC  '&ZMS "SUBJCONTOKEN"'                          00144500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00144600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00144700
.ZG22A             ANOP  ,                                              00144800
.*-------------------------------------------------------------------   00144900
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00145000
&ZXSUBJCONTOKEN    SETC  'INPUT'     SET IN/OUTPUT                      00145100
&XSUBJCONTOKEN     SETC  '&SUBJCONTOKEN(1)'     SET XVARIABLE           00145200
                   AIF   (N'&SUBJCONTOKEN GT 1).ZG22B  MULTI            00145300
&XSUBJCONTOKEN     SETC  '&SUBJCONTOKEN'        SET XVARIABLE           00145400
.ZG22B             AIF   (K'&SUBJCONTOKEN(1) GT 0).ZG22C                00145500
&ZXSUBJCONTOKEN    SETC  ''          RESET IN/OUTPUT                    00145600
&ZMS               SETC  'WHEN "YES" IS SPECIFIED'                      00145700
&ZMS               SETC  '&ZMS , "SUBJCONTOKEN" KEY AND ITS'            00145800
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00145900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00146000
.ZG22C             ANOP  ,                                              00146100
.*-------------------------------------------------------------------   00146200
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00146300
                   AIF   (K'&ZXSUBJCONTOKEN LE 0).ZG22R  NOT I/O        00146400
                   AIF   ('&XSUBJCONTOKEN'(1,1) NE '(').ZG22R           00146500
&ZCGPR             SETC  '&XSUBJCONTOKEN'(2,K'&XSUBJCONTOKEN-2)         00146600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                   00146700
                   AIF   (K'&ZCGPR GT 2).ZG22Q                          00146800
                   AIF   ('&ZCGPR' EQ '0').ZG22Q                        00146900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00147000
                   AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME      00147100
.ZG22P             ANOP  ,                                              00147200
                   AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC           00147300
                   AIF   ('&ZCGPR' LT '2').ZG22Q                        00147400
                   AIF   ('&ZCGPR' LE '12').ZG22R                       00147500
.ZG22Q             ANOP  ,                                              00147600
&ZMS               SETC  '"SUBJCONTOKEN='                               00147700
&ZMS               SETC  '&ZMS.&SUBJCONTOKEN"'                          00147800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00147900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00148000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00148100
.ZG22R             ANOP  ,                                              00148200
.*------------------------------------------------------------------    00148300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148400
.ZG24              ANOP  ,                                              00148500
&ZXPROXYRESPONSE   SETC  'INPUT'     SET IN/OUTPUT                      00148600
                   AIF   (K'&XPROXYRESPONSE GT 0).ZG24E  VALID ARG      00148700
                   AIF   (T'&PROXYRESPONSE EQ 'O').ZG24D  OMITTED       00148800
&ZASYSLNDX         SETA  0                                              00148900
.ZG24A             ANOP  ,           POSITIONAL MACRO KEY               00149000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00149100
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG24C               00149200
&ZTLC              SETC 'PROXYRESPONSE'                                 00149300
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG24A      00149400
.ZG24B             ANOP  ,                                              00149500
&ZXPROXYRESPONSE   SETC  ''          RESET IN/OUTPUT                    00149600
&ZMS               SETC  'THE "PROXYRESPONSE" KEY'                      00149700
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00149800
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00149900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00150000
                   AGO   .ZG24E                                         00150100
.ZG24C             ANOP  ,                                              00150200
&ZXPROXYRESPONSE   SETC  ''          RESET IN/OUTPUT                    00150300
&ZMS               SETC  '"PROXYRESPONSE='                              00150400
&ZMS               SETC  '&ZMS.&PROXYRESPONSE"'                         00150500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00150600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00150700
&ZMS               SETC  '&ZMS "NO"'                                    00150800
&ZMS               SETC  '&ZMS OR "YES".'                               00150900
                   MNOTE 8,' &ZMS '                                     00151000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00151100
                   AGO   .ZG24E                                         00151200
.ZG24D             ANOP  ,                                              00151300
&XPROXYRESPONSE    SETC  'NO'        SET DEFAULT KEYWORD                00151400
.ZG24E             ANOP  ,                                              00151500
.*-------------------------------------------------------------------   00151600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00151700
.ZG25              ANOP  ,                                              00151800
&ZTLC              SETC 'CONFIRMSET'                                    00151900
                   AIF   ('&REQUEST(1)' NE '&ZTLC').ZG43                00152000
&XREQUEST          SETC  'CONFIRMSET'           SET KEYWORD             00152100
                   AIF   (N'&REQUEST LE 1).ZG25A  CK NUM                00152200
&ZMS               SETC  '"REQUEST='                                    00152300
&ZMS               SETC  '&ZMS.&REQUEST"'                               00152400
&ZMS               SETC  '&ZMS "REQUEST"'                               00152500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00152600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00152700
.ZG25A             ANOP  ,                                              00152800
.*----------------------------------------------------------------***   00152900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00153000
                   AIF   (N'&COMPCODE LE 1).ZG27A  CK NUM               00153100
&ZMS               SETC  '"COMPCODE='                                   00153200
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00153300
&ZMS               SETC  '&ZMS "COMPCODE"'                              00153400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00153500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00153600
.ZG27A             ANOP  ,                                              00153700
.*-------------------------------------------------------------------   00153800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00153900
&ZXCOMPCODE        SETC  'INPUT'     SET IN/OUTPUT                      00154000
&XCOMPCODE         SETC  '0'                                            00154100
                   AIF   (K'&COMPCODE(1) LE 0).ZG27B  PARM              00154200
&XCOMPCODE         SETC  '&COMPCODE(1)'         SET XVARIABLE           00154300
                   AIF   (N'&COMPCODE GT 1).ZG27B  MULTI                00154400
&XCOMPCODE         SETC  '&COMPCODE'            SET XVARIABLE           00154500
.ZG27B             ANOP  ,                                              00154600
.*-------------------------------------------------------------------   00154700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00154800
                   AIF   (K'&ZXCOMPCODE LE 0).ZG27R  NOT I/O            00154900
         AIF   ('&XCOMPCODE' EQ '0').ZG27R                              00155000
                   AIF   ('&XCOMPCODE'(1,1) NE '(').ZG27R               00155100
&ZCGPR             SETC  '&XCOMPCODE'(2,K'&XCOMPCODE-2)                 00155200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                   00155300
                   AIF   (K'&ZCGPR GT 2).ZG27Q                          00155400
                   AIF   ('&ZCGPR' EQ '0').ZG27Q                        00155500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00155600
                   AIF   (T'&ZCGPR NE 'N').ZG27Q  INVALID REG NAME      00155700
.ZG27P             ANOP  ,                                              00155800
                   AIF   (T'&ZCGPR NE 'N').ZG27R  NON NUMERIC           00155900
                   AIF   ('&ZCGPR' LT '2').ZG27Q                        00156000
                   AIF   ('&ZCGPR' LE '12').ZG27R                       00156100
.ZG27Q             ANOP  ,                                              00156200
&ZMS               SETC  '"COMPCODE='                                   00156300
&ZMS               SETC  '&ZMS.&COMPCODE"'                              00156400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00156500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00156600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00156700
.ZG27R             ANOP  ,                                              00156800
.*----------------------------------------------------------------***   00156900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00157000
                   AIF   (N'&NEXTUSEREVENT LE 1).ZG30A  CK NUM          00157100
&ZMS               SETC  '"NEXTUSEREVENT='                              00157200
&ZMS               SETC  '&ZMS.&NEXTUSEREVENT"'                         00157300
&ZMS               SETC  '&ZMS "NEXTUSEREVENT"'                         00157400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00157500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00157600
.ZG30A             ANOP  ,                                              00157700
.*-------------------------------------------------------------------   00157800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00157900
&ZXNEXTUSEREVENT   SETC  'INPUT'     SET IN/OUTPUT                      00158000
&XNEXTUSEREVENT    SETC  '&NEXTUSEREVENT(1)'    SET XVARIABLE           00158100
                   AIF   (N'&NEXTUSEREVENT GT 1).ZG30B  MULTI           00158200
&XNEXTUSEREVENT    SETC  '&NEXTUSEREVENT'       SET XVARIABLE           00158300
.ZG30B             AIF   (K'&NEXTUSEREVENT(1) GT 0).ZG30C               00158400
&ZXNEXTUSEREVENT   SETC  ''          RESET IN/OUTPUT                    00158500
&ZMS               SETC  ' '                                            00158600
&ZMS               SETC  '&ZMS "NEXTUSEREVENT" KEY AND ITS'             00158700
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00158800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00158900
.ZG30C             ANOP  ,                                              00159000
.*-------------------------------------------------------------------   00159100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00159200
                   AIF   (K'&ZXNEXTUSEREVENT LE 0).ZG30R  NOT I/O       00159300
                   AIF   ('&XNEXTUSEREVENT'(1,1) NE '(').ZG30R          00159400
&ZCGPR             SETC  '&XNEXTUSEREVENT'(2,K'&XNEXTUSEREVENT-2)       00159500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG30P                   00159600
                   AIF   (K'&ZCGPR GT 2).ZG30Q                          00159700
                   AIF   ('&ZCGPR' EQ '0').ZG30Q                        00159800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00159900
                   AIF   (T'&ZCGPR NE 'N').ZG30Q  INVALID REG NAME      00160000
.ZG30P             ANOP  ,                                              00160100
                   AIF   (T'&ZCGPR NE 'N').ZG30R  NON NUMERIC           00160200
                   AIF   ('&ZCGPR' LT '2').ZG30Q                        00160300
                   AIF   ('&ZCGPR' LE '12').ZG30R                       00160400
.ZG30Q             ANOP  ,                                              00160500
&ZMS               SETC  '"NEXTUSEREVENT='                              00160600
&ZMS               SETC  '&ZMS.&NEXTUSEREVENT"'                         00160700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00160800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00160900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00161000
.ZG30R             ANOP  ,                                              00161100
.*----------------------------------------------------------------***   00161200
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00161300
                   AIF   (N'&USERSTATE LE 1).ZG33A  CK NUM              00161400
&ZMS               SETC  '"USERSTATE='                                  00161500
&ZMS               SETC  '&ZMS.&USERSTATE"'                             00161600
&ZMS               SETC  '&ZMS "USERSTATE"'                             00161700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00161800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00161900
.ZG33A             ANOP  ,                                              00162000
.*-------------------------------------------------------------------   00162100
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00162200
&ZXUSERSTATE       SETC  'INPUT'     SET IN/OUTPUT                      00162300
&XUSERSTATE        SETC  'ALL_ZEROES'                                   00162400
                   AIF   (K'&USERSTATE(1) LE 0).ZG33B  PARM             00162500
&XUSERSTATE        SETC  '&USERSTATE(1)'        SET XVARIABLE           00162600
                   AIF   (N'&USERSTATE GT 1).ZG33B  MULTI               00162700
&XUSERSTATE        SETC  '&USERSTATE'           SET XVARIABLE           00162800
.ZG33B             ANOP  ,                                              00162900
.*-------------------------------------------------------------------   00163000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00163100
                   AIF   (K'&ZXUSERSTATE LE 0).ZG33R  NOT I/O           00163200
         AIF   ('&XUSERSTATE' EQ 'ALL_ZEROES').ZG33R                    00163300
                   AIF   ('&XUSERSTATE'(1,1) NE '(').ZG33R              00163400
&ZCGPR             SETC  '&XUSERSTATE'(2,K'&XUSERSTATE-2)               00163500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                   00163600
                   AIF   (K'&ZCGPR GT 2).ZG33Q                          00163700
                   AIF   ('&ZCGPR' EQ '0').ZG33Q                        00163800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00163900
                   AIF   (T'&ZCGPR NE 'N').ZG33Q  INVALID REG NAME      00164000
.ZG33P             ANOP  ,                                              00164100
                   AIF   (T'&ZCGPR NE 'N').ZG33R  NON NUMERIC           00164200
                   AIF   ('&ZCGPR' LT '2').ZG33Q                        00164300
                   AIF   ('&ZCGPR' LE '12').ZG33R                       00164400
.ZG33Q             ANOP  ,                                              00164500
&ZMS               SETC  '"USERSTATE='                                  00164600
&ZMS               SETC  '&ZMS.&USERSTATE"'                             00164700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00164800
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00164900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00165000
.ZG33R             ANOP  ,                                              00165100
.*------------------------------------------------------------------    00165200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165300
&XPROXYRESPONSE    SETC  ''          INITIALIZE XVARIABLE               00165400
.*-------------------------------------------------------------------   00165500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165600
.ZG37              ANOP  ,                                              00165700
                   AIF   (K'&PROXYRESPONSE(1) LE 0).ZG37A               00165800
&ZTLC              SETC 'NO'                                            00165900
                   AIF   ('&PROXYRESPONSE(1)' NE '&ZTLC').ZG38          00166000
&XPROXYRESPONSE    SETC  'NO'        SET KEYWORD                        00166100
                   AIF   (N'&PROXYRESPONSE LE 1).ZG37A  CK NUM          00166200
&ZMS               SETC  '"PROXYRESPONSE='                              00166300
&ZMS               SETC  '&ZMS.&PROXYRESPONSE"'                         00166400
&ZMS               SETC  '&ZMS "PROXYRESPONSE"'                         00166500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00166600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00166700
.ZG37A             ANOP  ,                                              00166800
.*------------------------------------------------------------------    00166900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167000
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00167100
.ZG37A0            AIF   (K'&SUBJCONTOKEN LE 0).ZG37A1  OK              00167200
&ZCVAL             SETC '&ZCVAL SUBJCONTOKEN'   INCORRECT KEY USED      00167300
.ZG37A1            AIF   (K'&ZCVAL LE 0).ZG37A2  OK                     00167400
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00167500
&ZMS               SETC  '"PROXYRESPONSE'                               00167600
&ZMS               SETC  '&ZMS.=&PROXYRESPONSE"'                        00167700
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00167800
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00167900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00168000
.ZG37A2            ANOP  ,                                              00168100
.*-------------------------------------------------------------------   00168200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00168300
.ZG38              ANOP  ,                                              00168400
&ZTLC              SETC 'YES'                                           00168500
                   AIF   ('&PROXYRESPONSE(1)' NE '&ZTLC').ZG42          00168600
&XPROXYRESPONSE    SETC  'YES'       SET KEYWORD                        00168700
                   AIF   (N'&PROXYRESPONSE LE 1).ZG38A  CK NUM          00168800
&ZMS               SETC  '"PROXYRESPONSE='                              00168900
&ZMS               SETC  '&ZMS.&PROXYRESPONSE"'                         00169000
&ZMS               SETC  '&ZMS "PROXYRESPONSE"'                         00169100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00169200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00169300
.ZG38A             ANOP  ,                                              00169400
.*----------------------------------------------------------------***   00169500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00169600
                   AIF   (N'&SUBJCONTOKEN LE 1).ZG40A  CK NUM           00169700
&ZMS               SETC  '"SUBJCONTOKEN='                               00169800
&ZMS               SETC  '&ZMS.&SUBJCONTOKEN"'                          00169900
&ZMS               SETC  '&ZMS "SUBJCONTOKEN"'                          00170000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00170100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00170200
.ZG40A             ANOP  ,                                              00170300
.*-------------------------------------------------------------------   00170400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00170500
&ZXSUBJCONTOKEN    SETC  'INPUT'     SET IN/OUTPUT                      00170600
&XSUBJCONTOKEN     SETC  '&SUBJCONTOKEN(1)'     SET XVARIABLE           00170700
                   AIF   (N'&SUBJCONTOKEN GT 1).ZG40B  MULTI            00170800
&XSUBJCONTOKEN     SETC  '&SUBJCONTOKEN'        SET XVARIABLE           00170900
.ZG40B             AIF   (K'&SUBJCONTOKEN(1) GT 0).ZG40C                00171000
&ZXSUBJCONTOKEN    SETC  ''          RESET IN/OUTPUT                    00171100
&ZMS               SETC  'WHEN "YES" IS SPECIFIED'                      00171200
&ZMS               SETC  '&ZMS , "SUBJCONTOKEN" KEY AND ITS'            00171300
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00171400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00171500
.ZG40C             ANOP  ,                                              00171600
.*-------------------------------------------------------------------   00171700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00171800
                   AIF   (K'&ZXSUBJCONTOKEN LE 0).ZG40R  NOT I/O        00171900
                   AIF   ('&XSUBJCONTOKEN'(1,1) NE '(').ZG40R           00172000
&ZCGPR             SETC  '&XSUBJCONTOKEN'(2,K'&XSUBJCONTOKEN-2)         00172100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                   00172200
                   AIF   (K'&ZCGPR GT 2).ZG40Q                          00172300
                   AIF   ('&ZCGPR' EQ '0').ZG40Q                        00172400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00172500
                   AIF   (T'&ZCGPR NE 'N').ZG40Q  INVALID REG NAME      00172600
.ZG40P             ANOP  ,                                              00172700
                   AIF   (T'&ZCGPR NE 'N').ZG40R  NON NUMERIC           00172800
                   AIF   ('&ZCGPR' LT '2').ZG40Q                        00172900
                   AIF   ('&ZCGPR' LE '12').ZG40R                       00173000
.ZG40Q             ANOP  ,                                              00173100
&ZMS               SETC  '"SUBJCONTOKEN='                               00173200
&ZMS               SETC  '&ZMS.&SUBJCONTOKEN"'                          00173300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00173400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00173500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00173600
.ZG40R             ANOP  ,                                              00173700
.*------------------------------------------------------------------    00173800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173900
.ZG42              ANOP  ,                                              00174000
&ZXPROXYRESPONSE   SETC  'INPUT'     SET IN/OUTPUT                      00174100
                   AIF   (K'&XPROXYRESPONSE GT 0).ZG42E  VALID ARG      00174200
                   AIF   (T'&PROXYRESPONSE EQ 'O').ZG42D  OMITTED       00174300
&ZASYSLNDX         SETA  0                                              00174400
.ZG42A             ANOP  ,           POSITIONAL MACRO KEY               00174500
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00174600
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG42C               00174700
&ZTLC              SETC 'PROXYRESPONSE'                                 00174800
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG42A      00174900
.ZG42B             ANOP  ,                                              00175000
&ZXPROXYRESPONSE   SETC  ''          RESET IN/OUTPUT                    00175100
&ZMS               SETC  'THE "PROXYRESPONSE" KEY'                      00175200
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00175300
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00175400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00175500
                   AGO   .ZG42E                                         00175600
.ZG42C             ANOP  ,                                              00175700
&ZXPROXYRESPONSE   SETC  ''          RESET IN/OUTPUT                    00175800
&ZMS               SETC  '"PROXYRESPONSE='                              00175900
&ZMS               SETC  '&ZMS.&PROXYRESPONSE"'                         00176000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00176100
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00176200
&ZMS               SETC  '&ZMS "NO"'                                    00176300
&ZMS               SETC  '&ZMS OR "YES".'                               00176400
                   MNOTE 8,' &ZMS '                                     00176500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00176600
                   AGO   .ZG42E                                         00176700
.ZG42D             ANOP  ,                                              00176800
&XPROXYRESPONSE    SETC  'NO'        SET DEFAULT KEYWORD                00176900
.ZG42E             ANOP  ,                                              00177000
.*------------------------------------------------------------------    00177100
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177200
.ZG43              ANOP  ,                                              00177300
&ZXREQUEST         SETC  'INPUT'     SET IN/OUTPUT                      00177400
                   AIF   (K'&XREQUEST GT 0).ZG43E  VALID ARG            00177500
                   AIF   (T'&REQUEST EQ 'O').ZG43D  OMITTED             00177600
&ZASYSLNDX         SETA  0                                              00177700
.ZG43A             ANOP  ,           POSITIONAL MACRO KEY               00177800
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00177900
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG43C               00178000
&ZTLC              SETC 'REQUEST'                                       00178100
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG43A      00178200
.ZG43B             ANOP  ,                                              00178300
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00178400
&ZMS               SETC  'THE "REQUEST" KEY'                            00178500
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00178600
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00178700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00178800
                   AGO   .ZG43E                                         00178900
.ZG43C             ANOP  ,                                              00179000
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00179100
&ZMS               SETC  '"REQUEST='                                    00179200
&ZMS               SETC  '&ZMS.&REQUEST"'                               00179300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00179400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00179500
&ZMS               SETC  '&ZMS "SET",'                                  00179600
&ZMS               SETC  '&ZMS "CONFIRM",'                              00179700
&ZMS               SETC  '&ZMS OR "CONFIRMSET".'                        00179800
                   MNOTE 8,' &ZMS '                                     00179900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00180000
                   AGO   .ZG43E                                         00180100
.ZG43D             ANOP  ,                                              00180200
&XREQUEST          SETC  'SET'       SET DEFAULT KEYWORD                00180300
.ZG43E             ANOP  ,                                              00180400
.*------------------------------------------------------------------    00180500
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180600
                   AIF   (K'&REQUEST(1) GT 0).ZG43F  PARM               00180700
&XREQUEST          SETC  ''          ENSURE NULL KEYWORD                00180800
&ZXREQUEST         SETC  ''          RESET IN/OUTPUT                    00180900
&ZMS               SETC  'THE'                                          00181000
&ZMS               SETC  '&ZMS "REQUEST" KEY AND ITS'                   00181100
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00181200
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00181300
&ZMS               SETC  '&ZMS "SET",'                                  00181400
&ZMS               SETC  '&ZMS "CONFIRM",'                              00181500
&ZMS               SETC  '&ZMS OR "CONFIRMSET".'                        00181600
                   MNOTE 8,' &ZMS '                                     00181700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00181800
.ZG43F             ANOP  ,                                              00181900
.*----------------------------------------------------------------***   00182000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00182100
                   AIF   (N'&RETCODE LE 1).ZG45A  CK NUM                00182200
&ZMS               SETC  '"RETCODE='                                    00182300
&ZMS               SETC  '&ZMS.&RETCODE"'                               00182400
&ZMS               SETC  '&ZMS "RETCODE"'                               00182500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00182600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00182700
.ZG45A             ANOP  ,                                              00182800
.*-------------------------------------------------------------------   00182900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00183000
                   AIF   (K'&RETCODE(1) LE 0).ZG45C  NO PARM            00183100
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00183200
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00183300
                   AIF   (N'&RETCODE GT 1).ZG45C                        00183400
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00183500
.ZG45C             ANOP  ,                                              00183600
.*-------------------------------------------------------------------   00183700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00183800
                   AIF   (K'&ZXRETCODE LE 0).ZG45R  NOT I/O             00183900
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG45R                00184000
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00184100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG45P                   00184200
                   AIF   (K'&ZCGPR GT 2).ZG45Q                          00184300
                   AIF   ('&ZCGPR' EQ '0').ZG45Q                        00184400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00184500
                   AIF   (T'&ZCGPR NE 'N').ZG45Q  INVALID REG NAME      00184600
.ZG45P             ANOP  ,                                              00184700
                   AIF   (T'&ZCGPR NE 'N').ZG45R  NON NUMERIC           00184800
                   AIF   ('&ZCGPR' EQ '15').ZG45R                       00184900
                   AIF   ('&ZCGPR' LT '2').ZG45Q                        00185000
                   AIF   ('&ZCGPR' LE '12').ZG45R                       00185100
.ZG45Q             ANOP  ,                                              00185200
&ZMS               SETC  '"RETCODE='                                    00185300
&ZMS               SETC  '&ZMS.&RETCODE"'                               00185400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00185500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'       00185600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00185700
.ZG45R             ANOP  ,                                              00185800
.*----------------------------------------------------------------***   00185900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00186000
                   AIF   (N'&RSNCODE LE 1).ZG48A  CK NUM                00186100
&ZMS               SETC  '"RSNCODE='                                    00186200
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00186300
&ZMS               SETC  '&ZMS "RSNCODE"'                               00186400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00186500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00186600
.ZG48A             ANOP  ,                                              00186700
.*-------------------------------------------------------------------   00186800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00186900
                   AIF   (K'&RSNCODE(1) LE 0).ZG48C  NO PARM            00187000
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00187100
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00187200
                   AIF   (N'&RSNCODE GT 1).ZG48C                        00187300
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00187400
.ZG48C             ANOP  ,                                              00187500
.*-------------------------------------------------------------------   00187600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00187700
                   AIF   (K'&ZXRSNCODE LE 0).ZG48R  NOT I/O             00187800
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG48R                00187900
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00188000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG48P                   00188100
                   AIF   (K'&ZCGPR GT 2).ZG48Q                          00188200
                   AIF   ('&ZCGPR' EQ '0').ZG48R                        00188300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00188400
                   AIF   (T'&ZCGPR NE 'N').ZG48Q  INVALID REG NAME      00188500
.ZG48P             ANOP  ,                                              00188600
                   AIF   (T'&ZCGPR NE 'N').ZG48R  NON NUMERIC           00188700
                   AIF   ('&ZCGPR' EQ '0').ZG48R                        00188800
                   AIF   ('&ZCGPR' LT '2').ZG48Q                        00188900
                   AIF   ('&ZCGPR' LE '12').ZG48R                       00189000
.ZG48Q             ANOP  ,                                              00189100
&ZMS               SETC  '"RSNCODE='                                    00189200
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00189300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00189400
                   MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'        00189500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00189600
.ZG48R             ANOP  ,                                              00189700
.******************************************************************     00189800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00189900
.******************************************************************     00190000
                   ACTR  10000                                          00190100
.*----------------------------------------------------------------***   00190200
.***AH.P02 EXTRA POSITIONALS                                            00190300
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00190400
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00190500
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00190600
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00190700
.ZGLISTX1          ANOP  ,                                              00190800
&ZCVAL             SETC  ''          ERROR FIELD                        00190900
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00191000
.ZGLIST2           ANOP  ,                                              00191100
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00191200
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00191300
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00191400
                   AGO   .ZGLIST2                                       00191500
.*                                                                      00191600
.ZGLIST3           ANOP  ,                                              00191700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00191800
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00191900
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00192000
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00192100
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00192200
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00192300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00192400
.ZGLISTX           ANOP  ,                                              00192500
&ZASYSLNDX         SETA  0                                              00192600
.*-------------------------------------------------------------------   00192700
.***AG.MF04 MF=(SLE)                                                    00192800
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00192900
.*******************************************************************    00193000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00193100
.*******************************************************************    00193200
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00193300
.*******************************************************************    00193400
.***AE.01  START OF IXLUSYNC MACRO CODE                                 00193500
.*******************************************************************    00193600
                   LCLC  &M0M0001                 NAME                  00193700
&M0M0001           SETC  '&XLABEL'                SET NAME              00193800
                   AIF   (K'&XLABEL NE 0).XLAB2                         00193900
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00194000
.*                                                                      00194100
.XLAB2             ANOP  ,                                              00194200
                   AIF   ('&XMF' EQ 'L').XLAB3                          00194300
&M0M0001 DS    0H                             IXLUSYNC-2                00194400
.XLAB3             ANOP  ,                                              00194500
.*******************************************************************    00194600
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00194700
.*******************************************************************    00194800
              PUSH  PRINT                                               00194900
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00195000
                   PRINT OFF         ++ PR01                            00195100
                   AGO   .ZPRNTXX                                       00195200
.ZPRINTX           PRINT ON                                             00195300
.ZPRNTXX           ANOP  ,                                              00195400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00195500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00195600
.********************************************************************   00195700
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00195800
.********************************************************************   00195900
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00196000
                      LCLA  &ZOPN1         INVOCATION INDEX             00196100
                      LCLC  &ZOPL(4095)    LABEL                        00196200
                      LCLC  &ZOPO(4095)    OPERATION                    00196300
                      LCLC  &ZOPV(4095)    VALUE                        00196400
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00196500
.*                                                                      00196600
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00196700
.******************************************************************     00196800
.***AL.L10 IXLUSYNC FMT=LIST MF=S!L PARAMETERS                          00196900
.******************************************************************     00197000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00197100
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00197200
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00197300
&XMFATTR              SETC  '0D'                                        00197400
.*                                                                      00197500
&ZOPN                 SETA  &ZOPN+1                                     00197600
&ZOPL(&ZOPN)          SETC  ' '                                         00197700
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00197800
&ZOPO(&ZOPN)          SETC  'B'                                         00197900
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00198000
                      AGO   .ZALVL6B                                    00198100
.ZALVL6A              ANOP                                              00198200
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00198300
&ZOPV(&ZOPN)          SETC  '4,8'                                       00198400
&ZOPN                 SETA  &ZOPN+1                                     00198500
&ZOPL(&ZOPN)          SETC  ' '                                         00198600
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00198700
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00198800
.ZALVL6B              ANOP                                              00198900
&ZOPD(&ZOPN)          SETC  '++ IXLUSYNC ARG PARMS'                     00199000
.*                                                                      00199100
&ZOPN                 SETA  &ZOPN+1                                     00199200
&ZOPL(&ZOPN)          SETC  ' '                                         00199300
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00199400
&ZOPV(&ZOPN)          SETC  '1'                                         00199500
&ZOPD(&ZOPN)          SETC  ' '                                         00199600
.*                                                                      00199700
.ZLMFSL2              ANOP  ,                                           00199800
.*-------------------------------------------------------------------   00199900
.***AM.L00  IXLUSYNC FMT=LIST name                                      00200000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00200100
&ZOPN                 SETA &ZOPN+1                                      00200200
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00200300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00200400
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00200500
&ZOPD(&ZOPN)          SETC '++ IXLUSYNC NAME'                           00200600
.ZLMFSL2M             ANOP  ,                                           00200700
.*-------------------------------------------------------------------   00200800
.***AM.L01  IXLUSYNC FMT=LIST PARAMETERS                                00200900
&ZOPN                 SETA &ZOPN+1                                      00201000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00201100
&ZOPO(&ZOPN)          SETC 'DS'                                         00201200
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00201300
&ZOPD(&ZOPN)          SETC '++ IXLUSYNC PARM LIST'                      00201400
.*-------------------------------------------------------------------   00201500
.***AM.L02 XVERSION XL1                                                 00201600
&ZOPN                 SETA &ZOPN+1                                      00201700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00201800
&ZOPO(&ZOPN)          SETC 'DS'                                         00201900
&ZOPV(&ZOPN)          SETC 'XL1'                                        00202000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00202100
.*-------------------------------------------------------------------   00202200
.***AM.L03 XFLAGS BL.8                                                  00202300
&ZOPN                 SETA &ZOPN+1                                      00202400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00202500
&ZOPO(&ZOPN)          SETC 'DS'                                         00202600
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00202700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00202800
.*                                                                      00202900
&ZOPN                 SETA  &ZOPN+1                                     00203000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XPROXYRESPONSE_YES'              00203100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00203200
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00203300
&ZOPD(&ZOPN)          SETC  '++ XPROXYRESPONSE.'                        00203400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00203500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00203600
.*-------------------------------------------------------------------   00203700
.***AM.L09  XRSV0001 CL1                                                00203800
&ZOPN                 SETA &ZOPN+1                                      00203900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00204000
&ZOPO(&ZOPN)          SETC 'DS'                                         00204100
&ZOPV(&ZOPN)          SETC 'CL1'                                        00204200
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00204300
.*-------------------------------------------------------------------   00204400
.***AM.L05 XREQUEST XL1                                                 00204500
&ZOPN                 SETA &ZOPN+1                                      00204600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         00204700
&ZOPO(&ZOPN)          SETC 'DS'                                         00204800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00204900
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     00205000
.*                                                                      00205100
&ZOPN                 SETA  &ZOPN+1                                     00205200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_SET'                    00205300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00205400
&ZOPV(&ZOPN)          SETC  '1'                                         00205500
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00205600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).SET'                          00205700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00205800
.*                                                                      00205900
&ZOPN                 SETA  &ZOPN+1                                     00206000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_CONFIRM'                00206100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00206200
&ZOPV(&ZOPN)          SETC  '2'                                         00206300
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00206400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CONFIRM'                      00206500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00206600
.*                                                                      00206700
&ZOPN                 SETA  &ZOPN+1                                     00206800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQUEST_CONFIRMSET'             00206900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00207000
&ZOPV(&ZOPN)          SETC  '3'                                         00207100
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              00207200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CONFIRMSET'                   00207300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00207400
.*-------------------------------------------------------------------   00207500
.***AM.L09  XUSEREVENT F                                                00207600
&ZOPN                 SETA &ZOPN+1                                      00207700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSEREVENT'                       00207800
&ZOPO(&ZOPN)          SETC 'DS'                                         00207900
&ZOPV(&ZOPN)          SETC 'F'                                          00208000
&ZOPD(&ZOPN)          SETC '++ &ZXUSEREVENT '                           00208100
.*-------------------------------------------------------------------   00208200
.***AM.L09  XNEXTUSEREVENT F                                            00208300
&ZOPN                 SETA &ZOPN+1                                      00208400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNEXTUSEREVENT'                   00208500
&ZOPO(&ZOPN)          SETC 'DS'                                         00208600
&ZOPV(&ZOPN)          SETC 'F'                                          00208700
&ZOPD(&ZOPN)          SETC '++ &ZXNEXTUSEREVENT '                       00208800
.*-------------------------------------------------------------------   00208900
.***AM.L09  XUSERSTATE CL32                                             00209000
&ZOPN                 SETA &ZOPN+1                                      00209100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERSTATE'                       00209200
&ZOPO(&ZOPN)          SETC 'DS'                                         00209300
&ZOPV(&ZOPN)          SETC 'CL32'                                       00209400
&ZOPD(&ZOPN)          SETC '++ &ZXUSERSTATE '                           00209500
.*-------------------------------------------------------------------   00209600
.***AM.L09  XCONTOKEN CL16                                              00209700
&ZOPN                 SETA &ZOPN+1                                      00209800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONTOKEN'                        00209900
&ZOPO(&ZOPN)          SETC 'DS'                                         00210000
&ZOPV(&ZOPN)          SETC 'CL16'                                       00210100
&ZOPD(&ZOPN)          SETC '++ &ZXCONTOKEN '                            00210200
.*-------------------------------------------------------------------   00210300
.***AM.L09  XSUBJCONTOKEN CL16                                          00210400
&ZOPN                 SETA &ZOPN+1                                      00210500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSUBJCONTOKEN'                    00210600
&ZOPO(&ZOPN)          SETC 'DS'                                         00210700
&ZOPV(&ZOPN)          SETC 'CL16'                                       00210800
&ZOPD(&ZOPN)          SETC '++ &ZXSUBJCONTOKEN '                        00210900
.*-------------------------------------------------------------------   00211000
.***AM.L09  XCOMPCODE F                                                 00211100
&ZOPN                 SETA &ZOPN+1                                      00211200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOMPCODE'                        00211300
&ZOPO(&ZOPN)          SETC 'DS'                                         00211400
&ZOPV(&ZOPN)          SETC 'F'                                          00211500
&ZOPD(&ZOPN)          SETC '++ &ZXCOMPCODE '                            00211600
.*-------------------------------------------------------------------   00211700
.***AM.L09  XRSV0002 CL12                                               00211800
&ZOPN                 SETA &ZOPN+1                                      00211900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00212000
&ZOPO(&ZOPN)          SETC 'DS'                                         00212100
&ZOPV(&ZOPN)          SETC 'CL12'                                       00212200
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00212300
.*-------------------------------------------------------------------   00212400
.***AM.L10 END OF IXLUSYNC LIST PARAMETERS                              00212500
&ZOPN                 SETA &ZOPN+1                                      00212600
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00212700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00212800
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00212900
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00213000
.*                                                                      00213100
&ZOPN                 SETA &ZOPN+1                                      00213200
&ZOPL(&ZOPN)          SETC ' '                                          00213300
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00213400
&ZOPV(&ZOPN)          SETC '1'                                          00213500
&ZOPD(&ZOPN)          SETC ' '                                          00213600
.*-------------------------------------------------------------------   00213700
.***AL.L12 IXLUSYNC FMT=LIST MF=S!L PARAMETERS                          00213800
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00213900
.*                                                                      00214000
&ZOPN                 SETA  &ZOPN+1                                     00214100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00214200
&ZOPO(&ZOPN)          SETC  'DC'                                        00214300
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00214400
&ZOPD(&ZOPN)          SETC  '++ IXLUSYNC ARG PARMS'                     00214500
.*                                                                      00214600
.ZLMFSLX              ANOP  ,                                           00214700
.*-------------------------------------------------------------------   00214800
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00214900
&ZPLLEN               SETA 92                                           00215000
.*                                                                      00215100
.******************************************************************     00215200
.***AI.L01 IXLUSYNC FMT=LIST FILL IN PARAMETER AREA                     00215300
.******************************************************************     00215400
                      ACTR  10000                                       00215500
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00215600
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00215700
&ZCVAL                SETC  'LAE'          XAX MODE                     00215800
.ZIMFXA               ANOP ,                                            00215900
.*                                                                      00216000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00216100
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00216200
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00216300
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00216400
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00216500
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00216600
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00216700
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00216800
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00216900
&ZOPN                 SETA  &ZOPN+1                                     00217000
&ZOPL(&ZOPN)          SETC  ' '                                         00217100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00217200
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00217300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00217400
                      AGO   .ZIMFNX                                     00217500
.*                                                                      00217600
.ZIMFN2               ANOP ,                                            00217700
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00217800
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00217900
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00218000
&ZOPN                 SETA  &ZOPN+1                                     00218100
&ZOPL(&ZOPN)          SETC  ' '                                         00218200
&ZOPO(&ZOPN)          SETC  'LAE'                                       00218300
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00218400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00218500
                      AGO   .ZIMFNX                                     00218600
.ZIMFNX1              ANOP ,                                            00218700
&ZOPN                 SETA  &ZOPN+1                                     00218800
&ZOPL(&ZOPN)          SETC  ' '                                         00218900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00219000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00219100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00219200
.ZIMFNX               ANOP ,                                            00219300
.********************************************************************   00219400
.***AI.L02 IXLUSYNC FMT=LIST INITIALIZE PARAMETER AREA                  00219500
.********************************************************************   00219600
.***AI.L03 MF=(SLE)                                                     00219700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00219800
.*                                                                      00219900
&ZOPN                 SETA  &ZOPN+1                                     00220000
&ZOPL(&ZOPN)          SETC  ' '                                         00220100
&ZOPO(&ZOPN)          SETC  'XC'                                        00220200
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00220300
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00220400
.ZIMFLX               ANOP  ,                                           00220500
.*-------------------------------------------------------------------   00220600
.***AI.L04A XVERSION XL1                                                00220700
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00220800
&ZOPN                 SETA  &ZOPN+1                                     00220900
&ZOPL(&ZOPN)          SETC  ' '                                         00221000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00221100
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00221200
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00221300
.ZIMFVW               ANOP  ,                                           00221400
.*-------------------------------------------------------------------   00221500
.***AI.L05 XFLAGS BL1                                                   00221600
&ZW                   SETC  ''                                          00221700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00221800
.*-------------------------------------------------------------------   00221900
.***AI.L08 XFLAGS "YES"                                                 00222000
.***      BL1'1XXXXXXX'                                                 00222100
         AIF   ('&XPROXYRESPONSE' NE 'YES').ZI3A                        00222200
&ZW                   SETC  '&ZW.10000000'                              00222300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00222400
                      AGO   .ZI3C                                       00222500
.*                                                                      00222600
.ZI3A                 ANOP  ,                                           00222700
&ZW                   SETC  '&ZW.00000000'                              00222800
.ZI3C                 ANOP  ,                                           00222900
.*-------------------------------------------------------------------   00223000
.***AI.L11 XFLAGS BL1                                                   00223100
                      AIF   ('&ZCLNG' NE 'YES').ZI3E  ALL ZERO BITS     00223200
&ZOPN                 SETA  &ZOPN+1                                     00223300
&ZOPL(&ZOPN)          SETC  ' '                                         00223400
&ZOPO(&ZOPN)          SETC  'OI'                                        00223500
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00223600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00223700
.ZI3E                 ANOP  ,                                           00223800
.*-------------------------------------------------------------------   00223900
.***AI.L07 XREQUEST AL1                                                 00224000
&ZW                   SETC  ''                                          00224100
.*-------------------------------------------------------------------   00224200
.***AI.L15 XREQUEST "SET" AL1                                           00224300
         AIF   ('&XREQUEST' NE 'SET').ZI6A                              00224400
&ZW                   SETC  '1'                                         00224500
.ZI6A                 ANOP  ,                                           00224600
.*-------------------------------------------------------------------   00224700
.***AI.L15 XREQUEST "CONFIRM" AL1                                       00224800
         AIF   ('&XREQUEST' NE 'CONFIRM').ZI7A                          00224900
&ZW                   SETC  '2'                                         00225000
.ZI7A                 ANOP  ,                                           00225100
.*-------------------------------------------------------------------   00225200
.***AI.L15 XREQUEST "CONFIRMSET" AL1                                    00225300
         AIF   ('&XREQUEST' NE 'CONFIRMSET').ZI8A                       00225400
&ZW                   SETC  '3'                                         00225500
.ZI8A                 ANOP  ,                                           00225600
.*-------------------------------------------------------------------   00225700
.***AI.L17 XREQUEST AL1                                                 00225800
                      AIF   ('&ZW' EQ '0').ZI8B                         00225900
                      AIF   ('&ZW' EQ '').ZI8B                          00226000
.*                                                                      00226100
&ZOPN                 SETA  &ZOPN+1                                     00226200
&ZOPL(&ZOPN)          SETC  ' '                                         00226300
&ZOPO(&ZOPN)          SETC  'MVI'                                       00226400
&ZOPV(&ZOPN)          SETC  '3(1),&ZW'                                  00226500
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST'                    00226600
.ZI8B                 ANOP  ,                                           00226700
.*-------------------------------------------------------------------   00226800
.***AI.L25  XUSEREVENT F                                                00226900
                      AIF   ('&ZXUSEREVENT' EQ '').ZI9E                 00227000
                      AIF   ('&ZXUSEREVENT' EQ 'OUTPUT').ZI9E           00227100
&ZCGPR                SETC  '&XUSEREVENT'                               00227200
.*                                                                      00227300
                      AIF   ('&XUSEREVENT'(1,1) NE '(').ZI9B            00227400
&ZCGPR   SETC  '0('.'&XUSEREVENT'(2,K'&XUSEREVENT-2).')'                00227500
                      AGO   .ZI9D                                       00227600
.ZI9B                 ANOP  ,                                           00227700
.*                                                                      00227800
&ZC                   SETC  '&XUSEREVENT'(1,1)                          00227900
                      AIF   (T'&ZC NE 'N').ZI9D                         00228000
&ZC                   SETC  '&XUSEREVENT'                               00228100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00228200
&ZCGPR                SETC  '=AL4(&XUSEREVENT)'                         00228300
.*                                                                      00228400
.ZI9D                 ANOP  ,                                           00228500
.*                                                                      00228600
&ZOPN                 SETA  &ZOPN+1                                     00228700
&ZOPL(&ZOPN)          SETC  ' '                                         00228800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00228900
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00229000
&ZOPD(&ZOPN)          SETC  '++ &ZXUSEREVENT XUSEREVENT'                00229100
.*                                                                      00229200
.ZI9E                 ANOP  ,                                           00229300
.*-------------------------------------------------------------------   00229400
.***AI.L25  XNEXTUSEREVENT F                                            00229500
                      AIF   ('&ZXNEXTUSEREVENT' EQ '').ZI10E            00229600
                      AIF   ('&ZXNEXTUSEREVENT' EQ 'OUTPUT').ZI10E      00229700
&ZCGPR                SETC  '&XNEXTUSEREVENT'                           00229800
.*                                                                      00229900
                      AIF   ('&XNEXTUSEREVENT'(1,1) NE '(').ZI10B       00230000
&ZCGPR   SETC  '0('.'&XNEXTUSEREVENT'(2,K'&XNEXTUSEREVENT-2).')'        00230100
                      AGO   .ZI10D                                      00230200
.ZI10B                ANOP  ,                                           00230300
.*                                                                      00230400
&ZC                   SETC  '&XNEXTUSEREVENT'(1,1)                      00230500
                      AIF   (T'&ZC NE 'N').ZI10D                        00230600
&ZC                   SETC  '&XNEXTUSEREVENT'                           00230700
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00230800
&ZCGPR                SETC  '=AL4(&XNEXTUSEREVENT)'                     00230900
.*                                                                      00231000
.ZI10D                ANOP  ,                                           00231100
.*                                                                      00231200
&ZOPN                 SETA  &ZOPN+1                                     00231300
&ZOPL(&ZOPN)          SETC  ' '                                         00231400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00231500
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00231600
&ZOPD(&ZOPN)          SETC  '++ &ZXNEXTUSEREVENT XNEXTUSEREVENT'        00231700
.*                                                                      00231800
.ZI10E                ANOP  ,                                           00231900
.*-------------------------------------------------------------------   00232000
.***AI.L18  XUSERSTATE CL32                                             00232100
         AIF   ('&XUSERSTATE' NE 'ALL_ZEROES').ZI11                     00232200
&ZXUSERSTATE          SETC  ''             RESET INPUT/OUTPUT           00232300
.ZI11                 ANOP  ,                                           00232400
.*-------------------------------------------------------------------   00232500
.***AI.L25  XUSERSTATE CL32                                             00232600
                      AIF   ('&ZXUSERSTATE' EQ '').ZI11E                00232700
                      AIF   ('&ZXUSERSTATE' EQ 'OUTPUT').ZI11E          00232800
&ZCGPR                SETC  '&XUSERSTATE'                               00232900
.*                                                                      00233000
                      AIF   ('&XUSERSTATE'(1,1) NE '(').ZI11B           00233100
&ZCGPR   SETC  '0('.'&XUSERSTATE'(2,K'&XUSERSTATE-2).')'                00233200
.ZI11B                ANOP  ,                                           00233300
.*                                                                      00233400
&ZOPN                 SETA  &ZOPN+1                                     00233500
&ZOPL(&ZOPN)          SETC  ' '                                         00233600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00233700
&ZOPV(&ZOPN)          SETC  '12(32,1),&ZCGPR'                           00233800
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERSTATE XUSERSTATE'                00233900
.*                                                                      00234000
.ZI11E                ANOP  ,                                           00234100
.*-------------------------------------------------------------------   00234200
.***AI.L25  XCONTOKEN CL16                                              00234300
                      AIF   ('&ZXCONTOKEN' EQ '').ZI12E                 00234400
                      AIF   ('&ZXCONTOKEN' EQ 'OUTPUT').ZI12E           00234500
&ZCGPR                SETC  '&XCONTOKEN'                                00234600
.*                                                                      00234700
                      AIF   ('&XCONTOKEN'(1,1) NE '(').ZI12B            00234800
&ZCGPR   SETC  '0('.'&XCONTOKEN'(2,K'&XCONTOKEN-2).')'                  00234900
.ZI12B                ANOP  ,                                           00235000
.*                                                                      00235100
&ZOPN                 SETA  &ZOPN+1                                     00235200
&ZOPL(&ZOPN)          SETC  ' '                                         00235300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00235400
&ZOPV(&ZOPN)          SETC  '44(16,1),&ZCGPR'                           00235500
&ZOPD(&ZOPN)          SETC  '++ &ZXCONTOKEN XCONTOKEN'                  00235600
.*                                                                      00235700
.ZI12E                ANOP  ,                                           00235800
.*-------------------------------------------------------------------   00235900
.***AI.L25  XSUBJCONTOKEN CL16                                          00236000
                      AIF   ('&ZXSUBJCONTOKEN' EQ '').ZI13E             00236100
                      AIF   ('&ZXSUBJCONTOKEN' EQ 'OUTPUT').ZI13E       00236200
&ZCGPR                SETC  '&XSUBJCONTOKEN'                            00236300
.*                                                                      00236400
                      AIF   ('&XSUBJCONTOKEN'(1,1) NE '(').ZI13B        00236500
&ZCGPR   SETC  '0('.'&XSUBJCONTOKEN'(2,K'&XSUBJCONTOKEN-2).')'          00236600
.ZI13B                ANOP  ,                                           00236700
.*                                                                      00236800
&ZOPN                 SETA  &ZOPN+1                                     00236900
&ZOPL(&ZOPN)          SETC  ' '                                         00237000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00237100
&ZOPV(&ZOPN)          SETC  '60(16,1),&ZCGPR'                           00237200
&ZOPD(&ZOPN)          SETC  '++ &ZXSUBJCONTOKEN XSUBJCONTOKEN'          00237300
.*                                                                      00237400
.ZI13E                ANOP  ,                                           00237500
.*-------------------------------------------------------------------   00237600
.***AI.L18  XCOMPCODE F                                                 00237700
         AIF   ('&XCOMPCODE' NE '0').ZI14                               00237800
&ZXCOMPCODE           SETC  ''             RESET INPUT/OUTPUT           00237900
.ZI14                 ANOP  ,                                           00238000
.*-------------------------------------------------------------------   00238100
.***AI.L25  XCOMPCODE F                                                 00238200
                      AIF   ('&ZXCOMPCODE' EQ '').ZI14E                 00238300
                      AIF   ('&ZXCOMPCODE' EQ 'OUTPUT').ZI14E           00238400
&ZCGPR                SETC  '&XCOMPCODE'                                00238500
.*                                                                      00238600
                      AIF   ('&XCOMPCODE'(1,1) NE '(').ZI14B            00238700
&ZCGPR   SETC  '0('.'&XCOMPCODE'(2,K'&XCOMPCODE-2).')'                  00238800
                      AGO   .ZI14D                                      00238900
.ZI14B                ANOP  ,                                           00239000
.*                                                                      00239100
&ZC                   SETC  '&XCOMPCODE'(1,1)                           00239200
                      AIF   (T'&ZC NE 'N').ZI14D                        00239300
&ZC                   SETC  '&XCOMPCODE'                                00239400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI14D               00239500
&ZCGPR                SETC  '=AL4(&XCOMPCODE)'                          00239600
.*                                                                      00239700
.ZI14D                ANOP  ,                                           00239800
.*                                                                      00239900
&ZOPN                 SETA  &ZOPN+1                                     00240000
&ZOPL(&ZOPN)          SETC  ' '                                         00240100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00240200
&ZOPV(&ZOPN)          SETC  '76(4,1),&ZCGPR'                            00240300
&ZOPD(&ZOPN)          SETC  '++ &ZXCOMPCODE XCOMPCODE'                  00240400
.*                                                                      00240500
.ZI14E                ANOP  ,                                           00240600
.*-------------------------------------------------------------------   00240700
&ZOPN1                SETA &ZOPN                                        00240800
.*******************************************************************    00240900
.***  PROCESS IXLUSYNC OUTPUT PARAMETERS                                00241000
.*******************************************************************    00241100
                      ACTR  10000                                       00241200
.*******************************************************************    00241300
.***AO.X02  RETURN CODE PROCESSING                                      00241400
.*******************************************************************    00241500
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00241600
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00241700
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00241800
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00241900
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00242000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00242100
&ZOPN                 SETA  &ZOPN+1                                     00242200
&ZOPL(&ZOPN)          SETC  ' '                                         00242300
&ZOPO(&ZOPN)          SETC  'ST'                                        00242400
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00242500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00242600
                      AGO   .ZMRETX                                     00242700
.*                                                                      00242800
.ZMRET2               ANOP  ,                                           00242900
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00243000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00243100
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00243200
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00243300
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00243400
&ZOPN                 SETA  &ZOPN+1                                     00243500
&ZOPL(&ZOPN)          SETC  ' '                                         00243600
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00243700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00243800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00243900
.ZMRETX               ANOP  ,                                           00244000
.*******************************************************************    00244100
.***AO.X03  REASON CODE PROCESSING                                      00244200
.*******************************************************************    00244300
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00244400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00244500
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00244600
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00244700
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00244800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00244900
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00245000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00245100
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00245200
&ZOPN                 SETA  &ZOPN+1                                     00245300
&ZOPL(&ZOPN)          SETC  ' '                                         00245400
&ZOPO(&ZOPN)          SETC  'ST'                                        00245500
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00245600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00245700
                      AGO   .ZMRSNX                                     00245800
.*                                                                      00245900
.ZMRSN2               ANOP  ,                                           00246000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00246100
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00246200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00246300
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00246400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00246500
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00246600
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00246700
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00246800
&ZOPN                 SETA  &ZOPN+1                                     00246900
&ZOPL(&ZOPN)          SETC  ' '                                         00247000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00247100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00247200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00247300
.ZMRSNX               ANOP  ,                                           00247400
.*******************************************************************    00247500
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00247600
.*******************************************************************    00247700
.ZMFLX                ANOP  ,              MF=L PROCESSING              00247800
.*******************************************************************    00247900
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00248000
.*******************************************************************    00248100
                      ACTR  10000                                       00248200
.*                                                                      00248300
                      LCLA  &ZLC           COLUMN POSITION              00248400
                      LCLA  &ZOPX          LIST TABLE INDEX             00248500
                      LCLC  &ZLL           LABEL                        00248600
                      LCLC  &ZLOP          OPERATION                    00248700
                      LCLC  &ZLV           VALUE                        00248800
                      LCLC  &ZLD           DESCRIPTION                  00248900
.*                                                                      00249000
&ZOPX                 SETA  1                                           00249100
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00249200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00249300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00249400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00249500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00249600
                      AIF   (K'&ZLD LE 0).ZL5                           00249700
&ZLC                  SETA  35             COMMENT COLUMN               00249800
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00249900
&ZLC                  SETA  33             COMMMENT COLUMN              00250000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00250100
&ZLV                  SETC  '&ZLV'.' '                                  00250200
                      AGO   .ZL3                                        00250300
.*                                                                      00250400
.ZL4                  ANOP  ,                                           00250500
&ZLV                  SETC  '&ZLV'.' '                                  00250600
.ZL5                  ANOP  ,                                           00250700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00250800
.*                                                                      00250900
&ZLL     &ZLOP &ZLV                                                     00251000
.*                                                                      00251100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00251200
                      AGO   .ZL2           CONTINUE LOOPING             00251300
.*                                                                      00251400
.ZLX                  ANOP  ,                                           00251500
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00251600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00251700
         L     14,16(0,0)              GET CVT ADDRESS                  00251800
         L     14,772(14,0)            GET SFT ADDRESS                  00251900
         L     14,220(14,0)            GET LX FOR SERVICE ROUTINE       00252000
         LA    15,49                   GET EX FOR SERVICE ROUTINE       00252100
         OR    14,15                   GET PC NUMBER                    00252200
         PC    0(14)                                                    00252300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00252400
.ZLINKX               ANOP  ,                                           00252500
.*******************************************************************    00252600
.***AP.X01  FORMAT GENERATED CODE                                       00252700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00252800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00252900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00253000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00253100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00253200
                      AIF   (K'&ZLD LE 0).ZL51                          00253300
&ZLC                  SETA  35             COMMENT COLUMN               00253400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00253500
&ZLC                  SETA  33             COMMENT COLUMN               00253600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00253700
&ZLV                  SETC  '&ZLV'.' '                                  00253800
                      AGO   .ZL31                                       00253900
.*                                                                      00254000
.ZL41                 ANOP  ,                                           00254100
&ZLV                  SETC  '&ZLV'.' '                                  00254200
.ZL51                 ANOP  ,                                           00254300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00254400
.*                                                                      00254500
&ZLL     &ZLOP &ZLV                                                     00254600
.*                                                                      00254700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00254800
                      AGO   .ZL21          CONTINUE LOOPING             00254900
.*                                                                      00255000
.ZLX1                 ANOP  ,                                           00255100
.*******************************************************************    00255200
.***AP.X02  END OF IXLUSYNC MACRO                                       00255300
&ZIXLUSYNC            SETC  'YES'          SET IXLUSYNC USED            00255400
         POP   PRINT                                                    00255500
*                                            IXLUSYNC-2                 00255600
         SPACE 1                                                        00255700
.ZLX2                 ANOP  ,                                           00255800
         MEND                                                           00255900
**********************************************************************/ 00256000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00256100
*%IXLUSYNC: MACRO KEYS(CONTOKEN,USEREVENT,REQUEST,USERSTATE,COMPCODE,   00256200
*                 PROXYRESPONSE,SUBJCONTOKEN,NEXTUSEREVENT,RETCODE,     00256300
*                 RSNCODE,PLISTVER,MF);                                 00256400
*  ANS('?'!!MACLABEL!!' '!!'IXLUSYNP '!!MACLIST!!                       00256500
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00256600
*%END IXLUSYNC;                                                         00256700

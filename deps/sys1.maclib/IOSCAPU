*/**** START OF SPECIFICATIONS **************************************** 00040000
*                                                                     * 00080000
*                                                                     * 00120000
*01* MACRO NAME:  IOSCAPU                               -01/22/01-<1> * 00160000
*                                                                     * 00200000
*                                                                     * 00240000
*01* DESCRIPTIVE NAME:  UCB Capture/Uncapture/Translation             * 00280000
*                                                                     * 00320000
*01* PROPRIETARY STATEMENT:                                           * 00360000
*                                                                     * 00400000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00440000
*     5655-068 (C) COPYRIGHT IBM CORP. 1994                           * 00520000
*                                                                     * 00600000
* STATUS= HBB5520                                                     * 00640000
*                                                                     * 00680000
*                                                                     * 00720000
*                                                                     * 00760000
*01* FUNCTION:                                                        * 00800000
*                                                                     * 00840000
*                                                                     * 00880000
*      The IOSCAPU service should be used by programs that pass UCB   * 00920000
*      addresses or themselves get passed UCB addresses, and need to  * 00960000
*      use 24 bit addresses when accessing the UCB.  The Actual UCB   * 01000000
*      (which may be a 31 bit address) can be captured by invoking    * 01040000
*      the function CAPTUCB. For an above the 16Mb line Actual UCB,   * 01080000
*      this function will create and pass back the address of a       * 01120000
*      Captured UCB (a 24 bit address) that is located below the 16Mb * 01160000
*      line in the PRIVATE area of the current address space, or if   * 01200000
*      CAPTCOM is specified, into COMMON storage.  Actual UCBs        * 01240000
*      captured with this service will need to be explicitly          * 01280000
*      uncaptured by using the UCAPTUCB function. If a program has a  * 01320000
*      Captured UCB, it can use the function CAPTOACT to get the      * 01360000
*      above the 16Mb line Actual UCB address.                        * 01400000
*                                                                     * 01440000
*      The IOSCAPU service provides the following functions:          * 01480000
*                                                                     * 01520000
*                                                                     * 01560000
*      o   CAPTUCB  - The specified Actual UCB will be Captured into  * 01600000
*          the private area of the current address space or if        * 01640000
*          CAPTCOM is specified into COMMON storage, and the Captured * 01680000
*          UCB address returned.  If the UCB already Captured in the  * 01720000
*          current address space or in COMMON storage, that Captured  * 01760000
*          address will be returned. The caller is expected to use    * 01800000
*          the Uncapture function when the Captured UCB is no longer  * 01840000
*          needed.  If the UCB address passed as input is a below the * 01880000
*          16Mb line Actual UCB address, the service will return this * 01920000
*          UCB address as output and issue a warning return code.     * 01960000
*                                                                     * 02000000
*      o   UCAPTUCB - The specified Captured UCB will be uncaptured.  * 02040000
*          If a below the 16Mb line Actual UCB address is passed, no  * 02080000
*          UCB is Uncaptured and this function will return a warning  * 02120000
*          return code If an above 16Mb Actual UCB address is passed, * 02160000
*          no UCB is Uncaptured and this function will return a       * 02200000
*          failing return code.                                       * 02240000
*                                                                     * 02280000
*      o   CAPTOACT - Given a Captured UCB address, this function     * 02320000
*          will return the 31 bit above the 16Mb line Actual UCB      * 02360000
*          address.  If an Actual UCB address is passed as input,     * 02400000
*          this service will return a warning and pass that address   * 02440000
*          as output.  The ASID parameter may optionally be used to   * 02480000
*          allow translation to be performed for a Captured UCB in    * 02520000
*          another address space.                                     * 02560000
*                                                                     * 02600000
*                                                                     * 02640000
*                                                                     * 02680000
*      The LINKAGE=BRANCH option is intended for performance          * 02720000
*      sensitive invokers or programs which require this function     * 02760000
*      during NIP before a PC can be issued.                          * 02800000
*                                                                     * 02840000
*      The PC entry point is specified via LINKAGE(SYSTEM).           * 02880000
*                                                                     * 02920000
*      The entry via PC or Branch will perform full validation of     * 02960000
*      storage areas and parameters.  For example, a PC entered       * 03000000
*      caller can pass the parameter list in a non-zero key and the   * 03040000
*      service will only reference that storage in the caller's key.  * 03080000
*      Use of this feature will allow the caller to protect against   * 03120000
*      accidental corruption of a system storage area as a result of  * 03160000
*      a programming bug.  Both entry points will also provide        * 03200000
*      additional diagnostic information to aid in debugging these    * 03240000
*      problems.                                                      * 03280000
*                                                                     * 03320000
*01* EXTERNAL CLASSIFICATION:                                         * 03360000
*                                                                     * 03400000
*02* GUPI: BASE                                                       * 03440000
*                                                                     * 03480000
*02* NONE: FIELDS                                                     * 03520000
*          MSIFREE                                                    * 03560000
*                                                                     * 03600000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 03640000
*                                                                     * 03680000
*01* ENVIRONMENT:                                                     * 03720000
*                                                                     * 03760000
*                                                                     * 03800000
*      Dispatchable unit mode: Task or SRB mode.                      * 03840000
*                                                                     * 03880000
*      Cross Memory Mode:                                             * 03920000
*                                                                     * 03960000
*                                                                     * 04000000
*                        o   The functions CAPTUCB and UCAPTUCB will  * 04022800
*                            only allow primary = home = secondary    * 04045600
*                            address space.                           * 04068400
*                                                                     * 04091200
*                        o   The function CAPTOACT will allow primary * 04114000
*                            ^= home ^= secondary address space.      * 04136800
*                                                                     * 04160000
*                                                                     * 04200000
*                                                                     * 04240000
*      Minimum authorization:                                         * 04280000
*                                                                     * 04320000
*                                                                     * 04360000
*                        CAPTUCB                                      * 04400000
*                            Supervisor state, or problem state and   * 04440000
*                            PKM 0-7.                                 * 04480000
*                                                                     * 04520000
*                        UCAPTUCB                                     * 04560000
*                            Supervisor state, or problem state and   * 04600000
*                            PKM 0-7.                                 * 04640000
*                                                                     * 04680000
*                        CAPTOACT                                     * 04720000
*                            Supervisor state, or problem state and   * 04760000
*                            PKM 0-7 if ASID is specified. If ASID is * 04800000
*                            not specified, then Supervisor state, or * 04840000
*                            problem state.                           * 04880000
*                                                                     * 04920000
*                                                                     * 04960000
*                                                                     * 05000000
*      AMODE:            24- or 31-bit.                               * 05040000
*                                                                     * 05080000
*      ASC mode:         Primary or Access Register.                  * 05120000
*                                                                     * 05160000
*      Interrupt status:                                              * 05200000
*                                                                     * 05240000
*                                                                     * 05280000
*                        CAPTUCB CAPTCOM=NO                           * 05320000
*                            Enabled.                                 * 05360000
*                                                                     * 05400000
*                        CAPTUCB CAPTCOM=YES                          * 05416000
*                            Enabled or Disabled.                     * 05432000
*                                                                     * 05448000
*                        CAPTUCB CAPTCOM=NEVER                        * 05452000
*                            Enabled.                                 * 05456000
*                                                                     * 05460000
*                        UCAPTUCB CAPTCOM=NO                          * 05464000
*                            Enabled.                                 * 05480000
*                                                                     * 05490000
*                        UCAPTUCB CAPTCOM=YES                         * 05500000
*                            Enabled or Disabled.                     * 05510000
*                                                                     * 05520000
*                        CAPTOACT                                     * 05560000
*                            Enabled or Disabled.                     * 05600000
*                                                                     * 05640000
*                                                                     * 05680000
*                                                                     * 05720000
*      Locks:                                                         * 05760000
*                                                                     * 05800000
*                                                                     * 05840000
*                        CAPTUCB  CAPTCOM=NO                          * 05880000
*                            Unlocked.                                * 05920000
*                                                                     * 05960000
*                        CAPTUCB  CAPTCOM=YES                         * 05964200
*                            The invoker must not hold any lock which * 05968400
*                            would prevent the IOSULUT lock from      * 05972600
*                            being obtained shared.                   * 05976800
*                                                                     * 05977800
*                        CAPTUCB  CAPTCOM=NEVER                       * 05978800
*                            Unlocked                                 * 05979800
*                                                                     * 05981000
*                            NOTES:                                   * 05985200
*                                                                     * 05989400
*                                                                     * 05993600
*                                                                     * 05997800
*                                o   When invoking the CAPTUCB        * 06002000
*                                    CAPTCOM=YES function the IOSULUT * 06006200
*                                    lock cannot be held EXCLUSIVELY. * 06010400
*                                                                     * 06014600
*                                                                     * 06018800
*                                                                     * 06023000
*                                                                     * 06027200
*                                                                     * 06031400
*                        UCAPTUCB CAPTCOM=NO                          * 06035600
*                            Unlocked.                                * 06040000
*                                                                     * 06042200
*                        UCAPTUCB CAPTCOM=YES                         * 06044400
*                            The invoker must not hold any lock which * 06046600
*                            would prevent the IOSULUT lock from      * 06048800
*                            being obtained shared.                   * 06051000
*                                                                     * 06053200
*                            NOTES:                                   * 06055400
*                                                                     * 06057600
*                                                                     * 06059800
*                                                                     * 06062000
*                                o   When invoking the UCAPTUCB       * 06064200
*                                    CAPTCOM=YES function the IOSULUT * 06066400
*                                    lock cannot be held EXCLUSIVELY. * 06068600
*                                                                     * 06070800
*                                                                     * 06073000
*                                                                     * 06075200
*                                                                     * 06077400
*                                                                     * 06080000
*                        CAPTOACT                                     * 06120000
*                            The invoker must not hold any lock       * 06160000
*                            higher than the IOSULUT lock.            * 06200000
*                                                                     * 06203000
*                            NOTES:                                   * 06206000
*                                                                     * 06209000
*                                                                     * 06212000
*                                                                     * 06215000
*                                o   When invoking the CAPTOACT       * 06218000
*                                    function the IOSULUT lock cannot * 06221000
*                                    be held EXCLUSIVELY.             * 06224000
*                                                                     * 06227000
*                                                                     * 06230000
*                                                                     * 06233000
*                                                                     * 06236000
*                                                                     * 06240000
*                                                                     * 06280000
*                                                                     * 06320000
*      Restrictions:                                                  * 06360000
*                                                                     * 06400000
*                        The caller's storage must be in FIXED or     * 06440000
*                        DREF storage if the caller is disabled.      * 06480000
*                                                                     * 06520000
*                        The caller must make sure that the UCB is    * 06560000
*                        not dynamically deleted.                     * 06600000
*                                                                     * 06640000
*                        The LINKAGE=BRANCH option is limited to      * 06680000
*                        callers which meet the following criteria:   * 06720000
*                                                                     * 06760000
*                                                                     * 06800000
*                        o   supervisor state key 0                   * 06840000
*                                                                     * 06880000
*                        o   the parameter list must reside in fixed  * 06920000
*                            or DREF storage when the translate       * 06960000
*                            function is being performed and the      * 07000000
*                            caller is disabled.                      * 07040000
*                                                                     * 07080000
*                                                                     * 07120000
*                                                                     * 07160000
*                                                                     * 07200000
*                                                                     * 07240000
*01* INPUT REGISTER INFORMATION:                                      * 07280000
*                                                                     * 07320000
*                                                                     * 07360000
*    REGISTER  CONTENTS                                               * 07400000
*                                                                     * 07440000
*    GR0-GR15  Undefined                                              * 07480000
*                                                                     * 07520000
*                                                                     * 07560000
*                                                                     * 07600000
*    Before issuing the IOSCAPU the caller does not have to place any * 07640000
*    information into any AR.                                         * 07680000
*                                                                     * 07720000
*01* OUTPUT REGISTER INFORMATION:                                     * 07760000
*                                                                     * 07800000
*                                                                     * 07840000
*    REGISTER  CONTENTS                                               * 07880000
*                                                                     * 07920000
*    GR0       Reason code                                            * 07960000
*                                                                     * 08000000
*    GR1       Used by service                                        * 08040000
*                                                                     * 08080000
*    GR2-GR13  Unchanged                                              * 08120000
*                                                                     * 08160000
*    GR14      Used by service                                        * 08200000
*                                                                     * 08240000
*    GR15      Return code                                            * 08280000
*                                                                     * 08320000
*                                                                     * 08360000
*                                                                     * 08400000
*    When control returns to the caller, the ARs will contain what    * 08440000
*    they had at entry.                                               * 08480000
*                                                                     * 08520000
*01* SYNTAX:                                                          * 08560000
*                                                                     * 08600000
*Ýxlabel¨  IOSCAPU  Ð  CAPTUCB                                        * 08640000
*                   !     ,UCBPTR=xucbptr                             * 08680000
*                   !     ,CAPTPTR=xcaptptr                           * 08720000
*                   !    Ý,MSIFREE=»NO!YESº¨                          * 08760000
*                   !    Ý,LASTING=»NO!YESº¨                          * 08800000
*                   !    Ý,CAPTCOM=»NO!YES!NEVERº¨                    * 08840000
*                   Ô ,UCAPTUCB                                       * 08880000
*                   !     ,CAPTPTR=xcaptptr                           * 08920000
*                   !    Ý,LASTING=»NO!YESº¨                          * 08930000
*                   !    Ý,CAPTCOM=»NO!YESº¨                          * 08940000
*                   ¿ ,CAPTOACT                                       * 08960000
*                         ,CAPTPTR=xcaptptr                           * 09000000
*                         ,UCBPTR=xucbptr                             * 09040000
*                        Ý,ASID=»xasid!CURRENTº¨                      * 09080000
*                    Ý,LINKAGE=»SYSTEM!BRANCHº¨                       * 09120000
*                    Ý,RETCODE=xretcode¨                              * 09160000
*                    Ý,RSNCODE=xrsncode¨                              * 09200000
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 09220000
*                   ÐÝ,MF=S¨                                          * 09240000
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 09280000
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                     * 09320000
*                                                                     * 09360000
*                                                                     * 09400000
*      Where:                                                         * 09440000
*                                                                     * 09480000
*                                                                     * 09520000
*      Ýxlabel¨                                                       * 09560000
*          is an optional symbol, starting in column 1, that is the   * 09600000
*          name on the IOSCAPU macro invocation.  The name must       * 09640000
*          conform to the rules for an ordinary assembler language    * 09680000
*          symbol.                                                    * 09720000
*          DEFAULT: No name.                                          * 09760000
*                                                                     * 09800000
*                                                                     * 09840000
*                                                                     * 09880000
*                                                                     * 09920000
*      The following is a set of mutually exclusive keys.  This set   * 09960000
*      is required; only one key must be specified.                   * 10000000
*                                                                     * 10040000
*                                                                     * 10080000
*      CAPTUCB                                                        * 10120000
*          Create a Captured UCB in the current address space, and    * 10160000
*          return its address.                                        * 10200000
*                                                                     * 10240000
*                                                                     * 10280000
*          UCBPTR=xucbptr                                             * 10320000
*              is the name (RS-type), or address in register          * 10360000
*              (2)-(12), of a required 4 byte input that contains the * 10400000
*              address of the common segment of the Actual UCB to be  * 10440000
*              captured.                                              * 10480000
*                                                                     * 10520000
*                                                                     * 10560000
*                                                                     * 10600000
*                                                                     * 10640000
*          CAPTPTR=xcaptptr                                           * 10680000
*              is the name (RS-type), or address in register          * 10720000
*              (2)-(12), of a required 4 byte output that will        * 10760000
*              contain the address of the common segment of the       * 10800000
*              Captured UCB.                                          * 10840000
*                                                                     * 10880000
*                                                                     * 10920000
*                                                                     * 10960000
*                                                                     * 11000000
*          ÝMSIFREE=»NO!YESº¨                                         * 11040000
*              is an optional keyword input that indicates that the   * 11080000
*              captured UCB should be uncaptured during Master        * 11120000
*              Scheduler Initialization.                              * 11160000
*                                                                     * 11200000
*              NOTES:                                                 * 11240000
*                                                                     * 11280000
*                                                                     * 11320000
*                                                                     * 11360000
*                  o   This keyword is for IBM use only. Users of     * 11400000
*                      this keyword must be NIP callers. It enables   * 11440000
*                      NIP callers to indicate to IOS that the        * 11480000
*                      Captured UCB should be uncaptured during MSI.  * 11520000
*                                                                     * 11560000
*                  o   This keyword if used after NIP processing will * 11600000
*                      generate a return code and reason code. See    * 11640000
*                      the return code section for further            * 11653300
*                      information.                                   * 11666600
*                                                                     * 11679900
*                  o   MSIFREE is mutually exclusive with CAPTCOM and * 11693200
*                      LASTING.                                       * 11706500
*                                                                     * 11720000
*                                                                     * 11760000
*                                                                     * 11800000
*                                                                     * 11840000
*              DEFAULT: NO                                            * 11880000
*                                                                     * 11920000
*                                                                     * 11960000
*              MSIFREE=NO                                             * 11986600
*                  Do not uncapture the UCB during MSI.               * 12013200
*                                                                     * 12040000
*              MSIFREE=YES                                            * 12066600
*                  Uncapture the UCB during MSI.                      * 12093200
*                                                                     * 12120000
*                                                                     * 12160000
*                                                                     * 12200000
*                                                                     * 12240000
*                                                                     * 12280000
*                                                                     * 12320000
*          ÝLASTING=»NO!YESº¨                                         * 12360000
*              is an optional keyword input that indicates that the   * 12400000
*              captured UCB should not be uncaptured automatically    * 12440000
*              during end of task termination.                        * 12480000
*                                                                     * 12520000
*              NOTES:                                                 * 12560000
*                                                                     * 12600000
*                                                                     * 12640000
*                                                                     * 12680000
*                  o   The LASTING keyword will have no effect when   * 12720000
*                      capturing is being done on behalf of a caller  * 12760000
*                      in SRB mode.                                   * 12800000
*                                                                     * 12840000
*                  o   Cleanup will not be performed on behalf of     * 12880000
*                      callers in SRB mode that do not uncapture      * 12920000
*                      prior to terminating.                          * 12960000
*                                                                     * 12970000
*                  o   LASTING is mutually exclusive with MSIFREE and * 12980000
*                      CAPTCOM.                                       * 12990000
*                                                                     * 13000000
*                  o   If, and only if, LASTING=YES is specified when * 13008000
*                      capturing a UCB, LASTING=YES should be         * 13016000
*                      specified when releasing the same captured     * 13024000
*                      UCB.                                           * 13032000
*                                                                     * 13040000
*                                                                     * 13060000
*                                                                     * 13080000
*                                                                     * 13120000
*              DEFAULT: NO                                            * 13160000
*                                                                     * 13200000
*                                                                     * 13240000
*              LASTING=NO                                             * 13280000
*                  Free Captured resources during end of jobstep task * 13320000
*                  termination.  This option will ensure that a given * 13360000
*                  task uncaptures a given page as many times as it   * 13400000
*                  captured that page, regardless of the specific     * 13440000
*                  UCBs on that page involved.  If this is not the    * 13480000
*                  case, IOS will perform the necessary uncaptures to * 13520000
*                  reduce the outstanding page captures of the task   * 13560000
*                  to zero.                                           * 13600000
*                                                                     * 13640000
*              LASTING=YES                                            * 13670000
*                  Do not free Capture resources during jobstep task  * 13700000
*                  termination.                                       * 13730000
*                                                                     * 13760000
*                                                                     * 13800000
*                                                                     * 13840000
*                                                                     * 13880000
*                                                                     * 13920000
*                                                                     * 13960000
*          ÝCAPTCOM=»NO!YES!NEVERº¨                                   * 14000000
*              is an optional keyword input that indicates that the   * 14040000
*              Actual UCB above the 16Mb line should be captured into * 14080000
*              COMMON storage.                                        * 14120000
*                                                                     * 14160000
*              NOTES:                                                 * 14200000
*                                                                     * 14240000
*                                                                     * 14280000
*                                                                     * 14320000
*                  o   If the Actual UCB above the 16Mb line was      * 14440000
*                      already captured into COMMON storage, this     * 14480000
*                      address will be passed back to the caller.     * 14520000
*                      This will occur even if the default CAPTCOM=NO * 14560000
*                      is specified. CAPTCOM=NEVER could be specified * 14586600
*                      to capture to private unconditionally.         * 14613200
*                                                                     * 14640000
*                  o   When CAPTCOM=YES is specified, its processing  * 14670000
*                      will be analagous to LASTING=YES.              * 14700000
*                                                                     * 14730000
*                  o   CAPTCOM is mutually exclusive with MSIFREE and * 14740000
*                      LASTING.                                       * 14750000
*                                                                     * 14760000
*                                                                     * 14800000
*                                                                     * 14840000
*                                                                     * 14880000
*              DEFAULT: NO                                            * 14920000
*                                                                     * 14960000
*                                                                     * 15000000
*              CAPTCOM=NO                                             * 15032000
*                  The Capturing of the Actual UCB above the 16Mb     * 15064000
*                  line will occur into PRIVATE storage of the        * 15096000
*                  current address space.                             * 15128000
*                                                                     * 15160000
*              CAPTCOM=YES                                            * 15190000
*                  The capturing of the Actual UCB above the 16Mb     * 15220000
*                  line will occur into COMMON storage.               * 15250000
*                                                                     * 15250900
*              CAPTCOM=NEVER                                          * 15251800
*                  The capturing of the Actual UCB above the 16Mb     * 15252700
*                  line will occur into PRIVATE storage               * 15253600
*                  unconditionally.                                   * 15254500
*                                                                     * 15255400
*                  NOTES:                                             * 15256300
*                                                                     * 15257200
*                                                                     * 15258100
*                                                                     * 15259000
*                      o   Since there are reasons why a CAPTCOM=NO   * 15259900
*                          request may still cause a UCB to be        * 15260800
*                          captured to common (i.e., If the UCB is    * 15261700
*                          already captured in common), this keyword  * 15262600
*                          can be used to force IOS to capture the    * 15263500
*                          UCB to private storage.                    * 15264400
*                                                                     * 15265300
*                      o   Specifying CAPTCOM=NEVER may cause         * 15266200
*                          duplicate UCB storage to be allocated in   * 15267100
*                          the case where the UCB is already captured * 15268000
*                          to common.                                 * 15268900
*                                                                     * 15269800
*                      o   Since captures done in MASTERS address     * 15270700
*                          space will always be captured to common    * 15271600
*                          storage, the CAPTCOM=NEVER specification   * 15272500
*                          will be ignored in this case.              * 15273400
*                                                                     * 15274300
*                                                                     * 15275200
*                                                                     * 15276100
*                                                                     * 15277000
*                                                                     * 15280000
*                                                                     * 15320000
*                                                                     * 15360000
*                                                                     * 15400000
*                                                                     * 15440000
*      UCAPTUCB                                                       * 15480000
*          Uncapture the UCB in the current address space.            * 15520000
*                                                                     * 15560000
*                                                                     * 15600000
*          CAPTPTR=xcaptptr                                           * 15640000
*              is the name (RS-type), or address in register          * 15680000
*              (2)-(12), of a required 4 byte input that contains the * 15720000
*              address of the common segment of the Captured UCB to   * 15760000
*              be uncaptured.                                         * 15800000
*                                                                     * 15800100
*                                                                     * 15800200
*                                                                     * 15800300
*                                                                     * 15800400
*          ÝLASTING=»NO!YESº¨                                         * 15800500
*              is an optional keyword input input that indicates      * 15800600
*              whether or not this UCAPTUCB is being issued to        * 15800700
*              un-capture a UCB that was previously captured using    * 15800800
*              CAPTUCB with LASTING=YES.                              * 15800900
*                                                                     * 15801000
*              NOTES:                                                 * 15801100
*                                                                     * 15801200
*                                                                     * 15801300
*                                                                     * 15801400
*                  o   The LASTING keyword will have no effect when   * 15801500
*                      capturing is being done on behalf of a caller  * 15801600
*                      in SRB mode.                                   * 15801700
*                                                                     * 15801800
*                  o   Cleanup will not be performed on behalf of     * 15801900
*                      callers in SRB mode that do not uncapture      * 15802000
*                      prior to terminating.                          * 15802100
*                                                                     * 15802200
*                  o   LASTING is mutually exclusive with CAPTCOM.    * 15802300
*                                                                     * 15802400
*                  o   If, and only if, LASTING=YES is specified when * 15802500
*                      capturing a UCB, LASTING=YES should be         * 15802600
*                      specified when releasing the same captured     * 15802700
*                      UCB.                                           * 15802800
*                                                                     * 15802900
*                                                                     * 15803000
*                                                                     * 15803100
*                                                                     * 15803200
*              DEFAULT: NO                                            * 15803300
*                                                                     * 15803400
*                                                                     * 15803500
*              LASTING=NO                                             * 15803600
*                  This is NOT a UCAPTUCB associated with a previous  * 15803700
*                  CAPTUCB (where LASTING=YES was specified).         * 15803800
*                                                                     * 15803900
*              LASTING=YES                                            * 15804000
*                  This IS a UCAPTUCB associated with a previous      * 15804100
*                  CAPTUCB (where LASTING=YES was specified).         * 15804200
*                                                                     * 15804300
*                                                                     * 15804400
*                                                                     * 15804500
*                                                                     * 15804600
*                                                                     * 15805700
*                                                                     * 15807600
*          ÝCAPTCOM=»NO!YESº¨                                         * 15809500
*              is an optional keyword input that indicates that the   * 15811400
*              Captured UCB should be uncaptured from COMMON storage. * 15813300
*              DEFAULT: NO                                            * 15815200
*                                                                     * 15817100
*                                                                     * 15819000
*              CAPTCOM=NO                                             * 15820900
*                  The captured UCB will be uncaptured from common    * 15822800
*                  storage when it is a common captured UCB.  The     * 15824700
*                  captured UCB will be uncaptured from private       * 15826600
*                  storage when it is a private captured UCB.         * 15828500
*                                                                     * 15830400
*              CAPTCOM=YES                                            * 15831800
*                  The captured UCB will be uncaptured from common    * 15833200
*                  storage.                                           * 15834600
*                                                                     * 15836100
*                                                                     * 15838000
*                                                                     * 15840000
*                                                                     * 15880000
*                                                                     * 15920000
*      CAPTOACT                                                       * 15960000
*          translate the address of the Captured UCB to the address   * 16000000
*          of the Actual UCB.                                         * 16040000
*                                                                     * 16080000
*          NOTES:                                                     * 16100000
*                                                                     * 16120000
*                                                                     * 16122600
*                                                                     * 16125200
*              o   This function will allow the caller to be in cross * 16127800
*                  memory mode.                                       * 16130400
*                                                                     * 16133000
*              o   The caller and the parameter list must be          * 16135600
*                  executing and getmained respectively in the        * 16138200
*                  primary address space.                             * 16140800
*                                                                     * 16143400
*                                                                     * 16146000
*                                                                     * 16148600
*                                                                     * 16151200
*                                                                     * 16153800
*                                                                     * 16156400
*          CAPTPTR=xcaptptr                                           * 16160000
*              is the name (RS-type), or address in register          * 16200000
*              (2)-(12), of a required 4 byte input that contains the * 16240000
*              address of the common segment of the Captured UCB.     * 16280000
*                                                                     * 16320000
*                                                                     * 16360000
*                                                                     * 16400000
*                                                                     * 16440000
*          UCBPTR=xucbptr                                             * 16480000
*              is the name (RS-type), or address in register          * 16520000
*              (2)-(12), of a required 4 byte output that will        * 16560000
*              contain the address of the Actual UCB (common          * 16600000
*              segment).                                              * 16640000
*                                                                     * 16680000
*                                                                     * 16720000
*                                                                     * 16760000
*                                                                     * 16800000
*          ÝASID=»xasid!CURRENTº¨                                     * 16840000
*              is the name (RS-type), or address in register          * 16880000
*              (2)-(12), of an optional halfword input indicates the  * 16920000
*              address space in which the Captured UCB was originally * 16960000
*              captured.                                              * 17000000
*                                                                     * 17003000
*              NOTES:                                                 * 17006000
*                                                                     * 17009000
*                                                                     * 17012000
*                                                                     * 17015000
*                  o   The caller must make sure that the ASID        * 17018000
*                      specified represents the desired address       * 17021000
*                      space.                                         * 17024000
*                                                                     * 17027000
*                                                                     * 17030000
*                                                                     * 17033000
*                                                                     * 17036000
*              DEFAULT: CURRENT                                       * 17040000
*                                                                     * 17080000
*                                                                     * 17120000
*                                                                     * 17160000
*                                                                     * 17200000
*                                                                     * 17240000
*      End of a set of mutually exclusive required keys.              * 17280000
*                                                                     * 17320000
*                                                                     * 17360000
*                                                                     * 17400000
*      ÝLINKAGE=»SYSTEM!BRANCHº¨                                      * 17440000
*          is an optional keyword input that indicates whether a      * 17480000
*          branch-entry linkage should be generated or a Program Call * 17520000
*          should be issued for the routine invocation.               * 17560000
*          DEFAULT: SYSTEM                                            * 17600000
*                                                                     * 17640000
*                                                                     * 17680000
*          LINKAGE=SYSTEM                                             * 17706600
*              requests Program Call invocation.                      * 17733200
*                                                                     * 17760000
*          LINKAGE=BRANCH                                             * 17800000
*              requests branch-entry invocation.  See ENVIRONMENT for * 17840000
*              the restrictions on branch-entry invocation.           * 17880000
*                                                                     * 17920000
*                                                                     * 17960000
*                                                                     * 18000000
*                                                                     * 18040000
*                                                                     * 18080000
*                                                                     * 18120000
*      ÝRETCODE=xretcode¨                                             * 18160000
*          is the name (RS-type) of an optional fullword output       * 18200000
*          variable, or register (2)-(12), into which the return code * 18240000
*          is to be copied from GPR 15.                               * 18280000
*                                                                     * 18320000
*                                                                     * 18360000
*                                                                     * 18400000
*                                                                     * 18440000
*      ÝRSNCODE=xrsncode¨                                             * 18480000
*          is the name (RS-type) of an optional fullword output       * 18520000
*          variable, or register (2)-(12), into which the reason code * 18560000
*          is to be copied from GPR 0.                                * 18600000
*                                                                     * 18640000
*                                                                     * 18680000
*                                                                     * 18720000
*                                                                     * 18760000
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 18761800
*          is an optional byte input decimal value in the "1-1" range * 18763600
*          that specifies the macro version.  PLISTVER is the only    * 18765400
*          key allowed on the list form of MF and determines which    * 18767200
*          parameter list is generated.  Note that MAX may be         * 18769000
*          specified instead of a number, and the parameter list will * 18770800
*          be of the largest size currently supported. This size may  * 18772600
*          grow from release to release (thus possibly affecting the  * 18774400
*          amount of storage needed by your program).  If your        * 18776200
*          program can tolerate this, IBM recommends that you always  * 18778000
*          specify MAX when creating the list form parameter list as  * 18779800
*          that will ensure that the list form parameter list is      * 18781600
*          always long enough to hold whatever parameters might be    * 18783400
*          specified on the execute form.                             * 18785200
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 18787000
*          default is the lowest version which allows all of the      * 18788800
*          parameters specified on the invocation to be processed.    * 18790600
*                                                                     * 18792400
*                                                                     * 18794200
*                                                                     * 18796000
*                                                                     * 18797800
*      ÝMF=»S!L!Eº¨                                                   * 18800000
*          is an optional keyword input which specifies the macro     * 18840000
*          form.                                                      * 18880000
*          DEFAULT: S                                                 * 18920000
*                                                                     * 18960000
*                                                                     * 19000000
*          ÝMF=S¨                                                     * 19040000
*              specifies the standard form of the macro.  The "S"     * 19080000
*              form generates code to put the parameters into an      * 19120000
*              in-line parameter list and invoke the desired service. * 19160000
*              Full checking for required macro keys is done along    * 19200000
*              with supplying defaults for omitted optional           * 19240000
*              parameters.                                            * 19280000
*                                                                     * 19320000
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 19360000
*              specifies the list form of the macro.  The "L" form    * 19400000
*              defines an area to be used for the parameter list.     * 19440000
*              Only the PLISTVER key may be specified on the          * 19456000
*              invocation.  All other macro parameters are flagged as * 19472000
*              errors.  If PLISTVER is not specified, the original    * 19488000
*              parameter list definition is used.                     * 19504000
*                                                                     * 19520000
*            ,xmfctrl                                                 * 19560000
*              is a required input.  It is the name of a storage area * 19600000
*              for the parameter list.                                * 19640000
*                                                                     * 19680000
*            »,xmfattr!0Dº                                            * 19720000
*              is an optional 60 character input string that varies   * 19760000
*              from 1 to 60 characters. Use it to force boundary      * 19810000
*              alignment of the parameter list. Use only 0F or 0D.    * 19860000
*              DEFAULT: 0D which forces the parameter list to a       * 19960000
*              doubleword boundary.                                   * 20000000
*                                                                     * 20040000
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 20080000
*              specifies the execute form of the macro.  The "E" form * 20120000
*              generates code to put the parameters into the          * 20160000
*              parameter list specified by xmfctrl and provides full  * 20200000
*              syntax checking with default setting.                  * 20240000
*                                                                     * 20280000
*            ,xmfctrl                                                 * 20320000
*              is a required input.  It is the name (RS-type), or     * 20360000
*              address in register (1)-(12), of a storage area for    * 20400000
*              the parameter list.                                    * 20440000
*                                                                     * 20480000
*            »,COMPLETEº                                              * 20520000
*              is an optional keyword input which specifies the       * 20560000
*              degree of macro parameter syntax checking.             * 20600000
*              DEFAULT: COMPLETE                                      * 20640000
*                                                                     * 20680000
*                                                                     * 20720000
*              COMPLETE                                               * 20752000
*                  Checking for required macro keys is done and       * 20784000
*                  defaults are supplied for omitted optional         * 20816000
*                  parameters.                                        * 20848000
*                                                                     * 20880000
*                                                                     * 20920000
*                                                                     * 20960000
*                                                                     * 21000000
*                                                                     * 21040000
*                                                                     * 21080000
*                                                                     * 21120000
*01* RETURN CODES:                                                    * 21160000
*                                                                     * 21200000
*                                                                     * 21240000
*                                                                     * 21280000
*                 X'00'     The requested function was successfully   * 21320000
*                           executed.                                 * 21360000
*                                                                     * 21400000
*                 X'04'     This return code is a warning, and its    * 21440000
*                           associated reason codes should be used to * 21480000
*                           determine the reason for the warning.     * 21520000
*                                                                     * 21560000
*                           Reason Codes                              * 21600000
*                                                                     * 21640000
*                                                                     * 21680000
*                           X'04'     The Actual UCB was BELOW the    * 21720000
*                                     16Mb line. The address of the   * 21760000
*                                     Actual UCB is returned, and     * 21800000
*                                     capture is not performed.       * 21840000
*                                     (This reason code is for the    * 21880000
*                                     CAPTUCB function)               * 21920000
*                                                                     * 21960000
*                           X'08'     The Actual UCB was BELOW the    * 22000000
*                                     16Mb line, and no uncapture     * 22040000
*                                     will be performed.  (This       * 22080000
*                                     reason code is for the UCAPTUCB * 22120000
*                                     function)                       * 22160000
*                                                                     * 22200000
*                           X'0C'     An Actual UCB was passed as     * 22240000
*                                     input and it will be returned   * 22280000
*                                     as the Actual UCB.  (This       * 22320000
*                                     reason code is for the CAPTOACT * 22360000
*                                     function)                       * 22400000
*                                                                     * 22440000
*                                                                     * 22480000
*                                                                     * 22520000
*                 X'08'     Unable to perform function                * 22560000
*                                                                     * 22600000
*                           Reason Codes                              * 22640000
*                                                                     * 22680000
*                                                                     * 22720000
*                           X'04'     The ASID specified does not     * 22760000
*                                     exist or the address space was  * 22800000
*                                     swapped out.  (This reason code * 22840000
*                                     is for the CAPTOACT function)   * 22880000
*                                                                     * 22920000
*                           X'08'     The specified Captured UCB does * 22960000
*                                     not exist in the current        * 23000000
*                                     address space.  (This reason    * 23040000
*                                     code is for the UCAPTUCB        * 23080000
*                                     function)                       * 23120000
*                                                                     * 23160000
*                           X'0C'     The specified UCB address must  * 23200000
*                                     be an Actual UCB address.       * 23240000
*                                     (This reason code is for the    * 23280000
*                                     CAPTUCB function)               * 23320000
*                                                                     * 23360000
*                           X'10'     The UCB address provided by the * 23400000
*                                     caller does not represent a     * 23440000
*                                     valid UCB.  (This reason code   * 23480000
*                                     is for all functions)           * 23520000
*                                                                     * 23560000
*                           X'14'     The invoker used MSIFREE and is * 23600000
*                                     not capturing during NIP.       * 23640000
*                                     (This reason code is for the    * 23680000
*                                     CAPTUCB function)               * 23720000
*                                                                     * 23760000
*                           X'18'     The invoker tried to uncapture  * 23800000
*                                     an Actual UCB which resides     * 23840000
*                                     above the 16Mb line.  (This     * 23880000
*                                     reason code is for the UCAPTUCB * 23920000
*                                     function)                       * 23960000
*                                                                     * 24000000
*                                                                     * 24040000
*                                                                     * 24080000
*                 X'20'     Unexpected error                          * 24120000
*                                                                     * 24160000
*                                                                     * 24200000
*                                                                     * 24240000
*                                                                     * 24280000
*                                                                     * 24320000
*01* REASON CODES:                                                    * 24360000
*                                                                     * 24400000
*       See return codes section.                                     * 24440000
*                                                                     * 24480000
*01* ABEND CODES:                                                     * 24520000
*                                                                     * 24560000
*                                                                     * 24600000
*       2C6       Failure occurred during validation checking or      * 24640000
*                 while using storage passed by the caller.           * 24680000
*                                                                     * 24720000
*                                                                     * 24760000
*                                                                     * 24800000
*01* ABEND REASON CODES:                                              * 24840000
*                                                                     * 24880000
*       REASON    ABEND                                               * 24920000
*       CODE      CODE      DESCRIPTION                               * 24960000
*       ××××××××  ××××××××  ×××××××××××                               * 25000000
*                                                                     * 25040000
*                                                                     * 25080000
*       01000100  2C6       Invalid serialization.  Caller is holding * 25120000
*                           a  lock or is not enabled when requesting * 25160000
*                           the   CAPTUCB   CAPTCOM=NO  and  UCAPTUCB * 25173300
*                           CAPTCOM=NO  functions.  Caller is holding * 25186600
*                           a  lock higher than the IOSULUT lock when * 25199900
*                           requesting  the  CAPTUCB  CAPTCOM=YES  or * 25213200
*                           UCAPTUCB CAPTCOM=YES functions.           * 25226500
*                                                                     * 25240000
*       01000101  2C6       Invalid serialization.  Caller is holding * 25280000
*                           a  lock  higher  than  the ULUT lock when * 25320000
*                           requesting CAPTOACT function.             * 25360000
*                                                                     * 25400000
*       01000102  2C6       Invalid dispatchable unit mode. Caller is * 25440000
*                           in   SRB   mode   during   NIP   and   PC * 25480000
*                           authorization is not available.           * 25520000
*                                                                     * 25560000
*       01000103  2C6       Invalid  cross  memory mode. Caller is in * 25600000
*                           cross  memory mode (PASN ^= SASN ^= HOME) * 25620000
*                           when  requesting the CAPTUCB and UCAPTUCB * 25640000
*                           functions.                                * 25660000
*                                                                     * 25680000
*       01000104  2C6       PKM  invalid.  Caller is in problem state * 25720000
*                           and the PKM is not 0 - 7 while performing * 25760000
*                           the  CAPTUCB, UCAPTUCB, and CAPTOACT with * 25800000
*                           ASID specified functions.                 * 25840000
*                                                                     * 25880000
*       01000200  2C6       Invalid parameter list.  Caller passed an * 25920000
*                           invalid version of the parameter list.    * 25960000
*                                                                     * 26000000
*       01000201  2C6       Invalid  parameter list.   Parameter list * 26040000
*                           integrity compromised.                    * 26080000
*                                                                     * 26120000
*                           NOTES:                                    * 26160000
*                                                                     * 26200000
*                                                                     * 26240000
*                                                                     * 26280000
*                               o   More  than  one  of  the mutually * 26320000
*                                   exclusive keywords was specified. * 26360000
*                                                                     * 26400000
*                               o   A   function  was  not  specified * 26440000
*                                   where one was required.           * 26480000
*                                                                     * 26520000
*                               o   Reserved fields are not zero.     * 26560000
*                                                                     * 26600000
*                               o   The  required keywords associated * 26640000
*                                   with the function are missing.    * 26680000
*                                                                     * 26720000
*                                                                     * 26760000
*                                                                     * 26800000
*                                                                     * 26840000
*                                                                     * 26880000
*       01000202  2C6       Invalid  parameter list. Caller passed an * 26920000
*                           invalid   parameter  list  and  an  error * 26960000
*                           occurred reading the list.                * 27000000
*                                                                     * 27040000
*       01000203  2C6       Invalid  parameter list. Caller passed an * 27080000
*                           invalid   parameter  list  and  an  error * 27120000
*                           occurred updating the list.               * 27160000
*                                                                     * 27200000
*       01000204  2C6       Invalid  Alet.  Caller's  parameter  list * 27240000
*                           alet is invalid.                          * 27280000
*                                                                     * 27320000
*       01000205  2C6       Invalid  Function. The function requested * 27360000
*                           does not exist.                           * 27400000
*                                                                     * 27406600
*       01000300  2C6       Invalid  Uncapture.  The uncapture of the * 27413200
*                           specified  Captured  UCB would exceed the * 27419800
*                           number  of  LASTING,  MSIFREE or SRB mode * 27426400
*                           CAPTCOM=NO captures.                      * 27433200
*                                                                     * 27440000
*                                                                     * 27480000
*                                                                     * 27520000
*01* MODULE TYPE:  ASSEM MACRO                                        * 27560000
*                                                                     * 27600000
*02*   PROCESSOR:  ASSEM                                              * 27640000
*                                                                     * 27680000
*01* COMPONENT:  SC1C3                                                * 27720000
*                                                                     * 27760000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 27800000
*                                                                     * 27840000
*01* MACRO USAGE NOTES:                                               * 27880000
*                                                                     * 27920000
*                                                                     * 27960000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 28000000
*        global macro variable.  Any value other than 'NO' will       * 28040000
*        result in the macro expansion being printed.  The default is * 28080000
*        'YES'.  The following examples illustrate how the ZPRINT     * 28120000
*        variable should be set.                                      * 28160000
*                                                                     * 28200000
*                    GBLC &ZPRINT                                     * 28240000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 28280000
*                                                                     * 28320000
*                                                                     * 28360000
*    2.  All keys currently contained in the IOSCAPU macro correspond * 28370000
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 28380000
*        MAX.                                                         * 28390000
*                                                                     * 28400000
*                                                                     * 28410000
*                                                                     * 28420000
*                                                                     * 28430000
*01* CHANGE ACTIVITY:                                                 * 28440000
*                                                                     * 28480000
*   Flag LineItem  FMID    Date   ID    Comment                       * 28520000
*                                                                     * 28560000
*    $L0=UCBVP    HBB5520 940106 PDKB:  UCB VSCR Support - New        * 28600000
*                                         service                     * 28640000
*    $L1=UCBVP    HBB5520 940210 PDKB:  UCB VSCR Support - Make       * 28650000
*                                         MSIFREE, LASTING, and       * 28660000
*                                         CAPTCOM mutually exclusive  * 28670000
*    $L2=UCBVP    HBB5520 940310 PDKB:  UCB VSCR Support - Allow      * 28672500
*                                         cross memory mode for the   * 28675000
*                                         CAPTOACT function           * 28677500
*    $L3=UCBVP    HBB5520 940310 PDKB:  UCB VSCR Support - Add a new  * 28677900
*                                         reason code to ABEND2C6     * 28678300
*    $P1=PN70256  HBB5520 940310 PDKB:  Added note to CAPTOACT that   * 28678700
*                                         the IOSULUT lock cannot be  * 28679100
*                                         held exclusively            * 28679500
*    $P2=PN70822  HBB5520 940728 PDLS:  Add CAPTCOM to UCAPTUCB and   * 28679600
*                                         allow IOSULUT lock and      * 28679700
*                                         lower locks to be held when * 28679800
*                                         CAPTCOM=YES is specified    * 28679900
*    $01=OW12724  HBB5520 950602 PDMC:  Allow macro to be used in     * 28689900
*                                         relocatable code.           * 28699900
*    $02=OW40658  HBB6603 000115 PD00A8:  Add LASTING to UCAPTUCB.    * 28704900
*    $03=OW46651  HBB6608 001215 PD00PS:  Add a new option for        * 28706100
*                                         CAPTCOM for capturing to    * 28707300
*                                         PRIVATE unconditionally.    * 28708500
****** END OF SPECIFICATIONS *****************************************/ 28709900
*/* TLINE 1 *********************************************************** 28734900
         MACRO                                                          28760000
&XLABEL  IOSCAPU &UCBPTR=,&CAPTPTR=,&MSIFREE=,&LASTING=,&CAPTCOM=,     *28800000
               &ASID=,&LINKAGE=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=     28840000
.*                                                                      28880000
*              MACDATE -01/22/01-<1>                                    28920000
.*                                                                      28960000
.*******************************************************************    29000000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        29040000
.*******************************************************************    29080000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   29120000
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     29160000
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             29200000
.*                                                                      29240000
              GBLC  &ZIOSCAPU   YES=MACRO USED AT LEAST ONCE            29280000
.*******************************************************************    29320000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          29360000
.*******************************************************************    29400000
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 29440000
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            29480000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              29520000
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             29560000
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             29600000
              LCLA  &ZAWRK      USED AS A WORK AREA                     29640000
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  29680000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   29720000
              LCLC  &ZC         CHARACTER WORK VARIABLE                 29760000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             29800000
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 29840000
              LCLC  &ZMAC_G     "G" or null                             29844400
&ZMAC_G       SETC  ''                                                  29848800
              LCLC  &ZMAC_LR                                            29853200
&ZMAC_LR      SETC  'LR'                                                29857600
              LCLC  &ZMAC_L                                             29862000
&ZMAC_L       SETC  'L'                                                 29866400
              LCLC  &ZMAC_ST                                            29870800
&ZMAC_ST      SETC  'ST'                                                29875200
              LCLA  &ZMACRET    MACRO RETURN CODE                       29880000
&ZMACRET      SETA  0           ASSUME NO ERRORS                        29920000
.*                                                                      29960000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      30000000
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              30040000
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   30080000
              LCLC  &ZENDBASEPL                 End of base PL          30083300
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   30086600
.*******************************************************************    30089900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             30093200
.*******************************************************************    30096500
              LCLA  &ZI         INDEX FOR ARRAY                         30099800
              LCLA  &ZJ         INDEX FOR PARMS                         30103100
              LCLA  &ZK         INDEX FOR PARSE                         30106400
              LCLA  &ZLO        LOW RANGE VALUE                         30109700
              LCLA  &ZHI        HIGH RANGE VALUE                        30113000
              LCLC  &ZW         WORK AREA FOR PARM                      30116300
.********************************************************************   30120000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 30160000
.********************************************************************   30200000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 30240000
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          30280000
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        30300000
.*                                                                      30320000
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       30360000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        30400000
              SPLEVEL  TEST                                             30440000
.ZSYS2        ANOP  ,                                                   30480000
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              30520000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              30560000
              SYSSTATE TEST                                             30600000
              AGO   .ZSYS4                                              30640000
.ZSYS3        ANOP  ,                                                   30680000
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 30720000
.ZSYS4        ANOP  ,                                                   30760000
.*******************************************************************    30800000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   30840000
.*******************************************************************    30880000
              LCLC  &XFUNCTN    ++ VALUE                                30920000
              LCLC  &XCAPTUCB   ++ VALUE                                30960000
              LCLC  &XUCBPTR    ++ NAME                                 31000000
              LCLC  &XCAPTPTR   ++ NAME                                 31040000
              LCLC  &XMSIFREE   ++ VALUE                                31080000
              LCLC  &XLASTING   ++ VALUE                                31120000
              LCLC  &XCAPTCOM   ++ VALUE                                31160000
              LCLC  &XUCAPTUCB  ++ VALUE                                31200000
              LCLC  &XCAPTOACT  ++ VALUE                                31240000
              LCLC  &XASID      ++ NAME                                 31280000
              LCLC  &XLINKAGE   ++ VALUE                                31320000
              LCLC  &XRETCODE   ++ NAME                                 31360000
              LCLC  &XRSNCODE   ++ NAME                                 31400000
              LCLA  &XPLISTVER  ++ VALUE                                31420000
              LCLC  &XMF        ++ VALUE                                31440000
              LCLC  &XMFCTRL    ++ NAME                                 31480000
              LCLC  &XMFATTR    ++ VALUE                                31520000
              LCLC  &XMFSCK     ++ VALUE                                31560000
.*******************************************************************    31600000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           31640000
.*******************************************************************    31680000
              LCLC  &ZXFUNCTN   ++ INPUT VALUE                          31720000
              LCLC  &ZXCAPTUCB  ++ INPUT VALUE                          31760000
              LCLC  &ZXUCBPTR   ++ INPUT NAME                           31800000
              LCLC  &ZXCAPTPTR  ++ OUTPUT NAME                          31840000
              LCLC  &ZXMSIFREE  ++ INPUT VALUE                          31880000
              LCLC  &ZXLASTING  ++ INPUT VALUE                          31920000
              LCLC  &ZXCAPTCOM  ++ INPUT VALUE                          31960000
              LCLC  &ZXUCAPTUCB                 ++ INPUT VALUE          32000000
              LCLC  &ZXCAPTOACT                 ++ INPUT VALUE          32040000
              LCLC  &ZXASID     ++ INPUT NAME                           32080000
              LCLC  &ZXLINKAGE  ++ INPUT VALUE                          32120000
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          32160000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          32200000
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          32220000
              LCLC  &ZXMF       ++ INPUT VALUE                          32240000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           32280000
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          32320000
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          32360000
.********************************************************************   32400000
.***AC.PLV01  PROCESS PLISTVER                                      *   32400700
.********************************************************************   32401400
&XPLISTVER      SETA  1                                                 32402100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       32402800
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   32403500
&XPLISTVER      SETA  1                                                 32404200
.ZPLV0          ANOP  ,                                                 32404900
.*                                                                      32405600
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      32406300
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      32407000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  32407700
.*-------------------------------------------------------------------   32408400
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 32409100
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                32409800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 32410500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 32411200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               32411900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                32412600
                AGO   .ZPVCK2                                           32413300
.ZPVCK3         ANOP  ,                                                 32414000
.*-------------------------------------------------------------------   32414700
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  32415400
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                32416100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 32416800
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         32417500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 32418200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                32418900
                AGO   .ZPVCKE                                           32419600
.ZPVCK2         ANOP  ,                                                 32420300
.*-------------------------------------------------------------------   32421000
&ZCVAL          SETC  '&PLISTVER(1)'                                    32421100
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             32421200
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             32421300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        32421700
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      32421800
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     32421900
.ZPVCK6         ANOP  ,                                                 32422000
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                32422100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 32422200
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         32422300
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         32422400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                32422500
&XPLISTVER      SETA  1                                                 32422600
                AGO   .ZPVCKE                                           32422700
.*-------------------------------------------------------------------   32422800
.ZPVCK4A        ANOP  ,                                                 32422900
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        32423000
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                32423100
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               32423800
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          32424500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 32425200
                MNOTE 8,' &ZMS IS REQUIRED.'                            32425900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                32426600
                AGO   .ZPVCK5                                           32427300
.ZPVCK4         ANOP  ,                                                 32428000
&XPLISTVER      SETA  &PLISTVER(1)                                      32428700
.ZPVCK5         ANOP  ,                                                 32429400
.ZPVCKE         ANOP  ,                                                 32434300
.********************************************************************   32439200
.***AG.MF01 PROCESS MF MACRO FORMS                                      32440000
.********************************************************************   32480000
              ACTR  10000                                               32520000
.*------------------------------------------------------------------    32560000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           32600000
&XMF          SETC  ''          INITIALIZE XVARIABLE                    32640000
.*-------------------------------------------------------------------   32680000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           32720000
.ZG66         ANOP  ,                                                   32760000
&ZTLC         SETC 'S'                                                  32800000
              AIF   ('&MF(1)' NE '&ZTLC').ZG67                          32840000
&XMF          SETC  'S'         SET KEYWORD                             32880000
              AIF   (N'&MF LE 1).ZG66A          CK NUM                  32920000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           32960000
&ZMS          SETC  '&ZMS.&MF"'                                         33000000
&ZMS          SETC  '&ZMS "MF"'                                         33040000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 33080000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33120000
.ZG66A        ANOP  ,                                                   33160000
.*-------------------------------------------------------------------   33200000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           33240000
.ZG67         ANOP  ,                                                   33280000
&ZTLC         SETC 'L'                                                  33320000
              AIF   ('&MF(1)' NE '&ZTLC').ZG74                          33360000
&XMF          SETC  'L'         SET KEYWORD                             33400000
              AIF   (N'&MF LE 3).ZG67A          CK NUM                  33440000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           33480000
&ZMS          SETC  '&ZMS.&MF"'                                         33520000
&ZMS          SETC  '&ZMS "MF"'                                         33560000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                33600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33640000
.ZG67A        ANOP  ,                                                   33680000
.*-------------------------------------------------------------------   33720000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     33760000
              AIF   (N'&SYSLIST NE 0).ZG67B     POSITIONALS?            33800000
              AIF   ('&UCBPTR' NE '').ZG67B     KEYS?                   33840000
              AIF   ('&CAPTPTR' NE '').ZG67B    KEYS?                   33880000
              AIF   ('&MSIFREE' NE '').ZG67B    KEYS?                   33920000
              AIF   ('&LASTING' NE '').ZG67B    KEYS?                   33960000
              AIF   ('&CAPTCOM' NE '').ZG67B    KEYS?                   34000000
              AIF   ('&ASID' NE '').ZG67B       KEYS?                   34040000
              AIF   ('&LINKAGE' NE '').ZG67B    KEYS?                   34080000
              AIF   ('&RETCODE' NE '').ZG67B    KEYS?                   34120000
              AIF   ('&RSNCODE' NE '').ZG67B    KEYS?                   34160000
              AGO    .ZG67C     INVOCATION OKAY                         34200000
.ZG67B        ANOP  ,                                                   34240000
&ZMS          SETC  'THE "L" FORM OF "MF"'      *MFLA* MNOTE            34280000
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                34320000
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           34360000
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              34400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34440000
.ZG67C        ANOP  ,                                                   34480000
.*-------------------------------------------------------------------   34520000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   34560000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           34600000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           34640000
              AIF   (N'&MF(2) GT 1).ZG69B       MULTI PARMS             34680000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           34720000
.ZG69B        AIF   (K'&MF(2) GT 0).ZG69C                               34760000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         34800000
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 34840000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 34880000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        34920000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34960000
.ZG69C        ANOP  ,                                                   35000000
.*-------------------------------------------------------------------   35040000
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               35080000
              AIF   (K'&ZXMFCTRL LE 0).ZG69P    NOT I/O                 35120000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG69P                      35160000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         35200000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           35240000
&ZMS          SETC  '&ZMS.&MF"'                                         35280000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           35320000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   35360000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             35400000
.ZG69P        ANOP  ,                                                   35440000
.*-------------------------------------------------------------------   35480000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      35520000
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           35560000
&XMFATTR      SETC  '0D'                                                35600000
              AIF   (K'&MF(3) LE 0).ZG72B       PARM                    35640000
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           35680000
              AIF   (N'&MF(3) GT 1).ZG72B       MULTI PARMS             35720000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           35760000
.ZG72B        ANOP  ,                                                   35800000
.*-------------------------------------------------------------------   35840000
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  35880000
              AIF   (K'&ZXMFATTR LE 0).ZG72P    NOT I/O                 35920000
              AIF   ('&XMFATTR'(1,1) NE '(').ZG72P                      35960000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         36000000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           36040000
&ZMS          SETC  '&ZMS.&MF"'                                         36080000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           36120000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   36160000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36200000
.ZG72P        ANOP  ,                                                   36240000
.*-------------------------------------------------------------------   36280000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 36320000
              AIF   (K'&ZXMFATTR LE 0).ZG72S    NOT I/O                 36360000
              AIF   (K'&XMFATTR LE 60).ZG72S    LNG OK                  36400000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         36440000
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           36480000
&ZMS          SETC  '&ZMS.&MF"'                                         36520000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               36560000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  36600000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36640000
.ZG72S        ANOP  ,                                                   36680000
.*-------------------------------------------------------------------   36720000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36760000
.ZG74         ANOP  ,                                                   36800000
&ZTLC         SETC 'E'                                                  36840000
              AIF   ('&MF(1)' NE '&ZTLC').ZG82                          36880000
&XMF          SETC  'E'         SET KEYWORD                             36920000
              AIF   (N'&MF LE 3).ZG74A          CK NUM                  36960000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           37000000
&ZMS          SETC  '&ZMS.&MF"'                                         37040000
&ZMS          SETC  '&ZMS "MF"'                                         37080000
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                37120000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37160000
.ZG74A        ANOP  ,                                                   37200000
.*-------------------------------------------------------------------   37240000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   37280000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           37320000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           37360000
              AIF   (N'&MF(2) GT 1).ZG76B       MULTI PARMS             37400000
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           37440000
.ZG76B        AIF   (K'&MF(2) GT 0).ZG76C                               37480000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         37520000
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 37560000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 37600000
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        37640000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37680000
.ZG76C        ANOP  ,                                                   37720000
.*-------------------------------------------------------------------   37760000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              37800000
              AIF   (K'&ZXMFCTRL LE 0).ZG76R    NOT I/O                 37840000
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG76R                      37880000
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          37920000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG76P                        37960000
              AIF   (K'&ZCGPR GT 2).ZG76Q                               38000000
              AIF   ('&ZCGPR' EQ '0').ZG76Q                             38040000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       38080000
              AIF   (T'&ZCGPR NE 'N').ZG76Q     INVALID REG NAME        38120000
.ZG76P        ANOP  ,                                                   38160000
              AIF   (T'&ZCGPR NE 'N').ZG76R     NON NUMERIC             38200000
              AIF   ('&ZCGPR' LT '1').ZG76Q                             38240000
              AIF   ('&ZCGPR' LE '12').ZG76R                            38280000
.ZG76Q        ANOP  ,                                                   38320000
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           38360000
&ZMS          SETC  '&ZMS.&MF"'                                         38400000
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           38440000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    38480000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             38520000
.ZG76R        ANOP  ,                                                   38560000
.*-------------------------------------------------------------------   38600000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             38640000
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    38680000
.ZG80A   AIF   ('&MF(3)' NE 'COMPLETE').ZG81A                           38720000
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             38760000
.*-------------------------------------------------------------------   38800000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             38840000
.ZG81A        AIF   (K'&XMFSCK GT 0).ZG81C      KEYWORD                 38880000
              AIF   (K'&MF(3) LE 0).ZG81B                               38920000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           38960000
&ZMS          SETC  '&ZMS.&MF"'                                         39000000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           39040000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 39080000
&ZMS          SETC  '&ZMS "COMPLETE".'                                  39120000
              MNOTE 8,' &ZMS '                                          39160000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39200000
.ZG81B        ANOP  ,                                                   39240000
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     39280000
.ZG81C        ANOP  ,                                                   39320000
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           39360000
.*------------------------------------------------------------------    39400000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           39440000
.ZG82         ANOP  ,                                                   39480000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           39520000
              AIF   (K'&XMF GT 0).ZG82E         VALID ARG               39560000
              AIF   (T'&MF EQ 'O').ZG82D        OMITTED                 39600000
&ZASYSLNDX    SETA  0                                                   39640000
.ZG82A        ANOP  ,           POSITIONAL MACRO KEY                    39680000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        39720000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG82C                    39760000
&ZTLC         SETC 'MF'                                                 39800000
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG82A           39840000
.ZG82B        ANOP  ,                                                   39880000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         39920000
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           39960000
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             40000000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    40040000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40080000
              AGO   .ZG82E                                              40120000
.ZG82C        ANOP  ,                                                   40160000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         40200000
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           40240000
&ZMS          SETC  '&ZMS.&MF"'                                         40280000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           40320000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 40360000
&ZMS          SETC  '&ZMS "S",'                                         40400000
&ZMS          SETC  '&ZMS "L",'                                         40440000
&ZMS          SETC  '&ZMS OR "E".'                                      40480000
              MNOTE 8,' &ZMS '                                          40520000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40560000
              AGO   .ZG82E                                              40600000
.ZG82D        ANOP  ,                                                   40640000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     40680000
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       40720000
.ZG82E        ANOP  ,                                                   40760000
.********************************************************************   40800000
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 40840000
.********************************************************************   40880000
              ACTR  10000                                               40920000
.*-------------------------------------------------------------------   40960000
.***AG.MF03 MF=(SLE)                                                    41000000
              AIF   ('&XMF' EQ 'L').ZGMFX                               41040000
.*-------------------------------------------------------------------   41080000
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  41120000
&XFUNCTN      SETC  ''          INITIALIZE XVARIABLE                    41160000
&ZASYSLNDX    SETA  0                                                   41200000
.ZG2A         ANOP  ,           POSITIONAL KEY SEARCH                   41240000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         41280000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    41320000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             41360000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CAPTUCB').ZG2A               41400000
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         41440000
&ZXFUNCTN     SETC  'INPUT'     SET IN/OUTPUT                           41480000
&XFUNCTN      SETC  'CAPTUCB'   SET XVARIABLE                           41520000
&ZXCAPTUCB    SETC  'INPUT'     SET IN/OUTPUT                           41560000
&XCAPTUCB     SETC  'CAPTUCB'   SET XVARIABLE PARM                      41600000
.ZG2B         ANOP  ,                                                   41640000
.*-------------------------------------------------------------------   41680000
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  41720000
&ZASYSLNDX    SETA  0                                                   41760000
.ZG25A        ANOP  ,           POSITIONAL KEY SEARCH                   41800000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         41840000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG25C  DONE                   41880000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG25A            41920000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'UCAPTUCB').ZG25A             41960000
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         42000000
              AIF   (K'&XFUNCTN LE 0).ZG25B     VALID                   42040000
&ZMS          SETC  '"UCAPTUCB'                 *KMEKA* MNOTE           42080000
&ZMS          SETC  '&ZMS."'                                            42120000
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               42160000
&ZMS          SETC  '&ZMS "&XFUNCTN"'                                   42200000
              MNOTE 8,' &ZMS KEY.'                                      42240000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             42280000
              AGO   .ZG25C                                              42320000
.*                                                                      42360000
.ZG25B        ANOP  ,                                                   42400000
&ZXFUNCTN     SETC  'INPUT'     SET IN/OUTPUT                           42440000
&XFUNCTN      SETC  'UCAPTUCB'  SET XVARIABLE                           42480000
&ZXUCAPTUCB   SETC  'INPUT'     SET IN/OUTPUT                           42520000
&XUCAPTUCB    SETC  'UCAPTUCB'  SET XVARIABLE PARM                      42560000
.ZG25C        ANOP  ,                                                   42600000
.*-------------------------------------------------------------------   42640000
.***AG.KMEKY06 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  42680000
&ZASYSLNDX    SETA  0                                                   42720000
.ZG39A        ANOP  ,           POSITIONAL KEY SEARCH                   42760000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         42800000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG39C  DONE                   42840000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG39A            42880000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CAPTOACT').ZG39A             42920000
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         42960000
              AIF   (K'&XFUNCTN LE 0).ZG39B     VALID                   43000000
&ZMS          SETC  '"CAPTOACT'                 *KMEKA* MNOTE           43040000
&ZMS          SETC  '&ZMS."'                                            43080000
&ZMS          SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'               43120000
&ZMS          SETC  '&ZMS "&XFUNCTN"'                                   43160000
              MNOTE 8,' &ZMS KEY.'                                      43200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             43240000
              AGO   .ZG39C                                              43280000
.*                                                                      43320000
.ZG39B        ANOP  ,                                                   43360000
&ZXFUNCTN     SETC  'INPUT'     SET IN/OUTPUT                           43400000
&XFUNCTN      SETC  'CAPTOACT'  SET XVARIABLE                           43440000
&ZXCAPTOACT   SETC  'INPUT'     SET IN/OUTPUT                           43480000
&XCAPTOACT    SETC  'CAPTOACT'  SET XVARIABLE PARM                      43520000
.ZG39C        ANOP  ,                                                   43560000
.*------------------------------------------------------------------    43600000
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          43640000
              AIF   (K'&XFUNCTN GT 0).ZG49B                             43680000
&ZXFUNCTN     SETC  ''          RESET IN/OUTPUT                         43720000
&ZXCAPTUCB    SETC  ''          RESET IN/OUTPUT                         43760000
&XFUNCTN      SETC  ''          ENSURE NULL                             43800000
&XCAPTUCB     SETC  ''          ENSURE NULL                             43840000
&ZMS          SETC  'ONE OF THE FOLLOWING'      *KMERA* MNOTE           43880000
&ZMS          SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'                 43920000
&ZMS          SETC  '&ZMS REQUIRED:'                                    43960000
&ZMS          SETC  '&ZMS "CAPTUCB",'           VALID ME KEY            44000000
&ZMS          SETC  '&ZMS "UCAPTUCB",'          VALID ME KEY            44040000
&ZMS          SETC  '&ZMS OR "CAPTOACT".'       VALID ME KEY            44080000
              MNOTE 8,' &ZMS '                                          44120000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44160000
.ZG49B        ANOP  ,                                                   44200000
.*-------------------------------------------------------------------   44240000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          44280000
.ZG2          AIF   ('&XFUNCTN' NE 'CAPTUCB').ZG25                      44320000
.*-------------------------------------------------------------------   44360000
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               44400000
&ZCVAL        SETC ''           ERROR KEY FIELD                         44440000
.ZG2I0        AIF   (K'&ASID LE 0).ZG2I1                                44480000
&ZCVAL        SETC '&ZCVAL ASID'                DISALLOWED KEY          44520000
.ZG2I1        AIF   (K'&ZCVAL LE 0).ZG2J        KEY                     44560000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               44600000
&ZMS          SETC  '"CAPTUCB'  *KMEIA* MNOTE                           44640000
&ZMS          SETC  '&ZMS."'                                            44680000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                44720000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                44760000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44800000
.ZG2J         ANOP  ,                                                   44840000
.*----------------------------------------------------------------***   45720000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     45760000
              AIF   (N'&UCBPTR LE 1).ZG4A       CK NUM                  45800000
&ZMS          SETC  '"UCBPTR='  *KPOSA* MNOTE                           45840000
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     45880000
&ZMS          SETC  '&ZMS "UCBPTR"'                                     45920000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 45960000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             46000000
.ZG4A         ANOP  ,                                                   46040000
.*-------------------------------------------------------------------   46080000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         46120000
&ZXUCBPTR     SETC  'INPUT'     SET IN/OUTPUT                           46160000
&XUCBPTR      SETC  '&UCBPTR(1)'                SET XVARIABLE           46200000
              AIF   (N'&UCBPTR GT 1).ZG4B       MULTI PARMS             46240000
&XUCBPTR      SETC  '&UCBPTR'   SET XVARIABLE                           46280000
.ZG4B         AIF   (K'&UCBPTR(1) GT 0).ZG4C                            46320000
&ZXUCBPTR     SETC  ''          RESET IN/OUTPUT                         46360000
&ZMS          SETC  ' '         *KRQDA*                                 46400000
&ZMS          SETC  '&ZMS "UCBPTR" KEY AND ITS'                         46440000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    46480000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             46520000
.ZG4C         ANOP  ,                                                   46560000
.*-------------------------------------------------------------------   46600000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    46640000
              AIF   (K'&ZXUCBPTR LE 0).ZG4R     NOT I/O                 46680000
              AIF   ('&XUCBPTR'(1,1) NE '(').ZG4R                       46720000
&ZCGPR        SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                          46760000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                         46800000
              AIF   (K'&ZCGPR GT 2).ZG4Q                                46840000
              AIF   ('&ZCGPR' EQ '0').ZG4Q                              46880000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       46920000
              AIF   (T'&ZCGPR NE 'N').ZG4Q      INVALID REG NAME        46960000
.ZG4P         ANOP  ,                                                   47000000
              AIF   (T'&ZCGPR NE 'N').ZG4R      NON NUMERIC             47040000
              AIF   ('&ZCGPR' LT '2').ZG4Q                              47080000
              AIF   ('&ZCGPR' LE '12').ZG4R                             47120000
.ZG4Q         ANOP  ,                                                   47160000
&ZMS          SETC  '"UCBPTR='  *KGPRA* MNOTE                           47200000
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     47240000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           47280000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    47320000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47360000
.ZG4R         ANOP  ,                                                   47400000
.*----------------------------------------------------------------***   47440000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    47480000
              AIF   (N'&CAPTPTR LE 1).ZG7A      CK NUM                  47520000
&ZMS          SETC  '"CAPTPTR='                 *KPOSA* MNOTE           47560000
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    47600000
&ZMS          SETC  '&ZMS "CAPTPTR"'                                    47640000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 47680000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47720000
.ZG7A         ANOP  ,                                                   47760000
.*-------------------------------------------------------------------   47800000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        47840000
&ZXCAPTPTR    SETC  'OUTPUT'    SET IN/OUTPUT                           47880000
&XCAPTPTR     SETC  '&CAPTPTR(1)'               SET XVARIABLE           47920000
              AIF   (N'&CAPTPTR GT 1).ZG7B      MULTI PARMS             47960000
&XCAPTPTR     SETC  '&CAPTPTR'  SET XVARIABLE                           48000000
.ZG7B         AIF   (K'&CAPTPTR(1) GT 0).ZG7C                           48040000
&ZXCAPTPTR    SETC  ''          RESET IN/OUTPUT                         48080000
&ZMS          SETC  ' '         *KRQDA*                                 48120000
&ZMS          SETC  '&ZMS "CAPTPTR" KEY AND ITS'                        48160000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    48200000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             48240000
.ZG7C         ANOP  ,                                                   48280000
.*-------------------------------------------------------------------   48320000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   48360000
              AIF   (K'&ZXCAPTPTR LE 0).ZG7R    NOT I/O                 48400000
              AIF   ('&XCAPTPTR'(1,1) NE '(').ZG7R                      48440000
&ZCGPR        SETC  '&XCAPTPTR'(2,K'&XCAPTPTR-2)                        48480000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                         48520000
              AIF   (K'&ZCGPR GT 2).ZG7Q                                48560000
              AIF   ('&ZCGPR' EQ '0').ZG7Q                              48600000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       48640000
              AIF   (T'&ZCGPR NE 'N').ZG7Q      INVALID REG NAME        48680000
.ZG7P         ANOP  ,                                                   48720000
              AIF   (T'&ZCGPR NE 'N').ZG7R      NON NUMERIC             48760000
              AIF   ('&ZCGPR' LT '2').ZG7Q                              48800000
              AIF   ('&ZCGPR' LE '12').ZG7R                             48840000
.ZG7Q         ANOP  ,                                                   48880000
&ZMS          SETC  '"CAPTPTR='                 *KGPRA* MNOTE           48920000
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    48960000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           49000000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    49040000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49080000
.ZG7R         ANOP  ,                                                   49120000
.*----------------------------------------------------------------***   49160000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             49200000
              AIF   (N'&MSIFREE LE 1).ZG10A     CK NUM                  49240000
&ZMS          SETC  '"MSIFREE='                 *KPOSA* MNOTE           49280000
&ZMS          SETC  '&ZMS.&MSIFREE"'                                    49320000
&ZMS          SETC  '&ZMS "MSIFREE"'                                    49360000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 49400000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49440000
.ZG10A        ANOP  ,                                                   49480000
.*-------------------------------------------------------------------   49520000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             49560000
&XMSIFREE     SETC  ''          INITIALIZE XVARIABLE                    49600000
.ZG11A   AIF   ('&MSIFREE(1)' NE 'NO').ZG12A                            49640000
&XMSIFREE     SETC  'NO'        SET KEYWORD                             49680000
.*-------------------------------------------------------------------   49720000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             49760000
.ZG12A   AIF   ('&MSIFREE(1)' NE 'YES').ZG13A                           49800000
&XMSIFREE     SETC  'YES'       SET KEYWORD                             49840000
.*-------------------------------------------------------------------   49880000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             49920000
.ZG13A        AIF   (K'&XMSIFREE GT 0).ZG13C    KEYWORD                 49960000
              AIF   (K'&MSIFREE(1) LE 0).ZG13B                          50000000
&ZMS          SETC  '"MSIFREE='                 *KUKWA* MNOTE           50040000
&ZMS          SETC  '&ZMS.&MSIFREE"'                                    50080000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           50120000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 50160000
&ZMS          SETC  '&ZMS "NO"'                                         50200000
&ZMS          SETC  '&ZMS OR "YES".'                                    50240000
              MNOTE 8,' &ZMS '                                          50280000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50320000
.ZG13B        ANOP  ,                                                   50360000
&XMSIFREE     SETC  'NO'        SET DEFAULT KEYWORD                     50400000
.ZG13C        ANOP  ,                                                   50440000
&ZXMSIFREE    SETC  'INPUT'     SET IN/OUTPUT                           50480000
.*----------------------------------------------------------------***   50520000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             50560000
              AIF   (N'&LASTING LE 1).ZG15A     CK NUM                  50600000
&ZMS          SETC  '"LASTING='                 *KPOSA* MNOTE           50640000
&ZMS          SETC  '&ZMS.&LASTING"'                                    50680000
&ZMS          SETC  '&ZMS "LASTING"'                                    50720000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 50760000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50800000
.ZG15A        ANOP  ,                                                   50840000
.*-------------------------------------------------------------------   50880000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             50920000
&XLASTING     SETC  ''          INITIALIZE XVARIABLE                    50960000
.ZG16A   AIF   ('&LASTING(1)' NE 'NO').ZG17A                            51000000
&XLASTING     SETC  'NO'        SET KEYWORD                             51040000
.*-------------------------------------------------------------------   51080000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             51120000
.ZG17A   AIF   ('&LASTING(1)' NE 'YES').ZG18A                           51160000
&XLASTING     SETC  'YES'       SET KEYWORD                             51200000
.*-------------------------------------------------------------------   51240000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             51280000
.ZG18A        AIF   (K'&XLASTING GT 0).ZG18C    KEYWORD                 51320000
              AIF   (K'&LASTING(1) LE 0).ZG18B                          51360000
&ZMS          SETC  '"LASTING='                 *KUKWA* MNOTE           51400000
&ZMS          SETC  '&ZMS.&LASTING"'                                    51440000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           51480000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 51520000
&ZMS          SETC  '&ZMS "NO"'                                         51560000
&ZMS          SETC  '&ZMS OR "YES".'                                    51600000
              MNOTE 8,' &ZMS '                                          51640000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51680000
.ZG18B        ANOP  ,                                                   51720000
&XLASTING     SETC  'NO'        SET DEFAULT KEYWORD                     51760000
.ZG18C        ANOP  ,                                                   51800000
&ZXLASTING    SETC  'INPUT'     SET IN/OUTPUT                           51840000
.*----------------------------------------------------------------***   51880000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             51920000
              AIF   (N'&CAPTCOM LE 1).ZG20A     CK NUM                  51960000
&ZMS          SETC  '"CAPTCOM='                 *KPOSA* MNOTE           52000000
&ZMS          SETC  '&ZMS.&CAPTCOM"'                                    52040000
&ZMS          SETC  '&ZMS "CAPTCOM"'                                    52080000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 52120000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             52160000
.ZG20A        ANOP  ,                                                   52200000
.*-------------------------------------------------------------------   52240000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             52280000
&XCAPTCOM     SETC  ''          INITIALIZE XVARIABLE                    52320000
.ZG21A   AIF   ('&CAPTCOM(1)' NE 'NO').ZG22A                            52360000
&XCAPTCOM     SETC  'NO'        SET KEYWORD                             52400000
.*-------------------------------------------------------------------   52440000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             52480000
.ZG22A   AIF   ('&CAPTCOM(1)' NE 'YES').ZG23A                           52520000
&XCAPTCOM     SETC  'YES'       SET KEYWORD                             52560000
.*-------------------------------------------------------------------   52600000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             52608000
.ZG23A   AIF   ('&CAPTCOM(1)' NE 'NEVER').ZG24A                         52616000
&XCAPTCOM     SETC  'NEVER'     SET KEYWORD                             52624000
.*-------------------------------------------------------------------   52632000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             52640000
.ZG24A        AIF   (K'&XCAPTCOM GT 0).ZG24C    KEYWORD                 52680000
              AIF   (K'&CAPTCOM(1) LE 0).ZG24B                          52720000
&ZMS          SETC  '"CAPTCOM='                 *KUKWA* MNOTE           52760000
&ZMS          SETC  '&ZMS.&CAPTCOM"'                                    52800000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           52840000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 52880000
&ZMS          SETC  '&ZMS "NO",'                                        52910000
&ZMS          SETC  '&ZMS "YES",'                                       52940000
&ZMS          SETC  '&ZMS OR "NEVER".'                                  52970000
              MNOTE 8,' &ZMS '                                          53000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             53040000
.ZG24B        ANOP  ,                                                   53080000
&XCAPTCOM     SETC  'NO'        SET DEFAULT KEYWORD                     53120000
.ZG24C        ANOP  ,                                                   53160000
&ZXCAPTCOM    SETC  'INPUT'     SET IN/OUTPUT                           53200000
.*-------------------------------------------------------------------   53240000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          53280000
.ZG25         AIF   ('&XFUNCTN' NE 'UCAPTUCB').ZG39                     53320000
.*-------------------------------------------------------------------   53360000
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               53400000
&ZCVAL        SETC ''           ERROR KEY FIELD                         53440000
.ZG25I0       AIF   (K'&UCBPTR LE 0).ZG25I1                             53480000
&ZCVAL        SETC '&ZCVAL UCBPTR'              DISALLOWED KEY          53520000
.ZG25I1       AIF   (K'&MSIFREE LE 0).ZG25I2                            53560000
&ZCVAL        SETC '&ZCVAL MSIFREE'             DISALLOWED KEY          53600000
.ZG25I2       AIF   (K'&ASID LE 0).ZG25I3                               53650000
&ZCVAL        SETC '&ZCVAL ASID'                DISALLOWED KEY          53840000
.ZG25I3       AIF   (K'&ZCVAL LE 0).ZG25J       KEY                     53880000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               53920000
&ZMS          SETC  '"UCAPTUCB'                 *KMEIA* MNOTE           53960000
&ZMS          SETC  '&ZMS."'                                            54000000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                54040000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                54080000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             54120000
.ZG25J        ANOP  ,                                                   54170000
.*----------------------------------------------------------------***   55040000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     55080000
              AIF   (N'&CAPTPTR LE 1).ZG27A     CK NUM                  55120000
&ZMS          SETC  '"CAPTPTR='                 *KPOSA* MNOTE           55160000
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    55200000
&ZMS          SETC  '&ZMS "CAPTPTR"'                                    55240000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 55280000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             55320000
.ZG27A        ANOP  ,                                                   55360000
.*-------------------------------------------------------------------   55400000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         55440000
&ZXCAPTPTR    SETC  'INPUT'     SET IN/OUTPUT                           55480000
&XCAPTPTR     SETC  '&CAPTPTR(1)'               SET XVARIABLE           55520000
              AIF   (N'&CAPTPTR GT 1).ZG27B     MULTI PARMS             55560000
&XCAPTPTR     SETC  '&CAPTPTR'  SET XVARIABLE                           55600000
.ZG27B        AIF   (K'&CAPTPTR(1) GT 0).ZG27C                          55640000
&ZXCAPTPTR    SETC  ''          RESET IN/OUTPUT                         55680000
&ZMS          SETC  ' '         *KRQDA*                                 55720000
&ZMS          SETC  '&ZMS "CAPTPTR" KEY AND ITS'                        55760000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    55800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             55840000
.ZG27C        ANOP  ,                                                   55880000
.*-------------------------------------------------------------------   55920000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    55960000
              AIF   (K'&ZXCAPTPTR LE 0).ZG27R   NOT I/O                 56000000
              AIF   ('&XCAPTPTR'(1,1) NE '(').ZG27R                     56040000
&ZCGPR        SETC  '&XCAPTPTR'(2,K'&XCAPTPTR-2)                        56080000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                        56120000
              AIF   (K'&ZCGPR GT 2).ZG27Q                               56160000
              AIF   ('&ZCGPR' EQ '0').ZG27Q                             56200000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       56240000
              AIF   (T'&ZCGPR NE 'N').ZG27Q     INVALID REG NAME        56280000
.ZG27P        ANOP  ,                                                   56320000
              AIF   (T'&ZCGPR NE 'N').ZG27R     NON NUMERIC             56360000
              AIF   ('&ZCGPR' LT '2').ZG27Q                             56400000
              AIF   ('&ZCGPR' LE '12').ZG27R                            56440000
.ZG27Q        ANOP  ,                                                   56480000
&ZMS          SETC  '"CAPTPTR='                 *KGPRA* MNOTE           56520000
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    56560000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           56600000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    56640000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56680000
.ZG27R        ANOP  ,                                                   56700500
.*----------------------------------------------------------------***   56721100
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             56722200
              AIF   (N'&LASTING LE 1).ZG30A     CK NUM                  56723300
&ZMS          SETC  '"LASTING='                 *KPOSA* MNOTE           56724400
&ZMS          SETC  '&ZMS.&LASTING"'                                    56725500
&ZMS          SETC  '&ZMS "LASTING"'                                    56726600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 56727700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56728800
.ZG30A        ANOP  ,                                                   56729900
.*-------------------------------------------------------------------   56731000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             56732100
&XLASTING     SETC  ''          INITIALIZE XVARIABLE                    56732200
.ZG31A   AIF   ('&LASTING(1)' NE 'NO').ZG32A                            56732300
&XLASTING     SETC  'NO'        SET KEYWORD                             56732400
.*-------------------------------------------------------------------   56732500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             56732600
.ZG32A   AIF   ('&LASTING(1)' NE 'YES').ZG33A                           56732700
&XLASTING     SETC  'YES'       SET KEYWORD                             56732800
.*-------------------------------------------------------------------   56732900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             56733000
.ZG33A        AIF   (K'&XLASTING GT 0).ZG33C    KEYWORD                 56733100
              AIF   (K'&LASTING(1) LE 0).ZG33B                          56733200
&ZMS          SETC  '"LASTING='                 *KUKWA* MNOTE           56733300
&ZMS          SETC  '&ZMS.&LASTING"'                                    56733400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           56733500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 56733600
&ZMS          SETC  '&ZMS "NO"'                                         56733700
&ZMS          SETC  '&ZMS OR "YES".'                                    56733800
              MNOTE 8,' &ZMS '                                          56733900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56734000
.ZG33B        ANOP  ,                                                   56734100
&XLASTING     SETC  'NO'        SET DEFAULT KEYWORD                     56734200
.ZG33C        ANOP  ,                                                   56734300
&ZXLASTING    SETC  'INPUT'     SET IN/OUTPUT                           56734400
.*----------------------------------------------------------------***   56734500
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             56734600
              AIF   (N'&CAPTCOM LE 1).ZG35A     CK NUM                  56734700
&ZMS          SETC  '"CAPTCOM='                 *KPOSA* MNOTE           56734800
&ZMS          SETC  '&ZMS.&CAPTCOM"'                                    56734900
&ZMS          SETC  '&ZMS "CAPTCOM"'                                    56735000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 56735100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56735200
.ZG35A        ANOP  ,                                                   56735300
.*-------------------------------------------------------------------   56735400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             56735500
&XCAPTCOM     SETC  ''          INITIALIZE XVARIABLE                    56735600
.ZG36A   AIF   ('&CAPTCOM(1)' NE 'NO').ZG37A                            56735700
&XCAPTCOM     SETC  'NO'        SET KEYWORD                             56735800
.*-------------------------------------------------------------------   56736500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             56737600
.ZG37A   AIF   ('&CAPTCOM(1)' NE 'YES').ZG38A                           56738700
&XCAPTCOM     SETC  'YES'       SET KEYWORD                             56739800
.*-------------------------------------------------------------------   56740900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             56742000
.ZG38A        AIF   (K'&XCAPTCOM GT 0).ZG38C    KEYWORD                 56743100
              AIF   (K'&CAPTCOM(1) LE 0).ZG38B                          56744200
&ZMS          SETC  '"CAPTCOM='                 *KUKWA* MNOTE           56745300
&ZMS          SETC  '&ZMS.&CAPTCOM"'                                    56746400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           56747500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 56748600
&ZMS          SETC  '&ZMS "NO"'                                         56749700
&ZMS          SETC  '&ZMS OR "YES".'                                    56750800
              MNOTE 8,' &ZMS '                                          56751900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56753000
.ZG38B        ANOP  ,                                                   56754100
&XCAPTCOM     SETC  'NO'        SET DEFAULT KEYWORD                     56755200
.ZG38C        ANOP  ,                                                   56756300
&ZXCAPTCOM    SETC  'INPUT'     SET IN/OUTPUT                           56757400
.*-------------------------------------------------------------------   56760000
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          56800000
.ZG39         AIF   ('&XFUNCTN' NE 'CAPTOACT').ZG49                     56840000
.*-------------------------------------------------------------------   56880000
.***AG.KMEKY14 VALUE, RQD INPUT, ME KEYS -DISALLOWED KEYS               56920000
&ZCVAL        SETC ''           ERROR KEY FIELD                         56960000
.ZG39I0       AIF   (K'&MSIFREE LE 0).ZG39I1                            57000000
&ZCVAL        SETC '&ZCVAL MSIFREE'             DISALLOWED KEY          57040000
.ZG39I1       AIF   (K'&LASTING LE 0).ZG39I2                            57080000
&ZCVAL        SETC '&ZCVAL LASTING'             DISALLOWED KEY          57120000
.ZG39I2       AIF   (K'&CAPTCOM LE 0).ZG39I3                            57160000
&ZCVAL        SETC '&ZCVAL CAPTCOM'             DISALLOWED KEY          57200000
.ZG39I3       AIF   (K'&ZCVAL LE 0).ZG39J       KEY                     57240000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               57280000
&ZMS          SETC  '"CAPTOACT'                 *KMEIA* MNOTE           57320000
&ZMS          SETC  '&ZMS."'                                            57360000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                57400000
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                57440000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             57480000
.ZG39J        ANOP  ,                                                   57530000
.*----------------------------------------------------------------***   58400000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     58440000
              AIF   (N'&CAPTPTR LE 1).ZG41A     CK NUM                  58480000
&ZMS          SETC  '"CAPTPTR='                 *KPOSA* MNOTE           58520000
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    58560000
&ZMS          SETC  '&ZMS "CAPTPTR"'                                    58600000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 58640000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             58680000
.ZG41A        ANOP  ,                                                   58720000
.*-------------------------------------------------------------------   58760000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         58800000
&ZXCAPTPTR    SETC  'INPUT'     SET IN/OUTPUT                           58840000
&XCAPTPTR     SETC  '&CAPTPTR(1)'               SET XVARIABLE           58880000
              AIF   (N'&CAPTPTR GT 1).ZG41B     MULTI PARMS             58920000
&XCAPTPTR     SETC  '&CAPTPTR'  SET XVARIABLE                           58960000
.ZG41B        AIF   (K'&CAPTPTR(1) GT 0).ZG41C                          59000000
&ZXCAPTPTR    SETC  ''          RESET IN/OUTPUT                         59040000
&ZMS          SETC  ' '         *KRQDA*                                 59080000
&ZMS          SETC  '&ZMS "CAPTPTR" KEY AND ITS'                        59120000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    59160000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             59200000
.ZG41C        ANOP  ,                                                   59240000
.*-------------------------------------------------------------------   59280000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    59320000
              AIF   (K'&ZXCAPTPTR LE 0).ZG41R   NOT I/O                 59360000
              AIF   ('&XCAPTPTR'(1,1) NE '(').ZG41R                     59400000
&ZCGPR        SETC  '&XCAPTPTR'(2,K'&XCAPTPTR-2)                        59440000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG41P                        59480000
              AIF   (K'&ZCGPR GT 2).ZG41Q                               59520000
              AIF   ('&ZCGPR' EQ '0').ZG41Q                             59560000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       59600000
              AIF   (T'&ZCGPR NE 'N').ZG41Q     INVALID REG NAME        59640000
.ZG41P        ANOP  ,                                                   59680000
              AIF   (T'&ZCGPR NE 'N').ZG41R     NON NUMERIC             59720000
              AIF   ('&ZCGPR' LT '2').ZG41Q                             59760000
              AIF   ('&ZCGPR' LE '12').ZG41R                            59800000
.ZG41Q        ANOP  ,                                                   59840000
&ZMS          SETC  '"CAPTPTR='                 *KGPRA* MNOTE           59880000
&ZMS          SETC  '&ZMS.&CAPTPTR"'                                    59920000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           59960000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    60000000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             60040000
.ZG41R        ANOP  ,                                                   60080000
.*----------------------------------------------------------------***   60120000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    60160000
              AIF   (N'&UCBPTR LE 1).ZG44A      CK NUM                  60200000
&ZMS          SETC  '"UCBPTR='  *KPOSA* MNOTE                           60240000
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     60280000
&ZMS          SETC  '&ZMS "UCBPTR"'                                     60320000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 60360000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             60400000
.ZG44A        ANOP  ,                                                   60440000
.*-------------------------------------------------------------------   60480000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        60520000
&ZXUCBPTR     SETC  'OUTPUT'    SET IN/OUTPUT                           60560000
&XUCBPTR      SETC  '&UCBPTR(1)'                SET XVARIABLE           60600000
              AIF   (N'&UCBPTR GT 1).ZG44B      MULTI PARMS             60640000
&XUCBPTR      SETC  '&UCBPTR'   SET XVARIABLE                           60680000
.ZG44B        AIF   (K'&UCBPTR(1) GT 0).ZG44C                           60720000
&ZXUCBPTR     SETC  ''          RESET IN/OUTPUT                         60760000
&ZMS          SETC  ' '         *KRQDA*                                 60800000
&ZMS          SETC  '&ZMS "UCBPTR" KEY AND ITS'                         60840000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    60880000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             60920000
.ZG44C        ANOP  ,                                                   60960000
.*-------------------------------------------------------------------   61000000
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   61040000
              AIF   (K'&ZXUCBPTR LE 0).ZG44R    NOT I/O                 61080000
              AIF   ('&XUCBPTR'(1,1) NE '(').ZG44R                      61120000
&ZCGPR        SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                          61160000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG44P                        61200000
              AIF   (K'&ZCGPR GT 2).ZG44Q                               61240000
              AIF   ('&ZCGPR' EQ '0').ZG44Q                             61280000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       61320000
              AIF   (T'&ZCGPR NE 'N').ZG44Q     INVALID REG NAME        61360000
.ZG44P        ANOP  ,                                                   61400000
              AIF   (T'&ZCGPR NE 'N').ZG44R     NON NUMERIC             61440000
              AIF   ('&ZCGPR' LT '2').ZG44Q                             61480000
              AIF   ('&ZCGPR' LE '12').ZG44R                            61520000
.ZG44Q        ANOP  ,                                                   61560000
&ZMS          SETC  '"UCBPTR='  *KGPRA* MNOTE                           61600000
&ZMS          SETC  '&ZMS.&UCBPTR"'                                     61640000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           61680000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    61720000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61760000
.ZG44R        ANOP  ,                                                   61800000
.*----------------------------------------------------------------***   61840000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     61880000
              AIF   (N'&ASID LE 1).ZG47A        CK NUM                  61920000
&ZMS          SETC  '"ASID='    *KPOSA* MNOTE                           61960000
&ZMS          SETC  '&ZMS.&ASID"'                                       62000000
&ZMS          SETC  '&ZMS "ASID"'                                       62040000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 62080000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             62120000
.ZG47A        ANOP  ,                                                   62160000
.*-------------------------------------------------------------------   62200000
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         62240000
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           62280000
&XASID        SETC  'CURRENT'                                           62320000
              AIF   (K'&ASID(1) LE 0).ZG47B     PARM                    62360000
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           62400000
              AIF   (N'&ASID GT 1).ZG47B        MULTI PARMS             62440000
&XASID        SETC  '&ASID'     SET XVARIABLE                           62480000
.ZG47B        ANOP  ,                                                   62520000
.*-------------------------------------------------------------------   62560000
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    62600000
              AIF   (K'&ZXASID LE 0).ZG47R      NOT I/O                 62640000
         AIF   ('&XASID' EQ 'CURRENT').ZG47R                            62680000
              AIF   ('&XASID'(1,1) NE '(').ZG47R                        62720000
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              62760000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                        62800000
              AIF   (K'&ZCGPR GT 2).ZG47Q                               62840000
              AIF   ('&ZCGPR' EQ '0').ZG47Q                             62880000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       62920000
              AIF   (T'&ZCGPR NE 'N').ZG47Q     INVALID REG NAME        62960000
.ZG47P        ANOP  ,                                                   63000000
              AIF   (T'&ZCGPR NE 'N').ZG47R     NON NUMERIC             63040000
              AIF   ('&ZCGPR' LT '2').ZG47Q                             63080000
              AIF   ('&ZCGPR' LE '12').ZG47R                            63120000
.ZG47Q        ANOP  ,                                                   63160000
&ZMS          SETC  '"ASID='    *KGPRA* MNOTE                           63200000
&ZMS          SETC  '&ZMS.&ASID"'                                       63240000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           63280000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    63320000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             63360000
.ZG47R        ANOP  ,                                                   63400000
.*-------------------------------------------------------------------   63440000
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           63480000
.ZG49         ANOP  ,           END MUTUALLY EXCLUSIVE KEYS             63520000
.*----------------------------------------------------------------***   63560000
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             63600000
              AIF   (N'&LINKAGE LE 1).ZG51A     CK NUM                  63640000
&ZMS          SETC  '"LINKAGE='                 *KPOSA* MNOTE           63680000
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    63720000
&ZMS          SETC  '&ZMS "LINKAGE"'                                    63760000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 63800000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             63840000
.ZG51A        ANOP  ,                                                   63880000
.*-------------------------------------------------------------------   63920000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             63960000
&XLINKAGE     SETC  ''          INITIALIZE XVARIABLE                    64000000
.ZG52A   AIF   ('&LINKAGE(1)' NE 'SYSTEM').ZG53A                        64040000
&XLINKAGE     SETC  'SYSTEM'    SET KEYWORD                             64080000
.*-------------------------------------------------------------------   64120000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             64160000
.ZG53A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG54A                        64200000
&XLINKAGE     SETC  'BRANCH'    SET KEYWORD                             64240000
.*-------------------------------------------------------------------   64280000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             64320000
.ZG54A        AIF   (K'&XLINKAGE GT 0).ZG54C    KEYWORD                 64360000
              AIF   (K'&LINKAGE(1) LE 0).ZG54B                          64400000
&ZMS          SETC  '"LINKAGE='                 *KUKWA* MNOTE           64440000
&ZMS          SETC  '&ZMS.&LINKAGE"'                                    64480000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           64520000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 64560000
&ZMS          SETC  '&ZMS "SYSTEM"'                                     64600000
&ZMS          SETC  '&ZMS OR "BRANCH".'                                 64640000
              MNOTE 8,' &ZMS '                                          64680000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             64720000
.ZG54B        ANOP  ,                                                   64760000
&XLINKAGE     SETC  'SYSTEM'    SET DEFAULT KEYWORD                     64800000
.ZG54C        ANOP  ,                                                   64840000
&ZXLINKAGE    SETC  'INPUT'     SET IN/OUTPUT                           64880000
.*----------------------------------------------------------------***   64920000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    64960000
              AIF   (N'&RETCODE LE 1).ZG56A     CK NUM                  65000000
&ZMS          SETC  '"RETCODE='                 *KPOSA* MNOTE           65040000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    65080000
&ZMS          SETC  '&ZMS "RETCODE"'                                    65120000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 65160000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             65200000
.ZG56A        ANOP  ,                                                   65240000
.*-------------------------------------------------------------------   65280000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        65320000
              AIF   (K'&RETCODE(1) LE 0).ZG56C  NO PARM                 65360000
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              65400000
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           65440000
              AIF   (N'&RETCODE GT 1).ZG56C                             65480000
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           65520000
.ZG56C        ANOP  ,                                                   65560000
.*-------------------------------------------------------------------   65600000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   65640000
              AIF   (K'&ZXRETCODE LE 0).ZG56R   NOT I/O                 65680000
              AIF   ('&XRETCODE'(1,1) NE '(').ZG56R                     65720000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        65760000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG56P                        65800000
              AIF   (K'&ZCGPR GT 2).ZG56Q                               65840000
              AIF   ('&ZCGPR' EQ '0').ZG56Q                             65880000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       65920000
              AIF   (T'&ZCGPR NE 'N').ZG56Q     INVALID REG NAME        65960000
.ZG56P        ANOP  ,                                                   66000000
              AIF   (T'&ZCGPR NE 'N').ZG56R     NON NUMERIC             66040000
              AIF   ('&ZCGPR' LT '2').ZG56Q                             66080000
              AIF   ('&ZCGPR' LE '12').ZG56R                            66120000
.ZG56Q        ANOP  ,                                                   66160000
&ZMS          SETC  '"RETCODE='                 *KGPRA* MNOTE           66200000
&ZMS          SETC  '&ZMS.&RETCODE"'                                    66240000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           66280000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    66320000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             66360000
.ZG56R        ANOP  ,                                                   66400000
.*----------------------------------------------------------------***   66440000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    66480000
              AIF   (N'&RSNCODE LE 1).ZG59A     CK NUM                  66520000
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           66560000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    66600000
&ZMS          SETC  '&ZMS "RSNCODE"'                                    66640000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 66680000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             66720000
.ZG59A        ANOP  ,                                                   66760000
.*-------------------------------------------------------------------   66800000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        66840000
              AIF   (K'&RSNCODE(1) LE 0).ZG59C  NO PARM                 66880000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              66920000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           66960000
              AIF   (N'&RSNCODE GT 1).ZG59C                             67000000
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           67040000
.ZG59C        ANOP  ,                                                   67080000
.*-------------------------------------------------------------------   67120000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   67160000
              AIF   (K'&ZXRSNCODE LE 0).ZG59R   NOT I/O                 67200000
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG59R                     67240000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        67280000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG59P                        67320000
              AIF   (K'&ZCGPR GT 2).ZG59Q                               67360000
              AIF   ('&ZCGPR' EQ '0').ZG59Q                             67400000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       67440000
              AIF   (T'&ZCGPR NE 'N').ZG59Q     INVALID REG NAME        67480000
.ZG59P        ANOP  ,                                                   67520000
              AIF   (T'&ZCGPR NE 'N').ZG59R     NON NUMERIC             67560000
              AIF   ('&ZCGPR' LT '2').ZG59Q                             67600000
              AIF   ('&ZCGPR' LE '12').ZG59R                            67640000
.ZG59Q        ANOP  ,                                                   67680000
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           67720000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    67760000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           67800000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    67840000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             67880000
.ZG59R        ANOP  ,                                                   67920000
.******************************************************************     67960000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        68000000
.******************************************************************     68040000
              ACTR  10000                                               68080000
.*-------------------------------------------------------------------   68120000
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           68160000
&ZCVAL        SETC  ''          ERROR FIELD                             68200000
&ZAWRK        SETA  0           POSITIONAL COUNTER                      68240000
&ZASYSLNDX    SETA  0           NON-X KEY COUNTER                       68280000
.ZGLIST2      ANOP  ,                                                   68320000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT NON-X KEY          68360000
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 68400000
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          68440000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         68480000
              AIF   (&ZAWRK LE 0).ZGLIST2                               68520000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA                 68560000
              AGO   .ZGLIST2                                            68600000
.*                                                                      68640000
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  68680000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             68720000
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           68760000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     68800000
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              68840000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      68880000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              68920000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             68960000
.ZGLISTX      ANOP  ,                                                   69000000
&ZASYSLNDX    SETA  0                                                   69040000
.*-------------------------------------------------------------------   69080000
.***AG.MF04 MF=(SLE)                                                    69120000
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                69160000
.*******************************************************************    69200000
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       69240000
.*******************************************************************    69280000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          69320000
.*******************************************************************    69360000
.***AE.01  START OF IOSCAPU MACRO CODE                                  69400000
.*******************************************************************    69440000
              LCLC  &M0M0001                 NAME                       69480000
&M0M0001      SETC  '&XLABEL'                SET NAME                   69520000
              AIF   (K'&XLABEL NE 0).XLAB2                              69560000
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               69600000
.*                                                                      69640000
.XLAB2        ANOP  ,                                                   69680000
              AIF   ('&XMF' EQ 'L').XLAB3                               69700000
&M0M0001 DS    0H                             IOSCAPU-1                 69720000
.XLAB3        ANOP  ,                                                   69740000
.*******************************************************************    69760000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              69800000
.*******************************************************************    69840000
              PUSH  PRINT                                               69880000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          69920000
              PRINT OFF         ++ PR01                                 69960000
              AGO   .ZPRNTXX                                            70000000
.ZPRINTX      PRINT ON                                                  70040000
.ZPRNTXX      ANOP  ,                                                   70080000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  70082000
         AIF ('&MSIFREE(1)' EQ 'YES' AND '&LASTING(1)' EQ 'YES').MSG1   70084000
         AIF ('&MSIFREE(1)' EQ 'YES' AND '&CAPTCOM(1)' EQ 'YES').MSG2   70086000
         AIF ('&LASTING(1)' EQ 'YES' AND '&CAPTCOM(1)' EQ 'YES').MSG3   70088000
         AGO .OKAY1                                                     70090000
.MSG1    ANOP                                                           70092000
&ZMS     SETC 'MSIFREE AND LASTING MUTUALLY EXCLUSIVE'                  70094000
         MNOTE 8,'&ZMS'                                                 70096000
         MEXIT                                                          70098000
.MSG2    ANOP                                                           70100000
&ZMS     SETC 'MSIFREE AND CAPTCOM MUTUALLY EXCLUSIVE'                  70102000
         MNOTE 8,'&ZMS'                                                 70104000
         MEXIT                                                          70106000
.MSG3    ANOP                                                           70108000
&ZMS     SETC 'LASTING AND CAPTCOM MUTUALLY EXCLUSIVE'                  70110000
         MNOTE 8,'&ZMS'                                                 70112000
         MEXIT                                                          70114000
.OKAY1   ANOP                                                           70116000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  70118000
.********************************************************************   70120000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     70160000
.********************************************************************   70200000
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       70240000
                      LCLA  &ZOPN1         INVOCATION INDEX             70280000
                      LCLC  &ZOPL(4095)    LABEL                        70320000
                      LCLC  &ZOPO(4095)    OPERATION                    70360000
                      LCLC  &ZOPV(4095)    VALUE                        70400000
                      LCLC  &ZOPD(4095)    DESCRIPTION                  70440000
.*                                                                      70480000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     70520000
.******************************************************************     70560000
.***AL.L10 IOSCAPU FMT=LIST MF=S!L PARAMETERS                           70600000
.******************************************************************     70640000
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     70680000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     70720000
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     70760000
&XMFATTR              SETC  '0D'                                        70800000
.*                                                                      70840000
&ZOPN                 SETA  &ZOPN+1                                     70880000
&ZOPL(&ZOPN)          SETC  ' '                                         70920000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     70940000
&ZOPO(&ZOPN)          SETC  'B'                                         70960000
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                71000000
                      AGO   .ZALVL6B                                    71006600
.ZALVL6A              ANOP                                              71013200
&ZOPO(&ZOPN)          SETC  'BRAS'                                      71019800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              71026400
.ZALVL6B              ANOP                                              71033000
&ZOPD(&ZOPN)          SETC  '++ IOSCAPU ARG PARMS'                      71040000
.*                                                                      71080000
&ZOPN                 SETA  &ZOPN+1                                     71120000
&ZOPL(&ZOPN)          SETC  ' '                                         71160000
&ZOPO(&ZOPN)          SETC  'SPACE'                                     71200000
&ZOPV(&ZOPN)          SETC  '1'                                         71240000
&ZOPD(&ZOPN)          SETC  ' '                                         71280000
.*                                                                      71320000
.ZLMFSL2              ANOP  ,                                           71360000
.*-------------------------------------------------------------------   71364000
.***AM.L00  IOSCAPU FMT=LIST name                                       71368000
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    71372000
&ZOPN                 SETA &ZOPN+1                                      71376000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   71380000
&ZOPO(&ZOPN)          SETC 'EQU'                                        71384000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   71388000
&ZOPD(&ZOPN)          SETC '++ IOSCAPU NAME'                            71392000
.ZLMFSL2M             ANOP  ,                                           71396000
.*-------------------------------------------------------------------   71400000
.***AM.L01  IOSCAPU FMT=LIST PARAMETERS                                 71440000
&ZOPN                 SETA &ZOPN+1                                      71480000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   71520000
&ZOPO(&ZOPN)          SETC 'DS'                                         71560000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   71600000
&ZOPD(&ZOPN)          SETC '++ IOSCAPU PARM LIST'                       71640000
.*-------------------------------------------------------------------   71680000
.***AM.L02 XVERSION XL1                                                 71720000
&ZOPN                 SETA &ZOPN+1                                      71760000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         71800000
&ZOPO(&ZOPN)          SETC 'DS'                                         71840000
&ZOPV(&ZOPN)          SETC 'XL1'                                        71880000
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          71920000
.*-------------------------------------------------------------------   71960000
.***AM.L03 XFLAGS1 BL.8                                                 72000000
&ZOPN                 SETA &ZOPN+1                                      72040000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS1'                          72080000
&ZOPO(&ZOPN)          SETC 'DS'                                         72120000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       72160000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             72200000
.*                                                                      72240000
&ZOPN                 SETA  &ZOPN+1                                     72280000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CAPTUCB'                 72320000
&ZOPO(&ZOPN)          SETC  'EQU'                                       72360000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             72400000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               72440000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CAPTUCB'                      72480000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      72520000
.*                                                                      72560000
&ZOPN                 SETA  &ZOPN+1                                     72600000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCAPTUCB'                72640000
&ZOPO(&ZOPN)          SETC  'EQU'                                       72680000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             72720000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               72760000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCAPTUCB'                     72800000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      72840000
.*                                                                      72880000
&ZOPN                 SETA  &ZOPN+1                                     72920000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CAPTOACT'                72960000
&ZOPO(&ZOPN)          SETC  'EQU'                                       73000000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             73040000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               73080000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CAPTOACT'                     73120000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      73160000
.*                                                                      73200000
&ZOPN                 SETA  &ZOPN+1                                     73240000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_ASID'                    73280000
&ZOPO(&ZOPN)          SETC  'EQU'                                       73320000
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             73360000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               73400000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ASID'                         73440000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      73480000
.*                                                                      73520000
&ZOPN                 SETA  &ZOPN+1                                     73560000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_UCBPTR'                  73600000
&ZOPO(&ZOPN)          SETC  'EQU'                                       73640000
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             73680000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               73720000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).UCBPTR'                       73760000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      73800000
.*                                                                      73840000
&ZOPN                 SETA  &ZOPN+1                                     73880000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CAPTPTR'                 73920000
&ZOPO(&ZOPN)          SETC  'EQU'                                       73960000
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             74000000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               74040000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CAPTPTR'                      74080000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      74120000
.*-------------------------------------------------------------------   74160000
.***AM.L09  XRESERVED1 CL2                                              74200000
&ZOPN                 SETA &ZOPN+1                                      74240000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       74280000
&ZOPO(&ZOPN)          SETC 'DS'                                         74320000
&ZOPV(&ZOPN)          SETC 'CL2'                                        74360000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED1'                 74400000
.*-------------------------------------------------------------------   74440000
.***AM.L09  XUCBPTR A                                                   74480000
&ZOPN                 SETA &ZOPN+1                                      74520000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUCBPTR'                          74560000
&ZOPO(&ZOPN)          SETC 'DS'                                         74600000
&ZOPV(&ZOPN)          SETC 'A'                                          74640000
&ZOPD(&ZOPN)          SETC '++ &ZXUCBPTR  XUCBPTR'                      74680000
.*-------------------------------------------------------------------   74720000
.***AM.L09  XCAPTPTR A                                                  74760000
&ZOPN                 SETA &ZOPN+1                                      74800000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCAPTPTR'                         74840000
&ZOPO(&ZOPN)          SETC 'DS'                                         74880000
&ZOPV(&ZOPN)          SETC 'A'                                          74920000
&ZOPD(&ZOPN)          SETC '++ &ZXCAPTPTR  XCAPTPTR'                    74960000
.*-------------------------------------------------------------------   75000000
.***AM.L09  XRESERVED2 CL1                                              75040000
&ZOPN                 SETA &ZOPN+1                                      75080000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       75120000
&ZOPO(&ZOPN)          SETC 'DS'                                         75160000
&ZOPV(&ZOPN)          SETC 'CL1'                                        75200000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED2'                 75240000
.*-------------------------------------------------------------------   75280000
.***AM.L03 XMASK BL.8                                                   75320000
&ZOPN                 SETA &ZOPN+1                                      75360000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMASK'                            75400000
&ZOPO(&ZOPN)          SETC 'DS'                                         75440000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       75480000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             75520000
.*                                                                      75560000
&ZOPN                 SETA  &ZOPN+1                                     75600000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMSIFREE_YES'                    75640000
&ZOPO(&ZOPN)          SETC  'EQU'                                       75680000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             75720000
&ZOPD(&ZOPN)          SETC  '++ XMSIFREE.'                              75760000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          75800000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      75840000
.*                                                                      75880000
&ZOPN                 SETA  &ZOPN+1                                     75920000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XLASTING_YES'                    75960000
&ZOPO(&ZOPN)          SETC  'EQU'                                       76000000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             76040000
&ZOPD(&ZOPN)          SETC  '++ XLASTING.'                              76080000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          76120000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      76160000
.*                                                                      76200000
&ZOPN                 SETA  &ZOPN+1                                     76240000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCAPTCOM_YES'                    76280000
&ZOPO(&ZOPN)          SETC  'EQU'                                       76320000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             76360000
&ZOPD(&ZOPN)          SETC  '++ XCAPTCOM.'                              76400000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          76440000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      76444400
.*                                                                      76448800
&ZOPN                 SETA  &ZOPN+1                                     76453200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCAPTCOM_NEVER'                  76457600
&ZOPO(&ZOPN)          SETC  'EQU'                                       76462000
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             76466400
&ZOPD(&ZOPN)          SETC  '++ XCAPTCOM.'                              76470800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NEVER'                        76475200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      76480000
.*-------------------------------------------------------------------   76520000
.***AM.L09  XASID XL2                                                   76560000
&ZOPN                 SETA &ZOPN+1                                      76600000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XASID'                            76640000
&ZOPO(&ZOPN)          SETC 'DS'                                         76680000
&ZOPV(&ZOPN)          SETC 'XL2'                                        76720000
&ZOPD(&ZOPN)          SETC '++ &ZXASID  XASID'                          76760000
.*-------------------------------------------------------------------   76800000
.***AM.L09  XRESERVED3 CL16                                             76840000
&ZOPN                 SETA &ZOPN+1                                      76880000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED3'                       76920000
&ZOPO(&ZOPN)          SETC 'DS'                                         76960000
&ZOPV(&ZOPN)          SETC 'CL16'                                       77000000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XRESERVED3'                 77040000
.*-------------------------------------------------------------------   77080000
.***AM.L10 END OF IOSCAPU LIST PARAMETERS                               77120000
&ZOPN                 SETA &ZOPN+1                                      77160000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 77200000
&ZOPO(&ZOPN)          SETC 'EQU'                                        77240000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 77280000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         77320000
.*                                                                      77360000
&ZOPN                 SETA &ZOPN+1                                      77400000
&ZOPL(&ZOPN)          SETC ' '                                          77440000
&ZOPO(&ZOPN)          SETC 'SPACE'                                      77480000
&ZOPV(&ZOPN)          SETC '1'                                          77520000
&ZOPD(&ZOPN)          SETC ' '                                          77560000
.*-------------------------------------------------------------------   77600000
.***AL.L12 IOSCAPU FMT=LIST MF=S!L PARAMETERS                           77640000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         77680000
.*                                                                      77720000
&ZOPN                 SETA  &ZOPN+1                                     77760000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                77800000
&ZOPO(&ZOPN)          SETC  'DC'                                        77840000
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   77880000
&ZOPD(&ZOPN)          SETC  '++ IOSCAPU ARG PARMS'                      77920000
.*                                                                      77960000
.ZLMFSLX              ANOP  ,                                           78000000
.*-------------------------------------------------------------------   78040000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          78080000
&ZPLLEN               SETA 32                                           78120000
.*                                                                      78160000
.******************************************************************     78200000
.***AI.L01 IOSCAPU FMT=LIST FILL IN PARAMETER AREA                      78240000
.******************************************************************     78280000
                      ACTR  10000                                       78320000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               78360000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    78400000
&ZCVAL                SETC  'LAE'          XAX MODE                     78440000
.ZIMFXA               ANOP ,                                            78480000
.*                                                                      78520000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    78560000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         78600000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 78640000
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                78680000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 78720000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                78760000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   78800000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    78840000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   78880000
&ZOPN                 SETA  &ZOPN+1                                     78920000
&ZOPL(&ZOPN)          SETC  ' '                                         78960000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    79000000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              79040000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       79080000
                      AGO   .ZIMFNX                                     79120000
.*                                                                      79160000
.ZIMFN2               ANOP ,                                            79200000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     79203600
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     79207200
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  79210800
&ZOPN                 SETA  &ZOPN+1                                     79214400
&ZOPL(&ZOPN)          SETC  ' '                                         79218000
&ZOPO(&ZOPN)          SETC  'LAE'                                       79221600
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  79225200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       79228800
                      AGO   .ZIMFNX                                     79232400
.ZIMFNX1              ANOP ,                                            79236000
&ZOPN                 SETA  &ZOPN+1                                     79240000
&ZOPL(&ZOPN)          SETC  ' '                                         79280000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    79320000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                79360000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       79400000
.ZIMFNX               ANOP ,                                            79440000
.********************************************************************   79480000
.***AI.L02 IOSCAPU FMT=LIST INITIALIZE PARAMETER AREA                   79520000
.********************************************************************   79560000
.***AI.L03 MF=(SLE)                                                     79600000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      79640000
.*                                                                      79680000
&ZOPN                 SETA  &ZOPN+1                                     79720000
&ZOPL(&ZOPN)          SETC  ' '                                         79760000
&ZOPO(&ZOPN)          SETC  'XC'                                        79800000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         79840000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             79880000
.ZIMFLX               ANOP  ,                                           79920000
.*-------------------------------------------------------------------   79960000
.***AI.L04A XVERSION XL1                                                80000000
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    80020000
&ZOPN                 SETA  &ZOPN+1                                     80040000
&ZOPL(&ZOPN)          SETC  ' '                                         80080000
&ZOPO(&ZOPN)          SETC  'MVI'                                       80120000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           80160000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     80200000
.ZIMFVW               ANOP  ,                                           80220000
.*-------------------------------------------------------------------   80240000
.***AI.L05 XFLAGS1 BL1                                                  80280000
&ZW                   SETC  ''                                          80320000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            80360000
.*-------------------------------------------------------------------   80400000
.***AI.L08 XFLAGS1 "CAPTUCB"                                            80440000
.***      BL1'1XXXXXXX'                                                 80480000
         AIF   ('&XCAPTUCB' EQ '').ZI3A                                 80520000
&ZW                   SETC  '&ZW.1'                                     80560000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              80600000
                      AGO   .ZI3C                                       80640000
.*                                                                      80680000
.ZI3A                 ANOP  ,                                           80720000
&ZW                   SETC  '&ZW.0'                                     80760000
.ZI3C                 ANOP  ,                                           80800000
.*-------------------------------------------------------------------   80840000
.***AI.L08 XFLAGS1 "UCAPTUCB"                                           80880000
.***      BL1'X1XXXXXX'                                                 80920000
         AIF   ('&XUCAPTUCB' EQ '').ZI4A                                80960000
&ZW                   SETC  '&ZW.1'                                     81000000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              81040000
                      AGO   .ZI4C                                       81080000
.*                                                                      81120000
.ZI4A                 ANOP  ,                                           81160000
&ZW                   SETC  '&ZW.0'                                     81200000
.ZI4C                 ANOP  ,                                           81240000
.*-------------------------------------------------------------------   81280000
.***AI.L08 XFLAGS1 "CAPTOACT"                                           81320000
.***      BL1'XX1XXXXX'                                                 81360000
         AIF   ('&XCAPTOACT' EQ '').ZI5A                                81400000
&ZW                   SETC  '&ZW.1'                                     81440000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              81480000
                      AGO   .ZI5C                                       81520000
.*                                                                      81560000
.ZI5A                 ANOP  ,                                           81600000
&ZW                   SETC  '&ZW.0'                                     81640000
.ZI5C                 ANOP  ,                                           81680000
.*-------------------------------------------------------------------   81720000
.***AI.L08 XFLAGS1 "ASID"                                               81760000
.***      BL1'XXX1XXXX'                                                 81800000
         AIF   ('&ASID' EQ '').ZI6A                                     81840000
&ZW                   SETC  '&ZW.1'                                     81920000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              81960000
                      AGO   .ZI6C                                       82000000
.*                                                                      82040000
.ZI6A                 ANOP  ,                                           82080000
&ZW                   SETC  '&ZW.0'                                     82120000
.ZI6C                 ANOP  ,                                           82160000
.*-------------------------------------------------------------------   82200000
.***AI.L08 XFLAGS1 "UCBPTR"                                             82240000
.***      BL1'XXXX1XXX'                                                 82280000
         AIF   ('&UCBPTR' EQ '').ZI7A                                   82320000
&ZW                   SETC  '&ZW.1'                                     82360000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              82400000
                      AGO   .ZI7C                                       82440000
.*                                                                      82480000
.ZI7A                 ANOP  ,                                           82520000
&ZW                   SETC  '&ZW.0'                                     82560000
.ZI7C                 ANOP  ,                                           82600000
.*-------------------------------------------------------------------   82640000
.***AI.L08 XFLAGS1 "CAPTPTR"                                            82680000
.***      BL1'XXXXX1XX'                                                 82720000
         AIF   ('&CAPTPTR' EQ '').ZI8A                                  82760000
&ZW                   SETC  '&ZW.100'                                   82800000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              82840000
                      AGO   .ZI8C                                       82880000
.*                                                                      82920000
.ZI8A                 ANOP  ,                                           82960000
&ZW                   SETC  '&ZW.000'                                   83000000
.ZI8C                 ANOP  ,                                           83040000
.*-------------------------------------------------------------------   83080000
.***AI.L11 XFLAGS1 BL1                                                  83120000
                      AIF   ('&ZCLNG' NE 'YES').ZI8E  ALL ZERO BITS     83160000
&ZOPN                 SETA  &ZOPN+1                                     83200000
&ZOPL(&ZOPN)          SETC  ' '                                         83240000
&ZOPO(&ZOPN)          SETC  'OI'                                        83280000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             83320000
&ZOPD(&ZOPN)          SETC  '++ OUTPUT BL1'                             83360000
.ZI8E                 ANOP  ,                                           83400000
.*-------------------------------------------------------------------   83440000
.***AI.L25  XUCBPTR AL4                                                 83480000
                      AIF   ('&ZXUCBPTR' EQ '').ZI10E                   83520000
                      AIF   ('&ZXUCBPTR' EQ 'OUTPUT').ZI10E             83560000
&ZCGPR                SETC  '&XUCBPTR'                                  83600000
.*                                                                      83640000
                      AIF   ('&XUCBPTR'(1,1) NE '(').ZI10B              83680000
&ZCGPR   SETC  '0('.'&XUCBPTR'(2,K'&XUCBPTR-2).')'                      83720000
                      AGO   .ZI10D                                      83760000
.ZI10B                ANOP  ,                                           83800000
.*                                                                      83840000
&ZC                   SETC  '&XUCBPTR'(1,1)                             83880000
                      AIF   (T'&ZC NE 'N').ZI10D                        83920000
&ZC                   SETC  '&XUCBPTR'                                  83960000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               84000000
&ZCGPR                SETC  '=AL4(&XUCBPTR)'                            84040000
.*                                                                      84080000
.ZI10D                ANOP  ,                                           84120000
.*                                                                      84160000
&ZOPN                 SETA  &ZOPN+1                                     84200000
&ZOPL(&ZOPN)          SETC  ' '                                         84240000
&ZOPO(&ZOPN)          SETC  'MVC'                                       84280000
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             84320000
&ZOPD(&ZOPN)          SETC  '++ &ZXUCBPTR XUCBPTR'                      84360000
.*                                                                      84400000
.ZI10E                ANOP  ,                                           84440000
.*-------------------------------------------------------------------   84480000
.***AI.L25  XCAPTPTR AL4                                                84520000
                      AIF   ('&ZXCAPTPTR' EQ '').ZI11E                  84560000
                      AIF   ('&ZXCAPTPTR' EQ 'OUTPUT').ZI11E            84600000
&ZCGPR                SETC  '&XCAPTPTR'                                 84640000
.*                                                                      84680000
                      AIF   ('&XCAPTPTR'(1,1) NE '(').ZI11B             84720000
&ZCGPR   SETC  '0('.'&XCAPTPTR'(2,K'&XCAPTPTR-2).')'                    84760000
                      AGO   .ZI11D                                      84800000
.ZI11B                ANOP  ,                                           84840000
.*                                                                      84880000
&ZC                   SETC  '&XCAPTPTR'(1,1)                            84920000
                      AIF   (T'&ZC NE 'N').ZI11D                        84960000
&ZC                   SETC  '&XCAPTPTR'                                 85000000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               85040000
&ZCGPR                SETC  '=AL4(&XCAPTPTR)'                           85080000
.*                                                                      85120000
.ZI11D                ANOP  ,                                           85160000
.*                                                                      85200000
&ZOPN                 SETA  &ZOPN+1                                     85240000
&ZOPL(&ZOPN)          SETC  ' '                                         85280000
&ZOPO(&ZOPN)          SETC  'MVC'                                       85320000
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             85360000
&ZOPD(&ZOPN)          SETC  '++ &ZXCAPTPTR XCAPTPTR'                    85400000
.*                                                                      85440000
.ZI11E                ANOP  ,                                           85480000
.*-------------------------------------------------------------------   85520000
.***AI.L05 XMASK BL1                                                    85560000
&ZW                   SETC  ''                                          85600000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            85640000
.*-------------------------------------------------------------------   85680000
.***AI.L08 XMASK "YES"                                                  85720000
.***      BL1'1XXXXXXX'                                                 85760000
         AIF   ('&XMSIFREE' NE 'YES').ZI14A                             85800000
&ZW                   SETC  '&ZW.1'                                     85840000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              85880000
                      AGO   .ZI14C                                      85920000
.*                                                                      85960000
.ZI14A                ANOP  ,                                           86000000
&ZW                   SETC  '&ZW.0'                                     86040000
.ZI14C                ANOP  ,                                           86080000
.*-------------------------------------------------------------------   86120000
.***AI.L08 XMASK "YES"                                                  86160000
.***      BL1'X1XXXXXX'                                                 86200000
         AIF   ('&XLASTING' NE 'YES').ZI15A                             86240000
&ZW                   SETC  '&ZW.1'                                     86280000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              86320000
                      AGO   .ZI15C                                      86360000
.*                                                                      86400000
.ZI15A                ANOP  ,                                           86440000
&ZW                   SETC  '&ZW.0'                                     86480000
.ZI15C                ANOP  ,                                           86520000
.*-------------------------------------------------------------------   86560000
.***AI.L08 XMASK "YES"                                                  86600000
.***      BL1'XX1XXXXX'                                                 86640000
         AIF   ('&XCAPTCOM' NE 'YES').ZI16A                             86680000
&ZW                   SETC  '&ZW.1'                                     86720000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              86760000
                      AGO   .ZI16C                                      86800000
.*                                                                      86840000
.ZI16A                ANOP  ,                                           86880000
&ZW                   SETC  '&ZW.0'                                     86920000
.ZI16C                ANOP  ,                                           86960000
.*-------------------------------------------------------------------   87000000
.***AI.L08 XMASK "NEVER"                                                87003300
.***      BL1'XXX1XXXX'                                                 87006600
         AIF   ('&XCAPTCOM' NE 'NEVER').ZI17A                           87009900
&ZW                   SETC  '&ZW.10000'                                 87013200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              87016500
                      AGO   .ZI17C                                      87019800
.*                                                                      87023100
.ZI17A                ANOP  ,                                           87026400
&ZW                   SETC  '&ZW.00000'                                 87029700
.ZI17C                ANOP  ,                                           87033000
.*-------------------------------------------------------------------   87036300
.***AI.L11 XMASK BL1                                                    87040000
                      AIF   ('&ZCLNG' NE 'YES').ZI17E  ALL ZERO BITS    87080000
&ZOPN                 SETA  &ZOPN+1                                     87120000
&ZOPL(&ZOPN)          SETC  ' '                                         87160000
&ZOPO(&ZOPN)          SETC  'OI'                                        87200000
&ZOPV(&ZOPN)          SETC  '13(1),B''&ZW'''                            87240000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              87280000
.ZI17E                ANOP  ,                                           87320000
.*-------------------------------------------------------------------   87360000
.***AI.L18  XASID XL2                                                   87400000
         AIF   ('&XASID' NE 'CURRENT').ZI18                             87440000
&ZXASID               SETC  ''             RESET INPUT/OUTPUT           87480000
.ZI18                 ANOP  ,                                           87520000
.*-------------------------------------------------------------------   87560000
.***AI.L25  XASID XL2                                                   87600000
                      AIF   ('&ZXASID' EQ '').ZI18E                     87640000
                      AIF   ('&ZXASID' EQ 'OUTPUT').ZI18E               87680000
&ZCGPR                SETC  '&XASID'                                    87720000
.*                                                                      87760000
                      AIF   ('&XASID'(1,1) NE '(').ZI18B                87800000
&ZCGPR   SETC  '0('.'&XASID'(2,K'&XASID-2).')'                          87840000
                      AGO   .ZI18D                                      87880000
.ZI18B                ANOP  ,                                           87920000
.*                                                                      87960000
&ZC                   SETC  '&XASID'(1,1)                               88000000
                      AIF   (T'&ZC NE 'N').ZI18D                        88040000
&ZC                   SETC  '&XASID'                                    88080000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI18D               88120000
&ZCGPR                SETC  '=AL2(&XASID)'                              88160000
.*                                                                      88200000
.ZI18D                ANOP  ,                                           88240000
.*                                                                      88280000
&ZOPN                 SETA  &ZOPN+1                                     88320000
&ZOPL(&ZOPN)          SETC  ' '                                         88360000
&ZOPO(&ZOPN)          SETC  'MVC'                                       88400000
&ZOPV(&ZOPN)          SETC  '14(2,1),&ZCGPR'                            88440000
&ZOPD(&ZOPN)          SETC  '++ &ZXASID XASID'                          88480000
.*                                                                      88520000
.ZI18E                ANOP  ,                                           88560000
.*-------------------------------------------------------------------   88600000
&ZOPN1                SETA &ZOPN                                        88640000
.*******************************************************************    88680000
.***  PROCESS IOSCAPU OUTPUT PARAMETERS                                 88720000
.*******************************************************************    88760000
                      ACTR  10000                                       88800000
.*------------------------------------------------------------------    88840000
.***AO.L02 XUCBPTR A                                                    88880000
         AIF   ('&ZXUCBPTR' EQ 'OUTPUT').ZO10A  OUTPUT                  88920000
         AIF   ('&ZXUCBPTR' NE 'INOUT').ZO10C  INOUT                    88960000
.ZO10A    AIF   ('&XUCBPTR'(1,1) NE '(').ZO10B  ADDR IN GPR             89000000
&ZCGPR   SETC  '&XUCBPTR'(2,K'&XUCBPTR-2)                               89040000
&ZOPN                 SETA  &ZOPN+1                                     89080000
&ZOPL(&ZOPN)          SETC  ' '                                         89120000
&ZOPO(&ZOPN)          SETC  'MVC'                                       89160000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),4(1)'                          89200000
&ZOPD(&ZOPN)          SETC  '++ XUCBPTR A'                              89240000
                      AGO   .ZO10C                                      89280000
.*                                                                      89320000
.ZO10B                ANOP  ,                                           89360000
&ZAWRK   SETA  K'&XUCBPTR                                               89400000
         AIF   ('&XUCBPTR'(&ZAWRK,1) NE ')').ZO10G                      89440000
&ZN      SETA  2                                                        89480000
.ZO10H    ANOP                                                          89520000
         AIF   (&ZN GE &ZAWRK).ZO10G                                    89560000
         AIF   ('&XUCBPTR'(&ZN,1) NE '(').ZO10I                         89600000
&ZC      SETC  '&XUCBPTR'(1,&ZN).'4'.','                                89640000
&ZC      SETC  '&ZC'.'&XUCBPTR'(&ZN+1,&ZAWRK-&ZN).',4(1)'               89680000
         AGO   .ZO10J                                                   89720000
.ZO10I    ANOP                                                          89760000
&ZN      SETA  &ZN+1                                                    89800000
         AGO   .ZO10H                                                   89840000
.ZO10G    ANOP                                                          89880000
&ZC      SETC  '&XUCBPTR.(4),4(1)'                                      89920000
.ZO10J    ANOP                                                          89960000
&ZOPN                 SETA  &ZOPN+1                                     90000000
&ZOPL(&ZOPN)          SETC  ' '                                         90040000
&ZOPO(&ZOPN)          SETC  'MVC'                                       90080000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       90120000
&ZOPD(&ZOPN)          SETC  '++ XUCBPTR A'                              90160000
.ZO10C                ANOP  ,                                           90200000
.*------------------------------------------------------------------    90240000
.***AO.L02 XCAPTPTR A                                                   90280000
         AIF   ('&ZXCAPTPTR' EQ 'OUTPUT').ZO11A  OUTPUT                 90320000
         AIF   ('&ZXCAPTPTR' NE 'INOUT').ZO11C  INOUT                   90360000
.ZO11A    AIF   ('&XCAPTPTR'(1,1) NE '(').ZO11B  ADDR IN GPR            90400000
&ZCGPR   SETC  '&XCAPTPTR'(2,K'&XCAPTPTR-2)                             90440000
&ZOPN                 SETA  &ZOPN+1                                     90480000
&ZOPL(&ZOPN)          SETC  ' '                                         90520000
&ZOPO(&ZOPN)          SETC  'MVC'                                       90560000
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),8(1)'                          90600000
&ZOPD(&ZOPN)          SETC  '++ XCAPTPTR A'                             90640000
                      AGO   .ZO11C                                      90680000
.*                                                                      90720000
.ZO11B                ANOP  ,                                           90760000
&ZAWRK   SETA  K'&XCAPTPTR                                              90800000
         AIF   ('&XCAPTPTR'(&ZAWRK,1) NE ')').ZO11G                     90840000
&ZN      SETA  2                                                        90880000
.ZO11H    ANOP                                                          90920000
         AIF   (&ZN GE &ZAWRK).ZO11G                                    90960000
         AIF   ('&XCAPTPTR'(&ZN,1) NE '(').ZO11I                        91000000
&ZC      SETC  '&XCAPTPTR'(1,&ZN).'4'.','                               91040000
&ZC      SETC  '&ZC'.'&XCAPTPTR'(&ZN+1,&ZAWRK-&ZN).',8(1)'              91080000
         AGO   .ZO11J                                                   91120000
.ZO11I    ANOP                                                          91160000
&ZN      SETA  &ZN+1                                                    91200000
         AGO   .ZO11H                                                   91240000
.ZO11G    ANOP                                                          91280000
&ZC      SETC  '&XCAPTPTR.(4),8(1)'                                     91320000
.ZO11J    ANOP                                                          91360000
&ZOPN                 SETA  &ZOPN+1                                     91400000
&ZOPL(&ZOPN)          SETC  ' '                                         91440000
&ZOPO(&ZOPN)          SETC  'MVC'                                       91480000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       91520000
&ZOPD(&ZOPN)          SETC  '++ XCAPTPTR A'                             91560000
.ZO11C                ANOP  ,                                           91600000
.*******************************************************************    91640000
.***AO.X02  RETURN CODE PROCESSING                                      91680000
.*******************************************************************    91720000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    91760000
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            91800000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             91840000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             91880000
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               91920000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                91960000
&ZOPN                 SETA  &ZOPN+1                                     92000000
&ZOPL(&ZOPN)          SETC  ' '                                         92040000
&ZOPO(&ZOPN)          SETC  'ST'                                        92080000
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              92120000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        92160000
                      AGO   .ZMRETX                                     92200000
.*                                                                      92240000
.ZMRET2               ANOP  ,                                           92280000
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                92320000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                92360000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                92400000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  92440000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   92480000
&ZOPN                 SETA  &ZOPN+1                                     92520000
&ZOPL(&ZOPN)          SETC  ' '                                         92560000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  92600000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 92640000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        92680000
.ZMRETX               ANOP  ,                                           92720000
.*******************************************************************    92760000
.***AO.X03  REASON CODE PROCESSING                                      92800000
.*******************************************************************    92840000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    92880000
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            92920000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              92960000
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             93000000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              93040000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             93080000
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                93120000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 93160000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                93200000
&ZOPN                 SETA  &ZOPN+1                                     93240000
&ZOPL(&ZOPN)          SETC  ' '                                         93280000
&ZOPO(&ZOPN)          SETC  'ST'                                        93320000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               93360000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        93400000
                      AGO   .ZMRSNX                                     93440000
.*                                                                      93480000
.ZMRSN2               ANOP  ,                                           93520000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                93560000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 93600000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                93640000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 93680000
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                93720000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   93760000
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    93800000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   93840000
&ZOPN                 SETA  &ZOPN+1                                     93880000
&ZOPL(&ZOPN)          SETC  ' '                                         93920000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  93960000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  94000000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        94040000
.ZMRSNX               ANOP  ,                                           94080000
.*******************************************************************    94120000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   94160000
.*******************************************************************    94200000
.ZMFLX                ANOP  ,              MF=L PROCESSING              94240000
.*******************************************************************    94280000
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               94320000
.*******************************************************************    94360000
                      ACTR  10000                                       94400000
.*                                                                      94440000
                      LCLA  &ZLC           COLUMN POSITION              94480000
                      LCLA  &ZOPX          LIST TABLE INDEX             94520000
                      LCLC  &ZLL           LABEL                        94560000
                      LCLC  &ZLOP          OPERATION                    94600000
                      LCLC  &ZLV           VALUE                        94640000
                      LCLC  &ZLD           DESCRIPTION                  94680000
.*                                                                      94720000
&ZOPX                 SETA  1                                           94760000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            94800000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              94840000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              94880000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              94920000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              94960000
                      AIF   (K'&ZLD LE 0).ZL5                           95000000
&ZLC                  SETA  35             COMMENT COLUMN               95040000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    95080000
&ZLC                  SETA  33             COMMMENT COLUMN              95120000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   95160000
&ZLV                  SETC  '&ZLV'.' '                                  95200000
                      AGO   .ZL3                                        95240000
.*                                                                      95280000
.ZL4                  ANOP  ,                                           95320000
&ZLV                  SETC  '&ZLV'.' '                                  95360000
.ZL5                  ANOP  ,                                           95400000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               95440000
.*                                                                      95480000
&ZLL     &ZLOP &ZLV                                                     95520000
.*                                                                      95560000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               95600000
                      AGO   .ZL2           CONTINUE LOOPING             95640000
.*                                                                      95680000
.ZLX                  ANOP  ,                                           95720000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                95760000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  95800000
.*-----------BAL invocation code-------------                           95840000
.*********************************************************************  95880000
.*                                                                   *  95920000
.*  Branch or PC linkage                                             *  95960000
.*                                                                   *  96000000
.*********************************************************************  96040000
         LA    0,1                ++ SET IOSCAPU FUNCTION CODE          96080000
         AIF    ('&XLINKAGE' NE 'BRANCH').LNKPC1                        96120000
.*********************************************************************  96160000
.*                                                                   *  96200000
.*  Switch to AMODE 31 to access the IOVT.                           *  96240000
.*                                                                   *  96280000
.*********************************************************************  96320000
         LA    14,IOSCAPU_RETADDR_&SYSNDX     SAVE RETURN ADDRESS       96360000
         BSM   14,0                SAVE CALLER AMODE BIT INTO HIGH      96400000
*                                  ORDER BIT OF R14                     96440000
         LA    15,IOSCAPU_NXTADDR_&SYSNDX     GET THE NEXT ADDRESS      96456000
*                                                                 @01C  96472000
         O     15,IOSCAPU_X31_&SYSNDX         SET 31 BIT ADDRESSING     96488000
*                                                                 @01A  96504000
         BSM   0,15                SWITCH TO 31 BITE ADDRESSING MODE    96520000
IOSCAPU_X31_&SYSNDX  DC A(X'80000000')  FOR 31 BIT ADDRESSING     @01C  96560000
IOSCAPU_NXTADDR_&SYSNDX  DS    0H      FOR SWITCHING ADDR MODE.   @01C  96600000
.*********************************************************************  96640000
.*                                                                   *  96680000
.*  Get addressability to CVT                                        *  96720000
.*                                                                   *  96760000
.*********************************************************************  96800000
         L     15,16(0,0)                                               96840000
.*********************************************************************  96880000
.*                                                                   *  96920000
.*  Get addressability to IOCOM                                      *  96960000
.*                                                                   *  97000000
.*********************************************************************  97040000
         L     15,124(15,0)                                             97080000
.*********************************************************************  97120000
.*                                                                   *  97160000
.*  Get addressability to IOVT                                       *  97200000
.*                                                                   *  97240000
.*********************************************************************  97280000
         L     15,208(15,0)                                             97320000
         L     15,140(15,0)       ++ SET ADDR OF IOSVCAPB               97360000
         BR    15                 ++ BRANCH TO IOSVCAPB                 97400000
IOSCAPU_RETADDR_&SYSNDX  DS    0H  FOR SWIT. ADDR MODE                  97440000
         AGO   .DONE1                                                   97480000
.LNKPC1  ANOP                                                           97520000
         L     14,16(0,0)         ++ GET CVT ADDRESS                    97560000
         L     14,772(14,0)       ++ GET SFT ADDRESS                    97600000
.*********************************************************************  97640000
.*                                                                   *  97680000
.*  Get LX/EX for UCB Services                                       *  97720000
.*                                                                   *  97760000
.*  Note: LX/EX is calculated by multiplying the PC number (106)     *  97800000
.*        times the length of a PC/AUTH table entry (4) and          *  97840000
.*        then subtracting 4.                                        *  97880000
.*                                                                   *  97920000
.*********************************************************************  97960000
         L     14,420(14,0)       ++ GET LX/EX FOR Capture Service      98000000
         PC    0(14)              ++ PC TO IOSVCAPU                     98040000
.DONE1   ANOP                                                           98080000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  98120000
.ZLINKX               ANOP  ,                                           98160000
.*******************************************************************    98200000
.***AP.X01  FORMAT GENERATED CODE                                       98240000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            98280000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              98320000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              98360000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              98400000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              98440000
                      AIF   (K'&ZLD LE 0).ZL51                          98480000
&ZLC                  SETA  35             COMMENT COLUMN               98520000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   98560000
&ZLC                  SETA  33             COMMENT COLUMN               98600000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  98640000
&ZLV                  SETC  '&ZLV'.' '                                  98680000
                      AGO   .ZL31                                       98720000
.*                                                                      98760000
.ZL41                 ANOP  ,                                           98800000
&ZLV                  SETC  '&ZLV'.' '                                  98840000
.ZL51                 ANOP  ,                                           98880000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               98920000
.*                                                                      98960000
&ZLL     &ZLOP &ZLV                                                     99000000
.*                                                                      99040000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               99080000
                      AGO   .ZL21          CONTINUE LOOPING             99120000
.*                                                                      99160000
.ZLX1                 ANOP  ,                                           99200000
.*******************************************************************    99240000
.***AP.X02  END OF IOSCAPU MACRO                                        99280000
&ZIOSCAPU             SETC  'YES'          SET IOSCAPU USED             99320000
         POP   PRINT                                                    99360000
*                                            IOSCAPU-1                  99400000
         SPACE 1                                                        99440000
.ZLX2                 ANOP  ,                                           99480000
         MEND                                                           99520000
**********************************************************************/ 99560000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  99600000
*%IOSCAPU: MACRO KEYS(CAPTUCB,UCBPTR,CAPTPTR,MSIFREE,LASTING,CAPTCOM,   99640000
*                 UCAPTUCB,CAPTOACT,ASID,LINKAGE,RETCODE,RSNCODE,       99666600
*                 PLISTVER,MF);                                         99693200
*  ANS('?'!!MACLABEL!!' '!!'IOSCAPUP '!!MACLIST!!                       99720000
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              99760000
*%END IOSCAPU;                                                          99800000

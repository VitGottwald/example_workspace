*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IQPINFO                               -01/24/13-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Obtain PCIE Information                       * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2013                               * 00001200
*                                                                     * 00001300
* STATUS= HBB7790                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IQPINFO macro provides PCIE related information. IQPINFO   * 00002100
*      provides the following functions:                              * 00002200
*                                                                     * 00002300
*                                                                     * 00002400
*      o   PERFDATA - return the PCIE Performance Measurement data    * 00002500
*          for a PCIE Function (This data can be mapped by the        * 00002600
*          IQPYPERF mapping macro.)                                   * 00002700
*                                                                     * 00002800
*                                                                     * 00002900
*                                                                     * 00003000
*      The parameter list must be in the caller's primary address     * 00003100
*      space                                                          * 00003200
*                                                                     * 00003300
*      The contents of registers 14 through 1 are altered by the      * 00003400
*      macro expansion.                                               * 00003500
*                                                                     * 00003600
*                                                                     * 00003700
*                                                                     * 00003800
*01* EXTERNAL CLASSIFICATION:                                         * 00003900
*                                                                     * 00004000
*02* GUPI: BASE                                                       * 00004100
*                                                                     * 00004200
*02* PSPI: FIELDS                                                     * 00004300
*          PERFDATA PERFDATAPTR PERFDATALEN                           * 00004400
*                                                                     * 00004500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004600
*                                                                     * 00004700
*01* ENVIRONMENT:                                                     * 00004800
*                                                                     * 00004900
*                                                                     * 00005000
*      Dispatchable unit mode: Task or SRB mode.                      * 00005100
*                                                                     * 00005200
*      Minimum authorization: Supervisor state.  PSW Key 0.           * 00005300
*                                                                     * 00005400
*      AMODE:            31- or 64-bit.                               * 00005500
*                                                                     * 00005600
*      ASC mode:         Primary.                                     * 00005700
*                                                                     * 00005800
*                        This Interface is limited to callers which   * 00005900
*                        meet the following criteria:                 * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*                        o   supervisor state key 0                   * 00006300
*                                                                     * 00006400
*                        o   31 or 64 bit addressing mode             * 00006500
*                                                                     * 00006600
*                        o   primary ASC mode                         * 00006700
*                                                                     * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*01* SYNTAX:                                                          * 00007300
*                                                                     * 00007400
*Ýxlabel¨  IQPINFO    PERFDATA                                        * 00007500
*                         ,FCNINDEX=xfcnindex                         * 00007600
*                         ,PERFDATAPTR=xperfdataptr                   * 00007700
*                         ,PERFDATALEN=xperfdatalen                   * 00007800
*                    Ý,LINKAGE=»BRANCHº¨                              * 00007900
*                    Ý,RETCODE=xretcode¨                              * 00008000
*                    Ý,RSNCODE=xrsncode¨                              * 00008100
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00008200
*                   ÐÝ,MF=S¨                                          * 00008300
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00008400
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                     * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*      Where:                                                         * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*      Ýxlabel¨                                                       * 00009100
*          is an optional symbol, starting in column 1, that is the   * 00009200
*          name on the IQPINFO macro invocation.  The name must       * 00009300
*          conform to the rules for an ordinary assembler language    * 00009400
*          symbol.                                                    * 00009500
*          DEFAULT: No name.                                          * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*      The following is a set of mutually exclusive keys.  This set   * 00010100
*      is required; only one key must be specified.                   * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*      PERFDATA                                                       * 00010500
*          Obtain PCIE Performance Information.                       * 00010600
*                                                                     * 00010700
*                                                                     * 00010800
*          FCNINDEX=xfcnindex                                         * 00010900
*              is the name (RS-type), or address in register          * 00011000
*              (2)-(12), of a required fullword input/output PCIE     * 00011100
*              Function Index to start search from.  The IQPINFO      * 00011200
*              service will return performance data for the next      * 00011300
*              function in the PCIE Function Table after the supplied * 00011400
*              index value.  If an allocated PCIE function is found   * 00011500
*              in the table after the supplied PCIE Function Index,   * 00011600
*              the XFCNINDEX field is set to the index of the PCIE    * 00011700
*              Function upon which the performance data is returned.  * 00011800
*              If an allocated PCIE function is not found after the   * 00011900
*              supplied index, the XFCNINDEX field is set to 0.  To   * 00012000
*              get information for all allocated PCIE functions, this * 00012100
*              service should be called continuously starting with a  * 00012200
*              0 function index until a 0 function index is returned. * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*          PERFDATAPTR=xperfdataptr                                   * 00012800
*              is the name (RS-type), or address in register          * 00012900
*              (2)-(12), of a required 8 byte input that contains the * 00013000
*              address of area which is to receive the performance    * 00013100
*              data.  This area must be addressable in the primary    * 00013200
*              address space and must be on a doubleword boundary.    * 00013300
*              This area is mapped by macro IQPYPERF.                 * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*          PERFDATALEN=xperfdatalen                                   * 00013900
*              is the name (RS-type), or address in register          * 00014000
*              (2)-(12), of a required fullword input length of area  * 00014100
*              which is to receive the performance data.  If the      * 00014200
*              supplied length is not large enough to contain the     * 00014300
*              data to be returned, the supplied xPERFDATALEN field   * 00014400
*              is set to the length required to fit all of the data   * 00014500
*              to be returned.                                        * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*      End of a set of mutually exclusive required keys.              * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*      ÝLINKAGE=»BRANCHº¨                                             * 00015600
*          is an optional keyword input that indicates the linkage    * 00015700
*          that should be generated for the routine invocation.       * 00015800
*          DEFAULT: BRANCH                                            * 00015900
*                                                                     * 00016000
*                                                                     * 00016100
*          LINKAGE=BRANCH                                             * 00016200
*              requests branch-entry invocation.                      * 00016300
*                                                                     * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*      ÝRETCODE=xretcode¨                                             * 00017000
*          is the name (RS-type) of an optional fullword output       * 00017100
*          variable, or register (2)-(12) or (15), into which the     * 00017200
*          return code is to be copied from GPR 15.  If you specify   * 00017300
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00017400
*          the value will be left in GPR 15.                          * 00017500
*                                                                     * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*      ÝRSNCODE=xrsncode¨                                             * 00018000
*          is the name (RS-type) of an optional fullword output       * 00018100
*          variable into which the reason code is to be copied from   * 00018200
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00018300
*          R0 (within or without parentheses), the value will be left * 00018400
*          in GPR 0.                                                  * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00019000
*          is an optional byte input decimal value in the "1-1" range * 00019100
*          that specifies the macro version.  PLISTVER is the only    * 00019200
*          key allowed on the list form of MF and determines which    * 00019300
*          parameter list is generated.  Note that MAX may be         * 00019400
*          specified instead of a number, and the parameter list will * 00019500
*          be of the largest size currently supported. This size may  * 00019600
*          grow from release to release (thus possibly affecting the  * 00019700
*          amount of storage needed by your program).  If your        * 00019800
*          program can tolerate this, IBM recommends that you always  * 00019900
*          specify MAX when creating the list form parameter list as  * 00020000
*          that will ensure that the list form parameter list is      * 00020100
*          always long enough to hold whatever parameters might be    * 00020200
*          specified on the execute form.                             * 00020300
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00020400
*          default is the lowest version which allows all of the      * 00020500
*          parameters specified on the invocation to be processed.    * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*      ÝMF=»S!L!Eº¨                                                   * 00021100
*          is an optional keyword input which specifies the macro     * 00021200
*          form.                                                      * 00021300
*          DEFAULT: S                                                 * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*          ÝMF=S¨                                                     * 00021700
*              specifies the standard form of the macro.  The "S"     * 00021800
*              form generates code to put the parameters into an      * 00021900
*              in-line parameter list and invoke the desired service. * 00022000
*              Full checking for required macro keys is done along    * 00022100
*              with supplying defaults for omitted optional           * 00022200
*              parameters.                                            * 00022300
*                                                                     * 00022400
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00022500
*              specifies the list form of the macro.  The "L" form    * 00022600
*              defines an area to be used for the parameter list.     * 00022700
*              Only the PLISTVER key may be specified on the          * 00022800
*              invocation.  All other macro parameters are flagged as * 00022900
*              errors.  If PLISTVER is not specified, the original    * 00023000
*              parameter list definition is used.                     * 00023100
*                                                                     * 00023200
*            ,xmfctrl                                                 * 00023300
*              is a required input.  It is the name of a storage area * 00023400
*              for the parameter list.                                * 00023500
*                                                                     * 00023600
*            »,xmfattr!0Dº                                            * 00023700
*              is an optional 60 character input string that varies   * 00023800
*              from 1 to 60 characters. Use it to force boundary      * 00023900
*              alignment of the parameter list. Use only 0F or 0D.    * 00024000
*              DEFAULT: 0D which forces the parameter list to a       * 00024100
*              doubleword boundary.                                   * 00024200
*                                                                     * 00024300
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00024400
*              specifies the execute form of the macro.  The "E" form * 00024500
*              generates code to put the parameters into the          * 00024600
*              parameter list specified by xmfctrl and provides full  * 00024700
*              syntax checking with default setting.                  * 00024800
*                                                                     * 00024900
*            ,xmfctrl                                                 * 00025000
*              is a required input.  It is the name (RS-type), or     * 00025100
*              address in register (1)-(12), of a storage area for    * 00025200
*              the parameter list.                                    * 00025300
*                                                                     * 00025400
*            »,COMPLETEº                                              * 00025500
*              is an optional keyword input which specifies the       * 00025600
*              degree of macro parameter syntax checking.             * 00025700
*              DEFAULT: COMPLETE                                      * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*              COMPLETE                                               * 00026100
*                  Checking for required macro keys is done and       * 00026200
*                  defaults are supplied for omitted optional         * 00026300
*                  parameters.                                        * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*01* RETURN CODES:                                                    * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                 X'00'     The requested function was successfully   * 00027600
*                           executed.                                 * 00027700
*                                                                     * 00027800
*                 X'08'     Supplied Data Area to receive output from * 00027900
*                           IQPINFO is not large enough to hold all   * 00028000
*                           of the data to be returned.  The supplied * 00028100
*                           length field is set to contain the size   * 00028200
*                           of the area that is required to fit all   * 00028300
*                           of the data to be returned.  No           * 00028400
*                           meaningful data is returned when this     * 00028500
*                           return code is set.                       * 00028600
*                                                                     * 00028700
*                 X'0C'     Caller is not authorized to use IQPINFO.  * 00028800
*                           Callers must be running Key 0, Supervisor * 00028900
*                           State to use the IQPINFO Service.         * 00029000
*                                                                     * 00029100
*                 X'10'     Unexpected Error occurred during IQPINFO  * 00029200
*                           Processing.  Retry the IQPINFO Request.   * 00029300
*                           If the IQPINFO service continues to fail  * 00029400
*                           in this manner contact IBM Service.       * 00029500
*                                                                     * 00029600
*                 X'14'     The requested IQPINFO PLISTVER number is  * 00029700
*                           incorrect.                                * 00029800
*                                                                     * 00029900
*                 X'18'     Supplied data area address is not on a    * 00030000
*                           doubleword boundary                       * 00030100
*                                                                     * 00030200
*                 X'20'     IQPINFO Service is not available.  PCIE   * 00030300
*                           Services have not been enabled on the     * 00030400
*                           current system.                           * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*                                                                     * 00031000
*01* REASON CODES:                                                    * 00031100
*                                                                     * 00031200
*       See return codes section.                                     * 00031300
*                                                                     * 00031400
*01* MODULE TYPE:  ASSEM MACRO                                        * 00031500
*                                                                     * 00031600
*02*   PROCESSOR:  ASSEM                                              * 00031700
*                                                                     * 00031800
*01* COMPONENT:  SCIQP                                                * 00031900
*                                                                     * 00032000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00032100
*                                                                     * 00032200
*01* MACRO USAGE NOTES:                                               * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00032600
*        global macro variable.  Any value other than 'NO' will       * 00032700
*        result in the macro expansion being printed.  The default is * 00032800
*        'YES'.  The following examples illustrate how the ZPRINT     * 00032900
*        variable should be set.                                      * 00033000
*                                                                     * 00033100
*                    GBLC &ZPRINT                                     * 00033200
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*    2.  All keys currently contained in the IQPINFO macro correspond * 00033600
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00033700
*        MAX.                                                         * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*01* CHANGE ACTIVITY:                                                 * 00034300
*                                                                     * 00034400
*   Flag LineItem  FMID    Date   ID    Comment                       * 00034500
*                                                                     * 00034600
*    $L0=IOSPEN   HBB7790 101129 PDI6:  PCIE Services                 * 00034700
*    $L1=FPGA     HBB7790 130130 PDJI:  Update return code values in  * 00034800
*                                         prolog.                     * 00034900
****** END OF SPECIFICATIONS *****************************************/ 00035000
*/********************************************************************* 00035100
         MACRO                                                          00035200
&XLABEL  IQPINFO &FCNINDEX=,&PERFDATAPTR=,&PERFDATALEN=,&LINKAGE=,     *00035300
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00035400
.*                                                                      00035500
*                 MACDATE -01/24/13-<1>                                 00035600
.*                                                                      00035700
.*******************************************************************    00035800
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00035900
.*******************************************************************    00036000
                 GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                00036100
                 GBLC  &ZTEST      YES=TEST NO=NO TEST                  00036200
                 GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX          00036300
.*                                                                      00036400
                 GBLC  &ZIQPINFO   YES=MACRO USED AT LEAST ONCE         00036500
.*******************************************************************    00036600
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00036700
.*******************************************************************    00036800
                 LCLC  &ZMS        ERROR MESSAGE WORK AREA              00036900
                 LCLC  &ZCNDX      SYSNDX CHARACTERS                    00037000
                 LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED           00037100
                 LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR          00037200
                 LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE          00037300
                 LCLA  &ZAWRK      USED AS A WORK AREA                  00037400
                 LCLA  &ZASIZ      USED FOR SIZE OF VALUE               00037500
                 LCLA  &ZN         NUMERIC WORK VARIABLE                00037600
                 LCLC  &ZC         CHARACTER WORK VARIABLE              00037700
                 LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE          00037800
                 LCLA  &ZTLA       VALUE TOO LONG VARIABLE              00037900
                 LCLC  &ZMAC_G     "G" or null                          00038000
&ZMAC_G          SETC  ''                                               00038100
                 LCLC  &ZMAC_LR                                         00038200
&ZMAC_LR         SETC  'LR'                                             00038300
                 LCLC  &ZMAC_L                                          00038400
&ZMAC_L          SETC  'L'                                              00038500
                 LCLC  &ZMAC_ST                                         00038600
&ZMAC_ST         SETC  'ST'                                             00038700
                 LCLC  &ZMAC_LLGT                                       00038800
&ZMAC_LLGT       SETC  'L'                                              00038900
                 LCLC  &ZMAC_LGR                                        00039000
&ZMAC_LGR        SETC  'LR'                                             00039100
                 LCLC  &ZMAC_LG                                         00039200
&ZMAC_LG         SETC  'L'                                              00039300
                 LCLC  &ZMAC_STG                                        00039400
&ZMAC_STG        SETC  'ST'                                             00039500
                 LCLA  &ZMACRET    MACRO RETURN CODE                    00039600
&ZMACRET         SETA  0           ASSUME NO ERRORS                     00039700
.*                                                                      00039800
                 LCLC  &ZCSYSLIST(255)          NONXKEY, POS ARRAY      00039900
                 LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()           00040000
                 LCLA  &ZPLLEN     PARAMETER LIST LENGTH                00040100
                 LCLC  &ZENDBASEPL              End of base PL          00040200
                 LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                00040300
.*******************************************************************    00040400
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00040500
.*******************************************************************    00040600
                 LCLA  &ZI         INDEX FOR ARRAY                      00040700
                 LCLA  &ZJ         INDEX FOR PARMS                      00040800
                 LCLA  &ZK         INDEX FOR PARSE                      00040900
                 LCLA  &ZLO        LOW RANGE VALUE                      00041000
                 LCLA  &ZHI        HIGH RANGE VALUE                     00041100
                 LCLC  &ZW         WORK AREA FOR PARM                   00041200
.********************************************************************   00041300
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00041400
.********************************************************************   00041500
                 GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL              00041600
                 GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE       00041700
                 GBLA  &SYSALVL    SYSSTATE ARCHLVL                     00041800
                 GBLC  &SYSAM64    SYSSTATE AMODE64                     00041900
.*                                                                      00042000
                 AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED       00042100
                 AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED        00042200
                 SPLEVEL  TEST                                          00042300
.ZSYS2           ANOP  ,                                                00042400
                 AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1            00042500
                 AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1            00042600
                 SYSSTATE TEST                                          00042700
                 AGO   .ZSYS4                                           00042800
.ZSYS3           ANOP  ,                                                00042900
&SYSASCE         SETC  'P'         ASSUME SYSSTATE PRIMARY              00043000
.ZSYS4           ANOP  ,                                                00043100
                 AIF   ('&SYSAM64' NE 'YES').ZSYSN64                    00043200
&ZMAC_LLGT       SETC 'LLGT'                                            00043300
&ZMAC_LGR        SETC 'LGR'                                             00043400
&ZMAC_LG         SETC 'LG'                                              00043500
&ZMAC_STG        SETC 'STG'                                             00043600
.ZSYSN64         ANOP  ,                                                00043700
.*******************************************************************    00043800
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00043900
.*******************************************************************    00044000
                 LCLC  &XFUNCTN    ++ VALUE                             00044100
                 LCLC  &XPERFDATA  ++ VALUE                             00044200
                 LCLC  &XFCNINDEX  ++ NAME                              00044300
                 LCLC  &XPERFDATAPTR            ++ NAME                 00044400
                 LCLC  &XPERFDATALEN            ++ NAME                 00044500
                 LCLC  &XLINKAGE   ++ VALUE                             00044600
                 LCLC  &XRETCODE   ++ NAME                              00044700
                 LCLC  &XRSNCODE   ++ NAME                              00044800
                 LCLA  &XPLISTVER  ++ VALUE                             00044900
                 LCLC  &XMF        ++ VALUE                             00045000
                 LCLC  &XMFCTRL    ++ NAME                              00045100
                 LCLC  &XMFATTR    ++ VALUE                             00045200
                 LCLC  &XMFSCK     ++ VALUE                             00045300
.*******************************************************************    00045400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00045500
.*******************************************************************    00045600
                 LCLC  &ZXFUNCTN   ++ INPUT VALUE                       00045700
                 LCLC  &ZXPERFDATA              ++ INPUT VALUE          00045800
                 LCLC  &ZXFCNINDEX              ++ INOUT NAME           00045900
                 LCLC  &ZXPERFDATAPTR           ++ INPUT NAME           00046000
                 LCLC  &ZXPERFDATALEN           ++ INPUT NAME           00046100
                 LCLC  &ZXLINKAGE  ++ INPUT VALUE                       00046200
                 LCLC  &ZXRETCODE  ++ OUTPUT NAME                       00046300
                 LCLC  &ZXRSNCODE  ++ OUTPUT NAME                       00046400
                 LCLC  &ZXPLISTVER              ++ INPUT VALUE          00046500
                 LCLC  &ZXMF       ++ INPUT VALUE                       00046600
                 LCLC  &ZXMFCTRL   ++ INPUT NAME                        00046700
                 LCLC  &ZXMFATTR   ++ INPUT VALUE                       00046800
                 LCLC  &ZXMFSCK    ++ INPUT VALUE                       00046900
.********************************************************************   00047000
.***AC.PLV01  PROCESS PLISTVER                                      *   00047100
.********************************************************************   00047200
&XPLISTVER      SETA  1                                                 00047300
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00047400
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00047500
&XPLISTVER      SETA  1                                                 00047600
.ZPLV0          ANOP  ,                                                 00047700
.*                                                                      00047800
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00047900
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00048000
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00048100
.*-------------------------------------------------------------------   00048200
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00048300
&ZMS            SETC  '"PLISTVER='                                      00048400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00048500
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00048600
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00048700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00048800
                AGO   .ZPVCK2                                           00048900
.ZPVCK3         ANOP  ,                                                 00049000
.*-------------------------------------------------------------------   00049100
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00049200
&ZMS            SETC  '"PLISTVER='                                      00049300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00049400
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00049500
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00049600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00049700
                AGO   .ZPVCKE                                           00049800
.ZPVCK2         ANOP  ,                                                 00049900
.*-------------------------------------------------------------------   00050000
&ZCVAL          SETC  '&PLISTVER(1)'                                    00050100
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00050200
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00050300
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00050400
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00050500
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00050600
.ZPVCK6         ANOP  ,                                                 00050700
&ZMS            SETC  '"PLISTVER='                                      00050800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00050900
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00051000
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00051100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00051200
&XPLISTVER      SETA  1                                                 00051300
                AGO   .ZPVCKE                                           00051400
.*-------------------------------------------------------------------   00051500
.ZPVCK4A        ANOP  ,                                                 00051600
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00051700
&ZMS            SETC  'PLISTVER='                                       00051800
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00051900
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00052000
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00052100
                MNOTE 8,' &ZMS IS REQUIRED.'                            00052200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00052300
                AGO   .ZPVCK5                                           00052400
.ZPVCK4         ANOP  ,                                                 00052500
&XPLISTVER      SETA  &PLISTVER(1)                                      00052600
.ZPVCK5         ANOP  ,                                                 00052700
.ZPVCKE         ANOP  ,                                                 00052800
.********************************************************************   00052900
.***AG.MF01 PROCESS MF MACRO FORMS                                      00053000
.********************************************************************   00053100
                 ACTR  10000                                            00053200
.*------------------------------------------------------------------    00053300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00053400
&XMF             SETC  ''          INITIALIZE XVARIABLE                 00053500
.*-------------------------------------------------------------------   00053600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00053700
.ZG28            ANOP  ,                                                00053800
&ZTLC            SETC 'S'                                               00053900
                 AIF   ('&MF(1)' NE '&ZTLC').ZG29                       00054000
&XMF             SETC  'S'         SET KEYWORD                          00054100
                 AIF   (N'&MF LE 1).ZG28A       CK NUM                  00054200
&ZMS             SETC  '"MF='                                           00054300
&ZMS             SETC  '&ZMS.&MF"'                                      00054400
&ZMS             SETC  '&ZMS "MF"'                                      00054500
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00054600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00054700
.ZG28A           ANOP  ,                                                00054800
.*-------------------------------------------------------------------   00054900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00055000
.ZG29            ANOP  ,                                                00055100
&ZTLC            SETC 'L'                                               00055200
                 AIF   ('&MF(1)' NE '&ZTLC').ZG36                       00055300
&XMF             SETC  'L'         SET KEYWORD                          00055400
                 AIF   (N'&MF LE 3).ZG29A       CK NUM                  00055500
&ZMS             SETC  '"MF='                                           00055600
&ZMS             SETC  '&ZMS.&MF"'                                      00055700
&ZMS             SETC  '&ZMS "MF"'                                      00055800
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00055900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00056000
.ZG29A           ANOP  ,                                                00056100
.*-------------------------------------------------------------------   00056200
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00056300
                 AIF   (N'&SYSLIST NE 0).ZG29B  POSITIONALS?            00056400
                 AIF   ('&FCNINDEX' NE '').ZG29B  KEYS?                 00056500
                 AIF   ('&PERFDATAPTR' NE '').ZG29B  KEYS?              00056600
                 AIF   ('&PERFDATALEN' NE '').ZG29B  KEYS?              00056700
                 AIF   ('&LINKAGE' NE '').ZG29B  KEYS?                  00056800
                 AIF   ('&RETCODE' NE '').ZG29B  KEYS?                  00056900
                 AIF   ('&RSNCODE' NE '').ZG29B  KEYS?                  00057000
                 AGO    .ZG29C     INVOCATION OKAY                      00057100
.ZG29B           ANOP  ,                                                00057200
&ZMS             SETC  'THE "L" FORM OF "MF"'                           00057300
&ZMS             SETC  '&ZMS CAN ONLY HAVE'                             00057400
&ZMS             SETC  '&ZMS THE "PLISTVER" KEY'                        00057500
                 MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'           00057600
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00057700
.ZG29C           ANOP  ,                                                00057800
.*-------------------------------------------------------------------   00057900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00058000
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00058100
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00058200
                 AIF   (N'&MF(2) GT 1).ZG31B    MULTI PARMS             00058300
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00058400
.ZG31B           AIF   (K'&MF(2) GT 0).ZG31C                            00058500
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00058600
&ZMS             SETC  'WHEN "L" IS SPECIFIED'                          00058700
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00058800
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00058900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00059000
.ZG31C           ANOP  ,                                                00059100
.*-------------------------------------------------------------------   00059200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00059300
                 AIF   (K'&ZXMFCTRL LE 0).ZG31P  NOT I/O                00059400
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG31P                   00059500
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00059600
&ZMS             SETC  '"MF='                                           00059700
&ZMS             SETC  '&ZMS.&MF"'                                      00059800
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00059900
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                00060000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00060100
.ZG31P           ANOP  ,                                                00060200
.*-------------------------------------------------------------------   00060300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00060400
&ZXMFATTR        SETC  'INPUT'     SET IN/OUTPUT                        00060500
&XMFATTR         SETC  '0D'                                             00060600
                 AIF   (K'&MF(3) LE 0).ZG34B    PARM                    00060700
&XMFATTR         SETC  '&MF(3,1)'  SET XVARIABLE                        00060800
                 AIF   (N'&MF(3) GT 1).ZG34B    MULTI                   00060900
&XMFATTR         SETC  '&MF(3)'    SET XVARIABLE                        00061000
.ZG34B           ANOP  ,                                                00061100
.*-------------------------------------------------------------------   00061200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00061300
                 AIF   (K'&ZXMFATTR LE 0).ZG34P  NOT I/O                00061400
                 AIF   ('&XMFATTR'(1,1) NE '(').ZG34P                   00061500
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00061600
&ZMS             SETC  '"MF='                                           00061700
&ZMS             SETC  '&ZMS.&MF"'                                      00061800
&ZMS             SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'        00061900
                 MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                00062000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00062100
.ZG34P           ANOP  ,                                                00062200
.*-------------------------------------------------------------------   00062300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00062400
                 AIF   (K'&ZXMFATTR LE 0).ZG34S  NOT I/O                00062500
                 AIF   (K'&XMFATTR LE 60).ZG34S  LNG OK                 00062600
&ZXMFATTR        SETC  ''          RESET IN/OUTPUT                      00062700
&ZMS             SETC  '"MF='                                           00062800
&ZMS             SETC  '&ZMS.&MF"'                                      00062900
&ZMS             SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'            00063000
                 MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'               00063100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00063200
.ZG34S           ANOP  ,                                                00063300
.*-------------------------------------------------------------------   00063400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00063500
.ZG36            ANOP  ,                                                00063600
&ZTLC            SETC 'E'                                               00063700
                 AIF   ('&MF(1)' NE '&ZTLC').ZG44                       00063800
&XMF             SETC  'E'         SET KEYWORD                          00063900
                 AIF   (N'&MF LE 3).ZG36A       CK NUM                  00064000
&ZMS             SETC  '"MF='                                           00064100
&ZMS             SETC  '&ZMS.&MF"'                                      00064200
&ZMS             SETC  '&ZMS "MF"'                                      00064300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'             00064400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00064500
.ZG36A           ANOP  ,                                                00064600
.*-------------------------------------------------------------------   00064700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00064800
&ZXMFCTRL        SETC  'INPUT'     SET IN/OUTPUT                        00064900
&XMFCTRL         SETC  '&MF(2,1)'  SET XVARIABLE                        00065000
                 AIF   (N'&MF(2) GT 1).ZG38B    MULTI PARMS             00065100
&XMFCTRL         SETC  '&MF(2)'    SET XVARIABLE                        00065200
.ZG38B           AIF   (K'&MF(2) GT 0).ZG38C                            00065300
&ZXMFCTRL        SETC  ''          RESET IN/OUTPUT                      00065400
&ZMS             SETC  'WHEN "E" IS SPECIFIED'                          00065500
&ZMS             SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'              00065600
                 MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                     00065700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00065800
.ZG38C           ANOP  ,                                                00065900
.*-------------------------------------------------------------------   00066000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00066100
                 AIF   (K'&ZXMFCTRL LE 0).ZG38R  NOT I/O                00066200
                 AIF   ('&XMFCTRL'(1,1) NE '(').ZG38R                   00066300
&ZCGPR           SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                       00066400
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                     00066500
                 AIF   (K'&ZCGPR GT 2).ZG38Q                            00066600
                 AIF   ('&ZCGPR' EQ '0').ZG38Q                          00066700
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00066800
                 AIF   (T'&ZCGPR NE 'N').ZG38Q  INVALID REG NAME        00066900
.ZG38P           ANOP  ,                                                00067000
                 AIF   (T'&ZCGPR NE 'N').ZG38R  NON NUMERIC             00067100
                 AIF   ('&ZCGPR' LT '1').ZG38Q                          00067200
                 AIF   ('&ZCGPR' LE '12').ZG38R                         00067300
.ZG38Q           ANOP  ,                                                00067400
&ZMS             SETC  '"MF='                                           00067500
&ZMS             SETC  '&ZMS.&MF"'                                      00067600
&ZMS             SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'        00067700
                 MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                 00067800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00067900
.ZG38R           ANOP  ,                                                00068000
.*-------------------------------------------------------------------   00068100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00068200
&XMFSCK          SETC  ''          INITIALIZE XVARIABLE                 00068300
.ZG42A   AIF   ('&MF(3)' NE 'COMPLETE').ZG43A                           00068400
&XMFSCK          SETC  'COMPLETE'  SET KEYWORD                          00068500
.*-------------------------------------------------------------------   00068600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00068700
.ZG43A           AIF   (K'&XMFSCK GT 0).ZG43C   KEYWORD                 00068800
                 AIF   (K'&MF(3) LE 0).ZG43B                            00068900
&ZMS             SETC  '"MF='                                           00069000
&ZMS             SETC  '&ZMS.&MF"'                                      00069100
&ZMS             SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '        00069200
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00069300
&ZMS             SETC  '&ZMS "COMPLETE".'                               00069400
                 MNOTE 8,' &ZMS '                                       00069500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00069600
.ZG43B           ANOP  ,                                                00069700
&XMFSCK          SETC  'COMPLETE'  SET DEFAULT KEYWORD                  00069800
.ZG43C           ANOP  ,                                                00069900
&ZXMFSCK         SETC  'INPUT'     SET IN/OUTPUT                        00070000
.*------------------------------------------------------------------    00070100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00070200
.ZG44            ANOP  ,                                                00070300
&ZXMF            SETC  'INPUT'     SET IN/OUTPUT                        00070400
                 AIF   (K'&XMF GT 0).ZG44E      VALID ARG               00070500
                 AIF   (T'&MF EQ 'O').ZG44D     OMITTED                 00070600
&ZASYSLNDX       SETA  0                                                00070700
.ZG44A           ANOP  ,           POSITIONAL MACRO KEY                 00070800
&ZASYSLNDX       SETA  &ZASYSLNDX+1                                     00070900
                 AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG44C                 00071000
&ZTLC            SETC 'MF'                                              00071100
                 AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG44A        00071200
.ZG44B           ANOP  ,                                                00071300
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00071400
&ZMS             SETC  'THE "MF" KEY'                                   00071500
&ZMS             SETC  '&ZMS MUST CONTAIN ONE'                          00071600
                 MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                 00071700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00071800
                 AGO   .ZG44E                                           00071900
.ZG44C           ANOP  ,                                                00072000
&ZXMF            SETC  ''          RESET IN/OUTPUT                      00072100
&ZMS             SETC  '"MF='                                           00072200
&ZMS             SETC  '&ZMS.&MF"'                                      00072300
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00072400
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00072500
&ZMS             SETC  '&ZMS "S",'                                      00072600
&ZMS             SETC  '&ZMS "L",'                                      00072700
&ZMS             SETC  '&ZMS OR "E".'                                   00072800
                 MNOTE 8,' &ZMS '                                       00072900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00073000
                 AGO   .ZG44E                                           00073100
.ZG44D           ANOP  ,                                                00073200
&XMF             SETC  'S'         SET DEFAULT KEYWORD                  00073300
&XMFSCK          SETC  'COMPLETE'  COMPLETE CHECKING                    00073400
.ZG44E           ANOP  ,                                                00073500
.********************************************************************   00073600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00073700
.********************************************************************   00073800
                 ACTR  10000                                            00073900
.*-------------------------------------------------------------------   00074000
.***AG.MF03 MF=(SLE)                                                    00074100
                 AIF   ('&XMF' EQ 'L').ZGMFX                            00074200
.*-------------------------------------------------------------------   00074300
.***AG.KMEKY05 VALUE, RQD INPUT, ME KEYS -NO ARGUMENTS                  00074400
&XFUNCTN         SETC  ''          INITIALIZE XVARIABLE                 00074500
&ZASYSLNDX       SETA  0                                                00074600
.ZG2A            ANOP  ,           POSITIONAL KEY SEARCH                00074700
&ZASYSLNDX       SETA  &ZASYSLNDX+1             NEXT POSITIONAL         00074800
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00074900
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00075000
         AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'PERFDATA').ZG2A              00075100
&ZCSYSLIST(&ZASYSLNDX) SETC 'NONXKEY'           KEY IS NON-XKEY         00075200
&ZXFUNCTN        SETC  'INPUT'     SET IN/OUTPUT                        00075300
&XFUNCTN         SETC  'PERFDATA'  SET XVARIABLE                        00075400
&ZXPERFDATA      SETC  'INPUT'     SET IN/OUTPUT                        00075500
&XPERFDATA       SETC  'PERFDATA'  SET XVARIABLE PARM                   00075600
.ZG2B            ANOP  ,                                                00075700
.*------------------------------------------------------------------    00075800
.***AG.KME4Y09 VALUE, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED          00075900
                 AIF   (K'&XFUNCTN GT 0).ZG12B                          00076000
&ZXFUNCTN        SETC  ''          RESET IN/OUTPUT                      00076100
&ZXPERFDATA      SETC  ''          RESET IN/OUTPUT                      00076200
&XFUNCTN         SETC  ''          ENSURE NULL                          00076300
&XPERFDATA       SETC  ''          ENSURE NULL                          00076400
&ZMS             SETC  'ONE OF THE FOLLOWING'                           00076500
&ZMS             SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'              00076600
&ZMS             SETC  '&ZMS REQUIRED:'                                 00076700
&ZMS             SETC  '&ZMS "PERFDATA".'       VALID ME KEY            00076800
                 MNOTE 8,' &ZMS '                                       00076900
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00077000
.ZG12B           ANOP  ,                                                00077100
.*-------------------------------------------------------------------   00077200
.***AG.KMEKY13 VALUE, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES          00077300
.ZG2ZY  AIF    ('&XFUNCTN' NE 'PERFDATA').ZG12ZY                        00077400
.*----------------------------------------------------------------***   00077500
.***AG.KXVAR05 NAME, RQD INOUT, KEYS -XVARIABLE KEY                     00077600
                 AIF   (N'&FCNINDEX LE 1).ZG4A  CK NUM                  00077700
&ZMS             SETC  '"FCNINDEX='                                     00077800
&ZMS             SETC  '&ZMS.&FCNINDEX"'                                00077900
&ZMS             SETC  '&ZMS "FCNINDEX"'                                00078000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00078100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00078200
.ZG4A            ANOP  ,                                                00078300
.*-------------------------------------------------------------------   00078400
.***AG.KXVAR06 NAME, RQD INOUT, KEYS -XVARIABLE                         00078500
&ZXFCNINDEX      SETC  'INOUT'     SET IN/OUTPUT                        00078600
&XFCNINDEX       SETC  '&FCNINDEX(1)'           SET XVARIABLE           00078700
                 AIF   (N'&FCNINDEX GT 1).ZG4B  MULTI PARMS             00078800
&XFCNINDEX       SETC  '&FCNINDEX'              SET XVARIABLE           00078900
.ZG4B            AIF   (K'&FCNINDEX(1) GT 0).ZG4C                       00079000
&ZXFCNINDEX      SETC  ''          RESET IN/OUTPUT                      00079100
&ZMS             SETC  ' '                                              00079200
&ZMS             SETC  '&ZMS "FCNINDEX" KEY AND ITS'                    00079300
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00079400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00079500
.ZG4C            ANOP  ,                                                00079600
.*-------------------------------------------------------------------   00079700
.***AG.KCK02 NAME, RQD INOUT, KEYS -GPR OUT OF RANGE                    00079800
                 AIF   (K'&ZXFCNINDEX LE 0).ZG4R  NOT I/O               00079900
                 AIF   ('&XFCNINDEX'(1,1) NE '(').ZG4R                  00080000
&ZCGPR           SETC  '&XFCNINDEX'(2,K'&XFCNINDEX-2)                   00080100
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG4P                      00080200
                 AIF   (K'&ZCGPR GT 2).ZG4Q                             00080300
                 AIF   ('&ZCGPR' EQ '0').ZG4Q                           00080400
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00080500
                 AIF   (T'&ZCGPR NE 'N').ZG4Q   INVALID REG NAME        00080600
.ZG4P            ANOP  ,                                                00080700
                 AIF   (T'&ZCGPR NE 'N').ZG4R   NON NUMERIC             00080800
                 AIF   ('&ZCGPR' LT '2').ZG4Q                           00080900
                 AIF   ('&ZCGPR' LE '12').ZG4R                          00081000
.ZG4Q            ANOP  ,                                                00081100
&ZMS             SETC  '"FCNINDEX='                                     00081200
&ZMS             SETC  '&ZMS.&FCNINDEX"'                                00081300
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00081400
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00081500
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00081600
.ZG4R            ANOP  ,                                                00081700
.*----------------------------------------------------------------***   00081800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00081900
                 AIF   (N'&PERFDATAPTR LE 1).ZG7A  CK NUM               00082000
&ZMS             SETC  '"PERFDATAPTR='                                  00082100
&ZMS             SETC  '&ZMS.&PERFDATAPTR"'                             00082200
&ZMS             SETC  '&ZMS "PERFDATAPTR"'                             00082300
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00082400
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00082500
.ZG7A            ANOP  ,                                                00082600
.*-------------------------------------------------------------------   00082700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00082800
&ZXPERFDATAPTR   SETC  'INPUT'     SET IN/OUTPUT                        00082900
&XPERFDATAPTR    SETC  '&PERFDATAPTR(1)'        SET XVARIABLE           00083000
                 AIF   (N'&PERFDATAPTR GT 1).ZG7B  MULTI PARMS          00083100
&XPERFDATAPTR    SETC  '&PERFDATAPTR'           SET XVARIABLE           00083200
.ZG7B            AIF   (K'&PERFDATAPTR(1) GT 0).ZG7C                    00083300
&ZXPERFDATAPTR   SETC  ''          RESET IN/OUTPUT                      00083400
&ZMS             SETC  ' '                                              00083500
&ZMS             SETC  '&ZMS "PERFDATAPTR" KEY AND ITS'                 00083600
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00083700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00083800
.ZG7C            ANOP  ,                                                00083900
.*-------------------------------------------------------------------   00084000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00084100
                 AIF   (K'&ZXPERFDATAPTR LE 0).ZG7R  NOT I/O            00084200
                 AIF   ('&XPERFDATAPTR'(1,1) NE '(').ZG7R               00084300
&ZCGPR           SETC  '&XPERFDATAPTR'(2,K'&XPERFDATAPTR-2)             00084400
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG7P                      00084500
                 AIF   (K'&ZCGPR GT 2).ZG7Q                             00084600
                 AIF   ('&ZCGPR' EQ '0').ZG7Q                           00084700
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00084800
                 AIF   (T'&ZCGPR NE 'N').ZG7Q   INVALID REG NAME        00084900
.ZG7P            ANOP  ,                                                00085000
                 AIF   (T'&ZCGPR NE 'N').ZG7R   NON NUMERIC             00085100
                 AIF   ('&ZCGPR' LT '2').ZG7Q                           00085200
                 AIF   ('&ZCGPR' LE '12').ZG7R                          00085300
.ZG7Q            ANOP  ,                                                00085400
&ZMS             SETC  '"PERFDATAPTR='                                  00085500
&ZMS             SETC  '&ZMS.&PERFDATAPTR"'                             00085600
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00085700
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00085800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00085900
.ZG7R            ANOP  ,                                                00086000
.*----------------------------------------------------------------***   00086100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00086200
                 AIF   (N'&PERFDATALEN LE 1).ZG10A  CK NUM              00086300
&ZMS             SETC  '"PERFDATALEN='                                  00086400
&ZMS             SETC  '&ZMS.&PERFDATALEN"'                             00086500
&ZMS             SETC  '&ZMS "PERFDATALEN"'                             00086600
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00086700
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00086800
.ZG10A           ANOP  ,                                                00086900
.*-------------------------------------------------------------------   00087000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00087100
&ZXPERFDATALEN   SETC  'INPUT'     SET IN/OUTPUT                        00087200
&XPERFDATALEN    SETC  '&PERFDATALEN(1)'        SET XVARIABLE           00087300
                 AIF   (N'&PERFDATALEN GT 1).ZG10B  MULTI PARMS         00087400
&XPERFDATALEN    SETC  '&PERFDATALEN'           SET XVARIABLE           00087500
.ZG10B           AIF   (K'&PERFDATALEN(1) GT 0).ZG10C                   00087600
&ZXPERFDATALEN   SETC  ''          RESET IN/OUTPUT                      00087700
&ZMS             SETC  ' '                                              00087800
&ZMS             SETC  '&ZMS "PERFDATALEN" KEY AND ITS'                 00087900
                 MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                 00088000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00088100
.ZG10C           ANOP  ,                                                00088200
.*-------------------------------------------------------------------   00088300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00088400
                 AIF   (K'&ZXPERFDATALEN LE 0).ZG10R  NOT I/O           00088500
                 AIF   ('&XPERFDATALEN'(1,1) NE '(').ZG10R              00088600
&ZCGPR           SETC  '&XPERFDATALEN'(2,K'&XPERFDATALEN-2)             00088700
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                     00088800
                 AIF   (K'&ZCGPR GT 2).ZG10Q                            00088900
                 AIF   ('&ZCGPR' EQ '0').ZG10Q                          00089000
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00089100
                 AIF   (T'&ZCGPR NE 'N').ZG10Q  INVALID REG NAME        00089200
.ZG10P           ANOP  ,                                                00089300
                 AIF   (T'&ZCGPR NE 'N').ZG10R  NON NUMERIC             00089400
                 AIF   ('&ZCGPR' LT '2').ZG10Q                          00089500
                 AIF   ('&ZCGPR' LE '12').ZG10R                         00089600
.ZG10Q           ANOP  ,                                                00089700
&ZMS             SETC  '"PERFDATALEN='                                  00089800
&ZMS             SETC  '&ZMS.&PERFDATALEN"'                             00089900
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00090000
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                 00090100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00090200
.ZG10R           ANOP  ,                                                00090300
.*-------------------------------------------------------------------   00090400
.***AG.KMEKY15 VALUE, RQD INPUT, ME KEYS -END                           00090500
.ZG12ZY          ANOP ,            END MUTUALLY EXCLUSIVE KEYS          00090600
.*----------------------------------------------------------------***   00090700
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00090800
                 AIF   (N'&LINKAGE LE 1).ZG14A  CK NUM                  00090900
&ZMS             SETC  '"LINKAGE='                                      00091000
&ZMS             SETC  '&ZMS.&LINKAGE"'                                 00091100
&ZMS             SETC  '&ZMS "LINKAGE"'                                 00091200
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00091300
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00091400
.ZG14A           ANOP  ,                                                00091500
.*-------------------------------------------------------------------   00091600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00091700
&XLINKAGE        SETC  ''          INITIALIZE XVARIABLE                 00091800
.ZG15A   AIF   ('&LINKAGE(1)' NE 'BRANCH').ZG16A                        00091900
&XLINKAGE        SETC  'BRANCH'    SET KEYWORD                          00092000
.*-------------------------------------------------------------------   00092100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00092200
.ZG16A           AIF   (K'&XLINKAGE GT 0).ZG16C  KEYWORD                00092300
                 AIF   (K'&LINKAGE(1) LE 0).ZG16B                       00092400
&ZMS             SETC  '"LINKAGE='                                      00092500
&ZMS             SETC  '&ZMS.&LINKAGE"'                                 00092600
&ZMS             SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '        00092700
&ZMS             SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'              00092800
&ZMS             SETC  '&ZMS "BRANCH".'                                 00092900
                 MNOTE 8,' &ZMS '                                       00093000
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00093100
.ZG16B           ANOP  ,                                                00093200
&XLINKAGE        SETC  'BRANCH'    SET DEFAULT KEYWORD                  00093300
.ZG16C           ANOP  ,                                                00093400
&ZXLINKAGE       SETC  'INPUT'     SET IN/OUTPUT                        00093500
.*----------------------------------------------------------------***   00093600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00093700
                 AIF   (N'&RETCODE LE 1).ZG18A  CK NUM                  00093800
&ZMS             SETC  '"RETCODE='                                      00093900
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00094000
&ZMS             SETC  '&ZMS "RETCODE"'                                 00094100
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00094200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00094300
.ZG18A           ANOP  ,                                                00094400
.*-------------------------------------------------------------------   00094500
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00094600
                 AIF   (K'&RETCODE(1) LE 0).ZG18C  NO PARM              00094700
&ZXRETCODE       SETC  'OUTPUT'    SET OUTPUT                           00094800
&XRETCODE        SETC  '&RETCODE(1)'            SET XVARIABLE           00094900
                 AIF   (N'&RETCODE GT 1).ZG18C                          00095000
&XRETCODE        SETC  '&RETCODE'  SET XVARIABLE                        00095100
.ZG18C           ANOP  ,                                                00095200
.*-------------------------------------------------------------------   00095300
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00095400
                 AIF   (K'&ZXRETCODE LE 0).ZG18R  NOT I/O               00095500
                 AIF   ('&XRETCODE'(1,1) NE '(').ZG18R                  00095600
&ZCGPR           SETC  '&XRETCODE'(2,K'&XRETCODE-2)                     00095700
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                     00095800
                 AIF   (K'&ZCGPR GT 2).ZG18Q                            00095900
                 AIF   ('&ZCGPR' EQ '0').ZG18Q                          00096000
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00096100
                 AIF   (T'&ZCGPR NE 'N').ZG18Q  INVALID REG NAME        00096200
.ZG18P           ANOP  ,                                                00096300
                 AIF   (T'&ZCGPR NE 'N').ZG18R  NON NUMERIC             00096400
                 AIF   ('&ZCGPR' EQ '15').ZG18R                         00096500
                 AIF   ('&ZCGPR' LT '2').ZG18Q                          00096600
                 AIF   ('&ZCGPR' LE '12').ZG18R                         00096700
.ZG18Q           ANOP  ,                                                00096800
&ZMS             SETC  '"RETCODE='                                      00096900
&ZMS             SETC  '&ZMS.&RETCODE"'                                 00097000
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00097100
                 MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'         00097200
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00097300
.ZG18R           ANOP  ,                                                00097400
.*----------------------------------------------------------------***   00097500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00097600
                 AIF   (N'&RSNCODE LE 1).ZG21A  CK NUM                  00097700
&ZMS             SETC  '"RSNCODE='                                      00097800
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00097900
&ZMS             SETC  '&ZMS "RSNCODE"'                                 00098000
                 MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'              00098100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00098200
.ZG21A           ANOP  ,                                                00098300
.*-------------------------------------------------------------------   00098400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00098500
                 AIF   (K'&RSNCODE(1) LE 0).ZG21C  NO PARM              00098600
&ZXRSNCODE       SETC  'OUTPUT'    SET OUTPUT                           00098700
&XRSNCODE        SETC  '&RSNCODE(1)'            SET XVARIABLE           00098800
                 AIF   (N'&RSNCODE GT 1).ZG21C                          00098900
&XRSNCODE        SETC  '&RSNCODE'  SET XVARIABLE                        00099000
.ZG21C           ANOP  ,                                                00099100
.*-------------------------------------------------------------------   00099200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00099300
                 AIF   (K'&ZXRSNCODE LE 0).ZG21R  NOT I/O               00099400
                 AIF   ('&XRSNCODE'(1,1) NE '(').ZG21R                  00099500
&ZCGPR           SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                     00099600
                 AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                     00099700
                 AIF   (K'&ZCGPR GT 2).ZG21Q                            00099800
                 AIF   ('&ZCGPR' EQ '0').ZG21R                          00099900
&ZCGPR           SETC  '&ZCGPR'(2,1)                                    00100000
                 AIF   (T'&ZCGPR NE 'N').ZG21Q  INVALID REG NAME        00100100
.ZG21P           ANOP  ,                                                00100200
                 AIF   (T'&ZCGPR NE 'N').ZG21R  NON NUMERIC             00100300
                 AIF   ('&ZCGPR' EQ '0').ZG21R                          00100400
                 AIF   ('&ZCGPR' LT '2').ZG21Q                          00100500
                 AIF   ('&ZCGPR' LE '12').ZG21R                         00100600
.ZG21Q           ANOP  ,                                                00100700
&ZMS             SETC  '"RSNCODE='                                      00100800
&ZMS             SETC  '&ZMS.&RSNCODE"'                                 00100900
&ZMS             SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'        00101000
                 MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'          00101100
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00101200
.ZG21R           ANOP  ,                                                00101300
.******************************************************************     00101400
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00101500
.******************************************************************     00101600
                 ACTR  10000                                            00101700
.*-------------------------------------------------------------------   00101800
.***AH.P03 EXTRA POSITIONALS AMONG NON-X KEYS                           00101900
&ZCVAL           SETC  ''          ERROR FIELD                          00102000
&ZAWRK           SETA  0           POSITIONAL COUNTER                   00102100
&ZASYSLNDX       SETA  0           NON-X KEY COUNTER                    00102200
.ZGLIST2         ANOP  ,                                                00102300
&ZASYSLNDX       SETA  &ZASYSLNDX+1             NEXT NON-X KEY          00102400
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZGLIST3  DONE                 00102500
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZGLIST2          00102600
&ZAWRK           SETA  &ZAWRK+1    NEXT POSITIONAL                      00102700
                 AIF   (&ZAWRK LE 0).ZGLIST2                            00102800
&ZCVAL           SETC '&ZCVAL,&SYSLIST(&ZASYSLNDX)'  EXTRA              00102900
                 AGO   .ZGLIST2                                         00103000
.*                                                                      00103100
.ZGLIST3  AIF  (K'&ZCVAL LE 0).ZGLISTX                                  00103200
&ZCVAL           SETC '&ZCVAL'(2,K'&ZCVAL-1)    STRIP COMMA             00103300
&ZMS             SETC  'POSITIONAL ARGUMENT(S),'                        00103400
&ZMS             SETC  '&ZMS "&ZCVAL"'                                  00103500
&ZMS             SETC  '&ZMS CANNOT BE USED.'                           00103600
&ZMS             SETC  '&ZMS NO POSITIONAL ARGUMENTS'                   00103700
                 MNOTE 8,' &ZMS ARE ALLOWED.'                           00103800
&ZMACRET         SETA  8           SET MACRO ERROR RETURN CODE          00103900
.ZGLISTX         ANOP  ,                                                00104000
&ZASYSLNDX       SETA  0                                                00104100
.*-------------------------------------------------------------------   00104200
.***AG.MF04 MF=(SLE)                                                    00104300
.ZGMFX           ANOP  ,           END OF FULL SYNTAX CHECK             00104400
.*******************************************************************    00104500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00104600
.*******************************************************************    00104700
                 AIF   (&ZMACRET NE 0).ZLX2     ERROR DETECTED          00104800
.*******************************************************************    00104900
.***AE.01  START OF IQPINFO MACRO CODE                                  00105000
.*******************************************************************    00105100
                 LCLC  &M0M0001                 NAME                    00105200
&M0M0001         SETC  '&XLABEL'                SET NAME                00105300
                 AIF   (K'&XLABEL NE 0).XLAB2                           00105400
&M0M0001         SETC  'M00M&SYSNDX'            DEFAULT NAME            00105500
.*                                                                      00105600
.XLAB2           ANOP  ,                                                00105700
                 AIF   ('&XMF' EQ 'L').XLAB3                            00105800
&M0M0001 DS    0H                             IQPINFO-1                 00105900
.XLAB3           ANOP  ,                                                00106000
.*******************************************************************    00106100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00106200
.*******************************************************************    00106300
              PUSH  PRINT                                               00106400
                 AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON       00106500
                 PRINT OFF         ++ PR01                              00106600
                 AGO   .ZPRNTXX                                         00106700
.ZPRINTX         PRINT ON                                               00106800
.ZPRNTXX         ANOP  ,                                                00106900
.********************************************************************   00107000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00107100
.********************************************************************   00107200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00107300
                      LCLA  &ZOPN1         INVOCATION INDEX             00107400
                      LCLC  &ZOPL(4095)    LABEL                        00107500
                      LCLC  &ZOPO(4095)    OPERATION                    00107600
                      LCLC  &ZOPV(4095)    VALUE                        00107700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00107800
.*                                                                      00107900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00108000
.******************************************************************     00108100
.***AL.L10 IQPINFO FMT=LIST MF=S!L PARAMETERS                           00108200
.******************************************************************     00108300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00108400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00108500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00108600
&XMFATTR              SETC  '0D'                                        00108700
.*                                                                      00108800
&ZOPN                 SETA  &ZOPN+1                                     00108900
&ZOPL(&ZOPN)          SETC  ' '                                         00109000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00109100
&ZOPO(&ZOPN)          SETC  'B'                                         00109200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00109300
                      AGO   .ZALVL6B                                    00109400
.ZALVL6A              ANOP                                              00109500
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00109600
&ZOPV(&ZOPN)          SETC  '4,8'                                       00109700
&ZOPN                 SETA  &ZOPN+1                                     00109800
&ZOPL(&ZOPN)          SETC  ' '                                         00109900
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00110000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00110100
.ZALVL6B              ANOP                                              00110200
&ZOPD(&ZOPN)          SETC  '++ IQPINFO ARG PARMS'                      00110300
.*                                                                      00110400
&ZOPN                 SETA  &ZOPN+1                                     00110500
&ZOPL(&ZOPN)          SETC  ' '                                         00110600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00110700
&ZOPV(&ZOPN)          SETC  '1'                                         00110800
&ZOPD(&ZOPN)          SETC  ' '                                         00110900
.*                                                                      00111000
.ZLMFSL2              ANOP  ,                                           00111100
.*-------------------------------------------------------------------   00111200
.***AM.L00  IQPINFO FMT=LIST name                                       00111300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00111400
&ZOPN                 SETA &ZOPN+1                                      00111500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00111600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00111700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00111800
&ZOPD(&ZOPN)          SETC '++ IQPINFO NAME'                            00111900
.ZLMFSL2M             ANOP  ,                                           00112000
.*-------------------------------------------------------------------   00112100
.***AM.L01  IQPINFO FMT=LIST PARAMETERS                                 00112200
&ZOPN                 SETA &ZOPN+1                                      00112300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00112400
&ZOPO(&ZOPN)          SETC 'DS'                                         00112500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00112600
&ZOPD(&ZOPN)          SETC '++ IQPINFO PARM LIST'                       00112700
.*-------------------------------------------------------------------   00112800
.***AM.L02 XVERSION XL1                                                 00112900
&ZOPN                 SETA &ZOPN+1                                      00113000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00113100
&ZOPO(&ZOPN)          SETC 'DS'                                         00113200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00113300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00113400
.*-------------------------------------------------------------------   00113500
.***AM.L03 XFLAGS BL.08                                                 00113600
&ZOPN                 SETA &ZOPN+1                                      00113700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00113800
&ZOPO(&ZOPN)          SETC 'DS'                                         00113900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00114000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00114100
.*                                                                      00114200
&ZOPN                 SETA  &ZOPN+1                                     00114300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_PERFDATA'                00114400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00114500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00114600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00114700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PERFDATA'                     00114800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00114900
.*-------------------------------------------------------------------   00115000
.***AM.L09  XRESERVED1 CL02                                             00115100
&ZOPN                 SETA &ZOPN+1                                      00115200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00115300
&ZOPO(&ZOPN)          SETC 'DS'                                         00115400
&ZOPV(&ZOPN)          SETC 'CL02'                                       00115500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00115600
.*-------------------------------------------------------------------   00115700
.***AM.L09 ADDR XFCNINDEX A                                             00115800
&ZOPN                 SETA &ZOPN+1                                      00115900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFCNINDEX_ADDR'                   00116000
&ZOPO(&ZOPN)          SETC 'DS'                                         00116100
&ZOPV(&ZOPN)          SETC 'A'                                          00116200
&ZOPD(&ZOPN)          SETC '++ &ZXFCNINDEX ADDR'                        00116300
.*-------------------------------------------------------------------   00116400
.***AM.L09 ADDR XPERFDATAPTR A                                          00116500
&ZOPN                 SETA &ZOPN+1                                      00116600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPERFDATAPTR_ADDR'                00116700
&ZOPO(&ZOPN)          SETC 'DS'                                         00116800
&ZOPV(&ZOPN)          SETC 'A'                                          00116900
&ZOPD(&ZOPN)          SETC '++ &ZXPERFDATAPTR ADDR'                     00117000
.*-------------------------------------------------------------------   00117100
.***AM.L09 ADDR XPERFDATALEN A                                          00117200
&ZOPN                 SETA &ZOPN+1                                      00117300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPERFDATALEN_ADDR'                00117400
&ZOPO(&ZOPN)          SETC 'DS'                                         00117500
&ZOPV(&ZOPN)          SETC 'A'                                          00117600
&ZOPD(&ZOPN)          SETC '++ &ZXPERFDATALEN ADDR'                     00117700
.*-------------------------------------------------------------------   00117800
.***AM.L10 END OF IQPINFO LIST PARAMETERS                               00117900
&ZOPN                 SETA &ZOPN+1                                      00118000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00118100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00118200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00118300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00118400
.*                                                                      00118500
&ZOPN                 SETA &ZOPN+1                                      00118600
&ZOPL(&ZOPN)          SETC ' '                                          00118700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00118800
&ZOPV(&ZOPN)          SETC '1'                                          00118900
&ZOPD(&ZOPN)          SETC ' '                                          00119000
.*-------------------------------------------------------------------   00119100
.***AL.L12 IQPINFO FMT=LIST MF=S!L PARAMETERS                           00119200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00119300
.*                                                                      00119400
&ZOPN                 SETA  &ZOPN+1                                     00119500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00119600
&ZOPO(&ZOPN)          SETC  'DC'                                        00119700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00119800
&ZOPD(&ZOPN)          SETC  '++ IQPINFO ARG PARMS'                      00119900
.*                                                                      00120000
.ZLMFSLX              ANOP  ,                                           00120100
.*-------------------------------------------------------------------   00120200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00120300
&ZPLLEN               SETA 16                                           00120400
.*                                                                      00120500
.******************************************************************     00120600
.***AI.L01 IQPINFO FMT=LIST FILL IN PARAMETER AREA                      00120700
.******************************************************************     00120800
                      ACTR  10000                                       00120900
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00121000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00121100
&ZCVAL                SETC  'LAE'          XAX MODE                     00121200
.ZIMFXA               ANOP ,                                            00121300
.*                                                                      00121400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00121500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00121600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00121700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00121800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00121900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00122000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00122100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00122200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00122300
&ZOPN                 SETA  &ZOPN+1                                     00122400
&ZOPL(&ZOPN)          SETC  ' '                                         00122500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00122600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00122700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00122800
                      AGO   .ZIMFNX                                     00122900
.*                                                                      00123000
.ZIMFN2               ANOP ,                                            00123100
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00123200
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00123300
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00123400
&ZOPN                 SETA  &ZOPN+1                                     00123500
&ZOPL(&ZOPN)          SETC  ' '                                         00123600
&ZOPO(&ZOPN)          SETC  'LAE'                                       00123700
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00123800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00123900
                      AGO   .ZIMFNX                                     00124000
.ZIMFNX1              ANOP ,                                            00124100
&ZOPN                 SETA  &ZOPN+1                                     00124200
&ZOPL(&ZOPN)          SETC  ' '                                         00124300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00124400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00124500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00124600
.ZIMFNX               ANOP ,                                            00124700
.********************************************************************   00124800
.***AI.L02 IQPINFO FMT=LIST INITIALIZE PARAMETER AREA                   00124900
.********************************************************************   00125000
.***AI.L03 MF=(SLE)                                                     00125100
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00125200
.*                                                                      00125300
&ZOPN                 SETA  &ZOPN+1                                     00125400
&ZOPL(&ZOPN)          SETC  ' '                                         00125500
&ZOPO(&ZOPN)          SETC  'XC'                                        00125600
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00125700
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00125800
.ZIMFLX               ANOP  ,                                           00125900
.*-------------------------------------------------------------------   00126000
.***AI.L04A XVERSION XL1                                                00126100
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00126200
&ZOPN                 SETA  &ZOPN+1                                     00126300
&ZOPL(&ZOPN)          SETC  ' '                                         00126400
&ZOPO(&ZOPN)          SETC  'MVI'                                       00126500
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00126600
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00126700
.ZIMFVW               ANOP  ,                                           00126800
.*-------------------------------------------------------------------   00126900
.***AI.L05 XFLAGS BL1                                                   00127000
&ZW                   SETC  ''                                          00127100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00127200
.*-------------------------------------------------------------------   00127300
.***AI.L08 XFLAGS "PERFDATA"                                            00127400
.***      BL1'1XXXXXXX'                                                 00127500
         AIF   ('&XPERFDATA' EQ '').ZI3A                                00127600
&ZW                   SETC  '&ZW.10000000'                              00127700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00127800
                      AGO   .ZI3C                                       00127900
.*                                                                      00128000
.ZI3A                 ANOP  ,                                           00128100
&ZW                   SETC  '&ZW.00000000'                              00128200
.ZI3C                 ANOP  ,                                           00128300
.*-------------------------------------------------------------------   00128400
.***AI.L11 XFLAGS BL1                                                   00128500
                      AIF   ('&ZCLNG' NE 'YES').ZI3E  ALL ZERO BITS     00128600
&ZOPN                 SETA  &ZOPN+1                                     00128700
&ZOPL(&ZOPN)          SETC  ' '                                         00128800
&ZOPO(&ZOPN)          SETC  'OI'                                        00128900
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00129000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00129100
.ZI3E                 ANOP  ,                                           00129200
.*-------------------------------------------------------------------   00129300
.***AI.L19 ADDR XFCNINDEX A                                             00129400
                      AIF   ('&ZXFCNINDEX' EQ '').ZI5H                  00129500
&ZCLNG                SETC  '&XFCNINDEX'                                00129600
&ZCGPR                SETC  '14'                                        00129700
         AIF   ('&XFCNINDEX'(1,1) EQ '(').ZI5F  IN GPR                  00129800
.*                                                                      00129900
&ZOPN                 SETA  &ZOPN+1                                     00130000
&ZOPL(&ZOPN)          SETC  ' '                                         00130100
&ZOPO(&ZOPN)          SETC  'LA'                                        00130200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00130300
&ZOPD(&ZOPN)          SETC  '++ &ZXFCNINDEX XFCNINDEX'                  00130400
.*                                                                      00130500
                      AGO   .ZI5G                                       00130600
.*                                                                      00130700
.ZI5F                 ANOP  ,                                           00130800
&ZCGPR   SETC  '&XFCNINDEX'(2,K'&XFCNINDEX-2)                           00130900
.*                                                                      00131000
.ZI5G                 ANOP  ,                                           00131100
.*                                                                      00131200
&ZOPN                 SETA  &ZOPN+1                                     00131300
&ZOPL(&ZOPN)          SETC  ' '                                         00131400
&ZOPO(&ZOPN)          SETC  'ST'                                        00131500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              00131600
&ZOPD(&ZOPN)          SETC  '++ &ZXFCNINDEX XFCNINDEX'                  00131700
.*                                                                      00131800
.ZI5H                 ANOP  ,                                           00131900
.*-------------------------------------------------------------------   00132000
.***AI.L19 ADDR XPERFDATAPTR A                                          00132100
                      AIF   ('&ZXPERFDATAPTR' EQ '').ZI6H               00132200
&ZCLNG                SETC  '&XPERFDATAPTR'                             00132300
&ZCGPR                SETC  '14'                                        00132400
         AIF   ('&XPERFDATAPTR'(1,1) EQ '(').ZI6F  IN GPR               00132500
.*                                                                      00132600
&ZOPN                 SETA  &ZOPN+1                                     00132700
&ZOPL(&ZOPN)          SETC  ' '                                         00132800
&ZOPO(&ZOPN)          SETC  'LA'                                        00132900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00133000
&ZOPD(&ZOPN)          SETC  '++ &ZXPERFDATAPTR XPERFDATAPTR'            00133100
.*                                                                      00133200
                      AGO   .ZI6G                                       00133300
.*                                                                      00133400
.ZI6F                 ANOP  ,                                           00133500
&ZCGPR   SETC  '&XPERFDATAPTR'(2,K'&XPERFDATAPTR-2)                     00133600
.*                                                                      00133700
.ZI6G                 ANOP  ,                                           00133800
.*                                                                      00133900
&ZOPN                 SETA  &ZOPN+1                                     00134000
&ZOPL(&ZOPN)          SETC  ' '                                         00134100
&ZOPO(&ZOPN)          SETC  'ST'                                        00134200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00134300
&ZOPD(&ZOPN)          SETC  '++ &ZXPERFDATAPTR XPERFDATAPTR'            00134400
.*                                                                      00134500
.ZI6H                 ANOP  ,                                           00134600
.*-------------------------------------------------------------------   00134700
.***AI.L19 ADDR XPERFDATALEN A                                          00134800
                      AIF   ('&ZXPERFDATALEN' EQ '').ZI7H               00134900
&ZCLNG                SETC  '&XPERFDATALEN'                             00135000
&ZCGPR                SETC  '14'                                        00135100
         AIF   ('&XPERFDATALEN'(1,1) EQ '(').ZI7F  IN GPR               00135200
.*                                                                      00135300
&ZOPN                 SETA  &ZOPN+1                                     00135400
&ZOPL(&ZOPN)          SETC  ' '                                         00135500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00135600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00135700
&ZOPD(&ZOPN)          SETC  '++ &ZXPERFDATALEN XPERFDATALEN'            00135800
.*                                                                      00135900
                      AGO   .ZI7G                                       00136000
.*                                                                      00136100
.ZI7F                 ANOP  ,                                           00136200
&ZCGPR   SETC  '&XPERFDATALEN'(2,K'&XPERFDATALEN-2)                     00136300
.*                                                                      00136400
.ZI7G                 ANOP  ,                                           00136500
.*                                                                      00136600
&ZOPN                 SETA  &ZOPN+1                                     00136700
&ZOPL(&ZOPN)          SETC  ' '                                         00136800
&ZOPO(&ZOPN)          SETC  'ST'                                        00136900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00137000
&ZOPD(&ZOPN)          SETC  '++ &ZXPERFDATALEN XPERFDATALEN'            00137100
.*                                                                      00137200
.ZI7H                 ANOP  ,                                           00137300
.*-------------------------------------------------------------------   00137400
&ZOPN1                SETA &ZOPN                                        00137500
.*******************************************************************    00137600
.***  PROCESS IQPINFO OUTPUT PARAMETERS                                 00137700
.*******************************************************************    00137800
                      ACTR  10000                                       00137900
.*******************************************************************    00138000
.***AO.X02  RETURN CODE PROCESSING                                      00138100
.*******************************************************************    00138200
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00138300
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00138400
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00138500
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00138600
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00138700
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00138800
&ZOPN                 SETA  &ZOPN+1                                     00138900
&ZOPL(&ZOPN)          SETC  ' '                                         00139000
&ZOPO(&ZOPN)          SETC  'ST'                                        00139100
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00139200
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00139300
                      AGO   .ZMRETX                                     00139400
.*                                                                      00139500
.ZMRET2               ANOP  ,                                           00139600
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00139700
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00139800
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00139900
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00140000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00140100
&ZOPN                 SETA  &ZOPN+1                                     00140200
&ZOPL(&ZOPN)          SETC  ' '                                         00140300
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00140400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00140500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00140600
.ZMRETX               ANOP  ,                                           00140700
.*******************************************************************    00140800
.***AO.X03  REASON CODE PROCESSING                                      00140900
.*******************************************************************    00141000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00141100
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00141200
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00141300
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00141400
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00141500
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00141600
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00141700
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00141800
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00141900
&ZOPN                 SETA  &ZOPN+1                                     00142000
&ZOPL(&ZOPN)          SETC  ' '                                         00142100
&ZOPO(&ZOPN)          SETC  'ST'                                        00142200
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00142300
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00142400
                      AGO   .ZMRSNX                                     00142500
.*                                                                      00142600
.ZMRSN2               ANOP  ,                                           00142700
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00142800
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00142900
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00143000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00143100
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00143200
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00143300
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00143400
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00143500
&ZOPN                 SETA  &ZOPN+1                                     00143600
&ZOPL(&ZOPN)          SETC  ' '                                         00143700
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00143800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00143900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00144000
.ZMRSNX               ANOP  ,                                           00144100
.*******************************************************************    00144200
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00144300
.*******************************************************************    00144400
.ZMFLX                ANOP  ,              MF=L PROCESSING              00144500
.*******************************************************************    00144600
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00144700
.*******************************************************************    00144800
                      ACTR  10000                                       00144900
.*                                                                      00145000
                      LCLA  &ZLC           COLUMN POSITION              00145100
                      LCLA  &ZOPX          LIST TABLE INDEX             00145200
                      LCLC  &ZLL           LABEL                        00145300
                      LCLC  &ZLOP          OPERATION                    00145400
                      LCLC  &ZLV           VALUE                        00145500
                      LCLC  &ZLD           DESCRIPTION                  00145600
.*                                                                      00145700
&ZOPX                 SETA  1                                           00145800
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00145900
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00146000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00146100
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00146200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00146300
                      AIF   (K'&ZLD LE 0).ZL5                           00146400
&ZLC                  SETA  35             COMMENT COLUMN               00146500
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00146600
&ZLC                  SETA  33             COMMMENT COLUMN              00146700
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00146800
&ZLV                  SETC  '&ZLV'.' '                                  00146900
                      AGO   .ZL3                                        00147000
.*                                                                      00147100
.ZL4                  ANOP  ,                                           00147200
&ZLV                  SETC  '&ZLV'.' '                                  00147300
.ZL5                  ANOP  ,                                           00147400
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00147500
.*                                                                      00147600
&ZLL     &ZLOP &ZLV                                                     00147700
.*                                                                      00147800
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00147900
                      AGO   .ZL2           CONTINUE LOOPING             00148000
.*                                                                      00148100
.ZLX                  ANOP  ,                                           00148200
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00148300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00148400
.*-----------BAL invocation code-------------                           00148500
.LNKFC1  LA    0,1                ++ SET IQPINFO FUNCTION CODE          00148600
.*********************************************************************  00148700
.*                                                                   *  00148800
.*  Get addressability to CVT                                        *  00148900
.*                                                                   *  00149000
.*********************************************************************  00149100
         LLGT  15,16(0,0)                                               00149200
.*********************************************************************  00149300
.*                                                                   *  00149400
.*  Get addressability to ECVT                                       *  00149500
.*                                                                   *  00149600
.*********************************************************************  00149700
         L     15,140(15,0)                                             00149800
.*********************************************************************  00149900
.*                                                                   *  00150000
.*  Get addressability to CRIT                                       *  00150100
.*                                                                   *  00150200
.*********************************************************************  00150300
         L     15,716(15,0)                                             00150400
         LTR   15,15              ++ Test if PCIE facility active       00150500
         JZ    INFO_ERR&SYSNDX                                          00150600
         L     15,24(15,0)        ++ SET ADDR OF IQPINFO SERVICE        00150700
         LTR   15,15                                                    00150800
         JNZ   INFO_BR&SYSNDX                                           00150900
INFO_ERR&SYSNDX DS 0H                                                   00151000
         LA    R15,32(0,0)        ++ Service not available              00151100
         J     INFO_RET&SYSNDX                                          00151200
INFO_BR&SYSNDX  DS 0H                                                   00151300
         BASR  14,15              ++ BRANCH TO IQPINFO SERVICE          00151400
INFO_RET&SYSNDX DS 0H                                                   00151500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00151600
.ZLINKX               ANOP  ,                                           00151700
.*******************************************************************    00151800
.***AP.X01  FORMAT GENERATED CODE                                       00151900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00152000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00152100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00152200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00152300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00152400
                      AIF   (K'&ZLD LE 0).ZL51                          00152500
&ZLC                  SETA  35             COMMENT COLUMN               00152600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00152700
&ZLC                  SETA  33             COMMENT COLUMN               00152800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00152900
&ZLV                  SETC  '&ZLV'.' '                                  00153000
                      AGO   .ZL31                                       00153100
.*                                                                      00153200
.ZL41                 ANOP  ,                                           00153300
&ZLV                  SETC  '&ZLV'.' '                                  00153400
.ZL51                 ANOP  ,                                           00153500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00153600
.*                                                                      00153700
&ZLL     &ZLOP &ZLV                                                     00153800
.*                                                                      00153900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00154000
                      AGO   .ZL21          CONTINUE LOOPING             00154100
.*                                                                      00154200
.ZLX1                 ANOP  ,                                           00154300
.*******************************************************************    00154400
.***AP.X02  END OF IQPINFO MACRO                                        00154500
&ZIQPINFO             SETC  'YES'          SET IQPINFO USED             00154600
         POP   PRINT                                                    00154700
*                                            IQPINFO-1                  00154800
         SPACE 1                                                        00154900
.ZLX2                 ANOP  ,                                           00155000
         MEND                                                           00155100
**********************************************************************/ 00155200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00155300
*%IQPINFO: MACRO KEYS(PERFDATA,FCNINDEX,PERFDATAPTR,PERFDATALEN,        00155400
*                 LINKAGE,RETCODE,RSNCODE,PLISTVER,MF);                 00155500
*  ANS('?'!!MACLABEL!!' '!!'IQPINFOP '!!MACLIST!!                       00155600
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00155700
*%END IQPINFO;                                                          00155800

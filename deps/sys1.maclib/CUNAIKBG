         MACRO                                                                  
&NAME    CUNAIKBG &CCSID=,&ES=,            FOR ALL CCSIDS              *        
               &STRINGT=,&CP=,             FOR BIDI                    *        
               &SUFFIX=,&CCDEF=,           FOR SIMPLE CCSIDS           *        
               &ACRI=,&SUBIDS=,            FOR MIXED CCSIDS      @F3C  *        
               &DESC=                      FOR CCSID DESCRIPTION @F3A           
.*********************************************************************          
.*                                                                   *          
.* LICENSED MATERIALS - PROPERTY OF IBM                              *          
.*                                                                   *          
.* 5650-ZOS                                                          *          
.*                                                                   *          
.* COPYRIGHT IBM CORP.  2000, 2019                               @T1C*          
.*                                                                   *          
.* STATUS = HUN77B0                                              @T1C*          
.*                                                                   *          
.*********************************************************************          
.*                                                                   *          
.* THIS IS THE KNOWLEDGE BASE MACRO.                                 *          
.*                                                                   *          
.* THE OUTPUT FROM EACH INVOCATION IS A KNOWLEDGE BASE ENTRY.        *          
.*                                                                   *          
.* ALL KNOWLEDGE BASE ENTRIES GO INTO A NON-EXECUTABLE LOAD MODULE.  *          
.* (SEE SAMPLE USERMOD, CUNSUSKB)                                    *          
.*                                                                   *          
.* SAMPLE INVOCATIONS:                                               *          
.*                                                                   *          
.*       CUNAIKBG CCSID=57344,ES=1100,SUFFIX=AA,CCDEF=(1,1,1,1,1,1)  *          
.*       CUNAIKBG CCSID=57345,ES=1200,SUFFIX=BB,CCDEF=(2,2,2,2,2,2)  *          
.*       CUNAIKBG CCSID=57346,ES=1301,SUBIDS=(57344,57345)           *          
.*                                                               @F3A*          
.* From B35800 and higer a new "optional" keyword is added,      @F3A*          
.* making invovalions as follow:                                 @F3A*          
.*                                                               @F3A*          
.* CUNAIKBG CCSID=00037,ES=1100,STRINGT=1,CP=00037,SUFFIX='XRF', @F3A*          
.*       CCDEF=(1,1,1,1,1,1),                                    @F3A*          
.*       DESC='USA, CANADA,  BRAZIL, and  COMMON EUROPE'         @F3A*          
.* CUNAIKBG CCSID=00256,ES=1100,STRINGT=1,CP=00256,SUFFIX='XRF', @F3A*          
.*       CCDEF=(1,1,1,1,1,1)                                     @F3A*          
.*       DESC='NETHERLAND'                                       @F3A*          
.* CUNAIKBG CCSID=00259,ES=1100,STRINGT=1,CP=00259,SUFFIX='XRF', @F3A*          
.*       CCDEF=(1,1,1,1,1,1),                                    @F3A*          
.*       DESC='SYMBOLS SET 7'                                    @F3A*          
.* CUNAIKBG CCSID=00273,ES=1100,STRINGT=1,CP=00273,SUFFIX='XRF', @F3A*          
.*      CCDEF=(1,1,1,1,1,1)                                      @F3A*          
.*      (does not include DESC keyword)                          @F3A*          
.*                                                               @F3A*          
.*Important. New keyword DESC is option to do not affect         @F3A*          
.*           current customers, however, official z/OS           @F3A*          
.*           releases must generate cunmikbs making DESC         @F3A*          
.*           as mandatory parameter into CUNRIKBT rexx tool      @F3A*          
.*                                                                   *          
.* CHANGE HISTORY:                                                   *          
.* 25/05/2000 INITIAL                                                *          
.* $D1=GB18030 HUNI2A0 010604 PDM: GB18030 Ph-1 Integration,      D1A*          
.*                                 allow new Encoding Schemes &   D1A*          
.*                                 definition of SUB for 4 byte   D1A*          
.*                                 part                           D1A*          
.* $F1=MG00317 HUN7707 011119 PDM: Change enconding scheme 8200   F1A*          
.*                                 to 9200                        F1A*          
.* $D2=MG01568 HUN7708 030120 PDM: Add new CCDefs                 D2A*          
.*                                                                   *          
.* $L1=MG04420 HUN7720 040730 CSJ: Add new information of CDRA    D3A*          
.* $F2=B144.00 HUN7740 060425  JR: PROVIDE SUPPORT FOR CCSID 1202 F2A*          
.* $D3=B138.00 HUN7740 061107 HFM: Correct ACRI_TCP field            *          
.* $F3=B35800  HUN7750 070507 LMM: IOI - API to Provide Details      *          
.*                                 for Conversion Tables             *          
.* $F4=B35900  HUN7750 070701 LMM: HQN - Extended Translation        *          
.*                                 Facility 3                        *          
.* $T1=LI2265  HUN7780 091231 TVC: store the codepage in the same    *          
.*                                 format as the ccsid           @T1A*          
.* $C1=B902.00 HUN7780 100127 CJB: PROVIDE SUPPORT FOR CCSID 1210 C1A*          
.* $C2=OA56512 HUN77B0 190131 DJG: PROVIDE SUPPORT FOR CCSID 28792C2A*          
.*                                                                   *          
.*********************************************************************          
         GBLB  &DSECT                                                           
         LCLC  &LAB                                                             
         LCLA  &T,&COUNT                                                        
         LCLC  &X,&VERSION                                                      
         LCLA  &NCP                                                             
         LCLC  &AT          ACRI TYPE                                           
         LCLA  &AI          ACRI INDEX                                          
         LCLA  &I           A COUNTER                                           
         LCLC  &C           A CHARACTER                                         
&VERSION SETC  '2'          AFTER B35800 KB VERSION IS 2                        
&X       SETC  '&SYSNDX'                                                        
         SPACE                                                                  
.**********************************************************************         
.* SPACE CHARACTER DEFINITIONS. LAYOUT IS:                            *         
.*                                                                    *         
.* SSNNWWWWCCCCCCCC                                                   *         
.* '-!-!---!---------- STATE                                          *         
.*   '-!---!---------- NUMBER OF SPACE CHARACTERS                     *         
.*     '---!---------- WIDTH                                          *         
.*         '---------- SOAC CHARACTE                                  *         
.*                     FOR UCS-2 THE FOUR BYTES OF CCCCCCCC ARE       *         
.*                     DIVIDED IN TWO HALFS:                          *         
.*                     SSSSDDDD                                       *         
.*                     '---!-------- FOR SINGLE WIDE SPACE            *         
.*                         '-------- FOR DOUBLE WIDE SPACE            *         
.*                                                                    *         
.*                      Note. For UTF-32, the real length for    @F4A *         
.*                            space characters is 4-bytes, even  @F4A *         
.*                            appears only as 00020 and 3000.    @F4A *         
.*                            When they're used the padding to   @F4A *         
.*                            00000020 and 00003000 will be      @F4A *         
.*                            done automatically to be four      @F4A *         
.*                            bytes.                             @F4A *         
.*                                                                    *         
.* NOTE THAT THE SPACE CHARACTER IS RIGHT ALIGNED WITHIN CCCCCCCC     *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.**********************************************************************         
&SPACE(1) SETC '0101000100000040',   1  HOST SINGLE EBCDIC             *        
               '0101000200004040',   2  HOST DOUBLE EBCDIC             *        
               '0201000200004040',   3  HOST DB MIX EBCDIC             *        
               '0101000100000020',   4  PC SINGLE                      *        
               '0101000200008140',   5  PC DOUBLE                      *        
               '0201000200008140',   6  PC DB MIX                      *        
               '010100020000A1A1',   7  PC DOUBLE - IBM KS CODE        *        
               '020100020000A1A1',   8  PC DB MIX - IBM KS CODE        *        
               '0301000100000020',   9  EUC/TCP SINGLE                 *        
               '040100020000A1A1',  10  EUC DB                         *        
               '0101000200002121',  11  ISO2022 AND EUC                *        
               '0201000200002121',  12  ISO2022 AND EUC                *        
               '0401000200002121',  13  ISO2022                        *        
               '010100020000A140',  14  T-CH BIG 5                     *        
               '020100020000A140',  15  T-CH BIG 5                     *        
               '0102000200203000',  16  UCS-2                      @F2C*        
               '0102000220000030',  17  LITTLE ENDIAN              @F4C*        
               '0102000400203000',  18  UTF-32 BE                  @F4A*        
               '0000000000000000',  19  Dummy Entry                @F4A*        
               '0101000100000020',  20  UTF-32                     @F4A*        
               '0101000100000040'   21  UTF-EBCDIC                 @C1A         
                                                                                
.**********************************************************************         
.* SUBSTITUTION CHARACTER DEFINITIONS. LAYOUT IS:                     *         
.*                                                                    *         
.* SSNNWWWWCCCCCCCC                                                   *         
.* '-!-!---!---------- STATE                                          *         
.*   '-!---!---------- NUMBER OF SUBSTITUTION CHARACTERS              *         
.*     '---!---------- WIDTH                                          *         
.*         '---------- SUBSTITUTION CHARACTER                         *         
.*                     FOR UCS-2 THE FOUR BYTES OF CCCCCCCC ARE       *         
.*                     DIVIDED IN TWO HALFS:                          *         
.*                     SSSSMMMM                                       *         
.*                     '---!-------- FOR CONVERSIONS FROM SBCS        *         
.*                         '-------- FOR CONVERSIONS FROM MBCS        *         
.*                                                                    *         
.*                      Note. For UTF-32, the real length for    @F4A *         
.*                            sub characters is 4-bytes, even    @F4A *         
.*                            appears only as 00020 and 3000.    @F4A *         
.*                            When they're used the padding to   @F4A *         
.*                            00000020 and 00003000 will be      @F4A *         
.*                            done automatically to be four      @F4A *         
.*                            bytes.                             @F4A *         
.*                                                                    *         
.* NOTE THAT THE SUBSTITUTION CHARACTER IS RIGHT ALIGNED WITHIN       *         
.* CCCCCCCC                                                           *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.**********************************************************************         
&SUBC(1) SETC  '010100010000003F',  1  HOST SINGLE EBCDIC              *        
               '010100020000FEFE',  2  HOST DOUBLE EBCDIC              *        
               '020100020000FEFE',  3  HOST DB MIX EBCDIC              *        
               '010100010000007F',  4  PC SINGLE                       *        
               '010100010000001A',  5  ISO SINGLE                      *        
               '010100020000FCFC',  6  PC DOUBLE                       *        
               '020100020000FCFC',  7  PC DB MIX                       *        
               '010100020000BFFC',  8  PC DOUBLE - KOREAN              *        
               '020100020000BFFC',  9  PC DB MIX - KOREAN              *        
               '01010002000041B8', 10  HOST DOUBLE EBCDIC - THAI       *        
               '01010002000081B8', 11  PC DOUBLE - THAI                *        
               '010100020000AFFE', 12  PC DOUBLE - IBM KS CODE         *        
               '020100020000AFFE', 13  PC DB MIX - IBM KS CODE         *        
               '010100020000747E', 14  ISO2022 AND EUC (JAPAN)         *        
               '020100020000747E', 15  ISO2022 (JAPAN)                 *        
               '040100020000747E', 16  ISO2022 (JAPAN)                 *        
               '01020002001AFFFD', 17  UCS-2                           *        
               '020100020000F4FE', 18  EUC (JAPAN)                     *        
               '040100020000F4FE', 19  EUC (JAPAN)                     *        
               '0201000200002F7E', 20  ISO2022 AND EUC (KOREA)         *        
               '0201000200007D7E', 21  ISO2022 AND EUC (CHINA)         *        
               '020100020000FDFE', 22  EUC G1 (T-CH)                   *        
               '01010003002D247E', 23  EUC G2 (T-CH)                   *        
               '010100020000C8FE', 24  PC DBCS BIG 5 (T-CH)            *        
               '020100020000C8FE', 25  PC DBCS BIG 5 (T-CH)            *        
               '010100020000FEFE', 26  PC DBCS BG (S-CH)               *        
               '020100020000FEFE', 27  PC DBCS BG (S-CH)               *        
               '010100020000727E', 28  ISO2022 (T-CH)                  *        
               '030100020000727E', 29  ISO2022 (T-CH)                  *        
               '030100010000001A', 30  ISO SINGLE                      *        
               '0101000200002121', 31  EUC G1 (S-CH)                   *        
               '020100020000A1A1', 32  EUC G2 (S-CH)                   *        
               '0201000200002121', 33  ISO2022 (S-CH)                  *        
               '010100020000A1A1', 34  PC DBCS GBK (S-CH)              *        
               '010100020000A1E0', 35  PC DBCS WINDOWS KOREAN          *        
               '020100020000A1E0', 36  PC DB MIX WINDOWS KOREAN        *        
               '010100020000FDFE', 37  EUC G1 (T-CH)                   *        
               '010100020000F4FE', 38  EUC  (JAPAN)                    *        
               '0101000200002F7E', 39  EUC  (KOREA)                    *        
               '010100048431A437', 40  STANDALONE GB18030 4 BYTE PT D1A*        
               '030100048431A437', 41  4BYTE PT OF COMBINED GB18030 D1A*        
               '020100020000EAA5', 42  DB of JISX0213 combined code D2A*        
               '010100020000EAA5', 43  Standalone DB of JISX0213    D2A*        
               '010100020000A3FE', 44  PC DBCS MS BIG-5 (T-Ch)      D2A*        
               '020100020000A3FE', 45  PC DBCS MS BIG-5 (T-Ch)      D2A*        
               '010100020000A148', 46  Big-5 extension for HKSCS    D3A*        
               '020100020000A148', 47  Big-5 extension for HKSCSD3A@F2C*        
               '010200021A00FDFF', 48  LITTLE ENDIAN               @F4C*        
               '01020004001AFFFD', 49  UTF-32 BE                   @F4A*        
               '0000000000000000', 50  Dummy Entry                 @F4A*        
               '010100010000001A', 51  UTF-8                       @F4A*        
               '010100010000003F'  52  UTF-EBCDIC                  @C1A         
                                                                                
.**********************************************************************         
.* NEWLINE CHARACTER DEFINITIONS. LAYOUT IS:                          *         
.*                                                                    *         
.* SSNNWWWWCCCCCCCC                                                   *         
.* '-!-!---!---------- STATE                                          *         
.*   '-!---!---------- RESERVED                                       *         
.*     '---!---------- WIDTH                                          *         
.*         '---------- NEWLINE CHARACTERS                             *         
.*                                                                    *         
.* NOTE THAT THE NEWLINE CHARACTER IS RIGHT ALIGNED WITHIN CCCCCCCC   *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.**********************************************************************         
&NEWLN(1) SETC '0100000100000015',  1 HOST SINGLE                      *        
               '0100000200000D0A',  2 IBM-PC                           *        
               '0100000100000015'   3 UTF-EBCDIC                   @C1A         
.**********************************************************************         
.* LINEFEED CHARACTER DEFINITIONS. LAYOUT IS:                         *         
.*                                                                    *         
.* SSNNWWWWCCCCCCCC                                                   *         
.* '-!-!---!---------- STATE                                          *         
.*   '-!---!---------- RESERVED                                       *         
.*     '---!---------- WIDTH                                          *         
.*         '---------- LINEFEED CHARACTERS                            *         
.*                                                                    *         
.* NOTE THAT THE LIENFEED CHARACTER IS RIGHT ALIGNED WITHIN CCCCCCCC  *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.**********************************************************************         
&LINEF(1) SETC '0100000100000025',  1 HOST SINGLE                      *        
               '010000010000000A',  2 IBM-PC AND ISO                   *        
               '020000010000000A',  3 ISO2022                          *        
               '030000010000000A',  4 ISO2022                          *        
               '040000010000000A',  5 ISO2022                          *        
               '010000020000000A',  6 UCS-2                        @F2C*        
               '0100000200000A00',  7 LITTLE ENDIAN                @F4C*        
               '010000040000000A',  8 UTF-32                       @F4A*        
               '0000000000000000',  9 Dummy Entry                  @F4A*        
               '010000010000000A', 10 UTF-8                        @F4A*        
               '0100000100000025'  11 UTF-EBCDIC                   @C1A         
                                                                                
.**********************************************************************         
.* CARRIAGE RETURN CHARACTER DEFINITIONS. LAYOUT IS:                  *         
.*                                                                    *         
.* SSNNWWWWCCCCCCCC                                                   *         
.* '-!-!---!---------- STATE                                          *         
.*   '-!---!---------- RESERVED                                       *         
.*     '---!---------- WIDTH                                          *         
.*         '---------- CARRIAGE RETURN CHARACTERS                     *         
.*                                                                    *         
.* NOTE THAT THE CARRIAGE RETURN CHARACTERS ARE RIGHT ALINED WITHIN   *         
.* CCCCCCCC                                                           *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.**********************************************************************         
&CARET(1) SETC '010000010000000D',  1 HOST SINGLE                      *        
               '010000010000000D',  2 IBM-PC AND ISO                   *        
               '020000010000000D',  3 ISO2022                          *        
               '030000010000000D',  4 ISO2022                          *        
               '040000010000000D',  5 ISO2022                          *        
               '010000020000000D',  6 UCS-2                        @F2C*        
               '0100000200000D00',  7 LITTLE ENDIAN                @F4C*        
               '010000040000000D',  8 UTF-32                       @F4A*        
               '0000000000000000',  9 Dumy Entry                   @F4A*        
               '010000010000000D', 10 UTF-8                        @F4A*        
               '010000010000000D'  11 UTF-EBCDIC                   @C1A         
.**********************************************************************         
.* END OF FILE CHARACTER DEFINITIONS. LAYOUT IS:                      *         
.*                                                                    *         
.* SSNNWWWWCCCCCCCC                                                   *         
.* '-!-!---!---------- STATE                                          *         
.*   '-!---!---------- RESERVED                                       *         
.*     '---!---------- WIDTH                                          *         
.*         '---------- END OF FILE CHARACTERS                         *         
.*                                                                    *         
.* NOTE THAT THE END OF FILE CHARACTERS ARE RIGHT ALINED WITHIN       *         
.* CCCCCCCC                                                           *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.**********************************************************************         
&EOFC(1)  SETC '010000010000001C',  1 HOST SINGLE                      *        
               '010000010000001A',  2 IBM-PC AND ISO                   *        
               '020000010000001C',  3 ISO2022                          *        
               '030000010000001C',  4 ISO2022                          *        
               '040000010000001C',  5 ISO2022                          *        
               '010000020000001C',  6 UCS-2                        @F2C*        
               '0100000200001C00',  7 LITTLE ENDIAN                @F4C*        
               '010000040000001C',  8 UTF-32                       @F4A*        
               '0000000000000000',  9 Dummy Entry                  @F4A*        
               '010000010000001C', 10 UTF-8                        @F4A*        
               '010000010000001C'  11 UTF-EBCDIC                   @C1A         
.**********************************************************************         
.* ACRI INFORMATION TYPE PC DEFINITIONS. LAYOUT IS:                   *         
.*                                                                    *         
.* NNNNNNNNAABBCCDD  FOLLOWED BY XL28'00'                             *         
.* '-------!-!-!-!---- NUMBER OF RANGES                               *         
.*         '-!-!-!---- START RANGE 1                                  *         
.*           '-!-!---- END RANGE 1                                    *         
.*             '-!---- START RANGE 2                                  *         
.*               '---- END RANGE 2                                    *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.**********************************************************************         
&ACRI_PC(1) SETC '00000002819FE0FC',   1  PCMB - JAPAN                 *        
               '000000018FFE0000',     2  PCMB - KOREA                 *        
               '0000000181FC0000',     3  PCMB - T-CH                  *        
               '0000000181BF0000',     4  PCMB - KOREA (OLD)           *        
               '0000000181FE0000',     5  PCMB - T-CH BIG 5            *        
               '000000018CFE0000'      6  PCMB - S-CH GB                        
.**********************************************************************         
.* ACRI INFORMATION TYPE EUC DEFINITIONS. LAYOUT IS:                  *         
.*                                                                    *         
.* NNNNNNNNAABBCCDD  FOLLOWED BY XL28'00'                             *         
.* '-------!-!-!-!---- NUMBER OF GRAPHIC SETS                         *         
.*         '-!-!-!---- LENGTH SET 1                                   *         
.*           '-!-!---- LENGTH SET 2                                   *         
.*             '-!---- LENGTH SET 3                                   *         
.*               '---- LENGTH SET 4                                   *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.* ADDITIONALLY THE MINIMUM AND MAXIMUM CHARACTER WIDTH IS SET IN     *         
.* MINMAX_EUC                                                         *         
.*                                                                    *         
.**********************************************************************         
&ACRI_EUC(1) SETC '0000000401020102',   1                              *        
               '0000000301020300',      2                              *        
               '0000000201020000'       3                                       
&MINMAX_EUC(1) SETC  'AL1(1,3)','AL1(1,4)','AL1(1,3)'                           
.**********************************************************************         
.* ACRI INFORMATION TYPE TCP DEFINITIONS. LAYOUT IS:                  *         
.*                                                                    *         
.* NNNNNNNNWWLLCCCCCC (WWLLCCCCC REPEATED 4 TIMES)                    *         
.* '-------!-!-!------ NUMBER OF CODESETS                             *         
.*         '-!-!------ WIDTH OF SET 0                                 *         
.*           '-!------ LENGTH OF ESCAPE SEQUENCE OF SET 0(1,2,3)      *         
.*             '------ ESCAPE SEQUENCE OF SET 0(1,2,3)                *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CDRA REFERENCE                          *         
.*                                                                    *         
.* ADDITIONALLY THE MINIMUM AND MAXIMUM CHARACTER WIDTH IS SET IN     *         
.* MINMAX_TCP                                                         *         
.*                                                                    *         
.**********************************************************************         
&ACRI_TCP(1) SETC '0000000401031B284A00000002041B2428420000',         1*        
               '01031B284900000002041B2428440000',                 @D3C*        
               '0000000401031B284A00000002041B2428400000',            2*        
               '01031B284900000002041B2428440000',                     *        
               '0000000401031B284200000002041B2428420000',            3*        
               '01031B284900000002041B2428440000',                     *        
               '0000000401031B284200000002041B2428400000',            4*        
               '01031B284900000002041B2428440000',                     *        
               '0000000401031B284A00000002031B2442000000',            5*        
               '01031B284900000002041B2428440000',                     *        
               '0000000401031B284A00000002031B2440000000',            6*        
               '01031B284900000002041B2428440000',                     *        
               '0000000401031B284200000002031B2442000000',            7*        
               '01031B284900000002041B2428440000',                     *        
               '0000000401031B284200000002031B2440000000',            8*        
               '01031B284900000002041B2428440000',                     *        
               '0000000301031B284200000002041B2429300000',            9*        
               '02041B24293100000000000000000000',                     *        
               '0000000201031B284200000002041B2428430000',           10*        
               '00000000000000000000000000000000',                     *        
               '0000000201031B284200000002031B2441000000',           11*        
               '00000000000000000000000000000000',                     *        
               '00000002010000000000000001041B2429430000',           12*        
               '00000000000000000000000000000000',                     *        
               '00000004010000000000000002041B2429470000',           13*        
               '02041B242A48000002041B2429410000',                     *        
               '00000003010000000000000002041B2429470000',           14*        
               '02041B242A4800000000000000000000',                     *        
               '00000002010000000000000002041B2429410000',           15*        
               '00000000000000000000000000000000',                     *        
               '0000000401031B284200000001031B284A000000',           16*        
               '02031B244000000002031B2442000000'                               
&MINMAX_TCP(1) SETC 'AL1(1,6)','AL1(1,6)','AL1(1,6)','AL1(1,6)',       *        
               'AL1(1,6)','AL1(1,6)','AL1(1,6)','AL1(1,6)','AL1(1,6)', *        
               'AL1(1,6)','AL1(1,5)','AL1(1,5)','AL1(1,6)','AL1(1,6)', *        
               'AL1(1,6)','AL1(1,5)'                                            
.**********************************************************************         
.* STRING TYPE. LAYOUT IS:                                            *         
.*                                                                    *         
.* OOCCTTIISSNNXXFFFF                                                 *         
.* '-!-!-!-!-!-!------ ORIENTATION                                    *         
.*   '-!-!-!-!-!------ CONTEXT                                        *         
.*     '-!-!-!-!------ TYPE OF TEXT                                   *         
.*       '-!-!-!------ IMPLICIT ALGOR                                 *         
.*         '-!-!------ SWAPING                                        *         
.*           '-!------ NUMERALES                                      *         
.*             '------ TEXT SHAPING                                   *         
.*                                                                    *         
.* DEFINITIONS ARE TAKEN FROM CODE                                    *         
.*                                                                    *         
.**********************************************************************         
&STRINGS(1)  SETC '00000000000000000000',  1 STRINGTYPE                *        
                  '00000000000000000000',  2 STRINGTYPE                *        
                  '00000000000000000000',  3 STRINGTYPE                *        
                  '00000000000001000000',  4 STRINGTYPE                *        
                  '00000100010100000000',  5 STRINGTYPE                *        
                  '01000100010100000000',  6 STRINGTYPE                *        
                  '04000000000000000000',  7 STRINGTYPE                *        
                  '01000000000001000000',  8 STRINGTYPE                *        
                  '01000000010001000000',  9 STRINGTYPE                *        
                  '02000100010100000000', 10 STRINGTYPE                *        
                  '03000100010100000000', 11 STRINGTYPE                *        
                  '01000100000101000000'  12 STRINGTYPE                         
.**********************************************************************         
.* CHECK THE CCSID OPERAND                                            *         
.* CCSID IS REQUIRED IN ANY CASE. ONE TO FIVE DECIMAL DIGITS HAVE TO  *         
.* BE SUPPLIED.                                                       *         
.**********************************************************************         
.ID0     AIF   (T'&CCSID EQ 'O').ID999 CCSID IS REQUIRED]                       
         AIF   (N'&CCSID NE 1).ID998   ONLY ONE VALUE ALLOWED]                  
         AIF   ((&CCSID LT 1) OR (&CCSID GT 65535)).ID998  CHECK RANGE?         
         AGO   .ES0                                                             
.ID999   ANOP  ,                                                                
         MNOTE 8,'MISSING KEYWORD: CCSID'                                       
         MEXIT                                                                  
.ID998   ANOP  ,                                                                
         MNOTE 8,'INVALID OPERAND ''&CCSID'' FOR KEYWORD: CCSID'                
         MEXIT                                                                  
.**********************************************************************         
.* CHECK THE ES OPERAND.                                              *         
.* ES IS REQUIRED IN ANY CASE. FOUR HEX DIGITS HAVE TO BE SUPPLIED.   *         
.* ES DETERMINES WHETHER A CCSID IS CONSIDERED SIMPLE OR MIXED.       *         
.* THIS HAS IMPLICATIONS ON THE OPERANDS THAT HAVE TO BE SPECIFIED.   *         
.*                                                                    *         
.* IF CCSID IS SIMPLE SUFFIX AND CCDEF ARE REQUIRED.                  *         
.* OTHERWISE SUBIDS IS REQUIRED AND IF ES^=1301 ACRI IS REQUIRED      *         
.*                                                                    *         
.**********************************************************************         
.ES0     AIF   (T'&ES EQ 'O').ES999     ES IS REQUIRED]                         
         AIF   (N'&ES NE 1).ES998       ONLY ONE VALUE ALLOWED]                 
.**********************************************************************         
.* CHECK SIMPLE CCSIDS (SBCS,DBCS,TBCS,UTF-8,LITTLE ENDIAN)       @F2C*         
.**********************************************************************         
&AT      SETC  'SBCS'                                                           
.ESS1    AIF   ('&ES' EQ '1100').CHKSIMP EBCDIC SBCS                            
.ESS2    AIF   ('&ES' EQ '2100').CHKSIMP PC-DATA SBCS                           
.ESS3    AIF   ('&ES' EQ '3100').CHKSIMP PC-DISPLAY SBCS                        
.ESS4    AIF   ('&ES' EQ '4100').CHKSIMP ISO-8 SBCS                             
.ESS5    AIF   ('&ES' EQ '4105').CHKSIMP ISO-8 SBCS, GRAPHICS                   
.ESS6    AIF   ('&ES' EQ '4155').CHKSIMP ISO-8 PRESENTATION SBCS                
.ESS7    AIF   ('&ES' EQ '5100').CHKSIMP ISO-7 SBCS                             
.ESS8    AIF   ('&ES' EQ '6100').CHKSIMP EBCDIC PRESENTATION SBCS               
.ESS9    AIF   ('&ES' EQ '8100').CHKSIMP 8-BIT EUC G-SET STANDALONE             
&AT      SETC  'DBCS'                                                           
.ESD1    AIF   ('&ES' EQ '1200').CHKSIMP EBDIC DBCS                             
.ESD2    AIF   ('&ES' EQ '2200').CHKSIMP PC-DATA DBCS                           
.ESD3    AIF   ('&ES' EQ '3200').CHKSIMP PC-DISPLAY DBCS                        
.ESD4    AIF   ('&ES' EQ '5200').CHKSIMP ISO-7 DBCS                             
.ESD5    AIF   ('&ES' EQ '7200').CHKSIMP UCS-2                                  
.ESD6    AIF   ('&ES' EQ '9200').CHKSIMP 8-BIT EUC G-SET STANDALONE F1C         
&AT      SETC  'TBCS'                                                           
.ES14    AIF   ('&ES' EQ '5700').CHKSIMP ISO-7 TBCS                             
&AT      SETC  'FBCS'                                               D1A         
.ESF1    AIF   ('&ES' EQ '2900').CHKSIMP GB18030 4BYTE              D1A         
&AT      SETC  'UTF8'                                                           
.ES15    AIF   ('&ES' EQ '7807').CHKSIMP UTF-8                                  
&AT      SETC  'LEND'                                               F2A         
.ES16    AIF   ('&ES' EQ '720B').CHKSIMP LITTLE ENDIAN              F2A         
&AT      SETC  'UTF32'                                             @F4A         
.ES17    AIF   ('&ES' EQ '7500').CHKSIMP UTF-32                    @F4A         
&AT      SETC  'UTFEBCDIC'                                         @C1A         
.ES18    AIF   ('&ES' EQ '1808').CHKSIMP UTF-EBCDIC                @C1A         
.**********************************************************************         
.* CHECK MIXED CCSIDS (ALL OTHERS)                                    *         
.**********************************************************************         
.ES19    ANOP  ,                                                   @C1C         
&AT      SETC  'EBCDIC'                  NO ACRI FOR EBCDIC MIXED               
&AI      SETA  0                         NO ACRI FOR EBCDIC MIXED               
         AIF   ('&ES' NE '1301').ES20    EBCDIC MIXED SI/SO        @C1C         
         AGO   .CHKMIX                                                          
.ES20    ANOP  ,                                                   @C1C         
&AT      SETC  'PC'                      ACRI TYPE MUST BE PC                   
&AI      SETA  N'&ACRI_PC                SET MAX INDEX INTO ACRI TABLE          
         AIF   ('&ES' NE '2300').ES21    PC-DATA MIXED             @C1C         
         AGO   .CHKMIX                                                          
.ES21    ANOP  ,                                                   @C1C         
&AT      SETC  'PC'                      ACRI TYPE MUST BE PC                   
&AI      SETA  N'&ACRI_PC                SET MAX INDEX INTO ACRI TABLE          
         AIF   ('&ES' NE '3300').ES22    PC-DISPLAY MIXED          @C1C         
         AGO   .CHKMIX                                                          
.ES22    ANOP  ,                                                   @C1C         
&AT      SETC  'EUC'                     ACRI TYPE MUST BE EUC                  
&AI      SETA  N'&ACRI_EUC               SET MAX INDEX INTO ACRI TABLE          
         AIF   ('&ES' NE '4403').ES23    IBM EUC                   @C1C         
         AGO   .CHKMIX                                                          
.ES23    ANOP  ,                                                   @C1C         
&AT      SETC  'TCP'                     ACRI TYPE MUST BE TC                   
&AI      SETA  N'&ACRI_TCP               SET MAX INDEX INTO ACRI TABLE          
         AIF   ('&ES' NE '5404').ES24    ISO 2022 TCP/IP JPN       @C1C         
         AGO   .CHKMIX                                                          
.ES24    ANOP  ,                                                   @C1C         
         AIF   ('&ES' NE '5409').ES25    ISO 2022 TCP/IP KRD1C     @C1C         
         AGO   .CHKMIX                                                          
.ES25    ANOP  ,                                                   @C1C         
&AT      SETC  'GB18030'                 ACRI TYPE MUST BE GB18030  D1A         
         AIF   ('&ES' NE '2A00').ES26    GB18030                   @C1C         
         AGO   .CHKMIX                                                          
.ES26    ANOP  ,                                                   @C1C         
&AT      SETC  'PC'                      ACRI TYPE MUST BE PC      D3A4         
&AI      SETA  N'&ACRI_PC                SET MAX INDEX INTO ACRI TABLE          
         AIF   ('&ES' NE '2305').ES998   PC-DISPLAY MIXED                       
         AGO   .CHKMIX                                                          
.ES999   ANOP  ,                                                                
         MNOTE 8,'MISSING KEYWORD: ES'                                          
         MEXIT                                                                  
.ES998   ANOP  ,                                                                
         MNOTE 8,'INVALID OPERAND ''&ES'' FOR KEYWORD: ES'                      
         MEXIT                                                                  
.**********************************************************************         
.* CHECK THE OPERANDS FOR SIMPLE CCSIDS                               *         
.* - SUFFIX MUST BE SPECIFIES AS 2 CHARACTERS                         *         
.* - CCDEF MUST BE SPECIFIED AS A LIST OF 6 INDICES                   *         
.**********************************************************************         
.CHKSIMP ANOP  ,                                                                
.**********************************************************************         
.* CHECK THE SUFFIX OPERAND                                           *         
.**********************************************************************         
.SUF0    AIF   (T'&SUFFIX EQ 'O').SUF999 SUFFIX IS REQUIRED]                    
         AIF   (N'&SUFFIX NE 1).SUF998   ONLY ONE VALUE ALLOWED]                
         AIF   ('&SUFFIX' EQ '''XRF''').CCDF0   ** IBM ONLY **                  
         AIF   (K'&SUFFIX NE 2).SUF998   MUST BE 2 CHARACTERS                   
         AGO   .CCDF0                                                           
.SUF999  MNOTE 8,'MISSING KEYWORD FOR SIMPLE CCSID: SUFFIX'                     
         MEXIT                                                                  
.SUF998  MNOTE 8,'INVALID OPERAND ''&SUFFIX'' FOR KEYWORD: SUFFIX'              
         MEXIT                                                                  
.**********************************************************************         
.* CHECK THE CCDEF OPERAND                                            *         
.**********************************************************************         
.CCDF0   AIF   (T'&CCDEF EQ 'O').CCDF997                                        
         AIF   (N'&CCDEF NE 6).CCDF996                                          
         AIF   (&CCDEF(1) GT N'&SPACE).CCDF995                                  
         AIF   (&CCDEF(2) GT N'&SUBC).CCDF994                                   
         AIF   (&CCDEF(3) GT N'&NEWLN).CCDF993                                  
         AIF   (&CCDEF(4) GT N'&LINEF).CCDF992                                  
         AIF   (&CCDEF(5) GT N'&CARET).CCDF991                                  
         AIF   (&CCDEF(6) GT N'&EOFC).CCDF990                                   
         AIF   (T'&ACRI NE 'O').CCDF999                                         
         AIF   (T'&SUBIDS NE 'O').CCDF998                                       
         AGO   .CHKOK                                                           
.CCDF999 MNOTE 8,'EXCESSIVE KEYWORD(S) FOR MIXED CCSIDS: SUFFIX'                
         MEXIT                                                                  
.CCDF998 MNOTE 8,'EXCESSIVE KEYWORD(S) FOR MIXED CCSIDS: CCDEF'                 
         MEXIT                                                                  
.CCDF997 MNOTE 8,'MISSING KEYWORD FOR SIMPLE CCSID: CCDEF'                      
         MEXIT                                                                  
.CCDF996 MNOTE 8,'INVALID OPERAND ''&CCDEF'' FOR KEYWORD: CCDEF'                
         MEXIT                                                                  
.CCDF995 MNOTE 8,'INVALID SP IN CCDEF SPECIFIED'                                
         MEXIT                                                                  
.CCDF994 MNOTE 8,'INVALID SUB IN CCDEF SPECIFIED'                               
         MEXIT                                                                  
.CCDF993 MNOTE 8,'INVALID NL IN CCDEF SPECIFIED'                                
         MEXIT                                                                  
.CCDF992 MNOTE 8,'INVALID LF IN CCDEF SPECIFIED'                                
         MEXIT                                                                  
.CCDF991 MNOTE 8,'INVALID CR IN CCDEF SPECIFIED'                                
         MEXIT                                                                  
.CCDF990 MNOTE 8,'INVALID EOF IN CCDEF SPECIFIED'                               
         MEXIT                                                                  
.**********************************************************************         
.* CHECK THE OPERANDS FOR MIXED CCSIDS                                *         
.* - CHECK ACRI DEPENDING ON THE ENCODING SCHEME                      *         
.* - SUBIDS MUST BE 2-8 VALID CCSIDS                                  *         
.**********************************************************************         
.CHKMIX  ANOP  ,                                                                
.**********************************************************************         
.* CHECK ACRI OPERAND                                                 *         
.**********************************************************************         
.ACRI0   AIF   ((T'&ACRI EQ 'O') AND ('&AT' EQ '')).SUB0  NO ACRI REQ.          
         AIF   ((T'&ACRI EQ 'O') AND ('&AT' EQ 'EBCDIC')).SUB0                  
         AIF   ((T'&ACRI EQ 'O') AND ('&AT' EQ 'GB18030')).SUB0                 
         AIF   (T'&ACRI EQ 'O').ACRI999         ACRI REQUIRED                   
         AIF   (N'&ACRI NE 2).ACRI998           MUST BE TWO VALUES              
         AIF   ('&ACRI(1)' NE '&AT').ACRI997    VAL 1 MUST MATCH ES             
         AIF   (T'&ACRI(2) NE 'N').ACRI996      VAL 2 MUST BE NUMBER            
         AIF   (('&ACRI(1)' EQ 'TCP') AND (&ACRI(2)*2 GT &AI)).ACRI996          
         AIF   (('&ACRI(1)' NE 'TCP') AND (&ACRI(2) GT &AI)).ACRI996            
         AGO   .SUB0                                                            
.ACRI999 MNOTE 8,'MISSING KEYWORD FOR ES=&ES: ACRI'                             
         MEXIT                                                                  
.ACRI998 MNOTE 8,'INVALID OPERAND ''&ACRI'' FOR KEYWORD: ACRI'                  
         MEXIT                                                                  
.ACRI997 MNOTE 8,'INVALID ACRI TYPE ''&ACRI(1)'' FOR ES=&ES'                    
         MEXIT                                                                  
.ACRI996 MNOTE 8,'INVALID ACRI INDEX ''&ACRI(2)'' FOR ES=&ES'                   
         MEXIT                                                                  
.**********************************************************************         
.* CHECK SUBIDS OPERAND                                               *         
.**********************************************************************         
.SUB0    AIF   (T'&SUBIDS EQ 'O').SUB997     SUBIDS IS REQUIRED]                
         AIF   ((N'&SUBIDS LT 2) OR (N'&SUBIDS GT 8)).SUB996   2-8              
&I       SETA  0                                                                
.SUB1    ANOP  ,                                                                
&I       SETA  &I+1                                                             
         AIF   ((&SUBIDS(&I) LT 1) OR (&SUBIDS(&I) GT 65535)).SUB995            
         AIF   (&I EQ N'&SUBIDS).CHKOK                                          
         AIF   (T'&SUFFIX NE 'O').SUB999                                        
         AIF   (T'&CCDEF NE 'O').SUB998                                         
         AGO   .SUB1                                                            
.SUB999  MNOTE 8,'EXCESSIVE KEYWORD(S) FOR MIXED CCSIDS: SUFFIX'                
         MEXIT                                                                  
.SUB998  MNOTE 8,'EXCESSIVE KEYWORD(S) FOR MIXED CCSIDS: CCDEF'                 
         MEXIT                                                                  
.SUB997  MNOTE 8,'MISSING KEYWORD FOR MIXED CCSIDS: SUBIDS'                     
         MEXIT                                                                  
.SUB996  MNOTE 8,'INVALID OPERAND ''&SUBIDS'' FOR KEYWORD: SUBIDS'              
         MEXIT                                                                  
.SUB995  MNOTE 8,'INVALID SUB-CCSID ''&SUBIDS(&I)'' SPECIFIED AS SUBID(*        
               &I)'                                                             
         MEXIT                                                                  
.CHKOK   AIF   (N'&STRINGT NE 1).STR999   ONLY ONE VALUE ALLOWED]               
         AGO   .CHKOK2                                                          
.STR999  MNOTE 8,'INVALID OPERAND ''&STRINGT'' FOR KEYWORD: STRINGT'            
         MEXIT                                                                  
.CHKOK2  ANOP                                                                   
.*                                                                              
.* CREATE STANDARD CUNBIKBS BODY                                                
.*                                                                              
         AGO   .COMMNT1        JUST A COMMENT FOR CLARITY                       
         CUNBIKBS DSECT=NO,CUNBIKBS=YES,TITLE=NO,UCCS=NO,CUNBCPRM=NO,  *        
               HCUNBIKBS=NO,CUNBIKBS_ACRI_PC=NO,CUNBIKBS_ACRI_EUC=NO,  *        
               CUNBIKBS_ACRI_TCP=NO,CUNBIKBS_CFUNC=NO                           
.COMMNT1 ANOP  ,                                                                
.*                                                                              
.* NOTE THAT WE HAVE TO USE THE ADDRESSING FORM LABEL1+(LABEL2-LABEL3)          
.* BECAUSE THE MAPPING MACRO CUNBIKBS CANNOT PRODUCE A VALID CSECT              
.* FROM KEYWORD PARAMETERS, AND ALSO CONTAINS HARD-CODED LABELS WHICH           
.* WILL CAUSE DUPLICATE LABEL ERRORS IF INVOKED MORE THAN ONCE                  
.*                                                                              
.**********************************************************************         
.* CREATE THE KB ENTRIES HEADER WITH EYECATCHER, LENGTH , VERSION     *         
.* CCSID, NAME, SUFFIX AND ES. NOTE THAT IF 'XRF' WAS USED AS ASUFFIX *         
.* MACRO CUNAIXRF IS CALLED TO GENERATE AN IBM SUFFIX                 *         
.**********************************************************************         
&LAB     SETC  'KB&CCSID'                                                       
&LAB     DS    0D                      CREATE A LABEL                           
A&X      DS    0D                                                               
         ORG   A&X                                                              
         DC    (CUNBIKBS_END-CUNBIKBS)X'0'                                      
         ORG   A&X+(CUNBIKBS_EYECATCHER-CUNBIKBS)                               
         DC    CL4'KBSE'                                                        
         ORG   A&X+(CUNBIKBS_LENGTH-CUNBIKBS)                                   
         DC    A(CUNBIKBS_END-CUNBIKBS)                                         
         ORG   A&X+(CUNBIKBS_VERSION-CUNBIKBS)                                  
         DC    F'&VERSION'             After B35800 VERSION is 2 @F3C           
         ORG   A&X+(CUNBIKBS_CCSID-CUNBIKBS)                                    
         DC    F'&CCSID'                                                        
         ORG   A&X+(CUNBIKBS_NAME-CUNBIKBS)                                     
         AIF   (T'&DESC EQ 'O').DESC001  DESC NOT PROVIDED        @F3A          
         AIF   (T'&DESC NE 'O').DESC002  DESC PROVIDED            @F3A          
.DESC001 DC    CL64''                                             @F3A          
         AGO   .DESCOK                                            @F3A          
.DESC002 DC    CL64&DESC               After B35800 use DESC parm @F3C          
         AGO   .DESCOK                                            @F3A          
.DESCOK  ANOP  ,                                                  @F3A          
         ORG   A&X+(CUNBIKBS_SUFFIX-CUNBIKBS)                                   
         AIF   ('&SUFFIX' NE '''XRF''').USRSFX                                  
         CUNAIXRF CCSID=&CCSID                                                  
         AGO   .XRFDONE                                                         
.USRSFX  AIF   (T'&SUFFIX EQ 'O').XRFDONE                                       
.ADDSUF  DC    CL2'&SUFFIX'                                                     
.XRFDONE ANOP  ,                                                                
         ORG   A&X+(CUNBIKBS_ENCODING-CUNBIKBS)                                 
         DC    XL2'&ES'                                                         
.**********************************************************************         
.* NOW FILL IN THE ACRI INFORMATION AND THE MIN AND MAX BUFFER LENGTHS*         
.**********************************************************************         
         AIF   ('&AT' EQ 'EBCDIC').EBCDIC                                       
         AIF   ('&AT' EQ 'EUC').EUC                                             
         AIF   ('&AT' EQ 'PC').PC                                               
         AIF   ('&AT' EQ 'UTF8').UTF8                                           
         AIF   ('&AT' EQ 'SBCS').SBCS                                           
         AIF   ('&AT' EQ 'DBCS').DBCS                                           
         AIF   ('&AT' EQ 'TBCS').TBCS                                           
         AIF   ('&AT' EQ 'FBCS').FBCS                                           
         AIF   ('&AT' EQ 'GB18030').GB18030                                     
         AIF   ('&AT' EQ 'LEND').LEND                              @F2A         
         AIF   ('&AT' EQ 'UTF32').UTF32                            @F4A         
         AIF   ('&AT' EQ 'UTFEBCDIC').UTFEBCDIC                    @C1A         
.TCP     ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                               
         DC    &MINMAX_TCP(&ACRI(2))                                            
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                                
         DC    CL1'T'                                                           
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                                
         DC    XL20'&ACRI_TCP((&ACRI(2)-1)*2+1)'                                
         DC    XL16'&ACRI_TCP((&ACRI(2)-1)*2+2)'                                
         AGO   .CCDEF                                                           
.EBCDIC  ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                               
         DC    AL1(1,3)                                                         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                                
         DC    CL1' '                                                           
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                                
         DC    XL36'00'                                                         
         AGO   .CCDEF                                                           
.EUC     ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                               
         DC    &MINMAX_EUC(&ACRI(2))                                            
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                                
         DC    CL1'E'                                                           
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                                
         DC    XL8'&ACRI_EUC(&ACRI(2))',XL28'00'                                
         AGO   .CCDEF                                                           
.PC      ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                               
         DC    AL1(1,2)                                                         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                                
         DC    CL1'P'                                                           
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                                
         DC    XL8'&ACRI_PC(&ACRI(2))',XL28'00'                                 
         AGO   .CCDEF                                                           
.UTF8    ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                               
         DC    AL1(1,4)                                                         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                                
         DC    CL1' '                                                           
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                                
         DC    XL36'00'                                                         
         AGO   .CCDEF                                                           
.SBCS    ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                               
         DC    AL1(1,1)                                                         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                                
         DC    CL1' '                                                           
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                                
         DC    XL36'00'                                                         
         AGO   .CCDEF                                                           
.DBCS    ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                               
         DC    AL1(2,2)                                                         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                                
         DC    CL1' '                                                           
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                                
         DC    XL36'00'                                                         
         AGO   .CCDEF                                                           
.TBCS    ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                               
         DC    AL1(3,3)                                                         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                                
         DC    CL1' '                                                           
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                                
         DC    XL36'00'                                                         
         AGO   .CCDEF                                                           
.FBCS    ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                   D1A         
         DC    AL1(4,4)                                             D1A         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                    D1A         
         DC    CL1' '                                               D1A         
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                    D1A         
         DC    XL36'00'                                             D1A         
         AGO   .CCDEF                                               D1A         
.GB18030 ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                   D1A         
         DC    AL1(1,4)                                             D1A         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                    D1A         
         DC    CL1' '                                               D1A         
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                    D1A         
         DC    XL36'00'                                             D1A         
         AGO   .CCDEF                                               D1A         
.LEND      ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                @F2A         
         DC    AL1(2,2)                                            @F4C         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                   @F2A         
         DC    CL1' '                                              @F2A         
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                   @F2A         
         DC    XL36'00'                                            @F2A         
         AGO   .CCDEF                                              @F2A         
.UTF32   ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                  @F4A         
         DC    AL1(4,4)                                            @F4A         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                   @F4A         
         DC    CL1' '                                              @F4A         
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                   @F4A         
         DC    XL36'00'                                            @F4A         
         AGO   .CCDEF                                              @F4A         
.UTFEBCDIC ORG   A&X+(CUNBIKBS_BUFFER_MIN-CUNBIKBS)                @C1A         
         DC    AL1(1,4)                                            @C1A         
         ORG   A&X+(CUNBIKBS_ACRI_TYPE-CUNBIKBS)                   @C1A         
         DC    CL1' '                                              @C1A         
         ORG   A&X+(CUNBIKBS_ACRI_AREA-CUNBIKBS)                   @C1A         
         DC    XL36'00'                                            @C1A         
         AGO   .CCDEF                                              @C1A         
.**********************************************************************         
.* NOW FILL IN THE CONTROL FUNCTION DEFINITIONS                       *         
.**********************************************************************         
.CCDEF   AIF   (T'&CCDEF EQ 'O').NUMSUB                                         
         ORG   A&X+(CUNBIKBS_CFUNC_AREA-CUNBIKBS)                               
         AIF   (&CCDEF(1) NE 0).CCD1                                            
         DC    XL8'00'                                                          
         AGO   .CCD1A                                                           
.CCD1    DC    XL8'&SPACE(&CCDEF(1))'                                           
.CCD1A   AIF   (&CCDEF(2) NE 0).CCD2                                            
         DC    XL8'00'                                                          
         AGO   .CCD2A                                                           
.CCD2    DC    XL8'&SUBC(&CCDEF(2))'                                            
.CCD2A   AIF   (&CCDEF(3) NE 0).CCD3                                            
         DC    XL8'00'                                                          
         AGO   .CCD3A                                                           
.CCD3    DC    XL8'&NEWLN(&CCDEF(3))'                                           
.CCD3A   AIF   (&CCDEF(4) NE 0).CCD4                                            
         DC    XL8'00'                                                          
         AGO   .CCD4A                                                           
.CCD4    DC    XL8'&LINEF(&CCDEF(4))'                                           
.CCD4A   AIF   (&CCDEF(5) NE 0).CCD5                                            
         DC    XL8'00'                                                          
         AGO   .CCD5A                                                           
.CCD5    DC    XL8'&CARET(&CCDEF(5))'                                           
.CCD5A   AIF   (&CCDEF(6) NE 0).CCD6                                            
         DC    XL8'00'                                                          
         AGO   .NUMSUB                                                          
.CCD6    DC    XL8'&EOFC(&CCDEF(6))'                                            
.**********************************************************************         
.* NOW FILL IN THE NUMBER AND VALUES IF SUB-CCSIDS                    *         
.**********************************************************************         
.NUMSUB  ORG   A&X+(CUNBIKBS_SUBCCSID_NUM-CUNBIKBS)                             
&NCP     SETA  N'&SUBIDS                                                        
         DC    F'&NCP'                                                          
         AIF   (T'&SUBIDS(1) EQ 'O').FILLSTR                                    
         ORG   A&X+(CUNBIKBS_SUBCCSID_1-CUNBIKBS)                               
&LAB     SETC  'KB&SUBIDS(1)'                                                   
         DC    F'&SUBIDS(1)'                                                    
         AIF   (T'&SUBIDS(2) EQ 'O').FILLSTR                                    
         ORG   A&X+(CUNBIKBS_SUBCCSID_2-CUNBIKBS)                               
&LAB     SETC  'KB&SUBIDS(2)'                                                   
         DC    F'&SUBIDS(2)'                                                    
         AIF   (T'&SUBIDS(3) EQ 'O').FILLSTR                                    
         ORG   A&X+(CUNBIKBS_SUBCCSID_3-CUNBIKBS)                               
&LAB     SETC  'KB&SUBIDS(3)'                                                   
         DC    F'&SUBIDS(3)'                                                    
         AIF   (T'&SUBIDS(4) EQ 'O').FILLSTR                                    
         ORG   A&X+(CUNBIKBS_SUBCCSID_4-CUNBIKBS)                               
&LAB     SETC  'KB&SUBIDS(4)'                                                   
         DC    F'&SUBIDS(4)'                                                    
         AIF   (T'&SUBIDS(5) EQ 'O').FILLSTR                                    
         ORG   A&X+(CUNBIKBS_SUBCCSID_5-CUNBIKBS)                               
&LAB     SETC  'KB&SUBIDS(5)'                                                   
         DC    F'&SUBIDS(5)'                                                    
         AIF   (T'&SUBIDS(6) EQ 'O').FILLSTR                                    
         ORG   A&X+(CUNBIKBS_SUBCCSID_6-CUNBIKBS)                               
&LAB     SETC  'KB&SUBIDS(6)'                                                   
         DC    F'&SUBIDS(6)'                                                    
         AIF   (T'&SUBIDS(7) EQ 'O').FILLSTR                                    
         ORG   A&X+(CUNBIKBS_SUBCCSID_7-CUNBIKBS)                               
&LAB     SETC  'KB&SUBIDS(7)'                                                   
         DC    F'&SUBIDS(7)'                                                    
         AIF   (T'&SUBIDS(8) EQ 'O').FILLSTR                                    
         ORG   A&X+(CUNBIKBS_SUBCCSID_8-CUNBIKBS)                               
&LAB     SETC  'KB&SUBIDS(8)'                                                   
         DC    F'&SUBIDS(8)'                                                    
.**********************************************************************         
.* NOW FILL IN THE STRINGTYPE,BIDI DATA AND CODE PAGE                 *         
.**********************************************************************         
.FILLSTR ORG   A&X+(CUNBIKBS_STRINGTYPE-CUNBIKBS)                               
         DC    XL2'&STRINGT'                                                    
         ORG   A&X+(CUNBIKBS_BIDIDATA-CUNBIKBS)                                 
         AIF   (&STRINGT GT 12).STRING1                                         
.*       DC    XL10'&STRINGS(&STRINGT)'                                         
.*       MNOTE 8,'String type ''&STRINGT'' FOR ST=&STRINGS(&STRINGT)'           
         DC    XL10'&STRINGS(1)'                                                
         AGO   .NOCP2                                                           
.STRING1 DC    XL10'&STRINGS(1)'                                                
.NOCP2   ORG   A&X+(CUNBIKBS_CODEPAGE-CUNBIKBS)                                 
         DC    F'&CP'                                              @T1C         
         AGO   .NOCP                                                            
.NOCP    ANOP  ,                                                                
         ORG                                                                    
         AIF   (&DSECT).NODSECT                                                 
.*                                                                              
.* MAP THE CUNBIKBS SECTIONS, BUT ONLY ONCE                                     
.*                                                                              
MAIN&X   LOCTR                                                                  
&DSECT   SETB  1                                                                
         CUNBIKBS DSECT=YES,CUNBIKBS=YES,TITLE=NO,                     *        
               CUNBIKBS_ACRI_PC=YES,CUNBIKBS_ACRI_EUC=YES,             *        
               CUNBIKBS_ACRI_TCP=YES,CUNBIKBS_CFUNC=YES                         
MAIN&X   LOCTR                                                                  
.NODSECT ANOP  ,                                                                
         MEND                                                                   

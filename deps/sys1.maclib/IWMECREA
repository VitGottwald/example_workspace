*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMECREA                              -09/23/05-<3> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Create Enclave                                * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 (C) COPYRIGHT IBM CORP. 1994, 2006                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7730                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The purpose of this service is to create an Enclave where      * 00002100
*      possibly multiple SRBs and/or TCBs may be simultaneously       * 00002200
*      executing or scheduled. For the duration of each Enclave, all  * 00002300
*      SRBs and TCBs associated with the Enclave are treated as part  * 00002400
*      of a single work request.  All SRBs and/or TCBs associated     * 00002500
*      with the Enclave accumulate service as a single entity and are * 00002600
*      managed as a single entity.  The address spaces where Enclave  * 00002700
*      SRBs are dispatched, as defined by the ENV= parameter of       * 00002800
*      IEAMSCHD, should be non-swappable.                             * 00002900
*                                                                     * 00003000
*      For TYPE=INDEPENDENT Enclaves, a new work business unit of     * 00003100
*      work is created and classified according to the input Connect  * 00003200
*      token's subsystem type and subsystem name, along with whatever * 00003300
*      other attributes are passed via the Classify parameter list.   * 00003400
*      The current home address space is considered the owner.        * 00003500
*                                                                     * 00003600
*      For TYPE=DEPENDENT enclaves, SRM considers the enclave to be   * 00003700
*      part of the current home address space's transaction, which    * 00003800
*      then becomes the owning space.  This space need not be         * 00003900
*      connected to WLM via IWMCONN.                                  * 00004000
*                                                                     * 00004100
*      For TYPE=MONENV enclaves, SRM considers the enclave to be part * 00004200
*      of the address space's transaction which is delayed according  * 00004300
*      to the input management monitoring environment, as set when    * 00004400
*      IWMMINIT or IWMMRELA was used. This space becomes the owning   * 00004500
*      space.  This space need not be connected to WLM via IWMCONN.   * 00004600
*                                                                     * 00004700
*      For both TYPE=MONENV and TYPE=DEPENDENT enclaves, SRM will     * 00004800
*      change the enclave to TYPE=INDEPENDENT if the owning address   * 00004900
*      space's transaction ends.                                      * 00005000
*                                                                     * 00005100
*      For both TYPE=MONENV and TYPE=DEPENDENT enclaves, SRM will     * 00005200
*      check the enclave for period switch when the owning address    * 00005300
*      space is swapped in.  If the owning address space is swapped   * 00005400
*      out SRM will continue to accumulate service for any enclaves   * 00005500
*      owned by the space, but will not check the address space or    * 00005600
*      any owned enclave for period switch until the address space is * 00005700
*      swapped in again.  The presence of enclaves does not make the  * 00005800
*      address space appear to be ready from an SRM point of view.    * 00005900
*                                                                     * 00006000
*      Enclaves are deleted if the owning address space terminates.   * 00006100
*      TYPE=INDEPENDENT enclaves are deleted if the owning address    * 00006200
*      space disconnects or the TCB which connected terminates.       * 00006300
*                                                                     * 00006400
*      Enclaves should only be created when this environment is ready * 00006500
*      for execution, and should not be used when prolonged queueing  * 00006600
*      effects are possible prior to the scheduling of the first SRB  * 00006700
*      (IEAMSCHD) or the first TCB join (IWMEJOIN).  "Prolonged"      * 00006800
*      would certainly include times measured in seconds.  The        * 00006900
*      service allows the caller to pass the queueing time prior to   * 00007000
*      creation of the Enclave so that this may be separately         * 00007100
*      reported.                                                      * 00007200
*                                                                     * 00007300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00007400
*                                                                     * 00007500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00007600
*                                                                     * 00007700
*01* ENVIRONMENT:                                                     * 00007800
*                                                                     * 00007900
*                                                                     * 00008000
*      Dispatchable unit mode: Task or SRB mode.                      * 00008100
*                                                                     * 00008200
*      Minimum authorization: Supervisor state or program key mask    * 00008300
*                        (PKM) allowing keys 0-7.                     * 00008400
*                                                                     * 00008500
*      AMODE:            31-bit.                                      * 00008600
*                                                                     * 00008700
*      ASC mode:         Primary or Access Register.                  * 00008800
*                                                                     * 00008900
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00009000
*                                                                     * 00009100
*      Interrupt status: Enabled for I/O and external interrupts.     * 00009200
*                                                                     * 00009300
*      Locks:            No locks held.                               * 00009400
*                                                                     * 00009500
*      Control parameters: Control parameters must be in the primary  * 00009600
*                        address space.                               * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*01* PROGRAMMING REQUIREMENTS:                                        * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*    1.  The macro IWMYCON must be included to use this macro.        * 00010400
*                                                                     * 00010500
*    2.  The macro IWMPB must be in the library concatenation, since  * 00010600
*        it is included by IWMYCON.                                   * 00010700
*                                                                     * 00010800
*    3.  Note that the high order halfword of register 0, and the     * 00010900
*        reason code variable when specified, may be non-zero and     * 00011000
*        represents diagnostic data which is NOT part of the external * 00011100
*        interface.  The high order halfword should thus be excluded  * 00011200
*        from comparison with the reason code values described above. * 00011300
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00011400
*        be used for this purpose.                                    * 00011500
*                                                                     * 00011600
*    4.  All character data, unless otherwise specified, is assumed   * 00011700
*        to be left justified and padded with blanks on the right, as * 00011800
*        needed, to occupy the specified number of bytes.             * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*01* RESTRICTIONS:                                                    * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*    1.  This macro may not be used prior to the completion of WLM    * 00012600
*        address space initialization.                                * 00012700
*                                                                     * 00012800
*    2.  This macro may only be used on MVS/ESA SP5.2 or higher       * 00012900
*        levels.                                                      * 00013000
*                                                                     * 00013100
*    3.  This macro may only be used on MVS/ESA HBB6603 or higher     * 00013200
*        levels for TYPE(DEPENDENT!MONENV).                           * 00013300
*                                                                     * 00013400
*    4.  The Connect token from the input classify parameter list     * 00013500
*        must be owned by the current home address space and must be  * 00013600
*        associated with a system key (0-7), as specified on IWMCONN. * 00013700
*        The Classify parameter list and hence the Connect token is   * 00013800
*        only relevant for TYPE=INDEPENDENT Enclaves.                 * 00013900
*                                                                     * 00014000
*    5.  Since this service may only be used by system-like code,     * 00014100
*        some validity checking on the parameter list is not          * 00014200
*        performed. These checks would only be needed if the macro    * 00014300
*        were not used to invoke the service routine.                 * 00014400
*                                                                     * 00014500
*    6.  The variable length fields associated with the classify      * 00014600
*        parameter list (the classify parameter list is only relevant * 00014700
*        for certain options) given by the CLSFY keyword have the     * 00014800
*        following limitations in addition to those documented in     * 00014900
*        IWMCLSFY:                                                    * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*        o   SUBSYSPM is limited to 255 bytes                         * 00015300
*                                                                     * 00015400
*        o   COLLECTION is limited to 18 bytes                        * 00015500
*                                                                     * 00015600
*        o   CORRELATION is limited to 12 bytes                       * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*                                                                     * 00016000
*    7.  When TYPE(MONENV) is specified the following apply:          * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*        o   If the key specified on IWMMCREA was a user key (8-F),   * 00016400
*            then primary or home addressability must exist to the    * 00016500
*            performance block IWMMCREA obtained.  This condition is  * 00016600
*            satisfied by ensuring that the current primary or home   * 00016700
*            address space matches primary (=home) at the time that   * 00016800
*            IWMMCREA was invoked.                                    * 00016900
*                                                                     * 00017000
*        o   The caller must serialize to prevent any delay           * 00017100
*            monitoring services from being invoked concurrently for  * 00017200
*            the environment represented by the monitoring token.     * 00017300
*                                                                     * 00017400
*        o   Only limited checking is done against the input          * 00017500
*            monitoring token.                                        * 00017600
*                                                                     * 00017700
*        o   TYPE=MONENV enclaves cannot be created for report-only   * 00017800
*            monitoring environments.                                 * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*    8.  This macro may only be used on OS/390 R12 or higher levels   * 00018300
*        for EXSTARTDEFER keyword.                                    * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*01* INPUT REGISTER INFORMATION:                                      * 00018800
*                                                                     * 00018900
*    Before issuing the IWMECREA macro, the caller does not have to   * 00019000
*    place any information into any register unless using it in       * 00019100
*    register notation for a particular parameter, or using it as a   * 00019200
*    base register.                                                   * 00019300
*                                                                     * 00019400
*01* OUTPUT REGISTER INFORMATION:                                     * 00019500
*                                                                     * 00019600
*    When control returns to the caller, the GPRs contain:            * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*    REGISTER  CONTENTS                                               * 00020000
*                                                                     * 00020100
*    0         Reason code if GR15 return code is non-zero            * 00020200
*                                                                     * 00020300
*    1         Used as work registers by the system                   * 00020400
*                                                                     * 00020500
*    2-13      Unchanged                                              * 00020600
*                                                                     * 00020700
*    14        Used as work registers by the system                   * 00020800
*                                                                     * 00020900
*    15        Return code                                            * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*    When control returns to the caller, the ARs contain:             * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*    REGISTER  CONTENTS                                               * 00021700
*                                                                     * 00021800
*    0-1       Used as work registers by the system                   * 00021900
*                                                                     * 00022000
*    2-13      Unchanged                                              * 00022100
*                                                                     * 00022200
*    14-15     Used as work registers by the system                   * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*    Some callers depend on register contents remaining the same      * 00022700
*    before and after issuing a service.  If the system changes the   * 00022800
*    contents of registers on which the caller depends, the caller    * 00022900
*    must save them before issuing the service, and restore them      * 00023000
*    after the system returns control.                                * 00023100
*                                                                     * 00023200
*01* PERFORMANCE IMPLICATIONS:                                        * 00023300
*                                                                     * 00023400
*    None                                                             * 00023500
*                                                                     * 00023600
*01* SYNTAX:                                                          * 00023700
*                                                                     * 00023800
*Ýxlabel¨  IWMECREA  ÐÝ TYPE=INDEPENDENT                              * 00023900
*                    !     ,CLSFY=xclsfy                              * 00024000
*                    !     ,ARRIVALTIME=xarrivaltime                  * 00024100
*                    !     ,FUNCTION_NAME=xfunction_name              * 00024200
*                    !   ÐÝ,EXSTARTDEFER=NO¨                          * 00024300
*                    !   ¿Ý,EXSTARTDEFER=YES¨                         * 00024400
*                    !   ÐÝ,ESTRT=IMPLIED                             * 00024500
*                    !   !    Ý,WORKREQ_HDL=xworkreq_hdl¨¨            * 00024600
*                    !   ÔÝ,ESTRT=EXPLICIT¨                           * 00024700
*                    !   ÔÝ,ESTRT=EXPLICIT_SINGLE¨                    * 00024800
*                    !   ¿Ý,ESTRT=NEVER¨¨                             * 00024900
*                    ÔÝ,TYPE=DEPENDENT¨                               * 00025000
*                    ¿Ý,TYPE=MONENV                                   * 00025100
*                          ,MONTKN=xmontkn                            * 00025200
*                        Ð ,ACCESS=PRIMARY                            * 00025300
*                        ¿ ,ACCESS=HOME¨                              * 00025400
*                      ,ETOKEN=xetoken                                * 00025500
*                     Ý,RETCODE=xretcode¨                             * 00025600
*                     Ý,RSNCODE=xrsncode¨                             * 00025700
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00025800
*                    ÐÝ,MF=S¨                                         * 00025900
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00026000
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
*      Where:                                                         * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*      Ýxlabel¨                                                       * 00026700
*          is an optional symbol, starting in column 1, that is the   * 00026800
*          name on the IWMECREA macro invocation.  The name must      * 00026900
*          conform to the rules for an ordinary assembler language    * 00027000
*          symbol.                                                    * 00027100
*          DEFAULT: No name.                                          * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*      ÝTYPE=»INDEPENDENT!DEPENDENT!MONENVº                           * 00027700
*          is an optional keyword input which indicates the type of   * 00027800
*          Enclave being created.                                     * 00027900
*          DEFAULT: INDEPENDENT                                       * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*          ÝTYPE=INDEPENDENT                                          * 00028300
*              indicates that the Enclave represents a new business   * 00028400
*              unit of work with its own business objectives.         * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*              CLSFY=xclsfy                                           * 00028800
*                  is the name (RS-type), or address in register      * 00028900
*                  (2)-(12), of a required character input which      * 00029000
*                  contains the classification information in the     * 00029100
*                  format of the parameter list for IWMCLSFY.  NOTE   * 00029200
*                  that this name is the data area name, not its      * 00029300
*                  pointer.  IWMCLSFY MF(M) should be used to         * 00029400
*                  initialize the area prior to invocation of         * 00029500
*                  IWMECREA.  The Classify parameter list must be     * 00029600
*                  from MVS/ESA SP5.2.0 or later.                     * 00029700
*                                                                     * 00029800
*                  Note that the variable length fields associated    * 00029900
*                  with the classify parameter list given by the      * 00030000
*                  CLSFY keyword have the following limitations in    * 00030100
*                  addition to those documented in IWMCLSFY:          * 00030200
*                                                                     * 00030300
*                                                                     * 00030400
*                  o   SUBSYSPM is limited to 255 bytes               * 00030500
*                                                                     * 00030600
*                  o   COLLECTION is limited to 18 bytes              * 00030700
*                                                                     * 00030800
*                  o   CORRELATION is limited to 12 bytes             * 00030900
*                                                                     * 00031000
*                                                                     * 00031100
*                                                                     * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*              ARRIVALTIME=xarrivaltime                               * 00031600
*                  is the name (RS-type), or address in register      * 00031700
*                  (2)-(12), of a required 64 bit input which         * 00031800
*                  contains the work arrival time in STCK format.     * 00031900
*                  This is the time at which the business work        * 00032000
*                  request is considered to have arrived and from     * 00032100
*                  which point the system evaluates elapsed time for  * 00032200
*                  the work request.                                  * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*              FUNCTION_NAME=xfunction_name                           * 00032800
*                  is the name (RS-type), or address in register      * 00032900
*                  (2)-(12), of a required 8 character input which    * 00033000
*                  contains the descriptive name for the function for * 00033100
*                  which the Enclave was created.                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*              ÝEXSTARTDEFER=»NO!YESº¨                                * 00033700
*                  is an optional keyword input which indicates       * 00033800
*                  whether the Enclave execution start time should    * 00033900
*                  begin when the first IWMSTBGN or IWMEJOIN is       * 00034000
*                  executed.  The time between enclave create and the * 00034100
*                  first IWMSTBGN or IWMEJOIN is assumed to be the    * 00034200
*                  queue time.                                        * 00034300
*                  DEFAULT: NO                                        * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                  ÝEXSTARTDEFER=NO¨                                  * 00034700
*                                                                     * 00034800
*                      indicates that the Enclave execution start     * 00034900
*                      time should not begin when the first IWMSTBGN  * 00035000
*                      or IWMEJOIN is executed.                       * 00035100
*                                                                     * 00035200
*                  ÝEXSTARTDEFER=YES¨                                 * 00035300
*                                                                     * 00035400
*                      indicates that the Enclave execution start     * 00035500
*                      time should begin when the first IWMSTBGN or   * 00035600
*                      IWMEJOIN is executed.                          * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*              ÝESTRT=»IMPLIED!EXPLICIT!EXPLICIT_SINGLE!NEVERº¨       * 00036400
*                  is an optional keyword input which denotes how the * 00036500
*                  work manager indicates the start and end point of  * 00036600
*                  an EWLM work request when participating in cross   * 00036700
*                  platform Enterprise Workload Management (EWLM).    * 00036800
*                  DEFAULT: IMPLIED                                   * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                  ÝESTRT=IMPLIED                                     * 00037200
*                      If the work manager previously connected to    * 00037300
*                      WLM with IWMCONN EWLM=YES, a work request is   * 00037400
*                      started implicitly when the enclave is         * 00037500
*                      created.  If IWMESTOP was not invoked before,  * 00037600
*                      the work request will be stopped implicitly    * 00037700
*                      when the enclave is deleted.                   * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                      ÝWORKREQ_HDL=xworkreq_hdl¨¨                    * 00038100
*                          is the name (RS-type), or address in       * 00038200
*                          register (2)-(12), of an optional 8        * 00038300
*                          character output that will receive the     * 00038400
*                          handle which represents the work request.  * 00038500
*                          The application must pass this handle to   * 00038600
*                          the other work request services IWMESTOP,  * 00038700
*                          IWMEBLK, IWMEUBLK, and IWMEGCOR.           * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                  ÝESTRT=EXPLICIT¨                                   * 00039200
*                      The work manager indicates the start and end   * 00039300
*                      point of an EWLM work request by invoking the  * 00039400
*                      services IWMESTRT and IWMESTOP. NOTE that this * 00039500
*                      option is only meaningful, if the work manager * 00039600
*                      previously connected to WLM with IWMCONN       * 00039700
*                      EWLM=YES.                                      * 00039800
*                                                                     * 00039900
*                  ÝESTRT=EXPLICIT_SINGLE¨                            * 00040000
*                      Same as option EXPLICIT above, but the         * 00040100
*                      application ensures, that only one work        * 00040200
*                      request is active (no nested calls to IWMESTRT * 00040300
*                      are allowed). If this option is specified the  * 00040400
*                      CPU consumption on all EWLM Enclave services   * 00040500
*                      (IWMEGCOR, IWMESTRT, IWMESTOP, IWMEBLK,        * 00040600
*                      IWMEUBLK) will be reduced.  If                 * 00040700
*                      ESTRT=EXPLICIT_SINGLE is specified on          * 00040800
*                      IWMECREA, the the application must also add    * 00040900
*                      the EWLMMODE=EXPLICIT_SINGLE parameter on all  * 00041000
*                      calls to IWMEGCOR, IWMESTRT, IWMESTOP, IWMEBLK * 00041100
*                      and IWMEUBLK. If this parameter is used, the   * 00041200
*                      application has some restrictions on all calls * 00041300
*                      to IWMEGCOR, IWMESTRT, IWMESTOP, IWMEBLK and   * 00041400
*                      IWMEUBLK (see the corresponding macro          * 00041500
*                      descriptions for details).                     * 00041600
*                                                                     * 00041700
*                  ÝESTRT=NEVER¨¨                                     * 00041800
*                      Indicates, that this enclave will never use    * 00041900
*                      any EWLM related enclave services (IWMEGCOR,   * 00042000
*                      IWMESTRT, IWMESTOP, IWMEBLK, IWMEUBLK) after   * 00042100
*                      the enclave has been created, even if the work * 00042200
*                      manager has registered (IWM4CON or IWMCONN)    * 00042300
*                      with EWLM=YES.                                 * 00042400
*                      Moreover IWMECREA will not start an EWLM work  * 00042500
*                      request on the enclave and will not do any     * 00042600
*                      EWLM related processing.                       * 00042700
*                                                                     * 00042800
*                                                                     * 00042900
*                                                                     * 00043000
*                                                                     * 00043100
*                                                                     * 00043200
*          ÝTYPE=DEPENDENT¨                                           * 00043300
*              indicates that the Enclave represents a continuation   * 00043400
*              of the business unit of work represented by the        * 00043500
*              current home address space.                            * 00043600
*                                                                     * 00043700
*          ÝTYPE=MONENV                                               * 00043800
*              indicates that the Enclave represents a continuation   * 00043900
*              of the business unit of work represented by the input  * 00044000
*              management monitoring environment.  TYPE=MONENV        * 00044100
*              enclaves cannot be created for report-only monitoring  * 00044200
*              environments.                                          * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*              MONTKN=xmontkn                                         * 00044600
*                  is the name (RS-type), or address in register      * 00044700
*                  (2)-(12), of a required 32 bit input which         * 00044800
*                  contains the delay monitoring token which          * 00044900
*                  describes the current business unit of work.  If   * 00045000
*                  the monitoring environment is related to an        * 00045100
*                  address space, then it must be the current home    * 00045200
*                  address space.                                     * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*                                                                     * 00045600
*                                                                     * 00045700
*              ACCESS=»PRIMARY!HOMEº¨                                 * 00045800
*                  is a required keyword input which describes how to * 00045900
*                  access the monitoring environment.                 * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*                  ACCESS=PRIMARY                                     * 00046300
*                                                                     * 00046400
*                      indicates that the monitoring environment can  * 00046500
*                      be accessed in the caller's primary address    * 00046600
*                      space.  This would be appropriate if the       * 00046700
*                      monitoring environment was established (by     * 00046800
*                      IWMMCREA) to be used by routines in a specific * 00046900
*                      system key or if it was established to be used * 00047000
*                      in a specific user key in the current primary. * 00047100
*                                                                     * 00047200
*                  ACCESS=HOME¨                                       * 00047300
*                                                                     * 00047400
*                      indicates that the monitoring environment must * 00047500
*                      be accessed in the home address space, which   * 00047600
*                      is not the caller's primary address space.     * 00047700
*                      This would be appropriate if the monitoring    * 00047800
*                      environment was established (by IWMMCREA) for  * 00047900
*                      use by a specific user key.                    * 00048000
*                                                                     * 00048100
*                                                                     * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*                                                                     * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*      ETOKEN=xetoken                                                 * 00049100
*          is the name (RS-type), or address in register (2)-(12), of * 00049200
*          a required 8 character output which will receive the       * 00049300
*          Enclave token.                                             * 00049400
*                                                                     * 00049500
*                                                                     * 00049600
*                                                                     * 00049700
*                                                                     * 00049800
*      ÝRETCODE=xretcode¨                                             * 00049900
*          is the name (RS-type) of an optional fullword output       * 00050000
*          variable, or register (2)-(12), into which the return code * 00050100
*          is to be copied from GPR 15.                               * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*                                                                     * 00050500
*                                                                     * 00050600
*      ÝRSNCODE=xrsncode¨                                             * 00050700
*          is the name (RS-type) of an optional fullword output       * 00050800
*          variable, or register (2)-(12), into which the reason code * 00050900
*          is to be copied from GPR 0.                                * 00051000
*                                                                     * 00051100
*                                                                     * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00051500
*          is an optional byte input decimal value in the "0-3" range * 00051600
*          that specifies the macro version.  PLISTVER is the only    * 00051700
*          key allowed on the list form of MF and determines which    * 00051800
*          parameter list is generated.  The macro keys associated    * 00051900
*          with each supported version of the macro are listed in     * 00052000
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00052100
*          instead of a number, and the parameter list will be of the * 00052200
*          largest size currently supported. This size may grow from  * 00052300
*          release to release (thus possibly affecting the amount of  * 00052400
*          storage needed by your program).  If your program can      * 00052500
*          tolerate this, IBM recommends that you always specify MAX  * 00052600
*          when creating the list form parameter list as that will    * 00052700
*          ensure that the list form parameter list is always long    * 00052800
*          enough to hold whatever parameters might be specified on   * 00052900
*          the execute form.                                          * 00053000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00053100
*          default is the lowest version which allows all of the      * 00053200
*          parameters specified on the invocation to be processed.    * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*      ÝMF=»S!L!Eº¨                                                   * 00053800
*          is an optional keyword input which specifies the macro     * 00053900
*          form.                                                      * 00054000
*          DEFAULT: S                                                 * 00054100
*                                                                     * 00054200
*                                                                     * 00054300
*          ÝMF=S¨                                                     * 00054400
*              specifies the standard form of the macro.  The "S"     * 00054500
*              form generates code to put the parameters into an      * 00054600
*              in-line parameter list and invoke the desired service. * 00054700
*              Full checking for required macro keys is done along    * 00054800
*              with supplying defaults for omitted optional           * 00054900
*              parameters.                                            * 00055000
*                                                                     * 00055100
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00055200
*              specifies the list form of the macro.  The "L" form    * 00055300
*              defines an area to be used for the parameter list.     * 00055400
*              Only the PLISTVER key may be specified on the          * 00055500
*              invocation.  All other macro parameters are flagged as * 00055600
*              errors.  If PLISTVER is not specified, the original    * 00055700
*              parameter list definition is used.                     * 00055800
*                                                                     * 00055900
*            ,xmfctrl                                                 * 00056000
*              is a required input.  It is the name of a storage area * 00056100
*              for the parameter list.                                * 00056200
*                                                                     * 00056300
*            »,xmfattr!0Dº                                            * 00056400
*              is an optional 60 character input string that varies   * 00056500
*              from 1 to 60 characters. Use it to force boundary      * 00056600
*              alignment of the parameter list. Use only 0F or 0D.    * 00056700
*              DEFAULT: 0D which forces the parameter list to a       * 00056800
*              doubleword boundary.                                   * 00056900
*                                                                     * 00057000
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00057100
*              specifies the execute form of the macro.  The "E" form * 00057200
*              generates code to put the parameters into the          * 00057300
*              parameter list specified by xmfctrl and provides full  * 00057400
*              syntax checking with default setting.                  * 00057500
*                                                                     * 00057600
*            ,xmfctrl                                                 * 00057700
*              is a required input.  It is the name (RS-type), or     * 00057800
*              address in register (1)-(12), of a storage area for    * 00057900
*              the parameter list.                                    * 00058000
*                                                                     * 00058100
*            »,COMPLETEº                                              * 00058200
*              is an optional keyword input which specifies the       * 00058300
*              degree of macro parameter syntax checking.             * 00058400
*              DEFAULT: COMPLETE                                      * 00058500
*                                                                     * 00058600
*                                                                     * 00058700
*              COMPLETE                                               * 00058800
*                  Checking for required macro keys is done and       * 00058900
*                  defaults are supplied for omitted optional         * 00059000
*                  parameters.                                        * 00059100
*                                                                     * 00059200
*                                                                     * 00059300
*                                                                     * 00059400
*                                                                     * 00059500
*                                                                     * 00059600
*                                                                     * 00059700
*                                                                     * 00059800
*01* ABEND CODES:  None.                                              * 00059900
*                                                                     * 00060000
*01* RETURN CODES:                                                    * 00060100
*                                                                     * 00060200
*                                                                     * 00060300
*            0    Name: IwmRetCodeOk                                  * 00060400
*                                                                     * 00060500
*                 Meaning: Successful completion.                     * 00060600
*                                                                     * 00060700
*                 Action: None required.                              * 00060800
*                                                                     * 00060900
*            8    Name: IwmRetCodeInvocError                          * 00061000
*                                                                     * 00061100
*                 Meaning: Invalid invocation environment or          * 00061200
*                 parameters.                                         * 00061300
*                                                                     * 00061400
*                                                                     * 00061500
*                 HEX REASON  MEANING/ACTION                          * 00061600
*                 CODE                                                * 00061700
*                                                                     * 00061800
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00061900
*                                                                     * 00062000
*                             Meaning: Caller is disabled.            * 00062100
*                                                                     * 00062200
*                             Action: Avoid requesting this function  * 00062300
*                             while disabled.                         * 00062400
*                                                                     * 00062500
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00062600
*                                                                     * 00062700
*                             Meaning: Caller is locked.              * 00062800
*                                                                     * 00062900
*                             Action: Avoid requesting this function  * 00063000
*                             while locked.                           * 00063100
*                                                                     * 00063200
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00063300
*                                                                     * 00063400
*                             Meaning:  Error accessing parameter     * 00063500
*                             list.                                   * 00063600
*                                                                     * 00063700
*                             Action: Check for possible storage      * 00063800
*                             overlay.  Also check if you call this   * 00063900
*                             macro in 64 bit adressing mode (see     * 00064000
*                             explanations for xxxx089E).             * 00064100
*                                                                     * 00064200
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00064300
*                                                                     * 00064400
*                             Meaning:  Monitoring environment does   * 00064500
*                             not pass short form verification.       * 00064600
*                                                                     * 00064700
*                             Action: Check for possible storage      * 00064800
*                             overlay.                                * 00064900
*                                                                     * 00065000
*                 xxxx0821    Name: IwmRsnCodeBadConn                 * 00065100
*                                                                     * 00065200
*                             Meaning:  Connect token from the input  * 00065300
*                             classify parameter list does not pass   * 00065400
*                             validity checking.                      * 00065500
*                                                                     * 00065600
*                             Action: Check for possible storage      * 00065700
*                             overlay.                                * 00065800
*                                                                     * 00065900
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 00066000
*                                                                     * 00066100
*                             Meaning: Caller invoked service but was * 00066200
*                             in 24 bit addressing mode.              * 00066300
*                                                                     * 00066400
*                             Action: Request this function only when * 00066500
*                             you are in 31 bit addressing mode.      * 00066600
*                                                                     * 00066700
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00066800
*                                                                     * 00066900
*                             Meaning: Version number in parameter    * 00067000
*                             list is not valid.                      * 00067100
*                                                                     * 00067200
*                             Action: Check for possible storage      * 00067300
*                             overlay of the parameter list.          * 00067400
*                                                                     * 00067500
*                 xxxx0836    Name: IwmRsnCodeMaxEnclave              * 00067600
*                                                                     * 00067700
*                             Meaning:  Enclave could not be created  * 00067800
*                             because the Enclave limit has been      * 00067900
*                             reached.                                * 00068000
*                                                                     * 00068100
*                             Action: Check for possible problems     * 00068200
*                             wherein Enclaves are not being deleted  * 00068300
*                             as expected or excessive numbers of     * 00068400
*                             Enclaves are being created in a loop.   * 00068500
*                                                                     * 00068600
*                 xxxx0837    Name: IwmRsnCodeUserKeyConntkn          * 00068700
*                                                                     * 00068800
*                             Meaning:  Connect token from the input  * 00068900
*                             classify parameter list is associated   * 00069000
*                             with a user key.                        * 00069100
*                                                                     * 00069200
*                             Action: Invoke the function with a      * 00069300
*                             token associated with a system key.     * 00069400
*                                                                     * 00069500
*                 xxxx0838    Name: IwmRsnCodeClsfyAreaTooBig         * 00069600
*                                                                     * 00069700
*                             Meaning:  Input area associated with    * 00069800
*                             classification information is larger    * 00069900
*                             than supported.                         * 00070000
*                                                                     * 00070100
*                             Action: Invoke the function with an     * 00070200
*                             area of the proper size.  Check for     * 00070300
*                             possible storage overlay.               * 00070400
*                                                                     * 00070500
*                 xxxx0839    Name: IwmRsnCodeClsfyPlTooSmall         * 00070600
*                                                                     * 00070700
*                             Meaning:  Input Classify parameter list * 00070800
*                             is too small.                           * 00070900
*                                                                     * 00071000
*                             Action: Invoke the function with an     * 00071100
*                             area of the proper size.  Check for     * 00071200
*                             possible storage overlay.               * 00071300
*                                                                     * 00071400
*                 xxxx083B    Name: IwmRsnCodeHomeNotOwnConn          * 00071500
*                                                                     * 00071600
*                             Meaning:  Home address space does not   * 00071700
*                             own the connect token from the input    * 00071800
*                             classify parameter list.                * 00071900
*                                                                     * 00072000
*                             Action: Invoke the function with the    * 00072100
*                             correct home address space.             * 00072200
*                                                                     * 00072300
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 00072400
*                                                                     * 00072500
*                             Meaning:  Caller's space connection is  * 00072600
*                             not enabled for this service.           * 00072700
*                                                                     * 00072800
*                             Action: Avoid requesting this function  * 00072900
*                             under the input connection.  IWMCONN    * 00073000
*                             options must be specified previously to * 00073100
*                             enable this service.                    * 00073200
*                                                                     * 00073300
*                 xxxx085D    Name: IwmRsnCodeMonenvNotHome           * 00073400
*                                                                     * 00073500
*                             Meaning:  The input monitoring          * 00073600
*                             environment is related to an address    * 00073700
*                             space other than home.                  * 00073800
*                                                                     * 00073900
*                             Action: None required.                  * 00074000
*                                                                     * 00074100
*                 xxxx0894    Name: IwmRsnCodeInvalidEWLMCorr         * 00074200
*                                                                     * 00074300
*                             Meaning: Passed classification          * 00074400
*                             information contains an ARM correlator  * 00074500
*                             (EWLM_CORR) that does not pass validity * 00074600
*                             checking.  The architected ARM          * 00074700
*                             correlator length field in the first    * 00074800
*                             two Bytes of the EWLM_CORR is either    * 00074900
*                             less than 4 ('0004'x) or greater than   * 00075000
*                             512 ('0200'x).                          * 00075100
*                                                                     * 00075200
*                             Action: Check the specification of the  * 00075300
*                             EWLM correlator in the classification   * 00075400
*                             information.                            * 00075500
*                                                                     * 00075600
*                 xxxx0895    Name: IwmRsnCodeEWLMServNotEnabled      * 00075700
*                                                                     * 00075800
*                             Meaning: Service is not enabled because * 00075900
*                             caller invoked the IWMCONN service with * 00076000
*                             EWLM=NO.                                * 00076100
*                                                                     * 00076200
*                             Action: Specify the parameter           * 00076300
*                             WORKREQ_HDL only when connected with    * 00076400
*                             EWLM=YES.                               * 00076500
*                                                                     * 00076600
*                 xxxx089E    Name: IwmRsnCodeServiceAModeMismatch    * 00076700
*                                                                     * 00076800
*                             Meaning:  The caller works in 64-bit    * 00076900
*                             address mode and tried to invoke a      * 00077000
*                             service macro that is only enabled for  * 00077100
*                             a 31-bit address environment.           * 00077200
*                                                                     * 00077300
*                             Action:  Use the 64-bit enabled service * 00077400
*                             macro (IWM4ECRE) or change the          * 00077500
*                             addressing mode of the caller to        * 00077600
*                             31-bit.                                 * 00077700
*                                                                     * 00077800
*                                                                     * 00077900
*                                                                     * 00078000
*            C    Name: IwmRetCodeEnvError                            * 00078100
*                                                                     * 00078200
*                 Meaning: Environmental error.                       * 00078300
*                                                                     * 00078400
*                                                                     * 00078500
*                 HEX REASON  MEANING/ACTION                          * 00078600
*                 CODE                                                * 00078700
*                                                                     * 00078800
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 00078900
*                                                                     * 00079000
*                             Meaning:  Storage is not available for  * 00079100
*                             the request.                            * 00079200
*                                                                     * 00079300
*                             Action: There is a storage shortage.    * 00079400
*                             The function may work successfully at a * 00079500
*                             later time.                             * 00079600
*                                                                     * 00079700
*                 xxxx0C0C    Name: IwmRsnCodeClassifyFail            * 00079800
*                                                                     * 00079900
*                             Meaning:  Received a non-zero return    * 00080000
*                             code from the classification service,   * 00080100
*                             IWMCLSFY.                               * 00080200
*                                                                     * 00080300
*                             Action: No action required.  Reinvoking * 00080400
*                             the function later may succeed.         * 00080500
*                                                                     * 00080600
*                 xxxx0C0D    Name: IwmRsnCodeBadClsfy                * 00080700
*                                                                     * 00080800
*                             Meaning:  Classification apparently can * 00080900
*                             not access the current policy,          * 00081000
*                             possibly due to a policy switch in      * 00081100
*                             progress.                               * 00081200
*                                                                     * 00081300
*                             Action: Invoke the function when the    * 00081400
*                             conditions are alleviated.              * 00081500
*                                                                     * 00081600
*                 xxxx0C20    Name: IwmRsnCodeDepClassifyFail         * 00081700
*                                                                     * 00081800
*                             Meaning:  Unable to obtain              * 00081900
*                             classification attributes for a         * 00082000
*                             dependent enclave.                      * 00082100
*                                                                     * 00082200
*                             Action: None required.                  * 00082300
*                                                                     * 00082400
*                 xxxx0C21    Name: IwmRsnCodeNoMonEnvErr             * 00082500
*                                                                     * 00082600
*                             Meaning:  Input monitoring token        * 00082700
*                             indicates no monitoring environment was * 00082800
*                             established.                            * 00082900
*                                                                     * 00083000
*                             Action: None required.                  * 00083100
*                                                                     * 00083200
*                                                                     * 00083300
*                                                                     * 00083400
*            10   Name: IwmRetCodeCompError                           * 00083500
*                                                                     * 00083600
*                 Meaning: Component error.                           * 00083700
*                                                                     * 00083800
*                 Action: No action required.  The function may be    * 00083900
*                 successful if invoked again.                        * 00084000
*                                                                     * 00084100
*                                                                     * 00084200
*                                                                     * 00084300
*01* REASON CODES:                                                    * 00084400
*                                                                     * 00084500
*       A unique reason code will be returned whenever the return     * 00084600
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00084700
*       under their corresponding return code.  Reason code and       * 00084800
*       return code constants are defined within IWMYCON.  Note that  * 00084900
*       the high order halfword of register 0, and the reason code    * 00085000
*       variable when specified, may be non-zero and represents       * 00085100
*       diagnostic data which is NOT part of the external interface.  * 00085200
*       The high order halfword should thus be excluded from          * 00085300
*       comparison with the reason code values described above.  The  * 00085400
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00085500
*       used for this purpose.                                        * 00085600
*                                                                     * 00085700
*01* MODULE TYPE:  ASSEM MACRO                                        * 00085800
*                                                                     * 00085900
*02*   PROCESSOR:  ASSEM                                              * 00086000
*                                                                     * 00086100
*01* COMPONENT:  SCWLM                                                * 00086200
*                                                                     * 00086300
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00086400
*                                                                     * 00086500
*01* EXAMPLES:                                                        * 00086600
*                                                                     * 00086700
*01* MACRO USAGE NOTES:                                               * 00086800
*                                                                     * 00086900
*                                                                     * 00087000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00087100
*        global macro variable.  Any value other than 'NO' will       * 00087200
*        result in the macro expansion being printed.  The default is * 00087300
*        'YES'.  The following examples illustrate how the ZPRINT     * 00087400
*        variable should be set.                                      * 00087500
*                                                                     * 00087600
*                    GBLC &ZPRINT                                     * 00087700
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00087800
*                                                                     * 00087900
*                                                                     * 00088000
*    2.  The IWMECREA macro supports multiple versions. The macro key * 00088100
*        list  below  contains the version level in which the key was * 00088200
*        first  introduced.  Positionals  are  identified by the word * 00088300
*        'Positional'  followed by the numeric value of its position. * 00088400
*        Nested  positionals  are  preceded  by their outer key.  The * 00088500
*        lowest value represents the original version and the highest * 00088600
*        value  represents  the  most  recent version of the IWMECREA * 00088700
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00088800
*        least  as high as the highest version number of all the keys * 00088900
*        being used.                                                  * 00089000
*                                                                     * 00089100
*        VERSION   KEY                                                * 00089200
*                                                                     * 00089300
*              0      ARRIVALTIME                                     * 00089400
*                     CLSFY                                           * 00089500
*                     ETOKEN                                          * 00089600
*                     FUNCTION_NAME                                   * 00089700
*              1      ACCESS                                          * 00089800
*                     MONTKN                                          * 00089900
*                     TYPE                                            * 00090000
*              2      EXSTARTDEFER                                    * 00090100
*              3      ESTRT                                           * 00090200
*                     WORKREQ_HDL                                     * 00090300
*                                                                     * 00090400
*                                                                     * 00090500
*                                                                     * 00090600
*01* CHANGE ACTIVITY:                                                 * 00090700
*                                                                     * 00090800
*   Flag LineItem  FMID    Date   ID    Comment                       * 00090900
*                                                                     * 00091000
*    $L0=ENCLV    HBB5520 940103 PD16:  Enclave Create                * 00091100
*    $L1=WLMP     HBB6603 950127 PDDE:  Business Unit-of-Work         * 00091200
*                                         Management                  * 00091300
*    $L2=WLMPAPC  HBB7705 001031 3241AB:  Application Contexts        * 00091400
*    $L3=WLMPELM  HBB7708 020909 3241SW:  Enterprise Workload         * 00091500
*                                         Management (EWLM) support   * 00091600
*    $L4=PYN0804  HBB7708 021210 3241SW:  Added new reason code       * 00091700
*                                         IwmRsnCodeEWLMServNotEnable * 00091800
*                                         d                           * 00091900
*    $L5=WLMP64W  HBB7709 030315 3241NN:  IWM4ECRE created. Please do * 00092000
*                                         not change this macro any   * 00092100
*                                         longer.                     * 00092200
*    $L6=ME01430  HBB7709 040923 3241SW:  Removed xxxxRRRR reason     * 00092300
*                                         code.                       * 00092400
*    $P1=ME02076  HBB7720 041015 3241NN:  Added reason code for       * 00092500
*                                         callers in AMODE 64.        * 00092600
*                                         Specific to 31-bit version. * 00092700
*    $P2=WLMPEFP  HBB7709 050504 3241GB:  EWLM Enclave Fastpath       * 00092800
*                                         Processing                  * 00092900
*                                         (ESTRT=EXPLICIT_SINGLE/NEVE * 00093000
*                                         R).                         * 00093100
*    $P3=BLDCHKE  HBB7730 050919 3241BH:  No code change. ToolReq     * 00093200
*                                         5983 -                      * 00093300
*                                         B390.HBB7730.DRIVER5A.OC    * 00093400
*                                         OCHKE fixes.                * 00093500
****** END OF SPECIFICATIONS *****************************************/ 00093600
*/********************************************************************* 00093700
         MACRO                                                          00093800
&XLABEL  IWMECREA &TYPE=,&CLSFY=,&ARRIVALTIME=,&FUNCTION_NAME=,        *00093900
               &EXSTARTDEFER=,&ESTRT=,&WORKREQ_HDL=,&MONTKN=,&ACCESS=, *00094000
               &ETOKEN=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=             00094100
.*                                                                      00094200
*                     MACDATE -09/23/05-<3>                             00094300
.*                                                                      00094400
.*******************************************************************    00094500
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00094600
.*******************************************************************    00094700
                     GBLC  &ZPRINT     YES=PRINT NO=NO PRINT            00094800
                     GBLC  &ZTEST      YES=TEST NO=NO TEST              00094900
                     GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX      00095000
.*                                                                      00095100
                     GBLC  &ZIWMECREA  YES=MACRO USED AT LEAST ONCE     00095200
.*******************************************************************    00095300
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00095400
.*******************************************************************    00095500
                     LCLC  &ZMS        ERROR MESSAGE WORK AREA          00095600
                     LCLC  &ZCNDX      SYSNDX CHARACTERS                00095700
                     LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED       00095800
                     LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR      00095900
                     LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE      00096000
                     LCLA  &ZAWRK      USED AS A WORK AREA              00096100
                     LCLA  &ZASIZ      USED FOR SIZE OF VALUE           00096200
                     LCLA  &ZN         NUMERIC WORK VARIABLE            00096300
                     LCLC  &ZC         CHARACTER WORK VARIABLE          00096400
                     LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE      00096500
                     LCLA  &ZTLA       VALUE TOO LONG VARIABLE          00096600
                     LCLC  &ZMAC_G     "G" or null                      00096700
&ZMAC_G              SETC  ''                                           00096800
                     LCLC  &ZMAC_LR                                     00096900
&ZMAC_LR             SETC  'LR'                                         00097000
                     LCLC  &ZMAC_L                                      00097100
&ZMAC_L              SETC  'L'                                          00097200
                     LCLC  &ZMAC_ST                                     00097300
&ZMAC_ST             SETC  'ST'                                         00097400
                     LCLA  &ZMACRET    MACRO RETURN CODE                00097500
&ZMACRET             SETA  0           ASSUME NO ERRORS                 00097600
.*                                                                      00097700
                     LCLC  &ZCSYSLIST(255)      NONXKEY, POS ARRAY      00097800
                     LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()       00097900
                     LCLA  &ZPLLEN     PARAMETER LIST LENGTH            00098000
                     LCLC  &ZENDBASEPL          End of base PL          00098100
                     LCLA  &ZPLWORKA   PARAMETER LIST LENGTH            00098200
.*******************************************************************    00098300
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00098400
.*******************************************************************    00098500
                     LCLA  &ZI         INDEX FOR ARRAY                  00098600
                     LCLA  &ZJ         INDEX FOR PARMS                  00098700
                     LCLA  &ZK         INDEX FOR PARSE                  00098800
                     LCLA  &ZLO        LOW RANGE VALUE                  00098900
                     LCLA  &ZHI        HIGH RANGE VALUE                 00099000
                     LCLC  &ZW         WORK AREA FOR PARM               00099100
.********************************************************************   00099200
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00099300
.********************************************************************   00099400
                     GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL          00099500
                     GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE   00099600
                     GBLA  &SYSALVL    SYSSTATE ARCHLVL                 00099700
                     GBLC  &SYSAM64    SYSSTATE AMODE64                 00099800
.*                                                                      00099900
                     AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED   00100000
                     AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED    00100100
                     SPLEVEL  TEST                                      00100200
.ZSYS2               ANOP  ,                                            00100300
                     AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1        00100400
                     AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1        00100500
                     SYSSTATE TEST                                      00100600
                     AGO   .ZSYS4                                       00100700
.ZSYS3               ANOP  ,                                            00100800
&SYSASCE             SETC  'P'         ASSUME SYSSTATE PRIMARY          00100900
.ZSYS4               ANOP  ,                                            00101000
.*******************************************************************    00101100
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00101200
.*******************************************************************    00101300
                     LCLC  &XTYPE      ++ VALUE                         00101400
                     LCLC  &XCLSFY     ++ NAME                          00101500
                     LCLC  &XARRIVALTIME        ++ NAME                 00101600
                     LCLC  &XFUNCTION_NAME      ++ NAME                 00101700
                     LCLC  &XEXSTARTDEFER       ++ VALUE                00101800
                     LCLC  &XESTRT     ++ VALUE                         00101900
                     LCLC  &XWORKREQ_HDL        ++ NAME                 00102000
                     LCLC  &XMONTKN    ++ NAME                          00102100
                     LCLC  &XACCESS    ++ VALUE                         00102200
                     LCLC  &XETOKEN    ++ NAME                          00102300
                     LCLC  &XRETCODE   ++ NAME                          00102400
                     LCLC  &XRSNCODE   ++ NAME                          00102500
                     LCLA  &XPLISTVER  ++ VALUE                         00102600
                     LCLC  &XMF        ++ VALUE                         00102700
                     LCLC  &XMFCTRL    ++ NAME                          00102800
                     LCLC  &XMFATTR    ++ VALUE                         00102900
                     LCLC  &XMFSCK     ++ VALUE                         00103000
.*******************************************************************    00103100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00103200
.*******************************************************************    00103300
                     LCLC  &ZXTYPE     ++ INPUT VALUE                   00103400
                     LCLC  &ZXCLSFY    ++ INPUT NAME                    00103500
                     LCLC  &ZXARRIVALTIME       ++ INPUT NAME           00103600
                     LCLC  &ZXFUNCTION_NAME     ++ INPUT NAME           00103700
                     LCLC  &ZXEXSTARTDEFER      ++ INPUT VALUE          00103800
                     LCLC  &ZXESTRT    ++ INPUT VALUE                   00103900
                     LCLC  &ZXWORKREQ_HDL       ++ OUTPUT NAME          00104000
                     LCLC  &ZXMONTKN   ++ INPUT NAME                    00104100
                     LCLC  &ZXACCESS   ++ INPUT VALUE                   00104200
                     LCLC  &ZXETOKEN   ++ OUTPUT NAME                   00104300
                     LCLC  &ZXRETCODE  ++ OUTPUT NAME                   00104400
                     LCLC  &ZXRSNCODE  ++ OUTPUT NAME                   00104500
                     LCLC  &ZXPLISTVER          ++ INPUT VALUE          00104600
                     LCLC  &ZXMF       ++ INPUT VALUE                   00104700
                     LCLC  &ZXMFCTRL   ++ INPUT NAME                    00104800
                     LCLC  &ZXMFATTR   ++ INPUT VALUE                   00104900
                     LCLC  &ZXMFSCK    ++ INPUT VALUE                   00105000
.********************************************************************   00105100
.***AC.PLV01  PROCESS PLISTVER                                      *   00105200
.********************************************************************   00105300
&XPLISTVER      SETA  0                                                 00105400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00105500
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00105600
&XPLISTVER      SETA  3                                                 00105700
.ZPLV0          ANOP  ,                                                 00105800
.*                                                                      00105900
                AIF   ('&TYPE' EQ '').ZPLV1E                            00106000
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00106100
&XPLISTVER      SETA  1                                                 00106200
.ZPLV1E         ANOP  ,                                                 00106300
.*                                                                      00106400
                AIF   ('&EXSTARTDEFER' EQ '').ZPLV2E                    00106500
                AIF   (&XPLISTVER GE 2).ZPLV2E                          00106600
&XPLISTVER      SETA  2                                                 00106700
.ZPLV2E         ANOP  ,                                                 00106800
.*                                                                      00106900
                AIF   ('&ESTRT' EQ '').ZPLV3E                           00107000
                AIF   (&XPLISTVER GE 3).ZPLV3E                          00107100
&XPLISTVER      SETA  3                                                 00107200
.ZPLV3E         ANOP  ,                                                 00107300
.*                                                                      00107400
                AIF   ('&WORKREQ_HDL' EQ '').ZPLV4E                     00107500
                AIF   (&XPLISTVER GE 3).ZPLV4E                          00107600
&XPLISTVER      SETA  3                                                 00107700
.ZPLV4E         ANOP  ,                                                 00107800
.*                                                                      00107900
                AIF   ('&MONTKN' EQ '').ZPLV5E                          00108000
                AIF   (&XPLISTVER GE 1).ZPLV5E                          00108100
&XPLISTVER      SETA  1                                                 00108200
.ZPLV5E         ANOP  ,                                                 00108300
.*                                                                      00108400
                AIF   ('&ACCESS' EQ '').ZPLV6E                          00108500
                AIF   (&XPLISTVER GE 1).ZPLV6E                          00108600
&XPLISTVER      SETA  1                                                 00108700
.ZPLV6E         ANOP  ,                                                 00108800
.*                                                                      00108900
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00109000
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00109100
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00109200
.*-------------------------------------------------------------------   00109300
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00109400
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00109500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00109600
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00109700
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00109800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00109900
                AGO   .ZPVCK2                                           00110000
.ZPVCK3         ANOP  ,                                                 00110100
.*-------------------------------------------------------------------   00110200
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00110300
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00110400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00110500
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00110600
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00110700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00110800
                AGO   .ZPVCKE                                           00110900
.ZPVCK2         ANOP  ,                                                 00111000
.*-------------------------------------------------------------------   00111100
&ZCVAL          SETC  '&PLISTVER(1)'                                    00111200
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00111300
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00111400
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00111500
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00111600
                AIF   (&ZN LE 3).ZPVCK4A   NOT HIGH                     00111700
.ZPVCK6         ANOP  ,                                                 00111800
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00111900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00112000
&ZMS            SETC  '&ZMS THE RANGE IS "0-3"'                         00112100
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00112200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00112300
&XPLISTVER      SETA  3                                                 00112400
                AGO   .ZPVCKE                                           00112500
.*-------------------------------------------------------------------   00112600
.ZPVCK4A        ANOP  ,                                                 00112700
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00112800
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00112900
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00113000
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00113100
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00113200
                MNOTE 8,' &ZMS IS REQUIRED.'                            00113300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00113400
                AGO   .ZPVCK5                                           00113500
.ZPVCK4         ANOP  ,                                                 00113600
&XPLISTVER      SETA  &PLISTVER(1)                                      00113700
.ZPVCK5         ANOP  ,                                                 00113800
.ZPVCKE         ANOP  ,                                                 00113900
.********************************************************************   00114000
.***AG.MF01 PROCESS MF MACRO FORMS                                      00114100
.********************************************************************   00114200
                     ACTR  10000                                        00114300
.*------------------------------------------------------------------    00114400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114500
&XMF                 SETC  ''          INITIALIZE XVARIABLE             00114600
.*-------------------------------------------------------------------   00114700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114800
.ZG53                ANOP  ,                                            00114900
&ZTLC                SETC 'S'                                           00115000
                     AIF   ('&MF(1)' NE '&ZTLC').ZG54                   00115100
&XMF                 SETC  'S'         SET KEYWORD                      00115200
                     AIF   (N'&MF LE 1).ZG53A   CK NUM                  00115300
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00115400
&ZMS                 SETC  '&ZMS.&MF"'                                  00115500
&ZMS                 SETC  '&ZMS "MF"'                                  00115600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00115700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00115800
.ZG53A               ANOP  ,                                            00115900
.*-------------------------------------------------------------------   00116000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00116100
.ZG54                ANOP  ,                                            00116200
&ZTLC                SETC 'L'                                           00116300
                     AIF   ('&MF(1)' NE '&ZTLC').ZG61                   00116400
&XMF                 SETC  'L'         SET KEYWORD                      00116500
                     AIF   (N'&MF LE 3).ZG54A   CK NUM                  00116600
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00116700
&ZMS                 SETC  '&ZMS.&MF"'                                  00116800
&ZMS                 SETC  '&ZMS "MF"'                                  00116900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00117000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00117100
.ZG54A               ANOP  ,                                            00117200
.*-------------------------------------------------------------------   00117300
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00117400
                     AIF   (N'&SYSLIST NE 0).ZG54B  POSITIONALS?        00117500
                     AIF   ('&TYPE' NE '').ZG54B  KEYS?                 00117600
                     AIF   ('&CLSFY' NE '').ZG54B  KEYS?                00117700
                     AIF   ('&ARRIVALTIME' NE '').ZG54B  KEYS?          00117800
                     AIF   ('&FUNCTION_NAME' NE '').ZG54B  KEYS?        00117900
                     AIF   ('&EXSTARTDEFER' NE '').ZG54B  KEYS?         00118000
                     AIF   ('&ESTRT' NE '').ZG54B  KEYS?                00118100
                     AIF   ('&WORKREQ_HDL' NE '').ZG54B  KEYS?          00118200
                     AIF   ('&MONTKN' NE '').ZG54B  KEYS?               00118300
                     AIF   ('&ACCESS' NE '').ZG54B  KEYS?               00118400
                     AIF   ('&ETOKEN' NE '').ZG54B  KEYS?               00118500
                     AIF   ('&RETCODE' NE '').ZG54B  KEYS?              00118600
                     AIF   ('&RSNCODE' NE '').ZG54B  KEYS?              00118700
                     AGO    .ZG54C     INVOCATION OKAY                  00118800
.ZG54B               ANOP  ,                                            00118900
&ZMS                 SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE         00119000
&ZMS                 SETC  '&ZMS CAN ONLY HAVE'                         00119100
&ZMS                 SETC  '&ZMS THE "PLISTVER" KEY'                    00119200
                     MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'       00119300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00119400
.ZG54C               ANOP  ,                                            00119500
.*-------------------------------------------------------------------   00119600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00119700
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00119800
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00119900
                     AIF   (N'&MF(2) GT 1).ZG56B  MULTI PARMS           00120000
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00120100
.ZG56B               AIF   (K'&MF(2) GT 0).ZG56C                        00120200
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00120300
&ZMS                 SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*             00120400
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00120500
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00120600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00120700
.ZG56C               ANOP  ,                                            00120800
.*-------------------------------------------------------------------   00120900
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00121000
                     AIF   (K'&ZXMFCTRL LE 0).ZG56P  NOT I/O            00121100
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG56P               00121200
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00121300
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00121400
&ZMS                 SETC  '&ZMS.&MF"'                                  00121500
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00121600
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'            00121700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00121800
.ZG56P               ANOP  ,                                            00121900
.*-------------------------------------------------------------------   00122000
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00122100
&ZXMFATTR            SETC  'INPUT'     SET IN/OUTPUT                    00122200
&XMFATTR             SETC  '0D'                                         00122300
                     AIF   (K'&MF(3) LE 0).ZG59B  PARM                  00122400
&XMFATTR             SETC  '&MF(3,1)'  SET XVARIABLE                    00122500
                     AIF   (N'&MF(3) GT 1).ZG59B  MULTI                 00122600
&XMFATTR             SETC  '&MF(3)'    SET XVARIABLE                    00122700
.ZG59B               ANOP  ,                                            00122800
.*-------------------------------------------------------------------   00122900
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00123000
                     AIF   (K'&ZXMFATTR LE 0).ZG59P  NOT I/O            00123100
                     AIF   ('&XMFATTR'(1,1) NE '(').ZG59P               00123200
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00123300
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00123400
&ZMS                 SETC  '&ZMS.&MF"'                                  00123500
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00123600
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'            00123700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00123800
.ZG59P               ANOP  ,                                            00123900
.*-------------------------------------------------------------------   00124000
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00124100
                     AIF   (K'&ZXMFATTR LE 0).ZG59S  NOT I/O            00124200
                     AIF   (K'&XMFATTR LE 60).ZG59S  LNG OK             00124300
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00124400
&ZMS                 SETC  '"MF='      *KLNGA* MNOTE                    00124500
&ZMS                 SETC  '&ZMS.&MF"'                                  00124600
&ZMS                 SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'        00124700
                     MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'           00124800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00124900
.ZG59S               ANOP  ,                                            00125000
.*-------------------------------------------------------------------   00125100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00125200
.ZG61                ANOP  ,                                            00125300
&ZTLC                SETC 'E'                                           00125400
                     AIF   ('&MF(1)' NE '&ZTLC').ZG69                   00125500
&XMF                 SETC  'E'         SET KEYWORD                      00125600
                     AIF   (N'&MF LE 3).ZG61A   CK NUM                  00125700
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00125800
&ZMS                 SETC  '&ZMS.&MF"'                                  00125900
&ZMS                 SETC  '&ZMS "MF"'                                  00126000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00126100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00126200
.ZG61A               ANOP  ,                                            00126300
.*-------------------------------------------------------------------   00126400
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00126500
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00126600
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00126700
                     AIF   (N'&MF(2) GT 1).ZG63B  MULTI PARMS           00126800
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00126900
.ZG63B               AIF   (K'&MF(2) GT 0).ZG63C                        00127000
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00127100
&ZMS                 SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*             00127200
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00127300
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00127400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00127500
.ZG63C               ANOP  ,                                            00127600
.*-------------------------------------------------------------------   00127700
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00127800
                     AIF   (K'&ZXMFCTRL LE 0).ZG63R  NOT I/O            00127900
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG63R               00128000
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00128100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG63P                 00128200
                     AIF   (K'&ZCGPR GT 2).ZG63Q                        00128300
                     AIF   ('&ZCGPR' EQ '0').ZG63Q                      00128400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00128500
                     AIF   (T'&ZCGPR NE 'N').ZG63Q  INVALID REG NAME    00128600
.ZG63P               ANOP  ,                                            00128700
                     AIF   (T'&ZCGPR NE 'N').ZG63R  NON NUMERIC         00128800
                     AIF   ('&ZCGPR' LT '1').ZG63Q                      00128900
                     AIF   ('&ZCGPR' LE '12').ZG63R                     00129000
.ZG63Q               ANOP  ,                                            00129100
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00129200
&ZMS                 SETC  '&ZMS.&MF"'                                  00129300
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00129400
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00129500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00129600
.ZG63R               ANOP  ,                                            00129700
.*-------------------------------------------------------------------   00129800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00129900
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00130000
.ZG67A   AIF   ('&MF(3)' NE 'COMPLETE').ZG68A                           00130100
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00130200
.*-------------------------------------------------------------------   00130300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00130400
.ZG68A               AIF   (K'&XMFSCK GT 0).ZG68C  KEYWORD              00130500
                     AIF   (K'&MF(3) LE 0).ZG68B                        00130600
&ZMS                 SETC  '"MF='      *KUKWA* MNOTE                    00130700
&ZMS                 SETC  '&ZMS.&MF"'                                  00130800
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00130900
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00131000
&ZMS                 SETC  '&ZMS "COMPLETE".'                           00131100
                     MNOTE 8,' &ZMS '                                   00131200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00131300
.ZG68B               ANOP  ,                                            00131400
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00131500
.ZG68C               ANOP  ,                                            00131600
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00131700
.*------------------------------------------------------------------    00131800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00131900
.ZG69                ANOP  ,                                            00132000
&ZXMF                SETC  'INPUT'     SET IN/OUTPUT                    00132100
                     AIF   (K'&XMF GT 0).ZG69E  VALID ARG               00132200
                     AIF   (T'&MF EQ 'O').ZG69D  OMITTED                00132300
&ZASYSLNDX           SETA  0                                            00132400
.ZG69A               ANOP  ,           POSITIONAL MACRO KEY             00132500
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00132600
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG69C             00132700
&ZTLC                SETC 'MF'                                          00132800
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG69A    00132900
.ZG69B               ANOP  ,                                            00133000
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00133100
&ZMS                 SETC  'THE "MF" KEY'       *KOPTA* MNOTE           00133200
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00133300
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00133400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00133500
                     AGO   .ZG69E                                       00133600
.ZG69C               ANOP  ,                                            00133700
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00133800
&ZMS                 SETC  '"MF='      *KUKWA* MNOTE                    00133900
&ZMS                 SETC  '&ZMS.&MF"'                                  00134000
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00134100
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00134200
&ZMS                 SETC  '&ZMS "S",'                                  00134300
&ZMS                 SETC  '&ZMS "L",'                                  00134400
&ZMS                 SETC  '&ZMS OR "E".'                               00134500
                     MNOTE 8,' &ZMS '                                   00134600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00134700
                     AGO   .ZG69E                                       00134800
.ZG69D               ANOP  ,                                            00134900
&XMF                 SETC  'S'         SET DEFAULT KEYWORD              00135000
&XMFSCK              SETC  'COMPLETE'  COMPLETE CHECKING                00135100
.ZG69E               ANOP  ,                                            00135200
.********************************************************************   00135300
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00135400
.********************************************************************   00135500
                     ACTR  10000                                        00135600
.*-------------------------------------------------------------------   00135700
.***AG.MF03 MF=(SLE)                                                    00135800
                     AIF   ('&XMF' EQ 'L').ZGMFX                        00135900
.*------------------------------------------------------------------    00136000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136100
&XTYPE               SETC  ''          INITIALIZE XVARIABLE             00136200
.*-------------------------------------------------------------------   00136300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136400
.ZG3                 ANOP  ,                                            00136500
                     AIF   (K'&TYPE(1) LE 0).ZG3A                       00136600
&ZTLC                SETC 'INDEPENDENT'                                 00136700
                     AIF   ('&TYPE(1)' NE '&ZTLC').ZG28                 00136800
&XTYPE               SETC  'INDEPENDENT'        SET KEYWORD             00136900
                     AIF   (N'&TYPE LE 1).ZG3A  CK NUM                  00137000
&ZMS                 SETC  '"TYPE='    *KPOSA* MNOTE                    00137100
&ZMS                 SETC  '&ZMS.&TYPE"'                                00137200
&ZMS                 SETC  '&ZMS "TYPE"'                                00137300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00137400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00137500
.ZG3A                ANOP  ,                                            00137600
.*------------------------------------------------------------------    00137700
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137800
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00137900
.ZG3A0               AIF   (K'&MONTKN LE 0).ZG3A1  OK                   00138000
&ZCVAL               SETC '&ZCVAL MONTKN'       INCORRECT KEY USED      00138100
.ZG3A1               AIF   (K'&ACCESS LE 0).ZG3A2  OK                   00138200
&ZCVAL               SETC '&ZCVAL ACCESS'       INCORRECT KEY USED      00138300
.ZG3A2               AIF   (K'&ZCVAL LE 0).ZG3A3  OK                    00138400
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00138500
&ZMS                 SETC  '"TYPE'     *KMEIA* MNOTE                    00138600
&ZMS                 SETC  '&ZMS.=&TYPE"'                               00138700
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00138800
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00138900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00139000
.ZG3A3               ANOP  ,                                            00139100
.*----------------------------------------------------------------***   00139200
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00139300
                     AIF   (N'&CLSFY LE 1).ZG5A  CK NUM                 00139400
&ZMS                 SETC  '"CLSFY='   *KPOSA* MNOTE                    00139500
&ZMS                 SETC  '&ZMS.&CLSFY"'                               00139600
&ZMS                 SETC  '&ZMS "CLSFY"'                               00139700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00139800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00139900
.ZG5A                ANOP  ,                                            00140000
.*-------------------------------------------------------------------   00140100
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00140200
&ZXCLSFY             SETC  'INPUT'     SET IN/OUTPUT                    00140300
&XCLSFY              SETC  '&CLSFY(1)'          SET XVARIABLE           00140400
                     AIF   (N'&CLSFY GT 1).ZG5B  MULTI PARMS            00140500
&XCLSFY              SETC  '&CLSFY'    SET XVARIABLE                    00140600
.ZG5B                AIF   (K'&CLSFY(1) GT 0).ZG5C                      00140700
&ZXCLSFY             SETC  ''          RESET IN/OUTPUT                  00140800
&ZMS                 SETC  'WHEN "INDEPENDENT" IS SPECIFIED'  *KRQDA*   00140900
&ZMS                 SETC  '&ZMS , "CLSFY" KEY AND ITS'                 00141000
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00141100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00141200
.ZG5C                ANOP  ,                                            00141300
.*-------------------------------------------------------------------   00141400
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00141500
                     AIF   (K'&ZXCLSFY LE 0).ZG5R  NOT I/O              00141600
                     AIF   ('&XCLSFY'(1,1) NE '(').ZG5R                 00141700
&ZCGPR               SETC  '&XCLSFY'(2,K'&XCLSFY-2)                     00141800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                  00141900
                     AIF   (K'&ZCGPR GT 2).ZG5Q                         00142000
                     AIF   ('&ZCGPR' EQ '0').ZG5Q                       00142100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00142200
                     AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME     00142300
.ZG5P                ANOP  ,                                            00142400
                     AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC          00142500
                     AIF   ('&ZCGPR' LT '2').ZG5Q                       00142600
                     AIF   ('&ZCGPR' LE '12').ZG5R                      00142700
.ZG5Q                ANOP  ,                                            00142800
&ZMS                 SETC  '"CLSFY='   *KGPRA* MNOTE                    00142900
&ZMS                 SETC  '&ZMS.&CLSFY"'                               00143000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00143100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00143200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00143300
.ZG5R                ANOP  ,                                            00143400
.*----------------------------------------------------------------***   00143500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00143600
                     AIF   (N'&ARRIVALTIME LE 1).ZG8A  CK NUM           00143700
&ZMS                 SETC  '"ARRIVALTIME='      *KPOSA* MNOTE           00143800
&ZMS                 SETC  '&ZMS.&ARRIVALTIME"'                         00143900
&ZMS                 SETC  '&ZMS "ARRIVALTIME"'                         00144000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00144100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00144200
.ZG8A                ANOP  ,                                            00144300
.*-------------------------------------------------------------------   00144400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00144500
&ZXARRIVALTIME       SETC  'INPUT'     SET IN/OUTPUT                    00144600
&XARRIVALTIME        SETC  '&ARRIVALTIME(1)'    SET XVARIABLE           00144700
                     AIF   (N'&ARRIVALTIME GT 1).ZG8B  MULTI PARMS      00144800
&XARRIVALTIME        SETC  '&ARRIVALTIME'       SET XVARIABLE           00144900
.ZG8B                AIF   (K'&ARRIVALTIME(1) GT 0).ZG8C                00145000
&ZXARRIVALTIME       SETC  ''          RESET IN/OUTPUT                  00145100
&ZMS                 SETC  'WHEN "INDEPENDENT" IS SPECIFIED'  *KRQDA*   00145200
&ZMS                 SETC  '&ZMS , "ARRIVALTIME" KEY AND ITS'           00145300
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00145400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00145500
.ZG8C                ANOP  ,                                            00145600
.*-------------------------------------------------------------------   00145700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00145800
                     AIF   (K'&ZXARRIVALTIME LE 0).ZG8R  NOT I/O        00145900
                     AIF   ('&XARRIVALTIME'(1,1) NE '(').ZG8R           00146000
&ZCGPR               SETC  '&XARRIVALTIME'(2,K'&XARRIVALTIME-2)         00146100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                  00146200
                     AIF   (K'&ZCGPR GT 2).ZG8Q                         00146300
                     AIF   ('&ZCGPR' EQ '0').ZG8Q                       00146400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00146500
                     AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME     00146600
.ZG8P                ANOP  ,                                            00146700
                     AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC          00146800
                     AIF   ('&ZCGPR' LT '2').ZG8Q                       00146900
                     AIF   ('&ZCGPR' LE '12').ZG8R                      00147000
.ZG8Q                ANOP  ,                                            00147100
&ZMS                 SETC  '"ARRIVALTIME='      *KGPRA* MNOTE           00147200
&ZMS                 SETC  '&ZMS.&ARRIVALTIME"'                         00147300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00147400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00147500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00147600
.ZG8R                ANOP  ,                                            00147700
.*----------------------------------------------------------------***   00147800
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00147900
                     AIF   (N'&FUNCTION_NAME LE 1).ZG11A  CK NUM        00148000
&ZMS                 SETC  '"FUNCTION_NAME='    *KPOSA* MNOTE           00148100
&ZMS                 SETC  '&ZMS.&FUNCTION_NAME"'                       00148200
&ZMS                 SETC  '&ZMS "FUNCTION_NAME"'                       00148300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00148400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00148500
.ZG11A               ANOP  ,                                            00148600
.*-------------------------------------------------------------------   00148700
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00148800
&ZXFUNCTION_NAME     SETC  'INPUT'     SET IN/OUTPUT                    00148900
&XFUNCTION_NAME      SETC  '&FUNCTION_NAME(1)'  SET XVARIABLE           00149000
                     AIF   (N'&FUNCTION_NAME GT 1).ZG11B  MULTI PARMS   00149100
&XFUNCTION_NAME      SETC  '&FUNCTION_NAME'     SET XVARIABLE           00149200
.ZG11B               AIF   (K'&FUNCTION_NAME(1) GT 0).ZG11C             00149300
&ZXFUNCTION_NAME     SETC  ''          RESET IN/OUTPUT                  00149400
&ZMS                 SETC  'WHEN "INDEPENDENT" IS SPECIFIED'  *KRQDA*   00149500
&ZMS                 SETC  '&ZMS , "FUNCTION_NAME" KEY AND ITS'         00149600
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00149700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00149800
.ZG11C               ANOP  ,                                            00149900
.*-------------------------------------------------------------------   00150000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00150100
                     AIF   (K'&ZXFUNCTION_NAME LE 0).ZG11R  NOT I/O     00150200
                     AIF   ('&XFUNCTION_NAME'(1,1) NE '(').ZG11R        00150300
&ZCGPR               SETC  '&XFUNCTION_NAME'(2,K'&XFUNCTION_NAME-2)     00150400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                 00150500
                     AIF   (K'&ZCGPR GT 2).ZG11Q                        00150600
                     AIF   ('&ZCGPR' EQ '0').ZG11Q                      00150700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00150800
                     AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME    00150900
.ZG11P               ANOP  ,                                            00151000
                     AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC         00151100
                     AIF   ('&ZCGPR' LT '2').ZG11Q                      00151200
                     AIF   ('&ZCGPR' LE '12').ZG11R                     00151300
.ZG11Q               ANOP  ,                                            00151400
&ZMS                 SETC  '"FUNCTION_NAME='    *KGPRA* MNOTE           00151500
&ZMS                 SETC  '&ZMS.&FUNCTION_NAME"'                       00151600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00151700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00151800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00151900
.ZG11R               ANOP  ,                                            00152000
.*------------------------------------------------------------------    00152100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152200
&XEXSTARTDEFER       SETC  ''          INITIALIZE XVARIABLE             00152300
.*-------------------------------------------------------------------   00152400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152500
.ZG15                ANOP  ,                                            00152600
                     AIF   (K'&EXSTARTDEFER(1) LE 0).ZG15A              00152700
&ZTLC                SETC 'NO'                                          00152800
                     AIF   ('&EXSTARTDEFER(1)' NE '&ZTLC').ZG16         00152900
&XEXSTARTDEFER       SETC  'NO'        SET KEYWORD                      00153000
                     AIF   (N'&EXSTARTDEFER LE 1).ZG15A  CK NUM         00153100
&ZMS                 SETC  '"EXSTARTDEFER='     *KPOSA* MNOTE           00153200
&ZMS                 SETC  '&ZMS.&EXSTARTDEFER"'                        00153300
&ZMS                 SETC  '&ZMS "EXSTARTDEFER"'                        00153400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00153500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00153600
.ZG15A               ANOP  ,                                            00153700
.*-------------------------------------------------------------------   00153800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00153900
.ZG16                ANOP  ,                                            00154000
&ZTLC                SETC 'YES'                                         00154100
                     AIF   ('&EXSTARTDEFER(1)' NE '&ZTLC').ZG17         00154200
&XEXSTARTDEFER       SETC  'YES'       SET KEYWORD                      00154300
                     AIF   (N'&EXSTARTDEFER LE 1).ZG16A  CK NUM         00154400
&ZMS                 SETC  '"EXSTARTDEFER='     *KPOSA* MNOTE           00154500
&ZMS                 SETC  '&ZMS.&EXSTARTDEFER"'                        00154600
&ZMS                 SETC  '&ZMS "EXSTARTDEFER"'                        00154700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00154800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00154900
.ZG16A               ANOP  ,                                            00155000
.*------------------------------------------------------------------    00155100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155200
.ZG17                ANOP  ,                                            00155300
&ZXEXSTARTDEFER      SETC  'INPUT'     SET IN/OUTPUT                    00155400
                     AIF   (K'&XEXSTARTDEFER GT 0).ZG17E  VALID ARG     00155500
                     AIF   (T'&EXSTARTDEFER EQ 'O').ZG17D  OMITTED      00155600
&ZASYSLNDX           SETA  0                                            00155700
.ZG17A               ANOP  ,           POSITIONAL MACRO KEY             00155800
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00155900
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C             00156000
&ZTLC                SETC 'EXSTARTDEFER'                                00156100
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG17A    00156200
.ZG17B               ANOP  ,                                            00156300
&ZXEXSTARTDEFER      SETC  ''          RESET IN/OUTPUT                  00156400
&ZMS                 SETC  'THE "EXSTARTDEFER" KEY'  *KOPTA* MNOTE      00156500
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00156600
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00156700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00156800
                     AGO   .ZG17E                                       00156900
.ZG17C               ANOP  ,                                            00157000
&ZXEXSTARTDEFER      SETC  ''          RESET IN/OUTPUT                  00157100
&ZMS                 SETC  '"EXSTARTDEFER='     *KUKWA* MNOTE           00157200
&ZMS                 SETC  '&ZMS.&EXSTARTDEFER"'                        00157300
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00157400
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00157500
&ZMS                 SETC  '&ZMS "NO"'                                  00157600
&ZMS                 SETC  '&ZMS OR "YES".'                             00157700
                     MNOTE 8,' &ZMS '                                   00157800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00157900
                     AGO   .ZG17E                                       00158000
.ZG17D               ANOP  ,                                            00158100
&XEXSTARTDEFER       SETC  'NO'        SET DEFAULT KEYWORD              00158200
.ZG17E               ANOP  ,                                            00158300
.*------------------------------------------------------------------    00158400
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158500
&XESTRT              SETC  ''          INITIALIZE XVARIABLE             00158600
.*-------------------------------------------------------------------   00158700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00158800
.ZG20                ANOP  ,                                            00158900
                     AIF   (K'&ESTRT(1) LE 0).ZG20A                     00159000
&ZTLC                SETC 'IMPLIED'                                     00159100
                     AIF   ('&ESTRT(1)' NE '&ZTLC').ZG24                00159200
&XESTRT              SETC  'IMPLIED'   SET KEYWORD                      00159300
                     AIF   (N'&ESTRT LE 1).ZG20A  CK NUM                00159400
&ZMS                 SETC  '"ESTRT='   *KPOSA* MNOTE                    00159500
&ZMS                 SETC  '&ZMS.&ESTRT"'                               00159600
&ZMS                 SETC  '&ZMS "ESTRT"'                               00159700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00159800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00159900
.ZG20A               ANOP  ,                                            00160000
.*----------------------------------------------------------------***   00160100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00160200
                     AIF   (N'&WORKREQ_HDL LE 1).ZG22A  CK NUM          00160300
&ZMS                 SETC  '"WORKREQ_HDL='      *KPOSA* MNOTE           00160400
&ZMS                 SETC  '&ZMS.&WORKREQ_HDL"'                         00160500
&ZMS                 SETC  '&ZMS "WORKREQ_HDL"'                         00160600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00160700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00160800
.ZG22A               ANOP  ,                                            00160900
.*-------------------------------------------------------------------   00161000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00161100
                     AIF   (K'&WORKREQ_HDL(1) LE 0).ZG22C  NO PARM      00161200
&ZXWORKREQ_HDL       SETC  'OUTPUT'    SET OUTPUT                       00161300
&XWORKREQ_HDL        SETC  '&WORKREQ_HDL(1)'    SET XVARIABLE           00161400
                     AIF   (N'&WORKREQ_HDL GT 1).ZG22C                  00161500
&XWORKREQ_HDL        SETC  '&WORKREQ_HDL'       SET XVARIABLE           00161600
.ZG22C               ANOP  ,                                            00161700
.*-------------------------------------------------------------------   00161800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00161900
                     AIF   (K'&ZXWORKREQ_HDL LE 0).ZG22R  NOT I/O       00162000
                     AIF   ('&XWORKREQ_HDL'(1,1) NE '(').ZG22R          00162100
&ZCGPR               SETC  '&XWORKREQ_HDL'(2,K'&XWORKREQ_HDL-2)         00162200
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                 00162300
                     AIF   (K'&ZCGPR GT 2).ZG22Q                        00162400
                     AIF   ('&ZCGPR' EQ '0').ZG22Q                      00162500
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00162600
                     AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME    00162700
.ZG22P               ANOP  ,                                            00162800
                     AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC         00162900
                     AIF   ('&ZCGPR' LT '2').ZG22Q                      00163000
                     AIF   ('&ZCGPR' LE '12').ZG22R                     00163100
.ZG22Q               ANOP  ,                                            00163200
&ZMS                 SETC  '"WORKREQ_HDL='      *KGPRA* MNOTE           00163300
&ZMS                 SETC  '&ZMS.&WORKREQ_HDL"'                         00163400
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00163500
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00163600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00163700
.ZG22R               ANOP  ,                                            00163800
.*-------------------------------------------------------------------   00163900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00164000
.ZG24                ANOP  ,                                            00164100
&ZTLC                SETC 'EXPLICIT'                                    00164200
                     AIF   ('&ESTRT(1)' NE '&ZTLC').ZG25                00164300
&XESTRT              SETC  'EXPLICIT'  SET KEYWORD                      00164400
                     AIF   (N'&ESTRT LE 1).ZG24A  CK NUM                00164500
&ZMS                 SETC  '"ESTRT='   *KPOSA* MNOTE                    00164600
&ZMS                 SETC  '&ZMS.&ESTRT"'                               00164700
&ZMS                 SETC  '&ZMS "ESTRT"'                               00164800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00164900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00165000
.ZG24A               ANOP  ,                                            00165100
.*------------------------------------------------------------------    00165200
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165300
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00165400
.ZG24A0              AIF   (K'&WORKREQ_HDL LE 0).ZG24A1  OK             00165500
&ZCVAL               SETC '&ZCVAL WORKREQ_HDL'  INCORRECT KEY USED      00165600
.ZG24A1              AIF   (K'&ZCVAL LE 0).ZG24A2  OK                   00165700
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00165800
&ZMS                 SETC  '"ESTRT'    *KMEIA* MNOTE                    00165900
&ZMS                 SETC  '&ZMS.=&ESTRT"'                              00166000
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00166100
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00166200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00166300
.ZG24A2              ANOP  ,                                            00166400
.*-------------------------------------------------------------------   00166500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00166600
.ZG25                ANOP  ,                                            00166700
&ZTLC                SETC 'EXPLICIT_SINGLE'                             00166800
                     AIF   ('&ESTRT(1)' NE '&ZTLC').ZG26                00166900
&XESTRT              SETC  'EXPLICIT_SINGLE'    SET KEYWORD             00167000
                     AIF   (N'&ESTRT LE 1).ZG25A  CK NUM                00167100
&ZMS                 SETC  '"ESTRT='   *KPOSA* MNOTE                    00167200
&ZMS                 SETC  '&ZMS.&ESTRT"'                               00167300
&ZMS                 SETC  '&ZMS "ESTRT"'                               00167400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00167500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00167600
.ZG25A               ANOP  ,                                            00167700
.*------------------------------------------------------------------    00167800
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167900
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00168000
.ZG25A0              AIF   (K'&WORKREQ_HDL LE 0).ZG25A1  OK             00168100
&ZCVAL               SETC '&ZCVAL WORKREQ_HDL'  INCORRECT KEY USED      00168200
.ZG25A1              AIF   (K'&ZCVAL LE 0).ZG25A2  OK                   00168300
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00168400
&ZMS                 SETC  '"ESTRT'    *KMEIA* MNOTE                    00168500
&ZMS                 SETC  '&ZMS.=&ESTRT"'                              00168600
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00168700
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00168800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00168900
.ZG25A2              ANOP  ,                                            00169000
.*-------------------------------------------------------------------   00169100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00169200
.ZG26                ANOP  ,                                            00169300
&ZTLC                SETC 'NEVER'                                       00169400
                     AIF   ('&ESTRT(1)' NE '&ZTLC').ZG27                00169500
&XESTRT              SETC  'NEVER'     SET KEYWORD                      00169600
                     AIF   (N'&ESTRT LE 1).ZG26A  CK NUM                00169700
&ZMS                 SETC  '"ESTRT='   *KPOSA* MNOTE                    00169800
&ZMS                 SETC  '&ZMS.&ESTRT"'                               00169900
&ZMS                 SETC  '&ZMS "ESTRT"'                               00170000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00170100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00170200
.ZG26A               ANOP  ,                                            00170300
.*------------------------------------------------------------------    00170400
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170500
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00170600
.ZG26A0              AIF   (K'&WORKREQ_HDL LE 0).ZG26A1  OK             00170700
&ZCVAL               SETC '&ZCVAL WORKREQ_HDL'  INCORRECT KEY USED      00170800
.ZG26A1              AIF   (K'&ZCVAL LE 0).ZG26A2  OK                   00170900
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00171000
&ZMS                 SETC  '"ESTRT'    *KMEIA* MNOTE                    00171100
&ZMS                 SETC  '&ZMS.=&ESTRT"'                              00171200
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00171300
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00171400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00171500
.ZG26A2              ANOP  ,                                            00171600
.*------------------------------------------------------------------    00171700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171800
.ZG27                ANOP  ,                                            00171900
&ZXESTRT             SETC  'INPUT'     SET IN/OUTPUT                    00172000
                     AIF   (K'&XESTRT GT 0).ZG27E  VALID ARG            00172100
                     AIF   (T'&ESTRT EQ 'O').ZG27D  OMITTED             00172200
&ZASYSLNDX           SETA  0                                            00172300
.ZG27A               ANOP  ,           POSITIONAL MACRO KEY             00172400
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00172500
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG27C             00172600
&ZTLC                SETC 'ESTRT'                                       00172700
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG27A    00172800
.ZG27B               ANOP  ,                                            00172900
&ZXESTRT             SETC  ''          RESET IN/OUTPUT                  00173000
&ZMS                 SETC  'THE "ESTRT" KEY'    *KOPTA* MNOTE           00173100
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00173200
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00173300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00173400
                     AGO   .ZG27E                                       00173500
.ZG27C               ANOP  ,                                            00173600
&ZXESTRT             SETC  ''          RESET IN/OUTPUT                  00173700
&ZMS                 SETC  '"ESTRT='   *KUKWA* MNOTE                    00173800
&ZMS                 SETC  '&ZMS.&ESTRT"'                               00173900
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00174000
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00174100
&ZMS                 SETC  '&ZMS "IMPLIED",'                            00174200
&ZMS                 SETC  '&ZMS "EXPLICIT",'                           00174300
&ZMS                 SETC  '&ZMS "EXPLICIT_SINGLE",'                    00174400
&ZMS                 SETC  '&ZMS OR "NEVER".'                           00174500
                     MNOTE 8,' &ZMS '                                   00174600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00174700
                     AGO   .ZG27E                                       00174800
.ZG27D               ANOP  ,                                            00174900
&XESTRT              SETC  'IMPLIED'   SET DEFAULT KEYWORD              00175000
.ZG27E               ANOP  ,                                            00175100
.*-------------------------------------------------------------------   00175200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00175300
.ZG28                ANOP  ,                                            00175400
&ZTLC                SETC 'DEPENDENT'                                   00175500
                     AIF   ('&TYPE(1)' NE '&ZTLC').ZG29                 00175600
&XTYPE               SETC  'DEPENDENT'          SET KEYWORD             00175700
                     AIF   (N'&TYPE LE 1).ZG28A  CK NUM                 00175800
&ZMS                 SETC  '"TYPE='    *KPOSA* MNOTE                    00175900
&ZMS                 SETC  '&ZMS.&TYPE"'                                00176000
&ZMS                 SETC  '&ZMS "TYPE"'                                00176100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00176200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00176300
.ZG28A               ANOP  ,                                            00176400
.*------------------------------------------------------------------    00176500
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00176600
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00176700
.ZG28A0              AIF   (K'&CLSFY LE 0).ZG28A1  OK                   00176800
&ZCVAL               SETC '&ZCVAL CLSFY'        INCORRECT KEY USED      00176900
.ZG28A1              AIF   (K'&ARRIVALTIME LE 0).ZG28A2  OK             00177000
&ZCVAL               SETC '&ZCVAL ARRIVALTIME'  INCORRECT KEY USED      00177100
.ZG28A2              AIF   (K'&FUNCTION_NAME LE 0).ZG28A3  OK           00177200
&ZCVAL               SETC '&ZCVAL FUNCTION_NAME'  INCORRECT KEY USED    00177300
.ZG28A3              AIF   (K'&EXSTARTDEFER LE 0).ZG28A4  OK            00177400
&ZCVAL               SETC '&ZCVAL EXSTARTDEFER'  INCORRECT KEY USED     00177500
.ZG28A4              AIF   (K'&ESTRT LE 0).ZG28A5  OK                   00177600
&ZCVAL               SETC '&ZCVAL ESTRT'        INCORRECT KEY USED      00177700
.ZG28A5              AIF   (K'&WORKREQ_HDL LE 0).ZG28A6  OK             00177800
&ZCVAL               SETC '&ZCVAL WORKREQ_HDL'  INCORRECT KEY USED      00177900
.ZG28A6              AIF   (K'&MONTKN LE 0).ZG28A7  OK                  00178000
&ZCVAL               SETC '&ZCVAL MONTKN'       INCORRECT KEY USED      00178100
.ZG28A7              AIF   (K'&ACCESS LE 0).ZG28A8  OK                  00178200
&ZCVAL               SETC '&ZCVAL ACCESS'       INCORRECT KEY USED      00178300
.ZG28A8              AIF   (K'&ZCVAL LE 0).ZG28A9  OK                   00178400
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00178500
&ZMS                 SETC  '"TYPE'     *KMEIA* MNOTE                    00178600
&ZMS                 SETC  '&ZMS.=&TYPE"'                               00178700
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00178800
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00178900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00179000
.ZG28A9              ANOP  ,                                            00179100
.*-------------------------------------------------------------------   00179200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00179300
.ZG29                ANOP  ,                                            00179400
&ZTLC                SETC 'MONENV'                                      00179500
                     AIF   ('&TYPE(1)' NE '&ZTLC').ZG38                 00179600
&XTYPE               SETC  'MONENV'    SET KEYWORD                      00179700
                     AIF   (N'&TYPE LE 1).ZG29A  CK NUM                 00179800
&ZMS                 SETC  '"TYPE='    *KPOSA* MNOTE                    00179900
&ZMS                 SETC  '&ZMS.&TYPE"'                                00180000
&ZMS                 SETC  '&ZMS "TYPE"'                                00180100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00180200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00180300
.ZG29A               ANOP  ,                                            00180400
.*------------------------------------------------------------------    00180500
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180600
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00180700
.ZG29A0              AIF   (K'&CLSFY LE 0).ZG29A1  OK                   00180800
&ZCVAL               SETC '&ZCVAL CLSFY'        INCORRECT KEY USED      00180900
.ZG29A1              AIF   (K'&ARRIVALTIME LE 0).ZG29A2  OK             00181000
&ZCVAL               SETC '&ZCVAL ARRIVALTIME'  INCORRECT KEY USED      00181100
.ZG29A2              AIF   (K'&FUNCTION_NAME LE 0).ZG29A3  OK           00181200
&ZCVAL               SETC '&ZCVAL FUNCTION_NAME'  INCORRECT KEY USED    00181300
.ZG29A3              AIF   (K'&EXSTARTDEFER LE 0).ZG29A4  OK            00181400
&ZCVAL               SETC '&ZCVAL EXSTARTDEFER'  INCORRECT KEY USED     00181500
.ZG29A4              AIF   (K'&ESTRT LE 0).ZG29A5  OK                   00181600
&ZCVAL               SETC '&ZCVAL ESTRT'        INCORRECT KEY USED      00181700
.ZG29A5              AIF   (K'&WORKREQ_HDL LE 0).ZG29A6  OK             00181800
&ZCVAL               SETC '&ZCVAL WORKREQ_HDL'  INCORRECT KEY USED      00181900
.ZG29A6              AIF   (K'&ZCVAL LE 0).ZG29A7  OK                   00182000
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00182100
&ZMS                 SETC  '"TYPE'     *KMEIA* MNOTE                    00182200
&ZMS                 SETC  '&ZMS.=&TYPE"'                               00182300
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00182400
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00182500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00182600
.ZG29A7              ANOP  ,                                            00182700
.*----------------------------------------------------------------***   00182800
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00182900
                     AIF   (N'&MONTKN LE 1).ZG31A  CK NUM               00183000
&ZMS                 SETC  '"MONTKN='  *KPOSA* MNOTE                    00183100
&ZMS                 SETC  '&ZMS.&MONTKN"'                              00183200
&ZMS                 SETC  '&ZMS "MONTKN"'                              00183300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00183400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00183500
.ZG31A               ANOP  ,                                            00183600
.*-------------------------------------------------------------------   00183700
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00183800
&ZXMONTKN            SETC  'INPUT'     SET IN/OUTPUT                    00183900
&XMONTKN             SETC  '&MONTKN(1)'         SET XVARIABLE           00184000
                     AIF   (N'&MONTKN GT 1).ZG31B  MULTI PARMS          00184100
&XMONTKN             SETC  '&MONTKN'   SET XVARIABLE                    00184200
.ZG31B               AIF   (K'&MONTKN(1) GT 0).ZG31C                    00184300
&ZXMONTKN            SETC  ''          RESET IN/OUTPUT                  00184400
&ZMS                 SETC  'WHEN "MONENV" IS SPECIFIED'  *KRQDA*        00184500
&ZMS                 SETC  '&ZMS , "MONTKN" KEY AND ITS'                00184600
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00184700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00184800
.ZG31C               ANOP  ,                                            00184900
.*-------------------------------------------------------------------   00185000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00185100
                     AIF   (K'&ZXMONTKN LE 0).ZG31R  NOT I/O            00185200
                     AIF   ('&XMONTKN'(1,1) NE '(').ZG31R               00185300
&ZCGPR               SETC  '&XMONTKN'(2,K'&XMONTKN-2)                   00185400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                 00185500
                     AIF   (K'&ZCGPR GT 2).ZG31Q                        00185600
                     AIF   ('&ZCGPR' EQ '0').ZG31Q                      00185700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00185800
                     AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME    00185900
.ZG31P               ANOP  ,                                            00186000
                     AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC         00186100
                     AIF   ('&ZCGPR' LT '2').ZG31Q                      00186200
                     AIF   ('&ZCGPR' LE '12').ZG31R                     00186300
.ZG31Q               ANOP  ,                                            00186400
&ZMS                 SETC  '"MONTKN='  *KGPRA* MNOTE                    00186500
&ZMS                 SETC  '&ZMS.&MONTKN"'                              00186600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00186700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00186800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00186900
.ZG31R               ANOP  ,                                            00187000
.*------------------------------------------------------------------    00187100
.***AG.KKCTL01 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00187200
&XACCESS             SETC  ''          INITIALIZE XVARIABLE             00187300
.*-------------------------------------------------------------------   00187400
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00187500
.ZG35                ANOP  ,                                            00187600
                     AIF   (K'&ACCESS(1) LE 0).ZG35A                    00187700
&ZTLC                SETC 'PRIMARY'                                     00187800
                     AIF   ('&ACCESS(1)' NE '&ZTLC').ZG36               00187900
&XACCESS             SETC  'PRIMARY'   SET KEYWORD                      00188000
                     AIF   (N'&ACCESS LE 1).ZG35A  CK NUM               00188100
&ZMS                 SETC  '"ACCESS='  *KPOSA* MNOTE                    00188200
&ZMS                 SETC  '&ZMS.&ACCESS"'                              00188300
&ZMS                 SETC  '&ZMS "ACCESS"'                              00188400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00188500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00188600
.ZG35A               ANOP  ,                                            00188700
.*-------------------------------------------------------------------   00188800
.***AG.KKCTL02 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00188900
.ZG36                ANOP  ,                                            00189000
&ZTLC                SETC 'HOME'                                        00189100
                     AIF   ('&ACCESS(1)' NE '&ZTLC').ZG37               00189200
&XACCESS             SETC  'HOME'      SET KEYWORD                      00189300
                     AIF   (N'&ACCESS LE 1).ZG36A  CK NUM               00189400
&ZMS                 SETC  '"ACCESS='  *KPOSA* MNOTE                    00189500
&ZMS                 SETC  '&ZMS.&ACCESS"'                              00189600
&ZMS                 SETC  '&ZMS "ACCESS"'                              00189700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00189800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00189900
.ZG36A               ANOP  ,                                            00190000
.*------------------------------------------------------------------    00190100
.***AG.KKCTL04 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00190200
.ZG37                ANOP  ,                                            00190300
&ZXACCESS            SETC  'INPUT'     SET IN/OUTPUT                    00190400
                     AIF   (K'&XACCESS GT 0).ZG37E  VALID ARG           00190500
                     AIF   (T'&ACCESS EQ 'O').ZG37D  OMITTED            00190600
&ZASYSLNDX           SETA  0                                            00190700
.ZG37A               ANOP  ,           POSITIONAL MACRO KEY             00190800
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00190900
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG37C             00191000
&ZTLC                SETC 'ACCESS'                                      00191100
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG37A    00191200
.ZG37B               ANOP  ,                                            00191300
&ZXACCESS            SETC  ''          RESET IN/OUTPUT                  00191400
&ZMS                 SETC  'THE "ACCESS" KEY'   *KOPTA* MNOTE           00191500
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00191600
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00191700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00191800
                     AGO   .ZG37E                                       00191900
.ZG37C               ANOP  ,                                            00192000
&ZXACCESS            SETC  ''          RESET IN/OUTPUT                  00192100
&ZMS                 SETC  '"ACCESS='  *KUKWA* MNOTE                    00192200
&ZMS                 SETC  '&ZMS.&ACCESS"'                              00192300
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00192400
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00192500
&ZMS                 SETC  '&ZMS "PRIMARY"'                             00192600
&ZMS                 SETC  '&ZMS OR "HOME".'                            00192700
                     MNOTE 8,' &ZMS '                                   00192800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00192900
                     AGO   .ZG37E                                       00193000
.ZG37D               ANOP  ,                                            00193100
&XACCESS             SETC  'PRIMARY'   SET DEFAULT KEYWORD              00193200
.ZG37E               ANOP  ,                                            00193300
.*------------------------------------------------------------------    00193400
.***AG.KKCTL05 VALUE, OPT RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL       00193500
                     AIF   (K'&ACCESS(1) GT 0).ZG37F  PARM              00193600
&XACCESS             SETC  ''          ENSURE NULL KEYWORD              00193700
&ZXACCESS            SETC  ''          RESET IN/OUTPUT                  00193800
&ZMS                 SETC  'WHEN "MONENV" IS SPECIFIED, THE'            00193900
&ZMS                 SETC  '&ZMS "ACCESS" KEY AND ITS'                  00194000
&ZMS                 SETC  '&ZMS ARGUMENT ARE REQUIRED.'                00194100
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00194200
&ZMS                 SETC  '&ZMS "PRIMARY"'                             00194300
&ZMS                 SETC  '&ZMS OR "HOME".'                            00194400
                     MNOTE 8,' &ZMS '                                   00194500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00194600
.ZG37F               ANOP  ,                                            00194700
.*------------------------------------------------------------------    00194800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00194900
.ZG38                ANOP  ,                                            00195000
&ZXTYPE              SETC  'INPUT'     SET IN/OUTPUT                    00195100
                     AIF   (K'&XTYPE GT 0).ZG38E  VALID ARG             00195200
                     AIF   (T'&TYPE EQ 'O').ZG38D  OMITTED              00195300
&ZASYSLNDX           SETA  0                                            00195400
.ZG38A               ANOP  ,           POSITIONAL MACRO KEY             00195500
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00195600
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG38C             00195700
&ZTLC                SETC 'TYPE'                                        00195800
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG38A    00195900
.ZG38B               ANOP  ,                                            00196000
&ZXTYPE              SETC  ''          RESET IN/OUTPUT                  00196100
&ZMS                 SETC  'THE "TYPE" KEY'     *KOPTA* MNOTE           00196200
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00196300
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00196400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00196500
                     AGO   .ZG38E                                       00196600
.ZG38C               ANOP  ,                                            00196700
&ZXTYPE              SETC  ''          RESET IN/OUTPUT                  00196800
&ZMS                 SETC  '"TYPE='    *KUKWA* MNOTE                    00196900
&ZMS                 SETC  '&ZMS.&TYPE"'                                00197000
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00197100
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00197200
&ZMS                 SETC  '&ZMS "INDEPENDENT",'                        00197300
&ZMS                 SETC  '&ZMS "DEPENDENT",'                          00197400
&ZMS                 SETC  '&ZMS OR "MONENV".'                          00197500
                     MNOTE 8,' &ZMS '                                   00197600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00197700
                     AGO   .ZG38E                                       00197800
.ZG38D               ANOP  ,                                            00197900
&XTYPE               SETC  'INDEPENDENT'        SET DEFAULT KEYWORD     00198000
.ZG38E               ANOP  ,                                            00198100
.*----------------------------------------------------------------***   00198200
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00198300
                     AIF   (N'&ETOKEN LE 1).ZG40A  CK NUM               00198400
&ZMS                 SETC  '"ETOKEN='  *KPOSA* MNOTE                    00198500
&ZMS                 SETC  '&ZMS.&ETOKEN"'                              00198600
&ZMS                 SETC  '&ZMS "ETOKEN"'                              00198700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00198800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00198900
.ZG40A               ANOP  ,                                            00199000
.*-------------------------------------------------------------------   00199100
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00199200
&ZXETOKEN            SETC  'OUTPUT'    SET IN/OUTPUT                    00199300
&XETOKEN             SETC  '&ETOKEN(1)'         SET XVARIABLE           00199400
                     AIF   (N'&ETOKEN GT 1).ZG40B  MULTI PARMS          00199500
&XETOKEN             SETC  '&ETOKEN'   SET XVARIABLE                    00199600
.ZG40B               AIF   (K'&ETOKEN(1) GT 0).ZG40C                    00199700
&ZXETOKEN            SETC  ''          RESET IN/OUTPUT                  00199800
&ZMS                 SETC  ' '         *KRQDA*                          00199900
&ZMS                 SETC  '&ZMS "ETOKEN" KEY AND ITS'                  00200000
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00200100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00200200
.ZG40C               ANOP  ,                                            00200300
.*-------------------------------------------------------------------   00200400
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00200500
                     AIF   (K'&ZXETOKEN LE 0).ZG40R  NOT I/O            00200600
                     AIF   ('&XETOKEN'(1,1) NE '(').ZG40R               00200700
&ZCGPR               SETC  '&XETOKEN'(2,K'&XETOKEN-2)                   00200800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG40P                 00200900
                     AIF   (K'&ZCGPR GT 2).ZG40Q                        00201000
                     AIF   ('&ZCGPR' EQ '0').ZG40Q                      00201100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00201200
                     AIF   (T'&ZCGPR NE 'N').ZG40Q  INVALID REG NAME    00201300
.ZG40P               ANOP  ,                                            00201400
                     AIF   (T'&ZCGPR NE 'N').ZG40R  NON NUMERIC         00201500
                     AIF   ('&ZCGPR' LT '2').ZG40Q                      00201600
                     AIF   ('&ZCGPR' LE '12').ZG40R                     00201700
.ZG40Q               ANOP  ,                                            00201800
&ZMS                 SETC  '"ETOKEN='  *KGPRA* MNOTE                    00201900
&ZMS                 SETC  '&ZMS.&ETOKEN"'                              00202000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00202100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00202200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00202300
.ZG40R               ANOP  ,                                            00202400
.*----------------------------------------------------------------***   00202500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00202600
                     AIF   (N'&RETCODE LE 1).ZG43A  CK NUM              00202700
&ZMS                 SETC  '"RETCODE='          *KPOSA* MNOTE           00202800
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00202900
&ZMS                 SETC  '&ZMS "RETCODE"'                             00203000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00203100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00203200
.ZG43A               ANOP  ,                                            00203300
.*-------------------------------------------------------------------   00203400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00203500
                     AIF   (K'&RETCODE(1) LE 0).ZG43C  NO PARM          00203600
&ZXRETCODE           SETC  'OUTPUT'    SET OUTPUT                       00203700
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00203800
                     AIF   (N'&RETCODE GT 1).ZG43C                      00203900
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00204000
.ZG43C               ANOP  ,                                            00204100
.*-------------------------------------------------------------------   00204200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00204300
                     AIF   (K'&ZXRETCODE LE 0).ZG43R  NOT I/O           00204400
                     AIF   ('&XRETCODE'(1,1) NE '(').ZG43R              00204500
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00204600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG43P                 00204700
                     AIF   (K'&ZCGPR GT 2).ZG43Q                        00204800
                     AIF   ('&ZCGPR' EQ '0').ZG43Q                      00204900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00205000
                     AIF   (T'&ZCGPR NE 'N').ZG43Q  INVALID REG NAME    00205100
.ZG43P               ANOP  ,                                            00205200
                     AIF   (T'&ZCGPR NE 'N').ZG43R  NON NUMERIC         00205300
                     AIF   ('&ZCGPR' LT '2').ZG43Q                      00205400
                     AIF   ('&ZCGPR' LE '12').ZG43R                     00205500
.ZG43Q               ANOP  ,                                            00205600
&ZMS                 SETC  '"RETCODE='          *KGPRA* MNOTE           00205700
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00205800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00205900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00206000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00206100
.ZG43R               ANOP  ,                                            00206200
.*----------------------------------------------------------------***   00206300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00206400
                     AIF   (N'&RSNCODE LE 1).ZG46A  CK NUM              00206500
&ZMS                 SETC  '"RSNCODE='          *KPOSA* MNOTE           00206600
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00206700
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00206800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00206900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00207000
.ZG46A               ANOP  ,                                            00207100
.*-------------------------------------------------------------------   00207200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00207300
                     AIF   (K'&RSNCODE(1) LE 0).ZG46C  NO PARM          00207400
&ZXRSNCODE           SETC  'OUTPUT'    SET OUTPUT                       00207500
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00207600
                     AIF   (N'&RSNCODE GT 1).ZG46C                      00207700
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00207800
.ZG46C               ANOP  ,                                            00207900
.*-------------------------------------------------------------------   00208000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00208100
                     AIF   (K'&ZXRSNCODE LE 0).ZG46R  NOT I/O           00208200
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZG46R              00208300
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00208400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                 00208500
                     AIF   (K'&ZCGPR GT 2).ZG46Q                        00208600
                     AIF   ('&ZCGPR' EQ '0').ZG46Q                      00208700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00208800
                     AIF   (T'&ZCGPR NE 'N').ZG46Q  INVALID REG NAME    00208900
.ZG46P               ANOP  ,                                            00209000
                     AIF   (T'&ZCGPR NE 'N').ZG46R  NON NUMERIC         00209100
                     AIF   ('&ZCGPR' LT '2').ZG46Q                      00209200
                     AIF   ('&ZCGPR' LE '12').ZG46R                     00209300
.ZG46Q               ANOP  ,                                            00209400
&ZMS                 SETC  '"RSNCODE='          *KGPRA* MNOTE           00209500
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00209600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00209700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00209800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00209900
.ZG46R               ANOP  ,                                            00210000
.******************************************************************     00210100
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00210200
.******************************************************************     00210300
                     ACTR  10000                                        00210400
.*----------------------------------------------------------------***   00210500
.***AH.P02 EXTRA POSITIONALS                                            00210600
                     AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS         00210700
                     AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL         00210800
                     AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL     00210900
                     AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL      00211000
.ZGLISTX1            ANOP  ,                                            00211100
&ZCVAL               SETC  ''          ERROR FIELD                      00211200
&ZAWRK               SETA  0           POSITIONAL NUMBER                00211300
.ZGLIST2             ANOP  ,                                            00211400
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00211500
                     AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE         00211600
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00211700
                     AGO   .ZGLIST2                                     00211800
.*                                                                      00211900
.ZGLIST3             ANOP  ,                                            00212000
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00212100
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE     00212200
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00212300
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00212400
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00212500
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00212600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00212700
.ZGLISTX             ANOP  ,                                            00212800
&ZASYSLNDX           SETA  0                                            00212900
.*-------------------------------------------------------------------   00213000
.***AG.MF04 MF=(SLE)                                                    00213100
.ZGMFX               ANOP  ,           END OF FULL SYNTAX CHECK         00213200
.*******************************************************************    00213300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00213400
.*******************************************************************    00213500
                     AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED         00213600
.*******************************************************************    00213700
.***AE.01  START OF IWMECREA MACRO CODE                                 00213800
.*******************************************************************    00213900
                     LCLC  &M0M0001                 NAME                00214000
&M0M0001             SETC  '&XLABEL'                SET NAME            00214100
                     AIF   (K'&XLABEL NE 0).XLAB2                       00214200
&M0M0001             SETC  'M00M&SYSNDX'            DEFAULT NAME        00214300
.*                                                                      00214400
.XLAB2               ANOP  ,                                            00214500
                     AIF   ('&XMF' EQ 'L').XLAB3                        00214600
&M0M0001 DS    0H                             IWMECREA-3                00214700
.XLAB3               ANOP  ,                                            00214800
.*******************************************************************    00214900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00215000
.*******************************************************************    00215100
              PUSH  PRINT                                               00215200
                     AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON   00215300
                     PRINT OFF         ++ PR01                          00215400
                     AGO   .ZPRNTXX                                     00215500
.ZPRINTX             PRINT ON                                           00215600
.ZPRNTXX             ANOP  ,                                            00215700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00215800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00215900
.********************************************************************   00216000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00216100
.********************************************************************   00216200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00216300
                      LCLA  &ZOPN1         INVOCATION INDEX             00216400
                      LCLC  &ZOPL(4095)    LABEL                        00216500
                      LCLC  &ZOPO(4095)    OPERATION                    00216600
                      LCLC  &ZOPV(4095)    VALUE                        00216700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00216800
.*                                                                      00216900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00217000
.******************************************************************     00217100
.***AL.L10 IWMECREA FMT=LIST MF=S!L PARAMETERS                          00217200
.******************************************************************     00217300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00217400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00217500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00217600
&XMFATTR              SETC  '0D'                                        00217700
.*                                                                      00217800
&ZOPN                 SETA  &ZOPN+1                                     00217900
&ZOPL(&ZOPN)          SETC  ' '                                         00218000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00218100
&ZOPO(&ZOPN)          SETC  'B'                                         00218200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00218300
                      AGO   .ZALVL6B                                    00218400
.ZALVL6A              ANOP                                              00218500
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00218600
&ZOPV(&ZOPN)          SETC  '4,8'                                       00218700
&ZOPN                 SETA  &ZOPN+1                                     00218800
&ZOPL(&ZOPN)          SETC  ' '                                         00218900
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00219000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00219100
.ZALVL6B              ANOP                                              00219200
&ZOPD(&ZOPN)          SETC  '++ IWMECREA ARG PARMS'                     00219300
.*                                                                      00219400
&ZOPN                 SETA  &ZOPN+1                                     00219500
&ZOPL(&ZOPN)          SETC  ' '                                         00219600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00219700
&ZOPV(&ZOPN)          SETC  '1'                                         00219800
&ZOPD(&ZOPN)          SETC  ' '                                         00219900
.*                                                                      00220000
.ZLMFSL2              ANOP  ,                                           00220100
.*-------------------------------------------------------------------   00220200
.***AM.L00  IWMECREA FMT=LIST name                                      00220300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00220400
&ZOPN                 SETA &ZOPN+1                                      00220500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00220600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00220700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00220800
&ZOPD(&ZOPN)          SETC '++ IWMECREA NAME'                           00220900
.ZLMFSL2M             ANOP  ,                                           00221000
.*-------------------------------------------------------------------   00221100
.***AM.L01  IWMECREA FMT=LIST PARAMETERS                                00221200
&ZOPN                 SETA &ZOPN+1                                      00221300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00221400
&ZOPO(&ZOPN)          SETC 'DS'                                         00221500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00221600
&ZOPD(&ZOPN)          SETC '++ IWMECREA PARM LIST'                      00221700
.*-------------------------------------------------------------------   00221800
.***AM.L02 XVERSION XL1                                                 00221900
&ZOPN                 SETA &ZOPN+1                                      00222000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00222100
&ZOPO(&ZOPN)          SETC 'DS'                                         00222200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00222300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00222400
.*-------------------------------------------------------------------   00222500
.***AM.L09  XOPTIONS BL.8                                               00222600
&ZOPN                 SETA &ZOPN+1                                      00222700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPTIONS'                         00222800
&ZOPO(&ZOPN)          SETC 'DS'                                         00222900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00223000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL  XOPTIONS'                   00223100
.*-------------------------------------------------------------------   00223200
.***AM.L09  XPLISTLEN XL2                                               00223300
&ZOPN                 SETA &ZOPN+1                                      00223400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00223500
&ZOPO(&ZOPN)          SETC 'DS'                                         00223600
&ZOPV(&ZOPN)          SETC 'XL2'                                        00223700
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTLEN'                        00223800
.*-------------------------------------------------------------------   00223900
.***AM.L09  XRSV0004 CL4                                                00224000
&ZOPN                 SETA &ZOPN+1                                      00224100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0004'                         00224200
&ZOPO(&ZOPN)          SETC 'DS'                                         00224300
&ZOPV(&ZOPN)          SETC 'CL4'                                        00224400
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0004'                      00224500
.*-------------------------------------------------------------------   00224600
.***AM.L09 ADDR XCLSFY A                                                00224700
&ZOPN                 SETA &ZOPN+1                                      00224800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCLSFY_ADDR'                      00224900
&ZOPO(&ZOPN)          SETC 'DS'                                         00225000
&ZOPV(&ZOPN)          SETC 'A'                                          00225100
&ZOPD(&ZOPN)          SETC '++ &ZXCLSFY ADDR XCLSFY'                    00225200
.*-------------------------------------------------------------------   00225300
.***AM.L09  XRSV000C CL4                                                00225400
&ZOPN                 SETA &ZOPN+1                                      00225500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV000C'                         00225600
&ZOPO(&ZOPN)          SETC 'DS'                                         00225700
&ZOPV(&ZOPN)          SETC 'CL4'                                        00225800
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV000C'                      00225900
.*-------------------------------------------------------------------   00226000
.***AM.L09  XARRIVALTIME BL.64                                          00226100
&ZOPN                 SETA &ZOPN+1                                      00226200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XARRIVALTIME'                     00226300
&ZOPO(&ZOPN)          SETC 'DS'                                         00226400
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00226500
&ZOPD(&ZOPN)          SETC '++ &ZXARRIVALTIME  XARRIVALTIME'            00226600
.*-------------------------------------------------------------------   00226700
.***AM.L09  XRSV0018 CL8                                                00226800
&ZOPN                 SETA &ZOPN+1                                      00226900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0018'                         00227000
&ZOPO(&ZOPN)          SETC 'DS'                                         00227100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00227200
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0018'                      00227300
.*-------------------------------------------------------------------   00227400
.***AM.L09  XFUNCTION_NAME CL8                                          00227500
&ZOPN                 SETA &ZOPN+1                                      00227600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNCTION_NAME'                   00227700
&ZOPO(&ZOPN)          SETC 'DS'                                         00227800
&ZOPV(&ZOPN)          SETC 'CL8'                                        00227900
&ZOPD(&ZOPN)          SETC '++ &ZXFUNCTION_NAME  XFUNCTION_NAME'        00228000
.*-------------------------------------------------------------------   00228100
.***AM.L09  XETOKEN CL8                                                 00228200
&ZOPN                 SETA &ZOPN+1                                      00228300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XETOKEN'                          00228400
&ZOPO(&ZOPN)          SETC 'DS'                                         00228500
&ZOPV(&ZOPN)          SETC 'CL8'                                        00228600
&ZOPD(&ZOPN)          SETC '++ &ZXETOKEN  XETOKEN'                      00228700
.*-------------------------------------------------------------------   00228800
.***AM.L09  XRSV0030 CL4                                                00228900
&ZOPN                 SETA &ZOPN+1                                      00229000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0030'                         00229100
&ZOPO(&ZOPN)          SETC 'DS'                                         00229200
&ZOPV(&ZOPN)          SETC 'CL4'                                        00229300
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0030'                      00229400
.*-------------------------------------------------------------------   00229500
.***AM.MLM2 SAVED LOCATION COUNTER                                      00229600
                      AIF  (&XPLISTVER GE 1).ZL11LA                     00229700
                      AIF  ('&ZENDBASEPL' NE '').ZL11LA                 00229800
&ZENDBASEPL           SETC 'YES'                                        00229900
&ZOPN                 SETA &ZOPN+1                                      00230000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00230100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00230200
&ZOPV(&ZOPN)          SETC '*'                                          00230300
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00230400
.ZL11LA               ANOP  ,                                           00230500
.*-------------------------------------------------------------------   00230600
.***AM.LVER1                                                            00230700
                      AIF  (&XPLISTVER LT 1).ZL11L                      00230800
.*-------------------------------------------------------------------   00230900
.*-------------------------------------------------------------------   00231000
.***AM.L03 XTYPE_OPTIONS BL.8                                           00231100
&ZOPN                 SETA &ZOPN+1                                      00231200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTYPE_OPTIONS'                    00231300
&ZOPO(&ZOPN)          SETC 'DS'                                         00231400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00231500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00231600
.*-------------------------------------------------------------------   00231700
.***AM.LVER2                                                            00231800
.ZL11L                ANOP  ,                                           00231900
.*-------------------------------------------------------------------   00232000
.*-------------------------------------------------------------------   00232100
.***AM.LVER1                                                            00232200
                      AIF  (&XPLISTVER LT 1).ZL12L                      00232300
.*-------------------------------------------------------------------   00232400
.*                                                                      00232500
&ZOPN                 SETA  &ZOPN+1                                     00232600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_INDEPENDENT'               00232700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00232800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00232900
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 00233000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).INDEPENDENT'                  00233100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00233200
.*-------------------------------------------------------------------   00233300
.***AM.LVER2                                                            00233400
.ZL12L                ANOP  ,                                           00233500
.*-------------------------------------------------------------------   00233600
.*-------------------------------------------------------------------   00233700
.***AM.LVER1                                                            00233800
                      AIF  (&XPLISTVER LT 1).ZL13L                      00233900
.*-------------------------------------------------------------------   00234000
.*                                                                      00234100
&ZOPN                 SETA  &ZOPN+1                                     00234200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_DEPENDENT'                 00234300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00234400
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00234500
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 00234600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEPENDENT'                    00234700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00234800
.*-------------------------------------------------------------------   00234900
.***AM.LVER2                                                            00235000
.ZL13L                ANOP  ,                                           00235100
.*-------------------------------------------------------------------   00235200
.*-------------------------------------------------------------------   00235300
.***AM.LVER1                                                            00235400
                      AIF  (&XPLISTVER LT 1).ZL14L                      00235500
.*-------------------------------------------------------------------   00235600
.*                                                                      00235700
&ZOPN                 SETA  &ZOPN+1                                     00235800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XTYPE_MONENV'                    00235900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00236000
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00236100
&ZOPD(&ZOPN)          SETC  '++ XTYPE.'                                 00236200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MONENV'                       00236300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00236400
.*-------------------------------------------------------------------   00236500
.***AM.LVER2                                                            00236600
.ZL14L                ANOP  ,                                           00236700
.*-------------------------------------------------------------------   00236800
.*-------------------------------------------------------------------   00236900
.***AM.LVER1                                                            00237000
                      AIF  (&XPLISTVER LT 1).ZL15L                      00237100
.*-------------------------------------------------------------------   00237200
.*                                                                      00237300
&ZOPN                 SETA  &ZOPN+1                                     00237400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XACCESS_PRIMARY'                 00237500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00237600
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00237700
&ZOPD(&ZOPN)          SETC  '++ XACCESS.'                               00237800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PRIMARY'                      00237900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00238000
.*-------------------------------------------------------------------   00238100
.***AM.LVER2                                                            00238200
.ZL15L                ANOP  ,                                           00238300
.*-------------------------------------------------------------------   00238400
.*-------------------------------------------------------------------   00238500
.***AM.LVER1                                                            00238600
                      AIF  (&XPLISTVER LT 1).ZL16L                      00238700
.*-------------------------------------------------------------------   00238800
.*                                                                      00238900
&ZOPN                 SETA  &ZOPN+1                                     00239000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XACCESS_HOME'                    00239100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00239200
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00239300
&ZOPD(&ZOPN)          SETC  '++ XACCESS.'                               00239400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).HOME'                         00239500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00239600
.*-------------------------------------------------------------------   00239700
.***AM.LVER2                                                            00239800
.ZL16L                ANOP  ,                                           00239900
.*-------------------------------------------------------------------   00240000
.*-------------------------------------------------------------------   00240100
.***AM.LVER1                                                            00240200
                      AIF  (&XPLISTVER LT 1).ZL17L                      00240300
.*-------------------------------------------------------------------   00240400
.*-------------------------------------------------------------------   00240500
.***AM.L09  XRSV0035 CL3                                                00240600
&ZOPN                 SETA &ZOPN+1                                      00240700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0035'                         00240800
&ZOPO(&ZOPN)          SETC 'DS'                                         00240900
&ZOPV(&ZOPN)          SETC 'CL3'                                        00241000
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0035'                      00241100
.*-------------------------------------------------------------------   00241200
.***AM.LVER2                                                            00241300
.ZL17L                ANOP  ,                                           00241400
.*-------------------------------------------------------------------   00241500
.*-------------------------------------------------------------------   00241600
.***AM.LVER1                                                            00241700
                      AIF  (&XPLISTVER LT 1).ZL18L                      00241800
.*-------------------------------------------------------------------   00241900
.*-------------------------------------------------------------------   00242000
.***AM.L09  XMONTKN BL.32                                               00242100
&ZOPN                 SETA &ZOPN+1                                      00242200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00242300
&ZOPO(&ZOPN)          SETC 'DS'                                         00242400
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00242500
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN  XMONTKN'                      00242600
.*-------------------------------------------------------------------   00242700
.***AM.LVER2                                                            00242800
.ZL18L                ANOP  ,                                           00242900
.*-------------------------------------------------------------------   00243000
.*-------------------------------------------------------------------   00243100
.***AM.MLM2 SAVED LOCATION COUNTER                                      00243200
                      AIF  (&XPLISTVER GE 2).ZL19LA                     00243300
                      AIF  ('&ZENDBASEPL' NE '').ZL19LA                 00243400
&ZENDBASEPL           SETC 'YES'                                        00243500
&ZOPN                 SETA &ZOPN+1                                      00243600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00243700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00243800
&ZOPV(&ZOPN)          SETC '*'                                          00243900
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00244000
.ZL19LA               ANOP  ,                                           00244100
.*-------------------------------------------------------------------   00244200
.***AM.LVER1                                                            00244300
                      AIF  (&XPLISTVER LT 2).ZL19L                      00244400
.*-------------------------------------------------------------------   00244500
.*-------------------------------------------------------------------   00244600
.***AM.L03 X_OPTIONS BL.8                                               00244700
&ZOPN                 SETA &ZOPN+1                                      00244800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._X_OPTIONS'                        00244900
&ZOPO(&ZOPN)          SETC 'DS'                                         00245000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00245100
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00245200
.*-------------------------------------------------------------------   00245300
.***AM.LVER2                                                            00245400
.ZL19L                ANOP  ,                                           00245500
.*-------------------------------------------------------------------   00245600
.*-------------------------------------------------------------------   00245700
.***AM.LVER1                                                            00245800
                      AIF  (&XPLISTVER LT 2).ZL20L                      00245900
.*-------------------------------------------------------------------   00246000
.*                                                                      00246100
&ZOPN                 SETA  &ZOPN+1                                     00246200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XEXSTARTDEFER_YES'               00246300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00246400
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00246500
&ZOPD(&ZOPN)          SETC  '++ XEXSTARTDEFER.'                         00246600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00246700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00246800
.*-------------------------------------------------------------------   00246900
.***AM.LVER2                                                            00247000
.ZL20L                ANOP  ,                                           00247100
.*-------------------------------------------------------------------   00247200
.*-------------------------------------------------------------------   00247300
.***AM.LVER1                                                            00247400
                      AIF  (&XPLISTVER LT 2).ZL21L                      00247500
.*-------------------------------------------------------------------   00247600
.*                                                                      00247700
&ZOPN                 SETA  &ZOPN+1                                     00247800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XESTRT_EXPLICIT'                 00247900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00248000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00248100
&ZOPD(&ZOPN)          SETC  '++ XESTRT.'                                00248200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EXPLICIT'                     00248300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00248400
.*-------------------------------------------------------------------   00248500
.***AM.LVER2                                                            00248600
.ZL21L                ANOP  ,                                           00248700
.*-------------------------------------------------------------------   00248800
.*-------------------------------------------------------------------   00248900
.***AM.LVER1                                                            00249000
                      AIF  (&XPLISTVER LT 2).ZL22L                      00249100
.*-------------------------------------------------------------------   00249200
.*                                                                      00249300
&ZOPN                 SETA  &ZOPN+1                                     00249400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XESTRT_EXPLICIT_SINGLE'          00249500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00249600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00249700
&ZOPD(&ZOPN)          SETC  '++ XESTRT.'                                00249800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).EXPLICIT_SINGLE'              00249900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00250000
.*-------------------------------------------------------------------   00250100
.***AM.LVER2                                                            00250200
.ZL22L                ANOP  ,                                           00250300
.*-------------------------------------------------------------------   00250400
.*-------------------------------------------------------------------   00250500
.***AM.LVER1                                                            00250600
                      AIF  (&XPLISTVER LT 2).ZL23L                      00250700
.*-------------------------------------------------------------------   00250800
.*                                                                      00250900
&ZOPN                 SETA  &ZOPN+1                                     00251000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XESTRT_NEVER'                    00251100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00251200
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00251300
&ZOPD(&ZOPN)          SETC  '++ XESTRT.'                                00251400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NEVER'                        00251500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00251600
.*-------------------------------------------------------------------   00251700
.***AM.LVER2                                                            00251800
.ZL23L                ANOP  ,                                           00251900
.*-------------------------------------------------------------------   00252000
.*-------------------------------------------------------------------   00252100
.***AM.MLM2 SAVED LOCATION COUNTER                                      00252200
                      AIF  (&XPLISTVER GE 3).ZL24LA                     00252300
                      AIF  ('&ZENDBASEPL' NE '').ZL24LA                 00252400
&ZENDBASEPL           SETC 'YES'                                        00252500
&ZOPN                 SETA &ZOPN+1                                      00252600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00252700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00252800
&ZOPV(&ZOPN)          SETC '*'                                          00252900
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00253000
.ZL24LA               ANOP  ,                                           00253100
.*-------------------------------------------------------------------   00253200
.***AM.LVER1                                                            00253300
                      AIF  (&XPLISTVER LT 3).ZL24L                      00253400
.*-------------------------------------------------------------------   00253500
.*-------------------------------------------------------------------   00253600
.***AM.L09  XRSV003D CL3                                                00253700
&ZOPN                 SETA &ZOPN+1                                      00253800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV003D'                         00253900
&ZOPO(&ZOPN)          SETC 'DS'                                         00254000
&ZOPV(&ZOPN)          SETC 'CL3'                                        00254100
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV003D'                      00254200
.*-------------------------------------------------------------------   00254300
.***AM.LVER2                                                            00254400
.ZL24L                ANOP  ,                                           00254500
.*-------------------------------------------------------------------   00254600
.*-------------------------------------------------------------------   00254700
.***AM.LVER1                                                            00254800
                      AIF  (&XPLISTVER LT 3).ZL25L                      00254900
.*-------------------------------------------------------------------   00255000
.*-------------------------------------------------------------------   00255100
.***AM.L09 ADDR XWORKREQ_HDL A                                          00255200
&ZOPN                 SETA &ZOPN+1                                      00255300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XWORKREQ_HDL_ADDR'                00255400
&ZOPO(&ZOPN)          SETC 'DS'                                         00255500
&ZOPV(&ZOPN)          SETC 'A'                                          00255600
&ZOPD(&ZOPN)          SETC '++ &ZXWORKREQ_HDL ADDR XWORKREQ_HDL'        00255700
.*-------------------------------------------------------------------   00255800
.***AM.LVER2                                                            00255900
.ZL25L                ANOP  ,                                           00256000
.*-------------------------------------------------------------------   00256100
.*-------------------------------------------------------------------   00256200
.***AM.L10 END OF IWMECREA LIST PARAMETERS                              00256300
&ZOPN                 SETA &ZOPN+1                                      00256400
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00256500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00256600
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00256700
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00256800
.*                                                                      00256900
&ZOPN                 SETA &ZOPN+1                                      00257000
&ZOPL(&ZOPN)          SETC ' '                                          00257100
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00257200
&ZOPV(&ZOPN)          SETC '1'                                          00257300
&ZOPD(&ZOPN)          SETC ' '                                          00257400
.*-------------------------------------------------------------------   00257500
.***AL.L12 IWMECREA FMT=LIST MF=S!L PARAMETERS                          00257600
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00257700
.*                                                                      00257800
&ZOPN                 SETA  &ZOPN+1                                     00257900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00258000
&ZOPO(&ZOPN)          SETC  'DC'                                        00258100
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00258200
&ZOPD(&ZOPN)          SETC  '++ IWMECREA ARG PARMS'                     00258300
.*                                                                      00258400
.ZLMFSLX              ANOP  ,                                           00258500
.*-------------------------------------------------------------------   00258600
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00258700
&ZPLLEN               SETA 52                                           00258800
.*                                                                      00258900
                      AIF  (&XPLISTVER LT 1).ZLLEN2Z                    00259000
&ZPLLEN               SETA 60                                           00259100
.ZLLEN2Z              ANOP  ,                                           00259200
.*                                                                      00259300
                      AIF  (&XPLISTVER LT 2).ZLLEN3Z                    00259400
&ZPLLEN               SETA 61                                           00259500
.ZLLEN3Z              ANOP  ,                                           00259600
.*                                                                      00259700
                      AIF  (&XPLISTVER LT 3).ZLLEN4Z                    00259800
&ZPLLEN               SETA 68                                           00259900
.ZLLEN4Z              ANOP  ,                                           00260000
.*                                                                      00260100
.******************************************************************     00260200
.***AI.L01 IWMECREA FMT=LIST FILL IN PARAMETER AREA                     00260300
.******************************************************************     00260400
                      ACTR  10000                                       00260500
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00260600
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00260700
&ZCVAL                SETC  'LAE'          XAX MODE                     00260800
.ZIMFXA               ANOP ,                                            00260900
.*                                                                      00261000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00261100
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00261200
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00261300
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00261400
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00261500
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00261600
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00261700
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00261800
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00261900
&ZOPN                 SETA  &ZOPN+1                                     00262000
&ZOPL(&ZOPN)          SETC  ' '                                         00262100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00262200
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00262300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00262400
                      AGO   .ZIMFNX                                     00262500
.*                                                                      00262600
.ZIMFN2               ANOP ,                                            00262700
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00262800
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00262900
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00263000
&ZOPN                 SETA  &ZOPN+1                                     00263100
&ZOPL(&ZOPN)          SETC  ' '                                         00263200
&ZOPO(&ZOPN)          SETC  'LAE'                                       00263300
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00263400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00263500
                      AGO   .ZIMFNX                                     00263600
.ZIMFNX1              ANOP ,                                            00263700
&ZOPN                 SETA  &ZOPN+1                                     00263800
&ZOPL(&ZOPN)          SETC  ' '                                         00263900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00264000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00264100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00264200
.ZIMFNX               ANOP ,                                            00264300
.********************************************************************   00264400
.***AI.L02 IWMECREA FMT=LIST INITIALIZE PARAMETER AREA                  00264500
.********************************************************************   00264600
.***AI.L03 MF=(SLE)                                                     00264700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00264800
.*                                                                      00264900
&ZOPN                 SETA  &ZOPN+1                                     00265000
&ZOPL(&ZOPN)          SETC  ' '                                         00265100
&ZOPO(&ZOPN)          SETC  'XC'                                        00265200
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00265300
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00265400
.ZIMFLX               ANOP  ,                                           00265500
.*-------------------------------------------------------------------   00265600
.***AI.L04A XVERSION XL1                                                00265700
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00265800
&ZOPN                 SETA  &ZOPN+1                                     00265900
&ZOPL(&ZOPN)          SETC  ' '                                         00266000
&ZOPO(&ZOPN)          SETC  'MVI'                                       00266100
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00266200
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00266300
.ZIMFVW               ANOP  ,                                           00266400
.*-------------------------------------------------------------------   00266500
.***AI.L04 XPLISTLEN XL2                                                00266600
&ZOPN                 SETA  &ZOPN+1                                     00266700
&ZOPL(&ZOPN)          SETC  ' '                                         00266800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00266900
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      00267000
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00267100
.*-------------------------------------------------------------------   00267200
.***AI.L19 ADDR XCLSFY A                                                00267300
                      AIF   ('&ZXCLSFY' EQ '').ZI5H                     00267400
&ZCLNG                SETC  '&XCLSFY'                                   00267500
&ZCGPR                SETC  '14'                                        00267600
         AIF   ('&XCLSFY'(1,1) EQ '(').ZI5F  IN GPR                     00267700
.*                                                                      00267800
&ZOPN                 SETA  &ZOPN+1                                     00267900
&ZOPL(&ZOPN)          SETC  ' '                                         00268000
&ZOPO(&ZOPN)          SETC  'LA'                                        00268100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00268200
&ZOPD(&ZOPN)          SETC  '++ &ZXCLSFY XCLSFY'                        00268300
.*                                                                      00268400
                      AGO   .ZI5G                                       00268500
.*                                                                      00268600
.ZI5F                 ANOP  ,                                           00268700
&ZCGPR   SETC  '&XCLSFY'(2,K'&XCLSFY-2)                                 00268800
.*                                                                      00268900
.ZI5G                 ANOP  ,                                           00269000
.*                                                                      00269100
&ZOPN                 SETA  &ZOPN+1                                     00269200
&ZOPL(&ZOPN)          SETC  ' '                                         00269300
&ZOPO(&ZOPN)          SETC  'ST'                                        00269400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00269500
&ZOPD(&ZOPN)          SETC  '++ &ZXCLSFY XCLSFY'                        00269600
.*                                                                      00269700
.ZI5H                 ANOP  ,                                           00269800
.*-------------------------------------------------------------------   00269900
.***AI.L25  XARRIVALTIME XL8                                            00270000
                      AIF   ('&ZXARRIVALTIME' EQ '').ZI7E               00270100
                      AIF   ('&ZXARRIVALTIME' EQ 'OUTPUT').ZI7E         00270200
&ZCGPR                SETC  '&XARRIVALTIME'                             00270300
.*                                                                      00270400
                      AIF   ('&XARRIVALTIME'(1,1) NE '(').ZI7B          00270500
&ZCGPR   SETC  '0('.'&XARRIVALTIME'(2,K'&XARRIVALTIME-2).')'            00270600
                      AGO   .ZI7D                                       00270700
.ZI7B                 ANOP  ,                                           00270800
.*                                                                      00270900
&ZC                   SETC  '&XARRIVALTIME'(1,1)                        00271000
                      AIF   (T'&ZC NE 'N').ZI7D                         00271100
&ZC                   SETC  '&XARRIVALTIME'                             00271200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI7D                00271300
&ZCGPR                SETC  '=BL8''&XARRIVALTIME'''                     00271400
.*                                                                      00271500
.ZI7D                 ANOP  ,                                           00271600
.*                                                                      00271700
&ZOPN                 SETA  &ZOPN+1                                     00271800
&ZOPL(&ZOPN)          SETC  ' '                                         00271900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00272000
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            00272100
&ZOPD(&ZOPN)          SETC  '++ &ZXARRIVALTIME XARRIVALTIME'            00272200
.*                                                                      00272300
.ZI7E                 ANOP  ,                                           00272400
.*-------------------------------------------------------------------   00272500
.***AI.L25  XFUNCTION_NAME CL8                                          00272600
                      AIF   ('&ZXFUNCTION_NAME' EQ '').ZI9E             00272700
                      AIF   ('&ZXFUNCTION_NAME' EQ 'OUTPUT').ZI9E       00272800
&ZCGPR                SETC  '&XFUNCTION_NAME'                           00272900
.*                                                                      00273000
                      AIF   ('&XFUNCTION_NAME'(1,1) NE '(').ZI9B        00273100
&ZCGPR   SETC  '0('.'&XFUNCTION_NAME'(2,K'&XFUNCTION_NAME-2).')'        00273200
.ZI9B                 ANOP  ,                                           00273300
.*                                                                      00273400
&ZOPN                 SETA  &ZOPN+1                                     00273500
&ZOPL(&ZOPN)          SETC  ' '                                         00273600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00273700
&ZOPV(&ZOPN)          SETC  '32(8,1),&ZCGPR'                            00273800
&ZOPD(&ZOPN)          SETC  '++ &ZXFUNCTION_NAME XFUNCTION_NAME'        00273900
.*                                                                      00274000
.ZI9E                 ANOP  ,                                           00274100
.*-------------------------------------------------------------------   00274200
.***AI.LVER01                                                           00274300
                      AIF  (&XPLISTVER LT 1).ZI12Z                      00274400
.*-------------------------------------------------------------------   00274500
.***AI.L05 XTYPE_OPTIONS BL1                                            00274600
&ZW                   SETC  ''                                          00274700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00274800
.*-------------------------------------------------------------------   00274900
.***AI.LVER02                                                           00275000
.ZI12Z                ANOP  ,                                           00275100
.*-------------------------------------------------------------------   00275200
.***AI.LVER01                                                           00275300
                      AIF  (&XPLISTVER LT 1).ZI13Z                      00275400
.*-------------------------------------------------------------------   00275500
.***AI.L08 XTYPE_OPTIONS "INDEPENDENT"                                  00275600
.***      BL1'1XXXXXXX'                                                 00275700
         AIF   ('&XTYPE' NE 'INDEPENDENT').ZI13A                        00275800
&ZW                   SETC  '&ZW.1'                                     00275900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00276000
                      AGO   .ZI13C                                      00276100
.*                                                                      00276200
.ZI13A                ANOP  ,                                           00276300
&ZW                   SETC  '&ZW.0'                                     00276400
.ZI13C                ANOP  ,                                           00276500
.*-------------------------------------------------------------------   00276600
.***AI.LVER02                                                           00276700
.ZI13Z                ANOP  ,                                           00276800
.*-------------------------------------------------------------------   00276900
.***AI.LVER01                                                           00277000
                      AIF  (&XPLISTVER LT 1).ZI14Z                      00277100
.*-------------------------------------------------------------------   00277200
.***AI.L08 XTYPE_OPTIONS "DEPENDENT"                                    00277300
.***      BL1'X1XXXXXX'                                                 00277400
         AIF   ('&XTYPE' NE 'DEPENDENT').ZI14A                          00277500
&ZW                   SETC  '&ZW.1'                                     00277600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00277700
                      AGO   .ZI14C                                      00277800
.*                                                                      00277900
.ZI14A                ANOP  ,                                           00278000
&ZW                   SETC  '&ZW.0'                                     00278100
.ZI14C                ANOP  ,                                           00278200
.*-------------------------------------------------------------------   00278300
.***AI.LVER02                                                           00278400
.ZI14Z                ANOP  ,                                           00278500
.*-------------------------------------------------------------------   00278600
.***AI.LVER01                                                           00278700
                      AIF  (&XPLISTVER LT 1).ZI15Z                      00278800
.*-------------------------------------------------------------------   00278900
.***AI.L08 XTYPE_OPTIONS "MONENV"                                       00279000
.***      BL1'XX1XXXXX'                                                 00279100
         AIF   ('&XTYPE' NE 'MONENV').ZI15A                             00279200
&ZW                   SETC  '&ZW.1'                                     00279300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00279400
                      AGO   .ZI15C                                      00279500
.*                                                                      00279600
.ZI15A                ANOP  ,                                           00279700
&ZW                   SETC  '&ZW.0'                                     00279800
.ZI15C                ANOP  ,                                           00279900
.*-------------------------------------------------------------------   00280000
.***AI.LVER02                                                           00280100
.ZI15Z                ANOP  ,                                           00280200
.*-------------------------------------------------------------------   00280300
.***AI.LVER01                                                           00280400
                      AIF  (&XPLISTVER LT 1).ZI16Z                      00280500
.*-------------------------------------------------------------------   00280600
.***AI.L08 XTYPE_OPTIONS "PRIMARY"                                      00280700
.***      BL1'XXX1XXXX'                                                 00280800
         AIF   ('&XACCESS' NE 'PRIMARY').ZI16A                          00280900
&ZW                   SETC  '&ZW.1'                                     00281000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00281100
                      AGO   .ZI16C                                      00281200
.*                                                                      00281300
.ZI16A                ANOP  ,                                           00281400
&ZW                   SETC  '&ZW.0'                                     00281500
.ZI16C                ANOP  ,                                           00281600
.*-------------------------------------------------------------------   00281700
.***AI.LVER02                                                           00281800
.ZI16Z                ANOP  ,                                           00281900
.*-------------------------------------------------------------------   00282000
.***AI.LVER01                                                           00282100
                      AIF  (&XPLISTVER LT 1).ZI17Z                      00282200
.*-------------------------------------------------------------------   00282300
.***AI.L08 XTYPE_OPTIONS "HOME"                                         00282400
.***      BL1'XXXX1XXX'                                                 00282500
         AIF   ('&XACCESS' NE 'HOME').ZI17A                             00282600
&ZW                   SETC  '&ZW.1000'                                  00282700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00282800
                      AGO   .ZI17C                                      00282900
.*                                                                      00283000
.ZI17A                ANOP  ,                                           00283100
&ZW                   SETC  '&ZW.0000'                                  00283200
.ZI17C                ANOP  ,                                           00283300
.*-------------------------------------------------------------------   00283400
.***AI.L11 XTYPE_OPTIONS BL1                                            00283500
                      AIF   ('&ZCLNG' NE 'YES').ZI17E  ALL ZERO BITS    00283600
&ZOPN                 SETA  &ZOPN+1                                     00283700
&ZOPL(&ZOPN)          SETC  ' '                                         00283800
&ZOPO(&ZOPN)          SETC  'OI'                                        00283900
&ZOPV(&ZOPN)          SETC  '52(1),B''&ZW'''                            00284000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00284100
.ZI17E                ANOP  ,                                           00284200
.*-------------------------------------------------------------------   00284300
.***AI.LVER02                                                           00284400
.ZI17Z                ANOP  ,                                           00284500
.*-------------------------------------------------------------------   00284600
.***AI.LVER01                                                           00284700
                      AIF  (&XPLISTVER LT 1).ZI18Z                      00284800
.*-------------------------------------------------------------------   00284900
.***AI.LVER02                                                           00285000
.ZI18Z                ANOP  ,                                           00285100
.*-------------------------------------------------------------------   00285200
.***AI.LVER01                                                           00285300
                      AIF  (&XPLISTVER LT 1).ZI19Z                      00285400
.*-------------------------------------------------------------------   00285500
.***AI.L25  XMONTKN XL4                                                 00285600
                      AIF   ('&ZXMONTKN' EQ '').ZI19E                   00285700
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI19E             00285800
&ZCGPR                SETC  '&XMONTKN'                                  00285900
.*                                                                      00286000
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI19B              00286100
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      00286200
                      AGO   .ZI19D                                      00286300
.ZI19B                ANOP  ,                                           00286400
.*                                                                      00286500
&ZC                   SETC  '&XMONTKN'(1,1)                             00286600
                      AIF   (T'&ZC NE 'N').ZI19D                        00286700
&ZC                   SETC  '&XMONTKN'                                  00286800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI19D               00286900
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          00287000
.*                                                                      00287100
.ZI19D                ANOP  ,                                           00287200
.*                                                                      00287300
&ZOPN                 SETA  &ZOPN+1                                     00287400
&ZOPL(&ZOPN)          SETC  ' '                                         00287500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00287600
&ZOPV(&ZOPN)          SETC  '56(4,1),&ZCGPR'                            00287700
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      00287800
.*                                                                      00287900
.ZI19E                ANOP  ,                                           00288000
.*-------------------------------------------------------------------   00288100
.***AI.LVER02                                                           00288200
.ZI19Z                ANOP  ,                                           00288300
.*-------------------------------------------------------------------   00288400
.***AI.LVER01                                                           00288500
                      AIF  (&XPLISTVER LT 2).ZI20Z                      00288600
.*-------------------------------------------------------------------   00288700
.***AI.L05 X_OPTIONS BL1                                                00288800
&ZW                   SETC  ''                                          00288900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00289000
.*-------------------------------------------------------------------   00289100
.***AI.LVER02                                                           00289200
.ZI20Z                ANOP  ,                                           00289300
.*-------------------------------------------------------------------   00289400
.***AI.LVER01                                                           00289500
                      AIF  (&XPLISTVER LT 2).ZI21Z                      00289600
.*-------------------------------------------------------------------   00289700
.***AI.L08 X_OPTIONS "YES"                                              00289800
.***      BL1'1XXXXXXX'                                                 00289900
         AIF   ('&XEXSTARTDEFER' NE 'YES').ZI21A                        00290000
&ZW                   SETC  '&ZW.1'                                     00290100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00290200
                      AGO   .ZI21C                                      00290300
.*                                                                      00290400
.ZI21A                ANOP  ,                                           00290500
&ZW                   SETC  '&ZW.0'                                     00290600
.ZI21C                ANOP  ,                                           00290700
.*-------------------------------------------------------------------   00290800
.***AI.LVER02                                                           00290900
.ZI21Z                ANOP  ,                                           00291000
.*-------------------------------------------------------------------   00291100
.***AI.LVER01                                                           00291200
                      AIF  (&XPLISTVER LT 2).ZI22Z                      00291300
.*-------------------------------------------------------------------   00291400
.***AI.L08 X_OPTIONS "EXPLICIT"                                         00291500
.***      BL1'X1XXXXXX'                                                 00291600
         AIF   ('&XESTRT' NE 'EXPLICIT').ZI22A                          00291700
&ZW                   SETC  '&ZW.1'                                     00291800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00291900
                      AGO   .ZI22C                                      00292000
.*                                                                      00292100
.ZI22A                ANOP  ,                                           00292200
&ZW                   SETC  '&ZW.0'                                     00292300
.ZI22C                ANOP  ,                                           00292400
.*-------------------------------------------------------------------   00292500
.***AI.LVER02                                                           00292600
.ZI22Z                ANOP  ,                                           00292700
.*-------------------------------------------------------------------   00292800
.***AI.LVER01                                                           00292900
                      AIF  (&XPLISTVER LT 2).ZI23Z                      00293000
.*-------------------------------------------------------------------   00293100
.***AI.L08 X_OPTIONS "EXPLICIT_SINGLE"                                  00293200
.***      BL1'XX1XXXXX'                                                 00293300
         AIF   ('&XESTRT' NE 'EXPLICIT_SINGLE').ZI23A                   00293400
&ZW                   SETC  '&ZW.1'                                     00293500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00293600
                      AGO   .ZI23C                                      00293700
.*                                                                      00293800
.ZI23A                ANOP  ,                                           00293900
&ZW                   SETC  '&ZW.0'                                     00294000
.ZI23C                ANOP  ,                                           00294100
.*-------------------------------------------------------------------   00294200
.***AI.LVER02                                                           00294300
.ZI23Z                ANOP  ,                                           00294400
.*-------------------------------------------------------------------   00294500
.***AI.LVER01                                                           00294600
                      AIF  (&XPLISTVER LT 2).ZI24Z                      00294700
.*-------------------------------------------------------------------   00294800
.***AI.L08 X_OPTIONS "NEVER"                                            00294900
.***      BL1'XXX1XXXX'                                                 00295000
         AIF   ('&XESTRT' NE 'NEVER').ZI24A                             00295100
&ZW                   SETC  '&ZW.10000'                                 00295200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00295300
                      AGO   .ZI24C                                      00295400
.*                                                                      00295500
.ZI24A                ANOP  ,                                           00295600
&ZW                   SETC  '&ZW.00000'                                 00295700
.ZI24C                ANOP  ,                                           00295800
.*-------------------------------------------------------------------   00295900
.***AI.L11 X_OPTIONS BL1                                                00296000
                      AIF   ('&ZCLNG' NE 'YES').ZI24E  ALL ZERO BITS    00296100
&ZOPN                 SETA  &ZOPN+1                                     00296200
&ZOPL(&ZOPN)          SETC  ' '                                         00296300
&ZOPO(&ZOPN)          SETC  'OI'                                        00296400
&ZOPV(&ZOPN)          SETC  '60(1),B''&ZW'''                            00296500
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00296600
.ZI24E                ANOP  ,                                           00296700
.*-------------------------------------------------------------------   00296800
.***AI.LVER02                                                           00296900
.ZI24Z                ANOP  ,                                           00297000
.*-------------------------------------------------------------------   00297100
.***AI.LVER01                                                           00297200
                      AIF  (&XPLISTVER LT 3).ZI25Z                      00297300
.*-------------------------------------------------------------------   00297400
.***AI.LVER02                                                           00297500
.ZI25Z                ANOP  ,                                           00297600
.*-------------------------------------------------------------------   00297700
.***AI.LVER01                                                           00297800
                      AIF  (&XPLISTVER LT 3).ZI26Z                      00297900
.*-------------------------------------------------------------------   00298000
.***AI.L19 ADDR XWORKREQ_HDL A                                          00298100
                      AIF   ('&ZXWORKREQ_HDL' EQ '').ZI26H              00298200
&ZCLNG                SETC  '&XWORKREQ_HDL'                             00298300
&ZCGPR                SETC  '14'                                        00298400
         AIF   ('&XWORKREQ_HDL'(1,1) EQ '(').ZI26F  IN GPR              00298500
.*                                                                      00298600
&ZOPN                 SETA  &ZOPN+1                                     00298700
&ZOPL(&ZOPN)          SETC  ' '                                         00298800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00298900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00299000
&ZOPD(&ZOPN)          SETC  '++ &ZXWORKREQ_HDL XWORKREQ_HDL'            00299100
.*                                                                      00299200
                      AGO   .ZI26G                                      00299300
.*                                                                      00299400
.ZI26F                ANOP  ,                                           00299500
&ZCGPR   SETC  '&XWORKREQ_HDL'(2,K'&XWORKREQ_HDL-2)                     00299600
.*                                                                      00299700
.ZI26G                ANOP  ,                                           00299800
.*                                                                      00299900
&ZOPN                 SETA  &ZOPN+1                                     00300000
&ZOPL(&ZOPN)          SETC  ' '                                         00300100
&ZOPO(&ZOPN)          SETC  'ST'                                        00300200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,64(,1)'                             00300300
&ZOPD(&ZOPN)          SETC  '++ &ZXWORKREQ_HDL XWORKREQ_HDL'            00300400
.*                                                                      00300500
.ZI26H                ANOP  ,                                           00300600
.*-------------------------------------------------------------------   00300700
.***AI.LVER02                                                           00300800
.ZI26Z                ANOP  ,                                           00300900
.*-------------------------------------------------------------------   00301000
&ZOPN1                SETA &ZOPN                                        00301100
.*******************************************************************    00301200
.***  PROCESS IWMECREA OUTPUT PARAMETERS                                00301300
.*******************************************************************    00301400
                      ACTR  10000                                       00301500
.*------------------------------------------------------------------    00301600
.***AO.L02 XETOKEN CL8                                                  00301700
         AIF   ('&ZXETOKEN' EQ 'OUTPUT').ZO10A  OUTPUT                  00301800
         AIF   ('&ZXETOKEN' NE 'INOUT').ZO10C  INOUT                    00301900
.ZO10A    AIF   ('&XETOKEN'(1,1) NE '(').ZO10B  ADDR IN GPR             00302000
&ZCGPR   SETC  '&XETOKEN'(2,K'&XETOKEN-2)                               00302100
&ZOPN                 SETA  &ZOPN+1                                     00302200
&ZOPL(&ZOPN)          SETC  ' '                                         00302300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00302400
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),40(1)'                         00302500
&ZOPD(&ZOPN)          SETC  '++ XETOKEN CL8'                            00302600
                      AGO   .ZO10C                                      00302700
.*                                                                      00302800
.ZO10B                ANOP  ,                                           00302900
&ZAWRK   SETA  K'&XETOKEN                                               00303000
         AIF   ('&XETOKEN'(&ZAWRK,1) NE ')').ZO10G                      00303100
&ZN      SETA  2                                                        00303200
.ZO10H    ANOP                                                          00303300
         AIF   (&ZN GE &ZAWRK).ZO10G                                    00303400
         AIF   ('&XETOKEN'(&ZN,1) NE '(').ZO10I                         00303500
&ZC      SETC  '&XETOKEN'(1,&ZN).'8'.','                                00303600
&ZC      SETC  '&ZC'.'&XETOKEN'(&ZN+1,&ZAWRK-&ZN).',40(1)'              00303700
         AGO   .ZO10J                                                   00303800
.ZO10I    ANOP                                                          00303900
&ZN      SETA  &ZN+1                                                    00304000
         AGO   .ZO10H                                                   00304100
.ZO10G    ANOP                                                          00304200
&ZC      SETC  '&XETOKEN.(8),40(1)'                                     00304300
.ZO10J    ANOP                                                          00304400
&ZOPN                 SETA  &ZOPN+1                                     00304500
&ZOPL(&ZOPN)          SETC  ' '                                         00304600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00304700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00304800
&ZOPD(&ZOPN)          SETC  '++ XETOKEN CL8'                            00304900
.ZO10C                ANOP  ,                                           00305000
.*******************************************************************    00305100
.***AO.X02  RETURN CODE PROCESSING                                      00305200
.*******************************************************************    00305300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00305400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00305500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00305600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00305700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00305800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00305900
&ZOPN                 SETA  &ZOPN+1                                     00306000
&ZOPL(&ZOPN)          SETC  ' '                                         00306100
&ZOPO(&ZOPN)          SETC  'ST'                                        00306200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00306300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00306400
                      AGO   .ZMRETX                                     00306500
.*                                                                      00306600
.ZMRET2               ANOP  ,                                           00306700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00306800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00306900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00307000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00307100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00307200
&ZOPN                 SETA  &ZOPN+1                                     00307300
&ZOPL(&ZOPN)          SETC  ' '                                         00307400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00307500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00307600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00307700
.ZMRETX               ANOP  ,                                           00307800
.*******************************************************************    00307900
.***AO.X03  REASON CODE PROCESSING                                      00308000
.*******************************************************************    00308100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00308200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00308300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00308400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00308500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00308600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00308700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00308800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00308900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00309000
&ZOPN                 SETA  &ZOPN+1                                     00309100
&ZOPL(&ZOPN)          SETC  ' '                                         00309200
&ZOPO(&ZOPN)          SETC  'ST'                                        00309300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00309400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00309500
                      AGO   .ZMRSNX                                     00309600
.*                                                                      00309700
.ZMRSN2               ANOP  ,                                           00309800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00309900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00310000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00310100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00310200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00310300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00310400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00310500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00310600
&ZOPN                 SETA  &ZOPN+1                                     00310700
&ZOPL(&ZOPN)          SETC  ' '                                         00310800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00310900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00311000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00311100
.ZMRSNX               ANOP  ,                                           00311200
.*******************************************************************    00311300
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00311400
.*******************************************************************    00311500
.ZMFLX                ANOP  ,              MF=L PROCESSING              00311600
.*******************************************************************    00311700
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00311800
.*******************************************************************    00311900
                      ACTR  10000                                       00312000
.*                                                                      00312100
                      LCLA  &ZLC           COLUMN POSITION              00312200
                      LCLA  &ZOPX          LIST TABLE INDEX             00312300
                      LCLC  &ZLL           LABEL                        00312400
                      LCLC  &ZLOP          OPERATION                    00312500
                      LCLC  &ZLV           VALUE                        00312600
                      LCLC  &ZLD           DESCRIPTION                  00312700
.*                                                                      00312800
&ZOPX                 SETA  1                                           00312900
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00313000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00313100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00313200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00313300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00313400
                      AIF   (K'&ZLD LE 0).ZL5                           00313500
&ZLC                  SETA  35             COMMENT COLUMN               00313600
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00313700
&ZLC                  SETA  33             COMMMENT COLUMN              00313800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00313900
&ZLV                  SETC  '&ZLV'.' '                                  00314000
                      AGO   .ZL3                                        00314100
.*                                                                      00314200
.ZL4                  ANOP  ,                                           00314300
&ZLV                  SETC  '&ZLV'.' '                                  00314400
.ZL5                  ANOP  ,                                           00314500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00314600
.*                                                                      00314700
&ZLL     &ZLOP &ZLV                                                     00314800
.*                                                                      00314900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00315000
                      AGO   .ZL2           CONTINUE LOOPING             00315100
.*                                                                      00315200
.ZLX                  ANOP  ,                                           00315300
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00315400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00315500
         L     14,16(0,0)              GET CVT ADDRESS                  00315600
.***CHECK FOR VERSION 0 @L1A                                            00315700
                      AIF  (&XPLISTVER EQ 0).VEROK                      00315800
.*-------------------------------------------------------------------   00315900
         TM    CVTOSLV1-CVT(14),X'04'  TEST FOR HBB6603 PRESENCE        00316000
         BNZ   VEROK&SYSNDX            BRANCH IF HBB6603 PRESENCE       00316100
         TM    52(1),X'80'             TEST FOR TYPE INDEPENDENT        00316200
         BNZ   VEROK&SYSNDX            BRANCH IF TYPE INDEPENDENT       00316300
         LA    0,IWMRSNCODEBADVERSION  SET REASON CODE = NO CONNECT     00316400
         LA    15,IWMRETCODEINVOCERROR SET WARNING RETURN CODE          00316500
         B     END&SYSNDX              BRANCH TO END LABEL              00316600
VEROK&SYSNDX DS    0H                  BRANCH LABEL FOR VERSION OK      00316700
.*-------------------------------------------------------------------   00316800
.VEROK                ANOP  ,                                           00316900
.*-------------------------------------------------------------------   00317000
         L     14,772(14,0)            GET SFT ADDRESS                  00317100
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       00317200
         LA    15,24                   GET EX FOR SERVICE ROUTINE       00317300
         OR    14,15                   GET PC NUMBER                    00317400
         AIF   ('&XESTRT' NE 'EXPLICIT_SINGLE').NOEXSIN            @P2A 00317500
         OI    60(1),X'60'             BOTH SINGLE AND EXPLICIT    @P2A 00317600
.NOEXSIN ANOP  ,                                                   @P2A 00317700
         PC    0(14)                   PC TO IWMW2CRE              @P2A 00317800
END&SYSNDX DS    0H                    END LABEL                        00317900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00318000
.ZLINKX               ANOP  ,                                           00318100
.*******************************************************************    00318200
.***AP.X01  FORMAT GENERATED CODE                                       00318300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00318400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00318500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00318600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00318700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00318800
                      AIF   (K'&ZLD LE 0).ZL51                          00318900
&ZLC                  SETA  35             COMMENT COLUMN               00319000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00319100
&ZLC                  SETA  33             COMMENT COLUMN               00319200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00319300
&ZLV                  SETC  '&ZLV'.' '                                  00319400
                      AGO   .ZL31                                       00319500
.*                                                                      00319600
.ZL41                 ANOP  ,                                           00319700
&ZLV                  SETC  '&ZLV'.' '                                  00319800
.ZL51                 ANOP  ,                                           00319900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00320000
.*                                                                      00320100
&ZLL     &ZLOP &ZLV                                                     00320200
.*                                                                      00320300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00320400
                      AGO   .ZL21          CONTINUE LOOPING             00320500
.*                                                                      00320600
.ZLX1                 ANOP  ,                                           00320700
.*******************************************************************    00320800
.***AP.X02  END OF IWMECREA MACRO                                       00320900
&ZIWMECREA            SETC  'YES'          SET IWMECREA USED            00321000
         POP   PRINT                                                    00321100
*                                            IWMECREA-3                 00321200
         SPACE 1                                                        00321300
.ZLX2                 ANOP  ,                                           00321400
         MEND                                                           00321500
**********************************************************************/ 00321600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00321700
*%IWMECREA: MACRO KEYS(TYPE,CLSFY,ARRIVALTIME,FUNCTION_NAME,            00321800
*                 EXSTARTDEFER,ESTRT,WORKREQ_HDL,MONTKN,ACCESS,ETOKEN,  00321900
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00322000
*  ANS('?'!!MACLABEL!!' '!!'IWMECREP '!!MACLIST!!                       00322100
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00322200
*%END IWMECREA;                                                         00322300

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMAEDEF                              -11/09/04-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  WLM Define Dynamic Application Environments   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 (C) COPYRIGHT IBM CORP. 2003, 2005                     * 00001200
*                                                                     * 00001300
* STATUS= HBB7720                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IWMAEDEF service defines dynamic application environments  * 00002100
*      to WLM. The service can be used by queue manager address       * 00002200
*      spaces to add new application environments after they          * 00002300
*      connected to WLM and to delete the dynamic application         * 00002400
*      environments before they disconnect from WLM.                  * 00002500
*                                                                     * 00002600
*      Furthermore, the service can be used to define the method how  * 00002700
*      server spaces should be resumed for static and dynamic         * 00002800
*      application environments.                                      * 00002900
*                                                                     * 00003000
*      Before using this service, the caller must connect to WLM      * 00003100
*      using the IWMCONN service, specifying Work_Manager=Yes, and    * 00003200
*      Queue_Manager=Yes.                                             * 00003300
*                                                                     * 00003400
*      A queuing manager must not insert requests for a dynamic and   * 00003500
*      static application environment with the same application       * 00003600
*      environment name concurrently.                                 * 00003700
*                                                                     * 00003800
*      Refer to z/OS MVS Workload Management Services for more        * 00003900
*      information.                                                   * 00004000
*                                                                     * 00004100
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00004200
*                                                                     * 00004300
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004400
*                                                                     * 00004500
*01* ENVIRONMENT:                                                     * 00004600
*                                                                     * 00004700
*                                                                     * 00004800
*      Minimum authorization: Supervisor state or program key mask    * 00004900
*                        (PKM) allowing keys 0-7.                     * 00005000
*                                                                     * 00005100
*      Dispatchable unit mode: Task or SRB mode.                      * 00005200
*                                                                     * 00005300
*      Cross Memory Mode: Any HASN, any SASN.  PASN must be the       * 00005400
*                        address space which connected to WLM (i.e.   * 00005500
*                        the address space that was home when IWMCONN * 00005600
*                        was issued for Queue_Manager=Yes, or         * 00005700
*                        Server_Manager=Yes with Server_Type=Queue).  * 00005800
*                                                                     * 00005900
*      AMODE:            31-bit.                                      * 00006000
*                                                                     * 00006100
*      ASC mode:         Primary.                                     * 00006200
*                                                                     * 00006300
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006400
*                                                                     * 00006500
*      Locks:            No locks held.                               * 00006600
*                                                                     * 00006700
*      Control parameters: Control parameters must be in the primary  * 00006800
*                        address space.                               * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*                                                                     * 00007200
*01* PROGRAMMING REQUIREMENTS:                                        * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*    1.  The macro CVT must be included to use this macro.            * 00007600
*                                                                     * 00007700
*    2.  The macro IWMYCON must be included to use this macro.        * 00007800
*                                                                     * 00007900
*    3.  The macro IWMPB must be in the library concatenation, since  * 00008000
*        it is included by IWMYCON.                                   * 00008100
*                                                                     * 00008200
*    4.  Note that the high order halfword of register 0, and the     * 00008300
*        reason code variable when specified, may be non-zero and     * 00008400
*        represents diagnostic data which is NOT part of the external * 00008500
*        interface.  The high order halfword should thus be excluded  * 00008600
*        from comparison with the reason code values described above. * 00008700
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00008800
*        be used for this purpose.                                    * 00008900
*                                                                     * 00009000
*    5.  All character data, unless otherwise specified, is assumed   * 00009100
*        to be left justified and padded with blanks on the right, as * 00009200
*        needed, to occupy the specified number of bytes.             * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*01* RESTRICTIONS:                                                    * 00009700
*                                                                     * 00009800
*                                                                     * 00009900
*    1.  This macro may not be used prior to the completion of WLM    * 00010000
*        address space initialization.                                * 00010100
*                                                                     * 00010200
*    2.  This macro may only be used on MVS/ESA HBB7705 or higher.    * 00010300
*                                                                     * 00010400
*    3.  FUNC=MODIFY and FUNC=ADD together with DISTRIBUTED_WORK may  * 00010500
*        only be used on MVS/ESA HBB7707 or higher.                   * 00010600
*                                                                     * 00010700
*                                                                     * 00010800
*                                                                     * 00010900
*01* INPUT REGISTER INFORMATION:                                      * 00011000
*                                                                     * 00011100
*    Before issuing the IWMAEDEF macro, the caller does not have to   * 00011200
*    place any information into any register unless using it in       * 00011300
*    register notation for a particular parameter, or using it as a   * 00011400
*    base register.                                                   * 00011500
*                                                                     * 00011600
*01* OUTPUT REGISTER INFORMATION:                                     * 00011700
*                                                                     * 00011800
*    When control returns to the caller, the GPRs contain:            * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*    REGISTER  CONTENTS                                               * 00012200
*                                                                     * 00012300
*    0         Reason code if GR15 return code is non-zero            * 00012400
*                                                                     * 00012500
*    1         Used as work register by the system                    * 00012600
*                                                                     * 00012700
*    2-13      Unchanged                                              * 00012800
*                                                                     * 00012900
*    14        Used as work register by the system                    * 00013000
*                                                                     * 00013100
*    15        Return code                                            * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*    When control returns to the caller, the ARs contain:             * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*    REGISTER  CONTENTS                                               * 00013900
*                                                                     * 00014000
*    0-1       Used as work registers by the system                   * 00014100
*                                                                     * 00014200
*    2-13      Unchanged                                              * 00014300
*                                                                     * 00014400
*    14-15     Used as work registers by the system                   * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*    Some callers depend on register contents remaining the same      * 00014900
*    before and after issuing a service.  If the system changes the   * 00015000
*    contents of registers on which the caller depends, the caller    * 00015100
*    must save them before issuing the service, and restore them      * 00015200
*    after the system returns control.                                * 00015300
*                                                                     * 00015400
*01* PERFORMANCE IMPLICATIONS:                                        * 00015500
*                                                                     * 00015600
*    None                                                             * 00015700
*                                                                     * 00015800
*01* SYNTAX:                                                          * 00015900
*                                                                     * 00016000
*Ýxlabel¨  IWMAEDEF     CONNTKN=xconntkn                              * 00016100
*                    Ð ,FUNC=ADD                                      * 00016200
*                    !     ,APPLENV=xapplenv                          * 00016300
*                    !     ,JCLPROC=xjclproc                          * 00016400
*                    !    Ý,JCLPARMS=»xjclparms!0º¨                   * 00016500
*                    !   ÐÝ,SINGLE_SERVER=NO¨                         * 00016600
*                    !   ¿Ý,SINGLE_SERVER=YES¨                        * 00016700
*                    !    Ý,SELECT_POLICY=»xselect_policy!0º¨         * 00016800
*                    !   ÐÝ,DISTRIBUTE_WORK=FIRST_AVAILABLE¨          * 00016900
*                    !   ¿Ý,DISTRIBUTE_WORK=ROUND_ROBIN¨              * 00017000
*                    Ô ,FUNC=DELETE                                   * 00017100
*                    !     ,APPLENV=xapplenv                          * 00017200
*                    ¿ ,FUNC=MODIFY                                   * 00017300
*                          ,APPLENV=xapplenv                          * 00017400
*                        ÐÝ,DISTRIBUTE_WORK=FIRST_AVAILABLE¨          * 00017500
*                        ¿Ý,DISTRIBUTE_WORK=ROUND_ROBIN¨              * 00017600
*                        ÐÝ,STATIC=NO¨                                * 00017700
*                        ¿Ý,STATIC=YES¨                               * 00017800
*                     Ý,RETCODE=xretcode¨                             * 00017900
*                     Ý,RSNCODE=xrsncode¨                             * 00018000
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00018100
*                    ÐÝ,MF=S¨                                         * 00018200
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00018300
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00018400
*                                                                     * 00018500
*                                                                     * 00018600
*      Where:                                                         * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*      Ýxlabel¨                                                       * 00019000
*          is an optional symbol, starting in column 1, that is the   * 00019100
*          name on the IWMAEDEF macro invocation.  The name must      * 00019200
*          conform to the rules for an ordinary assembler language    * 00019300
*          symbol.                                                    * 00019400
*          DEFAULT: No name.                                          * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*      CONNTKN=xconntkn                                               * 00020000
*          is the name (RS-type), or address in register (2)-(12), of * 00020100
*          a required 32 bit input which contains the connect token   * 00020200
*          returned by the IWMCONN macro.                             * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*      FUNC=»ADD!DELETE!MODIFYº                                       * 00020800
*          is a required keyword input indicates how the caller uses  * 00020900
*          the service                                                * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*          FUNC=ADD                                                   * 00021300
*              indicates that the caller wants to add a dynamic       * 00021400
*              application environment to WLM.                        * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*              APPLENV=xapplenv                                       * 00021800
*                  is the name (RS-type), or address in register      * 00021900
*                  (2)-(12), of a required 32 character input which   * 00022000
*                  contains the name of the dynamic application       * 00022100
*                  environment.                                       * 00022200
*                                                                     * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*              JCLPROC=xjclproc                                       * 00022700
*                  is the name (RS-type), or address in register      * 00022800
*                  (2)-(12), of a required 8 character input which    * 00022900
*                  contains the name of the start procedure which is  * 00023000
*                  used by WLM to start server manager address spaces * 00023100
*                  for the application environment.                   * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*              ÝJCLPARMS=»xjclparms!0º¨                               * 00023700
*                  is the name (RS-type), or address in register      * 00023800
*                  (2)-(12), of an optional 115 character input which * 00023900
*                  contains the parameters which are passed to the    * 00024000
*                  start procedure of the server manager address      * 00024100
*                  spaces by WLM.                                     * 00024200
*                  DEFAULT: 0                                         * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*                                                                     * 00024700
*              ÝSINGLE_SERVER=»NO!YESº¨                               * 00024800
*                  is an optional keyword input indicating whether    * 00024900
*                  one or multiple server spaces should be started    * 00025000
*                  for the application environment                    * 00025100
*                  DEFAULT: NO                                        * 00025200
*                                                                     * 00025300
*                                                                     * 00025400
*                  ÝSINGLE_SERVER=NO¨                                 * 00025500
*                      Multiple server spaces should be started for   * 00025600
*                      the application environment (default).         * 00025700
*                                                                     * 00025800
*                  ÝSINGLE_SERVER=YES¨                                * 00025900
*                      Only one server space should be started for    * 00026000
*                      the application environment.                   * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*              ÝSELECT_POLICY=»xselect_policy!0º¨                     * 00026800
*                  is the name (RS-type), or address in register      * 00026900
*                  (2)-(12), of an optional byte input which tells    * 00027000
*                  WLM how to select work if work requests are        * 00027100
*                  directly routed to the server address space. Only  * 00027200
*                  0,1 and 2 are valid select policies. 0 is the      * 00027300
*                  default which is also selected if an invalid       * 00027400
*                  policy is specified.                               * 00027500
*                                                                     * 00027600
*                  The select policy options 0,1 and 2 have the       * 00027700
*                  following meaning:                                 * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*                  o    0 Default, the oldest request on either the   * 00028100
*                      service class or server address space queue is * 00028200
*                      selected first.                                * 00028300
*                                                                     * 00028400
*                  o    1 The request on the server address space     * 00028500
*                      queue (if present) is selected first           * 00028600
*                      independently of the times the requests have   * 00028700
*                      been inserted.                                 * 00028800
*                                                                     * 00028900
*                  o    2 The request on the service class queue is   * 00029000
*                      always selected first.                         * 00029100
*                                                                     * 00029200
*                                                                     * 00029300
*                  DEFAULT: 0                                         * 00029400
*                                                                     * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*              ÝDISTRIBUTE_WORK=»FIRST_AVAILABLE!ROUND_ROBINº¨        * 00029900
*                  is an optional keyword input controls how workload * 00030000
*                  management resumes bound server spaces that are    * 00030100
*                  waiting for work                                   * 00030200
*                  DEFAULT: FIRST_AVAILABLE                           * 00030300
*                                                                     * 00030400
*                                                                     * 00030500
*                  ÝDISTRIBUTE_WORK=FIRST_AVAILABLE¨                  * 00030600
*                      Workload management wakes up the server space  * 00030700
*                      that has been suspended first (default).       * 00030800
*                                                                     * 00030900
*                  ÝDISTRIBUTE_WORK=ROUND_ROBIN¨                      * 00031000
*                      Workload management wakes up the server space  * 00031100
*                      that has the smallest number of affinities. If * 00031200
*                      there are several server spaces with the same  * 00031300
*                      number of affinities, workload management will * 00031400
*                      start the server space with the smallest       * 00031500
*                      number of active server tasks.                 * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*          FUNC=DELETE                                                * 00032200
*              indicates that the caller wants to delete its interest * 00032300
*              in the dynamic application environment.                * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*              APPLENV=xapplenv                                       * 00032700
*                  is the name (RS-type), or address in register      * 00032800
*                  (2)-(12), of a required 32 character input which   * 00032900
*                  contains the name of the dynamic application       * 00033000
*                  environment.                                       * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*          FUNC=MODIFY                                                * 00033500
*              indicates that the caller wants to redefine the method * 00033600
*              how server spaces should be resumed for static and     * 00033700
*              dynamic application environments.                      * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*              APPLENV=xapplenv                                       * 00034100
*                  is the name (RS-type), or address in register      * 00034200
*                  (2)-(12), of a required 32 character input which   * 00034300
*                  contains the name of the static or dynamic         * 00034400
*                  application environment.                           * 00034500
*                                                                     * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*                                                                     * 00034900
*              ÝDISTRIBUTE_WORK=»FIRST_AVAILABLE!ROUND_ROBINº¨        * 00035000
*                  is an optional keyword input controls how workload * 00035100
*                  management resumes bound server spaces that are    * 00035200
*                  waiting for work                                   * 00035300
*                  DEFAULT: FIRST_AVAILABLE                           * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*                  ÝDISTRIBUTE_WORK=FIRST_AVAILABLE¨                  * 00035700
*                      Workload management wakes up the server space  * 00035800
*                      that has been suspended first (default).       * 00035900
*                                                                     * 00036000
*                  ÝDISTRIBUTE_WORK=ROUND_ROBIN¨                      * 00036100
*                      Workload management wakes up the server space  * 00036200
*                      that has the smallest number of affinities. If * 00036300
*                      there are several server spaces with the same  * 00036400
*                      number of affinities, workload management will * 00036500
*                      start the server space with the smallest       * 00036600
*                      number of active server tasks.                 * 00036700
*                                                                     * 00036800
*                                                                     * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*                                                                     * 00037200
*                                                                     * 00037300
*              ÝSTATIC=»NO!YESº¨                                      * 00037400
*                  is an optional keyword input controls whether a    * 00037500
*                  static or dynamic application environment should   * 00037600
*                  be updated                                         * 00037700
*                  DEFAULT: NO                                        * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                  ÝSTATIC=NO¨                                        * 00038100
*                      indicates that the caller wants to modify a    * 00038200
*                      dynamic application environment (default).     * 00038300
*                                                                     * 00038400
*                  ÝSTATIC=YES¨                                       * 00038500
*                      indicates that the caller wants to modify a    * 00038600
*                      static application environment.                * 00038700
*                                                                     * 00038800
*                                                                     * 00038900
*                                                                     * 00039000
*                                                                     * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*                                                                     * 00039700
*      ÝRETCODE=xretcode¨                                             * 00039800
*          is the name (RS-type) of an optional fullword output       * 00039900
*          variable, or register (2)-(12), into which the return code * 00040000
*          is to be copied from GPR 15.                               * 00040100
*                                                                     * 00040200
*                                                                     * 00040300
*                                                                     * 00040400
*                                                                     * 00040500
*      ÝRSNCODE=xrsncode¨                                             * 00040600
*          is the name (RS-type) of an optional fullword output       * 00040700
*          variable, or register (2)-(12), into which the reason code * 00040800
*          is to be copied from GPR 0.                                * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00041400
*          is an optional byte input decimal value in the "0-1" range * 00041500
*          that specifies the macro version.  PLISTVER is the only    * 00041600
*          key allowed on the list form of MF and determines which    * 00041700
*          parameter list is generated.  The macro keys associated    * 00041800
*          with each supported version of the macro are listed in     * 00041900
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00042000
*          instead of a number, and the parameter list will be of the * 00042100
*          largest size currently supported. This size may grow from  * 00042200
*          release to release (thus possibly affecting the amount of  * 00042300
*          storage needed by your program).  If your program can      * 00042400
*          tolerate this, IBM recommends that you always specify MAX  * 00042500
*          when creating the list form parameter list as that will    * 00042600
*          ensure that the list form parameter list is always long    * 00042700
*          enough to hold whatever parameters might be specified on   * 00042800
*          the execute form.                                          * 00042900
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00043000
*          default is the lowest version which allows all of the      * 00043100
*          parameters specified on the invocation to be processed.    * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*      ÝMF=»S!L!Eº¨                                                   * 00043700
*          is an optional keyword input which specifies the macro     * 00043800
*          form.                                                      * 00043900
*          DEFAULT: S                                                 * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*          ÝMF=S¨                                                     * 00044300
*              specifies the standard form of the macro.  The "S"     * 00044400
*              form generates code to put the parameters into an      * 00044500
*              in-line parameter list and invoke the desired service. * 00044600
*              Full checking for required macro keys is done along    * 00044700
*              with supplying defaults for omitted optional           * 00044800
*              parameters.                                            * 00044900
*                                                                     * 00045000
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00045100
*              specifies the list form of the macro.  The "L" form    * 00045200
*              defines an area to be used for the parameter list.     * 00045300
*              Only the PLISTVER key may be specified on the          * 00045400
*              invocation.  All other macro parameters are flagged as * 00045500
*              errors.  If PLISTVER is not specified, the original    * 00045600
*              parameter list definition is used.                     * 00045700
*                                                                     * 00045800
*            ,xmfctrl                                                 * 00045900
*              is a required input.  It is the name of a storage area * 00046000
*              for the parameter list.                                * 00046100
*                                                                     * 00046200
*            »,xmfattr!0Dº                                            * 00046300
*              is an optional 60 character input string that varies   * 00046400
*              from 1 to 60 characters. Use it to force boundary      * 00046500
*              alignment of the parameter list. Use only 0F or 0D.    * 00046600
*              DEFAULT: 0D which forces the parameter list to a       * 00046700
*              doubleword boundary.                                   * 00046800
*                                                                     * 00046900
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00047000
*              specifies the execute form of the macro.  The "E" form * 00047100
*              generates code to put the parameters into the          * 00047200
*              parameter list specified by xmfctrl and provides full  * 00047300
*              syntax checking with default setting.                  * 00047400
*                                                                     * 00047500
*            ,xmfctrl                                                 * 00047600
*              is a required input.  It is the name (RS-type), or     * 00047700
*              address in register (1)-(12), of a storage area for    * 00047800
*              the parameter list.                                    * 00047900
*                                                                     * 00048000
*            »,COMPLETEº                                              * 00048100
*              is an optional keyword input which specifies the       * 00048200
*              degree of macro parameter syntax checking.             * 00048300
*              DEFAULT: COMPLETE                                      * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*              COMPLETE                                               * 00048700
*                  Checking for required macro keys is done and       * 00048800
*                  defaults are supplied for omitted optional         * 00048900
*                  parameters.                                        * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*                                                                     * 00049300
*                                                                     * 00049400
*                                                                     * 00049500
*                                                                     * 00049600
*                                                                     * 00049700
*01* ABEND CODES:  None.                                              * 00049800
*                                                                     * 00049900
*01* RETURN CODES:                                                    * 00050000
*                                                                     * 00050100
*                                                                     * 00050200
*            0    Name: IwmRetCodeOk                                  * 00050300
*                                                                     * 00050400
*                 Meaning: Successful completion.                     * 00050500
*                                                                     * 00050600
*                 Action: None required.                              * 00050700
*                                                                     * 00050800
*                                                                     * 00050900
*            8    Name: IwmRetCodeInvocError                          * 00051000
*                                                                     * 00051100
*                 Meaning: Invalid invocation environment or          * 00051200
*                 parameters.                                         * 00051300
*                                                                     * 00051400
*                                                                     * 00051500
*                 HEX REASON  MEANING/ACTION                          * 00051600
*                 CODE                                                * 00051700
*                                                                     * 00051800
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00051900
*                                                                     * 00052000
*                             Meaning: Caller is disabled.            * 00052100
*                                                                     * 00052200
*                             Action: Avoid requesting this function  * 00052300
*                             while disabled.                         * 00052400
*                                                                     * 00052500
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00052600
*                                                                     * 00052700
*                             Meaning: Caller is locked.              * 00052800
*                                                                     * 00052900
*                             Action: Avoid requesting this function  * 00053000
*                             while locked.                           * 00053100
*                                                                     * 00053200
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00053300
*                                                                     * 00053400
*                             Meaning: Error accessing parameter      * 00053500
*                             list.                                   * 00053600
*                                                                     * 00053700
*                             Action: Check for possible storage      * 00053800
*                             overlay.  Also check if you call this   * 00053900
*                             macro in 64 bit adressing mode (see     * 00054000
*                             explanations for xxxx089E).             * 00054100
*                                                                     * 00054200
*                 xxxx0821    Name: IwmRsnCodeBadConn                 * 00054300
*                                                                     * 00054400
*                             Meaning: Input connect token does not   * 00054500
*                             pass validity checking.                 * 00054600
*                                                                     * 00054700
*                             Action: Make sure to use the connect    * 00054800
*                             token returned by the IWMCONN service   * 00054900
*                             requesting Queue_Manager=Yes, or        * 00055000
*                             Server_Manager=Yes with                 * 00055100
*                             Server_Type=Queue.                      * 00055200
*                                                                     * 00055300
*                 xxxx0823    Name: IwmRsnCodeDatoff                  * 00055400
*                                                                     * 00055500
*                             Meaning: Caller invoked service while   * 00055600
*                             DATOFF                                  * 00055700
*                                                                     * 00055800
*                             Action: Avoid requesting this function  * 00055900
*                             in this environment.                    * 00056000
*                                                                     * 00056100
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 00056200
*                                                                     * 00056300
*                             Meaning: Caller invoked service but was * 00056400
*                             in 24 bit addressing mode.              * 00056500
*                                                                     * 00056600
*                             Action: Request this function only when * 00056700
*                             you are in 31 bit addressing mode.      * 00056800
*                                                                     * 00056900
*                 xxxx0825    Name: IwmRsnCodeAscModeNotPrimary       * 00057000
*                                                                     * 00057100
*                             Meaning: Caller invoked service but was * 00057200
*                             not in primary ASC mode.                * 00057300
*                                                                     * 00057400
*                             Action: Avoid requesting this function  * 00057500
*                             in this environment.                    * 00057600
*                                                                     * 00057700
*                 xxxx0827    Name: IwmRsnCodeRsvdNot0                * 00057800
*                                                                     * 00057900
*                             Meaning: Reserved field in parameter    * 00058000
*                             list was non-zero.                      * 00058100
*                                                                     * 00058200
*                             Action:  Check for use of keywords that * 00058300
*                             are not supported by the MVS release on * 00058400
*                             which the program is running.           * 00058500
*                                                                     * 00058600
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00058700
*                                                                     * 00058800
*                             Meaning: Version number in parameter    * 00058900
*                             list is not valid.                      * 00059000
*                                                                     * 00059100
*                             Action: Check for possible storage      * 00059200
*                             overlay of the parameter list.          * 00059300
*                                                                     * 00059400
*                 xxxx083F    Name: IwmRsnCodePrimaryNotOwnConn       * 00059500
*                                                                     * 00059600
*                             Meaning: Primary address space does not * 00059700
*                             own the passed connect token.           * 00059800
*                                                                     * 00059900
*                             Action: Ensure that the primary address * 00060000
*                             space has previously connected to WLM   * 00060100
*                             using the IWMCONN macro.  Ensure that   * 00060200
*                             the connect token returned by the       * 00060300
*                             IWMCONN macro is passed to the IWMAEDEF * 00060400
*                             macro.                                  * 00060500
*                                                                     * 00060600
*                 xxxx0840    Name: IwmRsnCodeServiceNotEnabled       * 00060700
*                                                                     * 00060800
*                             Meaning: Caller's space connection is   * 00060900
*                             not enabled for this service.           * 00061000
*                                                                     * 00061100
*                             Action: Make sure that                  * 00061200
*                             Queue_Manager=Yes, or                   * 00061300
*                             Server_Manager=Yes with                 * 00061400
*                             Server_Type=Queue is specified on the   * 00061500
*                             IWMCONN request to enable this service. * 00061600
*                                                                     * 00061700
*                 xxxx0842    Name: IwmRsnCodeNoWLMConnect            * 00061800
*                                                                     * 00061900
*                             Meaning: Caller's space disconnected    * 00062000
*                             from WLM during processing of the       * 00062100
*                             request.                                * 00062200
*                                                                     * 00062300
*                             Action: None.                           * 00062400
*                                                                     * 00062500
*                 xxxx0890    Name: IwmRsnCodeApplEnvExists           * 00062600
*                                                                     * 00062700
*                             Meaning:  The caller tried to add an    * 00062800
*                             application environment that has        * 00062900
*                             already been defined.  subsystem type.  * 00063000
*                                                                     * 00063100
*                             Action: Check whether the correct       * 00063200
*                             application environment name is being   * 00063300
*                             used.  Make sure that a unique          * 00063400
*                             application environment name is used    * 00063500
*                             when adding application environments.   * 00063600
*                                                                     * 00063700
*                 xxxx0891    Name: IwmRsnCodeApplEnvNotFound         * 00063800
*                                                                     * 00063900
*                             Meaning:  The caller tried to delete or * 00064000
*                             modify an application environment that  * 00064100
*                             does not exist.                         * 00064200
*                                                                     * 00064300
*                             Action: Check whether the correct       * 00064400
*                             application environment name is being   * 00064500
*                             used.                                   * 00064600
*                                                                     * 00064700
*                 xxxx089E    Name: IwmRsnCodeServiceAModeMismatch    * 00064800
*                                                                     * 00064900
*                             Meaning:  The caller works in 64-bit    * 00065000
*                             address mode and tried to invoke a      * 00065100
*                             service macro that is only enabled for  * 00065200
*                             a 31-bit address environment.           * 00065300
*                                                                     * 00065400
*                             Action:  Use the 64-bit enabled service * 00065500
*                             macro (IWM4AEDF) or change the          * 00065600
*                             addressing mode of the caller to        * 00065700
*                             31-bit.                                 * 00065800
*                                                                     * 00065900
*                                                                     * 00066000
*                                                                     * 00066100
*                                                                     * 00066200
*            C    Name: IwmRetCodeEnvError                            * 00066300
*                                                                     * 00066400
*                 Meaning: Environmental error.                       * 00066500
*                                                                     * 00066600
*                                                                     * 00066700
*                 HEX REASON  MEANING/ACTION                          * 00066800
*                 CODE                                                * 00066900
*                                                                     * 00067000
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 00067100
*                                                                     * 00067200
*                             Meaning: Storage is not available for   * 00067300
*                             the request.                            * 00067400
*                                                                     * 00067500
*                             Action: Contact your system programmer. * 00067600
*                             There is a common storage shortage.     * 00067700
*                                                                     * 00067800
*                                                                     * 00067900
*                                                                     * 00068000
*                                                                     * 00068100
*            10   Name: IwmRetCodeCompError                           * 00068200
*                                                                     * 00068300
*                 Meaning: Component error.                           * 00068400
*                                                                     * 00068500
*                 Action: Contact your system programmer.             * 00068600
*                                                                     * 00068700
*                                                                     * 00068800
*                                                                     * 00068900
*01* REASON CODES:                                                    * 00069000
*                                                                     * 00069100
*       A unique reason code will be returned whenever the return     * 00069200
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00069300
*       under their corresponding return code.  Reason code and       * 00069400
*       return code constants are defined within IWMYCON.  Note that  * 00069500
*       the high order halfword of register 0, and the reason code    * 00069600
*       variable when specified, may be non-zero and represents       * 00069700
*       diagnostic data which is NOT part of the external interface.  * 00069800
*       The high order halfword should thus be excluded from          * 00069900
*       comparison with the reason code values described above.  The  * 00070000
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00070100
*       used for this purpose.                                        * 00070200
*                                                                     * 00070300
*01* MODULE TYPE:  ASSEM MACRO                                        * 00070400
*                                                                     * 00070500
*02*   PROCESSOR:  ASSEM                                              * 00070600
*                                                                     * 00070700
*01* COMPONENT:  SCWLM                                                * 00070800
*                                                                     * 00070900
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00071000
*                                                                     * 00071100
*01* EXAMPLES:                                                        * 00071200
*                                                                     * 00071300
*    To add a dynamic application environment:                        * 00071400
*                                                                     * 00071500
*               IWMAEDEF CONNTKN=CONNTOKEN,                         X * 00071600
*                        FUNC=ADD,                                  X * 00071700
*                        APPLENV=APPLENV                            X * 00071800
*                        JCLPROC=JCLPROC                            X * 00071900
*                        RETCODE=RC,RSNCODE=RSN                       * 00072000
*      *                                                              * 00072100
*      * Storage areas                                                * 00072200
*      *                                                              * 00072300
*      CONNTOKEN DS   FL4             Contains the connect token      * 00072400
*      *                              associated with the use of WLM  * 00072500
*      *                              Queuing services as returned by * 00072600
*      *                              IWMCONN                         * 00072700
*      APPLENV  DS    CL32            Contains the application        * 00072800
*      *                              environment name                * 00072900
*      JCLPROC  DS    CL8             Contains the name of the        * 00073000
*      *                              start procedure                 * 00073100
*      RC       DS    F               Return code                     * 00073200
*      RSN      DS    F               Reason code                     * 00073300
*                                                                     * 00073400
*                                                                     * 00073500
*01* MACRO USAGE NOTES:                                               * 00073600
*                                                                     * 00073700
*                                                                     * 00073800
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00073900
*        global macro variable.  Any value other than 'NO' will       * 00074000
*        result in the macro expansion being printed.  The default is * 00074100
*        'YES'.  The following examples illustrate how the ZPRINT     * 00074200
*        variable should be set.                                      * 00074300
*                                                                     * 00074400
*                    GBLC &ZPRINT                                     * 00074500
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00074600
*                                                                     * 00074700
*                                                                     * 00074800
*    2.  The IWMAEDEF macro supports multiple versions. The macro key * 00074900
*        list  below  contains the version level in which the key was * 00075000
*        first  introduced.  Positionals  are  identified by the word * 00075100
*        'Positional'  followed by the numeric value of its position. * 00075200
*        Nested  positionals  are  preceded  by their outer key.  The * 00075300
*        lowest value represents the original version and the highest * 00075400
*        value  represents  the  most  recent version of the IWMAEDEF * 00075500
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00075600
*        least  as high as the highest version number of all the keys * 00075700
*        being used.                                                  * 00075800
*                                                                     * 00075900
*        VERSION   KEY                                                * 00076000
*                                                                     * 00076100
*              0      APPLENV                                         * 00076200
*                     CONNTKN                                         * 00076300
*                     FUNC                                            * 00076400
*                     JCLPARMS                                        * 00076500
*                     JCLPROC                                         * 00076600
*                     SELECT_POLICY                                   * 00076700
*                     SINGLE_SERVER                                   * 00076800
*              1      DISTRIBUTE_WORK                                 * 00076900
*                     STATIC                                          * 00077000
*                                                                     * 00077100
*                                                                     * 00077200
*                                                                     * 00077300
*01* CHANGE ACTIVITY:                                                 * 00077400
*                                                                     * 00077500
*   Flag LineItem  FMID    Date   ID    Comment                       * 00077600
*                                                                     * 00077700
*    $L0=WLMP     HBB7708 020331 3241UH:  Dynamic Application         * 00077800
*                                         Environment Support         * 00077900
*    $L1=WLMPSSP  HBB7709 030930 3241JK:  OA04699 - Stateful Session  * 00078000
*                                         Placement (Rollback to      * 00078100
*                                         HBB7707)                    * 00078200
*    $L2=ME00696  HBB7720 040530 3241NN:  IWM4AEDF created. Please do * 00078300
*                                         not change this macro any   * 00078400
*                                         longer.                     * 00078500
*    $P1=ME02076  HBB7720 041015 3241NN:  Added reason code for       * 00078600
*                                         callers in AMODE 64.        * 00078700
*                                         Specific to 31-bit version. * 00078800
****** END OF SPECIFICATIONS *****************************************/ 00078900
*/********************************************************************* 00079000
         MACRO                                                          00079100
&XLABEL  IWMAEDEF &CONNTKN=,&FUNC=,&APPLENV=,&JCLPROC=,&JCLPARMS=,     *00079200
               &SINGLE_SERVER=,&SELECT_POLICY=,&DISTRIBUTE_WORK=,      *00079300
               &STATIC=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=             00079400
.*                                                                      00079500
*                     MACDATE -11/09/04-<1>                             00079600
.*                                                                      00079700
.*******************************************************************    00079800
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00079900
.*******************************************************************    00080000
                     GBLC  &ZPRINT     YES=PRINT NO=NO PRINT            00080100
                     GBLC  &ZTEST      YES=TEST NO=NO TEST              00080200
                     GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX      00080300
.*                                                                      00080400
                     GBLC  &ZIWMAEDEF  YES=MACRO USED AT LEAST ONCE     00080500
.*******************************************************************    00080600
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00080700
.*******************************************************************    00080800
                     LCLC  &ZMS        ERROR MESSAGE WORK AREA          00080900
                     LCLC  &ZCNDX      SYSNDX CHARACTERS                00081000
                     LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED       00081100
                     LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR      00081200
                     LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE      00081300
                     LCLA  &ZAWRK      USED AS A WORK AREA              00081400
                     LCLA  &ZASIZ      USED FOR SIZE OF VALUE           00081500
                     LCLA  &ZN         NUMERIC WORK VARIABLE            00081600
                     LCLC  &ZC         CHARACTER WORK VARIABLE          00081700
                     LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE      00081800
                     LCLA  &ZTLA       VALUE TOO LONG VARIABLE          00081900
                     LCLC  &ZMAC_G     "G" or null                      00082000
&ZMAC_G              SETC  ''                                           00082100
                     LCLC  &ZMAC_LR                                     00082200
&ZMAC_LR             SETC  'LR'                                         00082300
                     LCLC  &ZMAC_L                                      00082400
&ZMAC_L              SETC  'L'                                          00082500
                     LCLC  &ZMAC_ST                                     00082600
&ZMAC_ST             SETC  'ST'                                         00082700
                     LCLA  &ZMACRET    MACRO RETURN CODE                00082800
&ZMACRET             SETA  0           ASSUME NO ERRORS                 00082900
.*                                                                      00083000
                     LCLC  &ZCSYSLIST(255)      NONXKEY, POS ARRAY      00083100
                     LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()       00083200
                     LCLA  &ZPLLEN     PARAMETER LIST LENGTH            00083300
                     LCLC  &ZENDBASEPL          End of base PL          00083400
                     LCLA  &ZPLWORKA   PARAMETER LIST LENGTH            00083500
.*******************************************************************    00083600
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00083700
.*******************************************************************    00083800
                     LCLA  &ZI         INDEX FOR ARRAY                  00083900
                     LCLA  &ZJ         INDEX FOR PARMS                  00084000
                     LCLA  &ZK         INDEX FOR PARSE                  00084100
                     LCLA  &ZLO        LOW RANGE VALUE                  00084200
                     LCLA  &ZHI        HIGH RANGE VALUE                 00084300
                     LCLC  &ZW         WORK AREA FOR PARM               00084400
.********************************************************************   00084500
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00084600
.********************************************************************   00084700
                     GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL          00084800
                     GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE   00084900
                     GBLA  &SYSALVL    SYSSTATE ARCHLVL                 00085000
                     GBLC  &SYSAM64    SYSSTATE AMODE64                 00085100
.*                                                                      00085200
                     AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED   00085300
                     AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED    00085400
                     SPLEVEL  TEST                                      00085500
.ZSYS2               ANOP  ,                                            00085600
                     AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1        00085700
                     AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1        00085800
                     SYSSTATE TEST                                      00085900
                     AGO   .ZSYS4                                       00086000
.ZSYS3               ANOP  ,                                            00086100
&SYSASCE             SETC  'P'         ASSUME SYSSTATE PRIMARY          00086200
.ZSYS4               ANOP  ,                                            00086300
.*******************************************************************    00086400
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00086500
.*******************************************************************    00086600
                     LCLC  &XCONNTKN   ++ NAME                          00086700
                     LCLC  &XFUNC      ++ VALUE                         00086800
                     LCLC  &XAPPLENV   ++ NAME                          00086900
                     LCLC  &XJCLPROC   ++ NAME                          00087000
                     LCLC  &XJCLPARMS  ++ NAME                          00087100
                     LCLC  &XSINGLE_SERVER      ++ VALUE                00087200
                     LCLC  &XSELECT_POLICY      ++ NAME                 00087300
                     LCLC  &XDISTRIBUTE_WORK    ++ VALUE                00087400
                     LCLC  &XSTATIC    ++ VALUE                         00087500
                     LCLC  &XRETCODE   ++ NAME                          00087600
                     LCLC  &XRSNCODE   ++ NAME                          00087700
                     LCLA  &XPLISTVER  ++ VALUE                         00087800
                     LCLC  &XMF        ++ VALUE                         00087900
                     LCLC  &XMFCTRL    ++ NAME                          00088000
                     LCLC  &XMFATTR    ++ VALUE                         00088100
                     LCLC  &XMFSCK     ++ VALUE                         00088200
.*******************************************************************    00088300
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00088400
.*******************************************************************    00088500
                     LCLC  &ZXCONNTKN  ++ INPUT NAME                    00088600
                     LCLC  &ZXFUNC     ++ INPUT VALUE                   00088700
                     LCLC  &ZXAPPLENV  ++ INPUT NAME                    00088800
                     LCLC  &ZXJCLPROC  ++ INPUT NAME                    00088900
                     LCLC  &ZXJCLPARMS          ++ INPUT NAME           00089000
                     LCLC  &ZXSINGLE_SERVER     ++ INPUT VALUE          00089100
                     LCLC  &ZXSELECT_POLICY     ++ INPUT NAME           00089200
                     LCLC  &ZXDISTRIBUTE_WORK   ++ INPUT VALUE          00089300
                     LCLC  &ZXSTATIC   ++ INPUT VALUE                   00089400
                     LCLC  &ZXRETCODE  ++ OUTPUT NAME                   00089500
                     LCLC  &ZXRSNCODE  ++ OUTPUT NAME                   00089600
                     LCLC  &ZXPLISTVER          ++ INPUT VALUE          00089700
                     LCLC  &ZXMF       ++ INPUT VALUE                   00089800
                     LCLC  &ZXMFCTRL   ++ INPUT NAME                    00089900
                     LCLC  &ZXMFATTR   ++ INPUT VALUE                   00090000
                     LCLC  &ZXMFSCK    ++ INPUT VALUE                   00090100
.********************************************************************   00090200
.***AC.PLV01  PROCESS PLISTVER                                      *   00090300
.********************************************************************   00090400
&XPLISTVER      SETA  0                                                 00090500
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00090600
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00090700
&XPLISTVER      SETA  1                                                 00090800
.ZPLV0          ANOP  ,                                                 00090900
.*                                                                      00091000
                AIF   ('&DISTRIBUTE_WORK' EQ '').ZPLV1E                 00091100
                AIF   (&XPLISTVER GE 1).ZPLV1E                          00091200
&XPLISTVER      SETA  1                                                 00091300
.ZPLV1E         ANOP  ,                                                 00091400
.*                                                                      00091500
                AIF   ('&DISTRIBUTE_WORK' EQ '').ZPLV2E                 00091600
                AIF   (&XPLISTVER GE 1).ZPLV2E                          00091700
&XPLISTVER      SETA  1                                                 00091800
.ZPLV2E         ANOP  ,                                                 00091900
.*                                                                      00092000
                AIF   ('&STATIC' EQ '').ZPLV3E                          00092100
                AIF   (&XPLISTVER GE 1).ZPLV3E                          00092200
&XPLISTVER      SETA  1                                                 00092300
.ZPLV3E         ANOP  ,                                                 00092400
.*                                                                      00092500
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00092600
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00092700
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00092800
.*-------------------------------------------------------------------   00092900
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00093000
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00093100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00093200
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00093300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00093400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00093500
                AGO   .ZPVCK2                                           00093600
.ZPVCK3         ANOP  ,                                                 00093700
.*-------------------------------------------------------------------   00093800
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00093900
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00094000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00094100
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00094200
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00094300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00094400
                AGO   .ZPVCKE                                           00094500
.ZPVCK2         ANOP  ,                                                 00094600
.*-------------------------------------------------------------------   00094700
&ZCVAL          SETC  '&PLISTVER(1)'                                    00094800
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00094900
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00095000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00095100
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00095200
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00095300
.ZPVCK6         ANOP  ,                                                 00095400
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00095500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00095600
&ZMS            SETC  '&ZMS THE RANGE IS "0-1"'                         00095700
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00095800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00095900
&XPLISTVER      SETA  1                                                 00096000
                AGO   .ZPVCKE                                           00096100
.*-------------------------------------------------------------------   00096200
.ZPVCK4A        ANOP  ,                                                 00096300
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00096400
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00096500
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00096600
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00096700
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00096800
                MNOTE 8,' &ZMS IS REQUIRED.'                            00096900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00097000
                AGO   .ZPVCK5                                           00097100
.ZPVCK4         ANOP  ,                                                 00097200
&XPLISTVER      SETA  &PLISTVER(1)                                      00097300
.ZPVCK5         ANOP  ,                                                 00097400
.ZPVCKE         ANOP  ,                                                 00097500
.********************************************************************   00097600
.***AG.MF01 PROCESS MF MACRO FORMS                                      00097700
.********************************************************************   00097800
                     ACTR  10000                                        00097900
.*------------------------------------------------------------------    00098000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098100
&XMF                 SETC  ''          INITIALIZE XVARIABLE             00098200
.*-------------------------------------------------------------------   00098300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098400
.ZG59                ANOP  ,                                            00098500
&ZTLC                SETC 'S'                                           00098600
                     AIF   ('&MF(1)' NE '&ZTLC').ZG60                   00098700
&XMF                 SETC  'S'         SET KEYWORD                      00098800
                     AIF   (N'&MF LE 1).ZG59A   CK NUM                  00098900
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00099000
&ZMS                 SETC  '&ZMS.&MF"'                                  00099100
&ZMS                 SETC  '&ZMS "MF"'                                  00099200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00099300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00099400
.ZG59A               ANOP  ,                                            00099500
.*-------------------------------------------------------------------   00099600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099700
.ZG60                ANOP  ,                                            00099800
&ZTLC                SETC 'L'                                           00099900
                     AIF   ('&MF(1)' NE '&ZTLC').ZG67                   00100000
&XMF                 SETC  'L'         SET KEYWORD                      00100100
                     AIF   (N'&MF LE 3).ZG60A   CK NUM                  00100200
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00100300
&ZMS                 SETC  '&ZMS.&MF"'                                  00100400
&ZMS                 SETC  '&ZMS "MF"'                                  00100500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00100600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00100700
.ZG60A               ANOP  ,                                            00100800
.*-------------------------------------------------------------------   00100900
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00101000
                     AIF   (N'&SYSLIST NE 0).ZG60B  POSITIONALS?        00101100
                     AIF   ('&CONNTKN' NE '').ZG60B  KEYS?              00101200
                     AIF   ('&FUNC' NE '').ZG60B  KEYS?                 00101300
                     AIF   ('&APPLENV' NE '').ZG60B  KEYS?              00101400
                     AIF   ('&JCLPROC' NE '').ZG60B  KEYS?              00101500
                     AIF   ('&JCLPARMS' NE '').ZG60B  KEYS?             00101600
                     AIF   ('&SINGLE_SERVER' NE '').ZG60B  KEYS?        00101700
                     AIF   ('&SELECT_POLICY' NE '').ZG60B  KEYS?        00101800
                     AIF   ('&DISTRIBUTE_WORK' NE '').ZG60B  KEYS?      00101900
                     AIF   ('&STATIC' NE '').ZG60B  KEYS?               00102000
                     AIF   ('&RETCODE' NE '').ZG60B  KEYS?              00102100
                     AIF   ('&RSNCODE' NE '').ZG60B  KEYS?              00102200
                     AGO    .ZG60C     INVOCATION OKAY                  00102300
.ZG60B               ANOP  ,                                            00102400
&ZMS                 SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE         00102500
&ZMS                 SETC  '&ZMS CAN ONLY HAVE'                         00102600
&ZMS                 SETC  '&ZMS THE "PLISTVER" KEY'                    00102700
                     MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'       00102800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00102900
.ZG60C               ANOP  ,                                            00103000
.*-------------------------------------------------------------------   00103100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00103200
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00103300
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00103400
                     AIF   (N'&MF(2) GT 1).ZG62B  MULTI PARMS           00103500
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00103600
.ZG62B               AIF   (K'&MF(2) GT 0).ZG62C                        00103700
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00103800
&ZMS                 SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*             00103900
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00104000
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00104100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00104200
.ZG62C               ANOP  ,                                            00104300
.*-------------------------------------------------------------------   00104400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00104500
                     AIF   (K'&ZXMFCTRL LE 0).ZG62P  NOT I/O            00104600
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG62P               00104700
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00104800
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00104900
&ZMS                 SETC  '&ZMS.&MF"'                                  00105000
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00105100
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'            00105200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00105300
.ZG62P               ANOP  ,                                            00105400
.*-------------------------------------------------------------------   00105500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00105600
&ZXMFATTR            SETC  'INPUT'     SET IN/OUTPUT                    00105700
&XMFATTR             SETC  '0D'                                         00105800
                     AIF   (K'&MF(3) LE 0).ZG65B  PARM                  00105900
&XMFATTR             SETC  '&MF(3,1)'  SET XVARIABLE                    00106000
                     AIF   (N'&MF(3) GT 1).ZG65B  MULTI PARMS           00106100
&XMFATTR             SETC  '&MF(3)'    SET XVARIABLE                    00106200
.ZG65B               ANOP  ,                                            00106300
.*-------------------------------------------------------------------   00106400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00106500
                     AIF   (K'&ZXMFATTR LE 0).ZG65P  NOT I/O            00106600
                     AIF   ('&XMFATTR'(1,1) NE '(').ZG65P               00106700
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00106800
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00106900
&ZMS                 SETC  '&ZMS.&MF"'                                  00107000
&ZMS                 SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'    00107100
                     MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'            00107200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00107300
.ZG65P               ANOP  ,                                            00107400
.*-------------------------------------------------------------------   00107500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00107600
                     AIF   (K'&ZXMFATTR LE 0).ZG65S  NOT I/O            00107700
                     AIF   (K'&XMFATTR LE 60).ZG65S  LNG OK             00107800
&ZXMFATTR            SETC  ''          RESET IN/OUTPUT                  00107900
&ZMS                 SETC  '"MF='      *KLNGA* MNOTE                    00108000
&ZMS                 SETC  '&ZMS.&MF"'                                  00108100
&ZMS                 SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'        00108200
                     MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'           00108300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00108400
.ZG65S               ANOP  ,                                            00108500
.*-------------------------------------------------------------------   00108600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00108700
.ZG67                ANOP  ,                                            00108800
&ZTLC                SETC 'E'                                           00108900
                     AIF   ('&MF(1)' NE '&ZTLC').ZG75                   00109000
&XMF                 SETC  'E'         SET KEYWORD                      00109100
                     AIF   (N'&MF LE 3).ZG67A   CK NUM                  00109200
&ZMS                 SETC  '"MF='      *KPOSA* MNOTE                    00109300
&ZMS                 SETC  '&ZMS.&MF"'                                  00109400
&ZMS                 SETC  '&ZMS "MF"'                                  00109500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'         00109600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00109700
.ZG67A               ANOP  ,                                            00109800
.*-------------------------------------------------------------------   00109900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00110000
&ZXMFCTRL            SETC  'INPUT'     SET IN/OUTPUT                    00110100
&XMFCTRL             SETC  '&MF(2,1)'  SET XVARIABLE                    00110200
                     AIF   (N'&MF(2) GT 1).ZG69B  MULTI PARMS           00110300
&XMFCTRL             SETC  '&MF(2)'    SET XVARIABLE                    00110400
.ZG69B               AIF   (K'&MF(2) GT 0).ZG69C                        00110500
&ZXMFCTRL            SETC  ''          RESET IN/OUTPUT                  00110600
&ZMS                 SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*             00110700
&ZMS                 SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'          00110800
                     MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                 00110900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00111000
.ZG69C               ANOP  ,                                            00111100
.*-------------------------------------------------------------------   00111200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00111300
                     AIF   (K'&ZXMFCTRL LE 0).ZG69R  NOT I/O            00111400
                     AIF   ('&XMFCTRL'(1,1) NE '(').ZG69R               00111500
&ZCGPR               SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                   00111600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG69P                 00111700
                     AIF   (K'&ZCGPR GT 2).ZG69Q                        00111800
                     AIF   ('&ZCGPR' EQ '0').ZG69Q                      00111900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00112000
                     AIF   (T'&ZCGPR NE 'N').ZG69Q  INVALID REG NAME    00112100
.ZG69P               ANOP  ,                                            00112200
                     AIF   (T'&ZCGPR NE 'N').ZG69R  NON NUMERIC         00112300
                     AIF   ('&ZCGPR' LT '1').ZG69Q                      00112400
                     AIF   ('&ZCGPR' LE '12').ZG69R                     00112500
.ZG69Q               ANOP  ,                                            00112600
&ZMS                 SETC  '"MF='      *KGPRA* MNOTE                    00112700
&ZMS                 SETC  '&ZMS.&MF"'                                  00112800
&ZMS                 SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'    00112900
                     MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'             00113000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00113100
.ZG69R               ANOP  ,                                            00113200
.*-------------------------------------------------------------------   00113300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00113400
&XMFSCK              SETC  ''          INITIALIZE XVARIABLE             00113500
.ZG73A   AIF   ('&MF(3)' NE 'COMPLETE').ZG74A                           00113600
&XMFSCK              SETC  'COMPLETE'  SET KEYWORD                      00113700
.*-------------------------------------------------------------------   00113800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00113900
.ZG74A               AIF   (K'&XMFSCK GT 0).ZG74C  KEYWORD              00114000
                     AIF   (K'&MF(3) LE 0).ZG74B                        00114100
&ZMS                 SETC  '"MF='      *KUKWA* MNOTE                    00114200
&ZMS                 SETC  '&ZMS.&MF"'                                  00114300
&ZMS                 SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '    00114400
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00114500
&ZMS                 SETC  '&ZMS "COMPLETE".'                           00114600
                     MNOTE 8,' &ZMS '                                   00114700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00114800
.ZG74B               ANOP  ,                                            00114900
&XMFSCK              SETC  'COMPLETE'  SET DEFAULT KEYWORD              00115000
.ZG74C               ANOP  ,                                            00115100
&ZXMFSCK             SETC  'INPUT'     SET IN/OUTPUT                    00115200
.*------------------------------------------------------------------    00115300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00115400
.ZG75                ANOP  ,                                            00115500
&ZXMF                SETC  'INPUT'     SET IN/OUTPUT                    00115600
                     AIF   (K'&XMF GT 0).ZG75E  VALID ARG               00115700
                     AIF   (T'&MF EQ 'O').ZG75D  OMITTED                00115800
&ZASYSLNDX           SETA  0                                            00115900
.ZG75A               ANOP  ,           POSITIONAL MACRO KEY             00116000
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00116100
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG75C             00116200
&ZTLC                SETC 'MF'                                          00116300
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG75A    00116400
.ZG75B               ANOP  ,                                            00116500
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00116600
&ZMS                 SETC  'THE "MF" KEY'       *KOPTA* MNOTE           00116700
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00116800
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00116900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00117000
                     AGO   .ZG75E                                       00117100
.ZG75C               ANOP  ,                                            00117200
&ZXMF                SETC  ''          RESET IN/OUTPUT                  00117300
&ZMS                 SETC  '"MF='      *KUKWA* MNOTE                    00117400
&ZMS                 SETC  '&ZMS.&MF"'                                  00117500
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00117600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00117700
&ZMS                 SETC  '&ZMS "S",'                                  00117800
&ZMS                 SETC  '&ZMS "L",'                                  00117900
&ZMS                 SETC  '&ZMS OR "E".'                               00118000
                     MNOTE 8,' &ZMS '                                   00118100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00118200
                     AGO   .ZG75E                                       00118300
.ZG75D               ANOP  ,                                            00118400
&XMF                 SETC  'S'         SET DEFAULT KEYWORD              00118500
&XMFSCK              SETC  'COMPLETE'  COMPLETE CHECKING                00118600
.ZG75E               ANOP  ,                                            00118700
.********************************************************************   00118800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00118900
.********************************************************************   00119000
                     ACTR  10000                                        00119100
.*-------------------------------------------------------------------   00119200
.***AG.MF03 MF=(SLE)                                                    00119300
                     AIF   ('&XMF' EQ 'L').ZGMFX                        00119400
.*----------------------------------------------------------------***   00119500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00119600
                     AIF   (N'&CONNTKN LE 1).ZG2A  CK NUM               00119700
&ZMS                 SETC  '"CONNTKN='          *KPOSA* MNOTE           00119800
&ZMS                 SETC  '&ZMS.&CONNTKN"'                             00119900
&ZMS                 SETC  '&ZMS "CONNTKN"'                             00120000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00120100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00120200
.ZG2A                ANOP  ,                                            00120300
.*-------------------------------------------------------------------   00120400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00120500
&ZXCONNTKN           SETC  'INPUT'     SET IN/OUTPUT                    00120600
&XCONNTKN            SETC  '&CONNTKN(1)'        SET XVARIABLE           00120700
                     AIF   (N'&CONNTKN GT 1).ZG2B  MULTI PARMS          00120800
&XCONNTKN            SETC  '&CONNTKN'  SET XVARIABLE                    00120900
.ZG2B                AIF   (K'&CONNTKN(1) GT 0).ZG2C                    00121000
&ZXCONNTKN           SETC  ''          RESET IN/OUTPUT                  00121100
&ZMS                 SETC  ' '         *KRQDA*                          00121200
&ZMS                 SETC  '&ZMS "CONNTKN" KEY AND ITS'                 00121300
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00121400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00121500
.ZG2C                ANOP  ,                                            00121600
.*-------------------------------------------------------------------   00121700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00121800
                     AIF   (K'&ZXCONNTKN LE 0).ZG2R  NOT I/O            00121900
                     AIF   ('&XCONNTKN'(1,1) NE '(').ZG2R               00122000
&ZCGPR               SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                 00122100
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                  00122200
                     AIF   (K'&ZCGPR GT 2).ZG2Q                         00122300
                     AIF   ('&ZCGPR' EQ '0').ZG2Q                       00122400
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00122500
                     AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME     00122600
.ZG2P                ANOP  ,                                            00122700
                     AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC          00122800
                     AIF   ('&ZCGPR' LT '2').ZG2Q                       00122900
                     AIF   ('&ZCGPR' LE '12').ZG2R                      00123000
.ZG2Q                ANOP  ,                                            00123100
&ZMS                 SETC  '"CONNTKN='          *KGPRA* MNOTE           00123200
&ZMS                 SETC  '&ZMS.&CONNTKN"'                             00123300
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00123400
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00123500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00123600
.ZG2R                ANOP  ,                                            00123700
.*------------------------------------------------------------------    00123800
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123900
&XFUNC               SETC  ''          INITIALIZE XVARIABLE             00124000
.*-------------------------------------------------------------------   00124100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00124200
.ZG6                 ANOP  ,                                            00124300
                     AIF   (K'&FUNC(1) LE 0).ZG6A                       00124400
&ZTLC                SETC 'ADD'                                         00124500
                     AIF   ('&FUNC(1)' NE '&ZTLC').ZG29                 00124600
&XFUNC               SETC  'ADD'       SET KEYWORD                      00124700
                     AIF   (N'&FUNC LE 1).ZG6A  CK NUM                  00124800
&ZMS                 SETC  '"FUNC='    *KPOSA* MNOTE                    00124900
&ZMS                 SETC  '&ZMS.&FUNC"'                                00125000
&ZMS                 SETC  '&ZMS "FUNC"'                                00125100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00125200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00125300
.ZG6A                ANOP  ,                                            00125400
.*------------------------------------------------------------------    00125500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00125600
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00125700
.ZG6A0               AIF   (K'&STATIC LE 0).ZG6A1  OK                   00125800
&ZCVAL               SETC '&ZCVAL STATIC'       INCORRECT KEY USED      00125900
.ZG6A1               AIF   (K'&ZCVAL LE 0).ZG6A2  OK                    00126000
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00126100
&ZMS                 SETC  '"FUNC'     *KMEIA* MNOTE                    00126200
&ZMS                 SETC  '&ZMS.=&FUNC"'                               00126300
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00126400
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00126500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00126600
.ZG6A2               ANOP  ,                                            00126700
.*----------------------------------------------------------------***   00126800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00126900
                     AIF   (N'&APPLENV LE 1).ZG8A  CK NUM               00127000
&ZMS                 SETC  '"APPLENV='          *KPOSA* MNOTE           00127100
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00127200
&ZMS                 SETC  '&ZMS "APPLENV"'                             00127300
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00127400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00127500
.ZG8A                ANOP  ,                                            00127600
.*-------------------------------------------------------------------   00127700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00127800
&ZXAPPLENV           SETC  'INPUT'     SET IN/OUTPUT                    00127900
&XAPPLENV            SETC  '&APPLENV(1)'        SET XVARIABLE           00128000
                     AIF   (N'&APPLENV GT 1).ZG8B  MULTI PARMS          00128100
&XAPPLENV            SETC  '&APPLENV'  SET XVARIABLE                    00128200
.ZG8B                AIF   (K'&APPLENV(1) GT 0).ZG8C                    00128300
&ZXAPPLENV           SETC  ''          RESET IN/OUTPUT                  00128400
&ZMS                 SETC  ' '         *KRQDA*                          00128500
&ZMS                 SETC  '&ZMS "APPLENV" KEY AND ITS'                 00128600
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00128700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00128800
.ZG8C                ANOP  ,                                            00128900
.*-------------------------------------------------------------------   00129000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00129100
                     AIF   (K'&ZXAPPLENV LE 0).ZG8R  NOT I/O            00129200
                     AIF   ('&XAPPLENV'(1,1) NE '(').ZG8R               00129300
&ZCGPR               SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                 00129400
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                  00129500
                     AIF   (K'&ZCGPR GT 2).ZG8Q                         00129600
                     AIF   ('&ZCGPR' EQ '0').ZG8Q                       00129700
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00129800
                     AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME     00129900
.ZG8P                ANOP  ,                                            00130000
                     AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC          00130100
                     AIF   ('&ZCGPR' LT '2').ZG8Q                       00130200
                     AIF   ('&ZCGPR' LE '12').ZG8R                      00130300
.ZG8Q                ANOP  ,                                            00130400
&ZMS                 SETC  '"APPLENV='          *KGPRA* MNOTE           00130500
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00130600
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00130700
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00130800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00130900
.ZG8R                ANOP  ,                                            00131000
.*----------------------------------------------------------------***   00131100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00131200
                     AIF   (N'&JCLPROC LE 1).ZG11A  CK NUM              00131300
&ZMS                 SETC  '"JCLPROC='          *KPOSA* MNOTE           00131400
&ZMS                 SETC  '&ZMS.&JCLPROC"'                             00131500
&ZMS                 SETC  '&ZMS "JCLPROC"'                             00131600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00131700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00131800
.ZG11A               ANOP  ,                                            00131900
.*-------------------------------------------------------------------   00132000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00132100
&ZXJCLPROC           SETC  'INPUT'     SET IN/OUTPUT                    00132200
&XJCLPROC            SETC  '&JCLPROC(1)'        SET XVARIABLE           00132300
                     AIF   (N'&JCLPROC GT 1).ZG11B  MULTI PARMS         00132400
&XJCLPROC            SETC  '&JCLPROC'  SET XVARIABLE                    00132500
.ZG11B               AIF   (K'&JCLPROC(1) GT 0).ZG11C                   00132600
&ZXJCLPROC           SETC  ''          RESET IN/OUTPUT                  00132700
&ZMS                 SETC  ' '         *KRQDA*                          00132800
&ZMS                 SETC  '&ZMS "JCLPROC" KEY AND ITS'                 00132900
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00133000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00133100
.ZG11C               ANOP  ,                                            00133200
.*-------------------------------------------------------------------   00133300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00133400
                     AIF   (K'&ZXJCLPROC LE 0).ZG11R  NOT I/O           00133500
                     AIF   ('&XJCLPROC'(1,1) NE '(').ZG11R              00133600
&ZCGPR               SETC  '&XJCLPROC'(2,K'&XJCLPROC-2)                 00133700
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                 00133800
                     AIF   (K'&ZCGPR GT 2).ZG11Q                        00133900
                     AIF   ('&ZCGPR' EQ '0').ZG11Q                      00134000
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00134100
                     AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME    00134200
.ZG11P               ANOP  ,                                            00134300
                     AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC         00134400
                     AIF   ('&ZCGPR' LT '2').ZG11Q                      00134500
                     AIF   ('&ZCGPR' LE '12').ZG11R                     00134600
.ZG11Q               ANOP  ,                                            00134700
&ZMS                 SETC  '"JCLPROC='          *KGPRA* MNOTE           00134800
&ZMS                 SETC  '&ZMS.&JCLPROC"'                             00134900
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00135000
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00135100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00135200
.ZG11R               ANOP  ,                                            00135300
.*----------------------------------------------------------------***   00135400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00135500
                     AIF   (N'&JCLPARMS LE 1).ZG14A  CK NUM             00135600
&ZMS                 SETC  '"JCLPARMS='         *KPOSA* MNOTE           00135700
&ZMS                 SETC  '&ZMS.&JCLPARMS"'                            00135800
&ZMS                 SETC  '&ZMS "JCLPARMS"'                            00135900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00136000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00136100
.ZG14A               ANOP  ,                                            00136200
.*-------------------------------------------------------------------   00136300
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00136400
&ZXJCLPARMS          SETC  'INPUT'     SET IN/OUTPUT                    00136500
&XJCLPARMS           SETC  '0'                                          00136600
                     AIF   (K'&JCLPARMS(1) LE 0).ZG14B  PARM            00136700
&XJCLPARMS           SETC  '&JCLPARMS(1)'       SET XVARIABLE           00136800
                     AIF   (N'&JCLPARMS GT 1).ZG14B  MULTI PARMS        00136900
&XJCLPARMS           SETC  '&JCLPARMS'          SET XVARIABLE           00137000
.ZG14B               ANOP  ,                                            00137100
.*-------------------------------------------------------------------   00137200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00137300
                     AIF   (K'&ZXJCLPARMS LE 0).ZG14R  NOT I/O          00137400
                     AIF   ('&XJCLPARMS'(1,1) NE '(').ZG14R             00137500
&ZCGPR               SETC  '&XJCLPARMS'(2,K'&XJCLPARMS-2)               00137600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                 00137700
                     AIF   (K'&ZCGPR GT 2).ZG14Q                        00137800
                     AIF   ('&ZCGPR' EQ '0').ZG14Q                      00137900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00138000
                     AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME    00138100
.ZG14P               ANOP  ,                                            00138200
                     AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC         00138300
                     AIF   ('&ZCGPR' LT '2').ZG14Q                      00138400
                     AIF   ('&ZCGPR' LE '12').ZG14R                     00138500
.ZG14Q               ANOP  ,                                            00138600
&ZMS                 SETC  '"JCLPARMS='         *KGPRA* MNOTE           00138700
&ZMS                 SETC  '&ZMS.&JCLPARMS"'                            00138800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00138900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00139000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00139100
.ZG14R               ANOP  ,                                            00139200
.*------------------------------------------------------------------    00139300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00139400
&XSINGLE_SERVER      SETC  ''          INITIALIZE XVARIABLE             00139500
.*-------------------------------------------------------------------   00139600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00139700
.ZG18                ANOP  ,                                            00139800
                     AIF   (K'&SINGLE_SERVER(1) LE 0).ZG18A             00139900
&ZTLC                SETC 'NO'                                          00140000
                     AIF   ('&SINGLE_SERVER(1)' NE '&ZTLC').ZG19        00140100
&XSINGLE_SERVER      SETC  'NO'        SET KEYWORD                      00140200
                     AIF   (N'&SINGLE_SERVER LE 1).ZG18A  CK NUM        00140300
&ZMS                 SETC  '"SINGLE_SERVER='    *KPOSA* MNOTE           00140400
&ZMS                 SETC  '&ZMS.&SINGLE_SERVER"'                       00140500
&ZMS                 SETC  '&ZMS "SINGLE_SERVER"'                       00140600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00140700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00140800
.ZG18A               ANOP  ,                                            00140900
.*-------------------------------------------------------------------   00141000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00141100
.ZG19                ANOP  ,                                            00141200
&ZTLC                SETC 'YES'                                         00141300
                     AIF   ('&SINGLE_SERVER(1)' NE '&ZTLC').ZG20        00141400
&XSINGLE_SERVER      SETC  'YES'       SET KEYWORD                      00141500
                     AIF   (N'&SINGLE_SERVER LE 1).ZG19A  CK NUM        00141600
&ZMS                 SETC  '"SINGLE_SERVER='    *KPOSA* MNOTE           00141700
&ZMS                 SETC  '&ZMS.&SINGLE_SERVER"'                       00141800
&ZMS                 SETC  '&ZMS "SINGLE_SERVER"'                       00141900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00142000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00142100
.ZG19A               ANOP  ,                                            00142200
.*------------------------------------------------------------------    00142300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142400
.ZG20                ANOP  ,                                            00142500
&ZXSINGLE_SERVER     SETC  'INPUT'     SET IN/OUTPUT                    00142600
                     AIF   (K'&XSINGLE_SERVER GT 0).ZG20E  VALID ARG    00142700
                     AIF   (T'&SINGLE_SERVER EQ 'O').ZG20D  OMITTED     00142800
&ZASYSLNDX           SETA  0                                            00142900
.ZG20A               ANOP  ,           POSITIONAL MACRO KEY             00143000
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00143100
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG20C             00143200
&ZTLC                SETC 'SINGLE_SERVER'                               00143300
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG20A    00143400
.ZG20B               ANOP  ,                                            00143500
&ZXSINGLE_SERVER     SETC  ''          RESET IN/OUTPUT                  00143600
&ZMS                 SETC  'THE "SINGLE_SERVER" KEY'  *KOPTA* MNOTE     00143700
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00143800
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00143900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00144000
                     AGO   .ZG20E                                       00144100
.ZG20C               ANOP  ,                                            00144200
&ZXSINGLE_SERVER     SETC  ''          RESET IN/OUTPUT                  00144300
&ZMS                 SETC  '"SINGLE_SERVER='    *KUKWA* MNOTE           00144400
&ZMS                 SETC  '&ZMS.&SINGLE_SERVER"'                       00144500
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00144600
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00144700
&ZMS                 SETC  '&ZMS "NO"'                                  00144800
&ZMS                 SETC  '&ZMS OR "YES".'                             00144900
                     MNOTE 8,' &ZMS '                                   00145000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00145100
                     AGO   .ZG20E                                       00145200
.ZG20D               ANOP  ,                                            00145300
&XSINGLE_SERVER      SETC  'NO'        SET DEFAULT KEYWORD              00145400
.ZG20E               ANOP  ,                                            00145500
.*----------------------------------------------------------------***   00145600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00145700
                     AIF   (N'&SELECT_POLICY LE 1).ZG22A  CK NUM        00145800
&ZMS                 SETC  '"SELECT_POLICY='    *KPOSA* MNOTE           00145900
&ZMS                 SETC  '&ZMS.&SELECT_POLICY"'                       00146000
&ZMS                 SETC  '&ZMS "SELECT_POLICY"'                       00146100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00146200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00146300
.ZG22A               ANOP  ,                                            00146400
.*-------------------------------------------------------------------   00146500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00146600
&ZXSELECT_POLICY     SETC  'INPUT'     SET IN/OUTPUT                    00146700
&XSELECT_POLICY      SETC  '0'                                          00146800
                     AIF   (K'&SELECT_POLICY(1) LE 0).ZG22B  PARM       00146900
&XSELECT_POLICY      SETC  '&SELECT_POLICY(1)'  SET XVARIABLE           00147000
                     AIF   (N'&SELECT_POLICY GT 1).ZG22B  MULTI PARMS   00147100
&XSELECT_POLICY      SETC  '&SELECT_POLICY'     SET XVARIABLE           00147200
.ZG22B               ANOP  ,                                            00147300
.*-------------------------------------------------------------------   00147400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00147500
                     AIF   (K'&ZXSELECT_POLICY LE 0).ZG22R  NOT I/O     00147600
                     AIF   ('&XSELECT_POLICY'(1,1) NE '(').ZG22R        00147700
&ZCGPR               SETC  '&XSELECT_POLICY'(2,K'&XSELECT_POLICY-2)     00147800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                 00147900
                     AIF   (K'&ZCGPR GT 2).ZG22Q                        00148000
                     AIF   ('&ZCGPR' EQ '0').ZG22Q                      00148100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00148200
                     AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME    00148300
.ZG22P               ANOP  ,                                            00148400
                     AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC         00148500
                     AIF   ('&ZCGPR' LT '2').ZG22Q                      00148600
                     AIF   ('&ZCGPR' LE '12').ZG22R                     00148700
.ZG22Q               ANOP  ,                                            00148800
&ZMS                 SETC  '"SELECT_POLICY='    *KGPRA* MNOTE           00148900
&ZMS                 SETC  '&ZMS.&SELECT_POLICY"'                       00149000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00149100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00149200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00149300
.ZG22R               ANOP  ,                                            00149400
.*------------------------------------------------------------------    00149500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149600
&XDISTRIBUTE_WORK    SETC  ''          INITIALIZE XVARIABLE             00149700
.*-------------------------------------------------------------------   00149800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00149900
.ZG26                ANOP  ,                                            00150000
                     AIF   (K'&DISTRIBUTE_WORK(1) LE 0).ZG26A           00150100
&ZTLC                SETC 'FIRST_AVAILABLE'                             00150200
                     AIF   ('&DISTRIBUTE_WORK(1)' NE '&ZTLC').ZG27      00150300
&XDISTRIBUTE_WORK    SETC  'FIRST_AVAILABLE'    SET KEYWORD             00150400
                     AIF   (N'&DISTRIBUTE_WORK LE 1).ZG26A  CK NUM      00150500
&ZMS                 SETC  '"DISTRIBUTE_WORK='  *KPOSA* MNOTE           00150600
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00150700
&ZMS                 SETC  '&ZMS "DISTRIBUTE_WORK"'                     00150800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00150900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00151000
.ZG26A               ANOP  ,                                            00151100
.*-------------------------------------------------------------------   00151200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00151300
.ZG27                ANOP  ,                                            00151400
&ZTLC                SETC 'ROUND_ROBIN'                                 00151500
                     AIF   ('&DISTRIBUTE_WORK(1)' NE '&ZTLC').ZG28      00151600
&XDISTRIBUTE_WORK    SETC  'ROUND_ROBIN'        SET KEYWORD             00151700
                     AIF   (N'&DISTRIBUTE_WORK LE 1).ZG27A  CK NUM      00151800
&ZMS                 SETC  '"DISTRIBUTE_WORK='  *KPOSA* MNOTE           00151900
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00152000
&ZMS                 SETC  '&ZMS "DISTRIBUTE_WORK"'                     00152100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00152200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00152300
.ZG27A               ANOP  ,                                            00152400
.*------------------------------------------------------------------    00152500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152600
.ZG28                ANOP  ,                                            00152700
&ZXDISTRIBUTE_WORK   SETC  'INPUT'     SET IN/OUTPUT                    00152800
                     AIF   (K'&XDISTRIBUTE_WORK GT 0).ZG28E  VALID ARG  00152900
                     AIF   (T'&DISTRIBUTE_WORK EQ 'O').ZG28D  OMITTED   00153000
&ZASYSLNDX           SETA  0                                            00153100
.ZG28A               ANOP  ,           POSITIONAL MACRO KEY             00153200
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00153300
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG28C             00153400
&ZTLC                SETC 'DISTRIBUTE_WORK'                             00153500
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG28A    00153600
.ZG28B               ANOP  ,                                            00153700
&ZXDISTRIBUTE_WORK   SETC  ''          RESET IN/OUTPUT                  00153800
&ZMS                 SETC  'THE "DISTRIBUTE_WORK" KEY'  *KOPTA* MNOTE   00153900
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00154000
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00154100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00154200
                     AGO   .ZG28E                                       00154300
.ZG28C               ANOP  ,                                            00154400
&ZXDISTRIBUTE_WORK   SETC  ''          RESET IN/OUTPUT                  00154500
&ZMS                 SETC  '"DISTRIBUTE_WORK='  *KUKWA* MNOTE           00154600
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00154700
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00154800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00154900
&ZMS                 SETC  '&ZMS "FIRST_AVAILABLE"'                     00155000
&ZMS                 SETC  '&ZMS OR "ROUND_ROBIN".'                     00155100
                     MNOTE 8,' &ZMS '                                   00155200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00155300
                     AGO   .ZG28E                                       00155400
.ZG28D               ANOP  ,                                            00155500
&XDISTRIBUTE_WORK    SETC  'FIRST_AVAILABLE'    SET DEFAULT KEYWORD     00155600
.ZG28E               ANOP  ,                                            00155700
.*-------------------------------------------------------------------   00155800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155900
.ZG29                ANOP  ,                                            00156000
&ZTLC                SETC 'DELETE'                                      00156100
                     AIF   ('&FUNC(1)' NE '&ZTLC').ZG33                 00156200
&XFUNC               SETC  'DELETE'    SET KEYWORD                      00156300
                     AIF   (N'&FUNC LE 1).ZG29A  CK NUM                 00156400
&ZMS                 SETC  '"FUNC='    *KPOSA* MNOTE                    00156500
&ZMS                 SETC  '&ZMS.&FUNC"'                                00156600
&ZMS                 SETC  '&ZMS "FUNC"'                                00156700
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00156800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00156900
.ZG29A               ANOP  ,                                            00157000
.*------------------------------------------------------------------    00157100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157200
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00157300
.ZG29A0              AIF   (K'&JCLPROC LE 0).ZG29A1  OK                 00157400
&ZCVAL               SETC '&ZCVAL JCLPROC'      INCORRECT KEY USED      00157500
.ZG29A1              AIF   (K'&JCLPARMS LE 0).ZG29A2  OK                00157600
&ZCVAL               SETC '&ZCVAL JCLPARMS'     INCORRECT KEY USED      00157700
.ZG29A2              AIF   (K'&SINGLE_SERVER LE 0).ZG29A3  OK           00157800
&ZCVAL               SETC '&ZCVAL SINGLE_SERVER'  INCORRECT KEY USED    00157900
.ZG29A3              AIF   (K'&SELECT_POLICY LE 0).ZG29A4  OK           00158000
&ZCVAL               SETC '&ZCVAL SELECT_POLICY'  INCORRECT KEY USED    00158100
.ZG29A4              AIF   (K'&DISTRIBUTE_WORK LE 0).ZG29A5  OK         00158200
&ZCVAL               SETC '&ZCVAL DISTRIBUTE_WORK'  INCORRECT KEY USED  00158300
.ZG29A5              AIF   (K'&STATIC LE 0).ZG29A6  OK                  00158400
&ZCVAL               SETC '&ZCVAL STATIC'       INCORRECT KEY USED      00158500
.ZG29A6              AIF   (K'&ZCVAL LE 0).ZG29A7  OK                   00158600
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00158700
&ZMS                 SETC  '"FUNC'     *KMEIA* MNOTE                    00158800
&ZMS                 SETC  '&ZMS.=&FUNC"'                               00158900
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00159000
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00159100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00159200
.ZG29A7              ANOP  ,                                            00159300
.*----------------------------------------------------------------***   00159400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00159500
                     AIF   (N'&APPLENV LE 1).ZG31A  CK NUM              00159600
&ZMS                 SETC  '"APPLENV='          *KPOSA* MNOTE           00159700
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00159800
&ZMS                 SETC  '&ZMS "APPLENV"'                             00159900
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00160000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00160100
.ZG31A               ANOP  ,                                            00160200
.*-------------------------------------------------------------------   00160300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00160400
&ZXAPPLENV           SETC  'INPUT'     SET IN/OUTPUT                    00160500
&XAPPLENV            SETC  '&APPLENV(1)'        SET XVARIABLE           00160600
                     AIF   (N'&APPLENV GT 1).ZG31B  MULTI PARMS         00160700
&XAPPLENV            SETC  '&APPLENV'  SET XVARIABLE                    00160800
.ZG31B               AIF   (K'&APPLENV(1) GT 0).ZG31C                   00160900
&ZXAPPLENV           SETC  ''          RESET IN/OUTPUT                  00161000
&ZMS                 SETC  ' '         *KRQDA*                          00161100
&ZMS                 SETC  '&ZMS "APPLENV" KEY AND ITS'                 00161200
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00161300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00161400
.ZG31C               ANOP  ,                                            00161500
.*-------------------------------------------------------------------   00161600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00161700
                     AIF   (K'&ZXAPPLENV LE 0).ZG31R  NOT I/O           00161800
                     AIF   ('&XAPPLENV'(1,1) NE '(').ZG31R              00161900
&ZCGPR               SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                 00162000
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                 00162100
                     AIF   (K'&ZCGPR GT 2).ZG31Q                        00162200
                     AIF   ('&ZCGPR' EQ '0').ZG31Q                      00162300
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00162400
                     AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME    00162500
.ZG31P               ANOP  ,                                            00162600
                     AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC         00162700
                     AIF   ('&ZCGPR' LT '2').ZG31Q                      00162800
                     AIF   ('&ZCGPR' LE '12').ZG31R                     00162900
.ZG31Q               ANOP  ,                                            00163000
&ZMS                 SETC  '"APPLENV='          *KGPRA* MNOTE           00163100
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00163200
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00163300
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00163400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00163500
.ZG31R               ANOP  ,                                            00163600
.*-------------------------------------------------------------------   00163700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00163800
.ZG33                ANOP  ,                                            00163900
&ZTLC                SETC 'MODIFY'                                      00164000
                     AIF   ('&FUNC(1)' NE '&ZTLC').ZG47                 00164100
&XFUNC               SETC  'MODIFY'    SET KEYWORD                      00164200
                     AIF   (N'&FUNC LE 1).ZG33A  CK NUM                 00164300
&ZMS                 SETC  '"FUNC='    *KPOSA* MNOTE                    00164400
&ZMS                 SETC  '&ZMS.&FUNC"'                                00164500
&ZMS                 SETC  '&ZMS "FUNC"'                                00164600
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00164700
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00164800
.ZG33A               ANOP  ,                                            00164900
.*------------------------------------------------------------------    00165000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165100
&ZCVAL               SETC ''           CLEAR ERROR KEY ACCUMULATOR      00165200
.ZG33A0              AIF   (K'&JCLPROC LE 0).ZG33A1  OK                 00165300
&ZCVAL               SETC '&ZCVAL JCLPROC'      INCORRECT KEY USED      00165400
.ZG33A1              AIF   (K'&JCLPARMS LE 0).ZG33A2  OK                00165500
&ZCVAL               SETC '&ZCVAL JCLPARMS'     INCORRECT KEY USED      00165600
.ZG33A2              AIF   (K'&SINGLE_SERVER LE 0).ZG33A3  OK           00165700
&ZCVAL               SETC '&ZCVAL SINGLE_SERVER'  INCORRECT KEY USED    00165800
.ZG33A3              AIF   (K'&SELECT_POLICY LE 0).ZG33A4  OK           00165900
&ZCVAL               SETC '&ZCVAL SELECT_POLICY'  INCORRECT KEY USED    00166000
.ZG33A4              AIF   (K'&ZCVAL LE 0).ZG33A5  OK                   00166100
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)                        00166200
&ZMS                 SETC  '"FUNC'     *KMEIA* MNOTE                    00166300
&ZMS                 SETC  '&ZMS.=&FUNC"'                               00166400
&ZMS                 SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'         00166500
                     MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'         00166600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00166700
.ZG33A5              ANOP  ,                                            00166800
.*----------------------------------------------------------------***   00166900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00167000
                     AIF   (N'&APPLENV LE 1).ZG35A  CK NUM              00167100
&ZMS                 SETC  '"APPLENV='          *KPOSA* MNOTE           00167200
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00167300
&ZMS                 SETC  '&ZMS "APPLENV"'                             00167400
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00167500
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00167600
.ZG35A               ANOP  ,                                            00167700
.*-------------------------------------------------------------------   00167800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00167900
&ZXAPPLENV           SETC  'INPUT'     SET IN/OUTPUT                    00168000
&XAPPLENV            SETC  '&APPLENV(1)'        SET XVARIABLE           00168100
                     AIF   (N'&APPLENV GT 1).ZG35B  MULTI PARMS         00168200
&XAPPLENV            SETC  '&APPLENV'  SET XVARIABLE                    00168300
.ZG35B               AIF   (K'&APPLENV(1) GT 0).ZG35C                   00168400
&ZXAPPLENV           SETC  ''          RESET IN/OUTPUT                  00168500
&ZMS                 SETC  ' '         *KRQDA*                          00168600
&ZMS                 SETC  '&ZMS "APPLENV" KEY AND ITS'                 00168700
                     MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'             00168800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00168900
.ZG35C               ANOP  ,                                            00169000
.*-------------------------------------------------------------------   00169100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00169200
                     AIF   (K'&ZXAPPLENV LE 0).ZG35R  NOT I/O           00169300
                     AIF   ('&XAPPLENV'(1,1) NE '(').ZG35R              00169400
&ZCGPR               SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                 00169500
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG35P                 00169600
                     AIF   (K'&ZCGPR GT 2).ZG35Q                        00169700
                     AIF   ('&ZCGPR' EQ '0').ZG35Q                      00169800
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00169900
                     AIF   (T'&ZCGPR NE 'N').ZG35Q  INVALID REG NAME    00170000
.ZG35P               ANOP  ,                                            00170100
                     AIF   (T'&ZCGPR NE 'N').ZG35R  NON NUMERIC         00170200
                     AIF   ('&ZCGPR' LT '2').ZG35Q                      00170300
                     AIF   ('&ZCGPR' LE '12').ZG35R                     00170400
.ZG35Q               ANOP  ,                                            00170500
&ZMS                 SETC  '"APPLENV='          *KGPRA* MNOTE           00170600
&ZMS                 SETC  '&ZMS.&APPLENV"'                             00170700
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00170800
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00170900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00171000
.ZG35R               ANOP  ,                                            00171100
.*------------------------------------------------------------------    00171200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171300
&XDISTRIBUTE_WORK    SETC  ''          INITIALIZE XVARIABLE             00171400
.*-------------------------------------------------------------------   00171500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171600
.ZG39                ANOP  ,                                            00171700
                     AIF   (K'&DISTRIBUTE_WORK(1) LE 0).ZG39A           00171800
&ZTLC                SETC 'FIRST_AVAILABLE'                             00171900
                     AIF   ('&DISTRIBUTE_WORK(1)' NE '&ZTLC').ZG40      00172000
&XDISTRIBUTE_WORK    SETC  'FIRST_AVAILABLE'    SET KEYWORD             00172100
                     AIF   (N'&DISTRIBUTE_WORK LE 1).ZG39A  CK NUM      00172200
&ZMS                 SETC  '"DISTRIBUTE_WORK='  *KPOSA* MNOTE           00172300
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00172400
&ZMS                 SETC  '&ZMS "DISTRIBUTE_WORK"'                     00172500
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00172600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00172700
.ZG39A               ANOP  ,                                            00172800
.*-------------------------------------------------------------------   00172900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173000
.ZG40                ANOP  ,                                            00173100
&ZTLC                SETC 'ROUND_ROBIN'                                 00173200
                     AIF   ('&DISTRIBUTE_WORK(1)' NE '&ZTLC').ZG41      00173300
&XDISTRIBUTE_WORK    SETC  'ROUND_ROBIN'        SET KEYWORD             00173400
                     AIF   (N'&DISTRIBUTE_WORK LE 1).ZG40A  CK NUM      00173500
&ZMS                 SETC  '"DISTRIBUTE_WORK='  *KPOSA* MNOTE           00173600
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00173700
&ZMS                 SETC  '&ZMS "DISTRIBUTE_WORK"'                     00173800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00173900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00174000
.ZG40A               ANOP  ,                                            00174100
.*------------------------------------------------------------------    00174200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174300
.ZG41                ANOP  ,                                            00174400
&ZXDISTRIBUTE_WORK   SETC  'INPUT'     SET IN/OUTPUT                    00174500
                     AIF   (K'&XDISTRIBUTE_WORK GT 0).ZG41E  VALID ARG  00174600
                     AIF   (T'&DISTRIBUTE_WORK EQ 'O').ZG41D  OMITTED   00174700
&ZASYSLNDX           SETA  0                                            00174800
.ZG41A               ANOP  ,           POSITIONAL MACRO KEY             00174900
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00175000
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG41C             00175100
&ZTLC                SETC 'DISTRIBUTE_WORK'                             00175200
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG41A    00175300
.ZG41B               ANOP  ,                                            00175400
&ZXDISTRIBUTE_WORK   SETC  ''          RESET IN/OUTPUT                  00175500
&ZMS                 SETC  'THE "DISTRIBUTE_WORK" KEY'  *KOPTA* MNOTE   00175600
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00175700
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00175800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00175900
                     AGO   .ZG41E                                       00176000
.ZG41C               ANOP  ,                                            00176100
&ZXDISTRIBUTE_WORK   SETC  ''          RESET IN/OUTPUT                  00176200
&ZMS                 SETC  '"DISTRIBUTE_WORK='  *KUKWA* MNOTE           00176300
&ZMS                 SETC  '&ZMS.&DISTRIBUTE_WORK"'                     00176400
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00176500
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00176600
&ZMS                 SETC  '&ZMS "FIRST_AVAILABLE"'                     00176700
&ZMS                 SETC  '&ZMS OR "ROUND_ROBIN".'                     00176800
                     MNOTE 8,' &ZMS '                                   00176900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00177000
                     AGO   .ZG41E                                       00177100
.ZG41D               ANOP  ,                                            00177200
&XDISTRIBUTE_WORK    SETC  'FIRST_AVAILABLE'    SET DEFAULT KEYWORD     00177300
.ZG41E               ANOP  ,                                            00177400
.*------------------------------------------------------------------    00177500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177600
&XSTATIC             SETC  ''          INITIALIZE XVARIABLE             00177700
.*-------------------------------------------------------------------   00177800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177900
.ZG44                ANOP  ,                                            00178000
                     AIF   (K'&STATIC(1) LE 0).ZG44A                    00178100
&ZTLC                SETC 'NO'                                          00178200
                     AIF   ('&STATIC(1)' NE '&ZTLC').ZG45               00178300
&XSTATIC             SETC  'NO'        SET KEYWORD                      00178400
                     AIF   (N'&STATIC LE 1).ZG44A  CK NUM               00178500
&ZMS                 SETC  '"STATIC='  *KPOSA* MNOTE                    00178600
&ZMS                 SETC  '&ZMS.&STATIC"'                              00178700
&ZMS                 SETC  '&ZMS "STATIC"'                              00178800
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00178900
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00179000
.ZG44A               ANOP  ,                                            00179100
.*-------------------------------------------------------------------   00179200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00179300
.ZG45                ANOP  ,                                            00179400
&ZTLC                SETC 'YES'                                         00179500
                     AIF   ('&STATIC(1)' NE '&ZTLC').ZG46               00179600
&XSTATIC             SETC  'YES'       SET KEYWORD                      00179700
                     AIF   (N'&STATIC LE 1).ZG45A  CK NUM               00179800
&ZMS                 SETC  '"STATIC='  *KPOSA* MNOTE                    00179900
&ZMS                 SETC  '&ZMS.&STATIC"'                              00180000
&ZMS                 SETC  '&ZMS "STATIC"'                              00180100
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00180200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00180300
.ZG45A               ANOP  ,                                            00180400
.*------------------------------------------------------------------    00180500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00180600
.ZG46                ANOP  ,                                            00180700
&ZXSTATIC            SETC  'INPUT'     SET IN/OUTPUT                    00180800
                     AIF   (K'&XSTATIC GT 0).ZG46E  VALID ARG           00180900
                     AIF   (T'&STATIC EQ 'O').ZG46D  OMITTED            00181000
&ZASYSLNDX           SETA  0                                            00181100
.ZG46A               ANOP  ,           POSITIONAL MACRO KEY             00181200
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00181300
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG46C             00181400
&ZTLC                SETC 'STATIC'                                      00181500
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG46A    00181600
.ZG46B               ANOP  ,                                            00181700
&ZXSTATIC            SETC  ''          RESET IN/OUTPUT                  00181800
&ZMS                 SETC  'THE "STATIC" KEY'   *KOPTA* MNOTE           00181900
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00182000
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00182100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00182200
                     AGO   .ZG46E                                       00182300
.ZG46C               ANOP  ,                                            00182400
&ZXSTATIC            SETC  ''          RESET IN/OUTPUT                  00182500
&ZMS                 SETC  '"STATIC='  *KUKWA* MNOTE                    00182600
&ZMS                 SETC  '&ZMS.&STATIC"'                              00182700
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00182800
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00182900
&ZMS                 SETC  '&ZMS "NO"'                                  00183000
&ZMS                 SETC  '&ZMS OR "YES".'                             00183100
                     MNOTE 8,' &ZMS '                                   00183200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00183300
                     AGO   .ZG46E                                       00183400
.ZG46D               ANOP  ,                                            00183500
&XSTATIC             SETC  'NO'        SET DEFAULT KEYWORD              00183600
.ZG46E               ANOP  ,                                            00183700
.*------------------------------------------------------------------    00183800
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183900
.ZG47                ANOP  ,                                            00184000
&ZXFUNC              SETC  'INPUT'     SET IN/OUTPUT                    00184100
                     AIF   (K'&XFUNC GT 0).ZG47E  VALID ARG             00184200
                     AIF   (T'&FUNC EQ 'O').ZG47D  OMITTED              00184300
&ZASYSLNDX           SETA  0                                            00184400
.ZG47A               ANOP  ,           POSITIONAL MACRO KEY             00184500
&ZASYSLNDX           SETA  &ZASYSLNDX+1                                 00184600
                     AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG47C             00184700
&ZTLC                SETC 'FUNC'                                        00184800
                     AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG47A    00184900
.ZG47B               ANOP  ,                                            00185000
&ZXFUNC              SETC  ''          RESET IN/OUTPUT                  00185100
&ZMS                 SETC  'THE "FUNC" KEY'     *KOPTA* MNOTE           00185200
&ZMS                 SETC  '&ZMS MUST CONTAIN ONE'                      00185300
                     MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'             00185400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00185500
                     AGO   .ZG47E                                       00185600
.ZG47C               ANOP  ,                                            00185700
&ZXFUNC              SETC  ''          RESET IN/OUTPUT                  00185800
&ZMS                 SETC  '"FUNC='    *KUKWA* MNOTE                    00185900
&ZMS                 SETC  '&ZMS.&FUNC"'                                00186000
&ZMS                 SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '    00186100
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00186200
&ZMS                 SETC  '&ZMS "ADD",'                                00186300
&ZMS                 SETC  '&ZMS "DELETE",'                             00186400
&ZMS                 SETC  '&ZMS OR "MODIFY".'                          00186500
                     MNOTE 8,' &ZMS '                                   00186600
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00186700
                     AGO   .ZG47E                                       00186800
.ZG47D               ANOP  ,                                            00186900
&XFUNC               SETC  'ADD'       SET DEFAULT KEYWORD              00187000
.ZG47E               ANOP  ,                                            00187100
.*------------------------------------------------------------------    00187200
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00187300
                     AIF   (K'&FUNC(1) GT 0).ZG47F  PARM                00187400
&XFUNC               SETC  ''          ENSURE NULL KEYWORD              00187500
&ZXFUNC              SETC  ''          RESET IN/OUTPUT                  00187600
&ZMS                 SETC  'THE'                                        00187700
&ZMS                 SETC  '&ZMS "FUNC" KEY AND ITS'                    00187800
&ZMS                 SETC  '&ZMS ARGUMENT ARE REQUIRED.'                00187900
&ZMS                 SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'          00188000
&ZMS                 SETC  '&ZMS "ADD",'                                00188100
&ZMS                 SETC  '&ZMS "DELETE",'                             00188200
&ZMS                 SETC  '&ZMS OR "MODIFY".'                          00188300
                     MNOTE 8,' &ZMS '                                   00188400
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00188500
.ZG47F               ANOP  ,                                            00188600
.*----------------------------------------------------------------***   00188700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00188800
                     AIF   (N'&RETCODE LE 1).ZG49A  CK NUM              00188900
&ZMS                 SETC  '"RETCODE='          *KPOSA* MNOTE           00189000
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00189100
&ZMS                 SETC  '&ZMS "RETCODE"'                             00189200
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00189300
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00189400
.ZG49A               ANOP  ,                                            00189500
.*-------------------------------------------------------------------   00189600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00189700
                     AIF   (K'&RETCODE(1) LE 0).ZG49C  NO PARM          00189800
&ZXRETCODE           SETC  'OUTPUT'    SET OUTPUT                       00189900
&XRETCODE            SETC  '&RETCODE(1)'        SET XVARIABLE           00190000
                     AIF   (N'&RETCODE GT 1).ZG49C                      00190100
&XRETCODE            SETC  '&RETCODE'  SET XVARIABLE                    00190200
.ZG49C               ANOP  ,                                            00190300
.*-------------------------------------------------------------------   00190400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00190500
                     AIF   (K'&ZXRETCODE LE 0).ZG49R  NOT I/O           00190600
                     AIF   ('&XRETCODE'(1,1) NE '(').ZG49R              00190700
&ZCGPR               SETC  '&XRETCODE'(2,K'&XRETCODE-2)                 00190800
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                 00190900
                     AIF   (K'&ZCGPR GT 2).ZG49Q                        00191000
                     AIF   ('&ZCGPR' EQ '0').ZG49Q                      00191100
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00191200
                     AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME    00191300
.ZG49P               ANOP  ,                                            00191400
                     AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC         00191500
                     AIF   ('&ZCGPR' LT '2').ZG49Q                      00191600
                     AIF   ('&ZCGPR' LE '12').ZG49R                     00191700
.ZG49Q               ANOP  ,                                            00191800
&ZMS                 SETC  '"RETCODE='          *KGPRA* MNOTE           00191900
&ZMS                 SETC  '&ZMS.&RETCODE"'                             00192000
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00192100
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00192200
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00192300
.ZG49R               ANOP  ,                                            00192400
.*----------------------------------------------------------------***   00192500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00192600
                     AIF   (N'&RSNCODE LE 1).ZG52A  CK NUM              00192700
&ZMS                 SETC  '"RSNCODE='          *KPOSA* MNOTE           00192800
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00192900
&ZMS                 SETC  '&ZMS "RSNCODE"'                             00193000
                     MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'          00193100
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00193200
.ZG52A               ANOP  ,                                            00193300
.*-------------------------------------------------------------------   00193400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00193500
                     AIF   (K'&RSNCODE(1) LE 0).ZG52C  NO PARM          00193600
&ZXRSNCODE           SETC  'OUTPUT'    SET OUTPUT                       00193700
&XRSNCODE            SETC  '&RSNCODE(1)'        SET XVARIABLE           00193800
                     AIF   (N'&RSNCODE GT 1).ZG52C                      00193900
&XRSNCODE            SETC  '&RSNCODE'  SET XVARIABLE                    00194000
.ZG52C               ANOP  ,                                            00194100
.*-------------------------------------------------------------------   00194200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00194300
                     AIF   (K'&ZXRSNCODE LE 0).ZG52R  NOT I/O           00194400
                     AIF   ('&XRSNCODE'(1,1) NE '(').ZG52R              00194500
&ZCGPR               SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                 00194600
                     AIF   ('&ZCGPR'(1,1) NE '0').ZG52P                 00194700
                     AIF   (K'&ZCGPR GT 2).ZG52Q                        00194800
                     AIF   ('&ZCGPR' EQ '0').ZG52Q                      00194900
&ZCGPR               SETC  '&ZCGPR'(2,1)                                00195000
                     AIF   (T'&ZCGPR NE 'N').ZG52Q  INVALID REG NAME    00195100
.ZG52P               ANOP  ,                                            00195200
                     AIF   (T'&ZCGPR NE 'N').ZG52R  NON NUMERIC         00195300
                     AIF   ('&ZCGPR' LT '2').ZG52Q                      00195400
                     AIF   ('&ZCGPR' LE '12').ZG52R                     00195500
.ZG52Q               ANOP  ,                                            00195600
&ZMS                 SETC  '"RSNCODE='          *KGPRA* MNOTE           00195700
&ZMS                 SETC  '&ZMS.&RSNCODE"'                             00195800
&ZMS                 SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'    00195900
                     MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'             00196000
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00196100
.ZG52R               ANOP  ,                                            00196200
.******************************************************************     00196300
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00196400
.******************************************************************     00196500
                     ACTR  10000                                        00196600
.*----------------------------------------------------------------***   00196700
.***AH.P02 EXTRA POSITIONALS                                            00196800
                     AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS         00196900
                     AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL         00197000
                     AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL     00197100
                     AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL      00197200
.ZGLISTX1            ANOP  ,                                            00197300
&ZCVAL               SETC  ''          ERROR FIELD                      00197400
&ZAWRK               SETA  0           POSITIONAL NUMBER                00197500
.ZGLIST2             ANOP  ,                                            00197600
&ZAWRK               SETA  &ZAWRK+1    NEXT POSITIONAL                  00197700
                     AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE         00197800
&ZCVAL               SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA              00197900
                     AGO   .ZGLIST2                                     00198000
.*                                                                      00198100
.ZGLIST3             ANOP  ,                                            00198200
&ZCVAL               SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA           00198300
&ZMS                 SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE     00198400
&ZMS                 SETC  '&ZMS "&ZCVAL"'                              00198500
&ZMS                 SETC  '&ZMS CANNOT BE USED.'                       00198600
&ZMS                 SETC  '&ZMS NO POSITIONAL ARGUMENTS'               00198700
                     MNOTE 8,' &ZMS ARE ALLOWED.'                       00198800
&ZMACRET             SETA  8           SET MACRO ERROR RETURN CODE      00198900
.ZGLISTX             ANOP  ,                                            00199000
&ZASYSLNDX           SETA  0                                            00199100
.*-------------------------------------------------------------------   00199200
.***AG.MF04 MF=(SLE)                                                    00199300
.ZGMFX               ANOP  ,           END OF FULL SYNTAX CHECK         00199400
.*******************************************************************    00199500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00199600
.*******************************************************************    00199700
                     AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED         00199800
.*******************************************************************    00199900
.***AE.01  START OF IWMAEDEF MACRO CODE                                 00200000
.*******************************************************************    00200100
                     LCLC  &M0M0001                 NAME                00200200
&M0M0001             SETC  '&XLABEL'                SET NAME            00200300
                     AIF   (K'&XLABEL NE 0).XLAB2                       00200400
&M0M0001             SETC  'M00M&SYSNDX'            DEFAULT NAME        00200500
.*                                                                      00200600
.XLAB2               ANOP  ,                                            00200700
                     AIF   ('&XMF' EQ 'L').XLAB3                        00200800
&M0M0001 DS    0H                             IWMAEDEF-1                00200900
.XLAB3               ANOP  ,                                            00201000
.*******************************************************************    00201100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00201200
.*******************************************************************    00201300
              PUSH  PRINT                                               00201400
                     AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON   00201500
                     PRINT OFF         ++ PR01                          00201600
                     AGO   .ZPRNTXX                                     00201700
.ZPRINTX             PRINT ON                                           00201800
.ZPRNTXX             ANOP  ,                                            00201900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00202000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00202100
.********************************************************************   00202200
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00202300
.********************************************************************   00202400
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00202500
                      LCLA  &ZOPN1         INVOCATION INDEX             00202600
                      LCLC  &ZOPL(4095)    LABEL                        00202700
                      LCLC  &ZOPO(4095)    OPERATION                    00202800
                      LCLC  &ZOPV(4095)    VALUE                        00202900
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00203000
.*                                                                      00203100
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00203200
.******************************************************************     00203300
.***AL.L10 IWMAEDEF FMT=LIST MF=S!L PARAMETERS                          00203400
.******************************************************************     00203500
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00203600
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00203700
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00203800
&XMFATTR              SETC  '0D'                                        00203900
.*                                                                      00204000
&ZOPN                 SETA  &ZOPN+1                                     00204100
&ZOPL(&ZOPN)          SETC  ' '                                         00204200
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00204300
&ZOPO(&ZOPN)          SETC  'B'                                         00204400
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00204500
                      AGO   .ZALVL6B                                    00204600
.ZALVL6A              ANOP                                              00204700
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00204800
&ZOPV(&ZOPN)          SETC  '4,8'                                       00204900
&ZOPN                 SETA  &ZOPN+1                                     00205000
&ZOPL(&ZOPN)          SETC  ' '                                         00205100
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00205200
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00205300
.ZALVL6B              ANOP                                              00205400
&ZOPD(&ZOPN)          SETC  '++ IWMAEDEF ARG PARMS'                     00205500
.*                                                                      00205600
&ZOPN                 SETA  &ZOPN+1                                     00205700
&ZOPL(&ZOPN)          SETC  ' '                                         00205800
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00205900
&ZOPV(&ZOPN)          SETC  '1'                                         00206000
&ZOPD(&ZOPN)          SETC  ' '                                         00206100
.*                                                                      00206200
.ZLMFSL2              ANOP  ,                                           00206300
.*-------------------------------------------------------------------   00206400
.***AM.L00  IWMAEDEF FMT=LIST name                                      00206500
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00206600
&ZOPN                 SETA &ZOPN+1                                      00206700
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00206800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00206900
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00207000
&ZOPD(&ZOPN)          SETC '++ IWMAEDEF NAME'                           00207100
.ZLMFSL2M             ANOP  ,                                           00207200
.*-------------------------------------------------------------------   00207300
.***AM.L01  IWMAEDEF FMT=LIST PARAMETERS                                00207400
&ZOPN                 SETA &ZOPN+1                                      00207500
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00207600
&ZOPO(&ZOPN)          SETC 'DS'                                         00207700
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00207800
&ZOPD(&ZOPN)          SETC '++ IWMAEDEF PARM LIST'                      00207900
.*-------------------------------------------------------------------   00208000
.***AM.L02 XVERSION XL1                                                 00208100
&ZOPN                 SETA &ZOPN+1                                      00208200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00208300
&ZOPO(&ZOPN)          SETC 'DS'                                         00208400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00208500
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00208600
.*-------------------------------------------------------------------   00208700
.***AM.L09  XRSV001 CL1                                                 00208800
&ZOPN                 SETA &ZOPN+1                                      00208900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV001'                          00209000
&ZOPO(&ZOPN)          SETC 'DS'                                         00209100
&ZOPV(&ZOPN)          SETC 'CL1'                                        00209200
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV001'                       00209300
.*-------------------------------------------------------------------   00209400
.***AM.L09  XPLISTLEN XL2                                               00209500
&ZOPN                 SETA &ZOPN+1                                      00209600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00209700
&ZOPO(&ZOPN)          SETC 'DS'                                         00209800
&ZOPV(&ZOPN)          SETC 'XL2'                                        00209900
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTLEN'                        00210000
.*-------------------------------------------------------------------   00210100
.***AM.L09  XCONNTKN BL.32                                              00210200
&ZOPN                 SETA &ZOPN+1                                      00210300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         00210400
&ZOPO(&ZOPN)          SETC 'DS'                                         00210500
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00210600
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN  XCONNTKN'                    00210700
.*-------------------------------------------------------------------   00210800
.***AM.L03 XFUNC_OPTIONS BL.8                                           00210900
&ZOPN                 SETA &ZOPN+1                                      00211000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNC_OPTIONS'                    00211100
&ZOPO(&ZOPN)          SETC 'DS'                                         00211200
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00211300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00211400
.*                                                                      00211500
&ZOPN                 SETA  &ZOPN+1                                     00211600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_ADD'                       00211700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00211800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00211900
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00212000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ADD'                          00212100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00212200
.*                                                                      00212300
&ZOPN                 SETA  &ZOPN+1                                     00212400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_DELETE'                    00212500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00212600
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00212700
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00212800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DELETE'                       00212900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00213000
.*                                                                      00213100
&ZOPN                 SETA  &ZOPN+1                                     00213200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_MODIFY'                    00213300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00213400
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00213500
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00213600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MODIFY'                       00213700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00213800
.*-------------------------------------------------------------------   00213900
.***AM.L03 XAPPENV_OPTIONS BL.8                                         00214000
&ZOPN                 SETA &ZOPN+1                                      00214100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAPPENV_OPTIONS'                  00214200
&ZOPO(&ZOPN)          SETC 'DS'                                         00214300
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00214400
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00214500
.*                                                                      00214600
&ZOPN                 SETA  &ZOPN+1                                     00214700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSINGLE_SERVER_YES'              00214800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00214900
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00215000
&ZOPD(&ZOPN)          SETC  '++ XSINGLE_SERVER.'                        00215100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00215200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00215300
.*                                                                      00215400
&ZOPN                 SETA  &ZOPN+1                                     00215500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDISTRIBUTE_WORK_ROUND_ROBIN'    00215600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00215700
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00215800
&ZOPD(&ZOPN)          SETC  '++ XDISTRIBUTE_WORK.'                      00215900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ROUND_ROBIN'                  00216000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00216100
.*                                                                      00216200
&ZOPN                 SETA  &ZOPN+1                                     00216300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSTATIC_YES'                     00216400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00216500
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00216600
&ZOPD(&ZOPN)          SETC  '++ XSTATIC.'                               00216700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00216800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00216900
.*-------------------------------------------------------------------   00217000
.***AM.L09  XSELECT_POLICY XL1                                          00217100
&ZOPN                 SETA &ZOPN+1                                      00217200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSELECT_POLICY'                   00217300
&ZOPO(&ZOPN)          SETC 'DS'                                         00217400
&ZOPV(&ZOPN)          SETC 'XL1'                                        00217500
&ZOPD(&ZOPN)          SETC '++ &ZXSELECT_POLICY  XSELECT_POLICY'        00217600
.*-------------------------------------------------------------------   00217700
.***AM.L09  XRSV029 CL1                                                 00217800
&ZOPN                 SETA &ZOPN+1                                      00217900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV029'                          00218000
&ZOPO(&ZOPN)          SETC 'DS'                                         00218100
&ZOPV(&ZOPN)          SETC 'CL1'                                        00218200
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV029'                       00218300
.*-------------------------------------------------------------------   00218400
.***AM.L09 ADDR XAPPLENV A                                              00218500
&ZOPN                 SETA &ZOPN+1                                      00218600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAPPLENV_ADDR'                    00218700
&ZOPO(&ZOPN)          SETC 'DS'                                         00218800
&ZOPV(&ZOPN)          SETC 'A'                                          00218900
&ZOPD(&ZOPN)          SETC '++ &ZXAPPLENV ADDR XAPPLENV'                00219000
.*-------------------------------------------------------------------   00219100
.***AM.L09 ADDR XJCLPROC A                                              00219200
&ZOPN                 SETA &ZOPN+1                                      00219300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XJCLPROC_ADDR'                    00219400
&ZOPO(&ZOPN)          SETC 'DS'                                         00219500
&ZOPV(&ZOPN)          SETC 'A'                                          00219600
&ZOPD(&ZOPN)          SETC '++ &ZXJCLPROC ADDR XJCLPROC'                00219700
.*-------------------------------------------------------------------   00219800
.***AM.L09 ADDR XJCLPARMS A                                             00219900
&ZOPN                 SETA &ZOPN+1                                      00220000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XJCLPARMS_ADDR'                   00220100
&ZOPO(&ZOPN)          SETC 'DS'                                         00220200
&ZOPV(&ZOPN)          SETC 'A'                                          00220300
&ZOPD(&ZOPN)          SETC '++ &ZXJCLPARMS ADDR XJCLPARMS'              00220400
.*-------------------------------------------------------------------   00220500
.***AM.L10 END OF IWMAEDEF LIST PARAMETERS                              00220600
&ZOPN                 SETA &ZOPN+1                                      00220700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00220800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00220900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00221000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00221100
.*                                                                      00221200
&ZOPN                 SETA &ZOPN+1                                      00221300
&ZOPL(&ZOPN)          SETC ' '                                          00221400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00221500
&ZOPV(&ZOPN)          SETC '1'                                          00221600
&ZOPD(&ZOPN)          SETC ' '                                          00221700
.*-------------------------------------------------------------------   00221800
.***AL.L12 IWMAEDEF FMT=LIST MF=S!L PARAMETERS                          00221900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00222000
.*                                                                      00222100
&ZOPN                 SETA  &ZOPN+1                                     00222200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00222300
&ZOPO(&ZOPN)          SETC  'DC'                                        00222400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00222500
&ZOPD(&ZOPN)          SETC  '++ IWMAEDEF ARG PARMS'                     00222600
.*                                                                      00222700
.ZLMFSLX              ANOP  ,                                           00222800
.*-------------------------------------------------------------------   00222900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00223000
&ZPLLEN               SETA 24                                           00223100
.*                                                                      00223200
.******************************************************************     00223300
.***AI.L01 IWMAEDEF FMT=LIST FILL IN PARAMETER AREA                     00223400
.******************************************************************     00223500
                      ACTR  10000                                       00223600
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00223700
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00223800
&ZCVAL                SETC  'LAE'          XAX MODE                     00223900
.ZIMFXA               ANOP ,                                            00224000
.*                                                                      00224100
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00224200
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00224300
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00224400
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00224500
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00224600
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00224700
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00224800
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00224900
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00225000
&ZOPN                 SETA  &ZOPN+1                                     00225100
&ZOPL(&ZOPN)          SETC  ' '                                         00225200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00225300
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00225400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00225500
                      AGO   .ZIMFNX                                     00225600
.*                                                                      00225700
.ZIMFN2               ANOP ,                                            00225800
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00225900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00226000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00226100
&ZOPN                 SETA  &ZOPN+1                                     00226200
&ZOPL(&ZOPN)          SETC  ' '                                         00226300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00226400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00226500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00226600
                      AGO   .ZIMFNX                                     00226700
.ZIMFNX1              ANOP ,                                            00226800
&ZOPN                 SETA  &ZOPN+1                                     00226900
&ZOPL(&ZOPN)          SETC  ' '                                         00227000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00227100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00227200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00227300
.ZIMFNX               ANOP ,                                            00227400
.********************************************************************   00227500
.***AI.L02 IWMAEDEF FMT=LIST INITIALIZE PARAMETER AREA                  00227600
.********************************************************************   00227700
.***AI.L03 MF=(SLE)                                                     00227800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00227900
.*                                                                      00228000
&ZOPN                 SETA  &ZOPN+1                                     00228100
&ZOPL(&ZOPN)          SETC  ' '                                         00228200
&ZOPO(&ZOPN)          SETC  'XC'                                        00228300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00228400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00228500
.ZIMFLX               ANOP  ,                                           00228600
.*-------------------------------------------------------------------   00228700
.***AI.L04A XVERSION XL1                                                00228800
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00228900
&ZOPN                 SETA  &ZOPN+1                                     00229000
&ZOPL(&ZOPN)          SETC  ' '                                         00229100
&ZOPO(&ZOPN)          SETC  'MVI'                                       00229200
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00229300
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00229400
.ZIMFVW               ANOP  ,                                           00229500
.*-------------------------------------------------------------------   00229600
.***AI.L04 XPLISTLEN XL2                                                00229700
&ZOPN                 SETA  &ZOPN+1                                     00229800
&ZOPL(&ZOPN)          SETC  ' '                                         00229900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00230000
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      00230100
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00230200
.*-------------------------------------------------------------------   00230300
.***AI.L25  XCONNTKN XL4                                                00230400
                      AIF   ('&ZXCONNTKN' EQ '').ZI4E                   00230500
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI4E             00230600
&ZCGPR                SETC  '&XCONNTKN'                                 00230700
.*                                                                      00230800
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI4B              00230900
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    00231000
                      AGO   .ZI4D                                       00231100
.ZI4B                 ANOP  ,                                           00231200
.*                                                                      00231300
&ZC                   SETC  '&XCONNTKN'(1,1)                            00231400
                      AIF   (T'&ZC NE 'N').ZI4D                         00231500
&ZC                   SETC  '&XCONNTKN'                                 00231600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI4D                00231700
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         00231800
.*                                                                      00231900
.ZI4D                 ANOP  ,                                           00232000
.*                                                                      00232100
&ZOPN                 SETA  &ZOPN+1                                     00232200
&ZOPL(&ZOPN)          SETC  ' '                                         00232300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00232400
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00232500
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    00232600
.*                                                                      00232700
.ZI4E                 ANOP  ,                                           00232800
.*-------------------------------------------------------------------   00232900
.***AI.L05 XFUNC_OPTIONS BL1                                            00233000
&ZW                   SETC  ''                                          00233100
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00233200
.*-------------------------------------------------------------------   00233300
.***AI.L08 XFUNC_OPTIONS "ADD"                                          00233400
.***      BL1'1XXXXXXX'                                                 00233500
         AIF   ('&XFUNC' NE 'ADD').ZI6A                                 00233600
&ZW                   SETC  '&ZW.1'                                     00233700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00233800
                      AGO   .ZI6C                                       00233900
.*                                                                      00234000
.ZI6A                 ANOP  ,                                           00234100
&ZW                   SETC  '&ZW.0'                                     00234200
.ZI6C                 ANOP  ,                                           00234300
.*-------------------------------------------------------------------   00234400
.***AI.L08 XFUNC_OPTIONS "DELETE"                                       00234500
.***      BL1'X1XXXXXX'                                                 00234600
         AIF   ('&XFUNC' NE 'DELETE').ZI7A                              00234700
&ZW                   SETC  '&ZW.1'                                     00234800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00234900
                      AGO   .ZI7C                                       00235000
.*                                                                      00235100
.ZI7A                 ANOP  ,                                           00235200
&ZW                   SETC  '&ZW.0'                                     00235300
.ZI7C                 ANOP  ,                                           00235400
.*-------------------------------------------------------------------   00235500
.***AI.L08 XFUNC_OPTIONS "MODIFY"                                       00235600
.***      BL1'XX1XXXXX'                                                 00235700
         AIF   ('&XFUNC' NE 'MODIFY').ZI8A                              00235800
&ZW                   SETC  '&ZW.100000'                                00235900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00236000
                      AGO   .ZI8C                                       00236100
.*                                                                      00236200
.ZI8A                 ANOP  ,                                           00236300
&ZW                   SETC  '&ZW.000000'                                00236400
.ZI8C                 ANOP  ,                                           00236500
.*-------------------------------------------------------------------   00236600
.***AI.L11 XFUNC_OPTIONS BL1                                            00236700
                      AIF   ('&ZCLNG' NE 'YES').ZI8E  ALL ZERO BITS     00236800
&ZOPN                 SETA  &ZOPN+1                                     00236900
&ZOPL(&ZOPN)          SETC  ' '                                         00237000
&ZOPO(&ZOPN)          SETC  'OI'                                        00237100
&ZOPV(&ZOPN)          SETC  '8(1),B''&ZW'''                             00237200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00237300
.ZI8E                 ANOP  ,                                           00237400
.*-------------------------------------------------------------------   00237500
.***AI.L05 XAPPENV_OPTIONS BL1                                          00237600
&ZW                   SETC  ''                                          00237700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00237800
.*-------------------------------------------------------------------   00237900
.***AI.L08 XAPPENV_OPTIONS "YES"                                        00238000
.***      BL1'1XXXXXXX'                                                 00238100
         AIF   ('&XSINGLE_SERVER' NE 'YES').ZI10A                       00238200
&ZW                   SETC  '&ZW.1'                                     00238300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00238400
                      AGO   .ZI10C                                      00238500
.*                                                                      00238600
.ZI10A                ANOP  ,                                           00238700
&ZW                   SETC  '&ZW.0'                                     00238800
.ZI10C                ANOP  ,                                           00238900
.*-------------------------------------------------------------------   00239000
.***AI.L08 XAPPENV_OPTIONS "ROUND_ROBIN"                                00239100
.***      BL1'X1XXXXXX'                                                 00239200
         AIF   ('&XDISTRIBUTE_WORK' NE 'ROUND_ROBIN').ZI11A             00239300
&ZW                   SETC  '&ZW.1'                                     00239400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00239500
                      AGO   .ZI11C                                      00239600
.*                                                                      00239700
.ZI11A                ANOP  ,                                           00239800
&ZW                   SETC  '&ZW.0'                                     00239900
.ZI11C                ANOP  ,                                           00240000
.*-------------------------------------------------------------------   00240100
.***AI.L08 XAPPENV_OPTIONS "YES"                                        00240200
.***      BL1'XX1XXXXX'                                                 00240300
         AIF   ('&XSTATIC' NE 'YES').ZI12A                              00240400
&ZW                   SETC  '&ZW.100000'                                00240500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00240600
                      AGO   .ZI12C                                      00240700
.*                                                                      00240800
.ZI12A                ANOP  ,                                           00240900
&ZW                   SETC  '&ZW.000000'                                00241000
.ZI12C                ANOP  ,                                           00241100
.*-------------------------------------------------------------------   00241200
.***AI.L11 XAPPENV_OPTIONS BL1                                          00241300
                      AIF   ('&ZCLNG' NE 'YES').ZI12E  ALL ZERO BITS    00241400
&ZOPN                 SETA  &ZOPN+1                                     00241500
&ZOPL(&ZOPN)          SETC  ' '                                         00241600
&ZOPO(&ZOPN)          SETC  'OI'                                        00241700
&ZOPV(&ZOPN)          SETC  '9(1),B''&ZW'''                             00241800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00241900
.ZI12E                ANOP  ,                                           00242000
.*-------------------------------------------------------------------   00242100
.***AI.L25  XSELECT_POLICY XL1                                          00242200
                      AIF   ('&ZXSELECT_POLICY' EQ '').ZI13E            00242300
                      AIF   ('&ZXSELECT_POLICY' EQ 'OUTPUT').ZI13E      00242400
&ZCGPR                SETC  '&XSELECT_POLICY'                           00242500
         AIF   ('&XSELECT_POLICY' EQ '0').ZI13E                         00242600
         AIF   ('&XSELECT_POLICY' EQ '0').ZI13E                         00242700
.*                                                                      00242800
                      AIF   ('&XSELECT_POLICY'(1,1) NE '(').ZI13B       00242900
&ZCGPR   SETC  '0('.'&XSELECT_POLICY'(2,K'&XSELECT_POLICY-2).')'        00243000
                      AGO   .ZI13D                                      00243100
.ZI13B                ANOP  ,                                           00243200
.*                                                                      00243300
&ZC                   SETC  '&XSELECT_POLICY'(1,1)                      00243400
                      AIF   (T'&ZC NE 'N').ZI13D                        00243500
&ZC                   SETC  '&XSELECT_POLICY'                           00243600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               00243700
&ZCGPR                SETC  '=AL1(&XSELECT_POLICY)'                     00243800
.*                                                                      00243900
.ZI13D                ANOP  ,                                           00244000
.*                                                                      00244100
&ZOPN                 SETA  &ZOPN+1                                     00244200
&ZOPL(&ZOPN)          SETC  ' '                                         00244300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00244400
&ZOPV(&ZOPN)          SETC  '10(1,1),&ZCGPR'                            00244500
&ZOPD(&ZOPN)          SETC  '++ &ZXSELECT_POLICY XSELECT_POLICY'        00244600
.*                                                                      00244700
.ZI13E                ANOP  ,                                           00244800
.*-------------------------------------------------------------------   00244900
.***AI.L19 ADDR XAPPLENV A                                              00245000
                      AIF   ('&ZXAPPLENV' EQ '').ZI15H                  00245100
&ZCLNG                SETC  '&XAPPLENV'                                 00245200
&ZCGPR                SETC  '14'                                        00245300
         AIF   ('&XAPPLENV'(1,1) EQ '(').ZI15F  IN GPR                  00245400
.*                                                                      00245500
&ZOPN                 SETA  &ZOPN+1                                     00245600
&ZOPL(&ZOPN)          SETC  ' '                                         00245700
&ZOPO(&ZOPN)          SETC  'LA'                                        00245800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00245900
&ZOPD(&ZOPN)          SETC  '++ &ZXAPPLENV XAPPLENV'                    00246000
.*                                                                      00246100
                      AGO   .ZI15G                                      00246200
.*                                                                      00246300
.ZI15F                ANOP  ,                                           00246400
&ZCGPR   SETC  '&XAPPLENV'(2,K'&XAPPLENV-2)                             00246500
.*                                                                      00246600
.ZI15G                ANOP  ,                                           00246700
.*                                                                      00246800
&ZOPN                 SETA  &ZOPN+1                                     00246900
&ZOPL(&ZOPN)          SETC  ' '                                         00247000
&ZOPO(&ZOPN)          SETC  'ST'                                        00247100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00247200
&ZOPD(&ZOPN)          SETC  '++ &ZXAPPLENV XAPPLENV'                    00247300
.*                                                                      00247400
.ZI15H                ANOP  ,                                           00247500
.*-------------------------------------------------------------------   00247600
.***AI.L19 ADDR XJCLPROC A                                              00247700
                      AIF   ('&ZXJCLPROC' EQ '').ZI16H                  00247800
&ZCLNG                SETC  '&XJCLPROC'                                 00247900
&ZCGPR                SETC  '14'                                        00248000
         AIF   ('&XJCLPROC'(1,1) EQ '(').ZI16F  IN GPR                  00248100
.*                                                                      00248200
&ZOPN                 SETA  &ZOPN+1                                     00248300
&ZOPL(&ZOPN)          SETC  ' '                                         00248400
&ZOPO(&ZOPN)          SETC  'LA'                                        00248500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00248600
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPROC XJCLPROC'                    00248700
.*                                                                      00248800
                      AGO   .ZI16G                                      00248900
.*                                                                      00249000
.ZI16F                ANOP  ,                                           00249100
&ZCGPR   SETC  '&XJCLPROC'(2,K'&XJCLPROC-2)                             00249200
.*                                                                      00249300
.ZI16G                ANOP  ,                                           00249400
.*                                                                      00249500
&ZOPN                 SETA  &ZOPN+1                                     00249600
&ZOPL(&ZOPN)          SETC  ' '                                         00249700
&ZOPO(&ZOPN)          SETC  'ST'                                        00249800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00249900
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPROC XJCLPROC'                    00250000
.*                                                                      00250100
.ZI16H                ANOP  ,                                           00250200
.*-------------------------------------------------------------------   00250300
.***AI.L19 ADDR XJCLPARMS A                                             00250400
                      AIF   ('&ZXJCLPARMS' EQ '').ZI17H                 00250500
&ZCLNG                SETC  '&XJCLPARMS'                                00250600
&ZCGPR                SETC  '14'                                        00250700
         AIF   ('&XJCLPARMS'(1,1) EQ '(').ZI17F  IN GPR                 00250800
        AIF   ('&XJCLPARMS' EQ '0').ZI17H                               00250900
.*                                                                      00251000
.*                                                                      00251100
&ZOPN                 SETA  &ZOPN+1                                     00251200
&ZOPL(&ZOPN)          SETC  ' '                                         00251300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00251400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00251500
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPARMS XJCLPARMS'                  00251600
.*                                                                      00251700
                      AGO   .ZI17G                                      00251800
.*                                                                      00251900
.ZI17F                ANOP  ,                                           00252000
&ZCGPR   SETC  '&XJCLPARMS'(2,K'&XJCLPARMS-2)                           00252100
.*                                                                      00252200
.ZI17G                ANOP  ,                                           00252300
.*                                                                      00252400
&ZOPN                 SETA  &ZOPN+1                                     00252500
&ZOPL(&ZOPN)          SETC  ' '                                         00252600
&ZOPO(&ZOPN)          SETC  'ST'                                        00252700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,20(,1)'                             00252800
&ZOPD(&ZOPN)          SETC  '++ &ZXJCLPARMS XJCLPARMS'                  00252900
.*                                                                      00253000
.ZI17H                ANOP  ,                                           00253100
.*-------------------------------------------------------------------   00253200
&ZOPN1                SETA &ZOPN                                        00253300
.*******************************************************************    00253400
.***  PROCESS IWMAEDEF OUTPUT PARAMETERS                                00253500
.*******************************************************************    00253600
                      ACTR  10000                                       00253700
.*******************************************************************    00253800
.***AO.X02  RETURN CODE PROCESSING                                      00253900
.*******************************************************************    00254000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00254100
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00254200
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00254300
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00254400
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00254500
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00254600
&ZOPN                 SETA  &ZOPN+1                                     00254700
&ZOPL(&ZOPN)          SETC  ' '                                         00254800
&ZOPO(&ZOPN)          SETC  'ST'                                        00254900
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00255000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00255100
                      AGO   .ZMRETX                                     00255200
.*                                                                      00255300
.ZMRET2               ANOP  ,                                           00255400
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00255500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00255600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00255700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00255800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00255900
&ZOPN                 SETA  &ZOPN+1                                     00256000
&ZOPL(&ZOPN)          SETC  ' '                                         00256100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00256200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00256300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00256400
.ZMRETX               ANOP  ,                                           00256500
.*******************************************************************    00256600
.***AO.X03  REASON CODE PROCESSING                                      00256700
.*******************************************************************    00256800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00256900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00257000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00257100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00257200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00257300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00257400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00257500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00257600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00257700
&ZOPN                 SETA  &ZOPN+1                                     00257800
&ZOPL(&ZOPN)          SETC  ' '                                         00257900
&ZOPO(&ZOPN)          SETC  'ST'                                        00258000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00258100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00258200
                      AGO   .ZMRSNX                                     00258300
.*                                                                      00258400
.ZMRSN2               ANOP  ,                                           00258500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00258600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00258700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00258800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00258900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00259000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00259100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00259200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00259300
&ZOPN                 SETA  &ZOPN+1                                     00259400
&ZOPL(&ZOPN)          SETC  ' '                                         00259500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00259600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00259700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00259800
.ZMRSNX               ANOP  ,                                           00259900
.*******************************************************************    00260000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00260100
.*******************************************************************    00260200
.ZMFLX                ANOP  ,              MF=L PROCESSING              00260300
.*******************************************************************    00260400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00260500
.*******************************************************************    00260600
                      ACTR  10000                                       00260700
.*                                                                      00260800
                      LCLA  &ZLC           COLUMN POSITION              00260900
                      LCLA  &ZOPX          LIST TABLE INDEX             00261000
                      LCLC  &ZLL           LABEL                        00261100
                      LCLC  &ZLOP          OPERATION                    00261200
                      LCLC  &ZLV           VALUE                        00261300
                      LCLC  &ZLD           DESCRIPTION                  00261400
.*                                                                      00261500
&ZOPX                 SETA  1                                           00261600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00261700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00261800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00261900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00262000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00262100
                      AIF   (K'&ZLD LE 0).ZL5                           00262200
&ZLC                  SETA  35             COMMENT COLUMN               00262300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00262400
&ZLC                  SETA  33             COMMMENT COLUMN              00262500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00262600
&ZLV                  SETC  '&ZLV'.' '                                  00262700
                      AGO   .ZL3                                        00262800
.*                                                                      00262900
.ZL4                  ANOP  ,                                           00263000
&ZLV                  SETC  '&ZLV'.' '                                  00263100
.ZL5                  ANOP  ,                                           00263200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00263300
.*                                                                      00263400
&ZLL     &ZLOP &ZLV                                                     00263500
.*                                                                      00263600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00263700
                      AGO   .ZL2           CONTINUE LOOPING             00263800
.*                                                                      00263900
.ZLX                  ANOP  ,                                           00264000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00264100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00264200
     L     14,16(0,0)              GET CVT ADDRESS                      00264300
     L     14,772(14,0)            GET SFT ADDRESS                      00264400
     L     14,380(14,0)            GET LX FOR SERVICE ROUTINE           00264500
     LA    15,108                  GET EX FOR SERVICE ROUTINE           00264600
     OR    14,15                   GET PC NUMBER                        00264700
     PC    0(14)                                                        00264800
END&SYSNDX DS    0H                END LABEL                            00264900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00265000
.ZLINKX               ANOP  ,                                           00265100
.*******************************************************************    00265200
.***AP.X01  FORMAT GENERATED CODE                                       00265300
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00265400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00265500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00265600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00265700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00265800
                      AIF   (K'&ZLD LE 0).ZL51                          00265900
&ZLC                  SETA  35             COMMENT COLUMN               00266000
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00266100
&ZLC                  SETA  33             COMMENT COLUMN               00266200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00266300
&ZLV                  SETC  '&ZLV'.' '                                  00266400
                      AGO   .ZL31                                       00266500
.*                                                                      00266600
.ZL41                 ANOP  ,                                           00266700
&ZLV                  SETC  '&ZLV'.' '                                  00266800
.ZL51                 ANOP  ,                                           00266900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00267000
.*                                                                      00267100
&ZLL     &ZLOP &ZLV                                                     00267200
.*                                                                      00267300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00267400
                      AGO   .ZL21          CONTINUE LOOPING             00267500
.*                                                                      00267600
.ZLX1                 ANOP  ,                                           00267700
.*******************************************************************    00267800
.***AP.X02  END OF IWMAEDEF MACRO                                       00267900
&ZIWMAEDEF            SETC  'YES'          SET IWMAEDEF USED            00268000
         POP   PRINT                                                    00268100
*                                            IWMAEDEF-1                 00268200
         SPACE 1                                                        00268300
.ZLX2                 ANOP  ,                                           00268400
         MEND                                                           00268500
**********************************************************************/ 00268600
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00268700
*%IWMAEDEF: MACRO KEYS(CONNTKN,FUNC,APPLENV,JCLPROC,JCLPARMS,           00268800
*                 SINGLE_SERVER,SELECT_POLICY,DISTRIBUTE_WORK,STATIC,   00268900
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00269000
*  ANS('?'!!MACLABEL!!' '!!'IWMAEDEP '!!MACLIST!!                       00269100
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00269200
*%END IWMAEDEF;                                                         00269300

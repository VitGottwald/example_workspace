*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWMMSTRT                              -01/29/13-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Indicate the start of a work unit             * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2007, 2013                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7790                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The purpose of this service is to indicate that a work unit is * 00002100
*      beginning execution. The work unit runs under the specified    * 00002200
*      monitoring environment, but is reported to EWLM completely     * 00002300
*      independent from a potentially running transaction on the same * 00002400
*      monitoring environment that is defined by IWM4MINI and         * 00002500
*      IWMRPT/IWMMNTFY calls. You can use the set of services         * 00002600
*      IWMMSTRT, IWMMSTOP, IWMMUPD to provide data for "mini work     * 00002700
*      units" running within a long-running transaction.              * 00002800
*      In addition a work unit started by IWMMSTRT can participate in * 00002900
*      asynchronous and synchronous work unit flows.                  * 00003000
*                                                                     * 00003100
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003200
*                                                                     * 00003300
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003400
*                                                                     * 00003500
*01* ENVIRONMENT:                                                     * 00003600
*                                                                     * 00003700
*                                                                     * 00003800
*      Dispatchable unit mode: Task or SRB mode.                      * 00003900
*                                                                     * 00004000
*      Minimum authorization: Supervisor state or program key mask    * 00004100
*                        (PKM) allowing keys 0-7.                     * 00004200
*                                                                     * 00004300
*      AMODE:            31-bit.                                      * 00004400
*                                                                     * 00004500
*      ASC mode:         Primary.                                     * 00004600
*                                                                     * 00004700
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00004800
*                                                                     * 00004900
*      Interrupt status: Enabled for I/O and external interrupts.     * 00005000
*                                                                     * 00005100
*      Locks:            No restriction.                              * 00005200
*                                                                     * 00005300
*      Control parameters: Control parameters must be in the primary  * 00005400
*                        address space.                               * 00005500
*                                                                     * 00005600
*                                                                     * 00005700
*                                                                     * 00005800
*01* PROGRAMMING REQUIREMENTS:                                        * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*    1.  The macro CVT must be included to use this macro.            * 00006200
*                                                                     * 00006300
*    2.  The macro IWMYCON must be included to use this macro.        * 00006400
*                                                                     * 00006500
*    3.  The macro IWMPB must be in the library concatenation, since  * 00006600
*        it is included by IWMYCON.                                   * 00006700
*                                                                     * 00006800
*    4.  Note that the high order halfword of bits 0-31 of register   * 00006900
*        0, and the reason code variable when specified, may be       * 00007000
*        non-zero and represents diagnostic data which is NOT part of * 00007100
*        the external interface.  The high order halfword should thus * 00007200
*        be excluded from comparison with the reason code values      * 00007300
*        described above.  The constant, IWMRSNCODE_MASK_CONST        * 00007400
*        defined in IWMYCON, may be used for this purpose.            * 00007500
*                                                                     * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*01* RESTRICTIONS:                                                    * 00007900
*                                                                     * 00008000
*                                                                     * 00008100
*    1.  This macro may not be used prior to the completion of WLM    * 00008200
*        address space initialization                                 * 00008300
*                                                                     * 00008400
*    2.  The caller must have issued the IWM4MCRE macro successfully  * 00008500
*        and the created delay monitoring environment must be enabled * 00008600
*        for EWLM support.  This means the delay monitoring           * 00008700
*        environment must be created by one of the following ways:    * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*        o   IWM4CONN EWLM=YES ...  and IWM4MCRE SUBSYSP=CONNECT ...  * 00009100
*            OR                                                       * 00009200
*                                                                     * 00009300
*        o   IWM4MCRE SUBSYSP=VALUE EWLM=YES ...                      * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*                                                                     * 00009700
*    3.  The caller is responsible for error recovery.                * 00009800
*                                                                     * 00009900
*    4.  The current PSW key must be 0 or match the key specified on  * 00010000
*        IWM4MCRE provided the latter is a system key (0-7).          * 00010100
*                                                                     * 00010200
*    5.  The caller must serialize to prevent any delay monitoring    * 00010300
*        services from being invoked concurrently for the environment * 00010400
*        represented by the monitoring token.                         * 00010500
*                                                                     * 00010600
*                                                                     * 00010700
*                                                                     * 00010800
*01* INPUT REGISTER INFORMATION:                                      * 00010900
*                                                                     * 00011000
*    Before issuing the IWMMSTRT macro, the caller does not have to   * 00011100
*    place any information into any register unless using it in       * 00011200
*    register notation for a particular parameter, or using it as a   * 00011300
*    base register.                                                   * 00011400
*                                                                     * 00011500
*01* OUTPUT REGISTER INFORMATION:                                     * 00011600
*                                                                     * 00011700
*    When control returns to the caller, the GPRs contain:            * 00011800
*                                                                     * 00011900
*                                                                     * 00012000
*    REGISTER  CONTENTS                                               * 00012100
*                                                                     * 00012200
*    0         Reason code if the return code in GPR 15 is not 0,     * 00012300
*              otherwise, used as a work register by the system. The  * 00012400
*              reason code is stored in bits 0-31                     * 00012500
*                                                                     * 00012600
*    1         Used as work register by the system                    * 00012700
*                                                                     * 00012800
*    2-13      Unchanged                                              * 00012900
*                                                                     * 00013000
*    14        Used as work register by the system                    * 00013100
*                                                                     * 00013200
*    15        Return Code stored in bits 0-31                        * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*    When control returns to the caller, the ARs contain:             * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*    REGISTER  CONTENTS                                               * 00014000
*                                                                     * 00014100
*    0-1       Used as work registers by the system                   * 00014200
*                                                                     * 00014300
*    2-13      Unchanged                                              * 00014400
*                                                                     * 00014500
*    14-15     Used as work registers by the system.                  * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*    Some callers depend on register contents remaining the same      * 00015000
*    before and after issuing a service.  If the system changes the   * 00015100
*    contents of registers on which the caller depends, the caller    * 00015200
*    must save them before issuing the service, and restore them      * 00015300
*    after the system returns control.                                * 00015400
*                                                                     * 00015500
*01* PERFORMANCE IMPLICATIONS:                                        * 00015600
*                                                                     * 00015700
*    None                                                             * 00015800
*                                                                     * 00015900
*01* SYNTAX:                                                          * 00016000
*                                                                     * 00016100
*Ýxlabel¨  IWMMSTRT     MONTKN=xmontkn                                * 00016200
*                     Ý,END_FLOW=»NO!YESº¨                            * 00016300
*                     Ý,MSG_RECEIVED=»NO!YESº¨                        * 00016400
*                     Ý,ARRIVALTIME=»xarrivaltime!NO_ARRIVALTIMEº¨    * 00016500
*                    Ð ,EWLM_S_PACORR=xewlm_s_pacorr                  * 00016600
*                    ¿ ,EWLM_S_CURCORR=xewlm_s_curcorr                * 00016700
*                         Ý,EWLM_RCVD_CORR                            * 00016800
*                                          =»xewlm_rcvd_corr!NO_EWLM_ * 00016900
*                                          RCVD_CORRº¨                * 00017000
*                     Ý,RETCODE=xretcode¨                             * 00017100
*                     Ý,RSNCODE=xrsncode¨                             * 00017200
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00017300
*                    ÐÝ,MF=S¨                                         * 00017400
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00017500
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*      Where:                                                         * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*      Ýxlabel¨                                                       * 00018200
*          is an optional symbol, starting in column 1, that is the   * 00018300
*          name on the IWMMSTRT macro invocation.  The name must      * 00018400
*          conform to the rules for an ordinary assembler language    * 00018500
*          symbol.                                                    * 00018600
*          DEFAULT: No name.                                          * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*      MONTKN=xmontkn                                                 * 00019200
*          is the name (RS-type), or address in register (2)-(12), of * 00019300
*          a required 32 bit input which contains the delay           * 00019400
*          monitoring token                                           * 00019500
*                                                                     * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*      ÝEND_FLOW=»NO!YESº¨                                            * 00020000
*          is an optional keyword input which indicates the           * 00020100
*          completion of a message flow.                              * 00020200
*          DEFAULT: NO                                                * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*          END_FLOW=NO                                                * 00020600
*                                                                     * 00020700
*              indicates that a message flow has not completed.       * 00020800
*                                                                     * 00020900
*          END_FLOW=YES                                               * 00021000
*                                                                     * 00021100
*              indicates that a message flow has completed.  Specify  * 00021200
*              END_FLOW=YES, if you know that this work unit is the   * 00021300
*              last one in a work unit flow. This indication can not  * 00021400
*              be cleared, if it has been set.                        * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*      ÝMSG_RECEIVED=»NO!YESº¨                                        * 00022200
*          is an optional keyword input which indicates whether this  * 00022300
*          work unit has been started as a result of a receipt of a   * 00022400
*          message.                                                   * 00022500
*          DEFAULT: NO                                                * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*          MSG_RECEIVED=NO                                            * 00022900
*                                                                     * 00023000
*              indicates that this work unit has not been started by  * 00023100
*              receipt of a message.                                  * 00023200
*                                                                     * 00023300
*          MSG_RECEIVED=YES                                           * 00023400
*                                                                     * 00023500
*              indicates that this work unit has been started as a    * 00023600
*              result of a receipt of a message.                      * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*      ÝARRIVALTIME=»xarrivaltime!NO_ARRIVALTIMEº¨                    * 00024400
*          is the name (RS-type), or address in register (2)-(12), of * 00024500
*          an optional 8 character input which contains a timestamp   * 00024600
*          in STCK format.  This timestamp is subtracted from the     * 00024700
*          current timestamp and assigned as queued time to the work  * 00024800
*          unit.                                                      * 00024900
*          For example, you may use this parameter, if the work unit  * 00025000
*          is started by receipt of a message from a queue and you    * 00025100
*          know the put time (the timestamp when the message has been * 00025200
*          put onto the queue).                                       * 00025300
*                                                                     * 00025400
*          DEFAULT: NO_ARRIVALTIME indicates that parameter           * 00025500
*          ARRIVALTIME has not been specified.                        * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*      The following is a set of mutually exclusive keys.  This set   * 00026100
*      is required; only one key must be specified.                   * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*      EWLM_S_PACORR=xewlm_s_pacorr                                   * 00026500
*          belongs to a set of mutually exclusive keys. It is the     * 00026600
*          name (RS-type), or address in register (2)-(12), of a      * 00026700
*          character input which contains a cross platform Enterprise * 00026800
*          Workload Management (EWLM) parent correlator received from * 00026900
*          another application.                                       * 00027000
*                                                                     * 00027100
*      EWLM_S_CURCORR=xewlm_s_curcorr                                 * 00027200
*          belongs to a set of mutually exclusive keys. It is the     * 00027300
*          name (RS-type), or address in register (2)-(12), of a      * 00027400
*          character input which contains a cross platform Enterprise * 00027500
*          Workload Management (EWLM) correlator for the current      * 00027600
*          application.                                               * 00027700
*          The correlator passed to this parameter is used as the     * 00027800
*          current correlator of this work unit. It has usually been  * 00027900
*          created by means of a previous IWMCLSFY call with the      * 00028000
*          EWLM_CHCORR parameter (see below).                         * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*          ÝEWLM_RCVD_CORR=»xewlm_rcvd_corr!NO_EWLM_RCVD_CORRº¨       * 00028500
*              is the name (RS-type), or address in register          * 00028600
*              (2)-(12), of an optional character input which         * 00028700
*              contains a cross platform Enterprise Workload          * 00028800
*              Management (EWLM) correlator received from another     * 00028900
*              application.                                           * 00029000
*              Normally this is a received correlator which has the   * 00029100
*              independent flag and the asynchronous flag set. It     * 00029200
*              should not be passed to the EWLM_S_PACORR or the       * 00029300
*              EWLM_S_CURCORR parameter. If you pass this correlator  * 00029400
*              to one of them then the started work unit is not       * 00029500
*              reclassified and runs under the classification of this * 00029600
*              correlator. When you receive a correlator with the     * 00029700
*              independent flag set then you should:                  * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*              1.  Reclassify the work unit by issuing IWMCLSFY       * 00030100
*                  EWLM_CORR=r_corr EWLM_CHCORR=c_corr. r_corr is the * 00030200
*                  received correlator and c_corr is the correlator   * 00030300
*                  created by IWMCLSFY.                               * 00030400
*                                                                     * 00030500
*              2.  Start the work unit by issuing IWMMSTRT            * 00030600
*                  EWLM_S_CURCORR=c_corr EWLM_RCVD_CORR=r_corr .      * 00030700
*                                                                     * 00030800
*                                                                     * 00030900
*              DEFAULT: NO_EWLM_RCVD_CORR                             * 00031000
*              indicates that parameter EWLM_RCVD_CORR has not been   * 00031100
*              specified.                                             * 00031200
*                                                                     * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*      End of a set of mutually exclusive required keys.              * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*      ÝRETCODE=xretcode¨                                             * 00032200
*          is the name (RS-type) of an optional fullword output       * 00032300
*          variable, or register (2)-(12) or (15), into which the     * 00032400
*          return code is to be copied from GPR 15.  If you specify   * 00032500
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00032600
*          the value will be left in GPR 15.                          * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*      ÝRSNCODE=xrsncode¨                                             * 00033200
*          is the name (RS-type) of an optional fullword output       * 00033300
*          variable into which the reason code is to be copied from   * 00033400
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00033500
*          R0 (within or without parentheses), the value will be left * 00033600
*          in GPR 0.                                                  * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*                                                                     * 00034100
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00034200
*          is an optional byte input decimal value in the "0-0" range * 00034300
*          that specifies the macro version.  PLISTVER is the only    * 00034400
*          key allowed on the list form of MF and determines which    * 00034500
*          parameter list is generated.  Note that MAX may be         * 00034600
*          specified instead of a number, and the parameter list will * 00034700
*          be of the largest size currently supported. This size may  * 00034800
*          grow from release to release (thus possibly affecting the  * 00034900
*          amount of storage needed by your program).  If your        * 00035000
*          program can tolerate this, IBM recommends that you always  * 00035100
*          specify MAX when creating the list form parameter list as  * 00035200
*          that will ensure that the list form parameter list is      * 00035300
*          always long enough to hold whatever parameters might be    * 00035400
*          specified on the execute form.                             * 00035500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00035600
*          default is the lowest version which allows all of the      * 00035700
*          parameters specified on the invocation to be processed.    * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*      ÝMF=»S!L!Eº¨                                                   * 00036300
*          is an optional keyword input which specifies the macro     * 00036400
*          form.                                                      * 00036500
*          DEFAULT: S                                                 * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*          ÝMF=S¨                                                     * 00036900
*              specifies the standard form of the macro.  The "S"     * 00037000
*              form generates code to put the parameters into an      * 00037100
*              in-line parameter list and invoke the desired service. * 00037200
*              Full checking for required macro keys is done along    * 00037300
*              with supplying defaults for omitted optional           * 00037400
*              parameters.                                            * 00037500
*                                                                     * 00037600
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00037700
*              specifies the list form of the macro.  The "L" form    * 00037800
*              defines an area to be used for the parameter list.     * 00037900
*              Only the PLISTVER key may be specified on the          * 00038000
*              invocation.  All other macro parameters are flagged as * 00038100
*              errors.  If PLISTVER is not specified, the original    * 00038200
*              parameter list definition is used.                     * 00038300
*                                                                     * 00038400
*            ,xmfctrl                                                 * 00038500
*              is a required input.  It is the name of a storage area * 00038600
*              for the parameter list.                                * 00038700
*                                                                     * 00038800
*            »,xmfattr!0Dº                                            * 00038900
*              is an optional 60 character input string that varies   * 00039000
*              from 1 to 60 characters. Use it to force boundary      * 00039100
*              alignment of the parameter list. Use only 0F or 0D.    * 00039200
*              DEFAULT: 0D which forces the parameter list to a       * 00039300
*              doubleword boundary.                                   * 00039400
*                                                                     * 00039500
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00039600
*              specifies the execute form of the macro.  The "E" form * 00039700
*              generates code to put the parameters into the          * 00039800
*              parameter list specified by xmfctrl and provides full  * 00039900
*              syntax checking with default setting.                  * 00040000
*                                                                     * 00040100
*            ,xmfctrl                                                 * 00040200
*              is a required input.  It is the name (RS-type), or     * 00040300
*              address in register (1)-(12), of a storage area for    * 00040400
*              the parameter list.                                    * 00040500
*                                                                     * 00040600
*            »,COMPLETEº                                              * 00040700
*              is an optional keyword input which specifies the       * 00040800
*              degree of macro parameter syntax checking.             * 00040900
*              DEFAULT: COMPLETE                                      * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*              COMPLETE                                               * 00041300
*                  Checking for required macro keys is done and       * 00041400
*                  defaults are supplied for omitted optional         * 00041500
*                  parameters.                                        * 00041600
*                                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*01* ABEND CODES:  None.                                              * 00042400
*                                                                     * 00042500
*01* RETURN CODES:                                                    * 00042600
*                                                                     * 00042700
*                                                                     * 00042800
*            0    Name: IwmRetCodeOk                                  * 00042900
*                                                                     * 00043000
*                 Meaning: Successful completion.                     * 00043100
*                                                                     * 00043200
*                 Action: None required.                              * 00043300
*                                                                     * 00043400
*            4    Name: IwmRetCodeWarning                             * 00043500
*                                                                     * 00043600
*                 Meaning: Successful completion, unusual conditions  * 00043700
*                 noted.                                              * 00043800
*                                                                     * 00043900
*                                                                     * 00044000
*                 HEX REASON  MEANING/ACTION                          * 00044100
*                 CODE                                                * 00044200
*                                                                     * 00044300
*                 xxxx0402    Name: IwmRsnCodeNoMonEnv                * 00044400
*                                                                     * 00044500
*                             Meaning:  The input monitoring token    * 00044600
*                             indicates no monitoring environment was * 00044700
*                             established.                            * 00044800
*                                                                     * 00044900
*                             Action: Establish a monitoring          * 00045000
*                             environment by macro IWM4MCRE.          * 00045100
*                                                                     * 00045200
*                 xxxx0442    Name: IwmRsnCodeCorrelatorUnknown       * 00045300
*                                                                     * 00045400
*                             Meaning:  A unknown correlator has been * 00045500
*                             passed to the EWLM_RCVD_CORR parameter. * 00045600
*                             It is ignored.                          * 00045700
*                                                                     * 00045800
*                             Action: None required.                  * 00045900
*                                                                     * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*            8    Name: IwmRetCodeInvocError                          * 00046300
*                                                                     * 00046400
*                 Meaning: Invalid invocation environment or          * 00046500
*                 parameters.                                         * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                 HEX REASON  MEANING/ACTION                          * 00046900
*                 CODE                                                * 00047000
*                                                                     * 00047100
*                 xxxx0820    Name: IwmRsnCodeBadMonEnv               * 00047200
*                                                                     * 00047300
*                             Meaning:  Input monitoring environment  * 00047400
*                             does not pass short form validity       * 00047500
*                             checking.                               * 00047600
*                                                                     * 00047700
*                             Action: Check for possible storage      * 00047800
*                             overlay.                                * 00047900
*                                                                     * 00048000
*                 xxxx0894    Name: IwmRsnCodeInvalidEwlmCorr         * 00048100
*                                                                     * 00048200
*                             Meaning:  An unknown EWLM correlator    * 00048300
*                             has been passed to the EWLM_S_PACORR or * 00048400
*                             EWLM_S_CURCORR parameter.               * 00048500
*                                                                     * 00048600
*                             Action: Specify a supported correlator. * 00048700
*                             You can create a supported correlator   * 00048800
*                             by macro IWMCLSFY.                      * 00048900
*                                                                     * 00049000
*                 xxxx0895    Name: IwmRsnCodeEWLMServNotEnabled      * 00049100
*                                                                     * 00049200
*                             Meaning:  The EWLM service was not      * 00049300
*                             enabled for a delay monitoring          * 00049400
*                             environment.                            * 00049500
*                                                                     * 00049600
*                             Action: Create a monitoring environment * 00049700
*                             with EWLM=YES (either on macro IWM4CON  * 00049800
*                             or macro IWM4MCRE).                     * 00049900
*                                                                     * 00050000
*                 xxxx08AD    Name: IwmRsnCodeAlreadyActive           * 00050100
*                                                                     * 00050200
*                             Meaning:  A work unit started by        * 00050300
*                             IWMMSTRT is already active.             * 00050400
*                                                                     * 00050500
*                             Action: Stop the active work unit by    * 00050600
*                             macro IWMMSTOP before creating a new    * 00050700
*                             one.                                    * 00050800
*                                                                     * 00050900
*                 xxxx08AF    Name: IwmRsnCodeArrTimeGTStartTime      * 00051000
*                                                                     * 00051100
*                             Meaning:  The arrivaltime passed is     * 00051200
*                             greater than the current timestamp.     * 00051300
*                                                                     * 00051400
*                             Action: Check the format of the passed  * 00051500
*                             arrivaltime.                            * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*                                                                     * 00051900
*                                                                     * 00052000
*                                                                     * 00052100
*01* REASON CODES:                                                    * 00052200
*                                                                     * 00052300
*       A reason code will be returned whenever the return code is    * 00052400
*       non-zero.  Reason codes, as appropriate, are defined under    * 00052500
*       their corresponding return code.  Reason code and return code * 00052600
*       constants are defined within IWMYCON.  Note that the high     * 00052700
*       order halfword of bits 0-31 of register 0, and the reason     * 00052800
*       code variable when specified, may be non-zero and represents  * 00052900
*       diagnostic data which is NOT part of the external interface.  * 00053000
*       The high order halfword should thus be excluded from          * 00053100
*       comparison with the reason code values described above.  The  * 00053200
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00053300
*       used for this purpose.                                        * 00053400
*                                                                     * 00053500
*01* MODULE TYPE:  ASSEM MACRO                                        * 00053600
*                                                                     * 00053700
*02*   PROCESSOR:  ASSEM                                              * 00053800
*                                                                     * 00053900
*01* COMPONENT:  SCWLM                                                * 00054000
*                                                                     * 00054100
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00054200
*                                                                     * 00054300
*01* EXAMPLES:                                                        * 00054400
*                                                                     * 00054500
*01* MACRO USAGE NOTES:                                               * 00054600
*                                                                     * 00054700
*                                                                     * 00054800
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00054900
*        global macro variable.  Any value other than 'NO' will       * 00055000
*        result in the macro expansion being printed.  The default is * 00055100
*        'YES'.  The following examples illustrate how the ZPRINT     * 00055200
*        variable should be set.                                      * 00055300
*                                                                     * 00055400
*                    GBLC &ZPRINT                                     * 00055500
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00055600
*                                                                     * 00055700
*                                                                     * 00055800
*    2.  All   keys   currently   contained  in  the  IWMMSTRT  macro * 00055900
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00056000
*        value of 0 or MAX.                                           * 00056100
*                                                                     * 00056200
*                                                                     * 00056300
*                                                                     * 00056400
*                                                                     * 00056500
*01* CHANGE ACTIVITY:                                                 * 00056600
*                                                                     * 00056700
*   Flag LineItem  FMID    Date   ID    Comment                       * 00056800
*                                                                     * 00056900
*    $L0=LEWLMQ   HBB7740 060814 3241KK:  Initial version             * 00057000
*    $L1=LPBABV   HBB7790 111020 3241AH:  IWM4MSTR created. Please do * 00057100
*                                         not change this macro any   * 00057200
*                                         longer.                     * 00057300
****** END OF SPECIFICATIONS *****************************************/ 00057400
*/********************************************************************* 00057500
         MACRO                                                          00057600
&XLABEL  IWMMSTRT &MONTKN=,&END_FLOW=,&MSG_RECEIVED=,&ARRIVALTIME=,    *00057700
               &EWLM_S_PACORR=,&EWLM_S_CURCORR=,&EWLM_RCVD_CORR=,      *00057800
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00057900
.*                                                                      00058000
*                    MACDATE -01/29/13-<0>                              00058100
.*                                                                      00058200
.*******************************************************************    00058300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00058400
.*******************************************************************    00058500
                    GBLC  &ZPRINT     YES=PRINT NO=NO PRINT             00058600
                    GBLC  &ZTEST      YES=TEST NO=NO TEST               00058700
                    GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX       00058800
.*                                                                      00058900
                    GBLC  &ZIWMMSTRT  YES=MACRO USED AT LEAST ONCE      00059000
.*******************************************************************    00059100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00059200
.*******************************************************************    00059300
                    LCLC  &ZMS        ERROR MESSAGE WORK AREA           00059400
                    LCLC  &ZCNDX      SYSNDX CHARACTERS                 00059500
                    LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED        00059600
                    LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR       00059700
                    LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE       00059800
                    LCLA  &ZAWRK      USED AS A WORK AREA               00059900
                    LCLA  &ZASIZ      USED FOR SIZE OF VALUE            00060000
                    LCLA  &ZN         NUMERIC WORK VARIABLE             00060100
                    LCLC  &ZC         CHARACTER WORK VARIABLE           00060200
                    LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE       00060300
                    LCLA  &ZTLA       VALUE TOO LONG VARIABLE           00060400
                    LCLC  &ZMAC_G     "G" or null                       00060500
&ZMAC_G             SETC  ''                                            00060600
                    LCLC  &ZMAC_LR                                      00060700
&ZMAC_LR            SETC  'LR'                                          00060800
                    LCLC  &ZMAC_L                                       00060900
&ZMAC_L             SETC  'L'                                           00061000
                    LCLC  &ZMAC_ST                                      00061100
&ZMAC_ST            SETC  'ST'                                          00061200
                    LCLC  &ZMAC_LLGT                                    00061300
&ZMAC_LLGT          SETC  'L'                                           00061400
                    LCLC  &ZMAC_LGR                                     00061500
&ZMAC_LGR           SETC  'LR'                                          00061600
                    LCLC  &ZMAC_LG                                      00061700
&ZMAC_LG            SETC  'L'                                           00061800
                    LCLC  &ZMAC_STG                                     00061900
&ZMAC_STG           SETC  'ST'                                          00062000
                    LCLA  &ZMACRET    MACRO RETURN CODE                 00062100
&ZMACRET            SETA  0           ASSUME NO ERRORS                  00062200
.*                                                                      00062300
                    LCLC  &ZCSYSLIST(255)       NONXKEY, POS ARRAY      00062400
                    LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()        00062500
                    LCLA  &ZPLLEN     PARAMETER LIST LENGTH             00062600
                    LCLC  &ZENDBASEPL           End of base PL          00062700
                    LCLA  &ZPLWORKA   PARAMETER LIST LENGTH             00062800
.*******************************************************************    00062900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00063000
.*******************************************************************    00063100
                    LCLA  &ZI         INDEX FOR ARRAY                   00063200
                    LCLA  &ZJ         INDEX FOR PARMS                   00063300
                    LCLA  &ZK         INDEX FOR PARSE                   00063400
                    LCLA  &ZLO        LOW RANGE VALUE                   00063500
                    LCLA  &ZHI        HIGH RANGE VALUE                  00063600
                    LCLC  &ZW         WORK AREA FOR PARM                00063700
.********************************************************************   00063800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00063900
.********************************************************************   00064000
                    GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL           00064100
                    GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE    00064200
                    GBLA  &SYSALVL    SYSSTATE ARCHLVL                  00064300
                    GBLC  &SYSAM64    SYSSTATE AMODE64                  00064400
.*                                                                      00064500
                    AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED    00064600
                    AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED     00064700
                    SPLEVEL  TEST                                       00064800
.ZSYS2              ANOP  ,                                             00064900
                    AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1         00065000
                    AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1         00065100
                    SYSSTATE TEST                                       00065200
                    AGO   .ZSYS4                                        00065300
.ZSYS3              ANOP  ,                                             00065400
&SYSASCE            SETC  'P'         ASSUME SYSSTATE PRIMARY           00065500
.ZSYS4              ANOP  ,                                             00065600
                    AIF   ('&SYSAM64' NE 'YES').ZSYSN64                 00065700
&ZMAC_LLGT          SETC 'LLGT'                                         00065800
&ZMAC_LGR           SETC 'LGR'                                          00065900
&ZMAC_LG            SETC 'LG'                                           00066000
&ZMAC_STG           SETC 'STG'                                          00066100
.ZSYSN64            ANOP  ,                                             00066200
.*******************************************************************    00066300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00066400
.*******************************************************************    00066500
                    LCLC  &XMONTKN    ++ NAME                           00066600
                    LCLC  &XEND_FLOW  ++ VALUE                          00066700
                    LCLC  &XMSG_RECEIVED        ++ VALUE                00066800
                    LCLC  &XARRIVALTIME         ++ NAME                 00066900
                    LCLC  &XUSEDEWLMS           ++ NAME                 00067000
                    LCLC  &XEWLM_S_PACORR       ++ NAME                 00067100
                    LCLC  &XEWLM_S_CURCORR      ++ NAME                 00067200
                    LCLC  &XEWLM_RCVD_CORR      ++ NAME                 00067300
                    LCLC  &XRETCODE   ++ NAME                           00067400
                    LCLC  &XRSNCODE   ++ NAME                           00067500
                    LCLA  &XPLISTVER  ++ VALUE                          00067600
                    LCLC  &XMF        ++ VALUE                          00067700
                    LCLC  &XMFCTRL    ++ NAME                           00067800
                    LCLC  &XMFATTR    ++ VALUE                          00067900
                    LCLC  &XMFSCK     ++ VALUE                          00068000
.*******************************************************************    00068100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00068200
.*******************************************************************    00068300
                    LCLC  &ZXMONTKN   ++ INPUT NAME                     00068400
                    LCLC  &ZXEND_FLOW           ++ INPUT VALUE          00068500
                    LCLC  &ZXMSG_RECEIVED       ++ INPUT VALUE          00068600
                    LCLC  &ZXARRIVALTIME        ++ INPUT NAME           00068700
                    LCLC  &ZXUSEDEWLMS          ++ INPUT NAME           00068800
                    LCLC  &ZXEWLM_S_PACORR      ++ INPUT NAME           00068900
                    LCLC  &ZXEWLM_S_CURCORR     ++ INPUT NAME           00069000
                    LCLC  &ZXEWLM_RCVD_CORR     ++ INPUT NAME           00069100
                    LCLC  &ZXRETCODE  ++ OUTPUT NAME                    00069200
                    LCLC  &ZXRSNCODE  ++ OUTPUT NAME                    00069300
                    LCLC  &ZXPLISTVER           ++ INPUT VALUE          00069400
                    LCLC  &ZXMF       ++ INPUT VALUE                    00069500
                    LCLC  &ZXMFCTRL   ++ INPUT NAME                     00069600
                    LCLC  &ZXMFATTR   ++ INPUT VALUE                    00069700
                    LCLC  &ZXMFSCK    ++ INPUT VALUE                    00069800
.********************************************************************   00069900
.***AC.PLV01  PROCESS PLISTVER                                      *   00070000
.********************************************************************   00070100
&XPLISTVER      SETA  0                                                 00070200
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00070300
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00070400
&XPLISTVER      SETA  0                                                 00070500
.ZPLV0          ANOP  ,                                                 00070600
.*                                                                      00070700
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00070800
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00070900
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00071000
.*-------------------------------------------------------------------   00071100
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00071200
&ZMS            SETC  '"PLISTVER='                                      00071300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00071400
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00071500
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00071600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00071700
                AGO   .ZPVCK2                                           00071800
.ZPVCK3         ANOP  ,                                                 00071900
.*-------------------------------------------------------------------   00072000
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00072100
&ZMS            SETC  '"PLISTVER='                                      00072200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00072300
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00072400
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00072500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00072600
                AGO   .ZPVCKE                                           00072700
.ZPVCK2         ANOP  ,                                                 00072800
.*-------------------------------------------------------------------   00072900
&ZCVAL          SETC  '&PLISTVER(1)'                                    00073000
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00073100
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00073200
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00073300
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00073400
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00073500
.ZPVCK6         ANOP  ,                                                 00073600
&ZMS            SETC  '"PLISTVER='                                      00073700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00073800
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00073900
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00074000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00074100
&XPLISTVER      SETA  0                                                 00074200
                AGO   .ZPVCKE                                           00074300
.*-------------------------------------------------------------------   00074400
.ZPVCK4A        ANOP  ,                                                 00074500
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00074600
&ZMS            SETC  'PLISTVER='                                       00074700
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00074800
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00074900
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00075000
                MNOTE 8,' &ZMS IS REQUIRED.'                            00075100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00075200
                AGO   .ZPVCK5                                           00075300
.ZPVCK4         ANOP  ,                                                 00075400
&XPLISTVER      SETA  &PLISTVER(1)                                      00075500
.ZPVCK5         ANOP  ,                                                 00075600
.ZPVCKE         ANOP  ,                                                 00075700
.********************************************************************   00075800
.***AG.MF01 PROCESS MF MACRO FORMS                                      00075900
.********************************************************************   00076000
                    ACTR  10000                                         00076100
.*------------------------------------------------------------------    00076200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076300
&XMF                SETC  ''          INITIALIZE XVARIABLE              00076400
.*-------------------------------------------------------------------   00076500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00076600
.ZG35               ANOP  ,                                             00076700
&ZTLC               SETC 'S'                                            00076800
                    AIF   ('&MF(1)' NE '&ZTLC').ZG36                    00076900
&XMF                SETC  'S'         SET KEYWORD                       00077000
                    AIF   (N'&MF LE 1).ZG35A    CK NUM                  00077100
&ZMS                SETC  '"MF='                                        00077200
&ZMS                SETC  '&ZMS.&MF"'                                   00077300
&ZMS                SETC  '&ZMS "MF"'                                   00077400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00077500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00077600
.ZG35A              ANOP  ,                                             00077700
.*-------------------------------------------------------------------   00077800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00077900
.ZG36               ANOP  ,                                             00078000
&ZTLC               SETC 'L'                                            00078100
                    AIF   ('&MF(1)' NE '&ZTLC').ZG43                    00078200
&XMF                SETC  'L'         SET KEYWORD                       00078300
                    AIF   (N'&MF LE 3).ZG36A    CK NUM                  00078400
&ZMS                SETC  '"MF='                                        00078500
&ZMS                SETC  '&ZMS.&MF"'                                   00078600
&ZMS                SETC  '&ZMS "MF"'                                   00078700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00078800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00078900
.ZG36A              ANOP  ,                                             00079000
.*-------------------------------------------------------------------   00079100
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00079200
                    AIF   (N'&SYSLIST NE 0).ZG36B  POSITIONALS?         00079300
                    AIF   ('&MONTKN' NE '').ZG36B  KEYS?                00079400
                    AIF   ('&END_FLOW' NE '').ZG36B  KEYS?              00079500
                    AIF   ('&MSG_RECEIVED' NE '').ZG36B  KEYS?          00079600
                    AIF   ('&ARRIVALTIME' NE '').ZG36B  KEYS?           00079700
                    AIF   ('&EWLM_S_PACORR' NE '').ZG36B  KEYS?         00079800
                    AIF   ('&EWLM_S_CURCORR' NE '').ZG36B  KEYS?        00079900
                    AIF   ('&EWLM_RCVD_CORR' NE '').ZG36B  KEYS?        00080000
                    AIF   ('&RETCODE' NE '').ZG36B  KEYS?               00080100
                    AIF   ('&RSNCODE' NE '').ZG36B  KEYS?               00080200
                    AGO    .ZG36C     INVOCATION OKAY                   00080300
.ZG36B              ANOP  ,                                             00080400
&ZMS                SETC  'THE "L" FORM OF "MF"'                        00080500
&ZMS                SETC  '&ZMS CAN ONLY HAVE'                          00080600
&ZMS                SETC  '&ZMS THE "PLISTVER" KEY'                     00080700
                    MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'        00080800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00080900
.ZG36C              ANOP  ,                                             00081000
.*-------------------------------------------------------------------   00081100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00081200
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00081300
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00081400
                    AIF   (N'&MF(2) GT 1).ZG38B  MULTI PARMS            00081500
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00081600
.ZG38B              AIF   (K'&MF(2) GT 0).ZG38C                         00081700
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00081800
&ZMS                SETC  'WHEN "L" IS SPECIFIED'                       00081900
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00082000
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00082100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00082200
.ZG38C              ANOP  ,                                             00082300
.*-------------------------------------------------------------------   00082400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00082500
                    AIF   (K'&ZXMFCTRL LE 0).ZG38P  NOT I/O             00082600
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG38P                00082700
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00082800
&ZMS                SETC  '"MF='                                        00082900
&ZMS                SETC  '&ZMS.&MF"'                                   00083000
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00083100
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'             00083200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00083300
.ZG38P              ANOP  ,                                             00083400
.*-------------------------------------------------------------------   00083500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00083600
&ZXMFATTR           SETC  'INPUT'     SET IN/OUTPUT                     00083700
&XMFATTR            SETC  '0D'                                          00083800
                    AIF   (K'&MF(3) LE 0).ZG41B  PARM                   00083900
&XMFATTR            SETC  '&MF(3,1)'  SET XVARIABLE                     00084000
                    AIF   (N'&MF(3) GT 1).ZG41B  MULTI                  00084100
&XMFATTR            SETC  '&MF(3)'    SET XVARIABLE                     00084200
.ZG41B              ANOP  ,                                             00084300
.*-------------------------------------------------------------------   00084400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00084500
                    AIF   (K'&ZXMFATTR LE 0).ZG41P  NOT I/O             00084600
                    AIF   ('&XMFATTR'(1,1) NE '(').ZG41P                00084700
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00084800
&ZMS                SETC  '"MF='                                        00084900
&ZMS                SETC  '&ZMS.&MF"'                                   00085000
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00085100
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'             00085200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00085300
.ZG41P              ANOP  ,                                             00085400
.*-------------------------------------------------------------------   00085500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00085600
                    AIF   (K'&ZXMFATTR LE 0).ZG41S  NOT I/O             00085700
                    AIF   (K'&XMFATTR LE 60).ZG41S  LNG OK              00085800
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00085900
&ZMS                SETC  '"MF='                                        00086000
&ZMS                SETC  '&ZMS.&MF"'                                   00086100
&ZMS                SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'         00086200
                    MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'            00086300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00086400
.ZG41S              ANOP  ,                                             00086500
.*-------------------------------------------------------------------   00086600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00086700
.ZG43               ANOP  ,                                             00086800
&ZTLC               SETC 'E'                                            00086900
                    AIF   ('&MF(1)' NE '&ZTLC').ZG51                    00087000
&XMF                SETC  'E'         SET KEYWORD                       00087100
                    AIF   (N'&MF LE 3).ZG43A    CK NUM                  00087200
&ZMS                SETC  '"MF='                                        00087300
&ZMS                SETC  '&ZMS.&MF"'                                   00087400
&ZMS                SETC  '&ZMS "MF"'                                   00087500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00087600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00087700
.ZG43A              ANOP  ,                                             00087800
.*-------------------------------------------------------------------   00087900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00088000
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00088100
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00088200
                    AIF   (N'&MF(2) GT 1).ZG45B  MULTI PARMS            00088300
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00088400
.ZG45B              AIF   (K'&MF(2) GT 0).ZG45C                         00088500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00088600
&ZMS                SETC  'WHEN "E" IS SPECIFIED'                       00088700
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00088800
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00088900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00089000
.ZG45C              ANOP  ,                                             00089100
.*-------------------------------------------------------------------   00089200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00089300
                    AIF   (K'&ZXMFCTRL LE 0).ZG45R  NOT I/O             00089400
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG45R                00089500
&ZCGPR              SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                    00089600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG45P                  00089700
                    AIF   (K'&ZCGPR GT 2).ZG45Q                         00089800
                    AIF   ('&ZCGPR' EQ '0').ZG45Q                       00089900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00090000
                    AIF   (T'&ZCGPR NE 'N').ZG45Q  INVALID REG NAME     00090100
.ZG45P              ANOP  ,                                             00090200
                    AIF   (T'&ZCGPR NE 'N').ZG45R  NON NUMERIC          00090300
                    AIF   ('&ZCGPR' LT '1').ZG45Q                       00090400
                    AIF   ('&ZCGPR' LE '12').ZG45R                      00090500
.ZG45Q              ANOP  ,                                             00090600
&ZMS                SETC  '"MF='                                        00090700
&ZMS                SETC  '&ZMS.&MF"'                                   00090800
&ZMS                SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'     00090900
                    MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'              00091000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00091100
.ZG45R              ANOP  ,                                             00091200
.*-------------------------------------------------------------------   00091300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00091400
&XMFSCK             SETC  ''          INITIALIZE XVARIABLE              00091500
.ZG49A   AIF   ('&MF(3)' NE 'COMPLETE').ZG50A                           00091600
&XMFSCK             SETC  'COMPLETE'  SET KEYWORD                       00091700
.*-------------------------------------------------------------------   00091800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00091900
.ZG50A              AIF   (K'&XMFSCK GT 0).ZG50C  KEYWORD               00092000
                    AIF   (K'&MF(3) LE 0).ZG50B                         00092100
&ZMS                SETC  '"MF='                                        00092200
&ZMS                SETC  '&ZMS.&MF"'                                   00092300
&ZMS                SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '     00092400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00092500
&ZMS                SETC  '&ZMS "COMPLETE".'                            00092600
                    MNOTE 8,' &ZMS '                                    00092700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00092800
.ZG50B              ANOP  ,                                             00092900
&XMFSCK             SETC  'COMPLETE'  SET DEFAULT KEYWORD               00093000
.ZG50C              ANOP  ,                                             00093100
&ZXMFSCK            SETC  'INPUT'     SET IN/OUTPUT                     00093200
.*------------------------------------------------------------------    00093300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093400
.ZG51               ANOP  ,                                             00093500
&ZXMF               SETC  'INPUT'     SET IN/OUTPUT                     00093600
                    AIF   (K'&XMF GT 0).ZG51E   VALID ARG               00093700
                    AIF   (T'&MF EQ 'O').ZG51D  OMITTED                 00093800
&ZASYSLNDX          SETA  0                                             00093900
.ZG51A              ANOP  ,           POSITIONAL MACRO KEY              00094000
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00094100
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG51C              00094200
&ZTLC               SETC 'MF'                                           00094300
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG51A     00094400
.ZG51B              ANOP  ,                                             00094500
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00094600
&ZMS                SETC  'THE "MF" KEY'                                00094700
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00094800
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00094900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00095000
                    AGO   .ZG51E                                        00095100
.ZG51C              ANOP  ,                                             00095200
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00095300
&ZMS                SETC  '"MF='                                        00095400
&ZMS                SETC  '&ZMS.&MF"'                                   00095500
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00095600
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00095700
&ZMS                SETC  '&ZMS "S",'                                   00095800
&ZMS                SETC  '&ZMS "L",'                                   00095900
&ZMS                SETC  '&ZMS OR "E".'                                00096000
                    MNOTE 8,' &ZMS '                                    00096100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00096200
                    AGO   .ZG51E                                        00096300
.ZG51D              ANOP  ,                                             00096400
&XMF                SETC  'S'         SET DEFAULT KEYWORD               00096500
&XMFSCK             SETC  'COMPLETE'  COMPLETE CHECKING                 00096600
.ZG51E              ANOP  ,                                             00096700
.********************************************************************   00096800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00096900
.********************************************************************   00097000
                    ACTR  10000                                         00097100
.*-------------------------------------------------------------------   00097200
.***AG.MF03 MF=(SLE)                                                    00097300
                    AIF   ('&XMF' EQ 'L').ZGMFX                         00097400
.*----------------------------------------------------------------***   00097500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00097600
                    AIF   (N'&MONTKN LE 1).ZG2A  CK NUM                 00097700
&ZMS                SETC  '"MONTKN='                                    00097800
&ZMS                SETC  '&ZMS.&MONTKN"'                               00097900
&ZMS                SETC  '&ZMS "MONTKN"'                               00098000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00098100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00098200
.ZG2A               ANOP  ,                                             00098300
.*-------------------------------------------------------------------   00098400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00098500
&ZXMONTKN           SETC  'INPUT'     SET IN/OUTPUT                     00098600
&XMONTKN            SETC  '&MONTKN(1)'          SET XVARIABLE           00098700
                    AIF   (N'&MONTKN GT 1).ZG2B  MULTI PARMS            00098800
&XMONTKN            SETC  '&MONTKN'   SET XVARIABLE                     00098900
.ZG2B               AIF   (K'&MONTKN(1) GT 0).ZG2C                      00099000
&ZXMONTKN           SETC  ''          RESET IN/OUTPUT                   00099100
&ZMS                SETC  ' '                                           00099200
&ZMS                SETC  '&ZMS "MONTKN" KEY AND ITS'                   00099300
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00099400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00099500
.ZG2C               ANOP  ,                                             00099600
.*-------------------------------------------------------------------   00099700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00099800
                    AIF   (K'&ZXMONTKN LE 0).ZG2R  NOT I/O              00099900
                    AIF   ('&XMONTKN'(1,1) NE '(').ZG2R                 00100000
&ZCGPR              SETC  '&XMONTKN'(2,K'&XMONTKN-2)                    00100100
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                   00100200
                    AIF   (K'&ZCGPR GT 2).ZG2Q                          00100300
                    AIF   ('&ZCGPR' EQ '0').ZG2Q                        00100400
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00100500
                    AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME      00100600
.ZG2P               ANOP  ,                                             00100700
                    AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC           00100800
                    AIF   ('&ZCGPR' LT '2').ZG2Q                        00100900
                    AIF   ('&ZCGPR' LE '12').ZG2R                       00101000
.ZG2Q               ANOP  ,                                             00101100
&ZMS                SETC  '"MONTKN='                                    00101200
&ZMS                SETC  '&ZMS.&MONTKN"'                               00101300
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00101400
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00101500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00101600
.ZG2R               ANOP  ,                                             00101700
.*----------------------------------------------------------------***   00101800
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00101900
                    AIF   (N'&END_FLOW LE 1).ZG5A  CK NUM               00102000
&ZMS                SETC  '"END_FLOW='                                  00102100
&ZMS                SETC  '&ZMS.&END_FLOW"'                             00102200
&ZMS                SETC  '&ZMS "END_FLOW"'                             00102300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00102400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00102500
.ZG5A               ANOP  ,                                             00102600
.*-------------------------------------------------------------------   00102700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00102800
&XEND_FLOW          SETC  ''          INITIALIZE XVARIABLE              00102900
.ZG6A   AIF   ('&END_FLOW(1)' NE 'NO').ZG7A                             00103000
&XEND_FLOW          SETC  'NO'        SET KEYWORD                       00103100
.*-------------------------------------------------------------------   00103200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00103300
.ZG7A   AIF   ('&END_FLOW(1)' NE 'YES').ZG8A                            00103400
&XEND_FLOW          SETC  'YES'       SET KEYWORD                       00103500
.*-------------------------------------------------------------------   00103600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00103700
.ZG8A               AIF   (K'&XEND_FLOW GT 0).ZG8C  KEYWORD             00103800
                    AIF   (K'&END_FLOW(1) LE 0).ZG8B                    00103900
&ZMS                SETC  '"END_FLOW='                                  00104000
&ZMS                SETC  '&ZMS.&END_FLOW"'                             00104100
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00104200
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00104300
&ZMS                SETC  '&ZMS "NO"'                                   00104400
&ZMS                SETC  '&ZMS OR "YES".'                              00104500
                    MNOTE 8,' &ZMS '                                    00104600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00104700
.ZG8B               ANOP  ,                                             00104800
&XEND_FLOW          SETC  'NO'        SET DEFAULT KEYWORD               00104900
.ZG8C               ANOP  ,                                             00105000
&ZXEND_FLOW         SETC  'INPUT'     SET IN/OUTPUT                     00105100
.*----------------------------------------------------------------***   00105200
.***AG.KKWRD01 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00105300
                    AIF   (N'&MSG_RECEIVED LE 1).ZG10A  CK NUM          00105400
&ZMS                SETC  '"MSG_RECEIVED='                              00105500
&ZMS                SETC  '&ZMS.&MSG_RECEIVED"'                         00105600
&ZMS                SETC  '&ZMS "MSG_RECEIVED"'                         00105700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00105800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00105900
.ZG10A              ANOP  ,                                             00106000
.*-------------------------------------------------------------------   00106100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00106200
&XMSG_RECEIVED      SETC  ''          INITIALIZE XVARIABLE              00106300
.ZG11A   AIF   ('&MSG_RECEIVED(1)' NE 'NO').ZG12A                       00106400
&XMSG_RECEIVED      SETC  'NO'        SET KEYWORD                       00106500
.*-------------------------------------------------------------------   00106600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00106700
.ZG12A   AIF   ('&MSG_RECEIVED(1)' NE 'YES').ZG13A                      00106800
&XMSG_RECEIVED      SETC  'YES'       SET KEYWORD                       00106900
.*-------------------------------------------------------------------   00107000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00107100
.ZG13A              AIF   (K'&XMSG_RECEIVED GT 0).ZG13C  KEYWORD        00107200
                    AIF   (K'&MSG_RECEIVED(1) LE 0).ZG13B               00107300
&ZMS                SETC  '"MSG_RECEIVED='                              00107400
&ZMS                SETC  '&ZMS.&MSG_RECEIVED"'                         00107500
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00107600
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00107700
&ZMS                SETC  '&ZMS "NO"'                                   00107800
&ZMS                SETC  '&ZMS OR "YES".'                              00107900
                    MNOTE 8,' &ZMS '                                    00108000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00108100
.ZG13B              ANOP  ,                                             00108200
&XMSG_RECEIVED      SETC  'NO'        SET DEFAULT KEYWORD               00108300
.ZG13C              ANOP  ,                                             00108400
&ZXMSG_RECEIVED     SETC  'INPUT'     SET IN/OUTPUT                     00108500
.*----------------------------------------------------------------***   00108600
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00108700
                    AIF   (N'&ARRIVALTIME LE 1).ZG15A  CK NUM           00108800
&ZMS                SETC  '"ARRIVALTIME='                               00108900
&ZMS                SETC  '&ZMS.&ARRIVALTIME"'                          00109000
&ZMS                SETC  '&ZMS "ARRIVALTIME"'                          00109100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00109200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00109300
.ZG15A              ANOP  ,                                             00109400
.*-------------------------------------------------------------------   00109500
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00109600
&ZXARRIVALTIME      SETC  'INPUT'     SET IN/OUTPUT                     00109700
&XARRIVALTIME       SETC  'NO_ARRIVALTIME'                              00109800
                    AIF   (K'&ARRIVALTIME(1) LE 0).ZG15B  PARM          00109900
&XARRIVALTIME       SETC  '&ARRIVALTIME(1)'     SET XVARIABLE           00110000
                    AIF   (N'&ARRIVALTIME GT 1).ZG15B  MULTI            00110100
&XARRIVALTIME       SETC  '&ARRIVALTIME'        SET XVARIABLE           00110200
.ZG15B              ANOP  ,                                             00110300
.*-------------------------------------------------------------------   00110400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00110500
                    AIF   (K'&ZXARRIVALTIME LE 0).ZG15R  NOT I/O        00110600
         AIF   ('&XARRIVALTIME' EQ 'NO_ARRIVALTIME').ZG15R              00110700
                    AIF   ('&XARRIVALTIME'(1,1) NE '(').ZG15R           00110800
&ZCGPR              SETC  '&XARRIVALTIME'(2,K'&XARRIVALTIME-2)          00110900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                  00111000
                    AIF   (K'&ZCGPR GT 2).ZG15Q                         00111100
                    AIF   ('&ZCGPR' EQ '0').ZG15Q                       00111200
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00111300
                    AIF   (T'&ZCGPR NE 'N').ZG15Q  INVALID REG NAME     00111400
.ZG15P              ANOP  ,                                             00111500
                    AIF   (T'&ZCGPR NE 'N').ZG15R  NON NUMERIC          00111600
                    AIF   ('&ZCGPR' LT '2').ZG15Q                       00111700
                    AIF   ('&ZCGPR' LE '12').ZG15R                      00111800
.ZG15Q              ANOP  ,                                             00111900
&ZMS                SETC  '"ARRIVALTIME='                               00112000
&ZMS                SETC  '&ZMS.&ARRIVALTIME"'                          00112100
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00112200
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00112300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00112400
.ZG15R              ANOP  ,                                             00112500
.*----------------------------------------------------------------***   00112600
.***AG.KMEKY01 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00112700
&XUSEDEWLMS         SETC  ''          INITIALIZE XVARIABLE              00112800
                    AIF   (K'&EWLM_S_PACORR LE 0).ZG18C                 00112900
&ZXUSEDEWLMS        SETC  'INPUT'     SET IN/OUTPUT                     00113000
&XUSEDEWLMS         SETC  'EWLM_S_PACORR'       SET XVARIABLE           00113100
&ZXEWLM_S_PACORR    SETC  'INPUT'     SET IN/OUTPUT                     00113200
&XEWLM_S_PACORR     SETC  '&EWLM_S_PACORR(1)'   SET XVARIABLE PARM      00113300
                    AIF   (N'&EWLM_S_PACORR GT 1).ZG18A                 00113400
&XEWLM_S_PACORR     SETC  '&EWLM_S_PACORR'      SET XVARIABLE PARM      00113500
.ZG18A              AIF   (N'&EWLM_S_PACORR LE 1).ZG18B  CK NUM         00113600
&ZMS                SETC  '"EWLM_S_PACORR='                             00113700
&ZMS                SETC  '&ZMS.&EWLM_S_PACORR"'                        00113800
&ZMS                SETC  '&ZMS "EWLM_S_PACORR"'                        00113900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00114000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00114100
.ZG18B              AIF   (K'&XEWLM_S_PACORR GT 0).ZG18C  ONE PARM      00114200
&ZXUSEDEWLMS        SETC  ''          RESET IN/OUTPUT                   00114300
&ZXEWLM_S_PACORR    SETC  ''          RESET IN/OUTPUT                   00114400
&ZMS                SETC  ' '                                           00114500
&ZMS                SETC  '&ZMS "EWLM_S_PACORR" KEY AND ITS'            00114600
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00114700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00114800
.ZG18C              ANOP  ,                                             00114900
.*----------------------------------------------------------------***   00115000
.***AG.KMEKY02 NAME, RQD INPUT, ME KEYS -XVARIABLE                      00115100
                    AIF   (K'&EWLM_S_CURCORR LE 0).ZG19D  NO ME KEY     00115200
                    AIF   (N'&EWLM_S_CURCORR LE 1).ZG19A  CK NUM        00115300
&ZMS                SETC  '"EWLM_S_CURCORR='                            00115400
&ZMS                SETC  '&ZMS.&EWLM_S_CURCORR"'                       00115500
&ZMS                SETC  '&ZMS "EWLM_S_CURCORR"'                       00115600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00115700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00115800
.ZG19A              AIF   (K'&XUSEDEWLMS LE 0).ZG19B                    00115900
&ZMS                SETC  '"EWLM_S_CURCORR'                             00116000
&ZMS                SETC  '&ZMS.=&EWLM_S_CURCORR"'                      00116100
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00116200
&ZMS                SETC  '&ZMS "&XUSEDEWLMS"'                          00116300
                    MNOTE 8,' &ZMS KEY.'                                00116400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00116500
                    AGO   .ZG19D                                        00116600
.*                                                                      00116700
.ZG19B              ANOP  ,                                             00116800
&ZXUSEDEWLMS        SETC  'INPUT'     SET IN/OUTPUT                     00116900
&XUSEDEWLMS         SETC  'EWLM_S_CURCORR'      SET XVARIABLE           00117000
&ZXEWLM_S_CURCORR   SETC  'INPUT'     SET IN/OUTPUT                     00117100
&XEWLM_S_CURCORR    SETC  '&EWLM_S_CURCORR(1)'  SET XVARIABLE PARM      00117200
                    AIF   (N'&EWLM_S_CURCORR GT 1).ZG19C                00117300
&XEWLM_S_CURCORR    SETC  '&EWLM_S_CURCORR'     SET XVARIABLE PARM      00117400
.ZG19C              AIF   (K'&XEWLM_S_CURCORR GT 0).ZG19D  ONE PARM     00117500
&ZXUSEDEWLMS        SETC  ''          RESET IN/OUTPUT                   00117600
&ZXEWLM_S_CURCORR   SETC  ''          RESET IN/OUTPUT                   00117700
&ZMS                SETC  ' '                                           00117800
&ZMS                SETC  '&ZMS "EWLM_S_CURCORR" KEY AND ITS'           00117900
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00118000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00118100
.ZG19D              ANOP  ,                                             00118200
.*------------------------------------------------------------------    00118300
.***AG.KME4Y09 NAME, RQD INPUT, ME KEYS -CHECK IF KEY ENTERED           00118400
                    AIF   (K'&XUSEDEWLMS GT 0).ZG23B                    00118500
&ZXUSEDEWLMS        SETC  ''          RESET IN/OUTPUT                   00118600
&ZXEWLM_S_PACORR    SETC  ''          RESET IN/OUTPUT                   00118700
&XUSEDEWLMS         SETC  ''          ENSURE NULL                       00118800
&XEWLM_S_PACORR     SETC  ''          ENSURE NULL                       00118900
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00119000
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00119100
&ZMS                SETC  '&ZMS REQUIRED:'                              00119200
&ZMS                SETC  '&ZMS "EWLM_S_PACORR"'  VALID ME KEY          00119300
&ZMS                SETC  '&ZMS OR "EWLM_S_CURCORR".'  VALID ME KEY     00119400
                    MNOTE 8,' &ZMS '                                    00119500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00119600
.ZG23B              ANOP  ,                                             00119700
.*-------------------------------------------------------------------   00119800
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00119900
.ZG18ZY  AIF    ('&XUSEDEWLMS' NE 'EWLM_S_PACORR').ZG19ZY               00120000
.*-------------------------------------------------------------------   00120100
.***AG.KMEKY14 NAME, RQD INPUT, ME KEYS -DISALLOWED KEYS                00120200
&ZCVAL              SETC ''           ERROR KEY FIELD                   00120300
.ZG18I0             AIF   (K'&EWLM_RCVD_CORR LE 0).ZG18I1               00120400
&ZCVAL              SETC '&ZCVAL EWLM_RCVD_CORR'  DISALLOWED KEY        00120500
.ZG18I1             AIF   (K'&ZCVAL LE 0).ZG18J  KEY                    00120600
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00120700
&ZMS                SETC  '"EWLM_S_PACORR'                              00120800
&ZMS                SETC  '&ZMS.=&EWLM_S_PACORR"'                       00120900
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00121000
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00121100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00121200
.ZG18J              ANOP  ,                                             00121300
.*-------------------------------------------------------------------   00121400
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00121500
                    AIF   (K'&ZXEWLM_S_PACORR LE 0).ZG18R  NOT I/O      00121600
                    AIF   ('&XEWLM_S_PACORR'(1,1) NE '(').ZG18R         00121700
&ZCGPR              SETC  '&XEWLM_S_PACORR'(2,K'&XEWLM_S_PACORR-2)      00121800
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                  00121900
                    AIF   (K'&ZCGPR GT 2).ZG18Q                         00122000
                    AIF   ('&ZCGPR' EQ '0').ZG18Q                       00122100
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00122200
                    AIF   (T'&ZCGPR NE 'N').ZG18Q  INVALID REG NAME     00122300
.ZG18P              ANOP  ,                                             00122400
                    AIF   (T'&ZCGPR NE 'N').ZG18R  NON NUMERIC          00122500
                    AIF   ('&ZCGPR' LT '2').ZG18Q                       00122600
                    AIF   ('&ZCGPR' LE '12').ZG18R                      00122700
.ZG18Q              ANOP  ,                                             00122800
&ZMS                SETC  '"EWLM_S_PACORR='                             00122900
&ZMS                SETC  '&ZMS.&EWLM_S_PACORR"'                        00123000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00123100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00123200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00123300
.ZG18R              ANOP  ,                                             00123400
.*-------------------------------------------------------------------   00123500
.***AG.KMEKY13 NAME, RQD INPUT, ME KEYS -PROCESS DEPENDENCIES           00123600
.ZG19ZY  AIF    ('&XUSEDEWLMS' NE 'EWLM_S_CURCORR').ZG23ZY              00123700
.*-------------------------------------------------------------------   00123800
.***AG.KCK02 NAME, RQD INPUT, ME KEYS -GPR OUT OF RANGE                 00123900
                    AIF   (K'&ZXEWLM_S_CURCORR LE 0).ZG19R  NOT I/O     00124000
                    AIF   ('&XEWLM_S_CURCORR'(1,1) NE '(').ZG19R        00124100
&ZCGPR              SETC  '&XEWLM_S_CURCORR'(2,K'&XEWLM_S_CURCORR-2)    00124200
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                  00124300
                    AIF   (K'&ZCGPR GT 2).ZG19Q                         00124400
                    AIF   ('&ZCGPR' EQ '0').ZG19Q                       00124500
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00124600
                    AIF   (T'&ZCGPR NE 'N').ZG19Q  INVALID REG NAME     00124700
.ZG19P              ANOP  ,                                             00124800
                    AIF   (T'&ZCGPR NE 'N').ZG19R  NON NUMERIC          00124900
                    AIF   ('&ZCGPR' LT '2').ZG19Q                       00125000
                    AIF   ('&ZCGPR' LE '12').ZG19R                      00125100
.ZG19Q              ANOP  ,                                             00125200
&ZMS                SETC  '"EWLM_S_CURCORR='                            00125300
&ZMS                SETC  '&ZMS.&EWLM_S_CURCORR"'                       00125400
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00125500
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00125600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00125700
.ZG19R              ANOP  ,                                             00125800
.*----------------------------------------------------------------***   00125900
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00126000
                    AIF   (N'&EWLM_RCVD_CORR LE 1).ZG21A  CK NUM        00126100
&ZMS                SETC  '"EWLM_RCVD_CORR='                            00126200
&ZMS                SETC  '&ZMS.&EWLM_RCVD_CORR"'                       00126300
&ZMS                SETC  '&ZMS "EWLM_RCVD_CORR"'                       00126400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00126500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00126600
.ZG21A              ANOP  ,                                             00126700
.*-------------------------------------------------------------------   00126800
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00126900
&ZXEWLM_RCVD_CORR   SETC  'INPUT'     SET IN/OUTPUT                     00127000
&XEWLM_RCVD_CORR    SETC  'NO_EWLM_RCVD_CORR'                           00127100
                    AIF   (K'&EWLM_RCVD_CORR(1) LE 0).ZG21B  PARM       00127200
&XEWLM_RCVD_CORR    SETC  '&EWLM_RCVD_CORR(1)'  SET XVARIABLE           00127300
                    AIF   (N'&EWLM_RCVD_CORR GT 1).ZG21B  MULTI         00127400
&XEWLM_RCVD_CORR    SETC  '&EWLM_RCVD_CORR'     SET XVARIABLE           00127500
.ZG21B              ANOP  ,                                             00127600
.*-------------------------------------------------------------------   00127700
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00127800
                    AIF   (K'&ZXEWLM_RCVD_CORR LE 0).ZG21R  NOT I/O     00127900
         AIF   ('&XEWLM_RCVD_CORR' EQ 'NO_EWLM_RCVD_CORR').ZG21R        00128000
                    AIF   ('&XEWLM_RCVD_CORR'(1,1) NE '(').ZG21R        00128100
&ZCGPR              SETC  '&XEWLM_RCVD_CORR'(2,K'&XEWLM_RCVD_CORR-2)    00128200
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                  00128300
                    AIF   (K'&ZCGPR GT 2).ZG21Q                         00128400
                    AIF   ('&ZCGPR' EQ '0').ZG21Q                       00128500
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00128600
                    AIF   (T'&ZCGPR NE 'N').ZG21Q  INVALID REG NAME     00128700
.ZG21P              ANOP  ,                                             00128800
                    AIF   (T'&ZCGPR NE 'N').ZG21R  NON NUMERIC          00128900
                    AIF   ('&ZCGPR' LT '2').ZG21Q                       00129000
                    AIF   ('&ZCGPR' LE '12').ZG21R                      00129100
.ZG21Q              ANOP  ,                                             00129200
&ZMS                SETC  '"EWLM_RCVD_CORR='                            00129300
&ZMS                SETC  '&ZMS.&EWLM_RCVD_CORR"'                       00129400
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00129500
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00129600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00129700
.ZG21R              ANOP  ,                                             00129800
.*-------------------------------------------------------------------   00129900
.***AG.KMEKY15 NAME, RQD INPUT, ME KEYS -END                            00130000
.ZG23ZY             ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00130100
.*----------------------------------------------------------------***   00130200
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00130300
                    AIF   (N'&RETCODE LE 1).ZG25A  CK NUM               00130400
&ZMS                SETC  '"RETCODE='                                   00130500
&ZMS                SETC  '&ZMS.&RETCODE"'                              00130600
&ZMS                SETC  '&ZMS "RETCODE"'                              00130700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00130800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00130900
.ZG25A              ANOP  ,                                             00131000
.*-------------------------------------------------------------------   00131100
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00131200
                    AIF   (K'&RETCODE(1) LE 0).ZG25C  NO PARM           00131300
&ZXRETCODE          SETC  'OUTPUT'    SET OUTPUT                        00131400
&XRETCODE           SETC  '&RETCODE(1)'         SET XVARIABLE           00131500
                    AIF   (N'&RETCODE GT 1).ZG25C                       00131600
&XRETCODE           SETC  '&RETCODE'  SET XVARIABLE                     00131700
.ZG25C              ANOP  ,                                             00131800
.*-------------------------------------------------------------------   00131900
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00132000
                    AIF   (K'&ZXRETCODE LE 0).ZG25R  NOT I/O            00132100
                    AIF   ('&XRETCODE'(1,1) NE '(').ZG25R               00132200
&ZCGPR              SETC  '&XRETCODE'(2,K'&XRETCODE-2)                  00132300
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                  00132400
                    AIF   (K'&ZCGPR GT 2).ZG25Q                         00132500
                    AIF   ('&ZCGPR' EQ '0').ZG25Q                       00132600
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00132700
                    AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME     00132800
.ZG25P              ANOP  ,                                             00132900
                    AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC          00133000
                    AIF   ('&ZCGPR' EQ '15').ZG25R                      00133100
                    AIF   ('&ZCGPR' LT '2').ZG25Q                       00133200
                    AIF   ('&ZCGPR' LE '12').ZG25R                      00133300
.ZG25Q              ANOP  ,                                             00133400
&ZMS                SETC  '"RETCODE='                                   00133500
&ZMS                SETC  '&ZMS.&RETCODE"'                              00133600
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00133700
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'      00133800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00133900
.ZG25R              ANOP  ,                                             00134000
.*----------------------------------------------------------------***   00134100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00134200
                    AIF   (N'&RSNCODE LE 1).ZG28A  CK NUM               00134300
&ZMS                SETC  '"RSNCODE='                                   00134400
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00134500
&ZMS                SETC  '&ZMS "RSNCODE"'                              00134600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00134700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00134800
.ZG28A              ANOP  ,                                             00134900
.*-------------------------------------------------------------------   00135000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00135100
                    AIF   (K'&RSNCODE(1) LE 0).ZG28C  NO PARM           00135200
&ZXRSNCODE          SETC  'OUTPUT'    SET OUTPUT                        00135300
&XRSNCODE           SETC  '&RSNCODE(1)'         SET XVARIABLE           00135400
                    AIF   (N'&RSNCODE GT 1).ZG28C                       00135500
&XRSNCODE           SETC  '&RSNCODE'  SET XVARIABLE                     00135600
.ZG28C              ANOP  ,                                             00135700
.*-------------------------------------------------------------------   00135800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00135900
                    AIF   (K'&ZXRSNCODE LE 0).ZG28R  NOT I/O            00136000
                    AIF   ('&XRSNCODE'(1,1) NE '(').ZG28R               00136100
&ZCGPR              SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                  00136200
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                  00136300
                    AIF   (K'&ZCGPR GT 2).ZG28Q                         00136400
                    AIF   ('&ZCGPR' EQ '0').ZG28R                       00136500
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00136600
                    AIF   (T'&ZCGPR NE 'N').ZG28Q  INVALID REG NAME     00136700
.ZG28P              ANOP  ,                                             00136800
                    AIF   (T'&ZCGPR NE 'N').ZG28R  NON NUMERIC          00136900
                    AIF   ('&ZCGPR' EQ '0').ZG28R                       00137000
                    AIF   ('&ZCGPR' LT '2').ZG28Q                       00137100
                    AIF   ('&ZCGPR' LE '12').ZG28R                      00137200
.ZG28Q              ANOP  ,                                             00137300
&ZMS                SETC  '"RSNCODE='                                   00137400
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00137500
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00137600
                    MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'       00137700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00137800
.ZG28R              ANOP  ,                                             00137900
.******************************************************************     00138000
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00138100
.******************************************************************     00138200
                    ACTR  10000                                         00138300
.*----------------------------------------------------------------***   00138400
.***AH.P02 EXTRA POSITIONALS                                            00138500
                    AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS          00138600
                    AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL          00138700
                    AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL      00138800
                    AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL       00138900
.ZGLISTX1           ANOP  ,                                             00139000
&ZCVAL              SETC  ''          ERROR FIELD                       00139100
&ZAWRK              SETA  0           POSITIONAL NUMBER                 00139200
.ZGLIST2            ANOP  ,                                             00139300
&ZAWRK              SETA  &ZAWRK+1    NEXT POSITIONAL                   00139400
                    AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE          00139500
&ZCVAL              SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA               00139600
                    AGO   .ZGLIST2                                      00139700
.*                                                                      00139800
.ZGLIST3            ANOP  ,                                             00139900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA            00140000
&ZMS                SETC  'POSITIONAL ARGUMENT(S),'                     00140100
&ZMS                SETC  '&ZMS "&ZCVAL"'                               00140200
&ZMS                SETC  '&ZMS CANNOT BE USED.'                        00140300
&ZMS                SETC  '&ZMS NO POSITIONAL ARGUMENTS'                00140400
                    MNOTE 8,' &ZMS ARE ALLOWED.'                        00140500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00140600
.ZGLISTX            ANOP  ,                                             00140700
&ZASYSLNDX          SETA  0                                             00140800
.*-------------------------------------------------------------------   00140900
.***AG.MF04 MF=(SLE)                                                    00141000
.ZGMFX              ANOP  ,           END OF FULL SYNTAX CHECK          00141100
.*******************************************************************    00141200
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00141300
.*******************************************************************    00141400
                    AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED          00141500
.*******************************************************************    00141600
.***AE.01  START OF IWMMSTRT MACRO CODE                                 00141700
.*******************************************************************    00141800
                    LCLC  &M0M0001                 NAME                 00141900
&M0M0001            SETC  '&XLABEL'                SET NAME             00142000
                    AIF   (K'&XLABEL NE 0).XLAB2                        00142100
&M0M0001            SETC  'M00M&SYSNDX'            DEFAULT NAME         00142200
.*                                                                      00142300
.XLAB2              ANOP  ,                                             00142400
                    AIF   ('&XMF' EQ 'L').XLAB3                         00142500
&M0M0001 DS    0H                             IWMMSTRT-0                00142600
.XLAB3              ANOP  ,                                             00142700
.*******************************************************************    00142800
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00142900
.*******************************************************************    00143000
              PUSH  PRINT                                               00143100
                    AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON    00143200
                    PRINT OFF         ++ PR01                           00143300
                    AGO   .ZPRNTXX                                      00143400
.ZPRINTX            PRINT ON                                            00143500
.ZPRNTXX            ANOP  ,                                             00143600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00143700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00143800
.********************************************************************   00143900
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00144000
.********************************************************************   00144100
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00144200
                      LCLA  &ZOPN1         INVOCATION INDEX             00144300
                      LCLC  &ZOPL(4095)    LABEL                        00144400
                      LCLC  &ZOPO(4095)    OPERATION                    00144500
                      LCLC  &ZOPV(4095)    VALUE                        00144600
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00144700
.*                                                                      00144800
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00144900
.******************************************************************     00145000
.***AL.L10 IWMMSTRT FMT=LIST MF=S!L PARAMETERS                          00145100
.******************************************************************     00145200
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00145300
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00145400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00145500
&XMFATTR              SETC  '0D'                                        00145600
.*                                                                      00145700
&ZOPN                 SETA  &ZOPN+1                                     00145800
&ZOPL(&ZOPN)          SETC  ' '                                         00145900
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00146000
&ZOPO(&ZOPN)          SETC  'B'                                         00146100
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00146200
                      AGO   .ZALVL6B                                    00146300
.ZALVL6A              ANOP                                              00146400
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00146500
&ZOPV(&ZOPN)          SETC  '4,8'                                       00146600
&ZOPN                 SETA  &ZOPN+1                                     00146700
&ZOPL(&ZOPN)          SETC  ' '                                         00146800
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00146900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00147000
.ZALVL6B              ANOP                                              00147100
&ZOPD(&ZOPN)          SETC  '++ IWMMSTRT ARG PARMS'                     00147200
.*                                                                      00147300
&ZOPN                 SETA  &ZOPN+1                                     00147400
&ZOPL(&ZOPN)          SETC  ' '                                         00147500
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00147600
&ZOPV(&ZOPN)          SETC  '1'                                         00147700
&ZOPD(&ZOPN)          SETC  ' '                                         00147800
.*                                                                      00147900
.ZLMFSL2              ANOP  ,                                           00148000
.*-------------------------------------------------------------------   00148100
.***AM.L00  IWMMSTRT FMT=LIST name                                      00148200
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00148300
&ZOPN                 SETA &ZOPN+1                                      00148400
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00148500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00148600
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00148700
&ZOPD(&ZOPN)          SETC '++ IWMMSTRT NAME'                           00148800
.ZLMFSL2M             ANOP  ,                                           00148900
.*-------------------------------------------------------------------   00149000
.***AM.L01  IWMMSTRT FMT=LIST PARAMETERS                                00149100
&ZOPN                 SETA &ZOPN+1                                      00149200
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00149300
&ZOPO(&ZOPN)          SETC 'DS'                                         00149400
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00149500
&ZOPD(&ZOPN)          SETC '++ IWMMSTRT PARM LIST'                      00149600
.*-------------------------------------------------------------------   00149700
.***AM.L02 XVERSION XL1                                                 00149800
&ZOPN                 SETA &ZOPN+1                                      00149900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00150000
&ZOPO(&ZOPN)          SETC 'DS'                                         00150100
&ZOPV(&ZOPN)          SETC 'XL1'                                        00150200
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00150300
.*-------------------------------------------------------------------   00150400
.***AM.L03 XMSTRT_OPTIONS BL.16                                         00150500
&ZOPN                 SETA &ZOPN+1                                      00150600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMSTRT_OPTIONS'                   00150700
&ZOPO(&ZOPN)          SETC 'DS'                                         00150800
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00150900
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00151000
.*                                                                      00151100
&ZOPN                 SETA  &ZOPN+1                                     00151200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XEND_FLOW_YES'                   00151300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00151400
&ZOPV(&ZOPN)          SETC  'B''1000000000000000'''                     00151500
&ZOPD(&ZOPN)          SETC  '++ XEND_FLOW.'                             00151600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00151700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00151800
.*                                                                      00151900
&ZOPN                 SETA  &ZOPN+1                                     00152000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMSG_RECEIVED_YES'               00152100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00152200
&ZOPV(&ZOPN)          SETC  'B''0100000000000000'''                     00152300
&ZOPD(&ZOPN)          SETC  '++ XMSG_RECEIVED.'                         00152400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00152500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00152600
.*-------------------------------------------------------------------   00152700
.***AM.L09  XRSV0003 CL1                                                00152800
&ZOPN                 SETA &ZOPN+1                                      00152900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00153000
&ZOPO(&ZOPN)          SETC 'DS'                                         00153100
&ZOPV(&ZOPN)          SETC 'CL1'                                        00153200
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00153300
.*-------------------------------------------------------------------   00153400
.***AM.L09  XMONTKN BL.32                                               00153500
&ZOPN                 SETA &ZOPN+1                                      00153600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00153700
&ZOPO(&ZOPN)          SETC 'DS'                                         00153800
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00153900
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN '                              00154000
.*-------------------------------------------------------------------   00154100
.***AM.L09 ADDR XEWLM_S_PACORR A                                        00154200
&ZOPN                 SETA &ZOPN+1                                      00154300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEWLM_S_PACORR_ADDR'              00154400
&ZOPO(&ZOPN)          SETC 'DS'                                         00154500
&ZOPV(&ZOPN)          SETC 'A'                                          00154600
&ZOPD(&ZOPN)          SETC '++ &ZXEWLM_S_PACORR ADDR'                   00154700
.*-------------------------------------------------------------------   00154800
.***AM.L09 ADDR XEWLM_S_CURCORR A                                       00154900
&ZOPN                 SETA &ZOPN+1                                      00155000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEWLM_S_CURCORR_ADDR'             00155100
&ZOPO(&ZOPN)          SETC 'DS'                                         00155200
&ZOPV(&ZOPN)          SETC 'A'                                          00155300
&ZOPD(&ZOPN)          SETC '++ &ZXEWLM_S_CURCORR ADDR'                  00155400
.*-------------------------------------------------------------------   00155500
.***AM.L09 ADDR XEWLM_RCVD_CORR A                                       00155600
&ZOPN                 SETA &ZOPN+1                                      00155700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XEWLM_RCVD_CORR_ADDR'             00155800
&ZOPO(&ZOPN)          SETC 'DS'                                         00155900
&ZOPV(&ZOPN)          SETC 'A'                                          00156000
&ZOPD(&ZOPN)          SETC '++ &ZXEWLM_RCVD_CORR ADDR'                  00156100
.*-------------------------------------------------------------------   00156200
.***AM.L09 ADDR XARRIVALTIME A                                          00156300
&ZOPN                 SETA &ZOPN+1                                      00156400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XARRIVALTIME_ADDR'                00156500
&ZOPO(&ZOPN)          SETC 'DS'                                         00156600
&ZOPV(&ZOPN)          SETC 'A'                                          00156700
&ZOPD(&ZOPN)          SETC '++ &ZXARRIVALTIME ADDR'                     00156800
.*-------------------------------------------------------------------   00156900
.***AM.L10 END OF IWMMSTRT LIST PARAMETERS                              00157000
&ZOPN                 SETA &ZOPN+1                                      00157100
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00157200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00157300
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00157400
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00157500
.*                                                                      00157600
&ZOPN                 SETA &ZOPN+1                                      00157700
&ZOPL(&ZOPN)          SETC ' '                                          00157800
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00157900
&ZOPV(&ZOPN)          SETC '1'                                          00158000
&ZOPD(&ZOPN)          SETC ' '                                          00158100
.*-------------------------------------------------------------------   00158200
.***AL.L12 IWMMSTRT FMT=LIST MF=S!L PARAMETERS                          00158300
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00158400
.*                                                                      00158500
&ZOPN                 SETA  &ZOPN+1                                     00158600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00158700
&ZOPO(&ZOPN)          SETC  'DC'                                        00158800
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00158900
&ZOPD(&ZOPN)          SETC  '++ IWMMSTRT ARG PARMS'                     00159000
.*                                                                      00159100
.ZLMFSLX              ANOP  ,                                           00159200
.*-------------------------------------------------------------------   00159300
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00159400
&ZPLLEN               SETA 24                                           00159500
.*                                                                      00159600
.******************************************************************     00159700
.***AI.L01 IWMMSTRT FMT=LIST FILL IN PARAMETER AREA                     00159800
.******************************************************************     00159900
                      ACTR  10000                                       00160000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00160100
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00160200
&ZCVAL                SETC  'LAE'          XAX MODE                     00160300
.ZIMFXA               ANOP ,                                            00160400
.*                                                                      00160500
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00160600
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00160700
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00160800
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00160900
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00161000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00161100
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00161200
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00161300
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00161400
&ZOPN                 SETA  &ZOPN+1                                     00161500
&ZOPL(&ZOPN)          SETC  ' '                                         00161600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00161700
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00161800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00161900
                      AGO   .ZIMFNX                                     00162000
.*                                                                      00162100
.ZIMFN2               ANOP ,                                            00162200
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00162300
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00162400
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00162500
&ZOPN                 SETA  &ZOPN+1                                     00162600
&ZOPL(&ZOPN)          SETC  ' '                                         00162700
&ZOPO(&ZOPN)          SETC  'LAE'                                       00162800
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00162900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00163000
                      AGO   .ZIMFNX                                     00163100
.ZIMFNX1              ANOP ,                                            00163200
&ZOPN                 SETA  &ZOPN+1                                     00163300
&ZOPL(&ZOPN)          SETC  ' '                                         00163400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00163500
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00163600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00163700
.ZIMFNX               ANOP ,                                            00163800
.********************************************************************   00163900
.***AI.L02 IWMMSTRT FMT=LIST INITIALIZE PARAMETER AREA                  00164000
.********************************************************************   00164100
.***AI.L03 MF=(SLE)                                                     00164200
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00164300
.*                                                                      00164400
&ZOPN                 SETA  &ZOPN+1                                     00164500
&ZOPL(&ZOPN)          SETC  ' '                                         00164600
&ZOPO(&ZOPN)          SETC  'XC'                                        00164700
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00164800
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00164900
.ZIMFLX               ANOP  ,                                           00165000
.*-------------------------------------------------------------------   00165100
.***AI.L05 XMSTRT_OPTIONS BL2                                           00165200
&ZW                   SETC  ''                                          00165300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00165400
.*-------------------------------------------------------------------   00165500
.***AI.L08 XMSTRT_OPTIONS "YES"                                         00165600
.***      BL2'1XXXXXXXXXXXXXXX'                                         00165700
         AIF   ('&XEND_FLOW' NE 'YES').ZI3A                             00165800
&ZW                   SETC  '&ZW.1'                                     00165900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00166000
                      AGO   .ZI3C                                       00166100
.*                                                                      00166200
.ZI3A                 ANOP  ,                                           00166300
&ZW                   SETC  '&ZW.0'                                     00166400
.ZI3C                 ANOP  ,                                           00166500
.*-------------------------------------------------------------------   00166600
.***AI.L08 XMSTRT_OPTIONS "YES"                                         00166700
.***      BL2'X1XXXXXXXXXXXXXX'                                         00166800
         AIF   ('&XMSG_RECEIVED' NE 'YES').ZI4A                         00166900
&ZW                   SETC  '&ZW.100000000000000'                       00167000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00167100
                      AGO   .ZI4C                                       00167200
.*                                                                      00167300
.ZI4A                 ANOP  ,                                           00167400
&ZW                   SETC  '&ZW.000000000000000'                       00167500
.ZI4C                 ANOP  ,                                           00167600
.*-------------------------------------------------------------------   00167700
.***AI.L10 XMSTRT_OPTIONS BL2                                           00167800
                      AIF   ('&ZCLNG' NE 'YES').ZI4E  ALL ZERO BITS     00167900
&ZOPN                 SETA  &ZOPN+1                                     00168000
&ZOPL(&ZOPN)          SETC  ' '                                         00168100
&ZOPO(&ZOPN)          SETC  'OC'                                        00168200
&ZOPV(&ZOPN)          SETC  '1(2,1),=BL2''&ZW'''                        00168300
&ZOPD(&ZOPN)          SETC  '++ INPUT BL2'                              00168400
.ZI4E                 ANOP  ,                                           00168500
.*-------------------------------------------------------------------   00168600
.***AI.L25  XMONTKN XL4                                                 00168700
                      AIF   ('&ZXMONTKN' EQ '').ZI6E                    00168800
                      AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZI6E              00168900
&ZCGPR                SETC  '&XMONTKN'                                  00169000
.*                                                                      00169100
                      AIF   ('&XMONTKN'(1,1) NE '(').ZI6B               00169200
&ZCGPR   SETC  '0('.'&XMONTKN'(2,K'&XMONTKN-2).')'                      00169300
                      AGO   .ZI6D                                       00169400
.ZI6B                 ANOP  ,                                           00169500
.*                                                                      00169600
&ZC                   SETC  '&XMONTKN'(1,1)                             00169700
                      AIF   (T'&ZC NE 'N').ZI6D                         00169800
&ZC                   SETC  '&XMONTKN'                                  00169900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI6D                00170000
&ZCGPR                SETC  '=BL4''&XMONTKN'''                          00170100
.*                                                                      00170200
.ZI6D                 ANOP  ,                                           00170300
.*                                                                      00170400
&ZOPN                 SETA  &ZOPN+1                                     00170500
&ZOPL(&ZOPN)          SETC  ' '                                         00170600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00170700
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00170800
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN XMONTKN'                      00170900
.*                                                                      00171000
.ZI6E                 ANOP  ,                                           00171100
.*-------------------------------------------------------------------   00171200
.***AI.L19 ADDR XEWLM_S_PACORR A                                        00171300
                      AIF   ('&ZXEWLM_S_PACORR' EQ '').ZI7H             00171400
&ZCLNG                SETC  '&XEWLM_S_PACORR'                           00171500
&ZCGPR                SETC  '14'                                        00171600
         AIF   ('&XEWLM_S_PACORR'(1,1) EQ '(').ZI7F  IN GPR             00171700
.*                                                                      00171800
&ZOPN                 SETA  &ZOPN+1                                     00171900
&ZOPL(&ZOPN)          SETC  ' '                                         00172000
&ZOPO(&ZOPN)          SETC  'LA'                                        00172100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00172200
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_PACORR XEWLM_S_PACORR'        00172300
.*                                                                      00172400
                      AGO   .ZI7G                                       00172500
.*                                                                      00172600
.ZI7F                 ANOP  ,                                           00172700
&ZCGPR   SETC  '&XEWLM_S_PACORR'(2,K'&XEWLM_S_PACORR-2)                 00172800
.*                                                                      00172900
.ZI7G                 ANOP  ,                                           00173000
.*                                                                      00173100
&ZOPN                 SETA  &ZOPN+1                                     00173200
&ZOPL(&ZOPN)          SETC  ' '                                         00173300
&ZOPO(&ZOPN)          SETC  'ST'                                        00173400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00173500
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_PACORR XEWLM_S_PACORR'        00173600
.*                                                                      00173700
.ZI7H                 ANOP  ,                                           00173800
.*-------------------------------------------------------------------   00173900
.***AI.L19 ADDR XEWLM_S_CURCORR A                                       00174000
                      AIF   ('&ZXEWLM_S_CURCORR' EQ '').ZI8H            00174100
&ZCLNG                SETC  '&XEWLM_S_CURCORR'                          00174200
&ZCGPR                SETC  '14'                                        00174300
         AIF   ('&XEWLM_S_CURCORR'(1,1) EQ '(').ZI8F  IN GPR            00174400
.*                                                                      00174500
&ZOPN                 SETA  &ZOPN+1                                     00174600
&ZOPL(&ZOPN)          SETC  ' '                                         00174700
&ZOPO(&ZOPN)          SETC  'LA'                                        00174800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00174900
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_CURCORR XEWLM_S_CURCORR'      00175000
.*                                                                      00175100
                      AGO   .ZI8G                                       00175200
.*                                                                      00175300
.ZI8F                 ANOP  ,                                           00175400
&ZCGPR   SETC  '&XEWLM_S_CURCORR'(2,K'&XEWLM_S_CURCORR-2)               00175500
.*                                                                      00175600
.ZI8G                 ANOP  ,                                           00175700
.*                                                                      00175800
&ZOPN                 SETA  &ZOPN+1                                     00175900
&ZOPL(&ZOPN)          SETC  ' '                                         00176000
&ZOPO(&ZOPN)          SETC  'ST'                                        00176100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,12(,1)'                             00176200
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_S_CURCORR XEWLM_S_CURCORR'      00176300
.*                                                                      00176400
.ZI8H                 ANOP  ,                                           00176500
.*-------------------------------------------------------------------   00176600
.***AI.L18 ADDR XEWLM_RCVD_CORR A                                       00176700
         AIF   ('&XEWLM_RCVD_CORR' NE 'NO_EWLM_RCVD_CORR').ZI9          00176800
&ZXEWLM_RCVD_CORR     SETC  ''             RESET INPUT/OUTPUT           00176900
.ZI9                  ANOP  ,                                           00177000
.*-------------------------------------------------------------------   00177100
.***AI.L19 ADDR XEWLM_RCVD_CORR A                                       00177200
                      AIF   ('&ZXEWLM_RCVD_CORR' EQ '').ZI9H            00177300
&ZCLNG                SETC  '&XEWLM_RCVD_CORR'                          00177400
&ZCGPR                SETC  '14'                                        00177500
         AIF   ('&XEWLM_RCVD_CORR'(1,1) EQ '(').ZI9F  IN GPR            00177600
.*                                                                      00177700
&ZOPN                 SETA  &ZOPN+1                                     00177800
&ZOPL(&ZOPN)          SETC  ' '                                         00177900
&ZOPO(&ZOPN)          SETC  'LA'                                        00178000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00178100
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_RCVD_CORR XEWLM_RCVD_CORR'      00178200
.*                                                                      00178300
                      AGO   .ZI9G                                       00178400
.*                                                                      00178500
.ZI9F                 ANOP  ,                                           00178600
&ZCGPR   SETC  '&XEWLM_RCVD_CORR'(2,K'&XEWLM_RCVD_CORR-2)               00178700
.*                                                                      00178800
.ZI9G                 ANOP  ,                                           00178900
.*                                                                      00179000
&ZOPN                 SETA  &ZOPN+1                                     00179100
&ZOPL(&ZOPN)          SETC  ' '                                         00179200
&ZOPO(&ZOPN)          SETC  'ST'                                        00179300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00179400
&ZOPD(&ZOPN)          SETC  '++ &ZXEWLM_RCVD_CORR XEWLM_RCVD_CORR'      00179500
.*                                                                      00179600
.ZI9H                 ANOP  ,                                           00179700
.*-------------------------------------------------------------------   00179800
.***AI.L18 ADDR XARRIVALTIME A                                          00179900
         AIF   ('&XARRIVALTIME' NE 'NO_ARRIVALTIME').ZI10               00180000
&ZXARRIVALTIME        SETC  ''             RESET INPUT/OUTPUT           00180100
.ZI10                 ANOP  ,                                           00180200
.*-------------------------------------------------------------------   00180300
.***AI.L19 ADDR XARRIVALTIME A                                          00180400
                      AIF   ('&ZXARRIVALTIME' EQ '').ZI10H              00180500
&ZCLNG                SETC  '&XARRIVALTIME'                             00180600
&ZCGPR                SETC  '14'                                        00180700
         AIF   ('&XARRIVALTIME'(1,1) EQ '(').ZI10F  IN GPR              00180800
.*                                                                      00180900
&ZOPN                 SETA  &ZOPN+1                                     00181000
&ZOPL(&ZOPN)          SETC  ' '                                         00181100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00181200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00181300
&ZOPD(&ZOPN)          SETC  '++ &ZXARRIVALTIME XARRIVALTIME'            00181400
.*                                                                      00181500
                      AGO   .ZI10G                                      00181600
.*                                                                      00181700
.ZI10F                ANOP  ,                                           00181800
&ZCGPR   SETC  '&XARRIVALTIME'(2,K'&XARRIVALTIME-2)                     00181900
.*                                                                      00182000
.ZI10G                ANOP  ,                                           00182100
.*                                                                      00182200
&ZOPN                 SETA  &ZOPN+1                                     00182300
&ZOPL(&ZOPN)          SETC  ' '                                         00182400
&ZOPO(&ZOPN)          SETC  'ST'                                        00182500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,20(,1)'                             00182600
&ZOPD(&ZOPN)          SETC  '++ &ZXARRIVALTIME XARRIVALTIME'            00182700
.*                                                                      00182800
.ZI10H                ANOP  ,                                           00182900
.*-------------------------------------------------------------------   00183000
&ZOPN1                SETA &ZOPN                                        00183100
.*******************************************************************    00183200
.***  PROCESS IWMMSTRT OUTPUT PARAMETERS                                00183300
.*******************************************************************    00183400
                      ACTR  10000                                       00183500
.*******************************************************************    00183600
.***AO.X02  RETURN CODE PROCESSING                                      00183700
.*******************************************************************    00183800
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00183900
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00184000
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00184100
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00184200
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00184300
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00184400
&ZOPN                 SETA  &ZOPN+1                                     00184500
&ZOPL(&ZOPN)          SETC  ' '                                         00184600
&ZOPO(&ZOPN)          SETC  'ST'                                        00184700
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00184800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00184900
                      AGO   .ZMRETX                                     00185000
.*                                                                      00185100
.ZMRET2               ANOP  ,                                           00185200
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00185300
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00185400
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00185500
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00185600
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00185700
&ZOPN                 SETA  &ZOPN+1                                     00185800
&ZOPL(&ZOPN)          SETC  ' '                                         00185900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00186000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00186100
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00186200
.ZMRETX               ANOP  ,                                           00186300
.*******************************************************************    00186400
.***AO.X03  REASON CODE PROCESSING                                      00186500
.*******************************************************************    00186600
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00186700
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00186800
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00186900
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00187000
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00187100
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00187200
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00187300
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00187400
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00187500
&ZOPN                 SETA  &ZOPN+1                                     00187600
&ZOPL(&ZOPN)          SETC  ' '                                         00187700
&ZOPO(&ZOPN)          SETC  'ST'                                        00187800
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00187900
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00188000
                      AGO   .ZMRSNX                                     00188100
.*                                                                      00188200
.ZMRSN2               ANOP  ,                                           00188300
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00188400
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00188500
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00188600
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00188700
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00188800
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00188900
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00189000
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00189100
&ZOPN                 SETA  &ZOPN+1                                     00189200
&ZOPL(&ZOPN)          SETC  ' '                                         00189300
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00189400
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00189500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00189600
.ZMRSNX               ANOP  ,                                           00189700
.*******************************************************************    00189800
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00189900
.*******************************************************************    00190000
.ZMFLX                ANOP  ,              MF=L PROCESSING              00190100
.*******************************************************************    00190200
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00190300
.*******************************************************************    00190400
                      ACTR  10000                                       00190500
.*                                                                      00190600
                      LCLA  &ZLC           COLUMN POSITION              00190700
                      LCLA  &ZOPX          LIST TABLE INDEX             00190800
                      LCLC  &ZLL           LABEL                        00190900
                      LCLC  &ZLOP          OPERATION                    00191000
                      LCLC  &ZLV           VALUE                        00191100
                      LCLC  &ZLD           DESCRIPTION                  00191200
.*                                                                      00191300
&ZOPX                 SETA  1                                           00191400
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00191500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00191600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00191700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00191800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00191900
                      AIF   (K'&ZLD LE 0).ZL5                           00192000
&ZLC                  SETA  35             COMMENT COLUMN               00192100
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00192200
&ZLC                  SETA  33             COMMMENT COLUMN              00192300
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00192400
&ZLV                  SETC  '&ZLV'.' '                                  00192500
                      AGO   .ZL3                                        00192600
.*                                                                      00192700
.ZL4                  ANOP  ,                                           00192800
&ZLV                  SETC  '&ZLV'.' '                                  00192900
.ZL5                  ANOP  ,                                           00193000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00193100
.*                                                                      00193200
&ZLL     &ZLOP &ZLV                                                     00193300
.*                                                                      00193400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00193500
                      AGO   .ZL2           CONTINUE LOOPING             00193600
.*                                                                      00193700
.ZLX                  ANOP  ,                                           00193800
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00193900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00194000
         LCLC  &T1                                                      00194100
&T1      SETC  '&MONTKN'                                                00194200
         AIF   ('&MONTKN'(1,1) NE '(').MONTKNRS                         00194300
&T1      SETC  '&MONTKN'(2,K'&MONTKN-2)                                 00194400
&T1      SETC  '0(&T1.)'                                                00194500
.MONTKNRS  ANOP                                                         00194600
         ICM   14,15,&T1               FETCH MONITORING TOKEN           00194700
         BNZ   MONENV&SYSNDX           BRANCH WHEN MON ENV IS PRESENT   00194800
         LA    0,IWMRSNCODENOMONENV    SET REASON CODE = NO MON ENV     00194900
         LA    15,IWMRETCODEWARNING    SET WARNING RETURN CODE          00195000
         B     END&SYSNDX              BRANCH TO END LABEL              00195100
MONENV&SYSNDX DS    0H                 BRANCH LABEL FOR MON ENV PRESENT 00195200
         CLC   PB_ID-PB(4,14),=CL4'PB  '                                00195300
         BE    MONENVOK&SYSNDX         BRANCH WHEN MON ENV PASSES       00195400
         LA    0,IWMRSNCODEBADMONENV   SET REASON CODE = BAD MON ENV    00195500
         LA    15,IWMRETCODEINVOCERROR SET INVOCATION ERROR RETURN CODE 00195600
         B     END&SYSNDX              BRANCH TO END LABEL              00195700
MONENVOK&SYSNDX DS    0H               BRANCH LABEL FOR MON ENV OK      00195800
         CLI   PB_VERSION-PB(14),PB_VERSION6                            00195900
         BH    VERSOK&SYSNDX           BRANCH WHEN VERSION IS GREATER   00196000
         SLR   0,0                     SET REASON CODE = 0              00196100
         SLR   15,15                   SET RETURN CODE = 0              00196200
         B     END&SYSNDX              BRANCH TO END LABEL              00196300
VERSOK&SYSNDX DS    0H                 BRANCH LABEL FOR VERSION OK      00196400
         ST    1,PB_EWLM_PARMLIST-PB(,14)    STORE ADDR OF PARMLIST     00196500
         MVI   PB_EWLM_REQUEST-PB(14),PB_EWLM_REQUEST_IWMMSTRT          00196600
         LR    1,14                    LOAD ADDR OF PB INTO R01         00196700
*        USING PB,14                                                    00196800
         L     15,X'10'                ADDRESS THE CVT                  00196900
         L     15,X'8C'(15,0)          ADDRESS THE ECVT                 00197000
         L     15,X'C4'(15,0)          ADDRESS THE WMVT                 00197100
         L     15,X'13C'(15,0)         GET SERVICE ROUTINE ADDR         00197200
         BASR  14,15                   INVOKE SERVICE ROUTINE           00197300
*        LR    14,1                    RESTORE ADDRESS OF PB            00197400
*        DROP  14                                                       00197500
END&SYSNDX DS    0H                    END LABEL                        00197600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00197700
.ZLINKX               ANOP  ,                                           00197800
.*******************************************************************    00197900
.***AP.X01  FORMAT GENERATED CODE                                       00198000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00198100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00198200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00198300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00198400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00198500
                      AIF   (K'&ZLD LE 0).ZL51                          00198600
&ZLC                  SETA  35             COMMENT COLUMN               00198700
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00198800
&ZLC                  SETA  33             COMMENT COLUMN               00198900
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00199000
&ZLV                  SETC  '&ZLV'.' '                                  00199100
                      AGO   .ZL31                                       00199200
.*                                                                      00199300
.ZL41                 ANOP  ,                                           00199400
&ZLV                  SETC  '&ZLV'.' '                                  00199500
.ZL51                 ANOP  ,                                           00199600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00199700
.*                                                                      00199800
&ZLL     &ZLOP &ZLV                                                     00199900
.*                                                                      00200000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00200100
                      AGO   .ZL21          CONTINUE LOOPING             00200200
.*                                                                      00200300
.ZLX1                 ANOP  ,                                           00200400
.*******************************************************************    00200500
.***AP.X02  END OF IWMMSTRT MACRO                                       00200600
&ZIWMMSTRT            SETC  'YES'          SET IWMMSTRT USED            00200700
         POP   PRINT                                                    00200800
*                                            IWMMSTRT-0                 00200900
         SPACE 1                                                        00201000
.ZLX2                 ANOP  ,                                           00201100
         MEND                                                           00201200
**********************************************************************/ 00201300
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00201400
*%IWMMSTRT: MACRO KEYS(MONTKN,END_FLOW,MSG_RECEIVED,ARRIVALTIME,        00201500
*                 EWLM_S_PACORR,EWLM_S_CURCORR,EWLM_RCVD_CORR,RETCODE,  00201600
*                 RSNCODE,PLISTVER,MF);                                 00201700
*  ANS('?'!!MACLABEL!!' '!!'IWMMSTRP '!!MACLIST!!                       00201800
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00201900
*%END IWMMSTRT;                                                         00202000

*                                                                       00001000
* %DCL ISGYCNFP_INCLUDED CHAR EXT;                                      00002000
* %DEACTIVATE ISGYCNFP_INCLUDED;                                        00003000
* %IF ISGYCNFP_INCLUDED = '' %THEN                                      00004000
* %DO;                                                                  00005000
*/* Macro made bi-lingual on 08057. CBGEN compile date 07165         */ 00006000
*% /*                                                                   00007000
         MACRO                                                          00008000
         ISGYCNFP &DSECT=YES,&LIST=YES,&TITLE=YES,&CNFP=YES             00009000
         GBLC  &ISGYCNFP_INCLUDED                                       00010000
         GBLC  &ZCBPRINT                                                00011000
&ISGYCNFP_INCLUDED SETC 'YES'                                           00012000
         AIF   ('&LIST' EQ 'NONE').P0                                   00013000
         AIF   ('&TITLE' EQ 'NO').P5                                    00014000
 TITLE   'ISGYCNFP  - Contention Notification Filter Parameter list  '  00015000
.P5      ANOP                                                           00016000
**/ ISGYCNFP_1:;                                                        00017000
*/* START OF SPECIFICATIONS ******************************************* 00018000
*                                                                       00019000
*01* DESCRIPTIVE NAME:  Contention Notification Filter Parameter list   00020000
*02*  ACRONYM:  CNFP                                                    00021000
*                                                                       00022000
*01* PROPRIETARY STATEMENT =                                            00023000
*                                                                       00024000
*    LICENSED MATERIALS - PROPERTY OF IBM                               00025000
*    5694-A01 COPYRIGHT IBM CORP. 2001,2009                             00026000
*                                                                       00027000
*01* STATUS = HBB7760                                                   00028000
*                                                                       00029000
*01* EXTERNAL CLASSIFICATION: PI                                        00030000
*01* END OF EXTERNAL CLASSIFICATION:                                    00031000
*                                                                       00032000
*01* MACRO-NAME: ISGYCNFP                                               00033000
*                                                                       00034000
*01* DSECT NAME: CNFP                                                   00035000
*                                                                       00036000
*01* COMPONENT:  Global Resource Serialization (SCSDS)                  00037000
*                                                                       00038000
*01* EYE-CATCHER:  CNFP                                                 00039000
*02*  OFFSET:  0                                                        00040000
*02*  LENGTH:  4                                                        00041000
*                                                                       00042000
*01* STORAGE ATTRIBUTES:                                                00043000
*02*  SUBPOOL:  229                                                     00044000
*02*  KEY:  0                                                           00045000
*02*  RESIDENCY:  Above the 16M line                                    00046000
*                                                                       00047000
*01* SIZE:  LENGTH(CNFP)                                                00048000
*            CNFP -- X'00B0' bytes                                      00049000
*                                                                       00050000
*01* FREQUENCY:  1 per resource contention event                        00051000
*                                                                       00052000
*01* CREATED BY: ISGGCN                                                 00053000
*                                                                       00054000
*01* POINTED TO BY: R1 points to the CNFP on entry to the exit routine  00055000
*                                                                       00056000
*01* SERIALIZATION: N/A                                                 00057000
*                                                                       00058000
*01* FUNCTION:                                                          00059000
*                                                                       00060000
*    The Contention Notification Filter Parameter list is passed to     00061000
*    an installation provided exit routine installed at the             00062000
*    ISGNQXITSYSTEM or ISGNQXITSYSPLEX exit point, depending on the     00063000
*    scope of the resource.  It gives the installation the ability      00064000
*    to filter out ENF 51 signal processing on a resource basis.        00065000
*                                                                       00066000
*    The resource name information referenced in the parameter list     00067000
*    should not be altered.                                             00068000
*                                                                       00069000
*    Aditional information about the request is also provided when      00070000
*    available and can be used by contention monitors.                  00071000
*                                                                       00072000
*01* METHOD OF ACCESS: DECLARE CNFPPTR PTR(31)                          00073000
*                      %INCLUDE SYSLIB(ISGYCNFP)                        00074000
*                                                                       00075000
*01* DELETED BY: ISGGCN                                                 00076000
*                                                                       00077000
*01* NOTES: None                                                        00078000
*                                                                       00079000
*02*  DEPENDENCIES: None                                                00080000
*                                                                       00081000
*01* DISTRIBUTION LIBRARY: AMACLIB                                      00082000
*                                                                       00083000
*01* CHANGE ACTIVITY:                                                   00084000
*                                                                       00085000
*    $00=OW53323 ,HBB7707,020630,PDBC: Contention Notification          00086000
*                                      Filter Exits                     00087000
*       =ME03930 ,HBB7730,050808,PDCJ: Fix copyright                    00088000
*    $L1=GRSISVCP,HBB7760,070910,PDFX: Add requester data               00089000
*                                                                       00090000
**** END OF SPECIFICATIONS *******************************************/ 00091000
*% /*                                                                   00092000
.P0      ANOP                                                           00093000
         AIF   ('&ZCBPRINT' EQ 'NO').P1                                 00094000
         AIF   ('&LIST' EQ 'YES').P2                                    00095000
.P1      ANOP                                                           00096000
         PUSH  PRINT                                                    00097000
         PRINT OFF                                                      00098000
.P2      ANOP                                                           00099000
         AIF   ('&CNFP' EQ 'NO').L0002                                  00100000
         AIF   ('&DSECT' EQ 'YES').L0003                                00101000
         AIF   ('&CNFP' NE 'YES').L0002                                 00102000
CNFP     DS    0D        +00x------------------------------------------*00103000
                         ------------------                             00104000
         AGO   .L0004                                                   00105000
.L0003   ANOP                                                           00106000
CNFP     DSECT           +00x------------------------------------------*00107000
                         ------------------                             00108000
.L0004   ANOP                                                           00109000
CNFP_ID  DS    CL4       Eyecatcher                                     00110000
CNFP_VERSION DS X        Version                                        00111000
         DS    CL3       Reserved                                       00112000
CNFP_WORKAREA@ DS A      Pointer to a 4K work area, usable by exit     *00113000
                         routines                                       00114000
CNFP_FLAGS DS  0CL4                                                     00115000
CNFP_OUTPUTFLAGS DS 0CL2                                                00116000
CNFP_FILTER EQU X'80'    When set to 1 by the exit routine, ENF 51     *00117000
                         processing will be bypassed for this          *00118000
                         resource.                                      00119000
         ORG   CNFP_OUTPUTFLAGS+2                                       00120000
CNFP_INPUTFLAGS DS 0CL2                                                 00121000
CNFP_SYSTEM EQU X'80'    When 1, the exit routine is being called for  *00122000
                         the ISGCNFXITSYSTEM entry point. When 0, the  *00123000
                         exit routine is being called for the          *00124000
                         ISGCNFXITSYSPLEX entry point.                  00125000
CNFP_CONTENTIONSTART EQU X'40' When 1, this exit is being called for a *00126000
                         start of contention event                      00127000
CNFP_CONTENTIONCHANGE EQU X'20' When 1, this exit is being called for  *00128000
                         a change of contention event                   00129000
CNFP_CONTENTIONEND EQU X'10' When 1, this exit is being called for a   *00130000
                         end of contention event                        00131000
CNFP_REQUESTDATAAVAILABLE EQU X'08' When 1, the fields in              *00132000
                         Cnfp_RequestData are valid. This bit is only  *00133000
                         valid when version is Cnfp_kVersion#2 and     *00134000
                         above. +10x-----------------------------------*00135000
                         -------------------------                      00136000
         ORG   CNFP_FLAGS+4                                             00137000
CNFP_QNAME@ DS A         Pointer to resource Qname                      00138000
CNFP_RNAME@ DS A         Pointer to resource Rname                      00139000
CNFP_RLEN DS   F         Length of resource Rname                       00140000
         DS    CL4       Reserved **************************************00141000
                         **************************** Fields below     *00142000
                         this line only available with version 2 and   *00143000
                         higher ****************************************00144000
                         *********************                          00145000
CNFP_REQUESTDATA DS 0CL144 ENQ/DEQ request state information, these    *00146000
                         values cannot be changed. These fields are    *00147000
                         only available when Cnfp_RequestDataAvailable *00148000
                         is set. +20x----------------------------------*00149000
                         --------------------------                     00150000
CNFP_RSCTOKEN DS CL32    Token uniquely identifying the resource. The  *00151000
                         token represents the local systems view of    *00152000
                         the resource and expires when no requests for *00153000
                         the resource remain. Additionally, in Star    *00154000
                         mode the token expires when the local system  *00155000
                         no longer has interest in (i.e. requests for) *00156000
                         the resource. +40x----------------------------*00157000
                         --------------------------------               00158000
CNFP_ENQTOKEN DS CL32    Token uniquely identifying the queued request *00159000
                         to the resource. +60x-------------------------*00160000
                         -----------------------------------            00161000
CNFP_RD_REQUESTTOKEN DS CL16 Unique token identifying the GRS exit     *00162000
                         call processing for the request. If needed,   *00163000
                         all exits driven for this request can use     *00164000
                         this token to identify the same request. See  *00165000
                         the prologue for more information. +70x-------*00166000
                         ----------------------------------------------*00167000
                         -------                                        00168000
REQUESTFLAGS DS 0B       Flags about request                            00169000
CNFP_ENDOFTASK EQU X'80' When 1, this contention event is a result of  *00170000
                         task termination. Note that the only          *00171000
                         RequestData fields that are valid when        *00172000
                         Cnfp_EndOfTask is set are the above tokens,   *00173000
                         the ASCB, TCB, and final scope. All others    *00174000
                         are not applicable nor set.                    00175000
CNFP_ENDOFMEMORY EQU X'40' When 1, this contention event is a result   *00176000
                         of address space termination. Note that the   *00177000
                         only RequestData fields that are valid when   *00178000
                         Cnfp_EndOfMemory is set are the above tokens, *00179000
                         the ASCB, and final scope. All others are not *00180000
                         applicable nor set.                            00181000
CNFP_INTERNALREQUEST EQU X'20' When 1, this contention event is a      *00182000
                         result of an internal GRS request and is not  *00183000
                         a direct result of ENQ/DEQ on behalf of a     *00184000
                         caller. Note that the only RequestData fields *00185000
                         that are valid when Cnfp_InternalRequest is   *00186000
                         set are the above tokens, the ASCB, TCB, and  *00187000
                         final scope. All others are not applicable    *00188000
                         nor set.                                       00189000
         ORG   REQUESTFLAGS+1                                           00190000
         DS    CL7       Reserved                                       00191000
CNFP_RD_ASCB@ DS A       Pointer to requester's ASCB                    00192000
CNFP_RD_TCB@ DS A        Pointer to requester's TCB or directed TCB if *00193000
                         TCB= was specified. Note that if              *00194000
                         Cnfp_RD_MAsid is zero then the request is not *00195000
                         treated as a MASID/MTCB request. +80x---------*00196000
                         ----------------------------------------------*00197000
                         -----                                          00198000
CNFP_RD_SCOPE DS X       Final resolved request scope after any exit   *00199000
                         and RNL changes. See Cnfp_kScope values.       00200000
CNFP_RD_ORIGINALSCOPE DS X Scope before exit and RNL processing. See   *00201000
                         Cnfp_kScope values.                            00202000
CNFP_RD_RET DS 0X        Request RET value, see Cnfp_kRET values        00203000
CNFP_RD_RET1 EQU X'04'   Maps to PELRET1                                00204000
CNFP_RD_RET2 EQU X'02'   Maps to PELRET2                                00205000
CNFP_RD_RET3 EQU X'01'   Maps to PELRET3                                00206000
         ORG   CNFP_RD_RET+1                                            00207000
         DS    CL1       Reserved                                       00208000
CNFP_RD_UCB@ DS A        Request UCB address after ISGNQXIT/FAST and   *00209000
                         RNL processing. Only valid when Cnfp_SF1_ENQ  *00210000
                         is set. Note that the actual device RESERVE   *00211000
                         will not be issued when Cnfp_SF3_Converted is *00212000
                         set                                            00213000
CNFP_RD_MASID DS H       Request MASID value. This field might be      *00214000
                         cleared to zero indicating the request was    *00215000
                         not processed as a MASID request (such as     *00216000
                         when the targeted task was not found or the   *00217000
                         request could be a true owner).                00218000
CNFP_RD_NQXITSCOPE DS X  Scope value after ISGNQXITFAST and ISGNQXIT   *00219000
                         processing. A comparison with                 *00220000
                         Cnfp_RD_OriginalScope determines if the exit  *00221000
                         changed the scope. See Cnfp_kScope values.     00222000
         DS    CL1       Reserved                                       00223000
CNFP_RD_MTCB DS A        Request MTCB value +90x-----------------------*00224000
                         -------------------------------------          00225000
CNFP_RD_JOBNAME DS CL8   Requester's Jobname                            00226000
CNFP_RD_SYSNAME DS CL8   Requester's Sysname +A0x----------------------*00227000
                         --------------------------------------         00228000
CNFP_RD_NSI@ DS 0A       Requester's next sequential instruction       *00229000
                         address, when ENQ/DEQ ends, this is address   *00230000
                         of the next instruction in the calling        *00231000
                         program that will be executed                  00232000
CNFP_RD_AMODE31 EQU X'80' When set, ENQ caller is AMODE 31 or 64        00233000
         ORG   CNFP_RD_NSI@+4                                           00234000
CNFP_RD_ECB@ DS A        Pointer to original request ECB (set when     *00235000
                         ECB= specified on the request)                 00236000
CNFP_STATEFLAGS DS 0CL3  ENQ/DEQ request state flags                    00237000
CNFP_STATEFLAGS1 DS 0B   First byte of state flags                      00238000
CNFP_SF1_ENQ EQU X'80'   When 1, request is ENQ/RESERVE, when 0,       *00239000
                         request is DEQ. If Cnfp_SF1_ISGENQ is set     *00240000
                         then when 1, ISGENQ REQUEST=OBTAIN or CHANGE, *00241000
                         when 0, REQUEST=RELEASE. See Cnfp_SF2_Change  *00242000
                         to distinguish between ISGENQ REQUEST=OBTAIN  *00243000
                         and REQUEST=CHANGE.                            00244000
CNFP_SF1_AUTHORIZED EQU X'40' Caller is authorized. That is the        *00245000
                         requester was at least one of the following:  *00246000
                         Supervisor state, PSW key 0-7, or APF         *00247000
                         authorized.                                    00248000
CNFP_SF1_MATCHTASK EQU X'20' When 1, request specified MASID/MTCB.     *00249000
                         Note that if Cnfp_RD_MAsid is zero then the   *00250000
                         request is not treated as a MASID/MTCB        *00251000
                         request.                                       00252000
CNFP_SF1_SMCORRMC EQU X'10'                                             00253000
CNFP_SF1_STEPMUSTCOMPLETE EQU X'10' When 1, ENQ request specified      *00254000
                         SMC=YES                                        00255000
CNFP_SF1_RESETMUSTCOMPLETE EQU X'10' When 1, DEQ request specified     *00256000
                         RMC=YES                                        00257000
CNFP_SF1_LINKAGE EQU X'08' When 1, request is PC entered when 0,       *00258000
                         request is SVC entered. As ISGENQ requests    *00259000
                         are all PC entered, this bit will be 1 for    *00260000
                         all ISGENQ requests.                           00261000
CNFP_SF1_ISGENQ EQU X'04' When 1, request is ISGENQ                     00262000
CNFP_SF1_ISGENQCONDYES EQU X'02' When 1, request is a conditional      *00263000
                         ISGENQ request (ISGENQ COND=YES)               00264000
         ORG   CNFP_STATEFLAGS1+1                                       00265000
CNFP_STATEFLAGS2 DS 0B   Second byte of state flags                     00266000
CNFP_SF2_SHARE EQU X'80' For ENQ/RESERVE requests, when 1 request is   *00267000
                         for shared access, when 0, request is for     *00268000
                         exclusive access                               00269000
CNFP_SF2_RNLEQNO EQU X'40' RNL=NO was specified on the request          00270000
CNFP_SF2_CHANGE EQU X'20' When 1, request is a change (i.e. ENQ        *00271000
                         RET=CHNG or ISGENQ REQUEST=CHANGE).            00272000
CNFP_SF2_TEST_YES EQU X'10' When 1, ISGENQ with TEST=YES. When 0, Not  *00273000
                         ISGENQ with TEST=YES (i.e. TEST=NO if         *00274000
                         Cnfp_SF1_ISGENQ is set).                       00275000
CNFP_SF2_CONTENTIONACT_FAIL EQU X'08' When 1, ISGENQ with              *00276000
                         CONTENTIONACT=FAIL. When 0, not               *00277000
                         CONTENTIONACT=FAIL (i.e. CONTENTIONACT=WAIT   *00278000
                         if Cnfp_SF1_ISGENQ is set and                 *00279000
                         Cnfp_SF2_TEST_YES is off).                     00280000
CNFP_SF2_ECB EQU X'04'   When 1, ECB keyword specified (i.e. ISGENQ    *00281000
                         WAITTYPE=ECB or or ENQ with ECB). When 0, No  *00282000
                         ECB specified (i.e. WAITTYPE=SUSPEND if       *00283000
                         Cnfp_SF1_ISGENQ is set and Cnfp_SF2_TEST_YES  *00284000
                         and Cnfp_SF2_CONTENTIONACT_FAIL are off).      00285000
         ORG   CNFP_STATEFLAGS2+1                                       00286000
CNFP_STATEFLAGS3 DS 0B   Third byte of state flags                      00287000
CNFP_SF3_INCLUDED EQU X'80' Resource promoted to SYSTEMS scope          00288000
CNFP_SF3_CONVERTED EQU X'40' Resource converted from RESERVE to        *00289000
                         SYSTEMS ENQ only. As such, the device RESERVE *00290000
                         will not be issued, but Cnfp_RD_Ucb@ will     *00291000
                         still be set                                   00292000
CNFP_SF3_EXCLUDED EQU X'20' Resource demoted to SYSTEM scope            00293000
CNFP_SF3_GLOBAL EQU X'10' Resource request will be processed globally  *00294000
                         by GRS. Note Cnfp_SF3_Global will always be   *00295000
                         off in GRS=NONE mode.                          00296000
         ORG   CNFP_STATEFLAGS+3                                        00297000
         DS    CL5       Reserved +B0x---------------------------------*00298000
                         ---------------------------                    00299000
CNFP_END DS    0C                                                       00300000
*                                                                       00301000
*   ******************************************************************  00302000
*                                                                       00303000
*                          CNFP Constants                               00304000
*                                                                       00305000
*   ******************************************************************  00306000
*                                                                       00307000
*                                                                       00308000
CNFP_KID EQU   C'CNFP'   Eyecatcher                                     00309000
CNFP_KVERSION#1 EQU 1    Original version (OW53323)                     00310000
CNFP_KVERSION#2 EQU 2    Version HBB7760                                00311000
CNFP_KCURRENTVERSION EQU 2 Current version (same)                       00312000
CNFP_KSCOPESTEP EQU 0    Scope=Step                                     00313000
CNFP_KSCOPESYSTEM EQU 1  Scope=System                                   00314000
CNFP_KSCOPESYSTEMS EQU 2 Scope=Systems                                  00315000
CNFP_KRETNONE EQU 0      Ret=None                                       00316000
CNFP_KRETHAVE EQU 1      Ret=Have                                       00317000
CNFP_KRETCHNG EQU 2      Ret=Chng                                       00318000
CNFP_KRETUSE EQU 3       Ret=Use                                        00319000
CNFP_KRETTEST EQU 7      Ret=Test                                       00320000
CNFP_KRETECB EQU 4       An ECB is specified for this ENQ request, via *00321000
                         either the ECB= parameter on ENQ or the       *00322000
                         WAITTYPE=ECB parameter on ISGENQ              *00323000
                         REQUEST=OBTAIN                                 00324000
CNFP_KSF3MASK EQU 240    Mask for copying from PelXFlg1 to             *00325000
                         Cnfp_StateFlags3                               00326000
CNFP_LEN EQU   *-CNFP                                                   00327000
.L0002   ANOP                                                           00328000
         AIF   ('&ZCBPRINT' EQ 'NO').P3                                 00329000
         AIF   ('&LIST' EQ 'YES').P4                                    00330000
.P3      ANOP                                                           00331000
         POP   PRINT                                                    00332000
.P4      ANOP                                                           00333000
.P_EXIT  ANOP                                                           00334000
         MEND                                                           00335000
**/ ISGYCNFP_2:;                                                        00336000
* %ISGYCNFP_INCLUDED = 'YES';                                           00337000
* %DCL ZCBPRINT CHAR EXT;                                               00338000
* %DEACTIVATE ZCBPRINT;                                                 00339000
* %DCL ISGYCNFP_LIST CHAR EXT;                                          00340000
* %DEACTIVATE ISGYCNFP_LIST;                                            00341000
* %IF ISGYCNFP_LIST ^= 'NO' &                                           00342000
*    ZCBPRINT ^= 'NO' %THEN                                             00343000
*   %GOTO ISGYCNFP_3;                                                   00344000
*   @LIST PUSH NOECHO;                                                  00345000
*   @LIST NOASSEMBLE NOECHO;                                            00346000
*   @LIST OFF C NOECHO;                                                 00347000
* %ISGYCNFP_3:;                                                         00348000
*/* Start of PL/X Source                                             */ 00349000
*%if CnfpAttr = '' %then                                                00350000
*  %CnfpAttr = 'based(CnfpPtr) bdy(dword)';                             00351000
*dcl                                                                    00352000
*   1 Cnfp CnfpAttr                                                     00353000
* /* +00x------------------------------------------------------------*/ 00354000
*  ,  3 Cnfp_Id char(4)             /* Eyecatcher                    */ 00355000
*  ,  3 Cnfp_Version fixed(8)       /* Version                       */ 00356000
*  ,  3 * char(3)                   /* Reserved                      */ 00357000
*  ,  3 Cnfp_WorkArea@ ptr(31)      /* Pointer to a 4K work area,       00358000
*                                      usable by exit routines       */ 00359000
*  ,  3 Cnfp_Flags char(4)          /*                               */ 00360000
*  ,    5 Cnfp_OutputFlags char(2)  /*                               */ 00361000
*  ,      7 Cnfp_Filter bit(1)      /* When set to 1 by the exit        00362000
*                                      routine, ENF 51 processing       00363000
*                                      will be bypassed for this        00364000
*                                      resource.                     */ 00365000
*  ,    5 Cnfp_InputFlags char(2)   /*                               */ 00366000
*  ,      7 Cnfp_System bit(1)      /* When 1, the exit routine is      00367000
*                                      being called for the             00368000
*                                      ISGCNFXITSYSTEM entry point.     00369000
*                                      When 0, the exit routine is      00370000
*                                      being called for the             00371000
*                                      ISGCNFXITSYSPLEX entry point. */ 00372000
*  ,      7 Cnfp_ContentionStart bit(1) /* When 1, this exit is being   00373000
*                                      called for a start of            00374000
*                                      contention event          @L1A*/ 00375000
*  ,      7 Cnfp_ContentionChange bit(1) /* When 1, this exit is being  00376000
*                                      called for a change of           00377000
*                                      contention event          @L1A*/ 00378000
*  ,      7 Cnfp_ContentionEnd bit(1) /* When 1, this exit is being     00379000
*                                      called for a end of              00380000
*                                      contention event          @L1A*/ 00381000
*  ,      7 Cnfp_RequestDataAvailable bit(1) /* When 1, the fields      00382000
*                                      in Cnfp_RequestData are valid.   00383000
*                                      This bit is only valid when      00384000
*                                      version is Cnfp_kVersion#2       00385000
*                                      and above.                @L1A*/ 00386000
* /* +10x------------------------------------------------------------*/ 00387000
*  ,  3 Cnfp_Qname@ ptr(31)         /* Pointer to resource Qname     */ 00388000
*  ,  3 Cnfp_Rname@ ptr(31)         /* Pointer to resource Rname     */ 00389000
*  ,  3 Cnfp_RLen fixed(32)         /* Length of resource Rname      */ 00390000
*  ,  3 * char(4)                   /* Reserved                  @L1C*/ 00391000
* /*******************************************************************/ 00392000
* /* Fields below this line only available with version 2 and higher */ 00393000
* /************************************************************* @L1A*/ 00394000
*  ,  3 Cnfp_RequestData            /* ENQ/DEQ request state            00395000
*                                      information, these values        00396000
*                                      cannot be changed.               00397000
*                                      These fields are only available  00398000
*                                      when Cnfp_RequestDataAvailable   00399000
*                                      is set.                   @L1A*/ 00400000
* /* +20x------------------------------------------------------------*/ 00401000
*  ,    5 Cnfp_RscToken char(32)    /* Token uniquely identifying       00402000
*                                      the resource.                    00403000
*                                      The token represents             00404000
*                                      the local systems view of the    00405000
*                                      resource and expires when no     00406000
*                                      requests for the resource        00407000
*                                      remain. Additionally, in Star    00408000
*                                      mode the token expires when      00409000
*                                      the local system no longer has   00410000
*                                      interest in (i.e. requests for)  00411000
*                                      the resource.             @L1A*/ 00412000
* /* +40x------------------------------------------------------------*/ 00413000
*  ,    5 Cnfp_ENQToken char(32)    /* Token uniquely identifying       00414000
*                                      the queued request to the        00415000
*                                      resource.                 @L1P*/ 00416000
* /* +60x------------------------------------------------------------*/ 00417000
*  ,    5 Cnfp_RD_RequestToken char(16) /* Unique token identifying     00418000
*                                      the GRS exit call processing for 00419000
*                                      the request. If needed, all      00420000
*                                      exits driven for this request    00421000
*                                      can use this token to identify   00422000
*                                      the same request.  See the       00423000
*                                      prologue for more information.   00424000
*                                                                @L1P*/ 00425000
* /* +70x------------------------------------------------------------*/ 00426000
*  ,    5 RequestFlags bit(8)       /* Flags about request       @L1P*/ 00427000
*  ,        9 Cnfp_EndOfTask bit(1) /* When 1, this contention          00428000
*                                      event is a result of task        00429000
*                                      termination.                     00430000
*                                      Note that the only RequestData   00431000
*                                      fields that are valid when       00432000
*                                      Cnfp_EndOfTask is set are        00433000
*                                      the above tokens, the ASCB,      00434000
*                                      TCB, and final scope. All others 00435000
*                                      are not applicable nor set.      00436000
*                                                                @L1A*/ 00437000
*  ,        9 Cnfp_EndOfMemory bit(1) /* When 1, this contention        00438000
*                                      event is a result of address     00439000
*                                      space termination.               00440000
*                                      Note that the only RequestData   00441000
*                                      fields that are valid when       00442000
*                                      Cnfp_EndOfMemory is set are      00443000
*                                      the above tokens, the ASCB,      00444000
*                                      and final scope. All others      00445000
*                                      are not applicable nor set.      00446000
*                                                                @L1A*/ 00447000
*  ,        9 Cnfp_InternalRequest bit(1) /* When 1, this contention    00448000
*                                      event is a result of an internal 00449000
*                                      GRS request and is not a         00450000
*                                      direct result of ENQ/DEQ on      00451000
*                                      behalf of a caller.              00452000
*                                      Note that the only RequestData   00453000
*                                      fields that are valid when       00454000
*                                      Cnfp_InternalRequest is set are  00455000
*                                      the above tokens, the ASCB,      00456000
*                                      TCB, and final scope. All others 00457000
*                                      are not applicable nor set.      00458000
*                                                                @L1A*/ 00459000
*  ,    5 * char(7)                 /* Reserved                  @L1P*/ 00460000
*  ,    5 Cnfp_RD_Ascb@ ptr(31)     /* Pointer to requester's ASCB      00461000
*                                                                @L1P*/ 00462000
*  ,    5 Cnfp_RD_Tcb@ ptr(31)      /* Pointer to requester's TCB or    00463000
*                                      directed TCB if TCB= was         00464000
*                                      specified. Note that if          00465000
*                                      Cnfp_RD_MAsid is zero then       00466000
*                                      the request is not treated as    00467000
*                                      a MASID/MTCB request.     @L1P*/ 00468000
* /* +80x------------------------------------------------------------*/ 00469000
*  ,    5 Cnfp_RD_Scope fixed(8)    /* Final resolved request scope     00470000
*                                      after any exit and RNL changes.  00471000
*                                      See Cnfp_kScope values.   @L1P*/ 00472000
*  ,    5 Cnfp_RD_OriginalScope fixed(8) /* Scope before exit and RNL   00473000
*                                      processing.                      00474000
*                                      See Cnfp_kScope values.   @L1P*/ 00475000
*  ,    5 Cnfp_RD_Ret fixed(8)      /* Request RET value, see           00476000
*                                      Cnfp_kRET values          @L1P*/ 00477000
*  ,      7 * bit(5)                /* Unused                    @L1P*/ 00478000
*  ,      7 Cnfp_RD_Ret1 bit(1)     /* Maps to PELRET1           @L1P*/ 00479000
*  ,      7 Cnfp_RD_Ret2 bit(1)     /* Maps to PELRET2           @L1P*/ 00480000
*  ,      7 Cnfp_RD_Ret3 bit(1)     /* Maps to PELRET3           @L1P*/ 00481000
*  ,    5 * char(1)                 /* Reserved                  @L1P*/ 00482000
*  ,    5 Cnfp_RD_Ucb@ ptr(31)      /* Request UCB address after        00483000
*                                      ISGNQXIT/FAST and RNL            00484000
*                                      processing. Only valid when      00485000
*                                      Cnfp_SF1_ENQ is set. Note that   00486000
*                                      the actual device RESERVE        00487000
*                                      will not be issued when          00488000
*                                      Cnfp_SF3_Converted is set @L1P*/ 00489000
*  ,    5 Cnfp_RD_MAsid fixed(15)   /* Request MASID value.             00490000
*                                      This field might be cleared      00491000
*                                      to zero indicating the request   00492000
*                                      was not processed as a MASID     00493000
*                                      request (such as when the        00494000
*                                      targeted task was not found or   00495000
*                                      the request could be a true      00496000
*                                      owner).                   @L1P*/ 00497000
*  ,    5 Cnfp_RD_NqxitScope fixed(8) /* Scope value after ISGNQXITFAST 00498000
*                                      and ISGNQXIT processing.         00499000
*                                      A comparison with                00500000
*                                      Cnfp_RD_OriginalScope determines 00501000
*                                      if the exit changed the scope.   00502000
*                                      See Cnfp_kScope values.   @L1P*/ 00503000
*  ,    5 * char(1)                 /* Reserved                  @L1P*/ 00504000
*  ,    5 Cnfp_RD_MTcb ptr(31)      /* Request MTCB value        @L1P*/ 00505000
* /* +90x------------------------------------------------------------*/ 00506000
*  ,    5 Cnfp_RD_Jobname char(8)   /* Requester's Jobname       @L1P*/ 00507000
*  ,    5 Cnfp_RD_Sysname char(8)   /* Requester's Sysname       @L1P*/ 00508000
* /* +A0x------------------------------------------------------------*/ 00509000
*  ,    5 Cnfp_RD_NSI@ ptr(31)      /* Requester's next sequential      00510000
*                                      instruction address, when        00511000
*                                      ENQ/DEQ ends, this is address    00512000
*                                      of the next instruction in the   00513000
*                                      calling program that will be     00514000
*                                      executed                  @L1P*/ 00515000
*  ,      7 Cnfp_RD_AMode31 bit(1)  /* When set, ENQ caller is AMODE    00516000
*                                      31 or 64                  @L1P*/ 00517000
*  ,    5 Cnfp_RD_Ecb@ ptr(31)      /* Pointer to original request ECB  00518000
*                                      (set when ECB= specified on the  00519000
*                                      request)                  @L1P*/ 00520000
*  ,    5 Cnfp_StateFlags           /* ENQ/DEQ request state flags      00521000
*                                                                @L1P*/ 00522000
*  ,      7 Cnfp_StateFlags1 bit(8) /* First byte of state flags @L1P*/ 00523000
*  ,        9 Cnfp_SF1_ENQ bit(1)   /* When 1, request is ENQ/RESERVE,  00524000
*                                      when 0, request is DEQ.          00525000
*                                      If Cnfp_SF1_ISGENQ is set then   00526000
*                                      when 1, ISGENQ REQUEST=OBTAIN or 00527000
*                                      CHANGE, when 0, REQUEST=RELEASE. 00528000
*                                      See Cnfp_SF2_Change to           00529000
*                                      distinguish between ISGENQ       00530000
*                                      REQUEST=OBTAIN and               00531000
*                                      REQUEST=CHANGE.           @L1P*/ 00532000
*  ,        9 Cnfp_SF1_Authorized bit(1) /* Caller is authorized.       00533000
*                                      That is the requester was at     00534000
*                                      least one of the following:      00535000
*                                      Supervisor state, PSW key 0-7,   00536000
*                                      or APF authorized.        @L1P*/ 00537000
*  ,        9 Cnfp_SF1_MatchTask bit(1) /* When 1, request specified    00538000
*                                      MASID/MTCB. Note that if         00539000
*                                      Cnfp_RD_MAsid is zero then       00540000
*                                      the request is not treated as    00541000
*                                      a MASID/MTCB request.     @L1P*/ 00542000
*  ,        9 Cnfp_SF1_SMCorRMC bit(1)                                  00543000
*  ,          11 Cnfp_SF1_StepMustComplete bit(1) /* When 1, ENQ        00544000
*                                      request specified SMC=YES @L1P*/ 00545000
*  ,            13 Cnfp_SF1_ResetMustComplete bit(1) /* When 1, DEQ     00546000
*                                      request specified RMC=YES @L1P*/ 00547000
*  ,        9 Cnfp_SF1_Linkage bit(1) /* When 1, request is PC entered  00548000
*                                      when 0, request is SVC entered.  00549000
*                                      As ISGENQ requests are all PC    00550000
*                                      entered, this bit will be 1 for  00551000
*                                      all ISGENQ requests.      @L1P*/ 00552000
*  ,        9 Cnfp_SF1_ISGENQ bit(1) /* When 1, request is ISGENQ       00553000
*                                                                @L1P*/ 00554000
*  ,        9 Cnfp_SF1_IsgEnqCondYes bit(1) /* When 1, request is a     00555000
*                                      conditional ISGENQ request       00556000
*                                      (ISGENQ COND=YES)         @L1P*/ 00557000
*  ,        9 * bit(1)              /* Reserved                  @L1P*/ 00558000
*  ,      7 Cnfp_StateFlags2 bit(8) /* Second byte of state flags       00559000
*                                                                @L1P*/ 00560000
*  ,        9 Cnfp_SF2_Share bit(1) /* For ENQ/RESERVE requests,        00561000
*                                      when 1 request is for shared     00562000
*                                      access,                          00563000
*                                      when 0, request is for           00564000
*                                      exclusive access          @L1P*/ 00565000
*  ,        9 Cnfp_SF2_RnlEqNo bit(1) /* RNL=NO was specified on the    00566000
*                                      request                   @L1P*/ 00567000
*  ,        9 Cnfp_SF2_Change bit(1) /* When 1, request is a change     00568000
*                                      (i.e. ENQ RET=CHNG or ISGENQ     00569000
*                                      REQUEST=CHANGE).          @L1P*/ 00570000
*  ,        9 Cnfp_SF2_TEST_YES bit(1) /* When 1, ISGENQ with TEST=YES. 00571000
*                                      When 0, Not ISGENQ with TEST=YES 00572000
*                                      (i.e. TEST=NO if                 00573000
*                                      Cnfp_SF1_ISGENQ is set).  @L1P*/ 00574000
*  ,        9 Cnfp_SF2_CONTENTIONACT_FAIL bit(1) /* When 1, ISGENQ with 00575000
*                                      CONTENTIONACT=FAIL.              00576000
*                                      When 0, not CONTENTIONACT=FAIL   00577000
*                                      (i.e. CONTENTIONACT=WAIT if      00578000
*                                      Cnfp_SF1_ISGENQ is set and       00579000
*                                      Cnfp_SF2_TEST_YES is off).       00580000
*                                                                @L1P*/ 00581000
*  ,        9 Cnfp_SF2_ECB bit(1)   /* When 1, ECB keyword specified    00582000
*                                      (i.e. ISGENQ WAITTYPE=ECB or     00583000
*                                      or ENQ with ECB).                00584000
*                                      When 0, No ECB specified         00585000
*                                      (i.e. WAITTYPE=SUSPEND if        00586000
*                                      Cnfp_SF1_ISGENQ is set and       00587000
*                                      Cnfp_SF2_TEST_YES and            00588000
*                                      Cnfp_SF2_CONTENTIONACT_FAIL      00589000
*                                      are off).                 @L1P*/ 00590000
*  ,      7 Cnfp_StateFlags3 bit(8) /* Third byte of state flags @L1P*/ 00591000
*  ,        9 Cnfp_SF3_Included bit(1) /* Resource promoted to          00592000
*                                      SYSTEMS scope             @L1P*/ 00593000
*  ,        9 Cnfp_SF3_Converted bit(1) /* Resource converted from      00594000
*                                      RESERVE to SYSTEMS ENQ only.     00595000
*                                      As such, the device RESERVE      00596000
*                                      will not be issued, but          00597000
*                                      Cnfp_RD_Ucb@ will still          00598000
*                                      be set                    @L1P*/ 00599000
*  ,        9 Cnfp_SF3_Excluded bit(1) /* Resource demoted to SYSTEM    00600000
*                                      scope                     @L1P*/ 00601000
*  ,        9 Cnfp_SF3_Global bit(1) /* Resource request will be        00602000
*                                      processed globally by GRS. Note  00603000
*                                      Cnfp_SF3_Global will             00604000
*                                      always be off in GRS=NONE        00605000
*                                      mode.                     @L1P*/ 00606000
*  ,    5 * char(5)                 /* Reserved                  @L1P*/ 00607000
* /* +B0x------------------------------------------------------------*/ 00608000
*  ,  3 Cnfp_End char(0) bdy(dword)                                     00609000
*  ;                                                                    00610000
*                                                                       00611000
* /*******************************************************************/ 00612000
* /*                                                                 */ 00613000
* /*                       CNFP Constants                            */ 00614000
* /*                                                                 */ 00615000
* /*******************************************************************/ 00616000
* dcl                                                                   00617000
*    Cnfp_kId char(4) constant('CNFP') /* Eyecatcher                 */ 00618000
*   ,Cnfp_kVersion#1 fixed(8) constant(1) /* Original version           00619000
*                                            (OW53323)               */ 00620000
*   ,Cnfp_kVersion#2 fixed(8) constant(2) /* Version HBB7760     @L1A*/ 00621000
*   ,Cnfp_kCurrentVersion fixed(8) constant(Cnfp_kVersion#2) /*         00622000
*                                      Current version (same)    @L1C*/ 00623000
*   ,Cnfp_kScopeStep   constant(0)  /* Scope=Step                @L1P*/ 00624000
*   ,Cnfp_kScopeSystem constant(1)  /* Scope=System              @L1P*/ 00625000
*   ,Cnfp_kScopeSystems constant(2) /* Scope=Systems             @L1P*/ 00626000
*   ,Cnfp_kRetNone constant('00000000'b) /* Ret=None             @L1P*/ 00627000
*   ,Cnfp_kRetHave constant('00000001'b) /* Ret=Have             @L1P*/ 00628000
*   ,Cnfp_kRetChng constant('00000010'b) /* Ret=Chng             @L1P*/ 00629000
*   ,Cnfp_kRetUse constant('00000011'b) /* Ret=Use               @L1P*/ 00630000
*   ,Cnfp_kRetTest constant('00000111'b) /* Ret=Test             @L1P*/ 00631000
*   ,Cnfp_kRetEcb constant('00000100'b) /* An ECB is specified          00632000
*                                      for this ENQ request, via        00633000
*                                      either the ECB= parameter on     00634000
*                                      ENQ or the WAITTYPE=ECB          00635000
*                                      parameter on                     00636000
*                                      ISGENQ REQUEST=OBTAIN     @L1P*/ 00637000
*   ,Cnfp_kSF3Mask constant('11110000'b) /* Mask for copying from       00638000
*                                      PelXFlg1 to Cnfp_StateFlags3     00639000
*                                                                @L1P*/ 00640000
*   ;                                                                   00641000
*/* End of PL/X Source                                               */ 00642000
* %IF ISGYCNFP_LIST ^= 'NO' &                                           00643000
*    ZCBPRINT ^= 'NO' %THEN                                             00644000
*   %GOTO ISGYCNFP_4;                                                   00645000
*   @LIST POP NOECHO;                                                   00646000
* %ISGYCNFP_4:;                                                         00647000
* %END;                                                                 00648000

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWM4OPTQ                              -02/19/14-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Query Parmlib Information                     * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2015, 2015                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77A0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The purpose of this service is to return the active SRM and    * 00002100
*      WLM parmlib settings.                                          * 00002200
*                                                                     * 00002300
*      The caller of IWM4OPTQ must provide storage to contain all of  * 00002400
*      the parmlib information. This storage area must reside in the  * 00002500
*      caller's primary address space.                                * 00002600
*                                                                     * 00002700
*      It is possible that the storage required by IWM4OPTQ may       * 00002800
*      change such that multiple IWM4OPTQ calls are required to       * 00002900
*      obtain data.  IWM4OPTQ users should take this into account     * 00003000
*      when obtaining the amount of storage that the IWM4OPTQ service * 00003100
*      can use.                                                       * 00003200
*                                                                     * 00003300
*      If the caller does not provide enough storage to contain all   * 00003400
*      of the system information, this service will return a          * 00003500
*      return/reason code pair indicating that the input              * 00003600
*      OPTINFO_BLOCK is too small. Output data about the amount of    * 00003700
*      storage required (QUERYLEN) will be set to reflect the         * 00003800
*      required OPTINFO_BLOCK size.  However, no system capacity      * 00003900
*      information is returned.                                       * 00004000
*                                                                     * 00004100
*      The output of this service is a data area mapped by the        * 00004200
*      IWMWOPTI macro, that provides a point in time snapshot of the  * 00004300
*      active IEAOPTxx parmlib settings on the actual system.         * 00004400
*                                                                     * 00004500
*01* EXTERNAL CLASSIFICATION:  PSPI                                   * 00004600
*                                                                     * 00004700
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004800
*                                                                     * 00004900
*01* ENVIRONMENT:                                                     * 00005000
*                                                                     * 00005100
*                                                                     * 00005200
*      Dispatchable unit mode: Task mode.                             * 00005300
*                                                                     * 00005400
*      Minimum authorization: Problem state.  Any PSW key.            * 00005500
*                                                                     * 00005600
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00005700
*                                                                     * 00005800
*      AMODE:            31- or 64-bit.                               * 00005900
*                                                                     * 00006000
*      ASC mode:         Primary or Access Register.                  * 00006100
*                                                                     * 00006200
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006300
*                                                                     * 00006400
*      Locks:            No locks held.                               * 00006500
*                                                                     * 00006600
*      Control parameters: Control parameters must be in the primary  * 00006700
*                        address space.                               * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*01* PROGRAMMING REQUIREMENTS:                                        * 00007200
*                                                                     * 00007300
*                                                                     * 00007400
*    1.  The macro CVT must be included to use this macro.            * 00007500
*                                                                     * 00007600
*    2.  The macro IWMYCON must be included to use this macro.        * 00007700
*                                                                     * 00007800
*    3.  Note that the high order halfword of register 0, and the     * 00007900
*        reason code variable when specified, may be non-zero and     * 00008000
*        represents diagnostic data which is NOT part of the external * 00008100
*        interface.  The high order halfword should thus be excluded  * 00008200
*        from comparison with the reason code values described above. * 00008300
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00008400
*        be used for this purpose.                                    * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*01* RESTRICTIONS:                                                    * 00008900
*                                                                     * 00009000
*                                                                     * 00009100
*    1.  This macro may not be used prior to the completion of WLM    * 00009200
*        address space initialization.                                * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*                                                                     * 00009600
*01* INPUT REGISTER INFORMATION:                                      * 00009700
*                                                                     * 00009800
*    Before issuing the IWM4OPTQ macro, the caller does not have to   * 00009900
*    place any information into any register unless using it in       * 00010000
*    register notation for a particular parameter, or using it as a   * 00010100
*    base register.                                                   * 00010200
*                                                                     * 00010300
*01* OUTPUT REGISTER INFORMATION:                                     * 00010400
*                                                                     * 00010500
*    When control returns to the caller, the GPRs contain:            * 00010600
*                                                                     * 00010700
*                                                                     * 00010800
*    REGISTER  CONTENTS                                               * 00010900
*                                                                     * 00011000
*    0         Reason code if GR15 return code is non-zero            * 00011100
*                                                                     * 00011200
*    1         Used as work register by the system                    * 00011300
*                                                                     * 00011400
*    2-13      Unchanged                                              * 00011500
*                                                                     * 00011600
*    14        Used as work registers by the system                   * 00011700
*                                                                     * 00011800
*    15        Return code                                            * 00011900
*                                                                     * 00012000
*                                                                     * 00012100
*                                                                     * 00012200
*    When control returns to the caller, the ARs contain:             * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*    REGISTER  CONTENTS                                               * 00012600
*                                                                     * 00012700
*    0-1       Used as work registers by the system                   * 00012800
*                                                                     * 00012900
*    2-13      Unchanged                                              * 00013000
*                                                                     * 00013100
*    14-15     Used as work registers by the system                   * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*    Some callers depend on register contents remaining the same      * 00013600
*    before and after issuing a service.  If the system changes the   * 00013700
*    contents of registers on which the caller depends, the caller    * 00013800
*    must save them before issuing the service, and restore them      * 00013900
*    after the system returns control.                                * 00014000
*                                                                     * 00014100
*01* PERFORMANCE IMPLICATIONS:                                        * 00014200
*                                                                     * 00014300
*    None                                                             * 00014400
*                                                                     * 00014500
*01* SYNTAX:                                                          * 00014600
*                                                                     * 00014700
*Ýxlabel¨  IWM4OPTQ     OPTINFO_BLOCK                                 * 00014800
*                                     =xoptinfo_block                 * 00014900
*                      ,ANSLEN=xanslen                                * 00015000
*                      ,QUERYLEN=xquerylen                            * 00015100
*                     Ý,RETCODE=xretcode¨                             * 00015200
*                     Ý,RSNCODE=xrsncode¨                             * 00015300
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00015400
*                    ÐÝ,MF=S¨                                         * 00015500
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00015600
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00015700
*                                                                     * 00015800
*                                                                     * 00015900
*      Where:                                                         * 00016000
*                                                                     * 00016100
*                                                                     * 00016200
*      Ýxlabel¨                                                       * 00016300
*          is an optional symbol, starting in column 1, that is the   * 00016400
*          name on the IWM4OPTQ macro invocation.  The name must      * 00016500
*          conform to the rules for an ordinary assembler language    * 00016600
*          symbol.                                                    * 00016700
*          DEFAULT: No name.                                          * 00016800
*                                                                     * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*      OPTINFO_BLOCK=xoptinfo_block                                   * 00017300
*          is the name (RS-type), or address in register (2)-(12), of * 00017400
*          a required character input of an output area to contain    * 00017500
*          information provided by this service.  The format of this  * 00017600
*          area is mapped by IWMWOPTI and should only be considered   * 00017700
*          valid upon return code zero from this service.             * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*      ANSLEN=xanslen                                                 * 00018300
*          is the name (RS-type), or address in register (2)-(12), of * 00018400
*          a required fullword input which contains the length of the * 00018500
*          OPT_BLOCK in bytes.                                        * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*      QUERYLEN=xquerylen                                             * 00019100
*          is the name (RS-type), or address in register (2)-(12), of * 00019200
*          a required fullword output variable which contains the     * 00019300
*          output area size that must be provided by the caller to    * 00019400
*          contain all of the active systems in the sysplex that are  * 00019500
*          in goal mode (i.e. the amount of data returned by the      * 00019600
*          IWM4OPTQ service).                                         * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*      ÝRETCODE=xretcode¨                                             * 00020200
*          is the name (RS-type) of an optional fullword output       * 00020300
*          variable, or register (2)-(12) or (15), into which the     * 00020400
*          return code is to be copied from GPR 15.  If you specify   * 00020500
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00020600
*          the value will be left in GPR 15.                          * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*      ÝRSNCODE=xrsncode¨                                             * 00021200
*          is the name (RS-type) of an optional fullword output       * 00021300
*          variable into which the reason code is to be copied from   * 00021400
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00021500
*          R0 (within or without parentheses), the value will be left * 00021600
*          in GPR 0.                                                  * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*                                                                     * 00022000
*                                                                     * 00022100
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00022200
*          is an optional byte input decimal value in the "0-0" range * 00022300
*          that specifies the macro version.  PLISTVER is the only    * 00022400
*          key allowed on the list form of MF and determines which    * 00022500
*          parameter list is generated.  Note that MAX may be         * 00022600
*          specified instead of a number, and the parameter list will * 00022700
*          be of the largest size currently supported. This size may  * 00022800
*          grow from release to release (thus possibly affecting the  * 00022900
*          amount of storage needed by your program).  If your        * 00023000
*          program can tolerate this, IBM recommends that you always  * 00023100
*          specify MAX when creating the list form parameter list as  * 00023200
*          that will ensure that the list form parameter list is      * 00023300
*          always long enough to hold whatever parameters might be    * 00023400
*          specified on the execute form.                             * 00023500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00023600
*          default is the lowest version which allows all of the      * 00023700
*          parameters specified on the invocation to be processed.    * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*      ÝMF=»S!L!Eº¨                                                   * 00024300
*          is an optional keyword input which specifies the macro     * 00024400
*          form.                                                      * 00024500
*          DEFAULT: S                                                 * 00024600
*                                                                     * 00024700
*                                                                     * 00024800
*          ÝMF=S¨                                                     * 00024900
*              specifies the standard form of the macro.  The "S"     * 00025000
*              form generates code to put the parameters into an      * 00025100
*              in-line parameter list and invoke the desired service. * 00025200
*              Full checking for required macro keys is done along    * 00025300
*              with supplying defaults for omitted optional           * 00025400
*              parameters.                                            * 00025500
*                                                                     * 00025600
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00025700
*              specifies the list form of the macro.  The "L" form    * 00025800
*              defines an area to be used for the parameter list.     * 00025900
*              Only the PLISTVER key may be specified on the          * 00026000
*              invocation.  All other macro parameters are flagged as * 00026100
*              errors.  If PLISTVER is not specified, the original    * 00026200
*              parameter list definition is used.                     * 00026300
*                                                                     * 00026400
*            ,xmfctrl                                                 * 00026500
*              is a required input.  It is the name of a storage area * 00026600
*              for the parameter list.                                * 00026700
*                                                                     * 00026800
*            »,xmfattr!0Dº                                            * 00026900
*              is an optional 60 character input string that varies   * 00027000
*              from 1 to 60 characters. Use it to force boundary      * 00027100
*              alignment of the parameter list. Use only 0F or 0D.    * 00027200
*              DEFAULT: 0D which forces the parameter list to a       * 00027300
*              doubleword boundary.                                   * 00027400
*                                                                     * 00027500
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00027600
*              specifies the execute form of the macro.  The "E" form * 00027700
*              generates code to put the parameters into the          * 00027800
*              parameter list specified by xmfctrl and provides full  * 00027900
*              syntax checking with default setting.                  * 00028000
*                                                                     * 00028100
*            ,xmfctrl                                                 * 00028200
*              is a required input.  It is the name (RS-type), or     * 00028300
*              address in register (1)-(12), of a storage area for    * 00028400
*              the parameter list.                                    * 00028500
*                                                                     * 00028600
*            »,COMPLETEº                                              * 00028700
*              is an optional keyword input which specifies the       * 00028800
*              degree of macro parameter syntax checking.             * 00028900
*              DEFAULT: COMPLETE                                      * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*              COMPLETE                                               * 00029300
*                  Checking for required macro keys is done and       * 00029400
*                  defaults are supplied for omitted optional         * 00029500
*                  parameters.                                        * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*01* ABEND CODES:  None.                                              * 00030400
*                                                                     * 00030500
*01* RETURN CODES:                                                    * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*            0    Name: IwmRetCodeOk                                  * 00030900
*                                                                     * 00031000
*                 Meaning: Successful completion.                     * 00031100
*                                                                     * 00031200
*                 Action: None required.                              * 00031300
*                                                                     * 00031400
*            4    Name: IwmRetCodeWarning                             * 00031500
*                                                                     * 00031600
*                 Meaning: Successful completion, unusual conditions  * 00031700
*                 noted.                                              * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                 HEX REASON  MEANING/ACTION                          * 00032100
*                 CODE                                                * 00032200
*                                                                     * 00032300
*                 xxxx040A    Name: IwmRsnCodeOutputAreaTooSmall      * 00032400
*                                                                     * 00032500
*                             Meaning:  The output area supplied is   * 00032600
*                             too small to receive all the available  * 00032700
*                             information.                            * 00032800
*                                                                     * 00032900
*                             Action: None required.  If necessary,   * 00033000
*                             reinvoke the service with an output     * 00033100
*                             area of sufficient size (returned in    * 00033200
*                             QUERYLEN) to receive all information.   * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*            8    Name: IwmRetCodeInvocError                          * 00033700
*                                                                     * 00033800
*                 Meaning: Invalid invocation environment or          * 00033900
*                 parameters.                                         * 00034000
*                                                                     * 00034100
*                                                                     * 00034200
*                 HEX REASON  MEANING/ACTION                          * 00034300
*                 CODE                                                * 00034400
*                                                                     * 00034500
*                 xxxx0801    Name: IwmRsnCodeSrbMode                 * 00034600
*                                                                     * 00034700
*                             Meaning: Caller is in SRB mode.         * 00034800
*                                                                     * 00034900
*                             Action: Avoid requesting this function  * 00035000
*                             while in SRB mode.                      * 00035100
*                                                                     * 00035200
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00035300
*                                                                     * 00035400
*                             Meaning: Caller is disabled.            * 00035500
*                                                                     * 00035600
*                             Action: Avoid requesting this function  * 00035700
*                             while disabled.                         * 00035800
*                                                                     * 00035900
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00036000
*                                                                     * 00036100
*                             Meaning: Caller is locked.              * 00036200
*                                                                     * 00036300
*                             Action: Avoid requesting this function  * 00036400
*                             while locked.                           * 00036500
*                                                                     * 00036600
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00036700
*                                                                     * 00036800
*                             Meaning:  Error accessing parameter     * 00036900
*                             list.                                   * 00037000
*                                                                     * 00037100
*                             Action: Check for possible storage      * 00037200
*                             overlay.                                * 00037300
*                                                                     * 00037400
*                 xxxx0823    Name: IwmRsnCodeDatoff                  * 00037500
*                                                                     * 00037600
*                             Meaning: Caller invoked service while   * 00037700
*                             DATOFF                                  * 00037800
*                                                                     * 00037900
*                             Action: Avoid requesting this function  * 00038000
*                             in this environment.                    * 00038100
*                                                                     * 00038200
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 00038300
*                                                                     * 00038400
*                             Meaning: Caller invoked service but was * 00038500
*                             in 24 bit addressing mode.              * 00038600
*                                                                     * 00038700
*                             Action: Request this function only when * 00038800
*                             you are in 31 bit addressing mode.      * 00038900
*                                                                     * 00039000
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00039100
*                                                                     * 00039200
*                             Meaning: Version number in parameter    * 00039300
*                             list is not valid or the length         * 00039400
*                             specified is incorrect.                 * 00039500
*                                                                     * 00039600
*                             Action: Check for possible storage      * 00039700
*                             overlay of the parameter list.          * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*            10   Name: IwmRetCodeCompError                           * 00040200
*                                                                     * 00040300
*                 Meaning: Component error.                           * 00040400
*                                                                     * 00040500
*                 Action: No action required.  The function may be    * 00040600
*                 successful if invoked again.                        * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*01* REASON CODES:                                                    * 00041100
*                                                                     * 00041200
*       A unique reason code will be returned whenever the return     * 00041300
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00041400
*       under their corresponding return code.  Reason code and       * 00041500
*       return code constants are defined within IWMYCON.  Note that  * 00041600
*       the high order halfword of register 0, and the reason code    * 00041700
*       variable when specified, may be non-zero and represents       * 00041800
*       diagnostic data which is NOT part of the external interface.  * 00041900
*       The high order halfword should thus be excluded from          * 00042000
*       comparison with the reason code values described above.  The  * 00042100
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00042200
*       used for this purpose.                                        * 00042300
*                                                                     * 00042400
*01* MODULE TYPE:  ASSEM MACRO                                        * 00042500
*                                                                     * 00042600
*02*   PROCESSOR:  ASSEM                                              * 00042700
*                                                                     * 00042800
*01* COMPONENT:  SCWLM                                                * 00042900
*                                                                     * 00043000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00043100
*                                                                     * 00043200
*01* EXAMPLES:                                                        * 00043300
*                                                                     * 00043400
*    To query system information:                                     * 00043500
*                                                                     * 00043600
*      IWM4OPTQ OPTINFO_BLOCK=OPTINF,ANSLEN=ANSLEN,           X       * 00043700
*            QUERYLEN=QUERYLEN,RETCODE=RC,RSNCODE=RSN                 * 00043800
*                                                                     * 00043900
*    Where the following are declared:                                * 00044000
*                                                                     * 00044100
*      OPTINF   DS    F OPTINFO_BLOCK address                         * 00044200
*      ANSLEN   DS    F Length of the OPTINFO_BLOCK area              * 00044300
*      QUERYLEN DS    F Query length                                  * 00044400
*      RC       DS    F Return code                                   * 00044500
*      RSN      DS    F Reason code                                   * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*01* MACRO USAGE NOTES:                                               * 00044900
*                                                                     * 00045000
*                                                                     * 00045100
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00045200
*        global macro variable.  Any value other than 'NO' will       * 00045300
*        result in the macro expansion being printed.  The default is * 00045400
*        'YES'.  The following examples illustrate how the ZPRINT     * 00045500
*        variable should be set.                                      * 00045600
*                                                                     * 00045700
*                    GBLC &ZPRINT                                     * 00045800
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00045900
*                                                                     * 00046000
*                                                                     * 00046100
*    2.  All   keys   currently   contained  in  the  IWM4OPTQ  macro * 00046200
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00046300
*        value of 0 or MAX.                                           * 00046400
*                                                                     * 00046500
*                                                                     * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*01* CHANGE ACTIVITY:                                                 * 00046900
*                                                                     * 00047000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00047100
*                                                                     * 00047200
*    $L0=PCOPTQ   HBB77A0 121130 3241AH:  New service query parmlib   * 00047300
*                                         option information.         * 00047400
****** END OF SPECIFICATIONS *****************************************/ 00047500
*/********************************************************************* 00047600
         MACRO                                                          00047700
&XLABEL  IWM4OPTQ &OPTINFO_BLOCK=,&ANSLEN=,&QUERYLEN=,&RETCODE=,       *00047800
               &RSNCODE=,&PLISTVER=,&MF=                                00047900
.*                                                                      00048000
*                   MACDATE -02/19/14-<0>                               00048100
.*                                                                      00048200
.*******************************************************************    00048300
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00048400
.*******************************************************************    00048500
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00048600
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00048700
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00048800
.*                                                                      00048900
                   GBLC  &ZIWM4OPTQ  YES=MACRO USED AT LEAST ONCE       00049000
.*******************************************************************    00049100
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00049200
.*******************************************************************    00049300
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00049400
                   LCLC  &ZCNDX      SYSNDX CHARACTERS                  00049500
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00049600
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00049700
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00049800
                   LCLA  &ZAWRK      USED AS A WORK AREA                00049900
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00050000
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00050100
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00050200
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00050300
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00050400
                   LCLC  &ZMAC_G     "G" or null                        00050500
&ZMAC_G            SETC  ''                                             00050600
                   LCLC  &ZMAC_LR                                       00050700
&ZMAC_LR           SETC  'LR'                                           00050800
                   LCLC  &ZMAC_L                                        00050900
&ZMAC_L            SETC  'L'                                            00051000
                   LCLC  &ZMAC_ST                                       00051100
&ZMAC_ST           SETC  'ST'                                           00051200
                   LCLC  &ZMAC_LLGT                                     00051300
&ZMAC_LLGT         SETC  'L'                                            00051400
                   LCLC  &ZMAC_LGR                                      00051500
&ZMAC_LGR          SETC  'LR'                                           00051600
                   LCLC  &ZMAC_LG                                       00051700
&ZMAC_LG           SETC  'L'                                            00051800
                   LCLC  &ZMAC_STG                                      00051900
&ZMAC_STG          SETC  'ST'                                           00052000
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00052100
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00052200
.*                                                                      00052300
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00052400
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00052500
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00052600
                   LCLC  &ZENDBASEPL            End of base PL          00052700
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00052800
.*******************************************************************    00052900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00053000
.*******************************************************************    00053100
                   LCLA  &ZI         INDEX FOR ARRAY                    00053200
                   LCLA  &ZJ         INDEX FOR PARMS                    00053300
                   LCLA  &ZK         INDEX FOR PARSE                    00053400
                   LCLA  &ZLO        LOW RANGE VALUE                    00053500
                   LCLA  &ZHI        HIGH RANGE VALUE                   00053600
                   LCLC  &ZW         WORK AREA FOR PARM                 00053700
.********************************************************************   00053800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00053900
.********************************************************************   00054000
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00054100
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00054200
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00054300
                   GBLC  &SYSAM64    SYSSTATE AMODE64                   00054400
.*                                                                      00054500
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00054600
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00054700
                   SPLEVEL  TEST                                        00054800
.ZSYS2             ANOP  ,                                              00054900
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00055000
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00055100
                   SYSSTATE TEST                                        00055200
                   AGO   .ZSYS4                                         00055300
.ZSYS3             ANOP  ,                                              00055400
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00055500
.ZSYS4             ANOP  ,                                              00055600
                   AIF   ('&SYSAM64' NE 'YES').ZSYSN64                  00055700
&ZMAC_LLGT         SETC 'LLGT'                                          00055800
&ZMAC_LGR          SETC 'LGR'                                           00055900
&ZMAC_LG           SETC 'LG'                                            00056000
&ZMAC_STG          SETC 'STG'                                           00056100
.ZSYSN64           ANOP  ,                                              00056200
&ZMAC_G            SETC 'G'                                             00056300
&ZMAC_LR           SETC 'LGR'                                           00056400
&ZMAC_L            SETC 'LG'                                            00056500
&ZMAC_ST           SETC 'STG'                                           00056600
.*******************************************************************    00056700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00056800
.*******************************************************************    00056900
                   LCLC  &XOPTINFO_BLOCK        ++ NAME                 00057000
                   LCLC  &XANSLEN    ++ NAME                            00057100
                   LCLC  &XQUERYLEN  ++ NAME                            00057200
                   LCLC  &XRETCODE   ++ NAME                            00057300
                   LCLC  &XRSNCODE   ++ NAME                            00057400
                   LCLA  &XPLISTVER  ++ VALUE                           00057500
                   LCLC  &XMF        ++ VALUE                           00057600
                   LCLC  &XMFCTRL    ++ NAME                            00057700
                   LCLC  &XMFATTR    ++ VALUE                           00057800
                   LCLC  &XMFSCK     ++ VALUE                           00057900
.*******************************************************************    00058000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00058100
.*******************************************************************    00058200
                   LCLC  &ZXOPTINFO_BLOCK       ++ INPUT NAME           00058300
                   LCLC  &ZXANSLEN   ++ INPUT NAME                      00058400
                   LCLC  &ZXQUERYLEN            ++ OUTPUT NAME          00058500
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00058600
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00058700
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00058800
                   LCLC  &ZXMF       ++ INPUT VALUE                     00058900
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00059000
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00059100
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00059200
.********************************************************************   00059300
.***AC.PLV01  PROCESS PLISTVER                                      *   00059400
.********************************************************************   00059500
&XPLISTVER      SETA  0                                                 00059600
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00059700
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00059800
&XPLISTVER      SETA  0                                                 00059900
.ZPLV0          ANOP  ,                                                 00060000
.*                                                                      00060100
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00060200
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00060300
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00060400
.*-------------------------------------------------------------------   00060500
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00060600
&ZMS            SETC  '"PLISTVER='                                      00060700
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00060800
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00060900
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00061000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00061100
                AGO   .ZPVCK2                                           00061200
.ZPVCK3         ANOP  ,                                                 00061300
.*-------------------------------------------------------------------   00061400
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00061500
&ZMS            SETC  '"PLISTVER='                                      00061600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00061700
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00061800
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00061900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00062000
                AGO   .ZPVCKE                                           00062100
.ZPVCK2         ANOP  ,                                                 00062200
.*-------------------------------------------------------------------   00062300
&ZCVAL          SETC  '&PLISTVER(1)'                                    00062400
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00062500
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00062600
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00062700
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00062800
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00062900
.ZPVCK6         ANOP  ,                                                 00063000
&ZMS            SETC  '"PLISTVER='                                      00063100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00063200
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00063300
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00063400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00063500
&XPLISTVER      SETA  0                                                 00063600
                AGO   .ZPVCKE                                           00063700
.*-------------------------------------------------------------------   00063800
.ZPVCK4A        ANOP  ,                                                 00063900
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00064000
&ZMS            SETC  'PLISTVER='                                       00064100
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00064200
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00064300
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00064400
                MNOTE 8,' &ZMS IS REQUIRED.'                            00064500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00064600
                AGO   .ZPVCK5                                           00064700
.ZPVCK4         ANOP  ,                                                 00064800
&XPLISTVER      SETA  &PLISTVER(1)                                      00064900
.ZPVCK5         ANOP  ,                                                 00065000
.ZPVCKE         ANOP  ,                                                 00065100
.********************************************************************   00065200
.***AG.MF01 PROCESS MF MACRO FORMS                                      00065300
.********************************************************************   00065400
                   ACTR  10000                                          00065500
.*------------------------------------------------------------------    00065600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00065700
&XMF               SETC  ''          INITIALIZE XVARIABLE               00065800
.*-------------------------------------------------------------------   00065900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00066000
.ZG21              ANOP  ,                                              00066100
&ZTLC              SETC 'S'                                             00066200
                   AIF   ('&MF(1)' NE '&ZTLC').ZG22                     00066300
&XMF               SETC  'S'         SET KEYWORD                        00066400
                   AIF   (N'&MF LE 1).ZG21A     CK NUM                  00066500
&ZMS               SETC  '"MF='                                         00066600
&ZMS               SETC  '&ZMS.&MF"'                                    00066700
&ZMS               SETC  '&ZMS "MF"'                                    00066800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00066900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00067000
.ZG21A             ANOP  ,                                              00067100
.*-------------------------------------------------------------------   00067200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067300
.ZG22              ANOP  ,                                              00067400
&ZTLC              SETC 'L'                                             00067500
                   AIF   ('&MF(1)' NE '&ZTLC').ZG29                     00067600
&XMF               SETC  'L'         SET KEYWORD                        00067700
                   AIF   (N'&MF LE 3).ZG22A     CK NUM                  00067800
&ZMS               SETC  '"MF='                                         00067900
&ZMS               SETC  '&ZMS.&MF"'                                    00068000
&ZMS               SETC  '&ZMS "MF"'                                    00068100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00068200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00068300
.ZG22A             ANOP  ,                                              00068400
.*-------------------------------------------------------------------   00068500
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00068600
                   AIF   (N'&SYSLIST NE 0).ZG22B  POSITIONALS?          00068700
                   AIF   ('&OPTINFO_BLOCK' NE '').ZG22B  KEYS?          00068800
                   AIF   ('&ANSLEN' NE '').ZG22B  KEYS?                 00068900
                   AIF   ('&QUERYLEN' NE '').ZG22B  KEYS?               00069000
                   AIF   ('&RETCODE' NE '').ZG22B  KEYS?                00069100
                   AIF   ('&RSNCODE' NE '').ZG22B  KEYS?                00069200
                   AGO    .ZG22C     INVOCATION OKAY                    00069300
.ZG22B             ANOP  ,                                              00069400
&ZMS               SETC  'THE "L" FORM OF "MF"'                         00069500
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00069600
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00069700
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00069800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00069900
.ZG22C             ANOP  ,                                              00070000
.*-------------------------------------------------------------------   00070100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00070200
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00070300
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00070400
                   AIF   (N'&MF(2) GT 1).ZG24B  MULTI                   00070500
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00070600
.ZG24B             AIF   (K'&MF(2) GT 0).ZG24C                          00070700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00070800
&ZMS               SETC  'WHEN "L" IS SPECIFIED'                        00070900
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00071000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00071100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00071200
.ZG24C             ANOP  ,                                              00071300
.*-------------------------------------------------------------------   00071400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00071500
                   AIF   (K'&ZXMFCTRL LE 0).ZG24P  NOT I/O              00071600
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG24P                 00071700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00071800
&ZMS               SETC  '"MF='                                         00071900
&ZMS               SETC  '&ZMS.&MF"'                                    00072000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00072100
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00072200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00072300
.ZG24P             ANOP  ,                                              00072400
.*-------------------------------------------------------------------   00072500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00072600
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00072700
&XMFATTR           SETC  '0D'                                           00072800
                   AIF   (K'&MF(3) LE 0).ZG27B  PARM                    00072900
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00073000
                   AIF   (N'&MF(3) GT 1).ZG27B  MULTI                   00073100
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00073200
.ZG27B             ANOP  ,                                              00073300
.*-------------------------------------------------------------------   00073400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00073500
                   AIF   (K'&ZXMFATTR LE 0).ZG27P  NOT I/O              00073600
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG27P                 00073700
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00073800
&ZMS               SETC  '"MF='                                         00073900
&ZMS               SETC  '&ZMS.&MF"'                                    00074000
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00074100
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00074200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00074300
.ZG27P             ANOP  ,                                              00074400
.*-------------------------------------------------------------------   00074500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00074600
                   AIF   (K'&ZXMFATTR LE 0).ZG27S  NOT I/O              00074700
                   AIF   (K'&XMFATTR LE 60).ZG27S  LNG OK               00074800
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00074900
&ZMS               SETC  '"MF='                                         00075000
&ZMS               SETC  '&ZMS.&MF"'                                    00075100
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00075200
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00075300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00075400
.ZG27S             ANOP  ,                                              00075500
.*-------------------------------------------------------------------   00075600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075700
.ZG29              ANOP  ,                                              00075800
&ZTLC              SETC 'E'                                             00075900
                   AIF   ('&MF(1)' NE '&ZTLC').ZG37                     00076000
&XMF               SETC  'E'         SET KEYWORD                        00076100
                   AIF   (N'&MF LE 3).ZG29A     CK NUM                  00076200
&ZMS               SETC  '"MF='                                         00076300
&ZMS               SETC  '&ZMS.&MF"'                                    00076400
&ZMS               SETC  '&ZMS "MF"'                                    00076500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00076600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00076700
.ZG29A             ANOP  ,                                              00076800
.*-------------------------------------------------------------------   00076900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00077000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00077100
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00077200
                   AIF   (N'&MF(2) GT 1).ZG31B  MULTI                   00077300
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00077400
.ZG31B             AIF   (K'&MF(2) GT 0).ZG31C                          00077500
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00077600
&ZMS               SETC  'WHEN "E" IS SPECIFIED'                        00077700
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00077800
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00077900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00078000
.ZG31C             ANOP  ,                                              00078100
.*-------------------------------------------------------------------   00078200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00078300
                   AIF   (K'&ZXMFCTRL LE 0).ZG31R  NOT I/O              00078400
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG31R                 00078500
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00078600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                   00078700
                   AIF   (K'&ZCGPR GT 2).ZG31Q                          00078800
                   AIF   ('&ZCGPR' EQ '0').ZG31Q                        00078900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00079000
                   AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME      00079100
.ZG31P             ANOP  ,                                              00079200
                   AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC           00079300
                   AIF   ('&ZCGPR' LT '1').ZG31Q                        00079400
                   AIF   ('&ZCGPR' LE '12').ZG31R                       00079500
.ZG31Q             ANOP  ,                                              00079600
&ZMS               SETC  '"MF='                                         00079700
&ZMS               SETC  '&ZMS.&MF"'                                    00079800
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00079900
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00080000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00080100
.ZG31R             ANOP  ,                                              00080200
.*-------------------------------------------------------------------   00080300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00080400
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00080500
.ZG35A   AIF   ('&MF(3)' NE 'COMPLETE').ZG36A                           00080600
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00080700
.*-------------------------------------------------------------------   00080800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00080900
.ZG36A             AIF   (K'&XMFSCK GT 0).ZG36C  KEYWORD                00081000
                   AIF   (K'&MF(3) LE 0).ZG36B                          00081100
&ZMS               SETC  '"MF='                                         00081200
&ZMS               SETC  '&ZMS.&MF"'                                    00081300
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00081400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00081500
&ZMS               SETC  '&ZMS "COMPLETE".'                             00081600
                   MNOTE 8,' &ZMS '                                     00081700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00081800
.ZG36B             ANOP  ,                                              00081900
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00082000
.ZG36C             ANOP  ,                                              00082100
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00082200
.*------------------------------------------------------------------    00082300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00082400
.ZG37              ANOP  ,                                              00082500
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00082600
                   AIF   (K'&XMF GT 0).ZG37E    VALID ARG               00082700
                   AIF   (T'&MF EQ 'O').ZG37D   OMITTED                 00082800
&ZASYSLNDX         SETA  0                                              00082900
.ZG37A             ANOP  ,           POSITIONAL MACRO KEY               00083000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00083100
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG37C               00083200
&ZTLC              SETC 'MF'                                            00083300
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG37A      00083400
.ZG37B             ANOP  ,                                              00083500
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00083600
&ZMS               SETC  'THE "MF" KEY'                                 00083700
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00083800
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00083900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00084000
                   AGO   .ZG37E                                         00084100
.ZG37C             ANOP  ,                                              00084200
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00084300
&ZMS               SETC  '"MF='                                         00084400
&ZMS               SETC  '&ZMS.&MF"'                                    00084500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00084600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00084700
&ZMS               SETC  '&ZMS "S",'                                    00084800
&ZMS               SETC  '&ZMS "L",'                                    00084900
&ZMS               SETC  '&ZMS OR "E".'                                 00085000
                   MNOTE 8,' &ZMS '                                     00085100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00085200
                   AGO   .ZG37E                                         00085300
.ZG37D             ANOP  ,                                              00085400
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00085500
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00085600
.ZG37E             ANOP  ,                                              00085700
.********************************************************************   00085800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00085900
.********************************************************************   00086000
                   ACTR  10000                                          00086100
.*-------------------------------------------------------------------   00086200
.***AG.MF03 MF=(SLE)                                                    00086300
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00086400
.*----------------------------------------------------------------***   00086500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00086600
                   AIF   (N'&OPTINFO_BLOCK LE 1).ZG2A  CK NUM           00086700
&ZMS               SETC  '"OPTINFO_BLOCK='                              00086800
&ZMS               SETC  '&ZMS.&OPTINFO_BLOCK"'                         00086900
&ZMS               SETC  '&ZMS "OPTINFO_BLOCK"'                         00087000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00087100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00087200
.ZG2A              ANOP  ,                                              00087300
.*-------------------------------------------------------------------   00087400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00087500
&ZXOPTINFO_BLOCK   SETC  'INPUT'     SET IN/OUTPUT                      00087600
&XOPTINFO_BLOCK    SETC  '&OPTINFO_BLOCK(1)'    SET XVARIABLE           00087700
                   AIF   (N'&OPTINFO_BLOCK GT 1).ZG2B  MULTI            00087800
&XOPTINFO_BLOCK    SETC  '&OPTINFO_BLOCK'       SET XVARIABLE           00087900
.ZG2B              AIF   (K'&OPTINFO_BLOCK(1) GT 0).ZG2C                00088000
&ZXOPTINFO_BLOCK   SETC  ''          RESET IN/OUTPUT                    00088100
&ZMS               SETC  ' '                                            00088200
&ZMS               SETC  '&ZMS "OPTINFO_BLOCK" KEY AND ITS'             00088300
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00088400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00088500
.ZG2C              ANOP  ,                                              00088600
.*-------------------------------------------------------------------   00088700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00088800
                   AIF   (K'&ZXOPTINFO_BLOCK LE 0).ZG2R  NOT I/O        00088900
                   AIF   ('&XOPTINFO_BLOCK'(1,1) NE '(').ZG2R           00089000
&ZCGPR             SETC  '&XOPTINFO_BLOCK'(2,K'&XOPTINFO_BLOCK-2)       00089100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                    00089200
                   AIF   (K'&ZCGPR GT 2).ZG2Q                           00089300
                   AIF   ('&ZCGPR' EQ '0').ZG2Q                         00089400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00089500
                   AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME       00089600
.ZG2P              ANOP  ,                                              00089700
                   AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC            00089800
                   AIF   ('&ZCGPR' LT '2').ZG2Q                         00089900
                   AIF   ('&ZCGPR' LE '12').ZG2R                        00090000
.ZG2Q              ANOP  ,                                              00090100
&ZMS               SETC  '"OPTINFO_BLOCK='                              00090200
&ZMS               SETC  '&ZMS.&OPTINFO_BLOCK"'                         00090300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00090400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00090500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00090600
.ZG2R              ANOP  ,                                              00090700
.*----------------------------------------------------------------***   00090800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00090900
                   AIF   (N'&ANSLEN LE 1).ZG5A  CK NUM                  00091000
&ZMS               SETC  '"ANSLEN='                                     00091100
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00091200
&ZMS               SETC  '&ZMS "ANSLEN"'                                00091300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00091400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00091500
.ZG5A              ANOP  ,                                              00091600
.*-------------------------------------------------------------------   00091700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00091800
&ZXANSLEN          SETC  'INPUT'     SET IN/OUTPUT                      00091900
&XANSLEN           SETC  '&ANSLEN(1)'           SET XVARIABLE           00092000
                   AIF   (N'&ANSLEN GT 1).ZG5B  MULTI                   00092100
&XANSLEN           SETC  '&ANSLEN'   SET XVARIABLE                      00092200
.ZG5B              AIF   (K'&ANSLEN(1) GT 0).ZG5C                       00092300
&ZXANSLEN          SETC  ''          RESET IN/OUTPUT                    00092400
&ZMS               SETC  ' '                                            00092500
&ZMS               SETC  '&ZMS "ANSLEN" KEY AND ITS'                    00092600
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00092700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00092800
.ZG5C              ANOP  ,                                              00092900
.*-------------------------------------------------------------------   00093000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00093100
                   AIF   (K'&ZXANSLEN LE 0).ZG5R  NOT I/O               00093200
                   AIF   ('&XANSLEN'(1,1) NE '(').ZG5R                  00093300
&ZCGPR             SETC  '&XANSLEN'(2,K'&XANSLEN-2)                     00093400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                    00093500
                   AIF   (K'&ZCGPR GT 2).ZG5Q                           00093600
                   AIF   ('&ZCGPR' EQ '0').ZG5Q                         00093700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00093800
                   AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME       00093900
.ZG5P              ANOP  ,                                              00094000
                   AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC            00094100
                   AIF   ('&ZCGPR' LT '2').ZG5Q                         00094200
                   AIF   ('&ZCGPR' LE '12').ZG5R                        00094300
.ZG5Q              ANOP  ,                                              00094400
&ZMS               SETC  '"ANSLEN='                                     00094500
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00094600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00094700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00094800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00094900
.ZG5R              ANOP  ,                                              00095000
.*----------------------------------------------------------------***   00095100
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00095200
                   AIF   (N'&QUERYLEN LE 1).ZG8A  CK NUM                00095300
&ZMS               SETC  '"QUERYLEN='                                   00095400
&ZMS               SETC  '&ZMS.&QUERYLEN"'                              00095500
&ZMS               SETC  '&ZMS "QUERYLEN"'                              00095600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00095700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00095800
.ZG8A              ANOP  ,                                              00095900
.*-------------------------------------------------------------------   00096000
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00096100
&ZXQUERYLEN        SETC  'OUTPUT'    SET IN/OUTPUT                      00096200
&XQUERYLEN         SETC  '&QUERYLEN(1)'         SET XVARIABLE           00096300
                   AIF   (N'&QUERYLEN GT 1).ZG8B  MULTI                 00096400
&XQUERYLEN         SETC  '&QUERYLEN'            SET XVARIABLE           00096500
.ZG8B              AIF   (K'&QUERYLEN(1) GT 0).ZG8C                     00096600
&ZXQUERYLEN        SETC  ''          RESET IN/OUTPUT                    00096700
&ZMS               SETC  ' '                                            00096800
&ZMS               SETC  '&ZMS "QUERYLEN" KEY AND ITS'                  00096900
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00097000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00097100
.ZG8C              ANOP  ,                                              00097200
.*-------------------------------------------------------------------   00097300
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00097400
                   AIF   (K'&ZXQUERYLEN LE 0).ZG8R  NOT I/O             00097500
                   AIF   ('&XQUERYLEN'(1,1) NE '(').ZG8R                00097600
&ZCGPR             SETC  '&XQUERYLEN'(2,K'&XQUERYLEN-2)                 00097700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                    00097800
                   AIF   (K'&ZCGPR GT 2).ZG8Q                           00097900
                   AIF   ('&ZCGPR' EQ '0').ZG8Q                         00098000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00098100
                   AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME       00098200
.ZG8P              ANOP  ,                                              00098300
                   AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC            00098400
                   AIF   ('&ZCGPR' LT '2').ZG8Q                         00098500
                   AIF   ('&ZCGPR' LE '12').ZG8R                        00098600
.ZG8Q              ANOP  ,                                              00098700
&ZMS               SETC  '"QUERYLEN='                                   00098800
&ZMS               SETC  '&ZMS.&QUERYLEN"'                              00098900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00099000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00099100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00099200
.ZG8R              ANOP  ,                                              00099300
.*----------------------------------------------------------------***   00099400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00099500
                   AIF   (N'&RETCODE LE 1).ZG11A  CK NUM                00099600
&ZMS               SETC  '"RETCODE='                                    00099700
&ZMS               SETC  '&ZMS.&RETCODE"'                               00099800
&ZMS               SETC  '&ZMS "RETCODE"'                               00099900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00100000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00100100
.ZG11A             ANOP  ,                                              00100200
.*-------------------------------------------------------------------   00100300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00100400
                   AIF   (K'&RETCODE(1) LE 0).ZG11C  NO PARM            00100500
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00100600
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00100700
                   AIF   (N'&RETCODE GT 1).ZG11C                        00100800
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00100900
.ZG11C             ANOP  ,                                              00101000
.*-------------------------------------------------------------------   00101100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00101200
                   AIF   (K'&ZXRETCODE LE 0).ZG11R  NOT I/O             00101300
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG11R                00101400
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00101500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                   00101600
                   AIF   (K'&ZCGPR GT 2).ZG11Q                          00101700
                   AIF   ('&ZCGPR' EQ '0').ZG11Q                        00101800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00101900
                   AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME      00102000
.ZG11P             ANOP  ,                                              00102100
                   AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC           00102200
                   AIF   ('&ZCGPR' EQ '15').ZG11R                       00102300
                   AIF   ('&ZCGPR' LT '2').ZG11Q                        00102400
                   AIF   ('&ZCGPR' LE '12').ZG11R                       00102500
.ZG11Q             ANOP  ,                                              00102600
&ZMS               SETC  '"RETCODE='                                    00102700
&ZMS               SETC  '&ZMS.&RETCODE"'                               00102800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00102900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'       00103000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00103100
.ZG11R             ANOP  ,                                              00103200
.*----------------------------------------------------------------***   00103300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00103400
                   AIF   (N'&RSNCODE LE 1).ZG14A  CK NUM                00103500
&ZMS               SETC  '"RSNCODE='                                    00103600
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00103700
&ZMS               SETC  '&ZMS "RSNCODE"'                               00103800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00103900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00104000
.ZG14A             ANOP  ,                                              00104100
.*-------------------------------------------------------------------   00104200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00104300
                   AIF   (K'&RSNCODE(1) LE 0).ZG14C  NO PARM            00104400
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00104500
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00104600
                   AIF   (N'&RSNCODE GT 1).ZG14C                        00104700
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00104800
.ZG14C             ANOP  ,                                              00104900
.*-------------------------------------------------------------------   00105000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00105100
                   AIF   (K'&ZXRSNCODE LE 0).ZG14R  NOT I/O             00105200
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG14R                00105300
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00105400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                   00105500
                   AIF   (K'&ZCGPR GT 2).ZG14Q                          00105600
                   AIF   ('&ZCGPR' EQ '0').ZG14R                        00105700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00105800
                   AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME      00105900
.ZG14P             ANOP  ,                                              00106000
                   AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC           00106100
                   AIF   ('&ZCGPR' EQ '0').ZG14R                        00106200
                   AIF   ('&ZCGPR' LT '2').ZG14Q                        00106300
                   AIF   ('&ZCGPR' LE '12').ZG14R                       00106400
.ZG14Q             ANOP  ,                                              00106500
&ZMS               SETC  '"RSNCODE='                                    00106600
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00106700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00106800
                   MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'        00106900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00107000
.ZG14R             ANOP  ,                                              00107100
.******************************************************************     00107200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00107300
.******************************************************************     00107400
                   ACTR  10000                                          00107500
.*----------------------------------------------------------------***   00107600
.***AH.P02 EXTRA POSITIONALS                                            00107700
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00107800
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00107900
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00108000
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00108100
.ZGLISTX1          ANOP  ,                                              00108200
&ZCVAL             SETC  ''          ERROR FIELD                        00108300
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00108400
.ZGLIST2           ANOP  ,                                              00108500
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00108600
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00108700
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00108800
                   AGO   .ZGLIST2                                       00108900
.*                                                                      00109000
.ZGLIST3           ANOP  ,                                              00109100
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00109200
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00109300
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00109400
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00109500
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00109600
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00109700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00109800
.ZGLISTX           ANOP  ,                                              00109900
&ZASYSLNDX         SETA  0                                              00110000
.*-------------------------------------------------------------------   00110100
.***AG.MF04 MF=(SLE)                                                    00110200
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00110300
.*******************************************************************    00110400
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00110500
.*******************************************************************    00110600
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00110700
.*******************************************************************    00110800
.***AE.01  START OF IWM4OPTQ MACRO CODE                                 00110900
.*******************************************************************    00111000
                   LCLC  &M0M0001                 NAME                  00111100
&M0M0001           SETC  '&XLABEL'                SET NAME              00111200
                   AIF   (K'&XLABEL NE 0).XLAB2                         00111300
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00111400
.*                                                                      00111500
.XLAB2             ANOP  ,                                              00111600
                   AIF   ('&XMF' EQ 'L').XLAB3                          00111700
&M0M0001 DS    0H                             IWM4OPTQ-0                00111800
.XLAB3             ANOP  ,                                              00111900
.*******************************************************************    00112000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00112100
.*******************************************************************    00112200
              PUSH  PRINT                                               00112300
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00112400
                   PRINT OFF         ++ PR01                            00112500
                   AGO   .ZPRNTXX                                       00112600
.ZPRINTX           PRINT ON                                             00112700
.ZPRNTXX           ANOP  ,                                              00112800
.********************************************************************   00112900
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00113000
.********************************************************************   00113100
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00113200
                      LCLA  &ZOPN1         INVOCATION INDEX             00113300
                      LCLC  &ZOPL(4095)    LABEL                        00113400
                      LCLC  &ZOPO(4095)    OPERATION                    00113500
                      LCLC  &ZOPV(4095)    VALUE                        00113600
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00113700
.*                                                                      00113800
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00113900
.******************************************************************     00114000
.***AL.L10 IWM4OPTQ FMT=LIST MF=S!L PARAMETERS                          00114100
.******************************************************************     00114200
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00114300
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00114400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00114500
&XMFATTR              SETC  '0D'                                        00114600
.*                                                                      00114700
&ZOPN                 SETA  &ZOPN+1                                     00114800
&ZOPL(&ZOPN)          SETC  ' '                                         00114900
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00115000
&ZOPV(&ZOPN)          SETC  '4,8'                                       00115100
&ZOPN                 SETA  &ZOPN+1                                     00115200
&ZOPL(&ZOPN)          SETC  ' '                                         00115300
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00115400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00115500
&ZOPD(&ZOPN)          SETC  '++ IWM4OPTQ ARG PARMS'                     00115600
.*                                                                      00115700
&ZOPN                 SETA  &ZOPN+1                                     00115800
&ZOPL(&ZOPN)          SETC  ' '                                         00115900
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00116000
&ZOPV(&ZOPN)          SETC  '1'                                         00116100
&ZOPD(&ZOPN)          SETC  ' '                                         00116200
.*                                                                      00116300
.ZLMFSL2              ANOP  ,                                           00116400
.*-------------------------------------------------------------------   00116500
.***AM.L00  IWM4OPTQ FMT=LIST name                                      00116600
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00116700
&ZOPN                 SETA &ZOPN+1                                      00116800
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00116900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00117000
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00117100
&ZOPD(&ZOPN)          SETC '++ IWM4OPTQ NAME'                           00117200
.ZLMFSL2M             ANOP  ,                                           00117300
.*-------------------------------------------------------------------   00117400
.***AM.L01  IWM4OPTQ FMT=LIST PARAMETERS                                00117500
&ZOPN                 SETA &ZOPN+1                                      00117600
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00117700
&ZOPO(&ZOPN)          SETC 'DS'                                         00117800
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00117900
&ZOPD(&ZOPN)          SETC '++ IWM4OPTQ PARM LIST'                      00118000
.*-------------------------------------------------------------------   00118100
.***AM.L09  XACRO CL4                                                   00118200
&ZOPN                 SETA &ZOPN+1                                      00118300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACRO'                            00118400
&ZOPO(&ZOPN)          SETC 'DS'                                         00118500
&ZOPV(&ZOPN)          SETC 'CL4'                                        00118600
&ZOPD(&ZOPN)          SETC '++ CONSTANT '                               00118700
.*-------------------------------------------------------------------   00118800
.***AM.L02 XVERSION XL1                                                 00118900
&ZOPN                 SETA &ZOPN+1                                      00119000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00119100
&ZOPO(&ZOPN)          SETC 'DS'                                         00119200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00119300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00119400
.*-------------------------------------------------------------------   00119500
.***AM.L09  XRSV001 CL1                                                 00119600
&ZOPN                 SETA &ZOPN+1                                      00119700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV001'                          00119800
&ZOPO(&ZOPN)          SETC 'DS'                                         00119900
&ZOPV(&ZOPN)          SETC 'CL1'                                        00120000
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00120100
.*-------------------------------------------------------------------   00120200
.***AM.L09  XPLISTLEN XL2                                               00120300
&ZOPN                 SETA &ZOPN+1                                      00120400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00120500
&ZOPO(&ZOPN)          SETC 'DS'                                         00120600
&ZOPV(&ZOPN)          SETC 'XL2'                                        00120700
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00120800
.*-------------------------------------------------------------------   00120900
.***AM.L09  XANSLEN F                                                   00121000
&ZOPN                 SETA &ZOPN+1                                      00121100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00121200
&ZOPO(&ZOPN)          SETC 'DS'                                         00121300
&ZOPV(&ZOPN)          SETC 'F'                                          00121400
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN '                              00121500
.*-------------------------------------------------------------------   00121600
.***AM.L09  XQUERYLEN F                                                 00121700
&ZOPN                 SETA &ZOPN+1                                      00121800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XQUERYLEN'                        00121900
&ZOPO(&ZOPN)          SETC 'DS'                                         00122000
&ZOPV(&ZOPN)          SETC 'F'                                          00122100
&ZOPD(&ZOPN)          SETC '++ &ZXQUERYLEN '                            00122200
.*-------------------------------------------------------------------   00122300
.***AM.L09  XOPTINFO_BLOCK_ADDRESS AD                                   00122400
&ZOPN                 SETA &ZOPN+1                                      00122500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPTINFO_BLOCK_ADDRESS'           00122600
&ZOPO(&ZOPN)          SETC 'DS'                                         00122700
&ZOPV(&ZOPN)          SETC 'AD'                                         00122800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00122900
.*-------------------------------------------------------------------   00123000
.***AM.L09  XRSV002 CL8                                                 00123100
&ZOPN                 SETA &ZOPN+1                                      00123200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV002'                          00123300
&ZOPO(&ZOPN)          SETC 'DS'                                         00123400
&ZOPV(&ZOPN)          SETC 'CL8'                                        00123500
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00123600
.*-------------------------------------------------------------------   00123700
.***AM.MLM1 SAVED LOCATION COUNTER                                      00123800
                      AIF  ('&ZENDBASEPL' NE '').ZL9LB                  00123900
&ZENDBASEPL           SETC 'YES'                                        00124000
&ZOPN                 SETA &ZOPN+1                                      00124100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00124200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00124300
&ZOPV(&ZOPN)          SETC '*'                                          00124400
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00124500
.ZL9LB                ANOP  ,                                           00124600
.*-------------------------------------------------------------------   00124700
.***AM.PJR1 DEFINED ON XOPTINFO_BLOCK_ADDRESS                           00124800
&ZOPN                 SETA &ZOPN+1                                      00124900
&ZOPL(&ZOPN)          SETC ' '                                          00125000
&ZOPO(&ZOPN)          SETC 'ORG'                                        00125100
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+16'                               00125200
&ZOPD(&ZOPN)          SETC ' '                                          00125300
.*-------------------------------------------------------------------   00125400
.***AM.L09 ADDR3164 XOPTINFO_BLOCK AD                                   00125500
&ZOPN                 SETA &ZOPN+1                                      00125600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPTINFO_BLOCK_ADDR3164'          00125700
&ZOPO(&ZOPN)          SETC 'DS'                                         00125800
&ZOPV(&ZOPN)          SETC 'AD'                                         00125900
&ZOPD(&ZOPN)          SETC '++ &ZXOPTINFO_BLOCK ADDR3164'               00126000
&ZOPN                 SETA &ZOPN+1                                      00126100
&ZOPL(&ZOPN)          SETC ' '                                          00126200
&ZOPO(&ZOPN)          SETC 'ORG'                                        00126300
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00126400
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00126500
.*-------------------------------------------------------------------   00126600
.***AM.L10 END OF IWM4OPTQ LIST PARAMETERS                              00126700
&ZOPN                 SETA &ZOPN+1                                      00126800
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00126900
&ZOPO(&ZOPN)          SETC 'EQU'                                        00127000
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00127100
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00127200
.*                                                                      00127300
&ZOPN                 SETA &ZOPN+1                                      00127400
&ZOPL(&ZOPN)          SETC ' '                                          00127500
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00127600
&ZOPV(&ZOPN)          SETC '1'                                          00127700
&ZOPD(&ZOPN)          SETC ' '                                          00127800
.*-------------------------------------------------------------------   00127900
.***AL.L12 IWM4OPTQ FMT=LIST MF=S!L PARAMETERS                          00128000
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00128100
.*                                                                      00128200
&ZOPN                 SETA  &ZOPN+1                                     00128300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00128400
&ZOPO(&ZOPN)          SETC  'DC'                                        00128500
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00128600
&ZOPD(&ZOPN)          SETC  '++ IWM4OPTQ ARG PARMS'                     00128700
.*                                                                      00128800
.ZLMFSLX              ANOP  ,                                           00128900
.*-------------------------------------------------------------------   00129000
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00129100
&ZPLLEN               SETA 32                                           00129200
.*                                                                      00129300
.******************************************************************     00129400
.***AI.L01 IWM4OPTQ FMT=LIST FILL IN PARAMETER AREA                     00129500
.******************************************************************     00129600
                      ACTR  10000                                       00129700
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00129800
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00129900
&ZCVAL                SETC  'LAE'          XAX MODE                     00130000
.ZIMFXA               ANOP ,                                            00130100
.*                                                                      00130200
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00130300
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00130400
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00130500
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00130600
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00130700
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00130800
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00130900
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00131000
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00131100
&ZOPN                 SETA  &ZOPN+1                                     00131200
&ZOPL(&ZOPN)          SETC  ' '                                         00131300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00131400
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00131500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00131600
                      AGO   .ZIMFNX                                     00131700
.*                                                                      00131800
.ZIMFN2               ANOP ,                                            00131900
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00132000
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00132100
&ZOPN                 SETA  &ZOPN+1                                     00132200
&ZOPL(&ZOPN)          SETC  ' '                                         00132300
&ZOPO(&ZOPN)          SETC  'LAE'                                       00132400
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00132500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00132600
                      AGO   .ZIMFNX                                     00132700
.ZIMFNX1              ANOP ,                                            00132800
&ZOPN                 SETA  &ZOPN+1                                     00132900
&ZOPL(&ZOPN)          SETC  ' '                                         00133000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00133100
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00133200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00133300
.ZIMFNX               ANOP ,                                            00133400
.********************************************************************   00133500
.***AI.L02 IWM4OPTQ FMT=LIST INITIALIZE PARAMETER AREA                  00133600
.********************************************************************   00133700
.***AI.L03 MF=(SLE)                                                     00133800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00133900
.*                                                                      00134000
&ZOPN                 SETA  &ZOPN+1                                     00134100
&ZOPL(&ZOPN)          SETC  ' '                                         00134200
&ZOPO(&ZOPN)          SETC  'XC'                                        00134300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00134400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00134500
.ZIMFLX               ANOP  ,                                           00134600
.*-------------------------------------------------------------------   00134700
.***AI.L60 XACRO CL4                                                    00134800
&ZOPN                 SETA  &ZOPN+1                                     00134900
&ZOPL(&ZOPN)          SETC  ' '                                         00135000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00135100
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''OPQP'''                       00135200
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           00135300
.*-------------------------------------------------------------------   00135400
.***AI.L04 XPLISTLEN XL2                                                00135500
&ZOPN                 SETA  &ZOPN+1                                     00135600
&ZOPL(&ZOPN)          SETC  ' '                                         00135700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00135800
&ZOPV(&ZOPN)          SETC  '6(2,1),=AL2(&ZPLLEN)'                      00135900
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00136000
.*-------------------------------------------------------------------   00136100
.***AI.L25  XANSLEN F                                                   00136200
                      AIF   ('&ZXANSLEN' EQ '').ZI5E                    00136300
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI5E              00136400
&ZCGPR                SETC  '&XANSLEN'                                  00136500
.*                                                                      00136600
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI5B               00136700
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00136800
                      AGO   .ZI5D                                       00136900
.ZI5B                 ANOP  ,                                           00137000
.*                                                                      00137100
&ZC                   SETC  '&XANSLEN'(1,1)                             00137200
                      AIF   (T'&ZC NE 'N').ZI5D                         00137300
&ZC                   SETC  '&XANSLEN'                                  00137400
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI5D                00137500
&ZCGPR                SETC  '=FL4''&XANSLEN'''                          00137600
.*                                                                      00137700
.ZI5D                 ANOP  ,                                           00137800
.*                                                                      00137900
&ZOPN                 SETA  &ZOPN+1                                     00138000
&ZOPL(&ZOPN)          SETC  ' '                                         00138100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00138200
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00138300
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00138400
.*                                                                      00138500
.ZI5E                 ANOP  ,                                           00138600
.*-------------------------------------------------------------------   00138700
.***AI.L19 ADDR3164 XOPTINFO_BLOCK AD                                   00138800
                      AIF   ('&ZXOPTINFO_BLOCK' EQ '').ZI10H            00138900
&ZCLNG                SETC  '&XOPTINFO_BLOCK'                           00139000
&ZCGPR                SETC  '14'                                        00139100
         AIF   ('&XOPTINFO_BLOCK'(1,1) EQ '(').ZI10F  IN GPR            00139200
.*                                                                      00139300
&ZOPN                 SETA  &ZOPN+1                                     00139400
&ZOPL(&ZOPN)          SETC  ' '                                         00139500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00139600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00139700
&ZOPD(&ZOPN)          SETC  '++ &ZXOPTINFO_BLOCK XOPTINFO_BLOCK'        00139800
.*                                                                      00139900
                      AGO   .ZI10G                                      00140000
.*                                                                      00140100
.ZI10F                ANOP  ,                                           00140200
&ZCGPR   SETC  '&XOPTINFO_BLOCK'(2,K'&XOPTINFO_BLOCK-2)                 00140300
.*                                                                      00140400
.ZI10G                ANOP  ,                                           00140500
                      AIF   ('&SYSAM64' EQ 'YES').ZI10H1A               00140600
.*                                                                      00140700
&ZOPN                 SETA  &ZOPN+1                                     00140800
&ZOPL(&ZOPN)          SETC  ' '                                         00140900
&ZOPO(&ZOPN)          SETC  'ST'                                        00141000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+16(,1)'                           00141100
&ZOPD(&ZOPN)          SETC  '++ &ZXOPTINFO_BLOCK XOPTINFO_BLOCK'        00141200
.*                                                                      00141300
                      AGO   .ZI10H                                      00141400
.ZI10H1A              ANOP  ,                                           00141500
.*                                                                      00141600
&ZOPN                 SETA  &ZOPN+1                                     00141700
&ZOPL(&ZOPN)          SETC  ' '                                         00141800
&ZOPO(&ZOPN)          SETC  'STG'                                       00141900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00142000
&ZOPD(&ZOPN)          SETC  '++ &ZXOPTINFO_BLOCK XOPTINFO_BLOCK'        00142100
.*                                                                      00142200
.ZI10H                ANOP  ,                                           00142300
.*-------------------------------------------------------------------   00142400
&ZOPN1                SETA &ZOPN                                        00142500
.*******************************************************************    00142600
.***  PROCESS IWM4OPTQ OUTPUT PARAMETERS                                00142700
.*******************************************************************    00142800
                      ACTR  10000                                       00142900
.*------------------------------------------------------------------    00143000
.***AO.L02 XQUERYLEN F                                                  00143100
         AIF   ('&ZXQUERYLEN' EQ 'OUTPUT').ZO6A  OUTPUT                 00143200
         AIF   ('&ZXQUERYLEN' NE 'INOUT').ZO6C  INOUT                   00143300
.ZO6A    AIF   ('&XQUERYLEN'(1,1) NE '(').ZO6B  ADDR IN GPR             00143400
&ZCGPR   SETC  '&XQUERYLEN'(2,K'&XQUERYLEN-2)                           00143500
&ZOPN                 SETA  &ZOPN+1                                     00143600
&ZOPL(&ZOPN)          SETC  ' '                                         00143700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00143800
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),12(1)'                         00143900
&ZOPD(&ZOPN)          SETC  '++ XQUERYLEN F'                            00144000
                      AGO   .ZO6C                                       00144100
.*                                                                      00144200
.ZO6B                 ANOP  ,                                           00144300
&ZAWRK   SETA  K'&XQUERYLEN                                             00144400
         AIF   ('&XQUERYLEN'(&ZAWRK,1) NE ')').ZO6G                     00144500
&ZN      SETA  2                                                        00144600
.ZO6H    ANOP                                                           00144700
         AIF   (&ZN GE &ZAWRK).ZO6G                                     00144800
         AIF   ('&XQUERYLEN'(&ZN,1) NE '(').ZO6I                        00144900
&ZC      SETC  '&XQUERYLEN'(1,&ZN).'4'.','                              00145000
&ZC      SETC  '&ZC'.'&XQUERYLEN'(&ZN+1,&ZAWRK-&ZN).',12(1)'            00145100
         AGO   .ZO6J                                                    00145200
.ZO6I    ANOP                                                           00145300
&ZN      SETA  &ZN+1                                                    00145400
         AGO   .ZO6H                                                    00145500
.ZO6G    ANOP                                                           00145600
&ZC      SETC  '&XQUERYLEN.(4),12(1)'                                   00145700
.ZO6J    ANOP                                                           00145800
&ZOPN                 SETA  &ZOPN+1                                     00145900
&ZOPL(&ZOPN)          SETC  ' '                                         00146000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00146100
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00146200
&ZOPD(&ZOPN)          SETC  '++ XQUERYLEN F'                            00146300
.ZO6C                 ANOP  ,                                           00146400
.*******************************************************************    00146500
.***AO.X02  RETURN CODE PROCESSING                                      00146600
.*******************************************************************    00146700
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00146800
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00146900
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00147000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00147100
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00147200
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00147300
&ZOPN                 SETA  &ZOPN+1                                     00147400
&ZOPL(&ZOPN)          SETC  ' '                                         00147500
&ZOPO(&ZOPN)          SETC  'ST'                                        00147600
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00147700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00147800
                      AGO   .ZMRETX                                     00147900
.*                                                                      00148000
.ZMRET2               ANOP  ,                                           00148100
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00148200
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00148300
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00148400
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00148500
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00148600
&ZOPN                 SETA  &ZOPN+1                                     00148700
&ZOPL(&ZOPN)          SETC  ' '                                         00148800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00148900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00149000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00149100
.ZMRETX               ANOP  ,                                           00149200
.*******************************************************************    00149300
.***AO.X03  REASON CODE PROCESSING                                      00149400
.*******************************************************************    00149500
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00149600
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00149700
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00149800
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00149900
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00150000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00150100
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00150200
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00150300
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00150400
&ZOPN                 SETA  &ZOPN+1                                     00150500
&ZOPL(&ZOPN)          SETC  ' '                                         00150600
&ZOPO(&ZOPN)          SETC  'ST'                                        00150700
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00150800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00150900
                      AGO   .ZMRSNX                                     00151000
.*                                                                      00151100
.ZMRSN2               ANOP  ,                                           00151200
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00151300
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00151400
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00151500
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00151600
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00151700
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00151800
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00151900
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00152000
&ZOPN                 SETA  &ZOPN+1                                     00152100
&ZOPL(&ZOPN)          SETC  ' '                                         00152200
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00152300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00152400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00152500
.ZMRSNX               ANOP  ,                                           00152600
.*******************************************************************    00152700
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00152800
.*******************************************************************    00152900
.ZMFLX                ANOP  ,              MF=L PROCESSING              00153000
.*******************************************************************    00153100
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00153200
.*******************************************************************    00153300
                      ACTR  10000                                       00153400
.*                                                                      00153500
                      LCLA  &ZLC           COLUMN POSITION              00153600
                      LCLA  &ZOPX          LIST TABLE INDEX             00153700
                      LCLC  &ZLL           LABEL                        00153800
                      LCLC  &ZLOP          OPERATION                    00153900
                      LCLC  &ZLV           VALUE                        00154000
                      LCLC  &ZLD           DESCRIPTION                  00154100
.*                                                                      00154200
&ZOPX                 SETA  1                                           00154300
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00154400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00154500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00154600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00154700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00154800
                      AIF   (K'&ZLD LE 0).ZL5                           00154900
&ZLC                  SETA  35             COMMENT COLUMN               00155000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00155100
&ZLC                  SETA  33             COMMMENT COLUMN              00155200
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00155300
&ZLV                  SETC  '&ZLV'.' '                                  00155400
                      AGO   .ZL3                                        00155500
.*                                                                      00155600
.ZL4                  ANOP  ,                                           00155700
&ZLV                  SETC  '&ZLV'.' '                                  00155800
.ZL5                  ANOP  ,                                           00155900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00156000
.*                                                                      00156100
&ZLL     &ZLOP &ZLV                                                     00156200
.*                                                                      00156300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00156400
                      AGO   .ZL2           CONTINUE LOOPING             00156500
.*                                                                      00156600
.ZLX                  ANOP  ,                                           00156700
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00156800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00156900
     LLGT  14,16(0,0)              GET CVT ADDRESS                      00157000
     LLGT  14,772(14,0)            GET SFT ADDRESS                      00157100
     LLGT  14,380(14,0)            GET LX FOR SERVICE ROUTINE           00157200
     LA    15,128                  GET EX FOR SERVICE ROUTINE           00157300
     OR    14,15                   GET PC NUMBER                        00157400
     PC    0(14)                                                        00157500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00157600
.ZLINKX               ANOP  ,                                           00157700
.*******************************************************************    00157800
.***AP.X01  FORMAT GENERATED CODE                                       00157900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00158000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00158100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00158200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00158300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00158400
                      AIF   (K'&ZLD LE 0).ZL51                          00158500
&ZLC                  SETA  35             COMMENT COLUMN               00158600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00158700
&ZLC                  SETA  33             COMMENT COLUMN               00158800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00158900
&ZLV                  SETC  '&ZLV'.' '                                  00159000
                      AGO   .ZL31                                       00159100
.*                                                                      00159200
.ZL41                 ANOP  ,                                           00159300
&ZLV                  SETC  '&ZLV'.' '                                  00159400
.ZL51                 ANOP  ,                                           00159500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00159600
.*                                                                      00159700
&ZLL     &ZLOP &ZLV                                                     00159800
.*                                                                      00159900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00160000
                      AGO   .ZL21          CONTINUE LOOPING             00160100
.*                                                                      00160200
.ZLX1                 ANOP  ,                                           00160300
.*******************************************************************    00160400
.***AP.X02  END OF IWM4OPTQ MACRO                                       00160500
&ZIWM4OPTQ            SETC  'YES'          SET IWM4OPTQ USED            00160600
         POP   PRINT                                                    00160700
*                                            IWM4OPTQ-0                 00160800
         SPACE 1                                                        00160900
.ZLX2                 ANOP  ,                                           00161000
         MEND                                                           00161100
**********************************************************************/ 00161200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00161300
*%IWM4OPTQ: MACRO KEYS(OPTINFO_BLOCK,ANSLEN,QUERYLEN,RETCODE,RSNCODE,   00161400
*                 PLISTVER,MF);                                         00161500
*  ANS('?'!!MACLABEL!!' '!!'IWM4OPQP '!!MACLIST!!                       00161600
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00161700
*%END IWM4OPTQ;                                                         00161800

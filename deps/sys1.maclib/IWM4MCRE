*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IWM4MCRE                              -02/15/16-<2> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Create delay monitoring environment           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 2004, 2013                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7790                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The purpose of this service is to create a single delay        * 00002100
*      monitoring environment or a number of delay monitoring         * 00002200
*      environments so that work and resource managers may utilize    * 00002300
*      other delay monitoring services to reflect to MVS the          * 00002400
*      execution states and delays associated with work requests.     * 00002500
*                                                                     * 00002600
*      There are three types of monitoring environments available,    * 00002700
*      management monitoring environments, report-only monitoring     * 00002800
*      environments and buffer pool management only environments.     * 00002900
*      Management monitoring environments provide both, performance   * 00003000
*      management and performance reporting, including performance    * 00003100
*      management for buffer pools.  Report-only monitoring           * 00003200
*      environments can be used for performance reporting only.       * 00003300
*      Buffer pool management only environments. If you don't use     * 00003400
*      Management Monitoring Environments, these can be used to       * 00003500
*      report buffer pool delays to manage buffer pools with          * 00003600
*      enclaves.  If used for Buffer Pool Management, in addition     * 00003700
*      they can be used to report other delays for performance        * 00003800
*      reporting.                                                     * 00003900
*                                                                     * 00004000
*      Optionally with this macro, you can use the REPORTONLY=YES     * 00004100
*      parameter to specify the monitoring environment will be used   * 00004200
*      for reporting purposes only.                                   * 00004300
*                                                                     * 00004400
*      Optionally with this macro, you can use the BPMGMTONLY=YES     * 00004500
*      parameter to specify the monitoring environment will be used   * 00004600
*      together with enclaves for buffer pool management.             * 00004700
*                                                                     * 00004800
*                                                                     * 00004900
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00005000
*                                                                     * 00005100
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00005200
*                                                                     * 00005300
*01* ENVIRONMENT:                                                     * 00005400
*                                                                     * 00005500
*                                                                     * 00005600
*      Dispatchable unit mode: Task mode.                             * 00005700
*                                                                     * 00005800
*      Minimum authorization: Supervisor state or program key mask    * 00005900
*                        (PKM) allowing keys 0-7.                     * 00006000
*                                                                     * 00006100
*      AMODE:            31- or 64-bit.  If in 64-Bit addressing      * 00006200
*                        mode, code SYSSTATE AMODE64=YES before       * 00006300
*                        invoking this macro.                         * 00006400
*                                                                     * 00006500
*      ASC mode:         Primary.                                     * 00006600
*                                                                     * 00006700
*      Cross Memory Mode: Non-XMEM or XMEM. Any P.S.H.                * 00006800
*                                                                     * 00006900
*      Interrupt status: Enabled for I/O and external interrupts.  No * 00007000
*                        (EUT) FRR established.                       * 00007100
*                                                                     * 00007200
*      Locks:            No locks held.                               * 00007300
*                                                                     * 00007400
*      Control parameters: Control parameters must be in the primary  * 00007500
*                        address space.                               * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*                                                                     * 00007900
*01* PROGRAMMING REQUIREMENTS:                                        * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*    1.  The macro CVT must be included to use this macro.            * 00008300
*                                                                     * 00008400
*    2.  The macro IWMYCON must be included to use this macro.        * 00008500
*                                                                     * 00008600
*    3.  The macro IWMPB must be in the library concatenation, since  * 00008700
*        it is included by IWMYCON.                                   * 00008800
*                                                                     * 00008900
*    4.  Note that the high order halfword of register 0, and the     * 00009000
*        reason code variable when specified, may be non-zero and     * 00009100
*        represents diagnostic data which is NOT part of the external * 00009200
*        interface.  The high order halfword should thus be excluded  * 00009300
*        from comparison with the reason code values described above. * 00009400
*        The constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may  * 00009500
*        be used for this purpose.                                    * 00009600
*                                                                     * 00009700
*    5.  All character data, unless otherwise specified, is assumed   * 00009800
*        to be left justified and padded with blanks on the right, as * 00009900
*        needed, to occupy the specified number of bytes.             * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*01* RESTRICTIONS:                                                    * 00010400
*                                                                     * 00010500
*                                                                     * 00010600
*    1.  This macro may not be used prior to the completion of WLM    * 00010700
*        address space initialization.                                * 00010800
*                                                                     * 00010900
*    2.  This macro may not be used during task/address space         * 00011000
*        termination.                                                 * 00011100
*                                                                     * 00011200
*    3.  If the key specified on IWM4MCRE is a user key (8-F), then   * 00011300
*        the caller must be in non-cross-memory mode (P=S=H)          * 00011400
*                                                                     * 00011500
*    4.  While not a restriction for IWM4MCRE, it should be noted     * 00011600
*        that when the key specified is a user key (8-F), the delay   * 00011700
*        monitoring token may only be passed (to any service          * 00011800
*        whatsoever), when primary addressability exists to the       * 00011900
*        performance block obtained by IWM4MCRE.  This condition may  * 00012000
*        be satisfied by ensuring that the then current primary       * 00012100
*        matches primary at the time that IWM4MCRE was invoked.  If   * 00012200
*        these other services are invoked in a subspace, the          * 00012300
*        condition may be satisfied by ensuring that the performance  * 00012400
*        block is shared with the base space.                         * 00012500
*                                                                     * 00012600
*    5.  This service provides a task and address space resource      * 00012700
*        managers to clean up any resouces obtained during task and   * 00012800
*        address space terminations.  Once the calling task or        * 00012900
*        address space terminates, the monitoring token returned by   * 00013000
*        IWM4MCRE must not be used for any services.                  * 00013100
*                                                                     * 00013200
*    6.  This macro may only be used on z/OS V2R1 or higher levels    * 00013300
*        for the LISTLEN, MONTKN64 and MONTKN64_LIST keywords.        * 00013400
*                                                                     * 00013500
*                                                                     * 00013600
*                                                                     * 00013700
*01* INPUT REGISTER INFORMATION:                                      * 00013800
*                                                                     * 00013900
*    Before issuing the IWM4MCRE macro, the caller does not have to   * 00014000
*    place any information into any register unless using it in       * 00014100
*    register notation for a particular parameter, or using it as a   * 00014200
*    base register.                                                   * 00014300
*                                                                     * 00014400
*01* OUTPUT REGISTER INFORMATION:                                     * 00014500
*                                                                     * 00014600
*    When control returns to the caller, the GPRs contain:            * 00014700
*                                                                     * 00014800
*                                                                     * 00014900
*    REGISTER  CONTENTS                                               * 00015000
*                                                                     * 00015100
*    0         Reason code if GR15 return code is non-zero            * 00015200
*                                                                     * 00015300
*    1         Used as work registers by the system                   * 00015400
*                                                                     * 00015500
*    2-13      Unchanged                                              * 00015600
*                                                                     * 00015700
*    14        Used as work registers by the system                   * 00015800
*                                                                     * 00015900
*    15        Return code                                            * 00016000
*                                                                     * 00016100
*                                                                     * 00016200
*                                                                     * 00016300
*    When control returns to the caller, the ARs contain:             * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*    REGISTER  CONTENTS                                               * 00016700
*                                                                     * 00016800
*    0-1       Used as work registers by the system                   * 00016900
*                                                                     * 00017000
*    2-13      Unchanged                                              * 00017100
*                                                                     * 00017200
*    14-15     Used as work registers by the system                   * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*    Some callers depend on register contents remaining the same      * 00017700
*    before and after issuing a service.  If the system changes the   * 00017800
*    contents of registers on which the caller depends, the caller    * 00017900
*    must save them before issuing the service, and restore them      * 00018000
*    after the system returns control.                                * 00018100
*                                                                     * 00018200
*01* PERFORMANCE IMPLICATIONS:                                        * 00018300
*                                                                     * 00018400
*    None                                                             * 00018500
*                                                                     * 00018600
*01* SYNTAX:                                                          * 00018700
*                                                                     * 00018800
*Ýxlabel¨  IWM4MCRE  ÐÝ REQTYPE=SINGLE                                * 00018900
*                    !   Ð ,MONTKN=Ýxmontkn¨                          * 00019000
*                    !   ¿ ,MONTKN64=Ýxmontkn64¨                      * 00019100
*                    !       ÐÝ,ALLOCATEBELOW=NO¨                     * 00019200
*                    !       ¿Ý,ALLOCATEBELOW=YES¨¨                   * 00019300
*                    ¿Ý,REQTYPE=MULTIPLE                              * 00019400
*                          ,AMOUNT=xamount                            * 00019500
*                        Ð ,MONTKN_LIST=xmontkn_list                  * 00019600
*                        ¿ ,MONTKN64_LIST=xmontkn64_list              * 00019700
*                            ÐÝ,ALLOCATEBELOW=NO¨                     * 00019800
*                            ¿Ý,ALLOCATEBELOW=YES¨                    * 00019900
*                        Ð ,MONTKN_LISTLEN=xmontkn_listlen            * 00020000
*                        ¿ ,LISTLEN=xlistlen¨                         * 00020100
*                    ÐÝ,REPORTONLY=NO                                 * 00020200
*                    !   ÐÝ,BPMGMTONLY=NO¨                            * 00020300
*                    !   ¿Ý,BPMGMTONLY=YES¨¨                          * 00020400
*                    ¿Ý,REPORTONLY=YES¨                               * 00020500
*                    Ð ,SUBSYSP=CONNECT                               * 00020600
*                    !     ,CONNTKN=xconntkn                          * 00020700
*                    ¿ ,SUBSYSP=VALUE                                 * 00020800
*                          ,SUBSYS=xsubsys                            * 00020900
*                          ,SUBSYSNM=xsubsysnm                        * 00021000
*                        ÐÝ,EWLM=NO¨                                  * 00021100
*                        ¿Ý,EWLM=YES                                  * 00021200
*                             Ý,GROUPNM=»xgroupnm!NO_GROUPNMº         * 00021300
*                                  ,GROUPNM_LEN                       * 00021400
*                                               =xgroupnm_len¨¨       * 00021500
*                    Ð ,MONTKNKEYP=VALUE                              * 00021600
*                    !     ,MONTKNKEY=xmontknkey                      * 00021700
*                    ¿ ,MONTKNKEYP=PSWKEY                             * 00021800
*                     Ý,RETCODE=xretcode¨                             * 00021900
*                     Ý,RSNCODE=xrsncode¨                             * 00022000
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00022100
*                    ÐÝ,MF=S¨                                         * 00022200
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00022300
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*      Where:                                                         * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*      Ýxlabel¨                                                       * 00023000
*          is an optional symbol, starting in column 1, that is the   * 00023100
*          name on the IWM4MCRE macro invocation.  The name must      * 00023200
*          conform to the rules for an ordinary assembler language    * 00023300
*          symbol.                                                    * 00023400
*          DEFAULT: No name.                                          * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*      ÝREQTYPE=»SINGLE!MULTIPLEº                                     * 00024000
*          is an optional keyword input indicates whether the request * 00024100
*          is to create a single delay monitoring environment or to   * 00024200
*          create multiple delay monitoring environments.             * 00024300
*          DEFAULT: SINGLE                                            * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*          ÝREQTYPE=SINGLE                                            * 00024700
*              The request is to create a single delay monitoring     * 00024800
*              environment.                                           * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*              The following is a set of mutually exclusive keys.     * 00025200
*              This set is required; only one key must be specified.  * 00025300
*                                                                     * 00025400
*                                                                     * 00025500
*              MONTKN=Ýxmontkn¨                                       * 00025600
*                  belongs to a set of mutually exclusive keys. It is * 00025700
*                  the name (RS-type), or address in register         * 00025800
*                  (2)-(12), of a 32 bit output which will receive    * 00025900
*                  the delay monitoring token.                        * 00026000
*                                                                     * 00026100
*              MONTKN64=Ýxmontkn64¨                                   * 00026200
*                  belongs to a set of mutually exclusive keys. It is * 00026300
*                  the name (RS-type), or address in register         * 00026400
*                  (2)-(12), of a 64 bit output which will receive    * 00026500
*                  the long delay monitoring token.                   * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                  ÝALLOCATEBELOW=»NO!YESº¨                           * 00026900
*                      is an optional keyword input which indicates   * 00027000
*                      whether the virtual storage for the delay      * 00027100
*                      monitoring environment is to be obtained below * 00027200
*                      2 gigabytes.  This is especially helpful for   * 00027300
*                      callers with 31-bit dependencies.              * 00027400
*                      DEFAULT: NO                                    * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*                      ÝALLOCATEBELOW=NO¨                             * 00027800
*                          indicates that the delay monitoring        * 00027900
*                          environment is to be located as 64-bit     * 00028000
*                          virtual storage.                           * 00028100
*                                                                     * 00028200
*                      ÝALLOCATEBELOW=YES¨¨                           * 00028300
*                          indicates that the virtual storage is to   * 00028400
*                          be located below 2 gigabytes.              * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                                                                     * 00029200
*              End of a set of mutually exclusive required keys.      * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*          ÝREQTYPE=MULTIPLE                                          * 00029600
*              The request is to create a number of delay monitoring  * 00029700
*              environments.                                          * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*              AMOUNT=xamount                                         * 00030100
*                  is the name (RS-type), or address in register      * 00030200
*                  (2)-(12), of a required fullword input which       * 00030300
*                  specifies the number of delay monitoring           * 00030400
*                  environments to be created.                        * 00030500
*                                                                     * 00030600
*                  While there is no restriction on the number of     * 00030700
*                  delay monitoring environments to be created,       * 00030800
*                  caller should only create the minimum number of    * 00030900
*                  delay monitoring environments that are needed.     * 00031000
*                                                                     * 00031100
*                  If there are too many unused delay monitoring      * 00031200
*                  environments existing in the system, the storage   * 00031300
*                  and CPU overheads may be significant.              * 00031400
*                                                                     * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*              The following is a set of mutually exclusive keys.     * 00031900
*              This set is required; only one key must be specified.  * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*              MONTKN_LIST=xmontkn_list                               * 00032300
*                  belongs to a set of mutually exclusive keys. It is * 00032400
*                  the name (RS-type), or address in register         * 00032500
*                  (2)-(12), of a character input which specifies an  * 00032600
*                  area into which a list of delay monitoring tokens  * 00032700
*                  will be placed.                                    * 00032800
*                  A single MONTKN has a size of 4 byte.              * 00032900
*                                                                     * 00033000
*              MONTKN64_LIST=xmontkn64_list                           * 00033100
*                  belongs to a set of mutually exclusive keys. It is * 00033200
*                  the name (RS-type), or address in register         * 00033300
*                  (2)-(12), of a character input which specifies an  * 00033400
*                  area into which a list of long delay monitoring    * 00033500
*                  tokens will be placed.                             * 00033600
*                  A single MONTKN64 has a size of 8 byte.            * 00033700
*                                                                     * 00033800
*                                                                     * 00033900
*                  ÝALLOCATEBELOW=»NO!YESº¨¨                          * 00034000
*                      is an optional keyword input which indicates   * 00034100
*                      whether the virtual storage for the delay      * 00034200
*                      monitoring environment is to be obtained below * 00034300
*                      2 gigabytes.  This is especially helpful for   * 00034400
*                      callers with 31-bit dependencies.              * 00034500
*                      DEFAULT: NO                                    * 00034600
*                                                                     * 00034700
*                                                                     * 00034800
*                      ÝALLOCATEBELOW=NO¨                             * 00034900
*                          indicates that the delay monitoring        * 00035000
*                          environment is to be located as 64-bit     * 00035100
*                          virtual storage.                           * 00035200
*                                                                     * 00035300
*                      ÝALLOCATEBELOW=YES¨                            * 00035400
*                          indicates that the virtual storage is to   * 00035500
*                          be located below 2 gigabytes.              * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*                                                                     * 00036000
*                                                                     * 00036100
*                                                                     * 00036200
*                                                                     * 00036300
*              End of a set of mutually exclusive required keys.      * 00036400
*                                                                     * 00036500
*                                                                     * 00036600
*                                                                     * 00036700
*              The following is a set of mutually exclusive keys.     * 00036800
*              This set is required; only one key must be specified.  * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*              MONTKN_LISTLEN=xmontkn_listlen                         * 00037200
*                  belongs to a set of mutually exclusive keys. It is * 00037300
*                  the name (RS-type), or address in register         * 00037400
*                  (2)-(12), of a fullword input                      * 00037500
*                                                                     * 00037600
*                  Still supported, but use LISTLEN instead           * 00037700
*                                                                     * 00037800
*              LISTLEN=xlistlen¨                                      * 00037900
*                  belongs to a set of mutually exclusive keys. It is * 00038000
*                  the name (RS-type), or address in register         * 00038100
*                  (2)-(12), of a fullword input which specifies the  * 00038200
*                  length (in bytes) of the area identified by the    * 00038300
*                  MONTKN_LIST / MONTKN64_LIST keyword.               * 00038400
*                                                                     * 00038500
*                  Size of this area must be at least the size of one * 00038600
*                  monitoring token (see MONTKN / MONTKN64 keyword)   * 00038700
*                  times AMOUNT.  If the user specified area is not   * 00038800
*                  large enough to return the delay monitoring        * 00038900
*                  tokens, a specific return/reason code will be      * 00039000
*                  returned and the request will not be processed.    * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*                                                                     * 00039400
*              End of a set of mutually exclusive required keys.      * 00039500
*                                                                     * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*                                                                     * 00040200
*      ÝREPORTONLY=»NO!YESº¨                                          * 00040300
*          is an optional keyword input which indicates whether the   * 00040400
*          monitoring environment is for reporting purposes only      * 00040500
*          (YES) or (NO).                                             * 00040600
*          DEFAULT: NO                                                * 00040700
*                                                                     * 00040800
*                                                                     * 00040900
*          ÝREPORTONLY=NO                                             * 00041000
*              indicates that the monitoring environment is for       * 00041100
*              management and reporting purposes.                     * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*              ÝBPMGMTONLY=»NO!YESº¨                                  * 00041500
*                  is an optional keyword input which indicates       * 00041600
*                  whether the monitoring environment is used         * 00041700
*                  together with enclaves to manage buffer pools      * 00041800
*                  (YES) or (NO).                                     * 00041900
*                  DEFAULT: NO                                        * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*                  ÝBPMGMTONLY=NO¨                                    * 00042300
*                      indicates that the monitoring environment is   * 00042400
*                      not used together with enclaves to manage      * 00042500
*                      buffer pools.                                  * 00042600
*                                                                     * 00042700
*                  ÝBPMGMTONLY=YES¨¨                                  * 00042800
*                      indicates that the monitoring environment is   * 00042900
*                      used together with enclaves to manage buffer   * 00043000
*                      pools.                                         * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*          ÝREPORTONLY=YES¨                                           * 00043700
*              indicates that the monitoring environment is for       * 00043800
*              reporting purposes only.                               * 00043900
*                                                                     * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*                                                                     * 00044400
*                                                                     * 00044500
*      SUBSYSP=»CONNECT!VALUEº                                        * 00044600
*          is a required keyword input which describes how the        * 00044700
*          calling subsystem is providing identification.             * 00044800
*                                                                     * 00044900
*                                                                     * 00045000
*          SUBSYSP=CONNECT                                            * 00045100
*                                                                     * 00045200
*              indicates that the connect token is being passed.      * 00045300
*                                                                     * 00045400
*                                                                     * 00045500
*              CONNTKN=xconntkn                                       * 00045600
*                  is the name (RS-type), or address in register      * 00045700
*                  (2)-(12), of a required 32 bit input which         * 00045800
*                  contains the connect token associated with the     * 00045900
*                  subsystem.                                         * 00046000
*                                                                     * 00046100
*                                                                     * 00046200
*                                                                     * 00046300
*          SUBSYSP=VALUE                                              * 00046400
*                                                                     * 00046500
*              indicates that the subsystem name is being passed      * 00046600
*              directly.                                              * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*              SUBSYS=xsubsys                                         * 00047000
*                  is the name (RS-type), or address in register      * 00047100
*                  (2)-(12), of a required 4 character input which    * 00047200
*                  contains the generic subsystem type (e.g. IMS,     * 00047300
*                  CICS, etc.).                                       * 00047400
*                                                                     * 00047500
*                                                                     * 00047600
*                                                                     * 00047700
*                                                                     * 00047800
*              SUBSYSNM=xsubsysnm                                     * 00047900
*                  is the name (RS-type), or address in register      * 00048000
*                  (2)-(12), of a required 8 character input which    * 00048100
*                  contains the subsystem name.                       * 00048200
*                                                                     * 00048300
*                                                                     * 00048400
*                                                                     * 00048500
*                                                                     * 00048600
*              ÝEWLM=»NO!YESº¨                                        * 00048700
*                  is an optional keyword input which indicates if    * 00048800
*                  the created monitoring environment is intended to  * 00048900
*                  paricipate in Enterprise Workload Management       * 00049000
*                  (EWLM).                                            * 00049100
*                  DEFAULT: NO                                        * 00049200
*                                                                     * 00049300
*                                                                     * 00049400
*                  ÝEWLM=NO¨                                          * 00049500
*                      The monitoring environment can not be used to  * 00049600
*                      report on ARM work requests.                   * 00049700
*                                                                     * 00049800
*                  ÝEWLM=YES                                          * 00049900
*                      The monitoring environment participates in     * 00050000
*                      cross platform Enterprise Workload Management  * 00050100
*                      and interacts with EWLM. An ARM application    * 00050200
*                      instance will be registered and started using  * 00050300
*                      the passed subsystem type (SUBSYS), subsystem  * 00050400
*                      name (SUBSYSNM), and the new parameter group   * 00050500
*                      name (GROUPNM, GROUPNM_LEN) - an already       * 00050600
*                      existing ARM registration for the same address * 00050700
*                      space with identical SUBSYS, SUBSYSNM, GROUPNM * 00050800
*                      and GROUPNM_LEN parameters will be reused.     * 00050900
*                      All ARM work requests associated with the      * 00051000
*                      created monitoring environment are reported    * 00051100
*                      for this ARM application instance.             * 00051200
*                                                                     * 00051300
*                                                                     * 00051400
*                      ÝGROUPNM=»xgroupnm!NO_GROUPNMº                 * 00051500
*                          is the name (RS-type), or address in       * 00051600
*                          register (2)-(12), of an optional          * 00051700
*                          character input which contains the name of * 00051800
*                          an application group, i.e. a group of      * 00051900
*                          similar or cooperating subsystem           * 00052000
*                          instances. A group name can be up to 255   * 00052100
*                          characters long.  Provision of a data area * 00052200
*                          initialized to all blanks is equivalent to * 00052300
*                          specification of NO_GROUPNM.               * 00052400
*                          DEFAULT: NO_GROUPNM indicates that no      * 00052500
*                          group name is passed.                      * 00052600
*                                                                     * 00052700
*                                                                     * 00052800
*                          GROUPNM_LEN=xgroupnm_len¨¨                 * 00052900
*                              is the name (RS-type), or address in   * 00053000
*                              register (2)-(12), of a required       * 00053100
*                              fullword input which contains the      * 00053200
*                              length of the group name.  A group     * 00053300
*                              name can be up to 255 characters long. * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*                                                                     * 00053900
*                                                                     * 00054000
*                                                                     * 00054100
*                                                                     * 00054200
*                                                                     * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*                                                                     * 00054600
*                                                                     * 00054700
*                                                                     * 00054800
*      MONTKNKEYP=»VALUE!PSWKEYº                                      * 00054900
*          is a required keyword input which describes how the input  * 00055000
*          key for the monitoring environment should be obtained.     * 00055100
*                                                                     * 00055200
*                                                                     * 00055300
*          MONTKNKEYP=VALUE                                           * 00055400
*                                                                     * 00055500
*              indicates that the key is being passed explicitly via  * 00055600
*              MONTKNKEY.                                             * 00055700
*                                                                     * 00055800
*                                                                     * 00055900
*              MONTKNKEY=xmontknkey                                   * 00056000
*                  is the name (RS-type), or address in register      * 00056100
*                  (2)-(12), of a required 8 bit input which contains * 00056200
*                  the key in which the delay monitoring environment  * 00056300
*                  will be invoked subsequently when using the output * 00056400
*                  MONTKN / MONTKN64.  The low order 4 bits (bits     * 00056500
*                  4-7) contain the key value.  The high order 4 bits * 00056600
*                  (bits 0-3) must be 0.                              * 00056700
*                                                                     * 00056800
*                                                                     * 00056900
*                                                                     * 00057000
*          MONTKNKEYP=PSWKEY                                          * 00057100
*                                                                     * 00057200
*              indicates that the current PSW key should be used.     * 00057300
*                                                                     * 00057400
*                                                                     * 00057500
*                                                                     * 00057600
*                                                                     * 00057700
*                                                                     * 00057800
*                                                                     * 00057900
*      ÝRETCODE=xretcode¨                                             * 00058000
*          is the name (RS-type) of an optional fullword output       * 00058100
*          variable, or register (2)-(12) or (15), into which the     * 00058200
*          return code is to be copied from GPR 15.  If you specify   * 00058300
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00058400
*          the value will be left in GPR 15.                          * 00058500
*                                                                     * 00058600
*                                                                     * 00058700
*                                                                     * 00058800
*                                                                     * 00058900
*      ÝRSNCODE=xrsncode¨                                             * 00059000
*          is the name (RS-type) of an optional fullword output       * 00059100
*          variable into which the reason code is to be copied from   * 00059200
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00059300
*          R0 (within or without parentheses), the value will be left * 00059400
*          in GPR 0.                                                  * 00059500
*                                                                     * 00059600
*                                                                     * 00059700
*                                                                     * 00059800
*                                                                     * 00059900
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00060000
*          is an optional byte input decimal value in the "0-2" range * 00060100
*          that specifies the macro version.  PLISTVER is the only    * 00060200
*          key allowed on the list form of MF and determines which    * 00060300
*          parameter list is generated.  The macro keys associated    * 00060400
*          with each supported version of the macro are listed in     * 00060500
*          MACRO USAGE NOTE 2.  Note that MAX may be specified        * 00060600
*          instead of a number, and the parameter list will be of the * 00060700
*          largest size currently supported. This size may grow from  * 00060800
*          release to release (thus possibly affecting the amount of  * 00060900
*          storage needed by your program).  If your program can      * 00061000
*          tolerate this, IBM recommends that you always specify MAX  * 00061100
*          when creating the list form parameter list as that will    * 00061200
*          ensure that the list form parameter list is always long    * 00061300
*          enough to hold whatever parameters might be specified on   * 00061400
*          the execute form.                                          * 00061500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00061600
*          default is the lowest version which allows all of the      * 00061700
*          parameters specified on the invocation to be processed.    * 00061800
*                                                                     * 00061900
*                                                                     * 00062000
*                                                                     * 00062100
*                                                                     * 00062200
*      ÝMF=»S!L!Eº¨                                                   * 00062300
*          is an optional keyword input which specifies the macro     * 00062400
*          form.                                                      * 00062500
*          DEFAULT: S                                                 * 00062600
*                                                                     * 00062700
*                                                                     * 00062800
*          ÝMF=S¨                                                     * 00062900
*              specifies the standard form of the macro.  The "S"     * 00063000
*              form generates code to put the parameters into an      * 00063100
*              in-line parameter list and invoke the desired service. * 00063200
*              Full checking for required macro keys is done along    * 00063300
*              with supplying defaults for omitted optional           * 00063400
*              parameters.                                            * 00063500
*                                                                     * 00063600
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00063700
*              specifies the list form of the macro.  The "L" form    * 00063800
*              defines an area to be used for the parameter list.     * 00063900
*              Only the PLISTVER key may be specified on the          * 00064000
*              invocation.  All other macro parameters are flagged as * 00064100
*              errors.  If PLISTVER is not specified, the original    * 00064200
*              parameter list definition is used.                     * 00064300
*                                                                     * 00064400
*            ,xmfctrl                                                 * 00064500
*              is a required input.  It is the name of a storage area * 00064600
*              for the parameter list.                                * 00064700
*                                                                     * 00064800
*            »,xmfattr!0Dº                                            * 00064900
*              is an optional 60 character input string that varies   * 00065000
*              from 1 to 60 characters. Use it to force boundary      * 00065100
*              alignment of the parameter list. Use only 0F or 0D.    * 00065200
*              DEFAULT: 0D which forces the parameter list to a       * 00065300
*              doubleword boundary.                                   * 00065400
*                                                                     * 00065500
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00065600
*              specifies the execute form of the macro.  The "E" form * 00065700
*              generates code to put the parameters into the          * 00065800
*              parameter list specified by xmfctrl and provides full  * 00065900
*              syntax checking with default setting.                  * 00066000
*                                                                     * 00066100
*            ,xmfctrl                                                 * 00066200
*              is a required input.  It is the name (RS-type), or     * 00066300
*              address in register (1)-(12), of a storage area for    * 00066400
*              the parameter list.                                    * 00066500
*                                                                     * 00066600
*            »,COMPLETEº                                              * 00066700
*              is an optional keyword input which specifies the       * 00066800
*              degree of macro parameter syntax checking.             * 00066900
*              DEFAULT: COMPLETE                                      * 00067000
*                                                                     * 00067100
*                                                                     * 00067200
*              COMPLETE                                               * 00067300
*                  Checking for required macro keys is done and       * 00067400
*                  defaults are supplied for omitted optional         * 00067500
*                  parameters.                                        * 00067600
*                                                                     * 00067700
*                                                                     * 00067800
*                                                                     * 00067900
*                                                                     * 00068000
*                                                                     * 00068100
*                                                                     * 00068200
*                                                                     * 00068300
*01* ABEND CODES:  None.                                              * 00068400
*                                                                     * 00068500
*01* RETURN CODES:                                                    * 00068600
*                                                                     * 00068700
*                                                                     * 00068800
*            0    Name: IwmRetCodeOk                                  * 00068900
*                                                                     * 00069000
*                 Meaning: Successful completion.                     * 00069100
*                                                                     * 00069200
*                 Action: None required.                              * 00069300
*                                                                     * 00069400
*            4    Name: IwmRetCodeWarning                             * 00069500
*                                                                     * 00069600
*                 Meaning: Successful completion, unusual conditions  * 00069700
*                 noted.                                              * 00069800
*                                                                     * 00069900
*                                                                     * 00070000
*                 HEX REASON  MEANING/ACTION                          * 00070100
*                 CODE                                                * 00070200
*                                                                     * 00070300
*                 xxxx0409    Name: IwmRsnCodeNoConn                  * 00070400
*                                                                     * 00070500
*                             Meaning:  Connect token does not        * 00070600
*                             reflect a successful Connect.  The      * 00070700
*                             delay monitoring token returned is      * 00070800
*                             useable in other services.  However use * 00070900
*                             of this token will NOT result in the    * 00071000
*                             action requested of those services.     * 00071100
*                                                                     * 00071200
*                             Action: None required.                  * 00071300
*                                                                     * 00071400
*                                                                     * 00071500
*                                                                     * 00071600
*            8    Name: IwmRetCodeInvocError                          * 00071700
*                                                                     * 00071800
*                 Meaning: Invalid invocation environment or          * 00071900
*                 parameters.                                         * 00072000
*                                                                     * 00072100
*                                                                     * 00072200
*                 HEX REASON  MEANING/ACTION                          * 00072300
*                 CODE                                                * 00072400
*                                                                     * 00072500
*                 xxxx0801    Name: IwmRsnCodeSrbMode                 * 00072600
*                                                                     * 00072700
*                             Meaning:  Caller is in SRB mode.        * 00072800
*                                                                     * 00072900
*                             Action: Avoid requesting this function  * 00073000
*                             while in SRB mode.                      * 00073100
*                                                                     * 00073200
*                 xxxx0802    Name: IwmRsnCodeXmemUserKeyTkn          * 00073300
*                                                                     * 00073400
*                             Meaning:  Caller is in cross-memory     * 00073500
*                             mode while the token was requested in   * 00073600
*                             user key.                               * 00073700
*                                                                     * 00073800
*                             Action: Avoid requesting this function  * 00073900
*                             while in cross-memory mode.             * 00074000
*                                                                     * 00074100
*                 xxxx0803    Name: IwmRsnCodeDisabled                * 00074200
*                                                                     * 00074300
*                             Meaning:  Caller is disabled.           * 00074400
*                                                                     * 00074500
*                             Action: Avoid requesting this function  * 00074600
*                             while disabled.                         * 00074700
*                                                                     * 00074800
*                 xxxx0804    Name: IwmRsnCodeLocked                  * 00074900
*                                                                     * 00075000
*                             Meaning: Caller is locked.              * 00075100
*                                                                     * 00075200
*                             Action: Avoid requesting this function  * 00075300
*                             while locked.                           * 00075400
*                                                                     * 00075500
*                 xxxx080B    Name: IwmRsnCodeBadPl                   * 00075600
*                                                                     * 00075700
*                             Meaning:  Error accessing parameter     * 00075800
*                             list.                                   * 00075900
*                                                                     * 00076000
*                             Action: Check for possible storage      * 00076100
*                             overlay.                                * 00076200
*                                                                     * 00076300
*                 xxxx0810    Name: IwmRsnCodeEutFrr                  * 00076400
*                                                                     * 00076500
*                             Meaning:  Caller has EUT FRR            * 00076600
*                             established.                            * 00076700
*                                                                     * 00076800
*                             Action: Avoid requesting this function  * 00076900
*                             with an EUT FRR set.                    * 00077000
*                                                                     * 00077100
*                 xxxx0821    Name: IwmRsnCodeBadConn                 * 00077200
*                                                                     * 00077300
*                             Meaning:  Input connect token does not  * 00077400
*                             pass validity checking.                 * 00077500
*                                                                     * 00077600
*                             Action: Check for possible storage      * 00077700
*                             overlay.                                * 00077800
*                                                                     * 00077900
*                 xxxx0823    Name: IwmRsnCodeDatoff                  * 00078000
*                                                                     * 00078100
*                             Meaning: Caller invoked service while   * 00078200
*                             DATOFF                                  * 00078300
*                                                                     * 00078400
*                             Action: Avoid requesting this function  * 00078500
*                             in this environment.                    * 00078600
*                                                                     * 00078700
*                 xxxx0824    Name: IwmRsnCodeAmode24                 * 00078800
*                                                                     * 00078900
*                             Meaning: Caller invoked service but was * 00079000
*                             in 24 bit addressing mode.              * 00079100
*                                                                     * 00079200
*                             Action: Request this function only when * 00079300
*                             you are in 31 bit addressing mode.      * 00079400
*                                                                     * 00079500
*                 xxxx0825    Name: IwmRsnCodeAscModeNotPrimary       * 00079600
*                                                                     * 00079700
*                             Meaning: Caller invoked service but was * 00079800
*                             not DAT on Primary ASC mode.            * 00079900
*                                                                     * 00080000
*                             Action: Avoid requesting this function  * 00080100
*                             in this environment.                    * 00080200
*                                                                     * 00080300
*                 xxxx0826    Name: IwmRsnCodeTaskTerm                * 00080400
*                                                                     * 00080500
*                             Meaning:  Caller invoked service while  * 00080600
*                             task termination is in progress for the * 00080700
*                             TCB associated with the owner.          * 00080800
*                                                                     * 00080900
*                             Action: Avoid requesting this function  * 00081000
*                             in this environment.                    * 00081100
*                                                                     * 00081200
*                 xxxx0827    Name: IwmRsnCodeRsvdNot0                * 00081300
*                                                                     * 00081400
*                             Meaning:  Reserved field in parameter   * 00081500
*                             list was non-zero.                      * 00081600
*                                                                     * 00081700
*                             Action: Check for possible storage      * 00081800
*                             overlay of the parameter list.          * 00081900
*                                                                     * 00082000
*                 xxxx0828    Name: IwmRsnCodeBadVersion              * 00082100
*                                                                     * 00082200
*                             Meaning: Version number in parameter    * 00082300
*                             list is not valid.                      * 00082400
*                                                                     * 00082500
*                             Action: Check for possible storage      * 00082600
*                             overlay of the parameter list.          * 00082700
*                                                                     * 00082800
*                 xxxx0829    Name: IwmRsnCodeBadOptions              * 00082900
*                                                                     * 00083000
*                             Meaning:  Parameter list omits required * 00083100
*                             parameters or supplies mutually         * 00083200
*                             exclusive parameters or provides data   * 00083300
*                             associated with options not selected.   * 00083400
*                                                                     * 00083500
*                             Action: Check for possible storage      * 00083600
*                             overlay of the parameter list.          * 00083700
*                                                                     * 00083800
*                 xxxx0844    Name: IwmRsnCodeBadMonTknListLen        * 00083900
*                                                                     * 00084000
*                             Meaning:  The storage area length       * 00084100
*                             specified on the MONTKN_LISTLEN         * 00084200
*                             parameter is not large enough to        * 00084300
*                             contain the data being returned. No     * 00084400
*                             data is returned.                       * 00084500
*                                                                     * 00084600
*                             Action: Invoke the function with an     * 00084700
*                             output area sufficient to receive the   * 00084800
*                             data.                                   * 00084900
*                                                                     * 00085000
*                                                                     * 00085100
*                                                                     * 00085200
*            C    Name: IwmRetCodeEnvError                            * 00085300
*                                                                     * 00085400
*                 Meaning: Environmental error.                       * 00085500
*                                                                     * 00085600
*                                                                     * 00085700
*                 HEX REASON  MEANING/ACTION                          * 00085800
*                 CODE                                                * 00085900
*                                                                     * 00086000
*                 xxxx0C01    Name: IwmRsnCodeNoStg                   * 00086100
*                                                                     * 00086200
*                             Meaning:  Storage is not available for  * 00086300
*                             the request.                            * 00086400
*                                                                     * 00086500
*                             Action: There is a storage shortage.    * 00086600
*                             The function may work successfully at a * 00086700
*                             later time.                             * 00086800
*                                                                     * 00086900
*                 xxxx0C09    Name: IwmRsnCodeNoResmgr                * 00087000
*                                                                     * 00087100
*                             Meaning: Resource manager could not be  * 00087200
*                             established.                            * 00087300
*                                                                     * 00087400
*                             Action: No action required.  This       * 00087500
*                             condition may be due to a storage       * 00087600
*                             shortage condition.                     * 00087700
*                                                                     * 00087800
*                                                                     * 00087900
*                                                                     * 00088000
*            10   Name: IwmRetCodeCompError                           * 00088100
*                                                                     * 00088200
*                 Meaning: Component error.                           * 00088300
*                                                                     * 00088400
*                 Action: No action required.  The function may be    * 00088500
*                 successful if invoked again.                        * 00088600
*                                                                     * 00088700
*                                                                     * 00088800
*                                                                     * 00088900
*01* REASON CODES:                                                    * 00089000
*                                                                     * 00089100
*       A unique reason code will be returned whenever the return     * 00089200
*       code is non-zero.  Reason codes, as appropriate, are defined  * 00089300
*       under their corresponding return code.  Reason code and       * 00089400
*       return code constants are defined within IWMYCON.  Note that  * 00089500
*       the high order halfword of register 0, and the reason code    * 00089600
*       variable when specified, may be non-zero and represents       * 00089700
*       diagnostic data which is NOT part of the external interface.  * 00089800
*       The high order halfword should thus be excluded from          * 00089900
*       comparison with the reason code values described above.  The  * 00090000
*       constant, IWMRSNCODE_MASK_CONST defined in IWMYCON, may be    * 00090100
*       used for this purpose.                                        * 00090200
*                                                                     * 00090300
*01* MODULE TYPE:  ASSEM MACRO                                        * 00090400
*                                                                     * 00090500
*02*   PROCESSOR:  ASSEM                                              * 00090600
*                                                                     * 00090700
*01* COMPONENT:  SCWLM                                                * 00090800
*                                                                     * 00090900
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00091000
*                                                                     * 00091100
*01* EXAMPLES:                                                        * 00091200
*                                                                     * 00091300
*01* MACRO USAGE NOTES:                                               * 00091400
*                                                                     * 00091500
*                                                                     * 00091600
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00091700
*        global macro variable.  Any value other than 'NO' will       * 00091800
*        result in the macro expansion being printed.  The default is * 00091900
*        'YES'.  The following examples illustrate how the ZPRINT     * 00092000
*        variable should be set.                                      * 00092100
*                                                                     * 00092200
*                    GBLC &ZPRINT                                     * 00092300
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00092400
*                                                                     * 00092500
*                                                                     * 00092600
*    2.  The IWM4MCRE macro supports multiple versions. The macro key * 00092700
*        list  below  contains the version level in which the key was * 00092800
*        first  introduced.  Positionals  are  identified by the word * 00092900
*        'Positional'  followed by the numeric value of its position. * 00093000
*        Nested  positionals  are  preceded  by their outer key.  The * 00093100
*        lowest value represents the original version and the highest * 00093200
*        value  represents  the  most  recent version of the IWM4MCRE * 00093300
*        macro.    When  specifying  PLISTVER,  be sure that it is at * 00093400
*        least  as high as the highest version number of all the keys * 00093500
*        being used.                                                  * 00093600
*                                                                     * 00093700
*        VERSION   KEY                                                * 00093800
*                                                                     * 00093900
*              0      AMOUNT                                          * 00094000
*                     CONNTKN                                         * 00094100
*                     MONTKN                                          * 00094200
*                     MONTKN_LIST                                     * 00094300
*                     MONTKN_LISTLEN                                  * 00094400
*                     MONTKNKEY                                       * 00094500
*                     MONTKNKEYP                                      * 00094600
*                     REPORTONLY                                      * 00094700
*                     REQTYPE                                         * 00094800
*                     SUBSYS                                          * 00094900
*                     SUBSYSNM                                        * 00095000
*                     SUBSYSP                                         * 00095100
*              1      BPMGMTONLY                                      * 00095200
*                     EWLM                                            * 00095300
*                     GROUPNM                                         * 00095400
*                     GROUPNM_LEN                                     * 00095500
*              2      ALLOCATEBELOW                                   * 00095600
*                     LISTLEN                                         * 00095700
*                     MONTKN64                                        * 00095800
*                     MONTKN64_LIST                                   * 00095900
*                                                                     * 00096000
*                                                                     * 00096100
*                                                                     * 00096200
*01* CHANGE ACTIVITY:                                                 * 00096300
*                                                                     * 00096400
*   Flag LineItem  FMID    Date   ID    Comment                       * 00096500
*                                                                     * 00096600
*    $L0=WLMP64W  HBB7709 030315 3241NN:  WLM 64-bit support copied   * 00096700
*                                         from IWMMCREA with flag L3  * 00096800
*    $L1=WLMPERS  HBB7730 041202 3241GB:  EWLM Support                * 00096900
*    $P1=BLDCHKE  HBB7730 050919 3241BH:  No code change. ToolReq     * 00097000
*                                         5983 -                      * 00097100
*                                         B390.HBB7730.DRIVER5A.OC    * 00097200
*                                         OCHKE fixes.                * 00097300
*    $L2=WLMPDBM  HBB7730 060111 3241AA:  Dynamic Buffer Pool         * 00097400
*                                         management GA Support       * 00097500
*    $L3=LPBABV   HBB7790 111021 3241AH:  PB above 2G                 * 00097600
*    $P2=ME25965  HBB7790 103112 3241AH:  AB S004E 084 DYNSTRT        * 00097700
*                                         DSNYSIRM DSNY ECTE REGS     * 00097800
*                                         0CDB4 0B24B BRIANT          * 00097900
*    $P3=ME25121  HBB7790 110612 3241AH:  key used MONTKN64_LIST      * 00098000
*    $P4=OA45023  HBB7790 140422 3241AK:  MONTKN, MONTKN_LIST and     * 00098100
*                                         MONTKN_LISTLEN has the      * 00098200
*                                         wrong parameterlist         * 00098300
*                                         version.                    * 00098400
*    $P5=OA49557  HBB7790 151209 3241AH:  MONTKN_LIST and             * 00098500
*                                         MONTKN_LISTLEN parameter    * 00098600
*                                         list entries have the wrong * 00098700
*                                         parameterlist version.      * 00098800
****** END OF SPECIFICATIONS *****************************************/ 00098900
*/********************************************************************* 00099000
         MACRO                                                          00099100
&XLABEL  IWM4MCRE &REQTYPE=,&MONTKN=,&MONTKN64=,&ALLOCATEBELOW=,       *00099200
               &AMOUNT=,&MONTKN_LIST=,&MONTKN64_LIST=,&MONTKN_LISTLEN=,*00099300
               &LISTLEN=,&REPORTONLY=,&BPMGMTONLY=,&SUBSYSP=,&CONNTKN=,*00099400
               &SUBSYS=,&SUBSYSNM=,&EWLM=,&GROUPNM=,&GROUPNM_LEN=,     *00099500
               &MONTKNKEYP=,&MONTKNKEY=,&RETCODE=,&RSNCODE=,&PLISTVER=,*00099600
               &MF=                                                     00099700
.*                                                                      00099800
*                    MACDATE -02/15/16-<2>                              00099900
.*                                                                      00100000
.*******************************************************************    00100100
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00100200
.*******************************************************************    00100300
                    GBLC  &ZPRINT     YES=PRINT NO=NO PRINT             00100400
                    GBLC  &ZTEST      YES=TEST NO=NO TEST               00100500
                    GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX       00100600
.*                                                                      00100700
                    GBLC  &ZIWM4MCRE  YES=MACRO USED AT LEAST ONCE      00100800
.*******************************************************************    00100900
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00101000
.*******************************************************************    00101100
                    LCLC  &ZMS        ERROR MESSAGE WORK AREA           00101200
                    LCLC  &ZCNDX      SYSNDX CHARACTERS                 00101300
                    LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED        00101400
                    LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR       00101500
                    LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE       00101600
                    LCLA  &ZAWRK      USED AS A WORK AREA               00101700
                    LCLA  &ZASIZ      USED FOR SIZE OF VALUE            00101800
                    LCLA  &ZN         NUMERIC WORK VARIABLE             00101900
                    LCLC  &ZC         CHARACTER WORK VARIABLE           00102000
                    LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE       00102100
                    LCLA  &ZTLA       VALUE TOO LONG VARIABLE           00102200
                    LCLC  &ZMAC_G     "G" or null                       00102300
&ZMAC_G             SETC  ''                                            00102400
                    LCLC  &ZMAC_LR                                      00102500
&ZMAC_LR            SETC  'LR'                                          00102600
                    LCLC  &ZMAC_L                                       00102700
&ZMAC_L             SETC  'L'                                           00102800
                    LCLC  &ZMAC_ST                                      00102900
&ZMAC_ST            SETC  'ST'                                          00103000
                    LCLC  &ZMAC_LLGT                                    00103100
&ZMAC_LLGT          SETC  'L'                                           00103200
                    LCLC  &ZMAC_LGR                                     00103300
&ZMAC_LGR           SETC  'LR'                                          00103400
                    LCLC  &ZMAC_LG                                      00103500
&ZMAC_LG            SETC  'L'                                           00103600
                    LCLC  &ZMAC_STG                                     00103700
&ZMAC_STG           SETC  'ST'                                          00103800
                    LCLA  &ZMACRET    MACRO RETURN CODE                 00103900
&ZMACRET            SETA  0           ASSUME NO ERRORS                  00104000
.*                                                                      00104100
                    LCLC  &ZCSYSLIST(255)       NONXKEY, POS ARRAY      00104200
                    LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()        00104300
                    LCLA  &ZPLLEN     PARAMETER LIST LENGTH             00104400
                    LCLC  &ZENDBASEPL           End of base PL          00104500
                    LCLA  &ZPLWORKA   PARAMETER LIST LENGTH             00104600
.*******************************************************************    00104700
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00104800
.*******************************************************************    00104900
                    LCLA  &ZI         INDEX FOR ARRAY                   00105000
                    LCLA  &ZJ         INDEX FOR PARMS                   00105100
                    LCLA  &ZK         INDEX FOR PARSE                   00105200
                    LCLA  &ZLO        LOW RANGE VALUE                   00105300
                    LCLA  &ZHI        HIGH RANGE VALUE                  00105400
                    LCLC  &ZW         WORK AREA FOR PARM                00105500
.********************************************************************   00105600
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00105700
.********************************************************************   00105800
                    GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL           00105900
                    GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE    00106000
                    GBLA  &SYSALVL    SYSSTATE ARCHLVL                  00106100
                    GBLC  &SYSAM64    SYSSTATE AMODE64                  00106200
.*                                                                      00106300
                    AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED    00106400
                    AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED     00106500
                    SPLEVEL  TEST                                       00106600
.ZSYS2              ANOP  ,                                             00106700
                    AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1         00106800
                    AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1         00106900
                    SYSSTATE TEST                                       00107000
                    AGO   .ZSYS4                                        00107100
.ZSYS3              ANOP  ,                                             00107200
&SYSASCE            SETC  'P'         ASSUME SYSSTATE PRIMARY           00107300
.ZSYS4              ANOP  ,                                             00107400
                    AIF   ('&SYSAM64' NE 'YES').ZSYSN64                 00107500
&ZMAC_LLGT          SETC 'LLGT'                                         00107600
&ZMAC_LGR           SETC 'LGR'                                          00107700
&ZMAC_LG            SETC 'LG'                                           00107800
&ZMAC_STG           SETC 'STG'                                          00107900
.ZSYSN64            ANOP  ,                                             00108000
&ZMAC_G             SETC 'G'                                            00108100
&ZMAC_LR            SETC 'LGR'                                          00108200
&ZMAC_L             SETC 'LG'                                           00108300
&ZMAC_ST            SETC 'STG'                                          00108400
.*******************************************************************    00108500
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00108600
.*******************************************************************    00108700
                    LCLC  &XREQTYPE   ++ VALUE                          00108800
                    LCLC  &XUSEDMONTKNKEY       ++ NAME                 00108900
                    LCLC  &XMONTKN    ++ NAME                           00109000
                    LCLC  &XMONTKN64  ++ NAME                           00109100
                    LCLC  &XALLOCATEBELOW       ++ VALUE                00109200
                    LCLC  &XAMOUNT    ++ NAME                           00109300
                    LCLC  &XUSEDMTKNLISTKEY     ++ NAME                 00109400
                    LCLC  &XMONTKN_LIST         ++ NAME                 00109500
                    LCLC  &XMONTKN64_LIST       ++ NAME                 00109600
                    LCLC  &XUSEDLISTLENKEY      ++ NAME                 00109700
                    LCLC  &XMONTKN_LISTLEN      ++ NAME                 00109800
                    LCLC  &XLISTLEN   ++ NAME                           00109900
                    LCLC  &XREPORTONLY          ++ VALUE                00110000
                    LCLC  &XBPMGMTONLY          ++ VALUE                00110100
                    LCLC  &XSUBSYSP   ++ VALUE                          00110200
                    LCLC  &XCONNTKN   ++ NAME                           00110300
                    LCLC  &XSUBSYS    ++ NAME                           00110400
                    LCLC  &XSUBSYSNM  ++ NAME                           00110500
                    LCLC  &XEWLM      ++ VALUE                          00110600
                    LCLC  &XGROUPNM   ++ NAME                           00110700
                    LCLC  &XGROUPNM_LEN         ++ NAME                 00110800
                    LCLC  &XMONTKNKEYP          ++ VALUE                00110900
                    LCLC  &XMONTKNKEY           ++ NAME                 00111000
                    LCLC  &XRETCODE   ++ NAME                           00111100
                    LCLC  &XRSNCODE   ++ NAME                           00111200
                    LCLA  &XPLISTVER  ++ VALUE                          00111300
                    LCLC  &XMF        ++ VALUE                          00111400
                    LCLC  &XMFCTRL    ++ NAME                           00111500
                    LCLC  &XMFATTR    ++ VALUE                          00111600
                    LCLC  &XMFSCK     ++ VALUE                          00111700
.*******************************************************************    00111800
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00111900
.*******************************************************************    00112000
                    LCLC  &ZXREQTYPE  ++ INPUT VALUE                    00112100
                    LCLC  &ZXUSEDMONTKNKEY      ++ OUTPUT NAME          00112200
                    LCLC  &ZXMONTKN   ++ OUTPUT NAME                    00112300
                    LCLC  &ZXMONTKN64           ++ OUTPUT NAME          00112400
                    LCLC  &ZXALLOCATEBELOW      ++ INPUT VALUE          00112500
                    LCLC  &ZXAMOUNT   ++ INPUT NAME                     00112600
                    LCLC  &ZXUSEDMTKNLISTKEY    ++ INPUT NAME           00112700
                    LCLC  &ZXMONTKN_LIST        ++ INPUT NAME           00112800
                    LCLC  &ZXMONTKN64_LIST      ++ INPUT NAME           00112900
                    LCLC  &ZXUSEDLISTLENKEY     ++ INPUT NAME           00113000
                    LCLC  &ZXMONTKN_LISTLEN     ++ INPUT NAME           00113100
                    LCLC  &ZXLISTLEN  ++ INPUT NAME                     00113200
                    LCLC  &ZXREPORTONLY         ++ INPUT VALUE          00113300
                    LCLC  &ZXBPMGMTONLY         ++ INPUT VALUE          00113400
                    LCLC  &ZXSUBSYSP  ++ INPUT VALUE                    00113500
                    LCLC  &ZXCONNTKN  ++ INPUT NAME                     00113600
                    LCLC  &ZXSUBSYS   ++ INPUT NAME                     00113700
                    LCLC  &ZXSUBSYSNM           ++ INPUT NAME           00113800
                    LCLC  &ZXEWLM     ++ INPUT VALUE                    00113900
                    LCLC  &ZXGROUPNM  ++ INPUT NAME                     00114000
                    LCLC  &ZXGROUPNM_LEN        ++ INPUT NAME           00114100
                    LCLC  &ZXMONTKNKEYP         ++ INPUT VALUE          00114200
                    LCLC  &ZXMONTKNKEY          ++ INPUT NAME           00114300
                    LCLC  &ZXRETCODE  ++ OUTPUT NAME                    00114400
                    LCLC  &ZXRSNCODE  ++ OUTPUT NAME                    00114500
                    LCLC  &ZXPLISTVER           ++ INPUT VALUE          00114600
                    LCLC  &ZXMF       ++ INPUT VALUE                    00114700
                    LCLC  &ZXMFCTRL   ++ INPUT NAME                     00114800
                    LCLC  &ZXMFATTR   ++ INPUT VALUE                    00114900
                    LCLC  &ZXMFSCK    ++ INPUT VALUE                    00115000
.********************************************************************   00115100
.***AC.PLV01  PROCESS PLISTVER                                      *   00115200
.********************************************************************   00115300
&XPLISTVER      SETA  0                                                 00115400
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00115500
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00115600
&XPLISTVER      SETA  2                                                 00115700
.ZPLV0          ANOP  ,                                                 00115800
.*                                                                      00115900
                AIF   ('&MONTKN64' EQ '').ZPLV1E                        00116000
                AIF   (&XPLISTVER GE 2).ZPLV1E                          00116100
&XPLISTVER      SETA  2                                                 00116200
.ZPLV1E         ANOP  ,                                                 00116300
.*                                                                      00116400
                AIF   ('&ALLOCATEBELOW' EQ '').ZPLV2E                   00116500
                AIF   (&XPLISTVER GE 2).ZPLV2E                          00116600
&XPLISTVER      SETA  2                                                 00116700
.ZPLV2E         ANOP  ,                                                 00116800
.*                                                                      00116900
                AIF   ('&MONTKN64_LIST' EQ '').ZPLV3E                   00117000
                AIF   (&XPLISTVER GE 2).ZPLV3E                          00117100
&XPLISTVER      SETA  2                                                 00117200
.ZPLV3E         ANOP  ,                                                 00117300
.*                                                                      00117400
                AIF   ('&ALLOCATEBELOW' EQ '').ZPLV4E                   00117500
                AIF   (&XPLISTVER GE 2).ZPLV4E                          00117600
&XPLISTVER      SETA  2                                                 00117700
.ZPLV4E         ANOP  ,                                                 00117800
.*                                                                      00117900
                AIF   ('&LISTLEN' EQ '').ZPLV5E                         00118000
                AIF   (&XPLISTVER GE 2).ZPLV5E                          00118100
&XPLISTVER      SETA  2                                                 00118200
.ZPLV5E         ANOP  ,                                                 00118300
.*                                                                      00118400
                AIF   ('&BPMGMTONLY' EQ '').ZPLV6E                      00118500
                AIF   (&XPLISTVER GE 1).ZPLV6E                          00118600
&XPLISTVER      SETA  1                                                 00118700
.ZPLV6E         ANOP  ,                                                 00118800
.*                                                                      00118900
                AIF   ('&EWLM' EQ '').ZPLV7E                            00119000
                AIF   (&XPLISTVER GE 1).ZPLV7E                          00119100
&XPLISTVER      SETA  1                                                 00119200
.ZPLV7E         ANOP  ,                                                 00119300
.*                                                                      00119400
                AIF   ('&GROUPNM' EQ '').ZPLV8E                         00119500
                AIF   (&XPLISTVER GE 1).ZPLV8E                          00119600
&XPLISTVER      SETA  1                                                 00119700
.ZPLV8E         ANOP  ,                                                 00119800
.*                                                                      00119900
                AIF   ('&GROUPNM_LEN' EQ '').ZPLV9E                     00120000
                AIF   (&XPLISTVER GE 1).ZPLV9E                          00120100
&XPLISTVER      SETA  1                                                 00120200
.ZPLV9E         ANOP  ,                                                 00120300
.*                                                                      00120400
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00120500
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00120600
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00120700
.*-------------------------------------------------------------------   00120800
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00120900
&ZMS            SETC  '"PLISTVER='                                      00121000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00121100
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00121200
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00121300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00121400
                AGO   .ZPVCK2                                           00121500
.ZPVCK3         ANOP  ,                                                 00121600
.*-------------------------------------------------------------------   00121700
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00121800
&ZMS            SETC  '"PLISTVER='                                      00121900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00122000
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00122100
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00122200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00122300
                AGO   .ZPVCKE                                           00122400
.ZPVCK2         ANOP  ,                                                 00122500
.*-------------------------------------------------------------------   00122600
&ZCVAL          SETC  '&PLISTVER(1)'                                    00122700
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00122800
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00122900
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00123000
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00123100
                AIF   (&ZN LE 2).ZPVCK4A   NOT HIGH                     00123200
.ZPVCK6         ANOP  ,                                                 00123300
&ZMS            SETC  '"PLISTVER='                                      00123400
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00123500
&ZMS            SETC  '&ZMS THE RANGE IS "0-2"'                         00123600
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00123700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00123800
&XPLISTVER      SETA  2                                                 00123900
                AGO   .ZPVCKE                                           00124000
.*-------------------------------------------------------------------   00124100
.ZPVCK4A        ANOP  ,                                                 00124200
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00124300
&ZMS            SETC  'PLISTVER='                                       00124400
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00124500
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00124600
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00124700
                MNOTE 8,' &ZMS IS REQUIRED.'                            00124800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00124900
                AGO   .ZPVCK5                                           00125000
.ZPVCK4         ANOP  ,                                                 00125100
&XPLISTVER      SETA  &PLISTVER(1)                                      00125200
.ZPVCK5         ANOP  ,                                                 00125300
.ZPVCKE         ANOP  ,                                                 00125400
.********************************************************************   00125500
.***AG.MF01 PROCESS MF MACRO FORMS                                      00125600
.********************************************************************   00125700
                    ACTR  10000                                         00125800
.*------------------------------------------------------------------    00125900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126000
&XMF                SETC  ''          INITIALIZE XVARIABLE              00126100
.*-------------------------------------------------------------------   00126200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126300
.ZG85               ANOP  ,                                             00126400
&ZTLC               SETC 'S'                                            00126500
                    AIF   ('&MF(1)' NE '&ZTLC').ZG86                    00126600
&XMF                SETC  'S'         SET KEYWORD                       00126700
                    AIF   (N'&MF LE 1).ZG85A    CK NUM                  00126800
&ZMS                SETC  '"MF='                                        00126900
&ZMS                SETC  '&ZMS.&MF"'                                   00127000
&ZMS                SETC  '&ZMS "MF"'                                   00127100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00127200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00127300
.ZG85A              ANOP  ,                                             00127400
.*-------------------------------------------------------------------   00127500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127600
.ZG86               ANOP  ,                                             00127700
&ZTLC               SETC 'L'                                            00127800
                    AIF   ('&MF(1)' NE '&ZTLC').ZG93                    00127900
&XMF                SETC  'L'         SET KEYWORD                       00128000
                    AIF   (N'&MF LE 3).ZG86A    CK NUM                  00128100
&ZMS                SETC  '"MF='                                        00128200
&ZMS                SETC  '&ZMS.&MF"'                                   00128300
&ZMS                SETC  '&ZMS "MF"'                                   00128400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00128500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00128600
.ZG86A              ANOP  ,                                             00128700
.*-------------------------------------------------------------------   00128800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00128900
                    AIF   (N'&SYSLIST NE 0).ZG86B  POSITIONALS?         00129000
                    AIF   ('&REQTYPE' NE '').ZG86B  KEYS?               00129100
                    AIF   ('&MONTKN' NE '').ZG86B  KEYS?                00129200
                    AIF   ('&MONTKN64' NE '').ZG86B  KEYS?              00129300
                    AIF   ('&ALLOCATEBELOW' NE '').ZG86B  KEYS?         00129400
                    AIF   ('&AMOUNT' NE '').ZG86B  KEYS?                00129500
                    AIF   ('&MONTKN_LIST' NE '').ZG86B  KEYS?           00129600
                    AIF   ('&MONTKN64_LIST' NE '').ZG86B  KEYS?         00129700
                    AIF   ('&MONTKN_LISTLEN' NE '').ZG86B  KEYS?        00129800
                    AIF   ('&LISTLEN' NE '').ZG86B  KEYS?               00129900
                    AIF   ('&REPORTONLY' NE '').ZG86B  KEYS?            00130000
                    AIF   ('&BPMGMTONLY' NE '').ZG86B  KEYS?            00130100
                    AIF   ('&SUBSYSP' NE '').ZG86B  KEYS?               00130200
                    AIF   ('&CONNTKN' NE '').ZG86B  KEYS?               00130300
                    AIF   ('&SUBSYS' NE '').ZG86B  KEYS?                00130400
                    AIF   ('&SUBSYSNM' NE '').ZG86B  KEYS?              00130500
                    AIF   ('&EWLM' NE '').ZG86B  KEYS?                  00130600
                    AIF   ('&GROUPNM' NE '').ZG86B  KEYS?               00130700
                    AIF   ('&GROUPNM_LEN' NE '').ZG86B  KEYS?           00130800
                    AIF   ('&MONTKNKEYP' NE '').ZG86B  KEYS?            00130900
                    AIF   ('&MONTKNKEY' NE '').ZG86B  KEYS?             00131000
                    AIF   ('&RETCODE' NE '').ZG86B  KEYS?               00131100
                    AIF   ('&RSNCODE' NE '').ZG86B  KEYS?               00131200
                    AGO    .ZG86C     INVOCATION OKAY                   00131300
.ZG86B              ANOP  ,                                             00131400
&ZMS                SETC  'THE "L" FORM OF "MF"'                        00131500
&ZMS                SETC  '&ZMS CAN ONLY HAVE'                          00131600
&ZMS                SETC  '&ZMS THE "PLISTVER" KEY'                     00131700
                    MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'        00131800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00131900
.ZG86C              ANOP  ,                                             00132000
.*-------------------------------------------------------------------   00132100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00132200
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00132300
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00132400
                    AIF   (N'&MF(2) GT 1).ZG88B  MULTI                  00132500
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00132600
.ZG88B              AIF   (K'&MF(2) GT 0).ZG88C                         00132700
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00132800
&ZMS                SETC  ' '                                           00132900
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00133000
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00133100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00133200
.ZG88C              ANOP  ,                                             00133300
.*-------------------------------------------------------------------   00133400
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00133500
                    AIF   (K'&ZXMFCTRL LE 0).ZG88P  NOT I/O             00133600
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG88P                00133700
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00133800
&ZMS                SETC  '"MF='                                        00133900
&ZMS                SETC  '&ZMS.&MF"'                                   00134000
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00134100
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'             00134200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00134300
.ZG88P              ANOP  ,                                             00134400
.*-------------------------------------------------------------------   00134500
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00134600
&ZXMFATTR           SETC  'INPUT'     SET IN/OUTPUT                     00134700
&XMFATTR            SETC  '0D'                                          00134800
                    AIF   (K'&MF(3) LE 0).ZG91B  PARM                   00134900
&XMFATTR            SETC  '&MF(3,1)'  SET XVARIABLE                     00135000
                    AIF   (N'&MF(3) GT 1).ZG91B  MULTI                  00135100
&XMFATTR            SETC  '&MF(3)'    SET XVARIABLE                     00135200
.ZG91B              ANOP  ,                                             00135300
.*-------------------------------------------------------------------   00135400
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00135500
                    AIF   (K'&ZXMFATTR LE 0).ZG91P  NOT I/O             00135600
                    AIF   ('&XMFATTR'(1,1) NE '(').ZG91P                00135700
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00135800
&ZMS                SETC  '"MF='                                        00135900
&ZMS                SETC  '&ZMS.&MF"'                                   00136000
&ZMS                SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'     00136100
                    MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'             00136200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00136300
.ZG91P              ANOP  ,                                             00136400
.*-------------------------------------------------------------------   00136500
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00136600
                    AIF   (K'&ZXMFATTR LE 0).ZG91S  NOT I/O             00136700
                    AIF   (K'&XMFATTR LE 60).ZG91S  LNG OK              00136800
&ZXMFATTR           SETC  ''          RESET IN/OUTPUT                   00136900
&ZMS                SETC  '"MF='                                        00137000
&ZMS                SETC  '&ZMS.&MF"'                                   00137100
&ZMS                SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'         00137200
                    MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'            00137300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00137400
.ZG91S              ANOP  ,                                             00137500
.*-------------------------------------------------------------------   00137600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00137700
.ZG93               ANOP  ,                                             00137800
&ZTLC               SETC 'E'                                            00137900
                    AIF   ('&MF(1)' NE '&ZTLC').ZG101                   00138000
&XMF                SETC  'E'         SET KEYWORD                       00138100
                    AIF   (N'&MF LE 3).ZG93A    CK NUM                  00138200
&ZMS                SETC  '"MF='                                        00138300
&ZMS                SETC  '&ZMS.&MF"'                                   00138400
&ZMS                SETC  '&ZMS "MF"'                                   00138500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'          00138600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00138700
.ZG93A              ANOP  ,                                             00138800
.*-------------------------------------------------------------------   00138900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00139000
&ZXMFCTRL           SETC  'INPUT'     SET IN/OUTPUT                     00139100
&XMFCTRL            SETC  '&MF(2,1)'  SET XVARIABLE                     00139200
                    AIF   (N'&MF(2) GT 1).ZG95B  MULTI                  00139300
&XMFCTRL            SETC  '&MF(2)'    SET XVARIABLE                     00139400
.ZG95B              AIF   (K'&MF(2) GT 0).ZG95C                         00139500
&ZXMFCTRL           SETC  ''          RESET IN/OUTPUT                   00139600
&ZMS                SETC  ' '                                           00139700
&ZMS                SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'           00139800
                    MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                  00139900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00140000
.ZG95C              ANOP  ,                                             00140100
.*-------------------------------------------------------------------   00140200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00140300
                    AIF   (K'&ZXMFCTRL LE 0).ZG95R  NOT I/O             00140400
                    AIF   ('&XMFCTRL'(1,1) NE '(').ZG95R                00140500
&ZCGPR              SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                    00140600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG95P                  00140700
                    AIF   (K'&ZCGPR GT 2).ZG95Q                         00140800
                    AIF   ('&ZCGPR' EQ '0').ZG95Q                       00140900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00141000
                    AIF   (T'&ZCGPR NE 'N').ZG95Q  INVALID REG NAME     00141100
.ZG95P              ANOP  ,                                             00141200
                    AIF   (T'&ZCGPR NE 'N').ZG95R  NON NUMERIC          00141300
                    AIF   ('&ZCGPR' LT '1').ZG95Q                       00141400
                    AIF   ('&ZCGPR' LE '12').ZG95R                      00141500
.ZG95Q              ANOP  ,                                             00141600
&ZMS                SETC  '"MF='                                        00141700
&ZMS                SETC  '&ZMS.&MF"'                                   00141800
&ZMS                SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'     00141900
                    MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'              00142000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00142100
.ZG95R              ANOP  ,                                             00142200
.*-------------------------------------------------------------------   00142300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00142400
&XMFSCK             SETC  ''          INITIALIZE XVARIABLE              00142500
.ZG99A   AIF   ('&MF(3)' NE 'COMPLETE').ZG100A                          00142600
&XMFSCK             SETC  'COMPLETE'  SET KEYWORD                       00142700
.*-------------------------------------------------------------------   00142800
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00142900
.ZG100A             AIF   (K'&XMFSCK GT 0).ZG100C  KEYWORD              00143000
                    AIF   (K'&MF(3) LE 0).ZG100B                        00143100
&ZMS                SETC  '"MF='                                        00143200
&ZMS                SETC  '&ZMS.&MF"'                                   00143300
&ZMS                SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '     00143400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00143500
&ZMS                SETC  '&ZMS "COMPLETE".'                            00143600
                    MNOTE 8,' &ZMS '                                    00143700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00143800
.ZG100B             ANOP  ,                                             00143900
&XMFSCK             SETC  'COMPLETE'  SET DEFAULT KEYWORD               00144000
.ZG100C             ANOP  ,                                             00144100
&ZXMFSCK            SETC  'INPUT'     SET IN/OUTPUT                     00144200
.*------------------------------------------------------------------    00144300
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00144400
.ZG101              ANOP  ,                                             00144500
&ZXMF               SETC  'INPUT'     SET IN/OUTPUT                     00144600
                    AIF   (K'&XMF GT 0).ZG101E  VALID ARG               00144700
                    AIF   (T'&MF EQ 'O').ZG101D  OMITTED                00144800
&ZASYSLNDX          SETA  0                                             00144900
.ZG101A             ANOP  ,           POSITIONAL MACRO KEY              00145000
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00145100
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG101C             00145200
&ZTLC               SETC 'MF'                                           00145300
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG101A    00145400
.ZG101B             ANOP  ,                                             00145500
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00145600
&ZMS                SETC  'THE "MF" KEY'                                00145700
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00145800
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00145900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00146000
                    AGO   .ZG101E                                       00146100
.ZG101C             ANOP  ,                                             00146200
&ZXMF               SETC  ''          RESET IN/OUTPUT                   00146300
&ZMS                SETC  '"MF='                                        00146400
&ZMS                SETC  '&ZMS.&MF"'                                   00146500
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00146600
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00146700
&ZMS                SETC  '&ZMS "S",'                                   00146800
&ZMS                SETC  '&ZMS "L",'                                   00146900
&ZMS                SETC  '&ZMS OR "E".'                                00147000
                    MNOTE 8,' &ZMS '                                    00147100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00147200
                    AGO   .ZG101E                                       00147300
.ZG101D             ANOP  ,                                             00147400
&XMF                SETC  'S'         SET DEFAULT KEYWORD               00147500
&XMFSCK             SETC  'COMPLETE'  COMPLETE CHECKING                 00147600
.ZG101E             ANOP  ,                                             00147700
.********************************************************************   00147800
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00147900
.********************************************************************   00148000
                    ACTR  10000                                         00148100
.*-------------------------------------------------------------------   00148200
.***AG.MF03 MF=(SLE)                                                    00148300
                    AIF   ('&XMF' EQ 'L').ZGMFX                         00148400
.*------------------------------------------------------------------    00148500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148600
&XREQTYPE           SETC  ''          INITIALIZE XVARIABLE              00148700
.*-------------------------------------------------------------------   00148800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148900
.ZG3                ANOP  ,                                             00149000
                    AIF   (K'&REQTYPE(1) LE 0).ZG3A                     00149100
&ZTLC               SETC 'SINGLE'                                       00149200
                    AIF   ('&REQTYPE(1)' NE '&ZTLC').ZG13               00149300
&XREQTYPE           SETC  'SINGLE'    SET KEYWORD                       00149400
                    AIF   (N'&REQTYPE LE 1).ZG3A  CK NUM                00149500
&ZMS                SETC  '"REQTYPE='                                   00149600
&ZMS                SETC  '&ZMS.&REQTYPE"'                              00149700
&ZMS                SETC  '&ZMS "REQTYPE"'                              00149800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00149900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00150000
.ZG3A               ANOP  ,                                             00150100
.*------------------------------------------------------------------    00150200
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00150300
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00150400
.ZG3A0              AIF   (K'&AMOUNT LE 0).ZG3A1  OK                    00150500
&ZCVAL              SETC '&ZCVAL AMOUNT'        INCORRECT KEY USED      00150600
.ZG3A1              AIF   (K'&MONTKN_LIST LE 0).ZG3A2  OK               00150700
&ZCVAL              SETC '&ZCVAL MONTKN_LIST'   INCORRECT KEY USED      00150800
.ZG3A2              AIF   (K'&MONTKN64_LIST LE 0).ZG3A3  OK             00150900
&ZCVAL              SETC '&ZCVAL MONTKN64_LIST'  INCORRECT KEY USED     00151000
.ZG3A3              AIF   (K'&MONTKN_LISTLEN LE 0).ZG3A4  OK            00151100
&ZCVAL              SETC '&ZCVAL MONTKN_LISTLEN'  INCORRECT KEY USED    00151200
.ZG3A4              AIF   (K'&LISTLEN LE 0).ZG3A5  OK                   00151300
&ZCVAL              SETC '&ZCVAL LISTLEN'       INCORRECT KEY USED      00151400
.ZG3A5              AIF   (K'&ZCVAL LE 0).ZG3A6  OK                     00151500
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00151600
&ZMS                SETC  '"REQTYPE'                                    00151700
&ZMS                SETC  '&ZMS.=&REQTYPE"'                             00151800
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00151900
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00152000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00152100
.ZG3A6              ANOP  ,                                             00152200
.*----------------------------------------------------------------***   00152300
.***AG.KMEKY01 NAME, OPT RQD OUTPUT, ME KEYS -XVARIABLE                 00152400
&XUSEDMONTKNKEY     SETC  ''          INITIALIZE XVARIABLE              00152500
                    AIF   (K'&MONTKN LE 0).ZG5C                         00152600
&ZXUSEDMONTKNKEY    SETC  'OUTPUT'    SET IN/OUTPUT                     00152700
&XUSEDMONTKNKEY     SETC  'MONTKN'    SET XVARIABLE                     00152800
&ZXMONTKN           SETC  'OUTPUT'    SET IN/OUTPUT                     00152900
&XMONTKN            SETC  '&MONTKN(1)'          SET XVARIABLE PARM      00153000
                    AIF   (N'&MONTKN GT 1).ZG5A                         00153100
&XMONTKN            SETC  '&MONTKN'   SET XVARIABLE PARM                00153200
.ZG5A               AIF   (N'&MONTKN LE 1).ZG5B  CK NUM                 00153300
&ZMS                SETC  '"MONTKN='                                    00153400
&ZMS                SETC  '&ZMS.&MONTKN"'                               00153500
&ZMS                SETC  '&ZMS "MONTKN"'                               00153600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00153700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00153800
.ZG5B               AIF   (K'&XMONTKN GT 0).ZG5C  ONE PARM              00153900
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00154000
&ZXMONTKN           SETC  ''          RESET IN/OUTPUT                   00154100
&ZMS                SETC  ' '                                           00154200
&ZMS                SETC  '&ZMS "MONTKN" KEY AND ITS'                   00154300
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00154400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00154500
.ZG5C               ANOP  ,                                             00154600
.*----------------------------------------------------------------***   00154700
.***AG.KMEKY02 NAME, OPT RQD OUTPUT, ME KEYS -XVARIABLE                 00154800
                    AIF   (K'&MONTKN64 LE 0).ZG6D  NO ME KEY            00154900
                    AIF   (N'&MONTKN64 LE 1).ZG6A  CK NUM               00155000
&ZMS                SETC  '"MONTKN64='                                  00155100
&ZMS                SETC  '&ZMS.&MONTKN64"'                             00155200
&ZMS                SETC  '&ZMS "MONTKN64"'                             00155300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00155400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00155500
.ZG6A               AIF   (K'&XUSEDMONTKNKEY LE 0).ZG6B                 00155600
&ZMS                SETC  '"MONTKN64'                                   00155700
&ZMS                SETC  '&ZMS.=&MONTKN64"'                            00155800
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00155900
&ZMS                SETC  '&ZMS "&XUSEDMONTKNKEY"'                      00156000
                    MNOTE 8,' &ZMS KEY.'                                00156100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00156200
                    AGO   .ZG6D                                         00156300
.*                                                                      00156400
.ZG6B               ANOP  ,                                             00156500
&ZXUSEDMONTKNKEY    SETC  'OUTPUT'    SET IN/OUTPUT                     00156600
&XUSEDMONTKNKEY     SETC  'MONTKN64'  SET XVARIABLE                     00156700
&ZXMONTKN64         SETC  'OUTPUT'    SET IN/OUTPUT                     00156800
&XMONTKN64          SETC  '&MONTKN64(1)'        SET XVARIABLE PARM      00156900
                    AIF   (N'&MONTKN64 GT 1).ZG6C                       00157000
&XMONTKN64          SETC  '&MONTKN64'           SET XVARIABLE PARM      00157100
.ZG6C               AIF   (K'&XMONTKN64 GT 0).ZG6D  ONE PARM            00157200
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00157300
&ZXMONTKN64         SETC  ''          RESET IN/OUTPUT                   00157400
&ZMS                SETC  ' '                                           00157500
&ZMS                SETC  '&ZMS "MONTKN64" KEY AND ITS'                 00157600
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00157700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00157800
.ZG6D               ANOP  ,                                             00157900
.*------------------------------------------------------------------    00158000
.***AG.KME4Y09 NAME, OPT RQD OUTPUT, ME KEYS -CHECK IF KEY ENTERED      00158100
                    AIF   (K'&XUSEDMONTKNKEY GT 0).ZG12B                00158200
&ZXUSEDMONTKNKEY    SETC  ''          RESET IN/OUTPUT                   00158300
&ZXMONTKN           SETC  ''          RESET IN/OUTPUT                   00158400
&XUSEDMONTKNKEY     SETC  ''          ENSURE NULL                       00158500
&XMONTKN            SETC  ''          ENSURE NULL                       00158600
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00158700
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00158800
&ZMS                SETC  '&ZMS REQUIRED:'                              00158900
&ZMS                SETC  '&ZMS "MONTKN"'       VALID ME KEY            00159000
&ZMS                SETC  '&ZMS OR "MONTKN64".'  VALID ME KEY           00159100
                    MNOTE 8,' &ZMS '                                    00159200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00159300
.ZG12B              ANOP  ,                                             00159400
.*-------------------------------------------------------------------   00159500
.***AG.KMEKY13 NAME, OPT RQD OUTPUT, ME KEYS -PROCESS DEPENDENCIES      00159600
.ZG5ZY  AIF    ('&XUSEDMONTKNKEY' NE 'MONTKN').ZG6ZY                    00159700
.*-------------------------------------------------------------------   00159800
.***AG.KMEKY14 NAME, OPT RQD OUTPUT, ME KEYS -DISALLOWED KEYS           00159900
&ZCVAL              SETC ''           ERROR KEY FIELD                   00160000
.ZG5I0              AIF   (K'&ALLOCATEBELOW LE 0).ZG5I1                 00160100
&ZCVAL              SETC '&ZCVAL ALLOCATEBELOW'  DISALLOWED KEY         00160200
.ZG5I1              AIF   (K'&ZCVAL LE 0).ZG5J  KEY                     00160300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00160400
&ZMS                SETC  '"MONTKN'                                     00160500
&ZMS                SETC  '&ZMS.=&MONTKN"'                              00160600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00160700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00160800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00160900
.ZG5J               ANOP  ,                                             00161000
.*-------------------------------------------------------------------   00161100
.***AG.KCK02 NAME, OPT RQD OUTPUT, ME KEYS -GPR OUT OF RANGE            00161200
                    AIF   (K'&ZXMONTKN LE 0).ZG5R  NOT I/O              00161300
                    AIF   ('&XMONTKN'(1,1) NE '(').ZG5R                 00161400
&ZCGPR              SETC  '&XMONTKN'(2,K'&XMONTKN-2)                    00161500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                   00161600
                    AIF   (K'&ZCGPR GT 2).ZG5Q                          00161700
                    AIF   ('&ZCGPR' EQ '0').ZG5Q                        00161800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00161900
                    AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME      00162000
.ZG5P               ANOP  ,                                             00162100
                    AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC           00162200
                    AIF   ('&ZCGPR' LT '2').ZG5Q                        00162300
                    AIF   ('&ZCGPR' LE '12').ZG5R                       00162400
.ZG5Q               ANOP  ,                                             00162500
&ZMS                SETC  '"MONTKN='                                    00162600
&ZMS                SETC  '&ZMS.&MONTKN"'                               00162700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00162800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00162900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00163000
.ZG5R               ANOP  ,                                             00163100
.*-------------------------------------------------------------------   00163200
.***AG.KMEKY13 NAME, OPT RQD OUTPUT, ME KEYS -PROCESS DEPENDENCIES      00163300
.ZG6ZY  AIF    ('&XUSEDMONTKNKEY' NE 'MONTKN64').ZG12ZY                 00163400
.*-------------------------------------------------------------------   00163500
.***AG.KCK02 NAME, OPT RQD OUTPUT, ME KEYS -GPR OUT OF RANGE            00163600
                    AIF   (K'&ZXMONTKN64 LE 0).ZG6R  NOT I/O            00163700
                    AIF   ('&XMONTKN64'(1,1) NE '(').ZG6R               00163800
&ZCGPR              SETC  '&XMONTKN64'(2,K'&XMONTKN64-2)                00163900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                   00164000
                    AIF   (K'&ZCGPR GT 2).ZG6Q                          00164100
                    AIF   ('&ZCGPR' EQ '0').ZG6Q                        00164200
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00164300
                    AIF   (T'&ZCGPR NE 'N').ZG6Q  INVALID REG NAME      00164400
.ZG6P               ANOP  ,                                             00164500
                    AIF   (T'&ZCGPR NE 'N').ZG6R  NON NUMERIC           00164600
                    AIF   ('&ZCGPR' LT '2').ZG6Q                        00164700
                    AIF   ('&ZCGPR' LE '12').ZG6R                       00164800
.ZG6Q               ANOP  ,                                             00164900
&ZMS                SETC  '"MONTKN64='                                  00165000
&ZMS                SETC  '&ZMS.&MONTKN64"'                             00165100
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00165200
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00165300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00165400
.ZG6R               ANOP  ,                                             00165500
.*------------------------------------------------------------------    00165600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165700
&XALLOCATEBELOW     SETC  ''          INITIALIZE XVARIABLE              00165800
.*-------------------------------------------------------------------   00165900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00166000
.ZG9                ANOP  ,                                             00166100
                    AIF   (K'&ALLOCATEBELOW(1) LE 0).ZG9A               00166200
&ZTLC               SETC 'NO'                                           00166300
                    AIF   ('&ALLOCATEBELOW(1)' NE '&ZTLC').ZG10         00166400
&XALLOCATEBELOW     SETC  'NO'        SET KEYWORD                       00166500
                    AIF   (N'&ALLOCATEBELOW LE 1).ZG9A  CK NUM          00166600
&ZMS                SETC  '"ALLOCATEBELOW='                             00166700
&ZMS                SETC  '&ZMS.&ALLOCATEBELOW"'                        00166800
&ZMS                SETC  '&ZMS "ALLOCATEBELOW"'                        00166900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00167000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00167100
.ZG9A               ANOP  ,                                             00167200
.*-------------------------------------------------------------------   00167300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00167400
.ZG10               ANOP  ,                                             00167500
&ZTLC               SETC 'YES'                                          00167600
                    AIF   ('&ALLOCATEBELOW(1)' NE '&ZTLC').ZG11         00167700
&XALLOCATEBELOW     SETC  'YES'       SET KEYWORD                       00167800
                    AIF   (N'&ALLOCATEBELOW LE 1).ZG10A  CK NUM         00167900
&ZMS                SETC  '"ALLOCATEBELOW='                             00168000
&ZMS                SETC  '&ZMS.&ALLOCATEBELOW"'                        00168100
&ZMS                SETC  '&ZMS "ALLOCATEBELOW"'                        00168200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00168300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00168400
.ZG10A              ANOP  ,                                             00168500
.*------------------------------------------------------------------    00168600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00168700
.ZG11               ANOP  ,                                             00168800
&ZXALLOCATEBELOW    SETC  'INPUT'     SET IN/OUTPUT                     00168900
                    AIF   (K'&XALLOCATEBELOW GT 0).ZG11E  VALID ARG     00169000
                    AIF   (T'&ALLOCATEBELOW EQ 'O').ZG11D  OMITTED      00169100
&ZASYSLNDX          SETA  0                                             00169200
.ZG11A              ANOP  ,           POSITIONAL MACRO KEY              00169300
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00169400
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG11C              00169500
&ZTLC               SETC 'ALLOCATEBELOW'                                00169600
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG11A     00169700
.ZG11B              ANOP  ,                                             00169800
&ZXALLOCATEBELOW    SETC  ''          RESET IN/OUTPUT                   00169900
&ZMS                SETC  'THE "ALLOCATEBELOW" KEY'                     00170000
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00170100
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00170200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00170300
                    AGO   .ZG11E                                        00170400
.ZG11C              ANOP  ,                                             00170500
&ZXALLOCATEBELOW    SETC  ''          RESET IN/OUTPUT                   00170600
&ZMS                SETC  '"ALLOCATEBELOW='                             00170700
&ZMS                SETC  '&ZMS.&ALLOCATEBELOW"'                        00170800
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00170900
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00171000
&ZMS                SETC  '&ZMS "NO"'                                   00171100
&ZMS                SETC  '&ZMS OR "YES".'                              00171200
                    MNOTE 8,' &ZMS '                                    00171300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00171400
                    AGO   .ZG11E                                        00171500
.ZG11D              ANOP  ,                                             00171600
&XALLOCATEBELOW     SETC  'NO'        SET DEFAULT KEYWORD               00171700
.ZG11E              ANOP  ,                                             00171800
.*-------------------------------------------------------------------   00171900
.***AG.KMEKY15 NAME, OPT RQD OUTPUT, ME KEYS -END                       00172000
.ZG12ZY             ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00172100
.*-------------------------------------------------------------------   00172200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00172300
.ZG13               ANOP  ,                                             00172400
&ZTLC               SETC 'MULTIPLE'                                     00172500
                    AIF   ('&REQTYPE(1)' NE '&ZTLC').ZG30               00172600
&XREQTYPE           SETC  'MULTIPLE'  SET KEYWORD                       00172700
                    AIF   (N'&REQTYPE LE 1).ZG13A  CK NUM               00172800
&ZMS                SETC  '"REQTYPE='                                   00172900
&ZMS                SETC  '&ZMS.&REQTYPE"'                              00173000
&ZMS                SETC  '&ZMS "REQTYPE"'                              00173100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00173200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00173300
.ZG13A              ANOP  ,                                             00173400
.*------------------------------------------------------------------    00173500
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173600
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00173700
.ZG13A0             AIF   (K'&MONTKN LE 0).ZG13A1  OK                   00173800
&ZCVAL              SETC '&ZCVAL MONTKN'        INCORRECT KEY USED      00173900
.ZG13A1             AIF   (K'&MONTKN64 LE 0).ZG13A2  OK                 00174000
&ZCVAL              SETC '&ZCVAL MONTKN64'      INCORRECT KEY USED      00174100
.ZG13A2             AIF   (K'&ZCVAL LE 0).ZG13A3  OK                    00174200
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00174300
&ZMS                SETC  '"REQTYPE'                                    00174400
&ZMS                SETC  '&ZMS.=&REQTYPE"'                             00174500
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00174600
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00174700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00174800
.ZG13A3             ANOP  ,                                             00174900
.*----------------------------------------------------------------***   00175000
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00175100
                    AIF   (N'&AMOUNT LE 1).ZG15A  CK NUM                00175200
&ZMS                SETC  '"AMOUNT='                                    00175300
&ZMS                SETC  '&ZMS.&AMOUNT"'                               00175400
&ZMS                SETC  '&ZMS "AMOUNT"'                               00175500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00175600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00175700
.ZG15A              ANOP  ,                                             00175800
.*-------------------------------------------------------------------   00175900
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00176000
&ZXAMOUNT           SETC  'INPUT'     SET IN/OUTPUT                     00176100
&XAMOUNT            SETC  '&AMOUNT(1)'          SET XVARIABLE           00176200
                    AIF   (N'&AMOUNT GT 1).ZG15B  MULTI                 00176300
&XAMOUNT            SETC  '&AMOUNT'   SET XVARIABLE                     00176400
.ZG15B              AIF   (K'&AMOUNT(1) GT 0).ZG15C                     00176500
&ZXAMOUNT           SETC  ''          RESET IN/OUTPUT                   00176600
&ZMS                SETC  ' '                                           00176700
&ZMS                SETC  '&ZMS "AMOUNT" KEY AND ITS'                   00176800
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00176900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00177000
.ZG15C              ANOP  ,                                             00177100
.*-------------------------------------------------------------------   00177200
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00177300
                    AIF   (K'&ZXAMOUNT LE 0).ZG15R  NOT I/O             00177400
                    AIF   ('&XAMOUNT'(1,1) NE '(').ZG15R                00177500
&ZCGPR              SETC  '&XAMOUNT'(2,K'&XAMOUNT-2)                    00177600
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                  00177700
                    AIF   (K'&ZCGPR GT 2).ZG15Q                         00177800
                    AIF   ('&ZCGPR' EQ '0').ZG15Q                       00177900
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00178000
                    AIF   (T'&ZCGPR NE 'N').ZG15Q  INVALID REG NAME     00178100
.ZG15P              ANOP  ,                                             00178200
                    AIF   (T'&ZCGPR NE 'N').ZG15R  NON NUMERIC          00178300
                    AIF   ('&ZCGPR' LT '2').ZG15Q                       00178400
                    AIF   ('&ZCGPR' LE '12').ZG15R                      00178500
.ZG15Q              ANOP  ,                                             00178600
&ZMS                SETC  '"AMOUNT='                                    00178700
&ZMS                SETC  '&ZMS.&AMOUNT"'                               00178800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00178900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00179000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00179100
.ZG15R              ANOP  ,                                             00179200
.*----------------------------------------------------------------***   00179300
.***AG.KMEKY01 NAME, OPT RQD INPUT, ME KEYS -XVARIABLE                  00179400
&XUSEDMTKNLISTKEY   SETC  ''          INITIALIZE XVARIABLE              00179500
                    AIF   (K'&MONTKN_LIST LE 0).ZG18C                   00179600
&ZXUSEDMTKNLISTKEY  SETC  'INPUT'     SET IN/OUTPUT                     00179700
&XUSEDMTKNLISTKEY   SETC  'MONTKN_LIST'         SET XVARIABLE           00179800
&ZXMONTKN_LIST      SETC  'INPUT'     SET IN/OUTPUT                     00179900
&XMONTKN_LIST       SETC  '&MONTKN_LIST(1)'     SET XVARIABLE PARM      00180000
                    AIF   (N'&MONTKN_LIST GT 1).ZG18A                   00180100
&XMONTKN_LIST       SETC  '&MONTKN_LIST'        SET XVARIABLE PARM      00180200
.ZG18A              AIF   (N'&MONTKN_LIST LE 1).ZG18B  CK NUM           00180300
&ZMS                SETC  '"MONTKN_LIST='                               00180400
&ZMS                SETC  '&ZMS.&MONTKN_LIST"'                          00180500
&ZMS                SETC  '&ZMS "MONTKN_LIST"'                          00180600
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00180700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00180800
.ZG18B              AIF   (K'&XMONTKN_LIST GT 0).ZG18C  ONE PARM        00180900
&ZXUSEDMTKNLISTKEY  SETC  ''          RESET IN/OUTPUT                   00181000
&ZXMONTKN_LIST      SETC  ''          RESET IN/OUTPUT                   00181100
&ZMS                SETC  ' '                                           00181200
&ZMS                SETC  '&ZMS "MONTKN_LIST" KEY AND ITS'              00181300
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00181400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00181500
.ZG18C              ANOP  ,                                             00181600
.*----------------------------------------------------------------***   00181700
.***AG.KMEKY02 NAME, OPT RQD INPUT, ME KEYS -XVARIABLE                  00181800
                    AIF   (K'&MONTKN64_LIST LE 0).ZG19D  NO ME KEY      00181900
                    AIF   (N'&MONTKN64_LIST LE 1).ZG19A  CK NUM         00182000
&ZMS                SETC  '"MONTKN64_LIST='                             00182100
&ZMS                SETC  '&ZMS.&MONTKN64_LIST"'                        00182200
&ZMS                SETC  '&ZMS "MONTKN64_LIST"'                        00182300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00182400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00182500
.ZG19A              AIF   (K'&XUSEDMTKNLISTKEY LE 0).ZG19B              00182600
&ZMS                SETC  '"MONTKN64_LIST'                              00182700
&ZMS                SETC  '&ZMS.=&MONTKN64_LIST"'                       00182800
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00182900
&ZMS                SETC  '&ZMS "&XUSEDMTKNLISTKEY"'                    00183000
                    MNOTE 8,' &ZMS KEY.'                                00183100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00183200
                    AGO   .ZG19D                                        00183300
.*                                                                      00183400
.ZG19B              ANOP  ,                                             00183500
&ZXUSEDMTKNLISTKEY  SETC  'INPUT'     SET IN/OUTPUT                     00183600
&XUSEDMTKNLISTKEY   SETC  'MONTKN64_LIST'       SET XVARIABLE           00183700
&ZXMONTKN64_LIST    SETC  'INPUT'     SET IN/OUTPUT                     00183800
&XMONTKN64_LIST     SETC  '&MONTKN64_LIST(1)'   SET XVARIABLE PARM      00183900
                    AIF   (N'&MONTKN64_LIST GT 1).ZG19C                 00184000
&XMONTKN64_LIST     SETC  '&MONTKN64_LIST'      SET XVARIABLE PARM      00184100
.ZG19C              AIF   (K'&XMONTKN64_LIST GT 0).ZG19D  ONE PARM      00184200
&ZXUSEDMTKNLISTKEY  SETC  ''          RESET IN/OUTPUT                   00184300
&ZXMONTKN64_LIST    SETC  ''          RESET IN/OUTPUT                   00184400
&ZMS                SETC  ' '                                           00184500
&ZMS                SETC  '&ZMS "MONTKN64_LIST" KEY AND ITS'            00184600
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00184700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00184800
.ZG19D              ANOP  ,                                             00184900
.*------------------------------------------------------------------    00185000
.***AG.KME4Y09 NAME, OPT RQD INPUT, ME KEYS -CHECK IF KEY ENTERED       00185100
                    AIF   (K'&XUSEDMTKNLISTKEY GT 0).ZG25B              00185200
&ZXUSEDMTKNLISTKEY  SETC  ''          RESET IN/OUTPUT                   00185300
&ZXMONTKN_LIST      SETC  ''          RESET IN/OUTPUT                   00185400
&XUSEDMTKNLISTKEY   SETC  ''          ENSURE NULL                       00185500
&XMONTKN_LIST       SETC  ''          ENSURE NULL                       00185600
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00185700
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00185800
&ZMS                SETC  '&ZMS REQUIRED:'                              00185900
&ZMS                SETC  '&ZMS "MONTKN_LIST"'  VALID ME KEY            00186000
&ZMS                SETC  '&ZMS OR "MONTKN64_LIST".'  VALID ME KEY      00186100
                    MNOTE 8,' &ZMS '                                    00186200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00186300
.ZG25B              ANOP  ,                                             00186400
.*-------------------------------------------------------------------   00186500
.***AG.KMEKY13 NAME, OPT RQD INPUT, ME KEYS -PROCESS DEPENDENCIES       00186600
.ZG18ZY  AIF    ('&XUSEDMTKNLISTKEY' NE 'MONTKN_LIST').ZG19ZY           00186700
.*-------------------------------------------------------------------   00186800
.***AG.KMEKY14 NAME, OPT RQD INPUT, ME KEYS -DISALLOWED KEYS            00186900
&ZCVAL              SETC ''           ERROR KEY FIELD                   00187000
.ZG18I0             AIF   (K'&ALLOCATEBELOW LE 0).ZG18I1                00187100
&ZCVAL              SETC '&ZCVAL ALLOCATEBELOW'  DISALLOWED KEY         00187200
.ZG18I1             AIF   (K'&ZCVAL LE 0).ZG18J  KEY                    00187300
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00187400
&ZMS                SETC  '"MONTKN_LIST'                                00187500
&ZMS                SETC  '&ZMS.=&MONTKN_LIST"'                         00187600
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00187700
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00187800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00187900
.ZG18J              ANOP  ,                                             00188000
.*-------------------------------------------------------------------   00188100
.***AG.KCK02 NAME, OPT RQD INPUT, ME KEYS -GPR OUT OF RANGE             00188200
                    AIF   (K'&ZXMONTKN_LIST LE 0).ZG18R  NOT I/O        00188300
                    AIF   ('&XMONTKN_LIST'(1,1) NE '(').ZG18R           00188400
&ZCGPR              SETC  '&XMONTKN_LIST'(2,K'&XMONTKN_LIST-2)          00188500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                  00188600
                    AIF   (K'&ZCGPR GT 2).ZG18Q                         00188700
                    AIF   ('&ZCGPR' EQ '0').ZG18Q                       00188800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00188900
                    AIF   (T'&ZCGPR NE 'N').ZG18Q  INVALID REG NAME     00189000
.ZG18P              ANOP  ,                                             00189100
                    AIF   (T'&ZCGPR NE 'N').ZG18R  NON NUMERIC          00189200
                    AIF   ('&ZCGPR' LT '2').ZG18Q                       00189300
                    AIF   ('&ZCGPR' LE '12').ZG18R                      00189400
.ZG18Q              ANOP  ,                                             00189500
&ZMS                SETC  '"MONTKN_LIST='                               00189600
&ZMS                SETC  '&ZMS.&MONTKN_LIST"'                          00189700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00189800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00189900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00190000
.ZG18R              ANOP  ,                                             00190100
.*-------------------------------------------------------------------   00190200
.***AG.KMEKY13 NAME, OPT RQD INPUT, ME KEYS -PROCESS DEPENDENCIES       00190300
.ZG19ZY  AIF    ('&XUSEDMTKNLISTKEY' NE 'MONTKN64_LIST').ZG25ZY         00190400
.*-------------------------------------------------------------------   00190500
.***AG.KCK02 NAME, OPT RQD INPUT, ME KEYS -GPR OUT OF RANGE             00190600
                    AIF   (K'&ZXMONTKN64_LIST LE 0).ZG19R  NOT I/O      00190700
                    AIF   ('&XMONTKN64_LIST'(1,1) NE '(').ZG19R         00190800
&ZCGPR              SETC  '&XMONTKN64_LIST'(2,K'&XMONTKN64_LIST-2)      00190900
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                  00191000
                    AIF   (K'&ZCGPR GT 2).ZG19Q                         00191100
                    AIF   ('&ZCGPR' EQ '0').ZG19Q                       00191200
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00191300
                    AIF   (T'&ZCGPR NE 'N').ZG19Q  INVALID REG NAME     00191400
.ZG19P              ANOP  ,                                             00191500
                    AIF   (T'&ZCGPR NE 'N').ZG19R  NON NUMERIC          00191600
                    AIF   ('&ZCGPR' LT '2').ZG19Q                       00191700
                    AIF   ('&ZCGPR' LE '12').ZG19R                      00191800
.ZG19Q              ANOP  ,                                             00191900
&ZMS                SETC  '"MONTKN64_LIST='                             00192000
&ZMS                SETC  '&ZMS.&MONTKN64_LIST"'                        00192100
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00192200
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00192300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00192400
.ZG19R              ANOP  ,                                             00192500
.*------------------------------------------------------------------    00192600
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00192700
&XALLOCATEBELOW     SETC  ''          INITIALIZE XVARIABLE              00192800
.*-------------------------------------------------------------------   00192900
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00193000
.ZG22               ANOP  ,                                             00193100
                    AIF   (K'&ALLOCATEBELOW(1) LE 0).ZG22A              00193200
&ZTLC               SETC 'NO'                                           00193300
                    AIF   ('&ALLOCATEBELOW(1)' NE '&ZTLC').ZG23         00193400
&XALLOCATEBELOW     SETC  'NO'        SET KEYWORD                       00193500
                    AIF   (N'&ALLOCATEBELOW LE 1).ZG22A  CK NUM         00193600
&ZMS                SETC  '"ALLOCATEBELOW='                             00193700
&ZMS                SETC  '&ZMS.&ALLOCATEBELOW"'                        00193800
&ZMS                SETC  '&ZMS "ALLOCATEBELOW"'                        00193900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00194000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00194100
.ZG22A              ANOP  ,                                             00194200
.*-------------------------------------------------------------------   00194300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00194400
.ZG23               ANOP  ,                                             00194500
&ZTLC               SETC 'YES'                                          00194600
                    AIF   ('&ALLOCATEBELOW(1)' NE '&ZTLC').ZG24         00194700
&XALLOCATEBELOW     SETC  'YES'       SET KEYWORD                       00194800
                    AIF   (N'&ALLOCATEBELOW LE 1).ZG23A  CK NUM         00194900
&ZMS                SETC  '"ALLOCATEBELOW='                             00195000
&ZMS                SETC  '&ZMS.&ALLOCATEBELOW"'                        00195100
&ZMS                SETC  '&ZMS "ALLOCATEBELOW"'                        00195200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00195300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00195400
.ZG23A              ANOP  ,                                             00195500
.*------------------------------------------------------------------    00195600
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00195700
.ZG24               ANOP  ,                                             00195800
&ZXALLOCATEBELOW    SETC  'INPUT'     SET IN/OUTPUT                     00195900
                    AIF   (K'&XALLOCATEBELOW GT 0).ZG24E  VALID ARG     00196000
                    AIF   (T'&ALLOCATEBELOW EQ 'O').ZG24D  OMITTED      00196100
&ZASYSLNDX          SETA  0                                             00196200
.ZG24A              ANOP  ,           POSITIONAL MACRO KEY              00196300
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00196400
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG24C              00196500
&ZTLC               SETC 'ALLOCATEBELOW'                                00196600
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG24A     00196700
.ZG24B              ANOP  ,                                             00196800
&ZXALLOCATEBELOW    SETC  ''          RESET IN/OUTPUT                   00196900
&ZMS                SETC  'THE "ALLOCATEBELOW" KEY'                     00197000
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00197100
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00197200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00197300
                    AGO   .ZG24E                                        00197400
.ZG24C              ANOP  ,                                             00197500
&ZXALLOCATEBELOW    SETC  ''          RESET IN/OUTPUT                   00197600
&ZMS                SETC  '"ALLOCATEBELOW='                             00197700
&ZMS                SETC  '&ZMS.&ALLOCATEBELOW"'                        00197800
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00197900
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00198000
&ZMS                SETC  '&ZMS "NO"'                                   00198100
&ZMS                SETC  '&ZMS OR "YES".'                              00198200
                    MNOTE 8,' &ZMS '                                    00198300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00198400
                    AGO   .ZG24E                                        00198500
.ZG24D              ANOP  ,                                             00198600
&XALLOCATEBELOW     SETC  'NO'        SET DEFAULT KEYWORD               00198700
.ZG24E              ANOP  ,                                             00198800
.*-------------------------------------------------------------------   00198900
.***AG.KMEKY15 NAME, OPT RQD INPUT, ME KEYS -END                        00199000
.ZG25ZY             ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00199100
.*----------------------------------------------------------------***   00199200
.***AG.KMEKY01 NAME, OPT RQD INPUT, ME KEYS -XVARIABLE                  00199300
&XUSEDLISTLENKEY    SETC  ''          INITIALIZE XVARIABLE              00199400
                    AIF   (K'&MONTKN_LISTLEN LE 0).ZG27C                00199500
&ZXUSEDLISTLENKEY   SETC  'INPUT'     SET IN/OUTPUT                     00199600
&XUSEDLISTLENKEY    SETC  'MONTKN_LISTLEN'      SET XVARIABLE           00199700
&ZXMONTKN_LISTLEN   SETC  'INPUT'     SET IN/OUTPUT                     00199800
&XMONTKN_LISTLEN    SETC  '&MONTKN_LISTLEN(1)'  SET XVARIABLE PARM      00199900
                    AIF   (N'&MONTKN_LISTLEN GT 1).ZG27A                00200000
&XMONTKN_LISTLEN    SETC  '&MONTKN_LISTLEN'     SET XVARIABLE PARM      00200100
.ZG27A              AIF   (N'&MONTKN_LISTLEN LE 1).ZG27B  CK NUM        00200200
&ZMS                SETC  '"MONTKN_LISTLEN='                            00200300
&ZMS                SETC  '&ZMS.&MONTKN_LISTLEN"'                       00200400
&ZMS                SETC  '&ZMS "MONTKN_LISTLEN"'                       00200500
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00200600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00200700
.ZG27B              AIF   (K'&XMONTKN_LISTLEN GT 0).ZG27C  ONE PARM     00200800
&ZXUSEDLISTLENKEY   SETC  ''          RESET IN/OUTPUT                   00200900
&ZXMONTKN_LISTLEN   SETC  ''          RESET IN/OUTPUT                   00201000
&ZMS                SETC  ' '                                           00201100
&ZMS                SETC  '&ZMS "MONTKN_LISTLEN" KEY AND ITS'           00201200
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00201300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00201400
.ZG27C              ANOP  ,                                             00201500
.*----------------------------------------------------------------***   00201600
.***AG.KMEKY02 NAME, OPT RQD INPUT, ME KEYS -XVARIABLE                  00201700
                    AIF   (K'&LISTLEN LE 0).ZG28D  NO ME KEY            00201800
                    AIF   (N'&LISTLEN LE 1).ZG28A  CK NUM               00201900
&ZMS                SETC  '"LISTLEN='                                   00202000
&ZMS                SETC  '&ZMS.&LISTLEN"'                              00202100
&ZMS                SETC  '&ZMS "LISTLEN"'                              00202200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00202300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00202400
.ZG28A              AIF   (K'&XUSEDLISTLENKEY LE 0).ZG28B               00202500
&ZMS                SETC  '"LISTLEN'                                    00202600
&ZMS                SETC  '&ZMS.=&LISTLEN"'                             00202700
&ZMS                SETC  '&ZMS IS MUTUALLY EXCLUSIVE WITH THE'         00202800
&ZMS                SETC  '&ZMS "&XUSEDLISTLENKEY"'                     00202900
                    MNOTE 8,' &ZMS KEY.'                                00203000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00203100
                    AGO   .ZG28D                                        00203200
.*                                                                      00203300
.ZG28B              ANOP  ,                                             00203400
&ZXUSEDLISTLENKEY   SETC  'INPUT'     SET IN/OUTPUT                     00203500
&XUSEDLISTLENKEY    SETC  'LISTLEN'   SET XVARIABLE                     00203600
&ZXLISTLEN          SETC  'INPUT'     SET IN/OUTPUT                     00203700
&XLISTLEN           SETC  '&LISTLEN(1)'         SET XVARIABLE PARM      00203800
                    AIF   (N'&LISTLEN GT 1).ZG28C                       00203900
&XLISTLEN           SETC  '&LISTLEN'  SET XVARIABLE PARM                00204000
.ZG28C              AIF   (K'&XLISTLEN GT 0).ZG28D  ONE PARM            00204100
&ZXUSEDLISTLENKEY   SETC  ''          RESET IN/OUTPUT                   00204200
&ZXLISTLEN          SETC  ''          RESET IN/OUTPUT                   00204300
&ZMS                SETC  ' '                                           00204400
&ZMS                SETC  '&ZMS "LISTLEN" KEY AND ITS'                  00204500
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00204600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00204700
.ZG28D              ANOP  ,                                             00204800
.*------------------------------------------------------------------    00204900
.***AG.KME4Y09 NAME, OPT RQD INPUT, ME KEYS -CHECK IF KEY ENTERED       00205000
                    AIF   (K'&XUSEDLISTLENKEY GT 0).ZG29B               00205100
&ZXUSEDLISTLENKEY   SETC  ''          RESET IN/OUTPUT                   00205200
&ZXMONTKN_LISTLEN   SETC  ''          RESET IN/OUTPUT                   00205300
&XUSEDLISTLENKEY    SETC  ''          ENSURE NULL                       00205400
&XMONTKN_LISTLEN    SETC  ''          ENSURE NULL                       00205500
&ZMS                SETC  'ONE OF THE FOLLOWING'                        00205600
&ZMS                SETC  '&ZMS MUTUALLY EXCLUSIVE KEY(S) IS'           00205700
&ZMS                SETC  '&ZMS REQUIRED:'                              00205800
&ZMS                SETC  '&ZMS "MONTKN_LISTLEN"'  VALID ME KEY         00205900
&ZMS                SETC  '&ZMS OR "LISTLEN".'  VALID ME KEY            00206000
                    MNOTE 8,' &ZMS '                                    00206100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00206200
.ZG29B              ANOP  ,                                             00206300
.*-------------------------------------------------------------------   00206400
.***AG.KMEKY13 NAME, OPT RQD INPUT, ME KEYS -PROCESS DEPENDENCIES       00206500
.ZG27ZY  AIF    ('&XUSEDLISTLENKEY' NE 'MONTKN_LISTLEN').ZG28ZY         00206600
.*-------------------------------------------------------------------   00206700
.***AG.KCK02 NAME, OPT RQD INPUT, ME KEYS -GPR OUT OF RANGE             00206800
                    AIF   (K'&ZXMONTKN_LISTLEN LE 0).ZG27R  NOT I/O     00206900
                    AIF   ('&XMONTKN_LISTLEN'(1,1) NE '(').ZG27R        00207000
&ZCGPR              SETC  '&XMONTKN_LISTLEN'(2,K'&XMONTKN_LISTLEN-2)    00207100
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG27P                  00207200
                    AIF   (K'&ZCGPR GT 2).ZG27Q                         00207300
                    AIF   ('&ZCGPR' EQ '0').ZG27Q                       00207400
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00207500
                    AIF   (T'&ZCGPR NE 'N').ZG27Q  INVALID REG NAME     00207600
.ZG27P              ANOP  ,                                             00207700
                    AIF   (T'&ZCGPR NE 'N').ZG27R  NON NUMERIC          00207800
                    AIF   ('&ZCGPR' LT '2').ZG27Q                       00207900
                    AIF   ('&ZCGPR' LE '12').ZG27R                      00208000
.ZG27Q              ANOP  ,                                             00208100
&ZMS                SETC  '"MONTKN_LISTLEN='                            00208200
&ZMS                SETC  '&ZMS.&MONTKN_LISTLEN"'                       00208300
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00208400
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00208500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00208600
.ZG27R              ANOP  ,                                             00208700
.*-------------------------------------------------------------------   00208800
.***AG.KMEKY13 NAME, OPT RQD INPUT, ME KEYS -PROCESS DEPENDENCIES       00208900
.ZG28ZY  AIF    ('&XUSEDLISTLENKEY' NE 'LISTLEN').ZG29ZY                00209000
.*-------------------------------------------------------------------   00209100
.***AG.KCK02 NAME, OPT RQD INPUT, ME KEYS -GPR OUT OF RANGE             00209200
                    AIF   (K'&ZXLISTLEN LE 0).ZG28R  NOT I/O            00209300
                    AIF   ('&XLISTLEN'(1,1) NE '(').ZG28R               00209400
&ZCGPR              SETC  '&XLISTLEN'(2,K'&XLISTLEN-2)                  00209500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                  00209600
                    AIF   (K'&ZCGPR GT 2).ZG28Q                         00209700
                    AIF   ('&ZCGPR' EQ '0').ZG28Q                       00209800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00209900
                    AIF   (T'&ZCGPR NE 'N').ZG28Q  INVALID REG NAME     00210000
.ZG28P              ANOP  ,                                             00210100
                    AIF   (T'&ZCGPR NE 'N').ZG28R  NON NUMERIC          00210200
                    AIF   ('&ZCGPR' LT '2').ZG28Q                       00210300
                    AIF   ('&ZCGPR' LE '12').ZG28R                      00210400
.ZG28Q              ANOP  ,                                             00210500
&ZMS                SETC  '"LISTLEN='                                   00210600
&ZMS                SETC  '&ZMS.&LISTLEN"'                              00210700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00210800
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00210900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00211000
.ZG28R              ANOP  ,                                             00211100
.*-------------------------------------------------------------------   00211200
.***AG.KMEKY15 NAME, OPT RQD INPUT, ME KEYS -END                        00211300
.ZG29ZY             ANOP ,            END MUTUALLY EXCLUSIVE KEYS       00211400
.*------------------------------------------------------------------    00211500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00211600
.ZG30               ANOP  ,                                             00211700
&ZXREQTYPE          SETC  'INPUT'     SET IN/OUTPUT                     00211800
                    AIF   (K'&XREQTYPE GT 0).ZG30E  VALID ARG           00211900
                    AIF   (T'&REQTYPE EQ 'O').ZG30D  OMITTED            00212000
&ZASYSLNDX          SETA  0                                             00212100
.ZG30A              ANOP  ,           POSITIONAL MACRO KEY              00212200
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00212300
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG30C              00212400
&ZTLC               SETC 'REQTYPE'                                      00212500
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG30A     00212600
.ZG30B              ANOP  ,                                             00212700
&ZXREQTYPE          SETC  ''          RESET IN/OUTPUT                   00212800
&ZMS                SETC  'THE "REQTYPE" KEY'                           00212900
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00213000
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00213100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00213200
                    AGO   .ZG30E                                        00213300
.ZG30C              ANOP  ,                                             00213400
&ZXREQTYPE          SETC  ''          RESET IN/OUTPUT                   00213500
&ZMS                SETC  '"REQTYPE='                                   00213600
&ZMS                SETC  '&ZMS.&REQTYPE"'                              00213700
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00213800
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00213900
&ZMS                SETC  '&ZMS "SINGLE"'                               00214000
&ZMS                SETC  '&ZMS OR "MULTIPLE".'                         00214100
                    MNOTE 8,' &ZMS '                                    00214200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00214300
                    AGO   .ZG30E                                        00214400
.ZG30D              ANOP  ,                                             00214500
&XREQTYPE           SETC  'SINGLE'    SET DEFAULT KEYWORD               00214600
.ZG30E              ANOP  ,                                             00214700
.*------------------------------------------------------------------    00214800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00214900
&XREPORTONLY        SETC  ''          INITIALIZE XVARIABLE              00215000
.*-------------------------------------------------------------------   00215100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00215200
.ZG33               ANOP  ,                                             00215300
                    AIF   (K'&REPORTONLY(1) LE 0).ZG33A                 00215400
&ZTLC               SETC 'NO'                                           00215500
                    AIF   ('&REPORTONLY(1)' NE '&ZTLC').ZG39            00215600
&XREPORTONLY        SETC  'NO'        SET KEYWORD                       00215700
                    AIF   (N'&REPORTONLY LE 1).ZG33A  CK NUM            00215800
&ZMS                SETC  '"REPORTONLY='                                00215900
&ZMS                SETC  '&ZMS.&REPORTONLY"'                           00216000
&ZMS                SETC  '&ZMS "REPORTONLY"'                           00216100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00216200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00216300
.ZG33A              ANOP  ,                                             00216400
.*------------------------------------------------------------------    00216500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00216600
&XBPMGMTONLY        SETC  ''          INITIALIZE XVARIABLE              00216700
.*-------------------------------------------------------------------   00216800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00216900
.ZG36               ANOP  ,                                             00217000
                    AIF   (K'&BPMGMTONLY(1) LE 0).ZG36A                 00217100
&ZTLC               SETC 'NO'                                           00217200
                    AIF   ('&BPMGMTONLY(1)' NE '&ZTLC').ZG37            00217300
&XBPMGMTONLY        SETC  'NO'        SET KEYWORD                       00217400
                    AIF   (N'&BPMGMTONLY LE 1).ZG36A  CK NUM            00217500
&ZMS                SETC  '"BPMGMTONLY='                                00217600
&ZMS                SETC  '&ZMS.&BPMGMTONLY"'                           00217700
&ZMS                SETC  '&ZMS "BPMGMTONLY"'                           00217800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00217900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00218000
.ZG36A              ANOP  ,                                             00218100
.*-------------------------------------------------------------------   00218200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00218300
.ZG37               ANOP  ,                                             00218400
&ZTLC               SETC 'YES'                                          00218500
                    AIF   ('&BPMGMTONLY(1)' NE '&ZTLC').ZG38            00218600
&XBPMGMTONLY        SETC  'YES'       SET KEYWORD                       00218700
                    AIF   (N'&BPMGMTONLY LE 1).ZG37A  CK NUM            00218800
&ZMS                SETC  '"BPMGMTONLY='                                00218900
&ZMS                SETC  '&ZMS.&BPMGMTONLY"'                           00219000
&ZMS                SETC  '&ZMS "BPMGMTONLY"'                           00219100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00219200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00219300
.ZG37A              ANOP  ,                                             00219400
.*------------------------------------------------------------------    00219500
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00219600
.ZG38               ANOP  ,                                             00219700
&ZXBPMGMTONLY       SETC  'INPUT'     SET IN/OUTPUT                     00219800
                    AIF   (K'&XBPMGMTONLY GT 0).ZG38E  VALID ARG        00219900
                    AIF   (T'&BPMGMTONLY EQ 'O').ZG38D  OMITTED         00220000
&ZASYSLNDX          SETA  0                                             00220100
.ZG38A              ANOP  ,           POSITIONAL MACRO KEY              00220200
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00220300
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG38C              00220400
&ZTLC               SETC 'BPMGMTONLY'                                   00220500
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG38A     00220600
.ZG38B              ANOP  ,                                             00220700
&ZXBPMGMTONLY       SETC  ''          RESET IN/OUTPUT                   00220800
&ZMS                SETC  'THE "BPMGMTONLY" KEY'                        00220900
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00221000
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00221100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00221200
                    AGO   .ZG38E                                        00221300
.ZG38C              ANOP  ,                                             00221400
&ZXBPMGMTONLY       SETC  ''          RESET IN/OUTPUT                   00221500
&ZMS                SETC  '"BPMGMTONLY='                                00221600
&ZMS                SETC  '&ZMS.&BPMGMTONLY"'                           00221700
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00221800
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00221900
&ZMS                SETC  '&ZMS "NO"'                                   00222000
&ZMS                SETC  '&ZMS OR "YES".'                              00222100
                    MNOTE 8,' &ZMS '                                    00222200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00222300
                    AGO   .ZG38E                                        00222400
.ZG38D              ANOP  ,                                             00222500
&XBPMGMTONLY        SETC  'NO'        SET DEFAULT KEYWORD               00222600
.ZG38E              ANOP  ,                                             00222700
.*-------------------------------------------------------------------   00222800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00222900
.ZG39               ANOP  ,                                             00223000
&ZTLC               SETC 'YES'                                          00223100
                    AIF   ('&REPORTONLY(1)' NE '&ZTLC').ZG40            00223200
&XREPORTONLY        SETC  'YES'       SET KEYWORD                       00223300
                    AIF   (N'&REPORTONLY LE 1).ZG39A  CK NUM            00223400
&ZMS                SETC  '"REPORTONLY='                                00223500
&ZMS                SETC  '&ZMS.&REPORTONLY"'                           00223600
&ZMS                SETC  '&ZMS "REPORTONLY"'                           00223700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00223800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00223900
.ZG39A              ANOP  ,                                             00224000
.*------------------------------------------------------------------    00224100
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00224200
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00224300
.ZG39A0             AIF   (K'&BPMGMTONLY LE 0).ZG39A1  OK               00224400
&ZCVAL              SETC '&ZCVAL BPMGMTONLY'    INCORRECT KEY USED      00224500
.ZG39A1             AIF   (K'&ZCVAL LE 0).ZG39A2  OK                    00224600
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00224700
&ZMS                SETC  '"REPORTONLY'                                 00224800
&ZMS                SETC  '&ZMS.=&REPORTONLY"'                          00224900
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00225000
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00225100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00225200
.ZG39A2             ANOP  ,                                             00225300
.*------------------------------------------------------------------    00225400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00225500
.ZG40               ANOP  ,                                             00225600
&ZXREPORTONLY       SETC  'INPUT'     SET IN/OUTPUT                     00225700
                    AIF   (K'&XREPORTONLY GT 0).ZG40E  VALID ARG        00225800
                    AIF   (T'&REPORTONLY EQ 'O').ZG40D  OMITTED         00225900
&ZASYSLNDX          SETA  0                                             00226000
.ZG40A              ANOP  ,           POSITIONAL MACRO KEY              00226100
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00226200
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG40C              00226300
&ZTLC               SETC 'REPORTONLY'                                   00226400
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG40A     00226500
.ZG40B              ANOP  ,                                             00226600
&ZXREPORTONLY       SETC  ''          RESET IN/OUTPUT                   00226700
&ZMS                SETC  'THE "REPORTONLY" KEY'                        00226800
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00226900
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00227000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00227100
                    AGO   .ZG40E                                        00227200
.ZG40C              ANOP  ,                                             00227300
&ZXREPORTONLY       SETC  ''          RESET IN/OUTPUT                   00227400
&ZMS                SETC  '"REPORTONLY='                                00227500
&ZMS                SETC  '&ZMS.&REPORTONLY"'                           00227600
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00227700
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00227800
&ZMS                SETC  '&ZMS "NO"'                                   00227900
&ZMS                SETC  '&ZMS OR "YES".'                              00228000
                    MNOTE 8,' &ZMS '                                    00228100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00228200
                    AGO   .ZG40E                                        00228300
.ZG40D              ANOP  ,                                             00228400
&XREPORTONLY        SETC  'NO'        SET DEFAULT KEYWORD               00228500
.ZG40E              ANOP  ,                                             00228600
.*------------------------------------------------------------------    00228700
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00228800
&XSUBSYSP           SETC  ''          INITIALIZE XVARIABLE              00228900
.*-------------------------------------------------------------------   00229000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00229100
.ZG43               ANOP  ,                                             00229200
                    AIF   (K'&SUBSYSP(1) LE 0).ZG43A                    00229300
&ZTLC               SETC 'CONNECT'                                      00229400
                    AIF   ('&SUBSYSP(1)' NE '&ZTLC').ZG47               00229500
&XSUBSYSP           SETC  'CONNECT'   SET KEYWORD                       00229600
                    AIF   (N'&SUBSYSP LE 1).ZG43A  CK NUM               00229700
&ZMS                SETC  '"SUBSYSP='                                   00229800
&ZMS                SETC  '&ZMS.&SUBSYSP"'                              00229900
&ZMS                SETC  '&ZMS "SUBSYSP"'                              00230000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00230100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00230200
.ZG43A              ANOP  ,                                             00230300
.*------------------------------------------------------------------    00230400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00230500
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00230600
.ZG43A0             AIF   (K'&SUBSYS LE 0).ZG43A1  OK                   00230700
&ZCVAL              SETC '&ZCVAL SUBSYS'        INCORRECT KEY USED      00230800
.ZG43A1             AIF   (K'&SUBSYSNM LE 0).ZG43A2  OK                 00230900
&ZCVAL              SETC '&ZCVAL SUBSYSNM'      INCORRECT KEY USED      00231000
.ZG43A2             AIF   (K'&EWLM LE 0).ZG43A3  OK                     00231100
&ZCVAL              SETC '&ZCVAL EWLM'          INCORRECT KEY USED      00231200
.ZG43A3             AIF   (K'&GROUPNM LE 0).ZG43A4  OK                  00231300
&ZCVAL              SETC '&ZCVAL GROUPNM'       INCORRECT KEY USED      00231400
.ZG43A4             AIF   (K'&GROUPNM_LEN LE 0).ZG43A5  OK              00231500
&ZCVAL              SETC '&ZCVAL GROUPNM_LEN'   INCORRECT KEY USED      00231600
.ZG43A5             AIF   (K'&ZCVAL LE 0).ZG43A6  OK                    00231700
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00231800
&ZMS                SETC  '"SUBSYSP'                                    00231900
&ZMS                SETC  '&ZMS.=&SUBSYSP"'                             00232000
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00232100
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00232200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00232300
.ZG43A6             ANOP  ,                                             00232400
.*----------------------------------------------------------------***   00232500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00232600
                    AIF   (N'&CONNTKN LE 1).ZG45A  CK NUM               00232700
&ZMS                SETC  '"CONNTKN='                                   00232800
&ZMS                SETC  '&ZMS.&CONNTKN"'                              00232900
&ZMS                SETC  '&ZMS "CONNTKN"'                              00233000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00233100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00233200
.ZG45A              ANOP  ,                                             00233300
.*-------------------------------------------------------------------   00233400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00233500
&ZXCONNTKN          SETC  'INPUT'     SET IN/OUTPUT                     00233600
&XCONNTKN           SETC  '&CONNTKN(1)'         SET XVARIABLE           00233700
                    AIF   (N'&CONNTKN GT 1).ZG45B  MULTI                00233800
&XCONNTKN           SETC  '&CONNTKN'  SET XVARIABLE                     00233900
.ZG45B              AIF   (K'&CONNTKN(1) GT 0).ZG45C                    00234000
&ZXCONNTKN          SETC  ''          RESET IN/OUTPUT                   00234100
&ZMS                SETC  ' '                                           00234200
&ZMS                SETC  '&ZMS "CONNTKN" KEY AND ITS'                  00234300
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00234400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00234500
.ZG45C              ANOP  ,                                             00234600
.*-------------------------------------------------------------------   00234700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00234800
                    AIF   (K'&ZXCONNTKN LE 0).ZG45R  NOT I/O            00234900
                    AIF   ('&XCONNTKN'(1,1) NE '(').ZG45R               00235000
&ZCGPR              SETC  '&XCONNTKN'(2,K'&XCONNTKN-2)                  00235100
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG45P                  00235200
                    AIF   (K'&ZCGPR GT 2).ZG45Q                         00235300
                    AIF   ('&ZCGPR' EQ '0').ZG45Q                       00235400
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00235500
                    AIF   (T'&ZCGPR NE 'N').ZG45Q  INVALID REG NAME     00235600
.ZG45P              ANOP  ,                                             00235700
                    AIF   (T'&ZCGPR NE 'N').ZG45R  NON NUMERIC          00235800
                    AIF   ('&ZCGPR' LT '2').ZG45Q                       00235900
                    AIF   ('&ZCGPR' LE '12').ZG45R                      00236000
.ZG45Q              ANOP  ,                                             00236100
&ZMS                SETC  '"CONNTKN='                                   00236200
&ZMS                SETC  '&ZMS.&CONNTKN"'                              00236300
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00236400
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00236500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00236600
.ZG45R              ANOP  ,                                             00236700
.*-------------------------------------------------------------------   00236800
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00236900
.ZG47               ANOP  ,                                             00237000
&ZTLC               SETC 'VALUE'                                        00237100
                    AIF   ('&SUBSYSP(1)' NE '&ZTLC').ZG65               00237200
&XSUBSYSP           SETC  'VALUE'     SET KEYWORD                       00237300
                    AIF   (N'&SUBSYSP LE 1).ZG47A  CK NUM               00237400
&ZMS                SETC  '"SUBSYSP='                                   00237500
&ZMS                SETC  '&ZMS.&SUBSYSP"'                              00237600
&ZMS                SETC  '&ZMS "SUBSYSP"'                              00237700
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00237800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00237900
.ZG47A              ANOP  ,                                             00238000
.*------------------------------------------------------------------    00238100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00238200
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00238300
.ZG47A0             AIF   (K'&CONNTKN LE 0).ZG47A1  OK                  00238400
&ZCVAL              SETC '&ZCVAL CONNTKN'       INCORRECT KEY USED      00238500
.ZG47A1             AIF   (K'&ZCVAL LE 0).ZG47A2  OK                    00238600
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00238700
&ZMS                SETC  '"SUBSYSP'                                    00238800
&ZMS                SETC  '&ZMS.=&SUBSYSP"'                             00238900
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00239000
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00239100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00239200
.ZG47A2             ANOP  ,                                             00239300
.*----------------------------------------------------------------***   00239400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00239500
                    AIF   (N'&SUBSYS LE 1).ZG49A  CK NUM                00239600
&ZMS                SETC  '"SUBSYS='                                    00239700
&ZMS                SETC  '&ZMS.&SUBSYS"'                               00239800
&ZMS                SETC  '&ZMS "SUBSYS"'                               00239900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00240000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00240100
.ZG49A              ANOP  ,                                             00240200
.*-------------------------------------------------------------------   00240300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00240400
&ZXSUBSYS           SETC  'INPUT'     SET IN/OUTPUT                     00240500
&XSUBSYS            SETC  '&SUBSYS(1)'          SET XVARIABLE           00240600
                    AIF   (N'&SUBSYS GT 1).ZG49B  MULTI                 00240700
&XSUBSYS            SETC  '&SUBSYS'   SET XVARIABLE                     00240800
.ZG49B              AIF   (K'&SUBSYS(1) GT 0).ZG49C                     00240900
&ZXSUBSYS           SETC  ''          RESET IN/OUTPUT                   00241000
&ZMS                SETC  ' '                                           00241100
&ZMS                SETC  '&ZMS "SUBSYS" KEY AND ITS'                   00241200
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00241300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00241400
.ZG49C              ANOP  ,                                             00241500
.*-------------------------------------------------------------------   00241600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00241700
                    AIF   (K'&ZXSUBSYS LE 0).ZG49R  NOT I/O             00241800
                    AIF   ('&XSUBSYS'(1,1) NE '(').ZG49R                00241900
&ZCGPR              SETC  '&XSUBSYS'(2,K'&XSUBSYS-2)                    00242000
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG49P                  00242100
                    AIF   (K'&ZCGPR GT 2).ZG49Q                         00242200
                    AIF   ('&ZCGPR' EQ '0').ZG49Q                       00242300
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00242400
                    AIF   (T'&ZCGPR NE 'N').ZG49Q  INVALID REG NAME     00242500
.ZG49P              ANOP  ,                                             00242600
                    AIF   (T'&ZCGPR NE 'N').ZG49R  NON NUMERIC          00242700
                    AIF   ('&ZCGPR' LT '2').ZG49Q                       00242800
                    AIF   ('&ZCGPR' LE '12').ZG49R                      00242900
.ZG49Q              ANOP  ,                                             00243000
&ZMS                SETC  '"SUBSYS='                                    00243100
&ZMS                SETC  '&ZMS.&SUBSYS"'                               00243200
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00243300
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00243400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00243500
.ZG49R              ANOP  ,                                             00243600
.*----------------------------------------------------------------***   00243700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00243800
                    AIF   (N'&SUBSYSNM LE 1).ZG52A  CK NUM              00243900
&ZMS                SETC  '"SUBSYSNM='                                  00244000
&ZMS                SETC  '&ZMS.&SUBSYSNM"'                             00244100
&ZMS                SETC  '&ZMS "SUBSYSNM"'                             00244200
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00244300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00244400
.ZG52A              ANOP  ,                                             00244500
.*-------------------------------------------------------------------   00244600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00244700
&ZXSUBSYSNM         SETC  'INPUT'     SET IN/OUTPUT                     00244800
&XSUBSYSNM          SETC  '&SUBSYSNM(1)'        SET XVARIABLE           00244900
                    AIF   (N'&SUBSYSNM GT 1).ZG52B  MULTI               00245000
&XSUBSYSNM          SETC  '&SUBSYSNM'           SET XVARIABLE           00245100
.ZG52B              AIF   (K'&SUBSYSNM(1) GT 0).ZG52C                   00245200
&ZXSUBSYSNM         SETC  ''          RESET IN/OUTPUT                   00245300
&ZMS                SETC  ' '                                           00245400
&ZMS                SETC  '&ZMS "SUBSYSNM" KEY AND ITS'                 00245500
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00245600
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00245700
.ZG52C              ANOP  ,                                             00245800
.*-------------------------------------------------------------------   00245900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00246000
                    AIF   (K'&ZXSUBSYSNM LE 0).ZG52R  NOT I/O           00246100
                    AIF   ('&XSUBSYSNM'(1,1) NE '(').ZG52R              00246200
&ZCGPR              SETC  '&XSUBSYSNM'(2,K'&XSUBSYSNM-2)                00246300
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG52P                  00246400
                    AIF   (K'&ZCGPR GT 2).ZG52Q                         00246500
                    AIF   ('&ZCGPR' EQ '0').ZG52Q                       00246600
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00246700
                    AIF   (T'&ZCGPR NE 'N').ZG52Q  INVALID REG NAME     00246800
.ZG52P              ANOP  ,                                             00246900
                    AIF   (T'&ZCGPR NE 'N').ZG52R  NON NUMERIC          00247000
                    AIF   ('&ZCGPR' LT '2').ZG52Q                       00247100
                    AIF   ('&ZCGPR' LE '12').ZG52R                      00247200
.ZG52Q              ANOP  ,                                             00247300
&ZMS                SETC  '"SUBSYSNM='                                  00247400
&ZMS                SETC  '&ZMS.&SUBSYSNM"'                             00247500
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00247600
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00247700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00247800
.ZG52R              ANOP  ,                                             00247900
.*------------------------------------------------------------------    00248000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00248100
&XEWLM              SETC  ''          INITIALIZE XVARIABLE              00248200
.*-------------------------------------------------------------------   00248300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00248400
.ZG56               ANOP  ,                                             00248500
                    AIF   (K'&EWLM(1) LE 0).ZG56A                       00248600
&ZTLC               SETC 'NO'                                           00248700
                    AIF   ('&EWLM(1)' NE '&ZTLC').ZG57                  00248800
&XEWLM              SETC  'NO'        SET KEYWORD                       00248900
                    AIF   (N'&EWLM LE 1).ZG56A  CK NUM                  00249000
&ZMS                SETC  '"EWLM='                                      00249100
&ZMS                SETC  '&ZMS.&EWLM"'                                 00249200
&ZMS                SETC  '&ZMS "EWLM"'                                 00249300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00249400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00249500
.ZG56A              ANOP  ,                                             00249600
.*------------------------------------------------------------------    00249700
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00249800
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00249900
.ZG56A0             AIF   (K'&GROUPNM LE 0).ZG56A1  OK                  00250000
&ZCVAL              SETC '&ZCVAL GROUPNM'       INCORRECT KEY USED      00250100
.ZG56A1             AIF   (K'&GROUPNM_LEN LE 0).ZG56A2  OK              00250200
&ZCVAL              SETC '&ZCVAL GROUPNM_LEN'   INCORRECT KEY USED      00250300
.ZG56A2             AIF   (K'&ZCVAL LE 0).ZG56A3  OK                    00250400
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00250500
&ZMS                SETC  '"EWLM'                                       00250600
&ZMS                SETC  '&ZMS.=&EWLM"'                                00250700
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00250800
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00250900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00251000
.ZG56A3             ANOP  ,                                             00251100
.*-------------------------------------------------------------------   00251200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00251300
.ZG57               ANOP  ,                                             00251400
&ZTLC               SETC 'YES'                                          00251500
                    AIF   ('&EWLM(1)' NE '&ZTLC').ZG64                  00251600
&XEWLM              SETC  'YES'       SET KEYWORD                       00251700
                    AIF   (N'&EWLM LE 1).ZG57A  CK NUM                  00251800
&ZMS                SETC  '"EWLM='                                      00251900
&ZMS                SETC  '&ZMS.&EWLM"'                                 00252000
&ZMS                SETC  '&ZMS "EWLM"'                                 00252100
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00252200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00252300
.ZG57A              ANOP  ,                                             00252400
.*----------------------------------------------------------------***   00252500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00252600
                    AIF   (N'&GROUPNM LE 1).ZG59A  CK NUM               00252700
&ZMS                SETC  '"GROUPNM='                                   00252800
&ZMS                SETC  '&ZMS.&GROUPNM"'                              00252900
&ZMS                SETC  '&ZMS "GROUPNM"'                              00253000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00253100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00253200
.ZG59A              ANOP  ,                                             00253300
.*-------------------------------------------------------------------   00253400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00253500
&ZXGROUPNM          SETC  'INPUT'     SET IN/OUTPUT                     00253600
&XGROUPNM           SETC  'NO_GROUPNM'                                  00253700
                    AIF   (K'&GROUPNM(1) LE 0).ZG59B  PARM              00253800
&XGROUPNM           SETC  '&GROUPNM(1)'         SET XVARIABLE           00253900
                    AIF   (N'&GROUPNM GT 1).ZG59B  MULTI                00254000
&XGROUPNM           SETC  '&GROUPNM'  SET XVARIABLE                     00254100
.ZG59B              ANOP  ,                                             00254200
.*-------------------------------------------------------------------   00254300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00254400
                    AIF   (K'&ZXGROUPNM LE 0).ZG59R  NOT I/O            00254500
         AIF   ('&XGROUPNM' EQ 'NO_GROUPNM').ZG59R                      00254600
                    AIF   ('&XGROUPNM'(1,1) NE '(').ZG59R               00254700
&ZCGPR              SETC  '&XGROUPNM'(2,K'&XGROUPNM-2)                  00254800
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG59P                  00254900
                    AIF   (K'&ZCGPR GT 2).ZG59Q                         00255000
                    AIF   ('&ZCGPR' EQ '0').ZG59Q                       00255100
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00255200
                    AIF   (T'&ZCGPR NE 'N').ZG59Q  INVALID REG NAME     00255300
.ZG59P              ANOP  ,                                             00255400
                    AIF   (T'&ZCGPR NE 'N').ZG59R  NON NUMERIC          00255500
                    AIF   ('&ZCGPR' LT '2').ZG59Q                       00255600
                    AIF   ('&ZCGPR' LE '12').ZG59R                      00255700
.ZG59Q              ANOP  ,                                             00255800
&ZMS                SETC  '"GROUPNM='                                   00255900
&ZMS                SETC  '&ZMS.&GROUPNM"'                              00256000
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00256100
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00256200
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00256300
.ZG59R              ANOP  ,                                             00256400
.*----------------------------------------------------------------***   00256500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00256600
                    AIF   (N'&GROUPNM_LEN LE 1).ZG61A  CK NUM           00256700
&ZMS                SETC  '"GROUPNM_LEN='                               00256800
&ZMS                SETC  '&ZMS.&GROUPNM_LEN"'                          00256900
&ZMS                SETC  '&ZMS "GROUPNM_LEN"'                          00257000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00257100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00257200
.ZG61A              ANOP  ,                                             00257300
.*-------------------------------------------------------------------   00257400
.***AG.KXVAR09 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00257500
&ZXGROUPNM_LEN      SETC  'INPUT'     SET IN/OUTPUT                     00257600
&XGROUPNM_LEN       SETC  '&GROUPNM_LEN(1)'     SET XVARIABLE           00257700
                    AIF   (N'&GROUPNM_LEN GT 1).ZG61B  MULTI            00257800
&XGROUPNM_LEN       SETC  '&GROUPNM_LEN'        SET XVARIABLE           00257900
.ZG61B              AIF   (K'&GROUPNM(1) GT 0).ZG61C  KEY               00258000
                    AIF   (K'&GROUPNM_LEN(1) LE 0).ZG61D  PARM          00258100
&ZMS                SETC  '"GROUPNM_LEN'                                00258200
&ZMS                SETC  '&ZMS.=&GROUPNM_LEN"'                         00258300
&ZMS                SETC  '&ZMS CAN ONLY BE SPECIFIED IF'               00258400
&ZMS                SETC  '&ZMS '                                       00258500
&ZMS                SETC  '&ZMS "GROUPNM"'                              00258600
                    MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                  00258700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00258800
                    AGO   .ZG61E                                        00258900
.*                                                                      00259000
.ZG61C              AIF   (K'&GROUPNM_LEN(1) GT 0).ZG61E  PARM          00259100
&ZXGROUPNM_LEN      SETC  ''          RESET IN/OUTPUT                   00259200
&ZMS                SETC  ' '                                           00259300
&ZMS                SETC  '&ZMS "GROUPNM_LEN" KEY AND ITS'              00259400
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00259500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00259600
.ZG61D              ANOP  ,                                             00259700
&XGROUPNM_LEN       SETC  '0'         SET DEFAULT                       00259800
.ZG61E              ANOP  ,                                             00259900
.*-------------------------------------------------------------------   00260000
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00260100
                    AIF   (K'&ZXGROUPNM_LEN LE 0).ZG61R  NOT I/O        00260200
                    AIF   ('&XGROUPNM_LEN'(1,1) NE '(').ZG61R           00260300
&ZCGPR              SETC  '&XGROUPNM_LEN'(2,K'&XGROUPNM_LEN-2)          00260400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG61P                  00260500
                    AIF   (K'&ZCGPR GT 2).ZG61Q                         00260600
                    AIF   ('&ZCGPR' EQ '0').ZG61Q                       00260700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00260800
                    AIF   (T'&ZCGPR NE 'N').ZG61Q  INVALID REG NAME     00260900
.ZG61P              ANOP  ,                                             00261000
                    AIF   (T'&ZCGPR NE 'N').ZG61R  NON NUMERIC          00261100
                    AIF   ('&ZCGPR' LT '2').ZG61Q                       00261200
                    AIF   ('&ZCGPR' LE '12').ZG61R                      00261300
.ZG61Q              ANOP  ,                                             00261400
&ZMS                SETC  '"GROUPNM_LEN='                               00261500
&ZMS                SETC  '&ZMS.&GROUPNM_LEN"'                          00261600
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00261700
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00261800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00261900
.ZG61R              ANOP  ,                                             00262000
.*------------------------------------------------------------------    00262100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00262200
.ZG64               ANOP  ,                                             00262300
&ZXEWLM             SETC  'INPUT'     SET IN/OUTPUT                     00262400
                    AIF   (K'&XEWLM GT 0).ZG64E  VALID ARG              00262500
                    AIF   (T'&EWLM EQ 'O').ZG64D  OMITTED               00262600
&ZASYSLNDX          SETA  0                                             00262700
.ZG64A              ANOP  ,           POSITIONAL MACRO KEY              00262800
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00262900
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG64C              00263000
&ZTLC               SETC 'EWLM'                                         00263100
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG64A     00263200
.ZG64B              ANOP  ,                                             00263300
&ZXEWLM             SETC  ''          RESET IN/OUTPUT                   00263400
&ZMS                SETC  'THE "EWLM" KEY'                              00263500
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00263600
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00263700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00263800
                    AGO   .ZG64E                                        00263900
.ZG64C              ANOP  ,                                             00264000
&ZXEWLM             SETC  ''          RESET IN/OUTPUT                   00264100
&ZMS                SETC  '"EWLM='                                      00264200
&ZMS                SETC  '&ZMS.&EWLM"'                                 00264300
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00264400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00264500
&ZMS                SETC  '&ZMS "NO"'                                   00264600
&ZMS                SETC  '&ZMS OR "YES".'                              00264700
                    MNOTE 8,' &ZMS '                                    00264800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00264900
                    AGO   .ZG64E                                        00265000
.ZG64D              ANOP  ,                                             00265100
&XEWLM              SETC  'NO'        SET DEFAULT KEYWORD               00265200
.ZG64E              ANOP  ,                                             00265300
.*------------------------------------------------------------------    00265400
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00265500
.ZG65               ANOP  ,                                             00265600
&ZXSUBSYSP          SETC  'INPUT'     SET IN/OUTPUT                     00265700
                    AIF   (K'&XSUBSYSP GT 0).ZG65E  VALID ARG           00265800
                    AIF   (T'&SUBSYSP EQ 'O').ZG65D  OMITTED            00265900
&ZASYSLNDX          SETA  0                                             00266000
.ZG65A              ANOP  ,           POSITIONAL MACRO KEY              00266100
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00266200
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG65C              00266300
&ZTLC               SETC 'SUBSYSP'                                      00266400
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG65A     00266500
.ZG65B              ANOP  ,                                             00266600
&ZXSUBSYSP          SETC  ''          RESET IN/OUTPUT                   00266700
&ZMS                SETC  'THE "SUBSYSP" KEY'                           00266800
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00266900
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00267000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00267100
                    AGO   .ZG65E                                        00267200
.ZG65C              ANOP  ,                                             00267300
&ZXSUBSYSP          SETC  ''          RESET IN/OUTPUT                   00267400
&ZMS                SETC  '"SUBSYSP='                                   00267500
&ZMS                SETC  '&ZMS.&SUBSYSP"'                              00267600
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00267700
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00267800
&ZMS                SETC  '&ZMS "CONNECT"'                              00267900
&ZMS                SETC  '&ZMS OR "VALUE".'                            00268000
                    MNOTE 8,' &ZMS '                                    00268100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00268200
                    AGO   .ZG65E                                        00268300
.ZG65D              ANOP  ,                                             00268400
&XSUBSYSP           SETC  'CONNECT'   SET DEFAULT KEYWORD               00268500
.ZG65E              ANOP  ,                                             00268600
.*------------------------------------------------------------------    00268700
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00268800
                    AIF   (K'&SUBSYSP(1) GT 0).ZG65F  PARM              00268900
&XSUBSYSP           SETC  ''          ENSURE NULL KEYWORD               00269000
&ZXSUBSYSP          SETC  ''          RESET IN/OUTPUT                   00269100
&ZMS                SETC  'THE'                                         00269200
&ZMS                SETC  '&ZMS "SUBSYSP" KEY AND ITS'                  00269300
&ZMS                SETC  '&ZMS ARGUMENT ARE REQUIRED.'                 00269400
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00269500
&ZMS                SETC  '&ZMS "CONNECT"'                              00269600
&ZMS                SETC  '&ZMS OR "VALUE".'                            00269700
                    MNOTE 8,' &ZMS '                                    00269800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00269900
.ZG65F              ANOP  ,                                             00270000
.*------------------------------------------------------------------    00270100
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00270200
&XMONTKNKEYP        SETC  ''          INITIALIZE XVARIABLE              00270300
.*-------------------------------------------------------------------   00270400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00270500
.ZG68               ANOP  ,                                             00270600
                    AIF   (K'&MONTKNKEYP(1) LE 0).ZG68A                 00270700
&ZTLC               SETC 'VALUE'                                        00270800
                    AIF   ('&MONTKNKEYP(1)' NE '&ZTLC').ZG72            00270900
&XMONTKNKEYP        SETC  'VALUE'     SET KEYWORD                       00271000
                    AIF   (N'&MONTKNKEYP LE 1).ZG68A  CK NUM            00271100
&ZMS                SETC  '"MONTKNKEYP='                                00271200
&ZMS                SETC  '&ZMS.&MONTKNKEYP"'                           00271300
&ZMS                SETC  '&ZMS "MONTKNKEYP"'                           00271400
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00271500
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00271600
.ZG68A              ANOP  ,                                             00271700
.*----------------------------------------------------------------***   00271800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00271900
                    AIF   (N'&MONTKNKEY LE 1).ZG70A  CK NUM             00272000
&ZMS                SETC  '"MONTKNKEY='                                 00272100
&ZMS                SETC  '&ZMS.&MONTKNKEY"'                            00272200
&ZMS                SETC  '&ZMS "MONTKNKEY"'                            00272300
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00272400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00272500
.ZG70A              ANOP  ,                                             00272600
.*-------------------------------------------------------------------   00272700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00272800
&ZXMONTKNKEY        SETC  'INPUT'     SET IN/OUTPUT                     00272900
&XMONTKNKEY         SETC  '&MONTKNKEY(1)'       SET XVARIABLE           00273000
                    AIF   (N'&MONTKNKEY GT 1).ZG70B  MULTI              00273100
&XMONTKNKEY         SETC  '&MONTKNKEY'          SET XVARIABLE           00273200
.ZG70B              AIF   (K'&MONTKNKEY(1) GT 0).ZG70C                  00273300
&ZXMONTKNKEY        SETC  ''          RESET IN/OUTPUT                   00273400
&ZMS                SETC  ' '                                           00273500
&ZMS                SETC  '&ZMS "MONTKNKEY" KEY AND ITS'                00273600
                    MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'              00273700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00273800
.ZG70C              ANOP  ,                                             00273900
.*-------------------------------------------------------------------   00274000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00274100
                    AIF   (K'&ZXMONTKNKEY LE 0).ZG70R  NOT I/O          00274200
                    AIF   ('&XMONTKNKEY'(1,1) NE '(').ZG70R             00274300
&ZCGPR              SETC  '&XMONTKNKEY'(2,K'&XMONTKNKEY-2)              00274400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG70P                  00274500
                    AIF   (K'&ZCGPR GT 2).ZG70Q                         00274600
                    AIF   ('&ZCGPR' EQ '0').ZG70Q                       00274700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00274800
                    AIF   (T'&ZCGPR NE 'N').ZG70Q  INVALID REG NAME     00274900
.ZG70P              ANOP  ,                                             00275000
                    AIF   (T'&ZCGPR NE 'N').ZG70R  NON NUMERIC          00275100
                    AIF   ('&ZCGPR' LT '2').ZG70Q                       00275200
                    AIF   ('&ZCGPR' LE '12').ZG70R                      00275300
.ZG70Q              ANOP  ,                                             00275400
&ZMS                SETC  '"MONTKNKEY='                                 00275500
&ZMS                SETC  '&ZMS.&MONTKNKEY"'                            00275600
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00275700
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'              00275800
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00275900
.ZG70R              ANOP  ,                                             00276000
.*-------------------------------------------------------------------   00276100
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00276200
.ZG72               ANOP  ,                                             00276300
&ZTLC               SETC 'PSWKEY'                                       00276400
                    AIF   ('&MONTKNKEYP(1)' NE '&ZTLC').ZG73            00276500
&XMONTKNKEYP        SETC  'PSWKEY'    SET KEYWORD                       00276600
                    AIF   (N'&MONTKNKEYP LE 1).ZG72A  CK NUM            00276700
&ZMS                SETC  '"MONTKNKEYP='                                00276800
&ZMS                SETC  '&ZMS.&MONTKNKEYP"'                           00276900
&ZMS                SETC  '&ZMS "MONTKNKEYP"'                           00277000
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00277100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00277200
.ZG72A              ANOP  ,                                             00277300
.*------------------------------------------------------------------    00277400
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00277500
&ZCVAL              SETC ''           CLEAR ERROR KEY ACCUMULATOR       00277600
.ZG72A0             AIF   (K'&MONTKNKEY LE 0).ZG72A1  OK                00277700
&ZCVAL              SETC '&ZCVAL MONTKNKEY'     INCORRECT KEY USED      00277800
.ZG72A1             AIF   (K'&ZCVAL LE 0).ZG72A2  OK                    00277900
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)                         00278000
&ZMS                SETC  '"MONTKNKEYP'                                 00278100
&ZMS                SETC  '&ZMS.=&MONTKNKEYP"'                          00278200
&ZMS                SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'          00278300
                    MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'          00278400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00278500
.ZG72A2             ANOP  ,                                             00278600
.*------------------------------------------------------------------    00278700
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00278800
.ZG73               ANOP  ,                                             00278900
&ZXMONTKNKEYP       SETC  'INPUT'     SET IN/OUTPUT                     00279000
                    AIF   (K'&XMONTKNKEYP GT 0).ZG73E  VALID ARG        00279100
                    AIF   (T'&MONTKNKEYP EQ 'O').ZG73D  OMITTED         00279200
&ZASYSLNDX          SETA  0                                             00279300
.ZG73A              ANOP  ,           POSITIONAL MACRO KEY              00279400
&ZASYSLNDX          SETA  &ZASYSLNDX+1                                  00279500
                    AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG73C              00279600
&ZTLC               SETC 'MONTKNKEYP'                                   00279700
                    AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG73A     00279800
.ZG73B              ANOP  ,                                             00279900
&ZXMONTKNKEYP       SETC  ''          RESET IN/OUTPUT                   00280000
&ZMS                SETC  'THE "MONTKNKEYP" KEY'                        00280100
&ZMS                SETC  '&ZMS MUST CONTAIN ONE'                       00280200
                    MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'              00280300
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00280400
                    AGO   .ZG73E                                        00280500
.ZG73C              ANOP  ,                                             00280600
&ZXMONTKNKEYP       SETC  ''          RESET IN/OUTPUT                   00280700
&ZMS                SETC  '"MONTKNKEYP='                                00280800
&ZMS                SETC  '&ZMS.&MONTKNKEYP"'                           00280900
&ZMS                SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '     00281000
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00281100
&ZMS                SETC  '&ZMS "VALUE"'                                00281200
&ZMS                SETC  '&ZMS OR "PSWKEY".'                           00281300
                    MNOTE 8,' &ZMS '                                    00281400
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00281500
                    AGO   .ZG73E                                        00281600
.ZG73D              ANOP  ,                                             00281700
&XMONTKNKEYP        SETC  'VALUE'     SET DEFAULT KEYWORD               00281800
.ZG73E              ANOP  ,                                             00281900
.*------------------------------------------------------------------    00282000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00282100
                    AIF   (K'&MONTKNKEYP(1) GT 0).ZG73F  PARM           00282200
&XMONTKNKEYP        SETC  ''          ENSURE NULL KEYWORD               00282300
&ZXMONTKNKEYP       SETC  ''          RESET IN/OUTPUT                   00282400
&ZMS                SETC  'THE'                                         00282500
&ZMS                SETC  '&ZMS "MONTKNKEYP" KEY AND ITS'               00282600
&ZMS                SETC  '&ZMS ARGUMENT ARE REQUIRED.'                 00282700
&ZMS                SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'           00282800
&ZMS                SETC  '&ZMS "VALUE"'                                00282900
&ZMS                SETC  '&ZMS OR "PSWKEY".'                           00283000
                    MNOTE 8,' &ZMS '                                    00283100
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00283200
.ZG73F              ANOP  ,                                             00283300
.*----------------------------------------------------------------***   00283400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00283500
                    AIF   (N'&RETCODE LE 1).ZG75A  CK NUM               00283600
&ZMS                SETC  '"RETCODE='                                   00283700
&ZMS                SETC  '&ZMS.&RETCODE"'                              00283800
&ZMS                SETC  '&ZMS "RETCODE"'                              00283900
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00284000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00284100
.ZG75A              ANOP  ,                                             00284200
.*-------------------------------------------------------------------   00284300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00284400
                    AIF   (K'&RETCODE(1) LE 0).ZG75C  NO PARM           00284500
&ZXRETCODE          SETC  'OUTPUT'    SET OUTPUT                        00284600
&XRETCODE           SETC  '&RETCODE(1)'         SET XVARIABLE           00284700
                    AIF   (N'&RETCODE GT 1).ZG75C                       00284800
&XRETCODE           SETC  '&RETCODE'  SET XVARIABLE                     00284900
.ZG75C              ANOP  ,                                             00285000
.*-------------------------------------------------------------------   00285100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00285200
                    AIF   (K'&ZXRETCODE LE 0).ZG75R  NOT I/O            00285300
                    AIF   ('&XRETCODE'(1,1) NE '(').ZG75R               00285400
&ZCGPR              SETC  '&XRETCODE'(2,K'&XRETCODE-2)                  00285500
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG75P                  00285600
                    AIF   (K'&ZCGPR GT 2).ZG75Q                         00285700
                    AIF   ('&ZCGPR' EQ '0').ZG75Q                       00285800
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00285900
                    AIF   (T'&ZCGPR NE 'N').ZG75Q  INVALID REG NAME     00286000
.ZG75P              ANOP  ,                                             00286100
                    AIF   (T'&ZCGPR NE 'N').ZG75R  NON NUMERIC          00286200
                    AIF   ('&ZCGPR' EQ '15').ZG75R                      00286300
                    AIF   ('&ZCGPR' LT '2').ZG75Q                       00286400
                    AIF   ('&ZCGPR' LE '12').ZG75R                      00286500
.ZG75Q              ANOP  ,                                             00286600
&ZMS                SETC  '"RETCODE='                                   00286700
&ZMS                SETC  '&ZMS.&RETCODE"'                              00286800
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00286900
                    MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'      00287000
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00287100
.ZG75R              ANOP  ,                                             00287200
.*----------------------------------------------------------------***   00287300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00287400
                    AIF   (N'&RSNCODE LE 1).ZG78A  CK NUM               00287500
&ZMS                SETC  '"RSNCODE='                                   00287600
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00287700
&ZMS                SETC  '&ZMS "RSNCODE"'                              00287800
                    MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'           00287900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00288000
.ZG78A              ANOP  ,                                             00288100
.*-------------------------------------------------------------------   00288200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00288300
                    AIF   (K'&RSNCODE(1) LE 0).ZG78C  NO PARM           00288400
&ZXRSNCODE          SETC  'OUTPUT'    SET OUTPUT                        00288500
&XRSNCODE           SETC  '&RSNCODE(1)'         SET XVARIABLE           00288600
                    AIF   (N'&RSNCODE GT 1).ZG78C                       00288700
&XRSNCODE           SETC  '&RSNCODE'  SET XVARIABLE                     00288800
.ZG78C              ANOP  ,                                             00288900
.*-------------------------------------------------------------------   00289000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00289100
                    AIF   (K'&ZXRSNCODE LE 0).ZG78R  NOT I/O            00289200
                    AIF   ('&XRSNCODE'(1,1) NE '(').ZG78R               00289300
&ZCGPR              SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                  00289400
                    AIF   ('&ZCGPR'(1,1) NE '0').ZG78P                  00289500
                    AIF   (K'&ZCGPR GT 2).ZG78Q                         00289600
                    AIF   ('&ZCGPR' EQ '0').ZG78R                       00289700
&ZCGPR              SETC  '&ZCGPR'(2,1)                                 00289800
                    AIF   (T'&ZCGPR NE 'N').ZG78Q  INVALID REG NAME     00289900
.ZG78P              ANOP  ,                                             00290000
                    AIF   (T'&ZCGPR NE 'N').ZG78R  NON NUMERIC          00290100
                    AIF   ('&ZCGPR' EQ '0').ZG78R                       00290200
                    AIF   ('&ZCGPR' LT '2').ZG78Q                       00290300
                    AIF   ('&ZCGPR' LE '12').ZG78R                      00290400
.ZG78Q              ANOP  ,                                             00290500
&ZMS                SETC  '"RSNCODE='                                   00290600
&ZMS                SETC  '&ZMS.&RSNCODE"'                              00290700
&ZMS                SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'     00290800
                    MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'       00290900
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00291000
.ZG78R              ANOP  ,                                             00291100
.******************************************************************     00291200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00291300
.******************************************************************     00291400
                    ACTR  10000                                         00291500
.*----------------------------------------------------------------***   00291600
.***AH.P02 EXTRA POSITIONALS                                            00291700
                    AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS          00291800
                    AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL          00291900
                    AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL      00292000
                    AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL       00292100
.ZGLISTX1           ANOP  ,                                             00292200
&ZCVAL              SETC  ''          ERROR FIELD                       00292300
&ZAWRK              SETA  0           POSITIONAL NUMBER                 00292400
.ZGLIST2            ANOP  ,                                             00292500
&ZAWRK              SETA  &ZAWRK+1    NEXT POSITIONAL                   00292600
                    AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE          00292700
&ZCVAL              SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA               00292800
                    AGO   .ZGLIST2                                      00292900
.*                                                                      00293000
.ZGLIST3            ANOP  ,                                             00293100
&ZCVAL              SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA            00293200
&ZMS                SETC  'POSITIONAL ARGUMENT(S),'                     00293300
&ZMS                SETC  '&ZMS "&ZCVAL"'                               00293400
&ZMS                SETC  '&ZMS CANNOT BE USED.'                        00293500
&ZMS                SETC  '&ZMS NO POSITIONAL ARGUMENTS'                00293600
                    MNOTE 8,' &ZMS ARE ALLOWED.'                        00293700
&ZMACRET            SETA  8           SET MACRO ERROR RETURN CODE       00293800
.ZGLISTX            ANOP  ,                                             00293900
&ZASYSLNDX          SETA  0                                             00294000
.*-------------------------------------------------------------------   00294100
.***AG.MF04 MF=(SLE)                                                    00294200
.ZGMFX              ANOP  ,           END OF FULL SYNTAX CHECK          00294300
.*******************************************************************    00294400
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00294500
.*******************************************************************    00294600
                    AIF   (&ZMACRET NE 0).ZLX2  ERROR DETECTED          00294700
.*******************************************************************    00294800
.***AE.01  START OF IWM4MCRE MACRO CODE                                 00294900
.*******************************************************************    00295000
                    LCLC  &M0M0001                 NAME                 00295100
&M0M0001            SETC  '&XLABEL'                SET NAME             00295200
                    AIF   (K'&XLABEL NE 0).XLAB2                        00295300
&M0M0001            SETC  'M00M&SYSNDX'            DEFAULT NAME         00295400
.*                                                                      00295500
.XLAB2              ANOP  ,                                             00295600
                    AIF   ('&XMF' EQ 'L').XLAB3                         00295700
&M0M0001 DS    0H                             IWM4MCRE-2                00295800
.XLAB3              ANOP  ,                                             00295900
.*******************************************************************    00296000
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00296100
.*******************************************************************    00296200
              PUSH  PRINT                                               00296300
                    AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON    00296400
                    PRINT OFF         ++ PR01                           00296500
                    AGO   .ZPRNTXX                                      00296600
.ZPRINTX            PRINT ON                                            00296700
.ZPRNTXX            ANOP  ,                                             00296800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00296900
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00297000
.********************************************************************   00297100
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00297200
.********************************************************************   00297300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00297400
                      LCLA  &ZOPN1         INVOCATION INDEX             00297500
                      LCLC  &ZOPL(4095)    LABEL                        00297600
                      LCLC  &ZOPO(4095)    OPERATION                    00297700
                      LCLC  &ZOPV(4095)    VALUE                        00297800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00297900
.*                                                                      00298000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00298100
.******************************************************************     00298200
.***AL.L10 IWM4MCRE FMT=LIST MF=S!L PARAMETERS                          00298300
.******************************************************************     00298400
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00298500
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00298600
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00298700
&XMFATTR              SETC  '0D'                                        00298800
.*                                                                      00298900
&ZOPN                 SETA  &ZOPN+1                                     00299000
&ZOPL(&ZOPN)          SETC  ' '                                         00299100
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00299200
&ZOPV(&ZOPN)          SETC  '4,8'                                       00299300
&ZOPN                 SETA  &ZOPN+1                                     00299400
&ZOPL(&ZOPN)          SETC  ' '                                         00299500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00299600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00299700
&ZOPD(&ZOPN)          SETC  '++ IWM4MCRE ARG PARMS'                     00299800
.*                                                                      00299900
&ZOPN                 SETA  &ZOPN+1                                     00300000
&ZOPL(&ZOPN)          SETC  ' '                                         00300100
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00300200
&ZOPV(&ZOPN)          SETC  '1'                                         00300300
&ZOPD(&ZOPN)          SETC  ' '                                         00300400
.*                                                                      00300500
.ZLMFSL2              ANOP  ,                                           00300600
.*-------------------------------------------------------------------   00300700
.***AM.L00  IWM4MCRE FMT=LIST name                                      00300800
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00300900
&ZOPN                 SETA &ZOPN+1                                      00301000
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00301100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00301200
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00301300
&ZOPD(&ZOPN)          SETC '++ IWM4MCRE NAME'                           00301400
.ZLMFSL2M             ANOP  ,                                           00301500
.*-------------------------------------------------------------------   00301600
.***AM.L01  IWM4MCRE FMT=LIST PARAMETERS                                00301700
&ZOPN                 SETA &ZOPN+1                                      00301800
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00301900
&ZOPO(&ZOPN)          SETC 'DS'                                         00302000
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00302100
&ZOPD(&ZOPN)          SETC '++ IWM4MCRE PARM LIST'                      00302200
.*-------------------------------------------------------------------   00302300
.***AM.L02 XVERSION XL1                                                 00302400
&ZOPN                 SETA &ZOPN+1                                      00302500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00302600
&ZOPO(&ZOPN)          SETC 'DS'                                         00302700
&ZOPV(&ZOPN)          SETC 'XL1'                                        00302800
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00302900
.*-------------------------------------------------------------------   00303000
.***AM.L03 XCREATE_OPTIONS BL.8                                         00303100
&ZOPN                 SETA &ZOPN+1                                      00303200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCREATE_OPTIONS'                  00303300
&ZOPO(&ZOPN)          SETC 'DS'                                         00303400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00303500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00303600
.*                                                                      00303700
&ZOPN                 SETA  &ZOPN+1                                     00303800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XMONTKNKEYP_VALUE'               00303900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00304000
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00304100
&ZOPD(&ZOPN)          SETC  '++ XMONTKNKEYP.'                           00304200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).VALUE'                        00304300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00304400
.*                                                                      00304500
&ZOPN                 SETA  &ZOPN+1                                     00304600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSUBSYSP_CONNECT'                00304700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00304800
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00304900
&ZOPD(&ZOPN)          SETC  '++ XSUBSYSP.'                              00305000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CONNECT'                      00305100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00305200
.*                                                                      00305300
&ZOPN                 SETA  &ZOPN+1                                     00305400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSUBSYSP_VALUE'                  00305500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00305600
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00305700
&ZOPD(&ZOPN)          SETC  '++ XSUBSYSP.'                              00305800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).VALUE'                        00305900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00306000
.*                                                                      00306100
&ZOPN                 SETA  &ZOPN+1                                     00306200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREPORTONLY_YES'                 00306300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00306400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00306500
&ZOPD(&ZOPN)          SETC  '++ XREPORTONLY.'                           00306600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00306700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00306800
.*                                                                      00306900
&ZOPN                 SETA  &ZOPN+1                                     00307000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XEWLM_YES'                       00307100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00307200
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00307300
&ZOPD(&ZOPN)          SETC  '++ XEWLM.'                                 00307400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00307500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00307600
.*                                                                      00307700
&ZOPN                 SETA  &ZOPN+1                                     00307800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XBPMGMTONLY_YES'                 00307900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00308000
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00308100
&ZOPD(&ZOPN)          SETC  '++ XBPMGMTONLY.'                           00308200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00308300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00308400
.*                                                                      00308500
&ZOPN                 SETA  &ZOPN+1                                     00308600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MONTKN64'                00308700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00308800
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00308900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00309000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MONTKN64'                     00309100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00309200
.*                                                                      00309300
&ZOPN                 SETA  &ZOPN+1                                     00309400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._IWM4MCRE'                        00309500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00309600
&ZOPV(&ZOPN)          SETC  'B''00000001'''                             00309700
&ZOPD(&ZOPN)          SETC  '++ MACUSED.'                               00309800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IWM4MCRE'                     00309900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00310000
.*-------------------------------------------------------------------   00310100
.***AM.L03 XCREATE_OPTIONS2 BL.8                                        00310200
&ZOPN                 SETA &ZOPN+1                                      00310300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCREATE_OPTIONS2'                 00310400
&ZOPO(&ZOPN)          SETC 'DS'                                         00310500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00310600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00310700
.*                                                                      00310800
&ZOPN                 SETA  &ZOPN+1                                     00310900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MONTKN64_LIST'           00311000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00311100
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00311200
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00311300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MONTKN64_LIST'                00311400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00311500
.*-------------------------------------------------------------------   00311600
.***AM.L09  XMONTKNKEY BL.8                                             00311700
&ZOPN                 SETA &ZOPN+1                                      00311800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKNKEY'                       00311900
&ZOPO(&ZOPN)          SETC 'DS'                                         00312000
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00312100
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKNKEY '                           00312200
.*-------------------------------------------------------------------   00312300
.***AM.L09  XMONTKN BL.32                                               00312400
&ZOPN                 SETA &ZOPN+1                                      00312500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN'                          00312600
&ZOPO(&ZOPN)          SETC 'DS'                                         00312700
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00312800
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN '                              00312900
.*-------------------------------------------------------------------   00313000
.***AM.L09  XSUBSYS CL4                                                 00313100
&ZOPN                 SETA &ZOPN+1                                      00313200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSUBSYS'                          00313300
&ZOPO(&ZOPN)          SETC 'DS'                                         00313400
&ZOPV(&ZOPN)          SETC 'CL4'                                        00313500
&ZOPD(&ZOPN)          SETC '++ &ZXSUBSYS '                              00313600
.*-------------------------------------------------------------------   00313700
.***AM.L09  XSUBSYSNM CL8                                               00313800
&ZOPN                 SETA &ZOPN+1                                      00313900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSUBSYSNM'                        00314000
&ZOPO(&ZOPN)          SETC 'DS'                                         00314100
&ZOPV(&ZOPN)          SETC 'CL8'                                        00314200
&ZOPD(&ZOPN)          SETC '++ &ZXSUBSYSNM '                            00314300
.*-------------------------------------------------------------------   00314400
.***AM.L09  XCONNTKN BL.32                                              00314500
&ZOPN                 SETA &ZOPN+1                                      00314600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONNTKN'                         00314700
&ZOPO(&ZOPN)          SETC 'DS'                                         00314800
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00314900
&ZOPD(&ZOPN)          SETC '++ &ZXCONNTKN '                             00315000
.*-------------------------------------------------------------------   00315100
.***AM.L09  XRSV0018 CL4                                                00315200
&ZOPN                 SETA &ZOPN+1                                      00315300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0018'                         00315400
&ZOPO(&ZOPN)          SETC 'DS'                                         00315500
&ZOPV(&ZOPN)          SETC 'CL4'                                        00315600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00315700
.*-------------------------------------------------------------------   00315800
.***AM.L09  XPLISTLEN XL2                                               00315900
&ZOPN                 SETA &ZOPN+1                                      00316000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00316100
&ZOPO(&ZOPN)          SETC 'DS'                                         00316200
&ZOPV(&ZOPN)          SETC 'XL2'                                        00316300
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00316400
.*-------------------------------------------------------------------   00316500
.***AM.L03 XREQTYPE_OPTIONS BL.8                                        00316600
&ZOPN                 SETA &ZOPN+1                                      00316700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQTYPE_OPTIONS'                 00316800
&ZOPO(&ZOPN)          SETC 'DS'                                         00316900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00317000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00317100
.*                                                                      00317200
&ZOPN                 SETA  &ZOPN+1                                     00317300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREQTYPE_MULTIPLE'               00317400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00317500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00317600
&ZOPD(&ZOPN)          SETC  '++ XREQTYPE.'                              00317700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MULTIPLE'                     00317800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00317900
.*                                                                      00318000
&ZOPN                 SETA  &ZOPN+1                                     00318100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XALLOCATEBELOW_YES'              00318200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00318300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00318400
&ZOPD(&ZOPN)          SETC  '++ XALLOCATEBELOW.'                        00318500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00318600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00318700
.*-------------------------------------------------------------------   00318800
.***AM.L09  XRSV001F CL1                                                00318900
&ZOPN                 SETA &ZOPN+1                                      00319000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV001F'                         00319100
&ZOPO(&ZOPN)          SETC 'DS'                                         00319200
&ZOPV(&ZOPN)          SETC 'CL1'                                        00319300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00319400
.*-------------------------------------------------------------------   00319500
.***AM.L09  XAMOUNT F                                                   00319600
&ZOPN                 SETA &ZOPN+1                                      00319700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XAMOUNT'                          00319800
&ZOPO(&ZOPN)          SETC 'DS'                                         00319900
&ZOPV(&ZOPN)          SETC 'F'                                          00320000
&ZOPD(&ZOPN)          SETC '++ &ZXAMOUNT '                              00320100
.*-------------------------------------------------------------------   00320200
.***AM.L09  XRSV0024 CL4                                                00320300
&ZOPN                 SETA &ZOPN+1                                      00320400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0024'                         00320500
&ZOPO(&ZOPN)          SETC 'DS'                                         00320600
&ZOPV(&ZOPN)          SETC 'CL4'                                        00320700
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00320800
.*-------------------------------------------------------------------   00320900
.***AM.L09  XLISTLEN F                                                  00321000
&ZOPN                 SETA &ZOPN+1                                      00321100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XLISTLEN'                         00321200
&ZOPO(&ZOPN)          SETC 'DS'                                         00321300
&ZOPV(&ZOPN)          SETC 'F'                                          00321400
&ZOPD(&ZOPN)          SETC '++ &ZXLISTLEN '                             00321500
.*-------------------------------------------------------------------   00321600
.***AM.L09  XRSV002C CL4                                                00321700
&ZOPN                 SETA &ZOPN+1                                      00321800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV002C'                         00321900
&ZOPO(&ZOPN)          SETC 'DS'                                         00322000
&ZOPV(&ZOPN)          SETC 'CL4'                                        00322100
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00322200
.*-------------------------------------------------------------------   00322300
.***AM.L09  XMONTKN_LIST_ADDRESS AD                                     00322400
&ZOPN                 SETA &ZOPN+1                                      00322500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN_LIST_ADDRESS'             00322600
&ZOPO(&ZOPN)          SETC 'DS'                                         00322700
&ZOPV(&ZOPN)          SETC 'AD'                                         00322800
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00322900
.*-------------------------------------------------------------------   00323000
.***AM.MLM2 SAVED LOCATION COUNTER                                      00323100
                      AIF  (&XPLISTVER GE 1).ZL28LA                     00323200
                      AIF  ('&ZENDBASEPL' NE '').ZL28LA                 00323300
&ZENDBASEPL           SETC 'YES'                                        00323400
&ZOPN                 SETA &ZOPN+1                                      00323500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00323600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00323700
&ZOPV(&ZOPN)          SETC '*'                                          00323800
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00323900
.ZL28LA               ANOP  ,                                           00324000
.*-------------------------------------------------------------------   00324100
.***AM.LVER1                                                            00324200
                      AIF  (&XPLISTVER LT 1).ZL28L                      00324300
.*-------------------------------------------------------------------   00324400
.*-------------------------------------------------------------------   00324500
.***AM.L09 ADDR3164 XGROUPNM AD                                         00324600
&ZOPN                 SETA &ZOPN+1                                      00324700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGROUPNM_ADDR3164'                00324800
&ZOPO(&ZOPN)          SETC 'DS'                                         00324900
&ZOPV(&ZOPN)          SETC 'AD'                                         00325000
&ZOPD(&ZOPN)          SETC '++ &ZXGROUPNM ADDR3164'                     00325100
.*-------------------------------------------------------------------   00325200
.***AM.LVER2                                                            00325300
.ZL28L                ANOP  ,                                           00325400
.*-------------------------------------------------------------------   00325500
.*-------------------------------------------------------------------   00325600
.***AM.LVER1                                                            00325700
                      AIF  (&XPLISTVER LT 1).ZL29L                      00325800
.*-------------------------------------------------------------------   00325900
.*-------------------------------------------------------------------   00326000
.***AM.L09  XGROUPNM_LEN F                                              00326100
&ZOPN                 SETA &ZOPN+1                                      00326200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGROUPNM_LEN'                     00326300
&ZOPO(&ZOPN)          SETC 'DS'                                         00326400
&ZOPV(&ZOPN)          SETC 'F'                                          00326500
&ZOPD(&ZOPN)          SETC '++ &ZXGROUPNM_LEN '                         00326600
.*-------------------------------------------------------------------   00326700
.***AM.LVER2                                                            00326800
.ZL29L                ANOP  ,                                           00326900
.*-------------------------------------------------------------------   00327000
.*-------------------------------------------------------------------   00327100
.***AM.MLM2 SAVED LOCATION COUNTER                                      00327200
                      AIF  (&XPLISTVER GE 2).ZL30LA                     00327300
                      AIF  ('&ZENDBASEPL' NE '').ZL30LA                 00327400
&ZENDBASEPL           SETC 'YES'                                        00327500
&ZOPN                 SETA &ZOPN+1                                      00327600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00327700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00327800
&ZOPV(&ZOPN)          SETC '*'                                          00327900
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00328000
.ZL30LA               ANOP  ,                                           00328100
.*-------------------------------------------------------------------   00328200
.***AM.LVER1                                                            00328300
                      AIF  (&XPLISTVER LT 2).ZL30L                      00328400
.*-------------------------------------------------------------------   00328500
.*-------------------------------------------------------------------   00328600
.***AM.L09  XRSV0044 CL4                                                00328700
&ZOPN                 SETA &ZOPN+1                                      00328800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0044'                         00328900
&ZOPO(&ZOPN)          SETC 'DS'                                         00329000
&ZOPV(&ZOPN)          SETC 'CL4'                                        00329100
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00329200
.*-------------------------------------------------------------------   00329300
.***AM.LVER2                                                            00329400
.ZL30L                ANOP  ,                                           00329500
.*-------------------------------------------------------------------   00329600
.*-------------------------------------------------------------------   00329700
.***AM.LVER1                                                            00329800
                      AIF  (&XPLISTVER LT 2).ZL31L                      00329900
.*-------------------------------------------------------------------   00330000
.*-------------------------------------------------------------------   00330100
.***AM.L09  XMONTKN64 BL.64                                             00330200
&ZOPN                 SETA &ZOPN+1                                      00330300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN64'                        00330400
&ZOPO(&ZOPN)          SETC 'DS'                                         00330500
&ZOPV(&ZOPN)          SETC 'BL.64'                                      00330600
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN64 '                            00330700
.*-------------------------------------------------------------------   00330800
.***AM.LVER2                                                            00330900
.ZL31L                ANOP  ,                                           00331000
.*-------------------------------------------------------------------   00331100
.*-------------------------------------------------------------------   00331200
.***AM.MLM1 SAVED LOCATION COUNTER                                      00331300
                      AIF  ('&ZENDBASEPL' NE '').ZL32LB                 00331400
&ZENDBASEPL           SETC 'YES'                                        00331500
&ZOPN                 SETA &ZOPN+1                                      00331600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00331700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00331800
&ZOPV(&ZOPN)          SETC '*'                                          00331900
&ZOPD(&ZOPN)          SETC '++ END OF BASE PLIST'                       00332000
.ZL32LB               ANOP  ,                                           00332100
.*-------------------------------------------------------------------   00332200
.***AM.PJR1 DEFINED ON XLISTLEN                                         00332300
&ZOPN                 SETA &ZOPN+1                                      00332400
&ZOPL(&ZOPN)          SETC ' '                                          00332500
&ZOPO(&ZOPN)          SETC 'ORG'                                        00332600
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+40'                               00332700
&ZOPD(&ZOPN)          SETC ' '                                          00332800
.*-------------------------------------------------------------------   00332900
.***AM.L09  XMONTKN_LISTLEN F                                           00333000
&ZOPN                 SETA &ZOPN+1                                      00333100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN_LISTLEN'                  00333200
&ZOPO(&ZOPN)          SETC 'DS'                                         00333300
&ZOPV(&ZOPN)          SETC 'F'                                          00333400
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN_LISTLEN '                      00333500
.*-------------------------------------------------------------------   00333600
.***AM.PJR1 DEFINED ON XMONTKN_LIST_ADDRESS                             00333700
&ZOPN                 SETA &ZOPN+1                                      00333800
&ZOPL(&ZOPN)          SETC ' '                                          00333900
&ZOPO(&ZOPN)          SETC 'ORG'                                        00334000
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+48'                               00334100
&ZOPD(&ZOPN)          SETC ' '                                          00334200
.*-------------------------------------------------------------------   00334300
.***AM.L09 ADDR3164 XMONTKN_LIST AD                                     00334400
&ZOPN                 SETA &ZOPN+1                                      00334500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN_LIST_ADDR3164'            00334600
&ZOPO(&ZOPN)          SETC 'DS'                                         00334700
&ZOPV(&ZOPN)          SETC 'AD'                                         00334800
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN_LIST ADDR3164'                 00334900
.*-------------------------------------------------------------------   00335000
.***AM.LVER1                                                            00335100
                      AIF  (&XPLISTVER LT 2).ZL36L                      00335200
.*-------------------------------------------------------------------   00335300
.*-------------------------------------------------------------------   00335400
.***AM.PJR1 DEFINED ON XMONTKN_LIST_ADDRESS                             00335500
&ZOPN                 SETA &ZOPN+1                                      00335600
&ZOPL(&ZOPN)          SETC ' '                                          00335700
&ZOPO(&ZOPN)          SETC 'ORG'                                        00335800
&ZOPV(&ZOPN)          SETC '&XMFCTRL.+48'                               00335900
&ZOPD(&ZOPN)          SETC ' '                                          00336000
.*-------------------------------------------------------------------   00336100
.***AM.LVER2                                                            00336200
.ZL36L                ANOP  ,                                           00336300
.*-------------------------------------------------------------------   00336400
.*-------------------------------------------------------------------   00336500
.***AM.LVER1                                                            00336600
                      AIF  (&XPLISTVER LT 2).ZL37L                      00336700
.*-------------------------------------------------------------------   00336800
.*-------------------------------------------------------------------   00336900
.***AM.L09 ADDR3164 XMONTKN64_LIST AD                                   00337000
&ZOPN                 SETA &ZOPN+1                                      00337100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMONTKN64_LIST_ADDR3164'          00337200
&ZOPO(&ZOPN)          SETC 'DS'                                         00337300
&ZOPV(&ZOPN)          SETC 'AD'                                         00337400
&ZOPD(&ZOPN)          SETC '++ &ZXMONTKN64_LIST ADDR3164'               00337500
.*-------------------------------------------------------------------   00337600
.***AM.LVER2                                                            00337700
.ZL37L                ANOP  ,                                           00337800
.*-------------------------------------------------------------------   00337900
&ZOPN                 SETA &ZOPN+1                                      00338000
&ZOPL(&ZOPN)          SETC ' '                                          00338100
&ZOPO(&ZOPN)          SETC 'ORG'                                        00338200
&ZOPV(&ZOPN)          SETC '&XMFCTRL._PL_END'                           00338300
&ZOPD(&ZOPN)          SETC 'RESET LOCATION COUNTER'                     00338400
.*-------------------------------------------------------------------   00338500
.***AM.L10 END OF IWM4MCRE LIST PARAMETERS                              00338600
&ZOPN                 SETA &ZOPN+1                                      00338700
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00338800
&ZOPO(&ZOPN)          SETC 'EQU'                                        00338900
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00339000
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00339100
.*                                                                      00339200
&ZOPN                 SETA &ZOPN+1                                      00339300
&ZOPL(&ZOPN)          SETC ' '                                          00339400
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00339500
&ZOPV(&ZOPN)          SETC '1'                                          00339600
&ZOPD(&ZOPN)          SETC ' '                                          00339700
.*-------------------------------------------------------------------   00339800
.***AL.L12 IWM4MCRE FMT=LIST MF=S!L PARAMETERS                          00339900
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00340000
.*                                                                      00340100
&ZOPN                 SETA  &ZOPN+1                                     00340200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00340300
&ZOPO(&ZOPN)          SETC  'DC'                                        00340400
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00340500
&ZOPD(&ZOPN)          SETC  '++ IWM4MCRE ARG PARMS'                     00340600
.*                                                                      00340700
.ZLMFSLX              ANOP  ,                                           00340800
.*-------------------------------------------------------------------   00340900
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00341000
&ZPLLEN               SETA 56                                           00341100
.*                                                                      00341200
                      AIF  (&XPLISTVER LT 1).ZLLEN2Z                    00341300
&ZPLLEN               SETA 68                                           00341400
.ZLLEN2Z              ANOP  ,                                           00341500
.*                                                                      00341600
                      AIF  (&XPLISTVER LT 2).ZLLEN3Z                    00341700
&ZPLLEN               SETA 80                                           00341800
.ZLLEN3Z              ANOP  ,                                           00341900
.*                                                                      00342000
.******************************************************************     00342100
.***AI.L01 IWM4MCRE FMT=LIST FILL IN PARAMETER AREA                     00342200
.******************************************************************     00342300
                      ACTR  10000                                       00342400
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00342500
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00342600
&ZCVAL                SETC  'LAE'          XAX MODE                     00342700
.ZIMFXA               ANOP ,                                            00342800
.*                                                                      00342900
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00343000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00343100
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00343200
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00343300
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00343400
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00343500
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00343600
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00343700
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00343800
&ZOPN                 SETA  &ZOPN+1                                     00343900
&ZOPL(&ZOPN)          SETC  ' '                                         00344000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00344100
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00344200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00344300
                      AGO   .ZIMFNX                                     00344400
.*                                                                      00344500
.ZIMFN2               ANOP ,                                            00344600
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00344700
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00344800
&ZOPN                 SETA  &ZOPN+1                                     00344900
&ZOPL(&ZOPN)          SETC  ' '                                         00345000
&ZOPO(&ZOPN)          SETC  'LAE'                                       00345100
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00345200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00345300
                      AGO   .ZIMFNX                                     00345400
.ZIMFNX1              ANOP ,                                            00345500
&ZOPN                 SETA  &ZOPN+1                                     00345600
&ZOPL(&ZOPN)          SETC  ' '                                         00345700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00345800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00345900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00346000
.ZIMFNX               ANOP ,                                            00346100
.********************************************************************   00346200
.***AI.L02 IWM4MCRE FMT=LIST INITIALIZE PARAMETER AREA                  00346300
.********************************************************************   00346400
.***AI.L03 MF=(SLE)                                                     00346500
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00346600
.*                                                                      00346700
&ZOPN                 SETA  &ZOPN+1                                     00346800
&ZOPL(&ZOPN)          SETC  ' '                                         00346900
&ZOPO(&ZOPN)          SETC  'XC'                                        00347000
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00347100
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00347200
.ZIMFLX               ANOP  ,                                           00347300
.*-------------------------------------------------------------------   00347400
.***AI.L04A XVERSION XL1                                                00347500
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00347600
&ZOPN                 SETA  &ZOPN+1                                     00347700
&ZOPL(&ZOPN)          SETC  ' '                                         00347800
&ZOPO(&ZOPN)          SETC  'MVI'                                       00347900
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00348000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00348100
.ZIMFVW               ANOP  ,                                           00348200
.*-------------------------------------------------------------------   00348300
.***AI.L05 XCREATE_OPTIONS BL1                                          00348400
&ZW                   SETC  ''                                          00348500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00348600
.*-------------------------------------------------------------------   00348700
.***AI.L08 XCREATE_OPTIONS "VALUE"                                      00348800
.***      BL1'1XXXXXXX'                                                 00348900
         AIF   ('&XMONTKNKEYP' NE 'VALUE').ZI3A                         00349000
&ZW                   SETC  '&ZW.1'                                     00349100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00349200
                      AGO   .ZI3C                                       00349300
.*                                                                      00349400
.ZI3A                 ANOP  ,                                           00349500
&ZW                   SETC  '&ZW.0'                                     00349600
.ZI3C                 ANOP  ,                                           00349700
.*-------------------------------------------------------------------   00349800
.***AI.L08 XCREATE_OPTIONS "CONNECT"                                    00349900
.***      BL1'X1XXXXXX'                                                 00350000
         AIF   ('&XSUBSYSP' NE 'CONNECT').ZI4A                          00350100
&ZW                   SETC  '&ZW.1'                                     00350200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00350300
                      AGO   .ZI4C                                       00350400
.*                                                                      00350500
.ZI4A                 ANOP  ,                                           00350600
&ZW                   SETC  '&ZW.0'                                     00350700
.ZI4C                 ANOP  ,                                           00350800
.*-------------------------------------------------------------------   00350900
.***AI.L08 XCREATE_OPTIONS "VALUE"                                      00351000
.***      BL1'XX1XXXXX'                                                 00351100
         AIF   ('&XSUBSYSP' NE 'VALUE').ZI5A                            00351200
&ZW                   SETC  '&ZW.1'                                     00351300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00351400
                      AGO   .ZI5C                                       00351500
.*                                                                      00351600
.ZI5A                 ANOP  ,                                           00351700
&ZW                   SETC  '&ZW.0'                                     00351800
.ZI5C                 ANOP  ,                                           00351900
.*-------------------------------------------------------------------   00352000
.***AI.L08 XCREATE_OPTIONS "YES"                                        00352100
.***      BL1'XXX1XXXX'                                                 00352200
         AIF   ('&XREPORTONLY' NE 'YES').ZI6A                           00352300
&ZW                   SETC  '&ZW.1'                                     00352400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00352500
                      AGO   .ZI6C                                       00352600
.*                                                                      00352700
.ZI6A                 ANOP  ,                                           00352800
&ZW                   SETC  '&ZW.0'                                     00352900
.ZI6C                 ANOP  ,                                           00353000
.*-------------------------------------------------------------------   00353100
.***AI.L08 XCREATE_OPTIONS "YES"                                        00353200
.***      BL1'XXXX1XXX'                                                 00353300
         AIF   ('&XEWLM' NE 'YES').ZI7A                                 00353400
&ZW                   SETC  '&ZW.1'                                     00353500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00353600
                      AGO   .ZI7C                                       00353700
.*                                                                      00353800
.ZI7A                 ANOP  ,                                           00353900
&ZW                   SETC  '&ZW.0'                                     00354000
.ZI7C                 ANOP  ,                                           00354100
.*-------------------------------------------------------------------   00354200
.***AI.L08 XCREATE_OPTIONS "YES"                                        00354300
.***      BL1'XXXXX1XX'                                                 00354400
         AIF   ('&XBPMGMTONLY' NE 'YES').ZI8A                           00354500
&ZW                   SETC  '&ZW.1'                                     00354600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00354700
                      AGO   .ZI8C                                       00354800
.*                                                                      00354900
.ZI8A                 ANOP  ,                                           00355000
&ZW                   SETC  '&ZW.0'                                     00355100
.ZI8C                 ANOP  ,                                           00355200
.*-------------------------------------------------------------------   00355300
.***AI.L08 XCREATE_OPTIONS "MONTKN64"                                   00355400
.***      BL1'XXXXXX1X'                                                 00355500
         AIF   ('&MONTKN64' EQ '').ZI9A                                 00355600
&ZW                   SETC  '&ZW.1'                                     00355700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00355800
                      AGO   .ZI9C                                       00355900
.*                                                                      00356000
.ZI9A                 ANOP  ,                                           00356100
&ZW                   SETC  '&ZW.0'                                     00356200
.ZI9C                 ANOP  ,                                           00356300
.*-------------------------------------------------------------------   00356400
.***AI.L08 XCREATE_OPTIONS "IWM4MCRE"                                   00356500
.***      BL1'XXXXXXX1'                                                 00356600
&ZW                   SETC  '&ZW.1'                                     00356700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00356800
.*-------------------------------------------------------------------   00356900
.***AI.L11 XCREATE_OPTIONS BL1                                          00357000
                      AIF   ('&ZCLNG' NE 'YES').ZI10E  ALL ZERO BITS    00357100
&ZOPN                 SETA  &ZOPN+1                                     00357200
&ZOPL(&ZOPN)          SETC  ' '                                         00357300
&ZOPO(&ZOPN)          SETC  'OI'                                        00357400
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00357500
&ZOPD(&ZOPN)          SETC  '++ 101 BL1'                                00357600
.ZI10E                ANOP  ,                                           00357700
.*-------------------------------------------------------------------   00357800
.***AI.L05 XCREATE_OPTIONS2 BL1                                         00357900
&ZW                   SETC  ''                                          00358000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00358100
.*-------------------------------------------------------------------   00358200
.***AI.L08 XCREATE_OPTIONS2 "MONTKN64_LIST"                             00358300
.***      BL1'1XXXXXXX'                                                 00358400
         AIF   ('&MONTKN64_LIST' EQ '').ZI12A                           00358500
&ZW                   SETC  '&ZW.10000000'                              00358600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00358700
                      AGO   .ZI12C                                      00358800
.*                                                                      00358900
.ZI12A                ANOP  ,                                           00359000
&ZW                   SETC  '&ZW.00000000'                              00359100
.ZI12C                ANOP  ,                                           00359200
.*-------------------------------------------------------------------   00359300
.***AI.L11 XCREATE_OPTIONS2 BL1                                         00359400
                      AIF   ('&ZCLNG' NE 'YES').ZI12E  ALL ZERO BITS    00359500
&ZOPN                 SETA  &ZOPN+1                                     00359600
&ZOPL(&ZOPN)          SETC  ' '                                         00359700
&ZOPO(&ZOPN)          SETC  'OI'                                        00359800
&ZOPV(&ZOPN)          SETC  '2(1),B''&ZW'''                             00359900
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00360000
.ZI12E                ANOP  ,                                           00360100
.*-------------------------------------------------------------------   00360200
.***AI.L25  XMONTKNKEY XL1                                              00360300
                      AIF   ('&ZXMONTKNKEY' EQ '').ZI13E                00360400
                      AIF   ('&ZXMONTKNKEY' EQ 'OUTPUT').ZI13E          00360500
&ZCGPR                SETC  '&XMONTKNKEY'                               00360600
.*                                                                      00360700
                      AIF   ('&XMONTKNKEY'(1,1) NE '(').ZI13B           00360800
&ZCGPR   SETC  '0('.'&XMONTKNKEY'(2,K'&XMONTKNKEY-2).')'                00360900
                      AGO   .ZI13D                                      00361000
.ZI13B                ANOP  ,                                           00361100
.*                                                                      00361200
&ZC                   SETC  '&XMONTKNKEY'(1,1)                          00361300
                      AIF   (T'&ZC NE 'N').ZI13D                        00361400
&ZC                   SETC  '&XMONTKNKEY'                               00361500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               00361600
&ZCGPR                SETC  '=BL1''&XMONTKNKEY'''                       00361700
.*                                                                      00361800
.ZI13D                ANOP  ,                                           00361900
.*                                                                      00362000
&ZOPN                 SETA  &ZOPN+1                                     00362100
&ZOPL(&ZOPN)          SETC  ' '                                         00362200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00362300
&ZOPV(&ZOPN)          SETC  '3(1,1),&ZCGPR'                             00362400
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKNKEY XMONTKNKEY'                00362500
.*                                                                      00362600
.ZI13E                ANOP  ,                                           00362700
.*-------------------------------------------------------------------   00362800
.***AI.L25  XSUBSYS CL4                                                 00362900
                      AIF   ('&ZXSUBSYS' EQ '').ZI15E                   00363000
                      AIF   ('&ZXSUBSYS' EQ 'OUTPUT').ZI15E             00363100
&ZCGPR                SETC  '&XSUBSYS'                                  00363200
.*                                                                      00363300
                      AIF   ('&XSUBSYS'(1,1) NE '(').ZI15B              00363400
&ZCGPR   SETC  '0('.'&XSUBSYS'(2,K'&XSUBSYS-2).')'                      00363500
.ZI15B                ANOP  ,                                           00363600
.*                                                                      00363700
&ZOPN                 SETA  &ZOPN+1                                     00363800
&ZOPL(&ZOPN)          SETC  ' '                                         00363900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00364000
&ZOPV(&ZOPN)          SETC  '8(4,1),&ZCGPR'                             00364100
&ZOPD(&ZOPN)          SETC  '++ &ZXSUBSYS XSUBSYS'                      00364200
.*                                                                      00364300
.ZI15E                ANOP  ,                                           00364400
.*-------------------------------------------------------------------   00364500
.***AI.L25  XSUBSYSNM CL8                                               00364600
                      AIF   ('&ZXSUBSYSNM' EQ '').ZI16E                 00364700
                      AIF   ('&ZXSUBSYSNM' EQ 'OUTPUT').ZI16E           00364800
&ZCGPR                SETC  '&XSUBSYSNM'                                00364900
.*                                                                      00365000
                      AIF   ('&XSUBSYSNM'(1,1) NE '(').ZI16B            00365100
&ZCGPR   SETC  '0('.'&XSUBSYSNM'(2,K'&XSUBSYSNM-2).')'                  00365200
.ZI16B                ANOP  ,                                           00365300
.*                                                                      00365400
&ZOPN                 SETA  &ZOPN+1                                     00365500
&ZOPL(&ZOPN)          SETC  ' '                                         00365600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00365700
&ZOPV(&ZOPN)          SETC  '12(8,1),&ZCGPR'                            00365800
&ZOPD(&ZOPN)          SETC  '++ &ZXSUBSYSNM XSUBSYSNM'                  00365900
.*                                                                      00366000
.ZI16E                ANOP  ,                                           00366100
.*-------------------------------------------------------------------   00366200
.***AI.L25  XCONNTKN XL4                                                00366300
                      AIF   ('&ZXCONNTKN' EQ '').ZI17E                  00366400
                      AIF   ('&ZXCONNTKN' EQ 'OUTPUT').ZI17E            00366500
&ZCGPR                SETC  '&XCONNTKN'                                 00366600
.*                                                                      00366700
                      AIF   ('&XCONNTKN'(1,1) NE '(').ZI17B             00366800
&ZCGPR   SETC  '0('.'&XCONNTKN'(2,K'&XCONNTKN-2).')'                    00366900
                      AGO   .ZI17D                                      00367000
.ZI17B                ANOP  ,                                           00367100
.*                                                                      00367200
&ZC                   SETC  '&XCONNTKN'(1,1)                            00367300
                      AIF   (T'&ZC NE 'N').ZI17D                        00367400
&ZC                   SETC  '&XCONNTKN'                                 00367500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI17D               00367600
&ZCGPR                SETC  '=BL4''&XCONNTKN'''                         00367700
.*                                                                      00367800
.ZI17D                ANOP  ,                                           00367900
.*                                                                      00368000
&ZOPN                 SETA  &ZOPN+1                                     00368100
&ZOPL(&ZOPN)          SETC  ' '                                         00368200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00368300
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00368400
&ZOPD(&ZOPN)          SETC  '++ &ZXCONNTKN XCONNTKN'                    00368500
.*                                                                      00368600
.ZI17E                ANOP  ,                                           00368700
.*-------------------------------------------------------------------   00368800
.***AI.L04 XPLISTLEN XL2                                                00368900
&ZOPN                 SETA  &ZOPN+1                                     00369000
&ZOPL(&ZOPN)          SETC  ' '                                         00369100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00369200
&ZOPV(&ZOPN)          SETC  '28(2,1),=AL2(&ZPLLEN)'                     00369300
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00369400
.*-------------------------------------------------------------------   00369500
.***AI.L05 XREQTYPE_OPTIONS BL1                                         00369600
&ZW                   SETC  ''                                          00369700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00369800
.*-------------------------------------------------------------------   00369900
.***AI.L08 XREQTYPE_OPTIONS "MULTIPLE"                                  00370000
.***      BL1'1XXXXXXX'                                                 00370100
         AIF   ('&XREQTYPE' NE 'MULTIPLE').ZI21A                        00370200
&ZW                   SETC  '&ZW.1'                                     00370300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00370400
                      AGO   .ZI21C                                      00370500
.*                                                                      00370600
.ZI21A                ANOP  ,                                           00370700
&ZW                   SETC  '&ZW.0'                                     00370800
.ZI21C                ANOP  ,                                           00370900
.*-------------------------------------------------------------------   00371000
.***AI.L08 XREQTYPE_OPTIONS "YES"                                       00371100
.***      BL1'X1XXXXXX'                                                 00371200
         AIF   ('&XALLOCATEBELOW' NE 'YES').ZI22A                       00371300
&ZW                   SETC  '&ZW.1000000'                               00371400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00371500
                      AGO   .ZI22C                                      00371600
.*                                                                      00371700
.ZI22A                ANOP  ,                                           00371800
&ZW                   SETC  '&ZW.0000000'                               00371900
.ZI22C                ANOP  ,                                           00372000
.*-------------------------------------------------------------------   00372100
.***AI.L11 XREQTYPE_OPTIONS BL1                                         00372200
                      AIF   ('&ZCLNG' NE 'YES').ZI22E  ALL ZERO BITS    00372300
&ZOPN                 SETA  &ZOPN+1                                     00372400
&ZOPL(&ZOPN)          SETC  ' '                                         00372500
&ZOPO(&ZOPN)          SETC  'OI'                                        00372600
&ZOPV(&ZOPN)          SETC  '30(1),B''&ZW'''                            00372700
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00372800
.ZI22E                ANOP  ,                                           00372900
.*-------------------------------------------------------------------   00373000
.***AI.L25  XAMOUNT F                                                   00373100
                      AIF   ('&ZXAMOUNT' EQ '').ZI24E                   00373200
                      AIF   ('&ZXAMOUNT' EQ 'OUTPUT').ZI24E             00373300
&ZCGPR                SETC  '&XAMOUNT'                                  00373400
.*                                                                      00373500
                      AIF   ('&XAMOUNT'(1,1) NE '(').ZI24B              00373600
&ZCGPR   SETC  '0('.'&XAMOUNT'(2,K'&XAMOUNT-2).')'                      00373700
                      AGO   .ZI24D                                      00373800
.ZI24B                ANOP  ,                                           00373900
.*                                                                      00374000
&ZC                   SETC  '&XAMOUNT'(1,1)                             00374100
                      AIF   (T'&ZC NE 'N').ZI24D                        00374200
&ZC                   SETC  '&XAMOUNT'                                  00374300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI24D               00374400
&ZCGPR                SETC  '=FL4''&XAMOUNT'''                          00374500
.*                                                                      00374600
.ZI24D                ANOP  ,                                           00374700
.*                                                                      00374800
&ZOPN                 SETA  &ZOPN+1                                     00374900
&ZOPL(&ZOPN)          SETC  ' '                                         00375000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00375100
&ZOPV(&ZOPN)          SETC  '32(4,1),&ZCGPR'                            00375200
&ZOPD(&ZOPN)          SETC  '++ &ZXAMOUNT XAMOUNT'                      00375300
.*                                                                      00375400
.ZI24E                ANOP  ,                                           00375500
.*-------------------------------------------------------------------   00375600
.***AI.L25  XLISTLEN F                                                  00375700
                      AIF   ('&ZXLISTLEN' EQ '').ZI26E                  00375800
                      AIF   ('&ZXLISTLEN' EQ 'OUTPUT').ZI26E            00375900
&ZCGPR                SETC  '&XLISTLEN'                                 00376000
.*                                                                      00376100
                      AIF   ('&XLISTLEN'(1,1) NE '(').ZI26B             00376200
&ZCGPR   SETC  '0('.'&XLISTLEN'(2,K'&XLISTLEN-2).')'                    00376300
                      AGO   .ZI26D                                      00376400
.ZI26B                ANOP  ,                                           00376500
.*                                                                      00376600
&ZC                   SETC  '&XLISTLEN'(1,1)                            00376700
                      AIF   (T'&ZC NE 'N').ZI26D                        00376800
&ZC                   SETC  '&XLISTLEN'                                 00376900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI26D               00377000
&ZCGPR                SETC  '=AL4(&XLISTLEN)'                           00377100
.*                                                                      00377200
.ZI26D                ANOP  ,                                           00377300
.*                                                                      00377400
&ZOPN                 SETA  &ZOPN+1                                     00377500
&ZOPL(&ZOPN)          SETC  ' '                                         00377600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00377700
&ZOPV(&ZOPN)          SETC  '40(4,1),&ZCGPR'                            00377800
&ZOPD(&ZOPN)          SETC  '++ &ZXLISTLEN XLISTLEN'                    00377900
.*                                                                      00378000
.ZI26E                ANOP  ,                                           00378100
.*-------------------------------------------------------------------   00378200
.***AI.LVER01                                                           00378300
                      AIF  (&XPLISTVER LT 1).ZI29Z                      00378400
.*-------------------------------------------------------------------   00378500
.***AI.L18 ADDR3164 XGROUPNM AD                                         00378600
         AIF   ('&XGROUPNM' NE 'NO_GROUPNM').ZI29                       00378700
&ZXGROUPNM            SETC  ''             RESET INPUT/OUTPUT           00378800
.ZI29                 ANOP  ,                                           00378900
.*-------------------------------------------------------------------   00379000
.***AI.L19 ADDR3164 XGROUPNM AD                                         00379100
                      AIF   ('&ZXGROUPNM' EQ '').ZI29H                  00379200
&ZCLNG                SETC  '&XGROUPNM'                                 00379300
&ZCGPR                SETC  '14'                                        00379400
         AIF   ('&XGROUPNM'(1,1) EQ '(').ZI29F  IN GPR                  00379500
.*                                                                      00379600
&ZOPN                 SETA  &ZOPN+1                                     00379700
&ZOPL(&ZOPN)          SETC  ' '                                         00379800
&ZOPO(&ZOPN)          SETC  'LA'                                        00379900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00380000
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPNM XGROUPNM'                    00380100
.*                                                                      00380200
                      AGO   .ZI29G                                      00380300
.*                                                                      00380400
.ZI29F                ANOP  ,                                           00380500
&ZCGPR   SETC  '&XGROUPNM'(2,K'&XGROUPNM-2)                             00380600
.*                                                                      00380700
.ZI29G                ANOP  ,                                           00380800
                      AIF   ('&SYSAM64' EQ 'YES').ZI29H1A               00380900
.*                                                                      00381000
&ZOPN                 SETA  &ZOPN+1                                     00381100
&ZOPL(&ZOPN)          SETC  ' '                                         00381200
&ZOPO(&ZOPN)          SETC  'ST'                                        00381300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+56(,1)'                           00381400
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPNM XGROUPNM'                    00381500
.*                                                                      00381600
                      AGO   .ZI29H                                      00381700
.ZI29H1A              ANOP  ,                                           00381800
.*                                                                      00381900
&ZOPN                 SETA  &ZOPN+1                                     00382000
&ZOPL(&ZOPN)          SETC  ' '                                         00382100
&ZOPO(&ZOPN)          SETC  'STG'                                       00382200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,56(,1)'                             00382300
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPNM XGROUPNM'                    00382400
.*                                                                      00382500
.ZI29H                ANOP  ,                                           00382600
.*-------------------------------------------------------------------   00382700
.***AI.LVER02                                                           00382800
.ZI29Z                ANOP  ,                                           00382900
.*-------------------------------------------------------------------   00383000
.***AI.LVER01                                                           00383100
                      AIF  (&XPLISTVER LT 1).ZI30Z                      00383200
.*-------------------------------------------------------------------   00383300
.***AI.L25  XGROUPNM_LEN F                                              00383400
                      AIF   ('&ZXGROUPNM_LEN' EQ '').ZI30E              00383500
                      AIF   ('&ZXGROUPNM_LEN' EQ 'OUTPUT').ZI30E        00383600
&ZCGPR                SETC  '&XGROUPNM_LEN'                             00383700
.*                                                                      00383800
                      AIF   ('&XGROUPNM_LEN'(1,1) NE '(').ZI30B         00383900
&ZCGPR   SETC  '0('.'&XGROUPNM_LEN'(2,K'&XGROUPNM_LEN-2).')'            00384000
                      AGO   .ZI30D                                      00384100
.ZI30B                ANOP  ,                                           00384200
.*                                                                      00384300
&ZC                   SETC  '&XGROUPNM_LEN'(1,1)                        00384400
                      AIF   (T'&ZC NE 'N').ZI30D                        00384500
&ZC                   SETC  '&XGROUPNM_LEN'                             00384600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI30D               00384700
&ZCGPR                SETC  '=AL4(&XGROUPNM_LEN)'                       00384800
.*                                                                      00384900
.ZI30D                ANOP  ,                                           00385000
.*                                                                      00385100
&ZOPN                 SETA  &ZOPN+1                                     00385200
&ZOPL(&ZOPN)          SETC  ' '                                         00385300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00385400
&ZOPV(&ZOPN)          SETC  '64(4,1),&ZCGPR'                            00385500
&ZOPD(&ZOPN)          SETC  '++ &ZXGROUPNM_LEN XGROUPNM_LEN'            00385600
.*                                                                      00385700
.ZI30E                ANOP  ,                                           00385800
.*-------------------------------------------------------------------   00385900
.***AI.LVER02                                                           00386000
.ZI30Z                ANOP  ,                                           00386100
.*-------------------------------------------------------------------   00386200
.***AI.LVER01                                                           00386300
                      AIF  (&XPLISTVER LT 2).ZI31Z                      00386400
.*-------------------------------------------------------------------   00386500
.***AI.LVER02                                                           00386600
.ZI31Z                ANOP  ,                                           00386700
.*-------------------------------------------------------------------   00386800
.***AI.L25  XMONTKN_LISTLEN F                                           00386900
                      AIF   ('&ZXMONTKN_LISTLEN' EQ '').ZI34E           00387000
                      AIF   ('&ZXMONTKN_LISTLEN' EQ 'OUTPUT').ZI34E     00387100
&ZCGPR                SETC  '&XMONTKN_LISTLEN'                          00387200
.*                                                                      00387300
                      AIF   ('&XMONTKN_LISTLEN'(1,1) NE '(').ZI34B      00387400
&ZCGPR   SETC  '0('.'&XMONTKN_LISTLEN'(2,K'&XMONTKN_LISTLEN-2).')'      00387500
.ZI34B                ANOP  ,                                           00387600
.*                                                                      00387700
&ZC                   SETC  '&XMONTKN_LISTLEN'(1,1)                     00387800
                      AIF   (T'&ZC NE 'N').ZI34D                        00387900
&ZC                   SETC  '&XMONTKN_LISTLEN'                          00388000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI34D               00388100
&ZCGPR                SETC  '=AL4(&XMONTKN_LISTLEN)'                    00388200
.*                                                                      00388300
.ZI34D                ANOP  ,                                           00388400
.*                                                                      00388500
&ZOPN                 SETA  &ZOPN+1                                     00388600
&ZOPL(&ZOPN)          SETC  ' '                                         00388700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00388800
&ZOPV(&ZOPN)          SETC  '40(4,1),&ZCGPR'                            00388900
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN_LISTLEN XMONTKN_LISTLEN'      00389000
.*                                                                      00389100
.ZI34E                ANOP  ,                                           00389200
.*-------------------------------------------------------------------   00389300
.***AI.L19 ADDR3164 XMONTKN_LIST AD                                     00389400
                      AIF   ('&ZXMONTKN_LIST' EQ '').ZI36H              00389500
&ZCLNG                SETC  '&XMONTKN_LIST'                             00389600
&ZCGPR                SETC  '14'                                        00389700
         AIF   ('&XMONTKN_LIST'(1,1) EQ '(').ZI36F  IN GPR              00389800
.*                                                                      00389900
&ZOPN                 SETA  &ZOPN+1                                     00390000
&ZOPL(&ZOPN)          SETC  ' '                                         00390100
&ZOPO(&ZOPN)          SETC  'LA'                                        00390200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00390300
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN_LIST XMONTKN_LIST'            00390400
.*                                                                      00390500
                      AGO   .ZI36G                                      00390600
.*                                                                      00390700
.ZI36F                ANOP  ,                                           00390800
&ZCGPR   SETC  '&XMONTKN_LIST'(2,K'&XMONTKN_LIST-2)                     00390900
.*                                                                      00391000
.ZI36G                ANOP  ,                                           00391100
                      AIF   ('&SYSAM64' EQ 'YES').ZI36H1A               00391200
.*                                                                      00391300
&ZOPN                 SETA  &ZOPN+1                                     00391400
&ZOPL(&ZOPN)          SETC  ' '                                         00391500
&ZOPO(&ZOPN)          SETC  'ST'                                        00391600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+48(,1)'                           00391700
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN_LIST XMONTKN_LIST'            00391800
.*                                                                      00391900
                      AGO   .ZI36H                                      00392000
.ZI36H1A              ANOP  ,                                           00392100
.*                                                                      00392200
&ZOPN                 SETA  &ZOPN+1                                     00392300
&ZOPL(&ZOPN)          SETC  ' '                                         00392400
&ZOPO(&ZOPN)          SETC  'STG'                                       00392500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,48(,1)'                             00392600
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN_LIST XMONTKN_LIST'            00392700
.*                                                                      00392800
.ZI36H                ANOP  ,                                           00392900
.*-------------------------------------------------------------------   00393000
.***AI.LVER01                                                           00393100
                      AIF  (&XPLISTVER LT 2).ZI38Z                      00393200
.*-------------------------------------------------------------------   00393300
.***AI.L19 ADDR3164 XMONTKN64_LIST AD                                   00393400
                      AIF   ('&ZXMONTKN64_LIST' EQ '').ZI38H            00393500
&ZCLNG                SETC  '&XMONTKN64_LIST'                           00393600
&ZCGPR                SETC  '14'                                        00393700
         AIF   ('&XMONTKN64_LIST'(1,1) EQ '(').ZI38F  IN GPR            00393800
.*                                                                      00393900
&ZOPN                 SETA  &ZOPN+1                                     00394000
&ZOPL(&ZOPN)          SETC  ' '                                         00394100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00394200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00394300
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN64_LIST XMONTKN64_LIST'        00394400
.*                                                                      00394500
                      AGO   .ZI38G                                      00394600
.*                                                                      00394700
.ZI38F                ANOP  ,                                           00394800
&ZCGPR   SETC  '&XMONTKN64_LIST'(2,K'&XMONTKN64_LIST-2)                 00394900
.*                                                                      00395000
.ZI38G                ANOP  ,                                           00395100
                      AIF   ('&SYSAM64' EQ 'YES').ZI38H1A               00395200
.*                                                                      00395300
&ZOPN                 SETA  &ZOPN+1                                     00395400
&ZOPL(&ZOPN)          SETC  ' '                                         00395500
&ZOPO(&ZOPN)          SETC  'ST'                                        00395600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4+48(,1)'                           00395700
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN64_LIST XMONTKN64_LIST'        00395800
.*                                                                      00395900
                      AGO   .ZI38H                                      00396000
.ZI38H1A              ANOP  ,                                           00396100
.*                                                                      00396200
&ZOPN                 SETA  &ZOPN+1                                     00396300
&ZOPL(&ZOPN)          SETC  ' '                                         00396400
&ZOPO(&ZOPN)          SETC  'STG'                                       00396500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,48(,1)'                             00396600
&ZOPD(&ZOPN)          SETC  '++ &ZXMONTKN64_LIST XMONTKN64_LIST'        00396700
.*                                                                      00396800
.ZI38H                ANOP  ,                                           00396900
.*-------------------------------------------------------------------   00397000
.***AI.LVER02                                                           00397100
.ZI38Z                ANOP  ,                                           00397200
.*-------------------------------------------------------------------   00397300
&ZOPN1                SETA &ZOPN                                        00397400
.*******************************************************************    00397500
.***  PROCESS IWM4MCRE OUTPUT PARAMETERS                                00397600
.*******************************************************************    00397700
                      ACTR  10000                                       00397800
.*------------------------------------------------------------------    00397900
.***AO.L02 XMONTKN XL4                                                  00398000
         AIF   ('&ZXMONTKN' EQ 'OUTPUT').ZO14A  OUTPUT                  00398100
         AIF   ('&ZXMONTKN' NE 'INOUT').ZO14C  INOUT                    00398200
.ZO14A    AIF   ('&XMONTKN'(1,1) NE '(').ZO14B  ADDR IN GPR             00398300
&ZCGPR   SETC  '&XMONTKN'(2,K'&XMONTKN-2)                               00398400
&ZOPN                 SETA  &ZOPN+1                                     00398500
&ZOPL(&ZOPN)          SETC  ' '                                         00398600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00398700
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),4(1)'                          00398800
&ZOPD(&ZOPN)          SETC  '++ XMONTKN XL4'                            00398900
                      AGO   .ZO14C                                      00399000
.*                                                                      00399100
.ZO14B                ANOP  ,                                           00399200
&ZAWRK   SETA  K'&XMONTKN                                               00399300
         AIF   ('&XMONTKN'(&ZAWRK,1) NE ')').ZO14G                      00399400
&ZN      SETA  2                                                        00399500
.ZO14H    ANOP                                                          00399600
         AIF   (&ZN GE &ZAWRK).ZO14G                                    00399700
         AIF   ('&XMONTKN'(&ZN,1) NE '(').ZO14I                         00399800
&ZC      SETC  '&XMONTKN'(1,&ZN).'4'.','                                00399900
&ZC      SETC  '&ZC'.'&XMONTKN'(&ZN+1,&ZAWRK-&ZN).',4(1)'               00400000
         AGO   .ZO14J                                                   00400100
.ZO14I    ANOP                                                          00400200
&ZN      SETA  &ZN+1                                                    00400300
         AGO   .ZO14H                                                   00400400
.ZO14G    ANOP                                                          00400500
&ZC      SETC  '&XMONTKN.(4),4(1)'                                      00400600
.ZO14J    ANOP                                                          00400700
&ZOPN                 SETA  &ZOPN+1                                     00400800
&ZOPL(&ZOPN)          SETC  ' '                                         00400900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00401000
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00401100
&ZOPD(&ZOPN)          SETC  '++ XMONTKN XL4'                            00401200
.ZO14C                ANOP  ,                                           00401300
.*------------------------------------------------------------------    00401400
.***AO.LVER01                                                           00401500
                      AIF  (&XPLISTVER LT 2).ZO32Z  PLVER               00401600
.*------------------------------------------------------------------    00401700
.***AO.L02 XMONTKN64 XL8                                                00401800
         AIF   ('&ZXMONTKN64' EQ 'OUTPUT').ZO32A  OUTPUT                00401900
         AIF   ('&ZXMONTKN64' NE 'INOUT').ZO32C  INOUT                  00402000
.ZO32A    AIF   ('&XMONTKN64'(1,1) NE '(').ZO32B  ADDR IN GPR           00402100
&ZCGPR   SETC  '&XMONTKN64'(2,K'&XMONTKN64-2)                           00402200
&ZOPN                 SETA  &ZOPN+1                                     00402300
&ZOPL(&ZOPN)          SETC  ' '                                         00402400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00402500
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),72(1)'                         00402600
&ZOPD(&ZOPN)          SETC  '++ XMONTKN64 XL8'                          00402700
                      AGO   .ZO32C                                      00402800
.*                                                                      00402900
.ZO32B                ANOP  ,                                           00403000
&ZAWRK   SETA  K'&XMONTKN64                                             00403100
         AIF   ('&XMONTKN64'(&ZAWRK,1) NE ')').ZO32G                    00403200
&ZN      SETA  2                                                        00403300
.ZO32H    ANOP                                                          00403400
         AIF   (&ZN GE &ZAWRK).ZO32G                                    00403500
         AIF   ('&XMONTKN64'(&ZN,1) NE '(').ZO32I                       00403600
&ZC      SETC  '&XMONTKN64'(1,&ZN).'8'.','                              00403700
&ZC      SETC  '&ZC'.'&XMONTKN64'(&ZN+1,&ZAWRK-&ZN).',72(1)'            00403800
         AGO   .ZO32J                                                   00403900
.ZO32I    ANOP                                                          00404000
&ZN      SETA  &ZN+1                                                    00404100
         AGO   .ZO32H                                                   00404200
.ZO32G    ANOP                                                          00404300
&ZC      SETC  '&XMONTKN64.(8),72(1)'                                   00404400
.ZO32J    ANOP                                                          00404500
&ZOPN                 SETA  &ZOPN+1                                     00404600
&ZOPL(&ZOPN)          SETC  ' '                                         00404700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00404800
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00404900
&ZOPD(&ZOPN)          SETC  '++ XMONTKN64 XL8'                          00405000
.ZO32C                ANOP  ,                                           00405100
.*------------------------------------------------------------------    00405200
.***AO.LVER02                                                           00405300
.ZO32Z                ANOP  ,                                           00405400
.*******************************************************************    00405500
.***AO.X02  RETURN CODE PROCESSING                                      00405600
.*******************************************************************    00405700
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00405800
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00405900
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00406000
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00406100
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00406200
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00406300
&ZOPN                 SETA  &ZOPN+1                                     00406400
&ZOPL(&ZOPN)          SETC  ' '                                         00406500
&ZOPO(&ZOPN)          SETC  'ST'                                        00406600
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00406700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00406800
                      AGO   .ZMRETX                                     00406900
.*                                                                      00407000
.ZMRET2               ANOP  ,                                           00407100
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00407200
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00407300
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00407400
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00407500
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00407600
&ZOPN                 SETA  &ZOPN+1                                     00407700
&ZOPL(&ZOPN)          SETC  ' '                                         00407800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00407900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00408000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00408100
.ZMRETX               ANOP  ,                                           00408200
.*******************************************************************    00408300
.***AO.X03  REASON CODE PROCESSING                                      00408400
.*******************************************************************    00408500
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00408600
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00408700
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00408800
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00408900
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00409000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00409100
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00409200
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00409300
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00409400
&ZOPN                 SETA  &ZOPN+1                                     00409500
&ZOPL(&ZOPN)          SETC  ' '                                         00409600
&ZOPO(&ZOPN)          SETC  'ST'                                        00409700
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00409800
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00409900
                      AGO   .ZMRSNX                                     00410000
.*                                                                      00410100
.ZMRSN2               ANOP  ,                                           00410200
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00410300
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00410400
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00410500
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00410600
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00410700
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00410800
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00410900
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00411000
&ZOPN                 SETA  &ZOPN+1                                     00411100
&ZOPL(&ZOPN)          SETC  ' '                                         00411200
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00411300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00411400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00411500
.ZMRSNX               ANOP  ,                                           00411600
.*******************************************************************    00411700
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00411800
.*******************************************************************    00411900
.ZMFLX                ANOP  ,              MF=L PROCESSING              00412000
.*******************************************************************    00412100
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00412200
.*******************************************************************    00412300
                      ACTR  10000                                       00412400
.*                                                                      00412500
                      LCLA  &ZLC           COLUMN POSITION              00412600
                      LCLA  &ZOPX          LIST TABLE INDEX             00412700
                      LCLC  &ZLL           LABEL                        00412800
                      LCLC  &ZLOP          OPERATION                    00412900
                      LCLC  &ZLV           VALUE                        00413000
                      LCLC  &ZLD           DESCRIPTION                  00413100
.*                                                                      00413200
&ZOPX                 SETA  1                                           00413300
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00413400
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00413500
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00413600
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00413700
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00413800
                      AIF   (K'&ZLD LE 0).ZL5                           00413900
&ZLC                  SETA  35             COMMENT COLUMN               00414000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00414100
&ZLC                  SETA  33             COMMMENT COLUMN              00414200
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00414300
&ZLV                  SETC  '&ZLV'.' '                                  00414400
                      AGO   .ZL3                                        00414500
.*                                                                      00414600
.ZL4                  ANOP  ,                                           00414700
&ZLV                  SETC  '&ZLV'.' '                                  00414800
.ZL5                  ANOP  ,                                           00414900
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00415000
.*                                                                      00415100
&ZLL     &ZLOP &ZLV                                                     00415200
.*                                                                      00415300
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00415400
                      AGO   .ZL2           CONTINUE LOOPING             00415500
.*                                                                      00415600
.ZLX                  ANOP  ,                                           00415700
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00415800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00415900
         LLGT  14,16(0,0)              GET CVT ADDRESS          @L3C    00416000
.*------------------------------------------------------------------    00416100
         AIF   ('&SYSAM64' NE 'YES').AMODE31                            00416200
         TM    CVTOSLV3-CVT(14),CVTH7709  test for HBB7709 presence     00416300
         JNZ   VEROK&SYSNDX               running on HBB7709    @L3C    00416400
         LA    0,IWMRSNCODEBADVERSION     HBB7709 is required           00416500
         LA    15,IWMRETCODEINVOCERROR    set return code               00416600
         J     END&SYSNDX                 skip service          @L3C    00416700
VEROK&SYSNDX DS    0H                     version check successful      00416800
.AMODE31 ANOP  ,                                                        00416900
.*-------------------------------------------------------------------   00417000
         L     14,772(14,0)            GET SFT ADDRESS                  00417100
         L     14,380(14,0)            GET LX FOR SERVICE ROUTINE       00417200
         LA    15,1                    GET EX FOR SERVICE ROUTINE       00417300
         OR    14,15                   GET PC NUMBER                    00417400
         PC    0(14)                                                    00417500
END&SYSNDX DS    0H                    END LABEL                        00417600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00417700
.ZLINKX               ANOP  ,                                           00417800
.*******************************************************************    00417900
.***AP.X01  FORMAT GENERATED CODE                                       00418000
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00418100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00418200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00418300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00418400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00418500
                      AIF   (K'&ZLD LE 0).ZL51                          00418600
&ZLC                  SETA  35             COMMENT COLUMN               00418700
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00418800
&ZLC                  SETA  33             COMMENT COLUMN               00418900
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00419000
&ZLV                  SETC  '&ZLV'.' '                                  00419100
                      AGO   .ZL31                                       00419200
.*                                                                      00419300
.ZL41                 ANOP  ,                                           00419400
&ZLV                  SETC  '&ZLV'.' '                                  00419500
.ZL51                 ANOP  ,                                           00419600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00419700
.*                                                                      00419800
&ZLL     &ZLOP &ZLV                                                     00419900
.*                                                                      00420000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00420100
                      AGO   .ZL21          CONTINUE LOOPING             00420200
.*                                                                      00420300
.ZLX1                 ANOP  ,                                           00420400
.*******************************************************************    00420500
.***AP.X02  END OF IWM4MCRE MACRO                                       00420600
&ZIWM4MCRE            SETC  'YES'          SET IWM4MCRE USED            00420700
         POP   PRINT                                                    00420800
*                                            IWM4MCRE-2                 00420900
         SPACE 1                                                        00421000
.ZLX2                 ANOP  ,                                           00421100
         MEND                                                           00421200
**********************************************************************/ 00421300
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00421400
*%IWM4MCRE: MACRO KEYS(REQTYPE,MONTKN,MONTKN64,ALLOCATEBELOW,AMOUNT,    00421500
*                 MONTKN_LIST,MONTKN64_LIST,MONTKN_LISTLEN,LISTLEN,     00421600
*                 REPORTONLY,BPMGMTONLY,SUBSYSP,CONNTKN,SUBSYS,         00421700
*                 SUBSYSNM,EWLM,GROUPNM,GROUPNM_LEN,MONTKNKEYP,         00421800
*                 MONTKNKEY,RETCODE,RSNCODE,PLISTVER,MF);               00421900
*  ANS('?'!!MACLABEL!!' '!!'IWM4MCRP '!!MACLIST!!                       00422000
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00422100
*%END IWM4MCRE;                                                         00422200

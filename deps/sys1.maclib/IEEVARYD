*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IEEVARYD                              -02/24/09-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  VARY Device Service                           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 1994, 2008                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7750                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      IEEVARYD is a programming interface to the function performed  * 00002100
*      by the MVS VARY device online/offline/autoswitch/unavailable   * 00002200
*      system command.                                                * 00002300
*                                                                     * 00002400
*      You provide a device array which contains an entry for each    * 00002500
*      device upon which the function is to be performed.  IEEVARYD   * 00002600
*      sets a return and reason code for each device in the device    * 00002700
*      array to indicate the results of each VARY device operation    * 00002800
*      rather than issuing messages to a console.                     * 00002900
*                                                                     * 00003000
*      The macro expansion alters the contents of registers 0, 1, 14, * 00003100
*      and 15.                                                        * 00003200
*                                                                     * 00003300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003400
*                                                                     * 00003500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003600
*                                                                     * 00003700
*01* ENVIRONMENT:                                                     * 00003800
*                                                                     * 00003900
*                                                                     * 00004000
*      Dispatchable unit mode: Task mode.                             * 00004100
*                                                                     * 00004200
*      Minimum authorization: Supervisor state or PSW Key Mask (PKM)  * 00004300
*                        allowing keys 0-7.                           * 00004400
*                                                                     * 00004500
*      AMODE:            31-bit.                                      * 00004600
*                                                                     * 00004700
*      ASC mode:         Primary.  PASN=HASN=SASN.                    * 00004800
*                                                                     * 00004900
*      Serialization:    Enabled.  Unlocked.                          * 00005000
*                                                                     * 00005100
*      Restrictions:                                                  * 00005200
*                                                                     * 00005300
*                        The caller's address space must be           * 00005400
*                        non-swappable.                               * 00005500
*                                                                     * 00005600
*                        The control parameters must be in the        * 00005700
*                        caller's primary address space.              * 00005800
*                                                                     * 00005900
*                        The IEEVARYD macro does not invoke SAF.  If  * 00006000
*                        you require that the calling program's       * 00006100
*                        authority to perform a vary device operation * 00006200
*                        be checked, issue RACROUTE REQUEST=AUTH      * 00006300
*                        before issuing the IEEVARYD macro.           * 00006400
*                                                                     * 00006500
*                        The calling program must perform any logging * 00006600
*                        of information associated with the operation * 00006700
*                        (for example, in the system log (SYSLOG)).   * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*                                                                     * 00007100
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00007200
*                      GR2-GR13    Undefined                          * 00007300
*                      GR14-GR15   Reserved                           * 00007400
*                      AR0-AR1     Reserved                           * 00007500
*                      AR2-AR13    Undefined                          * 00007600
*                      AR14-AR15   Reserved                           * 00007700
*                                                                     * 00007800
*01* OUTPUT REGISTERS: GR0         Reason code                        * 00007900
*                      GR1         Unpredictable                      * 00008000
*                      GR2-GR13    Unchanged                          * 00008100
*                      GR14        Unpredictable                      * 00008200
*                      GR15        Return code                        * 00008300
*                      AR0-AR1     Unpredictable                      * 00008400
*                      AR2-AR13    Unchanged                          * 00008500
*                      AR14-AR15   Unpredictable                      * 00008600
*                                                                     * 00008700
*01* SYNTAX:                                                          * 00008800
*                                                                     * 00008900
*Ýxlabel¨  IEEVARYD     OPERATION=xoperation                          * 00009000
*                      ,DEVICES=xdevices                              * 00009100
*                     Ý,NUMDEVS=»xnumdevs!1º¨                         * 00009200
*                     Ý,RESULTS=xresults¨                             * 00009300
*                     Ý,CALLERID=»xcallerid!NO_CALLERIDº¨             * 00009400
*                     Ý,RETCODE=xretcode¨                             * 00009500
*                     Ý,RSNCODE=xrsncode¨                             * 00009600
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00009700
*                    ÐÝ,MF=S¨                                         * 00009800
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00009900
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                    * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*      Where:                                                         * 00010300
*                                                                     * 00010400
*                                                                     * 00010500
*      Ýxlabel¨                                                       * 00010600
*          is an optional symbol, starting in column 1, that is the   * 00010700
*          name on the IEEVARYD macro invocation.  The name must      * 00010800
*          conform to the rules for an ordinary assembler language    * 00010900
*          symbol.                                                    * 00011000
*          DEFAULT: No name.                                          * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*      OPERATION=xoperation                                           * 00011600
*          is the name (RS-type), or address in register (2)-(12), of * 00011700
*          a required character input which identifies the VARY       * 00011800
*          device operation to be performed on the device(s)          * 00011900
*          specified in the DEVICES parameter.  The OPERATION area is * 00012000
*          mapped by the IEEZB833 macro.                              * 00012100
*                                                                     * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*      DEVICES=xdevices                                               * 00012600
*          is the name (RS-type), or address in register (2)-(12), of * 00012700
*          a required character input variable length area which      * 00012800
*          identifies the devices upon which the VARY operation is to * 00012900
*          be performed.  The DEVICES area is an array which is       * 00013000
*          mapped by the IEEZB833 macro.                              * 00013100
*                                                                     * 00013200
*                                                                     * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*      ÝNUMDEVS=»xnumdevs!1º¨                                         * 00013600
*          is the name (RS-type), or address in register (2)-(12), of * 00013700
*          an optional fullword input which specifies the number of   * 00013800
*          devices in the device array.                               * 00013900
*          DEFAULT: 1                                                 * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*      ÝRESULTS=xresults¨                                             * 00014500
*          is the name (RS-type), or address in register (2)-(12), of * 00014600
*          an optional character output variable length area which    * 00014700
*          contains the results of the VARY operation.  The RESULTS   * 00014800
*          area, which is mapped by the IEEZB834 macro, is an array   * 00014900
*          which contains results for the VARY operation on each      * 00015000
*          device specified in the DEVICES area.                      * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*                                                                     * 00015400
*                                                                     * 00015500
*      ÝCALLERID=»xcallerid!NO_CALLERIDº¨                             * 00015600
*          is the name (RS-type), or address in register (2)-(12), of * 00015700
*          an optional 8 character input which identifies the caller  * 00015800
*          of the VARY operation.  If CALLERID is specified, then MVS * 00015900
*          will use this identifier as an insert in the message(s)    * 00016000
*          that MVS issues to hardcopy which indicate that a device   * 00016100
*          was brought online/offline or the autoswitch attribute or  * 00016200
*          unavailable state was changed.  The CALLERID insert        * 00016300
*          identifies the initiator of the VARY operation.            * 00016400
*          DEFAULT: NO_CALLERID                                       * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*      ÝRETCODE=xretcode¨                                             * 00017000
*          is the name (RS-type) of an optional fullword output       * 00017100
*          variable, or register (2)-(12) or (15), into which the     * 00017200
*          return code is to be copied from GPR 15.  If you specify   * 00017300
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00017400
*          the value will be left in GPR 15.                          * 00017500
*                                                                     * 00017600
*                                                                     * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*      ÝRSNCODE=xrsncode¨                                             * 00018000
*          is the name (RS-type) of an optional fullword output       * 00018100
*          variable into which the reason code is to be copied from   * 00018200
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00018300
*          R0 (within or without parentheses), the value will be left * 00018400
*          in GPR 0.                                                  * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*                                                                     * 00018900
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00019000
*          is an optional byte input decimal value in the "1-1" range * 00019100
*          that specifies the macro version.  PLISTVER is the only    * 00019200
*          key allowed on the list form of MF and determines which    * 00019300
*          parameter list is generated.  Note that MAX may be         * 00019400
*          specified instead of a number, and the parameter list will * 00019500
*          be of the largest size currently supported. This size may  * 00019600
*          grow from release to release (thus possibly affecting the  * 00019700
*          amount of storage needed by your program).  If your        * 00019800
*          program can tolerate this, IBM recommends that you always  * 00019900
*          specify MAX when creating the list form parameter list as  * 00020000
*          that will ensure that the list form parameter list is      * 00020100
*          always long enough to hold whatever parameters might be    * 00020200
*          specified on the execute form.                             * 00020300
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00020400
*          default is the lowest version which allows all of the      * 00020500
*          parameters specified on the invocation to be processed.    * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*      ÝMF=»S!L!Eº¨                                                   * 00021100
*          is an optional keyword input which specifies the macro     * 00021200
*          form.                                                      * 00021300
*          DEFAULT: S                                                 * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*          ÝMF=S¨                                                     * 00021700
*              specifies the standard form of the macro.  The "S"     * 00021800
*              form generates code to put the parameters into an      * 00021900
*              in-line parameter list and invoke the desired service. * 00022000
*              Full checking for required macro keys is done along    * 00022100
*              with supplying defaults for omitted optional           * 00022200
*              parameters.                                            * 00022300
*                                                                     * 00022400
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00022500
*              specifies the list form of the macro.  The "L" form    * 00022600
*              defines an area to be used for the parameter list.     * 00022700
*              Only the PLISTVER key may be specified on the          * 00022800
*              invocation.  All other macro parameters are flagged as * 00022900
*              errors.  If PLISTVER is not specified, the original    * 00023000
*              parameter list definition is used.                     * 00023100
*                                                                     * 00023200
*            ,xmfctrl                                                 * 00023300
*              is a required input.  It is the name of a storage area * 00023400
*              for the parameter list.                                * 00023500
*                                                                     * 00023600
*            »,xmfattr!0Dº                                            * 00023700
*              is an optional 60 character input string that varies   * 00023800
*              from 1 to 60 characters. Use it to force boundary      * 00023900
*              alignment of the parameter list. Use only 0F or 0D.    * 00024000
*              DEFAULT: 0D which forces the parameter list to a       * 00024100
*              doubleword boundary.                                   * 00024200
*                                                                     * 00024300
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00024400
*              specifies the execute form of the macro.  The "E" form * 00024500
*              generates code to put the parameters into the          * 00024600
*              parameter list specified by xmfctrl and provides full  * 00024700
*              syntax checking with default setting.                  * 00024800
*                                                                     * 00024900
*            ,xmfctrl                                                 * 00025000
*              is a required input.  It is the name (RS-type), or     * 00025100
*              address in register (1)-(12), of a storage area for    * 00025200
*              the parameter list.                                    * 00025300
*                                                                     * 00025400
*            »,COMPLETEº                                              * 00025500
*              is an optional keyword input which specifies the       * 00025600
*              degree of macro parameter syntax checking.             * 00025700
*              DEFAULT: COMPLETE                                      * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*              COMPLETE                                               * 00026100
*                  Checking for required macro keys is done and       * 00026200
*                  defaults are supplied for omitted optional         * 00026300
*                  parameters.                                        * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*01* RETURN CODES:                                                    * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                 X'00'     The operation was performed against each  * 00027600
*                           specified device and MVS set the          * 00027700
*                           VDRSARR_RETCODE field to 0 for each       * 00027800
*                           device in the device array (VDRSARR).     * 00027900
*                                                                     * 00028000
*                 X'04'     The operation was performed against all   * 00028100
*                           specified devices, but MVS set the        * 00028200
*                           VDRSARR_RETCODE field to a non-zero value * 00028300
*                           for at least one device in the device     * 00028400
*                           array (VDRSARR).                          * 00028500
*                                                                     * 00028600
*                 X'08'     Error in caller's parameters.             * 00028700
*                                                                     * 00028800
*                           Reason codes                              * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*                           X'01'     MVS could not access the        * 00029200
*                                     control parameter list.         * 00029300
*                                                                     * 00029400
*                           X'02'     MVS could not access the        * 00029500
*                                     storage area specified on the   * 00029600
*                                     DEVICES parameter.              * 00029700
*                                                                     * 00029800
*                           X'03'     MVS could not access the        * 00029900
*                                     storage area specified on the   * 00030000
*                                     OPERATION parameter.            * 00030100
*                                                                     * 00030200
*                           X'04'     MVS could not access the        * 00030300
*                                     storage area specified on the   * 00030400
*                                     RESULTS parameter.              * 00030500
*                                                                     * 00030600
*                           X'05'     Command keyword specification   * 00030700
*                                     in the OPERATION area is not    * 00030800
*                                     valid.                          * 00030900
*                                                                     * 00031000
*                           X'06'     The combination of vary device  * 00031100
*                                     options specified in the        * 00031200
*                                     OPERATION area is not valid.    * 00031300
*                                                                     * 00031400
*                           X'07'     The NUMDEVS value is not valid. * 00031500
*                                                                     * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                 X'0C'     MVS was temporarily unable to process the * 00031900
*                           requested operation.  The operation may   * 00032000
*                           be successful if retried at a later time. * 00032100
*                                                                     * 00032200
*                           Reason codes                              * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*                           X'00'     The caller requested the        * 00032600
*                                     VDEV_DO_NOT_WAIT_FOR_ENQ        * 00032700
*                                     option, and the IEEVARYD        * 00032800
*                                     service was unable to obtain    * 00032900
*                                     the SYSIEFSD.Q4 resource in a   * 00033000
*                                     reasonable amount of time.      * 00033100
*                                                                     * 00033200
*                           X'04'     The caller requested the        * 00033300
*                                     VDEV_DO_NOT_WAIT_FOR_ENQ        * 00033400
*                                     option, and the IEEVARYD        * 00033500
*                                     service was unable to obtain    * 00033600
*                                     the SYSIEFSD.VARYDEV resource   * 00033700
*                                     in a reasonable amount of time. * 00033800
*                                                                     * 00033900
*                           X'08'     The IEEVARYD service was        * 00034000
*                                     processing a console device and * 00034100
*                                     it was unable to obtain the     * 00034200
*                                     SYSZMCS SYSMCS#MCS resource.    * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*                 X'10'     MVS encountered an unexpected error and   * 00034700
*                           was unable to attempt the operation       * 00034800
*                           against one or more devices.  Record this * 00034900
*                           return code and supply it to the          * 00035000
*                           appropriate IBM support personnel.        * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*01* REASON CODES:                                                    * 00035700
*                                                                     * 00035800
*       See return codes section.                                     * 00035900
*                                                                     * 00036000
*01* MODULE TYPE:  ASSEM MACRO                                        * 00036100
*                                                                     * 00036200
*02*   PROCESSOR:  ASSEM                                              * 00036300
*                                                                     * 00036400
*01* COMPONENT:  SC1B8                                                * 00036500
*                                                                     * 00036600
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00036700
*                                                                     * 00036800
*01* MACRO USAGE NOTES:                                               * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00037200
*        global macro variable.  Any value other than 'NO' will       * 00037300
*        result in the macro expansion being printed.  The default is * 00037400
*        'YES'.  The following examples illustrate how the ZPRINT     * 00037500
*        variable should be set.                                      * 00037600
*                                                                     * 00037700
*                    GBLC &ZPRINT                                     * 00037800
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*    2.  All   keys   currently   contained  in  the  IEEVARYD  macro * 00038200
*        correspond  to  version  1.   If you specify PLISTVER, use a * 00038300
*        value of 1 or MAX.                                           * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                                                                     * 00038800
*01* CHANGE ACTIVITY:                                                 * 00038900
*                                                                     * 00039000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00039100
*                                                                     * 00039200
*    $L0=SYSOP4LC HBB5510 921205 PDLC:  Sysplex Operations            * 00039300
*    $D1=DMN4005  HBB5510 930121 PDLC:  Add reason codes              * 00039400
*    $P1=PIG2764  HBB5510 930830 PDLC:  Fix Assembler version         * 00039500
*    $P2=PIG3394  HBB5510 931019 PDLC:  Fix description of OPERATION  * 00039600
*                                         parameter                   * 00039700
*    $L1=SHRTP83J HBB5520 940415 PD3J:  Add VARY AUTOSWITCH to        * 00039800
*                                         descriptions.               * 00039900
*    $01=OA12454  HBB7720 051014 PDTA:  Add return code X'0C'.        * 00040000
*    $L2=UNAVAIL  HBB7750 070427 PDTA:  Mark Tape Unavailable         * 00040100
*    $02=OA26061  HBB7740 081017 PDKP:  Add return code X'0C' reason  * 00040200
*                                         code x'08'                  * 00040300
****** END OF SPECIFICATIONS *****************************************/ 00040400
*/********************************************************************* 00040500
         MACRO                                                          00040600
&XLABEL  IEEVARYD &OPERATION=,&DEVICES=,&NUMDEVS=,&RESULTS=,&CALLERID=,*00040700
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00040800
.*                                                                      00040900
*               MACDATE -02/24/09-<1>                                   00041000
.*                                                                      00041100
.*******************************************************************    00041200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00041300
.*******************************************************************    00041400
               GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                  00041500
               GBLC  &ZTEST      YES=TEST NO=NO TEST                    00041600
               GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX            00041700
.*                                                                      00041800
               GBLC  &ZIEEVARYD  YES=MACRO USED AT LEAST ONCE           00041900
.*******************************************************************    00042000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00042100
.*******************************************************************    00042200
               LCLC  &ZMS        ERROR MESSAGE WORK AREA                00042300
               LCLC  &ZCNDX      SYSNDX CHARACTERS                      00042400
               LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED             00042500
               LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR            00042600
               LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE            00042700
               LCLA  &ZAWRK      USED AS A WORK AREA                    00042800
               LCLA  &ZASIZ      USED FOR SIZE OF VALUE                 00042900
               LCLA  &ZN         NUMERIC WORK VARIABLE                  00043000
               LCLC  &ZC         CHARACTER WORK VARIABLE                00043100
               LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE            00043200
               LCLA  &ZTLA       VALUE TOO LONG VARIABLE                00043300
               LCLC  &ZMAC_G     "G" or null                            00043400
&ZMAC_G        SETC  ''                                                 00043500
               LCLC  &ZMAC_LR                                           00043600
&ZMAC_LR       SETC  'LR'                                               00043700
               LCLC  &ZMAC_L                                            00043800
&ZMAC_L        SETC  'L'                                                00043900
               LCLC  &ZMAC_ST                                           00044000
&ZMAC_ST       SETC  'ST'                                               00044100
               LCLA  &ZMACRET    MACRO RETURN CODE                      00044200
&ZMACRET       SETA  0           ASSUME NO ERRORS                       00044300
.*                                                                      00044400
               LCLC  &ZCSYSLIST(255)            NONXKEY, POS ARRAY      00044500
               LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()             00044600
               LCLA  &ZPLLEN     PARAMETER LIST LENGTH                  00044700
               LCLC  &ZENDBASEPL                End of base PL          00044800
               LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                  00044900
.*******************************************************************    00045000
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00045100
.*******************************************************************    00045200
               LCLA  &ZI         INDEX FOR ARRAY                        00045300
               LCLA  &ZJ         INDEX FOR PARMS                        00045400
               LCLA  &ZK         INDEX FOR PARSE                        00045500
               LCLA  &ZLO        LOW RANGE VALUE                        00045600
               LCLA  &ZHI        HIGH RANGE VALUE                       00045700
               LCLC  &ZW         WORK AREA FOR PARM                     00045800
.********************************************************************   00045900
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00046000
.********************************************************************   00046100
               GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                00046200
               GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE         00046300
               GBLA  &SYSALVL    SYSSTATE ARCHLVL                       00046400
               GBLC  &SYSAM64    SYSSTATE AMODE64                       00046500
.*                                                                      00046600
               AIF   (K'&SYSASCE GT 0).ZSYS4    SYS STATE DEFINED       00046700
               AIF   (K'&SYSSPLV GT 0).ZSYS2    SP LEVEL DEFINED        00046800
               SPLEVEL  TEST                                            00046900
.ZSYS2         ANOP  ,                                                  00047000
               AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1              00047100
               AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1              00047200
               SYSSTATE TEST                                            00047300
               AGO   .ZSYS4                                             00047400
.ZSYS3         ANOP  ,                                                  00047500
&SYSASCE       SETC  'P'         ASSUME SYSSTATE PRIMARY                00047600
.ZSYS4         ANOP  ,                                                  00047700
.*******************************************************************    00047800
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00047900
.*******************************************************************    00048000
               LCLC  &XOPERATION                ++ NAME                 00048100
               LCLC  &XDEVICES   ++ NAME                                00048200
               LCLC  &XNUMDEVS   ++ NAME                                00048300
               LCLC  &XRESULTS   ++ NAME                                00048400
               LCLC  &XCALLERID  ++ NAME                                00048500
               LCLC  &XRETCODE   ++ NAME                                00048600
               LCLC  &XRSNCODE   ++ NAME                                00048700
               LCLA  &XPLISTVER  ++ VALUE                               00048800
               LCLC  &XMF        ++ VALUE                               00048900
               LCLC  &XMFCTRL    ++ NAME                                00049000
               LCLC  &XMFATTR    ++ VALUE                               00049100
               LCLC  &XMFSCK     ++ VALUE                               00049200
.*******************************************************************    00049300
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00049400
.*******************************************************************    00049500
               LCLC  &ZXOPERATION               ++ INPUT NAME           00049600
               LCLC  &ZXDEVICES  ++ INPUT NAME                          00049700
               LCLC  &ZXNUMDEVS  ++ INPUT NAME                          00049800
               LCLC  &ZXRESULTS  ++ OUTPUT NAME                         00049900
               LCLC  &ZXCALLERID                ++ INPUT NAME           00050000
               LCLC  &ZXRETCODE  ++ OUTPUT NAME                         00050100
               LCLC  &ZXRSNCODE  ++ OUTPUT NAME                         00050200
               LCLC  &ZXPLISTVER                ++ INPUT VALUE          00050300
               LCLC  &ZXMF       ++ INPUT VALUE                         00050400
               LCLC  &ZXMFCTRL   ++ INPUT NAME                          00050500
               LCLC  &ZXMFATTR   ++ INPUT VALUE                         00050600
               LCLC  &ZXMFSCK    ++ INPUT VALUE                         00050700
.********************************************************************   00050800
.***AC.PLV01  PROCESS PLISTVER                                      *   00050900
.********************************************************************   00051000
&XPLISTVER      SETA  1                                                 00051100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00051200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00051300
&XPLISTVER      SETA  1                                                 00051400
.ZPLV0          ANOP  ,                                                 00051500
.*                                                                      00051600
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00051700
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00051800
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00051900
.*-------------------------------------------------------------------   00052000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00052100
&ZMS            SETC  '"PLISTVER='                                      00052200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00052300
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00052400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00052500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00052600
                AGO   .ZPVCK2                                           00052700
.ZPVCK3         ANOP  ,                                                 00052800
.*-------------------------------------------------------------------   00052900
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00053000
&ZMS            SETC  '"PLISTVER='                                      00053100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00053200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00053300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00053400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00053500
                AGO   .ZPVCKE                                           00053600
.ZPVCK2         ANOP  ,                                                 00053700
.*-------------------------------------------------------------------   00053800
&ZCVAL          SETC  '&PLISTVER(1)'                                    00053900
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00054000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00054100
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00054200
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00054300
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00054400
.ZPVCK6         ANOP  ,                                                 00054500
&ZMS            SETC  '"PLISTVER='                                      00054600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00054700
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00054800
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00054900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00055000
&XPLISTVER      SETA  1                                                 00055100
                AGO   .ZPVCKE                                           00055200
.*-------------------------------------------------------------------   00055300
.ZPVCK4A        ANOP  ,                                                 00055400
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00055500
&ZMS            SETC  'PLISTVER='                                       00055600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00055700
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00055800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00055900
                MNOTE 8,' &ZMS IS REQUIRED.'                            00056000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00056100
                AGO   .ZPVCK5                                           00056200
.ZPVCK4         ANOP  ,                                                 00056300
&XPLISTVER      SETA  &PLISTVER(1)                                      00056400
.ZPVCK5         ANOP  ,                                                 00056500
.ZPVCKE         ANOP  ,                                                 00056600
.********************************************************************   00056700
.***AG.MF01 PROCESS MF MACRO FORMS                                      00056800
.********************************************************************   00056900
               ACTR  10000                                              00057000
.*------------------------------------------------------------------    00057100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00057200
&XMF           SETC  ''          INITIALIZE XVARIABLE                   00057300
.*-------------------------------------------------------------------   00057400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00057500
.ZG27          ANOP  ,                                                  00057600
&ZTLC          SETC 'S'                                                 00057700
               AIF   ('&MF(1)' NE '&ZTLC').ZG28                         00057800
&XMF           SETC  'S'         SET KEYWORD                            00057900
               AIF   (N'&MF LE 1).ZG27A         CK NUM                  00058000
&ZMS           SETC  '"MF='                                             00058100
&ZMS           SETC  '&ZMS.&MF"'                                        00058200
&ZMS           SETC  '&ZMS "MF"'                                        00058300
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00058400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00058500
.ZG27A         ANOP  ,                                                  00058600
.*-------------------------------------------------------------------   00058700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00058800
.ZG28          ANOP  ,                                                  00058900
&ZTLC          SETC 'L'                                                 00059000
               AIF   ('&MF(1)' NE '&ZTLC').ZG35                         00059100
&XMF           SETC  'L'         SET KEYWORD                            00059200
               AIF   (N'&MF LE 3).ZG28A         CK NUM                  00059300
&ZMS           SETC  '"MF='                                             00059400
&ZMS           SETC  '&ZMS.&MF"'                                        00059500
&ZMS           SETC  '&ZMS "MF"'                                        00059600
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               00059700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00059800
.ZG28A         ANOP  ,                                                  00059900
.*-------------------------------------------------------------------   00060000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00060100
               AIF   (N'&SYSLIST NE 0).ZG28B    POSITIONALS?            00060200
               AIF   ('&OPERATION' NE '').ZG28B  KEYS?                  00060300
               AIF   ('&DEVICES' NE '').ZG28B   KEYS?                   00060400
               AIF   ('&NUMDEVS' NE '').ZG28B   KEYS?                   00060500
               AIF   ('&RESULTS' NE '').ZG28B   KEYS?                   00060600
               AIF   ('&CALLERID' NE '').ZG28B  KEYS?                   00060700
               AIF   ('&RETCODE' NE '').ZG28B   KEYS?                   00060800
               AIF   ('&RSNCODE' NE '').ZG28B   KEYS?                   00060900
               AGO    .ZG28C     INVOCATION OKAY                        00061000
.ZG28B         ANOP  ,                                                  00061100
&ZMS           SETC  'THE "L" FORM OF "MF"'                             00061200
&ZMS           SETC  '&ZMS CAN ONLY HAVE'                               00061300
&ZMS           SETC  '&ZMS THE "PLISTVER" KEY'                          00061400
               MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'             00061500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00061600
.ZG28C         ANOP  ,                                                  00061700
.*-------------------------------------------------------------------   00061800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00061900
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          00062000
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          00062100
               AIF   (N'&MF(2) GT 1).ZG30B      MULTI PARMS             00062200
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          00062300
.ZG30B         AIF   (K'&MF(2) GT 0).ZG30C                              00062400
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00062500
&ZMS           SETC  'WHEN "L" IS SPECIFIED'                            00062600
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                00062700
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       00062800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00062900
.ZG30C         ANOP  ,                                                  00063000
.*-------------------------------------------------------------------   00063100
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00063200
               AIF   (K'&ZXMFCTRL LE 0).ZG30P   NOT I/O                 00063300
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG30P                     00063400
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00063500
&ZMS           SETC  '"MF='                                             00063600
&ZMS           SETC  '&ZMS.&MF"'                                        00063700
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          00063800
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                  00063900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00064000
.ZG30P         ANOP  ,                                                  00064100
.*-------------------------------------------------------------------   00064200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00064300
&ZXMFATTR      SETC  'INPUT'     SET IN/OUTPUT                          00064400
&XMFATTR       SETC  '0D'                                               00064500
               AIF   (K'&MF(3) LE 0).ZG33B      PARM                    00064600
&XMFATTR       SETC  '&MF(3,1)'  SET XVARIABLE                          00064700
               AIF   (N'&MF(3) GT 1).ZG33B      MULTI                   00064800
&XMFATTR       SETC  '&MF(3)'    SET XVARIABLE                          00064900
.ZG33B         ANOP  ,                                                  00065000
.*-------------------------------------------------------------------   00065100
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00065200
               AIF   (K'&ZXMFATTR LE 0).ZG33P   NOT I/O                 00065300
               AIF   ('&XMFATTR'(1,1) NE '(').ZG33P                     00065400
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        00065500
&ZMS           SETC  '"MF='                                             00065600
&ZMS           SETC  '&ZMS.&MF"'                                        00065700
&ZMS           SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'          00065800
               MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                  00065900
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00066000
.ZG33P         ANOP  ,                                                  00066100
.*-------------------------------------------------------------------   00066200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00066300
               AIF   (K'&ZXMFATTR LE 0).ZG33S   NOT I/O                 00066400
               AIF   (K'&XMFATTR LE 60).ZG33S   LNG OK                  00066500
&ZXMFATTR      SETC  ''          RESET IN/OUTPUT                        00066600
&ZMS           SETC  '"MF='                                             00066700
&ZMS           SETC  '&ZMS.&MF"'                                        00066800
&ZMS           SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'              00066900
               MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                 00067000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00067100
.ZG33S         ANOP  ,                                                  00067200
.*-------------------------------------------------------------------   00067300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00067400
.ZG35          ANOP  ,                                                  00067500
&ZTLC          SETC 'E'                                                 00067600
               AIF   ('&MF(1)' NE '&ZTLC').ZG43                         00067700
&XMF           SETC  'E'         SET KEYWORD                            00067800
               AIF   (N'&MF LE 3).ZG35A         CK NUM                  00067900
&ZMS           SETC  '"MF='                                             00068000
&ZMS           SETC  '&ZMS.&MF"'                                        00068100
&ZMS           SETC  '&ZMS "MF"'                                        00068200
               MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'               00068300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00068400
.ZG35A         ANOP  ,                                                  00068500
.*-------------------------------------------------------------------   00068600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00068700
&ZXMFCTRL      SETC  'INPUT'     SET IN/OUTPUT                          00068800
&XMFCTRL       SETC  '&MF(2,1)'  SET XVARIABLE                          00068900
               AIF   (N'&MF(2) GT 1).ZG37B      MULTI PARMS             00069000
&XMFCTRL       SETC  '&MF(2)'    SET XVARIABLE                          00069100
.ZG37B         AIF   (K'&MF(2) GT 0).ZG37C                              00069200
&ZXMFCTRL      SETC  ''          RESET IN/OUTPUT                        00069300
&ZMS           SETC  'WHEN "E" IS SPECIFIED'                            00069400
&ZMS           SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                00069500
               MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                       00069600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00069700
.ZG37C         ANOP  ,                                                  00069800
.*-------------------------------------------------------------------   00069900
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00070000
               AIF   (K'&ZXMFCTRL LE 0).ZG37R   NOT I/O                 00070100
               AIF   ('&XMFCTRL'(1,1) NE '(').ZG37R                     00070200
&ZCGPR         SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                         00070300
               AIF   ('&ZCGPR'(1,1) NE '0').ZG37P                       00070400
               AIF   (K'&ZCGPR GT 2).ZG37Q                              00070500
               AIF   ('&ZCGPR' EQ '0').ZG37Q                            00070600
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00070700
               AIF   (T'&ZCGPR NE 'N').ZG37Q    INVALID REG NAME        00070800
.ZG37P         ANOP  ,                                                  00070900
               AIF   (T'&ZCGPR NE 'N').ZG37R    NON NUMERIC             00071000
               AIF   ('&ZCGPR' LT '1').ZG37Q                            00071100
               AIF   ('&ZCGPR' LE '12').ZG37R                           00071200
.ZG37Q         ANOP  ,                                                  00071300
&ZMS           SETC  '"MF='                                             00071400
&ZMS           SETC  '&ZMS.&MF"'                                        00071500
&ZMS           SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'          00071600
               MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                   00071700
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00071800
.ZG37R         ANOP  ,                                                  00071900
.*-------------------------------------------------------------------   00072000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00072100
&XMFSCK        SETC  ''          INITIALIZE XVARIABLE                   00072200
.ZG41A   AIF   ('&MF(3)' NE 'COMPLETE').ZG42A                           00072300
&XMFSCK        SETC  'COMPLETE'  SET KEYWORD                            00072400
.*-------------------------------------------------------------------   00072500
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00072600
.ZG42A         AIF   (K'&XMFSCK GT 0).ZG42C     KEYWORD                 00072700
               AIF   (K'&MF(3) LE 0).ZG42B                              00072800
&ZMS           SETC  '"MF='                                             00072900
&ZMS           SETC  '&ZMS.&MF"'                                        00073000
&ZMS           SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '          00073100
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00073200
&ZMS           SETC  '&ZMS "COMPLETE".'                                 00073300
               MNOTE 8,' &ZMS '                                         00073400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00073500
.ZG42B         ANOP  ,                                                  00073600
&XMFSCK        SETC  'COMPLETE'  SET DEFAULT KEYWORD                    00073700
.ZG42C         ANOP  ,                                                  00073800
&ZXMFSCK       SETC  'INPUT'     SET IN/OUTPUT                          00073900
.*------------------------------------------------------------------    00074000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00074100
.ZG43          ANOP  ,                                                  00074200
&ZXMF          SETC  'INPUT'     SET IN/OUTPUT                          00074300
               AIF   (K'&XMF GT 0).ZG43E        VALID ARG               00074400
               AIF   (T'&MF EQ 'O').ZG43D       OMITTED                 00074500
&ZASYSLNDX     SETA  0                                                  00074600
.ZG43A         ANOP  ,           POSITIONAL MACRO KEY                   00074700
&ZASYSLNDX     SETA  &ZASYSLNDX+1                                       00074800
               AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG43C                   00074900
&ZTLC          SETC 'MF'                                                00075000
               AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG43A          00075100
.ZG43B         ANOP  ,                                                  00075200
&ZXMF          SETC  ''          RESET IN/OUTPUT                        00075300
&ZMS           SETC  'THE "MF" KEY'                                     00075400
&ZMS           SETC  '&ZMS MUST CONTAIN ONE'                            00075500
               MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                   00075600
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00075700
               AGO   .ZG43E                                             00075800
.ZG43C         ANOP  ,                                                  00075900
&ZXMF          SETC  ''          RESET IN/OUTPUT                        00076000
&ZMS           SETC  '"MF='                                             00076100
&ZMS           SETC  '&ZMS.&MF"'                                        00076200
&ZMS           SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '          00076300
&ZMS           SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                00076400
&ZMS           SETC  '&ZMS "S",'                                        00076500
&ZMS           SETC  '&ZMS "L",'                                        00076600
&ZMS           SETC  '&ZMS OR "E".'                                     00076700
               MNOTE 8,' &ZMS '                                         00076800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00076900
               AGO   .ZG43E                                             00077000
.ZG43D         ANOP  ,                                                  00077100
&XMF           SETC  'S'         SET DEFAULT KEYWORD                    00077200
&XMFSCK        SETC  'COMPLETE'  COMPLETE CHECKING                      00077300
.ZG43E         ANOP  ,                                                  00077400
.********************************************************************   00077500
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00077600
.********************************************************************   00077700
               ACTR  10000                                              00077800
.*-------------------------------------------------------------------   00077900
.***AG.MF03 MF=(SLE)                                                    00078000
               AIF   ('&XMF' EQ 'L').ZGMFX                              00078100
.*----------------------------------------------------------------***   00078200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00078300
               AIF   (N'&OPERATION LE 1).ZG2A   CK NUM                  00078400
&ZMS           SETC  '"OPERATION='                                      00078500
&ZMS           SETC  '&ZMS.&OPERATION"'                                 00078600
&ZMS           SETC  '&ZMS "OPERATION"'                                 00078700
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00078800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00078900
.ZG2A          ANOP  ,                                                  00079000
.*-------------------------------------------------------------------   00079100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00079200
&ZXOPERATION   SETC  'INPUT'     SET IN/OUTPUT                          00079300
&XOPERATION    SETC  '&OPERATION(1)'            SET XVARIABLE           00079400
               AIF   (N'&OPERATION GT 1).ZG2B   MULTI PARMS             00079500
&XOPERATION    SETC  '&OPERATION'               SET XVARIABLE           00079600
.ZG2B          AIF   (K'&OPERATION(1) GT 0).ZG2C                        00079700
&ZXOPERATION   SETC  ''          RESET IN/OUTPUT                        00079800
&ZMS           SETC  ' '                                                00079900
&ZMS           SETC  '&ZMS "OPERATION" KEY AND ITS'                     00080000
               MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                   00080100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00080200
.ZG2C          ANOP  ,                                                  00080300
.*-------------------------------------------------------------------   00080400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00080500
               AIF   (K'&ZXOPERATION LE 0).ZG2R  NOT I/O                00080600
               AIF   ('&XOPERATION'(1,1) NE '(').ZG2R                   00080700
&ZCGPR         SETC  '&XOPERATION'(2,K'&XOPERATION-2)                   00080800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                        00080900
               AIF   (K'&ZCGPR GT 2).ZG2Q                               00081000
               AIF   ('&ZCGPR' EQ '0').ZG2Q                             00081100
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00081200
               AIF   (T'&ZCGPR NE 'N').ZG2Q     INVALID REG NAME        00081300
.ZG2P          ANOP  ,                                                  00081400
               AIF   (T'&ZCGPR NE 'N').ZG2R     NON NUMERIC             00081500
               AIF   ('&ZCGPR' LT '2').ZG2Q                             00081600
               AIF   ('&ZCGPR' LE '12').ZG2R                            00081700
.ZG2Q          ANOP  ,                                                  00081800
&ZMS           SETC  '"OPERATION='                                      00081900
&ZMS           SETC  '&ZMS.&OPERATION"'                                 00082000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00082100
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00082200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00082300
.ZG2R          ANOP  ,                                                  00082400
.*----------------------------------------------------------------***   00082500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00082600
               AIF   (N'&DEVICES LE 1).ZG5A     CK NUM                  00082700
&ZMS           SETC  '"DEVICES='                                        00082800
&ZMS           SETC  '&ZMS.&DEVICES"'                                   00082900
&ZMS           SETC  '&ZMS "DEVICES"'                                   00083000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00083100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00083200
.ZG5A          ANOP  ,                                                  00083300
.*-------------------------------------------------------------------   00083400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00083500
&ZXDEVICES     SETC  'INPUT'     SET IN/OUTPUT                          00083600
&XDEVICES      SETC  '&DEVICES(1)'              SET XVARIABLE           00083700
               AIF   (N'&DEVICES GT 1).ZG5B     MULTI PARMS             00083800
&XDEVICES      SETC  '&DEVICES'  SET XVARIABLE                          00083900
.ZG5B          AIF   (K'&DEVICES(1) GT 0).ZG5C                          00084000
&ZXDEVICES     SETC  ''          RESET IN/OUTPUT                        00084100
&ZMS           SETC  ' '                                                00084200
&ZMS           SETC  '&ZMS "DEVICES" KEY AND ITS'                       00084300
               MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                   00084400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00084500
.ZG5C          ANOP  ,                                                  00084600
.*-------------------------------------------------------------------   00084700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00084800
               AIF   (K'&ZXDEVICES LE 0).ZG5R   NOT I/O                 00084900
               AIF   ('&XDEVICES'(1,1) NE '(').ZG5R                     00085000
&ZCGPR         SETC  '&XDEVICES'(2,K'&XDEVICES-2)                       00085100
               AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                        00085200
               AIF   (K'&ZCGPR GT 2).ZG5Q                               00085300
               AIF   ('&ZCGPR' EQ '0').ZG5Q                             00085400
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00085500
               AIF   (T'&ZCGPR NE 'N').ZG5Q     INVALID REG NAME        00085600
.ZG5P          ANOP  ,                                                  00085700
               AIF   (T'&ZCGPR NE 'N').ZG5R     NON NUMERIC             00085800
               AIF   ('&ZCGPR' LT '2').ZG5Q                             00085900
               AIF   ('&ZCGPR' LE '12').ZG5R                            00086000
.ZG5Q          ANOP  ,                                                  00086100
&ZMS           SETC  '"DEVICES='                                        00086200
&ZMS           SETC  '&ZMS.&DEVICES"'                                   00086300
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00086400
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00086500
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00086600
.ZG5R          ANOP  ,                                                  00086700
.*----------------------------------------------------------------***   00086800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00086900
               AIF   (N'&NUMDEVS LE 1).ZG8A     CK NUM                  00087000
&ZMS           SETC  '"NUMDEVS='                                        00087100
&ZMS           SETC  '&ZMS.&NUMDEVS"'                                   00087200
&ZMS           SETC  '&ZMS "NUMDEVS"'                                   00087300
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00087400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00087500
.ZG8A          ANOP  ,                                                  00087600
.*-------------------------------------------------------------------   00087700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00087800
&ZXNUMDEVS     SETC  'INPUT'     SET IN/OUTPUT                          00087900
&XNUMDEVS      SETC  '1'                                                00088000
               AIF   (K'&NUMDEVS(1) LE 0).ZG8B  PARM                    00088100
&XNUMDEVS      SETC  '&NUMDEVS(1)'              SET XVARIABLE           00088200
               AIF   (N'&NUMDEVS GT 1).ZG8B     MULTI                   00088300
&XNUMDEVS      SETC  '&NUMDEVS'  SET XVARIABLE                          00088400
.ZG8B          ANOP  ,                                                  00088500
.*-------------------------------------------------------------------   00088600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00088700
               AIF   (K'&ZXNUMDEVS LE 0).ZG8R   NOT I/O                 00088800
               AIF   ('&XNUMDEVS'(1,1) NE '(').ZG8R                     00088900
&ZCGPR         SETC  '&XNUMDEVS'(2,K'&XNUMDEVS-2)                       00089000
               AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                        00089100
               AIF   (K'&ZCGPR GT 2).ZG8Q                               00089200
               AIF   ('&ZCGPR' EQ '0').ZG8Q                             00089300
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00089400
               AIF   (T'&ZCGPR NE 'N').ZG8Q     INVALID REG NAME        00089500
.ZG8P          ANOP  ,                                                  00089600
               AIF   (T'&ZCGPR NE 'N').ZG8R     NON NUMERIC             00089700
               AIF   ('&ZCGPR' LT '2').ZG8Q                             00089800
               AIF   ('&ZCGPR' LE '12').ZG8R                            00089900
.ZG8Q          ANOP  ,                                                  00090000
&ZMS           SETC  '"NUMDEVS='                                        00090100
&ZMS           SETC  '&ZMS.&NUMDEVS"'                                   00090200
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00090300
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00090400
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00090500
.ZG8R          ANOP  ,                                                  00090600
.*----------------------------------------------------------------***   00090700
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00090800
               AIF   (N'&RESULTS LE 1).ZG11A    CK NUM                  00090900
&ZMS           SETC  '"RESULTS='                                        00091000
&ZMS           SETC  '&ZMS.&RESULTS"'                                   00091100
&ZMS           SETC  '&ZMS "RESULTS"'                                   00091200
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00091300
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00091400
.ZG11A         ANOP  ,                                                  00091500
.*-------------------------------------------------------------------   00091600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00091700
               AIF   (K'&RESULTS(1) LE 0).ZG11C  NO PARM                00091800
&ZXRESULTS     SETC  'OUTPUT'    SET OUTPUT                             00091900
&XRESULTS      SETC  '&RESULTS(1)'              SET XVARIABLE           00092000
               AIF   (N'&RESULTS GT 1).ZG11C                            00092100
&XRESULTS      SETC  '&RESULTS'  SET XVARIABLE                          00092200
.ZG11C         ANOP  ,                                                  00092300
.*-------------------------------------------------------------------   00092400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00092500
               AIF   (K'&ZXRESULTS LE 0).ZG11R  NOT I/O                 00092600
               AIF   ('&XRESULTS'(1,1) NE '(').ZG11R                    00092700
&ZCGPR         SETC  '&XRESULTS'(2,K'&XRESULTS-2)                       00092800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                       00092900
               AIF   (K'&ZCGPR GT 2).ZG11Q                              00093000
               AIF   ('&ZCGPR' EQ '0').ZG11Q                            00093100
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00093200
               AIF   (T'&ZCGPR NE 'N').ZG11Q    INVALID REG NAME        00093300
.ZG11P         ANOP  ,                                                  00093400
               AIF   (T'&ZCGPR NE 'N').ZG11R    NON NUMERIC             00093500
               AIF   ('&ZCGPR' LT '2').ZG11Q                            00093600
               AIF   ('&ZCGPR' LE '12').ZG11R                           00093700
.ZG11Q         ANOP  ,                                                  00093800
&ZMS           SETC  '"RESULTS='                                        00093900
&ZMS           SETC  '&ZMS.&RESULTS"'                                   00094000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00094100
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00094200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00094300
.ZG11R         ANOP  ,                                                  00094400
.*----------------------------------------------------------------***   00094500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00094600
               AIF   (N'&CALLERID LE 1).ZG14A   CK NUM                  00094700
&ZMS           SETC  '"CALLERID='                                       00094800
&ZMS           SETC  '&ZMS.&CALLERID"'                                  00094900
&ZMS           SETC  '&ZMS "CALLERID"'                                  00095000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00095100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00095200
.ZG14A         ANOP  ,                                                  00095300
.*-------------------------------------------------------------------   00095400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00095500
&ZXCALLERID    SETC  'INPUT'     SET IN/OUTPUT                          00095600
&XCALLERID     SETC  'NO_CALLERID'                                      00095700
               AIF   (K'&CALLERID(1) LE 0).ZG14B  PARM                  00095800
&XCALLERID     SETC  '&CALLERID(1)'             SET XVARIABLE           00095900
               AIF   (N'&CALLERID GT 1).ZG14B   MULTI                   00096000
&XCALLERID     SETC  '&CALLERID'                SET XVARIABLE           00096100
.ZG14B         ANOP  ,                                                  00096200
.*-------------------------------------------------------------------   00096300
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00096400
               AIF   (K'&ZXCALLERID LE 0).ZG14R  NOT I/O                00096500
         AIF   ('&XCALLERID' EQ 'NO_CALLERID').ZG14R                    00096600
               AIF   ('&XCALLERID'(1,1) NE '(').ZG14R                   00096700
&ZCGPR         SETC  '&XCALLERID'(2,K'&XCALLERID-2)                     00096800
               AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                       00096900
               AIF   (K'&ZCGPR GT 2).ZG14Q                              00097000
               AIF   ('&ZCGPR' EQ '0').ZG14Q                            00097100
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00097200
               AIF   (T'&ZCGPR NE 'N').ZG14Q    INVALID REG NAME        00097300
.ZG14P         ANOP  ,                                                  00097400
               AIF   (T'&ZCGPR NE 'N').ZG14R    NON NUMERIC             00097500
               AIF   ('&ZCGPR' LT '2').ZG14Q                            00097600
               AIF   ('&ZCGPR' LE '12').ZG14R                           00097700
.ZG14Q         ANOP  ,                                                  00097800
&ZMS           SETC  '"CALLERID='                                       00097900
&ZMS           SETC  '&ZMS.&CALLERID"'                                  00098000
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00098100
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                   00098200
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00098300
.ZG14R         ANOP  ,                                                  00098400
.*----------------------------------------------------------------***   00098500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00098600
               AIF   (N'&RETCODE LE 1).ZG17A    CK NUM                  00098700
&ZMS           SETC  '"RETCODE='                                        00098800
&ZMS           SETC  '&ZMS.&RETCODE"'                                   00098900
&ZMS           SETC  '&ZMS "RETCODE"'                                   00099000
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00099100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00099200
.ZG17A         ANOP  ,                                                  00099300
.*-------------------------------------------------------------------   00099400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00099500
               AIF   (K'&RETCODE(1) LE 0).ZG17C  NO PARM                00099600
&ZXRETCODE     SETC  'OUTPUT'    SET OUTPUT                             00099700
&XRETCODE      SETC  '&RETCODE(1)'              SET XVARIABLE           00099800
               AIF   (N'&RETCODE GT 1).ZG17C                            00099900
&XRETCODE      SETC  '&RETCODE'  SET XVARIABLE                          00100000
.ZG17C         ANOP  ,                                                  00100100
.*-------------------------------------------------------------------   00100200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00100300
               AIF   (K'&ZXRETCODE LE 0).ZG17R  NOT I/O                 00100400
               AIF   ('&XRETCODE'(1,1) NE '(').ZG17R                    00100500
&ZCGPR         SETC  '&XRETCODE'(2,K'&XRETCODE-2)                       00100600
               AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                       00100700
               AIF   (K'&ZCGPR GT 2).ZG17Q                              00100800
               AIF   ('&ZCGPR' EQ '0').ZG17Q                            00100900
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00101000
               AIF   (T'&ZCGPR NE 'N').ZG17Q    INVALID REG NAME        00101100
.ZG17P         ANOP  ,                                                  00101200
               AIF   (T'&ZCGPR NE 'N').ZG17R    NON NUMERIC             00101300
               AIF   ('&ZCGPR' EQ '15').ZG17R                           00101400
               AIF   ('&ZCGPR' LT '2').ZG17Q                            00101500
               AIF   ('&ZCGPR' LE '12').ZG17R                           00101600
.ZG17Q         ANOP  ,                                                  00101700
&ZMS           SETC  '"RETCODE='                                        00101800
&ZMS           SETC  '&ZMS.&RETCODE"'                                   00101900
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00102000
               MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'           00102100
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00102200
.ZG17R         ANOP  ,                                                  00102300
.*----------------------------------------------------------------***   00102400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00102500
               AIF   (N'&RSNCODE LE 1).ZG20A    CK NUM                  00102600
&ZMS           SETC  '"RSNCODE='                                        00102700
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   00102800
&ZMS           SETC  '&ZMS "RSNCODE"'                                   00102900
               MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                00103000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00103100
.ZG20A         ANOP  ,                                                  00103200
.*-------------------------------------------------------------------   00103300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00103400
               AIF   (K'&RSNCODE(1) LE 0).ZG20C  NO PARM                00103500
&ZXRSNCODE     SETC  'OUTPUT'    SET OUTPUT                             00103600
&XRSNCODE      SETC  '&RSNCODE(1)'              SET XVARIABLE           00103700
               AIF   (N'&RSNCODE GT 1).ZG20C                            00103800
&XRSNCODE      SETC  '&RSNCODE'  SET XVARIABLE                          00103900
.ZG20C         ANOP  ,                                                  00104000
.*-------------------------------------------------------------------   00104100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00104200
               AIF   (K'&ZXRSNCODE LE 0).ZG20R  NOT I/O                 00104300
               AIF   ('&XRSNCODE'(1,1) NE '(').ZG20R                    00104400
&ZCGPR         SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                       00104500
               AIF   ('&ZCGPR'(1,1) NE '0').ZG20P                       00104600
               AIF   (K'&ZCGPR GT 2).ZG20Q                              00104700
               AIF   ('&ZCGPR' EQ '0').ZG20R                            00104800
&ZCGPR         SETC  '&ZCGPR'(2,1)                                      00104900
               AIF   (T'&ZCGPR NE 'N').ZG20Q    INVALID REG NAME        00105000
.ZG20P         ANOP  ,                                                  00105100
               AIF   (T'&ZCGPR NE 'N').ZG20R    NON NUMERIC             00105200
               AIF   ('&ZCGPR' EQ '0').ZG20R                            00105300
               AIF   ('&ZCGPR' LT '2').ZG20Q                            00105400
               AIF   ('&ZCGPR' LE '12').ZG20R                           00105500
.ZG20Q         ANOP  ,                                                  00105600
&ZMS           SETC  '"RSNCODE='                                        00105700
&ZMS           SETC  '&ZMS.&RSNCODE"'                                   00105800
&ZMS           SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'          00105900
               MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'            00106000
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00106100
.ZG20R         ANOP  ,                                                  00106200
.******************************************************************     00106300
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00106400
.******************************************************************     00106500
               ACTR  10000                                              00106600
.*----------------------------------------------------------------***   00106700
.***AH.P02 EXTRA POSITIONALS                                            00106800
               AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS               00106900
               AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL               00107000
               AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL           00107100
               AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL            00107200
.ZGLISTX1      ANOP  ,                                                  00107300
&ZCVAL         SETC  ''          ERROR FIELD                            00107400
&ZAWRK         SETA  0           POSITIONAL NUMBER                      00107500
.ZGLIST2       ANOP  ,                                                  00107600
&ZAWRK         SETA  &ZAWRK+1    NEXT POSITIONAL                        00107700
               AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE               00107800
&ZCVAL         SETC '&ZCVAL,&SYSLIST(&ZAWRK)'   EXTRA                   00107900
               AGO   .ZGLIST2                                           00108000
.*                                                                      00108100
.ZGLIST3       ANOP  ,                                                  00108200
&ZCVAL         SETC '&ZCVAL'(2,K'&ZCVAL-1)      STRIP COMMA             00108300
&ZMS           SETC  'POSITIONAL ARGUMENT(S),'                          00108400
&ZMS           SETC  '&ZMS "&ZCVAL"'                                    00108500
&ZMS           SETC  '&ZMS CANNOT BE USED.'                             00108600
&ZMS           SETC  '&ZMS NO POSITIONAL ARGUMENTS'                     00108700
               MNOTE 8,' &ZMS ARE ALLOWED.'                             00108800
&ZMACRET       SETA  8           SET MACRO ERROR RETURN CODE            00108900
.ZGLISTX       ANOP  ,                                                  00109000
&ZASYSLNDX     SETA  0                                                  00109100
.*-------------------------------------------------------------------   00109200
.***AG.MF04 MF=(SLE)                                                    00109300
.ZGMFX         ANOP  ,           END OF FULL SYNTAX CHECK               00109400
.*******************************************************************    00109500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00109600
.*******************************************************************    00109700
               AIF   (&ZMACRET NE 0).ZLX2       ERROR DETECTED          00109800
.*******************************************************************    00109900
.***AE.01  START OF IEEVARYD MACRO CODE                                 00110000
.*******************************************************************    00110100
               LCLC  &M0M0001                 NAME                      00110200
&M0M0001       SETC  '&XLABEL'                SET NAME                  00110300
               AIF   (K'&XLABEL NE 0).XLAB2                             00110400
&M0M0001       SETC  'M00M&SYSNDX'            DEFAULT NAME              00110500
.*                                                                      00110600
.XLAB2         ANOP  ,                                                  00110700
               AIF   ('&XMF' EQ 'L').XLAB3                              00110800
&M0M0001 DS    0H                             IEEVARYD-1                00110900
.XLAB3         ANOP  ,                                                  00111000
.*******************************************************************    00111100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00111200
.*******************************************************************    00111300
              PUSH  PRINT                                               00111400
               AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON         00111500
               PRINT OFF         ++ PR01                                00111600
               AGO   .ZPRNTXX                                           00111700
.ZPRINTX       PRINT ON                                                 00111800
.ZPRNTXX       ANOP  ,                                                  00111900
.********************************************************************   00112000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00112100
.********************************************************************   00112200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00112300
                      LCLA  &ZOPN1         INVOCATION INDEX             00112400
                      LCLC  &ZOPL(4095)    LABEL                        00112500
                      LCLC  &ZOPO(4095)    OPERATION                    00112600
                      LCLC  &ZOPV(4095)    VALUE                        00112700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00112800
.*                                                                      00112900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00113000
.******************************************************************     00113100
.***AL.L10 IEEVARYD FMT=LIST MF=S!L PARAMETERS                          00113200
.******************************************************************     00113300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00113400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00113500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00113600
&XMFATTR              SETC  '0D'                                        00113700
.*                                                                      00113800
&ZOPN                 SETA  &ZOPN+1                                     00113900
&ZOPL(&ZOPN)          SETC  ' '                                         00114000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00114100
&ZOPO(&ZOPN)          SETC  'B'                                         00114200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00114300
                      AGO   .ZALVL6B                                    00114400
.ZALVL6A              ANOP                                              00114500
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00114600
&ZOPV(&ZOPN)          SETC  '4,8'                                       00114700
&ZOPN                 SETA  &ZOPN+1                                     00114800
&ZOPL(&ZOPN)          SETC  ' '                                         00114900
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00115000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00115100
.ZALVL6B              ANOP                                              00115200
&ZOPD(&ZOPN)          SETC  '++ IEEVARYD ARG PARMS'                     00115300
.*                                                                      00115400
&ZOPN                 SETA  &ZOPN+1                                     00115500
&ZOPL(&ZOPN)          SETC  ' '                                         00115600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00115700
&ZOPV(&ZOPN)          SETC  '1'                                         00115800
&ZOPD(&ZOPN)          SETC  ' '                                         00115900
.*                                                                      00116000
.ZLMFSL2              ANOP  ,                                           00116100
.*-------------------------------------------------------------------   00116200
.***AM.L00  IEEVARYD FMT=LIST name                                      00116300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00116400
&ZOPN                 SETA &ZOPN+1                                      00116500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00116600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00116700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00116800
&ZOPD(&ZOPN)          SETC '++ IEEVARYD NAME'                           00116900
.ZLMFSL2M             ANOP  ,                                           00117000
.*-------------------------------------------------------------------   00117100
.***AM.L01  IEEVARYD FMT=LIST PARAMETERS                                00117200
&ZOPN                 SETA &ZOPN+1                                      00117300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00117400
&ZOPO(&ZOPN)          SETC 'DS'                                         00117500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00117600
&ZOPD(&ZOPN)          SETC '++ IEEVARYD PARM LIST'                      00117700
.*-------------------------------------------------------------------   00117800
.***AM.L02 XVERSION XL1                                                 00117900
&ZOPN                 SETA &ZOPN+1                                      00118000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00118100
&ZOPO(&ZOPN)          SETC 'DS'                                         00118200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00118300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00118400
.*-------------------------------------------------------------------   00118500
.***AM.L03 XFLAGS BL.8                                                  00118600
&ZOPN                 SETA &ZOPN+1                                      00118700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00118800
&ZOPO(&ZOPN)          SETC 'DS'                                         00118900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00119000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00119100
.*                                                                      00119200
&ZOPN                 SETA  &ZOPN+1                                     00119300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_RESULTS'                 00119400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00119500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00119600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00119700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RESULTS'                      00119800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00119900
.*                                                                      00120000
&ZOPN                 SETA  &ZOPN+1                                     00120100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CALLERID'                00120200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00120300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00120400
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00120500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CALLERID'                     00120600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00120700
.*-------------------------------------------------------------------   00120800
.***AM.L09  XRESERVED1 CL2                                              00120900
&ZOPN                 SETA &ZOPN+1                                      00121000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED1'                       00121100
&ZOPO(&ZOPN)          SETC 'DS'                                         00121200
&ZOPV(&ZOPN)          SETC 'CL2'                                        00121300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00121400
.*-------------------------------------------------------------------   00121500
.***AM.L09 ADDR XOPERATION A                                            00121600
&ZOPN                 SETA &ZOPN+1                                      00121700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XOPERATION_ADDR'                  00121800
&ZOPO(&ZOPN)          SETC 'DS'                                         00121900
&ZOPV(&ZOPN)          SETC 'A'                                          00122000
&ZOPD(&ZOPN)          SETC '++ &ZXOPERATION ADDR'                       00122100
.*-------------------------------------------------------------------   00122200
.***AM.L09 ADDR XDEVICES A                                              00122300
&ZOPN                 SETA &ZOPN+1                                      00122400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVICES_ADDR'                    00122500
&ZOPO(&ZOPN)          SETC 'DS'                                         00122600
&ZOPV(&ZOPN)          SETC 'A'                                          00122700
&ZOPD(&ZOPN)          SETC '++ &ZXDEVICES ADDR'                         00122800
.*-------------------------------------------------------------------   00122900
.***AM.L09  XNUMDEVS F                                                  00123000
&ZOPN                 SETA &ZOPN+1                                      00123100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XNUMDEVS'                         00123200
&ZOPO(&ZOPN)          SETC 'DS'                                         00123300
&ZOPV(&ZOPN)          SETC 'F'                                          00123400
&ZOPD(&ZOPN)          SETC '++ &ZXNUMDEVS '                             00123500
.*-------------------------------------------------------------------   00123600
.***AM.L09 ADDR XRESULTS A                                              00123700
&ZOPN                 SETA &ZOPN+1                                      00123800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESULTS_ADDR'                    00123900
&ZOPO(&ZOPN)          SETC 'DS'                                         00124000
&ZOPV(&ZOPN)          SETC 'A'                                          00124100
&ZOPD(&ZOPN)          SETC '++ &ZXRESULTS ADDR'                         00124200
.*-------------------------------------------------------------------   00124300
.***AM.L09  XCALLERID CL8                                               00124400
&ZOPN                 SETA &ZOPN+1                                      00124500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCALLERID'                        00124600
&ZOPO(&ZOPN)          SETC 'DS'                                         00124700
&ZOPV(&ZOPN)          SETC 'CL8'                                        00124800
&ZOPD(&ZOPN)          SETC '++ &ZXCALLERID '                            00124900
.*-------------------------------------------------------------------   00125000
.***AM.L09  XRESERVED2 CL16                                             00125100
&ZOPN                 SETA &ZOPN+1                                      00125200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRESERVED2'                       00125300
&ZOPO(&ZOPN)          SETC 'DS'                                         00125400
&ZOPV(&ZOPN)          SETC 'CL16'                                       00125500
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL '                            00125600
.*-------------------------------------------------------------------   00125700
.***AM.L10 END OF IEEVARYD LIST PARAMETERS                              00125800
&ZOPN                 SETA &ZOPN+1                                      00125900
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00126000
&ZOPO(&ZOPN)          SETC 'EQU'                                        00126100
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00126200
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00126300
.*                                                                      00126400
&ZOPN                 SETA &ZOPN+1                                      00126500
&ZOPL(&ZOPN)          SETC ' '                                          00126600
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00126700
&ZOPV(&ZOPN)          SETC '1'                                          00126800
&ZOPD(&ZOPN)          SETC ' '                                          00126900
.*-------------------------------------------------------------------   00127000
.***AL.L12 IEEVARYD FMT=LIST MF=S!L PARAMETERS                          00127100
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00127200
.*                                                                      00127300
&ZOPN                 SETA  &ZOPN+1                                     00127400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00127500
&ZOPO(&ZOPN)          SETC  'DC'                                        00127600
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00127700
&ZOPD(&ZOPN)          SETC  '++ IEEVARYD ARG PARMS'                     00127800
.*                                                                      00127900
.ZLMFSLX              ANOP  ,                                           00128000
.*-------------------------------------------------------------------   00128100
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00128200
&ZPLLEN               SETA 44                                           00128300
.*                                                                      00128400
.******************************************************************     00128500
.***AI.L01 IEEVARYD FMT=LIST FILL IN PARAMETER AREA                     00128600
.******************************************************************     00128700
                      ACTR  10000                                       00128800
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00128900
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00129000
&ZCVAL                SETC  'LAE'          XAX MODE                     00129100
.ZIMFXA               ANOP ,                                            00129200
.*                                                                      00129300
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00129400
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00129500
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00129600
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00129700
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00129800
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00129900
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00130000
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00130100
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00130200
&ZOPN                 SETA  &ZOPN+1                                     00130300
&ZOPL(&ZOPN)          SETC  ' '                                         00130400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00130500
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00130600
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00130700
                      AGO   .ZIMFNX                                     00130800
.*                                                                      00130900
.ZIMFN2               ANOP ,                                            00131000
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00131100
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00131200
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00131300
&ZOPN                 SETA  &ZOPN+1                                     00131400
&ZOPL(&ZOPN)          SETC  ' '                                         00131500
&ZOPO(&ZOPN)          SETC  'LAE'                                       00131600
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00131700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00131800
                      AGO   .ZIMFNX                                     00131900
.ZIMFNX1              ANOP ,                                            00132000
&ZOPN                 SETA  &ZOPN+1                                     00132100
&ZOPL(&ZOPN)          SETC  ' '                                         00132200
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00132300
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00132400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00132500
.ZIMFNX               ANOP ,                                            00132600
.********************************************************************   00132700
.***AI.L02 IEEVARYD FMT=LIST INITIALIZE PARAMETER AREA                  00132800
.********************************************************************   00132900
.***AI.L03 MF=(SLE)                                                     00133000
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00133100
.*                                                                      00133200
&ZOPN                 SETA  &ZOPN+1                                     00133300
&ZOPL(&ZOPN)          SETC  ' '                                         00133400
&ZOPO(&ZOPN)          SETC  'XC'                                        00133500
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00133600
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00133700
.ZIMFLX               ANOP  ,                                           00133800
.*-------------------------------------------------------------------   00133900
.***AI.L04A XVERSION XL1                                                00134000
                      AIF   (&XPLISTVER EQ 0).ZIMFVW                    00134100
&ZOPN                 SETA  &ZOPN+1                                     00134200
&ZOPL(&ZOPN)          SETC  ' '                                         00134300
&ZOPO(&ZOPN)          SETC  'MVI'                                       00134400
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00134500
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00134600
.ZIMFVW               ANOP  ,                                           00134700
.*-------------------------------------------------------------------   00134800
.***AI.L05 XFLAGS BL1                                                   00134900
&ZW                   SETC  ''                                          00135000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00135100
.*-------------------------------------------------------------------   00135200
.***AI.L08 XFLAGS "RESULTS"                                             00135300
.***      BL1'1XXXXXXX'                                                 00135400
         AIF   ('&RESULTS' EQ '').ZI3A                                  00135500
&ZW                   SETC  '&ZW.1'                                     00135600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00135700
                      AGO   .ZI3C                                       00135800
.*                                                                      00135900
.ZI3A                 ANOP  ,                                           00136000
&ZW                   SETC  '&ZW.0'                                     00136100
.ZI3C                 ANOP  ,                                           00136200
.*-------------------------------------------------------------------   00136300
.***AI.L08 XFLAGS "CALLERID"                                            00136400
.***      BL1'X1XXXXXX'                                                 00136500
         AIF   ('&CALLERID' EQ '').ZI4A                                 00136600
&ZW                   SETC  '&ZW.1000000'                               00136700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00136800
                      AGO   .ZI4C                                       00136900
.*                                                                      00137000
.ZI4A                 ANOP  ,                                           00137100
&ZW                   SETC  '&ZW.0000000'                               00137200
.ZI4C                 ANOP  ,                                           00137300
.*-------------------------------------------------------------------   00137400
.***AI.L11 XFLAGS BL1                                                   00137500
                      AIF   ('&ZCLNG' NE 'YES').ZI4E  ALL ZERO BITS     00137600
&ZOPN                 SETA  &ZOPN+1                                     00137700
&ZOPL(&ZOPN)          SETC  ' '                                         00137800
&ZOPO(&ZOPN)          SETC  'OI'                                        00137900
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00138000
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00138100
.ZI4E                 ANOP  ,                                           00138200
.*-------------------------------------------------------------------   00138300
.***AI.L19 ADDR XOPERATION A                                            00138400
                      AIF   ('&ZXOPERATION' EQ '').ZI6H                 00138500
&ZCLNG                SETC  '&XOPERATION'                               00138600
&ZCGPR                SETC  '14'                                        00138700
         AIF   ('&XOPERATION'(1,1) EQ '(').ZI6F  IN GPR                 00138800
.*                                                                      00138900
&ZOPN                 SETA  &ZOPN+1                                     00139000
&ZOPL(&ZOPN)          SETC  ' '                                         00139100
&ZOPO(&ZOPN)          SETC  'LA'                                        00139200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00139300
&ZOPD(&ZOPN)          SETC  '++ &ZXOPERATION XOPERATION'                00139400
.*                                                                      00139500
                      AGO   .ZI6G                                       00139600
.*                                                                      00139700
.ZI6F                 ANOP  ,                                           00139800
&ZCGPR   SETC  '&XOPERATION'(2,K'&XOPERATION-2)                         00139900
.*                                                                      00140000
.ZI6G                 ANOP  ,                                           00140100
.*                                                                      00140200
&ZOPN                 SETA  &ZOPN+1                                     00140300
&ZOPL(&ZOPN)          SETC  ' '                                         00140400
&ZOPO(&ZOPN)          SETC  'ST'                                        00140500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,4(,1)'                              00140600
&ZOPD(&ZOPN)          SETC  '++ &ZXOPERATION XOPERATION'                00140700
.*                                                                      00140800
.ZI6H                 ANOP  ,                                           00140900
.*-------------------------------------------------------------------   00141000
.***AI.L19 ADDR XDEVICES A                                              00141100
                      AIF   ('&ZXDEVICES' EQ '').ZI7H                   00141200
&ZCLNG                SETC  '&XDEVICES'                                 00141300
&ZCGPR                SETC  '14'                                        00141400
         AIF   ('&XDEVICES'(1,1) EQ '(').ZI7F  IN GPR                   00141500
.*                                                                      00141600
&ZOPN                 SETA  &ZOPN+1                                     00141700
&ZOPL(&ZOPN)          SETC  ' '                                         00141800
&ZOPO(&ZOPN)          SETC  'LA'                                        00141900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00142000
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVICES XDEVICES'                    00142100
.*                                                                      00142200
                      AGO   .ZI7G                                       00142300
.*                                                                      00142400
.ZI7F                 ANOP  ,                                           00142500
&ZCGPR   SETC  '&XDEVICES'(2,K'&XDEVICES-2)                             00142600
.*                                                                      00142700
.ZI7G                 ANOP  ,                                           00142800
.*                                                                      00142900
&ZOPN                 SETA  &ZOPN+1                                     00143000
&ZOPL(&ZOPN)          SETC  ' '                                         00143100
&ZOPO(&ZOPN)          SETC  'ST'                                        00143200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00143300
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVICES XDEVICES'                    00143400
.*                                                                      00143500
.ZI7H                 ANOP  ,                                           00143600
.*-------------------------------------------------------------------   00143700
.***AI.L25  XNUMDEVS F                                                  00143800
                      AIF   ('&ZXNUMDEVS' EQ '').ZI8E                   00143900
                      AIF   ('&ZXNUMDEVS' EQ 'OUTPUT').ZI8E             00144000
&ZCGPR                SETC  '&XNUMDEVS'                                 00144100
.*                                                                      00144200
                      AIF   ('&XNUMDEVS'(1,1) NE '(').ZI8B              00144300
&ZCGPR   SETC  '0('.'&XNUMDEVS'(2,K'&XNUMDEVS-2).')'                    00144400
                      AGO   .ZI8D                                       00144500
.ZI8B                 ANOP  ,                                           00144600
.*                                                                      00144700
&ZC                   SETC  '&XNUMDEVS'(1,1)                            00144800
                      AIF   (T'&ZC NE 'N').ZI8D                         00144900
&ZC                   SETC  '&XNUMDEVS'                                 00145000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00145100
&ZCGPR                SETC  '=AL4(&XNUMDEVS)'                           00145200
.*                                                                      00145300
.ZI8D                 ANOP  ,                                           00145400
.*                                                                      00145500
&ZOPN                 SETA  &ZOPN+1                                     00145600
&ZOPL(&ZOPN)          SETC  ' '                                         00145700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00145800
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00145900
&ZOPD(&ZOPN)          SETC  '++ &ZXNUMDEVS XNUMDEVS'                    00146000
.*                                                                      00146100
.ZI8E                 ANOP  ,                                           00146200
.*-------------------------------------------------------------------   00146300
.***AI.L19 ADDR XRESULTS A                                              00146400
                      AIF   ('&ZXRESULTS' EQ '').ZI9H                   00146500
&ZCLNG                SETC  '&XRESULTS'                                 00146600
&ZCGPR                SETC  '14'                                        00146700
         AIF   ('&XRESULTS'(1,1) EQ '(').ZI9F  IN GPR                   00146800
.*                                                                      00146900
&ZOPN                 SETA  &ZOPN+1                                     00147000
&ZOPL(&ZOPN)          SETC  ' '                                         00147100
&ZOPO(&ZOPN)          SETC  'LA'                                        00147200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00147300
&ZOPD(&ZOPN)          SETC  '++ &ZXRESULTS XRESULTS'                    00147400
.*                                                                      00147500
                      AGO   .ZI9G                                       00147600
.*                                                                      00147700
.ZI9F                 ANOP  ,                                           00147800
&ZCGPR   SETC  '&XRESULTS'(2,K'&XRESULTS-2)                             00147900
.*                                                                      00148000
.ZI9G                 ANOP  ,                                           00148100
.*                                                                      00148200
&ZOPN                 SETA  &ZOPN+1                                     00148300
&ZOPL(&ZOPN)          SETC  ' '                                         00148400
&ZOPO(&ZOPN)          SETC  'ST'                                        00148500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00148600
&ZOPD(&ZOPN)          SETC  '++ &ZXRESULTS XRESULTS'                    00148700
.*                                                                      00148800
.ZI9H                 ANOP  ,                                           00148900
.*-------------------------------------------------------------------   00149000
.***AI.L18  XCALLERID CL8                                               00149100
         AIF   ('&XCALLERID' NE 'NO_CALLERID').ZI10                     00149200
&ZXCALLERID           SETC  ''             RESET INPUT/OUTPUT           00149300
.ZI10                 ANOP  ,                                           00149400
.*-------------------------------------------------------------------   00149500
.***AI.L25  XCALLERID CL8                                               00149600
                      AIF   ('&ZXCALLERID' EQ '').ZI10E                 00149700
                      AIF   ('&ZXCALLERID' EQ 'OUTPUT').ZI10E           00149800
&ZCGPR                SETC  '&XCALLERID'                                00149900
.*                                                                      00150000
                      AIF   ('&XCALLERID'(1,1) NE '(').ZI10B            00150100
&ZCGPR   SETC  '0('.'&XCALLERID'(2,K'&XCALLERID-2).')'                  00150200
.ZI10B                ANOP  ,                                           00150300
.*                                                                      00150400
&ZOPN                 SETA  &ZOPN+1                                     00150500
&ZOPL(&ZOPN)          SETC  ' '                                         00150600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00150700
&ZOPV(&ZOPN)          SETC  '20(8,1),&ZCGPR'                            00150800
&ZOPD(&ZOPN)          SETC  '++ &ZXCALLERID XCALLERID'                  00150900
.*                                                                      00151000
.ZI10E                ANOP  ,                                           00151100
.*-------------------------------------------------------------------   00151200
&ZOPN1                SETA &ZOPN                                        00151300
.*******************************************************************    00151400
.***  PROCESS IEEVARYD OUTPUT PARAMETERS                                00151500
.*******************************************************************    00151600
                      ACTR  10000                                       00151700
.*******************************************************************    00151800
.***AO.X02  RETURN CODE PROCESSING                                      00151900
.*******************************************************************    00152000
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00152100
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00152200
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00152300
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00152400
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00152500
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00152600
&ZOPN                 SETA  &ZOPN+1                                     00152700
&ZOPL(&ZOPN)          SETC  ' '                                         00152800
&ZOPO(&ZOPN)          SETC  'ST'                                        00152900
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00153000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00153100
                      AGO   .ZMRETX                                     00153200
.*                                                                      00153300
.ZMRET2               ANOP  ,                                           00153400
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00153500
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00153600
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00153700
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00153800
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00153900
&ZOPN                 SETA  &ZOPN+1                                     00154000
&ZOPL(&ZOPN)          SETC  ' '                                         00154100
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00154200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00154300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00154400
.ZMRETX               ANOP  ,                                           00154500
.*******************************************************************    00154600
.***AO.X03  REASON CODE PROCESSING                                      00154700
.*******************************************************************    00154800
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00154900
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00155000
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00155100
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00155200
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00155300
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00155400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00155500
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00155600
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00155700
&ZOPN                 SETA  &ZOPN+1                                     00155800
&ZOPL(&ZOPN)          SETC  ' '                                         00155900
&ZOPO(&ZOPN)          SETC  'ST'                                        00156000
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00156100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00156200
                      AGO   .ZMRSNX                                     00156300
.*                                                                      00156400
.ZMRSN2               ANOP  ,                                           00156500
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00156600
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00156700
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00156800
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00156900
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00157000
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00157100
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00157200
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00157300
&ZOPN                 SETA  &ZOPN+1                                     00157400
&ZOPL(&ZOPN)          SETC  ' '                                         00157500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00157600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00157700
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00157800
.ZMRSNX               ANOP  ,                                           00157900
.*******************************************************************    00158000
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00158100
.*******************************************************************    00158200
.ZMFLX                ANOP  ,              MF=L PROCESSING              00158300
.*******************************************************************    00158400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00158500
.*******************************************************************    00158600
                      ACTR  10000                                       00158700
.*                                                                      00158800
                      LCLA  &ZLC           COLUMN POSITION              00158900
                      LCLA  &ZOPX          LIST TABLE INDEX             00159000
                      LCLC  &ZLL           LABEL                        00159100
                      LCLC  &ZLOP          OPERATION                    00159200
                      LCLC  &ZLV           VALUE                        00159300
                      LCLC  &ZLD           DESCRIPTION                  00159400
.*                                                                      00159500
&ZOPX                 SETA  1                                           00159600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00159700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00159800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00159900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00160000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00160100
                      AIF   (K'&ZLD LE 0).ZL5                           00160200
&ZLC                  SETA  35             COMMENT COLUMN               00160300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00160400
&ZLC                  SETA  33             COMMMENT COLUMN              00160500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00160600
&ZLV                  SETC  '&ZLV'.' '                                  00160700
                      AGO   .ZL3                                        00160800
.*                                                                      00160900
.ZL4                  ANOP  ,                                           00161000
&ZLV                  SETC  '&ZLV'.' '                                  00161100
.ZL5                  ANOP  ,                                           00161200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00161300
.*                                                                      00161400
&ZLL     &ZLOP &ZLV                                                     00161500
.*                                                                      00161600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00161700
                      AGO   .ZL2           CONTINUE LOOPING             00161800
.*                                                                      00161900
.ZLX                  ANOP  ,                                           00162000
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00162100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00162200
.*-----------BAL invocation code-------------                           00162300
.********************************************************************** 00162400
.*                                                                      00162500
.*  Invoke PC for VARY Device Interface Routine                         00162600
.*                                                                      00162700
.********************************************************************** 00162800
         L     15,16(0,0)         GET ADDRESS OF CVT FROM PSA           00162900
         L     15,772(,15)        GET ADDRESS OF SFT FROM CVT           00163000
         LA    14,16(0,0)         GET IEEVARYD INDEX IN LINKAGE TABLE   00163100
         AL    14,100(,15)        POINT REG14 TO IEEVARYD ETD ENTRY     00163200
         PC    0(14)              PC TO IEEVARYD SERVICE                00163300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00163400
.ZLINKX               ANOP  ,                                           00163500
.*******************************************************************    00163600
.***AP.X01  FORMAT GENERATED CODE                                       00163700
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00163800
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00163900
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00164000
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00164100
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00164200
                      AIF   (K'&ZLD LE 0).ZL51                          00164300
&ZLC                  SETA  35             COMMENT COLUMN               00164400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00164500
&ZLC                  SETA  33             COMMENT COLUMN               00164600
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00164700
&ZLV                  SETC  '&ZLV'.' '                                  00164800
                      AGO   .ZL31                                       00164900
.*                                                                      00165000
.ZL41                 ANOP  ,                                           00165100
&ZLV                  SETC  '&ZLV'.' '                                  00165200
.ZL51                 ANOP  ,                                           00165300
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00165400
.*                                                                      00165500
&ZLL     &ZLOP &ZLV                                                     00165600
.*                                                                      00165700
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00165800
                      AGO   .ZL21          CONTINUE LOOPING             00165900
.*                                                                      00166000
.ZLX1                 ANOP  ,                                           00166100
.*******************************************************************    00166200
.***AP.X02  END OF IEEVARYD MACRO                                       00166300
&ZIEEVARYD            SETC  'YES'          SET IEEVARYD USED            00166400
         POP   PRINT                                                    00166500
*                                            IEEVARYD-1                 00166600
         SPACE 1                                                        00166700
.ZLX2                 ANOP  ,                                           00166800
         MEND                                                           00166900
**********************************************************************/ 00167000
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00167100
*%IEEVARYD: MACRO KEYS(OPERATION,DEVICES,NUMDEVS,RESULTS,CALLERID,      00167200
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00167300
*  ANS('?'!!MACLABEL!!' '!!'IEEVARYP '!!MACLIST!!                       00167400
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00167500
*%END IEEVARYD;                                                         00167600

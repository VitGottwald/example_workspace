*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  CONVCON                               -11/30/06-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  CONSOLE NAME AND ID CONVERTER MACRO           * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 1990, 2008                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7750                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      The ConVCon macro is used to invoke the ConVCon service        * 00002000
*      processor.  This service is used to obtain console information * 00002100
*      about a particular console name or console id.                 * 00002200
*                                                                     * 00002300
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00002400
*                                                                     * 00002500
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002600
*                                                                     * 00002700
*01* ENVIRONMENT:                                                     * 00002800
*                                                                     * 00002900
*                                                                     * 00003000
*      Dispatchable unit mode: Task mode.                             * 00003100
*                                                                     * 00003200
*      Minimum authorization: Problem or Supervisor state.            * 00003300
*                                                                     * 00003400
*      Cross Memory Mode: Any primary, any home, and any secondary    * 00003500
*                        address space.                               * 00003600
*                                                                     * 00003700
*      AMODE:            24- or 31-bit.                               * 00003800
*                                                                     * 00003900
*      ASC mode:         Primary.                                     * 00004000
*                                                                     * 00004100
*      Serialization:    Enabled.                                     * 00004200
*                                                                     * 00004300
*      Locks:            The caller may not hold locks.               * 00004400
*                                                                     * 00004500
*      Restrictions:     None.                                        * 00004600
*                                                                     * 00004700
*01* INPUT REGISTERS:  GR0         Undefined                          * 00004800
*                      GR1         Address of CONV parameter list     * 00004900
*                      GR2-GR15    Undefined                          * 00005000
*                                                                     * 00005100
*01* OUTPUT REGISTERS: GR0         Reason code                        * 00005200
*                      GR1         Address of CONV parameter list     * 00005300
*                      GR2-GR14    Unchanged                          * 00005400
*                      GR15        Return code                        * 00005500
*                                                                     * 00005600
*                                                                     * 00005700
*                                                                     * 00005800
*01* SYNTAX:                                                          * 00005900
*                                                                     * 00006000
*Ýxlabel¨  CONVCON   xinconv                                          * 00006100
*                    Ý RTNCODE=xrtncode¨                              * 00006200
*                    Ý,RSNCODE=xrsncode¨                              * 00006300
*                                                                     * 00006400
*                                                                     * 00006500
*      Where:                                                         * 00006600
*                                                                     * 00006700
*                                                                     * 00006800
*      Ýxlabel¨                                                       * 00006900
*          is an optional symbol, starting in column 1, that is the   * 00007000
*          name on the CONVCON macro invocation.  The name must       * 00007100
*          conform to the rules for an ordinary assembler language    * 00007200
*          symbol.                                                    * 00007300
*          DEFAULT: No name.                                          * 00007400
*                                                                     * 00007500
*                                                                     * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*      xinconv                                                        * 00007900
*          is a required input/output.  It is the name (RS-type), or  * 00008000
*          address in register (2)-(12), address of the CONV          * 00008100
*          parameter list.                                            * 00008200
*                                                                     * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*      ÝRTNCODE=xrtncode¨                                             * 00008700
*          is the name (RS-type) of an optional fullword output       * 00008800
*          variable, or register (2)-(12), into which the return code * 00008900
*          is to be copied from GPR 15.                               * 00009000
*                                                                     * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*      ÝRSNCODE=xrsncode¨                                             * 00009500
*          is the name (RS-type) of an optional fullword output       * 00009600
*          variable, or register (2)-(12), into which the reason code * 00009700
*          is to be copied from GPR 0.                                * 00009800
*                                                                     * 00009900
*                                                                     * 00010000
*                                                                     * 00010100
*01* RETURN CODES:                                                    * 00010200
*                                                                     * 00010300
*                                                                     * 00010400
*                 Macro IEZVG200 provides declares for the return and * 00010500
*                 reason codes.                                       * 00010600
*                                                                     * 00010700
*       0         Name: ConVConRet0_ConsoleActive                     * 00010800
*                                                                     * 00010900
*                 Meaning:  The input console is active.              * 00011000
*                                                                     * 00011100
*                 Action: Examine the reason code to determine how to * 00011200
*                 proceed.                                            * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*                 HEX REASON  MEANING/ACTION                          * 00011600
*                 CODE                                                * 00011700
*                                                                     * 00011800
*                 0           Name: ConVConRsn0_AreaIdValid           * 00011900
*                                                                     * 00012000
*                             Meaning: The area ID (if specified) is  * 00012100
*                             syntactically valid.                    * 00012200
*                                                                     * 00012300
*                             Action: None.                           * 00012400
*                                                                     * 00012500
*                 C           Name: ConVConRsnC_AreaIdInvalid         * 00012600
*                                                                     * 00012700
*                             Meaning: Program error. The area id     * 00012800
*                             specified is not syntactically valid.   * 00012900
*                                                                     * 00013000
*                             Action: Correct the area ID             * 00013100
*                             specification. The area ID must be a    * 00013200
*                             letter between A-K or Z.                * 00013300
*                                                                     * 00013400
*                 10          Name: ConVConRsn10_AreaIdWrongLength    * 00013500
*                                                                     * 00013600
*                             Meaning: Program error. The area ID was * 00013700
*                             either not specified after the dash or  * 00013800
*                             additional non-blank characters were    * 00013900
*                             specified after the area ID in CONVFLD. * 00014000
*                                                                     * 00014100
*                             Action: Correct the area ID             * 00014200
*                             specification. The area ID must be a    * 00014300
*                             letter between A-K or Z.                * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*       4         Name: ConVConRet4_ConsoleInactive                   * 00014800
*                                                                     * 00014900
*                 Meaning:  The input console is inactive.            * 00015000
*                                                                     * 00015100
*                 Action: Messages cannot be sent to this console.    * 00015200
*                 You must direct messages elsewhere. Examine the     * 00015300
*                 reason code for additional information.             * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*                 HEX REASON  MEANING/ACTION                          * 00015700
*                 CODE                                                * 00015800
*                                                                     * 00015900
*                 0           ConVConRsn0_AreaIdValid                 * 00016000
*                                                                     * 00016100
*                             Meaning: The area ID (if specified) is  * 00016200
*                             syntactically valid.                    * 00016300
*                                                                     * 00016400
*                             Action: None.                           * 00016500
*                                                                     * 00016600
*                 C           ConVConRsnC_AreaIdInvalid               * 00016700
*                                                                     * 00016800
*                             Meaning: Program error. The area id     * 00016900
*                             specified is not syntactically valid.   * 00017000
*                                                                     * 00017100
*                             Action: Correct the area ID             * 00017200
*                             specification. The area ID must be a    * 00017300
*                             letter between A-K or Z.                * 00017400
*                                                                     * 00017500
*                 10          ConVConRsn10_AreaIdWrongLength          * 00017600
*                                                                     * 00017700
*                             Meaning: Program error. The area ID was * 00017800
*                             either not specified after the dash or  * 00017900
*                             additional non-blank characters were    * 00018000
*                             specified after the area ID in CONVFLD. * 00018100
*                                                                     * 00018200
*                             Action: Correct the area ID             * 00018300
*                             specification. The area ID must be a    * 00018400
*                             letter between A-K or Z.                * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*                                                                     * 00018800
*       8         Name: ConVConRet8_ConsoleNameNotFound               * 00018900
*                                                                     * 00019000
*                 Meaning:  The input console name was not found.     * 00019100
*                                                                     * 00019200
*                 Action: Examine the reason code to determine how to * 00019300
*                 proceed.                                            * 00019400
*                                                                     * 00019500
*                                                                     * 00019600
*                 HEX REASON  MEANING/ACTION                          * 00019700
*                 CODE                                                * 00019800
*                                                                     * 00019900
*                 0           Name: ConVConRsn0_BadName               * 00020000
*                                                                     * 00020100
*                             Meaning: Program error. The console     * 00020200
*                             name specified is not valid for one of  * 00020300
*                             the following reasons:  (1) No console  * 00020400
*                             with the specified name exists.  (2)    * 00020500
*                             You specified an area ID with the       * 00020600
*                             console name, but you also set the flag * 00020700
*                             CONVNPAR in the CONVFLGS field of the   * 00020800
*                             CONV parameter list.  (3) You specified * 00020900
*                             a console name with more than 8         * 00021000
*                             characters.                             * 00021100
*                                                                     * 00021200
*                             Action: Take the action number          * 00021300
*                             corresponding to the meaning number.    * 00021400
*                             (1) Change the console name to one that * 00021500
*                             is defined in the sysplex.  (2) Remove  * 00021600
*                             the area ID after the console name, or  * 00021700
*                             turn off the CONVNPAR flag in the CONV  * 00021800
*                             parameter list.  (3) Correct the        * 00021900
*                             console name.                           * 00022000
*                                                                     * 00022100
*                 8           Name: ConVConRsn8_InvalidSyntax         * 00022200
*                                                                     * 00022300
*                             Meaning: Program error. The console     * 00022400
*                             name specified contains invalid syntax. * 00022500
*                                                                     * 00022600
*                             Action: Correct the syntax of the       * 00022700
*                             console name and resubmit the request.  * 00022800
*                                                                     * 00022900
*                 C           Name: ConVConRsnC_NameIsReserved        * 00023000
*                                                                     * 00023100
*                             Meaning: Program error. The console     * 00023200
*                             name specified is a reserved console    * 00023300
*                             name.                                   * 00023400
*                                                                     * 00023500
*                             Action: Correct the problem and         * 00023600
*                             resubmit the request.                   * 00023700
*                                                                     * 00023800
*                                                                     * 00023900
*                                                                     * 00024000
*       C         Name: ConVConRetC_IncorrectConsoleId                * 00024100
*                                                                     * 00024200
*                 Meaning: Program error. You specified an incorrect  * 00024300
*                 console ID on input.                                * 00024400
*                                                                     * 00024500
*                 Action: Specify a valid 4-byte console id. Correct  * 00024600
*                 the problem and resubmit the request.               * 00024700
*                                                                     * 00024800
*                                                                     * 00024900
*       10        Name: ConVConRet10_NotAvailable                     * 00025000
*                                                                     * 00025100
*                 Meaning: Environmental error. The ConVCon service   * 00025200
*                 is not available                                    * 00025300
*                                                                     * 00025400
*                 Action: Resubmit the request at a later time.       * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*       14        Name: ConVConRet14_IBMDiagnostic                    * 00025800
*                                                                     * 00025900
*                 Meaning: System error. These codes are for IBM      * 00026000
*                 diagnostic purposes only.                           * 00026100
*                                                                     * 00026200
*                 Action: Supply the return code, reason code,        * 00026300
*                 CNZ0001I message, and the dump to the appropriate   * 00026400
*                 IBM support personel.                               * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*       18        Name: ConVConRet18_NoInputSpecified                 * 00026800
*                                                                     * 00026900
*                 Meaning: Program error. CONVCON processing          * 00027000
*                 completed unsuccessfully.  You did not specify      * 00027100
*                 whether a console name or a console ID was being    * 00027200
*                 supplied as input.                                  * 00027300
*                                                                     * 00027400
*                 Action: Ensure that exactly one of the console      * 00027500
*                 input flags in field CONVFLGS is on and resubmit    * 00027600
*                 the request.                                        * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*       1C        Name: ConVConRet1C_TooMuchInput                     * 00028000
*                                                                     * 00028100
*                 Meaning: Program error. CONVCON processing          * 00028200
*                 completed unsuccessfully.  You specified both the   * 00028300
*                 console name and console ID values in CONVFLGS.     * 00028400
*                                                                     * 00028500
*                 Action: Ensure that you only have one of the        * 00028600
*                 console input flags in field CONVFLGS is on and     * 00028700
*                 resubmit the request.                               * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*       20        Name: ConVConRet20_BadAcronym                       * 00029100
*                                                                     * 00029200
*                 Meaning: Program error. CONVCON processing          * 00029300
*                 completed unsuccessfully.  The CONV acronym was     * 00029400
*                 missing in the CONV parameter list.                 * 00029500
*                                                                     * 00029600
*                 Action: Ensure that you are correctly referencing   * 00029700
*                 the parameter list issuing CONVCON, and that the    * 00029800
*                 parameter list is correct.  Resubmit the request.   * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*       24        Name: ConVConRet24_HoldingLocks                     * 00030200
*                                                                     * 00030300
*                 Meaning: Program error. CONVCON was called while    * 00030400
*                 holding a lock.                                     * 00030500
*                                                                     * 00030600
*                 Action: Correct the program to invoke CONVCON while * 00030700
*                 no locks are held.                                  * 00030800
*                                                                     * 00030900
*       28        Name: ConVConRet28_IncorrectEnv                     * 00031000
*                                                                     * 00031100
*                 Meaning: The CONVCON service was invoked in an      * 00031200
*                 incorrect environment.                              * 00031300
*                                                                     * 00031400
*                 Action: Invoke the CONVCON service in a valid       * 00031500
*                 environment.                                        * 00031600
*                                                                     * 00031700
*                                                                     * 00031800
*                                                                     * 00031900
*01* REASON CODES:                                                    * 00032000
*                                                                     * 00032100
*       Reason codes, as appropriate, are defined under their         * 00032200
*       corresponding return code.                                    * 00032300
*                                                                     * 00032400
*01* MODULE TYPE:  ASSEM MACRO                                        * 00032500
*                                                                     * 00032600
*02*   PROCESSOR:  ASSEM                                              * 00032700
*                                                                     * 00032800
*01* COMPONENT:  SC1CK                                                * 00032900
*                                                                     * 00033000
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00033100
*                                                                     * 00033200
*01* MACRO USAGE NOTES:                                               * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00033600
*        global macro variable.  Any value other than 'NO' will       * 00033700
*        result in the macro expansion being printed.  The default is * 00033800
*        'YES'.  The following examples illustrate how the ZPRINT     * 00033900
*        variable should be set.                                      * 00034000
*                                                                     * 00034100
*                    GBLC &ZPRINT                                     * 00034200
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*                                                                     * 00034600
*01* CHANGE ACTIVITY:                                                 * 00034700
*                                                                     * 00034800
*   Flag LineItem  FMID    Date   ID    Comment                       * 00034900
*                                                                     * 00035000
*    $L0=CNMG2    HBB4410 870319 PDV1:  CONSOLE MERGE STAGE II        * 00035100
*    $L1=TSOOP    HBB4410 870901 PDBU:  ADD PC INVOCATION             * 00035200
*    $D1=DCR186   HBB4410 890626 PDCM:  AREA ID VERIFICATION          * 00035300
*    $L2=CNZ1B    HBB7720 040212 PDD0:  TRACK ELIMINATION             * 00035400
*    $P1=ME00837  HBB7720 040610 PDSW:  REVERSIONING                  * 00035500
*    $P2=ME01663  HBB7720 040831 PDSW:  REVERSIONING CANCELLED        * 00035600
*    $L3=CNZ2A    HBB7730 050304 PDD0:  ConVCon Rewrite               * 00035700
*    $P3=ME05149  HBB7730 051130 PDD0:  ConVCon Compatibility         * 00035800
*    $01=OA16296  HBB7730 060531 PDD0:  Enhanced CnzConv Checks       * 00035900
*    $L4=CNZ2B    HBB7750 060630 PDD0:  ConVCon/CnzConv Environments  * 00036000
*    $P4=ME08332  HBB7740 061130 PDD0:  Relative Branching            * 00036100
****** END OF SPECIFICATIONS *****************************************/ 00036200
*/********************************************************************* 00036300
         MACRO                                                          00036400
&XLABEL  CONVCON &RTNCODE=,&RSNCODE=                                    00036500
.*                                                                      00036600
*              MACDATE -11/30/06-<0>                                    00036700
.*                                                                      00036800
.*******************************************************************    00036900
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00037000
.*******************************************************************    00037100
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00037200
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00037300
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00037400
.*                                                                      00037500
              GBLC  &ZCONVCON   YES=MACRO USED AT LEAST ONCE            00037600
.*******************************************************************    00037700
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00037800
.*******************************************************************    00037900
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00038000
              LCLC  &ZCNDX      SYSNDX CHARACTERS                       00038100
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00038200
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00038300
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00038400
              LCLA  &ZAWRK      USED AS A WORK AREA                     00038500
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00038600
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00038700
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00038800
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00038900
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00039000
              LCLC  &ZMAC_G     "G" or null                             00039100
&ZMAC_G       SETC  ''                                                  00039200
              LCLC  &ZMAC_LR                                            00039300
&ZMAC_LR      SETC  'LR'                                                00039400
              LCLC  &ZMAC_L                                             00039500
&ZMAC_L       SETC  'L'                                                 00039600
              LCLC  &ZMAC_ST                                            00039700
&ZMAC_ST      SETC  'ST'                                                00039800
              LCLA  &ZMACRET    MACRO RETURN CODE                       00039900
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00040000
.*                                                                      00040100
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00040200
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00040300
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00040400
              LCLC  &ZENDBASEPL                 End of base PL          00040500
.********************************************************************   00040600
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00040700
.********************************************************************   00040800
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00040900
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00041000
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00041100
              GBLC  &SYSAM64    SYSSTATE AMODE64                        00041200
.*                                                                      00041300
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00041400
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00041500
              SPLEVEL  TEST                                             00041600
.ZSYS2        ANOP  ,                                                   00041700
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00041800
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00041900
              SYSSTATE TEST                                             00042000
              AGO   .ZSYS4                                              00042100
.ZSYS3        ANOP  ,                                                   00042200
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00042300
.ZSYS4        ANOP  ,                                                   00042400
.*******************************************************************    00042500
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00042600
.*******************************************************************    00042700
              LCLC  &XINCONV    ++ NAME                                 00042800
              LCLC  &XRTNCODE   ++ NAME                                 00042900
              LCLC  &XRSNCODE   ++ NAME                                 00043000
.*******************************************************************    00043100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00043200
.*******************************************************************    00043300
              LCLC  &ZXINCONV   ++ INOUT NAME                           00043400
              LCLC  &ZXRTNCODE  ++ OUTPUT NAME                          00043500
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00043600
.********************************************************************   00043700
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00043800
.********************************************************************   00043900
              ACTR  10000                                               00044000
.*----------------------------------------------------------------***   00044100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00044200
              AIF   (N'&RTNCODE LE 1).ZG5A      CK NUM                  00044300
&ZMS          SETC  '"RTNCODE='                                         00044400
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00044500
&ZMS          SETC  '&ZMS "RTNCODE"'                                    00044600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00044700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00044800
.ZG5A         ANOP  ,                                                   00044900
.*-------------------------------------------------------------------   00045000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00045100
              AIF   (K'&RTNCODE(1) LE 0).ZG5C   NO PARM                 00045200
&ZXRTNCODE    SETC  'OUTPUT'    SET OUTPUT                              00045300
&XRTNCODE     SETC  '&RTNCODE(1)'               SET XVARIABLE           00045400
              AIF   (N'&RTNCODE GT 1).ZG5C                              00045500
&XRTNCODE     SETC  '&RTNCODE'  SET XVARIABLE                           00045600
.ZG5C         ANOP  ,                                                   00045700
.*-------------------------------------------------------------------   00045800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00045900
              AIF   (K'&ZXRTNCODE LE 0).ZG5R    NOT I/O                 00046000
              AIF   ('&XRTNCODE'(1,1) NE '(').ZG5R                      00046100
&ZCGPR        SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                        00046200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         00046300
              AIF   (K'&ZCGPR GT 2).ZG5Q                                00046400
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              00046500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00046600
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        00046700
.ZG5P         ANOP  ,                                                   00046800
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             00046900
              AIF   ('&ZCGPR' LT '2').ZG5Q                              00047000
              AIF   ('&ZCGPR' LE '12').ZG5R                             00047100
.ZG5Q         ANOP  ,                                                   00047200
&ZMS          SETC  '"RTNCODE='                                         00047300
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    00047400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00047500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00047600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00047700
.ZG5R         ANOP  ,                                                   00047800
.*----------------------------------------------------------------***   00047900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00048000
              AIF   (N'&RSNCODE LE 1).ZG8A      CK NUM                  00048100
&ZMS          SETC  '"RSNCODE='                                         00048200
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00048300
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00048400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00048500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00048600
.ZG8A         ANOP  ,                                                   00048700
.*-------------------------------------------------------------------   00048800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00048900
              AIF   (K'&RSNCODE(1) LE 0).ZG8C   NO PARM                 00049000
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00049100
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00049200
              AIF   (N'&RSNCODE GT 1).ZG8C                              00049300
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00049400
.ZG8C         ANOP  ,                                                   00049500
.*-------------------------------------------------------------------   00049600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00049700
              AIF   (K'&ZXRSNCODE LE 0).ZG8R    NOT I/O                 00049800
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG8R                      00049900
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00050000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                         00050100
              AIF   (K'&ZCGPR GT 2).ZG8Q                                00050200
              AIF   ('&ZCGPR' EQ '0').ZG8Q                              00050300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00050400
              AIF   (T'&ZCGPR NE 'N').ZG8Q      INVALID REG NAME        00050500
.ZG8P         ANOP  ,                                                   00050600
              AIF   (T'&ZCGPR NE 'N').ZG8R      NON NUMERIC             00050700
              AIF   ('&ZCGPR' LT '2').ZG8Q                              00050800
              AIF   ('&ZCGPR' LE '12').ZG8R                             00050900
.ZG8Q         ANOP  ,                                                   00051000
&ZMS          SETC  '"RSNCODE='                                         00051100
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00051200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00051300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00051400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00051500
.ZG8R         ANOP  ,                                                   00051600
.******************************************************************     00051700
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00051800
.******************************************************************     00051900
              ACTR  10000                                               00052000
.*----------------------------------------------------------------***   00052100
.***AH.P02 EXTRA POSITIONALS                                            00052200
              AIF   (N'&SYSLIST LE 1).ZGLISTX   NO EXTRAS               00052300
&ZCVAL        SETC  ''          ERROR FIELD                             00052400
&ZAWRK        SETA  1           POSITIONAL NUMBER                       00052500
.ZGLIST2      ANOP  ,                                                   00052600
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00052700
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00052800
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00052900
              AGO   .ZGLIST2                                            00053000
.*                                                                      00053100
.ZGLIST3      ANOP  ,                                                   00053200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00053300
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00053400
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00053500
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00053600
&ZMS          SETC  '&ZMS ONLY 1 POSITIONAL ARGUMENT'                   00053700
              MNOTE 8,' &ZMS IS ALLOWED.'                               00053800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00053900
.ZGLISTX      ANOP  ,                                                   00054000
&ZASYSLNDX    SETA  0                                                   00054100
.*-------------------------------------------------------------------   00054200
.***AH.PXVAR01 NAME, RQD INOUT, POS(1) -XVARIABLE                       00054300
.ZG2A         ANOP  ,                                                   00054400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                NEXT POSITIONAL         00054500
         AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG2B  DONE                    00054600
         AIF   ('&ZCSYSLIST(&ZASYSLNDX)' EQ 'NONXKEY').ZG2A             00054700
         AIF   (K'&SYSLIST(&ZASYSLNDX) LE 0).ZG2B  NULL                 00054800
&ZXINCONV     SETC  'INOUT'     SET IN/OUTPUT                           00054900
&XINCONV      SETC  '&SYSLIST(&ZASYSLNDX)'      SET XVARIABLE           00055000
              AGO               .ZG2C                                   00055100
.*                                                                      00055200
.ZG2B         ANOP  ,                                                   00055300
&ZMS          SETC  'POSITIONAL ARGUMENT'                               00055400
&ZMS          SETC  '&ZMS 1 IS REQUIRED.  SEE DOCUMENTATION'            00055500
              MNOTE 8,' &ZMS FOR "XINCONV".'                            00055600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00055700
.ZG2C         ANOP  ,                                                   00055800
.*-------------------------------------------------------------------   00055900
.***AH.PCK02 NAME, RQD INOUT, POS(1) -GPR OUT OF RANGE                  00056000
              AIF   (K'&ZXINCONV LE 0).ZG2R     NOT I/O                 00056100
              AIF   ('&XINCONV'(1,1) NE '(').ZG2R                       00056200
&ZCGPR        SETC  '&XINCONV'(2,K'&XINCONV-2)                          00056300
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         00056400
              AIF   (K'&ZCGPR GT 2).ZG2Q                                00056500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00056600
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        00056700
.ZG2P         ANOP  ,                                                   00056800
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             00056900
              AIF   ('&ZCGPR' LT '2').ZG2Q                              00057000
              AIF   ('&ZCGPR' LE '12').ZG2R                             00057100
.ZG2Q         ANOP  ,                                                   00057200
&ZMS          SETC  '"&SYSLIST(&ZASYSLNDX)"'                            00057300
&ZMS          SETC  '&ZMS POSITIONAL ARGUMENT 1 MUST SPECIFY'           00057400
              MNOTE 8,' &ZMS A REGISTER IN THE RANGE (2)-(12).'         00057500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00057600
.ZG2R         ANOP  ,                                                   00057700
.*******************************************************************    00057800
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00057900
.*******************************************************************    00058000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00058100
.*******************************************************************    00058200
.***AE.01  START OF CONVCON MACRO CODE                                  00058300
.*******************************************************************    00058400
              LCLC  &M0M0001                 NAME                       00058500
&M0M0001      SETC  '&XLABEL'                SET NAME                   00058600
              AIF   (K'&XLABEL NE 0).XLAB2                              00058700
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00058800
.*                                                                      00058900
.XLAB2        ANOP  ,                                                   00059000
&M0M0001 DS    0H                             CONVCON-0                 00059100
.*******************************************************************    00059200
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00059300
.*******************************************************************    00059400
              PUSH  PRINT                                               00059500
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00059600
              PRINT OFF         ++ PR01                                 00059700
              AGO   .ZPRNTXX                                            00059800
.ZPRINTX      PRINT ON                                                  00059900
.ZPRNTXX      ANOP  ,                                                   00060000
.********************************************************************   00060100
.***AL.A01  INTERNAL ARRAY TO PRODUCE FORMATTED CODE                    00060200
.********************************************************************   00060300
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00060400
                      LCLA  &ZOPN1         INVOCATION INDEX             00060500
                      LCLC  &ZOPL(4095)    LABEL                        00060600
                      LCLC  &ZOPO(4095)    OPERATION                    00060700
                      LCLC  &ZOPV(4095)    VALUE                        00060800
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00060900
.*                                                                      00061000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00061100
.*-------------------------------------------------------------------   00061200
&ZOPN1                SETA &ZOPN                                        00061300
.*******************************************************************    00061400
.***AO.X01  LABEL TO BYPASS INVOCATION                                  00061500
.*******************************************************************    00061600
&ZOPN     SETA  &ZOPN+1                                                 00061700
&ZOPL(&ZOPN)   SETC  'AMGE&SYSNDX'                                      00061800
&ZOPO(&ZOPN)   SETC  'DS'                                               00061900
&ZOPV(&ZOPN)   SETC  '0H'                                               00062000
&ZOPD(&ZOPN)   SETC  '++ BYPASS INVOCATION'                             00062100
.*******************************************************************    00062200
.***AO.X02  RETURN CODE PROCESSING                                      00062300
.*******************************************************************    00062400
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    00062500
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            00062600
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             00062700
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             00062800
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               00062900
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                00063000
&ZOPN                 SETA  &ZOPN+1                                     00063100
&ZOPL(&ZOPN)          SETC  ' '                                         00063200
&ZOPO(&ZOPN)          SETC  'ST'                                        00063300
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              00063400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00063500
                      AGO   .ZMRETX                                     00063600
.*                                                                      00063700
.ZMRET2               ANOP  ,                                           00063800
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                00063900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00064000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00064100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00064200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00064300
&ZOPN                 SETA  &ZOPN+1                                     00064400
&ZOPL(&ZOPN)          SETC  ' '                                         00064500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00064600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00064700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00064800
.ZMRETX               ANOP  ,                                           00064900
.*******************************************************************    00065000
.***AO.X03  REASON CODE PROCESSING                                      00065100
.*******************************************************************    00065200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00065300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00065400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00065500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00065600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00065700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00065800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00065900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00066000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00066100
&ZOPN                 SETA  &ZOPN+1                                     00066200
&ZOPL(&ZOPN)          SETC  ' '                                         00066300
&ZOPO(&ZOPN)          SETC  'ST'                                        00066400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00066500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00066600
                      AGO   .ZMRSNX                                     00066700
.*                                                                      00066800
.ZMRSN2               ANOP  ,                                           00066900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00067000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00067100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00067200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00067300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00067400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00067500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00067600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00067700
&ZOPN                 SETA  &ZOPN+1                                     00067800
&ZOPL(&ZOPN)          SETC  ' '                                         00067900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00068000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00068100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00068200
.ZMRSNX               ANOP  ,                                           00068300
.*******************************************************************    00068400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00068500
.*******************************************************************    00068600
                      ACTR  10000                                       00068700
.*                                                                      00068800
                      LCLA  &ZLC           COLUMN POSITION              00068900
                      LCLA  &ZOPX          LIST TABLE INDEX             00069000
                      LCLC  &ZLL           LABEL                        00069100
                      LCLC  &ZLOP          OPERATION                    00069200
                      LCLC  &ZLV           VALUE                        00069300
                      LCLC  &ZLD           DESCRIPTION                  00069400
.*                                                                      00069500
&ZOPX                 SETA  1                                           00069600
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00069700
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00069800
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00069900
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00070000
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00070100
                      AIF   (K'&ZLD LE 0).ZL5                           00070200
&ZLC                  SETA  35             COMMENT COLUMN               00070300
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00070400
&ZLC                  SETA  33             COMMMENT COLUMN              00070500
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00070600
&ZLV                  SETC  '&ZLV'.' '                                  00070700
                      AGO   .ZL3                                        00070800
.*                                                                      00070900
.ZL4                  ANOP  ,                                           00071000
&ZLV                  SETC  '&ZLV'.' '                                  00071100
.ZL5                  ANOP  ,                                           00071200
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00071300
.*                                                                      00071400
&ZLL     &ZLOP &ZLV                                                     00071500
.*                                                                      00071600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00071700
                      AGO   .ZL2           CONTINUE LOOPING             00071800
.*                                                                      00071900
.ZLX                  ANOP  ,                                           00072000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00072100
.*-----------BAL invocation code-------------                           00072200
         AIF   ('&XINCONV'(1,1) EQ '(').REG                             00072300
         LA    1,&XINCONV     GET ADDRESS OF CONV                       00072400
         ST    1,CONVPTR-CONV(,1) SAVE CONVCON PTR AS PARAMETER FOR THE+00072500
                                CONVCON SERVICE PROCESSOR               00072600
         LA    1,CONVPTR-CONV(,1)   PUT ADDRESS OF PARAMETER IN        +00072700
                                      REGISTER ONE                      00072800
         AGO   .GET@                                                    00072900
.********************************************************************** 00073000
.*   CONVCON WAS INVOKED WITH A REGISTER SPECIFIED AS AN ARGUMENT.    * 00073100
.* GENERATE INSTRUCTIONS TO PERFORM STANDARD PARAMETER PASSING OF     * 00073200
.* THE CONV PARAMETER LIST.                                           * 00073300
.********************************************************************** 00073400
.REG     ANOP                                                           00073500
         ST    &XINCONV,CONVPTR-CONV(,&XINCONV) SAVE CONV POINTER AS   +00073600
                                   PARAMETER FOR SERVICE PROCESSOR      00073700
         LA    1,CONVPTR-CONV(,&XINCONV) PUT ADDRESS OF PARAMETER IN   +00073800
                                      REGISTER ONE                      00073900
.********************************************************************** 00074000
.*                                                                    * 00074100
.*  Invoke PC for CONVCON Interface Routine                           * 00074200
.*                                                                    * 00074300
.********************************************************************** 00074400
.GET@    ANOP                                                           00074500
         L     15,16(0,0)     GET ADDRESS OF CVT FROM PSA               00074600
         L     15,100(,15)    GET ADDRESS OF UCM FROM CVT               00074700
         ICM   15,15,304(15)  GET ADDRESS OF CONVCON PROCESSOR FROM UCM 00074800
         JZ    CnzConVConNotInstalled_&SYSNDX  DO NOT INVOKE CONVCON   +00074900
                              PROCESSOR IF ITS ADDRESS WAS ZERO    @P4C 00075000
         L     15,16(0,0)     GET ADDRESS OF CVT FROM PSA          @L1A 00075100
         L     15,772(,15)    GET ADDRESS OF SFT FROM CVT          @L1A 00075200
         LA    14,2           GET CONVCON INDEX INTO LINKAGE TABLE @L1A 00075300
         AL    14,100(,15)    POINT REG14 TO CONVCON ETD ENTRY     @L1A 00075400
         PC    0(14)          PC TO CONVCON SERVICE                @L1A 00075500
         J     CnzConVConEnd_&SYSNDX Branch to the end of ConVCon  @P4C 00075600
CnzConVConNotInstalled_&SYSNDX EQU * Branch location when ConVCon not  +00075700
                              installed                            @P4A 00075800
         LA    15,16          SET RETURN CODE 16 - CONVCON PROCESSOR   +00075900
                               NOT INSTALLED                            00076000
CnzConVConEnd_&SYSNDX EQU *   Branch location when ConVCon done    @P4A 00076100
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00076200
.*******************************************************************    00076300
.***AP.X01  FORMAT GENERATED CODE                                       00076400
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00076500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00076600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00076700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00076800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00076900
                      AIF   (K'&ZLD LE 0).ZL51                          00077000
&ZLC                  SETA  35             COMMENT COLUMN               00077100
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00077200
&ZLC                  SETA  33             COMMENT COLUMN               00077300
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00077400
&ZLV                  SETC  '&ZLV'.' '                                  00077500
                      AGO   .ZL31                                       00077600
.*                                                                      00077700
.ZL41                 ANOP  ,                                           00077800
&ZLV                  SETC  '&ZLV'.' '                                  00077900
.ZL51                 ANOP  ,                                           00078000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00078100
.*                                                                      00078200
&ZLL     &ZLOP &ZLV                                                     00078300
.*                                                                      00078400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00078500
                      AGO   .ZL21          CONTINUE LOOPING             00078600
.*                                                                      00078700
.ZLX1                 ANOP  ,                                           00078800
.*******************************************************************    00078900
.***AP.X02  END OF CONVCON MACRO                                        00079000
&ZCONVCON             SETC  'YES'          SET CONVCON USED             00079100
         POP   PRINT                                                    00079200
*                                            CONVCON-0                  00079300
         SPACE 1                                                        00079400
.ZLX2                 ANOP  ,                                           00079500
         MEND                                                           00079600
**********************************************************************/ 00079700
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00079800
*%CONVCON: MACRO KEYS(RTNCODE,RSNCODE);                                 00079900
*  ANS('?'!!MACLABEL!!' '!!'CONVCONP '!!MACLIST!!                       00080000
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00080100
*%END CONVCON;                                                          00080200

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  HZSPWRIT                              -07/10/15-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Write Check Persistent Data                   * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 2005, 2010                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7770                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      The HZSPWRIT macro is an interface used by check routines to   * 00002000
*      write persistent data into the IBM Health Checker for z/OS     * 00002100
*      Persistent Data data set, which is allocated using the         * 00002200
*      HZSPDATA ddname in the startup proc or via the HZSPDATA        * 00002300
*      statement in a HZSPRMxx parmlib member. Use HZSPWRIT only      * 00002400
*      within the Init, Check, or Cleanup function for a local check, * 00002500
*      or within the InitRun or Run function for a remote check.      * 00002600
*                                                                     * 00002700
*      The data is associated with the writing check, and can be      * 00002800
*      retrieved by the HZSPREAD macro, specifying the check owner    * 00002900
*      and check name.  The data remains even if the writing check is * 00003000
*      deleted.                                                       * 00003100
*                                                                     * 00003200
*      If the check iteration completes with an abend (or a remote    * 00003300
*      check iteration is designated unsuccessful) or an invocation   * 00003400
*      of HZSPWRIT is not successful, then the persistent data for    * 00003500
*      that iteration is not retained. Note that "unsuccessful" has   * 00003600
*      no correlation with whether or not the check detected          * 00003700
*      exception(s).                                                  * 00003800
*                                                                     * 00003900
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00004000
*                                                                     * 00004100
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00004200
*                                                                     * 00004300
*01* ENVIRONMENT:                                                     * 00004400
*                                                                     * 00004500
*                                                                     * 00004600
*      Minimum authorization: Problem state.  PSW key 8-15.           * 00004700
*                                                                     * 00004800
*                        When problem state and key 8-15 and not APF  * 00004900
*                        authorized, or when SECCHECK=ALL is          * 00005000
*                        specified, the caller must be authorized for * 00005100
*                        update access to either of the following:    * 00005200
*                                                                     * 00005300
*                                                                     * 00005400
*                        o   XFACILIT class resource                  * 00005500
*                            HZS.sysname.checkowner.PDATA             * 00005600
*                                                                     * 00005700
*                        o   XFACILIT class resource                  * 00005800
*                            HZS.sysname.checkowner.checkname.PDATA   * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*      Dispatchable unit mode: Task mode.                             * 00006300
*                                                                     * 00006400
*      Cross Memory Mode: PASN=HASN=SASN.                             * 00006500
*                                                                     * 00006600
*      AMODE:            31- or 64-bit.                               * 00006700
*                                                                     * 00006800
*                        If in AMODE 64, specify SYSSTATE AMODE64=YES * 00006900
*                        before invoking this macro.                  * 00007000
*                                                                     * 00007100
*      ASC mode:         Primary or Access Register.                  * 00007200
*                                                                     * 00007300
*                        If in Access Register ASC mode, specify      * 00007400
*                        SYSSTATE ASCENV=AR before invoking this      * 00007500
*                        macro.                                       * 00007600
*                                                                     * 00007700
*      Interrupt status: Enabled for I/O and external interrupts.     * 00007800
*                                                                     * 00007900
*      Locks:            No locks held.                               * 00008000
*                                                                     * 00008100
*      Control parameters: Control parameters must be in the primary  * 00008200
*                        address space or, for AR-mode callers, must  * 00008300
*                        be in an address/data space that is          * 00008400
*                        addressable through a public entry on the    * 00008500
*                        caller's dispatchable unit access list       * 00008600
*                        (DU-AL).  Control parameters must be below   * 00008700
*                        2G.                                          * 00008800
*                                                                     * 00008900
*                        The user-provided buffer (via BUFFER) has    * 00009000
*                        the same requirements and restrictions as    * 00009100
*                        the control parameters.                      * 00009200
*                                                                     * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*01* PROGRAMMING REQUIREMENTS:                                        * 00009600
*                                                                     * 00009700
*                                                                     * 00009800
*    o   This service is supported only when it is called from a      * 00009900
*        check routine invoked by IBM Health Checker for z/OS.        * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*                                                                     * 00010300
*01* RESTRICTIONS:                                                    * 00010400
*                                                                     * 00010500
*    The caller may not have an FRR established.                      * 00010600
*                                                                     * 00010700
*01* INPUT REGISTER INFORMATION:                                      * 00010800
*                                                                     * 00010900
*    Before issuing the HZSPWRIT macro, the caller does not have to   * 00011000
*    place any information into any register unless using it in       * 00011100
*    register notation for a particular parameter, or using it as a   * 00011200
*    base register.                                                   * 00011300
*                                                                     * 00011400
*    Before issuing the HZSPWRIT macro, the caller does not have to   * 00011500
*    place any information into any AR unless using it in register    * 00011600
*    notation for a particular parameter, or using it as a base       * 00011700
*    register.                                                        * 00011800
*                                                                     * 00011900
*01* OUTPUT REGISTER INFORMATION:                                     * 00012000
*                                                                     * 00012100
*    When control returns to the caller, the GPRs contain:            * 00012200
*                                                                     * 00012300
*                                                                     * 00012400
*    REGISTER  CONTENTS                                               * 00012500
*                                                                     * 00012600
*    0         Reason code, when register 15 is not 0.  Otherwise,    * 00012700
*              used as a work register by the system                  * 00012800
*                                                                     * 00012900
*    1         Used as a work register by the system                  * 00013000
*                                                                     * 00013100
*    2-13      Unchanged                                              * 00013200
*                                                                     * 00013300
*    14        Used as a work register by the system                  * 00013400
*                                                                     * 00013500
*    15        Return code                                            * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*    When control returns to the caller, the ARs contain:             * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*    REGISTER  CONTENTS                                               * 00014300
*                                                                     * 00014400
*    0-1       Used as work registers by the system                   * 00014500
*                                                                     * 00014600
*    2-13      Unchanged                                              * 00014700
*                                                                     * 00014800
*    14-15     Used as work registers by the system                   * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*    Some callers depend on register contents remaining the same      * 00015300
*    before and after issuing a service.  If the system changes the   * 00015400
*    contents of registers on which the caller depends, the caller    * 00015500
*    must save them before issuing the service, and restore them      * 00015600
*    after the system returns control.                                * 00015700
*                                                                     * 00015800
*01* PERFORMANCE IMPLICATIONS:                                        * 00015900
*    None.                                                            * 00016000
*                                                                     * 00016100
*01* SYNTAX:                                                          * 00016200
*                                                                     * 00016300
*Ýxlabel¨  HZSPWRIT     BUFFER=xbuffer                                * 00016400
*                      ,DATALEN=xdatalen                              * 00016500
*                    ÐÝ,SECCHECK=UNAUTH¨                              * 00016600
*                    ¿Ý,SECCHECK=ALL¨                                 * 00016700
*                    ÐÝ,REMOTE=NO¨                                    * 00016800
*                    ¿Ý,REMOTE=YES                                    * 00016900
*                          ,HANDLE=xhandle                            * 00017000
*                        ÐÝ,REXX=NO¨                                  * 00017100
*                        ¿Ý,REXX=YES¨¨                                * 00017200
*                     Ý,RETCODE=xretcode¨                             * 00017300
*                     Ý,RSNCODE=xrsncode¨                             * 00017400
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00017500
*                    ÐÝ,MF=S¨                                         * 00017600
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00017700
*                    ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00017800
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*      Where:                                                         * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      Ýxlabel¨                                                       * 00018500
*          is an optional symbol, starting in column 1, that is the   * 00018600
*          name on the HZSPWRIT macro invocation.  The name must      * 00018700
*          conform to the rules for an ordinary assembler language    * 00018800
*          symbol.                                                    * 00018900
*          DEFAULT: No name.                                          * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*      BUFFER=xbuffer                                                 * 00019500
*          is the name (RS-type), or address in register (2)-(12), of * 00019600
*          a required character input area that contains the data to  * 00019700
*          be written.  The buffer should be in the same key as the   * 00019800
*          caller.                                                    * 00019900
*                                                                     * 00020000
*                                                                     * 00020100
*                                                                     * 00020200
*                                                                     * 00020300
*      DATALEN=xdatalen                                               * 00020400
*          is the name (RS-type), or address in register (2)-(12), of * 00020500
*          a required fullword input that contains the number of      * 00020600
*          bytes of data from the buffer to be written.               * 00020700
*                                                                     * 00020800
*                                                                     * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*      ÝSECCHECK=»UNAUTH!ALLº¨                                        * 00021200
*          is an optional keyword input that indicates whether to do  * 00021300
*          RACF security checks.                                      * 00021400
*          DEFAULT: UNAUTH                                            * 00021500
*                                                                     * 00021600
*                                                                     * 00021700
*          ÝSECCHECK=UNAUTH¨                                          * 00021800
*              that indicates to do RACF security checks only when    * 00021900
*              the caller is unauthorized (not supervisor state, not  * 00022000
*              system key, not APF-authorized).                       * 00022100
*                                                                     * 00022200
*          ÝSECCHECK=ALL¨                                             * 00022300
*              that indicates to do RACF security checks in all       * 00022400
*              cases. If RACF does not grant authority, the request   * 00022500
*              is rejected.                                           * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*                                                                     * 00023100
*                                                                     * 00023200
*      ÝREMOTE=»NO!YESº                                               * 00023300
*          is an optional keyword input which identifies the locale   * 00023400
*          of the check.                                              * 00023500
*          DEFAULT: NO                                                * 00023600
*                                                                     * 00023700
*                                                                     * 00023800
*          ÝREMOTE=NO¨                                                * 00023900
*              indicates that the check runs locally in the address   * 00024000
*              space of IBM Health Checker for z/OS.                  * 00024100
*                                                                     * 00024200
*          ÝREMOTE=YES                                                * 00024300
*              indicates that the check runs remotely, in an address  * 00024400
*              space other than that of IBM Health Checker for z/OS.  * 00024500
*                                                                     * 00024600
*                                                                     * 00024700
*              HANDLE=xhandle                                         * 00024800
*                  is the name (RS-type), or address in register      * 00024900
*                  (2)-(12), of a required 16 character input that    * 00025000
*                  specifies a handle (token) that identifies the     * 00025100
*                  check. This handle was returned via the HANDLE     * 00025200
*                  parameter of the HZSADDCK macro for a REMOTE=YES   * 00025300
*                  REXX=NO check. It is provided in REXX variable     * 00025400
*                  HZS_HANDLE for a REMOTE=YES REXX=YES check.        * 00025500
*                                                                     * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*                                                                     * 00025900
*              ÝREXX=»NO!YESº¨¨                                       * 00026000
*                  is an optional keyword input which indicates if    * 00026100
*                  this is a REXX check.                              * 00026200
*                  DEFAULT: NO                                        * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                  ÝREXX=NO¨                                          * 00026600
*                      indicates that the check is not a REXX check.  * 00026700
*                                                                     * 00026800
*                  ÝREXX=YES¨¨                                        * 00026900
*                      indicates that the check is a REXX check.      * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*                                                                     * 00027800
*                                                                     * 00027900
*                                                                     * 00028000
*      ÝRETCODE=xretcode¨                                             * 00028100
*          is the name (RS-type) of an optional fullword output       * 00028200
*          variable, or register (2)-(12) or (15), into which the     * 00028300
*          return code is to be copied from GPR 15.  If you specify   * 00028400
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00028500
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00028600
*          with MF=M.                                                 * 00028700
*                                                                     * 00028800
*                                                                     * 00028900
*                                                                     * 00029000
*                                                                     * 00029100
*      ÝRSNCODE=xrsncode¨                                             * 00029200
*          is the name (RS-type) of an optional fullword output       * 00029300
*          variable into which the reason code is to be copied from   * 00029400
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00029500
*          R0 (within or without parentheses), the value will be left * 00029600
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00029700
*                                                                     * 00029800
*                                                                     * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00030200
*          is an optional byte input decimal value in the "0-0" range * 00030300
*          that specifies the macro version.  PLISTVER is the only    * 00030400
*          key allowed on the list form of MF and determines which    * 00030500
*          parameter list is generated.  Note that MAX may be         * 00030600
*          specified instead of a number, and the parameter list will * 00030700
*          be of the largest size currently supported. This size may  * 00030800
*          grow from release to release (thus possibly affecting the  * 00030900
*          amount of storage needed by your program).  If your        * 00031000
*          program can tolerate this, IBM recommends that you always  * 00031100
*          specify MAX when creating the list form parameter list as  * 00031200
*          that will ensure that the list form parameter list is      * 00031300
*          always long enough to hold whatever parameters might be    * 00031400
*          specified on the execute form.                             * 00031500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00031600
*          default is the lowest version which allows all of the      * 00031700
*          parameters specified on the invocation to be processed.    * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*      ÝMF=»S!L!M!Eº¨                                                 * 00032300
*          is an optional keyword input which specifies the macro     * 00032400
*          form.                                                      * 00032500
*          DEFAULT: S                                                 * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*          ÝMF=S¨                                                     * 00032900
*              specifies the standard form of the macro.  The "S"     * 00033000
*              form generates code to put the parameters into an      * 00033100
*              in-line parameter list and invoke the desired service. * 00033200
*              Full checking for required macro keys is done along    * 00033300
*              with supplying defaults for omitted optional           * 00033400
*              parameters.                                            * 00033500
*                                                                     * 00033600
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00033700
*              specifies the list form of the macro.  The "L" form    * 00033800
*              defines an area to be used for the parameter list.     * 00033900
*              Only the PLISTVER key may be specified on the          * 00034000
*              invocation.  All other macro parameters are flagged as * 00034100
*              errors.  If PLISTVER is not specified, the original    * 00034200
*              parameter list definition is used.                     * 00034300
*                                                                     * 00034400
*            ,xmfctrl                                                 * 00034500
*              is a required input.  It is the name of a storage area * 00034600
*              for the parameter list.                                * 00034700
*                                                                     * 00034800
*            »,xmfattr!0Dº                                            * 00034900
*              is an optional 60 character input string that varies   * 00035000
*              from 1 to 60 characters. Use it to force boundary      * 00035100
*              alignment of the parameter list. Use only 0F or 0D.    * 00035200
*              DEFAULT: 0D which forces the parameter list to a       * 00035300
*              doubleword boundary.                                   * 00035400
*                                                                     * 00035500
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00035600
*              specifies the modify form of the macro.  The "M" form  * 00035700
*              generates code to put the parameters into the          * 00035800
*              parameter list specified by xmfctrl.                   * 00035900
*                                                                     * 00036000
*            ,xmfctrl                                                 * 00036100
*              is a required input.  It is the name (RS-type), or     * 00036200
*              address in register (1)-(12), of a storage area for    * 00036300
*              the parameter list.                                    * 00036400
*                                                                     * 00036500
*            »,COMPLETE!NOCHECKº¨                                     * 00036600
*              is an optional keyword input which specifies the       * 00036700
*              degree of macro parameter syntax checking.             * 00036800
*              DEFAULT: COMPLETE                                      * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*              COMPLETE                                               * 00037200
*                  Checking for required macro keys is done and       * 00037300
*                  defaults are supplied for omitted optional         * 00037400
*                  parameters.  (See Macro Usage Note 2).             * 00037500
*                                                                     * 00037600
*              NOCHECK                                                * 00037700
*                  Checking for required macro keys is not done nor   * 00037800
*                  are defaults supplied for omitted optional         * 00037900
*                  parameters.                                        * 00038000
*                                                                     * 00038100
*                                                                     * 00038200
*                                                                     * 00038300
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00038400
*              specifies the execute form of the macro.  The "E" form * 00038500
*              generates code to put the parameters into the          * 00038600
*              parameter list specified by xmfctrl and invoke the     * 00038700
*              desired service.                                       * 00038800
*                                                                     * 00038900
*            ,xmfctrl                                                 * 00039000
*              is a required input.  It is the name (RS-type), or     * 00039100
*              address in register (1)-(12), of a storage area for    * 00039200
*              the parameter list.                                    * 00039300
*                                                                     * 00039400
*            »,COMPLETE!NOCHECKº                                      * 00039500
*              is an optional keyword input which specifies the       * 00039600
*              degree of macro parameter syntax checking.             * 00039700
*              DEFAULT: COMPLETE                                      * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*              COMPLETE                                               * 00040100
*                  Checking for required macro keys is done and       * 00040200
*                  defaults are supplied for omitted optional         * 00040300
*                  parameters.  (See Macro Usage Note 2).             * 00040400
*                                                                     * 00040500
*              NOCHECK                                                * 00040600
*                  Checking for required macro keys is not done nor   * 00040700
*                  are defaults supplied for omitted optional         * 00040800
*                  parameters.                                        * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*                                                                     * 00041300
*                                                                     * 00041400
*                                                                     * 00041500
*                                                                     * 00041600
*01* ABEND CODES:                                                     * 00041700
*                                                                     * 00041800
*                                                                     * 00041900
*       058       The IBM Health Checker for z/OS address space       * 00042000
*                 terminated while this call was in process.          * 00042100
*                                                                     * 00042200
*                                                                     * 00042300
*                                                                     * 00042400
*01* RETURN CODES:                                                    * 00042500
*                                                                     * 00042600
*                                                                     * 00042700
*                 Macro HZSZCONS provides equate symbols for the      * 00042800
*                 return and reason codes.                            * 00042900
*                                                                     * 00043000
*       0         Name: HzspwritRc_OK                                 * 00043100
*                                                                     * 00043200
*                 Meaning: The request was successfully processed.    * 00043300
*                                                                     * 00043400
*                 Action: None required                               * 00043500
*                                                                     * 00043600
*                                                                     * 00043700
*       8         Name: HzspwritRc_InvParm                            * 00043800
*                                                                     * 00043900
*                 Meaning:  HZSPWRIT request specified incorrect      * 00044000
*                 parameters.                                         * 00044100
*                                                                     * 00044200
*                 Action: Refer to action under the individual reason * 00044300
*                 code.                                               * 00044400
*                                                                     * 00044500
*                                                                     * 00044600
*                 HEX REASON  MEANING/ACTION                          * 00044700
*                 CODE                                                * 00044800
*                                                                     * 00044900
*                 xxxx0801    Name: HzspwritRsn_NotAuthorized         * 00045000
*                                                                     * 00045100
*                             Meaning: Caller is not authorized to    * 00045200
*                             write persistent data for this check    * 00045300
*                                                                     * 00045400
*                             Action: Avoid calling HZSPWRIT to write * 00045500
*                             data when not authorized.               * 00045600
*                                                                     * 00045700
*                 xxxx0808    Name: HzspwritRsn_BadENV                * 00045800
*                                                                     * 00045900
*                             Meaning:  HZSPWRIT is supported only    * 00046000
*                             when called within the HZS address      * 00046100
*                             space.                                  * 00046200
*                                                                     * 00046300
*                             Action: Invoke HZSPWRIT only within the * 00046400
*                             HZS address space.                      * 00046500
*                                                                     * 00046600
*                 xxxx0818    Name: HzspwritRsn_BadParmlist           * 00046700
*                                                                     * 00046800
*                             Meaning: Error accessing parameter      * 00046900
*                             list.                                   * 00047000
*                                                                     * 00047100
*                             Action: Make sure that the provided     * 00047200
*                             parameter list is valid.                * 00047300
*                                                                     * 00047400
*                 xxxx0843    Name: HzspwritRsn_SrbMode               * 00047500
*                                                                     * 00047600
*                             Meaning: SRB mode.                      * 00047700
*                                                                     * 00047800
*                             Action: Avoid issuing HZSPWRIT in SRB   * 00047900
*                             mode.                                   * 00048000
*                                                                     * 00048100
*                 xxxx0844    Name: HzspwritRsn_NotEnabled            * 00048200
*                                                                     * 00048300
*                             Meaning: Not Enabled.                   * 00048400
*                                                                     * 00048500
*                             Action: Avoid using HZSPWRIT when not   * 00048600
*                             enabled.                                * 00048700
*                                                                     * 00048800
*                 xxxx0845    Name: HzspwritRsn_Locked                * 00048900
*                                                                     * 00049000
*                             Meaning: Locked                         * 00049100
*                                                                     * 00049200
*                             Action: Avoid using HZSPWRIT when a     * 00049300
*                             lock is held.                           * 00049400
*                                                                     * 00049500
*                 xxxx0846    Name: HzspwritRsn_FRR                   * 00049600
*                                                                     * 00049700
*                             Meaning: The caller had an EUT FRR      * 00049800
*                             established.                            * 00049900
*                                                                     * 00050000
*                             Action: Avoid using HZSPWRIT when an    * 00050100
*                             EUT FRR is established.                 * 00050200
*                                                                     * 00050300
*                 xxxx0847    Name: HzspwritRsn_BadParmlistALET       * 00050400
*                                                                     * 00050500
*                             Meaning: Bad parameter list ALET.       * 00050600
*                                                                     * 00050700
*                             Action: Make sure that the ALET         * 00050800
*                             associated with the parameter list is   * 00050900
*                             valid. The access register might not    * 00051000
*                             have been set up correctly.             * 00051100
*                                                                     * 00051200
*                 xxxx0848    Name: HzspwritRsn_BadBufferALET         * 00051300
*                                                                     * 00051400
*                             Meaning: Bad buffer ALET.               * 00051500
*                                                                     * 00051600
*                             Action: Make sure that the ALET         * 00051700
*                             associated with the buffer is valid.    * 00051800
*                             The access register might not have been * 00051900
*                             set up correctly.                       * 00052000
*                                                                     * 00052100
*                 xxxx0849    Name: HzspwritRsn_BadBuffer             * 00052200
*                                                                     * 00052300
*                             Meaning: Error accessing buffer         * 00052400
*                                                                     * 00052500
*                             Action: Make sure that the provided     * 00052600
*                             buffer is valid.                        * 00052700
*                                                                     * 00052800
*                 xxxx0858    Name: HzspwritRsn_BadHandle             * 00052900
*                                                                     * 00053000
*                             Meaning: The handle provided with the   * 00053100
*                             HANDLE parameter is not valid.          * 00053200
*                                                                     * 00053300
*                             Action: Specify the handle that was     * 00053400
*                             returned by the HZSADDCK macro if this  * 00053500
*                             is a REMOTE=YES REXX=NO check.          * 00053600
*                                                                     * 00053700
*                 xxxx085A    Name: HzspwritRsn_WrongRemoteFunction   * 00053800
*                                                                     * 00053900
*                             Meaning: The check routine is not       * 00054000
*                             currently processing either the INITRUN * 00054100
*                             or the RUN remote function.             * 00054200
*                                                                     * 00054300
*                             Action: Avoid invoking HZSPWRIT for a   * 00054400
*                             remote check when not within the        * 00054500
*                             INITRUN or RUN function.                * 00054600
*                                                                     * 00054700
*                 xxxx085B    Name: HzspwritRsn_BadRemoteEnvironment  * 00054800
*                                                                     * 00054900
*                             Meaning: HZSPWRIT was invoked from a    * 00055000
*                             task other than the one that issued     * 00055100
*                             HZSCHECK REQUEST=OPSTART.               * 00055200
*                                                                     * 00055300
*                             Action: Avoid invoking HZSPWRIT from an * 00055400
*                             incorrect task.                         * 00055500
*                                                                     * 00055600
*                 xxxx0861    Name: HzspwritRsn_WrongFunction         * 00055700
*                                                                     * 00055800
*                             Meaning: The check routine is not       * 00055900
*                             currently processing either the INIT,   * 00056000
*                             CHECK, or CLEANUP function.             * 00056100
*                                                                     * 00056200
*                             Action: Avoid invoking HZSPWRIT for a   * 00056300
*                             local check when not within the INIT or * 00056400
*                             CHECK function.                         * 00056500
*                                                                     * 00056600
*                                                                     * 00056700
*                                                                     * 00056800
*                                                                     * 00056900
*       0C        Name: HzspwritRc_EnvError                           * 00057000
*                                                                     * 00057100
*                 Meaning: Environmental Error                        * 00057200
*                                                                     * 00057300
*                 Action: Refer to action under the individual reason * 00057400
*                 code.                                               * 00057500
*                                                                     * 00057600
*                                                                     * 00057700
*                 HEX REASON  MEANING/ACTION                          * 00057800
*                 CODE                                                * 00057900
*                                                                     * 00058000
*                 xxxx0C15    Name: HzspwritRsn_DataCorrupted         * 00058100
*                                                                     * 00058200
*                             Meaning: The persistent data being      * 00058300
*                             managed by the system for this check    * 00058400
*                             has been overlaid. It will not be       * 00058500
*                             written to the HZSPDATA data set.       * 00058600
*                                                                     * 00058700
*                             Action: Report the problem to the       * 00058800
*                             system programmer                       * 00058900
*                                                                     * 00059000
*                                                                     * 00059100
*                                                                     * 00059200
*                                                                     * 00059300
*       10        Name: HzspwritRc_CompError                          * 00059400
*                                                                     * 00059500
*                 Meaning: Component Error                            * 00059600
*                                                                     * 00059700
*                 Action: Refer to action under the individual reason * 00059800
*                 code.                                               * 00059900
*                                                                     * 00060000
*                                                                     * 00060100
*                 HEX REASON  MEANING/ACTION                          * 00060200
*                 CODE                                                * 00060300
*                                                                     * 00060400
*                 xxxx1001    Name: HzspwritRsn_IntError              * 00060500
*                                                                     * 00060600
*                             Meaning: Unexpected internal error      * 00060700
*                                                                     * 00060800
*                             Action: Report the problem to the       * 00060900
*                             system programmer                       * 00061000
*                                                                     * 00061100
*                                                                     * 00061200
*                                                                     * 00061300
*                                                                     * 00061400
*                                                                     * 00061500
*01* REASON CODES:                                                    * 00061600
*                                                                     * 00061700
*       Reason codes, as appropriate, are defined under their         * 00061800
*       corresponding return code.                                    * 00061900
*                                                                     * 00062000
*01* MODULE TYPE:  ASSEM MACRO                                        * 00062100
*                                                                     * 00062200
*02*   PROCESSOR:  ASSEM                                              * 00062300
*                                                                     * 00062400
*01* COMPONENT:  SCHZS                                                * 00062500
*                                                                     * 00062600
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00062700
*                                                                     * 00062800
*01* EXAMPLES:                                                        * 00062900
*                                                                     * 00063000
*    Example                                                          * 00063100
*                                                                     * 00063200
*    Operation:                                                       * 00063300
*                                                                     * 00063400
*                                                                     * 00063500
*        Write peristent data                                         * 00063600
*                                                                     * 00063700
*                                                                     * 00063800
*                                                                     * 00063900
*    The code is as follows.                                          * 00064000
*                                                                     * 00064100
*    *************************************************************    * 00064200
*    * Write data that is to persist                             *    * 00064300
*    *************************************************************    * 00064400
*             SYSSTATE ARCHLVL=2                                      * 00064500
*    *                                                                * 00064600
*    * Previous code would have saved data into area thebuff          * 00064700
*    * and saved the number of bytes to write in thelen               * 00064800
*    *                                                                * 00064900
*             HZSPWRIT BUFFER=thebuff,DATALEN=thelen,            *    * 00065000
*                   RETCODE=LRETCODE,RSNCODE=LRSNCODE,           *    * 00065100
*                   MF=(E,PWRITL)                                     * 00065200
*    *                                                                * 00065300
*    * Place code to check return/reason codes here                   * 00065400
*    *                                                                * 00065500
*             LTORG ,                                                 * 00065600
*             HZSZCONS ,            Return code information           * 00065700
*    DYNAREA  DSECT                                                   * 00065800
*    thelen   DS   F                Length of output buffer           * 00065900
*    LRETCODE DS   F                                                  * 00066000
*    LRSNCODE DS   F                                                  * 00066100
*             HZSPWRIT MF=(L,PWRITL),PLISTVER=MAX                     * 00066200
*             DS   0D                                                 * 00066300
*    thebuff  DS   8192X            Output buffer                     * 00066400
*                                                                     * 00066500
*                                                                     * 00066600
*01* MACRO USAGE NOTES:                                               * 00066700
*                                                                     * 00066800
*                                                                     * 00066900
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00067000
*        global macro variable.  Any value other than 'NO' will       * 00067100
*        result in the macro expansion being printed.  The default is * 00067200
*        'YES'.  The following examples illustrate how the ZPRINT     * 00067300
*        variable should be set.                                      * 00067400
*                                                                     * 00067500
*                    GBLC &ZPRINT                                     * 00067600
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00067700
*                                                                     * 00067800
*                                                                     * 00067900
*    2.  When using the NOCHECK option in conjunction with the Modify * 00068000
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00068100
*        Modify   or  Execute  form  invocation  which  specifies  or * 00068200
*        defaults  to  the  COMPLETE  option.   This insures that the * 00068300
*        parameter  list  is  initialized completely.   The parameter * 00068400
*        list  field which identifies the version number of the macro * 00068500
*        is only set when the Standard form or the Complete option of * 00068600
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00068700
*        explicitly  specified.  Be sure that the resulting parameter * 00068800
*        list version number covers all the keys that you use.        * 00068900
*                                                                     * 00069000
*                                                                     * 00069100
*    3.  All   keys   currently   contained  in  the  HZSPWRIT  macro * 00069200
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00069300
*        value of 0 or MAX.                                           * 00069400
*                                                                     * 00069500
*                                                                     * 00069600
*                                                                     * 00069700
*                                                                     * 00069800
*01* CHANGE ACTIVITY:                                                 * 00069900
*                                                                     * 00070000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00070100
*                                                                     * 00070200
*    $L0=INIT     HZS7720 040315 PD00ZP:                              * 00070300
*    $P1=ME01520  HZS7720 040929 PD00MP:  Clear AR15 when needed      * 00070400
*    $L1=HCR10    HBB7750 070101 PD00XB:  R10                         * 00070500
*    $L5=HCR12    HBB7770 100118 RD00UT:  Access register wording     * 00070600
****** END OF SPECIFICATIONS *****************************************/ 00070700
*/********************************************************************* 00070800
         MACRO                                                          00070900
&XLABEL  HZSPWRIT &BUFFER=,&DATALEN=,&SECCHECK=,&REMOTE=,&HANDLE=,     *00071000
               &REXX=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=               00071100
.*                                                                      00071200
*              MACDATE -07/10/15-<0>                                    00071300
.*                                                                      00071400
.*******************************************************************    00071500
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00071600
.*******************************************************************    00071700
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00071800
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00071900
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00072000
.*                                                                      00072100
              GBLC  &ZHZSPWRIT  YES=MACRO USED AT LEAST ONCE            00072200
.*******************************************************************    00072300
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00072400
.*******************************************************************    00072500
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00072600
              LCLC  &ZCNDX      SYSNDX CHARACTERS                       00072700
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00072800
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00072900
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00073000
              LCLA  &ZAWRK      USED AS A WORK AREA                     00073100
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00073200
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00073300
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00073400
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00073500
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00073600
              LCLC  &ZMAC_G     "G" or null                             00073700
&ZMAC_G       SETC  ''                                                  00073800
              LCLC  &ZMAC_LR                                            00073900
&ZMAC_LR      SETC  'LR'                                                00074000
              LCLC  &ZMAC_L                                             00074100
&ZMAC_L       SETC  'L'                                                 00074200
              LCLC  &ZMAC_ST                                            00074300
&ZMAC_ST      SETC  'ST'                                                00074400
              LCLC  &ZMAC_LLGT                                          00074500
&ZMAC_LLGT    SETC  'L'                                                 00074600
              LCLC  &ZMAC_LGR                                           00074700
&ZMAC_LGR     SETC  'LR'                                                00074800
              LCLC  &ZMAC_LG                                            00074900
&ZMAC_LG      SETC  'L'                                                 00075000
              LCLC  &ZMAC_STG                                           00075100
&ZMAC_STG     SETC  'ST'                                                00075200
              LCLA  &ZMACRET    MACRO RETURN CODE                       00075300
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00075400
.*                                                                      00075500
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00075600
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00075700
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00075800
              LCLC  &ZENDBASEPL                 End of base PL          00075900
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00076000
.*******************************************************************    00076100
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00076200
.*******************************************************************    00076300
              LCLA  &ZI         INDEX FOR ARRAY                         00076400
              LCLA  &ZJ         INDEX FOR PARMS                         00076500
              LCLA  &ZK         INDEX FOR PARSE                         00076600
              LCLA  &ZLO        LOW RANGE VALUE                         00076700
              LCLA  &ZHI        HIGH RANGE VALUE                        00076800
              LCLC  &ZW         WORK AREA FOR PARM                      00076900
.********************************************************************   00077000
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00077100
.********************************************************************   00077200
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00077300
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00077400
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00077500
              GBLC  &SYSAM64    SYSSTATE AMODE64                        00077600
.*                                                                      00077700
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00077800
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00077900
              SPLEVEL  TEST                                             00078000
.ZSYS2        ANOP  ,                                                   00078100
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00078200
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00078300
              SYSSTATE TEST                                             00078400
              AGO   .ZSYS4                                              00078500
.ZSYS3        ANOP  ,                                                   00078600
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00078700
.ZSYS4        ANOP  ,                                                   00078800
              AIF   ('&SYSAM64' NE 'YES').ZSYSN64                       00078900
&ZMAC_LLGT    SETC 'LLGT'                                               00079000
&ZMAC_LGR     SETC 'LGR'                                                00079100
&ZMAC_LG      SETC 'LG'                                                 00079200
&ZMAC_STG     SETC 'STG'                                                00079300
.ZSYSN64      ANOP  ,                                                   00079400
.*******************************************************************    00079500
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00079600
.*******************************************************************    00079700
              LCLC  &XBUFFER    ++ NAME                                 00079800
              LCLC  &XDATALEN   ++ NAME                                 00079900
              LCLC  &XSECCHECK  ++ VALUE                                00080000
              LCLC  &XREMOTE    ++ VALUE                                00080100
              LCLC  &XHANDLE    ++ NAME                                 00080200
              LCLC  &XREXX      ++ VALUE                                00080300
              LCLC  &XRETCODE   ++ NAME                                 00080400
              LCLC  &XRSNCODE   ++ NAME                                 00080500
              LCLA  &XPLISTVER  ++ VALUE                                00080600
              LCLC  &XMF        ++ VALUE                                00080700
              LCLC  &XMFCTRL    ++ NAME                                 00080800
              LCLC  &XMFATTR    ++ VALUE                                00080900
              LCLC  &XMFSCK     ++ VALUE                                00081000
.*******************************************************************    00081100
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00081200
.*******************************************************************    00081300
              LCLC  &ZXBUFFER   ++ INPUT NAME                           00081400
              LCLC  &ZXDATALEN  ++ INPUT NAME                           00081500
              LCLC  &ZXSECCHECK                 ++ INPUT VALUE          00081600
              LCLC  &ZXREMOTE   ++ INPUT VALUE                          00081700
              LCLC  &ZXHANDLE   ++ INPUT NAME                           00081800
              LCLC  &ZXREXX     ++ INPUT VALUE                          00081900
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00082000
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00082100
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00082200
              LCLC  &ZXMF       ++ INPUT VALUE                          00082300
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00082400
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00082500
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00082600
.********************************************************************   00082700
.***AC.PLV01  PROCESS PLISTVER                                      *   00082800
.********************************************************************   00082900
&XPLISTVER      SETA  0                                                 00083000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00083100
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00083200
&XPLISTVER      SETA  0                                                 00083300
.ZPLV0          ANOP  ,                                                 00083400
.*                                                                      00083500
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00083600
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00083700
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00083800
.*-------------------------------------------------------------------   00083900
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00084000
&ZMS            SETC  '"PLISTVER='                                      00084100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00084200
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00084300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00084400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00084500
                AGO   .ZPVCK2                                           00084600
.ZPVCK3         ANOP  ,                                                 00084700
.*-------------------------------------------------------------------   00084800
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00084900
&ZMS            SETC  '"PLISTVER='                                      00085000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00085100
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00085200
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00085300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00085400
                AGO   .ZPVCKE                                           00085500
.ZPVCK2         ANOP  ,                                                 00085600
.*-------------------------------------------------------------------   00085700
&ZCVAL          SETC  '&PLISTVER(1)'                                    00085800
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00085900
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00086000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00086100
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00086200
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00086300
.ZPVCK6         ANOP  ,                                                 00086400
&ZMS            SETC  '"PLISTVER='                                      00086500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00086600
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00086700
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00086800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00086900
&XPLISTVER      SETA  0                                                 00087000
                AGO   .ZPVCKE                                           00087100
.*-------------------------------------------------------------------   00087200
.ZPVCK4A        ANOP  ,                                                 00087300
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00087400
&ZMS            SETC  'PLISTVER='                                       00087500
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00087600
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00087700
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00087800
                MNOTE 8,' &ZMS IS REQUIRED.'                            00087900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00088000
                AGO   .ZPVCK5                                           00088100
.ZPVCK4         ANOP  ,                                                 00088200
&XPLISTVER      SETA  &PLISTVER(1)                                      00088300
.ZPVCK5         ANOP  ,                                                 00088400
.ZPVCKE         ANOP  ,                                                 00088500
.********************************************************************   00088600
.***AG.MF01 PROCESS MF MACRO FORMS                                      00088700
.********************************************************************   00088800
              ACTR  10000                                               00088900
.*------------------------------------------------------------------    00089000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089100
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00089200
.*-------------------------------------------------------------------   00089300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089400
.ZG36         ANOP  ,                                                   00089500
&ZTLC         SETC 'S'                                                  00089600
              AIF   ('&MF(1)' NE '&ZTLC').ZG37                          00089700
&XMF          SETC  'S'         SET KEYWORD                             00089800
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00089900
              AIF   (N'&MF LE 1).ZG36A          CK NUM                  00090000
&ZMS          SETC  '"MF='                                              00090100
&ZMS          SETC  '&ZMS.&MF"'                                         00090200
&ZMS          SETC  '&ZMS "MF"'                                         00090300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00090400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00090500
.ZG36A        ANOP  ,                                                   00090600
.*-------------------------------------------------------------------   00090700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090800
.ZG37         ANOP  ,                                                   00090900
&ZTLC         SETC 'L'                                                  00091000
              AIF   ('&MF(1)' NE '&ZTLC').ZG44                          00091100
&XMF          SETC  'L'         SET KEYWORD                             00091200
              AIF   (N'&MF LE 3).ZG37A          CK NUM                  00091300
&ZMS          SETC  '"MF='                                              00091400
&ZMS          SETC  '&ZMS.&MF"'                                         00091500
&ZMS          SETC  '&ZMS "MF"'                                         00091600
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00091700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00091800
.ZG37A        ANOP  ,                                                   00091900
.*-------------------------------------------------------------------   00092000
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00092100
              AIF   (N'&SYSLIST NE 0).ZG37B     POSITIONALS?            00092200
              AIF   ('&BUFFER' NE '').ZG37B     KEYS?                   00092300
              AIF   ('&DATALEN' NE '').ZG37B    KEYS?                   00092400
              AIF   ('&SECCHECK' NE '').ZG37B   KEYS?                   00092500
              AIF   ('&REMOTE' NE '').ZG37B     KEYS?                   00092600
              AIF   ('&HANDLE' NE '').ZG37B     KEYS?                   00092700
              AIF   ('&REXX' NE '').ZG37B       KEYS?                   00092800
              AIF   ('&RETCODE' NE '').ZG37B    KEYS?                   00092900
              AIF   ('&RSNCODE' NE '').ZG37B    KEYS?                   00093000
              AGO    .ZG37C     INVOCATION OKAY                         00093100
.ZG37B        ANOP  ,                                                   00093200
&ZMS          SETC  'THE "L" FORM OF "MF"'                              00093300
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00093400
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00093500
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00093600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093700
.ZG37C        ANOP  ,                                                   00093800
.*-------------------------------------------------------------------   00093900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00094000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00094100
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00094200
              AIF   (N'&MF(2) GT 1).ZG39B       MULTI                   00094300
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00094400
.ZG39B        AIF   (K'&MF(2) GT 0).ZG39C                               00094500
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00094600
&ZMS          SETC  'WHEN "L" IS SPECIFIED'                             00094700
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00094800
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00094900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00095000
.ZG39C        ANOP  ,                                                   00095100
.*-------------------------------------------------------------------   00095200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00095300
              AIF   (K'&ZXMFCTRL LE 0).ZG39P    NOT I/O                 00095400
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG39P                      00095500
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00095600
&ZMS          SETC  '"MF='                                              00095700
&ZMS          SETC  '&ZMS.&MF"'                                         00095800
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00095900
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00096000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00096100
.ZG39P        ANOP  ,                                                   00096200
.*-------------------------------------------------------------------   00096300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00096400
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00096500
&XMFATTR      SETC  '0D'                                                00096600
              AIF   (K'&MF(3) LE 0).ZG42B       PARM                    00096700
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00096800
              AIF   (N'&MF(3) GT 1).ZG42B       MULTI                   00096900
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00097000
.ZG42B        ANOP  ,                                                   00097100
.*-------------------------------------------------------------------   00097200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00097300
              AIF   (K'&ZXMFATTR LE 0).ZG42P    NOT I/O                 00097400
              AIF   ('&XMFATTR'(1,1) NE '(').ZG42P                      00097500
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00097600
&ZMS          SETC  '"MF='                                              00097700
&ZMS          SETC  '&ZMS.&MF"'                                         00097800
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00097900
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00098000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00098100
.ZG42P        ANOP  ,                                                   00098200
.*-------------------------------------------------------------------   00098300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00098400
              AIF   (K'&ZXMFATTR LE 0).ZG42S    NOT I/O                 00098500
              AIF   (K'&XMFATTR LE 60).ZG42S    LNG OK                  00098600
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00098700
&ZMS          SETC  '"MF='                                              00098800
&ZMS          SETC  '&ZMS.&MF"'                                         00098900
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00099000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00099100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00099200
.ZG42S        ANOP  ,                                                   00099300
.*-------------------------------------------------------------------   00099400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00099500
.ZG44         ANOP  ,                                                   00099600
&ZTLC         SETC 'M'                                                  00099700
              AIF   ('&MF(1)' NE '&ZTLC').ZG53                          00099800
&XMF          SETC  'M'         SET KEYWORD                             00099900
              AIF   (N'&MF LE 3).ZG44A          CK NUM                  00100000
&ZMS          SETC  '"MF='                                              00100100
&ZMS          SETC  '&ZMS.&MF"'                                         00100200
&ZMS          SETC  '&ZMS "MF"'                                         00100300
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00100400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00100500
.ZG44A        ANOP  ,                                                   00100600
.*-------------------------------------------------------------------   00100700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00100800
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00100900
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00101000
              AIF   (N'&MF(2) GT 1).ZG46B       MULTI                   00101100
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00101200
.ZG46B        AIF   (K'&MF(2) GT 0).ZG46C                               00101300
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00101400
&ZMS          SETC  'WHEN "M" IS SPECIFIED'                             00101500
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00101600
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00101700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101800
.ZG46C        ANOP  ,                                                   00101900
.*-------------------------------------------------------------------   00102000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00102100
              AIF   (K'&ZXMFCTRL LE 0).ZG46R    NOT I/O                 00102200
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG46R                      00102300
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00102400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG46P                        00102500
              AIF   (K'&ZCGPR GT 2).ZG46Q                               00102600
              AIF   ('&ZCGPR' EQ '0').ZG46Q                             00102700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00102800
              AIF   (T'&ZCGPR NE 'N').ZG46Q     INVALID REG NAME        00102900
.ZG46P        ANOP  ,                                                   00103000
              AIF   (T'&ZCGPR NE 'N').ZG46R     NON NUMERIC             00103100
              AIF   ('&ZCGPR' LT '1').ZG46Q                             00103200
              AIF   ('&ZCGPR' LE '12').ZG46R                            00103300
.ZG46Q        ANOP  ,                                                   00103400
&ZMS          SETC  '"MF='                                              00103500
&ZMS          SETC  '&ZMS.&MF"'                                         00103600
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00103700
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00103800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00103900
.ZG46R        ANOP  ,                                                   00104000
.*-------------------------------------------------------------------   00104100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00104200
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00104300
.ZG50A   AIF   ('&MF(3)' NE 'COMPLETE').ZG51A                           00104400
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00104500
.*-------------------------------------------------------------------   00104600
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00104700
.ZG51A   AIF   ('&MF(3)' NE 'NOCHECK').ZG52A                            00104800
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00104900
.*-------------------------------------------------------------------   00105000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00105100
.ZG52A        AIF   (K'&XMFSCK GT 0).ZG52C      KEYWORD                 00105200
              AIF   (K'&MF(3) LE 0).ZG52B                               00105300
&ZMS          SETC  '"MF='                                              00105400
&ZMS          SETC  '&ZMS.&MF"'                                         00105500
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00105600
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00105700
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00105800
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00105900
              MNOTE 8,' &ZMS '                                          00106000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00106100
.ZG52B        ANOP  ,                                                   00106200
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00106300
.ZG52C        ANOP  ,                                                   00106400
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00106500
.*-------------------------------------------------------------------   00106600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00106700
.ZG53         ANOP  ,                                                   00106800
&ZTLC         SETC 'E'                                                  00106900
              AIF   ('&MF(1)' NE '&ZTLC').ZG62                          00107000
&XMF          SETC  'E'         SET KEYWORD                             00107100
              AIF   (N'&MF LE 3).ZG53A          CK NUM                  00107200
&ZMS          SETC  '"MF='                                              00107300
&ZMS          SETC  '&ZMS.&MF"'                                         00107400
&ZMS          SETC  '&ZMS "MF"'                                         00107500
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00107600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107700
.ZG53A        ANOP  ,                                                   00107800
.*-------------------------------------------------------------------   00107900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00108000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00108100
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00108200
              AIF   (N'&MF(2) GT 1).ZG55B       MULTI                   00108300
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00108400
.ZG55B        AIF   (K'&MF(2) GT 0).ZG55C                               00108500
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00108600
&ZMS          SETC  'WHEN "E" IS SPECIFIED'                             00108700
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00108800
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00108900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00109000
.ZG55C        ANOP  ,                                                   00109100
.*-------------------------------------------------------------------   00109200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00109300
              AIF   (K'&ZXMFCTRL LE 0).ZG55R    NOT I/O                 00109400
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG55R                      00109500
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00109600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG55P                        00109700
              AIF   (K'&ZCGPR GT 2).ZG55Q                               00109800
              AIF   ('&ZCGPR' EQ '0').ZG55Q                             00109900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00110000
              AIF   (T'&ZCGPR NE 'N').ZG55Q     INVALID REG NAME        00110100
.ZG55P        ANOP  ,                                                   00110200
              AIF   (T'&ZCGPR NE 'N').ZG55R     NON NUMERIC             00110300
              AIF   ('&ZCGPR' LT '1').ZG55Q                             00110400
              AIF   ('&ZCGPR' LE '12').ZG55R                            00110500
.ZG55Q        ANOP  ,                                                   00110600
&ZMS          SETC  '"MF='                                              00110700
&ZMS          SETC  '&ZMS.&MF"'                                         00110800
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00110900
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00111000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00111100
.ZG55R        ANOP  ,                                                   00111200
.*-------------------------------------------------------------------   00111300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00111400
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00111500
.ZG59A   AIF   ('&MF(3)' NE 'COMPLETE').ZG60A                           00111600
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00111700
.*-------------------------------------------------------------------   00111800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00111900
.ZG60A   AIF   ('&MF(3)' NE 'NOCHECK').ZG61A                            00112000
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00112100
.*-------------------------------------------------------------------   00112200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00112300
.ZG61A        AIF   (K'&XMFSCK GT 0).ZG61C      KEYWORD                 00112400
              AIF   (K'&MF(3) LE 0).ZG61B                               00112500
&ZMS          SETC  '"MF='                                              00112600
&ZMS          SETC  '&ZMS.&MF"'                                         00112700
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00112800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00112900
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00113000
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00113100
              MNOTE 8,' &ZMS '                                          00113200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00113300
.ZG61B        ANOP  ,                                                   00113400
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00113500
.ZG61C        ANOP  ,                                                   00113600
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00113700
.*------------------------------------------------------------------    00113800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00113900
.ZG62         ANOP  ,                                                   00114000
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00114100
              AIF   (K'&XMF GT 0).ZG62E         VALID ARG               00114200
              AIF   (T'&MF EQ 'O').ZG62D        OMITTED                 00114300
&ZASYSLNDX    SETA  0                                                   00114400
.ZG62A        ANOP  ,           POSITIONAL MACRO KEY                    00114500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00114600
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG62C                    00114700
&ZTLC         SETC 'MF'                                                 00114800
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG62A           00114900
.ZG62B        ANOP  ,                                                   00115000
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00115100
&ZMS          SETC  'THE "MF" KEY'                                      00115200
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00115300
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00115400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00115500
              AGO   .ZG62E                                              00115600
.ZG62C        ANOP  ,                                                   00115700
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00115800
&ZMS          SETC  '"MF='                                              00115900
&ZMS          SETC  '&ZMS.&MF"'                                         00116000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00116100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00116200
&ZMS          SETC  '&ZMS "S",'                                         00116300
&ZMS          SETC  '&ZMS "L",'                                         00116400
&ZMS          SETC  '&ZMS "M",'                                         00116500
&ZMS          SETC  '&ZMS OR "E".'                                      00116600
              MNOTE 8,' &ZMS '                                          00116700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00116800
              AGO   .ZG62E                                              00116900
.ZG62D        ANOP  ,                                                   00117000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00117100
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00117200
.ZG62E        ANOP  ,                                                   00117300
.********************************************************************   00117400
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00117500
.********************************************************************   00117600
              ACTR  10000                                               00117700
.*-------------------------------------------------------------------   00117800
.***AG.MF03 MF=(SLME)                                                   00117900
              AIF   ('&XMF' EQ 'L').ZGMFX                               00118000
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00118100
.*----------------------------------------------------------------***   00118200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00118300
              AIF   (N'&BUFFER LE 1).ZG2A       CK NUM                  00118400
&ZMS          SETC  '"BUFFER='                                          00118500
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00118600
&ZMS          SETC  '&ZMS "BUFFER"'                                     00118700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00118800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00118900
.ZG2A         ANOP  ,                                                   00119000
.*-------------------------------------------------------------------   00119100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00119200
&ZXBUFFER     SETC  'INPUT'     SET IN/OUTPUT                           00119300
&XBUFFER      SETC  '&BUFFER(1)'                SET XVARIABLE           00119400
              AIF   (N'&BUFFER GT 1).ZG2B       MULTI                   00119500
&XBUFFER      SETC  '&BUFFER'   SET XVARIABLE                           00119600
.ZG2B         AIF   (K'&BUFFER(1) GT 0).ZG2C                            00119700
&ZXBUFFER     SETC  ''          RESET IN/OUTPUT                         00119800
&ZMS          SETC  ' '                                                 00119900
&ZMS          SETC  '&ZMS "BUFFER" KEY AND ITS'                         00120000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00120100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00120200
.ZG2C         ANOP  ,                                                   00120300
.*-------------------------------------------------------------------   00120400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00120500
              AIF   (K'&ZXBUFFER LE 0).ZG2R     NOT I/O                 00120600
              AIF   ('&XBUFFER'(1,1) NE '(').ZG2R                       00120700
&ZCGPR        SETC  '&XBUFFER'(2,K'&XBUFFER-2)                          00120800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                         00120900
              AIF   (K'&ZCGPR GT 2).ZG2Q                                00121000
              AIF   ('&ZCGPR' EQ '0').ZG2Q                              00121100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00121200
              AIF   (T'&ZCGPR NE 'N').ZG2Q      INVALID REG NAME        00121300
.ZG2P         ANOP  ,                                                   00121400
              AIF   (T'&ZCGPR NE 'N').ZG2R      NON NUMERIC             00121500
              AIF   ('&ZCGPR' LT '2').ZG2Q                              00121600
              AIF   ('&ZCGPR' LE '12').ZG2R                             00121700
.ZG2Q         ANOP  ,                                                   00121800
&ZMS          SETC  '"BUFFER='                                          00121900
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00122000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00122100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00122200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122300
.ZG2R         ANOP  ,                                                   00122400
.*----------------------------------------------------------------***   00122500
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00122600
              AIF   (N'&DATALEN LE 1).ZG5A      CK NUM                  00122700
&ZMS          SETC  '"DATALEN='                                         00122800
&ZMS          SETC  '&ZMS.&DATALEN"'                                    00122900
&ZMS          SETC  '&ZMS "DATALEN"'                                    00123000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00123100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00123200
.ZG5A         ANOP  ,                                                   00123300
.*-------------------------------------------------------------------   00123400
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00123500
&ZXDATALEN    SETC  'INPUT'     SET IN/OUTPUT                           00123600
&XDATALEN     SETC  '&DATALEN(1)'               SET XVARIABLE           00123700
              AIF   (N'&DATALEN GT 1).ZG5B      MULTI                   00123800
&XDATALEN     SETC  '&DATALEN'  SET XVARIABLE                           00123900
.ZG5B         AIF   (K'&DATALEN(1) GT 0).ZG5C                           00124000
&ZXDATALEN    SETC  ''          RESET IN/OUTPUT                         00124100
&ZMS          SETC  ' '                                                 00124200
&ZMS          SETC  '&ZMS "DATALEN" KEY AND ITS'                        00124300
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00124400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00124500
.ZG5C         ANOP  ,                                                   00124600
.*-------------------------------------------------------------------   00124700
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00124800
              AIF   (K'&ZXDATALEN LE 0).ZG5R    NOT I/O                 00124900
              AIF   ('&XDATALEN'(1,1) NE '(').ZG5R                      00125000
&ZCGPR        SETC  '&XDATALEN'(2,K'&XDATALEN-2)                        00125100
              AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                         00125200
              AIF   (K'&ZCGPR GT 2).ZG5Q                                00125300
              AIF   ('&ZCGPR' EQ '0').ZG5Q                              00125400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00125500
              AIF   (T'&ZCGPR NE 'N').ZG5Q      INVALID REG NAME        00125600
.ZG5P         ANOP  ,                                                   00125700
              AIF   (T'&ZCGPR NE 'N').ZG5R      NON NUMERIC             00125800
              AIF   ('&ZCGPR' LT '2').ZG5Q                              00125900
              AIF   ('&ZCGPR' LE '12').ZG5R                             00126000
.ZG5Q         ANOP  ,                                                   00126100
&ZMS          SETC  '"DATALEN='                                         00126200
&ZMS          SETC  '&ZMS.&DATALEN"'                                    00126300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00126400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00126500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126600
.ZG5R         ANOP  ,                                                   00126700
.*------------------------------------------------------------------    00126800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00126900
&XSECCHECK    SETC  ''          INITIALIZE XVARIABLE                    00127000
.*-------------------------------------------------------------------   00127100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00127200
.ZG9          ANOP  ,                                                   00127300
              AIF   (K'&SECCHECK(1) LE 0).ZG9A                          00127400
&ZTLC         SETC 'UNAUTH'                                             00127500
              AIF   ('&SECCHECK(1)' NE '&ZTLC').ZG10                    00127600
&XSECCHECK    SETC  'UNAUTH'    SET KEYWORD                             00127700
              AIF   (N'&SECCHECK LE 1).ZG9A     CK NUM                  00127800
&ZMS          SETC  '"SECCHECK='                                        00127900
&ZMS          SETC  '&ZMS.&SECCHECK"'                                   00128000
&ZMS          SETC  '&ZMS "SECCHECK"'                                   00128100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00128200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00128300
.ZG9A         ANOP  ,                                                   00128400
.*-------------------------------------------------------------------   00128500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00128600
.ZG10         ANOP  ,                                                   00128700
&ZTLC         SETC 'ALL'                                                00128800
              AIF   ('&SECCHECK(1)' NE '&ZTLC').ZG11                    00128900
&XSECCHECK    SETC  'ALL'       SET KEYWORD                             00129000
              AIF   (N'&SECCHECK LE 1).ZG10A    CK NUM                  00129100
&ZMS          SETC  '"SECCHECK='                                        00129200
&ZMS          SETC  '&ZMS.&SECCHECK"'                                   00129300
&ZMS          SETC  '&ZMS "SECCHECK"'                                   00129400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00129500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00129600
.ZG10A        ANOP  ,                                                   00129700
.*------------------------------------------------------------------    00129800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00129900
.ZG11         ANOP  ,                                                   00130000
&ZXSECCHECK   SETC  'INPUT'     SET IN/OUTPUT                           00130100
              AIF   (K'&XSECCHECK GT 0).ZG11E   VALID ARG               00130200
              AIF   (T'&SECCHECK EQ 'O').ZG11D  OMITTED                 00130300
&ZASYSLNDX    SETA  0                                                   00130400
.ZG11A        ANOP  ,           POSITIONAL MACRO KEY                    00130500
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00130600
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG11C                    00130700
&ZTLC         SETC 'SECCHECK'                                           00130800
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG11A           00130900
.ZG11B        ANOP  ,                                                   00131000
&ZXSECCHECK   SETC  ''          RESET IN/OUTPUT                         00131100
&ZMS          SETC  'THE "SECCHECK" KEY'                                00131200
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00131300
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00131400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131500
              AGO   .ZG11E                                              00131600
.ZG11C        ANOP  ,                                                   00131700
&ZXSECCHECK   SETC  ''          RESET IN/OUTPUT                         00131800
&ZMS          SETC  '"SECCHECK='                                        00131900
&ZMS          SETC  '&ZMS.&SECCHECK"'                                   00132000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00132100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00132200
&ZMS          SETC  '&ZMS "UNAUTH"'                                     00132300
&ZMS          SETC  '&ZMS OR "ALL".'                                    00132400
              MNOTE 8,' &ZMS '                                          00132500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00132600
              AGO   .ZG11E                                              00132700
.ZG11D        ANOP  ,                                                   00132800
&XSECCHECK    SETC  'UNAUTH'    SET DEFAULT KEYWORD                     00132900
.ZG11E        ANOP  ,                                                   00133000
.*------------------------------------------------------------------    00133100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00133200
&XREMOTE      SETC  ''          INITIALIZE XVARIABLE                    00133300
.*-------------------------------------------------------------------   00133400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00133500
.ZG14         ANOP  ,                                                   00133600
              AIF   (K'&REMOTE(1) LE 0).ZG14A                           00133700
&ZTLC         SETC 'NO'                                                 00133800
              AIF   ('&REMOTE(1)' NE '&ZTLC').ZG15                      00133900
&XREMOTE      SETC  'NO'        SET KEYWORD                             00134000
              AIF   (N'&REMOTE LE 1).ZG14A      CK NUM                  00134100
&ZMS          SETC  '"REMOTE='                                          00134200
&ZMS          SETC  '&ZMS.&REMOTE"'                                     00134300
&ZMS          SETC  '&ZMS "REMOTE"'                                     00134400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00134500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00134600
.ZG14A        ANOP  ,                                                   00134700
.*------------------------------------------------------------------    00134800
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00134900
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00135000
.ZG14A0       AIF   (K'&HANDLE LE 0).ZG14A1     OK                      00135100
&ZCVAL        SETC '&ZCVAL HANDLE'              INCORRECT KEY USED      00135200
.ZG14A1       AIF   (K'&REXX LE 0).ZG14A2       OK                      00135300
&ZCVAL        SETC '&ZCVAL REXX'                INCORRECT KEY USED      00135400
.ZG14A2       AIF   (K'&ZCVAL LE 0).ZG14A3      OK                      00135500
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00135600
&ZMS          SETC  '"REMOTE'                                           00135700
&ZMS          SETC  '&ZMS.=&REMOTE"'                                    00135800
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00135900
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00136000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00136100
.ZG14A3       ANOP  ,                                                   00136200
.*-------------------------------------------------------------------   00136300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00136400
.ZG15         ANOP  ,                                                   00136500
&ZTLC         SETC 'YES'                                                00136600
              AIF   ('&REMOTE(1)' NE '&ZTLC').ZG24                      00136700
&XREMOTE      SETC  'YES'       SET KEYWORD                             00136800
              AIF   (N'&REMOTE LE 1).ZG15A      CK NUM                  00136900
&ZMS          SETC  '"REMOTE='                                          00137000
&ZMS          SETC  '&ZMS.&REMOTE"'                                     00137100
&ZMS          SETC  '&ZMS "REMOTE"'                                     00137200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00137300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00137400
.ZG15A        ANOP  ,                                                   00137500
.*----------------------------------------------------------------***   00137600
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00137700
              AIF   (N'&HANDLE LE 1).ZG17A      CK NUM                  00137800
&ZMS          SETC  '"HANDLE='                                          00137900
&ZMS          SETC  '&ZMS.&HANDLE"'                                     00138000
&ZMS          SETC  '&ZMS "HANDLE"'                                     00138100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00138200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00138300
.ZG17A        ANOP  ,                                                   00138400
.*-------------------------------------------------------------------   00138500
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00138600
&ZXHANDLE     SETC  'INPUT'     SET IN/OUTPUT                           00138700
&XHANDLE      SETC  '&HANDLE(1)'                SET XVARIABLE           00138800
              AIF   (N'&HANDLE GT 1).ZG17B      MULTI                   00138900
&XHANDLE      SETC  '&HANDLE'   SET XVARIABLE                           00139000
.ZG17B        AIF   (K'&HANDLE(1) GT 0).ZG17C                           00139100
&ZXHANDLE     SETC  ''          RESET IN/OUTPUT                         00139200
&ZMS          SETC  'WHEN "YES" IS SPECIFIED'                           00139300
&ZMS          SETC  '&ZMS , "HANDLE" KEY AND ITS'                       00139400
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00139500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00139600
.ZG17C        ANOP  ,                                                   00139700
.*-------------------------------------------------------------------   00139800
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00139900
              AIF   (K'&ZXHANDLE LE 0).ZG17R    NOT I/O                 00140000
              AIF   ('&XHANDLE'(1,1) NE '(').ZG17R                      00140100
&ZCGPR        SETC  '&XHANDLE'(2,K'&XHANDLE-2)                          00140200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                        00140300
              AIF   (K'&ZCGPR GT 2).ZG17Q                               00140400
              AIF   ('&ZCGPR' EQ '0').ZG17Q                             00140500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00140600
              AIF   (T'&ZCGPR NE 'N').ZG17Q     INVALID REG NAME        00140700
.ZG17P        ANOP  ,                                                   00140800
              AIF   (T'&ZCGPR NE 'N').ZG17R     NON NUMERIC             00140900
              AIF   ('&ZCGPR' LT '2').ZG17Q                             00141000
              AIF   ('&ZCGPR' LE '12').ZG17R                            00141100
.ZG17Q        ANOP  ,                                                   00141200
&ZMS          SETC  '"HANDLE='                                          00141300
&ZMS          SETC  '&ZMS.&HANDLE"'                                     00141400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00141500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00141600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141700
.ZG17R        ANOP  ,                                                   00141800
.*------------------------------------------------------------------    00141900
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142000
&XREXX        SETC  ''          INITIALIZE XVARIABLE                    00142100
.*-------------------------------------------------------------------   00142200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00142300
.ZG21         ANOP  ,                                                   00142400
              AIF   (K'&REXX(1) LE 0).ZG21A                             00142500
&ZTLC         SETC 'NO'                                                 00142600
              AIF   ('&REXX(1)' NE '&ZTLC').ZG22                        00142700
&XREXX        SETC  'NO'        SET KEYWORD                             00142800
              AIF   (N'&REXX LE 1).ZG21A        CK NUM                  00142900
&ZMS          SETC  '"REXX='                                            00143000
&ZMS          SETC  '&ZMS.&REXX"'                                       00143100
&ZMS          SETC  '&ZMS "REXX"'                                       00143200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00143300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00143400
.ZG21A        ANOP  ,                                                   00143500
.*-------------------------------------------------------------------   00143600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00143700
.ZG22         ANOP  ,                                                   00143800
&ZTLC         SETC 'YES'                                                00143900
              AIF   ('&REXX(1)' NE '&ZTLC').ZG23                        00144000
&XREXX        SETC  'YES'       SET KEYWORD                             00144100
              AIF   (N'&REXX LE 1).ZG22A        CK NUM                  00144200
&ZMS          SETC  '"REXX='                                            00144300
&ZMS          SETC  '&ZMS.&REXX"'                                       00144400
&ZMS          SETC  '&ZMS "REXX"'                                       00144500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00144600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00144700
.ZG22A        ANOP  ,                                                   00144800
.*------------------------------------------------------------------    00144900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145000
.ZG23         ANOP  ,                                                   00145100
&ZXREXX       SETC  'INPUT'     SET IN/OUTPUT                           00145200
              AIF   (K'&XREXX GT 0).ZG23E       VALID ARG               00145300
              AIF   (T'&REXX EQ 'O').ZG23D      OMITTED                 00145400
&ZASYSLNDX    SETA  0                                                   00145500
.ZG23A        ANOP  ,           POSITIONAL MACRO KEY                    00145600
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00145700
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG23C                    00145800
&ZTLC         SETC 'REXX'                                               00145900
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG23A           00146000
.ZG23B        ANOP  ,                                                   00146100
&ZXREXX       SETC  ''          RESET IN/OUTPUT                         00146200
&ZMS          SETC  'THE "REXX" KEY'                                    00146300
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00146400
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00146500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00146600
              AGO   .ZG23E                                              00146700
.ZG23C        ANOP  ,                                                   00146800
&ZXREXX       SETC  ''          RESET IN/OUTPUT                         00146900
&ZMS          SETC  '"REXX='                                            00147000
&ZMS          SETC  '&ZMS.&REXX"'                                       00147100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00147200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00147300
&ZMS          SETC  '&ZMS "NO"'                                         00147400
&ZMS          SETC  '&ZMS OR "YES".'                                    00147500
              MNOTE 8,' &ZMS '                                          00147600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00147700
              AGO   .ZG23E                                              00147800
.ZG23D        ANOP  ,                                                   00147900
&XREXX        SETC  'NO'        SET DEFAULT KEYWORD                     00148000
.ZG23E        ANOP  ,                                                   00148100
.*------------------------------------------------------------------    00148200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00148300
.ZG24         ANOP  ,                                                   00148400
&ZXREMOTE     SETC  'INPUT'     SET IN/OUTPUT                           00148500
              AIF   (K'&XREMOTE GT 0).ZG24E     VALID ARG               00148600
              AIF   (T'&REMOTE EQ 'O').ZG24D    OMITTED                 00148700
&ZASYSLNDX    SETA  0                                                   00148800
.ZG24A        ANOP  ,           POSITIONAL MACRO KEY                    00148900
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00149000
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG24C                    00149100
&ZTLC         SETC 'REMOTE'                                             00149200
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG24A           00149300
.ZG24B        ANOP  ,                                                   00149400
&ZXREMOTE     SETC  ''          RESET IN/OUTPUT                         00149500
&ZMS          SETC  'THE "REMOTE" KEY'                                  00149600
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00149700
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00149800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149900
              AGO   .ZG24E                                              00150000
.ZG24C        ANOP  ,                                                   00150100
&ZXREMOTE     SETC  ''          RESET IN/OUTPUT                         00150200
&ZMS          SETC  '"REMOTE='                                          00150300
&ZMS          SETC  '&ZMS.&REMOTE"'                                     00150400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00150500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00150600
&ZMS          SETC  '&ZMS "NO"'                                         00150700
&ZMS          SETC  '&ZMS OR "YES".'                                    00150800
              MNOTE 8,' &ZMS '                                          00150900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151000
              AGO   .ZG24E                                              00151100
.ZG24D        ANOP  ,                                                   00151200
&XREMOTE      SETC  'NO'        SET DEFAULT KEYWORD                     00151300
.ZG24E        ANOP  ,                                                   00151400
.*----------------------------------------------------------------***   00151500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00151600
              AIF   (N'&RETCODE LE 1).ZG26A     CK NUM                  00151700
&ZMS          SETC  '"RETCODE='                                         00151800
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00151900
&ZMS          SETC  '&ZMS "RETCODE"'                                    00152000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00152100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00152200
.ZG26A        ANOP  ,                                                   00152300
.*-------------------------------------------------------------------   00152400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00152500
              AIF   (K'&RETCODE(1) LE 0).ZG26C  NO PARM                 00152600
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00152700
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00152800
              AIF   (N'&RETCODE GT 1).ZG26C                             00152900
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00153000
.ZG26C        ANOP  ,                                                   00153100
.*-------------------------------------------------------------------   00153200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00153300
              AIF   (K'&ZXRETCODE LE 0).ZG26R   NOT I/O                 00153400
              AIF   ('&XRETCODE'(1,1) NE '(').ZG26R                     00153500
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00153600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        00153700
              AIF   (K'&ZCGPR GT 2).ZG26Q                               00153800
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             00153900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00154000
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        00154100
.ZG26P        ANOP  ,                                                   00154200
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             00154300
              AIF   ('&ZCGPR' EQ '15').ZG26R                            00154400
              AIF   ('&ZCGPR' LT '2').ZG26Q                             00154500
              AIF   ('&ZCGPR' LE '12').ZG26R                            00154600
.ZG26Q        ANOP  ,                                                   00154700
&ZMS          SETC  '"RETCODE='                                         00154800
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00154900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00155000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'            00155100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00155200
.ZG26R        ANOP  ,                                                   00155300
.*----------------------------------------------------------------***   00155400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00155500
              AIF   (N'&RSNCODE LE 1).ZG29A     CK NUM                  00155600
&ZMS          SETC  '"RSNCODE='                                         00155700
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00155800
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00155900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00156000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00156100
.ZG29A        ANOP  ,                                                   00156200
.*-------------------------------------------------------------------   00156300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00156400
              AIF   (K'&RSNCODE(1) LE 0).ZG29C  NO PARM                 00156500
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00156600
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00156700
              AIF   (N'&RSNCODE GT 1).ZG29C                             00156800
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00156900
.ZG29C        ANOP  ,                                                   00157000
.*-------------------------------------------------------------------   00157100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00157200
              AIF   (K'&ZXRSNCODE LE 0).ZG29R   NOT I/O                 00157300
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG29R                     00157400
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00157500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                        00157600
              AIF   (K'&ZCGPR GT 2).ZG29Q                               00157700
              AIF   ('&ZCGPR' EQ '0').ZG29R                             00157800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00157900
              AIF   (T'&ZCGPR NE 'N').ZG29Q     INVALID REG NAME        00158000
.ZG29P        ANOP  ,                                                   00158100
              AIF   (T'&ZCGPR NE 'N').ZG29R     NON NUMERIC             00158200
              AIF   ('&ZCGPR' EQ '0').ZG29R                             00158300
              AIF   ('&ZCGPR' LT '2').ZG29Q                             00158400
              AIF   ('&ZCGPR' LE '12').ZG29R                            00158500
.ZG29Q        ANOP  ,                                                   00158600
&ZMS          SETC  '"RSNCODE='                                         00158700
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00158800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00158900
              MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'             00159000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00159100
.ZG29R        ANOP  ,                                                   00159200
.******************************************************************     00159300
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00159400
.******************************************************************     00159500
              ACTR  10000                                               00159600
.*----------------------------------------------------------------***   00159700
.***AH.P02 EXTRA POSITIONALS                                            00159800
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00159900
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00160000
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00160100
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00160200
.ZGLISTX1     ANOP  ,                                                   00160300
&ZCVAL        SETC  ''          ERROR FIELD                             00160400
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00160500
.ZGLIST2      ANOP  ,                                                   00160600
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00160700
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00160800
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00160900
              AGO   .ZGLIST2                                            00161000
.*                                                                      00161100
.ZGLIST3      ANOP  ,                                                   00161200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00161300
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00161400
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00161500
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00161600
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00161700
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00161800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00161900
.ZGLISTX      ANOP  ,                                                   00162000
&ZASYSLNDX    SETA  0                                                   00162100
.*-------------------------------------------------------------------   00162200
.***AG.MF04 MF=(SLME)                                                   00162300
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00162400
.********************************************************************   00162500
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00162600
.********************************************************************   00162700
              ACTR  10000                                               00162800
.*-------------------------------------------------------------------   00162900
.***AE.MF01 MF=(SLME)                                                   00163000
              AIF   ('&XMF' EQ 'L').ZEMFX                               00163100
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00163200
.********************************************************************   00163300
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00163400
.********************************************************************   00163500
&XSECCHECK    SETC  ''          INITIALIZE XVARIABLE                    00163600
&XREMOTE      SETC  ''          INITIALIZE XVARIABLE                    00163700
&XREXX        SETC  ''          INITIALIZE XVARIABLE                    00163800
.*----------------------------------------------------------------***   00163900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00164000
              AIF   (N'&BUFFER LE 1).ZE2A       CK NUM                  00164100
&ZMS          SETC  '"BUFFER='                                          00164200
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00164300
&ZMS          SETC  '&ZMS "BUFFER"'                                     00164400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00164500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00164600
.ZE2A         ANOP  ,                                                   00164700
.*-------------------------------------------------------------------   00164800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00164900
              AIF   (K'&BUFFER(1) LE 0).ZE2B    NO PRM                  00165000
&ZXBUFFER     SETC  'INPUT'     SET IN/OUTPUT                           00165100
&XBUFFER      SETC  '&BUFFER(1)'                SET XVARIABLE           00165200
              AIF   (N'&BUFFER GT 1).ZE2B                               00165300
.*            ANOP                                                      00165400
&XBUFFER      SETC  '&BUFFER'   SET XVARIABLE                           00165500
.ZE2B         ANOP  ,                                                   00165600
.*-------------------------------------------------------------------   00165700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00165800
              AIF   (K'&ZXBUFFER LE 0).ZE2R     NOT I/O                 00165900
              AIF   ('&XBUFFER'(1,1) NE '(').ZE2R                       00166000
&ZCGPR        SETC  '&XBUFFER'(2,K'&XBUFFER-2)                          00166100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                         00166200
              AIF   (K'&ZCGPR GT 2).ZE2Q                                00166300
              AIF   ('&ZCGPR' EQ '0').ZE2Q                              00166400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00166500
              AIF   (T'&ZCGPR NE 'N').ZE2Q      INVALID REG NAME        00166600
.ZE2P         ANOP  ,                                                   00166700
              AIF   (T'&ZCGPR NE 'N').ZE2R      NON NUMERIC             00166800
              AIF   ('&ZCGPR' LT '2').ZE2Q                              00166900
              AIF   ('&ZCGPR' LE '12').ZE2R                             00167000
.ZE2Q         ANOP  ,                                                   00167100
&ZMS          SETC  '"BUFFER='                                          00167200
&ZMS          SETC  '&ZMS.&BUFFER"'                                     00167300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00167400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00167500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00167600
.ZE2R         ANOP  ,                                                   00167700
.*----------------------------------------------------------------***   00167800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00167900
              AIF   (N'&DATALEN LE 1).ZE5A      CK NUM                  00168000
&ZMS          SETC  '"DATALEN='                                         00168100
&ZMS          SETC  '&ZMS.&DATALEN"'                                    00168200
&ZMS          SETC  '&ZMS "DATALEN"'                                    00168300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00168400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00168500
.ZE5A         ANOP  ,                                                   00168600
.*-------------------------------------------------------------------   00168700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00168800
              AIF   (K'&DATALEN(1) LE 0).ZE5B   NO PRM                  00168900
&ZXDATALEN    SETC  'INPUT'     SET IN/OUTPUT                           00169000
&XDATALEN     SETC  '&DATALEN(1)'               SET XVARIABLE           00169100
              AIF   (N'&DATALEN GT 1).ZE5B                              00169200
.*            ANOP                                                      00169300
&XDATALEN     SETC  '&DATALEN'  SET XVARIABLE                           00169400
.ZE5B         ANOP  ,                                                   00169500
.*-------------------------------------------------------------------   00169600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00169700
              AIF   (K'&ZXDATALEN LE 0).ZE5R    NOT I/O                 00169800
              AIF   ('&XDATALEN'(1,1) NE '(').ZE5R                      00169900
&ZCGPR        SETC  '&XDATALEN'(2,K'&XDATALEN-2)                        00170000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                         00170100
              AIF   (K'&ZCGPR GT 2).ZE5Q                                00170200
              AIF   ('&ZCGPR' EQ '0').ZE5Q                              00170300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00170400
              AIF   (T'&ZCGPR NE 'N').ZE5Q      INVALID REG NAME        00170500
.ZE5P         ANOP  ,                                                   00170600
              AIF   (T'&ZCGPR NE 'N').ZE5R      NON NUMERIC             00170700
              AIF   ('&ZCGPR' LT '2').ZE5Q                              00170800
              AIF   ('&ZCGPR' LE '12').ZE5R                             00170900
.ZE5Q         ANOP  ,                                                   00171000
&ZMS          SETC  '"DATALEN='                                         00171100
&ZMS          SETC  '&ZMS.&DATALEN"'                                    00171200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00171300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00171400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00171500
.ZE5R         ANOP  ,                                                   00171600
.*-------------------------------------------------------------------   00171700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171800
&ZTLC         SETC 'UNAUTH'                                             00171900
              AIF   ('&SECCHECK(1)' NE '&ZTLC').ZE9A                    00172000
&XSECCHECK    SETC  'UNAUTH'    SET KEYWORD                             00172100
              AIF   (N'&SECCHECK LE 1).ZE9A     CK NUM                  00172200
&ZMS          SETC  '"SECCHECK='                                        00172300
&ZMS          SETC  '&ZMS.&SECCHECK"'                                   00172400
&ZMS          SETC  '&ZMS "SECCHECK"'                                   00172500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00172600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00172700
.ZE9A         ANOP  ,                                                   00172800
.*-------------------------------------------------------------------   00172900
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173000
&ZTLC         SETC 'ALL'                                                00173100
              AIF   ('&SECCHECK(1)' NE '&ZTLC').ZE10A                   00173200
&XSECCHECK    SETC  'ALL'       SET KEYWORD                             00173300
              AIF   (N'&SECCHECK LE 1).ZE10A    CK NUM                  00173400
&ZMS          SETC  '"SECCHECK='                                        00173500
&ZMS          SETC  '&ZMS.&SECCHECK"'                                   00173600
&ZMS          SETC  '&ZMS "SECCHECK"'                                   00173700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00173800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00173900
.ZE10A        ANOP  ,                                                   00174000
.*------------------------------------------------------------------    00174100
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00174200
.ZE11         AIF   (K'&XSECCHECK GT 0).ZE11A                           00174300
              AIF   (K'&SECCHECK(1) LE 0).ZE11B                         00174400
&ZMS          SETC  '"SECCHECK='                                        00174500
&ZMS          SETC  '&ZMS.&SECCHECK"'                                   00174600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00174700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00174800
&ZMS          SETC  '&ZMS "UNAUTH"'                                     00174900
&ZMS          SETC  '&ZMS OR "ALL".'                                    00175000
              MNOTE 8,' &ZMS '                                          00175100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175200
              AGO   .ZE11B                                              00175300
.*                                                                      00175400
.ZE11A        ANOP  ,                                                   00175500
&ZXSECCHECK   SETC  'INPUT'     SET IN/OUTPUT                           00175600
.ZE11B        ANOP  ,                                                   00175700
.*-------------------------------------------------------------------   00175800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00175900
&ZTLC         SETC 'NO'                                                 00176000
              AIF   ('&REMOTE(1)' NE '&ZTLC').ZE14A                     00176100
&XREMOTE      SETC  'NO'        SET KEYWORD                             00176200
              AIF   (N'&REMOTE LE 1).ZE14A      CK NUM                  00176300
&ZMS          SETC  '"REMOTE='                                          00176400
&ZMS          SETC  '&ZMS.&REMOTE"'                                     00176500
&ZMS          SETC  '&ZMS "REMOTE"'                                     00176600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00176700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00176800
.ZE14A        ANOP  ,                                                   00176900
.*-------------------------------------------------------------------   00177000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00177100
&ZTLC         SETC 'YES'                                                00177200
              AIF   ('&REMOTE(1)' NE '&ZTLC').ZE15A                     00177300
&XREMOTE      SETC  'YES'       SET KEYWORD                             00177400
              AIF   (N'&REMOTE LE 1).ZE15A      CK NUM                  00177500
&ZMS          SETC  '"REMOTE='                                          00177600
&ZMS          SETC  '&ZMS.&REMOTE"'                                     00177700
&ZMS          SETC  '&ZMS "REMOTE"'                                     00177800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00177900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00178000
.ZE15A        ANOP  ,                                                   00178100
.*----------------------------------------------------------------***   00178200
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00178300
              AIF   (N'&HANDLE LE 1).ZE17A      CK NUM                  00178400
&ZMS          SETC  '"HANDLE='                                          00178500
&ZMS          SETC  '&ZMS.&HANDLE"'                                     00178600
&ZMS          SETC  '&ZMS "HANDLE"'                                     00178700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00178800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00178900
.ZE17A        ANOP  ,                                                   00179000
.*-------------------------------------------------------------------   00179100
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00179200
              AIF   (K'&HANDLE(1) LE 0).ZE17B   NO PRM                  00179300
&ZXHANDLE     SETC  'INPUT'     SET IN/OUTPUT                           00179400
&XHANDLE      SETC  '&HANDLE(1)'                SET XVARIABLE           00179500
              AIF   (N'&HANDLE GT 1).ZE17B                              00179600
.*            ANOP                                                      00179700
&XHANDLE      SETC  '&HANDLE'   SET XVARIABLE                           00179800
.ZE17B        ANOP  ,                                                   00179900
.*-------------------------------------------------------------------   00180000
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00180100
              AIF   (K'&ZXHANDLE LE 0).ZE17R    NOT I/O                 00180200
              AIF   ('&XHANDLE'(1,1) NE '(').ZE17R                      00180300
&ZCGPR        SETC  '&XHANDLE'(2,K'&XHANDLE-2)                          00180400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE17P                        00180500
              AIF   (K'&ZCGPR GT 2).ZE17Q                               00180600
              AIF   ('&ZCGPR' EQ '0').ZE17Q                             00180700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00180800
              AIF   (T'&ZCGPR NE 'N').ZE17Q     INVALID REG NAME        00180900
.ZE17P        ANOP  ,                                                   00181000
              AIF   (T'&ZCGPR NE 'N').ZE17R     NON NUMERIC             00181100
              AIF   ('&ZCGPR' LT '2').ZE17Q                             00181200
              AIF   ('&ZCGPR' LE '12').ZE17R                            00181300
.ZE17Q        ANOP  ,                                                   00181400
&ZMS          SETC  '"HANDLE='                                          00181500
&ZMS          SETC  '&ZMS.&HANDLE"'                                     00181600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00181700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00181800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00181900
.ZE17R        ANOP  ,                                                   00182000
.*-------------------------------------------------------------------   00182100
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00182200
&ZTLC         SETC 'NO'                                                 00182300
              AIF   ('&REXX(1)' NE '&ZTLC').ZE21A                       00182400
&XREXX        SETC  'NO'        SET KEYWORD                             00182500
              AIF   (N'&REXX LE 1).ZE21A        CK NUM                  00182600
&ZMS          SETC  '"REXX='                                            00182700
&ZMS          SETC  '&ZMS.&REXX"'                                       00182800
&ZMS          SETC  '&ZMS "REXX"'                                       00182900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00183000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00183100
.ZE21A        ANOP  ,                                                   00183200
.*-------------------------------------------------------------------   00183300
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00183400
&ZTLC         SETC 'YES'                                                00183500
              AIF   ('&REXX(1)' NE '&ZTLC').ZE22A                       00183600
&XREXX        SETC  'YES'       SET KEYWORD                             00183700
              AIF   (N'&REXX LE 1).ZE22A        CK NUM                  00183800
&ZMS          SETC  '"REXX='                                            00183900
&ZMS          SETC  '&ZMS.&REXX"'                                       00184000
&ZMS          SETC  '&ZMS "REXX"'                                       00184100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00184200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00184300
.ZE22A        ANOP  ,                                                   00184400
.*------------------------------------------------------------------    00184500
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00184600
.ZE23         AIF   (K'&XREXX GT 0).ZE23A                               00184700
              AIF   (K'&REXX(1) LE 0).ZE23B                             00184800
&ZMS          SETC  '"REXX='                                            00184900
&ZMS          SETC  '&ZMS.&REXX"'                                       00185000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00185100
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00185200
&ZMS          SETC  '&ZMS "NO"'                                         00185300
&ZMS          SETC  '&ZMS OR "YES".'                                    00185400
              MNOTE 8,' &ZMS '                                          00185500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00185600
              AGO   .ZE23B                                              00185700
.*                                                                      00185800
.ZE23A        ANOP  ,                                                   00185900
&ZXREXX       SETC  'INPUT'     SET IN/OUTPUT                           00186000
.ZE23B        ANOP  ,                                                   00186100
.*------------------------------------------------------------------    00186200
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00186300
.ZE24         AIF   (K'&XREMOTE GT 0).ZE24A                             00186400
              AIF   (K'&REMOTE(1) LE 0).ZE24B                           00186500
&ZMS          SETC  '"REMOTE='                                          00186600
&ZMS          SETC  '&ZMS.&REMOTE"'                                     00186700
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00186800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00186900
&ZMS          SETC  '&ZMS "NO"'                                         00187000
&ZMS          SETC  '&ZMS OR "YES".'                                    00187100
              MNOTE 8,' &ZMS '                                          00187200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00187300
              AGO   .ZE24B                                              00187400
.*                                                                      00187500
.ZE24A        ANOP  ,                                                   00187600
&ZXREMOTE     SETC  'INPUT'     SET IN/OUTPUT                           00187700
.ZE24B        ANOP  ,                                                   00187800
.*----------------------------------------------------------------***   00187900
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00188000
              AIF   (N'&RETCODE LE 1).ZE26A     CK NUM                  00188100
&ZMS          SETC  '"RETCODE='                                         00188200
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00188300
&ZMS          SETC  '&ZMS "RETCODE"'                                    00188400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00188500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00188600
.ZE26A        ANOP  ,                                                   00188700
.*-------------------------------------------------------------------   00188800
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00188900
              AIF   (K'&RETCODE(1) LE 0).ZE26B  NO PRM                  00189000
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00189100
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00189200
              AIF   (N'&RETCODE GT 1).ZE26B                             00189300
.*            ANOP                                                      00189400
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00189500
.ZE26B        ANOP  ,                                                   00189600
.*-------------------------------------------------------------------   00189700
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00189800
              AIF   (K'&ZXRETCODE LE 0).ZE26R   NOT I/O                 00189900
              AIF   ('&XRETCODE'(1,1) NE '(').ZE26R                     00190000
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00190100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE26P                        00190200
              AIF   (K'&ZCGPR GT 2).ZE26Q                               00190300
              AIF   ('&ZCGPR' EQ '0').ZE26Q                             00190400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00190500
              AIF   (T'&ZCGPR NE 'N').ZE26Q     INVALID REG NAME        00190600
.ZE26P        ANOP  ,                                                   00190700
              AIF   (T'&ZCGPR NE 'N').ZE26R     NON NUMERIC             00190800
              AIF   ('&ZCGPR' LT '2').ZE26Q                             00190900
              AIF   ('&ZCGPR' LE '12').ZE26R                            00191000
.ZE26Q        ANOP  ,                                                   00191100
&ZMS          SETC  '"RETCODE='                                         00191200
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00191300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00191400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00191500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00191600
.ZE26R        ANOP  ,                                                   00191700
.*----------------------------------------------------------------***   00191800
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00191900
              AIF   (N'&RSNCODE LE 1).ZE29A     CK NUM                  00192000
&ZMS          SETC  '"RSNCODE='                                         00192100
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00192200
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00192300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00192400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00192500
.ZE29A        ANOP  ,                                                   00192600
.*-------------------------------------------------------------------   00192700
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00192800
              AIF   (K'&RSNCODE(1) LE 0).ZE29B  NO PRM                  00192900
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00193000
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00193100
              AIF   (N'&RSNCODE GT 1).ZE29B                             00193200
.*            ANOP                                                      00193300
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00193400
.ZE29B        ANOP  ,                                                   00193500
.*-------------------------------------------------------------------   00193600
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00193700
              AIF   (K'&ZXRSNCODE LE 0).ZE29R   NOT I/O                 00193800
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE29R                     00193900
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00194000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE29P                        00194100
              AIF   (K'&ZCGPR GT 2).ZE29Q                               00194200
              AIF   ('&ZCGPR' EQ '0').ZE29Q                             00194300
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00194400
              AIF   (T'&ZCGPR NE 'N').ZE29Q     INVALID REG NAME        00194500
.ZE29P        ANOP  ,                                                   00194600
              AIF   (T'&ZCGPR NE 'N').ZE29R     NON NUMERIC             00194700
              AIF   ('&ZCGPR' LT '2').ZE29Q                             00194800
              AIF   ('&ZCGPR' LE '12').ZE29R                            00194900
.ZE29Q        ANOP  ,                                                   00195000
&ZMS          SETC  '"RSNCODE='                                         00195100
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00195200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00195300
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00195400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00195500
.ZE29R        ANOP  ,                                                   00195600
.******************************************************************     00195700
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00195800
.******************************************************************     00195900
              ACTR  10000                                               00196000
.*----------------------------------------------------------------***   00196100
.***AF.P02 EXTRA POSITIONALS                                            00196200
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00196300
&ZCVAL        SETC  ''          ERROR FIELD                             00196400
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00196500
.ZELIST2      ANOP  ,                                                   00196600
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00196700
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00196800
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00196900
              AGO   .ZELIST2                                            00197000
.*                                                                      00197100
.ZELIST3      ANOP  ,                                                   00197200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00197300
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00197400
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00197500
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00197600
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00197700
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00197800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00197900
.ZELISTX      ANOP  ,                                                   00198000
&ZASYSLNDX    SETA  0                                                   00198100
.*-------------------------------------------------------------------   00198200
.***AE.MF02 MF=(SLME)                                                   00198300
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00198400
.*******************************************************************    00198500
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00198600
.*******************************************************************    00198700
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00198800
.*******************************************************************    00198900
.***AE.01  START OF HZSPWRIT MACRO CODE                                 00199000
.*******************************************************************    00199100
              LCLC  &M0M0001                 NAME                       00199200
&M0M0001      SETC  '&XLABEL'                SET NAME                   00199300
              AIF   (K'&XLABEL NE 0).XLAB2                              00199400
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00199500
.*                                                                      00199600
.XLAB2        ANOP  ,                                                   00199700
              AIF   ('&XMF' EQ 'L').XLAB3                               00199800
&M0M0001 DS    0H                             HZSPWRIT-0                00199900
.XLAB3        ANOP  ,                                                   00200000
.*******************************************************************    00200100
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00200200
.*******************************************************************    00200300
              PUSH  PRINT                                               00200400
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00200500
              PRINT OFF         ++ PR01                                 00200600
              AGO   .ZPRNTXX                                            00200700
.ZPRINTX      PRINT ON                                                  00200800
.ZPRNTXX      ANOP  ,                                                   00200900
.********************************************************************   00201000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00201100
.********************************************************************   00201200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00201300
                      LCLA  &ZOPN1         INVOCATION INDEX             00201400
                      LCLC  &ZOPL(4095)    LABEL                        00201500
                      LCLC  &ZOPO(4095)    OPERATION                    00201600
                      LCLC  &ZOPV(4095)    VALUE                        00201700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00201800
.*                                                                      00201900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00202000
.******************************************************************     00202100
.***AL.L10 HZSPWRIT FMT=LIST MF=S!L PARAMETERS                          00202200
.******************************************************************     00202300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00202400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00202500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00202600
&XMFATTR              SETC  '0D'                                        00202700
.*                                                                      00202800
&ZOPN                 SETA  &ZOPN+1                                     00202900
&ZOPL(&ZOPN)          SETC  ' '                                         00203000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00203100
&ZOPO(&ZOPN)          SETC  'B'                                         00203200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00203300
                      AGO   .ZALVL6B                                    00203400
.ZALVL6A              ANOP                                              00203500
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00203600
&ZOPV(&ZOPN)          SETC  '4,8'                                       00203700
&ZOPN                 SETA  &ZOPN+1                                     00203800
&ZOPL(&ZOPN)          SETC  ' '                                         00203900
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00204000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00204100
.ZALVL6B              ANOP                                              00204200
&ZOPD(&ZOPN)          SETC  '++ HZSPWRIT ARG PARMS'                     00204300
.*                                                                      00204400
&ZOPN                 SETA  &ZOPN+1                                     00204500
&ZOPL(&ZOPN)          SETC  ' '                                         00204600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00204700
&ZOPV(&ZOPN)          SETC  '1'                                         00204800
&ZOPD(&ZOPN)          SETC  ' '                                         00204900
.*                                                                      00205000
.ZLMFSL2              ANOP  ,                                           00205100
.*-------------------------------------------------------------------   00205200
.***AM.L00  HZSPWRIT FMT=LIST name                                      00205300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00205400
&ZOPN                 SETA &ZOPN+1                                      00205500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00205600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00205700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00205800
&ZOPD(&ZOPN)          SETC '++ HZSPWRIT NAME'                           00205900
.ZLMFSL2M             ANOP  ,                                           00206000
.*-------------------------------------------------------------------   00206100
.***AM.L01  HZSPWRIT FMT=LIST PARAMETERS                                00206200
&ZOPN                 SETA &ZOPN+1                                      00206300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00206400
&ZOPO(&ZOPN)          SETC 'DS'                                         00206500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00206600
&ZOPD(&ZOPN)          SETC '++ HZSPWRIT PARM LIST'                      00206700
.*-------------------------------------------------------------------   00206800
.***AM.L02 XVERSION XL1                                                 00206900
&ZOPN                 SETA &ZOPN+1                                      00207000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00207100
&ZOPO(&ZOPN)          SETC 'DS'                                         00207200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00207300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00207400
.*-------------------------------------------------------------------   00207500
.***AM.L09  XRSV0003 CL03                                               00207600
&ZOPN                 SETA &ZOPN+1                                      00207700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00207800
&ZOPO(&ZOPN)          SETC 'DS'                                         00207900
&ZOPV(&ZOPN)          SETC 'CL03'                                       00208000
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00208100
.*-------------------------------------------------------------------   00208200
.***AM.L03 XFLAGS BL.32                                                 00208300
&ZOPN                 SETA &ZOPN+1                                      00208400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00208500
&ZOPO(&ZOPN)          SETC 'DS'                                         00208600
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00208700
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00208800
.*                                                                      00208900
&ZOPN                 SETA  &ZOPN+1                                     00209000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREMOTE_YES'                     00209100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00209200
&ZOPV(&ZOPN)          SETC  'B''10000000000000000000000000000000'''     00209300
&ZOPD(&ZOPN)          SETC  '++ XREMOTE.'                               00209400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00209500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00209600
.*                                                                      00209700
&ZOPN                 SETA  &ZOPN+1                                     00209800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREXX_YES'                       00209900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00210000
&ZOPV(&ZOPN)          SETC  'B''01000000000000000000000000000000'''     00210100
&ZOPD(&ZOPN)          SETC  '++ XREXX.'                                 00210200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00210300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00210400
.*                                                                      00210500
&ZOPN                 SETA  &ZOPN+1                                     00210600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSECCHECK_ALL'                   00210700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00210800
&ZOPV(&ZOPN)          SETC  'B''00100000000000000000000000000000'''     00210900
&ZOPD(&ZOPN)          SETC  '++ XSECCHECK.'                             00211000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ALL'                          00211100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00211200
.*-------------------------------------------------------------------   00211300
.***AM.L09 ADDR XBUFFER A                                               00211400
&ZOPN                 SETA &ZOPN+1                                      00211500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ADDR'                     00211600
&ZOPO(&ZOPN)          SETC 'DS'                                         00211700
&ZOPV(&ZOPN)          SETC 'A'                                          00211800
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ADDR'                          00211900
.*-------------------------------------------------------------------   00212000
.***AM.L09 ALET XBUFFER F                                               00212100
&ZOPN                 SETA &ZOPN+1                                      00212200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ALET'                     00212300
&ZOPO(&ZOPN)          SETC 'DS'                                         00212400
&ZOPV(&ZOPN)          SETC 'F'                                          00212500
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ALET'                          00212600
.*-------------------------------------------------------------------   00212700
.***AM.L09  XDATALEN F                                                  00212800
&ZOPN                 SETA &ZOPN+1                                      00212900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATALEN'                         00213000
&ZOPO(&ZOPN)          SETC 'DS'                                         00213100
&ZOPV(&ZOPN)          SETC 'F'                                          00213200
&ZOPD(&ZOPN)          SETC '++ &ZXDATALEN '                             00213300
.*-------------------------------------------------------------------   00213400
.***AM.L09  XHANDLE CL16                                                00213500
&ZOPN                 SETA &ZOPN+1                                      00213600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XHANDLE'                          00213700
&ZOPO(&ZOPN)          SETC 'DS'                                         00213800
&ZOPV(&ZOPN)          SETC 'CL16'                                       00213900
&ZOPD(&ZOPN)          SETC '++ &ZXHANDLE '                              00214000
.*-------------------------------------------------------------------   00214100
.***AM.L09  XRSV0020 CL04                                               00214200
&ZOPN                 SETA &ZOPN+1                                      00214300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0020'                         00214400
&ZOPO(&ZOPN)          SETC 'DS'                                         00214500
&ZOPV(&ZOPN)          SETC 'CL04'                                       00214600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00214700
.*-------------------------------------------------------------------   00214800
.***AM.L10 END OF HZSPWRIT LIST PARAMETERS                              00214900
&ZOPN                 SETA &ZOPN+1                                      00215000
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00215100
&ZOPO(&ZOPN)          SETC 'EQU'                                        00215200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00215300
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00215400
.*                                                                      00215500
&ZOPN                 SETA &ZOPN+1                                      00215600
&ZOPL(&ZOPN)          SETC ' '                                          00215700
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00215800
&ZOPV(&ZOPN)          SETC '1'                                          00215900
&ZOPD(&ZOPN)          SETC ' '                                          00216000
.*-------------------------------------------------------------------   00216100
.***AL.L12 HZSPWRIT FMT=LIST MF=S!L PARAMETERS                          00216200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00216300
.*                                                                      00216400
&ZOPN                 SETA  &ZOPN+1                                     00216500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00216600
&ZOPO(&ZOPN)          SETC  'DC'                                        00216700
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00216800
&ZOPD(&ZOPN)          SETC  '++ HZSPWRIT ARG PARMS'                     00216900
.*                                                                      00217000
.ZLMFSLX              ANOP  ,                                           00217100
.*-------------------------------------------------------------------   00217200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00217300
&ZPLLEN               SETA 40                                           00217400
.*                                                                      00217500
.******************************************************************     00217600
.***AI.L01 HZSPWRIT FMT=LIST FILL IN PARAMETER AREA                     00217700
.******************************************************************     00217800
                      ACTR  10000                                       00217900
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00218000
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00218100
&ZCVAL                SETC  'LAE'          XAX MODE                     00218200
.ZIMFXA               ANOP ,                                            00218300
.*                                                                      00218400
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00218500
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00218600
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00218700
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00218800
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00218900
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00219000
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00219100
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00219200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00219300
&ZOPN                 SETA  &ZOPN+1                                     00219400
&ZOPL(&ZOPN)          SETC  ' '                                         00219500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00219600
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00219700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00219800
                      AGO   .ZIMFNX                                     00219900
.*                                                                      00220000
.ZIMFN2               ANOP ,                                            00220100
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00220200
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00220300
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00220400
&ZOPN                 SETA  &ZOPN+1                                     00220500
&ZOPL(&ZOPN)          SETC  ' '                                         00220600
&ZOPO(&ZOPN)          SETC  'LAE'                                       00220700
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00220800
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00220900
                      AGO   .ZIMFNX                                     00221000
.ZIMFNX1              ANOP ,                                            00221100
&ZOPN                 SETA  &ZOPN+1                                     00221200
&ZOPL(&ZOPN)          SETC  ' '                                         00221300
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00221400
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00221500
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00221600
.ZIMFNX               ANOP ,                                            00221700
.********************************************************************   00221800
.***AI.L02 HZSPWRIT FMT=LIST INITIALIZE PARAMETER AREA                  00221900
.********************************************************************   00222000
.***AI.L03 MF=(SLME)                                                    00222100
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00222200
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00222300
.*                                                                      00222400
&ZOPN                 SETA  &ZOPN+1                                     00222500
&ZOPL(&ZOPN)          SETC  ' '                                         00222600
&ZOPO(&ZOPN)          SETC  'XC'                                        00222700
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00222800
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00222900
.ZIMFLX               ANOP  ,                                           00223000
.*-------------------------------------------------------------------   00223100
.***AI.L05 XFLAGS BL4                                                   00223200
&ZW                   SETC  ''                                          00223300
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00223400
&ZMS                  SETC  ''                                          00223500
&ZC                   SETC  ''                                          00223600
.*-------------------------------------------------------------------   00223700
.***AI.L08 XFLAGS "YES"                                                 00223800
.***      BL4'1XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'                         00223900
         AIF   ('&XREMOTE' NE 'YES').ZI4A                               00224000
&ZW                   SETC  '&ZW.1'                                     00224100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00224200
&ZMS                  SETC  '&ZMS.1'                                    00224300
                      AGO   .ZI4C                                       00224400
.*                                                                      00224500
.ZI4A                 ANOP  ,                                           00224600
&ZW                   SETC  '&ZW.0'                                     00224700
         AIF   ('&ZXREMOTE' EQ '').ZI4B                                 00224800
&ZMS                  SETC  '&ZMS.0'                                    00224900
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00225000
                      AGO   .ZI4C                                       00225100
.*                                                                      00225200
.ZI4B                 ANOP  ,                                           00225300
&ZMS                  SETC  '&ZMS.1'                                    00225400
.ZI4C                 ANOP  ,                                           00225500
.*-------------------------------------------------------------------   00225600
.***AI.L08 XFLAGS "YES"                                                 00225700
.***      BL4'X1XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'                         00225800
         AIF   ('&XREXX' NE 'YES').ZI5A                                 00225900
&ZW                   SETC  '&ZW.1'                                     00226000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00226100
&ZMS                  SETC  '&ZMS.1'                                    00226200
                      AGO   .ZI5C                                       00226300
.*                                                                      00226400
.ZI5A                 ANOP  ,                                           00226500
&ZW                   SETC  '&ZW.0'                                     00226600
         AIF   ('&ZXREXX' EQ '').ZI5B                                   00226700
&ZMS                  SETC  '&ZMS.0'                                    00226800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00226900
                      AGO   .ZI5C                                       00227000
.*                                                                      00227100
.ZI5B                 ANOP  ,                                           00227200
&ZMS                  SETC  '&ZMS.1'                                    00227300
.ZI5C                 ANOP  ,                                           00227400
.*-------------------------------------------------------------------   00227500
.***AI.L08 XFLAGS "ALL"                                                 00227600
.***      BL4'XX1XXXXXXXXXXXXXXXXXXXXXXXXXXXXX'                         00227700
         AIF   ('&XSECCHECK' NE 'ALL').ZI6A                             00227800
&ZW                   SETC  '&ZW.100000000000000000000000000000'        00227900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00228000
&ZMS                  SETC  '&ZMS.111111111111111111111111111111'       00228100
                      AGO   .ZI6C                                       00228200
.*                                                                      00228300
.ZI6A                 ANOP  ,                                           00228400
&ZW                   SETC  '&ZW.000000000000000000000000000000'        00228500
         AIF   ('&ZXSECCHECK' EQ '').ZI6B                               00228600
&ZMS                  SETC  '&ZMS.011111111111111111111111111111'       00228700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00228800
                      AGO   .ZI6C                                       00228900
.*                                                                      00229000
.ZI6B                 ANOP  ,                                           00229100
&ZMS                  SETC  '&ZMS.111111111111111111111111111111'       00229200
.ZI6C                 ANOP  ,                                           00229300
.*-------------------------------------------------------------------   00229400
.***AI.L10 XFLAGS BL4                                                   00229500
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI6D               00229600
                      AIF   ('&ZC' NE 'YES').ZI6D                       00229700
&ZOPN                 SETA  &ZOPN+1                                     00229800
&ZOPL(&ZOPN)          SETC  ' '                                         00229900
&ZOPO(&ZOPN)          SETC  'NC'                                        00230000
&ZOPV(&ZOPN)          SETC  '4(4,1),=BL4''&ZMS'''                       00230100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL4'                              00230200
.ZI6D                 ANOP  ,                                           00230300
                      AIF   ('&ZCLNG' NE 'YES').ZI6E  ALL ZERO BITS     00230400
&ZOPN                 SETA  &ZOPN+1                                     00230500
&ZOPL(&ZOPN)          SETC  ' '                                         00230600
&ZOPO(&ZOPN)          SETC  'OC'                                        00230700
&ZOPV(&ZOPN)          SETC  '4(4,1),=BL4''&ZW'''                        00230800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL4'                              00230900
.ZI6E                 ANOP  ,                                           00231000
.*-------------------------------------------------------------------   00231100
.***AI.L19 ADDR XBUFFER A                                               00231200
                      AIF   ('&ZXBUFFER' EQ '').ZI7H                    00231300
&ZCLNG                SETC  '&XBUFFER'                                  00231400
&ZCGPR                SETC  '14'                                        00231500
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI7F  IN GPR                    00231600
.*                                                                      00231700
&ZOPN                 SETA  &ZOPN+1                                     00231800
&ZOPL(&ZOPN)          SETC  ' '                                         00231900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00232000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00232100
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00232200
.*                                                                      00232300
                      AGO   .ZI7G                                       00232400
.*                                                                      00232500
.ZI7F                 ANOP  ,                                           00232600
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00232700
.*                                                                      00232800
.ZI7G                 ANOP  ,                                           00232900
.*                                                                      00233000
&ZOPN                 SETA  &ZOPN+1                                     00233100
&ZOPL(&ZOPN)          SETC  ' '                                         00233200
&ZOPO(&ZOPN)          SETC  'ST'                                        00233300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00233400
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00233500
.*                                                                      00233600
.ZI7H                 ANOP  ,                                           00233700
.*-------------------------------------------------------------------   00233800
.***AI.L23 ALET XBUFFER F                                               00233900
         AIF   ('&ZXBUFFER' EQ '').ZI8G                                 00234000
         AIF   ('&SYSASCE' EQ 'P').ZI8G    SYSSTATE PRIMARY             00234100
&ZCLNG                SETC  '&XBUFFER'                                  00234200
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI8E  IN AR                     00234300
.*                                                                      00234400
&ZCGPR                SETC  '14'                                        00234500
                      AGO   .ZI8F                                       00234600
.*                                                                      00234700
.ZI8E                 ANOP  ,                                           00234800
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00234900
.*                                                                      00235000
.ZI8F                 ANOP  ,                                           00235100
.*                                                                      00235200
&ZOPN                 SETA  &ZOPN+1                                     00235300
&ZOPL(&ZOPN)          SETC  ' '                                         00235400
&ZOPO(&ZOPN)          SETC  'STAM'                                      00235500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,12(1)'                       00235600
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00235700
.*                                                                      00235800
.ZI8G                 ANOP  ,                                           00235900
.*-------------------------------------------------------------------   00236000
.***AI.L25  XDATALEN F                                                  00236100
                      AIF   ('&ZXDATALEN' EQ '').ZI9E                   00236200
                      AIF   ('&ZXDATALEN' EQ 'OUTPUT').ZI9E             00236300
&ZCGPR                SETC  '&XDATALEN'                                 00236400
.*                                                                      00236500
                      AIF   ('&XDATALEN'(1,1) NE '(').ZI9B              00236600
&ZCGPR   SETC  '0('.'&XDATALEN'(2,K'&XDATALEN-2).')'                    00236700
                      AGO   .ZI9D                                       00236800
.ZI9B                 ANOP  ,                                           00236900
.*                                                                      00237000
&ZC                   SETC  '&XDATALEN'(1,1)                            00237100
                      AIF   (T'&ZC NE 'N').ZI9D                         00237200
&ZC                   SETC  '&XDATALEN'                                 00237300
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI9D                00237400
&ZCGPR                SETC  '=FL4''&XDATALEN'''                         00237500
.*                                                                      00237600
.ZI9D                 ANOP  ,                                           00237700
.*                                                                      00237800
&ZOPN                 SETA  &ZOPN+1                                     00237900
&ZOPL(&ZOPN)          SETC  ' '                                         00238000
&ZOPO(&ZOPN)          SETC  'MVC'                                       00238100
&ZOPV(&ZOPN)          SETC  '16(4,1),&ZCGPR'                            00238200
&ZOPD(&ZOPN)          SETC  '++ &ZXDATALEN XDATALEN'                    00238300
.*                                                                      00238400
.ZI9E                 ANOP  ,                                           00238500
.*-------------------------------------------------------------------   00238600
.***AI.L25  XHANDLE CL16                                                00238700
                      AIF   ('&ZXHANDLE' EQ '').ZI10E                   00238800
                      AIF   ('&ZXHANDLE' EQ 'OUTPUT').ZI10E             00238900
&ZCGPR                SETC  '&XHANDLE'                                  00239000
.*                                                                      00239100
                      AIF   ('&XHANDLE'(1,1) NE '(').ZI10B              00239200
&ZCGPR   SETC  '0('.'&XHANDLE'(2,K'&XHANDLE-2).')'                      00239300
.ZI10B                ANOP  ,                                           00239400
.*                                                                      00239500
&ZOPN                 SETA  &ZOPN+1                                     00239600
&ZOPL(&ZOPN)          SETC  ' '                                         00239700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00239800
&ZOPV(&ZOPN)          SETC  '20(16,1),&ZCGPR'                           00239900
&ZOPD(&ZOPN)          SETC  '++ &ZXHANDLE XHANDLE'                      00240000
.*                                                                      00240100
.ZI10E                ANOP  ,                                           00240200
.*-------------------------------------------------------------------   00240300
&ZOPN1                SETA &ZOPN                                        00240400
.*-------------------------------------------------------------------   00240500
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00240600
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00240700
.*******************************************************************    00240800
.***  PROCESS HZSPWRIT OUTPUT PARAMETERS                                00240900
.*******************************************************************    00241000
                      ACTR  10000                                       00241100
.*******************************************************************    00241200
.***AO.X02  RETURN CODE PROCESSING                                      00241300
.*******************************************************************    00241400
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00241500
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00241600
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00241700
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00241800
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00241900
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00242000
&ZOPN                 SETA  &ZOPN+1                                     00242100
&ZOPL(&ZOPN)          SETC  ' '                                         00242200
&ZOPO(&ZOPN)          SETC  'ST'                                        00242300
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00242400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00242500
                      AGO   .ZMRETX                                     00242600
.*                                                                      00242700
.ZMRET2               ANOP  ,                                           00242800
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00242900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00243000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00243100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00243200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00243300
&ZOPN                 SETA  &ZOPN+1                                     00243400
&ZOPL(&ZOPN)          SETC  ' '                                         00243500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00243600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00243700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00243800
.ZMRETX               ANOP  ,                                           00243900
.*******************************************************************    00244000
.***AO.X03  REASON CODE PROCESSING                                      00244100
.*******************************************************************    00244200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00244300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00244400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00244500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00244600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00244700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00244800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00244900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00245000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00245100
&ZOPN                 SETA  &ZOPN+1                                     00245200
&ZOPL(&ZOPN)          SETC  ' '                                         00245300
&ZOPO(&ZOPN)          SETC  'ST'                                        00245400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00245500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00245600
                      AGO   .ZMRSNX                                     00245700
.*                                                                      00245800
.ZMRSN2               ANOP  ,                                           00245900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00246000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00246100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00246200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00246300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00246400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00246500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00246600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00246700
&ZOPN                 SETA  &ZOPN+1                                     00246800
&ZOPL(&ZOPN)          SETC  ' '                                         00246900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00247000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00247100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00247200
.ZMRSNX               ANOP  ,                                           00247300
.*******************************************************************    00247400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00247500
.*******************************************************************    00247600
.ZMFLX                ANOP  ,              MF=L PROCESSING              00247700
.*******************************************************************    00247800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00247900
.*******************************************************************    00248000
                      ACTR  10000                                       00248100
.*                                                                      00248200
                      LCLA  &ZLC           COLUMN POSITION              00248300
                      LCLA  &ZOPX          LIST TABLE INDEX             00248400
                      LCLC  &ZLL           LABEL                        00248500
                      LCLC  &ZLOP          OPERATION                    00248600
                      LCLC  &ZLV           VALUE                        00248700
                      LCLC  &ZLD           DESCRIPTION                  00248800
.*                                                                      00248900
&ZOPX                 SETA  1                                           00249000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00249100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00249200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00249300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00249400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00249500
                      AIF   (K'&ZLD LE 0).ZL5                           00249600
&ZLC                  SETA  35             COMMENT COLUMN               00249700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00249800
&ZLC                  SETA  33             COMMMENT COLUMN              00249900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00250000
&ZLV                  SETC  '&ZLV'.' '                                  00250100
                      AGO   .ZL3                                        00250200
.*                                                                      00250300
.ZL4                  ANOP  ,                                           00250400
&ZLV                  SETC  '&ZLV'.' '                                  00250500
.ZL5                  ANOP  ,                                           00250600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00250700
.*                                                                      00250800
&ZLL     &ZLOP &ZLV                                                     00250900
.*                                                                      00251000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00251100
                      AGO   .ZL2           CONTINUE LOOPING             00251200
.*                                                                      00251300
.ZLX                  ANOP  ,                                           00251400
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00251500
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00251600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00251700
         AIF   ('&SYSAM64' NE 'YES').NOT_AM64                           00251800
&ZMAC_L  SETC  'LLGT'                                                   00251900
.NOT_AM64 ANOP                                                          00252000
         &ZMAC_L 15,16(0,0)         Get CVT address                     00252100
         AIF   ('&SYSASCE' EQ 'P').NOT_AR_1                             00252200
         LAE   15,0(15,0)           Clear AR 15                         00252300
.NOT_AR_1 ANOP                                                          00252400
         L     15,140(15,0)         Get ECVT address                    00252500
         L     15,204(15,0)         Get CTBL address                    00252600
         AIF   ('&XREMOTE' EQ 'YES').REM1A                              00252700
         L     15,300(15,0)         Get HZSTABLE address                00252800
         AGO   .REM1B                                                   00252900
.REM1A   ANOP                                                           00253000
         ICM   15,B'1111',300(15)   Get HZSTABLE address                00253100
         JZ    HZSPWRITNA_&SYSNDX   No HZSTABLE, get out now            00253200
         TM    1240(15),X'80'       Check if commands accepted          00253300
         JZ    HZSPWRITNA_&SYSNDX   No cmds accepted, get out now       00253400
.REM1B   ANOP                                                           00253500
         AIF   (&SYSALVL GE 2).IS_ZARCH_1                               00253600
         CLI   163(0),00            Z-Architecture?                     00253700
         JE    HZSPWRITESA390_&SYSNDX                                   00253800
.IS_ZARCH_1 ANOP                                                        00253900
         LMH   15,15,1372(15)                                           00254000
         AIF   (&SYSALVL GE 2).IS_ZARCH_2                               00254100
HZSPWRITESA390_&SYSNDX DS 0H                                            00254200
.IS_ZARCH_2 ANOP                                                        00254300
         AIF   ('&XREMOTE' EQ 'YES').REM2A                              00254400
         L     15,1332(15,0)        Get HZSPWRIT PC NUM                 00254500
         AGO   .REM2B                                                   00254600
.REM2A   ANOP                                                           00254700
         ICM   15,B'1111',1332(15)  Get HZSPWRIT PC NUM                 00254800
         JZ    HZSPWRITNA_&SYSNDX   No PC Num, get out now              00254900
.REM2B   ANOP                                                           00255000
         PC    0(15)                PC to handle HZSPWRIT request       00255100
         AIF   ('&XREMOTE' NE 'YES').REM3B                              00255200
         J     HZSPWRITEND_&SYSNDX  Branch around seting bad RC         00255300
HZSPWRITNA_&SYSNDX DS 0H                                                00255400
         LA    15,X'C'              Set RC (HC not active)              00255500
         LA    0,X'C01'             Set RSN not active                  00255600
HZSPWRITEND_&SYSNDX DS 0H                                               00255700
.REM3B   ANOP                                                           00255800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00255900
.ZLINKX               ANOP  ,                                           00256000
.*******************************************************************    00256100
.***AP.X01  FORMAT GENERATED CODE                                       00256200
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00256300
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00256400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00256500
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00256600
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00256700
                      AIF   (K'&ZLD LE 0).ZL51                          00256800
&ZLC                  SETA  35             COMMENT COLUMN               00256900
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00257000
&ZLC                  SETA  33             COMMENT COLUMN               00257100
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00257200
&ZLV                  SETC  '&ZLV'.' '                                  00257300
                      AGO   .ZL31                                       00257400
.*                                                                      00257500
.ZL41                 ANOP  ,                                           00257600
&ZLV                  SETC  '&ZLV'.' '                                  00257700
.ZL51                 ANOP  ,                                           00257800
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00257900
.*                                                                      00258000
&ZLL     &ZLOP &ZLV                                                     00258100
.*                                                                      00258200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00258300
                      AGO   .ZL21          CONTINUE LOOPING             00258400
.*                                                                      00258500
.ZLX1                 ANOP  ,                                           00258600
.*******************************************************************    00258700
.***AP.X02  END OF HZSPWRIT MACRO                                       00258800
&ZHZSPWRIT            SETC  'YES'          SET HZSPWRIT USED            00258900
         POP   PRINT                                                    00259000
*                                            HZSPWRIT-0                 00259100
         SPACE 1                                                        00259200
.ZLX2                 ANOP  ,                                           00259300
         MEND                                                           00259400
**********************************************************************/ 00259500
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00259600
*%HZSPWRIT: MACRO KEYS(BUFFER,DATALEN,SECCHECK,REMOTE,HANDLE,REXX,      00259700
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00259800
*  ANS('?'!!MACLABEL!!' '!!'HZSPWRIP '!!MACLIST!!                       00259900
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00260000
*%END HZSPWRIT;                                                         00260100

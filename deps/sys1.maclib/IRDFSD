*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IRDFSD                                -06/20/03-<1> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  FICON Switch Data Service                     * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5647-A01 (C) COPYRIGHT IBM CORP. 2000                           * 00001200
*                                                                     * 00001300
* STATUS= HBB7703                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      The FICON Switch Data macro service is used to obtain          * 00002000
*      statistical counters from FICON switch devices.                * 00002100
*                                                                     * 00002200
*01* EXTERNAL CLASSIFICATION:                                         * 00002300
*                                                                     * 00002400
*02* GUPI: BASE                                                       * 00002500
*                                                                     * 00002600
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002700
*                                                                     * 00002800
*01* ENVIRONMENT:                                                     * 00002900
*                                                                     * 00003000
*                                                                     * 00003100
*      Dispatchable unit mode: Task mode.                             * 00003200
*                                                                     * 00003300
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00003400
*                        key.  Must be authorized.                    * 00003500
*                                                                     * 00003600
*      AMODE:            31-bit.                                      * 00003700
*                                                                     * 00003800
*      ASC mode:         Primary.                                     * 00003900
*                                                                     * 00004000
*      Interrupt status: Enabled for I/O and external interrupts.     * 00004100
*                                                                     * 00004200
*                                                                     * 00004300
*                                                                     * 00004400
*01* RESTRICTIONS:                                                    * 00004500
*    Must not hold any locks, or be in an environment that would      * 00004600
*    prevent SVCs from being issued.  Must be authorized.             * 00004700
*                                                                     * 00004800
*01* INPUT REGISTERS:  GR0-GR15    Undefined                          * 00004900
*                                                                     * 00005000
*01* OUTPUT REGISTERS: GR0         Reason code                        * 00005100
*                      GR1         Unpredictable                      * 00005200
*                      GR2-GR14    Restored                           * 00005300
*                      GR15        Return code                        * 00005400
*                                                                     * 00005500
*01* SYNTAX:                                                          * 00005600
*                                                                     * 00005700
*Ýxlabel¨  IRDFSD  ÐÝ DEVICE=ALL¨                                     * 00005800
*                  ¿Ý,DEVICE=SINGLE                                   * 00005900
*                        ,DEVICENUMBER=xdevicenumber¨                 * 00006000
*                  ÐÝ,COUNTERS=DEFAULT¨                               * 00006100
*                  ÔÝ,COUNTERS=ALL¨                                   * 00006200
*                  ¿Ý,COUNTERS=LIST                                   * 00006300
*                        ,COUNTERLIST=xcounterlist¨                   * 00006400
*                   Ý,SUBPOOL=»xsubpool!0º¨                           * 00006500
*                    ,FSDADDRESS=xfsdaddress                          * 00006600
*                    ,FSDLENGTH=xfsdlength                            * 00006700
*                   Ý,RETCODE=xretcode¨                               * 00006800
*                   Ý,RSNCODE=xrsncode¨                               * 00006900
*                   Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨           * 00007000
*                  ÐÝ,MF=S¨                                           * 00007100
*                  ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                    * 00007200
*                  ¿Ý,MF=(E,xmfctrl»,COMPLETEº)¨                      * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*      Where:                                                         * 00007600
*                                                                     * 00007700
*                                                                     * 00007800
*      Ýxlabel¨                                                       * 00007900
*          is an optional symbol, starting in column 1, that is the   * 00008000
*          name on the IRDFSD macro invocation.  The name must        * 00008100
*          conform to the rules for an ordinary assembler language    * 00008200
*          symbol.                                                    * 00008300
*          DEFAULT: No name.                                          * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*      ÝDEVICE=»ALL!SINGLEº¨                                          * 00008900
*          is an optional keyword input                               * 00009000
*          DEFAULT: ALL                                               * 00009100
*                                                                     * 00009200
*                                                                     * 00009300
*          ÝDEVICE=ALL¨                                               * 00009400
*              Specifies that statistics for all devices should be    * 00009500
*              returned.                                              * 00009600
*                                                                     * 00009700
*          ÝDEVICE=SINGLE                                             * 00009800
*              Specifies that statistics for a single device should   * 00009900
*              be returned.                                           * 00010000
*                                                                     * 00010100
*                                                                     * 00010200
*              DEVICENUMBER=xdevicenumber¨                            * 00010300
*                  is the name (RS-type), or address in register      * 00010400
*                  (2)-(12), of a required halfword input that        * 00010500
*                  specifies the device number of the FICON switch    * 00010600
*                  device to be interogated.                          * 00010700
*                                                                     * 00010800
*                                                                     * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*                                                                     * 00011200
*                                                                     * 00011300
*                                                                     * 00011400
*                                                                     * 00011500
*      ÝCOUNTERS=»DEFAULT!ALL!LISTº¨                                  * 00011600
*          is an optional keyword input                               * 00011700
*          DEFAULT: DEFAULT                                           * 00011800
*                                                                     * 00011900
*                                                                     * 00012000
*          ÝCOUNTERS=DEFAULT¨                                         * 00012100
*              Specifies that the default set of counters be          * 00012200
*              returned.                                              * 00012300
*                                                                     * 00012400
*          ÝCOUNTERS=ALL¨                                             * 00012500
*              Specifies that all supported counters be returned.     * 00012600
*                                                                     * 00012700
*          ÝCOUNTERS=LIST                                             * 00012800
*              Specifies that the list of counters to return is       * 00012900
*              provided.                                              * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*              COUNTERLIST=xcounterlist¨                              * 00013300
*                  is the name (RS-type), or address in register      * 00013400
*                  (2)-(12), of a required 4 byte input that contains * 00013500
*                  the address that specifies a list of Statistical   * 00013600
*                  Counter Control Words (60 maximum) to return.  The * 00013700
*                  IHAFSD macro contains the definition of the        * 00013800
*                  statistical counter control word (SCCW), as well   * 00013900
*                  as descriptions of the available counters.         * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*                                                                     * 00014600
*                                                                     * 00014700
*                                                                     * 00014800
*      ÝSUBPOOL=»xsubpool!0º¨                                         * 00014900
*          is the name (RS-type), or address in register (2)-(12), of * 00015000
*          an optional byte input that specifies the subpool this     * 00015100
*          service should use to obtain the storage for the FICON     * 00015200
*          Switch Data (FSD), mapped in IHAFSD.                       * 00015300
*          DEFAULT: 0                                                 * 00015400
*                                                                     * 00015500
*                                                                     * 00015600
*                                                                     * 00015700
*                                                                     * 00015800
*      FSDADDRESS=xfsdaddress                                         * 00015900
*          is the name (RS-type), or address in register (2)-(12), of * 00016000
*          a required 4 byte output that will contain the address     * 00016100
*          address of the storage for the FICON Switch Data (FSD),    * 00016200
*          mapped in IHAFSD.  Note that the invoker is responsible    * 00016300
*          for freeing this storage.                                  * 00016400
*                                                                     * 00016500
*                                                                     * 00016600
*                                                                     * 00016700
*                                                                     * 00016800
*      FSDLENGTH=xfsdlength                                           * 00016900
*          is the name (RS-type), or address in register (2)-(12), of * 00017000
*          a required fullword output that contains the length of the * 00017100
*          storage for the FICON Switch Data (FSD), mapped in IHAFSD. * 00017200
*                                                                     * 00017300
*                                                                     * 00017400
*                                                                     * 00017500
*                                                                     * 00017600
*      ÝRETCODE=xretcode¨                                             * 00017700
*          is the name (RS-type) of an optional fullword output       * 00017800
*          variable, or register (2)-(12), into which the return code * 00017900
*          is to be copied from GPR 15.                               * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      ÝRSNCODE=xrsncode¨                                             * 00018500
*          is the name (RS-type) of an optional fullword output       * 00018600
*          variable, or register (2)-(12), into which the reason code * 00018700
*          is to be copied from GPR 0.                                * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00019300
*          is an optional byte input decimal value in the "1-1" range * 00019400
*          that specifies the macro version.  PLISTVER is the only    * 00019500
*          key allowed on the list form of MF and determines which    * 00019600
*          parameter list is generated.  Note that MAX may be         * 00019700
*          specified instead of a number, and the parameter list will * 00019800
*          be of the largest size currently supported. This size may  * 00019900
*          grow from release to release (thus possibly affecting the  * 00020000
*          amount of storage needed by your program).  If your        * 00020100
*          program can tolerate this, IBM recommends that you always  * 00020200
*          specify MAX when creating the list form parameter list as  * 00020300
*          that will ensure that the list form parameter list is      * 00020400
*          always long enough to hold whatever parameters might be    * 00020500
*          specified on the execute form.                             * 00020600
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00020700
*          default is the lowest version which allows all of the      * 00020800
*          parameters specified on the invocation to be processed.    * 00020900
*                                                                     * 00021000
*                                                                     * 00021100
*                                                                     * 00021200
*                                                                     * 00021300
*      ÝMF=»S!L!Eº¨                                                   * 00021400
*          is an optional keyword input which specifies the macro     * 00021500
*          form.                                                      * 00021600
*          DEFAULT: S                                                 * 00021700
*                                                                     * 00021800
*                                                                     * 00021900
*          ÝMF=S¨                                                     * 00022000
*              specifies the standard form of the macro.  The "S"     * 00022100
*              form generates code to put the parameters into an      * 00022200
*              in-line parameter list and invoke the desired service. * 00022300
*              Full checking for required macro keys is done along    * 00022400
*              with supplying defaults for omitted optional           * 00022500
*              parameters.                                            * 00022600
*                                                                     * 00022700
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00022800
*              specifies the list form of the macro.  The "L" form    * 00022900
*              defines an area to be used for the parameter list.     * 00023000
*              Only the PLISTVER key may be specified on the          * 00023100
*              invocation.  All other macro parameters are flagged as * 00023200
*              errors.  If PLISTVER is not specified, the original    * 00023300
*              parameter list definition is used.                     * 00023400
*                                                                     * 00023500
*            ,xmfctrl                                                 * 00023600
*              is a required input.  It is the name of a storage area * 00023700
*              for the parameter list.                                * 00023800
*                                                                     * 00023900
*            »,xmfattr!0Dº                                            * 00024000
*              is an optional 60 character input string that varies   * 00024100
*              from 1 to 60 characters. Use it to force boundary      * 00024200
*              alignment of the parameter list. Use only 0F or 0D.    * 00024300
*              DEFAULT: 0D which forces the parameter list to a       * 00024400
*              doubleword boundary.                                   * 00024500
*                                                                     * 00024600
*          ÝMF=(E,xmfctrl»,COMPLETEº)¨                                * 00024700
*              specifies the execute form of the macro.  The "E" form * 00024800
*              generates code to put the parameters into the          * 00024900
*              parameter list specified by xmfctrl and provides full  * 00025000
*              syntax checking with default setting.                  * 00025100
*                                                                     * 00025200
*            ,xmfctrl                                                 * 00025300
*              is a required input.  It is the name (RS-type), or     * 00025400
*              address in register (1)-(12), of a storage area for    * 00025500
*              the parameter list.                                    * 00025600
*                                                                     * 00025700
*            »,COMPLETEº                                              * 00025800
*              is an optional keyword input which specifies the       * 00025900
*              degree of macro parameter syntax checking.             * 00026000
*              DEFAULT: COMPLETE                                      * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
*              COMPLETE                                               * 00026400
*                  Checking for required macro keys is done and       * 00026500
*                  defaults are supplied for omitted optional         * 00026600
*                  parameters.                                        * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*                                                                     * 00027200
*                                                                     * 00027300
*                                                                     * 00027400
*01* RETURN CODES:                                                    * 00027500
*                                                                     * 00027600
*                                                                     * 00027700
*            00   Successful completion, data returned for online     * 00027800
*                 FICON switches                                      * 00027900
*                                                                     * 00028000
*            04   Environmental error, no data returned               * 00028100
*                                                                     * 00028200
*            08   User error, no data returned                        * 00028300
*                                                                     * 00028400
*            0C   System error, no data returned                      * 00028500
*                                                                     * 00028600
*                                                                     * 00028700
*                                                                     * 00028800
*01* REASON CODES:                                                    * 00028900
*                                                                     * 00029000
*       REASON    RETURN                                              * 00029100
*       CODE      CODE      DESCRIPTION                               * 00029200
*       ××××××××  ××××××××  ×××××××××××                               * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*       00000001  04        Required  module unavailable. The request * 00029600
*                           could not be processed.                   * 00029700
*                                                                     * 00029800
*       00000002  04        The  server  task  is  not  active.   The * 00029900
*                           request could not be processed.           * 00030000
*                                                                     * 00030100
*       00000024  04        FICON switch statistics disabled.         * 00030200
*                                                                     * 00030300
*       00000003  08        Caller is not APF authorized.             * 00030400
*                                                                     * 00030500
*       00000008  08        Request type not recognized by IRDVFSD.   * 00030600
*                                                                     * 00030700
*       00000021  08        Specified device is not a FICON switch.   * 00030800
*                                                                     * 00030900
*       00000022  08        Specified device is not online.           * 00031000
*                                                                     * 00031100
*       00000023  08        Request type not recognized by IOSVFSD.   * 00031200
*                                                                     * 00031300
*       00000004  0C        Recovery could not be established.        * 00031400
*                                                                     * 00031500
*       00000005  0C        POST failed.                              * 00031600
*                                                                     * 00031700
*       00000006  0C        Recovery was entered.                     * 00031800
*                                                                     * 00031900
*       00000025  0C        I/O error.                                * 00032000
*                                                                     * 00032100
*       00000026  0C        UCBSCAN failure.                          * 00032200
*                                                                     * 00032300
*       00000027  0C        UCBLOOK failure.                          * 00032400
*                                                                     * 00032500
*       00000028  0C        Server task recovery was entered.         * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00033000
*                                                                     * 00033100
*02*   PROCESSOR:  ASSEM                                              * 00033200
*                                                                     * 00033300
*01* COMPONENT:  00101                                                * 00033400
*                                                                     * 00033500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00033600
*                                                                     * 00033700
*01* MACRO USAGE NOTES:                                               * 00033800
*                                                                     * 00033900
*                                                                     * 00034000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00034100
*        global macro variable.  Any value other than 'NO' will       * 00034200
*        result in the macro expansion being printed.  The default is * 00034300
*        'YES'.  The following examples illustrate how the ZPRINT     * 00034400
*        variable should be set.                                      * 00034500
*                                                                     * 00034600
*                    GBLC &ZPRINT                                     * 00034700
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00034800
*                                                                     * 00034900
*                                                                     * 00035000
*    2.  All  keys currently contained in the IRDFSD macro correspond * 00035100
*        to  version 1.  If you specify PLISTVER, use a value of 1 or * 00035200
*        MAX.                                                         * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*                                                                     * 00035600
*                                                                     * 00035700
*01* CHANGE ACTIVITY:                                                 * 00035800
*                                                                     * 00035900
*   Flag LineItem  FMID    Date   ID    Comment                       * 00036000
*                                                                     * 00036100
*    $L0=OW44428  HBB7703 010228 PDHT:  Winterpark II Support         * 00036200
*    $01=OW49638  HBB7703 020409 PDHC:  Add FSDADDRESS Add FSDLENGTH  * 00036300
*                                         Change return and reason    * 00036400
*                                         codes, Get IRDVFSD address  * 00036500
*                                         from IECA                   * 00036600
*    $02=OW57652  HBB7703 030630 PDHC:  Update Reason Codes           * 00036700
****** END OF SPECIFICATIONS *****************************************/ 00036800
*/* TLINE 1 *********************************************************** 00036900
         MACRO                                                          00037000
&XLABEL  IRDFSD &DEVICE=,&DEVICENUMBER=,&COUNTERS=,&COUNTERLIST=,      *00037100
               &SUBPOOL=,&FSDADDRESS=,&FSDLENGTH=,&RETCODE=,&RSNCODE=, *00037200
               &PLISTVER=,&MF=                                          00037300
.*                                                                      00037400
*                  MACDATE -06/20/03-<1>                                00037500
.*                                                                      00037600
.*******************************************************************    00037700
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00037800
.*******************************************************************    00037900
                  GBLC  &ZPRINT     YES=PRINT NO=NO PRINT               00038000
                  GBLC  &ZTEST      YES=TEST NO=NO TEST                 00038100
                  GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX         00038200
.*                                                                      00038300
                  GBLC  &ZIRDFSD    YES=MACRO USED AT LEAST ONCE        00038400
.*******************************************************************    00038500
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00038600
.*******************************************************************    00038700
                  LCLC  &ZMS        ERROR MESSAGE WORK AREA             00038800
                  LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS        00038900
                  LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED          00039000
                  LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR         00039100
                  LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE         00039200
                  LCLA  &ZAWRK      USED AS A WORK AREA                 00039300
                  LCLA  &ZASIZ      USED FOR SIZE OF VALUE              00039400
                  LCLA  &ZN         NUMERIC WORK VARIABLE               00039500
                  LCLC  &ZC         CHARACTER WORK VARIABLE             00039600
                  LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE         00039700
                  LCLA  &ZTLA       VALUE TOO LONG VARIABLE             00039800
                  LCLC  &ZMAC_G     "G" or null                         00039900
&ZMAC_G           SETC  ''                                              00040000
                  LCLC  &ZMAC_LR                                        00040100
&ZMAC_LR          SETC  'LR'                                            00040200
                  LCLC  &ZMAC_L                                         00040300
&ZMAC_L           SETC  'L'                                             00040400
                  LCLC  &ZMAC_ST                                        00040500
&ZMAC_ST          SETC  'ST'                                            00040600
                  LCLA  &ZMACRET    MACRO RETURN CODE                   00040700
&ZMACRET          SETA  0           ASSUME NO ERRORS                    00040800
.*                                                                      00040900
                  LCLC  &ZCSYSLIST(255)         NONXKEY, POS ARRAY      00041000
                  LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()          00041100
                  LCLA  &ZPLLEN     PARAMETER LIST LENGTH               00041200
                  LCLC  &ZENDBASEPL             End of base PL          00041300
                  LCLA  &ZPLWORKA   PARAMETER LIST LENGTH               00041400
.*******************************************************************    00041500
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00041600
.*******************************************************************    00041700
                  LCLA  &ZI         INDEX FOR ARRAY                     00041800
                  LCLA  &ZJ         INDEX FOR PARMS                     00041900
                  LCLA  &ZK         INDEX FOR PARSE                     00042000
                  LCLA  &ZLO        LOW RANGE VALUE                     00042100
                  LCLA  &ZHI        HIGH RANGE VALUE                    00042200
                  LCLC  &ZW         WORK AREA FOR PARM                  00042300
.********************************************************************   00042400
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00042500
.********************************************************************   00042600
                  GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL             00042700
                  GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE      00042800
                  GBLA  &SYSALVL    SYSSTATE ARCHLVL                    00042900
                  GBLC  &SYSAM64    SYSSTATE AMODE64                    00043000
.*                                                                      00043100
                  AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED      00043200
                  AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED       00043300
                  SPLEVEL  TEST                                         00043400
.ZSYS2            ANOP  ,                                               00043500
                  AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1           00043600
                  AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1           00043700
                  SYSSTATE TEST                                         00043800
                  AGO   .ZSYS4                                          00043900
.ZSYS3            ANOP  ,                                               00044000
&SYSASCE          SETC  'P'         ASSUME SYSSTATE PRIMARY             00044100
.ZSYS4            ANOP  ,                                               00044200
.*******************************************************************    00044300
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00044400
.*******************************************************************    00044500
                  LCLC  &XDEVICE    ++ VALUE                            00044600
                  LCLC  &XDEVICENUMBER          ++ NAME                 00044700
                  LCLC  &XCOUNTERS  ++ VALUE                            00044800
                  LCLC  &XCOUNTERLIST           ++ NAME                 00044900
                  LCLC  &XSUBPOOL   ++ NAME                             00045000
                  LCLC  &XFSDADDRESS            ++ NAME                 00045100
                  LCLC  &XFSDLENGTH             ++ NAME                 00045200
                  LCLC  &XRETCODE   ++ NAME                             00045300
                  LCLC  &XRSNCODE   ++ NAME                             00045400
                  LCLA  &XPLISTVER  ++ VALUE                            00045500
                  LCLC  &XMF        ++ VALUE                            00045600
                  LCLC  &XMFCTRL    ++ NAME                             00045700
                  LCLC  &XMFATTR    ++ VALUE                            00045800
                  LCLC  &XMFSCK     ++ VALUE                            00045900
.*******************************************************************    00046000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00046100
.*******************************************************************    00046200
                  LCLC  &ZXDEVICE   ++ INPUT VALUE                      00046300
                  LCLC  &ZXDEVICENUMBER         ++ INPUT NAME           00046400
                  LCLC  &ZXCOUNTERS             ++ INPUT VALUE          00046500
                  LCLC  &ZXCOUNTERLIST          ++ INPUT NAME           00046600
                  LCLC  &ZXSUBPOOL  ++ INPUT NAME                       00046700
                  LCLC  &ZXFSDADDRESS           ++ OUTPUT NAME          00046800
                  LCLC  &ZXFSDLENGTH            ++ OUTPUT NAME          00046900
                  LCLC  &ZXRETCODE  ++ OUTPUT NAME                      00047000
                  LCLC  &ZXRSNCODE  ++ OUTPUT NAME                      00047100
                  LCLC  &ZXPLISTVER             ++ INPUT VALUE          00047200
                  LCLC  &ZXMF       ++ INPUT VALUE                      00047300
                  LCLC  &ZXMFCTRL   ++ INPUT NAME                       00047400
                  LCLC  &ZXMFATTR   ++ INPUT VALUE                      00047500
                  LCLC  &ZXMFSCK    ++ INPUT VALUE                      00047600
.********************************************************************   00047700
.***AC.PLV01  PROCESS PLISTVER                                      *   00047800
.********************************************************************   00047900
&XPLISTVER      SETA  1                                                 00048000
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00048100
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00048200
&XPLISTVER      SETA  1                                                 00048300
.ZPLV0          ANOP  ,                                                 00048400
.*                                                                      00048500
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00048600
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00048700
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00048800
.*-------------------------------------------------------------------   00048900
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00049000
&ZMS            SETC  '"PLISTVER='         *KPOSA* MNOTE                00049100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00049200
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00049300
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00049400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00049500
                AGO   .ZPVCK2                                           00049600
.ZPVCK3         ANOP  ,                                                 00049700
.*-------------------------------------------------------------------   00049800
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00049900
&ZMS            SETC  '"PLISTVER='         *KGPRA* MNOTE                00050000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00050100
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00050200
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00050300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00050400
                AGO   .ZPVCKE                                           00050500
.ZPVCK2         ANOP  ,                                                 00050600
.*-------------------------------------------------------------------   00050700
&ZCVAL          SETC  '&PLISTVER(1)'                                    00050800
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00050900
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00051000
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00051100
                AIF   (&ZN LT 1).ZPVCK6    TOO LOW                      00051200
                AIF   (&ZN LE 1).ZPVCK4A   NOT HIGH                     00051300
.ZPVCK6         ANOP  ,                                                 00051400
&ZMS            SETC  '"PLISTVER='         *KRNGA* MNOTE                00051500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00051600
&ZMS            SETC  '&ZMS THE RANGE IS "1-1"'                         00051700
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00051800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00051900
&XPLISTVER      SETA  1                                                 00052000
                AGO   .ZPVCKE                                           00052100
.*-------------------------------------------------------------------   00052200
.ZPVCK4A        ANOP  ,                                                 00052300
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00052400
&ZMS            SETC  'PLISTVER='          *KVALA* MNOTE                00052500
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00052600
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00052700
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00052800
                MNOTE 8,' &ZMS IS REQUIRED.'                            00052900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00053000
                AGO   .ZPVCK5                                           00053100
.ZPVCK4         ANOP  ,                                                 00053200
&XPLISTVER      SETA  &PLISTVER(1)                                      00053300
.ZPVCK5         ANOP  ,                                                 00053400
.ZPVCKE         ANOP  ,                                                 00053500
.********************************************************************   00053600
.***AG.MF01 PROCESS MF MACRO FORMS                                      00053700
.********************************************************************   00053800
                  ACTR  10000                                           00053900
.*------------------------------------------------------------------    00054000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00054100
&XMF              SETC  ''          INITIALIZE XVARIABLE                00054200
.*-------------------------------------------------------------------   00054300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00054400
.ZG38             ANOP  ,                                               00054500
&ZTLC             SETC 'S'                                              00054600
                  AIF   ('&MF(1)' NE '&ZTLC').ZG39                      00054700
&XMF              SETC  'S'         SET KEYWORD                         00054800
                  AIF   (N'&MF LE 1).ZG38A      CK NUM                  00054900
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00055000
&ZMS              SETC  '&ZMS.&MF"'                                     00055100
&ZMS              SETC  '&ZMS "MF"'                                     00055200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00055300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00055400
.ZG38A            ANOP  ,                                               00055500
.*-------------------------------------------------------------------   00055600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00055700
.ZG39             ANOP  ,                                               00055800
&ZTLC             SETC 'L'                                              00055900
                  AIF   ('&MF(1)' NE '&ZTLC').ZG46                      00056000
&XMF              SETC  'L'         SET KEYWORD                         00056100
                  AIF   (N'&MF LE 3).ZG39A      CK NUM                  00056200
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00056300
&ZMS              SETC  '&ZMS.&MF"'                                     00056400
&ZMS              SETC  '&ZMS "MF"'                                     00056500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00056600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00056700
.ZG39A            ANOP  ,                                               00056800
.*-------------------------------------------------------------------   00056900
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00057000
                  AIF   (N'&SYSLIST NE 0).ZG39B  POSITIONALS?           00057100
                  AIF   ('&DEVICE' NE '').ZG39B  KEYS?                  00057200
                  AIF   ('&DEVICENUMBER' NE '').ZG39B  KEYS?            00057300
                  AIF   ('&COUNTERS' NE '').ZG39B  KEYS?                00057400
                  AIF   ('&COUNTERLIST' NE '').ZG39B  KEYS?             00057500
                  AIF   ('&SUBPOOL' NE '').ZG39B  KEYS?                 00057600
                  AIF   ('&FSDADDRESS' NE '').ZG39B  KEYS?              00057700
                  AIF   ('&FSDLENGTH' NE '').ZG39B  KEYS?               00057800
                  AIF   ('&RETCODE' NE '').ZG39B  KEYS?                 00057900
                  AIF   ('&RSNCODE' NE '').ZG39B  KEYS?                 00058000
                  AGO    .ZG39C     INVOCATION OKAY                     00058100
.ZG39B            ANOP  ,                                               00058200
&ZMS              SETC  'THE "L" FORM OF "MF"'  *MFLA* MNOTE            00058300
&ZMS              SETC  '&ZMS CAN ONLY HAVE'                            00058400
&ZMS              SETC  '&ZMS THE "PLISTVER" KEY'                       00058500
                  MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'          00058600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00058700
.ZG39C            ANOP  ,                                               00058800
.*-------------------------------------------------------------------   00058900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00059000
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00059100
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00059200
                  AIF   (N'&MF(2) GT 1).ZG41B   MULTI PARMS             00059300
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00059400
.ZG41B            AIF   (K'&MF(2) GT 0).ZG41C                           00059500
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00059600
&ZMS              SETC  'WHEN "L" IS SPECIFIED'  *KRQDA*                00059700
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00059800
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00059900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00060000
.ZG41C            ANOP  ,                                               00060100
.*-------------------------------------------------------------------   00060200
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00060300
                  AIF   (K'&ZXMFCTRL LE 0).ZG41P  NOT I/O               00060400
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG41P                  00060500
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00060600
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00060700
&ZMS              SETC  '&ZMS.&MF"'                                     00060800
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00060900
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'               00061000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00061100
.ZG41P            ANOP  ,                                               00061200
.*-------------------------------------------------------------------   00061300
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00061400
&ZXMFATTR         SETC  'INPUT'     SET IN/OUTPUT                       00061500
&XMFATTR          SETC  '0D'                                            00061600
                  AIF   (K'&MF(3) LE 0).ZG44B   PARM                    00061700
&XMFATTR          SETC  '&MF(3,1)'  SET XVARIABLE                       00061800
                  AIF   (N'&MF(3) GT 1).ZG44B   MULTI PARMS             00061900
&XMFATTR          SETC  '&MF(3)'    SET XVARIABLE                       00062000
.ZG44B            ANOP  ,                                               00062100
.*-------------------------------------------------------------------   00062200
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00062300
                  AIF   (K'&ZXMFATTR LE 0).ZG44P  NOT I/O               00062400
                  AIF   ('&XMFATTR'(1,1) NE '(').ZG44P                  00062500
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00062600
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00062700
&ZMS              SETC  '&ZMS.&MF"'                                     00062800
&ZMS              SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'       00062900
                  MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'               00063000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00063100
.ZG44P            ANOP  ,                                               00063200
.*-------------------------------------------------------------------   00063300
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00063400
                  AIF   (K'&ZXMFATTR LE 0).ZG44S  NOT I/O               00063500
                  AIF   (K'&XMFATTR LE 60).ZG44S  LNG OK                00063600
&ZXMFATTR         SETC  ''          RESET IN/OUTPUT                     00063700
&ZMS              SETC  '"MF='      *KLNGA* MNOTE                       00063800
&ZMS              SETC  '&ZMS.&MF"'                                     00063900
&ZMS              SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'           00064000
                  MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'              00064100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00064200
.ZG44S            ANOP  ,                                               00064300
.*-------------------------------------------------------------------   00064400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00064500
.ZG46             ANOP  ,                                               00064600
&ZTLC             SETC 'E'                                              00064700
                  AIF   ('&MF(1)' NE '&ZTLC').ZG54                      00064800
&XMF              SETC  'E'         SET KEYWORD                         00064900
                  AIF   (N'&MF LE 3).ZG46A      CK NUM                  00065000
&ZMS              SETC  '"MF='      *KPOSA* MNOTE                       00065100
&ZMS              SETC  '&ZMS.&MF"'                                     00065200
&ZMS              SETC  '&ZMS "MF"'                                     00065300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'            00065400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00065500
.ZG46A            ANOP  ,                                               00065600
.*-------------------------------------------------------------------   00065700
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00065800
&ZXMFCTRL         SETC  'INPUT'     SET IN/OUTPUT                       00065900
&XMFCTRL          SETC  '&MF(2,1)'  SET XVARIABLE                       00066000
                  AIF   (N'&MF(2) GT 1).ZG48B   MULTI PARMS             00066100
&XMFCTRL          SETC  '&MF(2)'    SET XVARIABLE                       00066200
.ZG48B            AIF   (K'&MF(2) GT 0).ZG48C                           00066300
&ZXMFCTRL         SETC  ''          RESET IN/OUTPUT                     00066400
&ZMS              SETC  'WHEN "E" IS SPECIFIED'  *KRQDA*                00066500
&ZMS              SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'             00066600
                  MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                    00066700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00066800
.ZG48C            ANOP  ,                                               00066900
.*-------------------------------------------------------------------   00067000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00067100
                  AIF   (K'&ZXMFCTRL LE 0).ZG48R  NOT I/O               00067200
                  AIF   ('&XMFCTRL'(1,1) NE '(').ZG48R                  00067300
&ZCGPR            SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                      00067400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG48P                    00067500
                  AIF   (K'&ZCGPR GT 2).ZG48Q                           00067600
                  AIF   ('&ZCGPR' EQ '0').ZG48Q                         00067700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00067800
                  AIF   (T'&ZCGPR NE 'N').ZG48Q  INVALID REG NAME       00067900
.ZG48P            ANOP  ,                                               00068000
                  AIF   (T'&ZCGPR NE 'N').ZG48R  NON NUMERIC            00068100
                  AIF   ('&ZCGPR' LT '1').ZG48Q                         00068200
                  AIF   ('&ZCGPR' LE '12').ZG48R                        00068300
.ZG48Q            ANOP  ,                                               00068400
&ZMS              SETC  '"MF='      *KGPRA* MNOTE                       00068500
&ZMS              SETC  '&ZMS.&MF"'                                     00068600
&ZMS              SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'       00068700
                  MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                00068800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00068900
.ZG48R            ANOP  ,                                               00069000
.*-------------------------------------------------------------------   00069100
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00069200
&XMFSCK           SETC  ''          INITIALIZE XVARIABLE                00069300
.ZG52A   AIF   ('&MF(3)' NE 'COMPLETE').ZG53A                           00069400
&XMFSCK           SETC  'COMPLETE'  SET KEYWORD                         00069500
.*-------------------------------------------------------------------   00069600
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00069700
.ZG53A            AIF   (K'&XMFSCK GT 0).ZG53C  KEYWORD                 00069800
                  AIF   (K'&MF(3) LE 0).ZG53B                           00069900
&ZMS              SETC  '"MF='      *KUKWA* MNOTE                       00070000
&ZMS              SETC  '&ZMS.&MF"'                                     00070100
&ZMS              SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '       00070200
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00070300
&ZMS              SETC  '&ZMS "COMPLETE".'                              00070400
                  MNOTE 8,' &ZMS '                                      00070500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00070600
.ZG53B            ANOP  ,                                               00070700
&XMFSCK           SETC  'COMPLETE'  SET DEFAULT KEYWORD                 00070800
.ZG53C            ANOP  ,                                               00070900
&ZXMFSCK          SETC  'INPUT'     SET IN/OUTPUT                       00071000
.*------------------------------------------------------------------    00071100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00071200
.ZG54             ANOP  ,                                               00071300
&ZXMF             SETC  'INPUT'     SET IN/OUTPUT                       00071400
                  AIF   (K'&XMF GT 0).ZG54E     VALID ARG               00071500
                  AIF   (T'&MF EQ 'O').ZG54D    OMITTED                 00071600
&ZASYSLNDX        SETA  0                                               00071700
.ZG54A            ANOP  ,           POSITIONAL MACRO KEY                00071800
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00071900
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG54C                00072000
&ZTLC             SETC 'MF'                                             00072100
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG54A       00072200
.ZG54B            ANOP  ,                                               00072300
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00072400
&ZMS              SETC  'THE "MF" KEY'          *KOPTA* MNOTE           00072500
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00072600
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00072700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00072800
                  AGO   .ZG54E                                          00072900
.ZG54C            ANOP  ,                                               00073000
&ZXMF             SETC  ''          RESET IN/OUTPUT                     00073100
&ZMS              SETC  '"MF='      *KUKWA* MNOTE                       00073200
&ZMS              SETC  '&ZMS.&MF"'                                     00073300
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00073400
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00073500
&ZMS              SETC  '&ZMS "S",'                                     00073600
&ZMS              SETC  '&ZMS "L",'                                     00073700
&ZMS              SETC  '&ZMS OR "E".'                                  00073800
                  MNOTE 8,' &ZMS '                                      00073900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00074000
                  AGO   .ZG54E                                          00074100
.ZG54D            ANOP  ,                                               00074200
&XMF              SETC  'S'         SET DEFAULT KEYWORD                 00074300
&XMFSCK           SETC  'COMPLETE'  COMPLETE CHECKING                   00074400
.ZG54E            ANOP  ,                                               00074500
.********************************************************************   00074600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00074700
.********************************************************************   00074800
                  ACTR  10000                                           00074900
.*-------------------------------------------------------------------   00075000
.***AG.MF03 MF=(SLE)                                                    00075100
                  AIF   ('&XMF' EQ 'L').ZGMFX                           00075200
.*------------------------------------------------------------------    00075300
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075400
&XDEVICE          SETC  ''          INITIALIZE XVARIABLE                00075500
.*-------------------------------------------------------------------   00075600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00075700
.ZG3              ANOP  ,                                               00075800
                  AIF   (K'&DEVICE(1) LE 0).ZG3A                        00075900
&ZTLC             SETC 'ALL'                                            00076000
                  AIF   ('&DEVICE(1)' NE '&ZTLC').ZG4                   00076100
&XDEVICE          SETC  'ALL'       SET KEYWORD                         00076200
                  AIF   (N'&DEVICE LE 1).ZG3A   CK NUM                  00076300
&ZMS              SETC  '"DEVICE='  *KPOSA* MNOTE                       00076400
&ZMS              SETC  '&ZMS.&DEVICE"'                                 00076500
&ZMS              SETC  '&ZMS "DEVICE"'                                 00076600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00076700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00076800
.ZG3A             ANOP  ,                                               00076900
.*------------------------------------------------------------------    00077000
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00077100
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00077200
.ZG3A0            AIF   (K'&DEVICENUMBER LE 0).ZG3A1  OK                00077300
&ZCVAL            SETC '&ZCVAL DEVICENUMBER'    INCORRECT KEY USED      00077400
.ZG3A1            AIF   (K'&ZCVAL LE 0).ZG3A2   OK                      00077500
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00077600
&ZMS              SETC  '"DEVICE'   *KMEIA* MNOTE                       00077700
&ZMS              SETC  '&ZMS.=&DEVICE"'                                00077800
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00077900
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00078000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00078100
.ZG3A2            ANOP  ,                                               00078200
.*-------------------------------------------------------------------   00078300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00078400
.ZG4              ANOP  ,                                               00078500
&ZTLC             SETC 'SINGLE'                                         00078600
                  AIF   ('&DEVICE(1)' NE '&ZTLC').ZG8                   00078700
&XDEVICE          SETC  'SINGLE'    SET KEYWORD                         00078800
                  AIF   (N'&DEVICE LE 1).ZG4A   CK NUM                  00078900
&ZMS              SETC  '"DEVICE='  *KPOSA* MNOTE                       00079000
&ZMS              SETC  '&ZMS.&DEVICE"'                                 00079100
&ZMS              SETC  '&ZMS "DEVICE"'                                 00079200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00079300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00079400
.ZG4A             ANOP  ,                                               00079500
.*----------------------------------------------------------------***   00079600
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00079700
                  AIF   (N'&DEVICENUMBER LE 1).ZG6A  CK NUM             00079800
&ZMS              SETC  '"DEVICENUMBER='        *KPOSA* MNOTE           00079900
&ZMS              SETC  '&ZMS.&DEVICENUMBER"'                           00080000
&ZMS              SETC  '&ZMS "DEVICENUMBER"'                           00080100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00080200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00080300
.ZG6A             ANOP  ,                                               00080400
.*-------------------------------------------------------------------   00080500
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00080600
&ZXDEVICENUMBER   SETC  'INPUT'     SET IN/OUTPUT                       00080700
&XDEVICENUMBER    SETC  '&DEVICENUMBER(1)'      SET XVARIABLE           00080800
                  AIF   (N'&DEVICENUMBER GT 1).ZG6B  MULTI PARMS        00080900
&XDEVICENUMBER    SETC  '&DEVICENUMBER'         SET XVARIABLE           00081000
.ZG6B             AIF   (K'&DEVICENUMBER(1) GT 0).ZG6C                  00081100
&ZXDEVICENUMBER   SETC  ''          RESET IN/OUTPUT                     00081200
&ZMS              SETC  'WHEN "SINGLE" IS SPECIFIED'  *KRQDA*           00081300
&ZMS              SETC  '&ZMS , "DEVICENUMBER" KEY AND ITS'             00081400
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00081500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00081600
.ZG6C             ANOP  ,                                               00081700
.*-------------------------------------------------------------------   00081800
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00081900
                  AIF   (K'&ZXDEVICENUMBER LE 0).ZG6R  NOT I/O          00082000
                  AIF   ('&XDEVICENUMBER'(1,1) NE '(').ZG6R             00082100
&ZCGPR            SETC  '&XDEVICENUMBER'(2,K'&XDEVICENUMBER-2)          00082200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                     00082300
                  AIF   (K'&ZCGPR GT 2).ZG6Q                            00082400
                  AIF   ('&ZCGPR' EQ '0').ZG6Q                          00082500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00082600
                  AIF   (T'&ZCGPR NE 'N').ZG6Q  INVALID REG NAME        00082700
.ZG6P             ANOP  ,                                               00082800
                  AIF   (T'&ZCGPR NE 'N').ZG6R  NON NUMERIC             00082900
                  AIF   ('&ZCGPR' LT '2').ZG6Q                          00083000
                  AIF   ('&ZCGPR' LE '12').ZG6R                         00083100
.ZG6Q             ANOP  ,                                               00083200
&ZMS              SETC  '"DEVICENUMBER='        *KGPRA* MNOTE           00083300
&ZMS              SETC  '&ZMS.&DEVICENUMBER"'                           00083400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00083500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00083600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00083700
.ZG6R             ANOP  ,                                               00083800
.*------------------------------------------------------------------    00083900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00084000
.ZG8              ANOP  ,                                               00084100
&ZXDEVICE         SETC  'INPUT'     SET IN/OUTPUT                       00084200
                  AIF   (K'&XDEVICE GT 0).ZG8E  VALID ARG               00084300
                  AIF   (T'&DEVICE EQ 'O').ZG8D  OMITTED                00084400
&ZASYSLNDX        SETA  0                                               00084500
.ZG8A             ANOP  ,           POSITIONAL MACRO KEY                00084600
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00084700
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG8C                 00084800
&ZTLC             SETC 'DEVICE'                                         00084900
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG8A        00085000
.ZG8B             ANOP  ,                                               00085100
&ZXDEVICE         SETC  ''          RESET IN/OUTPUT                     00085200
&ZMS              SETC  'THE "DEVICE" KEY'      *KOPTA* MNOTE           00085300
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00085400
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00085500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00085600
                  AGO   .ZG8E                                           00085700
.ZG8C             ANOP  ,                                               00085800
&ZXDEVICE         SETC  ''          RESET IN/OUTPUT                     00085900
&ZMS              SETC  '"DEVICE='  *KUKWA* MNOTE                       00086000
&ZMS              SETC  '&ZMS.&DEVICE"'                                 00086100
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00086200
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00086300
&ZMS              SETC  '&ZMS "ALL"'                                    00086400
&ZMS              SETC  '&ZMS OR "SINGLE".'                             00086500
                  MNOTE 8,' &ZMS '                                      00086600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00086700
                  AGO   .ZG8E                                           00086800
.ZG8D             ANOP  ,                                               00086900
&XDEVICE          SETC  'ALL'       SET DEFAULT KEYWORD                 00087000
.ZG8E             ANOP  ,                                               00087100
.*------------------------------------------------------------------    00087200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087300
&XCOUNTERS        SETC  ''          INITIALIZE XVARIABLE                00087400
.*-------------------------------------------------------------------   00087500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00087600
.ZG11             ANOP  ,                                               00087700
                  AIF   (K'&COUNTERS(1) LE 0).ZG11A                     00087800
&ZTLC             SETC 'DEFAULT'                                        00087900
                  AIF   ('&COUNTERS(1)' NE '&ZTLC').ZG12                00088000
&XCOUNTERS        SETC  'DEFAULT'   SET KEYWORD                         00088100
                  AIF   (N'&COUNTERS LE 1).ZG11A  CK NUM                00088200
&ZMS              SETC  '"COUNTERS='            *KPOSA* MNOTE           00088300
&ZMS              SETC  '&ZMS.&COUNTERS"'                               00088400
&ZMS              SETC  '&ZMS "COUNTERS"'                               00088500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00088600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00088700
.ZG11A            ANOP  ,                                               00088800
.*------------------------------------------------------------------    00088900
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00089000
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00089100
.ZG11A0           AIF   (K'&COUNTERLIST LE 0).ZG11A1  OK                00089200
&ZCVAL            SETC '&ZCVAL COUNTERLIST'     INCORRECT KEY USED      00089300
.ZG11A1           AIF   (K'&ZCVAL LE 0).ZG11A2  OK                      00089400
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00089500
&ZMS              SETC  '"COUNTERS'             *KMEIA* MNOTE           00089600
&ZMS              SETC  '&ZMS.=&COUNTERS"'                              00089700
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00089800
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00089900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00090000
.ZG11A2           ANOP  ,                                               00090100
.*-------------------------------------------------------------------   00090200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00090300
.ZG12             ANOP  ,                                               00090400
&ZTLC             SETC 'ALL'                                            00090500
                  AIF   ('&COUNTERS(1)' NE '&ZTLC').ZG13                00090600
&XCOUNTERS        SETC  'ALL'       SET KEYWORD                         00090700
                  AIF   (N'&COUNTERS LE 1).ZG12A  CK NUM                00090800
&ZMS              SETC  '"COUNTERS='            *KPOSA* MNOTE           00090900
&ZMS              SETC  '&ZMS.&COUNTERS"'                               00091000
&ZMS              SETC  '&ZMS "COUNTERS"'                               00091100
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00091200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00091300
.ZG12A            ANOP  ,                                               00091400
.*------------------------------------------------------------------    00091500
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00091600
&ZCVAL            SETC ''           CLEAR ERROR KEY ACCUMULATOR         00091700
.ZG12A0           AIF   (K'&COUNTERLIST LE 0).ZG12A1  OK                00091800
&ZCVAL            SETC '&ZCVAL COUNTERLIST'     INCORRECT KEY USED      00091900
.ZG12A1           AIF   (K'&ZCVAL LE 0).ZG12A2  OK                      00092000
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)                           00092100
&ZMS              SETC  '"COUNTERS'             *KMEIA* MNOTE           00092200
&ZMS              SETC  '&ZMS.=&COUNTERS"'                              00092300
&ZMS              SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'            00092400
                  MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'            00092500
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00092600
.ZG12A2           ANOP  ,                                               00092700
.*-------------------------------------------------------------------   00092800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092900
.ZG13             ANOP  ,                                               00093000
&ZTLC             SETC 'LIST'                                           00093100
                  AIF   ('&COUNTERS(1)' NE '&ZTLC').ZG17                00093200
&XCOUNTERS        SETC  'LIST'      SET KEYWORD                         00093300
                  AIF   (N'&COUNTERS LE 1).ZG13A  CK NUM                00093400
&ZMS              SETC  '"COUNTERS='            *KPOSA* MNOTE           00093500
&ZMS              SETC  '&ZMS.&COUNTERS"'                               00093600
&ZMS              SETC  '&ZMS "COUNTERS"'                               00093700
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00093800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00093900
.ZG13A            ANOP  ,                                               00094000
.*----------------------------------------------------------------***   00094100
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00094200
                  AIF   (N'&COUNTERLIST LE 1).ZG15A  CK NUM             00094300
&ZMS              SETC  '"COUNTERLIST='         *KPOSA* MNOTE           00094400
&ZMS              SETC  '&ZMS.&COUNTERLIST"'                            00094500
&ZMS              SETC  '&ZMS "COUNTERLIST"'                            00094600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00094700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00094800
.ZG15A            ANOP  ,                                               00094900
.*-------------------------------------------------------------------   00095000
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00095100
&ZXCOUNTERLIST    SETC  'INPUT'     SET IN/OUTPUT                       00095200
&XCOUNTERLIST     SETC  '&COUNTERLIST(1)'       SET XVARIABLE           00095300
                  AIF   (N'&COUNTERLIST GT 1).ZG15B  MULTI PARMS        00095400
&XCOUNTERLIST     SETC  '&COUNTERLIST'          SET XVARIABLE           00095500
.ZG15B            AIF   (K'&COUNTERLIST(1) GT 0).ZG15C                  00095600
&ZXCOUNTERLIST    SETC  ''          RESET IN/OUTPUT                     00095700
&ZMS              SETC  'WHEN "LIST" IS SPECIFIED'  *KRQDA*             00095800
&ZMS              SETC  '&ZMS , "COUNTERLIST" KEY AND ITS'              00095900
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00096000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00096100
.ZG15C            ANOP  ,                                               00096200
.*-------------------------------------------------------------------   00096300
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00096400
                  AIF   (K'&ZXCOUNTERLIST LE 0).ZG15R  NOT I/O          00096500
                  AIF   ('&XCOUNTERLIST'(1,1) NE '(').ZG15R             00096600
&ZCGPR            SETC  '&XCOUNTERLIST'(2,K'&XCOUNTERLIST-2)            00096700
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG15P                    00096800
                  AIF   (K'&ZCGPR GT 2).ZG15Q                           00096900
                  AIF   ('&ZCGPR' EQ '0').ZG15Q                         00097000
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00097100
                  AIF   (T'&ZCGPR NE 'N').ZG15Q  INVALID REG NAME       00097200
.ZG15P            ANOP  ,                                               00097300
                  AIF   (T'&ZCGPR NE 'N').ZG15R  NON NUMERIC            00097400
                  AIF   ('&ZCGPR' LT '2').ZG15Q                         00097500
                  AIF   ('&ZCGPR' LE '12').ZG15R                        00097600
.ZG15Q            ANOP  ,                                               00097700
&ZMS              SETC  '"COUNTERLIST='         *KGPRA* MNOTE           00097800
&ZMS              SETC  '&ZMS.&COUNTERLIST"'                            00097900
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00098000
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00098100
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00098200
.ZG15R            ANOP  ,                                               00098300
.*------------------------------------------------------------------    00098400
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098500
.ZG17             ANOP  ,                                               00098600
&ZXCOUNTERS       SETC  'INPUT'     SET IN/OUTPUT                       00098700
                  AIF   (K'&XCOUNTERS GT 0).ZG17E  VALID ARG            00098800
                  AIF   (T'&COUNTERS EQ 'O').ZG17D  OMITTED             00098900
&ZASYSLNDX        SETA  0                                               00099000
.ZG17A            ANOP  ,           POSITIONAL MACRO KEY                00099100
&ZASYSLNDX        SETA  &ZASYSLNDX+1                                    00099200
                  AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG17C                00099300
&ZTLC             SETC 'COUNTERS'                                       00099400
                  AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG17A       00099500
.ZG17B            ANOP  ,                                               00099600
&ZXCOUNTERS       SETC  ''          RESET IN/OUTPUT                     00099700
&ZMS              SETC  'THE "COUNTERS" KEY'    *KOPTA* MNOTE           00099800
&ZMS              SETC  '&ZMS MUST CONTAIN ONE'                         00099900
                  MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                00100000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00100100
                  AGO   .ZG17E                                          00100200
.ZG17C            ANOP  ,                                               00100300
&ZXCOUNTERS       SETC  ''          RESET IN/OUTPUT                     00100400
&ZMS              SETC  '"COUNTERS='            *KUKWA* MNOTE           00100500
&ZMS              SETC  '&ZMS.&COUNTERS"'                               00100600
&ZMS              SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '       00100700
&ZMS              SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'             00100800
&ZMS              SETC  '&ZMS "DEFAULT",'                               00100900
&ZMS              SETC  '&ZMS "ALL",'                                   00101000
&ZMS              SETC  '&ZMS OR "LIST".'                               00101100
                  MNOTE 8,' &ZMS '                                      00101200
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00101300
                  AGO   .ZG17E                                          00101400
.ZG17D            ANOP  ,                                               00101500
&XCOUNTERS        SETC  'DEFAULT'   SET DEFAULT KEYWORD                 00101600
.ZG17E            ANOP  ,                                               00101700
.*----------------------------------------------------------------***   00101800
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00101900
                  AIF   (N'&SUBPOOL LE 1).ZG19A  CK NUM                 00102000
&ZMS              SETC  '"SUBPOOL='             *KPOSA* MNOTE           00102100
&ZMS              SETC  '&ZMS.&SUBPOOL"'                                00102200
&ZMS              SETC  '&ZMS "SUBPOOL"'                                00102300
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00102400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00102500
.ZG19A            ANOP  ,                                               00102600
.*-------------------------------------------------------------------   00102700
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00102800
&ZXSUBPOOL        SETC  'INPUT'     SET IN/OUTPUT                       00102900
&XSUBPOOL         SETC  '0'                                             00103000
                  AIF   (K'&SUBPOOL(1) LE 0).ZG19B  PARM                00103100
&XSUBPOOL         SETC  '&SUBPOOL(1)'           SET XVARIABLE           00103200
                  AIF   (N'&SUBPOOL GT 1).ZG19B  MULTI PARMS            00103300
&XSUBPOOL         SETC  '&SUBPOOL'  SET XVARIABLE                       00103400
.ZG19B            ANOP  ,                                               00103500
.*-------------------------------------------------------------------   00103600
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00103700
                  AIF   (K'&ZXSUBPOOL LE 0).ZG19R  NOT I/O              00103800
                  AIF   ('&XSUBPOOL'(1,1) NE '(').ZG19R                 00103900
&ZCGPR            SETC  '&XSUBPOOL'(2,K'&XSUBPOOL-2)                    00104000
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG19P                    00104100
                  AIF   (K'&ZCGPR GT 2).ZG19Q                           00104200
                  AIF   ('&ZCGPR' EQ '0').ZG19Q                         00104300
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00104400
                  AIF   (T'&ZCGPR NE 'N').ZG19Q  INVALID REG NAME       00104500
.ZG19P            ANOP  ,                                               00104600
                  AIF   (T'&ZCGPR NE 'N').ZG19R  NON NUMERIC            00104700
                  AIF   ('&ZCGPR' LT '2').ZG19Q                         00104800
                  AIF   ('&ZCGPR' LE '12').ZG19R                        00104900
.ZG19Q            ANOP  ,                                               00105000
&ZMS              SETC  '"SUBPOOL='             *KGPRA* MNOTE           00105100
&ZMS              SETC  '&ZMS.&SUBPOOL"'                                00105200
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00105300
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00105400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00105500
.ZG19R            ANOP  ,                                               00105600
.*----------------------------------------------------------------***   00105700
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00105800
                  AIF   (N'&FSDADDRESS LE 1).ZG22A  CK NUM              00105900
&ZMS              SETC  '"FSDADDRESS='          *KPOSA* MNOTE           00106000
&ZMS              SETC  '&ZMS.&FSDADDRESS"'                             00106100
&ZMS              SETC  '&ZMS "FSDADDRESS"'                             00106200
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00106300
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00106400
.ZG22A            ANOP  ,                                               00106500
.*-------------------------------------------------------------------   00106600
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00106700
&ZXFSDADDRESS     SETC  'OUTPUT'    SET IN/OUTPUT                       00106800
&XFSDADDRESS      SETC  '&FSDADDRESS(1)'        SET XVARIABLE           00106900
                  AIF   (N'&FSDADDRESS GT 1).ZG22B  MULTI PARMS         00107000
&XFSDADDRESS      SETC  '&FSDADDRESS'           SET XVARIABLE           00107100
.ZG22B            AIF   (K'&FSDADDRESS(1) GT 0).ZG22C                   00107200
&ZXFSDADDRESS     SETC  ''          RESET IN/OUTPUT                     00107300
&ZMS              SETC  ' '         *KRQDA*                             00107400
&ZMS              SETC  '&ZMS "FSDADDRESS" KEY AND ITS'                 00107500
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00107600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00107700
.ZG22C            ANOP  ,                                               00107800
.*-------------------------------------------------------------------   00107900
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00108000
                  AIF   (K'&ZXFSDADDRESS LE 0).ZG22R  NOT I/O           00108100
                  AIF   ('&XFSDADDRESS'(1,1) NE '(').ZG22R              00108200
&ZCGPR            SETC  '&XFSDADDRESS'(2,K'&XFSDADDRESS-2)              00108300
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG22P                    00108400
                  AIF   (K'&ZCGPR GT 2).ZG22Q                           00108500
                  AIF   ('&ZCGPR' EQ '0').ZG22Q                         00108600
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00108700
                  AIF   (T'&ZCGPR NE 'N').ZG22Q  INVALID REG NAME       00108800
.ZG22P            ANOP  ,                                               00108900
                  AIF   (T'&ZCGPR NE 'N').ZG22R  NON NUMERIC            00109000
                  AIF   ('&ZCGPR' LT '2').ZG22Q                         00109100
                  AIF   ('&ZCGPR' LE '12').ZG22R                        00109200
.ZG22Q            ANOP  ,                                               00109300
&ZMS              SETC  '"FSDADDRESS='          *KGPRA* MNOTE           00109400
&ZMS              SETC  '&ZMS.&FSDADDRESS"'                             00109500
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00109600
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00109700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00109800
.ZG22R            ANOP  ,                                               00109900
.*----------------------------------------------------------------***   00110000
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00110100
                  AIF   (N'&FSDLENGTH LE 1).ZG25A  CK NUM               00110200
&ZMS              SETC  '"FSDLENGTH='           *KPOSA* MNOTE           00110300
&ZMS              SETC  '&ZMS.&FSDLENGTH"'                              00110400
&ZMS              SETC  '&ZMS "FSDLENGTH"'                              00110500
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00110600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00110700
.ZG25A            ANOP  ,                                               00110800
.*-------------------------------------------------------------------   00110900
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00111000
&ZXFSDLENGTH      SETC  'OUTPUT'    SET IN/OUTPUT                       00111100
&XFSDLENGTH       SETC  '&FSDLENGTH(1)'         SET XVARIABLE           00111200
                  AIF   (N'&FSDLENGTH GT 1).ZG25B  MULTI PARMS          00111300
&XFSDLENGTH       SETC  '&FSDLENGTH'            SET XVARIABLE           00111400
.ZG25B            AIF   (K'&FSDLENGTH(1) GT 0).ZG25C                    00111500
&ZXFSDLENGTH      SETC  ''          RESET IN/OUTPUT                     00111600
&ZMS              SETC  ' '         *KRQDA*                             00111700
&ZMS              SETC  '&ZMS "FSDLENGTH" KEY AND ITS'                  00111800
                  MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                00111900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00112000
.ZG25C            ANOP  ,                                               00112100
.*-------------------------------------------------------------------   00112200
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00112300
                  AIF   (K'&ZXFSDLENGTH LE 0).ZG25R  NOT I/O            00112400
                  AIF   ('&XFSDLENGTH'(1,1) NE '(').ZG25R               00112500
&ZCGPR            SETC  '&XFSDLENGTH'(2,K'&XFSDLENGTH-2)                00112600
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                    00112700
                  AIF   (K'&ZCGPR GT 2).ZG25Q                           00112800
                  AIF   ('&ZCGPR' EQ '0').ZG25Q                         00112900
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00113000
                  AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME       00113100
.ZG25P            ANOP  ,                                               00113200
                  AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC            00113300
                  AIF   ('&ZCGPR' LT '2').ZG25Q                         00113400
                  AIF   ('&ZCGPR' LE '12').ZG25R                        00113500
.ZG25Q            ANOP  ,                                               00113600
&ZMS              SETC  '"FSDLENGTH='           *KGPRA* MNOTE           00113700
&ZMS              SETC  '&ZMS.&FSDLENGTH"'                              00113800
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00113900
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00114000
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00114100
.ZG25R            ANOP  ,                                               00114200
.*----------------------------------------------------------------***   00114300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00114400
                  AIF   (N'&RETCODE LE 1).ZG28A  CK NUM                 00114500
&ZMS              SETC  '"RETCODE='             *KPOSA* MNOTE           00114600
&ZMS              SETC  '&ZMS.&RETCODE"'                                00114700
&ZMS              SETC  '&ZMS "RETCODE"'                                00114800
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00114900
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00115000
.ZG28A            ANOP  ,                                               00115100
.*-------------------------------------------------------------------   00115200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00115300
                  AIF   (K'&RETCODE(1) LE 0).ZG28C  NO PARM             00115400
&ZXRETCODE        SETC  'OUTPUT'    SET OUTPUT                          00115500
&XRETCODE         SETC  '&RETCODE(1)'           SET XVARIABLE           00115600
                  AIF   (N'&RETCODE GT 1).ZG28C                         00115700
&XRETCODE         SETC  '&RETCODE'  SET XVARIABLE                       00115800
.ZG28C            ANOP  ,                                               00115900
.*-------------------------------------------------------------------   00116000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00116100
                  AIF   (K'&ZXRETCODE LE 0).ZG28R  NOT I/O              00116200
                  AIF   ('&XRETCODE'(1,1) NE '(').ZG28R                 00116300
&ZCGPR            SETC  '&XRETCODE'(2,K'&XRETCODE-2)                    00116400
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                    00116500
                  AIF   (K'&ZCGPR GT 2).ZG28Q                           00116600
                  AIF   ('&ZCGPR' EQ '0').ZG28Q                         00116700
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00116800
                  AIF   (T'&ZCGPR NE 'N').ZG28Q  INVALID REG NAME       00116900
.ZG28P            ANOP  ,                                               00117000
                  AIF   (T'&ZCGPR NE 'N').ZG28R  NON NUMERIC            00117100
                  AIF   ('&ZCGPR' LT '2').ZG28Q                         00117200
                  AIF   ('&ZCGPR' LE '12').ZG28R                        00117300
.ZG28Q            ANOP  ,                                               00117400
&ZMS              SETC  '"RETCODE='             *KGPRA* MNOTE           00117500
&ZMS              SETC  '&ZMS.&RETCODE"'                                00117600
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00117700
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00117800
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00117900
.ZG28R            ANOP  ,                                               00118000
.*----------------------------------------------------------------***   00118100
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00118200
                  AIF   (N'&RSNCODE LE 1).ZG31A  CK NUM                 00118300
&ZMS              SETC  '"RSNCODE='             *KPOSA* MNOTE           00118400
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00118500
&ZMS              SETC  '&ZMS "RSNCODE"'                                00118600
                  MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'             00118700
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00118800
.ZG31A            ANOP  ,                                               00118900
.*-------------------------------------------------------------------   00119000
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00119100
                  AIF   (K'&RSNCODE(1) LE 0).ZG31C  NO PARM             00119200
&ZXRSNCODE        SETC  'OUTPUT'    SET OUTPUT                          00119300
&XRSNCODE         SETC  '&RSNCODE(1)'           SET XVARIABLE           00119400
                  AIF   (N'&RSNCODE GT 1).ZG31C                         00119500
&XRSNCODE         SETC  '&RSNCODE'  SET XVARIABLE                       00119600
.ZG31C            ANOP  ,                                               00119700
.*-------------------------------------------------------------------   00119800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00119900
                  AIF   (K'&ZXRSNCODE LE 0).ZG31R  NOT I/O              00120000
                  AIF   ('&XRSNCODE'(1,1) NE '(').ZG31R                 00120100
&ZCGPR            SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                    00120200
                  AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                    00120300
                  AIF   (K'&ZCGPR GT 2).ZG31Q                           00120400
                  AIF   ('&ZCGPR' EQ '0').ZG31Q                         00120500
&ZCGPR            SETC  '&ZCGPR'(2,1)                                   00120600
                  AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME       00120700
.ZG31P            ANOP  ,                                               00120800
                  AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC            00120900
                  AIF   ('&ZCGPR' LT '2').ZG31Q                         00121000
                  AIF   ('&ZCGPR' LE '12').ZG31R                        00121100
.ZG31Q            ANOP  ,                                               00121200
&ZMS              SETC  '"RSNCODE='             *KGPRA* MNOTE           00121300
&ZMS              SETC  '&ZMS.&RSNCODE"'                                00121400
&ZMS              SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'       00121500
                  MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                00121600
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00121700
.ZG31R            ANOP  ,                                               00121800
.******************************************************************     00121900
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00122000
.******************************************************************     00122100
                  ACTR  10000                                           00122200
.*----------------------------------------------------------------***   00122300
.***AH.P02 EXTRA POSITIONALS                                            00122400
                  AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS            00122500
                  AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL            00122600
                  AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL        00122700
                  AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL         00122800
.ZGLISTX1         ANOP  ,                                               00122900
&ZCVAL            SETC  ''          ERROR FIELD                         00123000
&ZAWRK            SETA  0           POSITIONAL NUMBER                   00123100
.ZGLIST2          ANOP  ,                                               00123200
&ZAWRK            SETA  &ZAWRK+1    NEXT POSITIONAL                     00123300
                  AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE            00123400
&ZCVAL            SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                 00123500
                  AGO   .ZGLIST2                                        00123600
.*                                                                      00123700
.ZGLIST3          ANOP  ,                                               00123800
&ZCVAL            SETC '&ZCVAL'(2,K'&ZCVAL-1)   STRIP COMMA             00123900
&ZMS              SETC  'POSITIONAL ARGUMENT(S),'  *PPOSA* MNOTE        00124000
&ZMS              SETC  '&ZMS "&ZCVAL"'                                 00124100
&ZMS              SETC  '&ZMS CANNOT BE USED.'                          00124200
&ZMS              SETC  '&ZMS NO POSITIONAL ARGUMENTS'                  00124300
                  MNOTE 8,' &ZMS ARE ALLOWED.'                          00124400
&ZMACRET          SETA  8           SET MACRO ERROR RETURN CODE         00124500
.ZGLISTX          ANOP  ,                                               00124600
&ZASYSLNDX        SETA  0                                               00124700
.*-------------------------------------------------------------------   00124800
.***AG.MF04 MF=(SLE)                                                    00124900
.ZGMFX            ANOP  ,           END OF FULL SYNTAX CHECK            00125000
.*******************************************************************    00125100
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00125200
.*******************************************************************    00125300
                  AIF   (&ZMACRET NE 0).ZLX2    ERROR DETECTED          00125400
.*******************************************************************    00125500
.***AE.01  START OF IRDFSD MACRO CODE                                   00125600
.*******************************************************************    00125700
                  LCLC  &M0M0001                 NAME                   00125800
&M0M0001          SETC  '&XLABEL'                SET NAME               00125900
                  AIF   (K'&XLABEL NE 0).XLAB2                          00126000
&M0M0001          SETC  'M00M&SYSNDX'            DEFAULT NAME           00126100
.*                                                                      00126200
.XLAB2            ANOP  ,                                               00126300
                  AIF   ('&XMF' EQ 'L').XLAB3                           00126400
&M0M0001 DS    0H                             IRDFSD-1                  00126500
.XLAB3            ANOP  ,                                               00126600
.*******************************************************************    00126700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00126800
.*******************************************************************    00126900
              PUSH  PRINT                                               00127000
                  AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON      00127100
                  PRINT OFF         ++ PR01                             00127200
                  AGO   .ZPRNTXX                                        00127300
.ZPRINTX          PRINT ON                                              00127400
.ZPRNTXX          ANOP  ,                                               00127500
.********************************************************************   00127600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00127700
.********************************************************************   00127800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00127900
                      LCLA  &ZOPN1         INVOCATION INDEX             00128000
                      LCLC  &ZOPL(4095)    LABEL                        00128100
                      LCLC  &ZOPO(4095)    OPERATION                    00128200
                      LCLC  &ZOPV(4095)    VALUE                        00128300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00128400
.*                                                                      00128500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00128600
.******************************************************************     00128700
.***AL.L10 IRDFSD FMT=LIST MF=S!L PARAMETERS                            00128800
.******************************************************************     00128900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00129000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00129100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(1,4).'A'                     00129200
&XMFATTR              SETC  '0D'                                        00129300
.*                                                                      00129400
&ZOPN                 SETA  &ZOPN+1                                     00129500
&ZOPL(&ZOPN)          SETC  ' '                                         00129600
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00129700
&ZOPO(&ZOPN)          SETC  'B'                                         00129800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00129900
                      AGO   .ZALVL6B                                    00130000
.ZALVL6A              ANOP                                              00130100
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00130200
&ZOPV(&ZOPN)          SETC  '4,8'                                       00130300
&ZOPN                 SETA  &ZOPN+1                                     00130400
&ZOPL(&ZOPN)          SETC  ' '                                         00130500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00130600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00130700
.ZALVL6B              ANOP                                              00130800
&ZOPD(&ZOPN)          SETC  '++ IRDFSD ARG PARMS'                       00130900
.*                                                                      00131000
&ZOPN                 SETA  &ZOPN+1                                     00131100
&ZOPL(&ZOPN)          SETC  ' '                                         00131200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00131300
&ZOPV(&ZOPN)          SETC  '1'                                         00131400
&ZOPD(&ZOPN)          SETC  ' '                                         00131500
.*                                                                      00131600
.ZLMFSL2              ANOP  ,                                           00131700
.*-------------------------------------------------------------------   00131800
.***AM.L00  IRDFSD FMT=LIST name                                        00131900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00132000
&ZOPN                 SETA &ZOPN+1                                      00132100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00132200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00132300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00132400
&ZOPD(&ZOPN)          SETC '++ IRDFSD NAME'                             00132500
.ZLMFSL2M             ANOP  ,                                           00132600
.*-------------------------------------------------------------------   00132700
.***AM.L01  IRDFSD FMT=LIST PARAMETERS                                  00132800
&ZOPN                 SETA &ZOPN+1                                      00132900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00133000
&ZOPO(&ZOPN)          SETC 'DS'                                         00133100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00133200
&ZOPD(&ZOPN)          SETC '++ IRDFSD PARM LIST'                        00133300
.*-------------------------------------------------------------------   00133400
.***AM.L02 XVERSION XL1                                                 00133500
&ZOPN                 SETA &ZOPN+1                                      00133600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00133700
&ZOPO(&ZOPN)          SETC 'DS'                                         00133800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00133900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00134000
.*-------------------------------------------------------------------   00134100
.***AM.L09  XFUNCTION XL1                                               00134200
&ZOPN                 SETA &ZOPN+1                                      00134300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFUNCTION'                        00134400
&ZOPO(&ZOPN)          SETC 'DS'                                         00134500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00134600
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XFUNCTION'                     00134700
.*-------------------------------------------------------------------   00134800
.***AM.L09  XPLISTLEN XL2                                               00134900
&ZOPN                 SETA &ZOPN+1                                      00135000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTLEN'                        00135100
&ZOPO(&ZOPN)          SETC 'DS'                                         00135200
&ZOPV(&ZOPN)          SETC 'XL2'                                        00135300
&ZOPD(&ZOPN)          SETC '++ INPUT  XPLISTLEN'                        00135400
.*-------------------------------------------------------------------   00135500
.***AM.L03 XFLAG BL.8                                                   00135600
&ZOPN                 SETA &ZOPN+1                                      00135700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAG'                            00135800
&ZOPO(&ZOPN)          SETC 'DS'                                         00135900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00136000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00136100
.*                                                                      00136200
&ZOPN                 SETA  &ZOPN+1                                     00136300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XDEVICE_ALL'                     00136400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00136500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00136600
&ZOPD(&ZOPN)          SETC  '++ XDEVICE.'                               00136700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ALL'                          00136800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00136900
.*                                                                      00137000
&ZOPN                 SETA  &ZOPN+1                                     00137100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCOUNTERS_DEFAULT'               00137200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00137300
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00137400
&ZOPD(&ZOPN)          SETC  '++ XCOUNTERS.'                             00137500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).DEFAULT'                      00137600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00137700
.*                                                                      00137800
&ZOPN                 SETA  &ZOPN+1                                     00137900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCOUNTERS_ALL'                   00138000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00138100
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00138200
&ZOPD(&ZOPN)          SETC  '++ XCOUNTERS.'                             00138300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ALL'                          00138400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00138500
.*                                                                      00138600
&ZOPN                 SETA  &ZOPN+1                                     00138700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCOUNTERS_LIST'                  00138800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00138900
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00139000
&ZOPD(&ZOPN)          SETC  '++ XCOUNTERS.'                             00139100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LIST'                         00139200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00139300
.*-------------------------------------------------------------------   00139400
.***AM.L09  XRSV0001 CL02                                               00139500
&ZOPN                 SETA &ZOPN+1                                      00139600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00139700
&ZOPO(&ZOPN)          SETC 'DS'                                         00139800
&ZOPV(&ZOPN)          SETC 'CL02'                                       00139900
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      00140000
.*-------------------------------------------------------------------   00140100
.***AM.L09  XSUBPOOL XL1                                                00140200
&ZOPN                 SETA &ZOPN+1                                      00140300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSUBPOOL'                         00140400
&ZOPO(&ZOPN)          SETC 'DS'                                         00140500
&ZOPV(&ZOPN)          SETC 'XL1'                                        00140600
&ZOPD(&ZOPN)          SETC '++ &ZXSUBPOOL  XSUBPOOL'                    00140700
.*-------------------------------------------------------------------   00140800
.***AM.L09  XRSV0002 CL02                                               00140900
&ZOPN                 SETA &ZOPN+1                                      00141000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         00141100
&ZOPO(&ZOPN)          SETC 'DS'                                         00141200
&ZOPV(&ZOPN)          SETC 'CL02'                                       00141300
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      00141400
.*-------------------------------------------------------------------   00141500
.***AM.L09  XDEVICENUMBER XL2                                           00141600
&ZOPN                 SETA &ZOPN+1                                      00141700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDEVICENUMBER'                    00141800
&ZOPO(&ZOPN)          SETC 'DS'                                         00141900
&ZOPV(&ZOPN)          SETC 'XL2'                                        00142000
&ZOPD(&ZOPN)          SETC '++ &ZXDEVICENUMBER  XDEVICENUMBER'          00142100
.*-------------------------------------------------------------------   00142200
.***AM.L09  XCOUNTERLIST A                                              00142300
&ZOPN                 SETA &ZOPN+1                                      00142400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCOUNTERLIST'                     00142500
&ZOPO(&ZOPN)          SETC 'DS'                                         00142600
&ZOPV(&ZOPN)          SETC 'A'                                          00142700
&ZOPD(&ZOPN)          SETC '++ &ZXCOUNTERLIST  XCOUNTERLIST'            00142800
.*-------------------------------------------------------------------   00142900
.***AM.L09  XFSDADDRESS A                                               00143000
&ZOPN                 SETA &ZOPN+1                                      00143100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFSDADDRESS'                      00143200
&ZOPO(&ZOPN)          SETC 'DS'                                         00143300
&ZOPV(&ZOPN)          SETC 'A'                                          00143400
&ZOPD(&ZOPN)          SETC '++ &ZXFSDADDRESS  XFSDADDRESS'              00143500
.*-------------------------------------------------------------------   00143600
.***AM.L09  XFSDLENGTH F                                                00143700
&ZOPN                 SETA &ZOPN+1                                      00143800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFSDLENGTH'                       00143900
&ZOPO(&ZOPN)          SETC 'DS'                                         00144000
&ZOPV(&ZOPN)          SETC 'F'                                          00144100
&ZOPD(&ZOPN)          SETC '++ &ZXFSDLENGTH  XFSDLENGTH'                00144200
.*-------------------------------------------------------------------   00144300
.***AM.L10 END OF IRDFSD LIST PARAMETERS                                00144400
&ZOPN                 SETA &ZOPN+1                                      00144500
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00144600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00144700
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00144800
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00144900
.*                                                                      00145000
&ZOPN                 SETA &ZOPN+1                                      00145100
&ZOPL(&ZOPN)          SETC ' '                                          00145200
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00145300
&ZOPV(&ZOPN)          SETC '1'                                          00145400
&ZOPD(&ZOPN)          SETC ' '                                          00145500
.*-------------------------------------------------------------------   00145600
.***AL.L12 IRDFSD FMT=LIST MF=S!L PARAMETERS                            00145700
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00145800
.*                                                                      00145900
&ZOPN                 SETA  &ZOPN+1                                     00146000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00146100
&ZOPO(&ZOPN)          SETC  'DC'                                        00146200
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00146300
&ZOPD(&ZOPN)          SETC  '++ IRDFSD ARG PARMS'                       00146400
.*                                                                      00146500
.ZLMFSLX              ANOP  ,                                           00146600
.*-------------------------------------------------------------------   00146700
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00146800
&ZPLLEN               SETA 24                                           00146900
.*                                                                      00147000
.******************************************************************     00147100
.***AI.L01 IRDFSD FMT=LIST FILL IN PARAMETER AREA                       00147200
.******************************************************************     00147300
                      ACTR  10000                                       00147400
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00147500
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00147600
&ZCVAL                SETC  'LAE'          XAX MODE                     00147700
.ZIMFXA               ANOP ,                                            00147800
.*                                                                      00147900
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00148000
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00148100
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00148200
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00148300
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00148400
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00148500
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00148600
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00148700
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00148800
&ZOPN                 SETA  &ZOPN+1                                     00148900
&ZOPL(&ZOPN)          SETC  ' '                                         00149000
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00149100
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00149200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00149300
                      AGO   .ZIMFNX                                     00149400
.*                                                                      00149500
.ZIMFN2               ANOP ,                                            00149600
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00149700
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00149800
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00149900
&ZOPN                 SETA  &ZOPN+1                                     00150000
&ZOPL(&ZOPN)          SETC  ' '                                         00150100
&ZOPO(&ZOPN)          SETC  'LAE'                                       00150200
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00150300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00150400
                      AGO   .ZIMFNX                                     00150500
.ZIMFNX1              ANOP ,                                            00150600
&ZOPN                 SETA  &ZOPN+1                                     00150700
&ZOPL(&ZOPN)          SETC  ' '                                         00150800
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00150900
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00151000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00151100
.ZIMFNX               ANOP ,                                            00151200
.********************************************************************   00151300
.***AI.L02 IRDFSD FMT=LIST INITIALIZE PARAMETER AREA                    00151400
.********************************************************************   00151500
.***AI.L03 MF=(SLE)                                                     00151600
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00151700
.*                                                                      00151800
&ZOPN                 SETA  &ZOPN+1                                     00151900
&ZOPL(&ZOPN)          SETC  ' '                                         00152000
&ZOPO(&ZOPN)          SETC  'XC'                                        00152100
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00152200
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00152300
.ZIMFLX               ANOP  ,                                           00152400
.*-------------------------------------------------------------------   00152500
.***AI.L04B XVERSION XL1                                                00152600
                      AIF   (&XPLISTVER EQ 0).ZIMFVZ                    00152700
&ZOPN                 SETA  &ZOPN+1                                     00152800
&ZOPL(&ZOPN)          SETC  ' '                                         00152900
&ZOPO(&ZOPN)          SETC  'MVI'                                       00153000
&ZOPV(&ZOPN)          SETC  '0(1),&XPLISTVER'                           00153100
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     00153200
.ZIMFVZ               ANOP  ,                                           00153300
.*-------------------------------------------------------------------   00153400
.***AI.L53 XFUNCTION XL1                                                00153500
&ZOPN                 SETA  &ZOPN+1                                     00153600
&ZOPL(&ZOPN)          SETC  ' '                                         00153700
&ZOPO(&ZOPN)          SETC  'MVI'                                       00153800
&ZOPV(&ZOPN)          SETC  '1(1),1'                                    00153900
&ZOPD(&ZOPN)          SETC  '++ XL1 CONSTANT'                           00154000
.*-------------------------------------------------------------------   00154100
.***AI.L04 XPLISTLEN XL2                                                00154200
&ZOPN                 SETA  &ZOPN+1                                     00154300
&ZOPL(&ZOPN)          SETC  ' '                                         00154400
&ZOPO(&ZOPN)          SETC  'MVC'                                       00154500
&ZOPV(&ZOPN)          SETC  '2(2,1),=AL2(&ZPLLEN)'                      00154600
&ZOPD(&ZOPN)          SETC  '++ INPUT XPLISTLEN XL2'                    00154700
.*-------------------------------------------------------------------   00154800
.***AI.L05 XFLAG BL1                                                    00154900
&ZW                   SETC  ''                                          00155000
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00155100
.*-------------------------------------------------------------------   00155200
.***AI.L08 XFLAG "ALL"                                                  00155300
.***      BL1'1XXXXXXX'                                                 00155400
         AIF   ('&XDEVICE' NE 'ALL').ZI5A                               00155500
&ZW                   SETC  '&ZW.1'                                     00155600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00155700
                      AGO   .ZI5C                                       00155800
.*                                                                      00155900
.ZI5A                 ANOP  ,                                           00156000
&ZW                   SETC  '&ZW.0'                                     00156100
.ZI5C                 ANOP  ,                                           00156200
.*-------------------------------------------------------------------   00156300
.***AI.L08 XFLAG "DEFAULT"                                              00156400
.***      BL1'X1XXXXXX'                                                 00156500
         AIF   ('&XCOUNTERS' NE 'DEFAULT').ZI6A                         00156600
&ZW                   SETC  '&ZW.1'                                     00156700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00156800
                      AGO   .ZI6C                                       00156900
.*                                                                      00157000
.ZI6A                 ANOP  ,                                           00157100
&ZW                   SETC  '&ZW.0'                                     00157200
.ZI6C                 ANOP  ,                                           00157300
.*-------------------------------------------------------------------   00157400
.***AI.L08 XFLAG "ALL"                                                  00157500
.***      BL1'XX1XXXXX'                                                 00157600
         AIF   ('&XCOUNTERS' NE 'ALL').ZI7A                             00157700
&ZW                   SETC  '&ZW.1'                                     00157800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00157900
                      AGO   .ZI7C                                       00158000
.*                                                                      00158100
.ZI7A                 ANOP  ,                                           00158200
&ZW                   SETC  '&ZW.0'                                     00158300
.ZI7C                 ANOP  ,                                           00158400
.*-------------------------------------------------------------------   00158500
.***AI.L08 XFLAG "LIST"                                                 00158600
.***      BL1'XXX1XXXX'                                                 00158700
         AIF   ('&XCOUNTERS' NE 'LIST').ZI8A                            00158800
&ZW                   SETC  '&ZW.10000'                                 00158900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00159000
                      AGO   .ZI8C                                       00159100
.*                                                                      00159200
.ZI8A                 ANOP  ,                                           00159300
&ZW                   SETC  '&ZW.00000'                                 00159400
.ZI8C                 ANOP  ,                                           00159500
.*-------------------------------------------------------------------   00159600
.***AI.L11 XFLAG BL1                                                    00159700
                      AIF   ('&ZCLNG' NE 'YES').ZI8E  ALL ZERO BITS     00159800
&ZOPN                 SETA  &ZOPN+1                                     00159900
&ZOPL(&ZOPN)          SETC  ' '                                         00160000
&ZOPO(&ZOPN)          SETC  'OI'                                        00160100
&ZOPV(&ZOPN)          SETC  '4(1),B''&ZW'''                             00160200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00160300
.ZI8E                 ANOP  ,                                           00160400
.*-------------------------------------------------------------------   00160500
.***AI.L25  XSUBPOOL XL1                                                00160600
                      AIF   ('&ZXSUBPOOL' EQ '').ZI10E                  00160700
                      AIF   ('&ZXSUBPOOL' EQ 'OUTPUT').ZI10E            00160800
&ZCGPR                SETC  '&XSUBPOOL'                                 00160900
         AIF   ('&XSUBPOOL' EQ '0').ZI10E                               00161000
         AIF   ('&XSUBPOOL' EQ '0').ZI10E                               00161100
.*                                                                      00161200
                      AIF   ('&XSUBPOOL'(1,1) NE '(').ZI10B             00161300
&ZCGPR   SETC  '0('.'&XSUBPOOL'(2,K'&XSUBPOOL-2).')'                    00161400
                      AGO   .ZI10D                                      00161500
.ZI10B                ANOP  ,                                           00161600
.*                                                                      00161700
&ZC                   SETC  '&XSUBPOOL'(1,1)                            00161800
                      AIF   (T'&ZC NE 'N').ZI10D                        00161900
&ZC                   SETC  '&XSUBPOOL'                                 00162000
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00162100
&ZCGPR                SETC  '=AL1(&XSUBPOOL)'                           00162200
.*                                                                      00162300
.ZI10D                ANOP  ,                                           00162400
.*                                                                      00162500
&ZOPN                 SETA  &ZOPN+1                                     00162600
&ZOPL(&ZOPN)          SETC  ' '                                         00162700
&ZOPO(&ZOPN)          SETC  'MVC'                                       00162800
&ZOPV(&ZOPN)          SETC  '7(1,1),&ZCGPR'                             00162900
&ZOPD(&ZOPN)          SETC  '++ &ZXSUBPOOL XSUBPOOL'                    00163000
.*                                                                      00163100
.ZI10E                ANOP  ,                                           00163200
.*-------------------------------------------------------------------   00163300
.***AI.L25  XDEVICENUMBER XL2                                           00163400
                      AIF   ('&ZXDEVICENUMBER' EQ '').ZI12E             00163500
                      AIF   ('&ZXDEVICENUMBER' EQ 'OUTPUT').ZI12E       00163600
&ZCGPR                SETC  '&XDEVICENUMBER'                            00163700
.*                                                                      00163800
                      AIF   ('&XDEVICENUMBER'(1,1) NE '(').ZI12B        00163900
&ZCGPR   SETC  '0('.'&XDEVICENUMBER'(2,K'&XDEVICENUMBER-2).')'          00164000
                      AGO   .ZI12D                                      00164100
.ZI12B                ANOP  ,                                           00164200
.*                                                                      00164300
&ZC                   SETC  '&XDEVICENUMBER'(1,1)                       00164400
                      AIF   (T'&ZC NE 'N').ZI12D                        00164500
&ZC                   SETC  '&XDEVICENUMBER'                            00164600
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI12D               00164700
&ZCGPR                SETC  '=AL2(&XDEVICENUMBER)'                      00164800
.*                                                                      00164900
.ZI12D                ANOP  ,                                           00165000
.*                                                                      00165100
&ZOPN                 SETA  &ZOPN+1                                     00165200
&ZOPL(&ZOPN)          SETC  ' '                                         00165300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00165400
&ZOPV(&ZOPN)          SETC  '10(2,1),&ZCGPR'                            00165500
&ZOPD(&ZOPN)          SETC  '++ &ZXDEVICENUMBER XDEVICENUMBER'          00165600
.*                                                                      00165700
.ZI12E                ANOP  ,                                           00165800
.*-------------------------------------------------------------------   00165900
.***AI.L25  XCOUNTERLIST AL4                                            00166000
                      AIF   ('&ZXCOUNTERLIST' EQ '').ZI13E              00166100
                      AIF   ('&ZXCOUNTERLIST' EQ 'OUTPUT').ZI13E        00166200
&ZCGPR                SETC  '&XCOUNTERLIST'                             00166300
.*                                                                      00166400
                      AIF   ('&XCOUNTERLIST'(1,1) NE '(').ZI13B         00166500
&ZCGPR   SETC  '0('.'&XCOUNTERLIST'(2,K'&XCOUNTERLIST-2).')'            00166600
                      AGO   .ZI13D                                      00166700
.ZI13B                ANOP  ,                                           00166800
.*                                                                      00166900
&ZC                   SETC  '&XCOUNTERLIST'(1,1)                        00167000
                      AIF   (T'&ZC NE 'N').ZI13D                        00167100
&ZC                   SETC  '&XCOUNTERLIST'                             00167200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI13D               00167300
&ZCGPR                SETC  '=AL4(&XCOUNTERLIST)'                       00167400
.*                                                                      00167500
.ZI13D                ANOP  ,                                           00167600
.*                                                                      00167700
&ZOPN                 SETA  &ZOPN+1                                     00167800
&ZOPL(&ZOPN)          SETC  ' '                                         00167900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00168000
&ZOPV(&ZOPN)          SETC  '12(4,1),&ZCGPR'                            00168100
&ZOPD(&ZOPN)          SETC  '++ &ZXCOUNTERLIST XCOUNTERLIST'            00168200
.*                                                                      00168300
.ZI13E                ANOP  ,                                           00168400
.*-------------------------------------------------------------------   00168500
&ZOPN1                SETA &ZOPN                                        00168600
.*******************************************************************    00168700
.***  PROCESS IRDFSD OUTPUT PARAMETERS                                  00168800
.*******************************************************************    00168900
                      ACTR  10000                                       00169000
.*------------------------------------------------------------------    00169100
.***AO.L02 XFSDADDRESS A                                                00169200
         AIF   ('&ZXFSDADDRESS' EQ 'OUTPUT').ZO14A  OUTPUT              00169300
         AIF   ('&ZXFSDADDRESS' NE 'INOUT').ZO14C  INOUT                00169400
.ZO14A    AIF   ('&XFSDADDRESS'(1,1) NE '(').ZO14B  ADDR IN GPR         00169500
&ZCGPR   SETC  '&XFSDADDRESS'(2,K'&XFSDADDRESS-2)                       00169600
&ZOPN                 SETA  &ZOPN+1                                     00169700
&ZOPL(&ZOPN)          SETC  ' '                                         00169800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00169900
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),16(1)'                         00170000
&ZOPD(&ZOPN)          SETC  '++ XFSDADDRESS A'                          00170100
                      AGO   .ZO14C                                      00170200
.*                                                                      00170300
.ZO14B                ANOP  ,                                           00170400
&ZAWRK   SETA  K'&XFSDADDRESS                                           00170500
         AIF   ('&XFSDADDRESS'(&ZAWRK,1) NE ')').ZO14G                  00170600
&ZN      SETA  2                                                        00170700
.ZO14H    ANOP                                                          00170800
         AIF   (&ZN GE &ZAWRK).ZO14G                                    00170900
         AIF   ('&XFSDADDRESS'(&ZN,1) NE '(').ZO14I                     00171000
&ZC      SETC  '&XFSDADDRESS'(1,&ZN).'4'.','                            00171100
&ZC      SETC  '&ZC'.'&XFSDADDRESS'(&ZN+1,&ZAWRK-&ZN).',16(1)'          00171200
         AGO   .ZO14J                                                   00171300
.ZO14I    ANOP                                                          00171400
&ZN      SETA  &ZN+1                                                    00171500
         AGO   .ZO14H                                                   00171600
.ZO14G    ANOP                                                          00171700
&ZC      SETC  '&XFSDADDRESS.(4),16(1)'                                 00171800
.ZO14J    ANOP                                                          00171900
&ZOPN                 SETA  &ZOPN+1                                     00172000
&ZOPL(&ZOPN)          SETC  ' '                                         00172100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00172200
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00172300
&ZOPD(&ZOPN)          SETC  '++ XFSDADDRESS A'                          00172400
.ZO14C                ANOP  ,                                           00172500
.*------------------------------------------------------------------    00172600
.***AO.L02 XFSDLENGTH F                                                 00172700
         AIF   ('&ZXFSDLENGTH' EQ 'OUTPUT').ZO15A  OUTPUT               00172800
         AIF   ('&ZXFSDLENGTH' NE 'INOUT').ZO15C  INOUT                 00172900
.ZO15A    AIF   ('&XFSDLENGTH'(1,1) NE '(').ZO15B  ADDR IN GPR          00173000
&ZCGPR   SETC  '&XFSDLENGTH'(2,K'&XFSDLENGTH-2)                         00173100
&ZOPN                 SETA  &ZOPN+1                                     00173200
&ZOPL(&ZOPN)          SETC  ' '                                         00173300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00173400
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),20(1)'                         00173500
&ZOPD(&ZOPN)          SETC  '++ XFSDLENGTH F'                           00173600
                      AGO   .ZO15C                                      00173700
.*                                                                      00173800
.ZO15B                ANOP  ,                                           00173900
&ZAWRK   SETA  K'&XFSDLENGTH                                            00174000
         AIF   ('&XFSDLENGTH'(&ZAWRK,1) NE ')').ZO15G                   00174100
&ZN      SETA  2                                                        00174200
.ZO15H    ANOP                                                          00174300
         AIF   (&ZN GE &ZAWRK).ZO15G                                    00174400
         AIF   ('&XFSDLENGTH'(&ZN,1) NE '(').ZO15I                      00174500
&ZC      SETC  '&XFSDLENGTH'(1,&ZN).'4'.','                             00174600
&ZC      SETC  '&ZC'.'&XFSDLENGTH'(&ZN+1,&ZAWRK-&ZN).',20(1)'           00174700
         AGO   .ZO15J                                                   00174800
.ZO15I    ANOP                                                          00174900
&ZN      SETA  &ZN+1                                                    00175000
         AGO   .ZO15H                                                   00175100
.ZO15G    ANOP                                                          00175200
&ZC      SETC  '&XFSDLENGTH.(4),20(1)'                                  00175300
.ZO15J    ANOP                                                          00175400
&ZOPN                 SETA  &ZOPN+1                                     00175500
&ZOPL(&ZOPN)          SETC  ' '                                         00175600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00175700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00175800
&ZOPD(&ZOPN)          SETC  '++ XFSDLENGTH F'                           00175900
.ZO15C                ANOP  ,                                           00176000
.*******************************************************************    00176100
.***AO.X02  RETURN CODE PROCESSING                                      00176200
.*******************************************************************    00176300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00176400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00176500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00176600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00176700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00176800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00176900
&ZOPN                 SETA  &ZOPN+1                                     00177000
&ZOPL(&ZOPN)          SETC  ' '                                         00177100
&ZOPO(&ZOPN)          SETC  'ST'                                        00177200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00177300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00177400
                      AGO   .ZMRETX                                     00177500
.*                                                                      00177600
.ZMRET2               ANOP  ,                                           00177700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00177800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00177900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00178000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00178100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00178200
&ZOPN                 SETA  &ZOPN+1                                     00178300
&ZOPL(&ZOPN)          SETC  ' '                                         00178400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00178500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00178600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00178700
.ZMRETX               ANOP  ,                                           00178800
.*******************************************************************    00178900
.***AO.X03  REASON CODE PROCESSING                                      00179000
.*******************************************************************    00179100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00179200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00179300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00179400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00179500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00179600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00179700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00179800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00179900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00180000
&ZOPN                 SETA  &ZOPN+1                                     00180100
&ZOPL(&ZOPN)          SETC  ' '                                         00180200
&ZOPO(&ZOPN)          SETC  'ST'                                        00180300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00180400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00180500
                      AGO   .ZMRSNX                                     00180600
.*                                                                      00180700
.ZMRSN2               ANOP  ,                                           00180800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00180900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00181000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00181100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00181200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00181300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00181400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00181500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00181600
&ZOPN                 SETA  &ZOPN+1                                     00181700
&ZOPL(&ZOPN)          SETC  ' '                                         00181800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00181900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00182000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00182100
.ZMRSNX               ANOP  ,                                           00182200
.*******************************************************************    00182300
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00182400
.*******************************************************************    00182500
.ZMFLX                ANOP  ,              MF=L PROCESSING              00182600
.*******************************************************************    00182700
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00182800
.*******************************************************************    00182900
                      ACTR  10000                                       00183000
.*                                                                      00183100
                      LCLA  &ZLC           COLUMN POSITION              00183200
                      LCLA  &ZOPX          LIST TABLE INDEX             00183300
                      LCLC  &ZLL           LABEL                        00183400
                      LCLC  &ZLOP          OPERATION                    00183500
                      LCLC  &ZLV           VALUE                        00183600
                      LCLC  &ZLD           DESCRIPTION                  00183700
.*                                                                      00183800
&ZOPX                 SETA  1                                           00183900
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00184000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00184100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00184200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00184300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00184400
                      AIF   (K'&ZLD LE 0).ZL5                           00184500
&ZLC                  SETA  35             COMMENT COLUMN               00184600
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00184700
&ZLC                  SETA  33             COMMMENT COLUMN              00184800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00184900
&ZLV                  SETC  '&ZLV'.' '                                  00185000
                      AGO   .ZL3                                        00185100
.*                                                                      00185200
.ZL4                  ANOP  ,                                           00185300
&ZLV                  SETC  '&ZLV'.' '                                  00185400
.ZL5                  ANOP  ,                                           00185500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00185600
.*                                                                      00185700
&ZLL     &ZLOP &ZLV                                                     00185800
.*                                                                      00185900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00186000
                      AGO   .ZL2           CONTINUE LOOPING             00186100
.*                                                                      00186200
.ZLX                  ANOP  ,                                           00186300
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00186400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00186500
         L    15,16(0,0)          ++ GET CVT ADDRESS                    00186600
         L    15,124(,15)         ++ GET IOCOM ADDRESS                  00186700
         L    15,8(,15)           ++ GET IOCOMWPT ADDRESS               00186800
         L    15,56(,15)          ++ GET IECA ADDRESS                   00186900
         ICM  15,15,32(15)        ++ GET AND CHECK IECA_IRDVFSD_EP@     00187000
         BNZ   IRDF&SYSNDX        ++ IF VALID, CALL ROUTINE             00187100
         LA   15,4                ++ SET WARNING RETURN CODE            00187200
         LA   0,1                 ++ SET WARNING REASON CODE            00187300
         B     IRDF2&SYSNDX       ++ BRANCH AROUND CALL                 00187400
IRDF&SYSNDX DS     0H                                                   00187500
         BALR 14,15               ++ CALL SERVICE ROUTINE               00187600
IRDF2&SYSNDX DS     0H                                                  00187700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00187800
.ZLINKX               ANOP  ,                                           00187900
.*******************************************************************    00188000
.***AP.X01  FORMAT GENERATED CODE                                       00188100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00188200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00188300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00188400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00188500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00188600
                      AIF   (K'&ZLD LE 0).ZL51                          00188700
&ZLC                  SETA  35             COMMENT COLUMN               00188800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00188900
&ZLC                  SETA  33             COMMENT COLUMN               00189000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00189100
&ZLV                  SETC  '&ZLV'.' '                                  00189200
                      AGO   .ZL31                                       00189300
.*                                                                      00189400
.ZL41                 ANOP  ,                                           00189500
&ZLV                  SETC  '&ZLV'.' '                                  00189600
.ZL51                 ANOP  ,                                           00189700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00189800
.*                                                                      00189900
&ZLL     &ZLOP &ZLV                                                     00190000
.*                                                                      00190100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00190200
                      AGO   .ZL21          CONTINUE LOOPING             00190300
.*                                                                      00190400
.ZLX1                 ANOP  ,                                           00190500
.*******************************************************************    00190600
.***AP.X02  END OF IRDFSD MACRO                                         00190700
&ZIRDFSD              SETC  'YES'          SET IRDFSD USED              00190800
         POP   PRINT                                                    00190900
*                                            IRDFSD-1                   00191000
         SPACE 1                                                        00191100
.ZLX2                 ANOP  ,                                           00191200
         MEND                                                           00191300
**********************************************************************/ 00191400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00191500
*%IRDFSD: MACRO KEYS(DEVICE,DEVICENUMBER,COUNTERS,COUNTERLIST,SUBPOOL,  00191600
*                 FSDADDRESS,FSDLENGTH,RETCODE,RSNCODE,PLISTVER,MF);    00191700
*  ANS('?'!!MACLABEL!!' '!!'IRDFSDP '!!MACLIST!!                        00191800
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00191900
*%END IRDFSD;                                                           00192000

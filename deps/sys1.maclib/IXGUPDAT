*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  IXGUPDAT                              -19/04/11-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Logger Services Update Log Stream Control Inf * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5650-ZOS COPYRIGHT IBM CORP. 1997, 2017                         * 00001200
*                                                                     * 00001300
* STATUS= HBB77B0                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*                                                                     * 00002000
*      The IXGUPDAT macro allows a user connected to a log stream to  * 00002100
*      update the following control field associated with a log       * 00002200
*      logstream:                                                     * 00002300
*                                                                     * 00002400
*                                                                     * 00002500
*      o   the GMT time stamp maintained in list controls of the list * 00002600
*          header allocated to the log stream. When this field is     * 00002700
*          successfully updated, any future log blocks written to the * 00002800
*          log stream cannot have a Logger-assigned GMT time stamp    * 00002900
*          that is less than the time stamp specified on the update   * 00003000
*          request. Note that this says nothing about any time stamps * 00003100
*          that the application that writes the log block may have    * 00003200
*          embedded in the log block itself.                          * 00003300
*                                                                     * 00003400
*                                                                     * 00003500
*                                                                     * 00003600
*01* EXTERNAL CLASSIFICATION:  GUPI                                   * 00003700
*                                                                     * 00003800
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00003900
*                                                                     * 00004000
*01* ENVIRONMENT:                                                     * 00004100
*                                                                     * 00004200
*                                                                     * 00004300
*      Dispatchable unit mode: Task mode.                             * 00004400
*                                                                     * 00004500
*      Cross Memory Mode: Any PASN, any HASN, any SASN.               * 00004600
*                                                                     * 00004700
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00004800
*                        key.                                         * 00004900
*                                                                     * 00005000
*      AMODE:            31- or 64-bit.                               * 00005100
*                                                                     * 00005200
*      ASC mode:         Primary or Access Register.                  * 00005300
*                                                                     * 00005400
*      Interrupt status: Enabled for I/O and external interrupts.     * 00005500
*                                                                     * 00005600
*                        The current primary address space must be    * 00005700
*                        the same as the HOME address space at the    * 00005800
*                        time you issued the IXGCONN macro.           * 00005900
*                                                                     * 00006000
*                        The caller must have connected with write    * 00006100
*                        authority to the log stream.                 * 00006200
*                                                                     * 00006300
*                        The caller's parameter list must be resident * 00006400
*                        in the caller's primary address space.       * 00006500
*                                                                     * 00006600
*                        All storage areas specified must be in the   * 00006700
*                        same storage key as the caller.              * 00006800
*                                                                     * 00006900
*                                                                     * 00007000
*      Locks:            No locks held.                               * 00007100
*                                                                     * 00007200
*      Control parameters: None.                                      * 00007300
*                                                                     * 00007400
*                                                                     * 00007500
*                                                                     * 00007600
*01* PROGRAMMING REQUIREMENTS:                                        * 00007700
*                                                                     * 00007800
*    Before issuing this request, a valid connection to the target    * 00007900
*    log stream identified by STREAMTOKEN must exist. Additionally,   * 00008000
*    the connection request (established by the IXGCONN) macro must   * 00008100
*    specify IMPORTCONNECT=YES.                                       * 00008200
*                                                                     * 00008300
*01* RESTRICTIONS:                                                    * 00008400
*    The caller must have connected with write authority to the log   * 00008500
*    stream.                                                          * 00008600
*                                                                     * 00008700
*    The caller's parameter list must be resident in the caller's     * 00008800
*    primary address space.                                           * 00008900
*                                                                     * 00009000
*    All storage areas specified must be in the same storage key as   * 00009100
*    the caller. Storage areas that must exist in the caller's        * 00009200
*    primary address space.                                           * 00009300
*                                                                     * 00009400
*01* INPUT REGISTERS:  GR0-GR1     Reserved                           * 00009500
*                      GR2-GR13    Undefined                          * 00009600
*                      GR14-GR15   Reserved                           * 00009700
*                      AR0-AR1     Reserved                           * 00009800
*                      AR2-AR13    Undefined                          * 00009900
*                      AR14-AR15   Reserved                           * 00010000
*                                                                     * 00010100
*01* OUTPUT REGISTERS: GR0         Reason code if GR15 return code is * 00010200
*                                  non-zero                           * 00010300
*                      GR1         Unpredictable                      * 00010400
*                      GR2-GR13    Unchanged                          * 00010500
*                      GR14        Unpredictable                      * 00010600
*                      GR15        Return code                        * 00010700
*                      AR0-AR1     Unpredictable                      * 00010800
*                      AR2-AR13    Unchanged                          * 00010900
*                      AR14-AR15   Unpredictable                      * 00011000
*                                                                     * 00011100
*01* PERFORMANCE IMPLICATIONS:                                        * 00011200
*                                                                     * 00011300
*    None.                                                            * 00011400
*                                                                     * 00011500
*01* SYNTAX:                                                          * 00011600
*                                                                     * 00011700
*Ýxlabel¨  IXGUPDAT     STREAMTOKEN=xstreamtoken                      * 00011800
*                     Ý,GMT_TIMESTAMP                                 * 00011900
*                                     =»xgmt_timestamp!NO_GMT_TIMESTA * 00012000
*                                     MPº¨                            * 00012100
*                      ,ANSAREA=xansarea                              * 00012200
*                      ,ANSLEN=xanslen                                * 00012300
*                     Ý,RETCODE=xretcode¨                             * 00012400
*                     Ý,RSNCODE=xrsncode¨                             * 00012500
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00012600
*                    ÐÝ,MF=S¨                                         * 00012700
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00012800
*                    ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00012900
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00013000
*                                                                     * 00013100
*                                                                     * 00013200
*      Where:                                                         * 00013300
*                                                                     * 00013400
*                                                                     * 00013500
*      Ýxlabel¨                                                       * 00013600
*          is an optional symbol, starting in column 1, that is the   * 00013700
*          name on the IXGUPDAT macro invocation.  The name must      * 00013800
*          conform to the rules for an ordinary assembler language    * 00013900
*          symbol.                                                    * 00014000
*          DEFAULT: No name.                                          * 00014100
*                                                                     * 00014200
*                                                                     * 00014300
*                                                                     * 00014400
*                                                                     * 00014500
*      STREAMTOKEN=xstreamtoken                                       * 00014600
*          is the name (RS-type), or address in register (2)-(12), of * 00014700
*          a required 16 character input that specifies the log       * 00014800
*          stream token that was returned on the IXGCONN service.     * 00014900
*                                                                     * 00015000
*                                                                     * 00015100
*                                                                     * 00015200
*                                                                     * 00015300
*      ÝGMT_TIMESTAMP=»xgmt_timestamp!NO_GMT_TIMESTAMPº¨              * 00015400
*          is the name (RS-type), or address in register (2)-(12), of * 00015500
*          an optional 8 character input that specifies the GMT time  * 00015600
*          stamp that must be in list controls in the list header     * 00015700
*          assigned to the log stream identified by the StreamToken   * 00015800
*          keyword for the update request to be successful. If the    * 00015900
*          user specified GMT time stamp is equal to the the time     * 00016000
*          stamp in list controls, the Logger generates a new time    * 00016100
*          stamp via a STCK machine instruction and replaces the GMT  * 00016200
*          time stamp in list controls with the value it received     * 00016300
*          when it issued its STCK.                                   * 00016400
*          DEFAULT: NO_GMT_TIMESTAMP                                  * 00016500
*                                                                     * 00016600
*          If NO_Gmt_TimeStamp is specified for GMT_TimeStamp the     * 00016700
*          macro will be invoked as if GMT_TimeStamp was not          * 00016800
*          specified.                                                 * 00016900
*                                                                     * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*                                                                     * 00017300
*      ANSAREA=xansarea                                               * 00017400
*          is a required input.  It is the name (RS-type), or address * 00017500
*          in register (2)-(12), of a virtual storage area, called    * 00017600
*          the answer area.  The ANSAREA contains additional error    * 00017700
*          status when the IXGUPDAT service generates an error return * 00017800
*          code. The format of the returned data is defined by the    * 00017900
*          IXGANSAA mapping macro.                                    * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*                                                                     * 00018300
*                                                                     * 00018400
*      ANSLEN=xanslen                                                 * 00018500
*          is the name (RS-type), or address in register (2)-(12), of * 00018600
*          a required fullword input that contains the length in      * 00018700
*          bytes of the virtual storage area provided for ANSAREA.    * 00018800
*                                                                     * 00018900
*          The length of the answer area is described by the IXGANSAA * 00019000
*          mapping macro.                                             * 00019100
*                                                                     * 00019200
*                                                                     * 00019300
*                                                                     * 00019400
*                                                                     * 00019500
*      ÝRETCODE=xretcode¨                                             * 00019600
*          is the name (RS-type) of an optional fullword output       * 00019700
*          variable, or register (2)-(12) or (15), into which the     * 00019800
*          return code is to be copied from GPR 15.  If you specify   * 00019900
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00020000
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00020100
*          with MF=M.                                                 * 00020200
*                                                                     * 00020300
*                                                                     * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*      ÝRSNCODE=xrsncode¨                                             * 00020700
*          is the name (RS-type) of an optional fullword output       * 00020800
*          variable into which the reason code is to be copied from   * 00020900
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00021000
*          R0 (within or without parentheses), the value will be left * 00021100
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00021700
*          is an optional byte input decimal value in the "0-0" range * 00021800
*          that specifies the macro version.  PLISTVER is the only    * 00021900
*          key allowed on the list form of MF and determines which    * 00022000
*          parameter list is generated.  Note that MAX may be         * 00022100
*          specified instead of a number, and the parameter list will * 00022200
*          be of the largest size currently supported. This size may  * 00022300
*          grow from release to release (thus possibly affecting the  * 00022400
*          amount of storage needed by your program).  If your        * 00022500
*          program can tolerate this, IBM recommends that you always  * 00022600
*          specify MAX when creating the list form parameter list as  * 00022700
*          that will ensure that the list form parameter list is      * 00022800
*          always long enough to hold whatever parameters might be    * 00022900
*          specified on the execute form.                             * 00023000
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00023100
*          default is the lowest version which allows all of the      * 00023200
*          parameters specified on the invocation to be processed.    * 00023300
*                                                                     * 00023400
*                                                                     * 00023500
*                                                                     * 00023600
*                                                                     * 00023700
*      ÝMF=»S!L!M!Eº¨                                                 * 00023800
*          is an optional keyword input which specifies the macro     * 00023900
*          form.                                                      * 00024000
*          DEFAULT: S                                                 * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*          ÝMF=S¨                                                     * 00024400
*              specifies the standard form of the macro.  The "S"     * 00024500
*              form generates code to put the parameters into an      * 00024600
*              in-line parameter list and invoke the desired service. * 00024700
*              Full checking for required macro keys is done along    * 00024800
*              with supplying defaults for omitted optional           * 00024900
*              parameters.                                            * 00025000
*                                                                     * 00025100
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00025200
*              specifies the list form of the macro.  The "L" form    * 00025300
*              defines an area to be used for the parameter list.     * 00025400
*              Only the PLISTVER key may be specified on the          * 00025500
*              invocation.  All other macro parameters are flagged as * 00025600
*              errors.  If PLISTVER is not specified, the original    * 00025700
*              parameter list definition is used.                     * 00025800
*                                                                     * 00025900
*            ,xmfctrl                                                 * 00026000
*              is a required input.  It is the name of a storage area * 00026100
*              for the parameter list.                                * 00026200
*                                                                     * 00026300
*            »,xmfattr!0Dº                                            * 00026400
*              is an optional 60 character input string that varies   * 00026500
*              from 1 to 60 characters. Use it to force boundary      * 00026600
*              alignment of the parameter list. Use only 0F or 0D.    * 00026700
*              DEFAULT: 0D which forces the parameter list to a       * 00026800
*              doubleword boundary.                                   * 00026900
*                                                                     * 00027000
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00027100
*              specifies the modify form of the macro.  The "M" form  * 00027200
*              generates code to put the parameters into the          * 00027300
*              parameter list specified by xmfctrl.                   * 00027400
*                                                                     * 00027500
*            ,xmfctrl                                                 * 00027600
*              is a required input.  It is the name (RS-type), or     * 00027700
*              address in register (1)-(12), of a storage area for    * 00027800
*              the parameter list.                                    * 00027900
*                                                                     * 00028000
*            »,COMPLETE!NOCHECKº¨                                     * 00028100
*              is an optional keyword input which specifies the       * 00028200
*              degree of macro parameter syntax checking.             * 00028300
*              DEFAULT: COMPLETE                                      * 00028400
*                                                                     * 00028500
*                                                                     * 00028600
*              COMPLETE                                               * 00028700
*                  Checking for required macro keys is done and       * 00028800
*                  defaults are supplied for omitted optional         * 00028900
*                  parameters.  (See Macro Usage Note 2).             * 00029000
*                                                                     * 00029100
*              NOCHECK                                                * 00029200
*                  Checking for required macro keys is not done nor   * 00029300
*                  are defaults supplied for omitted optional         * 00029400
*                  parameters.                                        * 00029500
*                                                                     * 00029600
*                                                                     * 00029700
*                                                                     * 00029800
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00029900
*              specifies the execute form of the macro.  The "E" form * 00030000
*              generates code to put the parameters into the          * 00030100
*              parameter list specified by xmfctrl and invoke the     * 00030200
*              desired service.                                       * 00030300
*                                                                     * 00030400
*            ,xmfctrl                                                 * 00030500
*              is a required input.  It is the name (RS-type), or     * 00030600
*              address in register (1)-(12), of a storage area for    * 00030700
*              the parameter list.                                    * 00030800
*                                                                     * 00030900
*            »,COMPLETE!NOCHECKº                                      * 00031000
*              is an optional keyword input which specifies the       * 00031100
*              degree of macro parameter syntax checking.             * 00031200
*              DEFAULT: COMPLETE                                      * 00031300
*                                                                     * 00031400
*                                                                     * 00031500
*              COMPLETE                                               * 00031600
*                  Checking for required macro keys is done and       * 00031700
*                  defaults are supplied for omitted optional         * 00031800
*                  parameters.  (See Macro Usage Note 2).             * 00031900
*                                                                     * 00032000
*              NOCHECK                                                * 00032100
*                  Checking for required macro keys is not done nor   * 00032200
*                  are defaults supplied for omitted optional         * 00032300
*                  parameters.                                        * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*                                                                     * 00032700
*                                                                     * 00032800
*                                                                     * 00032900
*                                                                     * 00033000
*                                                                     * 00033100
*01* RETURN CODES:                                                    * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                 When IXGUPDAT macro returns control to your         * 00033500
*                 program, GPR 15 contains a return code and GPR 0    * 00033600
*                 contains a reason code.                             * 00033700
*                                                                     * 00033800
*                 The IXGCON mapping macro provides equate symbols    * 00033900
*                 for the return and reason codes.  The equate        * 00034000
*                 symbols associated with each hexadecimal return     * 00034100
*                 code are as follows:                                * 00034200
*                                                                     * 00034300
*       00        IXGRETCODEOK -  Successful Completion               * 00034400
*                                                                     * 00034500
*       04        IXGRETCODEWARNING - The request was processed       * 00034600
*                 successfully, however a warning condition was       * 00034700
*                 encountered.                                        * 00034800
*                                                                     * 00034900
*       08        IXGRETCODEERROR - An error has been encountered.    * 00035000
*                 The associated reason code provides more            * 00035100
*                 information.                                        * 00035200
*                                                                     * 00035300
*       0C        IXGRETCODECOMPERROR - A System Logger component     * 00035400
*                 error has been encountered.                         * 00035500
*                                                                     * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*01* REASON CODES:                                                    * 00035900
*                                                                     * 00036000
*       Full details on the reason codes provided for each return     * 00036100
*       code listed above can be found in the "Return and Reason      * 00036200
*       Codes" topic for this service in publication "z/OS MVS        * 00036300
*       Programming:  Assembler Services Reference:, Volume 2         * 00036400
*       (IARR2V-XCTLX)".                                              * 00036500
*                                                                     * 00036600
*       REASON    RETURN                                              * 00036700
*       CODE      CODE      DESCRIPTION                               * 00036800
*       --------  --------  -----------                               * 00036900
*                                                                     * 00037000
*                                                                     * 00037100
*       xxxx0000  00                                                  * 00037200
*                                                                     * 00037300
*                           IXGRSNCODEOK -                            * 00037400
*                                                                     * 00037500
*                           EXPLANATION: Request processed            * 00037600
*                           successfully.                             * 00037700
*                                                                     * 00037800
*       xxxx0801  08                                                  * 00037900
*                                                                     * 00038000
*                           IXGRSNCODEBADPARMLIST -                   * 00038100
*                                                                     * 00038200
*                           EXPLANATION:  Program error. The          * 00038300
*                           parameter list is invalid.  Either the    * 00038400
*                           parameter list storage is inaccessible,   * 00038500
*                           or an invalid version of the macro was    * 00038600
*                           used.                                     * 00038700
*                                                                     * 00038800
*                           ACTION: Ensure that the storage area for  * 00038900
*                           the parameter list is accessible to the   * 00039000
*                           system logger for the duration of the     * 00039100
*                           request, and that the macro version is    * 00039200
*                           correct.  The parameter list storage must * 00039300
*                           be addressable in the caller's primary    * 00039400
*                           address space and in the same key as the  * 00039500
*                           caller.                                   * 00039600
*                                                                     * 00039700
*       xxxx0802  08                                                  * 00039800
*                                                                     * 00039900
*                           IXGRSNCODEXESERROR -                      * 00040000
*                                                                     * 00040100
*                           EXPLANATION:  System error. A severe      * 00040200
*                           cross-system extended services (XES)      * 00040300
*                           error has occurred.                       * 00040400
*                                                                     * 00040500
*                           ACTION:  See ANSAA_DIAG1 for the XES      * 00040600
*                           return code and ANSAA_DIAG2 for the XES   * 00040700
*                           reason code.                              * 00040800
*                                                                     * 00040900
*       xxxx0806  08                                                  * 00041000
*                                                                     * 00041100
*                           IXGRSNCODEBADSTMTOKEN -                   * 00041200
*                                                                     * 00041300
*                           EXPLANATION: Program error. One of the    * 00041400
*                           following occurred: # The stream token    * 00041500
*                           was not valid. # The specified request    * 00041600
*                           was issued from an address space other    * 00041700
*                           than the connectors address space.        * 00041800
*                                                                     * 00041900
*                           ACTION: Do one of the following: # Make   * 00042000
*                           sure that the stream token specified is   * 00042100
*                           valid. # Ensure that IXGUPDAT requests    * 00042200
*                           were issued from the connectors address   * 00042300
*                           space.                                    * 00042400
*                                                                     * 00042500
*       xxxx080A  08                                                  * 00042600
*                                                                     * 00042700
*                           IXGRSNCODEREQUESTLOCKED -                 * 00042800
*                                                                     * 00042900
*                           EXPLANATION:  Program error. The program  * 00043000
*                           issuing the request is holding a lock.    * 00043100
*                                                                     * 00043200
*                           ACTION: Ensure that the program issuing   * 00043300
*                           the request is not holding a lock.        * 00043400
*                                                                     * 00043500
*       xxxx0814  08                                                  * 00043600
*                                                                     * 00043700
*                           IXGRSNCODENOTAVAILFORIPL -                * 00043800
*                                                                     * 00043900
*                           EXPLANATION:  Environment error. The      * 00044000
*                           system logger address space is not        * 00044100
*                           available for the remainder of this IPL.  * 00044200
*                           The system issues messages about this     * 00044300
*                           error during system logger                * 00044400
*                           initialization.                           * 00044500
*                                                                     * 00044600
*                           ACTION: See the explanation for system    * 00044700
*                           messages issued during system logger      * 00044800
*                           initialization.                           * 00044900
*                                                                     * 00045000
*       xxxx0815  08                                                  * 00045100
*                                                                     * 00045200
*                           IXGRSNCODENOTENABLED -                    * 00045300
*                                                                     * 00045400
*                           EXPLANATION:  Program error. The program  * 00045500
*                           issuing the request is not enabled for    * 00045600
*                           I/O and external interrupts, so the       * 00045700
*                           request fails.                            * 00045800
*                                                                     * 00045900
*                           ACTION:  Make sure the program issuing    * 00046000
*                           the request is enabled for I/O and        * 00046100
*                           external interrupts.                      * 00046200
*                                                                     * 00046300
*       xxxx0816  08                                                  * 00046400
*                                                                     * 00046500
*                           IXGRSNCODEBADANSLEN -                     * 00046600
*                                                                     * 00046700
*                           EXPLANATION:  Program error. The answer   * 00046800
*                           area length (ANSLEN parameter) is not     * 00046900
*                           large enough. The system logger returned  * 00047000
*                           the required size in the                  * 00047100
*                           Ansaa_Preferred_Size field of the answer  * 00047200
*                           area, mapped by IXGANSAA macro.           * 00047300
*                                                                     * 00047400
*                           ACTION:  Re-issue the request, specifying * 00047500
*                           an answer area of the required size.      * 00047600
*                                                                     * 00047700
*       xxxx0817  08                                                  * 00047800
*                                                                     * 00047900
*                           IXGRSNCODEBADANSAREA -                    * 00048000
*                                                                     * 00048100
*                           EXPLANATION: Program error. The storage   * 00048200
*                           area specified on the ANSAREA parameter   * 00048300
*                           cannot be accessed. This may occur after  * 00048400
*                           the system logger address space has       * 00048500
*                           terminated.                               * 00048600
*                                                                     * 00048700
*                           ACTION: Specify storage that is in the    * 00048800
*                           callers primary address space and in the  * 00048900
*                           same key as the calling program at the    * 00049000
*                           time the system logger service was        * 00049100
*                           issued. This storage must be accessible   * 00049200
*                           until the request completes.              * 00049300
*                                                                     * 00049400
*       xxxx0819  08                                                  * 00049500
*                                                                     * 00049600
*                           IXGRSNCODESRBMODE -                       * 00049700
*                                                                     * 00049800
*                           EXPLANATION:  Program error. The calling  * 00049900
*                           program is in SRB mode, but task mode is  * 00050000
*                           the required dispatchable unit mode for   * 00050100
*                           this system logger service.               * 00050200
*                                                                     * 00050300
*                           ACTION: Make sure the calling program is  * 00050400
*                           in task mode.                             * 00050500
*                                                                     * 00050600
*       xxxx081C  08                                                  * 00050700
*                                                                     * 00050800
*                           IXGRSNCODENOTAUTHFUNC -                   * 00050900
*                                                                     * 00051000
*                           EXPLANATION: Program error. The program   * 00051100
*                           connected to the log stream with the      * 00051200
*                           AUTH=READ parameter and then tried to     * 00051300
*                           delete, write, offload or update data.    * 00051400
*                           You cannot write, delete, offload or      * 00051500
*                           update data when connected with read      * 00051600
*                           authority.                                * 00051700
*                                                                     * 00051800
*                           Or the program connected to the log       * 00051900
*                           stream with the AUTH=WRITE parameter and  * 00052000
*                           was granted limited access (i.e. write    * 00052100
*                           only log data and disconnect) as per the  * 00052200
*                           defined security access profiles, and     * 00052300
*                           then tried to perform a log stream access * 00052400
*                           service other than IXGWRITE, or IXGCONN   * 00052500
*                           (to disconnect).                          * 00052600
*                                                                     * 00052700
*                           ACTION: A connection to the log stream    * 00052800
*                           with the appropriate access authority     * 00052900
*                           must be established before using the      * 00053000
*                           update log stream (IXGUPDAT) service.     * 00053100
*                           When AUTH=WRITE was already used when the * 00053200
*                           error was encountered, then check with    * 00053300
*                           your installation's security              * 00053400
*                           administrator on obtaining the            * 00053500
*                           appropriate access to the log stream.     * 00053600
*                                                                     * 00053700
*                                                                     * 00053800
*       xxxx082D  08        IXGRSNCODEEXPIREDSTMTOKEN -               * 00053900
*                                                                     * 00054000
*                           EXPLANATION: Environment error. The       * 00054100
*                           stream token is no longer valid because   * 00054200
*                           the connector has been disconnected.      * 00054300
*                                                                     * 00054400
*                           ACTION: Re-connect to the log stream      * 00054500
*                           before issuing any functional requests.   * 00054600
*                                                                     * 00054700
*       xxxx0840  08                                                  * 00054800
*                                                                     * 00054900
*                           IXGRSNCODEBADVERSION -                    * 00055000
*                                                                     * 00055100
*                           EXPLANATION: Environment error. The       * 00055200
*                           parameter list passed to the service      * 00055300
*                           routine has an invalid version indicator. * 00055400
*                                                                     * 00055500
*                           ACTION: Ensure the level of MVS executing * 00055600
*                           the request and the macro library used to * 00055700
*                           compile the invoking routine are          * 00055800
*                           compatible.                               * 00055900
*                                                                     * 00056000
*       xxxx0861  08                                                  * 00056100
*                                                                     * 00056200
*                           IXGRSNCODEREBUILDINPROGRESS -             * 00056300
*                                                                     * 00056400
*                           EXPLANATION: Environment error. No        * 00056500
*                           requests can be processed for this log    * 00056600
*                           stream because a coupling facility        * 00056700
*                           structure re-build or a system-managed    * 00056800
*                           duplexing re-build is in progress for the * 00056900
*                           structure associated with this log        * 00057000
*                           stream.                                   * 00057100
*                                                                     * 00057200
*                           ACTION: Listen for ENF signal 48 that     * 00057300
*                           will indicate one of the following: # The * 00057400
*                           log stream is available because the       * 00057500
*                           re-build completed successfully. Re-issue * 00057600
*                           the request.  # The re-build failed and   * 00057700
*                           the log stream is not available. .        * 00057800
*                                                                     * 00057900
*       xxxx0862  08                                                  * 00058000
*                                                                     * 00058100
*                           IXGRSNCODEXESPURGE -                      * 00058200
*                                                                     * 00058300
*                           EXPLANATION: Environment error. An        * 00058400
*                           cross-system extended services (XES)      * 00058500
*                           request has been purged due to re-build   * 00058600
*                           processing.                               * 00058700
*                                                                     * 00058800
*                           ACTION: Listen for ENF signal 48 that     * 00058900
*                           will indicate one of the following: # The * 00059000
*                           log stream is available because the       * 00059100
*                           re-build completed successfully. Re-issue * 00059200
*                           the request.  # The re-build failed and   * 00059300
*                           the log stream is not available. .        * 00059400
*                                                                     * 00059500
*       xxxx0863  08                                                  * 00059600
*                                                                     * 00059700
*                           IXGRSNCODESTRUCTUREFAILED -               * 00059800
*                                                                     * 00059900
*                           EXPLANATION: Environment error. Either    * 00060000
*                           the coupling facility structure           * 00060100
*                           associated with the log stream has failed * 00060200
*                           or the coupling facility itself has       * 00060300
*                           failed.                                   * 00060400
*                                                                     * 00060500
*                           ACTION: Listen for ENF signal 48 that     * 00060600
*                           will indicate one of the following: # The * 00060700
*                           log stream is available because the       * 00060800
*                           re-build completed successfully. Re-issue * 00060900
*                           the request.  # The re-build failed and   * 00061000
*                           the log stream is not available.          * 00061100
*                                                                     * 00061200
*       xxxx0864  08                                                  * 00061300
*                                                                     * 00061400
*                           IXGRSNCODENOCONNECTIVITY -                * 00061500
*                                                                     * 00061600
*                           EXPLANATION: Environment error. No        * 00061700
*                           connectivity exists to the coupling       * 00061800
*                           facility associated with the log stream.  * 00061900
*                           The system logger will either attempt to  * 00062000
*                           re-build the log stream in another        * 00062100
*                           coupling facility or the log stream will  * 00062200
*                           be disconnected.                          * 00062300
*                                                                     * 00062400
*                           ACTION: Listen for ENF signal 48 that     * 00062500
*                           will indicate one of the following: # The * 00062600
*                           log stream is available because the       * 00062700
*                           re-build completed successfully. Re-issue * 00062800
*                           the request.  # The re-build failed and   * 00062900
*                           the log stream is not available. # The    * 00063000
*                           log stream has been disconnected from     * 00063100
*                           this system.                              * 00063200
*                                                                     * 00063300
*       xxxx0890  08                                                  * 00063400
*                                                                     * 00063500
*                           IXGRSNCODEADDRSPACENOTAVAIL -             * 00063600
*                                                                     * 00063700
*                           EXPLANATION: System error. The system     * 00063800
*                           logger address space failed and is not    * 00063900
*                           available.                                * 00064000
*                                                                     * 00064100
*                           ACTION: Do not issue system logger        * 00064200
*                           requests.                                 * 00064300
*                                                                     * 00064400
*       xxxx0891  08                                                  * 00064500
*                                                                     * 00064600
*                           IXGRSNCODEADDRSPACEINITIALIZING -         * 00064700
*                                                                     * 00064800
*                                                                     * 00064900
*                           EXPLANATION: System error. The system     * 00065000
*                           logger address space is not available     * 00065100
*                           because it is IPLing.                     * 00065200
*                                                                     * 00065300
*                           ACTION:  Listen for ENF signal 48, which  * 00065400
*                           will indicate when the system logger      * 00065500
*                           address space is available.  Once it's    * 00065600
*                           available, re-connect to the log stream,  * 00065700
*                           then re-issue this request. You can also  * 00065800
*                           listen for ENF signal 48, which will      * 00065900
*                           indicate if the system logger address     * 00066000
*                           space will not be available for the life  * 00066100
*                           of the IPL. In that case, do not issue    * 00066200
*                           system logger services.                   * 00066300
*                                                                     * 00066400
*       xxxx08DD  08                                                  * 00066500
*                                                                     * 00066600
*                           IXGRSNCODEUPDATETIMESTAMPTOOSMALL -       * 00066700
*                                                                     * 00066800
*                                                                     * 00066900
*                           EXPLANATION: Program error. The           * 00067000
*                           replacement GMT time stamp is smaller     * 00067100
*                           than the time stamp maintained in the     * 00067200
*                           coupling facility for the log stream.     * 00067300
*                           This error can be caused because the      * 00067400
*                           application did in fact specify an        * 00067500
*                           invalid time stamp or the time stamp      * 00067600
*                           value has changed after its current value * 00067700
*                           was retrieved (e.g., via the IXGQUERY     * 00067800
*                           service) because a write or another       * 00067900
*                           update request was successfully processed * 00068000
*                           for the log stream somewhere in the       * 00068100
*                           sysplex.                                  * 00068200
*                                                                     * 00068300
*                           ACTION -  - invoke the IXGQUERY service   * 00068400
*                           to obtain the current time stamp value    * 00068500
*                           and determine if the update request       * 00068600
*                           should be retried.                        * 00068700
*                                                                     * 00068800
*       xxxx08DE  08                                                  * 00068900
*                                                                     * 00069000
*                           IXGRSNCODEUPDATENOOPTIONS -               * 00069100
*                                                                     * 00069200
*                           EXPLANATION: Program error. The IXGUPDAT  * 00069300
*                           macro was invoked with no options         * 00069400
*                           specified.                                * 00069500
*                                                                     * 00069600
*                           ACTION -  - Specify at least one option   * 00069700
*                           and retry the request.                    * 00069800
*                                                                     * 00069900
*       xxxx0C00  0C                                                  * 00070000
*                                                                     * 00070100
*                           EXPLANATION: System Logger Error.  A      * 00070200
*                           System Logger component error has been    * 00070300
*                           encountered.                              * 00070400
*                                                                     * 00070500
*                                                                     * 00070600
*                                                                     * 00070700
*01* ABEND CODES:                                                     * 00070800
*                                                                     * 00070900
*                                                                     * 00071000
*       1C5       IXG_ABEND_CODE - A System Logger abend has          * 00071100
*                 occurred.                                           * 00071200
*                                                                     * 00071300
*                                                                     * 00071400
*                                                                     * 00071500
*01* ABEND REASON CODES:                                              * 00071600
*                                                                     * 00071700
*       REASON    ABEND                                               * 00071800
*       CODE      CODE      DESCRIPTION                               * 00071900
*       --------  --------  -----------                               * 00072000
*                                                                     * 00072100
*                                                                     * 00072200
*       xxxx085F  1C5       IXGRSNCODEPERCTOREQUESTOR -               * 00072300
*                                                                     * 00072400
*                           EXPLANATION: Environment error.           * 00072500
*                           Percolation to the service requestor's    * 00072600
*                           task occurred because of an abend during  * 00072700
*                           system logger processing. Retry was not   * 00072800
*                           allowed.                                  * 00072900
*                                                                     * 00073000
*                           ACTION: Issue the request again. If the   * 00073100
*                           problem persists, contact the IBM Support * 00073200
*                           Center.                                   * 00073300
*                                                                     * 00073400
*                                                                     * 00073500
*                                                                     * 00073600
*01* MODULE TYPE:  ASSEM MACRO                                        * 00073700
*                                                                     * 00073800
*02*   PROCESSOR:  ASSEM                                              * 00073900
*                                                                     * 00074000
*01* COMPONENT:  SCLOG                                                * 00074100
*                                                                     * 00074200
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00074300
*                                                                     * 00074400
*01* EXAMPLES:                                                        * 00074500
*    None.                                                            * 00074600
*                                                                     * 00074700
*01* MACRO USAGE NOTES:                                               * 00074800
*                                                                     * 00074900
*                                                                     * 00075000
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00075100
*        global macro variable.  Any value other than 'NO' will       * 00075200
*        result in the macro expansion being printed.  The default is * 00075300
*        'YES'.  The following examples illustrate how the ZPRINT     * 00075400
*        variable should be set.                                      * 00075500
*                                                                     * 00075600
*                    GBLC &ZPRINT                                     * 00075700
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00075800
*                                                                     * 00075900
*                                                                     * 00076000
*    2.  When using the NOCHECK option in conjunction with the Modify * 00076100
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00076200
*        Modify   or  Execute  form  invocation  which  specifies  or * 00076300
*        defaults  to  the  COMPLETE  option.   This insures that the * 00076400
*        parameter  list  is  initialized completely.   The parameter * 00076500
*        list  field which identifies the version number of the macro * 00076600
*        is only set when the Standard form or the Complete option of * 00076700
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00076800
*        explicitly  specified.  Be sure that the resulting parameter * 00076900
*        list version number covers all the keys that you use.        * 00077000
*                                                                     * 00077100
*                                                                     * 00077200
*    3.  All   keys   currently   contained  in  the  IXGUPDAT  macro * 00077300
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00077400
*        value of 0 or MAX.                                           * 00077500
*                                                                     * 00077600
*                                                                     * 00077700
*                                                                     * 00077800
*                                                                     * 00077900
*01* CHANGE ACTIVITY:                                                 * 00078000
*                                                                     * 00078100
*   Flag LineItem  FMID    Date   ID    Comment                       * 00078200
*                                                                     * 00078300
*    $L0=LOGGR    HBB6603 951201 PDXD:                                * 00078400
*    $L1=CFDUP    HBB7705 001024 PDJL:  Update                        * 00078500
*                                         IxgRsnCodeRebuildInProgress * 00078600
*    $L2=64V2     HBB7709 020404 PD00A8:  Support Amode 64            * 00078700
*    $L3=ME09177  HBB7740 070131 PDDZ:  refer to pubs for reason code * 00078800
*                                         details                     * 00078900
*    $P1=ME17775  HBB7770 091124 PDDZ:  AR mode proper linkage        * 00079000
*    $01=OA56050  HBB77B0 190411 PDDZ:  WriteOnly access              * 00079100
****** END OF SPECIFICATIONS *****************************************/ 00079200
*/********************************************************************* 00079300
         MACRO                                                          00079400
&XLABEL  IXGUPDAT &STREAMTOKEN=,&GMT_TIMESTAMP=,&ANSAREA=,&ANSLEN=,    *00079500
               &RETCODE=,&RSNCODE=,&PLISTVER=,&MF=                      00079600
.*                                                                      00079700
*                   MACDATE -19/04/11-<0>                               00079800
.*                                                                      00079900
.*******************************************************************    00080000
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00080100
.*******************************************************************    00080200
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00080300
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00080400
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00080500
.*                                                                      00080600
                   GBLC  &ZIXGUPDAT  YES=MACRO USED AT LEAST ONCE       00080700
.*******************************************************************    00080800
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00080900
.*******************************************************************    00081000
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00081100
                   LCLC  &ZCNDX      SYSNDX CHARACTERS                  00081200
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00081300
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00081400
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00081500
                   LCLA  &ZAWRK      USED AS A WORK AREA                00081600
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00081700
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00081800
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00081900
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00082000
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00082100
                   LCLC  &ZMAC_G     "G" or null                        00082200
&ZMAC_G            SETC  ''                                             00082300
                   LCLC  &ZMAC_LR                                       00082400
&ZMAC_LR           SETC  'LR'                                           00082500
                   LCLC  &ZMAC_L                                        00082600
&ZMAC_L            SETC  'L'                                            00082700
                   LCLC  &ZMAC_ST                                       00082800
&ZMAC_ST           SETC  'ST'                                           00082900
                   LCLC  &ZMAC_LLGT                                     00083000
&ZMAC_LLGT         SETC  'L'                                            00083100
                   LCLC  &ZMAC_LGR                                      00083200
&ZMAC_LGR          SETC  'LR'                                           00083300
                   LCLC  &ZMAC_LG                                       00083400
&ZMAC_LG           SETC  'L'                                            00083500
                   LCLC  &ZMAC_STG                                      00083600
&ZMAC_STG          SETC  'ST'                                           00083700
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00083800
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00083900
.*                                                                      00084000
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00084100
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00084200
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00084300
                   LCLC  &ZENDBASEPL            End of base PL          00084400
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00084500
.*******************************************************************    00084600
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00084700
.*******************************************************************    00084800
                   LCLA  &ZI         INDEX FOR ARRAY                    00084900
                   LCLA  &ZJ         INDEX FOR PARMS                    00085000
                   LCLA  &ZK         INDEX FOR PARSE                    00085100
                   LCLA  &ZLO        LOW RANGE VALUE                    00085200
                   LCLA  &ZHI        HIGH RANGE VALUE                   00085300
                   LCLC  &ZW         WORK AREA FOR PARM                 00085400
.********************************************************************   00085500
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00085600
.********************************************************************   00085700
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00085800
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00085900
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00086000
                   GBLC  &SYSAM64    SYSSTATE AMODE64                   00086100
.*                                                                      00086200
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00086300
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00086400
                   SPLEVEL  TEST                                        00086500
.ZSYS2             ANOP  ,                                              00086600
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00086700
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00086800
                   SYSSTATE TEST                                        00086900
                   AGO   .ZSYS4                                         00087000
.ZSYS3             ANOP  ,                                              00087100
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00087200
.ZSYS4             ANOP  ,                                              00087300
                   AIF   ('&SYSAM64' NE 'YES').ZSYSN64                  00087400
&ZMAC_LLGT         SETC 'LLGT'                                          00087500
&ZMAC_LGR          SETC 'LGR'                                           00087600
&ZMAC_LG           SETC 'LG'                                            00087700
&ZMAC_STG          SETC 'STG'                                           00087800
.ZSYSN64           ANOP  ,                                              00087900
.*******************************************************************    00088000
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00088100
.*******************************************************************    00088200
                   LCLC  &XSTREAMTOKEN          ++ NAME                 00088300
                   LCLC  &XGMT_TIMESTAMP        ++ NAME                 00088400
                   LCLC  &XANSAREA   ++ NAME                            00088500
                   LCLC  &XANSLEN    ++ NAME                            00088600
                   LCLC  &XRETCODE   ++ NAME                            00088700
                   LCLC  &XRSNCODE   ++ NAME                            00088800
                   LCLA  &XPLISTVER  ++ VALUE                           00088900
                   LCLC  &XMF        ++ VALUE                           00089000
                   LCLC  &XMFCTRL    ++ NAME                            00089100
                   LCLC  &XMFATTR    ++ VALUE                           00089200
                   LCLC  &XMFSCK     ++ VALUE                           00089300
.*******************************************************************    00089400
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00089500
.*******************************************************************    00089600
                   LCLC  &ZXSTREAMTOKEN         ++ INPUT NAME           00089700
                   LCLC  &ZXGMT_TIMESTAMP       ++ INPUT NAME           00089800
                   LCLC  &ZXANSAREA  ++ INPUT NAME                      00089900
                   LCLC  &ZXANSLEN   ++ INPUT NAME                      00090000
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00090100
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00090200
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00090300
                   LCLC  &ZXMF       ++ INPUT VALUE                     00090400
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00090500
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00090600
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00090700
.********************************************************************   00090800
.***AC.PLV01  PROCESS PLISTVER                                      *   00090900
.********************************************************************   00091000
&XPLISTVER      SETA  0                                                 00091100
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00091200
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00091300
&XPLISTVER      SETA  0                                                 00091400
.ZPLV0          ANOP  ,                                                 00091500
.*                                                                      00091600
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00091700
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00091800
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00091900
.*-------------------------------------------------------------------   00092000
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00092100
&ZMS            SETC  '"PLISTVER='                                      00092200
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00092300
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00092400
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00092500
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00092600
                AGO   .ZPVCK2                                           00092700
.ZPVCK3         ANOP  ,                                                 00092800
.*-------------------------------------------------------------------   00092900
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00093000
&ZMS            SETC  '"PLISTVER='                                      00093100
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00093200
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00093300
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00093400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00093500
                AGO   .ZPVCKE                                           00093600
.ZPVCK2         ANOP  ,                                                 00093700
.*-------------------------------------------------------------------   00093800
&ZCVAL          SETC  '&PLISTVER(1)'                                    00093900
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00094000
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00094100
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00094200
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00094300
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00094400
.ZPVCK6         ANOP  ,                                                 00094500
&ZMS            SETC  '"PLISTVER='                                      00094600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00094700
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00094800
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00094900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00095000
&XPLISTVER      SETA  0                                                 00095100
                AGO   .ZPVCKE                                           00095200
.*-------------------------------------------------------------------   00095300
.ZPVCK4A        ANOP  ,                                                 00095400
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00095500
&ZMS            SETC  'PLISTVER='                                       00095600
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00095700
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00095800
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00095900
                MNOTE 8,' &ZMS IS REQUIRED.'                            00096000
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00096100
                AGO   .ZPVCK5                                           00096200
.ZPVCK4         ANOP  ,                                                 00096300
&XPLISTVER      SETA  &PLISTVER(1)                                      00096400
.ZPVCK5         ANOP  ,                                                 00096500
.ZPVCKE         ANOP  ,                                                 00096600
.********************************************************************   00096700
.***AG.MF01 PROCESS MF MACRO FORMS                                      00096800
.********************************************************************   00096900
                   ACTR  10000                                          00097000
.*------------------------------------------------------------------    00097100
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00097200
&XMF               SETC  ''          INITIALIZE XVARIABLE               00097300
.*-------------------------------------------------------------------   00097400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00097500
.ZG24              ANOP  ,                                              00097600
&ZTLC              SETC 'S'                                             00097700
                   AIF   ('&MF(1)' NE '&ZTLC').ZG25                     00097800
&XMF               SETC  'S'         SET KEYWORD                        00097900
&XMFSCK            SETC  'COMPLETE'  SET XMFSCK                         00098000
                   AIF   (N'&MF LE 1).ZG24A     CK NUM                  00098100
&ZMS               SETC  '"MF='                                         00098200
&ZMS               SETC  '&ZMS.&MF"'                                    00098300
&ZMS               SETC  '&ZMS "MF"'                                    00098400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00098500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00098600
.ZG24A             ANOP  ,                                              00098700
.*-------------------------------------------------------------------   00098800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00098900
.ZG25              ANOP  ,                                              00099000
&ZTLC              SETC 'L'                                             00099100
                   AIF   ('&MF(1)' NE '&ZTLC').ZG32                     00099200
&XMF               SETC  'L'         SET KEYWORD                        00099300
                   AIF   (N'&MF LE 3).ZG25A     CK NUM                  00099400
&ZMS               SETC  '"MF='                                         00099500
&ZMS               SETC  '&ZMS.&MF"'                                    00099600
&ZMS               SETC  '&ZMS "MF"'                                    00099700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00099800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00099900
.ZG25A             ANOP  ,                                              00100000
.*-------------------------------------------------------------------   00100100
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00100200
                   AIF   (N'&SYSLIST NE 0).ZG25B  POSITIONALS?          00100300
                   AIF   ('&STREAMTOKEN' NE '').ZG25B  KEYS?            00100400
                   AIF   ('&GMT_TIMESTAMP' NE '').ZG25B  KEYS?          00100500
                   AIF   ('&ANSAREA' NE '').ZG25B  KEYS?                00100600
                   AIF   ('&ANSLEN' NE '').ZG25B  KEYS?                 00100700
                   AIF   ('&RETCODE' NE '').ZG25B  KEYS?                00100800
                   AIF   ('&RSNCODE' NE '').ZG25B  KEYS?                00100900
                   AGO    .ZG25C     INVOCATION OKAY                    00101000
.ZG25B             ANOP  ,                                              00101100
&ZMS               SETC  'THE "L" FORM OF "MF"'                         00101200
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00101300
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00101400
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00101500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00101600
.ZG25C             ANOP  ,                                              00101700
.*-------------------------------------------------------------------   00101800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00101900
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00102000
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00102100
                   AIF   (N'&MF(2) GT 1).ZG27B  MULTI                   00102200
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00102300
.ZG27B             AIF   (K'&MF(2) GT 0).ZG27C                          00102400
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00102500
&ZMS               SETC  'WHEN "L" IS SPECIFIED'                        00102600
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00102700
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00102800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00102900
.ZG27C             ANOP  ,                                              00103000
.*-------------------------------------------------------------------   00103100
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00103200
                   AIF   (K'&ZXMFCTRL LE 0).ZG27P  NOT I/O              00103300
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG27P                 00103400
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00103500
&ZMS               SETC  '"MF='                                         00103600
&ZMS               SETC  '&ZMS.&MF"'                                    00103700
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00103800
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00103900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00104000
.ZG27P             ANOP  ,                                              00104100
.*-------------------------------------------------------------------   00104200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00104300
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00104400
&XMFATTR           SETC  '0D'                                           00104500
                   AIF   (K'&MF(3) LE 0).ZG30B  PARM                    00104600
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00104700
                   AIF   (N'&MF(3) GT 1).ZG30B  MULTI                   00104800
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00104900
.ZG30B             ANOP  ,                                              00105000
.*-------------------------------------------------------------------   00105100
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00105200
                   AIF   (K'&ZXMFATTR LE 0).ZG30P  NOT I/O              00105300
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG30P                 00105400
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00105500
&ZMS               SETC  '"MF='                                         00105600
&ZMS               SETC  '&ZMS.&MF"'                                    00105700
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00105800
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00105900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00106000
.ZG30P             ANOP  ,                                              00106100
.*-------------------------------------------------------------------   00106200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00106300
                   AIF   (K'&ZXMFATTR LE 0).ZG30S  NOT I/O              00106400
                   AIF   (K'&XMFATTR LE 60).ZG30S  LNG OK               00106500
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00106600
&ZMS               SETC  '"MF='                                         00106700
&ZMS               SETC  '&ZMS.&MF"'                                    00106800
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00106900
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00107000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00107100
.ZG30S             ANOP  ,                                              00107200
.*-------------------------------------------------------------------   00107300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00107400
.ZG32              ANOP  ,                                              00107500
&ZTLC              SETC 'M'                                             00107600
                   AIF   ('&MF(1)' NE '&ZTLC').ZG41                     00107700
&XMF               SETC  'M'         SET KEYWORD                        00107800
                   AIF   (N'&MF LE 3).ZG32A     CK NUM                  00107900
&ZMS               SETC  '"MF='                                         00108000
&ZMS               SETC  '&ZMS.&MF"'                                    00108100
&ZMS               SETC  '&ZMS "MF"'                                    00108200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00108300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00108400
.ZG32A             ANOP  ,                                              00108500
.*-------------------------------------------------------------------   00108600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00108700
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00108800
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00108900
                   AIF   (N'&MF(2) GT 1).ZG34B  MULTI                   00109000
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00109100
.ZG34B             AIF   (K'&MF(2) GT 0).ZG34C                          00109200
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00109300
&ZMS               SETC  'WHEN "M" IS SPECIFIED'                        00109400
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00109500
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00109600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00109700
.ZG34C             ANOP  ,                                              00109800
.*-------------------------------------------------------------------   00109900
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00110000
                   AIF   (K'&ZXMFCTRL LE 0).ZG34R  NOT I/O              00110100
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG34R                 00110200
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00110300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                   00110400
                   AIF   (K'&ZCGPR GT 2).ZG34Q                          00110500
                   AIF   ('&ZCGPR' EQ '0').ZG34Q                        00110600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00110700
                   AIF   (T'&ZCGPR NE 'N').ZG34Q  INVALID REG NAME      00110800
.ZG34P             ANOP  ,                                              00110900
                   AIF   (T'&ZCGPR NE 'N').ZG34R  NON NUMERIC           00111000
                   AIF   ('&ZCGPR' LT '1').ZG34Q                        00111100
                   AIF   ('&ZCGPR' LE '12').ZG34R                       00111200
.ZG34Q             ANOP  ,                                              00111300
&ZMS               SETC  '"MF='                                         00111400
&ZMS               SETC  '&ZMS.&MF"'                                    00111500
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00111600
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00111700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00111800
.ZG34R             ANOP  ,                                              00111900
.*-------------------------------------------------------------------   00112000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00112100
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00112200
.ZG38A   AIF   ('&MF(3)' NE 'COMPLETE').ZG39A                           00112300
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00112400
.*-------------------------------------------------------------------   00112500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00112600
.ZG39A   AIF   ('&MF(3)' NE 'NOCHECK').ZG40A                            00112700
&XMFSCK            SETC  'NOCHECK'   SET KEYWORD                        00112800
.*-------------------------------------------------------------------   00112900
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00113000
.ZG40A             AIF   (K'&XMFSCK GT 0).ZG40C  KEYWORD                00113100
                   AIF   (K'&MF(3) LE 0).ZG40B                          00113200
&ZMS               SETC  '"MF='                                         00113300
&ZMS               SETC  '&ZMS.&MF"'                                    00113400
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00113500
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00113600
&ZMS               SETC  '&ZMS "COMPLETE"'                              00113700
&ZMS               SETC  '&ZMS OR "NOCHECK".'                           00113800
                   MNOTE 8,' &ZMS '                                     00113900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00114000
.ZG40B             ANOP  ,                                              00114100
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00114200
.ZG40C             ANOP  ,                                              00114300
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00114400
.*-------------------------------------------------------------------   00114500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00114600
.ZG41              ANOP  ,                                              00114700
&ZTLC              SETC 'E'                                             00114800
                   AIF   ('&MF(1)' NE '&ZTLC').ZG50                     00114900
&XMF               SETC  'E'         SET KEYWORD                        00115000
                   AIF   (N'&MF LE 3).ZG41A     CK NUM                  00115100
&ZMS               SETC  '"MF='                                         00115200
&ZMS               SETC  '&ZMS.&MF"'                                    00115300
&ZMS               SETC  '&ZMS "MF"'                                    00115400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00115500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00115600
.ZG41A             ANOP  ,                                              00115700
.*-------------------------------------------------------------------   00115800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00115900
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00116000
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00116100
                   AIF   (N'&MF(2) GT 1).ZG43B  MULTI                   00116200
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00116300
.ZG43B             AIF   (K'&MF(2) GT 0).ZG43C                          00116400
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00116500
&ZMS               SETC  'WHEN "E" IS SPECIFIED'                        00116600
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00116700
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00116800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00116900
.ZG43C             ANOP  ,                                              00117000
.*-------------------------------------------------------------------   00117100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00117200
                   AIF   (K'&ZXMFCTRL LE 0).ZG43R  NOT I/O              00117300
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG43R                 00117400
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00117500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG43P                   00117600
                   AIF   (K'&ZCGPR GT 2).ZG43Q                          00117700
                   AIF   ('&ZCGPR' EQ '0').ZG43Q                        00117800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00117900
                   AIF   (T'&ZCGPR NE 'N').ZG43Q  INVALID REG NAME      00118000
.ZG43P             ANOP  ,                                              00118100
                   AIF   (T'&ZCGPR NE 'N').ZG43R  NON NUMERIC           00118200
                   AIF   ('&ZCGPR' LT '1').ZG43Q                        00118300
                   AIF   ('&ZCGPR' LE '12').ZG43R                       00118400
.ZG43Q             ANOP  ,                                              00118500
&ZMS               SETC  '"MF='                                         00118600
&ZMS               SETC  '&ZMS.&MF"'                                    00118700
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00118800
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00118900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00119000
.ZG43R             ANOP  ,                                              00119100
.*-------------------------------------------------------------------   00119200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00119300
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00119400
.ZG47A   AIF   ('&MF(3)' NE 'COMPLETE').ZG48A                           00119500
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00119600
.*-------------------------------------------------------------------   00119700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00119800
.ZG48A   AIF   ('&MF(3)' NE 'NOCHECK').ZG49A                            00119900
&XMFSCK            SETC  'NOCHECK'   SET KEYWORD                        00120000
.*-------------------------------------------------------------------   00120100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00120200
.ZG49A             AIF   (K'&XMFSCK GT 0).ZG49C  KEYWORD                00120300
                   AIF   (K'&MF(3) LE 0).ZG49B                          00120400
&ZMS               SETC  '"MF='                                         00120500
&ZMS               SETC  '&ZMS.&MF"'                                    00120600
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00120700
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00120800
&ZMS               SETC  '&ZMS "COMPLETE"'                              00120900
&ZMS               SETC  '&ZMS OR "NOCHECK".'                           00121000
                   MNOTE 8,' &ZMS '                                     00121100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00121200
.ZG49B             ANOP  ,                                              00121300
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00121400
.ZG49C             ANOP  ,                                              00121500
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00121600
.*------------------------------------------------------------------    00121700
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121800
.ZG50              ANOP  ,                                              00121900
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00122000
                   AIF   (K'&XMF GT 0).ZG50E    VALID ARG               00122100
                   AIF   (T'&MF EQ 'O').ZG50D   OMITTED                 00122200
&ZASYSLNDX         SETA  0                                              00122300
.ZG50A             ANOP  ,           POSITIONAL MACRO KEY               00122400
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00122500
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG50C               00122600
&ZTLC              SETC 'MF'                                            00122700
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG50A      00122800
.ZG50B             ANOP  ,                                              00122900
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00123000
&ZMS               SETC  'THE "MF" KEY'                                 00123100
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00123200
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00123300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00123400
                   AGO   .ZG50E                                         00123500
.ZG50C             ANOP  ,                                              00123600
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00123700
&ZMS               SETC  '"MF='                                         00123800
&ZMS               SETC  '&ZMS.&MF"'                                    00123900
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00124000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00124100
&ZMS               SETC  '&ZMS "S",'                                    00124200
&ZMS               SETC  '&ZMS "L",'                                    00124300
&ZMS               SETC  '&ZMS "M",'                                    00124400
&ZMS               SETC  '&ZMS OR "E".'                                 00124500
                   MNOTE 8,' &ZMS '                                     00124600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00124700
                   AGO   .ZG50E                                         00124800
.ZG50D             ANOP  ,                                              00124900
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00125000
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00125100
.ZG50E             ANOP  ,                                              00125200
.********************************************************************   00125300
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00125400
.********************************************************************   00125500
                   ACTR  10000                                          00125600
.*-------------------------------------------------------------------   00125700
.***AG.MF03 MF=(SLME)                                                   00125800
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00125900
                   AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                00126000
.*----------------------------------------------------------------***   00126100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00126200
                   AIF   (N'&STREAMTOKEN LE 1).ZG2A  CK NUM             00126300
&ZMS               SETC  '"STREAMTOKEN='                                00126400
&ZMS               SETC  '&ZMS.&STREAMTOKEN"'                           00126500
&ZMS               SETC  '&ZMS "STREAMTOKEN"'                           00126600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00126700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00126800
.ZG2A              ANOP  ,                                              00126900
.*-------------------------------------------------------------------   00127000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00127100
&ZXSTREAMTOKEN     SETC  'INPUT'     SET IN/OUTPUT                      00127200
&XSTREAMTOKEN      SETC  '&STREAMTOKEN(1)'      SET XVARIABLE           00127300
                   AIF   (N'&STREAMTOKEN GT 1).ZG2B  MULTI              00127400
&XSTREAMTOKEN      SETC  '&STREAMTOKEN'         SET XVARIABLE           00127500
.ZG2B              AIF   (K'&STREAMTOKEN(1) GT 0).ZG2C                  00127600
&ZXSTREAMTOKEN     SETC  ''          RESET IN/OUTPUT                    00127700
&ZMS               SETC  ' '                                            00127800
&ZMS               SETC  '&ZMS "STREAMTOKEN" KEY AND ITS'               00127900
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00128000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00128100
.ZG2C              ANOP  ,                                              00128200
.*-------------------------------------------------------------------   00128300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00128400
                   AIF   (K'&ZXSTREAMTOKEN LE 0).ZG2R  NOT I/O          00128500
                   AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZG2R             00128600
&ZCGPR             SETC  '&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2)           00128700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                    00128800
                   AIF   (K'&ZCGPR GT 2).ZG2Q                           00128900
                   AIF   ('&ZCGPR' EQ '0').ZG2Q                         00129000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00129100
                   AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME       00129200
.ZG2P              ANOP  ,                                              00129300
                   AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC            00129400
                   AIF   ('&ZCGPR' LT '2').ZG2Q                         00129500
                   AIF   ('&ZCGPR' LE '12').ZG2R                        00129600
.ZG2Q              ANOP  ,                                              00129700
&ZMS               SETC  '"STREAMTOKEN='                                00129800
&ZMS               SETC  '&ZMS.&STREAMTOKEN"'                           00129900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00130000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00130100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00130200
.ZG2R              ANOP  ,                                              00130300
.*----------------------------------------------------------------***   00130400
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00130500
                   AIF   (N'&GMT_TIMESTAMP LE 1).ZG5A  CK NUM           00130600
&ZMS               SETC  '"GMT_TIMESTAMP='                              00130700
&ZMS               SETC  '&ZMS.&GMT_TIMESTAMP"'                         00130800
&ZMS               SETC  '&ZMS "GMT_TIMESTAMP"'                         00130900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00131000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00131100
.ZG5A              ANOP  ,                                              00131200
.*-------------------------------------------------------------------   00131300
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00131400
&ZXGMT_TIMESTAMP   SETC  'INPUT'     SET IN/OUTPUT                      00131500
&XGMT_TIMESTAMP    SETC  'NO_GMT_TIMESTAMP'                             00131600
                   AIF   (K'&GMT_TIMESTAMP(1) LE 0).ZG5B  PARM          00131700
&XGMT_TIMESTAMP    SETC  '&GMT_TIMESTAMP(1)'    SET XVARIABLE           00131800
                   AIF   (N'&GMT_TIMESTAMP GT 1).ZG5B  MULTI            00131900
&XGMT_TIMESTAMP    SETC  '&GMT_TIMESTAMP'       SET XVARIABLE           00132000
.ZG5B              ANOP  ,                                              00132100
.*-------------------------------------------------------------------   00132200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00132300
                   AIF   (K'&ZXGMT_TIMESTAMP LE 0).ZG5R  NOT I/O        00132400
         AIF   ('&XGMT_TIMESTAMP' EQ 'NO_GMT_TIMESTAMP').ZG5R           00132500
                   AIF   ('&XGMT_TIMESTAMP'(1,1) NE '(').ZG5R           00132600
&ZCGPR             SETC  '&XGMT_TIMESTAMP'(2,K'&XGMT_TIMESTAMP-2)       00132700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                    00132800
                   AIF   (K'&ZCGPR GT 2).ZG5Q                           00132900
                   AIF   ('&ZCGPR' EQ '0').ZG5Q                         00133000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00133100
                   AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME       00133200
.ZG5P              ANOP  ,                                              00133300
                   AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC            00133400
                   AIF   ('&ZCGPR' LT '2').ZG5Q                         00133500
                   AIF   ('&ZCGPR' LE '12').ZG5R                        00133600
.ZG5Q              ANOP  ,                                              00133700
&ZMS               SETC  '"GMT_TIMESTAMP='                              00133800
&ZMS               SETC  '&ZMS.&GMT_TIMESTAMP"'                         00133900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00134000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00134100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00134200
.ZG5R              ANOP  ,                                              00134300
.*----------------------------------------------------------------***   00134400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00134500
                   AIF   (N'&ANSAREA LE 1).ZG8A  CK NUM                 00134600
&ZMS               SETC  '"ANSAREA='                                    00134700
&ZMS               SETC  '&ZMS.&ANSAREA"'                               00134800
&ZMS               SETC  '&ZMS "ANSAREA"'                               00134900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00135000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00135100
.ZG8A              ANOP  ,                                              00135200
.*-------------------------------------------------------------------   00135300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00135400
&ZXANSAREA         SETC  'INPUT'     SET IN/OUTPUT                      00135500
&XANSAREA          SETC  '&ANSAREA(1)'          SET XVARIABLE           00135600
                   AIF   (N'&ANSAREA GT 1).ZG8B  MULTI                  00135700
&XANSAREA          SETC  '&ANSAREA'  SET XVARIABLE                      00135800
.ZG8B              AIF   (K'&ANSAREA(1) GT 0).ZG8C                      00135900
&ZXANSAREA         SETC  ''          RESET IN/OUTPUT                    00136000
&ZMS               SETC  ' '                                            00136100
&ZMS               SETC  '&ZMS "ANSAREA" KEY AND ITS'                   00136200
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00136300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00136400
.ZG8C              ANOP  ,                                              00136500
.*-------------------------------------------------------------------   00136600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00136700
                   AIF   (K'&ZXANSAREA LE 0).ZG8R  NOT I/O              00136800
                   AIF   ('&XANSAREA'(1,1) NE '(').ZG8R                 00136900
&ZCGPR             SETC  '&XANSAREA'(2,K'&XANSAREA-2)                   00137000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG8P                    00137100
                   AIF   (K'&ZCGPR GT 2).ZG8Q                           00137200
                   AIF   ('&ZCGPR' EQ '0').ZG8Q                         00137300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00137400
                   AIF   (T'&ZCGPR NE 'N').ZG8Q  INVALID REG NAME       00137500
.ZG8P              ANOP  ,                                              00137600
                   AIF   (T'&ZCGPR NE 'N').ZG8R  NON NUMERIC            00137700
                   AIF   ('&ZCGPR' LT '2').ZG8Q                         00137800
                   AIF   ('&ZCGPR' LE '12').ZG8R                        00137900
.ZG8Q              ANOP  ,                                              00138000
&ZMS               SETC  '"ANSAREA='                                    00138100
&ZMS               SETC  '&ZMS.&ANSAREA"'                               00138200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00138300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00138400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00138500
.ZG8R              ANOP  ,                                              00138600
.*----------------------------------------------------------------***   00138700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00138800
                   AIF   (N'&ANSLEN LE 1).ZG11A  CK NUM                 00138900
&ZMS               SETC  '"ANSLEN='                                     00139000
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00139100
&ZMS               SETC  '&ZMS "ANSLEN"'                                00139200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00139300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00139400
.ZG11A             ANOP  ,                                              00139500
.*-------------------------------------------------------------------   00139600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00139700
&ZXANSLEN          SETC  'INPUT'     SET IN/OUTPUT                      00139800
&XANSLEN           SETC  '&ANSLEN(1)'           SET XVARIABLE           00139900
                   AIF   (N'&ANSLEN GT 1).ZG11B  MULTI                  00140000
&XANSLEN           SETC  '&ANSLEN'   SET XVARIABLE                      00140100
.ZG11B             AIF   (K'&ANSLEN(1) GT 0).ZG11C                      00140200
&ZXANSLEN          SETC  ''          RESET IN/OUTPUT                    00140300
&ZMS               SETC  ' '                                            00140400
&ZMS               SETC  '&ZMS "ANSLEN" KEY AND ITS'                    00140500
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00140600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00140700
.ZG11C             ANOP  ,                                              00140800
.*-------------------------------------------------------------------   00140900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00141000
                   AIF   (K'&ZXANSLEN LE 0).ZG11R  NOT I/O              00141100
                   AIF   ('&XANSLEN'(1,1) NE '(').ZG11R                 00141200
&ZCGPR             SETC  '&XANSLEN'(2,K'&XANSLEN-2)                     00141300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG11P                   00141400
                   AIF   (K'&ZCGPR GT 2).ZG11Q                          00141500
                   AIF   ('&ZCGPR' EQ '0').ZG11Q                        00141600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00141700
                   AIF   (T'&ZCGPR NE 'N').ZG11Q  INVALID REG NAME      00141800
.ZG11P             ANOP  ,                                              00141900
                   AIF   (T'&ZCGPR NE 'N').ZG11R  NON NUMERIC           00142000
                   AIF   ('&ZCGPR' LT '2').ZG11Q                        00142100
                   AIF   ('&ZCGPR' LE '12').ZG11R                       00142200
.ZG11Q             ANOP  ,                                              00142300
&ZMS               SETC  '"ANSLEN='                                     00142400
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00142500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00142600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00142700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00142800
.ZG11R             ANOP  ,                                              00142900
.*----------------------------------------------------------------***   00143000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00143100
                   AIF   (N'&RETCODE LE 1).ZG14A  CK NUM                00143200
&ZMS               SETC  '"RETCODE='                                    00143300
&ZMS               SETC  '&ZMS.&RETCODE"'                               00143400
&ZMS               SETC  '&ZMS "RETCODE"'                               00143500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00143600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00143700
.ZG14A             ANOP  ,                                              00143800
.*-------------------------------------------------------------------   00143900
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00144000
                   AIF   (K'&RETCODE(1) LE 0).ZG14C  NO PARM            00144100
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00144200
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00144300
                   AIF   (N'&RETCODE GT 1).ZG14C                        00144400
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00144500
.ZG14C             ANOP  ,                                              00144600
.*-------------------------------------------------------------------   00144700
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00144800
                   AIF   (K'&ZXRETCODE LE 0).ZG14R  NOT I/O             00144900
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG14R                00145000
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00145100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                   00145200
                   AIF   (K'&ZCGPR GT 2).ZG14Q                          00145300
                   AIF   ('&ZCGPR' EQ '0').ZG14Q                        00145400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00145500
                   AIF   (T'&ZCGPR NE 'N').ZG14Q  INVALID REG NAME      00145600
.ZG14P             ANOP  ,                                              00145700
                   AIF   (T'&ZCGPR NE 'N').ZG14R  NON NUMERIC           00145800
                   AIF   ('&ZCGPR' EQ '15').ZG14R                       00145900
                   AIF   ('&ZCGPR' LT '2').ZG14Q                        00146000
                   AIF   ('&ZCGPR' LE '12').ZG14R                       00146100
.ZG14Q             ANOP  ,                                              00146200
&ZMS               SETC  '"RETCODE='                                    00146300
&ZMS               SETC  '&ZMS.&RETCODE"'                               00146400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00146500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'       00146600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00146700
.ZG14R             ANOP  ,                                              00146800
.*----------------------------------------------------------------***   00146900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00147000
                   AIF   (N'&RSNCODE LE 1).ZG17A  CK NUM                00147100
&ZMS               SETC  '"RSNCODE='                                    00147200
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00147300
&ZMS               SETC  '&ZMS "RSNCODE"'                               00147400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00147500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00147600
.ZG17A             ANOP  ,                                              00147700
.*-------------------------------------------------------------------   00147800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00147900
                   AIF   (K'&RSNCODE(1) LE 0).ZG17C  NO PARM            00148000
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00148100
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00148200
                   AIF   (N'&RSNCODE GT 1).ZG17C                        00148300
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00148400
.ZG17C             ANOP  ,                                              00148500
.*-------------------------------------------------------------------   00148600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00148700
                   AIF   (K'&ZXRSNCODE LE 0).ZG17R  NOT I/O             00148800
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG17R                00148900
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00149000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG17P                   00149100
                   AIF   (K'&ZCGPR GT 2).ZG17Q                          00149200
                   AIF   ('&ZCGPR' EQ '0').ZG17R                        00149300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00149400
                   AIF   (T'&ZCGPR NE 'N').ZG17Q  INVALID REG NAME      00149500
.ZG17P             ANOP  ,                                              00149600
                   AIF   (T'&ZCGPR NE 'N').ZG17R  NON NUMERIC           00149700
                   AIF   ('&ZCGPR' EQ '0').ZG17R                        00149800
                   AIF   ('&ZCGPR' LT '2').ZG17Q                        00149900
                   AIF   ('&ZCGPR' LE '12').ZG17R                       00150000
.ZG17Q             ANOP  ,                                              00150100
&ZMS               SETC  '"RSNCODE='                                    00150200
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00150300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00150400
                   MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'        00150500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00150600
.ZG17R             ANOP  ,                                              00150700
.******************************************************************     00150800
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00150900
.******************************************************************     00151000
                   ACTR  10000                                          00151100
.*----------------------------------------------------------------***   00151200
.***AH.P02 EXTRA POSITIONALS                                            00151300
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00151400
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00151500
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00151600
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00151700
.ZGLISTX1          ANOP  ,                                              00151800
&ZCVAL             SETC  ''          ERROR FIELD                        00151900
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00152000
.ZGLIST2           ANOP  ,                                              00152100
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00152200
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00152300
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00152400
                   AGO   .ZGLIST2                                       00152500
.*                                                                      00152600
.ZGLIST3           ANOP  ,                                              00152700
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00152800
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00152900
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00153000
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00153100
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00153200
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00153300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00153400
.ZGLISTX           ANOP  ,                                              00153500
&ZASYSLNDX         SETA  0                                              00153600
.*-------------------------------------------------------------------   00153700
.***AG.MF04 MF=(SLME)                                                   00153800
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00153900
.********************************************************************   00154000
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00154100
.********************************************************************   00154200
                   ACTR  10000                                          00154300
.*-------------------------------------------------------------------   00154400
.***AE.MF01 MF=(SLME)                                                   00154500
                   AIF   ('&XMF' EQ 'L').ZEMFX                          00154600
                   AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                 00154700
.********************************************************************   00154800
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00154900
.********************************************************************   00155000
.*----------------------------------------------------------------***   00155100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00155200
                   AIF   (N'&STREAMTOKEN LE 1).ZE2A  CK NUM             00155300
&ZMS               SETC  '"STREAMTOKEN='                                00155400
&ZMS               SETC  '&ZMS.&STREAMTOKEN"'                           00155500
&ZMS               SETC  '&ZMS "STREAMTOKEN"'                           00155600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00155700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00155800
.ZE2A              ANOP  ,                                              00155900
.*-------------------------------------------------------------------   00156000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00156100
                   AIF   (K'&STREAMTOKEN(1) LE 0).ZE2B NO PRM           00156200
&ZXSTREAMTOKEN     SETC  'INPUT'     SET IN/OUTPUT                      00156300
&XSTREAMTOKEN      SETC  '&STREAMTOKEN(1)'      SET XVARIABLE           00156400
                   AIF   (N'&STREAMTOKEN GT 1).ZE2B                     00156500
.*                 ANOP                                                 00156600
&XSTREAMTOKEN      SETC  '&STREAMTOKEN'         SET XVARIABLE           00156700
.ZE2B              ANOP  ,                                              00156800
.*-------------------------------------------------------------------   00156900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00157000
                   AIF   (K'&ZXSTREAMTOKEN LE 0).ZE2R  NOT I/O          00157100
                   AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZE2R             00157200
&ZCGPR             SETC  '&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2)           00157300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                    00157400
                   AIF   (K'&ZCGPR GT 2).ZE2Q                           00157500
                   AIF   ('&ZCGPR' EQ '0').ZE2Q                         00157600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00157700
                   AIF   (T'&ZCGPR NE 'N').ZE2Q  INVALID REG NAME       00157800
.ZE2P              ANOP  ,                                              00157900
                   AIF   (T'&ZCGPR NE 'N').ZE2R  NON NUMERIC            00158000
                   AIF   ('&ZCGPR' LT '2').ZE2Q                         00158100
                   AIF   ('&ZCGPR' LE '12').ZE2R                        00158200
.ZE2Q              ANOP  ,                                              00158300
&ZMS               SETC  '"STREAMTOKEN='                                00158400
&ZMS               SETC  '&ZMS.&STREAMTOKEN"'                           00158500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00158600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00158700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00158800
.ZE2R              ANOP  ,                                              00158900
.*----------------------------------------------------------------***   00159000
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00159100
                   AIF   (N'&GMT_TIMESTAMP LE 1).ZE5A  CK NUM           00159200
&ZMS               SETC  '"GMT_TIMESTAMP='                              00159300
&ZMS               SETC  '&ZMS.&GMT_TIMESTAMP"'                         00159400
&ZMS               SETC  '&ZMS "GMT_TIMESTAMP"'                         00159500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00159600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00159700
.ZE5A              ANOP  ,                                              00159800
.*-------------------------------------------------------------------   00159900
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00160000
                   AIF   (K'&GMT_TIMESTAMP(1) LE 0).ZE5B NO PRM         00160100
&ZXGMT_TIMESTAMP   SETC  'INPUT'     SET IN/OUTPUT                      00160200
&XGMT_TIMESTAMP    SETC  '&GMT_TIMESTAMP(1)'    SET XVARIABLE           00160300
                   AIF   (N'&GMT_TIMESTAMP GT 1).ZE5B                   00160400
.*                 ANOP                                                 00160500
&XGMT_TIMESTAMP    SETC  '&GMT_TIMESTAMP'       SET XVARIABLE           00160600
.ZE5B              ANOP  ,                                              00160700
.*-------------------------------------------------------------------   00160800
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00160900
                   AIF   (K'&ZXGMT_TIMESTAMP LE 0).ZE5R  NOT I/O        00161000
                   AIF   ('&XGMT_TIMESTAMP'(1,1) NE '(').ZE5R           00161100
&ZCGPR             SETC  '&XGMT_TIMESTAMP'(2,K'&XGMT_TIMESTAMP-2)       00161200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                    00161300
                   AIF   (K'&ZCGPR GT 2).ZE5Q                           00161400
                   AIF   ('&ZCGPR' EQ '0').ZE5Q                         00161500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00161600
                   AIF   (T'&ZCGPR NE 'N').ZE5Q  INVALID REG NAME       00161700
.ZE5P              ANOP  ,                                              00161800
                   AIF   (T'&ZCGPR NE 'N').ZE5R  NON NUMERIC            00161900
                   AIF   ('&ZCGPR' LT '2').ZE5Q                         00162000
                   AIF   ('&ZCGPR' LE '12').ZE5R                        00162100
.ZE5Q              ANOP  ,                                              00162200
&ZMS               SETC  '"GMT_TIMESTAMP='                              00162300
&ZMS               SETC  '&ZMS.&GMT_TIMESTAMP"'                         00162400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00162500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00162600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00162700
.ZE5R              ANOP  ,                                              00162800
.*----------------------------------------------------------------***   00162900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00163000
                   AIF   (N'&ANSAREA LE 1).ZE8A  CK NUM                 00163100
&ZMS               SETC  '"ANSAREA='                                    00163200
&ZMS               SETC  '&ZMS.&ANSAREA"'                               00163300
&ZMS               SETC  '&ZMS "ANSAREA"'                               00163400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00163500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00163600
.ZE8A              ANOP  ,                                              00163700
.*-------------------------------------------------------------------   00163800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00163900
                   AIF   (K'&ANSAREA(1) LE 0).ZE8B NO PRM               00164000
&ZXANSAREA         SETC  'INPUT'     SET IN/OUTPUT                      00164100
&XANSAREA          SETC  '&ANSAREA(1)'          SET XVARIABLE           00164200
                   AIF   (N'&ANSAREA GT 1).ZE8B                         00164300
.*                 ANOP                                                 00164400
&XANSAREA          SETC  '&ANSAREA'  SET XVARIABLE                      00164500
.ZE8B              ANOP  ,                                              00164600
.*-------------------------------------------------------------------   00164700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00164800
                   AIF   (K'&ZXANSAREA LE 0).ZE8R  NOT I/O              00164900
                   AIF   ('&XANSAREA'(1,1) NE '(').ZE8R                 00165000
&ZCGPR             SETC  '&XANSAREA'(2,K'&XANSAREA-2)                   00165100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE8P                    00165200
                   AIF   (K'&ZCGPR GT 2).ZE8Q                           00165300
                   AIF   ('&ZCGPR' EQ '0').ZE8Q                         00165400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00165500
                   AIF   (T'&ZCGPR NE 'N').ZE8Q  INVALID REG NAME       00165600
.ZE8P              ANOP  ,                                              00165700
                   AIF   (T'&ZCGPR NE 'N').ZE8R  NON NUMERIC            00165800
                   AIF   ('&ZCGPR' LT '2').ZE8Q                         00165900
                   AIF   ('&ZCGPR' LE '12').ZE8R                        00166000
.ZE8Q              ANOP  ,                                              00166100
&ZMS               SETC  '"ANSAREA='                                    00166200
&ZMS               SETC  '&ZMS.&ANSAREA"'                               00166300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00166400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00166500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00166600
.ZE8R              ANOP  ,                                              00166700
.*----------------------------------------------------------------***   00166800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00166900
                   AIF   (N'&ANSLEN LE 1).ZE11A  CK NUM                 00167000
&ZMS               SETC  '"ANSLEN='                                     00167100
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00167200
&ZMS               SETC  '&ZMS "ANSLEN"'                                00167300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00167400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00167500
.ZE11A             ANOP  ,                                              00167600
.*-------------------------------------------------------------------   00167700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00167800
                   AIF   (K'&ANSLEN(1) LE 0).ZE11B NO PRM               00167900
&ZXANSLEN          SETC  'INPUT'     SET IN/OUTPUT                      00168000
&XANSLEN           SETC  '&ANSLEN(1)'           SET XVARIABLE           00168100
                   AIF   (N'&ANSLEN GT 1).ZE11B                         00168200
.*                 ANOP                                                 00168300
&XANSLEN           SETC  '&ANSLEN'   SET XVARIABLE                      00168400
.ZE11B             ANOP  ,                                              00168500
.*-------------------------------------------------------------------   00168600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00168700
                   AIF   (K'&ZXANSLEN LE 0).ZE11R  NOT I/O              00168800
                   AIF   ('&XANSLEN'(1,1) NE '(').ZE11R                 00168900
&ZCGPR             SETC  '&XANSLEN'(2,K'&XANSLEN-2)                     00169000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE11P                   00169100
                   AIF   (K'&ZCGPR GT 2).ZE11Q                          00169200
                   AIF   ('&ZCGPR' EQ '0').ZE11Q                        00169300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00169400
                   AIF   (T'&ZCGPR NE 'N').ZE11Q  INVALID REG NAME      00169500
.ZE11P             ANOP  ,                                              00169600
                   AIF   (T'&ZCGPR NE 'N').ZE11R  NON NUMERIC           00169700
                   AIF   ('&ZCGPR' LT '2').ZE11Q                        00169800
                   AIF   ('&ZCGPR' LE '12').ZE11R                       00169900
.ZE11Q             ANOP  ,                                              00170000
&ZMS               SETC  '"ANSLEN='                                     00170100
&ZMS               SETC  '&ZMS.&ANSLEN"'                                00170200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00170300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00170400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00170500
.ZE11R             ANOP  ,                                              00170600
.*----------------------------------------------------------------***   00170700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00170800
                   AIF   (N'&RETCODE LE 1).ZE14A  CK NUM                00170900
&ZMS               SETC  '"RETCODE='                                    00171000
&ZMS               SETC  '&ZMS.&RETCODE"'                               00171100
&ZMS               SETC  '&ZMS "RETCODE"'                               00171200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00171300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00171400
.ZE14A             ANOP  ,                                              00171500
.*-------------------------------------------------------------------   00171600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00171700
                   AIF   (K'&RETCODE(1) LE 0).ZE14B NO PRM              00171800
&ZXRETCODE         SETC  'OUTPUT'    SET IN/OUTPUT                      00171900
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00172000
                   AIF   (N'&RETCODE GT 1).ZE14B                        00172100
.*                 ANOP                                                 00172200
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00172300
.ZE14B             ANOP  ,                                              00172400
.*-------------------------------------------------------------------   00172500
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00172600
                   AIF   (K'&ZXRETCODE LE 0).ZE14R  NOT I/O             00172700
                   AIF   ('&XRETCODE'(1,1) NE '(').ZE14R                00172800
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00172900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE14P                   00173000
                   AIF   (K'&ZCGPR GT 2).ZE14Q                          00173100
                   AIF   ('&ZCGPR' EQ '0').ZE14Q                        00173200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00173300
                   AIF   (T'&ZCGPR NE 'N').ZE14Q  INVALID REG NAME      00173400
.ZE14P             ANOP  ,                                              00173500
                   AIF   (T'&ZCGPR NE 'N').ZE14R  NON NUMERIC           00173600
                   AIF   ('&ZCGPR' LT '2').ZE14Q                        00173700
                   AIF   ('&ZCGPR' LE '12').ZE14R                       00173800
.ZE14Q             ANOP  ,                                              00173900
&ZMS               SETC  '"RETCODE='                                    00174000
&ZMS               SETC  '&ZMS.&RETCODE"'                               00174100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00174200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00174300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00174400
.ZE14R             ANOP  ,                                              00174500
.*----------------------------------------------------------------***   00174600
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00174700
                   AIF   (N'&RSNCODE LE 1).ZE17A  CK NUM                00174800
&ZMS               SETC  '"RSNCODE='                                    00174900
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00175000
&ZMS               SETC  '&ZMS "RSNCODE"'                               00175100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00175200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00175300
.ZE17A             ANOP  ,                                              00175400
.*-------------------------------------------------------------------   00175500
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00175600
                   AIF   (K'&RSNCODE(1) LE 0).ZE17B NO PRM              00175700
&ZXRSNCODE         SETC  'OUTPUT'    SET IN/OUTPUT                      00175800
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00175900
                   AIF   (N'&RSNCODE GT 1).ZE17B                        00176000
.*                 ANOP                                                 00176100
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00176200
.ZE17B             ANOP  ,                                              00176300
.*-------------------------------------------------------------------   00176400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00176500
                   AIF   (K'&ZXRSNCODE LE 0).ZE17R  NOT I/O             00176600
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZE17R                00176700
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00176800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE17P                   00176900
                   AIF   (K'&ZCGPR GT 2).ZE17Q                          00177000
                   AIF   ('&ZCGPR' EQ '0').ZE17Q                        00177100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00177200
                   AIF   (T'&ZCGPR NE 'N').ZE17Q  INVALID REG NAME      00177300
.ZE17P             ANOP  ,                                              00177400
                   AIF   (T'&ZCGPR NE 'N').ZE17R  NON NUMERIC           00177500
                   AIF   ('&ZCGPR' LT '2').ZE17Q                        00177600
                   AIF   ('&ZCGPR' LE '12').ZE17R                       00177700
.ZE17Q             ANOP  ,                                              00177800
&ZMS               SETC  '"RSNCODE='                                    00177900
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00178000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00178100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00178200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00178300
.ZE17R             ANOP  ,                                              00178400
.******************************************************************     00178500
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00178600
.******************************************************************     00178700
                   ACTR  10000                                          00178800
.*----------------------------------------------------------------***   00178900
.***AF.P02 EXTRA POSITIONALS                                            00179000
                   AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS           00179100
&ZCVAL             SETC  ''          ERROR FIELD                        00179200
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00179300
.ZELIST2           ANOP  ,                                              00179400
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00179500
                   AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE           00179600
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00179700
                   AGO   .ZELIST2                                       00179800
.*                                                                      00179900
.ZELIST3           ANOP  ,                                              00180000
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00180100
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00180200
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00180300
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00180400
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00180500
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00180600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00180700
.ZELISTX           ANOP  ,                                              00180800
&ZASYSLNDX         SETA  0                                              00180900
.*-------------------------------------------------------------------   00181000
.***AE.MF02 MF=(SLME)                                                   00181100
.ZEMFX             ANOP  ,           END OF PARTIAL SYNTAX CHECK        00181200
.*******************************************************************    00181300
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00181400
.*******************************************************************    00181500
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00181600
.*******************************************************************    00181700
.***AE.01  START OF IXGUPDAT MACRO CODE                                 00181800
.*******************************************************************    00181900
                   LCLC  &M0M0001                 NAME                  00182000
&M0M0001           SETC  '&XLABEL'                SET NAME              00182100
                   AIF   (K'&XLABEL NE 0).XLAB2                         00182200
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00182300
.*                                                                      00182400
.XLAB2             ANOP  ,                                              00182500
                   AIF   ('&XMF' EQ 'L').XLAB3                          00182600
&M0M0001 DS    0H                             IXGUPDAT-0                00182700
.XLAB3             ANOP  ,                                              00182800
.*******************************************************************    00182900
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00183000
.*******************************************************************    00183100
              PUSH  PRINT                                               00183200
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00183300
                   PRINT OFF         ++ PR01                            00183400
                   AGO   .ZPRNTXX                                       00183500
.ZPRINTX           PRINT ON                                             00183600
.ZPRNTXX           ANOP  ,                                              00183700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00183800
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00183900
.********************************************************************   00184000
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00184100
.********************************************************************   00184200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00184300
                      LCLA  &ZOPN1         INVOCATION INDEX             00184400
                      LCLC  &ZOPL(4095)    LABEL                        00184500
                      LCLC  &ZOPO(4095)    OPERATION                    00184600
                      LCLC  &ZOPV(4095)    VALUE                        00184700
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00184800
.*                                                                      00184900
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00185000
.******************************************************************     00185100
.***AL.L10 IXGUPDAT FMT=LIST MF=S!L PARAMETERS                          00185200
.******************************************************************     00185300
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00185400
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00185500
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00185600
&XMFATTR              SETC  '0D'                                        00185700
.*                                                                      00185800
&ZOPN                 SETA  &ZOPN+1                                     00185900
&ZOPL(&ZOPN)          SETC  ' '                                         00186000
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00186100
&ZOPO(&ZOPN)          SETC  'B'                                         00186200
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00186300
                      AGO   .ZALVL6B                                    00186400
.ZALVL6A              ANOP                                              00186500
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00186600
&ZOPV(&ZOPN)          SETC  '4,8'                                       00186700
&ZOPN                 SETA  &ZOPN+1                                     00186800
&ZOPL(&ZOPN)          SETC  ' '                                         00186900
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00187000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00187100
.ZALVL6B              ANOP                                              00187200
&ZOPD(&ZOPN)          SETC  '++ IXGUPDAT ARG PARMS'                     00187300
.*                                                                      00187400
&ZOPN                 SETA  &ZOPN+1                                     00187500
&ZOPL(&ZOPN)          SETC  ' '                                         00187600
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00187700
&ZOPV(&ZOPN)          SETC  '1'                                         00187800
&ZOPD(&ZOPN)          SETC  ' '                                         00187900
.*                                                                      00188000
.ZLMFSL2              ANOP  ,                                           00188100
.*-------------------------------------------------------------------   00188200
.***AM.L00  IXGUPDAT FMT=LIST name                                      00188300
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00188400
&ZOPN                 SETA &ZOPN+1                                      00188500
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00188600
&ZOPO(&ZOPN)          SETC 'EQU'                                        00188700
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00188800
&ZOPD(&ZOPN)          SETC '++ IXGUPDAT NAME'                           00188900
.ZLMFSL2M             ANOP  ,                                           00189000
.*-------------------------------------------------------------------   00189100
.***AM.L01  IXGUPDAT FMT=LIST PARAMETERS                                00189200
&ZOPN                 SETA &ZOPN+1                                      00189300
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00189400
&ZOPO(&ZOPN)          SETC 'DS'                                         00189500
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00189600
&ZOPD(&ZOPN)          SETC '++ IXGUPDAT PARM LIST'                      00189700
.*-------------------------------------------------------------------   00189800
.***AM.L02 XVERSION XL1                                                 00189900
&ZOPN                 SETA &ZOPN+1                                      00190000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00190100
&ZOPO(&ZOPN)          SETC 'DS'                                         00190200
&ZOPV(&ZOPN)          SETC 'XL1'                                        00190300
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00190400
.*-------------------------------------------------------------------   00190500
.***AM.L03 XIXGFLAGS BL.8                                               00190600
&ZOPN                 SETA &ZOPN+1                                      00190700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XIXGFLAGS'                        00190800
&ZOPO(&ZOPN)          SETC 'DS'                                         00190900
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00191000
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00191100
.*                                                                      00191200
&ZOPN                 SETA  &ZOPN+1                                     00191300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_GMT_TIMESTAMP'           00191400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00191500
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00191600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00191700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GMT_TIMESTAMP'                00191800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00191900
.*-------------------------------------------------------------------   00192000
.***AM.L09  XRSV0001 CL2                                                00192100
&ZOPN                 SETA &ZOPN+1                                      00192200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         00192300
&ZOPO(&ZOPN)          SETC 'DS'                                         00192400
&ZOPV(&ZOPN)          SETC 'CL2'                                        00192500
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00192600
.*-------------------------------------------------------------------   00192700
.***AM.L09  XPLISTPTR A                                                 00192800
&ZOPN                 SETA &ZOPN+1                                      00192900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XPLISTPTR'                        00193000
&ZOPO(&ZOPN)          SETC 'DS'                                         00193100
&ZOPV(&ZOPN)          SETC 'A'                                          00193200
&ZOPD(&ZOPN)          SETC '++ INPUT '                                  00193300
.*-------------------------------------------------------------------   00193400
.***AM.L09  XGMT_TIMESTAMP CL8                                          00193500
&ZOPN                 SETA &ZOPN+1                                      00193600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XGMT_TIMESTAMP'                   00193700
&ZOPO(&ZOPN)          SETC 'DS'                                         00193800
&ZOPV(&ZOPN)          SETC 'CL8'                                        00193900
&ZOPD(&ZOPN)          SETC '++ &ZXGMT_TIMESTAMP '                       00194000
.*-------------------------------------------------------------------   00194100
.***AM.L09  XANSAREA A                                                  00194200
&ZOPN                 SETA &ZOPN+1                                      00194300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSAREA'                         00194400
&ZOPO(&ZOPN)          SETC 'DS'                                         00194500
&ZOPV(&ZOPN)          SETC 'A'                                          00194600
&ZOPD(&ZOPN)          SETC '++ &ZXANSAREA '                             00194700
.*-------------------------------------------------------------------   00194800
.***AM.L09  XANSLEN F                                                   00194900
&ZOPN                 SETA &ZOPN+1                                      00195000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XANSLEN'                          00195100
&ZOPO(&ZOPN)          SETC 'DS'                                         00195200
&ZOPV(&ZOPN)          SETC 'F'                                          00195300
&ZOPD(&ZOPN)          SETC '++ &ZXANSLEN '                              00195400
.*-------------------------------------------------------------------   00195500
.***AM.L09  XSTREAMTOKEN CL16                                           00195600
&ZOPN                 SETA &ZOPN+1                                      00195700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTREAMTOKEN'                     00195800
&ZOPO(&ZOPN)          SETC 'DS'                                         00195900
&ZOPV(&ZOPN)          SETC 'CL16'                                       00196000
&ZOPD(&ZOPN)          SETC '++ &ZXSTREAMTOKEN '                         00196100
.*-------------------------------------------------------------------   00196200
.***AM.L10 END OF IXGUPDAT LIST PARAMETERS                              00196300
&ZOPN                 SETA &ZOPN+1                                      00196400
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00196500
&ZOPO(&ZOPN)          SETC 'EQU'                                        00196600
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00196700
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00196800
.*                                                                      00196900
&ZOPN                 SETA &ZOPN+1                                      00197000
&ZOPL(&ZOPN)          SETC ' '                                          00197100
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00197200
&ZOPV(&ZOPN)          SETC '1'                                          00197300
&ZOPD(&ZOPN)          SETC ' '                                          00197400
.*-------------------------------------------------------------------   00197500
.***AL.L12 IXGUPDAT FMT=LIST MF=S!L PARAMETERS                          00197600
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00197700
.*                                                                      00197800
&ZOPN                 SETA  &ZOPN+1                                     00197900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00198000
&ZOPO(&ZOPN)          SETC  'DC'                                        00198100
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00198200
&ZOPD(&ZOPN)          SETC  '++ IXGUPDAT ARG PARMS'                     00198300
.*                                                                      00198400
.ZLMFSLX              ANOP  ,                                           00198500
.*-------------------------------------------------------------------   00198600
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00198700
&ZPLLEN               SETA 40                                           00198800
.*                                                                      00198900
.******************************************************************     00199000
.***AI.L01 IXGUPDAT FMT=LIST FILL IN PARAMETER AREA                     00199100
.******************************************************************     00199200
                      ACTR  10000                                       00199300
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00199400
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00199500
&ZCVAL                SETC  'LAE'          XAX MODE                     00199600
.ZIMFXA               ANOP ,                                            00199700
.*                                                                      00199800
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00199900
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00200000
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00200100
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00200200
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00200300
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00200400
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00200500
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00200600
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00200700
&ZOPN                 SETA  &ZOPN+1                                     00200800
&ZOPL(&ZOPN)          SETC  ' '                                         00200900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00201000
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00201100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00201200
                      AGO   .ZIMFNX                                     00201300
.*                                                                      00201400
.ZIMFN2               ANOP ,                                            00201500
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00201600
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00201700
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00201800
&ZOPN                 SETA  &ZOPN+1                                     00201900
&ZOPL(&ZOPN)          SETC  ' '                                         00202000
&ZOPO(&ZOPN)          SETC  'LAE'                                       00202100
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00202200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00202300
                      AGO   .ZIMFNX                                     00202400
.ZIMFNX1              ANOP ,                                            00202500
&ZOPN                 SETA  &ZOPN+1                                     00202600
&ZOPL(&ZOPN)          SETC  ' '                                         00202700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00202800
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00202900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00203000
.ZIMFNX               ANOP ,                                            00203100
.********************************************************************   00203200
.***AI.L02 IXGUPDAT FMT=LIST INITIALIZE PARAMETER AREA                  00203300
.********************************************************************   00203400
.***AI.L03 MF=(SLME)                                                    00203500
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00203600
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00203700
.*                                                                      00203800
&ZOPN                 SETA  &ZOPN+1                                     00203900
&ZOPL(&ZOPN)          SETC  ' '                                         00204000
&ZOPO(&ZOPN)          SETC  'XC'                                        00204100
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00204200
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00204300
.ZIMFLX               ANOP  ,                                           00204400
.*-------------------------------------------------------------------   00204500
.***AI.L05 XIXGFLAGS BL1                                                00204600
&ZW                   SETC  ''                                          00204700
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00204800
&ZMS                  SETC  ''                                          00204900
&ZC                   SETC  ''                                          00205000
.*-------------------------------------------------------------------   00205100
.***AI.L08 XIXGFLAGS "GMT_TIMESTAMP"                                    00205200
.***      BL1'1XXXXXXX'                                                 00205300
         AIF   ('&GMT_TIMESTAMP' EQ '').ZI3A                            00205400
&ZW                   SETC  '&ZW.10000000'                              00205500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00205600
&ZMS                  SETC  '&ZMS.01111111'                             00205700
                      AGO   .ZI3C                                       00205800
.*                                                                      00205900
.ZI3A                 ANOP  ,                                           00206000
&ZW                   SETC  '&ZW.00000000'                              00206100
&ZMS                  SETC  '&ZMS.11111111'                             00206200
.ZI3C                 ANOP  ,                                           00206300
.*-------------------------------------------------------------------   00206400
.***AI.L11 XIXGFLAGS BL1                                                00206500
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI3D               00206600
                      AIF   ('&ZC' NE 'YES').ZI3D                       00206700
&ZOPN                 SETA  &ZOPN+1                                     00206800
&ZOPL(&ZOPN)          SETC  ' '                                         00206900
&ZOPO(&ZOPN)          SETC  'NI'                                        00207000
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            00207100
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00207200
.ZI3D                 ANOP  ,                                           00207300
                      AIF   ('&ZCLNG' NE 'YES').ZI3E  ALL ZERO BITS     00207400
&ZOPN                 SETA  &ZOPN+1                                     00207500
&ZOPL(&ZOPN)          SETC  ' '                                         00207600
&ZOPO(&ZOPN)          SETC  'OI'                                        00207700
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00207800
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00207900
.ZI3E                 ANOP  ,                                           00208000
.*-------------------------------------------------------------------   00208100
.***AI.L18  XGMT_TIMESTAMP CL8                                          00208200
         AIF   ('&XGMT_TIMESTAMP' NE 'NO_GMT_TIMESTAMP').ZI6            00208300
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI6  CK *         00208400
&ZXGMT_TIMESTAMP      SETC  ''             RESET INPUT/OUTPUT           00208500
.ZI6                  ANOP  ,                                           00208600
.*-------------------------------------------------------------------   00208700
.***AI.L25  XGMT_TIMESTAMP CL8                                          00208800
                      AIF   ('&ZXGMT_TIMESTAMP' EQ '').ZI6E             00208900
                      AIF   ('&ZXGMT_TIMESTAMP' EQ 'OUTPUT').ZI6E       00209000
&ZCGPR                SETC  '&XGMT_TIMESTAMP'                           00209100
         AIF   ('&XGMT_TIMESTAMP' NE 'NO_GMT_TIMESTAMP').ZI6A           00209200
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI6E                           00209300
.*                                                                      00209400
&ZCGPR                SETC  '=XL8''00'''                                00209500
.ZI6A                 ANOP  ,                                           00209600
.*                                                                      00209700
                      AIF   ('&XGMT_TIMESTAMP'(1,1) NE '(').ZI6B        00209800
&ZCGPR   SETC  '0('.'&XGMT_TIMESTAMP'(2,K'&XGMT_TIMESTAMP-2).')'        00209900
.ZI6B                 ANOP  ,                                           00210000
.*                                                                      00210100
&ZOPN                 SETA  &ZOPN+1                                     00210200
&ZOPL(&ZOPN)          SETC  ' '                                         00210300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00210400
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             00210500
&ZOPD(&ZOPN)          SETC  '++ &ZXGMT_TIMESTAMP XGMT_TIMESTAMP'        00210600
.*                                                                      00210700
.ZI6E                 ANOP  ,                                           00210800
.*-------------------------------------------------------------------   00210900
.***AI.L19  XANSAREA A                                                  00211000
                      AIF   ('&ZXANSAREA' EQ '').ZI7H                   00211100
&ZCLNG                SETC  '&XANSAREA'                                 00211200
&ZCGPR                SETC  '14'                                        00211300
         AIF   ('&XANSAREA'(1,1) EQ '(').ZI7F  IN GPR                   00211400
.*                                                                      00211500
&ZOPN                 SETA  &ZOPN+1                                     00211600
&ZOPL(&ZOPN)          SETC  ' '                                         00211700
&ZOPO(&ZOPN)          SETC  'LA'                                        00211800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00211900
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00212000
.*                                                                      00212100
                      AGO   .ZI7G                                       00212200
.*                                                                      00212300
.ZI7F                 ANOP  ,                                           00212400
&ZCGPR   SETC  '&XANSAREA'(2,K'&XANSAREA-2)                             00212500
.*                                                                      00212600
.ZI7G                 ANOP  ,                                           00212700
.*                                                                      00212800
&ZOPN                 SETA  &ZOPN+1                                     00212900
&ZOPL(&ZOPN)          SETC  ' '                                         00213000
&ZOPO(&ZOPN)          SETC  'ST'                                        00213100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00213200
&ZOPD(&ZOPN)          SETC  '++ &ZXANSAREA XANSAREA'                    00213300
.*                                                                      00213400
.ZI7H                 ANOP  ,                                           00213500
.*-------------------------------------------------------------------   00213600
.***AI.L25  XANSLEN F                                                   00213700
                      AIF   ('&ZXANSLEN' EQ '').ZI8E                    00213800
                      AIF   ('&ZXANSLEN' EQ 'OUTPUT').ZI8E              00213900
&ZCGPR                SETC  '&XANSLEN'                                  00214000
.*                                                                      00214100
                      AIF   ('&XANSLEN'(1,1) NE '(').ZI8B               00214200
&ZCGPR   SETC  '0('.'&XANSLEN'(2,K'&XANSLEN-2).')'                      00214300
                      AGO   .ZI8D                                       00214400
.ZI8B                 ANOP  ,                                           00214500
.*                                                                      00214600
&ZC                   SETC  '&XANSLEN'(1,1)                             00214700
                      AIF   (T'&ZC NE 'N').ZI8D                         00214800
&ZC                   SETC  '&XANSLEN'                                  00214900
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI8D                00215000
&ZCGPR                SETC  '=AL4(&XANSLEN)'                            00215100
.*                                                                      00215200
.ZI8D                 ANOP  ,                                           00215300
.*                                                                      00215400
&ZOPN                 SETA  &ZOPN+1                                     00215500
&ZOPL(&ZOPN)          SETC  ' '                                         00215600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00215700
&ZOPV(&ZOPN)          SETC  '20(4,1),&ZCGPR'                            00215800
&ZOPD(&ZOPN)          SETC  '++ &ZXANSLEN XANSLEN'                      00215900
.*                                                                      00216000
.ZI8E                 ANOP  ,                                           00216100
.*-------------------------------------------------------------------   00216200
.***AI.L25  XSTREAMTOKEN CL16                                           00216300
                      AIF   ('&ZXSTREAMTOKEN' EQ '').ZI9E               00216400
                      AIF   ('&ZXSTREAMTOKEN' EQ 'OUTPUT').ZI9E         00216500
&ZCGPR                SETC  '&XSTREAMTOKEN'                             00216600
.*                                                                      00216700
                      AIF   ('&XSTREAMTOKEN'(1,1) NE '(').ZI9B          00216800
&ZCGPR   SETC  '0('.'&XSTREAMTOKEN'(2,K'&XSTREAMTOKEN-2).')'            00216900
.ZI9B                 ANOP  ,                                           00217000
.*                                                                      00217100
&ZOPN                 SETA  &ZOPN+1                                     00217200
&ZOPL(&ZOPN)          SETC  ' '                                         00217300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00217400
&ZOPV(&ZOPN)          SETC  '24(16,1),&ZCGPR'                           00217500
&ZOPD(&ZOPN)          SETC  '++ &ZXSTREAMTOKEN XSTREAMTOKEN'            00217600
.*                                                                      00217700
.ZI9E                 ANOP  ,                                           00217800
.*-------------------------------------------------------------------   00217900
.***AI.C01 RESTORE ADDR OF PARM LIST PTR                                00218000
.*                                                                      00218100
&ZOPN                 SETA  &ZOPN+1                                     00218200
&ZOPL(&ZOPN)          SETC  ' '                                         00218300
&ZOPO(&ZOPN)          SETC  'ST'                                        00218400
&ZOPV(&ZOPN)          SETC  '1,4(,1)'                                   00218500
&ZOPD(&ZOPN)          SETC  '++ STORE ADDR OF PARM LIST'                00218600
.*                                                                      00218700
&ZOPN                 SETA  &ZOPN+1                                     00218800
&ZOPL(&ZOPN)          SETC  ' '                                         00218900
&ZOPO(&ZOPN)          SETC  'LA'                                        00219000
&ZOPV(&ZOPN)          SETC  '1,4(,1)'                                   00219100
&ZOPD(&ZOPN)          SETC  '++ LOAD ADDR OF PARM LIST PTR INTO R1'     00219200
.*-------------------------------------------------------------------   00219300
&ZOPN1                SETA &ZOPN                                        00219400
.*-------------------------------------------------------------------   00219500
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00219600
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00219700
.*******************************************************************    00219800
.***  PROCESS IXGUPDAT OUTPUT PARAMETERS                                00219900
.*******************************************************************    00220000
                      ACTR  10000                                       00220100
.*******************************************************************    00220200
.***AO.X02  RETURN CODE PROCESSING                                      00220300
.*******************************************************************    00220400
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00220500
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00220600
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00220700
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00220800
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00220900
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00221000
&ZOPN                 SETA  &ZOPN+1                                     00221100
&ZOPL(&ZOPN)          SETC  ' '                                         00221200
&ZOPO(&ZOPN)          SETC  'ST'                                        00221300
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00221400
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00221500
                      AGO   .ZMRETX                                     00221600
.*                                                                      00221700
.ZMRET2               ANOP  ,                                           00221800
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00221900
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00222000
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00222100
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00222200
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00222300
&ZOPN                 SETA  &ZOPN+1                                     00222400
&ZOPL(&ZOPN)          SETC  ' '                                         00222500
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00222600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00222700
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00222800
.ZMRETX               ANOP  ,                                           00222900
.*******************************************************************    00223000
.***AO.X03  REASON CODE PROCESSING                                      00223100
.*******************************************************************    00223200
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00223300
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00223400
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00223500
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00223600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00223700
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00223800
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00223900
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00224000
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00224100
&ZOPN                 SETA  &ZOPN+1                                     00224200
&ZOPL(&ZOPN)          SETC  ' '                                         00224300
&ZOPO(&ZOPN)          SETC  'ST'                                        00224400
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00224500
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00224600
                      AGO   .ZMRSNX                                     00224700
.*                                                                      00224800
.ZMRSN2               ANOP  ,                                           00224900
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00225000
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00225100
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00225200
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00225300
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00225400
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00225500
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00225600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00225700
&ZOPN                 SETA  &ZOPN+1                                     00225800
&ZOPL(&ZOPN)          SETC  ' '                                         00225900
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00226000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00226100
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00226200
.ZMRSNX               ANOP  ,                                           00226300
.*******************************************************************    00226400
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00226500
.*******************************************************************    00226600
.ZMFLX                ANOP  ,              MF=L PROCESSING              00226700
.*******************************************************************    00226800
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00226900
.*******************************************************************    00227000
                      ACTR  10000                                       00227100
.*                                                                      00227200
                      LCLA  &ZLC           COLUMN POSITION              00227300
                      LCLA  &ZOPX          LIST TABLE INDEX             00227400
                      LCLC  &ZLL           LABEL                        00227500
                      LCLC  &ZLOP          OPERATION                    00227600
                      LCLC  &ZLV           VALUE                        00227700
                      LCLC  &ZLD           DESCRIPTION                  00227800
.*                                                                      00227900
&ZOPX                 SETA  1                                           00228000
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00228100
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00228200
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00228300
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00228400
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00228500
                      AIF   (K'&ZLD LE 0).ZL5                           00228600
&ZLC                  SETA  35             COMMENT COLUMN               00228700
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00228800
&ZLC                  SETA  33             COMMMENT COLUMN              00228900
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00229000
&ZLV                  SETC  '&ZLV'.' '                                  00229100
                      AGO   .ZL3                                        00229200
.*                                                                      00229300
.ZL4                  ANOP  ,                                           00229400
&ZLV                  SETC  '&ZLV'.' '                                  00229500
.ZL5                  ANOP  ,                                           00229600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00229700
.*                                                                      00229800
&ZLL     &ZLOP &ZLV                                                     00229900
.*                                                                      00230000
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00230100
                      AGO   .ZL2           CONTINUE LOOPING             00230200
.*                                                                      00230300
.ZLX                  ANOP  ,                                           00230400
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00230500
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00230600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00230700
         AIF   ('&SYSASCE' EQ 'P').UPPRIM  SYSSTATE PRIMARY             00230800
         SLR   15,15                SET GPR 15 TO ZERO                  00230900
         SAR   15,15                ENSURE AR 15 IS ZERO FOR PRIMARY    00231000
.UPPRIM  ANOP                                                           00231100
         AIF   ('&SYSAM64' EQ 'YES').UPA64                              00231200
         L     15,16(0,0)           GET CVT ADDRESS                     00231300
         AGO   .UPCONT                                                  00231400
.UPA64   LLGT  15,16(0,0)           GET CVT Address                     00231500
.UPCONT  L     15,140(15,0)         GET ECVT ADDRESS                    00231600
         L     15,288(15,0)         GET LSAB ADDRESS                    00231700
         L     15,124(15,0)         GET ENTRY POINT ADDRESS             00231800
         LA    0,10                 EX OF UPDATE SERVICE                00231900
         BALR  14,15                INVOKE SERVICE ROUTINE              00232000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00232100
.ZLINKX               ANOP  ,                                           00232200
.*******************************************************************    00232300
.***AP.X01  FORMAT GENERATED CODE                                       00232400
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00232500
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00232600
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00232700
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00232800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00232900
                      AIF   (K'&ZLD LE 0).ZL51                          00233000
&ZLC                  SETA  35             COMMENT COLUMN               00233100
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00233200
&ZLC                  SETA  33             COMMENT COLUMN               00233300
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00233400
&ZLV                  SETC  '&ZLV'.' '                                  00233500
                      AGO   .ZL31                                       00233600
.*                                                                      00233700
.ZL41                 ANOP  ,                                           00233800
&ZLV                  SETC  '&ZLV'.' '                                  00233900
.ZL51                 ANOP  ,                                           00234000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00234100
.*                                                                      00234200
&ZLL     &ZLOP &ZLV                                                     00234300
.*                                                                      00234400
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00234500
                      AGO   .ZL21          CONTINUE LOOPING             00234600
.*                                                                      00234700
.ZLX1                 ANOP  ,                                           00234800
.*******************************************************************    00234900
.***AP.X02  END OF IXGUPDAT MACRO                                       00235000
&ZIXGUPDAT            SETC  'YES'          SET IXGUPDAT USED            00235100
         POP   PRINT                                                    00235200
*                                            IXGUPDAT-0                 00235300
         SPACE 1                                                        00235400
.ZLX2                 ANOP  ,                                           00235500
         MEND                                                           00235600
**********************************************************************/ 00235700
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00235800
*%IXGUPDAT: MACRO KEYS(STREAMTOKEN,GMT_TIMESTAMP,ANSAREA,ANSLEN,        00235900
*                 RETCODE,RSNCODE,PLISTVER,MF);                         00236000
*  ANS('?'!!MACLABEL!!' '!!'IXGUPDAP '!!MACLIST!!                       00236100
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00236200
*%END IXGUPDAT;                                                         00236300

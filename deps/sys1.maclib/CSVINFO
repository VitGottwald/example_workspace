*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  CSVINFO                               -03/16/10-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  CSV Information Retrieval Service             * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 1992, 2011                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7780                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      The CSVINFO service searches contents supervision control      * 00002000
*      structures and returns selected module information as          * 00002100
*      specified by the user.                                         * 00002200
*                                                                     * 00002300
*      The user must provide a module information processing routine  * 00002400
*      which will process the information returned for each instance  * 00002500
*      of module information located by the CSVINFO service.          * 00002600
*                                                                     * 00002700
*      CSVINFO is provided in list, execute, modify, and standard     * 00002800
*      forms.  The list form accepts no variable parameters and is    * 00002900
*      used only to reserve space for the CSVINFO parameter list.     * 00003000
*      The execute and modify forms are provided for use with the     * 00003100
*      list form.  It will initialize the parameter list from the     * 00003200
*      keywords specified and call the service routine.  It is        * 00003300
*      provided for use with reentrant routines.  The standard form   * 00003400
*      is provided for use with routines which do not require         * 00003500
*      reentrant code.  All valid keywords may be used with this      * 00003600
*      form.                                                          * 00003700
*                                                                     * 00003800
*                                                                     * 00003900
*                                                                     * 00004000
*                                                                     * 00004100
*      INPUT REGISTERS:                                               * 00004200
*                                                                     * 00004300
*                                                                     * 00004400
*                          GR0         reserved                       * 00004500
*                                                                     * 00004600
*                          GR1         used to pass parameter list    * 00004700
*                                                                     * 00004800
*                          GR2-GR13    undefined                      * 00004900
*                                                                     * 00005000
*                          GR14-GR15   reserved for linkage           * 00005100
*                                                                     * 00005200
*                          AR0-AR1     reserved                       * 00005300
*                                                                     * 00005400
*                          AR2-AR13    undefined                      * 00005500
*                                                                     * 00005600
*                          AR14-AR15   reserved                       * 00005700
*                                                                     * 00005800
*                                                                     * 00005900
*                                                                     * 00006000
*                                                                     * 00006100
*                                                                     * 00006200
*                                                                     * 00006300
*      OUTPUT ENVIRONMENT: Same as on entry                           * 00006400
*                                                                     * 00006500
*      OUTPUT REGISTERS:                                              * 00006600
*                                                                     * 00006700
*                                                                     * 00006800
*                          GR0         reason code                    * 00006900
*                                                                     * 00007000
*                          GR1         unpredictable                  * 00007100
*                                                                     * 00007200
*                          GR2-GR13    unchanged                      * 00007300
*                                                                     * 00007400
*                          GR14        unpredictable                  * 00007500
*                                                                     * 00007600
*                          GR15        return code                    * 00007700
*                                                                     * 00007800
*                          AR0-AR1     unpredictable                  * 00007900
*                                                                     * 00008000
*                          AR2-AR13    unchanged                      * 00008100
*                                                                     * 00008200
*                          AR14-AR15   unpredictable                  * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*                                                                     * 00008600
*                                                                     * 00008700
*                                                                     * 00008800
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00008900
*                                                                     * 00009000
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00009100
*                                                                     * 00009200
*01* ENVIRONMENT:                                                     * 00009300
*                                                                     * 00009400
*                                                                     * 00009500
*      Dispatchable unit mode: Task or SRB mode.                      * 00009600
*                                                                     * 00009700
*      Minimum authorization: Problem or Supervisor state.  Any PSW   * 00009800
*                        key.  For CSVINFO, an authorized caller is a * 00009900
*                        supervisor state caller.  The service only   * 00010000
*                        serializes its operations for authorized     * 00010100
*                        callers.                                     * 00010200
*                                                                     * 00010300
*      AMODE:            31-bit.                                      * 00010400
*                                                                     * 00010500
*      ASC mode:         Primary.                                     * 00010600
*                                                                     * 00010700
*      Serialization:    Enabled.  The authorized caller may invoke   * 00010800
*                        CSVINFO holding the LOCAL and/or CMS         * 00010900
*                        lock(s).  The LOCAL lock is used to          * 00011000
*                        serialize the job pack area queue and the    * 00011100
*                        CMS lock is used to serialize the active     * 00011200
*                        link pack area queue.  The service obtains   * 00011300
*                        the LOCAL lock and the CMS lock (as needed)  * 00011400
*                        for serialization ONLY when the following    * 00011500
*                        conditions are true:                         * 00011600
*                                                                     * 00011700
*                                                                     * 00011800
*                        1.  The service is invoked by an authorized  * 00011900
*                            caller.                                  * 00012000
*                                                                     * 00012100
*                        2.  The service is NOT invoked under IPCS.   * 00012200
*                                                                     * 00012300
*                        3.  The needed lock is NOT already held.     * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*                                                                     * 00012700
*                        N.B.  Unauthorized users are cautioned that  * 00012800
*                        the service may terminate unexpectedly,      * 00012900
*                        detect spurious errors in control blocks, or * 00013000
*                        return incorrect data if multi-tasking is    * 00013100
*                        taking place in the user's address space,    * 00013200
*                        since no serialization is obtained by the    * 00013300
*                        service.                                     * 00013400
*                                                                     * 00013500
*      Restrictions:     No locks may be held which would prevent     * 00013600
*                        CSVINFO from obtaining the LOCAL lock to     * 00013700
*                        search the job pack area queue and/or the    * 00013800
*                        CMS lock to search the link pack area queue. * 00013900
*                                                                     * 00014000
*                                                                     * 00014100
*                                                                     * 00014200
*01* SYNTAX:                                                          * 00014300
*                                                                     * 00014400
*Ýxlabel¨  CSVINFO  Ð  FUNC=LPA                                       * 00014500
*                   Ô ,FUNC=JPA                                       * 00014600
*                   !     ,TCBADDR=xtcbaddr                           * 00014700
*                   Ô ,FUNC=TASKLOAD                                  * 00014800
*                   !     ,TCBADDR=xtcbaddr                           * 00014900
*                   Ô ,FUNC=TASKALL                                   * 00015000
*                   !     ,TCBADDR=xtcbaddr                           * 00015100
*                   ¿ ,FUNC=RB                                        * 00015200
*                         ,RBADDR=xrbaddr                             * 00015300
*                   Ð ,ENV=MVS                                        * 00015400
*                   ¿ ,ENV=IPCS                                       * 00015500
*                         ,ABDPLPTR=xabdplptr                         * 00015600
*                         ,ASID=xasid                                 * 00015700
*                     ,MIPR=xmipr                                     * 00015800
*                    Ý,USERDATA=»xuserdata!NULLº¨                     * 00015900
*                    Ý,RETCODE=xretcode¨                              * 00016000
*                    Ý,RSNCODE=xrsncode¨                              * 00016100
*                    Ý,COM=»xcom!NULLº¨                               * 00016200
*                    Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨          * 00016300
*                   ÐÝ,MF=S¨                                          * 00016400
*                   ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                   * 00016500
*                   ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00016600
*                   ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨             * 00016700
*                                                                     * 00016800
*                                                                     * 00016900
*      Where:                                                         * 00017000
*                                                                     * 00017100
*                                                                     * 00017200
*      Ýxlabel¨                                                       * 00017300
*          is an optional symbol, starting in column 1, that is the   * 00017400
*          name on the CSVINFO macro invocation.  The name must       * 00017500
*          conform to the rules for an ordinary assembler language    * 00017600
*          symbol.                                                    * 00017700
*          DEFAULT: No name.                                          * 00017800
*                                                                     * 00017900
*                                                                     * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*      FUNC=»LPA!JPA!TASKLOAD!TASKALL!RBº                             * 00018300
*          is a required keyword input that specifies the function    * 00018400
*          which CSVINFO is to perform.                               * 00018500
*                                                                     * 00018600
*                                                                     * 00018700
*          FUNC=LPA                                                   * 00018800
*              requests that CSVINFO return module information for    * 00018900
*              Link Pack Area (LPA) modules.                          * 00019000
*                                                                     * 00019100
*          FUNC=JPA                                                   * 00019200
*              requests that CSVINFO return module information for    * 00019300
*              all modules in the Job Pack Queue for the Job Step     * 00019400
*              Task associated with the task specified by the TCBADDR * 00019500
*              keyword.                                               * 00019600
*                                                                     * 00019700
*              Module information is returned for all modules in the  * 00019800
*              private area known to the selected Job Step Task.      * 00019900
*              This covers all modules brought into storage via LINK  * 00020000
*              (or LINKX), LOAD, ATTACH (or ATTACHX), XCTL (or        * 00020100
*              XCTLX), or via the OpenMVS "exec()" function syscall.  * 00020200
*              It also inlcudes any modules that are in common        * 00020300
*              storage as a result of a LOAD to GLOBAL having been    * 00020400
*              performed by any task in the job running under the     * 00020500
*              selected Job Step Task.                                * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*              TCBADDR=xtcbaddr                                       * 00020900
*                  is the name (RS-type), or address in register      * 00021000
*                  (2)-(12), of a required 4 byte input that contains * 00021100
*                  the address of the TCB to which the JPA function   * 00021200
*                  applies.                                           * 00021300
*                                                                     * 00021400
*                                                                     * 00021500
*                                                                     * 00021600
*          FUNC=TASKLOAD                                              * 00021700
*              requests that CSVINFO return module information for    * 00021800
*              all modules LOADed (and not yet DELETEd) by the task   * 00021900
*              specified by the TCBADDR keyword.                      * 00022000
*                                                                     * 00022100
*                                                                     * 00022200
*              TCBADDR=xtcbaddr                                       * 00022300
*                  is the name (RS-type), or address in register      * 00022400
*                  (2)-(12), of a required 4 byte input that contains * 00022500
*                  the address of the TCB to which the TASKLOAD       * 00022600
*                  function applies.                                  * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*                                                                     * 00023000
*          FUNC=TASKALL                                               * 00023100
*              requests that CSVINFO return module information for    * 00023200
*              all modules running under RBs under the task specified * 00023300
*              by the TCBADDR keyword.  This represents the           * 00023400
*              information for all the modules that have been LINKed  * 00023500
*              or XCTLed to under the specified task and have not yet * 00023600
*              completed.                                             * 00023700
*                                                                     * 00023800
*              This function may return information on LPA modules as * 00023900
*              well as private modules. Note that this function may   * 00024000
*              give duplicate information on some modules, since a    * 00024100
*              module may well be in use multiple times.              * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*              TCBADDR=xtcbaddr                                       * 00024500
*                  is the name (RS-type), or address in register      * 00024600
*                  (2)-(12), of a required 4 byte input that contains * 00024700
*                  the address of the TCB to which the TASKALL        * 00024800
*                  function applies.                                  * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*                                                                     * 00025200
*          FUNC=RB                                                    * 00025300
*              requests that CSVINFO return module information for    * 00025400
*              the module running under the RB specified by the       * 00025500
*              RBADDR keyword.                                        * 00025600
*                                                                     * 00025700
*                                                                     * 00025800
*              RBADDR=xrbaddr                                         * 00025900
*                  is the name (RS-type), or address in register      * 00026000
*                  (2)-(12), of a required 4 byte input that contains * 00026100
*                  the address of the RB for which module information * 00026200
*                  is to be provided.                                 * 00026300
*                                                                     * 00026400
*                                                                     * 00026500
*                                                                     * 00026600
*                                                                     * 00026700
*                                                                     * 00026800
*                                                                     * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*      ENV=»MVS!IPCSº                                                 * 00027200
*          is a required keyword input that specifies the operating   * 00027300
*          environment in which CSVINFO is being invoked.             * 00027400
*                                                                     * 00027500
*                                                                     * 00027600
*          ENV=MVS                                                    * 00027700
*              indicates that CSVINFO is being invoked in a normal    * 00027800
*              MVS execution environment.  The caller may be either   * 00027900
*              authorized or not.  If the caller is authorized, the   * 00028000
*              local lock and CMS LOCK may be held by the caller.     * 00028100
*                                                                     * 00028200
*          ENV=IPCS                                                   * 00028300
*              indicates that CSVINFO is being invoked in an IPCS     * 00028400
*              environment.  The caller must be unauthorized.  No     * 00028500
*              serialization or recovery is obtained by the CSVINFO   * 00028600
*              service when this option is specified.                 * 00028700
*                                                                     * 00028800
*              The BLSABDPL mapping macro must be included in the     * 00028900
*              program when this option is specified.                 * 00029000
*                                                                     * 00029100
*              Current addressability to the ABDPL is not required to * 00029200
*              invoke CSVINFO.                                        * 00029300
*                                                                     * 00029400
*                                                                     * 00029500
*              ABDPLPTR=xabdplptr                                     * 00029600
*                  is the name (RS-type), or address in register      * 00029700
*                  (2)-(12), of a required 4 byte input that contains * 00029800
*                  the address of the ABDUMP parameter list (ABDPL)   * 00029900
*                  which is currently in use.  The address of the     * 00030000
*                  ABDPL is passed on to the caller's module          * 00030100
*                  information processing routine in the input        * 00030200
*                  parameter list mapped by the CSVMODI mapping       * 00030300
*                  macro.                                             * 00030400
*                                                                     * 00030500
*                                                                     * 00030600
*                                                                     * 00030700
*                                                                     * 00030800
*              ASID=xasid                                             * 00030900
*                  is the name (RS-type), or address in register      * 00031000
*                  (2)-(12), of a required 16 bit input address space * 00031100
*                  id in the dump from which the requested module     * 00031200
*                  information is to be obtained.                     * 00031300
*                                                                     * 00031400
*                  The specified address space id is stored in the    * 00031500
*                  ADPLASID field of the ABDPL and the ADPLASID field * 00031600
*                  will have this value when the MIPR routine is      * 00031700
*                  entered.                                           * 00031800
*                                                                     * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*                                                                     * 00032400
*                                                                     * 00032500
*                                                                     * 00032600
*      MIPR=xmipr                                                     * 00032700
*          is a required input.  It is the name (RS-type), or address * 00032800
*          in register (2)-(12), of the caller's Module Information   * 00032900
*          Processing Routine (MIPR).                                 * 00033000
*                                                                     * 00033100
*          The interface to the caller's MIPR is as follows:          * 00033200
*                                                                     * 00033300
*          SERIALIZATION AND RECOVERY                                 * 00033400
*                                                                     * 00033500
*          The user's MIPR gets control with CSVINFO's FRR in place   * 00033600
*          and the local lock held if the user is authorized.         * 00033700
*                                                                     * 00033800
*          If FUNC(LPA) is requested by an authorized user, the CMS   * 00033900
*          lock is also held when the MIPR gets control.  Care should * 00034000
*          be taken that the MIPR routine does not consume excessive  * 00034100
*          time, as holding this lock for an extended period of time  * 00034200
*          could cause system problems.                               * 00034300
*                                                                     * 00034400
*          If the user is unauthorized, the user's MIPR receives      * 00034500
*          control with CSVINFO's ESTAE routine in effect.  No locks  * 00034600
*          are obtained by CSVINFO when the caller is unauthorized.   * 00034700
*                                                                     * 00034800
*          MIPR INPUT (CSVINFO OUTPUT)                                * 00034900
*                                                                     * 00035000
*          The MIPR routine gets control via standard branch entry    * 00035100
*          linkage in 31 bit addressing mode.                         * 00035200
*                                                                     * 00035300
*                                                                     * 00035400
*                                                                     * 00035500
*          MIPR INPUT REGISTERS:                                      * 00035600
*                                                                     * 00035700
*                                                                     * 00035800
*                              GR0         reserved                   * 00035900
*                                                                     * 00036000
*                              GR1         address of the Contents    * 00036100
*                                          Supervision Module         * 00036200
*                                          Information Area mapped by * 00036300
*                                          the CSVMODI mapping macro. * 00036400
*                                                                     * 00036500
*                              GR2-GR12    irrelevant                 * 00036600
*                                                                     * 00036700
*                              GR13        address of standard 72     * 00036800
*                                          byte savearea              * 00036900
*                                                                     * 00037000
*                              GR14        return address to CSVINFO  * 00037100
*                                          service                    * 00037200
*                                                                     * 00037300
*                              GR15        address of the MIPR        * 00037400
*                                          routine entry point        * 00037500
*                                                                     * 00037600
*                              AR0-AR15    reserved. AR mode note     * 00037700
*                                          supported.                 * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*                                                                     * 00038100
*                              MIPR OUTPUT                            * 00038200
*                                                                     * 00038300
*                                                                     * 00038400
*          MIPR OUTPUT REGISTERS:                                     * 00038500
*                                                                     * 00038600
*                                                                     * 00038700
*                              MIPR output environment: Same as on    * 00038800
*                                          entry                      * 00038900
*                                                                     * 00039000
*                              GR0-GR1     unpredictable              * 00039100
*                                                                     * 00039200
*                              GR2-GR12    (unchanged) must be        * 00039300
*                                          restored to contents at    * 00039400
*                                          input to MIPR              * 00039500
*                                                                     * 00039600
*                              GR13        unchanged (save area       * 00039700
*                                          address)                   * 00039800
*                                                                     * 00039900
*                              GR14        unchanged (CSVINFO return  * 00040000
*                                          address)                   * 00040100
*                                                                     * 00040200
*                              GR15        MIPR return code           * 00040300
*                                                                     * 00040400
*                                          The user's Module          * 00040500
*                                          Information Processing     * 00040600
*                                          Routine (MIPR) should      * 00040700
*                                          return to CSVINFO with a   * 00040800
*                                          return code as follows:    * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                          o   0 - Continue           * 00041200
*                                              Processing             * 00041300
*                                                                     * 00041400
*                                          o   anything else -        * 00041500
*                                              terminate processing.  * 00041600
*                                                                     * 00041700
*                                              A non-zero return code * 00041800
*                                              will be passed back to * 00041900
*                                              the caller of CSVINFO  * 00042000
*                                              as the reason code     * 00042100
*                                              associated with return * 00042200
*                                              code 8.                * 00042300
*                                                                     * 00042400
*                                                                     * 00042500
*                                                                     * 00042600
*                              AR0-AR1     unpredictable              * 00042700
*                                                                     * 00042800
*                              AR2-AR13    unchanged                  * 00042900
*                                                                     * 00043000
*                              AR14-AR15   unpredictable              * 00043100
*                                                                     * 00043200
*                                                                     * 00043300
*                                                                     * 00043400
*                                                                     * 00043500
*                                                                     * 00043600
*          The CSVMODI mapping consists of a main section with        * 00043700
*          pointers to other sections containing portions of the      * 00043800
*          overall module information.  All of the meaningful         * 00043900
*          contents supervision information related to the instance   * 00044000
*          of the module's usage is contained in the areas mapped by  * 00044100
*          the macro.                                                 * 00044200
*                                                                     * 00044300
*          See the macro in SYS1.MACLIB for details of the CSVMODI    * 00044400
*          macro.                                                     * 00044500
*                                                                     * 00044600
*                                                                     * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*      ÝUSERDATA=»xuserdata!NULLº¨                                    * 00045000
*          is the name (RS-type) of an optional 16 character input    * 00045100
*          containing user data from the caller that is made          * 00045200
*          available to the module information processing routine     * 00045300
*          specified by the MIPR keyword.  The information is         * 00045400
*          included in the CSVMODI mapping macro.                     * 00045500
*          DEFAULT: NULL                                              * 00045600
*                                                                     * 00045700
*                                                                     * 00045800
*                                                                     * 00045900
*                                                                     * 00046000
*      ÝRETCODE=xretcode¨                                             * 00046100
*          is the name (RS-type) of an optional fullword output       * 00046200
*          variable, or register (2)-(12) or (15), into which the     * 00046300
*          return code is to be copied from GPR 15.  If you specify   * 00046400
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00046500
*          the value will be left in GPR 15.                          * 00046600
*                                                                     * 00046700
*                                                                     * 00046800
*                                                                     * 00046900
*                                                                     * 00047000
*      ÝRSNCODE=xrsncode¨                                             * 00047100
*          is the name (RS-type) of an optional fullword output       * 00047200
*          variable into which the reason code is to be copied from   * 00047300
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00047400
*          R0 (within or without parentheses), the value will be left * 00047500
*          in GPR 0.                                                  * 00047600
*                                                                     * 00047700
*                                                                     * 00047800
*                                                                     * 00047900
*                                                                     * 00048000
*      ÝCOM=»xcom!NULLº¨                                              * 00048100
*          is an optional character input  that will appear in the    * 00048200
*          block comment before the macro invocation echo. It can be  * 00048300
*          used to comment the macro invocation.  The comment string  * 00048400
*          must be enclosed in quotes if it contains any lower case   * 00048500
*          characters.                                                * 00048600
*          DEFAULT: NULL                                              * 00048700
*                                                                     * 00048800
*                                                                     * 00048900
*                                                                     * 00049000
*                                                                     * 00049100
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00049200
*          is an optional byte input decimal value in the "0-0" range * 00049300
*          that specifies the macro version.  PLISTVER is the only    * 00049400
*          key allowed on the list form of MF and determines which    * 00049500
*          parameter list is generated.  Note that MAX may be         * 00049600
*          specified instead of a number, and the parameter list will * 00049700
*          be of the largest size currently supported. This size may  * 00049800
*          grow from release to release (thus possibly affecting the  * 00049900
*          amount of storage needed by your program).  If your        * 00050000
*          program can tolerate this, IBM recommends that you always  * 00050100
*          specify MAX when creating the list form parameter list as  * 00050200
*          that will ensure that the list form parameter list is      * 00050300
*          always long enough to hold whatever parameters might be    * 00050400
*          specified on the execute form.                             * 00050500
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00050600
*          default is the lowest version which allows all of the      * 00050700
*          parameters specified on the invocation to be processed.    * 00050800
*                                                                     * 00050900
*                                                                     * 00051000
*                                                                     * 00051100
*                                                                     * 00051200
*      ÝMF=»S!L!M!Eº¨                                                 * 00051300
*          is an optional keyword input which specifies the macro     * 00051400
*          form.                                                      * 00051500
*          DEFAULT: S                                                 * 00051600
*                                                                     * 00051700
*                                                                     * 00051800
*          ÝMF=S¨                                                     * 00051900
*              specifies the standard form of the macro.  The "S"     * 00052000
*              form generates code to put the parameters into an      * 00052100
*              in-line parameter list and invoke the desired service. * 00052200
*              Full checking for required macro keys is done along    * 00052300
*              with supplying defaults for omitted optional           * 00052400
*              parameters.                                            * 00052500
*                                                                     * 00052600
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00052700
*              specifies the list form of the macro.  The "L" form    * 00052800
*              defines an area to be used for the parameter list.     * 00052900
*              Only the PLISTVER key may be specified on the          * 00053000
*              invocation.  All other macro parameters are flagged as * 00053100
*              errors.  If PLISTVER is not specified, the original    * 00053200
*              parameter list definition is used.                     * 00053300
*                                                                     * 00053400
*            ,xmfctrl                                                 * 00053500
*              is a required input.  It is the name of a storage area * 00053600
*              for the parameter list.                                * 00053700
*                                                                     * 00053800
*            »,xmfattr!0Dº                                            * 00053900
*              is an optional 60 character input string that varies   * 00054000
*              from 1 to 60 characters. Use it to force boundary      * 00054100
*              alignment of the parameter list. Use only 0F or 0D.    * 00054200
*              DEFAULT: 0D which forces the parameter list to a       * 00054300
*              doubleword boundary.                                   * 00054400
*                                                                     * 00054500
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00054600
*              specifies the modify form of the macro.  The "M" form  * 00054700
*              generates code to put the parameters into the          * 00054800
*              parameter list specified by xmfctrl.                   * 00054900
*                                                                     * 00055000
*            ,xmfctrl                                                 * 00055100
*              is a required input.  It is the name (RS-type), or     * 00055200
*              address in register (1)-(12), of a storage area for    * 00055300
*              the parameter list.                                    * 00055400
*                                                                     * 00055500
*            »,COMPLETE!NOCHECKº¨                                     * 00055600
*              is an optional keyword input which specifies the       * 00055700
*              degree of macro parameter syntax checking.             * 00055800
*              DEFAULT: COMPLETE                                      * 00055900
*                                                                     * 00056000
*                                                                     * 00056100
*              COMPLETE                                               * 00056200
*                  Checking for required macro keys is done and       * 00056300
*                  defaults are supplied for omitted optional         * 00056400
*                  parameters.  (See Macro Usage Note 2).             * 00056500
*                                                                     * 00056600
*              NOCHECK                                                * 00056700
*                  Checking for required macro keys is not done nor   * 00056800
*                  are defaults supplied for omitted optional         * 00056900
*                  parameters.                                        * 00057000
*                                                                     * 00057100
*                                                                     * 00057200
*                                                                     * 00057300
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00057400
*              specifies the execute form of the macro.  The "E" form * 00057500
*              generates code to put the parameters into the          * 00057600
*              parameter list specified by xmfctrl and invoke the     * 00057700
*              desired service.                                       * 00057800
*                                                                     * 00057900
*            ,xmfctrl                                                 * 00058000
*              is a required input.  It is the name (RS-type), or     * 00058100
*              address in register (1)-(12), of a storage area for    * 00058200
*              the parameter list.                                    * 00058300
*                                                                     * 00058400
*            »,COMPLETE!NOCHECKº                                      * 00058500
*              is an optional keyword input which specifies the       * 00058600
*              degree of macro parameter syntax checking.             * 00058700
*              DEFAULT: COMPLETE                                      * 00058800
*                                                                     * 00058900
*                                                                     * 00059000
*              COMPLETE                                               * 00059100
*                  Checking for required macro keys is done and       * 00059200
*                  defaults are supplied for omitted optional         * 00059300
*                  parameters.  (See Macro Usage Note 2).             * 00059400
*                                                                     * 00059500
*              NOCHECK                                                * 00059600
*                  Checking for required macro keys is not done nor   * 00059700
*                  are defaults supplied for omitted optional         * 00059800
*                  parameters.                                        * 00059900
*                                                                     * 00060000
*                                                                     * 00060100
*                                                                     * 00060200
*                                                                     * 00060300
*                                                                     * 00060400
*                                                                     * 00060500
*                                                                     * 00060600
*01* RETURN CODES:                                                    * 00060700
*                                                                     * 00060800
*                                                                     * 00060900
*                                                                     * 00061000
*                      0 -- (MODI_OK) CSVINFO retrieved all the       * 00061100
*                           requested information.                    * 00061200
*                                                                     * 00061300
*                      4 -- (MODI_NOINFO) There was no information    * 00061400
*                           for CSVINFO to return.                    * 00061500
*                                                                     * 00061600
*                      8 -- (MODI_CALLER) CSVINFO processing was      * 00061700
*                           terminated by a non-zero return code from * 00061800
*                           the user's module information processing  * 00061900
*                           routine (MIPR).  The reason code contains * 00062000
*                           the return code from that routine.  The   * 00062100
*                           meaning assigned to the return codes from * 00062200
*                           the user's MIPR is entirely up to the     * 00062300
*                           user.                                     * 00062400
*                                                                     * 00062500
*                      12 ('C'X) -- (MODI_LOCKS) CSVINFO was unable   * 00062600
*                           to obtain the locks needed for            * 00062700
*                           serialization.                            * 00062800
*                                                                     * 00062900
*                      16 ('10'X) -- (MODI_INVALID_INPUT) Invalid or  * 00063000
*                           unaccessable input parameters.            * 00063100
*                                                                     * 00063200
*                      20 ('14'X) -- (MODI_NOTAVAIL) The CSVINFO      * 00063300
*                           service is not available.                 * 00063400
*                                                                     * 00063500
*                      24 ('18'X) -- (MODI_NOTRETRIEVED) CSVINFO      * 00063600
*                           processing terminated because requested   * 00063700
*                           information could not be retrieved from   * 00063800
*                           the dump.  This return code only applies  * 00063900
*                           to the ENV(IPCS) option.                  * 00064000
*                                                                     * 00064100
*                      28 ('1C'X) -- (MODI_UNEXPECTED) Processing     * 00064200
*                           terminated unexcpectedly.                 * 00064300
*                                                                     * 00064400
*                      32 ('20'X) -- (MODI_BELOW430) The CSVINFO      * 00064500
*                           function is not supported on the current  * 00064600
*                           level of the system.                      * 00064700
*                                                                     * 00064800
*                      36 ('24'X) -- (MODI_BAD_PARMLIST) The CSVINFO  * 00064900
*                           parameter list is not valid for the level * 00065000
*                           of CSVINFO service on the system.         * 00065100
*                                                                     * 00065200
*                      40 ('28'X) -- (MODI_LOOP_LIMIT) The CSVINFO    * 00065300
*                           service has exceeded a large internal     * 00065400
*                           threshold value for the number of times   * 00065500
*                           the MIPR is invoked.  This return code    * 00065600
*                           indicates either that there is a loop in  * 00065700
*                           a queue being run or that the combination * 00065800
*                           or running unserialized and encountering  * 00065900
*                           some bad data is causing an apparent      * 00066000
*                           infinite loop.                            * 00066100
*                                                                     * 00066200
*                      44 ('2C'X) -- (MODI_INELIGIBLE_RB) The RB      * 00066300
*                           supplied via RBADDR as input for FUNC(RB) * 00066400
*                           was not a PRB or SVRB.                    * 00066500
*                                                                     * 00066600
*                      48 ('30'X) -- (MODI_MIPR_FAILED) The supplied  * 00066700
*                           MIPR routine failed.                      * 00066800
*                                                                     * 00066900
*                      52 ('34'X) -- (MODI_RB_LOOP) The RB supplied   * 00067000
*                           via RBADDR as input for FUNC(RB) has      * 00067100
*                           resulted in the CSVINFO service exceeding * 00067200
*                           the expected number of iterations through * 00067300
*                           an RB chain.                              * 00067400
*                                                                     * 00067500
*                                                                     * 00067600
*                                                                     * 00067700
*                                                                     * 00067800
*                                                                     * 00067900
*01* REASON CODES:                                                    * 00068000
*                                                                     * 00068100
*01* MODULE TYPE:  ASSEM MACRO                                        * 00068200
*                                                                     * 00068300
*02*   PROCESSOR:  ASSEM                                              * 00068400
*                                                                     * 00068500
*01* COMPONENT:  SC1CJ                                                * 00068600
*                                                                     * 00068700
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00068800
*                                                                     * 00068900
*01* MACRO USAGE NOTES:                                               * 00069000
*                                                                     * 00069100
*                                                                     * 00069200
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00069300
*        global macro variable.  Any value other than 'NO' will       * 00069400
*        result in the macro expansion being printed.  The default is * 00069500
*        'YES'.  The following examples illustrate how the ZPRINT     * 00069600
*        variable should be set.                                      * 00069700
*                                                                     * 00069800
*                    GBLC &ZPRINT                                     * 00069900
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00070000
*                                                                     * 00070100
*                                                                     * 00070200
*    2.  When using the NOCHECK option in conjunction with the Modify * 00070300
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00070400
*        Modify   or  Execute  form  invocation  which  specifies  or * 00070500
*        defaults  to  the  COMPLETE  option.   This insures that the * 00070600
*        parameter  list  is  initialized completely.   The parameter * 00070700
*        list  field which identifies the version number of the macro * 00070800
*        is only set when the Standard form or the Complete option of * 00070900
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00071000
*        explicitly  specified.  Be sure that the resulting parameter * 00071100
*        list version number covers all the keys that you use.        * 00071200
*                                                                     * 00071300
*                                                                     * 00071400
*    3.  All keys currently contained in the CSVINFO macro correspond * 00071500
*        to  version 0.  If you specify PLISTVER, use a value of 0 or * 00071600
*        MAX.                                                         * 00071700
*                                                                     * 00071800
*                                                                     * 00071900
*                                                                     * 00072000
*                                                                     * 00072100
*01* CHANGE ACTIVITY:                                                 * 00072200
*                                                                     * 00072300
*   Flag LineItem  FMID    Date   ID    Comment                       * 00072400
*                                                                     * 00072500
*    $L0=POSIX    HBB4430 020592 PD34EP:  Initial version.            * 00072600
*    $L1=POSIX    HBB4430 031892 PD34EP:  Add MODI_MIPR_LIMIT return  * 00072700
*                                         code.                       * 00072800
*    $P1=POSIX    HBB4430 042992 PD34EP:  PKB2200.                    * 00072900
*    $P2=POSIX    HBB4430 061792 PD34EP:  PKB3388.                    * 00073000
*    $L2=POSIX    HBB4430 042992 PD34EP:  Macro no longer sets        * 00073100
*                                         ADPLASID.                   * 00073200
*    $D1=POSIX    HBB4430 061792 PD34EP:  DKB0129.                    * 00073300
*    $P3=POSIX    HBB4430 062592 PD34EP:  PKB3662.                    * 00073400
*    $P4=POSIX    HBB4430 072992 PD34EP:  PKB3865.                    * 00073500
*    $P5=POSIX    HBB4430 072992 PD34EP:  PKB3675.                    * 00073600
*    $01=POSIX    HBB4430 120392 PD34EP:  OY58986 (PKB4295).          * 00073700
*    $02=OW02434  HBB4430 052394 PD34DH:  Add MODI_RB_LOOP return     * 00073800
*                                         code.                       * 00073900
*    $L2=ME18182  HBB7780 121609 PD00XB:  No longer check for old     * 00074000
*                                         releases                    * 00074100
****** END OF SPECIFICATIONS *****************************************/ 00074200
*/********************************************************************* 00074300
         MACRO                                                          00074400
&XLABEL  CSVINFO &FUNC=,&TCBADDR=,&RBADDR=,&ENV=,&ABDPLPTR=,&ASID=,    *00074500
               &MIPR=,&USERDATA=,&RETCODE=,&RSNCODE=,&COM=,&PLISTVER=, *00074600
               &MF=                                                     00074700
.*                                                                      00074800
*              MACDATE -03/16/10-<0>                                    00074900
.*                                                                      00075000
.*******************************************************************    00075100
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00075200
.*******************************************************************    00075300
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   00075400
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     00075500
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             00075600
.*                                                                      00075700
              GBLC  &ZCSVINFO   YES=MACRO USED AT LEAST ONCE            00075800
.*******************************************************************    00075900
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00076000
.*******************************************************************    00076100
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 00076200
              LCLC  &ZCNDX      SYSNDX CHARACTERS                       00076300
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              00076400
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             00076500
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             00076600
              LCLA  &ZAWRK      USED AS A WORK AREA                     00076700
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  00076800
              LCLA  &ZN         NUMERIC WORK VARIABLE                   00076900
              LCLC  &ZC         CHARACTER WORK VARIABLE                 00077000
              LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE             00077100
              LCLA  &ZTLA       VALUE TOO LONG VARIABLE                 00077200
              LCLC  &ZMAC_G     "G" or null                             00077300
&ZMAC_G       SETC  ''                                                  00077400
              LCLC  &ZMAC_LR                                            00077500
&ZMAC_LR      SETC  'LR'                                                00077600
              LCLC  &ZMAC_L                                             00077700
&ZMAC_L       SETC  'L'                                                 00077800
              LCLC  &ZMAC_ST                                            00077900
&ZMAC_ST      SETC  'ST'                                                00078000
              LCLA  &ZMACRET    MACRO RETURN CODE                       00078100
&ZMACRET      SETA  0           ASSUME NO ERRORS                        00078200
.*                                                                      00078300
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      00078400
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              00078500
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   00078600
              LCLC  &ZENDBASEPL                 End of base PL          00078700
              LCLA  &ZPLWORKA   PARAMETER LIST LENGTH                   00078800
.*******************************************************************    00078900
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00079000
.*******************************************************************    00079100
              LCLA  &ZI         INDEX FOR ARRAY                         00079200
              LCLA  &ZJ         INDEX FOR PARMS                         00079300
              LCLA  &ZK         INDEX FOR PARSE                         00079400
              LCLA  &ZLO        LOW RANGE VALUE                         00079500
              LCLA  &ZHI        HIGH RANGE VALUE                        00079600
              LCLC  &ZW         WORK AREA FOR PARM                      00079700
.********************************************************************   00079800
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00079900
.********************************************************************   00080000
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 00080100
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          00080200
              GBLA  &SYSALVL    SYSSTATE ARCHLVL                        00080300
              GBLC  &SYSAM64    SYSSTATE AMODE64                        00080400
.*                                                                      00080500
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       00080600
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        00080700
              SPLEVEL  TEST                                             00080800
.ZSYS2        ANOP  ,                                                   00080900
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              00081000
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              00081100
              SYSSTATE TEST                                             00081200
              AGO   .ZSYS4                                              00081300
.ZSYS3        ANOP  ,                                                   00081400
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 00081500
.ZSYS4        ANOP  ,                                                   00081600
.*******************************************************************    00081700
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00081800
.*******************************************************************    00081900
              LCLC  &XFUNC      ++ VALUE                                00082000
              LCLC  &XTCBADDR   ++ NAME                                 00082100
              LCLC  &XRBADDR    ++ NAME                                 00082200
              LCLC  &XENV       ++ VALUE                                00082300
              LCLC  &XABDPLPTR  ++ NAME                                 00082400
              LCLC  &XASID      ++ NAME                                 00082500
              LCLC  &XMIPR      ++ NAME                                 00082600
              LCLC  &XUSERDATA  ++ NAME                                 00082700
              LCLC  &XRETCODE   ++ NAME                                 00082800
              LCLC  &XRSNCODE   ++ NAME                                 00082900
              LCLC  &XCOM       ++ VALUE                                00083000
              LCLA  &XPLISTVER  ++ VALUE                                00083100
              LCLC  &XMF        ++ VALUE                                00083200
              LCLC  &XMFCTRL    ++ NAME                                 00083300
              LCLC  &XMFATTR    ++ VALUE                                00083400
              LCLC  &XMFSCK     ++ VALUE                                00083500
.*******************************************************************    00083600
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00083700
.*******************************************************************    00083800
              LCLC  &ZXFUNC     ++ INPUT VALUE                          00083900
              LCLC  &ZXTCBADDR  ++ INPUT NAME                           00084000
              LCLC  &ZXRBADDR   ++ INPUT NAME                           00084100
              LCLC  &ZXENV      ++ INPUT VALUE                          00084200
              LCLC  &ZXABDPLPTR                 ++ INPUT NAME           00084300
              LCLC  &ZXASID     ++ INPUT NAME                           00084400
              LCLC  &ZXMIPR     ++ INPUT NAME                           00084500
              LCLC  &ZXUSERDATA                 ++ INPUT NAME           00084600
              LCLC  &ZXRETCODE  ++ OUTPUT NAME                          00084700
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          00084800
              LCLC  &ZXCOM      ++ INPUT VALUE                          00084900
              LCLC  &ZXPLISTVER                 ++ INPUT VALUE          00085000
              LCLC  &ZXMF       ++ INPUT VALUE                          00085100
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           00085200
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          00085300
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          00085400
.********************************************************************   00085500
.***AC.PLV01  PROCESS PLISTVER                                      *   00085600
.********************************************************************   00085700
&XPLISTVER      SETA  0                                                 00085800
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00085900
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00086000
&XPLISTVER      SETA  0                                                 00086100
.ZPLV0          ANOP  ,                                                 00086200
.*                                                                      00086300
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00086400
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00086500
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00086600
.*-------------------------------------------------------------------   00086700
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00086800
&ZMS            SETC  '"PLISTVER='                                      00086900
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00087000
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00087100
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00087200
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00087300
                AGO   .ZPVCK2                                           00087400
.ZPVCK3         ANOP  ,                                                 00087500
.*-------------------------------------------------------------------   00087600
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00087700
&ZMS            SETC  '"PLISTVER='                                      00087800
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00087900
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00088000
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00088100
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00088200
                AGO   .ZPVCKE                                           00088300
.ZPVCK2         ANOP  ,                                                 00088400
.*-------------------------------------------------------------------   00088500
&ZCVAL          SETC  '&PLISTVER(1)'                                    00088600
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00088700
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00088800
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00088900
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00089000
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00089100
.ZPVCK6         ANOP  ,                                                 00089200
&ZMS            SETC  '"PLISTVER='                                      00089300
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00089400
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00089500
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00089600
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00089700
&XPLISTVER      SETA  0                                                 00089800
                AGO   .ZPVCKE                                           00089900
.*-------------------------------------------------------------------   00090000
.ZPVCK4A        ANOP  ,                                                 00090100
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00090200
&ZMS            SETC  'PLISTVER='                                       00090300
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00090400
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00090500
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00090600
                MNOTE 8,' &ZMS IS REQUIRED.'                            00090700
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00090800
                AGO   .ZPVCK5                                           00090900
.ZPVCK4         ANOP  ,                                                 00091000
&XPLISTVER      SETA  &PLISTVER(1)                                      00091100
.ZPVCK5         ANOP  ,                                                 00091200
.ZPVCKE         ANOP  ,                                                 00091300
.********************************************************************   00091400
.***AG.MF01 PROCESS MF MACRO FORMS                                      00091500
.********************************************************************   00091600
              ACTR  10000                                               00091700
.*------------------------------------------------------------------    00091800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00091900
&XMF          SETC  ''          INITIALIZE XVARIABLE                    00092000
.*-------------------------------------------------------------------   00092100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00092200
.ZG52         ANOP  ,                                                   00092300
&ZTLC         SETC 'S'                                                  00092400
              AIF   ('&MF(1)' NE '&ZTLC').ZG53                          00092500
&XMF          SETC  'S'         SET KEYWORD                             00092600
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              00092700
              AIF   (N'&MF LE 1).ZG52A          CK NUM                  00092800
&ZMS          SETC  '"MF='                                              00092900
&ZMS          SETC  '&ZMS.&MF"'                                         00093000
&ZMS          SETC  '&ZMS "MF"'                                         00093100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00093200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00093300
.ZG52A        ANOP  ,                                                   00093400
.*-------------------------------------------------------------------   00093500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00093600
.ZG53         ANOP  ,                                                   00093700
&ZTLC         SETC 'L'                                                  00093800
              AIF   ('&MF(1)' NE '&ZTLC').ZG60                          00093900
&XMF          SETC  'L'         SET KEYWORD                             00094000
              AIF   (N'&MF LE 3).ZG53A          CK NUM                  00094100
&ZMS          SETC  '"MF='                                              00094200
&ZMS          SETC  '&ZMS.&MF"'                                         00094300
&ZMS          SETC  '&ZMS "MF"'                                         00094400
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00094500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00094600
.ZG53A        ANOP  ,                                                   00094700
.*-------------------------------------------------------------------   00094800
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00094900
              AIF   (N'&SYSLIST NE 0).ZG53B     POSITIONALS?            00095000
              AIF   ('&FUNC' NE '').ZG53B       KEYS?                   00095100
              AIF   ('&TCBADDR' NE '').ZG53B    KEYS?                   00095200
              AIF   ('&RBADDR' NE '').ZG53B     KEYS?                   00095300
              AIF   ('&ENV' NE '').ZG53B        KEYS?                   00095400
              AIF   ('&ABDPLPTR' NE '').ZG53B   KEYS?                   00095500
              AIF   ('&ASID' NE '').ZG53B       KEYS?                   00095600
              AIF   ('&MIPR' NE '').ZG53B       KEYS?                   00095700
              AIF   ('&USERDATA' NE '').ZG53B   KEYS?                   00095800
              AIF   ('&RETCODE' NE '').ZG53B    KEYS?                   00095900
              AIF   ('&RSNCODE' NE '').ZG53B    KEYS?                   00096000
              AIF   ('&COM' NE '').ZG53B        KEYS?                   00096100
              AGO    .ZG53C     INVOCATION OKAY                         00096200
.ZG53B        ANOP  ,                                                   00096300
&ZMS          SETC  'THE "L" FORM OF "MF"'                              00096400
&ZMS          SETC  '&ZMS CAN ONLY HAVE'                                00096500
&ZMS          SETC  '&ZMS THE "PLISTVER" KEY'                           00096600
              MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'              00096700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00096800
.ZG53C        ANOP  ,                                                   00096900
.*-------------------------------------------------------------------   00097000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00097100
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00097200
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00097300
              AIF   (N'&MF(2) GT 1).ZG55B       MULTI PARMS             00097400
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00097500
.ZG55B        AIF   (K'&MF(2) GT 0).ZG55C                               00097600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00097700
&ZMS          SETC  'WHEN "L" IS SPECIFIED'                             00097800
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00097900
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00098000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00098100
.ZG55C        ANOP  ,                                                   00098200
.*-------------------------------------------------------------------   00098300
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00098400
              AIF   (K'&ZXMFCTRL LE 0).ZG55P    NOT I/O                 00098500
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG55P                      00098600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00098700
&ZMS          SETC  '"MF='                                              00098800
&ZMS          SETC  '&ZMS.&MF"'                                         00098900
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00099000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   00099100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00099200
.ZG55P        ANOP  ,                                                   00099300
.*-------------------------------------------------------------------   00099400
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00099500
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           00099600
&XMFATTR      SETC  '0D'                                                00099700
              AIF   (K'&MF(3) LE 0).ZG58B       PARM                    00099800
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           00099900
              AIF   (N'&MF(3) GT 1).ZG58B       MULTI                   00100000
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           00100100
.ZG58B        ANOP  ,                                                   00100200
.*-------------------------------------------------------------------   00100300
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00100400
              AIF   (K'&ZXMFATTR LE 0).ZG58P    NOT I/O                 00100500
              AIF   ('&XMFATTR'(1,1) NE '(').ZG58P                      00100600
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00100700
&ZMS          SETC  '"MF='                                              00100800
&ZMS          SETC  '&ZMS.&MF"'                                         00100900
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00101000
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   00101100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00101200
.ZG58P        ANOP  ,                                                   00101300
.*-------------------------------------------------------------------   00101400
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00101500
              AIF   (K'&ZXMFATTR LE 0).ZG58S    NOT I/O                 00101600
              AIF   (K'&XMFATTR LE 60).ZG58S    LNG OK                  00101700
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         00101800
&ZMS          SETC  '"MF='                                              00101900
&ZMS          SETC  '&ZMS.&MF"'                                         00102000
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               00102100
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  00102200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00102300
.ZG58S        ANOP  ,                                                   00102400
.*-------------------------------------------------------------------   00102500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00102600
.ZG60         ANOP  ,                                                   00102700
&ZTLC         SETC 'M'                                                  00102800
              AIF   ('&MF(1)' NE '&ZTLC').ZG69                          00102900
&XMF          SETC  'M'         SET KEYWORD                             00103000
              AIF   (N'&MF LE 3).ZG60A          CK NUM                  00103100
&ZMS          SETC  '"MF='                                              00103200
&ZMS          SETC  '&ZMS.&MF"'                                         00103300
&ZMS          SETC  '&ZMS "MF"'                                         00103400
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00103500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00103600
.ZG60A        ANOP  ,                                                   00103700
.*-------------------------------------------------------------------   00103800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00103900
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00104000
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00104100
              AIF   (N'&MF(2) GT 1).ZG62B       MULTI PARMS             00104200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00104300
.ZG62B        AIF   (K'&MF(2) GT 0).ZG62C                               00104400
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00104500
&ZMS          SETC  'WHEN "M" IS SPECIFIED'                             00104600
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00104700
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00104800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00104900
.ZG62C        ANOP  ,                                                   00105000
.*-------------------------------------------------------------------   00105100
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00105200
              AIF   (K'&ZXMFCTRL LE 0).ZG62R    NOT I/O                 00105300
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG62R                      00105400
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00105500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG62P                        00105600
              AIF   (K'&ZCGPR GT 2).ZG62Q                               00105700
              AIF   ('&ZCGPR' EQ '0').ZG62Q                             00105800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00105900
              AIF   (T'&ZCGPR NE 'N').ZG62Q     INVALID REG NAME        00106000
.ZG62P        ANOP  ,                                                   00106100
              AIF   (T'&ZCGPR NE 'N').ZG62R     NON NUMERIC             00106200
              AIF   ('&ZCGPR' LT '1').ZG62Q                             00106300
              AIF   ('&ZCGPR' LE '12').ZG62R                            00106400
.ZG62Q        ANOP  ,                                                   00106500
&ZMS          SETC  '"MF='                                              00106600
&ZMS          SETC  '&ZMS.&MF"'                                         00106700
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00106800
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00106900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00107000
.ZG62R        ANOP  ,                                                   00107100
.*-------------------------------------------------------------------   00107200
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00107300
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00107400
.ZG66A   AIF   ('&MF(3)' NE 'COMPLETE').ZG67A                           00107500
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00107600
.*-------------------------------------------------------------------   00107700
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00107800
.ZG67A   AIF   ('&MF(3)' NE 'NOCHECK').ZG68A                            00107900
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00108000
.*-------------------------------------------------------------------   00108100
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00108200
.ZG68A        AIF   (K'&XMFSCK GT 0).ZG68C      KEYWORD                 00108300
              AIF   (K'&MF(3) LE 0).ZG68B                               00108400
&ZMS          SETC  '"MF='                                              00108500
&ZMS          SETC  '&ZMS.&MF"'                                         00108600
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00108700
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00108800
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00108900
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00109000
              MNOTE 8,' &ZMS '                                          00109100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00109200
.ZG68B        ANOP  ,                                                   00109300
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00109400
.ZG68C        ANOP  ,                                                   00109500
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00109600
.*-------------------------------------------------------------------   00109700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00109800
.ZG69         ANOP  ,                                                   00109900
&ZTLC         SETC 'E'                                                  00110000
              AIF   ('&MF(1)' NE '&ZTLC').ZG78                          00110100
&XMF          SETC  'E'         SET KEYWORD                             00110200
              AIF   (N'&MF LE 3).ZG69A          CK NUM                  00110300
&ZMS          SETC  '"MF='                                              00110400
&ZMS          SETC  '&ZMS.&MF"'                                         00110500
&ZMS          SETC  '&ZMS "MF"'                                         00110600
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                00110700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00110800
.ZG69A        ANOP  ,                                                   00110900
.*-------------------------------------------------------------------   00111000
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00111100
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           00111200
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           00111300
              AIF   (N'&MF(2) GT 1).ZG71B       MULTI PARMS             00111400
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           00111500
.ZG71B        AIF   (K'&MF(2) GT 0).ZG71C                               00111600
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         00111700
&ZMS          SETC  'WHEN "E" IS SPECIFIED'                             00111800
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 00111900
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        00112000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00112100
.ZG71C        ANOP  ,                                                   00112200
.*-------------------------------------------------------------------   00112300
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00112400
              AIF   (K'&ZXMFCTRL LE 0).ZG71R    NOT I/O                 00112500
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG71R                      00112600
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          00112700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG71P                        00112800
              AIF   (K'&ZCGPR GT 2).ZG71Q                               00112900
              AIF   ('&ZCGPR' EQ '0').ZG71Q                             00113000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00113100
              AIF   (T'&ZCGPR NE 'N').ZG71Q     INVALID REG NAME        00113200
.ZG71P        ANOP  ,                                                   00113300
              AIF   (T'&ZCGPR NE 'N').ZG71R     NON NUMERIC             00113400
              AIF   ('&ZCGPR' LT '1').ZG71Q                             00113500
              AIF   ('&ZCGPR' LE '12').ZG71R                            00113600
.ZG71Q        ANOP  ,                                                   00113700
&ZMS          SETC  '"MF='                                              00113800
&ZMS          SETC  '&ZMS.&MF"'                                         00113900
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           00114000
              MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'                    00114100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00114200
.ZG71R        ANOP  ,                                                   00114300
.*-------------------------------------------------------------------   00114400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00114500
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    00114600
.ZG75A   AIF   ('&MF(3)' NE 'COMPLETE').ZG76A                           00114700
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             00114800
.*-------------------------------------------------------------------   00114900
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00115000
.ZG76A   AIF   ('&MF(3)' NE 'NOCHECK').ZG77A                            00115100
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             00115200
.*-------------------------------------------------------------------   00115300
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00115400
.ZG77A        AIF   (K'&XMFSCK GT 0).ZG77C      KEYWORD                 00115500
              AIF   (K'&MF(3) LE 0).ZG77B                               00115600
&ZMS          SETC  '"MF='                                              00115700
&ZMS          SETC  '&ZMS.&MF"'                                         00115800
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           00115900
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00116000
&ZMS          SETC  '&ZMS "COMPLETE"'                                   00116100
&ZMS          SETC  '&ZMS OR "NOCHECK".'                                00116200
              MNOTE 8,' &ZMS '                                          00116300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00116400
.ZG77B        ANOP  ,                                                   00116500
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     00116600
.ZG77C        ANOP  ,                                                   00116700
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           00116800
.*------------------------------------------------------------------    00116900
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00117000
.ZG78         ANOP  ,                                                   00117100
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           00117200
              AIF   (K'&XMF GT 0).ZG78E         VALID ARG               00117300
              AIF   (T'&MF EQ 'O').ZG78D        OMITTED                 00117400
&ZASYSLNDX    SETA  0                                                   00117500
.ZG78A        ANOP  ,           POSITIONAL MACRO KEY                    00117600
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00117700
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG78C                    00117800
&ZTLC         SETC 'MF'                                                 00117900
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG78A           00118000
.ZG78B        ANOP  ,                                                   00118100
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00118200
&ZMS          SETC  'THE "MF" KEY'                                      00118300
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00118400
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00118500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00118600
              AGO   .ZG78E                                              00118700
.ZG78C        ANOP  ,                                                   00118800
&ZXMF         SETC  ''          RESET IN/OUTPUT                         00118900
&ZMS          SETC  '"MF='                                              00119000
&ZMS          SETC  '&ZMS.&MF"'                                         00119100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00119200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00119300
&ZMS          SETC  '&ZMS "S",'                                         00119400
&ZMS          SETC  '&ZMS "L",'                                         00119500
&ZMS          SETC  '&ZMS "M",'                                         00119600
&ZMS          SETC  '&ZMS OR "E".'                                      00119700
              MNOTE 8,' &ZMS '                                          00119800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00119900
              AGO   .ZG78E                                              00120000
.ZG78D        ANOP  ,                                                   00120100
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     00120200
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       00120300
.ZG78E        ANOP  ,                                                   00120400
.********************************************************************   00120500
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00120600
.********************************************************************   00120700
              ACTR  10000                                               00120800
.*-------------------------------------------------------------------   00120900
.***AG.MF03 MF=(SLME)                                                   00121000
              AIF   ('&XMF' EQ 'L').ZGMFX                               00121100
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     00121200
.*------------------------------------------------------------------    00121300
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121400
&XFUNC        SETC  ''          INITIALIZE XVARIABLE                    00121500
.*-------------------------------------------------------------------   00121600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121700
.ZG3          ANOP  ,                                                   00121800
              AIF   (K'&FUNC(1) LE 0).ZG3A                              00121900
&ZTLC         SETC 'LPA'                                                00122000
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG4                         00122100
&XFUNC        SETC  'LPA'       SET KEYWORD                             00122200
              AIF   (N'&FUNC LE 1).ZG3A         CK NUM                  00122300
&ZMS          SETC  '"FUNC='                                            00122400
&ZMS          SETC  '&ZMS.&FUNC"'                                       00122500
&ZMS          SETC  '&ZMS "FUNC"'                                       00122600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00122700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00122800
.ZG3A         ANOP  ,                                                   00122900
.*------------------------------------------------------------------    00123000
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00123100
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00123200
.ZG3A0        AIF   (K'&TCBADDR LE 0).ZG3A1     OK                      00123300
&ZCVAL        SETC '&ZCVAL TCBADDR'             INCORRECT KEY USED      00123400
.ZG3A1        AIF   (K'&RBADDR LE 0).ZG3A2      OK                      00123500
&ZCVAL        SETC '&ZCVAL RBADDR'              INCORRECT KEY USED      00123600
.ZG3A2        AIF   (K'&ZCVAL LE 0).ZG3A3       OK                      00123700
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00123800
&ZMS          SETC  '"FUNC'                                             00123900
&ZMS          SETC  '&ZMS.=&FUNC"'                                      00124000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00124100
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00124200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00124300
.ZG3A3        ANOP  ,                                                   00124400
.*-------------------------------------------------------------------   00124500
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00124600
.ZG4          ANOP  ,                                                   00124700
&ZTLC         SETC 'JPA'                                                00124800
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG8                         00124900
&XFUNC        SETC  'JPA'       SET KEYWORD                             00125000
              AIF   (N'&FUNC LE 1).ZG4A         CK NUM                  00125100
&ZMS          SETC  '"FUNC='                                            00125200
&ZMS          SETC  '&ZMS.&FUNC"'                                       00125300
&ZMS          SETC  '&ZMS "FUNC"'                                       00125400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00125500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00125600
.ZG4A         ANOP  ,                                                   00125700
.*------------------------------------------------------------------    00125800
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00125900
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00126000
.ZG4A0        AIF   (K'&RBADDR LE 0).ZG4A1      OK                      00126100
&ZCVAL        SETC '&ZCVAL RBADDR'              INCORRECT KEY USED      00126200
.ZG4A1        AIF   (K'&ZCVAL LE 0).ZG4A2       OK                      00126300
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00126400
&ZMS          SETC  '"FUNC'                                             00126500
&ZMS          SETC  '&ZMS.=&FUNC"'                                      00126600
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00126700
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00126800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00126900
.ZG4A2        ANOP  ,                                                   00127000
.*----------------------------------------------------------------***   00127100
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00127200
              AIF   (N'&TCBADDR LE 1).ZG6A      CK NUM                  00127300
&ZMS          SETC  '"TCBADDR='                                         00127400
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00127500
&ZMS          SETC  '&ZMS "TCBADDR"'                                    00127600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00127700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00127800
.ZG6A         ANOP  ,                                                   00127900
.*-------------------------------------------------------------------   00128000
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00128100
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           00128200
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           00128300
              AIF   (N'&TCBADDR GT 1).ZG6B      MULTI PARMS             00128400
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           00128500
.ZG6B         AIF   (K'&TCBADDR(1) GT 0).ZG6C                           00128600
&ZXTCBADDR    SETC  ''          RESET IN/OUTPUT                         00128700
&ZMS          SETC  ' '                                                 00128800
&ZMS          SETC  '&ZMS "TCBADDR" KEY AND ITS'                        00128900
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00129000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00129100
.ZG6C         ANOP  ,                                                   00129200
.*-------------------------------------------------------------------   00129300
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00129400
              AIF   (K'&ZXTCBADDR LE 0).ZG6R    NOT I/O                 00129500
              AIF   ('&XTCBADDR'(1,1) NE '(').ZG6R                      00129600
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        00129700
              AIF   ('&ZCGPR'(1,1) NE '0').ZG6P                         00129800
              AIF   (K'&ZCGPR GT 2).ZG6Q                                00129900
              AIF   ('&ZCGPR' EQ '0').ZG6Q                              00130000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00130100
              AIF   (T'&ZCGPR NE 'N').ZG6Q      INVALID REG NAME        00130200
.ZG6P         ANOP  ,                                                   00130300
              AIF   (T'&ZCGPR NE 'N').ZG6R      NON NUMERIC             00130400
              AIF   ('&ZCGPR' LT '2').ZG6Q                              00130500
              AIF   ('&ZCGPR' LE '12').ZG6R                             00130600
.ZG6Q         ANOP  ,                                                   00130700
&ZMS          SETC  '"TCBADDR='                                         00130800
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00130900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00131000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00131100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00131200
.ZG6R         ANOP  ,                                                   00131300
.*-------------------------------------------------------------------   00131400
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00131500
.ZG8          ANOP  ,                                                   00131600
&ZTLC         SETC 'TASKLOAD'                                           00131700
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG12                        00131800
&XFUNC        SETC  'TASKLOAD'  SET KEYWORD                             00131900
              AIF   (N'&FUNC LE 1).ZG8A         CK NUM                  00132000
&ZMS          SETC  '"FUNC='                                            00132100
&ZMS          SETC  '&ZMS.&FUNC"'                                       00132200
&ZMS          SETC  '&ZMS "FUNC"'                                       00132300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00132400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00132500
.ZG8A         ANOP  ,                                                   00132600
.*------------------------------------------------------------------    00132700
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00132800
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00132900
.ZG8A0        AIF   (K'&RBADDR LE 0).ZG8A1      OK                      00133000
&ZCVAL        SETC '&ZCVAL RBADDR'              INCORRECT KEY USED      00133100
.ZG8A1        AIF   (K'&ZCVAL LE 0).ZG8A2       OK                      00133200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00133300
&ZMS          SETC  '"FUNC'                                             00133400
&ZMS          SETC  '&ZMS.=&FUNC"'                                      00133500
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00133600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00133700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00133800
.ZG8A2        ANOP  ,                                                   00133900
.*----------------------------------------------------------------***   00134000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00134100
              AIF   (N'&TCBADDR LE 1).ZG10A     CK NUM                  00134200
&ZMS          SETC  '"TCBADDR='                                         00134300
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00134400
&ZMS          SETC  '&ZMS "TCBADDR"'                                    00134500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00134600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00134700
.ZG10A        ANOP  ,                                                   00134800
.*-------------------------------------------------------------------   00134900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00135000
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           00135100
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           00135200
              AIF   (N'&TCBADDR GT 1).ZG10B     MULTI PARMS             00135300
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           00135400
.ZG10B        AIF   (K'&TCBADDR(1) GT 0).ZG10C                          00135500
&ZXTCBADDR    SETC  ''          RESET IN/OUTPUT                         00135600
&ZMS          SETC  ' '                                                 00135700
&ZMS          SETC  '&ZMS "TCBADDR" KEY AND ITS'                        00135800
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00135900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00136000
.ZG10C        ANOP  ,                                                   00136100
.*-------------------------------------------------------------------   00136200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00136300
              AIF   (K'&ZXTCBADDR LE 0).ZG10R   NOT I/O                 00136400
              AIF   ('&XTCBADDR'(1,1) NE '(').ZG10R                     00136500
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        00136600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        00136700
              AIF   (K'&ZCGPR GT 2).ZG10Q                               00136800
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             00136900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00137000
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        00137100
.ZG10P        ANOP  ,                                                   00137200
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             00137300
              AIF   ('&ZCGPR' LT '2').ZG10Q                             00137400
              AIF   ('&ZCGPR' LE '12').ZG10R                            00137500
.ZG10Q        ANOP  ,                                                   00137600
&ZMS          SETC  '"TCBADDR='                                         00137700
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00137800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00137900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00138000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00138100
.ZG10R        ANOP  ,                                                   00138200
.*-------------------------------------------------------------------   00138300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138400
.ZG12         ANOP  ,                                                   00138500
&ZTLC         SETC 'TASKALL'                                            00138600
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG16                        00138700
&XFUNC        SETC  'TASKALL'   SET KEYWORD                             00138800
              AIF   (N'&FUNC LE 1).ZG12A        CK NUM                  00138900
&ZMS          SETC  '"FUNC='                                            00139000
&ZMS          SETC  '&ZMS.&FUNC"'                                       00139100
&ZMS          SETC  '&ZMS "FUNC"'                                       00139200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00139300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00139400
.ZG12A        ANOP  ,                                                   00139500
.*------------------------------------------------------------------    00139600
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00139700
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00139800
.ZG12A0       AIF   (K'&RBADDR LE 0).ZG12A1     OK                      00139900
&ZCVAL        SETC '&ZCVAL RBADDR'              INCORRECT KEY USED      00140000
.ZG12A1       AIF   (K'&ZCVAL LE 0).ZG12A2      OK                      00140100
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00140200
&ZMS          SETC  '"FUNC'                                             00140300
&ZMS          SETC  '&ZMS.=&FUNC"'                                      00140400
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00140500
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00140600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00140700
.ZG12A2       ANOP  ,                                                   00140800
.*----------------------------------------------------------------***   00140900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00141000
              AIF   (N'&TCBADDR LE 1).ZG14A     CK NUM                  00141100
&ZMS          SETC  '"TCBADDR='                                         00141200
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00141300
&ZMS          SETC  '&ZMS "TCBADDR"'                                    00141400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00141500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00141600
.ZG14A        ANOP  ,                                                   00141700
.*-------------------------------------------------------------------   00141800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00141900
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           00142000
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           00142100
              AIF   (N'&TCBADDR GT 1).ZG14B     MULTI PARMS             00142200
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           00142300
.ZG14B        AIF   (K'&TCBADDR(1) GT 0).ZG14C                          00142400
&ZXTCBADDR    SETC  ''          RESET IN/OUTPUT                         00142500
&ZMS          SETC  ' '                                                 00142600
&ZMS          SETC  '&ZMS "TCBADDR" KEY AND ITS'                        00142700
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00142800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00142900
.ZG14C        ANOP  ,                                                   00143000
.*-------------------------------------------------------------------   00143100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00143200
              AIF   (K'&ZXTCBADDR LE 0).ZG14R   NOT I/O                 00143300
              AIF   ('&XTCBADDR'(1,1) NE '(').ZG14R                     00143400
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        00143500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG14P                        00143600
              AIF   (K'&ZCGPR GT 2).ZG14Q                               00143700
              AIF   ('&ZCGPR' EQ '0').ZG14Q                             00143800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00143900
              AIF   (T'&ZCGPR NE 'N').ZG14Q     INVALID REG NAME        00144000
.ZG14P        ANOP  ,                                                   00144100
              AIF   (T'&ZCGPR NE 'N').ZG14R     NON NUMERIC             00144200
              AIF   ('&ZCGPR' LT '2').ZG14Q                             00144300
              AIF   ('&ZCGPR' LE '12').ZG14R                            00144400
.ZG14Q        ANOP  ,                                                   00144500
&ZMS          SETC  '"TCBADDR='                                         00144600
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00144700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00144800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00144900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00145000
.ZG14R        ANOP  ,                                                   00145100
.*-------------------------------------------------------------------   00145200
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00145300
.ZG16         ANOP  ,                                                   00145400
&ZTLC         SETC 'RB'                                                 00145500
              AIF   ('&FUNC(1)' NE '&ZTLC').ZG20                        00145600
&XFUNC        SETC  'RB'        SET KEYWORD                             00145700
              AIF   (N'&FUNC LE 1).ZG16A        CK NUM                  00145800
&ZMS          SETC  '"FUNC='                                            00145900
&ZMS          SETC  '&ZMS.&FUNC"'                                       00146000
&ZMS          SETC  '&ZMS "FUNC"'                                       00146100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00146200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00146300
.ZG16A        ANOP  ,                                                   00146400
.*------------------------------------------------------------------    00146500
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00146600
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00146700
.ZG16A0       AIF   (K'&TCBADDR LE 0).ZG16A1    OK                      00146800
&ZCVAL        SETC '&ZCVAL TCBADDR'             INCORRECT KEY USED      00146900
.ZG16A1       AIF   (K'&ZCVAL LE 0).ZG16A2      OK                      00147000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00147100
&ZMS          SETC  '"FUNC'                                             00147200
&ZMS          SETC  '&ZMS.=&FUNC"'                                      00147300
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00147400
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00147500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00147600
.ZG16A2       ANOP  ,                                                   00147700
.*----------------------------------------------------------------***   00147800
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00147900
              AIF   (N'&RBADDR LE 1).ZG18A      CK NUM                  00148000
&ZMS          SETC  '"RBADDR='                                          00148100
&ZMS          SETC  '&ZMS.&RBADDR"'                                     00148200
&ZMS          SETC  '&ZMS "RBADDR"'                                     00148300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00148400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00148500
.ZG18A        ANOP  ,                                                   00148600
.*-------------------------------------------------------------------   00148700
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00148800
&ZXRBADDR     SETC  'INPUT'     SET IN/OUTPUT                           00148900
&XRBADDR      SETC  '&RBADDR(1)'                SET XVARIABLE           00149000
              AIF   (N'&RBADDR GT 1).ZG18B      MULTI PARMS             00149100
&XRBADDR      SETC  '&RBADDR'   SET XVARIABLE                           00149200
.ZG18B        AIF   (K'&RBADDR(1) GT 0).ZG18C                           00149300
&ZXRBADDR     SETC  ''          RESET IN/OUTPUT                         00149400
&ZMS          SETC  ' '                                                 00149500
&ZMS          SETC  '&ZMS "RBADDR" KEY AND ITS'                         00149600
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00149700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00149800
.ZG18C        ANOP  ,                                                   00149900
.*-------------------------------------------------------------------   00150000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00150100
              AIF   (K'&ZXRBADDR LE 0).ZG18R    NOT I/O                 00150200
              AIF   ('&XRBADDR'(1,1) NE '(').ZG18R                      00150300
&ZCGPR        SETC  '&XRBADDR'(2,K'&XRBADDR-2)                          00150400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                        00150500
              AIF   (K'&ZCGPR GT 2).ZG18Q                               00150600
              AIF   ('&ZCGPR' EQ '0').ZG18Q                             00150700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00150800
              AIF   (T'&ZCGPR NE 'N').ZG18Q     INVALID REG NAME        00150900
.ZG18P        ANOP  ,                                                   00151000
              AIF   (T'&ZCGPR NE 'N').ZG18R     NON NUMERIC             00151100
              AIF   ('&ZCGPR' LT '2').ZG18Q                             00151200
              AIF   ('&ZCGPR' LE '12').ZG18R                            00151300
.ZG18Q        ANOP  ,                                                   00151400
&ZMS          SETC  '"RBADDR='                                          00151500
&ZMS          SETC  '&ZMS.&RBADDR"'                                     00151600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00151700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00151800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00151900
.ZG18R        ANOP  ,                                                   00152000
.*------------------------------------------------------------------    00152100
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152200
.ZG20         ANOP  ,                                                   00152300
&ZXFUNC       SETC  'INPUT'     SET IN/OUTPUT                           00152400
              AIF   (K'&XFUNC GT 0).ZG20E       VALID ARG               00152500
              AIF   (T'&FUNC EQ 'O').ZG20D      OMITTED                 00152600
&ZASYSLNDX    SETA  0                                                   00152700
.ZG20A        ANOP  ,           POSITIONAL MACRO KEY                    00152800
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00152900
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG20C                    00153000
&ZTLC         SETC 'FUNC'                                               00153100
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG20A           00153200
.ZG20B        ANOP  ,                                                   00153300
&ZXFUNC       SETC  ''          RESET IN/OUTPUT                         00153400
&ZMS          SETC  'THE "FUNC" KEY'                                    00153500
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00153600
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00153700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00153800
              AGO   .ZG20E                                              00153900
.ZG20C        ANOP  ,                                                   00154000
&ZXFUNC       SETC  ''          RESET IN/OUTPUT                         00154100
&ZMS          SETC  '"FUNC='                                            00154200
&ZMS          SETC  '&ZMS.&FUNC"'                                       00154300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00154400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00154500
&ZMS          SETC  '&ZMS "LPA",'                                       00154600
&ZMS          SETC  '&ZMS "JPA",'                                       00154700
&ZMS          SETC  '&ZMS "TASKLOAD",'                                  00154800
&ZMS          SETC  '&ZMS "TASKALL",'                                   00154900
&ZMS          SETC  '&ZMS OR "RB".'                                     00155000
              MNOTE 8,' &ZMS '                                          00155100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00155200
              AGO   .ZG20E                                              00155300
.ZG20D        ANOP  ,                                                   00155400
&XFUNC        SETC  'LPA'       SET DEFAULT KEYWORD                     00155500
.ZG20E        ANOP  ,                                                   00155600
.*------------------------------------------------------------------    00155700
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00155800
              AIF   (K'&FUNC(1) GT 0).ZG20F     PARM                    00155900
&XFUNC        SETC  ''          ENSURE NULL KEYWORD                     00156000
&ZXFUNC       SETC  ''          RESET IN/OUTPUT                         00156100
&ZMS          SETC  'THE'                                               00156200
&ZMS          SETC  '&ZMS "FUNC" KEY AND ITS'                           00156300
&ZMS          SETC  '&ZMS ARGUMENT ARE REQUIRED.'                       00156400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00156500
&ZMS          SETC  '&ZMS "LPA",'                                       00156600
&ZMS          SETC  '&ZMS "JPA",'                                       00156700
&ZMS          SETC  '&ZMS "TASKLOAD",'                                  00156800
&ZMS          SETC  '&ZMS "TASKALL",'                                   00156900
&ZMS          SETC  '&ZMS OR "RB".'                                     00157000
              MNOTE 8,' &ZMS '                                          00157100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00157200
.ZG20F        ANOP  ,                                                   00157300
.*------------------------------------------------------------------    00157400
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157500
&XENV         SETC  ''          INITIALIZE XVARIABLE                    00157600
.*-------------------------------------------------------------------   00157700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157800
.ZG23         ANOP  ,                                                   00157900
              AIF   (K'&ENV(1) LE 0).ZG23A                              00158000
&ZTLC         SETC 'MVS'                                                00158100
              AIF   ('&ENV(1)' NE '&ZTLC').ZG24                         00158200
&XENV         SETC  'MVS'       SET KEYWORD                             00158300
              AIF   (N'&ENV LE 1).ZG23A         CK NUM                  00158400
&ZMS          SETC  '"ENV='                                             00158500
&ZMS          SETC  '&ZMS.&ENV"'                                        00158600
&ZMS          SETC  '&ZMS "ENV"'                                        00158700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00158800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00158900
.ZG23A        ANOP  ,                                                   00159000
.*------------------------------------------------------------------    00159100
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00159200
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             00159300
.ZG23A0       AIF   (K'&ABDPLPTR LE 0).ZG23A1   OK                      00159400
&ZCVAL        SETC '&ZCVAL ABDPLPTR'            INCORRECT KEY USED      00159500
.ZG23A1       AIF   (K'&ASID LE 0).ZG23A2       OK                      00159600
&ZCVAL        SETC '&ZCVAL ASID'                INCORRECT KEY USED      00159700
.ZG23A2       AIF   (K'&ZCVAL LE 0).ZG23A3      OK                      00159800
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               00159900
&ZMS          SETC  '"ENV'                                              00160000
&ZMS          SETC  '&ZMS.=&ENV"'                                       00160100
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                00160200
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                00160300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00160400
.ZG23A3       ANOP  ,                                                   00160500
.*-------------------------------------------------------------------   00160600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160700
.ZG24         ANOP  ,                                                   00160800
&ZTLC         SETC 'IPCS'                                               00160900
              AIF   ('&ENV(1)' NE '&ZTLC').ZG31                         00161000
&XENV         SETC  'IPCS'      SET KEYWORD                             00161100
              AIF   (N'&ENV LE 1).ZG24A         CK NUM                  00161200
&ZMS          SETC  '"ENV='                                             00161300
&ZMS          SETC  '&ZMS.&ENV"'                                        00161400
&ZMS          SETC  '&ZMS "ENV"'                                        00161500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00161600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00161700
.ZG24A        ANOP  ,                                                   00161800
.*----------------------------------------------------------------***   00161900
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00162000
              AIF   (N'&ABDPLPTR LE 1).ZG26A    CK NUM                  00162100
&ZMS          SETC  '"ABDPLPTR='                                        00162200
&ZMS          SETC  '&ZMS.&ABDPLPTR"'                                   00162300
&ZMS          SETC  '&ZMS "ABDPLPTR"'                                   00162400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00162500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00162600
.ZG26A        ANOP  ,                                                   00162700
.*-------------------------------------------------------------------   00162800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00162900
&ZXABDPLPTR   SETC  'INPUT'     SET IN/OUTPUT                           00163000
&XABDPLPTR    SETC  '&ABDPLPTR(1)'              SET XVARIABLE           00163100
              AIF   (N'&ABDPLPTR GT 1).ZG26B    MULTI PARMS             00163200
&XABDPLPTR    SETC  '&ABDPLPTR'                 SET XVARIABLE           00163300
.ZG26B        AIF   (K'&ABDPLPTR(1) GT 0).ZG26C                         00163400
&ZXABDPLPTR   SETC  ''          RESET IN/OUTPUT                         00163500
&ZMS          SETC  ' '                                                 00163600
&ZMS          SETC  '&ZMS "ABDPLPTR" KEY AND ITS'                       00163700
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00163800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00163900
.ZG26C        ANOP  ,                                                   00164000
.*-------------------------------------------------------------------   00164100
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00164200
              AIF   (K'&ZXABDPLPTR LE 0).ZG26R  NOT I/O                 00164300
              AIF   ('&XABDPLPTR'(1,1) NE '(').ZG26R                    00164400
&ZCGPR        SETC  '&XABDPLPTR'(2,K'&XABDPLPTR-2)                      00164500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG26P                        00164600
              AIF   (K'&ZCGPR GT 2).ZG26Q                               00164700
              AIF   ('&ZCGPR' EQ '0').ZG26Q                             00164800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00164900
              AIF   (T'&ZCGPR NE 'N').ZG26Q     INVALID REG NAME        00165000
.ZG26P        ANOP  ,                                                   00165100
              AIF   (T'&ZCGPR NE 'N').ZG26R     NON NUMERIC             00165200
              AIF   ('&ZCGPR' LT '2').ZG26Q                             00165300
              AIF   ('&ZCGPR' LE '12').ZG26R                            00165400
.ZG26Q        ANOP  ,                                                   00165500
&ZMS          SETC  '"ABDPLPTR='                                        00165600
&ZMS          SETC  '&ZMS.&ABDPLPTR"'                                   00165700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00165800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00165900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00166000
.ZG26R        ANOP  ,                                                   00166100
.*----------------------------------------------------------------***   00166200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00166300
              AIF   (N'&ASID LE 1).ZG29A        CK NUM                  00166400
&ZMS          SETC  '"ASID='                                            00166500
&ZMS          SETC  '&ZMS.&ASID"'                                       00166600
&ZMS          SETC  '&ZMS "ASID"'                                       00166700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00166800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00166900
.ZG29A        ANOP  ,                                                   00167000
.*-------------------------------------------------------------------   00167100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00167200
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           00167300
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           00167400
              AIF   (N'&ASID GT 1).ZG29B        MULTI PARMS             00167500
&XASID        SETC  '&ASID'     SET XVARIABLE                           00167600
.ZG29B        AIF   (K'&ASID(1) GT 0).ZG29C                             00167700
&ZXASID       SETC  ''          RESET IN/OUTPUT                         00167800
&ZMS          SETC  ' '                                                 00167900
&ZMS          SETC  '&ZMS "ASID" KEY AND ITS'                           00168000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00168100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00168200
.ZG29C        ANOP  ,                                                   00168300
.*-------------------------------------------------------------------   00168400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00168500
              AIF   (K'&ZXASID LE 0).ZG29R      NOT I/O                 00168600
              AIF   ('&XASID'(1,1) NE '(').ZG29R                        00168700
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              00168800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG29P                        00168900
              AIF   (K'&ZCGPR GT 2).ZG29Q                               00169000
              AIF   ('&ZCGPR' EQ '0').ZG29Q                             00169100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00169200
              AIF   (T'&ZCGPR NE 'N').ZG29Q     INVALID REG NAME        00169300
.ZG29P        ANOP  ,                                                   00169400
              AIF   (T'&ZCGPR NE 'N').ZG29R     NON NUMERIC             00169500
              AIF   ('&ZCGPR' LT '2').ZG29Q                             00169600
              AIF   ('&ZCGPR' LE '12').ZG29R                            00169700
.ZG29Q        ANOP  ,                                                   00169800
&ZMS          SETC  '"ASID='                                            00169900
&ZMS          SETC  '&ZMS.&ASID"'                                       00170000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00170100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00170200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00170300
.ZG29R        ANOP  ,                                                   00170400
.*------------------------------------------------------------------    00170500
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00170600
.ZG31         ANOP  ,                                                   00170700
&ZXENV        SETC  'INPUT'     SET IN/OUTPUT                           00170800
              AIF   (K'&XENV GT 0).ZG31E        VALID ARG               00170900
              AIF   (T'&ENV EQ 'O').ZG31D       OMITTED                 00171000
&ZASYSLNDX    SETA  0                                                   00171100
.ZG31A        ANOP  ,           POSITIONAL MACRO KEY                    00171200
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        00171300
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG31C                    00171400
&ZTLC         SETC 'ENV'                                                00171500
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG31A           00171600
.ZG31B        ANOP  ,                                                   00171700
&ZXENV        SETC  ''          RESET IN/OUTPUT                         00171800
&ZMS          SETC  'THE "ENV" KEY'                                     00171900
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             00172000
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    00172100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00172200
              AGO   .ZG31E                                              00172300
.ZG31C        ANOP  ,                                                   00172400
&ZXENV        SETC  ''          RESET IN/OUTPUT                         00172500
&ZMS          SETC  '"ENV='                                             00172600
&ZMS          SETC  '&ZMS.&ENV"'                                        00172700
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00172800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00172900
&ZMS          SETC  '&ZMS "MVS"'                                        00173000
&ZMS          SETC  '&ZMS OR "IPCS".'                                   00173100
              MNOTE 8,' &ZMS '                                          00173200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00173300
              AGO   .ZG31E                                              00173400
.ZG31D        ANOP  ,                                                   00173500
&XENV         SETC  'MVS'       SET DEFAULT KEYWORD                     00173600
.ZG31E        ANOP  ,                                                   00173700
.*------------------------------------------------------------------    00173800
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00173900
              AIF   (K'&ENV(1) GT 0).ZG31F      PARM                    00174000
&XENV         SETC  ''          ENSURE NULL KEYWORD                     00174100
&ZXENV        SETC  ''          RESET IN/OUTPUT                         00174200
&ZMS          SETC  'THE'                                               00174300
&ZMS          SETC  '&ZMS "ENV" KEY AND ITS'                            00174400
&ZMS          SETC  '&ZMS ARGUMENT ARE REQUIRED.'                       00174500
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00174600
&ZMS          SETC  '&ZMS "MVS"'                                        00174700
&ZMS          SETC  '&ZMS OR "IPCS".'                                   00174800
              MNOTE 8,' &ZMS '                                          00174900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175000
.ZG31F        ANOP  ,                                                   00175100
.*----------------------------------------------------------------***   00175200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00175300
              AIF   (N'&MIPR LE 1).ZG33A        CK NUM                  00175400
&ZMS          SETC  '"MIPR='                                            00175500
&ZMS          SETC  '&ZMS.&MIPR"'                                       00175600
&ZMS          SETC  '&ZMS "MIPR"'                                       00175700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00175800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00175900
.ZG33A        ANOP  ,                                                   00176000
.*-------------------------------------------------------------------   00176100
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00176200
&ZXMIPR       SETC  'INPUT'     SET IN/OUTPUT                           00176300
&XMIPR        SETC  '&MIPR(1)'  SET XVARIABLE                           00176400
              AIF   (N'&MIPR GT 1).ZG33B        MULTI PARMS             00176500
&XMIPR        SETC  '&MIPR'     SET XVARIABLE                           00176600
.ZG33B        AIF   (K'&MIPR(1) GT 0).ZG33C                             00176700
&ZXMIPR       SETC  ''          RESET IN/OUTPUT                         00176800
&ZMS          SETC  ' '                                                 00176900
&ZMS          SETC  '&ZMS "MIPR" KEY AND ITS'                           00177000
              MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'                    00177100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00177200
.ZG33C        ANOP  ,                                                   00177300
.*-------------------------------------------------------------------   00177400
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00177500
              AIF   (K'&ZXMIPR LE 0).ZG33R      NOT I/O                 00177600
              AIF   ('&XMIPR'(1,1) NE '(').ZG33R                        00177700
&ZCGPR        SETC  '&XMIPR'(2,K'&XMIPR-2)                              00177800
              AIF   ('&ZCGPR'(1,1) NE '0').ZG33P                        00177900
              AIF   (K'&ZCGPR GT 2).ZG33Q                               00178000
              AIF   ('&ZCGPR' EQ '0').ZG33Q                             00178100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00178200
              AIF   (T'&ZCGPR NE 'N').ZG33Q     INVALID REG NAME        00178300
.ZG33P        ANOP  ,                                                   00178400
              AIF   (T'&ZCGPR NE 'N').ZG33R     NON NUMERIC             00178500
              AIF   ('&ZCGPR' LT '2').ZG33Q                             00178600
              AIF   ('&ZCGPR' LE '12').ZG33R                            00178700
.ZG33Q        ANOP  ,                                                   00178800
&ZMS          SETC  '"MIPR='                                            00178900
&ZMS          SETC  '&ZMS.&MIPR"'                                       00179000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00179100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00179200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00179300
.ZG33R        ANOP  ,                                                   00179400
.*----------------------------------------------------------------***   00179500
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00179600
              AIF   (N'&USERDATA LE 1).ZG36A    CK NUM                  00179700
&ZMS          SETC  '"USERDATA='                                        00179800
&ZMS          SETC  '&ZMS.&USERDATA"'                                   00179900
&ZMS          SETC  '&ZMS "USERDATA"'                                   00180000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00180100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00180200
.ZG36A        ANOP  ,                                                   00180300
.*-------------------------------------------------------------------   00180400
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         00180500
&ZXUSERDATA   SETC  'INPUT'     SET IN/OUTPUT                           00180600
&XUSERDATA    SETC  'NULL'                                              00180700
              AIF   (K'&USERDATA(1) LE 0).ZG36B  PARM                   00180800
&XUSERDATA    SETC  '&USERDATA(1)'              SET XVARIABLE           00180900
              AIF   (N'&USERDATA GT 1).ZG36B    MULTI                   00181000
&XUSERDATA    SETC  '&USERDATA'                 SET XVARIABLE           00181100
.ZG36B        ANOP  ,                                                   00181200
.*-------------------------------------------------------------------   00181300
.***AG.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     00181400
              AIF   (K'&ZXUSERDATA LE 0).ZG36P  NOT I/O                 00181500
              AIF   ('&XUSERDATA' EQ 'NULL').ZG36P                      00181600
              AIF   ('&XUSERDATA'(1,1) NE '(').ZG36P                    00181700
&ZXUSERDATA   SETC  ''          RESET IN/OUTPUT                         00181800
&ZMS          SETC  '"USERDATA='                                        00181900
&ZMS          SETC  '&ZMS.&USERDATA"'                                   00182000
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00182100
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00182200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00182300
.ZG36P        ANOP  ,                                                   00182400
.*----------------------------------------------------------------***   00182500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00182600
              AIF   (N'&RETCODE LE 1).ZG39A     CK NUM                  00182700
&ZMS          SETC  '"RETCODE='                                         00182800
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00182900
&ZMS          SETC  '&ZMS "RETCODE"'                                    00183000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00183100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00183200
.ZG39A        ANOP  ,                                                   00183300
.*-------------------------------------------------------------------   00183400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00183500
              AIF   (K'&RETCODE(1) LE 0).ZG39C  NO PARM                 00183600
&ZXRETCODE    SETC  'OUTPUT'    SET OUTPUT                              00183700
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00183800
              AIF   (N'&RETCODE GT 1).ZG39C                             00183900
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00184000
.ZG39C        ANOP  ,                                                   00184100
.*-------------------------------------------------------------------   00184200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00184300
              AIF   (K'&ZXRETCODE LE 0).ZG39R   NOT I/O                 00184400
              AIF   ('&XRETCODE'(1,1) NE '(').ZG39R                     00184500
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00184600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG39P                        00184700
              AIF   (K'&ZCGPR GT 2).ZG39Q                               00184800
              AIF   ('&ZCGPR' EQ '0').ZG39Q                             00184900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00185000
              AIF   (T'&ZCGPR NE 'N').ZG39Q     INVALID REG NAME        00185100
.ZG39P        ANOP  ,                                                   00185200
              AIF   (T'&ZCGPR NE 'N').ZG39R     NON NUMERIC             00185300
              AIF   ('&ZCGPR' EQ '15').ZG39R                            00185400
              AIF   ('&ZCGPR' LT '2').ZG39Q                             00185500
              AIF   ('&ZCGPR' LE '12').ZG39R                            00185600
.ZG39Q        ANOP  ,                                                   00185700
&ZMS          SETC  '"RETCODE='                                         00185800
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00185900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00186000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'            00186100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00186200
.ZG39R        ANOP  ,                                                   00186300
.*----------------------------------------------------------------***   00186400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00186500
              AIF   (N'&RSNCODE LE 1).ZG42A     CK NUM                  00186600
&ZMS          SETC  '"RSNCODE='                                         00186700
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00186800
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00186900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00187000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00187100
.ZG42A        ANOP  ,                                                   00187200
.*-------------------------------------------------------------------   00187300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00187400
              AIF   (K'&RSNCODE(1) LE 0).ZG42C  NO PARM                 00187500
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              00187600
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00187700
              AIF   (N'&RSNCODE GT 1).ZG42C                             00187800
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00187900
.ZG42C        ANOP  ,                                                   00188000
.*-------------------------------------------------------------------   00188100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00188200
              AIF   (K'&ZXRSNCODE LE 0).ZG42R   NOT I/O                 00188300
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG42R                     00188400
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00188500
              AIF   ('&ZCGPR'(1,1) NE '0').ZG42P                        00188600
              AIF   (K'&ZCGPR GT 2).ZG42Q                               00188700
              AIF   ('&ZCGPR' EQ '0').ZG42R                             00188800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00188900
              AIF   (T'&ZCGPR NE 'N').ZG42Q     INVALID REG NAME        00189000
.ZG42P        ANOP  ,                                                   00189100
              AIF   (T'&ZCGPR NE 'N').ZG42R     NON NUMERIC             00189200
              AIF   ('&ZCGPR' EQ '0').ZG42R                             00189300
              AIF   ('&ZCGPR' LT '2').ZG42Q                             00189400
              AIF   ('&ZCGPR' LE '12').ZG42R                            00189500
.ZG42Q        ANOP  ,                                                   00189600
&ZMS          SETC  '"RSNCODE='                                         00189700
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00189800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00189900
              MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'             00190000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00190100
.ZG42R        ANOP  ,                                                   00190200
.*----------------------------------------------------------------***   00190300
.***AG.KXVAR05 VALUE, OPT INPUT, KEYS -XVARIABLE KEY                    00190400
              AIF   (N'&COM LE 1).ZG45A         CK NUM                  00190500
&ZMS          SETC  '"COM='                                             00190600
&ZMS          SETC  '&ZMS.&COM"'                                        00190700
&ZMS          SETC  '&ZMS "COM"'                                        00190800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00190900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00191000
.ZG45A        ANOP  ,                                                   00191100
.*-------------------------------------------------------------------   00191200
.***AG.KXVAR13 VALUE, OPT INPUT, KEYS -XVARIABLE                        00191300
&ZXCOM        SETC  'INPUT'     SET IN/OUTPUT                           00191400
&XCOM         SETC  'NULL'                                              00191500
              AIF   (K'&COM(1) LE 0).ZG45B      PARM                    00191600
&XCOM         SETC  '&COM(1)'   SET XVARIABLE                           00191700
              AIF   (N'&COM GT 1).ZG45B         MULTI                   00191800
&XCOM         SETC  '&COM'      SET XVARIABLE                           00191900
.ZG45B        ANOP  ,                                                   00192000
.*-------------------------------------------------------------------   00192100
.***AG.KCK01 VALUE, OPT INPUT, KEYS -GPR NOT ALLOWED                    00192200
              AIF   (K'&ZXCOM LE 0).ZG45P       NOT I/O                 00192300
              AIF   ('&XCOM' EQ 'NULL').ZG45P                           00192400
              AIF   ('&XCOM'(1,1) NE '(').ZG45P                         00192500
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         00192600
&ZMS          SETC  '"COM='                                             00192700
&ZMS          SETC  '&ZMS.&COM"'                                        00192800
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00192900
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00193000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00193100
.ZG45P        ANOP  ,                                                   00193200
.*-------------------------------------------------------------------   00193300
.***AG.KCK03 VALUE, OPT INPUT, KEYS -CHARACTER LENGTH                   00193400
              AIF   (K'&ZXCOM LE 0).ZG45S       NOT I/O                 00193500
              AIF   ('&XCOM' EQ 'NULL').ZG45S                           00193600
              AIF   (K'&XCOM LE 256).ZG45S      LNG OK                  00193700
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         00193800
&ZMS          SETC  '"COM='                                             00193900
&ZMS          SETC  '&ZMS.&COM"'                                        00194000
&ZMS          SETC  '&ZMS ARGUMENT 1 EXCEEDS THE MAXIMUM'               00194100
              MNOTE 8,' &ZMS LENGTH OF 256 CHARACTERS.'                 00194200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00194300
.ZG45S        ANOP  ,                                                   00194400
.******************************************************************     00194500
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00194600
.******************************************************************     00194700
              ACTR  10000                                               00194800
.*----------------------------------------------------------------***   00194900
.***AH.P02 EXTRA POSITIONALS                                            00195000
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               00195100
              AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL                00195200
              AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL            00195300
              AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL             00195400
.ZGLISTX1     ANOP  ,                                                   00195500
&ZCVAL        SETC  ''          ERROR FIELD                             00195600
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00195700
.ZGLIST2      ANOP  ,                                                   00195800
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00195900
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                00196000
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00196100
              AGO   .ZGLIST2                                            00196200
.*                                                                      00196300
.ZGLIST3      ANOP  ,                                                   00196400
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00196500
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00196600
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00196700
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00196800
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00196900
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00197000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00197100
.ZGLISTX      ANOP  ,                                                   00197200
&ZASYSLNDX    SETA  0                                                   00197300
.*-------------------------------------------------------------------   00197400
.***AG.MF04 MF=(SLME)                                                   00197500
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                00197600
.********************************************************************   00197700
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00197800
.********************************************************************   00197900
              ACTR  10000                                               00198000
.*-------------------------------------------------------------------   00198100
.***AE.MF01 MF=(SLME)                                                   00198200
              AIF   ('&XMF' EQ 'L').ZEMFX                               00198300
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      00198400
.********************************************************************   00198500
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00198600
.********************************************************************   00198700
&XFUNC        SETC  ''          INITIALIZE XVARIABLE                    00198800
&XENV         SETC  ''          INITIALIZE XVARIABLE                    00198900
.*-------------------------------------------------------------------   00199000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00199100
&ZTLC         SETC 'LPA'                                                00199200
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE3A                        00199300
&XFUNC        SETC  'LPA'       SET KEYWORD                             00199400
              AIF   (N'&FUNC LE 1).ZE3A         CK NUM                  00199500
&ZMS          SETC  '"FUNC='                                            00199600
&ZMS          SETC  '&ZMS.&FUNC"'                                       00199700
&ZMS          SETC  '&ZMS "FUNC"'                                       00199800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00199900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00200000
.ZE3A         ANOP  ,                                                   00200100
.*-------------------------------------------------------------------   00200200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00200300
&ZTLC         SETC 'JPA'                                                00200400
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE4A                        00200500
&XFUNC        SETC  'JPA'       SET KEYWORD                             00200600
              AIF   (N'&FUNC LE 1).ZE4A         CK NUM                  00200700
&ZMS          SETC  '"FUNC='                                            00200800
&ZMS          SETC  '&ZMS.&FUNC"'                                       00200900
&ZMS          SETC  '&ZMS "FUNC"'                                       00201000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00201100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00201200
.ZE4A         ANOP  ,                                                   00201300
.*----------------------------------------------------------------***   00201400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00201500
              AIF   (N'&TCBADDR LE 1).ZE6A      CK NUM                  00201600
&ZMS          SETC  '"TCBADDR='                                         00201700
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00201800
&ZMS          SETC  '&ZMS "TCBADDR"'                                    00201900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00202000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00202100
.ZE6A         ANOP  ,                                                   00202200
.*-------------------------------------------------------------------   00202300
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00202400
              AIF   (K'&TCBADDR(1) LE 0).ZE6B   NO PRM                  00202500
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           00202600
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           00202700
              AIF   (N'&TCBADDR GT 1).ZE6B                              00202800
.*            ANOP                                                      00202900
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           00203000
.ZE6B         ANOP  ,                                                   00203100
.*-------------------------------------------------------------------   00203200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00203300
              AIF   (K'&ZXTCBADDR LE 0).ZE6R    NOT I/O                 00203400
              AIF   ('&XTCBADDR'(1,1) NE '(').ZE6R                      00203500
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        00203600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE6P                         00203700
              AIF   (K'&ZCGPR GT 2).ZE6Q                                00203800
              AIF   ('&ZCGPR' EQ '0').ZE6Q                              00203900
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00204000
              AIF   (T'&ZCGPR NE 'N').ZE6Q      INVALID REG NAME        00204100
.ZE6P         ANOP  ,                                                   00204200
              AIF   (T'&ZCGPR NE 'N').ZE6R      NON NUMERIC             00204300
              AIF   ('&ZCGPR' LT '2').ZE6Q                              00204400
              AIF   ('&ZCGPR' LE '12').ZE6R                             00204500
.ZE6Q         ANOP  ,                                                   00204600
&ZMS          SETC  '"TCBADDR='                                         00204700
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00204800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00204900
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00205000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00205100
.ZE6R         ANOP  ,                                                   00205200
.*-------------------------------------------------------------------   00205300
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00205400
&ZTLC         SETC 'TASKLOAD'                                           00205500
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE8A                        00205600
&XFUNC        SETC  'TASKLOAD'  SET KEYWORD                             00205700
              AIF   (N'&FUNC LE 1).ZE8A         CK NUM                  00205800
&ZMS          SETC  '"FUNC='                                            00205900
&ZMS          SETC  '&ZMS.&FUNC"'                                       00206000
&ZMS          SETC  '&ZMS "FUNC"'                                       00206100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00206200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00206300
.ZE8A         ANOP  ,                                                   00206400
.*----------------------------------------------------------------***   00206500
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00206600
              AIF   (N'&TCBADDR LE 1).ZE10A     CK NUM                  00206700
&ZMS          SETC  '"TCBADDR='                                         00206800
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00206900
&ZMS          SETC  '&ZMS "TCBADDR"'                                    00207000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00207100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00207200
.ZE10A        ANOP  ,                                                   00207300
.*-------------------------------------------------------------------   00207400
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00207500
              AIF   (K'&TCBADDR(1) LE 0).ZE10B  NO PRM                  00207600
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           00207700
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           00207800
              AIF   (N'&TCBADDR GT 1).ZE10B                             00207900
.*            ANOP                                                      00208000
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           00208100
.ZE10B        ANOP  ,                                                   00208200
.*-------------------------------------------------------------------   00208300
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00208400
              AIF   (K'&ZXTCBADDR LE 0).ZE10R   NOT I/O                 00208500
              AIF   ('&XTCBADDR'(1,1) NE '(').ZE10R                     00208600
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        00208700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        00208800
              AIF   (K'&ZCGPR GT 2).ZE10Q                               00208900
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             00209000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00209100
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        00209200
.ZE10P        ANOP  ,                                                   00209300
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             00209400
              AIF   ('&ZCGPR' LT '2').ZE10Q                             00209500
              AIF   ('&ZCGPR' LE '12').ZE10R                            00209600
.ZE10Q        ANOP  ,                                                   00209700
&ZMS          SETC  '"TCBADDR='                                         00209800
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00209900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00210000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00210100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00210200
.ZE10R        ANOP  ,                                                   00210300
.*-------------------------------------------------------------------   00210400
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00210500
&ZTLC         SETC 'TASKALL'                                            00210600
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE12A                       00210700
&XFUNC        SETC  'TASKALL'   SET KEYWORD                             00210800
              AIF   (N'&FUNC LE 1).ZE12A        CK NUM                  00210900
&ZMS          SETC  '"FUNC='                                            00211000
&ZMS          SETC  '&ZMS.&FUNC"'                                       00211100
&ZMS          SETC  '&ZMS "FUNC"'                                       00211200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00211300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00211400
.ZE12A        ANOP  ,                                                   00211500
.*----------------------------------------------------------------***   00211600
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00211700
              AIF   (N'&TCBADDR LE 1).ZE14A     CK NUM                  00211800
&ZMS          SETC  '"TCBADDR='                                         00211900
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00212000
&ZMS          SETC  '&ZMS "TCBADDR"'                                    00212100
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00212200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00212300
.ZE14A        ANOP  ,                                                   00212400
.*-------------------------------------------------------------------   00212500
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00212600
              AIF   (K'&TCBADDR(1) LE 0).ZE14B  NO PRM                  00212700
&ZXTCBADDR    SETC  'INPUT'     SET IN/OUTPUT                           00212800
&XTCBADDR     SETC  '&TCBADDR(1)'               SET XVARIABLE           00212900
              AIF   (N'&TCBADDR GT 1).ZE14B                             00213000
.*            ANOP                                                      00213100
&XTCBADDR     SETC  '&TCBADDR'  SET XVARIABLE                           00213200
.ZE14B        ANOP  ,                                                   00213300
.*-------------------------------------------------------------------   00213400
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00213500
              AIF   (K'&ZXTCBADDR LE 0).ZE14R   NOT I/O                 00213600
              AIF   ('&XTCBADDR'(1,1) NE '(').ZE14R                     00213700
&ZCGPR        SETC  '&XTCBADDR'(2,K'&XTCBADDR-2)                        00213800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE14P                        00213900
              AIF   (K'&ZCGPR GT 2).ZE14Q                               00214000
              AIF   ('&ZCGPR' EQ '0').ZE14Q                             00214100
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00214200
              AIF   (T'&ZCGPR NE 'N').ZE14Q     INVALID REG NAME        00214300
.ZE14P        ANOP  ,                                                   00214400
              AIF   (T'&ZCGPR NE 'N').ZE14R     NON NUMERIC             00214500
              AIF   ('&ZCGPR' LT '2').ZE14Q                             00214600
              AIF   ('&ZCGPR' LE '12').ZE14R                            00214700
.ZE14Q        ANOP  ,                                                   00214800
&ZMS          SETC  '"TCBADDR='                                         00214900
&ZMS          SETC  '&ZMS.&TCBADDR"'                                    00215000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00215100
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00215200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00215300
.ZE14R        ANOP  ,                                                   00215400
.*-------------------------------------------------------------------   00215500
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00215600
&ZTLC         SETC 'RB'                                                 00215700
              AIF   ('&FUNC(1)' NE '&ZTLC').ZE16A                       00215800
&XFUNC        SETC  'RB'        SET KEYWORD                             00215900
              AIF   (N'&FUNC LE 1).ZE16A        CK NUM                  00216000
&ZMS          SETC  '"FUNC='                                            00216100
&ZMS          SETC  '&ZMS.&FUNC"'                                       00216200
&ZMS          SETC  '&ZMS "FUNC"'                                       00216300
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00216400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00216500
.ZE16A        ANOP  ,                                                   00216600
.*----------------------------------------------------------------***   00216700
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00216800
              AIF   (N'&RBADDR LE 1).ZE18A      CK NUM                  00216900
&ZMS          SETC  '"RBADDR='                                          00217000
&ZMS          SETC  '&ZMS.&RBADDR"'                                     00217100
&ZMS          SETC  '&ZMS "RBADDR"'                                     00217200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00217300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00217400
.ZE18A        ANOP  ,                                                   00217500
.*-------------------------------------------------------------------   00217600
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00217700
              AIF   (K'&RBADDR(1) LE 0).ZE18B   NO PRM                  00217800
&ZXRBADDR     SETC  'INPUT'     SET IN/OUTPUT                           00217900
&XRBADDR      SETC  '&RBADDR(1)'                SET XVARIABLE           00218000
              AIF   (N'&RBADDR GT 1).ZE18B                              00218100
.*            ANOP                                                      00218200
&XRBADDR      SETC  '&RBADDR'   SET XVARIABLE                           00218300
.ZE18B        ANOP  ,                                                   00218400
.*-------------------------------------------------------------------   00218500
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00218600
              AIF   (K'&ZXRBADDR LE 0).ZE18R    NOT I/O                 00218700
              AIF   ('&XRBADDR'(1,1) NE '(').ZE18R                      00218800
&ZCGPR        SETC  '&XRBADDR'(2,K'&XRBADDR-2)                          00218900
              AIF   ('&ZCGPR'(1,1) NE '0').ZE18P                        00219000
              AIF   (K'&ZCGPR GT 2).ZE18Q                               00219100
              AIF   ('&ZCGPR' EQ '0').ZE18Q                             00219200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00219300
              AIF   (T'&ZCGPR NE 'N').ZE18Q     INVALID REG NAME        00219400
.ZE18P        ANOP  ,                                                   00219500
              AIF   (T'&ZCGPR NE 'N').ZE18R     NON NUMERIC             00219600
              AIF   ('&ZCGPR' LT '2').ZE18Q                             00219700
              AIF   ('&ZCGPR' LE '12').ZE18R                            00219800
.ZE18Q        ANOP  ,                                                   00219900
&ZMS          SETC  '"RBADDR='                                          00220000
&ZMS          SETC  '&ZMS.&RBADDR"'                                     00220100
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00220200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00220300
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00220400
.ZE18R        ANOP  ,                                                   00220500
.*------------------------------------------------------------------    00220600
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00220700
.ZE20         AIF   (K'&XFUNC GT 0).ZE20A                               00220800
              AIF   (K'&FUNC(1) LE 0).ZE20B                             00220900
&ZMS          SETC  '"FUNC='                                            00221000
&ZMS          SETC  '&ZMS.&FUNC"'                                       00221100
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00221200
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00221300
&ZMS          SETC  '&ZMS "LPA",'                                       00221400
&ZMS          SETC  '&ZMS "JPA",'                                       00221500
&ZMS          SETC  '&ZMS "TASKLOAD",'                                  00221600
&ZMS          SETC  '&ZMS "TASKALL",'                                   00221700
&ZMS          SETC  '&ZMS OR "RB".'                                     00221800
              MNOTE 8,' &ZMS '                                          00221900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00222000
              AGO   .ZE20B                                              00222100
.*                                                                      00222200
.ZE20A        ANOP  ,                                                   00222300
&ZXFUNC       SETC  'INPUT'     SET IN/OUTPUT                           00222400
.ZE20B        ANOP  ,                                                   00222500
.*-------------------------------------------------------------------   00222600
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00222700
&ZTLC         SETC 'MVS'                                                00222800
              AIF   ('&ENV(1)' NE '&ZTLC').ZE23A                        00222900
&XENV         SETC  'MVS'       SET KEYWORD                             00223000
              AIF   (N'&ENV LE 1).ZE23A         CK NUM                  00223100
&ZMS          SETC  '"ENV='                                             00223200
&ZMS          SETC  '&ZMS.&ENV"'                                        00223300
&ZMS          SETC  '&ZMS "ENV"'                                        00223400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00223500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00223600
.ZE23A        ANOP  ,                                                   00223700
.*-------------------------------------------------------------------   00223800
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00223900
&ZTLC         SETC 'IPCS'                                               00224000
              AIF   ('&ENV(1)' NE '&ZTLC').ZE24A                        00224100
&XENV         SETC  'IPCS'      SET KEYWORD                             00224200
              AIF   (N'&ENV LE 1).ZE24A         CK NUM                  00224300
&ZMS          SETC  '"ENV='                                             00224400
&ZMS          SETC  '&ZMS.&ENV"'                                        00224500
&ZMS          SETC  '&ZMS "ENV"'                                        00224600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00224700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00224800
.ZE24A        ANOP  ,                                                   00224900
.*----------------------------------------------------------------***   00225000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00225100
              AIF   (N'&ABDPLPTR LE 1).ZE26A    CK NUM                  00225200
&ZMS          SETC  '"ABDPLPTR='                                        00225300
&ZMS          SETC  '&ZMS.&ABDPLPTR"'                                   00225400
&ZMS          SETC  '&ZMS "ABDPLPTR"'                                   00225500
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00225600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00225700
.ZE26A        ANOP  ,                                                   00225800
.*-------------------------------------------------------------------   00225900
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00226000
              AIF   (K'&ABDPLPTR(1) LE 0).ZE26B NO PRM                  00226100
&ZXABDPLPTR   SETC  'INPUT'     SET IN/OUTPUT                           00226200
&XABDPLPTR    SETC  '&ABDPLPTR(1)'              SET XVARIABLE           00226300
              AIF   (N'&ABDPLPTR GT 1).ZE26B                            00226400
.*            ANOP                                                      00226500
&XABDPLPTR    SETC  '&ABDPLPTR'                 SET XVARIABLE           00226600
.ZE26B        ANOP  ,                                                   00226700
.*-------------------------------------------------------------------   00226800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00226900
              AIF   (K'&ZXABDPLPTR LE 0).ZE26R  NOT I/O                 00227000
              AIF   ('&XABDPLPTR'(1,1) NE '(').ZE26R                    00227100
&ZCGPR        SETC  '&XABDPLPTR'(2,K'&XABDPLPTR-2)                      00227200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE26P                        00227300
              AIF   (K'&ZCGPR GT 2).ZE26Q                               00227400
              AIF   ('&ZCGPR' EQ '0').ZE26Q                             00227500
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00227600
              AIF   (T'&ZCGPR NE 'N').ZE26Q     INVALID REG NAME        00227700
.ZE26P        ANOP  ,                                                   00227800
              AIF   (T'&ZCGPR NE 'N').ZE26R     NON NUMERIC             00227900
              AIF   ('&ZCGPR' LT '2').ZE26Q                             00228000
              AIF   ('&ZCGPR' LE '12').ZE26R                            00228100
.ZE26Q        ANOP  ,                                                   00228200
&ZMS          SETC  '"ABDPLPTR='                                        00228300
&ZMS          SETC  '&ZMS.&ABDPLPTR"'                                   00228400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00228500
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00228600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00228700
.ZE26R        ANOP  ,                                                   00228800
.*----------------------------------------------------------------***   00228900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00229000
              AIF   (N'&ASID LE 1).ZE29A        CK NUM                  00229100
&ZMS          SETC  '"ASID='                                            00229200
&ZMS          SETC  '&ZMS.&ASID"'                                       00229300
&ZMS          SETC  '&ZMS "ASID"'                                       00229400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00229500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00229600
.ZE29A        ANOP  ,                                                   00229700
.*-------------------------------------------------------------------   00229800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00229900
              AIF   (K'&ASID(1) LE 0).ZE29B     NO PRM                  00230000
&ZXASID       SETC  'INPUT'     SET IN/OUTPUT                           00230100
&XASID        SETC  '&ASID(1)'  SET XVARIABLE                           00230200
              AIF   (N'&ASID GT 1).ZE29B                                00230300
.*            ANOP                                                      00230400
&XASID        SETC  '&ASID'     SET XVARIABLE                           00230500
.ZE29B        ANOP  ,                                                   00230600
.*-------------------------------------------------------------------   00230700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00230800
              AIF   (K'&ZXASID LE 0).ZE29R      NOT I/O                 00230900
              AIF   ('&XASID'(1,1) NE '(').ZE29R                        00231000
&ZCGPR        SETC  '&XASID'(2,K'&XASID-2)                              00231100
              AIF   ('&ZCGPR'(1,1) NE '0').ZE29P                        00231200
              AIF   (K'&ZCGPR GT 2).ZE29Q                               00231300
              AIF   ('&ZCGPR' EQ '0').ZE29Q                             00231400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00231500
              AIF   (T'&ZCGPR NE 'N').ZE29Q     INVALID REG NAME        00231600
.ZE29P        ANOP  ,                                                   00231700
              AIF   (T'&ZCGPR NE 'N').ZE29R     NON NUMERIC             00231800
              AIF   ('&ZCGPR' LT '2').ZE29Q                             00231900
              AIF   ('&ZCGPR' LE '12').ZE29R                            00232000
.ZE29Q        ANOP  ,                                                   00232100
&ZMS          SETC  '"ASID='                                            00232200
&ZMS          SETC  '&ZMS.&ASID"'                                       00232300
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00232400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00232500
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00232600
.ZE29R        ANOP  ,                                                   00232700
.*------------------------------------------------------------------    00232800
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00232900
.ZE31         AIF   (K'&XENV GT 0).ZE31A                                00233000
              AIF   (K'&ENV(1) LE 0).ZE31B                              00233100
&ZMS          SETC  '"ENV='                                             00233200
&ZMS          SETC  '&ZMS.&ENV"'                                        00233300
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           00233400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 00233500
&ZMS          SETC  '&ZMS "MVS"'                                        00233600
&ZMS          SETC  '&ZMS OR "IPCS".'                                   00233700
              MNOTE 8,' &ZMS '                                          00233800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00233900
              AGO   .ZE31B                                              00234000
.*                                                                      00234100
.ZE31A        ANOP  ,                                                   00234200
&ZXENV        SETC  'INPUT'     SET IN/OUTPUT                           00234300
.ZE31B        ANOP  ,                                                   00234400
.*----------------------------------------------------------------***   00234500
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00234600
              AIF   (N'&MIPR LE 1).ZE33A        CK NUM                  00234700
&ZMS          SETC  '"MIPR='                                            00234800
&ZMS          SETC  '&ZMS.&MIPR"'                                       00234900
&ZMS          SETC  '&ZMS "MIPR"'                                       00235000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00235100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00235200
.ZE33A        ANOP  ,                                                   00235300
.*-------------------------------------------------------------------   00235400
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00235500
              AIF   (K'&MIPR(1) LE 0).ZE33B     NO PRM                  00235600
&ZXMIPR       SETC  'INPUT'     SET IN/OUTPUT                           00235700
&XMIPR        SETC  '&MIPR(1)'  SET XVARIABLE                           00235800
              AIF   (N'&MIPR GT 1).ZE33B                                00235900
.*            ANOP                                                      00236000
&XMIPR        SETC  '&MIPR'     SET XVARIABLE                           00236100
.ZE33B        ANOP  ,                                                   00236200
.*-------------------------------------------------------------------   00236300
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00236400
              AIF   (K'&ZXMIPR LE 0).ZE33R      NOT I/O                 00236500
              AIF   ('&XMIPR'(1,1) NE '(').ZE33R                        00236600
&ZCGPR        SETC  '&XMIPR'(2,K'&XMIPR-2)                              00236700
              AIF   ('&ZCGPR'(1,1) NE '0').ZE33P                        00236800
              AIF   (K'&ZCGPR GT 2).ZE33Q                               00236900
              AIF   ('&ZCGPR' EQ '0').ZE33Q                             00237000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00237100
              AIF   (T'&ZCGPR NE 'N').ZE33Q     INVALID REG NAME        00237200
.ZE33P        ANOP  ,                                                   00237300
              AIF   (T'&ZCGPR NE 'N').ZE33R     NON NUMERIC             00237400
              AIF   ('&ZCGPR' LT '2').ZE33Q                             00237500
              AIF   ('&ZCGPR' LE '12').ZE33R                            00237600
.ZE33Q        ANOP  ,                                                   00237700
&ZMS          SETC  '"MIPR='                                            00237800
&ZMS          SETC  '&ZMS.&MIPR"'                                       00237900
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00238000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00238100
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00238200
.ZE33R        ANOP  ,                                                   00238300
.*----------------------------------------------------------------***   00238400
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00238500
              AIF   (N'&USERDATA LE 1).ZE36A    CK NUM                  00238600
&ZMS          SETC  '"USERDATA='                                        00238700
&ZMS          SETC  '&ZMS.&USERDATA"'                                   00238800
&ZMS          SETC  '&ZMS "USERDATA"'                                   00238900
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00239000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00239100
.ZE36A        ANOP  ,                                                   00239200
.*-------------------------------------------------------------------   00239300
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00239400
              AIF   (K'&USERDATA(1) LE 0).ZE36B NO PRM                  00239500
&ZXUSERDATA   SETC  'INPUT'     SET IN/OUTPUT                           00239600
&XUSERDATA    SETC  '&USERDATA(1)'              SET XVARIABLE           00239700
              AIF   (N'&USERDATA GT 1).ZE36B                            00239800
.*            ANOP                                                      00239900
&XUSERDATA    SETC  '&USERDATA'                 SET XVARIABLE           00240000
.ZE36B        ANOP  ,                                                   00240100
.*-------------------------------------------------------------------   00240200
.***AE.KCK01 NAME, OPT INPUT, KEYS -GPR NOT ALLOWED                     00240300
              AIF   (K'&ZXUSERDATA LE 0).ZE36P  NOT I/O                 00240400
              AIF   ('&XUSERDATA'(1,1) NE '(').ZE36P                    00240500
&ZXUSERDATA   SETC  ''          RESET IN/OUTPUT                         00240600
&ZMS          SETC  '"USERDATA='                                        00240700
&ZMS          SETC  '&ZMS.&USERDATA"'                                   00240800
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00240900
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00241000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00241100
.ZE36P        ANOP  ,                                                   00241200
.*----------------------------------------------------------------***   00241300
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00241400
              AIF   (N'&RETCODE LE 1).ZE39A     CK NUM                  00241500
&ZMS          SETC  '"RETCODE='                                         00241600
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00241700
&ZMS          SETC  '&ZMS "RETCODE"'                                    00241800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00241900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00242000
.ZE39A        ANOP  ,                                                   00242100
.*-------------------------------------------------------------------   00242200
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00242300
              AIF   (K'&RETCODE(1) LE 0).ZE39B  NO PRM                  00242400
&ZXRETCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00242500
&XRETCODE     SETC  '&RETCODE(1)'               SET XVARIABLE           00242600
              AIF   (N'&RETCODE GT 1).ZE39B                             00242700
.*            ANOP                                                      00242800
&XRETCODE     SETC  '&RETCODE'  SET XVARIABLE                           00242900
.ZE39B        ANOP  ,                                                   00243000
.*-------------------------------------------------------------------   00243100
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00243200
              AIF   (K'&ZXRETCODE LE 0).ZE39R   NOT I/O                 00243300
              AIF   ('&XRETCODE'(1,1) NE '(').ZE39R                     00243400
&ZCGPR        SETC  '&XRETCODE'(2,K'&XRETCODE-2)                        00243500
              AIF   ('&ZCGPR'(1,1) NE '0').ZE39P                        00243600
              AIF   (K'&ZCGPR GT 2).ZE39Q                               00243700
              AIF   ('&ZCGPR' EQ '0').ZE39Q                             00243800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00243900
              AIF   (T'&ZCGPR NE 'N').ZE39Q     INVALID REG NAME        00244000
.ZE39P        ANOP  ,                                                   00244100
              AIF   (T'&ZCGPR NE 'N').ZE39R     NON NUMERIC             00244200
              AIF   ('&ZCGPR' LT '2').ZE39Q                             00244300
              AIF   ('&ZCGPR' LE '12').ZE39R                            00244400
.ZE39Q        ANOP  ,                                                   00244500
&ZMS          SETC  '"RETCODE='                                         00244600
&ZMS          SETC  '&ZMS.&RETCODE"'                                    00244700
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00244800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00244900
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00245000
.ZE39R        ANOP  ,                                                   00245100
.*----------------------------------------------------------------***   00245200
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00245300
              AIF   (N'&RSNCODE LE 1).ZE42A     CK NUM                  00245400
&ZMS          SETC  '"RSNCODE='                                         00245500
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00245600
&ZMS          SETC  '&ZMS "RSNCODE"'                                    00245700
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00245800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00245900
.ZE42A        ANOP  ,                                                   00246000
.*-------------------------------------------------------------------   00246100
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00246200
              AIF   (K'&RSNCODE(1) LE 0).ZE42B  NO PRM                  00246300
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           00246400
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           00246500
              AIF   (N'&RSNCODE GT 1).ZE42B                             00246600
.*            ANOP                                                      00246700
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           00246800
.ZE42B        ANOP  ,                                                   00246900
.*-------------------------------------------------------------------   00247000
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00247100
              AIF   (K'&ZXRSNCODE LE 0).ZE42R   NOT I/O                 00247200
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE42R                     00247300
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        00247400
              AIF   ('&ZCGPR'(1,1) NE '0').ZE42P                        00247500
              AIF   (K'&ZCGPR GT 2).ZE42Q                               00247600
              AIF   ('&ZCGPR' EQ '0').ZE42Q                             00247700
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       00247800
              AIF   (T'&ZCGPR NE 'N').ZE42Q     INVALID REG NAME        00247900
.ZE42P        ANOP  ,                                                   00248000
              AIF   (T'&ZCGPR NE 'N').ZE42R     NON NUMERIC             00248100
              AIF   ('&ZCGPR' LT '2').ZE42Q                             00248200
              AIF   ('&ZCGPR' LE '12').ZE42R                            00248300
.ZE42Q        ANOP  ,                                                   00248400
&ZMS          SETC  '"RSNCODE='                                         00248500
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    00248600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           00248700
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    00248800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00248900
.ZE42R        ANOP  ,                                                   00249000
.*----------------------------------------------------------------***   00249100
.***AE.KXVAR03 VALUE, OPT INPUT, KEYS -XVAR KEY                         00249200
              AIF   (N'&COM LE 1).ZE45A         CK NUM                  00249300
&ZMS          SETC  '"COM='                                             00249400
&ZMS          SETC  '&ZMS.&COM"'                                        00249500
&ZMS          SETC  '&ZMS "COM"'                                        00249600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 00249700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00249800
.ZE45A        ANOP  ,                                                   00249900
.*-------------------------------------------------------------------   00250000
.***AE.KXVAR04 VALUE, OPT INPUT, KEYS -XVAR ARGUMENT                    00250100
              AIF   (K'&COM(1) LE 0).ZE45B      NO PRM                  00250200
&ZXCOM        SETC  'INPUT'     SET IN/OUTPUT                           00250300
&XCOM         SETC  '&COM(1)'   SET XVARIABLE                           00250400
              AIF   (N'&COM GT 1).ZE45B                                 00250500
.*            ANOP                                                      00250600
&XCOM         SETC  '&COM'      SET XVARIABLE                           00250700
.ZE45B        ANOP  ,                                                   00250800
.*-------------------------------------------------------------------   00250900
.***AE.KCK01 VALUE, OPT INPUT, KEYS -GPR NOT ALLOWED                    00251000
              AIF   (K'&ZXCOM LE 0).ZE45P       NOT I/O                 00251100
              AIF   ('&XCOM'(1,1) NE '(').ZE45P                         00251200
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         00251300
&ZMS          SETC  '"COM='                                             00251400
&ZMS          SETC  '&ZMS.&COM"'                                        00251500
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           00251600
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                   00251700
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00251800
.ZE45P        ANOP  ,                                                   00251900
.*-------------------------------------------------------------------   00252000
.***AE.KCK03 VALUE, OPT INPUT, KEYS -CHARACTER LENGTH                   00252100
              AIF   (K'&ZXCOM LE 0).ZE45S       NOT I/O                 00252200
              AIF   (K'&XCOM LE 256).ZE45S      LNG OK                  00252300
&ZXCOM        SETC  ''          RESET IN/OUTPUT                         00252400
&ZMS          SETC  '"COM='                                             00252500
&ZMS          SETC  '&ZMS.&COM"'                                        00252600
&ZMS          SETC  '&ZMS ARGUMENT 1 EXCEEDS THE MAXIMUM'               00252700
              MNOTE 8,' &ZMS LENGTH OF 256 CHARACTERS.'                 00252800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00252900
.ZE45S        ANOP  ,                                                   00253000
.******************************************************************     00253100
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00253200
.******************************************************************     00253300
              ACTR  10000                                               00253400
.*----------------------------------------------------------------***   00253500
.***AF.P02 EXTRA POSITIONALS                                            00253600
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               00253700
&ZCVAL        SETC  ''          ERROR FIELD                             00253800
&ZAWRK        SETA  0           POSITIONAL NUMBER                       00253900
.ZELIST2      ANOP  ,                                                   00254000
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         00254100
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                00254200
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   00254300
              AGO   .ZELIST2                                            00254400
.*                                                                      00254500
.ZELIST3      ANOP  ,                                                   00254600
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             00254700
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'                           00254800
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     00254900
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              00255000
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      00255100
              MNOTE 8,' &ZMS ARE ALLOWED.'                              00255200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             00255300
.ZELISTX      ANOP  ,                                                   00255400
&ZASYSLNDX    SETA  0                                                   00255500
.*-------------------------------------------------------------------   00255600
.***AE.MF02 MF=(SLME)                                                   00255700
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             00255800
.*******************************************************************    00255900
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00256000
.*******************************************************************    00256100
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          00256200
.*******************************************************************    00256300
.***AE.01  START OF CSVINFO MACRO CODE                                  00256400
.*******************************************************************    00256500
              LCLC  &M0M0001                 NAME                       00256600
&M0M0001      SETC  '&XLABEL'                SET NAME                   00256700
              AIF   (K'&XLABEL NE 0).XLAB2                              00256800
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT NAME               00256900
.*                                                                      00257000
.XLAB2        ANOP  ,                                                   00257100
              AIF   ('&XMF' EQ 'L').XLAB3                               00257200
&M0M0001 DS    0H                             CSVINFO-0                 00257300
.XLAB3        ANOP  ,                                                   00257400
.*******************************************************************    00257500
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00257600
.*******************************************************************    00257700
              PUSH  PRINT                                               00257800
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          00257900
              PRINT OFF         ++ PR01                                 00258000
              AGO   .ZPRNTXX                                            00258100
.ZPRINTX      PRINT ON                                                  00258200
.ZPRNTXX      ANOP  ,                                                   00258300
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00258400
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00258500
.********************************************************************   00258600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00258700
.********************************************************************   00258800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00258900
                      LCLA  &ZOPN1         INVOCATION INDEX             00259000
                      LCLC  &ZOPL(4095)    LABEL                        00259100
                      LCLC  &ZOPO(4095)    OPERATION                    00259200
                      LCLC  &ZOPV(4095)    VALUE                        00259300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00259400
.*                                                                      00259500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00259600
.******************************************************************     00259700
.***AL.L10 CSVINFO FMT=LIST MF=S!L PARAMETERS                           00259800
.******************************************************************     00259900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00260000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00260100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00260200
&XMFATTR              SETC  '0D'                                        00260300
.*                                                                      00260400
&ZOPN                 SETA  &ZOPN+1                                     00260500
&ZOPL(&ZOPN)          SETC  ' '                                         00260600
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00260700
&ZOPO(&ZOPN)          SETC  'B'                                         00260800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00260900
                      AGO   .ZALVL6B                                    00261000
.ZALVL6A              ANOP                                              00261100
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00261200
&ZOPV(&ZOPN)          SETC  '4,8'                                       00261300
&ZOPN                 SETA  &ZOPN+1                                     00261400
&ZOPL(&ZOPN)          SETC  ' '                                         00261500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00261600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00261700
.ZALVL6B              ANOP                                              00261800
&ZOPD(&ZOPN)          SETC  '++ CSVINFO ARG PARMS'                      00261900
.*                                                                      00262000
&ZOPN                 SETA  &ZOPN+1                                     00262100
&ZOPL(&ZOPN)          SETC  ' '                                         00262200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00262300
&ZOPV(&ZOPN)          SETC  '1'                                         00262400
&ZOPD(&ZOPN)          SETC  ' '                                         00262500
.*                                                                      00262600
.ZLMFSL2              ANOP  ,                                           00262700
.*-------------------------------------------------------------------   00262800
.***AM.L00  CSVINFO FMT=LIST name                                       00262900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00263000
&ZOPN                 SETA &ZOPN+1                                      00263100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00263200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00263300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00263400
&ZOPD(&ZOPN)          SETC '++ CSVINFO NAME'                            00263500
.ZLMFSL2M             ANOP  ,                                           00263600
.*-------------------------------------------------------------------   00263700
.***AM.L01  CSVINFO FMT=LIST PARAMETERS                                 00263800
&ZOPN                 SETA &ZOPN+1                                      00263900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00264000
&ZOPO(&ZOPN)          SETC 'DS'                                         00264100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00264200
&ZOPD(&ZOPN)          SETC '++ CSVINFO PARM LIST'                       00264300
.*-------------------------------------------------------------------   00264400
.***AM.L02 XVERSION XL1                                                 00264500
&ZOPN                 SETA &ZOPN+1                                      00264600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00264700
&ZOPO(&ZOPN)          SETC 'DS'                                         00264800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00264900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00265000
.*-------------------------------------------------------------------   00265100
.***AM.L03 XFLAGS1 BL.8                                                 00265200
&ZOPN                 SETA &ZOPN+1                                      00265300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS1'                          00265400
&ZOPO(&ZOPN)          SETC 'DS'                                         00265500
&ZOPV(&ZOPN)          SETC 'BL.8'                                       00265600
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00265700
.*                                                                      00265800
&ZOPN                 SETA  &ZOPN+1                                     00265900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_JPA'                       00266000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00266100
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             00266200
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00266300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).JPA'                          00266400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00266500
.*                                                                      00266600
&ZOPN                 SETA  &ZOPN+1                                     00266700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_LPA'                       00266800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00266900
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             00267000
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00267100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).LPA'                          00267200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00267300
.*                                                                      00267400
&ZOPN                 SETA  &ZOPN+1                                     00267500
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_TASKLOAD'                  00267600
&ZOPO(&ZOPN)          SETC  'EQU'                                       00267700
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             00267800
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00267900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TASKLOAD'                     00268000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00268100
.*                                                                      00268200
&ZOPN                 SETA  &ZOPN+1                                     00268300
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_TASKALL'                   00268400
&ZOPO(&ZOPN)          SETC  'EQU'                                       00268500
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             00268600
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00268700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).TASKALL'                      00268800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00268900
.*                                                                      00269000
&ZOPN                 SETA  &ZOPN+1                                     00269100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XFUNC_RB'                        00269200
&ZOPO(&ZOPN)          SETC  'EQU'                                       00269300
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             00269400
&ZOPD(&ZOPN)          SETC  '++ XFUNC.'                                 00269500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RB'                           00269600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00269700
.*                                                                      00269800
&ZOPN                 SETA  &ZOPN+1                                     00269900
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XENV_MVS'                        00270000
&ZOPO(&ZOPN)          SETC  'EQU'                                       00270100
&ZOPV(&ZOPN)          SETC  'B''00000100'''                             00270200
&ZOPD(&ZOPN)          SETC  '++ XENV.'                                  00270300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MVS'                          00270400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00270500
.*                                                                      00270600
&ZOPN                 SETA  &ZOPN+1                                     00270700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XENV_IPCS'                       00270800
&ZOPO(&ZOPN)          SETC  'EQU'                                       00270900
&ZOPV(&ZOPN)          SETC  'B''00000010'''                             00271000
&ZOPD(&ZOPN)          SETC  '++ XENV.'                                  00271100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).IPCS'                         00271200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00271300
.*-------------------------------------------------------------------   00271400
.***AM.L09  XASID BL.16                                                 00271500
&ZOPN                 SETA &ZOPN+1                                      00271600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XASID'                            00271700
&ZOPO(&ZOPN)          SETC 'DS'                                         00271800
&ZOPV(&ZOPN)          SETC 'BL.16'                                      00271900
&ZOPD(&ZOPN)          SETC '++ &ZXASID '                                00272000
.*-------------------------------------------------------------------   00272100
.***AM.L09  XABDPLPTR A                                                 00272200
&ZOPN                 SETA &ZOPN+1                                      00272300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XABDPLPTR'                        00272400
&ZOPO(&ZOPN)          SETC 'DS'                                         00272500
&ZOPV(&ZOPN)          SETC 'A'                                          00272600
&ZOPD(&ZOPN)          SETC '++ &ZXABDPLPTR '                            00272700
.*-------------------------------------------------------------------   00272800
.***AM.L09  XRSVCPL2 CL04                                               00272900
&ZOPN                 SETA &ZOPN+1                                      00273000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVCPL2'                         00273100
&ZOPO(&ZOPN)          SETC 'DS'                                         00273200
&ZOPV(&ZOPN)          SETC 'CL04'                                       00273300
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00273400
.*-------------------------------------------------------------------   00273500
.***AM.L09  XRSVCPL3 CL04                                               00273600
&ZOPN                 SETA &ZOPN+1                                      00273700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSVCPL3'                         00273800
&ZOPO(&ZOPN)          SETC 'DS'                                         00273900
&ZOPV(&ZOPN)          SETC 'CL04'                                       00274000
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00274100
.*-------------------------------------------------------------------   00274200
.***AM.L09  XMIPR A                                                     00274300
&ZOPN                 SETA &ZOPN+1                                      00274400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMIPR'                            00274500
&ZOPO(&ZOPN)          SETC 'DS'                                         00274600
&ZOPV(&ZOPN)          SETC 'A'                                          00274700
&ZOPD(&ZOPN)          SETC '++ &ZXMIPR '                                00274800
.*-------------------------------------------------------------------   00274900
.***AM.L09  XUSERDATA CL16                                              00275000
&ZOPN                 SETA &ZOPN+1                                      00275100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XUSERDATA'                        00275200
&ZOPO(&ZOPN)          SETC 'DS'                                         00275300
&ZOPV(&ZOPN)          SETC 'CL16'                                       00275400
&ZOPD(&ZOPN)          SETC '++ &ZXUSERDATA '                            00275500
.*-------------------------------------------------------------------   00275600
.***AM.L09  XTCBADDR A                                                  00275700
&ZOPN                 SETA &ZOPN+1                                      00275800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XTCBADDR'                         00275900
&ZOPO(&ZOPN)          SETC 'DS'                                         00276000
&ZOPV(&ZOPN)          SETC 'A'                                          00276100
&ZOPD(&ZOPN)          SETC '++ &ZXTCBADDR '                             00276200
.*-------------------------------------------------------------------   00276300
.***AM.L09  XRBADDR A                                                   00276400
&ZOPN                 SETA &ZOPN+1                                      00276500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRBADDR'                          00276600
&ZOPO(&ZOPN)          SETC 'DS'                                         00276700
&ZOPV(&ZOPN)          SETC 'A'                                          00276800
&ZOPD(&ZOPN)          SETC '++ &ZXRBADDR '                              00276900
.*-------------------------------------------------------------------   00277000
.***AM.L10 END OF CSVINFO LIST PARAMETERS                               00277100
&ZOPN                 SETA &ZOPN+1                                      00277200
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00277300
&ZOPO(&ZOPN)          SETC 'EQU'                                        00277400
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00277500
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00277600
.*                                                                      00277700
&ZOPN                 SETA &ZOPN+1                                      00277800
&ZOPL(&ZOPN)          SETC ' '                                          00277900
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00278000
&ZOPV(&ZOPN)          SETC '1'                                          00278100
&ZOPD(&ZOPN)          SETC ' '                                          00278200
.*-------------------------------------------------------------------   00278300
.***AL.L12 CSVINFO FMT=LIST MF=S!L PARAMETERS                           00278400
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00278500
.*                                                                      00278600
&ZOPN                 SETA  &ZOPN+1                                     00278700
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00278800
&ZOPO(&ZOPN)          SETC  'DC'                                        00278900
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00279000
&ZOPD(&ZOPN)          SETC  '++ CSVINFO ARG PARMS'                      00279100
.*                                                                      00279200
.ZLMFSLX              ANOP  ,                                           00279300
.*-------------------------------------------------------------------   00279400
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00279500
&ZPLLEN               SETA 44                                           00279600
.*                                                                      00279700
.******************************************************************     00279800
.***AI.L01 CSVINFO FMT=LIST FILL IN PARAMETER AREA                      00279900
.******************************************************************     00280000
                      ACTR  10000                                       00280100
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00280200
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00280300
&ZCVAL                SETC  'LAE'          XAX MODE                     00280400
.ZIMFXA               ANOP ,                                            00280500
.*                                                                      00280600
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00280700
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00280800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00280900
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00281000
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00281100
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00281200
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00281300
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00281400
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00281500
&ZOPN                 SETA  &ZOPN+1                                     00281600
&ZOPL(&ZOPN)          SETC  ' '                                         00281700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00281800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00281900
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00282000
                      AGO   .ZIMFNX                                     00282100
.*                                                                      00282200
.ZIMFN2               ANOP ,                                            00282300
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00282400
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00282500
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00282600
&ZOPN                 SETA  &ZOPN+1                                     00282700
&ZOPL(&ZOPN)          SETC  ' '                                         00282800
&ZOPO(&ZOPN)          SETC  'LAE'                                       00282900
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00283000
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00283100
                      AGO   .ZIMFNX                                     00283200
.ZIMFNX1              ANOP ,                                            00283300
&ZOPN                 SETA  &ZOPN+1                                     00283400
&ZOPL(&ZOPN)          SETC  ' '                                         00283500
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00283600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00283700
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00283800
.ZIMFNX               ANOP ,                                            00283900
.********************************************************************   00284000
.***AI.L02 CSVINFO FMT=LIST INITIALIZE PARAMETER AREA                   00284100
.********************************************************************   00284200
.***AI.L03 MF=(SLME)                                                    00284300
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00284400
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00284500
.*                                                                      00284600
&ZOPN                 SETA  &ZOPN+1                                     00284700
&ZOPL(&ZOPN)          SETC  ' '                                         00284800
&ZOPO(&ZOPN)          SETC  'XC'                                        00284900
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00285000
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00285100
.ZIMFLX               ANOP  ,                                           00285200
.*-------------------------------------------------------------------   00285300
.***AI.L05 XFLAGS1 BL1                                                  00285400
&ZW                   SETC  ''                                          00285500
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00285600
&ZMS                  SETC  ''                                          00285700
&ZC                   SETC  ''                                          00285800
.*-------------------------------------------------------------------   00285900
.***AI.L08 XFLAGS1 "JPA"                                                00286000
.***      BL1'1XXXXXXX'                                                 00286100
         AIF   ('&XFUNC' NE 'JPA').ZI3A                                 00286200
&ZW                   SETC  '&ZW.1'                                     00286300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00286400
&ZMS                  SETC  '&ZMS.1'                                    00286500
                      AGO   .ZI3C                                       00286600
.*                                                                      00286700
.ZI3A                 ANOP  ,                                           00286800
&ZW                   SETC  '&ZW.0'                                     00286900
         AIF   ('&ZXFUNC' EQ '').ZI3B                                   00287000
&ZMS                  SETC  '&ZMS.0'                                    00287100
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00287200
                      AGO   .ZI3C                                       00287300
.*                                                                      00287400
.ZI3B                 ANOP  ,                                           00287500
&ZMS                  SETC  '&ZMS.1'                                    00287600
.ZI3C                 ANOP  ,                                           00287700
.*-------------------------------------------------------------------   00287800
.***AI.L08 XFLAGS1 "LPA"                                                00287900
.***      BL1'X1XXXXXX'                                                 00288000
         AIF   ('&XFUNC' NE 'LPA').ZI4A                                 00288100
&ZW                   SETC  '&ZW.1'                                     00288200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00288300
&ZMS                  SETC  '&ZMS.1'                                    00288400
                      AGO   .ZI4C                                       00288500
.*                                                                      00288600
.ZI4A                 ANOP  ,                                           00288700
&ZW                   SETC  '&ZW.0'                                     00288800
         AIF   ('&ZXFUNC' EQ '').ZI4B                                   00288900
&ZMS                  SETC  '&ZMS.0'                                    00289000
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00289100
                      AGO   .ZI4C                                       00289200
.*                                                                      00289300
.ZI4B                 ANOP  ,                                           00289400
&ZMS                  SETC  '&ZMS.1'                                    00289500
.ZI4C                 ANOP  ,                                           00289600
.*-------------------------------------------------------------------   00289700
.***AI.L08 XFLAGS1 "TASKLOAD"                                           00289800
.***      BL1'XX1XXXXX'                                                 00289900
         AIF   ('&XFUNC' NE 'TASKLOAD').ZI5A                            00290000
&ZW                   SETC  '&ZW.1'                                     00290100
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00290200
&ZMS                  SETC  '&ZMS.1'                                    00290300
                      AGO   .ZI5C                                       00290400
.*                                                                      00290500
.ZI5A                 ANOP  ,                                           00290600
&ZW                   SETC  '&ZW.0'                                     00290700
         AIF   ('&ZXFUNC' EQ '').ZI5B                                   00290800
&ZMS                  SETC  '&ZMS.0'                                    00290900
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00291000
                      AGO   .ZI5C                                       00291100
.*                                                                      00291200
.ZI5B                 ANOP  ,                                           00291300
&ZMS                  SETC  '&ZMS.1'                                    00291400
.ZI5C                 ANOP  ,                                           00291500
.*-------------------------------------------------------------------   00291600
.***AI.L08 XFLAGS1 "TASKALL"                                            00291700
.***      BL1'XXX1XXXX'                                                 00291800
         AIF   ('&XFUNC' NE 'TASKALL').ZI6A                             00291900
&ZW                   SETC  '&ZW.1'                                     00292000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00292100
&ZMS                  SETC  '&ZMS.1'                                    00292200
                      AGO   .ZI6C                                       00292300
.*                                                                      00292400
.ZI6A                 ANOP  ,                                           00292500
&ZW                   SETC  '&ZW.0'                                     00292600
         AIF   ('&ZXFUNC' EQ '').ZI6B                                   00292700
&ZMS                  SETC  '&ZMS.0'                                    00292800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00292900
                      AGO   .ZI6C                                       00293000
.*                                                                      00293100
.ZI6B                 ANOP  ,                                           00293200
&ZMS                  SETC  '&ZMS.1'                                    00293300
.ZI6C                 ANOP  ,                                           00293400
.*-------------------------------------------------------------------   00293500
.***AI.L08 XFLAGS1 "RB"                                                 00293600
.***      BL1'XXXX1XXX'                                                 00293700
         AIF   ('&XFUNC' NE 'RB').ZI7A                                  00293800
&ZW                   SETC  '&ZW.1'                                     00293900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00294000
&ZMS                  SETC  '&ZMS.1'                                    00294100
                      AGO   .ZI7C                                       00294200
.*                                                                      00294300
.ZI7A                 ANOP  ,                                           00294400
&ZW                   SETC  '&ZW.0'                                     00294500
         AIF   ('&ZXFUNC' EQ '').ZI7B                                   00294600
&ZMS                  SETC  '&ZMS.0'                                    00294700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00294800
                      AGO   .ZI7C                                       00294900
.*                                                                      00295000
.ZI7B                 ANOP  ,                                           00295100
&ZMS                  SETC  '&ZMS.1'                                    00295200
.ZI7C                 ANOP  ,                                           00295300
.*-------------------------------------------------------------------   00295400
.***AI.L08 XFLAGS1 "MVS"                                                00295500
.***      BL1'XXXXX1XX'                                                 00295600
         AIF   ('&XENV' NE 'MVS').ZI8A                                  00295700
&ZW                   SETC  '&ZW.1'                                     00295800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00295900
&ZMS                  SETC  '&ZMS.1'                                    00296000
                      AGO   .ZI8C                                       00296100
.*                                                                      00296200
.ZI8A                 ANOP  ,                                           00296300
&ZW                   SETC  '&ZW.0'                                     00296400
         AIF   ('&ZXENV' EQ '').ZI8B                                    00296500
&ZMS                  SETC  '&ZMS.0'                                    00296600
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00296700
                      AGO   .ZI8C                                       00296800
.*                                                                      00296900
.ZI8B                 ANOP  ,                                           00297000
&ZMS                  SETC  '&ZMS.1'                                    00297100
.ZI8C                 ANOP  ,                                           00297200
.*-------------------------------------------------------------------   00297300
.***AI.L08 XFLAGS1 "IPCS"                                               00297400
.***      BL1'XXXXXX1X'                                                 00297500
         AIF   ('&XENV' NE 'IPCS').ZI9A                                 00297600
&ZW                   SETC  '&ZW.10'                                    00297700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00297800
&ZMS                  SETC  '&ZMS.11'                                   00297900
                      AGO   .ZI9C                                       00298000
.*                                                                      00298100
.ZI9A                 ANOP  ,                                           00298200
&ZW                   SETC  '&ZW.00'                                    00298300
         AIF   ('&ZXENV' EQ '').ZI9B                                    00298400
&ZMS                  SETC  '&ZMS.01'                                   00298500
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00298600
                      AGO   .ZI9C                                       00298700
.*                                                                      00298800
.ZI9B                 ANOP  ,                                           00298900
&ZMS                  SETC  '&ZMS.11'                                   00299000
.ZI9C                 ANOP  ,                                           00299100
.*-------------------------------------------------------------------   00299200
.***AI.L11 XFLAGS1 BL1                                                  00299300
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI9D               00299400
                      AIF   ('&ZC' NE 'YES').ZI9D                       00299500
&ZOPN                 SETA  &ZOPN+1                                     00299600
&ZOPL(&ZOPN)          SETC  ' '                                         00299700
&ZOPO(&ZOPN)          SETC  'NI'                                        00299800
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZMS'''                            00299900
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00300000
.ZI9D                 ANOP  ,                                           00300100
                      AIF   ('&ZCLNG' NE 'YES').ZI9E  ALL ZERO BITS     00300200
&ZOPN                 SETA  &ZOPN+1                                     00300300
&ZOPL(&ZOPN)          SETC  ' '                                         00300400
&ZOPO(&ZOPN)          SETC  'OI'                                        00300500
&ZOPV(&ZOPN)          SETC  '1(1),B''&ZW'''                             00300600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              00300700
.ZI9E                 ANOP  ,                                           00300800
.*-------------------------------------------------------------------   00300900
.***AI.L25  XASID XL2                                                   00301000
                      AIF   ('&ZXASID' EQ '').ZI10E                     00301100
                      AIF   ('&ZXASID' EQ 'OUTPUT').ZI10E               00301200
&ZCGPR                SETC  '&XASID'                                    00301300
.*                                                                      00301400
                      AIF   ('&XASID'(1,1) NE '(').ZI10B                00301500
&ZCGPR   SETC  '0('.'&XASID'(2,K'&XASID-2).')'                          00301600
                      AGO   .ZI10D                                      00301700
.ZI10B                ANOP  ,                                           00301800
.*                                                                      00301900
&ZC                   SETC  '&XASID'(1,1)                               00302000
                      AIF   (T'&ZC NE 'N').ZI10D                        00302100
&ZC                   SETC  '&XASID'                                    00302200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI10D               00302300
&ZCGPR                SETC  '=BL2''&XASID'''                            00302400
.*                                                                      00302500
.ZI10D                ANOP  ,                                           00302600
.*                                                                      00302700
&ZOPN                 SETA  &ZOPN+1                                     00302800
&ZOPL(&ZOPN)          SETC  ' '                                         00302900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00303000
&ZOPV(&ZOPN)          SETC  '2(2,1),&ZCGPR'                             00303100
&ZOPD(&ZOPN)          SETC  '++ &ZXASID XASID'                          00303200
.*                                                                      00303300
.ZI10E                ANOP  ,                                           00303400
.*-------------------------------------------------------------------   00303500
.***AI.L25  XABDPLPTR AL4                                               00303600
                      AIF   ('&ZXABDPLPTR' EQ '').ZI11E                 00303700
                      AIF   ('&ZXABDPLPTR' EQ 'OUTPUT').ZI11E           00303800
&ZCGPR                SETC  '&XABDPLPTR'                                00303900
.*                                                                      00304000
                      AIF   ('&XABDPLPTR'(1,1) NE '(').ZI11B            00304100
&ZCGPR   SETC  '0('.'&XABDPLPTR'(2,K'&XABDPLPTR-2).')'                  00304200
                      AGO   .ZI11D                                      00304300
.ZI11B                ANOP  ,                                           00304400
.*                                                                      00304500
&ZC                   SETC  '&XABDPLPTR'(1,1)                           00304600
                      AIF   (T'&ZC NE 'N').ZI11D                        00304700
&ZC                   SETC  '&XABDPLPTR'                                00304800
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI11D               00304900
&ZCGPR                SETC  '=AL4(&XABDPLPTR)'                          00305000
.*                                                                      00305100
.ZI11D                ANOP  ,                                           00305200
.*                                                                      00305300
&ZOPN                 SETA  &ZOPN+1                                     00305400
&ZOPL(&ZOPN)          SETC  ' '                                         00305500
&ZOPO(&ZOPN)          SETC  'MVC'                                       00305600
&ZOPV(&ZOPN)          SETC  '4(4,1),&ZCGPR'                             00305700
&ZOPD(&ZOPN)          SETC  '++ &ZXABDPLPTR XABDPLPTR'                  00305800
.*                                                                      00305900
.ZI11E                ANOP  ,                                           00306000
.*-------------------------------------------------------------------   00306100
.***AI.L19  XMIPR A                                                     00306200
                      AIF   ('&ZXMIPR' EQ '').ZI14H                     00306300
&ZCLNG                SETC  '&XMIPR'                                    00306400
&ZCGPR                SETC  '14'                                        00306500
         AIF   ('&XMIPR'(1,1) EQ '(').ZI14F  IN GPR                     00306600
.*                                                                      00306700
&ZOPN                 SETA  &ZOPN+1                                     00306800
&ZOPL(&ZOPN)          SETC  ' '                                         00306900
&ZOPO(&ZOPN)          SETC  'LA'                                        00307000
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00307100
&ZOPD(&ZOPN)          SETC  '++ &ZXMIPR XMIPR'                          00307200
.*                                                                      00307300
                      AGO   .ZI14G                                      00307400
.*                                                                      00307500
.ZI14F                ANOP  ,                                           00307600
&ZCGPR   SETC  '&XMIPR'(2,K'&XMIPR-2)                                   00307700
.*                                                                      00307800
.ZI14G                ANOP  ,                                           00307900
.*                                                                      00308000
&ZOPN                 SETA  &ZOPN+1                                     00308100
&ZOPL(&ZOPN)          SETC  ' '                                         00308200
&ZOPO(&ZOPN)          SETC  'ST'                                        00308300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,16(,1)'                             00308400
&ZOPD(&ZOPN)          SETC  '++ &ZXMIPR XMIPR'                          00308500
.*                                                                      00308600
.ZI14H                ANOP  ,                                           00308700
.*-------------------------------------------------------------------   00308800
.***AI.L18  XUSERDATA CL16                                              00308900
         AIF   ('&XUSERDATA' NE 'NULL').ZI15                            00309000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI15  CK *        00309100
&ZXUSERDATA           SETC  ''             RESET INPUT/OUTPUT           00309200
.ZI15                 ANOP  ,                                           00309300
.*-------------------------------------------------------------------   00309400
.***AI.L25  XUSERDATA CL16                                              00309500
                      AIF   ('&ZXUSERDATA' EQ '').ZI15E                 00309600
                      AIF   ('&ZXUSERDATA' EQ 'OUTPUT').ZI15E           00309700
&ZCGPR                SETC  '&XUSERDATA'                                00309800
         AIF   ('&XUSERDATA' NE 'NULL').ZI15A                           00309900
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI15E                          00310000
.*                                                                      00310100
&ZCGPR                SETC  '=XL16''00'''                               00310200
.ZI15A                ANOP  ,                                           00310300
.*                                                                      00310400
&ZOPN                 SETA  &ZOPN+1                                     00310500
&ZOPL(&ZOPN)          SETC  ' '                                         00310600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00310700
&ZOPV(&ZOPN)          SETC  '20(16,1),&ZCGPR'                           00310800
&ZOPD(&ZOPN)          SETC  '++ &ZXUSERDATA XUSERDATA'                  00310900
.*                                                                      00311000
.ZI15E                ANOP  ,                                           00311100
.*-------------------------------------------------------------------   00311200
.***AI.L25  XTCBADDR AL4                                                00311300
                      AIF   ('&ZXTCBADDR' EQ '').ZI16E                  00311400
                      AIF   ('&ZXTCBADDR' EQ 'OUTPUT').ZI16E            00311500
&ZCGPR                SETC  '&XTCBADDR'                                 00311600
.*                                                                      00311700
                      AIF   ('&XTCBADDR'(1,1) NE '(').ZI16B             00311800
&ZCGPR   SETC  '0('.'&XTCBADDR'(2,K'&XTCBADDR-2).')'                    00311900
                      AGO   .ZI16D                                      00312000
.ZI16B                ANOP  ,                                           00312100
.*                                                                      00312200
&ZC                   SETC  '&XTCBADDR'(1,1)                            00312300
                      AIF   (T'&ZC NE 'N').ZI16D                        00312400
&ZC                   SETC  '&XTCBADDR'                                 00312500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI16D               00312600
&ZCGPR                SETC  '=AL4(&XTCBADDR)'                           00312700
.*                                                                      00312800
.ZI16D                ANOP  ,                                           00312900
.*                                                                      00313000
&ZOPN                 SETA  &ZOPN+1                                     00313100
&ZOPL(&ZOPN)          SETC  ' '                                         00313200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00313300
&ZOPV(&ZOPN)          SETC  '36(4,1),&ZCGPR'                            00313400
&ZOPD(&ZOPN)          SETC  '++ &ZXTCBADDR XTCBADDR'                    00313500
.*                                                                      00313600
.ZI16E                ANOP  ,                                           00313700
.*-------------------------------------------------------------------   00313800
.***AI.L25  XRBADDR AL4                                                 00313900
                      AIF   ('&ZXRBADDR' EQ '').ZI17E                   00314000
                      AIF   ('&ZXRBADDR' EQ 'OUTPUT').ZI17E             00314100
&ZCGPR                SETC  '&XRBADDR'                                  00314200
.*                                                                      00314300
                      AIF   ('&XRBADDR'(1,1) NE '(').ZI17B              00314400
&ZCGPR   SETC  '0('.'&XRBADDR'(2,K'&XRBADDR-2).')'                      00314500
                      AGO   .ZI17D                                      00314600
.ZI17B                ANOP  ,                                           00314700
.*                                                                      00314800
&ZC                   SETC  '&XRBADDR'(1,1)                             00314900
                      AIF   (T'&ZC NE 'N').ZI17D                        00315000
&ZC                   SETC  '&XRBADDR'                                  00315100
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI17D               00315200
&ZCGPR                SETC  '=AL4(&XRBADDR)'                            00315300
.*                                                                      00315400
.ZI17D                ANOP  ,                                           00315500
.*                                                                      00315600
&ZOPN                 SETA  &ZOPN+1                                     00315700
&ZOPL(&ZOPN)          SETC  ' '                                         00315800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00315900
&ZOPV(&ZOPN)          SETC  '40(4,1),&ZCGPR'                            00316000
&ZOPD(&ZOPN)          SETC  '++ &ZXRBADDR XRBADDR'                      00316100
.*                                                                      00316200
.ZI17E                ANOP  ,                                           00316300
.*-------------------------------------------------------------------   00316400
&ZOPN1                SETA &ZOPN                                        00316500
.*-------------------------------------------------------------------   00316600
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00316700
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00316800
.*******************************************************************    00316900
.***  PROCESS CSVINFO OUTPUT PARAMETERS                                 00317000
.*******************************************************************    00317100
                      ACTR  10000                                       00317200
.*******************************************************************    00317300
.***AO.X02  RETURN CODE PROCESSING                                      00317400
.*******************************************************************    00317500
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00317600
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00317700
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00317800
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00317900
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00318000
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00318100
&ZOPN                 SETA  &ZOPN+1                                     00318200
&ZOPL(&ZOPN)          SETC  ' '                                         00318300
&ZOPO(&ZOPN)          SETC  'ST'                                        00318400
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00318500
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00318600
                      AGO   .ZMRETX                                     00318700
.*                                                                      00318800
.ZMRET2               ANOP  ,                                           00318900
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00319000
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00319100
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00319200
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00319300
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00319400
&ZOPN                 SETA  &ZOPN+1                                     00319500
&ZOPL(&ZOPN)          SETC  ' '                                         00319600
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00319700
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00319800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00319900
.ZMRETX               ANOP  ,                                           00320000
.*******************************************************************    00320100
.***AO.X03  REASON CODE PROCESSING                                      00320200
.*******************************************************************    00320300
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00320400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00320500
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00320600
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00320700
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00320800
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00320900
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00321000
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00321100
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00321200
&ZOPN                 SETA  &ZOPN+1                                     00321300
&ZOPL(&ZOPN)          SETC  ' '                                         00321400
&ZOPO(&ZOPN)          SETC  'ST'                                        00321500
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00321600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00321700
                      AGO   .ZMRSNX                                     00321800
.*                                                                      00321900
.ZMRSN2               ANOP  ,                                           00322000
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00322100
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00322200
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00322300
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00322400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00322500
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00322600
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00322700
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00322800
&ZOPN                 SETA  &ZOPN+1                                     00322900
&ZOPL(&ZOPN)          SETC  ' '                                         00323000
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00323100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00323200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00323300
.ZMRSNX               ANOP  ,                                           00323400
.*******************************************************************    00323500
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00323600
.*******************************************************************    00323700
.ZMFLX                ANOP  ,              MF=L PROCESSING              00323800
.*******************************************************************    00323900
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00324000
.*******************************************************************    00324100
                      ACTR  10000                                       00324200
.*                                                                      00324300
                      LCLA  &ZLC           COLUMN POSITION              00324400
                      LCLA  &ZOPX          LIST TABLE INDEX             00324500
                      LCLC  &ZLL           LABEL                        00324600
                      LCLC  &ZLOP          OPERATION                    00324700
                      LCLC  &ZLV           VALUE                        00324800
                      LCLC  &ZLD           DESCRIPTION                  00324900
.*                                                                      00325000
&ZOPX                 SETA  1                                           00325100
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00325200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00325300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00325400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00325500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00325600
                      AIF   (K'&ZLD LE 0).ZL5                           00325700
&ZLC                  SETA  35             COMMENT COLUMN               00325800
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00325900
&ZLC                  SETA  33             COMMMENT COLUMN              00326000
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00326100
&ZLV                  SETC  '&ZLV'.' '                                  00326200
                      AGO   .ZL3                                        00326300
.*                                                                      00326400
.ZL4                  ANOP  ,                                           00326500
&ZLV                  SETC  '&ZLV'.' '                                  00326600
.ZL5                  ANOP  ,                                           00326700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00326800
.*                                                                      00326900
&ZLL     &ZLOP &ZLV                                                     00327000
.*                                                                      00327100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00327200
                      AGO   .ZL2           CONTINUE LOOPING             00327300
.*                                                                      00327400
.ZLX                  ANOP  ,                                           00327500
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00327600
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00327700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00327800
         AIF  ('&SYSAM64' NE 'YES').AM31641                             00327900
         MNOTE 12,'CSVINFO ---> NOT VALID IN AMODE 64'                  00328000
.AM31641 ANOP                                                           00328100
&CSVABDP SETC '&XMFCTRL._XABDPLPTR-&XMFCTRL.(0,1)'                      00328200
.*                                                                @PxC  00328300
&CSVCPL2 SETC '&XMFCTRL._XRSVCPL2-&XMFCTRL.(0,1)'                       00328400
.*                                                                @PxC  00328500
&CSVCPL3 SETC '&XMFCTRL._XRSVCPL3-&XMFCTRL.(0,1)'                       00328600
.*                                                                @PxC  00328700
                      AIF   ('&XENV'(1,3) NE 'MVS').CSVIPCS             00328800
.*------------------------------------ ENV(MVS) linkage -------         00328900
         ST   1,&CSVCPL3           Set up ptr to parameter structure    00329000
.*                                                                @P1A  00329100
         LA   1,&CSVCPL3           Set R1 to addr of parmlist pointer   00329200
.*                                                                @P1A  00329300
         L    14,16(0,0)           Get CVT address                      00329400
         L    14,140(,14)          Get ECVT address (CVTECVT)           00329500
         L    14,228(,14)                                               00329600
         L    15,20(,14)                                                00329700
         BALR 14,15                Call CSVINFO service                 00329800
                      AGO   .CSVEND                                     00329900
.CSVIPCS              ANOP  ,                                           00330000
.*-------------------------------- If in IPCS environment               00330100
.*                                 --- ENV(IPCS ) ---                   00330200
         L    14,4(1,0)            Get temp ABDPL addressability        00330300
.*                                                                @P1A  00330400
         ST   1,&CSVCPL3           ADPLSERV parm 3 = @ of CSVINFO parms 00330500
.*                                                                @P1C  00330600
         LA   15,=A(ADPLSCSI)      Address of word containing service#  00330700
.*                                                                @PxC  00330800
         ST   15,&CSVCPL2          Save it as ADPLSERV parameter 2      00330900
.*                                                                @P1C  00331000
         LA   1,&CSVABDP           Set R1 = addr(ADPLSERV parmlist)     00331100
         L    15,ADPLSERV-ABDPL(14) Get address of ADPLSERV routine     00331200
.*                                                                @P1C  00331300
         BALR 14,15                Call ADPLESRV router routine         00331400
.CSVEND               ANOP  ,                                           00331500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00331600
.ZLINKX               ANOP  ,                                           00331700
.*******************************************************************    00331800
.***AP.X01  FORMAT GENERATED CODE                                       00331900
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00332000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00332100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00332200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00332300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00332400
                      AIF   (K'&ZLD LE 0).ZL51                          00332500
&ZLC                  SETA  35             COMMENT COLUMN               00332600
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00332700
&ZLC                  SETA  33             COMMENT COLUMN               00332800
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00332900
&ZLV                  SETC  '&ZLV'.' '                                  00333000
                      AGO   .ZL31                                       00333100
.*                                                                      00333200
.ZL41                 ANOP  ,                                           00333300
&ZLV                  SETC  '&ZLV'.' '                                  00333400
.ZL51                 ANOP  ,                                           00333500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00333600
.*                                                                      00333700
&ZLL     &ZLOP &ZLV                                                     00333800
.*                                                                      00333900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00334000
                      AGO   .ZL21          CONTINUE LOOPING             00334100
.*                                                                      00334200
.ZLX1                 ANOP  ,                                           00334300
.*******************************************************************    00334400
.***AP.X02  END OF CSVINFO MACRO                                        00334500
&ZCSVINFO             SETC  'YES'          SET CSVINFO USED             00334600
         POP   PRINT                                                    00334700
*                                            CSVINFO-0                  00334800
         SPACE 1                                                        00334900
.ZLX2                 ANOP  ,                                           00335000
         MEND                                                           00335100
**********************************************************************/ 00335200
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00335300
*%CSVINFO: MACRO KEYS(FUNC,TCBADDR,RBADDR,ENV,ABDPLPTR,ASID,MIPR,       00335400
*                 USERDATA,RETCODE,RSNCODE,COM,PLISTVER,MF);            00335500
*  ANS('?'!!MACLABEL!!' '!!'CSVINFOP '!!MACLIST!!                       00335600
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00335700
*%END CSVINFO;                                                          00335800

*/**** START OF SPECIFICATIONS **************************************** 00000100
*                                                                     * 00000200
*                                                                     * 00000300
*01* MACRO NAME:  HZSPREAD                              -07/10/15-<0> * 00000400
*                                                                     * 00000500
*                                                                     * 00000600
*01* DESCRIPTIVE NAME:  Read Check Persistent Data                    * 00000700
*                                                                     * 00000800
*01* PROPRIETARY STATEMENT:                                           * 00000900
*                                                                     * 00001000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00001100
*     5694-A01 COPYRIGHT IBM CORP. 2005, 2010                         * 00001200
*                                                                     * 00001300
* STATUS= HBB7770                                                     * 00001400
*                                                                     * 00001500
*                                                                     * 00001600
*                                                                     * 00001700
*01* FUNCTION:                                                        * 00001800
*                                                                     * 00001900
*      The HZSPREAD macro is an interface used by check routines to   * 00002000
*      read data that has been preserved in the IBM Health Checker    * 00002100
*      for z/OS Persistent Data data set, which is allocated using    * 00002200
*      the HZSPDATA ddname in the startup proc or via the HZSPDATA    * 00002300
*      statement in a HZSPRMxx parmlib member. Two groups of data are * 00002400
*      preserved for an IPL, the first and the most recent.           * 00002500
*                                                                     * 00002600
*01* EXTERNAL CLASSIFICATION:  PI                                     * 00002700
*                                                                     * 00002800
*01* END OF EXTERNAL CLASSIFICATION:                                  * 00002900
*                                                                     * 00003000
*01* ENVIRONMENT:                                                     * 00003100
*                                                                     * 00003200
*                                                                     * 00003300
*      Minimum authorization: Problem state.  PSW key 8-15.           * 00003400
*                                                                     * 00003500
*                        When problem state and key 8-15 and not APF  * 00003600
*                        authorized, or when SECCHECK=ALL is          * 00003700
*                        specified, the caller must be authorized for * 00003800
*                        read access to either of the following:      * 00003900
*                                                                     * 00004000
*                                                                     * 00004100
*                        o   XFACILIT class resource                  * 00004200
*                            HZS.sysname.checkowner.PDATA             * 00004300
*                                                                     * 00004400
*                        o   XFACILIT class resource                  * 00004500
*                            HZS.sysname.checkowner.checkname.PDATA   * 00004600
*                                                                     * 00004700
*                                                                     * 00004800
*                                                                     * 00004900
*      Dispatchable unit mode: Task mode.                             * 00005000
*                                                                     * 00005100
*      Cross Memory Mode: PASN=HASN=SASN.                             * 00005200
*                                                                     * 00005300
*      AMODE:            31- or 64-bit.                               * 00005400
*                                                                     * 00005500
*                        If in AMODE 64, specify SYSSTATE AMODE64=YES * 00005600
*                        before invoking this macro.                  * 00005700
*                                                                     * 00005800
*      ASC mode:         Primary or Access Register.                  * 00005900
*                                                                     * 00006000
*                        If in Access Register ASC mode, specify      * 00006100
*                        SYSSTATE ASCENV=AR before invoking this      * 00006200
*                        macro.                                       * 00006300
*                                                                     * 00006400
*      Interrupt status: Enabled for I/O and external interrupts.     * 00006500
*                                                                     * 00006600
*      Locks:            No locks held.                               * 00006700
*                                                                     * 00006800
*      Control parameters: Control parameters must be in the primary  * 00006900
*                        address space or, for AR-mode callers, must  * 00007000
*                        be in an address/data space that is          * 00007100
*                        addressable through a public entry on the    * 00007200
*                        caller's dispatchable unit access list       * 00007300
*                        (DU-AL).  Control parameters must be below   * 00007400
*                        2G.                                          * 00007500
*                                                                     * 00007600
*                        The user-provided buffer (via BUFFER) has    * 00007700
*                        the same requirements and restrictions as    * 00007800
*                        the control parameters.                      * 00007900
*                                                                     * 00008000
*                                                                     * 00008100
*                                                                     * 00008200
*01* PROGRAMMING REQUIREMENTS:                                        * 00008300
*                                                                     * 00008400
*                                                                     * 00008500
*    o   This service is supported only when it is called from a      * 00008600
*        check routine invoked by IBM Health Checker for z/OS.        * 00008700
*                                                                     * 00008800
*                                                                     * 00008900
*                                                                     * 00009000
*01* RESTRICTIONS:                                                    * 00009100
*                                                                     * 00009200
*    The caller may not have an FRR established.                      * 00009300
*                                                                     * 00009400
*01* INPUT REGISTER INFORMATION:                                      * 00009500
*                                                                     * 00009600
*    Before issuing the HZSPREAD macro, the caller does not have to   * 00009700
*    place any information into any register unless using it in       * 00009800
*    register notation for a particular parameter, or using it as a   * 00009900
*    base register.                                                   * 00010000
*                                                                     * 00010100
*    Before issuing the HZSPREAD macro, the caller does not have to   * 00010200
*    place any information into any AR unless using it in register    * 00010300
*    notation for a particular parameter, or using it as a base       * 00010400
*    register.                                                        * 00010500
*                                                                     * 00010600
*01* OUTPUT REGISTER INFORMATION:                                     * 00010700
*                                                                     * 00010800
*    When control returns to the caller, the GPRs contain:            * 00010900
*                                                                     * 00011000
*                                                                     * 00011100
*    REGISTER  CONTENTS                                               * 00011200
*                                                                     * 00011300
*    0         Reason code, when register 15 is not 0.  Otherwise,    * 00011400
*              used as a work register by the system                  * 00011500
*                                                                     * 00011600
*    1         Used as a work register by the system                  * 00011700
*                                                                     * 00011800
*    2-13      Unchanged                                              * 00011900
*                                                                     * 00012000
*    14        Used as a work register by the system                  * 00012100
*                                                                     * 00012200
*    15        Return code                                            * 00012300
*                                                                     * 00012400
*                                                                     * 00012500
*                                                                     * 00012600
*    When control returns to the caller, the ARs contain:             * 00012700
*                                                                     * 00012800
*                                                                     * 00012900
*    REGISTER  CONTENTS                                               * 00013000
*                                                                     * 00013100
*    0-1       Used as work registers by the system                   * 00013200
*                                                                     * 00013300
*    2-13      Unchanged                                              * 00013400
*                                                                     * 00013500
*    14-15     Used as work registers by the system                   * 00013600
*                                                                     * 00013700
*                                                                     * 00013800
*                                                                     * 00013900
*    Some callers depend on register contents remaining the same      * 00014000
*    before and after issuing a service.  If the system changes the   * 00014100
*    contents of registers on which the caller depends, the caller    * 00014200
*    must save them before issuing the service, and restore them      * 00014300
*    after the system returns control.                                * 00014400
*                                                                     * 00014500
*01* PERFORMANCE IMPLICATIONS:                                        * 00014600
*    None.                                                            * 00014700
*                                                                     * 00014800
*01* SYNTAX:                                                          * 00014900
*                                                                     * 00015000
*Ýxlabel¨  HZSPREAD     CHECKOWNER=xcheckowner                        * 00015100
*                      ,CHECKNAME=xcheckname                          * 00015200
*                    ÐÝ,SECCHECK=UNAUTH¨                              * 00015300
*                    ¿Ý,SECCHECK=ALL¨                                 * 00015400
*                    Ð ,IPL=CURRENT                                   * 00015500
*                    ¿ ,IPL=PRIOR                                     * 00015600
*                    Ð ,INSTANCE=FIRST                                * 00015700
*                    ¿ ,INSTANCE=MOSTRECENT                           * 00015800
*                      ,BUFFER=xbuffer                                * 00015900
*                          ,DATALEN=xdatalen                          * 00016000
*                         Ý,STARTBYTE=»xstartbyte!FIRST_BYTEº¨        * 00016100
*                          ,BYTESAVAIL=xbytesavail                    * 00016200
*                         Ý,BYTESPROVIDED=xbytesprovided¨             * 00016300
*                     Ý,RETIPLTOD=xretipltod¨                         * 00016400
*                     Ý,RETPTIME=xretptime¨                           * 00016500
*                    ÐÝ,REMOTE=NO¨                                    * 00016600
*                    ¿Ý,REMOTE=YES                                    * 00016700
*                          ,HANDLE=xhandle                            * 00016800
*                        ÐÝ,REXX=NO¨                                  * 00016900
*                        ¿Ý,REXX=YES¨¨                                * 00017000
*                     Ý,RETCODE=xretcode¨                             * 00017100
*                     Ý,RSNCODE=xrsncode¨                             * 00017200
*                     Ý,PLISTVER=»xplistver!IMPLIED_VERSIONº¨         * 00017300
*                    ÐÝ,MF=S¨                                         * 00017400
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr!0Dº)¨                  * 00017500
*                    ÔÝ,MF=(M,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00017600
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨            * 00017700
*                                                                     * 00017800
*                                                                     * 00017900
*      Where:                                                         * 00018000
*                                                                     * 00018100
*                                                                     * 00018200
*      Ýxlabel¨                                                       * 00018300
*          is an optional symbol, starting in column 1, that is the   * 00018400
*          name on the HZSPREAD macro invocation.  The name must      * 00018500
*          conform to the rules for an ordinary assembler language    * 00018600
*          symbol.                                                    * 00018700
*          DEFAULT: No name.                                          * 00018800
*                                                                     * 00018900
*                                                                     * 00019000
*                                                                     * 00019100
*                                                                     * 00019200
*      CHECKOWNER=xcheckowner                                         * 00019300
*          is the name (RS-type), or address in register (2)-(12), of * 00019400
*          a required 16 character input that specifies the owner of  * 00019500
*          the check that has saved persistent data.                  * 00019600
*                                                                     * 00019700
*                                                                     * 00019800
*                                                                     * 00019900
*                                                                     * 00020000
*      CHECKNAME=xcheckname                                           * 00020100
*          is the name (RS-type), or address in register (2)-(12), of * 00020200
*          a required 32 character input that specifies the name of   * 00020300
*          the check that has saved persistent data.                  * 00020400
*                                                                     * 00020500
*                                                                     * 00020600
*                                                                     * 00020700
*                                                                     * 00020800
*      ÝSECCHECK=»UNAUTH!ALLº¨                                        * 00020900
*          is an optional keyword input that indicates whether to do  * 00021000
*          RACF security checks.                                      * 00021100
*          DEFAULT: UNAUTH                                            * 00021200
*                                                                     * 00021300
*                                                                     * 00021400
*          ÝSECCHECK=UNAUTH¨                                          * 00021500
*              that indicates to do RACF security checks only when    * 00021600
*              the caller is unauthorized (not supervisor state, not  * 00021700
*              system key, not APF-authorized).                       * 00021800
*                                                                     * 00021900
*          ÝSECCHECK=ALL¨                                             * 00022000
*              that indicates to do RACF security checks in all       * 00022100
*              cases. If RACF does not grant authority, the request   * 00022200
*              is rejected.                                           * 00022300
*                                                                     * 00022400
*                                                                     * 00022500
*                                                                     * 00022600
*                                                                     * 00022700
*                                                                     * 00022800
*                                                                     * 00022900
*      IPL=»CURRENT!PRIORº                                            * 00023000
*          is a required keyword input that indicates which IPL's     * 00023100
*          data is to be returned.                                    * 00023200
*                                                                     * 00023300
*                                                                     * 00023400
*          IPL=CURRENT                                                * 00023500
*              indicates that data from this IPL is to be returned.   * 00023600
*                                                                     * 00023700
*          IPL=PRIOR                                                  * 00023800
*              indicates that data from the prior IPL is to be        * 00023900
*              returned.                                              * 00024000
*                                                                     * 00024100
*                                                                     * 00024200
*                                                                     * 00024300
*                                                                     * 00024400
*                                                                     * 00024500
*                                                                     * 00024600
*      INSTANCE=»FIRST!MOSTRECENTº                                    * 00024700
*          is a required keyword input that indicates which instance  * 00024800
*          of the data is to be returned.                             * 00024900
*                                                                     * 00025000
*                                                                     * 00025100
*          INSTANCE=FIRST                                             * 00025200
*              indicates that the first instance of this check's data * 00025300
*              for the selected IPL should be returned.               * 00025400
*                                                                     * 00025500
*          INSTANCE=MOSTRECENT                                        * 00025600
*              indicates that the most recent instance of this        * 00025700
*              check's data for the selected IPL should be returned.  * 00025800
*                                                                     * 00025900
*                                                                     * 00026000
*                                                                     * 00026100
*                                                                     * 00026200
*                                                                     * 00026300
*                                                                     * 00026400
*      BUFFER=xbuffer                                                 * 00026500
*          is the name (RS-type), or address in register (2)-(12), of * 00026600
*          a required character input that is the buffer in which to  * 00026700
*          return the data.  The buffer should be in the same key as  * 00026800
*          the caller.                                                * 00026900
*                                                                     * 00027000
*                                                                     * 00027100
*          DATALEN=xdatalen                                           * 00027200
*              is the name (RS-type), or address in register          * 00027300
*              (2)-(12), of a required fullword input that contains   * 00027400
*              the number of bytes of data to return.                 * 00027500
*                                                                     * 00027600
*              When requesting data for a check other than your own,  * 00027700
*              a startbyte of 0 will be used regardless of what you   * 00027800
*              specify, so you should use a datalen that will         * 00027900
*              accomplish returning all the data in a single request. * 00028000
*                                                                     * 00028100
*                                                                     * 00028200
*                                                                     * 00028300
*                                                                     * 00028400
*          ÝSTARTBYTE=»xstartbyte!FIRST_BYTEº¨                        * 00028500
*              is the name (RS-type), or address in register          * 00028600
*              (2)-(12), of an optional fullword input that indicates * 00028700
*              which byte to begin with. For the first call, the most * 00028800
*              likely value would be 0 to indicate the "first byte".  * 00028900
*              Subsequent calls would most likely use the previous    * 00029000
*              StartByte value plus the value provided by the DataLen * 00029100
*              parameter, when the value returned in the BytesAvail   * 00029200
*              parameter of the previous call exceeded the value      * 00029300
*              provided by the DataLen parameter.                     * 00029400
*                                                                     * 00029500
*              Note that if reading from a check other than your own  * 00029600
*              a StartByte of 0 is used, regardless of what you       * 00029700
*              specify.                                               * 00029800
*              DEFAULT: FIRST_BYTE                                    * 00029900
*                                                                     * 00030000
*                                                                     * 00030100
*                                                                     * 00030200
*                                                                     * 00030300
*          BYTESAVAIL=xbytesavail                                     * 00030400
*              is the name (RS-type), or address in register          * 00030500
*              (2)-(12), of a required fullword output that indicates * 00030600
*              the total number of bytes that were available to be    * 00030700
*              returned. If that number is less than or equal to the  * 00030800
*              sum of the values provided by the DataLen and          * 00030900
*              StartByte parameters, then all requested bytes were    * 00031000
*              returned. If that number is greater than the sum of    * 00031100
*              the values provided by the DataLen and StartByte       * 00031200
*              parameters, then the number of bytes returned matches  * 00031300
*              the value provided by the DataLen parameter, and       * 00031400
*              subsequent calls should be made to retrieve the        * 00031500
*              additional data, adding the value in the StartByte     * 00031600
*              parameter to the value in the DataLen parameter to     * 00031700
*              form the value for the StartByte parameter in the next * 00031800
*              call.                                                  * 00031900
*                                                                     * 00032000
*                                                                     * 00032100
*                                                                     * 00032200
*                                                                     * 00032300
*          ÝBYTESPROVIDED=xbytesprovided¨                             * 00032400
*              is the name (RS-type), or address in register          * 00032500
*              (2)-(12), of an optional fullword output that          * 00032600
*              indicates the total number of bytes that were returned * 00032700
*              by this call. This number is derived by the system     * 00032800
*              from the values of the StartByte, DataLen, and         * 00032900
*              BytesAvail parameters as described under the           * 00033000
*              BytesAvail parameter.                                  * 00033100
*                                                                     * 00033200
*                                                                     * 00033300
*                                                                     * 00033400
*                                                                     * 00033500
*                                                                     * 00033600
*                                                                     * 00033700
*      ÝRETIPLTOD=xretipltod¨                                         * 00033800
*          is the name (RS-type), or address in register (2)-(12), of * 00033900
*          an optional 8 character output that is to contain the IPL  * 00034000
*          TOD of the persistent data.  It is in STCK format.         * 00034100
*                                                                     * 00034200
*                                                                     * 00034300
*                                                                     * 00034400
*                                                                     * 00034500
*      ÝRETPTIME=xretptime¨                                           * 00034600
*          is the name (RS-type), or address in register (2)-(12), of * 00034700
*          an optional 8 character output that specifies the time the * 00034800
*          persistent data record was written.  It is in STCK format. * 00034900
*                                                                     * 00035000
*                                                                     * 00035100
*                                                                     * 00035200
*                                                                     * 00035300
*      ÝREMOTE=»NO!YESº                                               * 00035400
*          is an optional keyword input which identifies the locale   * 00035500
*          of the check.                                              * 00035600
*          DEFAULT: NO                                                * 00035700
*                                                                     * 00035800
*                                                                     * 00035900
*          ÝREMOTE=NO¨                                                * 00036000
*              indicates that the check runs locally in the address   * 00036100
*              space of IBM Health Checker for z/OS.                  * 00036200
*                                                                     * 00036300
*          ÝREMOTE=YES                                                * 00036400
*              indicates that the check runs remotely, in an address  * 00036500
*              space other than that of IBM Health Checker for z/OS.  * 00036600
*                                                                     * 00036700
*                                                                     * 00036800
*              HANDLE=xhandle                                         * 00036900
*                  is the name (RS-type), or address in register      * 00037000
*                  (2)-(12), of a required 16 character input that    * 00037100
*                  specifies a handle (token) that identifies the     * 00037200
*                  check. This handle was returned via the HANDLE     * 00037300
*                  parameter of the HZSADDCK macro for a REMOTE=YES   * 00037400
*                  REXX=NO check. It is provided in REXX variable     * 00037500
*                  HZS_HANDLE for a REMOTE=YES REXX=YES check.        * 00037600
*                                                                     * 00037700
*                                                                     * 00037800
*                                                                     * 00037900
*                                                                     * 00038000
*              ÝREXX=»NO!YESº¨¨                                       * 00038100
*                  is an optional keyword input which indicates if    * 00038200
*                  this is a REXX check.                              * 00038300
*                  DEFAULT: NO                                        * 00038400
*                                                                     * 00038500
*                                                                     * 00038600
*                  ÝREXX=NO¨                                          * 00038700
*                      indicates that the check is not a REXX check.  * 00038800
*                                                                     * 00038900
*                  ÝREXX=YES¨¨                                        * 00039000
*                      indicates that the check is a REXX check.      * 00039100
*                                                                     * 00039200
*                                                                     * 00039300
*                                                                     * 00039400
*                                                                     * 00039500
*                                                                     * 00039600
*                                                                     * 00039700
*                                                                     * 00039800
*                                                                     * 00039900
*                                                                     * 00040000
*                                                                     * 00040100
*      ÝRETCODE=xretcode¨                                             * 00040200
*          is the name (RS-type) of an optional fullword output       * 00040300
*          variable, or register (2)-(12) or (15), into which the     * 00040400
*          return code is to be copied from GPR 15.  If you specify   * 00040500
*          15, GPR15, REG15, or R15 (within or without parentheses),  * 00040600
*          the value will be left in GPR 15.  Do not specify RETCODE  * 00040700
*          with MF=M.                                                 * 00040800
*                                                                     * 00040900
*                                                                     * 00041000
*                                                                     * 00041100
*                                                                     * 00041200
*      ÝRSNCODE=xrsncode¨                                             * 00041300
*          is the name (RS-type) of an optional fullword output       * 00041400
*          variable into which the reason code is to be copied from   * 00041500
*          GPR 0.  If you specify 0, 00, GPR0, GPR00, REG0, REG00, or * 00041600
*          R0 (within or without parentheses), the value will be left * 00041700
*          in GPR 0.  Do not specify RSNCODE with MF=M.               * 00041800
*                                                                     * 00041900
*                                                                     * 00042000
*                                                                     * 00042100
*                                                                     * 00042200
*      ÝPLISTVER=»xplistver!IMPLIED_VERSIONº¨                         * 00042300
*          is an optional byte input decimal value in the "0-0" range * 00042400
*          that specifies the macro version.  PLISTVER is the only    * 00042500
*          key allowed on the list form of MF and determines which    * 00042600
*          parameter list is generated.  Note that MAX may be         * 00042700
*          specified instead of a number, and the parameter list will * 00042800
*          be of the largest size currently supported. This size may  * 00042900
*          grow from release to release (thus possibly affecting the  * 00043000
*          amount of storage needed by your program).  If your        * 00043100
*          program can tolerate this, IBM recommends that you always  * 00043200
*          specify MAX when creating the list form parameter list as  * 00043300
*          that will ensure that the list form parameter list is      * 00043400
*          always long enough to hold whatever parameters might be    * 00043500
*          specified on the execute form.                             * 00043600
*          DEFAULT: IMPLIED_VERSION.  When PLISTVER is omitted, the   * 00043700
*          default is the lowest version which allows all of the      * 00043800
*          parameters specified on the invocation to be processed.    * 00043900
*                                                                     * 00044000
*                                                                     * 00044100
*                                                                     * 00044200
*                                                                     * 00044300
*      ÝMF=»S!L!M!Eº¨                                                 * 00044400
*          is an optional keyword input which specifies the macro     * 00044500
*          form.                                                      * 00044600
*          DEFAULT: S                                                 * 00044700
*                                                                     * 00044800
*                                                                     * 00044900
*          ÝMF=S¨                                                     * 00045000
*              specifies the standard form of the macro.  The "S"     * 00045100
*              form generates code to put the parameters into an      * 00045200
*              in-line parameter list and invoke the desired service. * 00045300
*              Full checking for required macro keys is done along    * 00045400
*              with supplying defaults for omitted optional           * 00045500
*              parameters.                                            * 00045600
*                                                                     * 00045700
*          ÝMF=(L,xmfctrl»,xmfattr!0Dº)¨                              * 00045800
*              specifies the list form of the macro.  The "L" form    * 00045900
*              defines an area to be used for the parameter list.     * 00046000
*              Only the PLISTVER key may be specified on the          * 00046100
*              invocation.  All other macro parameters are flagged as * 00046200
*              errors.  If PLISTVER is not specified, the original    * 00046300
*              parameter list definition is used.                     * 00046400
*                                                                     * 00046500
*            ,xmfctrl                                                 * 00046600
*              is a required input.  It is the name of a storage area * 00046700
*              for the parameter list.                                * 00046800
*                                                                     * 00046900
*            »,xmfattr!0Dº                                            * 00047000
*              is an optional 60 character input string that varies   * 00047100
*              from 1 to 60 characters. Use it to force boundary      * 00047200
*              alignment of the parameter list. Use only 0F or 0D.    * 00047300
*              DEFAULT: 0D which forces the parameter list to a       * 00047400
*              doubleword boundary.                                   * 00047500
*                                                                     * 00047600
*          ÝMF(M,xmfctrl»,COMPLETE!NOCHECKº)¨                         * 00047700
*              specifies the modify form of the macro.  The "M" form  * 00047800
*              generates code to put the parameters into the          * 00047900
*              parameter list specified by xmfctrl.                   * 00048000
*                                                                     * 00048100
*            ,xmfctrl                                                 * 00048200
*              is a required input.  It is the name (RS-type), or     * 00048300
*              address in register (1)-(12), of a storage area for    * 00048400
*              the parameter list.                                    * 00048500
*                                                                     * 00048600
*            »,COMPLETE!NOCHECKº¨                                     * 00048700
*              is an optional keyword input which specifies the       * 00048800
*              degree of macro parameter syntax checking.             * 00048900
*              DEFAULT: COMPLETE                                      * 00049000
*                                                                     * 00049100
*                                                                     * 00049200
*              COMPLETE                                               * 00049300
*                  Checking for required macro keys is done and       * 00049400
*                  defaults are supplied for omitted optional         * 00049500
*                  parameters.  (See Macro Usage Note 2).             * 00049600
*                                                                     * 00049700
*              NOCHECK                                                * 00049800
*                  Checking for required macro keys is not done nor   * 00049900
*                  are defaults supplied for omitted optional         * 00050000
*                  parameters.                                        * 00050100
*                                                                     * 00050200
*                                                                     * 00050300
*                                                                     * 00050400
*          ÝMF=(E,xmfctrl»,COMPLETE!NOCHECKº)¨                        * 00050500
*              specifies the execute form of the macro.  The "E" form * 00050600
*              generates code to put the parameters into the          * 00050700
*              parameter list specified by xmfctrl and invoke the     * 00050800
*              desired service.                                       * 00050900
*                                                                     * 00051000
*            ,xmfctrl                                                 * 00051100
*              is a required input.  It is the name (RS-type), or     * 00051200
*              address in register (1)-(12), of a storage area for    * 00051300
*              the parameter list.                                    * 00051400
*                                                                     * 00051500
*            »,COMPLETE!NOCHECKº                                      * 00051600
*              is an optional keyword input which specifies the       * 00051700
*              degree of macro parameter syntax checking.             * 00051800
*              DEFAULT: COMPLETE                                      * 00051900
*                                                                     * 00052000
*                                                                     * 00052100
*              COMPLETE                                               * 00052200
*                  Checking for required macro keys is done and       * 00052300
*                  defaults are supplied for omitted optional         * 00052400
*                  parameters.  (See Macro Usage Note 2).             * 00052500
*                                                                     * 00052600
*              NOCHECK                                                * 00052700
*                  Checking for required macro keys is not done nor   * 00052800
*                  are defaults supplied for omitted optional         * 00052900
*                  parameters.                                        * 00053000
*                                                                     * 00053100
*                                                                     * 00053200
*                                                                     * 00053300
*                                                                     * 00053400
*                                                                     * 00053500
*                                                                     * 00053600
*                                                                     * 00053700
*01* ABEND CODES:                                                     * 00053800
*                                                                     * 00053900
*                                                                     * 00054000
*       058       The IBM Health Checker for z/OS address space       * 00054100
*                 terminated while this call was in process.          * 00054200
*                                                                     * 00054300
*                                                                     * 00054400
*                                                                     * 00054500
*01* RETURN CODES:                                                    * 00054600
*                                                                     * 00054700
*                                                                     * 00054800
*                 Macro HZSZCONS provides equate symbols for the      * 00054900
*                 return and reason codes.                            * 00055000
*                                                                     * 00055100
*       0         Name: HzspreadRc_OK                                 * 00055200
*                                                                     * 00055300
*                 Meaning: The request was successfully processed.    * 00055400
*                 Note that, if your buffer was not large enough, you * 00055500
*                 might not have retrieved all possible data. Refer   * 00055600
*                 to the BytesAvail parameter description for more    * 00055700
*                 information.                                        * 00055800
*                                                                     * 00055900
*                 Action: None required                               * 00056000
*                                                                     * 00056100
*                                                                     * 00056200
*       8         Name: HzspreadRc_InvParm                            * 00056300
*                                                                     * 00056400
*                 Meaning:  HZSPREAD request specifies incorrect      * 00056500
*                 parameters.                                         * 00056600
*                                                                     * 00056700
*                 Action: Refer to action under the individual reason * 00056800
*                 code.                                               * 00056900
*                                                                     * 00057000
*                                                                     * 00057100
*                 HEX REASON  MEANING/ACTION                          * 00057200
*                 CODE                                                * 00057300
*                                                                     * 00057400
*                 xxxx0801    Name: HzspreadRsn_NotAuthorized         * 00057500
*                                                                     * 00057600
*                             Meaning: Caller is not authorized to    * 00057700
*                             access persistent data for this check   * 00057800
*                                                                     * 00057900
*                             Action: Avoid calling HZSPREAD to       * 00058000
*                             access data for a check when not        * 00058100
*                             authorized.                             * 00058200
*                                                                     * 00058300
*                 xxxx0808    Name: HzspreadRsn_BadENV                * 00058400
*                                                                     * 00058500
*                             Meaning:  HZSPREAD is supported only    * 00058600
*                             when called within the HZS address      * 00058700
*                             space.                                  * 00058800
*                                                                     * 00058900
*                             Action: Invoke HZSPREAD only within the * 00059000
*                             HZS address space.                      * 00059100
*                                                                     * 00059200
*                 xxxx0818    Name: HzspreadRsn_BadParmlist           * 00059300
*                                                                     * 00059400
*                             Meaning: Error accessing parameter      * 00059500
*                             list.                                   * 00059600
*                                                                     * 00059700
*                             Action: Make sure that the provided     * 00059800
*                             parameter list is valid.                * 00059900
*                                                                     * 00060000
*                 xxxx082D    Name: HzspreadRsn_NoMatch               * 00060100
*                                                                     * 00060200
*                             Meaning:  No persistent data records    * 00060300
*                             exist for this check.                   * 00060400
*                                                                     * 00060500
*                             Action: Make sure that you requested    * 00060600
*                             the proper information.                 * 00060700
*                                                                     * 00060800
*                 xxxx0830    Name: HzspreadRsn_DataDoesNotExist      * 00060900
*                                                                     * 00061000
*                             Meaning: The startbyte requested for    * 00061100
*                             the specified instance is not           * 00061200
*                             available.                              * 00061300
*                                                                     * 00061400
*                             Action: Make sure that you requested    * 00061500
*                             the proper information.                 * 00061600
*                                                                     * 00061700
*                 xxxx0843    Name: HzspreadRsn_SrbMode               * 00061800
*                                                                     * 00061900
*                             Meaning: SRB mode.                      * 00062000
*                                                                     * 00062100
*                             Action: Avoid issuing HZSPREAD in SRB   * 00062200
*                             mode.                                   * 00062300
*                                                                     * 00062400
*                 xxxx0844    Name: HzspreadRsn_NotEnabled            * 00062500
*                                                                     * 00062600
*                             Meaning: Not Enabled.                   * 00062700
*                                                                     * 00062800
*                             Action: Avoid using HZSPREAD when not   * 00062900
*                             enabled.                                * 00063000
*                                                                     * 00063100
*                 xxxx0845    Name: HzspreadRsn_Locked                * 00063200
*                                                                     * 00063300
*                             Meaning: Locked                         * 00063400
*                                                                     * 00063500
*                             Action: Avoid using HZSPREAD when a     * 00063600
*                             lock is held.                           * 00063700
*                                                                     * 00063800
*                 xxxx0846    Name: HzspreadRsn_FRR                   * 00063900
*                                                                     * 00064000
*                             Meaning: The caller had an EUT FRR      * 00064100
*                             established.                            * 00064200
*                                                                     * 00064300
*                             Action: Avoid using HZSPREAD when an    * 00064400
*                             EUT FRR is established.                 * 00064500
*                                                                     * 00064600
*                 xxxx0847    Name: HzspreadRsn_BadParmlistALET       * 00064700
*                                                                     * 00064800
*                             Meaning: Bad parameter list ALET.       * 00064900
*                                                                     * 00065000
*                             Action: Make sure that the ALET         * 00065100
*                             associated with the parameter list is   * 00065200
*                             valid. The access register might not    * 00065300
*                             have been set up correctly.             * 00065400
*                                                                     * 00065500
*                 xxxx0848    Name: HzspreadRsn_BadBufferALET         * 00065600
*                                                                     * 00065700
*                             Meaning: Bad answer area ALET.          * 00065800
*                                                                     * 00065900
*                             Action: Make sure that the ALET         * 00066000
*                             associated with the buffer is valid.    * 00066100
*                             The access register might not have been * 00066200
*                             set up correctly.                       * 00066300
*                                                                     * 00066400
*                 xxxx0849    Name: HzspreadRsn_BadBuffer             * 00066500
*                                                                     * 00066600
*                             Meaning: Error accessing buffer         * 00066700
*                                                                     * 00066800
*                             Action: Make sure that the provided     * 00066900
*                             buffer is valid.                        * 00067000
*                                                                     * 00067100
*                 xxxx0858    Name: HzspreadRsn_BadHandle             * 00067200
*                                                                     * 00067300
*                             Meaning: The handle provided with the   * 00067400
*                             HANDLE parameter is not valid.          * 00067500
*                                                                     * 00067600
*                             Action: Specify the handle that was     * 00067700
*                             returned by the HZSADDCK macro if this  * 00067800
*                             is a REMOTE=YES REXX=NO check.          * 00067900
*                                                                     * 00068000
*                 xxxx085A    Name: HzspreadRsn_WrongRemoteFunction   * 00068100
*                                                                     * 00068200
*                             Meaning: The check routine is not       * 00068300
*                             currently processing either the INITRUN * 00068400
*                             or the RUN remote function.             * 00068500
*                                                                     * 00068600
*                             Action: Avoid invoking HZSPREAD for a   * 00068700
*                             remote check when not within the        * 00068800
*                             INITRUN or RUN function.                * 00068900
*                                                                     * 00069000
*                 xxxx085B    Name: HzspreadRsn_BadRemoteEnvironment  * 00069100
*                                                                     * 00069200
*                             Meaning: HZSPREAD was invoked from a    * 00069300
*                             task other than the one that issued     * 00069400
*                             HZSCHECK REQUEST=OPSTART.               * 00069500
*                                                                     * 00069600
*                             Action: Avoid invoking HZSPREAD from an * 00069700
*                             incorrect task.                         * 00069800
*                                                                     * 00069900
*                 xxxx0861    Name: HzspreadRsn_WrongFunction         * 00070000
*                                                                     * 00070100
*                             Meaning: The check routine is not       * 00070200
*                             currently processing either the INIT,   * 00070300
*                             CHECK, or CLEANUP function.             * 00070400
*                                                                     * 00070500
*                             Action: Avoid invoking HZSPREAD for a   * 00070600
*                             local check when not within the INIT or * 00070700
*                             CHECK function.                         * 00070800
*                                                                     * 00070900
*                                                                     * 00071000
*                                                                     * 00071100
*                                                                     * 00071200
*       10        Name: HzspreadRc_CompError                          * 00071300
*                                                                     * 00071400
*                 Meaning: Component Error                            * 00071500
*                                                                     * 00071600
*                 Action: Refer to action under the individual reason * 00071700
*                 code.                                               * 00071800
*                                                                     * 00071900
*                                                                     * 00072000
*                 HEX REASON  MEANING/ACTION                          * 00072100
*                 CODE                                                * 00072200
*                                                                     * 00072300
*                 xxxx1001    Name: HzspreadRsn_IntError              * 00072400
*                                                                     * 00072500
*                             Meaning: Unexpected internal error      * 00072600
*                                                                     * 00072700
*                             Action: Report the problem to the       * 00072800
*                             system programmer                       * 00072900
*                                                                     * 00073000
*                                                                     * 00073100
*                                                                     * 00073200
*                                                                     * 00073300
*                                                                     * 00073400
*01* REASON CODES:                                                    * 00073500
*                                                                     * 00073600
*       Reason codes, as appropriate, are defined under their         * 00073700
*       corresponding return code.                                    * 00073800
*                                                                     * 00073900
*01* MODULE TYPE:  ASSEM MACRO                                        * 00074000
*                                                                     * 00074100
*02*   PROCESSOR:  ASSEM                                              * 00074200
*                                                                     * 00074300
*01* COMPONENT:  SCHZS                                                * 00074400
*                                                                     * 00074500
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 00074600
*                                                                     * 00074700
*01* EXAMPLES:                                                        * 00074800
*                                                                     * 00074900
*    Example 1                                                        * 00075000
*                                                                     * 00075100
*    Operation:                                                       * 00075200
*                                                                     * 00075300
*                                                                     * 00075400
*        Retrieve the peristent data stored from the previous IPL.    * 00075500
*                                                                     * 00075600
*                                                                     * 00075700
*                                                                     * 00075800
*    The code is as follows.                                          * 00075900
*                                                                     * 00076000
*    *************************************************************    * 00076100
*    * Retrieve previous IPL persistent data                     *    * 00076200
*    *************************************************************    * 00076300
*             SYSSTATE ARCHLVL=2                                      * 00076400
*             LHI   2,L'thebuff     Length to read                    * 00076500
*             ST    2,thelen                                          * 00076600
*             SLR   2,2             Value of 0                        * 00076700
*             ST    2,startbyte     Start at byte 0                   * 00076800
*             HZSPREAD CHECKOWNER=cowner,CHECKNAME=cname,        *    * 00076900
*                   IPL=PRIOR,INSTANCE=FIRST,                    *    * 00077000
*                   STARTBYTE=startbyte,                         *    * 00077100
*                   BUFFER=thebuff,DATALEN=thelen,               *    * 00077200
*                   BYTESAVAIL=avail,                            *    * 00077300
*                   RETCODE=LRETCODE,RSNCODE=LRSNCODE,           *    * 00077400
*                   MF=(E,PREADL)                                     * 00077500
*    *                                                                * 00077600
*    * Place code to check return/reason codes here                   * 00077700
*    *                                                                * 00077800
*    *                                                                * 00077900
*    * Place code to process the output buffer here                   * 00078000
*    *                                                                * 00078100
*    cowner   DC   CL16'MY_CHECK_OWNER'                               * 00078200
*    cname    DC   CL32'MY_CHECK_NAME'                                * 00078300
*             LTORG ,                                                 * 00078400
*             HZSZCONS ,            Return code information           * 00078500
*    DYNAREA  DSECT                                                   * 00078600
*    thelen   DS   F                Length of output buffer           * 00078700
*    avail    DS   F                Available bytes                   * 00078800
*    startbyte DS  F                Starting byte position            * 00078900
*    LRETCODE DS   F                                                  * 00079000
*    LRSNCODE DS   F                                                  * 00079100
*             HZSPREAD MF=(L,PREADL),PLISTVER=MAX                     * 00079200
*             DS   0D                                                 * 00079300
*    thebuff  DS   16384X           Output buffer                     * 00079400
*                                                                     * 00079500
*                                                                     * 00079600
*    Example 2                                                        * 00079700
*                                                                     * 00079800
*    Operation:                                                       * 00079900
*                                                                     * 00080000
*                                                                     * 00080100
*        If additional data exists, re-issue HZSPREAD to read the     * 00080200
*        next data                                                    * 00080300
*                                                                     * 00080400
*                                                                     * 00080500
*                                                                     * 00080600
*    The code is as follows.                                          * 00080700
*                                                                     * 00080800
*    *                                                                * 00080900
*    * Place code to check available bytes here, in case              * 00081000
*    * more bytes were available than could be returned in            * 00081100
*    * the output buffer                                              * 00081200
*    *                                                                * 00081300
*    *************************************************************    * 00081400
*    * Retrieve next group of prior IPL persistent data          *    * 00081500
*    * The example presumes that a call similar to that          *    * 00081600
*    * in the first example had been made                        *    * 00081700
*    *************************************************************    * 00081800
*             SYSSTATE ARCHLVL=2                                      * 00081900
*             CLC   avail,thelen                                      * 00082000
*             JNH   done_pread                                        * 00082100
*             L     2,startbyte     Previous starting byte            * 00082200
*             AL    2,thelen        Increment by length read          * 00082300
*             ST    2,startbyte     Next starting byte                * 00082400
*             LHI   2,L'thebuff     Length to read this time          * 00082500
*             ST    2,thelen                                          * 00082600
*             HZSPREAD CHECKOWNER=cowner,CHECKNAME=cname,        *    * 00082700
*                   IPL=PRIOR,INSTANCE=FIRST,                    *    * 00082800
*                   STARTBYTE=startbyte,                         *    * 00082900
*                   BUFFER=thebuff,DATALEN=thelen,               *    * 00083000
*                   BYTESAVAIL=avail,                            *    * 00083100
*                   RETCODE=LRETCODE,RSNCODE=LRSNCODE,           *    * 00083200
*                   MF=(E,PREADL)                                     * 00083300
*    *                                                                * 00083400
*    * Place code to check return/reason codes here                   * 00083500
*    *                                                                * 00083600
*    *                                                                * 00083700
*    * Place code to process the output buffer here                   * 00083800
*    *                                                                * 00083900
*    done_pread DS 0H                                                 * 00084000
*             ....                                                    * 00084100
*    cowner   DC   CL16'MY_CHECK_OWNER'                               * 00084200
*    cname    DC   CL32'MY_CHECK_NAME'                                * 00084300
*             LTORG ,                                                 * 00084400
*             HZSZCONS ,            Return code information           * 00084500
*    DYNAREA  DSECT                                                   * 00084600
*    thelen   DS   F                Length of output buffer           * 00084700
*    avail    DS   F                Available bytes                   * 00084800
*    startbyte DS  F                Starting byte position            * 00084900
*    LRETCODE DS   F                                                  * 00085000
*    LRSNCODE DS   F                                                  * 00085100
*             HZSPREAD MF=(L,PREADL),PLISTVER=MAX                     * 00085200
*             DS   0D                                                 * 00085300
*    thebuff  DS   16384X           Output buffer                     * 00085400
*                                                                     * 00085500
*                                                                     * 00085600
*01* MACRO USAGE NOTES:                                               * 00085700
*                                                                     * 00085800
*                                                                     * 00085900
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 00086000
*        global macro variable.  Any value other than 'NO' will       * 00086100
*        result in the macro expansion being printed.  The default is * 00086200
*        'YES'.  The following examples illustrate how the ZPRINT     * 00086300
*        variable should be set.                                      * 00086400
*                                                                     * 00086500
*                    GBLC &ZPRINT                                     * 00086600
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 00086700
*                                                                     * 00086800
*                                                                     * 00086900
*    2.  When using the NOCHECK option in conjunction with the Modify * 00087000
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 00087100
*        Modify   or  Execute  form  invocation  which  specifies  or * 00087200
*        defaults  to  the  COMPLETE  option.   This insures that the * 00087300
*        parameter  list  is  initialized completely.   The parameter * 00087400
*        list  field which identifies the version number of the macro * 00087500
*        is only set when the Standard form or the Complete option of * 00087600
*        the  Execute/Modify  form  is  used,  or  when  PLISTVER  is * 00087700
*        explicitly  specified.  Be sure that the resulting parameter * 00087800
*        list version number covers all the keys that you use.        * 00087900
*                                                                     * 00088000
*                                                                     * 00088100
*    3.  All   keys   currently   contained  in  the  HZSPREAD  macro * 00088200
*        correspond  to  version  0.   If you specify PLISTVER, use a * 00088300
*        value of 0 or MAX.                                           * 00088400
*                                                                     * 00088500
*                                                                     * 00088600
*                                                                     * 00088700
*                                                                     * 00088800
*01* CHANGE ACTIVITY:                                                 * 00088900
*                                                                     * 00089000
*   Flag LineItem  FMID    Date   ID    Comment                       * 00089100
*                                                                     * 00089200
*    $L0=INIT     HBB7720 031231 PD00ZP:                              * 00089300
*    $P1=ME01520  HZS7720 040929 PD00MP:  Clear AR15 when needed      * 00089400
*    $L1=HCR10    HBB7750 070101 PD00XB:  R10                         * 00089500
*    $L5=HCR12    HBB7770 100118 RD00UT:  Access register wording     * 00089600
*    $L6=REXXPDAT HBB77A0 130522 RD00UT:                              * 00089700
*                                          BytesProvided output parm  * 00089800
*    $L7=REXXPDAT HBB77A0 140915 RD00UT:                              * 00089900
*                                          BytesProvided with         * 00090000
*                                         Register. HZSPDATA comment. * 00090100
****** END OF SPECIFICATIONS *****************************************/ 00090200
*/********************************************************************* 00090300
         MACRO                                                          00090400
&XLABEL  HZSPREAD &CHECKOWNER=,&CHECKNAME=,&SECCHECK=,&IPL=,&INSTANCE=,*00090500
               &BUFFER=,&DATALEN=,&STARTBYTE=,&BYTESAVAIL=,            *00090600
               &BYTESPROVIDED=,&RETIPLTOD=,&RETPTIME=,&REMOTE=,        *00090700
               &HANDLE=,&REXX=,&RETCODE=,&RSNCODE=,&PLISTVER=,&MF=      00090800
.*                                                                      00090900
*                   MACDATE -07/10/15-<0>                               00091000
.*                                                                      00091100
.*******************************************************************    00091200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        00091300
.*******************************************************************    00091400
                   GBLC  &ZPRINT     YES=PRINT NO=NO PRINT              00091500
                   GBLC  &ZTEST      YES=TEST NO=NO TEST                00091600
                   GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX        00091700
.*                                                                      00091800
                   GBLC  &ZHZSPREAD  YES=MACRO USED AT LEAST ONCE       00091900
.*******************************************************************    00092000
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          00092100
.*******************************************************************    00092200
                   LCLC  &ZMS        ERROR MESSAGE WORK AREA            00092300
                   LCLC  &ZCNDX      SYSNDX CHARACTERS                  00092400
                   LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED         00092500
                   LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR        00092600
                   LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE        00092700
                   LCLA  &ZAWRK      USED AS A WORK AREA                00092800
                   LCLA  &ZASIZ      USED FOR SIZE OF VALUE             00092900
                   LCLA  &ZN         NUMERIC WORK VARIABLE              00093000
                   LCLC  &ZC         CHARACTER WORK VARIABLE            00093100
                   LCLC  &ZTLC       CHARACTER TOO LONG VARIABLE        00093200
                   LCLA  &ZTLA       VALUE TOO LONG VARIABLE            00093300
                   LCLC  &ZMAC_G     "G" or null                        00093400
&ZMAC_G            SETC  ''                                             00093500
                   LCLC  &ZMAC_LR                                       00093600
&ZMAC_LR           SETC  'LR'                                           00093700
                   LCLC  &ZMAC_L                                        00093800
&ZMAC_L            SETC  'L'                                            00093900
                   LCLC  &ZMAC_ST                                       00094000
&ZMAC_ST           SETC  'ST'                                           00094100
                   LCLC  &ZMAC_LLGT                                     00094200
&ZMAC_LLGT         SETC  'L'                                            00094300
                   LCLC  &ZMAC_LGR                                      00094400
&ZMAC_LGR          SETC  'LR'                                           00094500
                   LCLC  &ZMAC_LG                                       00094600
&ZMAC_LG           SETC  'L'                                            00094700
                   LCLC  &ZMAC_STG                                      00094800
&ZMAC_STG          SETC  'ST'                                           00094900
                   LCLA  &ZMACRET    MACRO RETURN CODE                  00095000
&ZMACRET           SETA  0           ASSUME NO ERRORS                   00095100
.*                                                                      00095200
                   LCLC  &ZCSYSLIST(255)        NONXKEY, POS ARRAY      00095300
                   LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()         00095400
                   LCLA  &ZPLLEN     PARAMETER LIST LENGTH              00095500
                   LCLC  &ZENDBASEPL            End of base PL          00095600
                   LCLA  &ZPLWORKA   PARAMETER LIST LENGTH              00095700
.*******************************************************************    00095800
.***AB.04  MACRO VARIABLES FOR RANGES AND SETS OF ARGUMENTS             00095900
.*******************************************************************    00096000
                   LCLA  &ZI         INDEX FOR ARRAY                    00096100
                   LCLA  &ZJ         INDEX FOR PARMS                    00096200
                   LCLA  &ZK         INDEX FOR PARSE                    00096300
                   LCLA  &ZLO        LOW RANGE VALUE                    00096400
                   LCLA  &ZHI        HIGH RANGE VALUE                   00096500
                   LCLC  &ZW         WORK AREA FOR PARM                 00096600
.********************************************************************   00096700
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 00096800
.********************************************************************   00096900
                   GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL            00097000
                   GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE     00097100
                   GBLA  &SYSALVL    SYSSTATE ARCHLVL                   00097200
                   GBLC  &SYSAM64    SYSSTATE AMODE64                   00097300
.*                                                                      00097400
                   AIF   (K'&SYSASCE GT 0).ZSYS4  SYS STATE DEFINED     00097500
                   AIF   (K'&SYSSPLV GT 0).ZSYS2  SP LEVEL DEFINED      00097600
                   SPLEVEL  TEST                                        00097700
.ZSYS2             ANOP  ,                                              00097800
                   AIF   ('&SYSSPLV' EQ '1').ZSYS3  PRE SP 3.1          00097900
                   AIF   ('&SYSSPLV' EQ '2').ZSYS3  PRE SP 3.1          00098000
                   SYSSTATE TEST                                        00098100
                   AGO   .ZSYS4                                         00098200
.ZSYS3             ANOP  ,                                              00098300
&SYSASCE           SETC  'P'         ASSUME SYSSTATE PRIMARY            00098400
.ZSYS4             ANOP  ,                                              00098500
                   AIF   ('&SYSAM64' NE 'YES').ZSYSN64                  00098600
&ZMAC_LLGT         SETC 'LLGT'                                          00098700
&ZMAC_LGR          SETC 'LGR'                                           00098800
&ZMAC_LG           SETC 'LG'                                            00098900
&ZMAC_STG          SETC 'STG'                                           00099000
.ZSYSN64           ANOP  ,                                              00099100
.*******************************************************************    00099200
.***AB.07  DEFINE ALL MACRO VARIABLES                                   00099300
.*******************************************************************    00099400
                   LCLC  &XCHECKOWNER           ++ NAME                 00099500
                   LCLC  &XCHECKNAME            ++ NAME                 00099600
                   LCLC  &XSECCHECK  ++ VALUE                           00099700
                   LCLC  &XIPL       ++ VALUE                           00099800
                   LCLC  &XINSTANCE  ++ VALUE                           00099900
                   LCLC  &XBUFFER    ++ NAME                            00100000
                   LCLC  &XDATALEN   ++ NAME                            00100100
                   LCLC  &XSTARTBYTE            ++ NAME                 00100200
                   LCLC  &XBYTESAVAIL           ++ NAME                 00100300
                   LCLC  &XBYTESPROVIDED        ++ NAME                 00100400
                   LCLC  &XRETIPLTOD            ++ NAME                 00100500
                   LCLC  &XRETPTIME  ++ NAME                            00100600
                   LCLC  &XREMOTE    ++ VALUE                           00100700
                   LCLC  &XHANDLE    ++ NAME                            00100800
                   LCLC  &XREXX      ++ VALUE                           00100900
                   LCLC  &XRETCODE   ++ NAME                            00101000
                   LCLC  &XRSNCODE   ++ NAME                            00101100
                   LCLA  &XPLISTVER  ++ VALUE                           00101200
                   LCLC  &XMF        ++ VALUE                           00101300
                   LCLC  &XMFCTRL    ++ NAME                            00101400
                   LCLC  &XMFATTR    ++ VALUE                           00101500
                   LCLC  &XMFSCK     ++ VALUE                           00101600
.*******************************************************************    00101700
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           00101800
.*******************************************************************    00101900
                   LCLC  &ZXCHECKOWNER          ++ INPUT NAME           00102000
                   LCLC  &ZXCHECKNAME           ++ INPUT NAME           00102100
                   LCLC  &ZXSECCHECK            ++ INPUT VALUE          00102200
                   LCLC  &ZXIPL      ++ INPUT VALUE                     00102300
                   LCLC  &ZXINSTANCE            ++ INPUT VALUE          00102400
                   LCLC  &ZXBUFFER   ++ INPUT NAME                      00102500
                   LCLC  &ZXDATALEN  ++ INPUT NAME                      00102600
                   LCLC  &ZXSTARTBYTE           ++ INPUT NAME           00102700
                   LCLC  &ZXBYTESAVAIL          ++ OUTPUT NAME          00102800
                   LCLC  &ZXBYTESPROVIDED       ++ OUTPUT NAME          00102900
                   LCLC  &ZXRETIPLTOD           ++ OUTPUT NAME          00103000
                   LCLC  &ZXRETPTIME            ++ OUTPUT NAME          00103100
                   LCLC  &ZXREMOTE   ++ INPUT VALUE                     00103200
                   LCLC  &ZXHANDLE   ++ INPUT NAME                      00103300
                   LCLC  &ZXREXX     ++ INPUT VALUE                     00103400
                   LCLC  &ZXRETCODE  ++ OUTPUT NAME                     00103500
                   LCLC  &ZXRSNCODE  ++ OUTPUT NAME                     00103600
                   LCLC  &ZXPLISTVER            ++ INPUT VALUE          00103700
                   LCLC  &ZXMF       ++ INPUT VALUE                     00103800
                   LCLC  &ZXMFCTRL   ++ INPUT NAME                      00103900
                   LCLC  &ZXMFATTR   ++ INPUT VALUE                     00104000
                   LCLC  &ZXMFSCK    ++ INPUT VALUE                     00104100
.********************************************************************   00104200
.***AC.PLV01  PROCESS PLISTVER                                      *   00104300
.********************************************************************   00104400
&XPLISTVER      SETA  0                                                 00104500
                AIF   (K'&PLISTVER(1) LE 0).ZPLV0                       00104600
                AIF   ('&PLISTVER(1)' NE 'MAX').ZPLV0                   00104700
&XPLISTVER      SETA  0                                                 00104800
.ZPLV0          ANOP  ,                                                 00104900
.*                                                                      00105000
                AIF   (K'&PLISTVER(1) LE 0).ZPVCKE                      00105100
                AIF   ('&PLISTVER(1)' EQ 'IMPLIED_VERSION').ZPVCKE      00105200
                AIF   ('&PLISTVER(1)' EQ 'MAX').ZPVCKE                  00105300
.*-------------------------------------------------------------------   00105400
                AIF   (N'&PLISTVER LE 1).ZPVCK3  CK NUM                 00105500
&ZMS            SETC  '"PLISTVER='                                      00105600
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00105700
&ZMS            SETC  '&ZMS "PLISTVER"'                                 00105800
                MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'               00105900
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00106000
                AGO   .ZPVCK2                                           00106100
.ZPVCK3         ANOP  ,                                                 00106200
.*-------------------------------------------------------------------   00106300
                AIF   ('&PLISTVER'(1,1) NE '(').ZPVCK2                  00106400
&ZMS            SETC  '"PLISTVER='                                      00106500
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00106600
&ZMS            SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'         00106700
                MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 1.'                 00106800
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00106900
                AGO   .ZPVCKE                                           00107000
.ZPVCK2         ANOP  ,                                                 00107100
.*-------------------------------------------------------------------   00107200
&ZCVAL          SETC  '&PLISTVER(1)'                                    00107300
                AIF   ('&ZCVAL'(1,1) EQ '(').ZPVCKE  IN GPR             00107400
                AIF   (T'&ZCVAL NE 'N').ZPVCK6  NUMERIC ERR             00107500
&ZN             SETA   &PLISTVER(1)        CONVERT TO ARITHMETIC        00107600
                AIF   (&ZN LT 0).ZPVCK6    TOO LOW                      00107700
                AIF   (&ZN LE 0).ZPVCK4A   NOT HIGH                     00107800
.ZPVCK6         ANOP  ,                                                 00107900
&ZMS            SETC  '"PLISTVER='                                      00108000
&ZMS            SETC  '&ZMS.&PLISTVER"'                                 00108100
&ZMS            SETC  '&ZMS THE RANGE IS "0-0"'                         00108200
                MNOTE 8,' &ZMS FOR ARGUMENT 1.'                         00108300
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00108400
&XPLISTVER      SETA  0                                                 00108500
                AGO   .ZPVCKE                                           00108600
.*-------------------------------------------------------------------   00108700
.ZPVCK4A        ANOP  ,                                                 00108800
                AIF   (&ZN GE &XPLISTVER).ZPVCK4                        00108900
&ZMS            SETC  'PLISTVER='                                       00109000
&ZMS            SETC  '&ZMS.&PLISTVER(1)'                               00109100
&ZMS            SETC  '&ZMS., BUT PLISTVER OF'                          00109200
&ZMS            SETC  '&ZMS &XPLISTVER'                                 00109300
                MNOTE 8,' &ZMS IS REQUIRED.'                            00109400
&ZMACRET        SETA  8      SET MACRO ERROR RETURN CODE                00109500
                AGO   .ZPVCK5                                           00109600
.ZPVCK4         ANOP  ,                                                 00109700
&XPLISTVER      SETA  &PLISTVER(1)                                      00109800
.ZPVCK5         ANOP  ,                                                 00109900
.ZPVCKE         ANOP  ,                                                 00110000
.********************************************************************   00110100
.***AG.MF01 PROCESS MF MACRO FORMS                                      00110200
.********************************************************************   00110300
                   ACTR  10000                                          00110400
.*------------------------------------------------------------------    00110500
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110600
&XMF               SETC  ''          INITIALIZE XVARIABLE               00110700
.*-------------------------------------------------------------------   00110800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00110900
.ZG67              ANOP  ,                                              00111000
&ZTLC              SETC 'S'                                             00111100
                   AIF   ('&MF(1)' NE '&ZTLC').ZG68                     00111200
&XMF               SETC  'S'         SET KEYWORD                        00111300
&XMFSCK            SETC  'COMPLETE'  SET XMFSCK                         00111400
                   AIF   (N'&MF LE 1).ZG67A     CK NUM                  00111500
&ZMS               SETC  '"MF='                                         00111600
&ZMS               SETC  '&ZMS.&MF"'                                    00111700
&ZMS               SETC  '&ZMS "MF"'                                    00111800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00111900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00112000
.ZG67A             ANOP  ,                                              00112100
.*-------------------------------------------------------------------   00112200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00112300
.ZG68              ANOP  ,                                              00112400
&ZTLC              SETC 'L'                                             00112500
                   AIF   ('&MF(1)' NE '&ZTLC').ZG75                     00112600
&XMF               SETC  'L'         SET KEYWORD                        00112700
                   AIF   (N'&MF LE 3).ZG68A     CK NUM                  00112800
&ZMS               SETC  '"MF='                                         00112900
&ZMS               SETC  '&ZMS.&MF"'                                    00113000
&ZMS               SETC  '&ZMS "MF"'                                    00113100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00113200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00113300
.ZG68A             ANOP  ,                                              00113400
.*-------------------------------------------------------------------   00113500
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     00113600
                   AIF   (N'&SYSLIST NE 0).ZG68B  POSITIONALS?          00113700
                   AIF   ('&CHECKOWNER' NE '').ZG68B  KEYS?             00113800
                   AIF   ('&CHECKNAME' NE '').ZG68B  KEYS?              00113900
                   AIF   ('&SECCHECK' NE '').ZG68B  KEYS?               00114000
                   AIF   ('&IPL' NE '').ZG68B   KEYS?                   00114100
                   AIF   ('&INSTANCE' NE '').ZG68B  KEYS?               00114200
                   AIF   ('&BUFFER' NE '').ZG68B  KEYS?                 00114300
                   AIF   ('&DATALEN' NE '').ZG68B  KEYS?                00114400
                   AIF   ('&STARTBYTE' NE '').ZG68B  KEYS?              00114500
                   AIF   ('&BYTESAVAIL' NE '').ZG68B  KEYS?             00114600
                   AIF   ('&BYTESPROVIDED' NE '').ZG68B  KEYS?          00114700
                   AIF   ('&RETIPLTOD' NE '').ZG68B  KEYS?              00114800
                   AIF   ('&RETPTIME' NE '').ZG68B  KEYS?               00114900
                   AIF   ('&REMOTE' NE '').ZG68B  KEYS?                 00115000
                   AIF   ('&HANDLE' NE '').ZG68B  KEYS?                 00115100
                   AIF   ('&REXX' NE '').ZG68B  KEYS?                   00115200
                   AIF   ('&RETCODE' NE '').ZG68B  KEYS?                00115300
                   AIF   ('&RSNCODE' NE '').ZG68B  KEYS?                00115400
                   AGO    .ZG68C     INVOCATION OKAY                    00115500
.ZG68B             ANOP  ,                                              00115600
&ZMS               SETC  'THE "L" FORM OF "MF"'                         00115700
&ZMS               SETC  '&ZMS CAN ONLY HAVE'                           00115800
&ZMS               SETC  '&ZMS THE "PLISTVER" KEY'                      00115900
                   MNOTE 8,' &ZMS SPECIFIED ON THE INVOCATION.'         00116000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00116100
.ZG68C             ANOP  ,                                              00116200
.*-------------------------------------------------------------------   00116300
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00116400
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00116500
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00116600
                   AIF   (N'&MF(2) GT 1).ZG70B  MULTI                   00116700
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00116800
.ZG70B             AIF   (K'&MF(2) GT 0).ZG70C                          00116900
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00117000
&ZMS               SETC  'WHEN "L" IS SPECIFIED'                        00117100
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00117200
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00117300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00117400
.ZG70C             ANOP  ,                                              00117500
.*-------------------------------------------------------------------   00117600
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               00117700
                   AIF   (K'&ZXMFCTRL LE 0).ZG70P  NOT I/O              00117800
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG70P                 00117900
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00118000
&ZMS               SETC  '"MF='                                         00118100
&ZMS               SETC  '&ZMS.&MF"'                                    00118200
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00118300
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'              00118400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00118500
.ZG70P             ANOP  ,                                              00118600
.*-------------------------------------------------------------------   00118700
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      00118800
&ZXMFATTR          SETC  'INPUT'     SET IN/OUTPUT                      00118900
&XMFATTR           SETC  '0D'                                           00119000
                   AIF   (K'&MF(3) LE 0).ZG73B  PARM                    00119100
&XMFATTR           SETC  '&MF(3,1)'  SET XVARIABLE                      00119200
                   AIF   (N'&MF(3) GT 1).ZG73B  MULTI                   00119300
&XMFATTR           SETC  '&MF(3)'    SET XVARIABLE                      00119400
.ZG73B             ANOP  ,                                              00119500
.*-------------------------------------------------------------------   00119600
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  00119700
                   AIF   (K'&ZXMFATTR LE 0).ZG73P  NOT I/O              00119800
                   AIF   ('&XMFATTR'(1,1) NE '(').ZG73P                 00119900
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00120000
&ZMS               SETC  '"MF='                                         00120100
&ZMS               SETC  '&ZMS.&MF"'                                    00120200
&ZMS               SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'      00120300
                   MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'              00120400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00120500
.ZG73P             ANOP  ,                                              00120600
.*-------------------------------------------------------------------   00120700
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 00120800
                   AIF   (K'&ZXMFATTR LE 0).ZG73S  NOT I/O              00120900
                   AIF   (K'&XMFATTR LE 60).ZG73S  LNG OK               00121000
&ZXMFATTR          SETC  ''          RESET IN/OUTPUT                    00121100
&ZMS               SETC  '"MF='                                         00121200
&ZMS               SETC  '&ZMS.&MF"'                                    00121300
&ZMS               SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'          00121400
                   MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'             00121500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00121600
.ZG73S             ANOP  ,                                              00121700
.*-------------------------------------------------------------------   00121800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00121900
.ZG75              ANOP  ,                                              00122000
&ZTLC              SETC 'M'                                             00122100
                   AIF   ('&MF(1)' NE '&ZTLC').ZG84                     00122200
&XMF               SETC  'M'         SET KEYWORD                        00122300
                   AIF   (N'&MF LE 3).ZG75A     CK NUM                  00122400
&ZMS               SETC  '"MF='                                         00122500
&ZMS               SETC  '&ZMS.&MF"'                                    00122600
&ZMS               SETC  '&ZMS "MF"'                                    00122700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00122800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00122900
.ZG75A             ANOP  ,                                              00123000
.*-------------------------------------------------------------------   00123100
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            00123200
                   AIF   ('&BYTESAVAIL' NE '').ZG75B  OUTPUT?           00123300
                   AIF   ('&BYTESPROVIDED' NE '').ZG75B                 00123400
                   AIF   ('&RETIPLTOD' NE '').ZG75B                     00123500
                   AIF   ('&RETPTIME' NE '').ZG75B                      00123600
                   AGO    .ZG75C     INVOCATION OKAY                    00123700
.ZG75B             ANOP  ,                                              00123800
&ZMS               SETC  'THE "M" FORM OF "MF" CANNOT'                  00123900
&ZMS               SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'        00124000
&ZMS               SETC  '&ZMS SPECIFIED ON THE INVOCATION:'            00124100
&ZMS               SETC  '&ZMS "BYTESAVAIL"'                            00124200
&ZMS               SETC  '&ZMS OR "BYTESPROVIDED"'                      00124300
&ZMS               SETC  '&ZMS OR "RETIPLTOD"'                          00124400
&ZMS               SETC  '&ZMS OR "RETPTIME"'                           00124500
                   MNOTE 8,' &ZMS '                                     00124600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00124700
.ZG75C             ANOP  ,                                              00124800
.*-------------------------------------------------------------------   00124900
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00125000
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00125100
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00125200
                   AIF   (N'&MF(2) GT 1).ZG77B  MULTI                   00125300
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00125400
.ZG77B             AIF   (K'&MF(2) GT 0).ZG77C                          00125500
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00125600
&ZMS               SETC  'WHEN "M" IS SPECIFIED'                        00125700
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00125800
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00125900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00126000
.ZG77C             ANOP  ,                                              00126100
.*-------------------------------------------------------------------   00126200
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00126300
                   AIF   (K'&ZXMFCTRL LE 0).ZG77R  NOT I/O              00126400
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG77R                 00126500
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00126600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG77P                   00126700
                   AIF   (K'&ZCGPR GT 2).ZG77Q                          00126800
                   AIF   ('&ZCGPR' EQ '0').ZG77Q                        00126900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00127000
                   AIF   (T'&ZCGPR NE 'N').ZG77Q  INVALID REG NAME      00127100
.ZG77P             ANOP  ,                                              00127200
                   AIF   (T'&ZCGPR NE 'N').ZG77R  NON NUMERIC           00127300
                   AIF   ('&ZCGPR' LT '1').ZG77Q                        00127400
                   AIF   ('&ZCGPR' LE '12').ZG77R                       00127500
.ZG77Q             ANOP  ,                                              00127600
&ZMS               SETC  '"MF='                                         00127700
&ZMS               SETC  '&ZMS.&MF"'                                    00127800
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00127900
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00128000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00128100
.ZG77R             ANOP  ,                                              00128200
.*-------------------------------------------------------------------   00128300
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00128400
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00128500
.ZG81A   AIF   ('&MF(3)' NE 'COMPLETE').ZG82A                           00128600
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00128700
.*-------------------------------------------------------------------   00128800
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00128900
.ZG82A   AIF   ('&MF(3)' NE 'NOCHECK').ZG83A                            00129000
&XMFSCK            SETC  'NOCHECK'   SET KEYWORD                        00129100
.*-------------------------------------------------------------------   00129200
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00129300
.ZG83A             AIF   (K'&XMFSCK GT 0).ZG83C  KEYWORD                00129400
                   AIF   (K'&MF(3) LE 0).ZG83B                          00129500
&ZMS               SETC  '"MF='                                         00129600
&ZMS               SETC  '&ZMS.&MF"'                                    00129700
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00129800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00129900
&ZMS               SETC  '&ZMS "COMPLETE"'                              00130000
&ZMS               SETC  '&ZMS OR "NOCHECK".'                           00130100
                   MNOTE 8,' &ZMS '                                     00130200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00130300
.ZG83B             ANOP  ,                                              00130400
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00130500
.ZG83C             ANOP  ,                                              00130600
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00130700
.*-------------------------------------------------------------------   00130800
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00130900
.ZG84              ANOP  ,                                              00131000
&ZTLC              SETC 'E'                                             00131100
                   AIF   ('&MF(1)' NE '&ZTLC').ZG93                     00131200
&XMF               SETC  'E'         SET KEYWORD                        00131300
                   AIF   (N'&MF LE 3).ZG84A     CK NUM                  00131400
&ZMS               SETC  '"MF='                                         00131500
&ZMS               SETC  '&ZMS.&MF"'                                    00131600
&ZMS               SETC  '&ZMS "MF"'                                    00131700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'           00131800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00131900
.ZG84A             ANOP  ,                                              00132000
.*-------------------------------------------------------------------   00132100
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   00132200
&ZXMFCTRL          SETC  'INPUT'     SET IN/OUTPUT                      00132300
&XMFCTRL           SETC  '&MF(2,1)'  SET XVARIABLE                      00132400
                   AIF   (N'&MF(2) GT 1).ZG86B  MULTI                   00132500
&XMFCTRL           SETC  '&MF(2)'    SET XVARIABLE                      00132600
.ZG86B             AIF   (K'&MF(2) GT 0).ZG86C                          00132700
&ZXMFCTRL          SETC  ''          RESET IN/OUTPUT                    00132800
&ZMS               SETC  'WHEN "E" IS SPECIFIED'                        00132900
&ZMS               SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'            00133000
                   MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                   00133100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00133200
.ZG86C             ANOP  ,                                              00133300
.*-------------------------------------------------------------------   00133400
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              00133500
                   AIF   (K'&ZXMFCTRL LE 0).ZG86R  NOT I/O              00133600
                   AIF   ('&XMFCTRL'(1,1) NE '(').ZG86R                 00133700
&ZCGPR             SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                     00133800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG86P                   00133900
                   AIF   (K'&ZCGPR GT 2).ZG86Q                          00134000
                   AIF   ('&ZCGPR' EQ '0').ZG86Q                        00134100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00134200
                   AIF   (T'&ZCGPR NE 'N').ZG86Q  INVALID REG NAME      00134300
.ZG86P             ANOP  ,                                              00134400
                   AIF   (T'&ZCGPR NE 'N').ZG86R  NON NUMERIC           00134500
                   AIF   ('&ZCGPR' LT '1').ZG86Q                        00134600
                   AIF   ('&ZCGPR' LE '12').ZG86R                       00134700
.ZG86Q             ANOP  ,                                              00134800
&ZMS               SETC  '"MF='                                         00134900
&ZMS               SETC  '&ZMS.&MF"'                                    00135000
&ZMS               SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'      00135100
                   MNOTE 8,' &ZMS IN THE RANGE (1)-(12).'               00135200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00135300
.ZG86R             ANOP  ,                                              00135400
.*-------------------------------------------------------------------   00135500
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00135600
&XMFSCK            SETC  ''          INITIALIZE XVARIABLE               00135700
.ZG90A   AIF   ('&MF(3)' NE 'COMPLETE').ZG91A                           00135800
&XMFSCK            SETC  'COMPLETE'  SET KEYWORD                        00135900
.*-------------------------------------------------------------------   00136000
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00136100
.ZG91A   AIF   ('&MF(3)' NE 'NOCHECK').ZG92A                            00136200
&XMFSCK            SETC  'NOCHECK'   SET KEYWORD                        00136300
.*-------------------------------------------------------------------   00136400
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             00136500
.ZG92A             AIF   (K'&XMFSCK GT 0).ZG92C  KEYWORD                00136600
                   AIF   (K'&MF(3) LE 0).ZG92B                          00136700
&ZMS               SETC  '"MF='                                         00136800
&ZMS               SETC  '&ZMS.&MF"'                                    00136900
&ZMS               SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '      00137000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00137100
&ZMS               SETC  '&ZMS "COMPLETE"'                              00137200
&ZMS               SETC  '&ZMS OR "NOCHECK".'                           00137300
                   MNOTE 8,' &ZMS '                                     00137400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00137500
.ZG92B             ANOP  ,                                              00137600
&XMFSCK            SETC  'COMPLETE'  SET DEFAULT KEYWORD                00137700
.ZG92C             ANOP  ,                                              00137800
&ZXMFSCK           SETC  'INPUT'     SET IN/OUTPUT                      00137900
.*------------------------------------------------------------------    00138000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00138100
.ZG93              ANOP  ,                                              00138200
&ZXMF              SETC  'INPUT'     SET IN/OUTPUT                      00138300
                   AIF   (K'&XMF GT 0).ZG93E    VALID ARG               00138400
                   AIF   (T'&MF EQ 'O').ZG93D   OMITTED                 00138500
&ZASYSLNDX         SETA  0                                              00138600
.ZG93A             ANOP  ,           POSITIONAL MACRO KEY               00138700
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00138800
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG93C               00138900
&ZTLC              SETC 'MF'                                            00139000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG93A      00139100
.ZG93B             ANOP  ,                                              00139200
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00139300
&ZMS               SETC  'THE "MF" KEY'                                 00139400
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00139500
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00139600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00139700
                   AGO   .ZG93E                                         00139800
.ZG93C             ANOP  ,                                              00139900
&ZXMF              SETC  ''          RESET IN/OUTPUT                    00140000
&ZMS               SETC  '"MF='                                         00140100
&ZMS               SETC  '&ZMS.&MF"'                                    00140200
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00140300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00140400
&ZMS               SETC  '&ZMS "S",'                                    00140500
&ZMS               SETC  '&ZMS "L",'                                    00140600
&ZMS               SETC  '&ZMS "M",'                                    00140700
&ZMS               SETC  '&ZMS OR "E".'                                 00140800
                   MNOTE 8,' &ZMS '                                     00140900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00141000
                   AGO   .ZG93E                                         00141100
.ZG93D             ANOP  ,                                              00141200
&XMF               SETC  'S'         SET DEFAULT KEYWORD                00141300
&XMFSCK            SETC  'COMPLETE'  COMPLETE CHECKING                  00141400
.ZG93E             ANOP  ,                                              00141500
.********************************************************************   00141600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 00141700
.********************************************************************   00141800
                   ACTR  10000                                          00141900
.*-------------------------------------------------------------------   00142000
.***AG.MF03 MF=(SLME)                                                   00142100
                   AIF   ('&XMF' EQ 'L').ZGMFX                          00142200
                   AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                00142300
.*----------------------------------------------------------------***   00142400
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00142500
                   AIF   (N'&CHECKOWNER LE 1).ZG2A  CK NUM              00142600
&ZMS               SETC  '"CHECKOWNER='                                 00142700
&ZMS               SETC  '&ZMS.&CHECKOWNER"'                            00142800
&ZMS               SETC  '&ZMS "CHECKOWNER"'                            00142900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00143000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00143100
.ZG2A              ANOP  ,                                              00143200
.*-------------------------------------------------------------------   00143300
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00143400
&ZXCHECKOWNER      SETC  'INPUT'     SET IN/OUTPUT                      00143500
&XCHECKOWNER       SETC  '&CHECKOWNER(1)'       SET XVARIABLE           00143600
                   AIF   (N'&CHECKOWNER GT 1).ZG2B  MULTI               00143700
&XCHECKOWNER       SETC  '&CHECKOWNER'          SET XVARIABLE           00143800
.ZG2B              AIF   (K'&CHECKOWNER(1) GT 0).ZG2C                   00143900
&ZXCHECKOWNER      SETC  ''          RESET IN/OUTPUT                    00144000
&ZMS               SETC  ' '                                            00144100
&ZMS               SETC  '&ZMS "CHECKOWNER" KEY AND ITS'                00144200
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00144300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00144400
.ZG2C              ANOP  ,                                              00144500
.*-------------------------------------------------------------------   00144600
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00144700
                   AIF   (K'&ZXCHECKOWNER LE 0).ZG2R  NOT I/O           00144800
                   AIF   ('&XCHECKOWNER'(1,1) NE '(').ZG2R              00144900
&ZCGPR             SETC  '&XCHECKOWNER'(2,K'&XCHECKOWNER-2)             00145000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG2P                    00145100
                   AIF   (K'&ZCGPR GT 2).ZG2Q                           00145200
                   AIF   ('&ZCGPR' EQ '0').ZG2Q                         00145300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00145400
                   AIF   (T'&ZCGPR NE 'N').ZG2Q  INVALID REG NAME       00145500
.ZG2P              ANOP  ,                                              00145600
                   AIF   (T'&ZCGPR NE 'N').ZG2R  NON NUMERIC            00145700
                   AIF   ('&ZCGPR' LT '2').ZG2Q                         00145800
                   AIF   ('&ZCGPR' LE '12').ZG2R                        00145900
.ZG2Q              ANOP  ,                                              00146000
&ZMS               SETC  '"CHECKOWNER='                                 00146100
&ZMS               SETC  '&ZMS.&CHECKOWNER"'                            00146200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00146300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00146400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00146500
.ZG2R              ANOP  ,                                              00146600
.*----------------------------------------------------------------***   00146700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00146800
                   AIF   (N'&CHECKNAME LE 1).ZG5A  CK NUM               00146900
&ZMS               SETC  '"CHECKNAME='                                  00147000
&ZMS               SETC  '&ZMS.&CHECKNAME"'                             00147100
&ZMS               SETC  '&ZMS "CHECKNAME"'                             00147200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00147300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00147400
.ZG5A              ANOP  ,                                              00147500
.*-------------------------------------------------------------------   00147600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00147700
&ZXCHECKNAME       SETC  'INPUT'     SET IN/OUTPUT                      00147800
&XCHECKNAME        SETC  '&CHECKNAME(1)'        SET XVARIABLE           00147900
                   AIF   (N'&CHECKNAME GT 1).ZG5B  MULTI                00148000
&XCHECKNAME        SETC  '&CHECKNAME'           SET XVARIABLE           00148100
.ZG5B              AIF   (K'&CHECKNAME(1) GT 0).ZG5C                    00148200
&ZXCHECKNAME       SETC  ''          RESET IN/OUTPUT                    00148300
&ZMS               SETC  ' '                                            00148400
&ZMS               SETC  '&ZMS "CHECKNAME" KEY AND ITS'                 00148500
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00148600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00148700
.ZG5C              ANOP  ,                                              00148800
.*-------------------------------------------------------------------   00148900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00149000
                   AIF   (K'&ZXCHECKNAME LE 0).ZG5R  NOT I/O            00149100
                   AIF   ('&XCHECKNAME'(1,1) NE '(').ZG5R               00149200
&ZCGPR             SETC  '&XCHECKNAME'(2,K'&XCHECKNAME-2)               00149300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG5P                    00149400
                   AIF   (K'&ZCGPR GT 2).ZG5Q                           00149500
                   AIF   ('&ZCGPR' EQ '0').ZG5Q                         00149600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00149700
                   AIF   (T'&ZCGPR NE 'N').ZG5Q  INVALID REG NAME       00149800
.ZG5P              ANOP  ,                                              00149900
                   AIF   (T'&ZCGPR NE 'N').ZG5R  NON NUMERIC            00150000
                   AIF   ('&ZCGPR' LT '2').ZG5Q                         00150100
                   AIF   ('&ZCGPR' LE '12').ZG5R                        00150200
.ZG5Q              ANOP  ,                                              00150300
&ZMS               SETC  '"CHECKNAME='                                  00150400
&ZMS               SETC  '&ZMS.&CHECKNAME"'                             00150500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00150600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00150700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00150800
.ZG5R              ANOP  ,                                              00150900
.*------------------------------------------------------------------    00151000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00151100
&XSECCHECK         SETC  ''          INITIALIZE XVARIABLE               00151200
.*-------------------------------------------------------------------   00151300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00151400
.ZG9               ANOP  ,                                              00151500
                   AIF   (K'&SECCHECK(1) LE 0).ZG9A                     00151600
&ZTLC              SETC 'UNAUTH'                                        00151700
                   AIF   ('&SECCHECK(1)' NE '&ZTLC').ZG10               00151800
&XSECCHECK         SETC  'UNAUTH'    SET KEYWORD                        00151900
                   AIF   (N'&SECCHECK LE 1).ZG9A  CK NUM                00152000
&ZMS               SETC  '"SECCHECK='                                   00152100
&ZMS               SETC  '&ZMS.&SECCHECK"'                              00152200
&ZMS               SETC  '&ZMS "SECCHECK"'                              00152300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00152400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00152500
.ZG9A              ANOP  ,                                              00152600
.*-------------------------------------------------------------------   00152700
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00152800
.ZG10              ANOP  ,                                              00152900
&ZTLC              SETC 'ALL'                                           00153000
                   AIF   ('&SECCHECK(1)' NE '&ZTLC').ZG11               00153100
&XSECCHECK         SETC  'ALL'       SET KEYWORD                        00153200
                   AIF   (N'&SECCHECK LE 1).ZG10A  CK NUM               00153300
&ZMS               SETC  '"SECCHECK='                                   00153400
&ZMS               SETC  '&ZMS.&SECCHECK"'                              00153500
&ZMS               SETC  '&ZMS "SECCHECK"'                              00153600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00153700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00153800
.ZG10A             ANOP  ,                                              00153900
.*------------------------------------------------------------------    00154000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00154100
.ZG11              ANOP  ,                                              00154200
&ZXSECCHECK        SETC  'INPUT'     SET IN/OUTPUT                      00154300
                   AIF   (K'&XSECCHECK GT 0).ZG11E  VALID ARG           00154400
                   AIF   (T'&SECCHECK EQ 'O').ZG11D  OMITTED            00154500
&ZASYSLNDX         SETA  0                                              00154600
.ZG11A             ANOP  ,           POSITIONAL MACRO KEY               00154700
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00154800
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG11C               00154900
&ZTLC              SETC 'SECCHECK'                                      00155000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG11A      00155100
.ZG11B             ANOP  ,                                              00155200
&ZXSECCHECK        SETC  ''          RESET IN/OUTPUT                    00155300
&ZMS               SETC  'THE "SECCHECK" KEY'                           00155400
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00155500
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00155600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00155700
                   AGO   .ZG11E                                         00155800
.ZG11C             ANOP  ,                                              00155900
&ZXSECCHECK        SETC  ''          RESET IN/OUTPUT                    00156000
&ZMS               SETC  '"SECCHECK='                                   00156100
&ZMS               SETC  '&ZMS.&SECCHECK"'                              00156200
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00156300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00156400
&ZMS               SETC  '&ZMS "UNAUTH"'                                00156500
&ZMS               SETC  '&ZMS OR "ALL".'                               00156600
                   MNOTE 8,' &ZMS '                                     00156700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00156800
                   AGO   .ZG11E                                         00156900
.ZG11D             ANOP  ,                                              00157000
&XSECCHECK         SETC  'UNAUTH'    SET DEFAULT KEYWORD                00157100
.ZG11E             ANOP  ,                                              00157200
.*------------------------------------------------------------------    00157300
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157400
&XIPL              SETC  ''          INITIALIZE XVARIABLE               00157500
.*-------------------------------------------------------------------   00157600
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00157700
.ZG14              ANOP  ,                                              00157800
                   AIF   (K'&IPL(1) LE 0).ZG14A                         00157900
&ZTLC              SETC 'CURRENT'                                       00158000
                   AIF   ('&IPL(1)' NE '&ZTLC').ZG15                    00158100
&XIPL              SETC  'CURRENT'   SET KEYWORD                        00158200
                   AIF   (N'&IPL LE 1).ZG14A    CK NUM                  00158300
&ZMS               SETC  '"IPL='                                        00158400
&ZMS               SETC  '&ZMS.&IPL"'                                   00158500
&ZMS               SETC  '&ZMS "IPL"'                                   00158600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00158700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00158800
.ZG14A             ANOP  ,                                              00158900
.*-------------------------------------------------------------------   00159000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00159100
.ZG15              ANOP  ,                                              00159200
&ZTLC              SETC 'PRIOR'                                         00159300
                   AIF   ('&IPL(1)' NE '&ZTLC').ZG16                    00159400
&XIPL              SETC  'PRIOR'     SET KEYWORD                        00159500
                   AIF   (N'&IPL LE 1).ZG15A    CK NUM                  00159600
&ZMS               SETC  '"IPL='                                        00159700
&ZMS               SETC  '&ZMS.&IPL"'                                   00159800
&ZMS               SETC  '&ZMS "IPL"'                                   00159900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00160000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00160100
.ZG15A             ANOP  ,                                              00160200
.*------------------------------------------------------------------    00160300
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00160400
.ZG16              ANOP  ,                                              00160500
&ZXIPL             SETC  'INPUT'     SET IN/OUTPUT                      00160600
                   AIF   (K'&XIPL GT 0).ZG16E   VALID ARG               00160700
                   AIF   (T'&IPL EQ 'O').ZG16D  OMITTED                 00160800
&ZASYSLNDX         SETA  0                                              00160900
.ZG16A             ANOP  ,           POSITIONAL MACRO KEY               00161000
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00161100
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C               00161200
&ZTLC              SETC 'IPL'                                           00161300
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG16A      00161400
.ZG16B             ANOP  ,                                              00161500
&ZXIPL             SETC  ''          RESET IN/OUTPUT                    00161600
&ZMS               SETC  'THE "IPL" KEY'                                00161700
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00161800
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00161900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00162000
                   AGO   .ZG16E                                         00162100
.ZG16C             ANOP  ,                                              00162200
&ZXIPL             SETC  ''          RESET IN/OUTPUT                    00162300
&ZMS               SETC  '"IPL='                                        00162400
&ZMS               SETC  '&ZMS.&IPL"'                                   00162500
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00162600
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00162700
&ZMS               SETC  '&ZMS "CURRENT"'                               00162800
&ZMS               SETC  '&ZMS OR "PRIOR".'                             00162900
                   MNOTE 8,' &ZMS '                                     00163000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00163100
                   AGO   .ZG16E                                         00163200
.ZG16D             ANOP  ,                                              00163300
&XIPL              SETC  'CURRENT'   SET DEFAULT KEYWORD                00163400
.ZG16E             ANOP  ,                                              00163500
.*------------------------------------------------------------------    00163600
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00163700
                   AIF   (K'&IPL(1) GT 0).ZG16F  PARM                   00163800
&XIPL              SETC  ''          ENSURE NULL KEYWORD                00163900
&ZXIPL             SETC  ''          RESET IN/OUTPUT                    00164000
&ZMS               SETC  'THE'                                          00164100
&ZMS               SETC  '&ZMS "IPL" KEY AND ITS'                       00164200
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00164300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00164400
&ZMS               SETC  '&ZMS "CURRENT"'                               00164500
&ZMS               SETC  '&ZMS OR "PRIOR".'                             00164600
                   MNOTE 8,' &ZMS '                                     00164700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00164800
.ZG16F             ANOP  ,                                              00164900
.*------------------------------------------------------------------    00165000
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165100
&XINSTANCE         SETC  ''          INITIALIZE XVARIABLE               00165200
.*-------------------------------------------------------------------   00165300
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00165400
.ZG19              ANOP  ,                                              00165500
                   AIF   (K'&INSTANCE(1) LE 0).ZG19A                    00165600
&ZTLC              SETC 'FIRST'                                         00165700
                   AIF   ('&INSTANCE(1)' NE '&ZTLC').ZG20               00165800
&XINSTANCE         SETC  'FIRST'     SET KEYWORD                        00165900
                   AIF   (N'&INSTANCE LE 1).ZG19A  CK NUM               00166000
&ZMS               SETC  '"INSTANCE='                                   00166100
&ZMS               SETC  '&ZMS.&INSTANCE"'                              00166200
&ZMS               SETC  '&ZMS "INSTANCE"'                              00166300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00166400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00166500
.ZG19A             ANOP  ,                                              00166600
.*-------------------------------------------------------------------   00166700
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00166800
.ZG20              ANOP  ,                                              00166900
&ZTLC              SETC 'MOSTRECENT'                                    00167000
                   AIF   ('&INSTANCE(1)' NE '&ZTLC').ZG21               00167100
&XINSTANCE         SETC  'MOSTRECENT'           SET KEYWORD             00167200
                   AIF   (N'&INSTANCE LE 1).ZG20A  CK NUM               00167300
&ZMS               SETC  '"INSTANCE='                                   00167400
&ZMS               SETC  '&ZMS.&INSTANCE"'                              00167500
&ZMS               SETC  '&ZMS "INSTANCE"'                              00167600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00167700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00167800
.ZG20A             ANOP  ,                                              00167900
.*------------------------------------------------------------------    00168000
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00168100
.ZG21              ANOP  ,                                              00168200
&ZXINSTANCE        SETC  'INPUT'     SET IN/OUTPUT                      00168300
                   AIF   (K'&XINSTANCE GT 0).ZG21E  VALID ARG           00168400
                   AIF   (T'&INSTANCE EQ 'O').ZG21D  OMITTED            00168500
&ZASYSLNDX         SETA  0                                              00168600
.ZG21A             ANOP  ,           POSITIONAL MACRO KEY               00168700
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00168800
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG21C               00168900
&ZTLC              SETC 'INSTANCE'                                      00169000
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG21A      00169100
.ZG21B             ANOP  ,                                              00169200
&ZXINSTANCE        SETC  ''          RESET IN/OUTPUT                    00169300
&ZMS               SETC  'THE "INSTANCE" KEY'                           00169400
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00169500
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00169600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00169700
                   AGO   .ZG21E                                         00169800
.ZG21C             ANOP  ,                                              00169900
&ZXINSTANCE        SETC  ''          RESET IN/OUTPUT                    00170000
&ZMS               SETC  '"INSTANCE='                                   00170100
&ZMS               SETC  '&ZMS.&INSTANCE"'                              00170200
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00170300
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00170400
&ZMS               SETC  '&ZMS "FIRST"'                                 00170500
&ZMS               SETC  '&ZMS OR "MOSTRECENT".'                        00170600
                   MNOTE 8,' &ZMS '                                     00170700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00170800
                   AGO   .ZG21E                                         00170900
.ZG21D             ANOP  ,                                              00171000
&XINSTANCE         SETC  'FIRST'     SET DEFAULT KEYWORD                00171100
.ZG21E             ANOP  ,                                              00171200
.*------------------------------------------------------------------    00171300
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00171400
                   AIF   (K'&INSTANCE(1) GT 0).ZG21F  PARM              00171500
&XINSTANCE         SETC  ''          ENSURE NULL KEYWORD                00171600
&ZXINSTANCE        SETC  ''          RESET IN/OUTPUT                    00171700
&ZMS               SETC  'THE'                                          00171800
&ZMS               SETC  '&ZMS "INSTANCE" KEY AND ITS'                  00171900
&ZMS               SETC  '&ZMS ARGUMENT ARE REQUIRED.'                  00172000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00172100
&ZMS               SETC  '&ZMS "FIRST"'                                 00172200
&ZMS               SETC  '&ZMS OR "MOSTRECENT".'                        00172300
                   MNOTE 8,' &ZMS '                                     00172400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00172500
.ZG21F             ANOP  ,                                              00172600
.*----------------------------------------------------------------***   00172700
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00172800
                   AIF   (N'&BUFFER LE 1).ZG23A  CK NUM                 00172900
&ZMS               SETC  '"BUFFER='                                     00173000
&ZMS               SETC  '&ZMS.&BUFFER"'                                00173100
&ZMS               SETC  '&ZMS "BUFFER"'                                00173200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00173300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00173400
.ZG23A             ANOP  ,                                              00173500
.*-------------------------------------------------------------------   00173600
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00173700
&ZXBUFFER          SETC  'INPUT'     SET IN/OUTPUT                      00173800
&XBUFFER           SETC  '&BUFFER(1)'           SET XVARIABLE           00173900
                   AIF   (N'&BUFFER GT 1).ZG23B  MULTI                  00174000
&XBUFFER           SETC  '&BUFFER'   SET XVARIABLE                      00174100
.ZG23B             AIF   (K'&BUFFER(1) GT 0).ZG23C                      00174200
&ZXBUFFER          SETC  ''          RESET IN/OUTPUT                    00174300
&ZMS               SETC  ' '                                            00174400
&ZMS               SETC  '&ZMS "BUFFER" KEY AND ITS'                    00174500
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00174600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00174700
.ZG23C             ANOP  ,                                              00174800
.*-------------------------------------------------------------------   00174900
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00175000
                   AIF   (K'&ZXBUFFER LE 0).ZG23R  NOT I/O              00175100
                   AIF   ('&XBUFFER'(1,1) NE '(').ZG23R                 00175200
&ZCGPR             SETC  '&XBUFFER'(2,K'&XBUFFER-2)                     00175300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG23P                   00175400
                   AIF   (K'&ZCGPR GT 2).ZG23Q                          00175500
                   AIF   ('&ZCGPR' EQ '0').ZG23Q                        00175600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00175700
                   AIF   (T'&ZCGPR NE 'N').ZG23Q  INVALID REG NAME      00175800
.ZG23P             ANOP  ,                                              00175900
                   AIF   (T'&ZCGPR NE 'N').ZG23R  NON NUMERIC           00176000
                   AIF   ('&ZCGPR' LT '2').ZG23Q                        00176100
                   AIF   ('&ZCGPR' LE '12').ZG23R                       00176200
.ZG23Q             ANOP  ,                                              00176300
&ZMS               SETC  '"BUFFER='                                     00176400
&ZMS               SETC  '&ZMS.&BUFFER"'                                00176500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00176600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00176700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00176800
.ZG23R             ANOP  ,                                              00176900
.*----------------------------------------------------------------***   00177000
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     00177100
                   AIF   (N'&DATALEN LE 1).ZG25A  CK NUM                00177200
&ZMS               SETC  '"DATALEN='                                    00177300
&ZMS               SETC  '&ZMS.&DATALEN"'                               00177400
&ZMS               SETC  '&ZMS "DATALEN"'                               00177500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00177600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00177700
.ZG25A             ANOP  ,                                              00177800
.*-------------------------------------------------------------------   00177900
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         00178000
&ZXDATALEN         SETC  'INPUT'     SET IN/OUTPUT                      00178100
&XDATALEN          SETC  '&DATALEN(1)'          SET XVARIABLE           00178200
                   AIF   (N'&DATALEN GT 1).ZG25B  MULTI                 00178300
&XDATALEN          SETC  '&DATALEN'  SET XVARIABLE                      00178400
.ZG25B             AIF   (K'&DATALEN(1) GT 0).ZG25C                     00178500
&ZXDATALEN         SETC  ''          RESET IN/OUTPUT                    00178600
&ZMS               SETC  ' '                                            00178700
&ZMS               SETC  '&ZMS "DATALEN" KEY AND ITS'                   00178800
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00178900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00179000
.ZG25C             ANOP  ,                                              00179100
.*-------------------------------------------------------------------   00179200
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00179300
                   AIF   (K'&ZXDATALEN LE 0).ZG25R  NOT I/O             00179400
                   AIF   ('&XDATALEN'(1,1) NE '(').ZG25R                00179500
&ZCGPR             SETC  '&XDATALEN'(2,K'&XDATALEN-2)                   00179600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG25P                   00179700
                   AIF   (K'&ZCGPR GT 2).ZG25Q                          00179800
                   AIF   ('&ZCGPR' EQ '0').ZG25Q                        00179900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00180000
                   AIF   (T'&ZCGPR NE 'N').ZG25Q  INVALID REG NAME      00180100
.ZG25P             ANOP  ,                                              00180200
                   AIF   (T'&ZCGPR NE 'N').ZG25R  NON NUMERIC           00180300
                   AIF   ('&ZCGPR' LT '2').ZG25Q                        00180400
                   AIF   ('&ZCGPR' LE '12').ZG25R                       00180500
.ZG25Q             ANOP  ,                                              00180600
&ZMS               SETC  '"DATALEN='                                    00180700
&ZMS               SETC  '&ZMS.&DATALEN"'                               00180800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00180900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00181000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00181100
.ZG25R             ANOP  ,                                              00181200
.*----------------------------------------------------------------***   00181300
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     00181400
                   AIF   (N'&STARTBYTE LE 1).ZG28A  CK NUM              00181500
&ZMS               SETC  '"STARTBYTE='                                  00181600
&ZMS               SETC  '&ZMS.&STARTBYTE"'                             00181700
&ZMS               SETC  '&ZMS "STARTBYTE"'                             00181800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00181900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00182000
.ZG28A             ANOP  ,                                              00182100
.*-------------------------------------------------------------------   00182200
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         00182300
&XSTARTBYTE        SETC  'FIRST_BYTE'           SET DEFAULT             00182400
                   AIF   (K'&STARTBYTE(1) LE 0).ZG28C  PARM             00182500
&XSTARTBYTE        SETC  '&STARTBYTE(1)'        SET XVARIABLE           00182600
                   AIF   (N'&STARTBYTE GT 1).ZG28B  MULTI               00182700
&XSTARTBYTE        SETC  '&STARTBYTE'           SET XVARIABLE           00182800
.ZG28B             AIF   (K'&BUFFER(1) GT 0).ZG28C  KEY                 00182900
&ZMS               SETC  '"STARTBYTE'                                   00183000
&ZMS               SETC  '&ZMS.=&STARTBYTE"'                            00183100
&ZMS               SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                00183200
&ZMS               SETC  '&ZMS '                                        00183300
&ZMS               SETC  '&ZMS "BUFFER"'                                00183400
                   MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                   00183500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00183600
.ZG28C             ANOP  ,                                              00183700
&ZXSTARTBYTE       SETC  'INPUT'     SET IN/OUTPUT                      00183800
.*-------------------------------------------------------------------   00183900
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00184000
                   AIF   (K'&ZXSTARTBYTE LE 0).ZG28R  NOT I/O           00184100
         AIF   ('&XSTARTBYTE' EQ 'FIRST_BYTE').ZG28R                    00184200
                   AIF   ('&XSTARTBYTE'(1,1) NE '(').ZG28R              00184300
&ZCGPR             SETC  '&XSTARTBYTE'(2,K'&XSTARTBYTE-2)               00184400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG28P                   00184500
                   AIF   (K'&ZCGPR GT 2).ZG28Q                          00184600
                   AIF   ('&ZCGPR' EQ '0').ZG28Q                        00184700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00184800
                   AIF   (T'&ZCGPR NE 'N').ZG28Q  INVALID REG NAME      00184900
.ZG28P             ANOP  ,                                              00185000
                   AIF   (T'&ZCGPR NE 'N').ZG28R  NON NUMERIC           00185100
                   AIF   ('&ZCGPR' LT '2').ZG28Q                        00185200
                   AIF   ('&ZCGPR' LE '12').ZG28R                       00185300
.ZG28Q             ANOP  ,                                              00185400
&ZMS               SETC  '"STARTBYTE='                                  00185500
&ZMS               SETC  '&ZMS.&STARTBYTE"'                             00185600
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00185700
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00185800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00185900
.ZG28R             ANOP  ,                                              00186000
.*-------------------------------------------------------------------   00186100
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00186200
                   AIF   ('&XMF' EQ 'M').ZG32   BYPASS IF MF=M          00186300
.*----------------------------------------------------------------***   00186400
.***AG.KXVAR05 NAME, RQD OUTPUT, KEYS -XVARIABLE KEY                    00186500
                   AIF   (N'&BYTESAVAIL LE 1).ZG31A  CK NUM             00186600
&ZMS               SETC  '"BYTESAVAIL='                                 00186700
&ZMS               SETC  '&ZMS.&BYTESAVAIL"'                            00186800
&ZMS               SETC  '&ZMS "BYTESAVAIL"'                            00186900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00187000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00187100
.ZG31A             ANOP  ,                                              00187200
.*-------------------------------------------------------------------   00187300
.***AG.KXVAR06 NAME, RQD OUTPUT, KEYS -XVARIABLE                        00187400
&ZXBYTESAVAIL      SETC  'OUTPUT'    SET IN/OUTPUT                      00187500
&XBYTESAVAIL       SETC  '&BYTESAVAIL(1)'       SET XVARIABLE           00187600
                   AIF   (N'&BYTESAVAIL GT 1).ZG31B  MULTI              00187700
&XBYTESAVAIL       SETC  '&BYTESAVAIL'          SET XVARIABLE           00187800
.ZG31B             AIF   (K'&BYTESAVAIL(1) GT 0).ZG31C                  00187900
&ZXBYTESAVAIL      SETC  ''          RESET IN/OUTPUT                    00188000
&ZMS               SETC  ' '                                            00188100
&ZMS               SETC  '&ZMS "BYTESAVAIL" KEY AND ITS'                00188200
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00188300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00188400
.ZG31C             ANOP  ,                                              00188500
.*-------------------------------------------------------------------   00188600
.***AG.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00188700
                   AIF   (K'&ZXBYTESAVAIL LE 0).ZG31R  NOT I/O          00188800
                   AIF   ('&XBYTESAVAIL'(1,1) NE '(').ZG31R             00188900
&ZCGPR             SETC  '&XBYTESAVAIL'(2,K'&XBYTESAVAIL-2)             00189000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG31P                   00189100
                   AIF   (K'&ZCGPR GT 2).ZG31Q                          00189200
                   AIF   ('&ZCGPR' EQ '0').ZG31Q                        00189300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00189400
                   AIF   (T'&ZCGPR NE 'N').ZG31Q  INVALID REG NAME      00189500
.ZG31P             ANOP  ,                                              00189600
                   AIF   (T'&ZCGPR NE 'N').ZG31R  NON NUMERIC           00189700
                   AIF   ('&ZCGPR' LT '2').ZG31Q                        00189800
                   AIF   ('&ZCGPR' LE '12').ZG31R                       00189900
.ZG31Q             ANOP  ,                                              00190000
&ZMS               SETC  '"BYTESAVAIL='                                 00190100
&ZMS               SETC  '&ZMS.&BYTESAVAIL"'                            00190200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00190300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00190400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00190500
.ZG31R             ANOP  ,                                              00190600
.*-------------------------------------------------------------------   00190700
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00190800
.ZG32              ANOP  ,           END OF BYPASS CHECK                00190900
.*-------------------------------------------------------------------   00191000
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00191100
                   AIF   ('&XMF' EQ 'M').ZG35   BYPASS IF MF=M          00191200
.*----------------------------------------------------------------***   00191300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00191400
                   AIF   (N'&BYTESPROVIDED LE 1).ZG34A  CK NUM          00191500
&ZMS               SETC  '"BYTESPROVIDED='                              00191600
&ZMS               SETC  '&ZMS.&BYTESPROVIDED"'                         00191700
&ZMS               SETC  '&ZMS "BYTESPROVIDED"'                         00191800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00191900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00192000
.ZG34A             ANOP  ,                                              00192100
.*-------------------------------------------------------------------   00192200
.***AG.KXVAR18 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00192300
                   AIF   (K'&BYTESPROVIDED(1) LE 0).ZG34C  PARM         00192400
&ZXBYTESPROVIDED   SETC  'OUTPUT'    SET OUTPUT                         00192500
&XBYTESPROVIDED    SETC  '&BYTESPROVIDED(1)'    SET XVARIABLE           00192600
                   AIF   (N'&BYTESPROVIDED GT 1).ZG34B                  00192700
&XBYTESPROVIDED    SETC  '&BYTESPROVIDED'       SET XVARIABLE           00192800
.ZG34B             AIF   (K'&BUFFER(1) GT 0).ZG34C  KEY                 00192900
&ZMS               SETC  '"BYTESPROVIDED'                               00193000
&ZMS               SETC  '&ZMS.=&BYTESPROVIDED"'                        00193100
&ZMS               SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                00193200
&ZMS               SETC  '&ZMS '                                        00193300
&ZMS               SETC  '&ZMS "BUFFER"'                                00193400
                   MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                   00193500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00193600
.ZG34C             ANOP  ,                                              00193700
.*-------------------------------------------------------------------   00193800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00193900
                   AIF   (K'&ZXBYTESPROVIDED LE 0).ZG34R  NOT I/O       00194000
                   AIF   ('&XBYTESPROVIDED'(1,1) NE '(').ZG34R          00194100
&ZCGPR             SETC  '&XBYTESPROVIDED'(2,K'&XBYTESPROVIDED-2)       00194200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG34P                   00194300
                   AIF   (K'&ZCGPR GT 2).ZG34Q                          00194400
                   AIF   ('&ZCGPR' EQ '0').ZG34Q                        00194500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00194600
                   AIF   (T'&ZCGPR NE 'N').ZG34Q  INVALID REG NAME      00194700
.ZG34P             ANOP  ,                                              00194800
                   AIF   (T'&ZCGPR NE 'N').ZG34R  NON NUMERIC           00194900
                   AIF   ('&ZCGPR' LT '2').ZG34Q                        00195000
                   AIF   ('&ZCGPR' LE '12').ZG34R                       00195100
.ZG34Q             ANOP  ,                                              00195200
&ZMS               SETC  '"BYTESPROVIDED='                              00195300
&ZMS               SETC  '&ZMS.&BYTESPROVIDED"'                         00195400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00195500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00195600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00195700
.ZG34R             ANOP  ,                                              00195800
.*-------------------------------------------------------------------   00195900
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00196000
.ZG35              ANOP  ,           END OF BYPASS CHECK                00196100
.*-------------------------------------------------------------------   00196200
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00196300
                   AIF   ('&XMF' EQ 'M').ZG39   BYPASS IF MF=M          00196400
.*----------------------------------------------------------------***   00196500
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00196600
                   AIF   (N'&RETIPLTOD LE 1).ZG38A  CK NUM              00196700
&ZMS               SETC  '"RETIPLTOD='                                  00196800
&ZMS               SETC  '&ZMS.&RETIPLTOD"'                             00196900
&ZMS               SETC  '&ZMS "RETIPLTOD"'                             00197000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00197100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00197200
.ZG38A             ANOP  ,                                              00197300
.*-------------------------------------------------------------------   00197400
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00197500
                   AIF   (K'&RETIPLTOD(1) LE 0).ZG38C  NO PARM          00197600
&ZXRETIPLTOD       SETC  'OUTPUT'    SET OUTPUT                         00197700
&XRETIPLTOD        SETC  '&RETIPLTOD(1)'        SET XVARIABLE           00197800
                   AIF   (N'&RETIPLTOD GT 1).ZG38C                      00197900
&XRETIPLTOD        SETC  '&RETIPLTOD'           SET XVARIABLE           00198000
.ZG38C             ANOP  ,                                              00198100
.*-------------------------------------------------------------------   00198200
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00198300
                   AIF   (K'&ZXRETIPLTOD LE 0).ZG38R  NOT I/O           00198400
                   AIF   ('&XRETIPLTOD'(1,1) NE '(').ZG38R              00198500
&ZCGPR             SETC  '&XRETIPLTOD'(2,K'&XRETIPLTOD-2)               00198600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                   00198700
                   AIF   (K'&ZCGPR GT 2).ZG38Q                          00198800
                   AIF   ('&ZCGPR' EQ '0').ZG38Q                        00198900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00199000
                   AIF   (T'&ZCGPR NE 'N').ZG38Q  INVALID REG NAME      00199100
.ZG38P             ANOP  ,                                              00199200
                   AIF   (T'&ZCGPR NE 'N').ZG38R  NON NUMERIC           00199300
                   AIF   ('&ZCGPR' LT '2').ZG38Q                        00199400
                   AIF   ('&ZCGPR' LE '12').ZG38R                       00199500
.ZG38Q             ANOP  ,                                              00199600
&ZMS               SETC  '"RETIPLTOD='                                  00199700
&ZMS               SETC  '&ZMS.&RETIPLTOD"'                             00199800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00199900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00200000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00200100
.ZG38R             ANOP  ,                                              00200200
.*-------------------------------------------------------------------   00200300
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00200400
.ZG39              ANOP  ,           END OF BYPASS CHECK                00200500
.*-------------------------------------------------------------------   00200600
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             00200700
                   AIF   ('&XMF' EQ 'M').ZG42   BYPASS IF MF=M          00200800
.*----------------------------------------------------------------***   00200900
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00201000
                   AIF   (N'&RETPTIME LE 1).ZG41A  CK NUM               00201100
&ZMS               SETC  '"RETPTIME='                                   00201200
&ZMS               SETC  '&ZMS.&RETPTIME"'                              00201300
&ZMS               SETC  '&ZMS "RETPTIME"'                              00201400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00201500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00201600
.ZG41A             ANOP  ,                                              00201700
.*-------------------------------------------------------------------   00201800
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00201900
                   AIF   (K'&RETPTIME(1) LE 0).ZG41C  NO PARM           00202000
&ZXRETPTIME        SETC  'OUTPUT'    SET OUTPUT                         00202100
&XRETPTIME         SETC  '&RETPTIME(1)'         SET XVARIABLE           00202200
                   AIF   (N'&RETPTIME GT 1).ZG41C                       00202300
&XRETPTIME         SETC  '&RETPTIME'            SET XVARIABLE           00202400
.ZG41C             ANOP  ,                                              00202500
.*-------------------------------------------------------------------   00202600
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00202700
                   AIF   (K'&ZXRETPTIME LE 0).ZG41R  NOT I/O            00202800
                   AIF   ('&XRETPTIME'(1,1) NE '(').ZG41R               00202900
&ZCGPR             SETC  '&XRETPTIME'(2,K'&XRETPTIME-2)                 00203000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG41P                   00203100
                   AIF   (K'&ZCGPR GT 2).ZG41Q                          00203200
                   AIF   ('&ZCGPR' EQ '0').ZG41Q                        00203300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00203400
                   AIF   (T'&ZCGPR NE 'N').ZG41Q  INVALID REG NAME      00203500
.ZG41P             ANOP  ,                                              00203600
                   AIF   (T'&ZCGPR NE 'N').ZG41R  NON NUMERIC           00203700
                   AIF   ('&ZCGPR' LT '2').ZG41Q                        00203800
                   AIF   ('&ZCGPR' LE '12').ZG41R                       00203900
.ZG41Q             ANOP  ,                                              00204000
&ZMS               SETC  '"RETPTIME='                                   00204100
&ZMS               SETC  '&ZMS.&RETPTIME"'                              00204200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00204300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00204400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00204500
.ZG41R             ANOP  ,                                              00204600
.*-------------------------------------------------------------------   00204700
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               00204800
.ZG42              ANOP  ,           END OF BYPASS CHECK                00204900
.*------------------------------------------------------------------    00205000
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00205100
&XREMOTE           SETC  ''          INITIALIZE XVARIABLE               00205200
.*-------------------------------------------------------------------   00205300
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00205400
.ZG45              ANOP  ,                                              00205500
                   AIF   (K'&REMOTE(1) LE 0).ZG45A                      00205600
&ZTLC              SETC 'NO'                                            00205700
                   AIF   ('&REMOTE(1)' NE '&ZTLC').ZG46                 00205800
&XREMOTE           SETC  'NO'        SET KEYWORD                        00205900
                   AIF   (N'&REMOTE LE 1).ZG45A  CK NUM                 00206000
&ZMS               SETC  '"REMOTE='                                     00206100
&ZMS               SETC  '&ZMS.&REMOTE"'                                00206200
&ZMS               SETC  '&ZMS "REMOTE"'                                00206300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00206400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00206500
.ZG45A             ANOP  ,                                              00206600
.*------------------------------------------------------------------    00206700
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00206800
&ZCVAL             SETC ''           CLEAR ERROR KEY ACCUMULATOR        00206900
.ZG45A0            AIF   (K'&HANDLE LE 0).ZG45A1  OK                    00207000
&ZCVAL             SETC '&ZCVAL HANDLE'         INCORRECT KEY USED      00207100
.ZG45A1            AIF   (K'&REXX LE 0).ZG45A2  OK                      00207200
&ZCVAL             SETC '&ZCVAL REXX'           INCORRECT KEY USED      00207300
.ZG45A2            AIF   (K'&ZCVAL LE 0).ZG45A3  OK                     00207400
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)                          00207500
&ZMS               SETC  '"REMOTE'                                      00207600
&ZMS               SETC  '&ZMS.=&REMOTE"'                               00207700
&ZMS               SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'           00207800
                   MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'           00207900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00208000
.ZG45A3            ANOP  ,                                              00208100
.*-------------------------------------------------------------------   00208200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00208300
.ZG46              ANOP  ,                                              00208400
&ZTLC              SETC 'YES'                                           00208500
                   AIF   ('&REMOTE(1)' NE '&ZTLC').ZG55                 00208600
&XREMOTE           SETC  'YES'       SET KEYWORD                        00208700
                   AIF   (N'&REMOTE LE 1).ZG46A  CK NUM                 00208800
&ZMS               SETC  '"REMOTE='                                     00208900
&ZMS               SETC  '&ZMS.&REMOTE"'                                00209000
&ZMS               SETC  '&ZMS "REMOTE"'                                00209100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00209200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00209300
.ZG46A             ANOP  ,                                              00209400
.*----------------------------------------------------------------***   00209500
.***AG.KXVAR05 NAME, OPT RQD INPUT, KEYS -XVARIABLE KEY                 00209600
                   AIF   (N'&HANDLE LE 1).ZG48A  CK NUM                 00209700
&ZMS               SETC  '"HANDLE='                                     00209800
&ZMS               SETC  '&ZMS.&HANDLE"'                                00209900
&ZMS               SETC  '&ZMS "HANDLE"'                                00210000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00210100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00210200
.ZG48A             ANOP  ,                                              00210300
.*-------------------------------------------------------------------   00210400
.***AG.KXVAR06 NAME, OPT RQD INPUT, KEYS -XVARIABLE                     00210500
&ZXHANDLE          SETC  'INPUT'     SET IN/OUTPUT                      00210600
&XHANDLE           SETC  '&HANDLE(1)'           SET XVARIABLE           00210700
                   AIF   (N'&HANDLE GT 1).ZG48B  MULTI                  00210800
&XHANDLE           SETC  '&HANDLE'   SET XVARIABLE                      00210900
.ZG48B             AIF   (K'&HANDLE(1) GT 0).ZG48C                      00211000
&ZXHANDLE          SETC  ''          RESET IN/OUTPUT                    00211100
&ZMS               SETC  'WHEN "YES" IS SPECIFIED'                      00211200
&ZMS               SETC  '&ZMS , "HANDLE" KEY AND ITS'                  00211300
                   MNOTE 8,' &ZMS ARGUMENT ARE REQUIRED.'               00211400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00211500
.ZG48C             ANOP  ,                                              00211600
.*-------------------------------------------------------------------   00211700
.***AG.KCK02 NAME, OPT RQD INPUT, KEYS -GPR OUT OF RANGE                00211800
                   AIF   (K'&ZXHANDLE LE 0).ZG48R  NOT I/O              00211900
                   AIF   ('&XHANDLE'(1,1) NE '(').ZG48R                 00212000
&ZCGPR             SETC  '&XHANDLE'(2,K'&XHANDLE-2)                     00212100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG48P                   00212200
                   AIF   (K'&ZCGPR GT 2).ZG48Q                          00212300
                   AIF   ('&ZCGPR' EQ '0').ZG48Q                        00212400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00212500
                   AIF   (T'&ZCGPR NE 'N').ZG48Q  INVALID REG NAME      00212600
.ZG48P             ANOP  ,                                              00212700
                   AIF   (T'&ZCGPR NE 'N').ZG48R  NON NUMERIC           00212800
                   AIF   ('&ZCGPR' LT '2').ZG48Q                        00212900
                   AIF   ('&ZCGPR' LE '12').ZG48R                       00213000
.ZG48Q             ANOP  ,                                              00213100
&ZMS               SETC  '"HANDLE='                                     00213200
&ZMS               SETC  '&ZMS.&HANDLE"'                                00213300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00213400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00213500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00213600
.ZG48R             ANOP  ,                                              00213700
.*------------------------------------------------------------------    00213800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00213900
&XREXX             SETC  ''          INITIALIZE XVARIABLE               00214000
.*-------------------------------------------------------------------   00214100
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00214200
.ZG52              ANOP  ,                                              00214300
                   AIF   (K'&REXX(1) LE 0).ZG52A                        00214400
&ZTLC              SETC 'NO'                                            00214500
                   AIF   ('&REXX(1)' NE '&ZTLC').ZG53                   00214600
&XREXX             SETC  'NO'        SET KEYWORD                        00214700
                   AIF   (N'&REXX LE 1).ZG52A   CK NUM                  00214800
&ZMS               SETC  '"REXX='                                       00214900
&ZMS               SETC  '&ZMS.&REXX"'                                  00215000
&ZMS               SETC  '&ZMS "REXX"'                                  00215100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00215200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00215300
.ZG52A             ANOP  ,                                              00215400
.*-------------------------------------------------------------------   00215500
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00215600
.ZG53              ANOP  ,                                              00215700
&ZTLC              SETC 'YES'                                           00215800
                   AIF   ('&REXX(1)' NE '&ZTLC').ZG54                   00215900
&XREXX             SETC  'YES'       SET KEYWORD                        00216000
                   AIF   (N'&REXX LE 1).ZG53A   CK NUM                  00216100
&ZMS               SETC  '"REXX='                                       00216200
&ZMS               SETC  '&ZMS.&REXX"'                                  00216300
&ZMS               SETC  '&ZMS "REXX"'                                  00216400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00216500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00216600
.ZG53A             ANOP  ,                                              00216700
.*------------------------------------------------------------------    00216800
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00216900
.ZG54              ANOP  ,                                              00217000
&ZXREXX            SETC  'INPUT'     SET IN/OUTPUT                      00217100
                   AIF   (K'&XREXX GT 0).ZG54E  VALID ARG               00217200
                   AIF   (T'&REXX EQ 'O').ZG54D  OMITTED                00217300
&ZASYSLNDX         SETA  0                                              00217400
.ZG54A             ANOP  ,           POSITIONAL MACRO KEY               00217500
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00217600
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG54C               00217700
&ZTLC              SETC 'REXX'                                          00217800
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG54A      00217900
.ZG54B             ANOP  ,                                              00218000
&ZXREXX            SETC  ''          RESET IN/OUTPUT                    00218100
&ZMS               SETC  'THE "REXX" KEY'                               00218200
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00218300
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00218400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00218500
                   AGO   .ZG54E                                         00218600
.ZG54C             ANOP  ,                                              00218700
&ZXREXX            SETC  ''          RESET IN/OUTPUT                    00218800
&ZMS               SETC  '"REXX='                                       00218900
&ZMS               SETC  '&ZMS.&REXX"'                                  00219000
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00219100
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00219200
&ZMS               SETC  '&ZMS "NO"'                                    00219300
&ZMS               SETC  '&ZMS OR "YES".'                               00219400
                   MNOTE 8,' &ZMS '                                     00219500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00219600
                   AGO   .ZG54E                                         00219700
.ZG54D             ANOP  ,                                              00219800
&XREXX             SETC  'NO'        SET DEFAULT KEYWORD                00219900
.ZG54E             ANOP  ,                                              00220000
.*------------------------------------------------------------------    00220100
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00220200
.ZG55              ANOP  ,                                              00220300
&ZXREMOTE          SETC  'INPUT'     SET IN/OUTPUT                      00220400
                   AIF   (K'&XREMOTE GT 0).ZG55E  VALID ARG             00220500
                   AIF   (T'&REMOTE EQ 'O').ZG55D  OMITTED              00220600
&ZASYSLNDX         SETA  0                                              00220700
.ZG55A             ANOP  ,           POSITIONAL MACRO KEY               00220800
&ZASYSLNDX         SETA  &ZASYSLNDX+1                                   00220900
                   AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG55C               00221000
&ZTLC              SETC 'REMOTE'                                        00221100
                   AIF   ('&SYSLIST(&ZASYSLNDX)' NE '&ZTLC').ZG55A      00221200
.ZG55B             ANOP  ,                                              00221300
&ZXREMOTE          SETC  ''          RESET IN/OUTPUT                    00221400
&ZMS               SETC  'THE "REMOTE" KEY'                             00221500
&ZMS               SETC  '&ZMS MUST CONTAIN ONE'                        00221600
                   MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'               00221700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00221800
                   AGO   .ZG55E                                         00221900
.ZG55C             ANOP  ,                                              00222000
&ZXREMOTE          SETC  ''          RESET IN/OUTPUT                    00222100
&ZMS               SETC  '"REMOTE='                                     00222200
&ZMS               SETC  '&ZMS.&REMOTE"'                                00222300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00222400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00222500
&ZMS               SETC  '&ZMS "NO"'                                    00222600
&ZMS               SETC  '&ZMS OR "YES".'                               00222700
                   MNOTE 8,' &ZMS '                                     00222800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00222900
                   AGO   .ZG55E                                         00223000
.ZG55D             ANOP  ,                                              00223100
&XREMOTE           SETC  'NO'        SET DEFAULT KEYWORD                00223200
.ZG55E             ANOP  ,                                              00223300
.*----------------------------------------------------------------***   00223400
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00223500
                   AIF   (N'&RETCODE LE 1).ZG57A  CK NUM                00223600
&ZMS               SETC  '"RETCODE='                                    00223700
&ZMS               SETC  '&ZMS.&RETCODE"'                               00223800
&ZMS               SETC  '&ZMS "RETCODE"'                               00223900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00224000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00224100
.ZG57A             ANOP  ,                                              00224200
.*-------------------------------------------------------------------   00224300
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00224400
                   AIF   (K'&RETCODE(1) LE 0).ZG57C  NO PARM            00224500
&ZXRETCODE         SETC  'OUTPUT'    SET OUTPUT                         00224600
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00224700
                   AIF   (N'&RETCODE GT 1).ZG57C                        00224800
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00224900
.ZG57C             ANOP  ,                                              00225000
.*-------------------------------------------------------------------   00225100
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00225200
                   AIF   (K'&ZXRETCODE LE 0).ZG57R  NOT I/O             00225300
                   AIF   ('&XRETCODE'(1,1) NE '(').ZG57R                00225400
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00225500
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG57P                   00225600
                   AIF   (K'&ZCGPR GT 2).ZG57Q                          00225700
                   AIF   ('&ZCGPR' EQ '0').ZG57Q                        00225800
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00225900
                   AIF   (T'&ZCGPR NE 'N').ZG57Q  INVALID REG NAME      00226000
.ZG57P             ANOP  ,                                              00226100
                   AIF   (T'&ZCGPR NE 'N').ZG57R  NON NUMERIC           00226200
                   AIF   ('&ZCGPR' EQ '15').ZG57R                       00226300
                   AIF   ('&ZCGPR' LT '2').ZG57Q                        00226400
                   AIF   ('&ZCGPR' LE '12').ZG57R                       00226500
.ZG57Q             ANOP  ,                                              00226600
&ZMS               SETC  '"RETCODE='                                    00226700
&ZMS               SETC  '&ZMS.&RETCODE"'                               00226800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00226900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12) OR (15).'       00227000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00227100
.ZG57R             ANOP  ,                                              00227200
.*----------------------------------------------------------------***   00227300
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    00227400
                   AIF   (N'&RSNCODE LE 1).ZG60A  CK NUM                00227500
&ZMS               SETC  '"RSNCODE='                                    00227600
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00227700
&ZMS               SETC  '&ZMS "RSNCODE"'                               00227800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00227900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00228000
.ZG60A             ANOP  ,                                              00228100
.*-------------------------------------------------------------------   00228200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        00228300
                   AIF   (K'&RSNCODE(1) LE 0).ZG60C  NO PARM            00228400
&ZXRSNCODE         SETC  'OUTPUT'    SET OUTPUT                         00228500
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00228600
                   AIF   (N'&RSNCODE GT 1).ZG60C                        00228700
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00228800
.ZG60C             ANOP  ,                                              00228900
.*-------------------------------------------------------------------   00229000
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00229100
                   AIF   (K'&ZXRSNCODE LE 0).ZG60R  NOT I/O             00229200
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZG60R                00229300
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00229400
                   AIF   ('&ZCGPR'(1,1) NE '0').ZG60P                   00229500
                   AIF   (K'&ZCGPR GT 2).ZG60Q                          00229600
                   AIF   ('&ZCGPR' EQ '0').ZG60R                        00229700
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00229800
                   AIF   (T'&ZCGPR NE 'N').ZG60Q  INVALID REG NAME      00229900
.ZG60P             ANOP  ,                                              00230000
                   AIF   (T'&ZCGPR NE 'N').ZG60R  NON NUMERIC           00230100
                   AIF   ('&ZCGPR' EQ '0').ZG60R                        00230200
                   AIF   ('&ZCGPR' LT '2').ZG60Q                        00230300
                   AIF   ('&ZCGPR' LE '12').ZG60R                       00230400
.ZG60Q             ANOP  ,                                              00230500
&ZMS               SETC  '"RSNCODE='                                    00230600
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00230700
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00230800
                   MNOTE 8,' &ZMS IN THE RANGE (0) OR (2)-(12).'        00230900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00231000
.ZG60R             ANOP  ,                                              00231100
.******************************************************************     00231200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00231300
.******************************************************************     00231400
                   ACTR  10000                                          00231500
.*----------------------------------------------------------------***   00231600
.***AH.P02 EXTRA POSITIONALS                                            00231700
                   AIF   (N'&SYSLIST LE 0).ZGLISTX  NO EXTRAS           00231800
                   AIF   (N'&SYSLIST NE 2).ZGLISTX1  NOT NULL           00231900
                   AIF   ('&SYSLIST(1)' NE '').ZGLISTX1  NOT NULL       00232000
                   AIF   ('&SYSLIST(2)' EQ '').ZGLISTX  NOT NULL        00232100
.ZGLISTX1          ANOP  ,                                              00232200
&ZCVAL             SETC  ''          ERROR FIELD                        00232300
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00232400
.ZGLIST2           ANOP  ,                                              00232500
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00232600
                   AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE           00232700
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00232800
                   AGO   .ZGLIST2                                       00232900
.*                                                                      00233000
.ZGLIST3           ANOP  ,                                              00233100
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00233200
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00233300
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00233400
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00233500
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00233600
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00233700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00233800
.ZGLISTX           ANOP  ,                                              00233900
&ZASYSLNDX         SETA  0                                              00234000
.*-------------------------------------------------------------------   00234100
.***AG.MF04 MF=(SLME)                                                   00234200
.ZGMFX             ANOP  ,           END OF FULL SYNTAX CHECK           00234300
.********************************************************************   00234400
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             00234500
.********************************************************************   00234600
                   ACTR  10000                                          00234700
.*-------------------------------------------------------------------   00234800
.***AE.MF01 MF=(SLME)                                                   00234900
                   AIF   ('&XMF' EQ 'L').ZEMFX                          00235000
                   AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                 00235100
.********************************************************************   00235200
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        00235300
.********************************************************************   00235400
&XSECCHECK         SETC  ''          INITIALIZE XVARIABLE               00235500
&XIPL              SETC  ''          INITIALIZE XVARIABLE               00235600
&XINSTANCE         SETC  ''          INITIALIZE XVARIABLE               00235700
&XREMOTE           SETC  ''          INITIALIZE XVARIABLE               00235800
&XREXX             SETC  ''          INITIALIZE XVARIABLE               00235900
.*----------------------------------------------------------------***   00236000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00236100
                   AIF   (N'&CHECKOWNER LE 1).ZE2A  CK NUM              00236200
&ZMS               SETC  '"CHECKOWNER='                                 00236300
&ZMS               SETC  '&ZMS.&CHECKOWNER"'                            00236400
&ZMS               SETC  '&ZMS "CHECKOWNER"'                            00236500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00236600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00236700
.ZE2A              ANOP  ,                                              00236800
.*-------------------------------------------------------------------   00236900
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00237000
                   AIF   (K'&CHECKOWNER(1) LE 0).ZE2B NO PRM            00237100
&ZXCHECKOWNER      SETC  'INPUT'     SET IN/OUTPUT                      00237200
&XCHECKOWNER       SETC  '&CHECKOWNER(1)'       SET XVARIABLE           00237300
                   AIF   (N'&CHECKOWNER GT 1).ZE2B                      00237400
.*                 ANOP                                                 00237500
&XCHECKOWNER       SETC  '&CHECKOWNER'          SET XVARIABLE           00237600
.ZE2B              ANOP  ,                                              00237700
.*-------------------------------------------------------------------   00237800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00237900
                   AIF   (K'&ZXCHECKOWNER LE 0).ZE2R  NOT I/O           00238000
                   AIF   ('&XCHECKOWNER'(1,1) NE '(').ZE2R              00238100
&ZCGPR             SETC  '&XCHECKOWNER'(2,K'&XCHECKOWNER-2)             00238200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE2P                    00238300
                   AIF   (K'&ZCGPR GT 2).ZE2Q                           00238400
                   AIF   ('&ZCGPR' EQ '0').ZE2Q                         00238500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00238600
                   AIF   (T'&ZCGPR NE 'N').ZE2Q  INVALID REG NAME       00238700
.ZE2P              ANOP  ,                                              00238800
                   AIF   (T'&ZCGPR NE 'N').ZE2R  NON NUMERIC            00238900
                   AIF   ('&ZCGPR' LT '2').ZE2Q                         00239000
                   AIF   ('&ZCGPR' LE '12').ZE2R                        00239100
.ZE2Q              ANOP  ,                                              00239200
&ZMS               SETC  '"CHECKOWNER='                                 00239300
&ZMS               SETC  '&ZMS.&CHECKOWNER"'                            00239400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00239500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00239600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00239700
.ZE2R              ANOP  ,                                              00239800
.*----------------------------------------------------------------***   00239900
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00240000
                   AIF   (N'&CHECKNAME LE 1).ZE5A  CK NUM               00240100
&ZMS               SETC  '"CHECKNAME='                                  00240200
&ZMS               SETC  '&ZMS.&CHECKNAME"'                             00240300
&ZMS               SETC  '&ZMS "CHECKNAME"'                             00240400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00240500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00240600
.ZE5A              ANOP  ,                                              00240700
.*-------------------------------------------------------------------   00240800
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00240900
                   AIF   (K'&CHECKNAME(1) LE 0).ZE5B NO PRM             00241000
&ZXCHECKNAME       SETC  'INPUT'     SET IN/OUTPUT                      00241100
&XCHECKNAME        SETC  '&CHECKNAME(1)'        SET XVARIABLE           00241200
                   AIF   (N'&CHECKNAME GT 1).ZE5B                       00241300
.*                 ANOP                                                 00241400
&XCHECKNAME        SETC  '&CHECKNAME'           SET XVARIABLE           00241500
.ZE5B              ANOP  ,                                              00241600
.*-------------------------------------------------------------------   00241700
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00241800
                   AIF   (K'&ZXCHECKNAME LE 0).ZE5R  NOT I/O            00241900
                   AIF   ('&XCHECKNAME'(1,1) NE '(').ZE5R               00242000
&ZCGPR             SETC  '&XCHECKNAME'(2,K'&XCHECKNAME-2)               00242100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE5P                    00242200
                   AIF   (K'&ZCGPR GT 2).ZE5Q                           00242300
                   AIF   ('&ZCGPR' EQ '0').ZE5Q                         00242400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00242500
                   AIF   (T'&ZCGPR NE 'N').ZE5Q  INVALID REG NAME       00242600
.ZE5P              ANOP  ,                                              00242700
                   AIF   (T'&ZCGPR NE 'N').ZE5R  NON NUMERIC            00242800
                   AIF   ('&ZCGPR' LT '2').ZE5Q                         00242900
                   AIF   ('&ZCGPR' LE '12').ZE5R                        00243000
.ZE5Q              ANOP  ,                                              00243100
&ZMS               SETC  '"CHECKNAME='                                  00243200
&ZMS               SETC  '&ZMS.&CHECKNAME"'                             00243300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00243400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00243500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00243600
.ZE5R              ANOP  ,                                              00243700
.*-------------------------------------------------------------------   00243800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00243900
&ZTLC              SETC 'UNAUTH'                                        00244000
                   AIF   ('&SECCHECK(1)' NE '&ZTLC').ZE9A               00244100
&XSECCHECK         SETC  'UNAUTH'    SET KEYWORD                        00244200
                   AIF   (N'&SECCHECK LE 1).ZE9A  CK NUM                00244300
&ZMS               SETC  '"SECCHECK='                                   00244400
&ZMS               SETC  '&ZMS.&SECCHECK"'                              00244500
&ZMS               SETC  '&ZMS "SECCHECK"'                              00244600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00244700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00244800
.ZE9A              ANOP  ,                                              00244900
.*-------------------------------------------------------------------   00245000
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00245100
&ZTLC              SETC 'ALL'                                           00245200
                   AIF   ('&SECCHECK(1)' NE '&ZTLC').ZE10A              00245300
&XSECCHECK         SETC  'ALL'       SET KEYWORD                        00245400
                   AIF   (N'&SECCHECK LE 1).ZE10A  CK NUM               00245500
&ZMS               SETC  '"SECCHECK='                                   00245600
&ZMS               SETC  '&ZMS.&SECCHECK"'                              00245700
&ZMS               SETC  '&ZMS "SECCHECK"'                              00245800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00245900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00246000
.ZE10A             ANOP  ,                                              00246100
.*------------------------------------------------------------------    00246200
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00246300
.ZE11              AIF   (K'&XSECCHECK GT 0).ZE11A                      00246400
                   AIF   (K'&SECCHECK(1) LE 0).ZE11B                    00246500
&ZMS               SETC  '"SECCHECK='                                   00246600
&ZMS               SETC  '&ZMS.&SECCHECK"'                              00246700
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00246800
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00246900
&ZMS               SETC  '&ZMS "UNAUTH"'                                00247000
&ZMS               SETC  '&ZMS OR "ALL".'                               00247100
                   MNOTE 8,' &ZMS '                                     00247200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00247300
                   AGO   .ZE11B                                         00247400
.*                                                                      00247500
.ZE11A             ANOP  ,                                              00247600
&ZXSECCHECK        SETC  'INPUT'     SET IN/OUTPUT                      00247700
.ZE11B             ANOP  ,                                              00247800
.*-------------------------------------------------------------------   00247900
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00248000
&ZTLC              SETC 'CURRENT'                                       00248100
                   AIF   ('&IPL(1)' NE '&ZTLC').ZE14A                   00248200
&XIPL              SETC  'CURRENT'   SET KEYWORD                        00248300
                   AIF   (N'&IPL LE 1).ZE14A    CK NUM                  00248400
&ZMS               SETC  '"IPL='                                        00248500
&ZMS               SETC  '&ZMS.&IPL"'                                   00248600
&ZMS               SETC  '&ZMS "IPL"'                                   00248700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00248800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00248900
.ZE14A             ANOP  ,                                              00249000
.*-------------------------------------------------------------------   00249100
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00249200
&ZTLC              SETC 'PRIOR'                                         00249300
                   AIF   ('&IPL(1)' NE '&ZTLC').ZE15A                   00249400
&XIPL              SETC  'PRIOR'     SET KEYWORD                        00249500
                   AIF   (N'&IPL LE 1).ZE15A    CK NUM                  00249600
&ZMS               SETC  '"IPL='                                        00249700
&ZMS               SETC  '&ZMS.&IPL"'                                   00249800
&ZMS               SETC  '&ZMS "IPL"'                                   00249900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00250000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00250100
.ZE15A             ANOP  ,                                              00250200
.*------------------------------------------------------------------    00250300
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00250400
.ZE16              AIF   (K'&XIPL GT 0).ZE16A                           00250500
                   AIF   (K'&IPL(1) LE 0).ZE16B                         00250600
&ZMS               SETC  '"IPL='                                        00250700
&ZMS               SETC  '&ZMS.&IPL"'                                   00250800
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00250900
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00251000
&ZMS               SETC  '&ZMS "CURRENT"'                               00251100
&ZMS               SETC  '&ZMS OR "PRIOR".'                             00251200
                   MNOTE 8,' &ZMS '                                     00251300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00251400
                   AGO   .ZE16B                                         00251500
.*                                                                      00251600
.ZE16A             ANOP  ,                                              00251700
&ZXIPL             SETC  'INPUT'     SET IN/OUTPUT                      00251800
.ZE16B             ANOP  ,                                              00251900
.*-------------------------------------------------------------------   00252000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00252100
&ZTLC              SETC 'FIRST'                                         00252200
                   AIF   ('&INSTANCE(1)' NE '&ZTLC').ZE19A              00252300
&XINSTANCE         SETC  'FIRST'     SET KEYWORD                        00252400
                   AIF   (N'&INSTANCE LE 1).ZE19A  CK NUM               00252500
&ZMS               SETC  '"INSTANCE='                                   00252600
&ZMS               SETC  '&ZMS.&INSTANCE"'                              00252700
&ZMS               SETC  '&ZMS "INSTANCE"'                              00252800
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00252900
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00253000
.ZE19A             ANOP  ,                                              00253100
.*-------------------------------------------------------------------   00253200
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00253300
&ZTLC              SETC 'MOSTRECENT'                                    00253400
                   AIF   ('&INSTANCE(1)' NE '&ZTLC').ZE20A              00253500
&XINSTANCE         SETC  'MOSTRECENT'           SET KEYWORD             00253600
                   AIF   (N'&INSTANCE LE 1).ZE20A  CK NUM               00253700
&ZMS               SETC  '"INSTANCE='                                   00253800
&ZMS               SETC  '&ZMS.&INSTANCE"'                              00253900
&ZMS               SETC  '&ZMS "INSTANCE"'                              00254000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00254100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00254200
.ZE20A             ANOP  ,                                              00254300
.*------------------------------------------------------------------    00254400
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           00254500
.ZE21              AIF   (K'&XINSTANCE GT 0).ZE21A                      00254600
                   AIF   (K'&INSTANCE(1) LE 0).ZE21B                    00254700
&ZMS               SETC  '"INSTANCE='                                   00254800
&ZMS               SETC  '&ZMS.&INSTANCE"'                              00254900
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00255000
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00255100
&ZMS               SETC  '&ZMS "FIRST"'                                 00255200
&ZMS               SETC  '&ZMS OR "MOSTRECENT".'                        00255300
                   MNOTE 8,' &ZMS '                                     00255400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00255500
                   AGO   .ZE21B                                         00255600
.*                                                                      00255700
.ZE21A             ANOP  ,                                              00255800
&ZXINSTANCE        SETC  'INPUT'     SET IN/OUTPUT                      00255900
.ZE21B             ANOP  ,                                              00256000
.*----------------------------------------------------------------***   00256100
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00256200
                   AIF   (N'&BUFFER LE 1).ZE23A  CK NUM                 00256300
&ZMS               SETC  '"BUFFER='                                     00256400
&ZMS               SETC  '&ZMS.&BUFFER"'                                00256500
&ZMS               SETC  '&ZMS "BUFFER"'                                00256600
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00256700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00256800
.ZE23A             ANOP  ,                                              00256900
.*-------------------------------------------------------------------   00257000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00257100
                   AIF   (K'&BUFFER(1) LE 0).ZE23B NO PRM               00257200
&ZXBUFFER          SETC  'INPUT'     SET IN/OUTPUT                      00257300
&XBUFFER           SETC  '&BUFFER(1)'           SET XVARIABLE           00257400
                   AIF   (N'&BUFFER GT 1).ZE23B                         00257500
.*                 ANOP                                                 00257600
&XBUFFER           SETC  '&BUFFER'   SET XVARIABLE                      00257700
.ZE23B             ANOP  ,                                              00257800
.*-------------------------------------------------------------------   00257900
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00258000
                   AIF   (K'&ZXBUFFER LE 0).ZE23R  NOT I/O              00258100
                   AIF   ('&XBUFFER'(1,1) NE '(').ZE23R                 00258200
&ZCGPR             SETC  '&XBUFFER'(2,K'&XBUFFER-2)                     00258300
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE23P                   00258400
                   AIF   (K'&ZCGPR GT 2).ZE23Q                          00258500
                   AIF   ('&ZCGPR' EQ '0').ZE23Q                        00258600
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00258700
                   AIF   (T'&ZCGPR NE 'N').ZE23Q  INVALID REG NAME      00258800
.ZE23P             ANOP  ,                                              00258900
                   AIF   (T'&ZCGPR NE 'N').ZE23R  NON NUMERIC           00259000
                   AIF   ('&ZCGPR' LT '2').ZE23Q                        00259100
                   AIF   ('&ZCGPR' LE '12').ZE23R                       00259200
.ZE23Q             ANOP  ,                                              00259300
&ZMS               SETC  '"BUFFER='                                     00259400
&ZMS               SETC  '&ZMS.&BUFFER"'                                00259500
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00259600
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00259700
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00259800
.ZE23R             ANOP  ,                                              00259900
.*----------------------------------------------------------------***   00260000
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00260100
                   AIF   (N'&DATALEN LE 1).ZE25A  CK NUM                00260200
&ZMS               SETC  '"DATALEN='                                    00260300
&ZMS               SETC  '&ZMS.&DATALEN"'                               00260400
&ZMS               SETC  '&ZMS "DATALEN"'                               00260500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00260600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00260700
.ZE25A             ANOP  ,                                              00260800
.*-------------------------------------------------------------------   00260900
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00261000
                   AIF   (K'&DATALEN(1) LE 0).ZE25B NO PRM              00261100
&ZXDATALEN         SETC  'INPUT'     SET IN/OUTPUT                      00261200
&XDATALEN          SETC  '&DATALEN(1)'          SET XVARIABLE           00261300
                   AIF   (N'&DATALEN GT 1).ZE25B                        00261400
.*                 ANOP                                                 00261500
&XDATALEN          SETC  '&DATALEN'  SET XVARIABLE                      00261600
.ZE25B             ANOP  ,                                              00261700
.*-------------------------------------------------------------------   00261800
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00261900
                   AIF   (K'&ZXDATALEN LE 0).ZE25R  NOT I/O             00262000
                   AIF   ('&XDATALEN'(1,1) NE '(').ZE25R                00262100
&ZCGPR             SETC  '&XDATALEN'(2,K'&XDATALEN-2)                   00262200
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE25P                   00262300
                   AIF   (K'&ZCGPR GT 2).ZE25Q                          00262400
                   AIF   ('&ZCGPR' EQ '0').ZE25Q                        00262500
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00262600
                   AIF   (T'&ZCGPR NE 'N').ZE25Q  INVALID REG NAME      00262700
.ZE25P             ANOP  ,                                              00262800
                   AIF   (T'&ZCGPR NE 'N').ZE25R  NON NUMERIC           00262900
                   AIF   ('&ZCGPR' LT '2').ZE25Q                        00263000
                   AIF   ('&ZCGPR' LE '12').ZE25R                       00263100
.ZE25Q             ANOP  ,                                              00263200
&ZMS               SETC  '"DATALEN='                                    00263300
&ZMS               SETC  '&ZMS.&DATALEN"'                               00263400
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00263500
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00263600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00263700
.ZE25R             ANOP  ,                                              00263800
.*----------------------------------------------------------------***   00263900
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          00264000
                   AIF   (N'&STARTBYTE LE 1).ZE28A  CK NUM              00264100
&ZMS               SETC  '"STARTBYTE='                                  00264200
&ZMS               SETC  '&ZMS.&STARTBYTE"'                             00264300
&ZMS               SETC  '&ZMS "STARTBYTE"'                             00264400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00264500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00264600
.ZE28A             ANOP  ,                                              00264700
.*-------------------------------------------------------------------   00264800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     00264900
                   AIF   (K'&STARTBYTE(1) LE 0).ZE28B NO PRM            00265000
&ZXSTARTBYTE       SETC  'INPUT'     SET IN/OUTPUT                      00265100
&XSTARTBYTE        SETC  '&STARTBYTE(1)'        SET XVARIABLE           00265200
                   AIF   (N'&STARTBYTE GT 1).ZE28B                      00265300
.*                 ANOP                                                 00265400
&XSTARTBYTE        SETC  '&STARTBYTE'           SET XVARIABLE           00265500
.ZE28B             ANOP  ,                                              00265600
.*-------------------------------------------------------------------   00265700
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    00265800
                   AIF   (K'&ZXSTARTBYTE LE 0).ZE28R  NOT I/O           00265900
                   AIF   ('&XSTARTBYTE'(1,1) NE '(').ZE28R              00266000
&ZCGPR             SETC  '&XSTARTBYTE'(2,K'&XSTARTBYTE-2)               00266100
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE28P                   00266200
                   AIF   (K'&ZCGPR GT 2).ZE28Q                          00266300
                   AIF   ('&ZCGPR' EQ '0').ZE28Q                        00266400
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00266500
                   AIF   (T'&ZCGPR NE 'N').ZE28Q  INVALID REG NAME      00266600
.ZE28P             ANOP  ,                                              00266700
                   AIF   (T'&ZCGPR NE 'N').ZE28R  NON NUMERIC           00266800
                   AIF   ('&ZCGPR' LT '2').ZE28Q                        00266900
                   AIF   ('&ZCGPR' LE '12').ZE28R                       00267000
.ZE28Q             ANOP  ,                                              00267100
&ZMS               SETC  '"STARTBYTE='                                  00267200
&ZMS               SETC  '&ZMS.&STARTBYTE"'                             00267300
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00267400
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00267500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00267600
.ZE28R             ANOP  ,                                              00267700
.*----------------------------------------------------------------***   00267800
.***AE.KXVAR03 NAME, RQD OUTPUT, KEYS -XVAR KEY                         00267900
                   AIF   (N'&BYTESAVAIL LE 1).ZE31A  CK NUM             00268000
&ZMS               SETC  '"BYTESAVAIL='                                 00268100
&ZMS               SETC  '&ZMS.&BYTESAVAIL"'                            00268200
&ZMS               SETC  '&ZMS "BYTESAVAIL"'                            00268300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00268400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00268500
.ZE31A             ANOP  ,                                              00268600
.*-------------------------------------------------------------------   00268700
.***AE.KXVAR04 NAME, RQD OUTPUT, KEYS -XVAR ARGUMENT                    00268800
                   AIF   (K'&BYTESAVAIL(1) LE 0).ZE31B NO PRM           00268900
&ZXBYTESAVAIL      SETC  'OUTPUT'    SET IN/OUTPUT                      00269000
&XBYTESAVAIL       SETC  '&BYTESAVAIL(1)'       SET XVARIABLE           00269100
                   AIF   (N'&BYTESAVAIL GT 1).ZE31B                     00269200
.*                 ANOP                                                 00269300
&XBYTESAVAIL       SETC  '&BYTESAVAIL'          SET XVARIABLE           00269400
.ZE31B             ANOP  ,                                              00269500
.*-------------------------------------------------------------------   00269600
.***AE.KCK02 NAME, RQD OUTPUT, KEYS -GPR OUT OF RANGE                   00269700
                   AIF   (K'&ZXBYTESAVAIL LE 0).ZE31R  NOT I/O          00269800
                   AIF   ('&XBYTESAVAIL'(1,1) NE '(').ZE31R             00269900
&ZCGPR             SETC  '&XBYTESAVAIL'(2,K'&XBYTESAVAIL-2)             00270000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE31P                   00270100
                   AIF   (K'&ZCGPR GT 2).ZE31Q                          00270200
                   AIF   ('&ZCGPR' EQ '0').ZE31Q                        00270300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00270400
                   AIF   (T'&ZCGPR NE 'N').ZE31Q  INVALID REG NAME      00270500
.ZE31P             ANOP  ,                                              00270600
                   AIF   (T'&ZCGPR NE 'N').ZE31R  NON NUMERIC           00270700
                   AIF   ('&ZCGPR' LT '2').ZE31Q                        00270800
                   AIF   ('&ZCGPR' LE '12').ZE31R                       00270900
.ZE31Q             ANOP  ,                                              00271000
&ZMS               SETC  '"BYTESAVAIL='                                 00271100
&ZMS               SETC  '&ZMS.&BYTESAVAIL"'                            00271200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00271300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00271400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00271500
.ZE31R             ANOP  ,                                              00271600
.*----------------------------------------------------------------***   00271700
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00271800
                   AIF   (N'&BYTESPROVIDED LE 1).ZE34A  CK NUM          00271900
&ZMS               SETC  '"BYTESPROVIDED='                              00272000
&ZMS               SETC  '&ZMS.&BYTESPROVIDED"'                         00272100
&ZMS               SETC  '&ZMS "BYTESPROVIDED"'                         00272200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00272300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00272400
.ZE34A             ANOP  ,                                              00272500
.*-------------------------------------------------------------------   00272600
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00272700
                   AIF   (K'&BYTESPROVIDED(1) LE 0).ZE34B NO PRM        00272800
&ZXBYTESPROVIDED   SETC  'OUTPUT'    SET IN/OUTPUT                      00272900
&XBYTESPROVIDED    SETC  '&BYTESPROVIDED(1)'    SET XVARIABLE           00273000
                   AIF   (N'&BYTESPROVIDED GT 1).ZE34B                  00273100
.*                 ANOP                                                 00273200
&XBYTESPROVIDED    SETC  '&BYTESPROVIDED'       SET XVARIABLE           00273300
.ZE34B             ANOP  ,                                              00273400
.*-------------------------------------------------------------------   00273500
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00273600
                   AIF   (K'&ZXBYTESPROVIDED LE 0).ZE34R  NOT I/O       00273700
                   AIF   ('&XBYTESPROVIDED'(1,1) NE '(').ZE34R          00273800
&ZCGPR             SETC  '&XBYTESPROVIDED'(2,K'&XBYTESPROVIDED-2)       00273900
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE34P                   00274000
                   AIF   (K'&ZCGPR GT 2).ZE34Q                          00274100
                   AIF   ('&ZCGPR' EQ '0').ZE34Q                        00274200
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00274300
                   AIF   (T'&ZCGPR NE 'N').ZE34Q  INVALID REG NAME      00274400
.ZE34P             ANOP  ,                                              00274500
                   AIF   (T'&ZCGPR NE 'N').ZE34R  NON NUMERIC           00274600
                   AIF   ('&ZCGPR' LT '2').ZE34Q                        00274700
                   AIF   ('&ZCGPR' LE '12').ZE34R                       00274800
.ZE34Q             ANOP  ,                                              00274900
&ZMS               SETC  '"BYTESPROVIDED='                              00275000
&ZMS               SETC  '&ZMS.&BYTESPROVIDED"'                         00275100
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00275200
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00275300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00275400
.ZE34R             ANOP  ,                                              00275500
.*----------------------------------------------------------------***   00275600
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00275700
                   AIF   (N'&RETIPLTOD LE 1).ZE38A  CK NUM              00275800
&ZMS               SETC  '"RETIPLTOD='                                  00275900
&ZMS               SETC  '&ZMS.&RETIPLTOD"'                             00276000
&ZMS               SETC  '&ZMS "RETIPLTOD"'                             00276100
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00276200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00276300
.ZE38A             ANOP  ,                                              00276400
.*-------------------------------------------------------------------   00276500
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00276600
                   AIF   (K'&RETIPLTOD(1) LE 0).ZE38B NO PRM            00276700
&ZXRETIPLTOD       SETC  'OUTPUT'    SET IN/OUTPUT                      00276800
&XRETIPLTOD        SETC  '&RETIPLTOD(1)'        SET XVARIABLE           00276900
                   AIF   (N'&RETIPLTOD GT 1).ZE38B                      00277000
.*                 ANOP                                                 00277100
&XRETIPLTOD        SETC  '&RETIPLTOD'           SET XVARIABLE           00277200
.ZE38B             ANOP  ,                                              00277300
.*-------------------------------------------------------------------   00277400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00277500
                   AIF   (K'&ZXRETIPLTOD LE 0).ZE38R  NOT I/O           00277600
                   AIF   ('&XRETIPLTOD'(1,1) NE '(').ZE38R              00277700
&ZCGPR             SETC  '&XRETIPLTOD'(2,K'&XRETIPLTOD-2)               00277800
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE38P                   00277900
                   AIF   (K'&ZCGPR GT 2).ZE38Q                          00278000
                   AIF   ('&ZCGPR' EQ '0').ZE38Q                        00278100
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00278200
                   AIF   (T'&ZCGPR NE 'N').ZE38Q  INVALID REG NAME      00278300
.ZE38P             ANOP  ,                                              00278400
                   AIF   (T'&ZCGPR NE 'N').ZE38R  NON NUMERIC           00278500
                   AIF   ('&ZCGPR' LT '2').ZE38Q                        00278600
                   AIF   ('&ZCGPR' LE '12').ZE38R                       00278700
.ZE38Q             ANOP  ,                                              00278800
&ZMS               SETC  '"RETIPLTOD='                                  00278900
&ZMS               SETC  '&ZMS.&RETIPLTOD"'                             00279000
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00279100
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00279200
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00279300
.ZE38R             ANOP  ,                                              00279400
.*----------------------------------------------------------------***   00279500
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00279600
                   AIF   (N'&RETPTIME LE 1).ZE41A  CK NUM               00279700
&ZMS               SETC  '"RETPTIME='                                   00279800
&ZMS               SETC  '&ZMS.&RETPTIME"'                              00279900
&ZMS               SETC  '&ZMS "RETPTIME"'                              00280000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00280100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00280200
.ZE41A             ANOP  ,                                              00280300
.*-------------------------------------------------------------------   00280400
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00280500
                   AIF   (K'&RETPTIME(1) LE 0).ZE41B NO PRM             00280600
&ZXRETPTIME        SETC  'OUTPUT'    SET IN/OUTPUT                      00280700
&XRETPTIME         SETC  '&RETPTIME(1)'         SET XVARIABLE           00280800
                   AIF   (N'&RETPTIME GT 1).ZE41B                       00280900
.*                 ANOP                                                 00281000
&XRETPTIME         SETC  '&RETPTIME'            SET XVARIABLE           00281100
.ZE41B             ANOP  ,                                              00281200
.*-------------------------------------------------------------------   00281300
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00281400
                   AIF   (K'&ZXRETPTIME LE 0).ZE41R  NOT I/O            00281500
                   AIF   ('&XRETPTIME'(1,1) NE '(').ZE41R               00281600
&ZCGPR             SETC  '&XRETPTIME'(2,K'&XRETPTIME-2)                 00281700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE41P                   00281800
                   AIF   (K'&ZCGPR GT 2).ZE41Q                          00281900
                   AIF   ('&ZCGPR' EQ '0').ZE41Q                        00282000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00282100
                   AIF   (T'&ZCGPR NE 'N').ZE41Q  INVALID REG NAME      00282200
.ZE41P             ANOP  ,                                              00282300
                   AIF   (T'&ZCGPR NE 'N').ZE41R  NON NUMERIC           00282400
                   AIF   ('&ZCGPR' LT '2').ZE41Q                        00282500
                   AIF   ('&ZCGPR' LE '12').ZE41R                       00282600
.ZE41Q             ANOP  ,                                              00282700
&ZMS               SETC  '"RETPTIME='                                   00282800
&ZMS               SETC  '&ZMS.&RETPTIME"'                              00282900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00283000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00283100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00283200
.ZE41R             ANOP  ,                                              00283300
.*-------------------------------------------------------------------   00283400
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00283500
&ZTLC              SETC 'NO'                                            00283600
                   AIF   ('&REMOTE(1)' NE '&ZTLC').ZE45A                00283700
&XREMOTE           SETC  'NO'        SET KEYWORD                        00283800
                   AIF   (N'&REMOTE LE 1).ZE45A  CK NUM                 00283900
&ZMS               SETC  '"REMOTE='                                     00284000
&ZMS               SETC  '&ZMS.&REMOTE"'                                00284100
&ZMS               SETC  '&ZMS "REMOTE"'                                00284200
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00284300
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00284400
.ZE45A             ANOP  ,                                              00284500
.*-------------------------------------------------------------------   00284600
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00284700
&ZTLC              SETC 'YES'                                           00284800
                   AIF   ('&REMOTE(1)' NE '&ZTLC').ZE46A                00284900
&XREMOTE           SETC  'YES'       SET KEYWORD                        00285000
                   AIF   (N'&REMOTE LE 1).ZE46A  CK NUM                 00285100
&ZMS               SETC  '"REMOTE='                                     00285200
&ZMS               SETC  '&ZMS.&REMOTE"'                                00285300
&ZMS               SETC  '&ZMS "REMOTE"'                                00285400
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00285500
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00285600
.ZE46A             ANOP  ,                                              00285700
.*----------------------------------------------------------------***   00285800
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          00285900
                   AIF   (N'&HANDLE LE 1).ZE48A  CK NUM                 00286000
&ZMS               SETC  '"HANDLE='                                     00286100
&ZMS               SETC  '&ZMS.&HANDLE"'                                00286200
&ZMS               SETC  '&ZMS "HANDLE"'                                00286300
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00286400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00286500
.ZE48A             ANOP  ,                                              00286600
.*-------------------------------------------------------------------   00286700
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     00286800
                   AIF   (K'&HANDLE(1) LE 0).ZE48B NO PRM               00286900
&ZXHANDLE          SETC  'INPUT'     SET IN/OUTPUT                      00287000
&XHANDLE           SETC  '&HANDLE(1)'           SET XVARIABLE           00287100
                   AIF   (N'&HANDLE GT 1).ZE48B                         00287200
.*                 ANOP                                                 00287300
&XHANDLE           SETC  '&HANDLE'   SET XVARIABLE                      00287400
.ZE48B             ANOP  ,                                              00287500
.*-------------------------------------------------------------------   00287600
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    00287700
                   AIF   (K'&ZXHANDLE LE 0).ZE48R  NOT I/O              00287800
                   AIF   ('&XHANDLE'(1,1) NE '(').ZE48R                 00287900
&ZCGPR             SETC  '&XHANDLE'(2,K'&XHANDLE-2)                     00288000
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE48P                   00288100
                   AIF   (K'&ZCGPR GT 2).ZE48Q                          00288200
                   AIF   ('&ZCGPR' EQ '0').ZE48Q                        00288300
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00288400
                   AIF   (T'&ZCGPR NE 'N').ZE48Q  INVALID REG NAME      00288500
.ZE48P             ANOP  ,                                              00288600
                   AIF   (T'&ZCGPR NE 'N').ZE48R  NON NUMERIC           00288700
                   AIF   ('&ZCGPR' LT '2').ZE48Q                        00288800
                   AIF   ('&ZCGPR' LE '12').ZE48R                       00288900
.ZE48Q             ANOP  ,                                              00289000
&ZMS               SETC  '"HANDLE='                                     00289100
&ZMS               SETC  '&ZMS.&HANDLE"'                                00289200
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00289300
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00289400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00289500
.ZE48R             ANOP  ,                                              00289600
.*-------------------------------------------------------------------   00289700
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00289800
&ZTLC              SETC 'NO'                                            00289900
                   AIF   ('&REXX(1)' NE '&ZTLC').ZE52A                  00290000
&XREXX             SETC  'NO'        SET KEYWORD                        00290100
                   AIF   (N'&REXX LE 1).ZE52A   CK NUM                  00290200
&ZMS               SETC  '"REXX='                                       00290300
&ZMS               SETC  '&ZMS.&REXX"'                                  00290400
&ZMS               SETC  '&ZMS "REXX"'                                  00290500
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00290600
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00290700
.ZE52A             ANOP  ,                                              00290800
.*-------------------------------------------------------------------   00290900
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00291000
&ZTLC              SETC 'YES'                                           00291100
                   AIF   ('&REXX(1)' NE '&ZTLC').ZE53A                  00291200
&XREXX             SETC  'YES'       SET KEYWORD                        00291300
                   AIF   (N'&REXX LE 1).ZE53A   CK NUM                  00291400
&ZMS               SETC  '"REXX='                                       00291500
&ZMS               SETC  '&ZMS.&REXX"'                                  00291600
&ZMS               SETC  '&ZMS "REXX"'                                  00291700
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00291800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00291900
.ZE53A             ANOP  ,                                              00292000
.*------------------------------------------------------------------    00292100
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00292200
.ZE54              AIF   (K'&XREXX GT 0).ZE54A                          00292300
                   AIF   (K'&REXX(1) LE 0).ZE54B                        00292400
&ZMS               SETC  '"REXX='                                       00292500
&ZMS               SETC  '&ZMS.&REXX"'                                  00292600
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00292700
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00292800
&ZMS               SETC  '&ZMS "NO"'                                    00292900
&ZMS               SETC  '&ZMS OR "YES".'                               00293000
                   MNOTE 8,' &ZMS '                                     00293100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00293200
                   AGO   .ZE54B                                         00293300
.*                                                                      00293400
.ZE54A             ANOP  ,                                              00293500
&ZXREXX            SETC  'INPUT'     SET IN/OUTPUT                      00293600
.ZE54B             ANOP  ,                                              00293700
.*------------------------------------------------------------------    00293800
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           00293900
.ZE55              AIF   (K'&XREMOTE GT 0).ZE55A                        00294000
                   AIF   (K'&REMOTE(1) LE 0).ZE55B                      00294100
&ZMS               SETC  '"REMOTE='                                     00294200
&ZMS               SETC  '&ZMS.&REMOTE"'                                00294300
&ZMS               SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '      00294400
&ZMS               SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'            00294500
&ZMS               SETC  '&ZMS "NO"'                                    00294600
&ZMS               SETC  '&ZMS OR "YES".'                               00294700
                   MNOTE 8,' &ZMS '                                     00294800
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00294900
                   AGO   .ZE55B                                         00295000
.*                                                                      00295100
.ZE55A             ANOP  ,                                              00295200
&ZXREMOTE          SETC  'INPUT'     SET IN/OUTPUT                      00295300
.ZE55B             ANOP  ,                                              00295400
.*----------------------------------------------------------------***   00295500
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00295600
                   AIF   (N'&RETCODE LE 1).ZE57A  CK NUM                00295700
&ZMS               SETC  '"RETCODE='                                    00295800
&ZMS               SETC  '&ZMS.&RETCODE"'                               00295900
&ZMS               SETC  '&ZMS "RETCODE"'                               00296000
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00296100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00296200
.ZE57A             ANOP  ,                                              00296300
.*-------------------------------------------------------------------   00296400
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00296500
                   AIF   (K'&RETCODE(1) LE 0).ZE57B NO PRM              00296600
&ZXRETCODE         SETC  'OUTPUT'    SET IN/OUTPUT                      00296700
&XRETCODE          SETC  '&RETCODE(1)'          SET XVARIABLE           00296800
                   AIF   (N'&RETCODE GT 1).ZE57B                        00296900
.*                 ANOP                                                 00297000
&XRETCODE          SETC  '&RETCODE'  SET XVARIABLE                      00297100
.ZE57B             ANOP  ,                                              00297200
.*-------------------------------------------------------------------   00297300
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00297400
                   AIF   (K'&ZXRETCODE LE 0).ZE57R  NOT I/O             00297500
                   AIF   ('&XRETCODE'(1,1) NE '(').ZE57R                00297600
&ZCGPR             SETC  '&XRETCODE'(2,K'&XRETCODE-2)                   00297700
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE57P                   00297800
                   AIF   (K'&ZCGPR GT 2).ZE57Q                          00297900
                   AIF   ('&ZCGPR' EQ '0').ZE57Q                        00298000
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00298100
                   AIF   (T'&ZCGPR NE 'N').ZE57Q  INVALID REG NAME      00298200
.ZE57P             ANOP  ,                                              00298300
                   AIF   (T'&ZCGPR NE 'N').ZE57R  NON NUMERIC           00298400
                   AIF   ('&ZCGPR' LT '2').ZE57Q                        00298500
                   AIF   ('&ZCGPR' LE '12').ZE57R                       00298600
.ZE57Q             ANOP  ,                                              00298700
&ZMS               SETC  '"RETCODE='                                    00298800
&ZMS               SETC  '&ZMS.&RETCODE"'                               00298900
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00299000
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00299100
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00299200
.ZE57R             ANOP  ,                                              00299300
.*----------------------------------------------------------------***   00299400
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         00299500
                   AIF   (N'&RSNCODE LE 1).ZE60A  CK NUM                00299600
&ZMS               SETC  '"RSNCODE='                                    00299700
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00299800
&ZMS               SETC  '&ZMS "RSNCODE"'                               00299900
                   MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'            00300000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00300100
.ZE60A             ANOP  ,                                              00300200
.*-------------------------------------------------------------------   00300300
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    00300400
                   AIF   (K'&RSNCODE(1) LE 0).ZE60B NO PRM              00300500
&ZXRSNCODE         SETC  'OUTPUT'    SET IN/OUTPUT                      00300600
&XRSNCODE          SETC  '&RSNCODE(1)'          SET XVARIABLE           00300700
                   AIF   (N'&RSNCODE GT 1).ZE60B                        00300800
.*                 ANOP                                                 00300900
&XRSNCODE          SETC  '&RSNCODE'  SET XVARIABLE                      00301000
.ZE60B             ANOP  ,                                              00301100
.*-------------------------------------------------------------------   00301200
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   00301300
                   AIF   (K'&ZXRSNCODE LE 0).ZE60R  NOT I/O             00301400
                   AIF   ('&XRSNCODE'(1,1) NE '(').ZE60R                00301500
&ZCGPR             SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                   00301600
                   AIF   ('&ZCGPR'(1,1) NE '0').ZE60P                   00301700
                   AIF   (K'&ZCGPR GT 2).ZE60Q                          00301800
                   AIF   ('&ZCGPR' EQ '0').ZE60Q                        00301900
&ZCGPR             SETC  '&ZCGPR'(2,1)                                  00302000
                   AIF   (T'&ZCGPR NE 'N').ZE60Q  INVALID REG NAME      00302100
.ZE60P             ANOP  ,                                              00302200
                   AIF   (T'&ZCGPR NE 'N').ZE60R  NON NUMERIC           00302300
                   AIF   ('&ZCGPR' LT '2').ZE60Q                        00302400
                   AIF   ('&ZCGPR' LE '12').ZE60R                       00302500
.ZE60Q             ANOP  ,                                              00302600
&ZMS               SETC  '"RSNCODE='                                    00302700
&ZMS               SETC  '&ZMS.&RSNCODE"'                               00302800
&ZMS               SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'      00302900
                   MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'               00303000
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00303100
.ZE60R             ANOP  ,                                              00303200
.******************************************************************     00303300
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        00303400
.******************************************************************     00303500
                   ACTR  10000                                          00303600
.*----------------------------------------------------------------***   00303700
.***AF.P02 EXTRA POSITIONALS                                            00303800
                   AIF   (N'&SYSLIST LE 0).ZELISTX  NO EXTRAS           00303900
&ZCVAL             SETC  ''          ERROR FIELD                        00304000
&ZAWRK             SETA  0           POSITIONAL NUMBER                  00304100
.ZELIST2           ANOP  ,                                              00304200
&ZAWRK             SETA  &ZAWRK+1    NEXT POSITIONAL                    00304300
                   AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE           00304400
&ZCVAL             SETC '&ZCVAL,&SYSLIST(&ZAWRK)'  EXTRA                00304500
                   AGO   .ZELIST2                                       00304600
.*                                                                      00304700
.ZELIST3           ANOP  ,                                              00304800
&ZCVAL             SETC '&ZCVAL'(2,K'&ZCVAL-1)  STRIP COMMA             00304900
&ZMS               SETC  'POSITIONAL ARGUMENT(S),'                      00305000
&ZMS               SETC  '&ZMS "&ZCVAL"'                                00305100
&ZMS               SETC  '&ZMS CANNOT BE USED.'                         00305200
&ZMS               SETC  '&ZMS NO POSITIONAL ARGUMENTS'                 00305300
                   MNOTE 8,' &ZMS ARE ALLOWED.'                         00305400
&ZMACRET           SETA  8           SET MACRO ERROR RETURN CODE        00305500
.ZELISTX           ANOP  ,                                              00305600
&ZASYSLNDX         SETA  0                                              00305700
.*-------------------------------------------------------------------   00305800
.***AE.MF02 MF=(SLME)                                                   00305900
.ZEMFX             ANOP  ,           END OF PARTIAL SYNTAX CHECK        00306000
.*******************************************************************    00306100
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       00306200
.*******************************************************************    00306300
                   AIF   (&ZMACRET NE 0).ZLX2   ERROR DETECTED          00306400
.*******************************************************************    00306500
.***AE.01  START OF HZSPREAD MACRO CODE                                 00306600
.*******************************************************************    00306700
                   LCLC  &M0M0001                 NAME                  00306800
&M0M0001           SETC  '&XLABEL'                SET NAME              00306900
                   AIF   (K'&XLABEL NE 0).XLAB2                         00307000
&M0M0001           SETC  'M00M&SYSNDX'            DEFAULT NAME          00307100
.*                                                                      00307200
.XLAB2             ANOP  ,                                              00307300
                   AIF   ('&XMF' EQ 'L').XLAB3                          00307400
&M0M0001 DS    0H                             HZSPREAD-0                00307500
.XLAB3             ANOP  ,                                              00307600
.*******************************************************************    00307700
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              00307800
.*******************************************************************    00307900
              PUSH  PRINT                                               00308000
                   AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON     00308100
                   PRINT OFF         ++ PR01                            00308200
                   AGO   .ZPRNTXX                                       00308300
.ZPRINTX           PRINT ON                                             00308400
.ZPRNTXX           ANOP  ,                                              00308500
.********************************************************************   00308600
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     00308700
.********************************************************************   00308800
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       00308900
                      LCLA  &ZOPN1         INVOCATION INDEX             00309000
                      LCLC  &ZOPL(4095)    LABEL                        00309100
                      LCLC  &ZOPO(4095)    OPERATION                    00309200
                      LCLC  &ZOPV(4095)    VALUE                        00309300
                      LCLC  &ZOPD(4095)    DESCRIPTION                  00309400
.*                                                                      00309500
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     00309600
.******************************************************************     00309700
.***AL.L10 HZSPREAD FMT=LIST MF=S!L PARAMETERS                          00309800
.******************************************************************     00309900
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     00310000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     00310100
&XMFCTRL              SETC  '#Z'.'&SYSNDX'.'A'                          00310200
&XMFATTR              SETC  '0D'                                        00310300
.*                                                                      00310400
&ZOPN                 SETA  &ZOPN+1                                     00310500
&ZOPL(&ZOPN)          SETC  ' '                                         00310600
                      AIF   (&SYSALVL NE 0).ZALVL6A                     00310700
&ZOPO(&ZOPN)          SETC  'B'                                         00310800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                00310900
                      AGO   .ZALVL6B                                    00311000
.ZALVL6A              ANOP                                              00311100
&ZOPO(&ZOPN)          SETC  'CNOP'                                      00311200
&ZOPV(&ZOPN)          SETC  '4,8'                                       00311300
&ZOPN                 SETA  &ZOPN+1                                     00311400
&ZOPL(&ZOPN)          SETC  ' '                                         00311500
&ZOPO(&ZOPN)          SETC  'BRAS'                                      00311600
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL.S'                              00311700
.ZALVL6B              ANOP                                              00311800
&ZOPD(&ZOPN)          SETC  '++ HZSPREAD ARG PARMS'                     00311900
.*                                                                      00312000
&ZOPN                 SETA  &ZOPN+1                                     00312100
&ZOPL(&ZOPN)          SETC  ' '                                         00312200
&ZOPO(&ZOPN)          SETC  'SPACE'                                     00312300
&ZOPV(&ZOPN)          SETC  '1'                                         00312400
&ZOPD(&ZOPN)          SETC  ' '                                         00312500
.*                                                                      00312600
.ZLMFSL2              ANOP  ,                                           00312700
.*-------------------------------------------------------------------   00312800
.***AM.L00  HZSPREAD FMT=LIST name                                      00312900
                      AIF   ('&XMF' NE 'L').ZLMFSL2M                    00313000
&ZOPN                 SETA &ZOPN+1                                      00313100
&ZOPL(&ZOPN)          SETC '&M0M0001'                                   00313200
&ZOPO(&ZOPN)          SETC 'EQU'                                        00313300
&ZOPV(&ZOPN)          SETC '&XMFCTRL'                                   00313400
&ZOPD(&ZOPN)          SETC '++ HZSPREAD NAME'                           00313500
.ZLMFSL2M             ANOP  ,                                           00313600
.*-------------------------------------------------------------------   00313700
.***AM.L01  HZSPREAD FMT=LIST PARAMETERS                                00313800
&ZOPN                 SETA &ZOPN+1                                      00313900
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   00314000
&ZOPO(&ZOPN)          SETC 'DS'                                         00314100
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   00314200
&ZOPD(&ZOPN)          SETC '++ HZSPREAD PARM LIST'                      00314300
.*-------------------------------------------------------------------   00314400
.***AM.L02 XVERSION XL1                                                 00314500
&ZOPN                 SETA &ZOPN+1                                      00314600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         00314700
&ZOPO(&ZOPN)          SETC 'DS'                                         00314800
&ZOPV(&ZOPN)          SETC 'XL1'                                        00314900
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          00315000
.*-------------------------------------------------------------------   00315100
.***AM.L09  XRSV0003 CL03                                               00315200
&ZOPN                 SETA &ZOPN+1                                      00315300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0003'                         00315400
&ZOPO(&ZOPN)          SETC 'DS'                                         00315500
&ZOPV(&ZOPN)          SETC 'CL03'                                       00315600
&ZOPD(&ZOPN)          SETC '++ RESERVED '                               00315700
.*-------------------------------------------------------------------   00315800
.***AM.L03 XFLAGS BL.32                                                 00315900
&ZOPN                 SETA &ZOPN+1                                      00316000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XFLAGS'                           00316100
&ZOPO(&ZOPN)          SETC 'DS'                                         00316200
&ZOPV(&ZOPN)          SETC 'BL.32'                                      00316300
&ZOPD(&ZOPN)          SETC '++ FIELD_LABEL'                             00316400
.*                                                                      00316500
&ZOPN                 SETA  &ZOPN+1                                     00316600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XIPL_CURRENT'                    00316700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00316800
&ZOPV(&ZOPN)          SETC  'B''10000000000000000000000000000000'''     00316900
&ZOPD(&ZOPN)          SETC  '++ XIPL.'                                  00317000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CURRENT'                      00317100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00317200
.*                                                                      00317300
&ZOPN                 SETA  &ZOPN+1                                     00317400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XIPL_PRIOR'                      00317500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00317600
&ZOPV(&ZOPN)          SETC  'B''01000000000000000000000000000000'''     00317700
&ZOPD(&ZOPN)          SETC  '++ XIPL.'                                  00317800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).PRIOR'                        00317900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00318000
.*                                                                      00318100
&ZOPN                 SETA  &ZOPN+1                                     00318200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XINSTANCE_FIRST'                 00318300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00318400
&ZOPV(&ZOPN)          SETC  'B''00100000000000000000000000000000'''     00318500
&ZOPD(&ZOPN)          SETC  '++ XINSTANCE.'                             00318600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).FIRST'                        00318700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00318800
.*                                                                      00318900
&ZOPN                 SETA  &ZOPN+1                                     00319000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XINSTANCE_MOSTRECENT'            00319100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00319200
&ZOPV(&ZOPN)          SETC  'B''00010000000000000000000000000000'''     00319300
&ZOPD(&ZOPN)          SETC  '++ XINSTANCE.'                             00319400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MOSTRECENT'                   00319500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00319600
.*                                                                      00319700
&ZOPN                 SETA  &ZOPN+1                                     00319800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_RETIPLTOD'               00319900
&ZOPO(&ZOPN)          SETC  'EQU'                                       00320000
&ZOPV(&ZOPN)          SETC  'B''00000100000000000000000000000000'''     00320100
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00320200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RETIPLTOD'                    00320300
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00320400
.*                                                                      00320500
&ZOPN                 SETA  &ZOPN+1                                     00320600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_RETPTIME'                00320700
&ZOPO(&ZOPN)          SETC  'EQU'                                       00320800
&ZOPV(&ZOPN)          SETC  'B''00000010000000000000000000000000'''     00320900
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               00321000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RETPTIME'                     00321100
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00321200
.*                                                                      00321300
&ZOPN                 SETA  &ZOPN+1                                     00321400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREMOTE_YES'                     00321500
&ZOPO(&ZOPN)          SETC  'EQU'                                       00321600
&ZOPV(&ZOPN)          SETC  'B''00000001000000000000000000000000'''     00321700
&ZOPD(&ZOPN)          SETC  '++ XREMOTE.'                               00321800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00321900
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00322000
.*                                                                      00322100
&ZOPN                 SETA  &ZOPN+1                                     00322200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XREXX_YES'                       00322300
&ZOPO(&ZOPN)          SETC  'EQU'                                       00322400
&ZOPV(&ZOPN)          SETC  'B''00000000100000000000000000000000'''     00322500
&ZOPD(&ZOPN)          SETC  '++ XREXX.'                                 00322600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          00322700
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00322800
.*                                                                      00322900
&ZOPN                 SETA  &ZOPN+1                                     00323000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XSECCHECK_ALL'                   00323100
&ZOPO(&ZOPN)          SETC  'EQU'                                       00323200
&ZOPV(&ZOPN)          SETC  'B''00000000010000000000000000000000'''     00323300
&ZOPD(&ZOPN)          SETC  '++ XSECCHECK.'                             00323400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).ALL'                          00323500
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      00323600
.*-------------------------------------------------------------------   00323700
.***AM.L09 ADDR XBUFFER A                                               00323800
&ZOPN                 SETA &ZOPN+1                                      00323900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ADDR'                     00324000
&ZOPO(&ZOPN)          SETC 'DS'                                         00324100
&ZOPV(&ZOPN)          SETC 'A'                                          00324200
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ADDR'                          00324300
.*-------------------------------------------------------------------   00324400
.***AM.L09 ALET XBUFFER F                                               00324500
&ZOPN                 SETA &ZOPN+1                                      00324600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBUFFER_ALET'                     00324700
&ZOPO(&ZOPN)          SETC 'DS'                                         00324800
&ZOPV(&ZOPN)          SETC 'F'                                          00324900
&ZOPD(&ZOPN)          SETC '++ &ZXBUFFER ALET'                          00325000
.*-------------------------------------------------------------------   00325100
.***AM.L09  XCHECKNAME CL32                                             00325200
&ZOPN                 SETA &ZOPN+1                                      00325300
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHECKNAME'                       00325400
&ZOPO(&ZOPN)          SETC 'DS'                                         00325500
&ZOPV(&ZOPN)          SETC 'CL32'                                       00325600
&ZOPD(&ZOPN)          SETC '++ &ZXCHECKNAME '                           00325700
.*-------------------------------------------------------------------   00325800
.***AM.L09  XCHECKOWNER CL16                                            00325900
&ZOPN                 SETA &ZOPN+1                                      00326000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCHECKOWNER'                      00326100
&ZOPO(&ZOPN)          SETC 'DS'                                         00326200
&ZOPV(&ZOPN)          SETC 'CL16'                                       00326300
&ZOPD(&ZOPN)          SETC '++ &ZXCHECKOWNER '                          00326400
.*-------------------------------------------------------------------   00326500
.***AM.L09  XRETIPLTOD CL8                                              00326600
&ZOPN                 SETA &ZOPN+1                                      00326700
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRETIPLTOD'                       00326800
&ZOPO(&ZOPN)          SETC 'DS'                                         00326900
&ZOPV(&ZOPN)          SETC 'CL8'                                        00327000
&ZOPD(&ZOPN)          SETC '++ &ZXRETIPLTOD '                           00327100
.*-------------------------------------------------------------------   00327200
.***AM.L09  XBYTESPROVIDED F                                            00327300
&ZOPN                 SETA &ZOPN+1                                      00327400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBYTESPROVIDED'                   00327500
&ZOPO(&ZOPN)          SETC 'DS'                                         00327600
&ZOPV(&ZOPN)          SETC 'F'                                          00327700
&ZOPD(&ZOPN)          SETC '++ &ZXBYTESPROVIDED '                       00327800
.*-------------------------------------------------------------------   00327900
.***AM.L09  XRETPTIME CL8                                               00328000
&ZOPN                 SETA &ZOPN+1                                      00328100
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRETPTIME'                        00328200
&ZOPO(&ZOPN)          SETC 'DS'                                         00328300
&ZOPV(&ZOPN)          SETC 'CL8'                                        00328400
&ZOPD(&ZOPN)          SETC '++ &ZXRETPTIME '                            00328500
.*-------------------------------------------------------------------   00328600
.***AM.L09  XDATALEN F                                                  00328700
&ZOPN                 SETA &ZOPN+1                                      00328800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XDATALEN'                         00328900
&ZOPO(&ZOPN)          SETC 'DS'                                         00329000
&ZOPV(&ZOPN)          SETC 'F'                                          00329100
&ZOPD(&ZOPN)          SETC '++ &ZXDATALEN '                             00329200
.*-------------------------------------------------------------------   00329300
.***AM.L09  XSTARTBYTE F                                                00329400
&ZOPN                 SETA &ZOPN+1                                      00329500
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XSTARTBYTE'                       00329600
&ZOPO(&ZOPN)          SETC 'DS'                                         00329700
&ZOPV(&ZOPN)          SETC 'F'                                          00329800
&ZOPD(&ZOPN)          SETC '++ &ZXSTARTBYTE '                           00329900
.*-------------------------------------------------------------------   00330000
.***AM.L09  XBYTESAVAIL F                                               00330100
&ZOPN                 SETA &ZOPN+1                                      00330200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XBYTESAVAIL'                      00330300
&ZOPO(&ZOPN)          SETC 'DS'                                         00330400
&ZOPV(&ZOPN)          SETC 'F'                                          00330500
&ZOPD(&ZOPN)          SETC '++ &ZXBYTESAVAIL '                          00330600
.*-------------------------------------------------------------------   00330700
.***AM.L09  XHANDLE CL16                                                00330800
&ZOPN                 SETA &ZOPN+1                                      00330900
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XHANDLE'                          00331000
&ZOPO(&ZOPN)          SETC 'DS'                                         00331100
&ZOPV(&ZOPN)          SETC 'CL16'                                       00331200
&ZOPD(&ZOPN)          SETC '++ &ZXHANDLE '                              00331300
.*-------------------------------------------------------------------   00331400
.***AM.L10 END OF HZSPREAD LIST PARAMETERS                              00331500
&ZOPN                 SETA &ZOPN+1                                      00331600
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 00331700
&ZOPO(&ZOPN)          SETC 'EQU'                                        00331800
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 00331900
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         00332000
.*                                                                      00332100
&ZOPN                 SETA &ZOPN+1                                      00332200
&ZOPL(&ZOPN)          SETC ' '                                          00332300
&ZOPO(&ZOPN)          SETC 'SPACE'                                      00332400
&ZOPV(&ZOPN)          SETC '1'                                          00332500
&ZOPD(&ZOPN)          SETC ' '                                          00332600
.*-------------------------------------------------------------------   00332700
.***AL.L12 HZSPREAD FMT=LIST MF=S!L PARAMETERS                          00332800
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         00332900
.*                                                                      00333000
&ZOPN                 SETA  &ZOPN+1                                     00333100
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                00333200
&ZOPO(&ZOPN)          SETC  'DC'                                        00333300
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   00333400
&ZOPD(&ZOPN)          SETC  '++ HZSPREAD ARG PARMS'                     00333500
.*                                                                      00333600
.ZLMFSLX              ANOP  ,                                           00333700
.*-------------------------------------------------------------------   00333800
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          00333900
&ZPLLEN               SETA 112                                          00334000
.*                                                                      00334100
.******************************************************************     00334200
.***AI.L01 HZSPREAD FMT=LIST FILL IN PARAMETER AREA                     00334300
.******************************************************************     00334400
                      ACTR  10000                                       00334500
&ZCVAL                SETC  'LA'           ASSUME XA MODE               00334600
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSSTATE PRI    00334700
&ZCVAL                SETC  'LAE'          XAX MODE                     00334800
.ZIMFXA               ANOP ,                                            00334900
.*                                                                      00335000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    00335100
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         00335200
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 00335300
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                00335400
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 00335500
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                00335600
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   00335700
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    00335800
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   00335900
&ZOPN                 SETA  &ZOPN+1                                     00336000
&ZOPL(&ZOPN)          SETC  ' '                                         00336100
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00336200
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              00336300
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00336400
                      AGO   .ZIMFNX                                     00336500
.*                                                                      00336600
.ZIMFN2               ANOP ,                                            00336700
                      AIF   (&SYSALVL EQ 0).ZIMFNX1                     00336800
                      AIF   ('&XMF' NE 'S').ZIMFNX1                     00336900
                      AIF   ('&ZCVAL' NE 'LAE').ZIMFNX                  00337000
&ZOPN                 SETA  &ZOPN+1                                     00337100
&ZOPL(&ZOPN)          SETC  ' '                                         00337200
&ZOPO(&ZOPN)          SETC  'LAE'                                       00337300
&ZOPV(&ZOPN)          SETC  '1,0(1,0)'                                  00337400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00337500
                      AGO   .ZIMFNX                                     00337600
.ZIMFNX1              ANOP ,                                            00337700
&ZOPN                 SETA  &ZOPN+1                                     00337800
&ZOPL(&ZOPN)          SETC  ' '                                         00337900
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00338000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                00338100
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       00338200
.ZIMFNX               ANOP ,                                            00338300
.********************************************************************   00338400
.***AI.L02 HZSPREAD FMT=LIST INITIALIZE PARAMETER AREA                  00338500
.********************************************************************   00338600
.***AI.L03 MF=(SLME)                                                    00338700
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      00338800
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            00338900
.*                                                                      00339000
&ZOPN                 SETA  &ZOPN+1                                     00339100
&ZOPL(&ZOPN)          SETC  ' '                                         00339200
&ZOPO(&ZOPN)          SETC  'XC'                                        00339300
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         00339400
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             00339500
.ZIMFLX               ANOP  ,                                           00339600
.*-------------------------------------------------------------------   00339700
.***AI.L05 XFLAGS BL4                                                   00339800
&ZW                   SETC  ''                                          00339900
&ZCLNG                SETC  ''             RESET BIT ON FLAG            00340000
&ZMS                  SETC  ''                                          00340100
&ZC                   SETC  ''                                          00340200
.*-------------------------------------------------------------------   00340300
.***AI.L08 XFLAGS "CURRENT"                                             00340400
.***      BL4'1XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'                         00340500
         AIF   ('&XIPL' NE 'CURRENT').ZI4A                              00340600
&ZW                   SETC  '&ZW.1'                                     00340700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00340800
&ZMS                  SETC  '&ZMS.1'                                    00340900
                      AGO   .ZI4C                                       00341000
.*                                                                      00341100
.ZI4A                 ANOP  ,                                           00341200
&ZW                   SETC  '&ZW.0'                                     00341300
         AIF   ('&ZXIPL' EQ '').ZI4B                                    00341400
&ZMS                  SETC  '&ZMS.0'                                    00341500
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00341600
                      AGO   .ZI4C                                       00341700
.*                                                                      00341800
.ZI4B                 ANOP  ,                                           00341900
&ZMS                  SETC  '&ZMS.1'                                    00342000
.ZI4C                 ANOP  ,                                           00342100
.*-------------------------------------------------------------------   00342200
.***AI.L08 XFLAGS "PRIOR"                                               00342300
.***      BL4'X1XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'                         00342400
         AIF   ('&XIPL' NE 'PRIOR').ZI5A                                00342500
&ZW                   SETC  '&ZW.1'                                     00342600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00342700
&ZMS                  SETC  '&ZMS.1'                                    00342800
                      AGO   .ZI5C                                       00342900
.*                                                                      00343000
.ZI5A                 ANOP  ,                                           00343100
&ZW                   SETC  '&ZW.0'                                     00343200
         AIF   ('&ZXIPL' EQ '').ZI5B                                    00343300
&ZMS                  SETC  '&ZMS.0'                                    00343400
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00343500
                      AGO   .ZI5C                                       00343600
.*                                                                      00343700
.ZI5B                 ANOP  ,                                           00343800
&ZMS                  SETC  '&ZMS.1'                                    00343900
.ZI5C                 ANOP  ,                                           00344000
.*-------------------------------------------------------------------   00344100
.***AI.L08 XFLAGS "FIRST"                                               00344200
.***      BL4'XX1XXXXXXXXXXXXXXXXXXXXXXXXXXXXX'                         00344300
         AIF   ('&XINSTANCE' NE 'FIRST').ZI6A                           00344400
&ZW                   SETC  '&ZW.1'                                     00344500
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00344600
&ZMS                  SETC  '&ZMS.1'                                    00344700
                      AGO   .ZI6C                                       00344800
.*                                                                      00344900
.ZI6A                 ANOP  ,                                           00345000
&ZW                   SETC  '&ZW.0'                                     00345100
         AIF   ('&ZXINSTANCE' EQ '').ZI6B                               00345200
&ZMS                  SETC  '&ZMS.0'                                    00345300
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00345400
                      AGO   .ZI6C                                       00345500
.*                                                                      00345600
.ZI6B                 ANOP  ,                                           00345700
&ZMS                  SETC  '&ZMS.1'                                    00345800
.ZI6C                 ANOP  ,                                           00345900
.*-------------------------------------------------------------------   00346000
.***AI.L08 XFLAGS "MOSTRECENT"                                          00346100
.***      BL4'XXX1XXXXXXXXXXXXXXXXXXXXXXXXXXXX'                         00346200
         AIF   ('&XINSTANCE' NE 'MOSTRECENT').ZI7A                      00346300
&ZW                   SETC  '&ZW.1'                                     00346400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00346500
&ZMS                  SETC  '&ZMS.1'                                    00346600
                      AGO   .ZI7C                                       00346700
.*                                                                      00346800
.ZI7A                 ANOP  ,                                           00346900
&ZW                   SETC  '&ZW.0'                                     00347000
         AIF   ('&ZXINSTANCE' EQ '').ZI7B                               00347100
&ZMS                  SETC  '&ZMS.0'                                    00347200
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00347300
                      AGO   .ZI7C                                       00347400
.*                                                                      00347500
.ZI7B                 ANOP  ,                                           00347600
&ZMS                  SETC  '&ZMS.1'                                    00347700
.ZI7C                 ANOP  ,                                           00347800
.*-------------------------------------------------------------------   00347900
.***AI.L08 XFLAGS "RETIPLTOD"                                           00348000
.***      BL4'XXXXX1XXXXXXXXXXXXXXXXXXXXXXXXXX'                         00348100
         AIF   ('&RETIPLTOD' EQ '').ZI8A                                00348200
&ZW                   SETC  '&ZW.01'                                    00348300
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00348400
&ZMS                  SETC  '&ZMS.10'                                   00348500
                      AGO   .ZI8C                                       00348600
.*                                                                      00348700
.ZI8A                 ANOP  ,                                           00348800
&ZW                   SETC  '&ZW.00'                                    00348900
&ZMS                  SETC  '&ZMS.11'                                   00349000
.ZI8C                 ANOP  ,                                           00349100
.*-------------------------------------------------------------------   00349200
.***AI.L08 XFLAGS "RETPTIME"                                            00349300
.***      BL4'XXXXXX1XXXXXXXXXXXXXXXXXXXXXXXXX'                         00349400
         AIF   ('&RETPTIME' EQ '').ZI9A                                 00349500
&ZW                   SETC  '&ZW.1'                                     00349600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00349700
&ZMS                  SETC  '&ZMS.0'                                    00349800
                      AGO   .ZI9C                                       00349900
.*                                                                      00350000
.ZI9A                 ANOP  ,                                           00350100
&ZW                   SETC  '&ZW.0'                                     00350200
&ZMS                  SETC  '&ZMS.1'                                    00350300
.ZI9C                 ANOP  ,                                           00350400
.*-------------------------------------------------------------------   00350500
.***AI.L08 XFLAGS "YES"                                                 00350600
.***      BL4'XXXXXXX1XXXXXXXXXXXXXXXXXXXXXXXX'                         00350700
         AIF   ('&XREMOTE' NE 'YES').ZI10A                              00350800
&ZW                   SETC  '&ZW.1'                                     00350900
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00351000
&ZMS                  SETC  '&ZMS.1'                                    00351100
                      AGO   .ZI10C                                      00351200
.*                                                                      00351300
.ZI10A                ANOP  ,                                           00351400
&ZW                   SETC  '&ZW.0'                                     00351500
         AIF   ('&ZXREMOTE' EQ '').ZI10B                                00351600
&ZMS                  SETC  '&ZMS.0'                                    00351700
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00351800
                      AGO   .ZI10C                                      00351900
.*                                                                      00352000
.ZI10B                ANOP  ,                                           00352100
&ZMS                  SETC  '&ZMS.1'                                    00352200
.ZI10C                ANOP  ,                                           00352300
.*-------------------------------------------------------------------   00352400
.***AI.L08 XFLAGS "YES"                                                 00352500
.***      BL4'XXXXXXXX1XXXXXXXXXXXXXXXXXXXXXXX'                         00352600
         AIF   ('&XREXX' NE 'YES').ZI11A                                00352700
&ZW                   SETC  '&ZW.1'                                     00352800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00352900
&ZMS                  SETC  '&ZMS.1'                                    00353000
                      AGO   .ZI11C                                      00353100
.*                                                                      00353200
.ZI11A                ANOP  ,                                           00353300
&ZW                   SETC  '&ZW.0'                                     00353400
         AIF   ('&ZXREXX' EQ '').ZI11B                                  00353500
&ZMS                  SETC  '&ZMS.0'                                    00353600
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00353700
                      AGO   .ZI11C                                      00353800
.*                                                                      00353900
.ZI11B                ANOP  ,                                           00354000
&ZMS                  SETC  '&ZMS.1'                                    00354100
.ZI11C                ANOP  ,                                           00354200
.*-------------------------------------------------------------------   00354300
.***AI.L08 XFLAGS "ALL"                                                 00354400
.***      BL4'XXXXXXXXX1XXXXXXXXXXXXXXXXXXXXXX'                         00354500
         AIF   ('&XSECCHECK' NE 'ALL').ZI12A                            00354600
&ZW                   SETC  '&ZW.10000000000000000000000'               00354700
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              00354800
&ZMS                  SETC  '&ZMS.11111111111111111111111'              00354900
                      AGO   .ZI12C                                      00355000
.*                                                                      00355100
.ZI12A                ANOP  ,                                           00355200
&ZW                   SETC  '&ZW.00000000000000000000000'               00355300
         AIF   ('&ZXSECCHECK' EQ '').ZI12B                              00355400
&ZMS                  SETC  '&ZMS.01111111111111111111111'              00355500
&ZC                   SETC  'YES'          SET BIT OFF FLAG             00355600
                      AGO   .ZI12C                                      00355700
.*                                                                      00355800
.ZI12B                ANOP  ,                                           00355900
&ZMS                  SETC  '&ZMS.11111111111111111111111'              00356000
.ZI12C                ANOP  ,                                           00356100
.*-------------------------------------------------------------------   00356200
.***AI.L10 XFLAGS BL4                                                   00356300
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI12D              00356400
                      AIF   ('&ZC' NE 'YES').ZI12D                      00356500
&ZOPN                 SETA  &ZOPN+1                                     00356600
&ZOPL(&ZOPN)          SETC  ' '                                         00356700
&ZOPO(&ZOPN)          SETC  'NC'                                        00356800
&ZOPV(&ZOPN)          SETC  '4(4,1),=BL4''&ZMS'''                       00356900
&ZOPD(&ZOPN)          SETC  '++ INPUT BL4'                              00357000
.ZI12D                ANOP  ,                                           00357100
                      AIF   ('&ZCLNG' NE 'YES').ZI12E  ALL ZERO BITS    00357200
&ZOPN                 SETA  &ZOPN+1                                     00357300
&ZOPL(&ZOPN)          SETC  ' '                                         00357400
&ZOPO(&ZOPN)          SETC  'OC'                                        00357500
&ZOPV(&ZOPN)          SETC  '4(4,1),=BL4''&ZW'''                        00357600
&ZOPD(&ZOPN)          SETC  '++ INPUT BL4'                              00357700
.ZI12E                ANOP  ,                                           00357800
.*-------------------------------------------------------------------   00357900
.***AI.L19 ADDR XBUFFER A                                               00358000
                      AIF   ('&ZXBUFFER' EQ '').ZI13H                   00358100
&ZCLNG                SETC  '&XBUFFER'                                  00358200
&ZCGPR                SETC  '14'                                        00358300
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI13F  IN GPR                   00358400
.*                                                                      00358500
&ZOPN                 SETA  &ZOPN+1                                     00358600
&ZOPL(&ZOPN)          SETC  ' '                                         00358700
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    00358800
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCLNG'                             00358900
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00359000
.*                                                                      00359100
                      AGO   .ZI13G                                      00359200
.*                                                                      00359300
.ZI13F                ANOP  ,                                           00359400
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00359500
.*                                                                      00359600
.ZI13G                ANOP  ,                                           00359700
.*                                                                      00359800
&ZOPN                 SETA  &ZOPN+1                                     00359900
&ZOPL(&ZOPN)          SETC  ' '                                         00360000
&ZOPO(&ZOPN)          SETC  'ST'                                        00360100
&ZOPV(&ZOPN)          SETC  '&ZCGPR,8(,1)'                              00360200
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00360300
.*                                                                      00360400
.ZI13H                ANOP  ,                                           00360500
.*-------------------------------------------------------------------   00360600
.***AI.L23 ALET XBUFFER F                                               00360700
         AIF   ('&ZXBUFFER' EQ '').ZI14G                                00360800
         AIF   ('&SYSASCE' EQ 'P').ZI14G   SYSSTATE PRIMARY             00360900
&ZCLNG                SETC  '&XBUFFER'                                  00361000
         AIF   ('&XBUFFER'(1,1) EQ '(').ZI14E  IN AR                    00361100
.*                                                                      00361200
&ZCGPR                SETC  '14'                                        00361300
                      AGO   .ZI14F                                      00361400
.*                                                                      00361500
.ZI14E                ANOP  ,                                           00361600
&ZCGPR   SETC  '&XBUFFER'(2,K'&XBUFFER-2)                               00361700
.*                                                                      00361800
.ZI14F                ANOP  ,                                           00361900
.*                                                                      00362000
&ZOPN                 SETA  &ZOPN+1                                     00362100
&ZOPL(&ZOPN)          SETC  ' '                                         00362200
&ZOPO(&ZOPN)          SETC  'STAM'                                      00362300
&ZOPV(&ZOPN)          SETC  '&ZCGPR,&ZCGPR,12(1)'                       00362400
&ZOPD(&ZOPN)          SETC  '++ &ZXBUFFER XBUFFER'                      00362500
.*                                                                      00362600
.ZI14G                ANOP  ,                                           00362700
.*-------------------------------------------------------------------   00362800
.***AI.L25  XCHECKNAME CL32                                             00362900
                      AIF   ('&ZXCHECKNAME' EQ '').ZI15E                00363000
                      AIF   ('&ZXCHECKNAME' EQ 'OUTPUT').ZI15E          00363100
&ZCGPR                SETC  '&XCHECKNAME'                               00363200
.*                                                                      00363300
                      AIF   ('&XCHECKNAME'(1,1) NE '(').ZI15B           00363400
&ZCGPR   SETC  '0('.'&XCHECKNAME'(2,K'&XCHECKNAME-2).')'                00363500
.ZI15B                ANOP  ,                                           00363600
.*                                                                      00363700
&ZOPN                 SETA  &ZOPN+1                                     00363800
&ZOPL(&ZOPN)          SETC  ' '                                         00363900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00364000
&ZOPV(&ZOPN)          SETC  '16(32,1),&ZCGPR'                           00364100
&ZOPD(&ZOPN)          SETC  '++ &ZXCHECKNAME XCHECKNAME'                00364200
.*                                                                      00364300
.ZI15E                ANOP  ,                                           00364400
.*-------------------------------------------------------------------   00364500
.***AI.L25  XCHECKOWNER CL16                                            00364600
                      AIF   ('&ZXCHECKOWNER' EQ '').ZI16E               00364700
                      AIF   ('&ZXCHECKOWNER' EQ 'OUTPUT').ZI16E         00364800
&ZCGPR                SETC  '&XCHECKOWNER'                              00364900
.*                                                                      00365000
                      AIF   ('&XCHECKOWNER'(1,1) NE '(').ZI16B          00365100
&ZCGPR   SETC  '0('.'&XCHECKOWNER'(2,K'&XCHECKOWNER-2).')'              00365200
.ZI16B                ANOP  ,                                           00365300
.*                                                                      00365400
&ZOPN                 SETA  &ZOPN+1                                     00365500
&ZOPL(&ZOPN)          SETC  ' '                                         00365600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00365700
&ZOPV(&ZOPN)          SETC  '48(16,1),&ZCGPR'                           00365800
&ZOPD(&ZOPN)          SETC  '++ &ZXCHECKOWNER XCHECKOWNER'              00365900
.*                                                                      00366000
.ZI16E                ANOP  ,                                           00366100
.*-------------------------------------------------------------------   00366200
.***AI.L25  XDATALEN F                                                  00366300
                      AIF   ('&ZXDATALEN' EQ '').ZI20E                  00366400
                      AIF   ('&ZXDATALEN' EQ 'OUTPUT').ZI20E            00366500
&ZCGPR                SETC  '&XDATALEN'                                 00366600
.*                                                                      00366700
                      AIF   ('&XDATALEN'(1,1) NE '(').ZI20B             00366800
&ZCGPR   SETC  '0('.'&XDATALEN'(2,K'&XDATALEN-2).')'                    00366900
                      AGO   .ZI20D                                      00367000
.ZI20B                ANOP  ,                                           00367100
.*                                                                      00367200
&ZC                   SETC  '&XDATALEN'(1,1)                            00367300
                      AIF   (T'&ZC NE 'N').ZI20D                        00367400
&ZC                   SETC  '&XDATALEN'                                 00367500
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI20D               00367600
&ZCGPR                SETC  '=FL4''&XDATALEN'''                         00367700
.*                                                                      00367800
.ZI20D                ANOP  ,                                           00367900
.*                                                                      00368000
&ZOPN                 SETA  &ZOPN+1                                     00368100
&ZOPL(&ZOPN)          SETC  ' '                                         00368200
&ZOPO(&ZOPN)          SETC  'MVC'                                       00368300
&ZOPV(&ZOPN)          SETC  '84(4,1),&ZCGPR'                            00368400
&ZOPD(&ZOPN)          SETC  '++ &ZXDATALEN XDATALEN'                    00368500
.*                                                                      00368600
.ZI20E                ANOP  ,                                           00368700
.*-------------------------------------------------------------------   00368800
.***AI.L18  XSTARTBYTE F                                                00368900
         AIF   ('&XSTARTBYTE' NE 'FIRST_BYTE').ZI21                     00369000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI21  CK *        00369100
&ZXSTARTBYTE          SETC  ''             RESET INPUT/OUTPUT           00369200
.ZI21                 ANOP  ,                                           00369300
.*-------------------------------------------------------------------   00369400
.***AI.L25  XSTARTBYTE F                                                00369500
                      AIF   ('&ZXSTARTBYTE' EQ '').ZI21E                00369600
                      AIF   ('&ZXSTARTBYTE' EQ 'OUTPUT').ZI21E          00369700
&ZCGPR                SETC  '&XSTARTBYTE'                               00369800
         AIF   ('&XSTARTBYTE' NE 'FIRST_BYTE').ZI21A                    00369900
         AIF   ('&XMFSCK' EQ 'COMPLETE').ZI21E                          00370000
.*                                                                      00370100
&ZCGPR                SETC  '=XL4''00'''                                00370200
.ZI21A                ANOP  ,                                           00370300
.*                                                                      00370400
                      AIF   ('&XSTARTBYTE'(1,1) NE '(').ZI21B           00370500
&ZCGPR   SETC  '0('.'&XSTARTBYTE'(2,K'&XSTARTBYTE-2).')'                00370600
                      AGO   .ZI21D                                      00370700
.ZI21B                ANOP  ,                                           00370800
.*                                                                      00370900
&ZC                   SETC  '&XSTARTBYTE'(1,1)                          00371000
                      AIF   (T'&ZC NE 'N').ZI21D                        00371100
&ZC                   SETC  '&XSTARTBYTE'                               00371200
                      AIF   ('&ZC'(K'&ZC,1) EQ ')').ZI21D               00371300
&ZCGPR                SETC  '=FL4''&XSTARTBYTE'''                       00371400
.*                                                                      00371500
.ZI21D                ANOP  ,                                           00371600
.*                                                                      00371700
&ZOPN                 SETA  &ZOPN+1                                     00371800
&ZOPL(&ZOPN)          SETC  ' '                                         00371900
&ZOPO(&ZOPN)          SETC  'MVC'                                       00372000
&ZOPV(&ZOPN)          SETC  '88(4,1),&ZCGPR'                            00372100
&ZOPD(&ZOPN)          SETC  '++ &ZXSTARTBYTE XSTARTBYTE'                00372200
.*                                                                      00372300
.ZI21E                ANOP  ,                                           00372400
.*-------------------------------------------------------------------   00372500
.***AI.L25  XHANDLE CL16                                                00372600
                      AIF   ('&ZXHANDLE' EQ '').ZI23E                   00372700
                      AIF   ('&ZXHANDLE' EQ 'OUTPUT').ZI23E             00372800
&ZCGPR                SETC  '&XHANDLE'                                  00372900
.*                                                                      00373000
                      AIF   ('&XHANDLE'(1,1) NE '(').ZI23B              00373100
&ZCGPR   SETC  '0('.'&XHANDLE'(2,K'&XHANDLE-2).')'                      00373200
.ZI23B                ANOP  ,                                           00373300
.*                                                                      00373400
&ZOPN                 SETA  &ZOPN+1                                     00373500
&ZOPL(&ZOPN)          SETC  ' '                                         00373600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00373700
&ZOPV(&ZOPN)          SETC  '96(16,1),&ZCGPR'                           00373800
&ZOPD(&ZOPN)          SETC  '++ &ZXHANDLE XHANDLE'                      00373900
.*                                                                      00374000
.ZI23E                ANOP  ,                                           00374100
.*-------------------------------------------------------------------   00374200
&ZOPN1                SETA &ZOPN                                        00374300
.*-------------------------------------------------------------------   00374400
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              00374500
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         00374600
.*******************************************************************    00374700
.***  PROCESS HZSPREAD OUTPUT PARAMETERS                                00374800
.*******************************************************************    00374900
                      ACTR  10000                                       00375000
.*------------------------------------------------------------------    00375100
.***AO.L02 XRETIPLTOD CL8                                               00375200
         AIF   ('&ZXRETIPLTOD' EQ 'OUTPUT').ZO17A  OUTPUT               00375300
         AIF   ('&ZXRETIPLTOD' NE 'INOUT').ZO17C  INOUT                 00375400
.ZO17A    AIF   ('&XRETIPLTOD'(1,1) NE '(').ZO17B  ADDR IN GPR          00375500
&ZCGPR   SETC  '&XRETIPLTOD'(2,K'&XRETIPLTOD-2)                         00375600
&ZOPN                 SETA  &ZOPN+1                                     00375700
&ZOPL(&ZOPN)          SETC  ' '                                         00375800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00375900
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),64(1)'                         00376000
&ZOPD(&ZOPN)          SETC  '++ XRETIPLTOD CL8'                         00376100
                      AGO   .ZO17C                                      00376200
.*                                                                      00376300
.ZO17B                ANOP  ,                                           00376400
&ZAWRK   SETA  K'&XRETIPLTOD                                            00376500
         AIF   ('&XRETIPLTOD'(&ZAWRK,1) NE ')').ZO17G                   00376600
&ZN      SETA  2                                                        00376700
.ZO17H    ANOP                                                          00376800
         AIF   (&ZN GE &ZAWRK).ZO17G                                    00376900
         AIF   ('&XRETIPLTOD'(&ZN,1) NE '(').ZO17I                      00377000
&ZC      SETC  '&XRETIPLTOD'(1,&ZN).'8'.','                             00377100
&ZC      SETC  '&ZC'.'&XRETIPLTOD'(&ZN+1,&ZAWRK-&ZN).',64(1)'           00377200
         AGO   .ZO17J                                                   00377300
.ZO17I    ANOP                                                          00377400
&ZN      SETA  &ZN+1                                                    00377500
         AGO   .ZO17H                                                   00377600
.ZO17G    ANOP                                                          00377700
&ZC      SETC  '&XRETIPLTOD.(8),64(1)'                                  00377800
.ZO17J    ANOP                                                          00377900
&ZOPN                 SETA  &ZOPN+1                                     00378000
&ZOPL(&ZOPN)          SETC  ' '                                         00378100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00378200
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00378300
&ZOPD(&ZOPN)          SETC  '++ XRETIPLTOD CL8'                         00378400
.ZO17C                ANOP  ,                                           00378500
.*------------------------------------------------------------------    00378600
.***AO.L02 XBYTESPROVIDED F                                             00378700
         AIF   ('&ZXBYTESPROVIDED' EQ 'OUTPUT').ZO18A  OUTPUT           00378800
         AIF   ('&ZXBYTESPROVIDED' NE 'INOUT').ZO18C  INOUT             00378900
.ZO18A    AIF   ('&XBYTESPROVIDED'(1,1) NE '(').ZO18B  ADDR IN GPR      00379000
&ZCGPR   SETC  '&XBYTESPROVIDED'(2,K'&XBYTESPROVIDED-2)                 00379100
&ZOPN                 SETA  &ZOPN+1                                     00379200
&ZOPL(&ZOPN)          SETC  ' '                                         00379300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00379400
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),72(1)'                         00379500
&ZOPD(&ZOPN)          SETC  '++ XBYTESPROVIDED F'                       00379600
                      AGO   .ZO18C                                      00379700
.*                                                                      00379800
.ZO18B                ANOP  ,                                           00379900
&ZAWRK   SETA  K'&XBYTESPROVIDED                                        00380000
         AIF   ('&XBYTESPROVIDED'(&ZAWRK,1) NE ')').ZO18G               00380100
&ZN      SETA  2                                                        00380200
.ZO18H    ANOP                                                          00380300
         AIF   (&ZN GE &ZAWRK).ZO18G                                    00380400
         AIF   ('&XBYTESPROVIDED'(&ZN,1) NE '(').ZO18I                  00380500
&ZC      SETC  '&XBYTESPROVIDED'(1,&ZN).'4'.','                         00380600
&ZC      SETC  '&ZC'.'&XBYTESPROVIDED'(&ZN+1,&ZAWRK-&ZN).',72(1)'       00380700
         AGO   .ZO18J                                                   00380800
.ZO18I    ANOP                                                          00380900
&ZN      SETA  &ZN+1                                                    00381000
         AGO   .ZO18H                                                   00381100
.ZO18G    ANOP                                                          00381200
&ZC      SETC  '&XBYTESPROVIDED.(4),72(1)'                              00381300
.ZO18J    ANOP                                                          00381400
&ZOPN                 SETA  &ZOPN+1                                     00381500
&ZOPL(&ZOPN)          SETC  ' '                                         00381600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00381700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00381800
&ZOPD(&ZOPN)          SETC  '++ XBYTESPROVIDED F'                       00381900
.ZO18C                ANOP  ,                                           00382000
.*------------------------------------------------------------------    00382100
.***AO.L02 XRETPTIME CL8                                                00382200
         AIF   ('&ZXRETPTIME' EQ 'OUTPUT').ZO19A  OUTPUT                00382300
         AIF   ('&ZXRETPTIME' NE 'INOUT').ZO19C  INOUT                  00382400
.ZO19A    AIF   ('&XRETPTIME'(1,1) NE '(').ZO19B  ADDR IN GPR           00382500
&ZCGPR   SETC  '&XRETPTIME'(2,K'&XRETPTIME-2)                           00382600
&ZOPN                 SETA  &ZOPN+1                                     00382700
&ZOPL(&ZOPN)          SETC  ' '                                         00382800
&ZOPO(&ZOPN)          SETC  'MVC'                                       00382900
&ZOPV(&ZOPN)          SETC  '0(8,&ZCGPR),76(1)'                         00383000
&ZOPD(&ZOPN)          SETC  '++ XRETPTIME CL8'                          00383100
                      AGO   .ZO19C                                      00383200
.*                                                                      00383300
.ZO19B                ANOP  ,                                           00383400
&ZAWRK   SETA  K'&XRETPTIME                                             00383500
         AIF   ('&XRETPTIME'(&ZAWRK,1) NE ')').ZO19G                    00383600
&ZN      SETA  2                                                        00383700
.ZO19H    ANOP                                                          00383800
         AIF   (&ZN GE &ZAWRK).ZO19G                                    00383900
         AIF   ('&XRETPTIME'(&ZN,1) NE '(').ZO19I                       00384000
&ZC      SETC  '&XRETPTIME'(1,&ZN).'8'.','                              00384100
&ZC      SETC  '&ZC'.'&XRETPTIME'(&ZN+1,&ZAWRK-&ZN).',76(1)'            00384200
         AGO   .ZO19J                                                   00384300
.ZO19I    ANOP                                                          00384400
&ZN      SETA  &ZN+1                                                    00384500
         AGO   .ZO19H                                                   00384600
.ZO19G    ANOP                                                          00384700
&ZC      SETC  '&XRETPTIME.(8),76(1)'                                   00384800
.ZO19J    ANOP                                                          00384900
&ZOPN                 SETA  &ZOPN+1                                     00385000
&ZOPL(&ZOPN)          SETC  ' '                                         00385100
&ZOPO(&ZOPN)          SETC  'MVC'                                       00385200
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00385300
&ZOPD(&ZOPN)          SETC  '++ XRETPTIME CL8'                          00385400
.ZO19C                ANOP  ,                                           00385500
.*------------------------------------------------------------------    00385600
.***AO.L02 XBYTESAVAIL F                                                00385700
         AIF   ('&ZXBYTESAVAIL' EQ 'OUTPUT').ZO22A  OUTPUT              00385800
         AIF   ('&ZXBYTESAVAIL' NE 'INOUT').ZO22C  INOUT                00385900
.ZO22A    AIF   ('&XBYTESAVAIL'(1,1) NE '(').ZO22B  ADDR IN GPR         00386000
&ZCGPR   SETC  '&XBYTESAVAIL'(2,K'&XBYTESAVAIL-2)                       00386100
&ZOPN                 SETA  &ZOPN+1                                     00386200
&ZOPL(&ZOPN)          SETC  ' '                                         00386300
&ZOPO(&ZOPN)          SETC  'MVC'                                       00386400
&ZOPV(&ZOPN)          SETC  '0(4,&ZCGPR),92(1)'                         00386500
&ZOPD(&ZOPN)          SETC  '++ XBYTESAVAIL F'                          00386600
                      AGO   .ZO22C                                      00386700
.*                                                                      00386800
.ZO22B                ANOP  ,                                           00386900
&ZAWRK   SETA  K'&XBYTESAVAIL                                           00387000
         AIF   ('&XBYTESAVAIL'(&ZAWRK,1) NE ')').ZO22G                  00387100
&ZN      SETA  2                                                        00387200
.ZO22H    ANOP                                                          00387300
         AIF   (&ZN GE &ZAWRK).ZO22G                                    00387400
         AIF   ('&XBYTESAVAIL'(&ZN,1) NE '(').ZO22I                     00387500
&ZC      SETC  '&XBYTESAVAIL'(1,&ZN).'4'.','                            00387600
&ZC      SETC  '&ZC'.'&XBYTESAVAIL'(&ZN+1,&ZAWRK-&ZN).',92(1)'          00387700
         AGO   .ZO22J                                                   00387800
.ZO22I    ANOP                                                          00387900
&ZN      SETA  &ZN+1                                                    00388000
         AGO   .ZO22H                                                   00388100
.ZO22G    ANOP                                                          00388200
&ZC      SETC  '&XBYTESAVAIL.(4),92(1)'                                 00388300
.ZO22J    ANOP                                                          00388400
&ZOPN                 SETA  &ZOPN+1                                     00388500
&ZOPL(&ZOPN)          SETC  ' '                                         00388600
&ZOPO(&ZOPN)          SETC  'MVC'                                       00388700
&ZOPV(&ZOPN)          SETC  '&ZC'                                       00388800
&ZOPD(&ZOPN)          SETC  '++ XBYTESAVAIL F'                          00388900
.ZO22C                ANOP  ,                                           00389000
.*******************************************************************    00389100
.***AO.X02  RETURN CODE PROCESSING                                      00389200
.*******************************************************************    00389300
                      AIF   (N'&RETCODE LE 0).ZMRETX                    00389400
                      AIF   ('&XRETCODE'(1,1) EQ '(').ZMRET2            00389500
                      AIF   ('&XRETCODE' EQ 'GPR15').ZMRETX             00389600
                      AIF   ('&XRETCODE' EQ 'REG15').ZMRETX             00389700
                      AIF   ('&XRETCODE' EQ 'R15').ZMRETX               00389800
                      AIF   ('&XRETCODE' EQ '15').ZMRETX                00389900
&ZOPN                 SETA  &ZOPN+1                                     00390000
&ZOPL(&ZOPN)          SETC  ' '                                         00390100
&ZOPO(&ZOPN)          SETC  'ST'                                        00390200
&ZOPV(&ZOPN)          SETC  '15,&XRETCODE'                              00390300
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00390400
                      AGO   .ZMRETX                                     00390500
.*                                                                      00390600
.ZMRET2               ANOP  ,                                           00390700
&ZCGPR                SETC  '&XRETCODE'(2,K'&XRETCODE-2)                00390800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                00390900
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                00391000
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  00391100
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   00391200
&ZOPN                 SETA  &ZOPN+1                                     00391300
&ZOPL(&ZOPN)          SETC  ' '                                         00391400
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00391500
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 00391600
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        00391700
.ZMRETX               ANOP  ,                                           00391800
.*******************************************************************    00391900
.***AO.X03  REASON CODE PROCESSING                                      00392000
.*******************************************************************    00392100
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    00392200
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            00392300
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              00392400
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             00392500
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              00392600
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             00392700
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                00392800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 00392900
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                00393000
&ZOPN                 SETA  &ZOPN+1                                     00393100
&ZOPL(&ZOPN)          SETC  ' '                                         00393200
&ZOPO(&ZOPN)          SETC  'ST'                                        00393300
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               00393400
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00393500
                      AGO   .ZMRSNX                                     00393600
.*                                                                      00393700
.ZMRSN2               ANOP  ,                                           00393800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                00393900
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 00394000
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                00394100
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 00394200
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                00394300
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   00394400
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    00394500
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   00394600
&ZOPN                 SETA  &ZOPN+1                                     00394700
&ZOPL(&ZOPN)          SETC  ' '                                         00394800
&ZOPO(&ZOPN)          SETC  '&ZMAC_LR'                                  00394900
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  00395000
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        00395100
.ZMRSNX               ANOP  ,                                           00395200
.*******************************************************************    00395300
.***AO.X04  LABEL FOR MF=L PROCESSING                                   00395400
.*******************************************************************    00395500
.ZMFLX                ANOP  ,              MF=L PROCESSING              00395600
.*******************************************************************    00395700
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               00395800
.*******************************************************************    00395900
                      ACTR  10000                                       00396000
.*                                                                      00396100
                      LCLA  &ZLC           COLUMN POSITION              00396200
                      LCLA  &ZOPX          LIST TABLE INDEX             00396300
                      LCLC  &ZLL           LABEL                        00396400
                      LCLC  &ZLOP          OPERATION                    00396500
                      LCLC  &ZLV           VALUE                        00396600
                      LCLC  &ZLD           DESCRIPTION                  00396700
.*                                                                      00396800
&ZOPX                 SETA  1                                           00396900
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            00397000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00397100
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00397200
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00397300
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00397400
                      AIF   (K'&ZLD LE 0).ZL5                           00397500
&ZLC                  SETA  35             COMMENT COLUMN               00397600
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    00397700
&ZLC                  SETA  33             COMMMENT COLUMN              00397800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   00397900
&ZLV                  SETC  '&ZLV'.' '                                  00398000
                      AGO   .ZL3                                        00398100
.*                                                                      00398200
.ZL4                  ANOP  ,                                           00398300
&ZLV                  SETC  '&ZLV'.' '                                  00398400
.ZL5                  ANOP  ,                                           00398500
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00398600
.*                                                                      00398700
&ZLL     &ZLOP &ZLV                                                     00398800
.*                                                                      00398900
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00399000
                      AGO   .ZL2           CONTINUE LOOPING             00399100
.*                                                                      00399200
.ZLX                  ANOP  ,                                           00399300
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                00399400
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                00399500
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00399600
         AIF   ('&SYSAM64' NE 'YES').NOT_AM64                           00399700
&ZMAC_L  SETC  'LLGT'                                                   00399800
.NOT_AM64 ANOP                                                          00399900
         &ZMAC_L 15,16(0,0)         Get CVT address                     00400000
         AIF   ('&SYSASCE' EQ 'P').NOT_AR_1                             00400100
         LAE   15,0(15,0)           Clear AR 15                         00400200
.NOT_AR_1 ANOP                                                          00400300
         L     15,140(15,0)         Get ECVT address                    00400400
         L     15,204(15,0)         Get CTBL address                    00400500
         AIF   ('&XREMOTE' EQ 'YES').REM1A                              00400600
         L     15,300(15,0)         Get HZSTABLE address                00400700
         AGO   .REM1B                                                   00400800
.REM1A   ANOP                                                           00400900
         ICM   15,B'1111',300(15)   Get HZSTABLE address                00401000
         JZ    HZSPREADNA_&SYSNDX   No HZSTABLE, get out now            00401100
         TM    1240(15),X'80'       Check if commands accepted          00401200
         JZ    HZSPREADNA_&SYSNDX   No cmds accepted, get out now       00401300
.REM1B   ANOP                                                           00401400
         AIF   (&SYSALVL GE 2).IS_ZARCH_1                               00401500
         CLI   163(0),00            Z-Architecture?                     00401600
         JE    HZSPREADESA390_&SYSNDX                                   00401700
.IS_ZARCH_1 ANOP                                                        00401800
         LMH   15,15,1372(15)                                           00401900
         AIF   (&SYSALVL GE 2).IS_ZARCH_2                               00402000
HZSPREADESA390_&SYSNDX DS 0H                                            00402100
.IS_ZARCH_2 ANOP                                                        00402200
         AIF   ('&XREMOTE' EQ 'YES').REM2A                              00402300
         L     15,1328(15,0)        Get HZSPREAD PC NUM                 00402400
         AGO   .REM2B                                                   00402500
.REM2A   ANOP                                                           00402600
         ICM   15,B'1111',1328(15)  Get HZSPREAD PC NUM                 00402700
         JZ    HZSPREADNA_&SYSNDX   No PC Num, get out now              00402800
.REM2B   ANOP                                                           00402900
         PC    0(15)                PC to handle HZSPREAD request       00403000
         AIF   ('&XREMOTE' NE 'YES').REM3B                              00403100
         J     HZSPREADEND_&SYSNDX  Branch around seting bad RC         00403200
HZSPREADNA_&SYSNDX DS 0H                                                00403300
         LA    15,X'C'              Set RC (HC not active)              00403400
         LA    0,X'C01'             Set RSN not active                  00403500
HZSPREADEND_&SYSNDX DS 0H                                               00403600
.REM3B   ANOP                                                           00403700
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  00403800
.ZLINKX               ANOP  ,                                           00403900
.*******************************************************************    00404000
.***AP.X01  FORMAT GENERATED CODE                                       00404100
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            00404200
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              00404300
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              00404400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              00404500
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              00404600
                      AIF   (K'&ZLD LE 0).ZL51                          00404700
&ZLC                  SETA  35             COMMENT COLUMN               00404800
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   00404900
&ZLC                  SETA  33             COMMENT COLUMN               00405000
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  00405100
&ZLV                  SETC  '&ZLV'.' '                                  00405200
                      AGO   .ZL31                                       00405300
.*                                                                      00405400
.ZL41                 ANOP  ,                                           00405500
&ZLV                  SETC  '&ZLV'.' '                                  00405600
.ZL51                 ANOP  ,                                           00405700
&ZLV                  SETC  '&ZLV'.'&ZLD'                               00405800
.*                                                                      00405900
&ZLL     &ZLOP &ZLV                                                     00406000
.*                                                                      00406100
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               00406200
                      AGO   .ZL21          CONTINUE LOOPING             00406300
.*                                                                      00406400
.ZLX1                 ANOP  ,                                           00406500
.*******************************************************************    00406600
.***AP.X02  END OF HZSPREAD MACRO                                       00406700
&ZHZSPREAD            SETC  'YES'          SET HZSPREAD USED            00406800
         POP   PRINT                                                    00406900
*                                            HZSPREAD-0                 00407000
         SPACE 1                                                        00407100
.ZLX2                 ANOP  ,                                           00407200
         MEND                                                           00407300
**********************************************************************/ 00407400
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  00407500
*%HZSPREAD: MACRO KEYS(CHECKOWNER,CHECKNAME,SECCHECK,IPL,INSTANCE,      00407600
*                 BUFFER,DATALEN,STARTBYTE,BYTESAVAIL,BYTESPROVIDED,    00407700
*                 RETIPLTOD,RETPTIME,REMOTE,HANDLE,REXX,RETCODE,        00407800
*                 RSNCODE,PLISTVER,MF);                                 00407900
*  ANS('?'!!MACLABEL!!' '!!'HZSPREAP '!!MACLIST!!                       00408000
*         ' '!!MACKEYS!!';') COL(MACLMAR);                              00408100
*%END HZSPREAD;                                                         00408200
